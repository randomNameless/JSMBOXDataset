<!DOCTYPE html>

<html lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>player.ads.html</title>
</head>
<body>
<script>"use strict";(self.cnx_webpack_global_elements_545253=self.cnx_webpack_global_elements_545253||[]).push([["ads"],{1844:(t,i,e)=>{e.d(i,{Z:()=>o});var s=e(8081),r=e.n(s),n=e(3645),h=e.n(n)()(r());h.push([t.id,".cnx-non-linear-ad-container .cnx-ad-bid-slot{position:absolute;top:0;left:0;grid-area:adslot;opacity:0;background:none;width:100%;height:100%}.cnx-non-linear-ad-container .cnx-ad-bid-slot.cnx-ad-bid-slot-selected{opacity:1;z-index:10}.cnx-non-linear-ad-container .cnx-ad-slot{display:flex;position:absolute;top:0;left:0;justify-content:center;align-items:center;width:100%;height:100%;overflow:hidden}.cnx-non-linear-ad-container .cnx-ad-slot video,.cnx-non-linear-ad-container video.cnx-ad-slot{background-color:unset}.cnx-ad-container .cnx-ad-bid-slot{position:absolute;top:0;left:0;grid-area:adslot;opacity:0;background:#f4f4f4;width:100%;height:100%}.cnx-ad-container .cnx-ad-bid-slot.cnx-ad-bid-slot-selected{opacity:1;z-index:10}.cnx-ad-container .cnx-ad-slot{display:flex;position:absolute;top:0;left:0;justify-content:center;align-items:center;width:100%;height:100%;overflow:hidden}.cnx-ad-container .cnx-ad-slot div{background-color:transparent !important}.cnx-ad-container .cnx-ad-slot iframe{box-sizing:border-box;border:3px solid #ffffff !important;color-scheme:none}.cnx-ad-container .cnx-ad-slot iframe:not([id]){border:none !important}.cnx-ad-container .cnx-ad-slot-video-type iframe{border:none !important}.cnx-ad-container .cnx-ad-slot video,.cnx-ad-container video.cnx-ad-slot{background-color:#f4f4f4}\n",""]);const o=h},3645:t=>{t.exports=function(t){var i=[];return i.toString=function(){return this.map((function(i){var e="",s=void 0!==i[5];return i[4]&&(e+="@supports (".concat(i[4],") {")),i[2]&&(e+="@media ".concat(i[2]," {")),s&&(e+="@layer".concat(i[5].length>0?" ".concat(i[5]):""," {")),e+=t(i),s&&(e+="}"),i[2]&&(e+="}"),i[4]&&(e+="}"),e})).join("")},i.i=function(t,e,s,r,n){"string"==typeof t&&(t=[[null,t,void 0]]);var h={};if(s)for(var o=0;o<this.length;o++){var a=this[o][0];null!=a&&(h[a]=!0)}for(var d=0;d<t.length;d++){var c=[].concat(t[d]);s&&h[c[0]]||(void 0!==n&&(void 0===c[5]||(c[1]="@layer".concat(c[5].length>0?" ".concat(c[5]):""," {").concat(c[1],"}")),c[5]=n),e&&(c[2]?(c[1]="@media ".concat(c[2]," {").concat(c[1],"}"),c[2]=e):c[2]=e),r&&(c[4]?(c[1]="@supports (".concat(c[4],") {").concat(c[1],"}"),c[4]=r):c[4]="".concat(r)),i.push(c))}},i}},8081:t=>{t.exports=function(t){return t[1]}},3276:(t,i,e)=>{e.d(i,{Z:()=>s});const s='<cnx class="cnx-ui-loader" role="presentation"><svg class="cnx-color-accent" version="1.1" viewBox="0 0 79 90" xmlns="http://www.w3.org/2000/svg"><polygon fill="none" points="21 73.322 11 79 11 12 21 17.678" stroke-linecap="round" stroke-linejoin="round"/><polygon fill="transparent" points="27 70 27 21 38 27.267 38 63.733" stroke-linecap="round" stroke-linejoin="round"/><polygon fill="none" points="44 61 44 31 54 36.769 54 55.231" stroke-linecap="round" stroke-linejoin="round"/><polygon fill="none" points="60 51 60 40 70 45.5" stroke-linecap="round" stroke-linejoin="round"/></svg></cnx>'},2457:(t,i,e)=>{e.d(i,{dA:()=>a,jO:()=>h,yG:()=>o});var s=e(8474),r=e(4865);function n(t){return t[t.length-1]}function h(t){return(0,s.m)(n(t))?t.pop():void 0}function o(t){return(0,r.K)(n(t))?t.pop():void 0}function a(t,i){return"number"==typeof n(t)?t.pop():i}},7845:(t,i,e)=>{function s(t,i,e,s,r){void 0===s&&(s=0),void 0===r&&(r=!1);var n=i.schedule((function(){e(),r?t.add(this.schedule(null,s)):this.unsubscribe()}),s);if(t.add(n),!r)return n}e.d(i,{f:()=>s})},585:(t,i,e)=>{e.r(i),e.d(i,{ElementsAdHandler:()=>co,OutstreamAdHandler:()=>uo,PlayspaceAdHandler:()=>mo});var s=e(6716),r=e(1027),n=e(2855),h=e(1573),o=e(4463),a=e(7476);class d{constructor(t,i,e,r,n,o,d,c,l,u,p){this.UE=t,this.QD=i,this.$r=e,this.ls=r,this.aT=n,this.oT=o,this.nT=d,this.mp=c,this._appSettings=l,this.Lg=u,this.rT=p,this.SF="normal",this.Li=[],this.hT=new s.x,this.Dv=new s.x,this.XC=new s.x,this.G$=new s.x,this.sN=new s.x,this.Rq=new s.x,this.pT=new s.x,this.lT=new s.x,this.vT=new s.x,this.Nq=new s.x,this.Qq=new s.x,this.mT=new s.x,this.ZH=new s.x,this.qc=this.jG(),this.jJ();const v=(0,h.TF)(this.mp.config.sessionId,a.k);this.iY=this.OX(v),this.zc(),this.gQ=this.XQ(v),this.gQ&&this.VZ(),this.QD&&this.disableAdvertising()}get onAdsEnable(){return this.hT.asObservable()}get onVpaidEvent(){return this.Dv.asObservable()}get onPrefetchStart(){return this.XC.asObservable()}get onNonLinearEvent(){return this.Nq.asObservable()}get onNonLinearExperienceEvent(){return this.Qq.asObservable()}get onNonLinearImpressionPrice(){return this.mT.asObservable()}get onNonLinearImpressionRevenue(){return this.ZH.asObservable()}get nonLinearInImpression(){return!!this.gQ&&this.gQ.inImpression}get onLinearEvent(){return this.G$.asObservable()}get onLinearUiComponentEvent(){return this.sN.asObservable()}get onLinearExperienceEvent(){return this.Rq.asObservable()}get onLinearImpressionPrice(){return this.pT.asObservable()}get onLinearImpressionRevenue(){return this.lT.asObservable()}get onLinearNoFill(){return this.vT.asObservable()}get linearInImpression(){return this.iY.inImpression}get linearAdUserInterface(){return this.iY.adUserInterface}get onFullcreenChange(){return this.iY.onFullcreenChange}get linearAdInWin(){return this.iY.adInWin}get firstLinearAdShown(){return this.iY.firstAdShown}get inAdPodLoadingState(){return this.iY.inAdPodLoadingState}get sessionId(){return this.$r.sessionId}get XZ(){return this.iY.adContainer}get d0(){return this.iY.secondaryAdContainer}get u0(){var t;return null===(t=this.gQ)||void 0===t?void 0:t.adContainer}inFloatingChanged(t){this.UE=t,this.qc.inFloatingChanged(t),this.iY.updateFloatingState(t)}canPrefetchAds(t){this.qc.canPrefetchAds(t)}hasAdsEligibleForFill(){return this.qc.hasAdsEligibleForFill()}setLineItemMetadata(t,i){this.qc.setLineItemMetadata(t,i)}startConnatixAuction(t){this.qc.startConnatixAuction(t)}adStateChange(t,i){var e;this.iY.adStateChange(t,i),null===(e=this.gQ)||void 0===e||e.adStateChange(t,i)}contentPlaybackStateChanged(t){var i;null===(i=this.gQ)||void 0===i||i.contentPlaybackStateChanged(t)}disableAds(t,i){this.qc.disableAds(t,i)}enableAds(t){this.qc.enableAds(t)}disableAdvertising(){this.qc.disableAdvertising()}enableAdvertising(){this.qc.enableAdvertising()}start(t,i,e,s,r=!1){r&&this.startNonLinear(),this.startLinear(e,s),this.ST(t,i,e)}stopAd(t){var i;this.iY.stopAd(t),null===(i=this.gQ)||void 0===i||i.stopAd(t)}play(){this.iY.play()}pause(){var t;this.iY.pause(),null===(t=this.gQ)||void 0===t||t.pause()}togglePlay(t=!1){this.iY.togglePlay(t)}resumeWithoutUserInteraction(t){var i;this.iY.resumeWithoutUserInteraction(),null===(i=this.gQ)||void 0===i||i.resumeWithoutUserInteraction(t)}resizeAd(t,i,e,s){var r;this.setVastViewMode(e),this.iY.resizeAd(t,i),null===(r=this.gQ)||void 0===r||r.resizeAd(t,i,s)}setPlayerOrientation(t){this.qc.setPlayerOrientation(t)}updateJsQueryTargeting(t){this.qc.updateJsQueryTargeting(t)}removeJsQueryTargeting(t){this.qc.removeJsQueryTargeting(t)}setVastViewMode(t){this.SF=t,this.qc.setVastViewMode(t)}contentChanged(){this.qc.onContentChange()}newLinearAdOpportunity(t){this.qc.newLinearAdOpportunity(t)}destroy(){var t,i,e;(0,o.i)(this.Li),this.iY.destroy(),null===(t=this.gQ)||void 0===t||t.destroy(),null===(i=this.qc)||void 0===i||i.disableAds(n.k.LINEAR,{disableReason:0}),null===(e=this.qc)||void 0===e||e.disableAds(n.k.NONLINEAR,{disableReason:0}),this.qc.destroy(this.$r.sessionId)}startNonLinear(){var t;null===(t=this.gQ)||void 0===t||t.start()}contentEnded(){var t;null===(t=this.gQ)||void 0===t||t.pause()}startLinear(t,i){this.iY.start(t,i)}setMediaRestrictions(t){this.qc.setMediaRestrictions(t)}getNewLinearAdOpportunity(){return this.qc.getNewLinearAdOpportunity()}getLinearVolume(){return this.iY.getVolume()}setLinearVolume(t){this.iY.setVolume(t)}increaseVolume(t,i=!1){this.iY.increaseVolume(t,i)}decreaseVolume(t,i=!1){this.iY.decreaseVolume(t,i)}toggleMute(t=!1){this.iY.toggleMute(t)}hideLinear(){this.iY.hide()}showLinear(){this.iY.show()}updateContinueReadingCard(){this.iY.updateContinueReadingCard()}setContinueReadingCard(t){this.iY.setContinueReadingCard(t)}hideContinueReadingCard(){this.iY.hideContinueReadingCard()}setAdMarkerTitle(t){this.iY.setAdMarkerTitle(t)}hideAdMarkerTitle(){this.iY.hideAdMarkerTitle()}enterAdPodLoadingState(){this.iY.enterAdPodLoadingState()}setAdLoadingBackgroundUrl(t){this.iY.setAdLoadingBackgroundUrl(t)}setCustomMacros(t){this.qc.setCustomMacros(t)}enablePrefetchForLinearity(t){this.qc.enablePrefetchForLinearity(t)}startPrefetchForLinearity(t,i){this.qc.startPrefetchForLinearity(t,i)}getLinearAdContainerWidth(){return this.iY.getMainAdContainerWidth()}userInteraction(){this.qc.userInteraction()}w0(t,i){const e=[{container:this.XZ,width:t,height:i,type:r.Z9.VIDEO_OVERLAY},{container:this.XZ,width:t,height:i,type:r.Z9.VIDEO_VIDEO},{container:this.u0,width:t,height:i,type:r.Z9.VIDEO_NON_LINEAR}];return this.u0||e.pop(),e}jJ(){this.Li.push(this.qc.onAdsEnable.subscribe((t=>{this.hT.next(t)})),this.qc.onPrefetchStart.subscribe((()=>{this.XC.next()})))}VZ(){var t,i,e;this.Li.push(null===(t=this.gQ)||void 0===t?void 0:t.onVpaidEvent.subscribe((t=>{this.Dv.next(t)})),null===(i=this.gQ)||void 0===i?void 0:i.onNonLinearEvent.subscribe((t=>{"showNonLinearEvent"===t.type&&this.linearInImpression&&this.gQ.pause(),this.Nq.next(t)})),null===(e=this.gQ)||void 0===e?void 0:e.onExperienceEvent.subscribe((t=>{this.Qq.next({type:t.type,payload:t.payload})})),this.qc.onNonlinearImpressionPrice.subscribe((t=>{this.mT.next(t)})),this.qc.onNonlinearImpressionRevenue.subscribe((t=>{this.ZH.next(t)})))}zc(){this.Li.push(this.iY.onVpaidEvent.subscribe((t=>{this.Dv.next(t)})),this.iY.onUiComponentEvent.subscribe((t=>{this.sN.next(t)})),this.iY.onExperienceEvent.subscribe((t=>{this.Rq.next({type:t.type,payload:t.payload})})),this.iY.onLinearEvent.subscribe((t=>{var i;"showLinearEvent"===t.type&&(null===(i=this.gQ)||void 0===i||i.pause()),this.G$.next(t)})),this.qc.onLinearImpressionPrice.subscribe((t=>{this.pT.next(t)})),this.qc.onLinearImpressionRevenue.subscribe((t=>{this.lT.next(t)})),this.qc.onLinearNoFill.subscribe((()=>{this.vT.next()})))}ST(t,i,e){this.qc.initAd(t,i,this.SF,1,e,this.w0(t,i),this.mp)}}var c=e(9127),l=e(7878),u=e(6798),p=e(7845),v=e(2566);var m=e(8474);function g(t,i,e){return void 0===e&&(e=1/0),(0,m.m)(i)?g((function(e,s){return(0,c.U)((function(t,r){return i(e,t,s,r)}))((0,l.Xf)(t(e,s)))}),e):("number"==typeof i&&(e=i),(0,u.e)((function(i,s){return function(t,i,e,s,r,n,h,o){var a=[],d=0,c=0,u=!1,m=function(){!u||a.length||d||i.complete()},g=function(t){return d<s?f(t):a.push(t)},f=function(t){n&&i.next(t),d++;var o=!1;(0,l.Xf)(e(t,c++)).subscribe((0,v.x)(i,(function(t){null==r||r(t),n?g(t):i.next(t)}),(function(){o=!0}),void 0,(function(){if(o)try{d--;for(var t=function(){var t=a.shift();h?(0,p.f)(i,h,(function(){return f(t)})):f(t)};a.length&&d<s;)t();m()}catch(t){i.error(t)}})))};return t.subscribe((0,v.x)(i,g,(function(){u=!0,m()}))),function(){null==o||o()}}(i,s,t,e)})))}var f=e(278);var I=e(1545),y=e(2457);function A(t,i){return void 0===i&&(i=0),(0,u.e)((function(e,s){e.subscribe((0,v.x)(s,(function(e){return(0,p.f)(s,t,(function(){return s.next(e)}),i)}),(function(){return(0,p.f)(s,t,(function(){return s.complete()}),i)}),(function(e){return(0,p.f)(s,t,(function(){return s.error(e)}),i)})))}))}function b(t,i){return void 0===i&&(i=0),(0,u.e)((function(e,s){s.add(t.schedule((function(){return e.subscribe(s)}),i))}))}var _=e(1480);var x=e(9768);function S(t,i){if(!t)throw new Error("Iterable cannot be null");return new _.y((function(e){(0,p.f)(e,i,(function(){var s=t[Symbol.asyncIterator]();(0,p.f)(e,i,(function(){s.next().then((function(t){t.done?e.complete():e.next(t.value)}))}),0,!0)}))}))}var w=e(1764),k=e(9272),P=e(5685),M=e(1837),C=e(8430),L=e(8729),T=e(7749);function B(t,i){if(null!=t){if((0,w.c)(t))return function(t,i){return(0,l.Xf)(t).pipe(b(i),A(i))}(t,i);if((0,P.z)(t))return function(t,i){return new _.y((function(e){var s=0;return i.schedule((function(){s===t.length?e.complete():(e.next(t[s++]),e.closed||this.schedule())}))}))}(t,i);if((0,k.t)(t))return function(t,i){return(0,l.Xf)(t).pipe(b(i),A(i))}(t,i);if((0,C.D)(t))return S(t,i);if((0,M.T)(t))return function(t,i){return new _.y((function(e){var s;return(0,p.f)(e,i,(function(){s=t[x.h](),(0,p.f)(e,i,(function(){var t,i,r;try{i=(t=s.next()).value,r=t.done}catch(t){return void e.error(t)}r?e.complete():e.next(i)}),0,!0)})),function(){return(0,m.m)(null==s?void 0:s.return)&&s.return()}}))}(t,i);if((0,T.L)(t))return function(t,i){return S((0,T.Q)(t),i)}(t,i)}throw(0,L.z)(t)}function E(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];var e=(0,y.yG)(t),s=(0,y.dA)(t,1/0),r=t;return r.length?1===r.length?(0,l.Xf)(r[0]):function(t){return void 0===t&&(t=1/0),g(f.y,t)}(s)(function(t,i){return i?B(t,i):(0,l.Xf)(t)}(r,e)):I.E}var D=e(692);const R="nonLinearCloseClick",O="f9a85c20-7d4b-4200-bf9e-3354710df1a1",F="c5897219-fa3c-4a19-a50a-24178cd51422";var V=e(6916);var $=e(5965),N=e(142),U=e(6288),W=e(822);class j extends N.P{constructor(){super(...arguments),this.eventList=[]}initComponent(){this.j0=this.Ny.getElementsByClassName($.mr.BackgroundImg)[0],this.q0=this.Ny.getElementsByClassName($.mr.Icon)[0],this.q0.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" viewBox="2 2 20 20"><path d="M14 3v2h3.59l-9.83 9.83 1.41 1.41L19 6.41V10h2V3m-2 16H5V5h7V3H5a2 2 0 00-2 2v14a2 2 0 002 2h14a2 2 0 002-2v-7h-2v7z"/></svg>',this.N2=this.Ny.getElementsByClassName($.mr.ButtonContainer)[0];const t=this.Ny.getElementsByClassName($.mr.Button)[0];this.U2=this.nt.createElementByString(`<a class="${$.mr.Wrapper}" href="#">`),this.U2.target="_blank",this.U2.appendChild(t),this.N2.innerHTML="",this.N2.appendChild(this.U2),this.W2=this.Ny.getElementsByClassName($.mr.InfoContainer)[0],this.j2=this.Ny.getElementsByClassName($.mr.FallbackContainer)[0],this.q2=this.Ny.getElementsByClassName($.mr.SlotCountText)[0]}setBackgroundImg(t){(0,W.QM)(t)?((0,U.IV)(this.j0,"cnx-mod-display-none"),this.j0.src=t):(0,U.cn)(this.j0,"cnx-mod-display-none")}setClickUrl(t){if(!(0,W.QM)(t))return(0,U.Ho)(this.j2),void(0,U.MV)(this.W2);(0,U.Ho)(this.W2),(0,U.MV)(this.j2),this.U2.href=t}setFallbackText(t,i){const e=t||1,s=i||1;this.q2.innerHTML=`Loading ad ${e}/${s}`}}var q=e(2191),H=e(7672);class z extends H.h{constructor(){super(...arguments),this.eventList=[q.C[q.C.SkipAd],...this.eventList],this.H2=-1,this.z2=-1}get tooltip(){}initComponent(){super.initComponent(),this.hideComponent(),this.G2=this.Ny.getElementsByTagName("cnx-span")[0],this.G2.innerHTML="Ad",this.J2=this.Ny.querySelectorAll(`.${$.Hs.Timer} svg`)[0],this.Ny.setAttribute("aria-label","Skip Ad")}setSecondsUntilSkip(t){this.H2=Math.ceil(t),this.z2=-1,this.H2>0&&(0,U.T7)(this.J2,{"animation-duration":this.H2+"s"})}tickDown(t){const i=this.H2-Math.floor(t);if(i<0||0===this.z2)return;const e=(0,U.pv)(this.Ny,$.Hs.InTimer);this.z2=i,0===this.z2?(e&&(0,U.IV)(this.Ny,$.Hs.InTimer),this.G2.innerHTML="Ad"):(e||(0,U.cn)(this.Ny,$.Hs.InTimer),this.G2.innerHTML=`in ${this.z2}s`)}GW(){0===this.z2&&this.mediator.publish(this,q.C[q.C.SkipAd])}}var G=e(6939),J=e(5046);const Y=J.h`<cnx class="cnx-ad-skip-button cnx-ui-btn" role="button" tabindex="0"><cnx class="cnx-icon-button"><cnx class="cnx-skip-ad-text">Skip <cnx-span></cnx-span></cnx><cnx class="cnx-skip-ad-icon">${G}</cnx></cnx><cnx class="cnx-timer-loader">${'<svg xmlns="http://www.w3.org/2000/svg" width="36" height="36"><circle class="cnx-svg-circle-stroke" cx="18" cy="18" r="17"/></svg>\n'}</cnx></cnx>`;var X=e(3586),Q=e(2764),K=e(2962);class Z extends K.A{constructor(t,i,e,s,r,n={}){super(t,i,e,r,n),this.Y2=s,this.X2={[V.r.VolumeControls]:t=>new X.N(t,this.nt,Q.e,this),[V.r.AdLoadingScreen]:t=>new j(t,this.nt,this.qW,'<cnx class="cnx-pod-loading-screen-container"><img class="cnx-pod-loading-background" alt="Loading Pods"><cnx class="cnx-pod-loading-info"><cnx class="cnx-pod-open-new-icon"></cnx><cnx class="cnx-pod-visit-website-text"><cnx-span>Visit Advertiser website</cnx-span></cnx><cnx class="cnx-pod-read-more-container"><cnx-span class="cnx-pod-read-more-btn">GO TO PAGE</cnx-span></cnx></cnx><cnx class="cnx-pod-loading-fallback"><cnx class="cnx-pod-loading-spinner"></cnx><cnx-span class="cnx-pod-slot-count-text"></cnx-span></cnx></cnx>'),[V.r.SkipAdButton]:t=>new z(t,this.nt,this.qW,Y,this.mi.isMobile),[V.r.FloatingCloseButton]:t=>{var i;if(!(null===(i=this.nt.global.cnxAsyncChunks)||void 0===i?void 0:i.litUI))return;const{litFloatingCloseOldUIWrapper:e}=this.nt.global.cnxAsyncChunks.litUI,{tooltipTextColor:s,tooltipBackgroundColor:r}=this.mi;return new e(t,{floatingCloseButtonTooltipPosition:this.Y2.floatingCloseButtonTooltipPosition||"above",tooltipTextColor:s,tooltipBackgroundColor:r})}},this.Q2=t=>i=>{var e,s;return null===(s=(e=this.X2)[t])||void 0===s?void 0:s.call(e,i)}}createComponent(t,i){return this.Q2(t)(i)||super.createComponent(t,i)}}var tt=e(6982),it=e(843),et=e(4052);class st extends et.d{exitState(){super.exitState()}K2(){super.K2()}}var rt=e(3592),nt=e(1749);class ht extends rt._{constructor(){super(...arguments),this.Z2=100}exitState(){super.exitState(),this.ep.duration&&(clearTimeout(this.t3),this.t3=null)}K2(){super.K2(),this.ep.duration&&this.i3()}i3(){if(this.t3||!this.ep.duration)return;const t=Date.now();this.t3=setTimeout((()=>{this.ep.elapsedTime+=(Date.now()-t)/1e3;const i=this.ep.getComponent(V.r.ProgressBar);i&&i.setProgress((0,nt.dQ)(0,this.ep.duration,0,100,this.ep.elapsedTime)),this.t3=null,this.i3()}),this.Z2)}}var ot=e(8243);class at extends it.q{constructor(t,i,e,r,n,o,a={}){super(r,t,n,new Z(t,e,r,o,a),a),this.iw=i,this.$container=r,this.e3={0:new ht(this),1:new st(this)},this.s3=new s.x,this.r3=0,this.rR=null,this.wa=t=>{(0,U.og)(this.$uiContainer,"cnx-ui-in-view",t)},this.n3.setDistanceValues({top:4,bottom:4}),this.e3[1].enterState(),this.h3=this.$container.querySelector(".cnx-ad-card-image"),this.o3=this.$container.querySelector(".cnx-ad-card-title"),this.a3=this.$container.querySelector(".cnx-ad-title-text"),this.c3=this.$container.querySelector(".cnx-ui-ad-content"),this.Xt=(0,h.AU)(tt.f)}get onUiEvent(){return this.s3.asObservable()}get elapsedTime(){return this.r3}set elapsedTime(t){this.r3=t,this.l3(this.r3)}updateDuration(t){const i=this.getComponent(V.r.ProgressBar),e=this.getComponent(V.r.TotalDurationLabel),s=this.getComponent(V.r.SkipAdButton);if(!t&&s&&(s.setSecondsUntilSkip(0),s.tickDown(0)),!t&&i)return i.setProgress(100),void i.updateWcagAttributes(0,0);this.elapsedTime=0,this.duration=t,i&&i.setProgress((0,nt.dQ)(0,t,0,100,0)),e&&e.setTime(t),this.l3(this.r3)}updateVolume(t){const i=this.getComponent(V.r.VolumeControls),e=this.getComponent(V.r.VolumeButton);i&&i.setVolume(t),e&&e.setVolume(t)}showSkipAdButton(t){const i=this.getComponent(V.r.SkipAdButton);i&&(i.showComponent(),i.setSecondsUntilSkip(t))}hideSkipAdButton(){const t=this.getComponent(V.r.SkipAdButton);t&&t.hideComponent()}addPodAdMarker(t,i){(0,U.cn)(this.$uiContainer,"cnx-ad-in-pod");(0,ot.Sz)(this.$uiContainer.getElementsByClassName("cnx-ad-marker-text")).forEach((e=>{e.innerHTML=`${t+1}/${i}`}))}removeAddPodAdMarker(){(0,U.IV)(this.$uiContainer,"cnx-ad-in-pod")}addDurationAdMarker(){(0,U.cn)(this.$uiContainer,"cnx-ad-duration")}removeDurationAdMarker(){(0,U.IV)(this.$uiContainer,"cnx-ad-duration")}hideAdLoadingScreen(){const t=this.getComponent(V.r.AdLoadingScreen);t&&t.hideComponent(),(0,U.IV)(this.$container,"cnx-in-pod-loading")}showAdLoadingScreen(t,i,e,s){const r=this.getComponent(V.r.AdLoadingScreen);r&&(r.showComponent(),r.setBackgroundImg(t),r.setClickUrl(i),r.setFallbackText(e,s),(0,U.cn)(this.$container,"cnx-in-pod-loading"))}hideAdMarker(){const t=this.$container.querySelector(".cnx-ad-marker");(0,U.MV)(t)}hideProgressBar(){this.getComponent(V.r.ProgressBar).hideComponent()}setContinueReadingCard(t){this.h3.style.backgroundImage=`url("${t.imageSrc}")`,this.o3.innerText=t.title||""}addAdMarkerTitle(t){this.a3.innerHTML=t}cardHasData(){return(0,W.QM)(this.h3.style.backgroundImage)&&(0,W.QM)(this.o3.innerHTML)}showContinueReadingCard(t){(0,U.cn)(this.$container,"cnx-ad-show-card"),null===this.rR&&(this.rR=this.vt.requestAnimationFrameHelper((()=>{this.rR=null;const{clientHeight:i,clientWidth:e}=this.c3;(0,nt.ON)({width:e,height:i})&&this.hideContinueReadingCard(this.$container);const s=this.u3(t);s&&(0,U.T7)(s,{height:`${i}px`})})))}hideContinueReadingCard(t){(0,U.IV)(this.$container,"cnx-ad-show-card");const i=this.u3(t);i&&(0,U.aQ)(i,"height")}showAdMarkerTitle(){(0,U.cn)(this.$uiContainer,"cnx-ad-title")}hideAdMarkerTitle(){(0,U.IV)(this.$uiContainer,"cnx-ad-title")}show(){super.show(),this.iw.on(this.$uiContainer,this.wa,{threshold:.5})}hide(){super.hide();(0,U.og)(this.$uiContainer,"cnx-ui-in-view",!1),this.iw.off(this.$uiContainer,this.wa)}expand(){this.getComponent(V.r.ExpandButton).setState(1)}collapse(){this.getComponent(V.r.ExpandButton).setState(0)}getComponent(t){return super.getComponent(t)}v3(t,i,e){var s,r,n;switch(super.v3(t,i,e),t){case q.C[q.C.Volume]:{const t=i.payload;this.s3.next({type:q.C.Volume,payload:{volume:t}});break}case q.C[q.C.Seek]:{const t=i.payload;this.s3.next({type:q.C.Seek,payload:{seek:t}});break}case q.C[q.C.Quality]:{const t=i.payload;this.s3.next({type:q.C.Quality,payload:{quality:t}});break}case q.C[q.C.HoverStart]:{const t=null===(s=null==i?void 0:i.payload)||void 0===s?void 0:s.targetComponent;this.s3.next({type:q.C.HoverStart,payload:t?{targetComponent:t}:void 0});break}case q.C[q.C.FocusStart]:this.m3();break;case q.C[q.C.HoverEnd]:{const t=null===(r=null==i?void 0:i.payload)||void 0===r?void 0:r.targetComponent;this.s3.next({type:q.C.HoverEnd,payload:t?{targetComponent:t}:void 0});break}case q.C[q.C.StateChanged]:{const t=null===(n=null==i?void 0:i.payload)||void 0===n?void 0:n.targetComponent;this.s3.next({type:q.C.StateChanged,payload:t?{targetComponent:t}:void 0});break}case q.C[q.C.RebindComponent]:{const t=i.payload;this.s3.next({type:q.C.RebindComponent,payload:{uiComponentEnum:t}});break}case V.r[V.r.CloseButton]:this.s3.next({type:q.C.Close});break;default:this.s3.next({type:q.C[t]})}}m3(){this.Xt.clearTimeout(this.g3),(0,U.cn)(this.$container,"cnx-focused"),this.g3=this.Xt.setTimeout((()=>{(0,U.IV)(this.$container,"cnx-focused"),this.n3.removeActiveTooltip()}),3e3)}l3(t){const i=this.getComponent(V.r.ElapsedTimeLabel);i&&i.setTime(t);const e=this.getComponent(V.r.SkipAdButton);e&&e.tickDown(t);const s=this.getComponent(V.r.ProgressBar);null==s||s.updateWcagAttributes(this.r3,this.duration);const r=this.getComponent(V.r.RemainingDurationLabel);if(r&&this.duration){const i=this.duration-t;i>=0&&r.setTime(i)}}u3(t){return t.querySelector(".cnx-ad-bid-slot-selected")}}var dt=e(3682),ct=e(6990),lt=e(5727);class ut{constructor(t){this.Y2=t}get template(){return J.h`<cnx class="cnx-ui cnx-ui-ad"><cnx class="cnx-ui-ad-content ${this.Y2.shouldShowExpandButton?"cnx-ad-fs":""}"><cnx class="cnx-ad-marker" role="img" aria-label="Ad"><cnx class="cnx-marker-cnt-first"><cnx class="cnx-marker-cnt-second"><cnx class="cnx-ad-marker-svg">${'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 22"><path d="M26,22H0V0H31.93L32,16A6,6,0,0,1,26,22Z" style="fill:#ffc800;fill-rule:evenodd"/><path d="M12,5.29h0L16.45,16.7H14.83l-1.06-2.85H8.86l-1,2.85H6.21L10.6,5.31h0Zm5.89,11.42V5.29h3.63A5.52,5.52,0,0,1,26.65,11a5.33,5.33,0,0,1-4.93,5.7H17.89Zm1.46-1.36h2.17c1.77,0,3.7-1.49,3.7-4.35s-1.93-4.28-3.7-4.28H19.35Zm-8-8.16-2,5.24h3.86Z" style="fill-rule:evenodd"/></svg>\n'}</cnx><cnx class="cnx-ad-marker-text">1/1</cnx></cnx><cnx class="cnx-ad-marker-duration">[[${V.r.RemainingDurationLabel}]]</cnx></cnx><cnx class="cnx-ad-marker-title"><cnx-span class="cnx-ad-title-text"></cnx-span></cnx></cnx><cnx class="cnx-ad-buttons"><cnx class="cnx-ad-play-button cnx-ui-btn">[[${V.r.PlayButton}]]</cnx><cnx class="cnx-ad-volume-controls">[[${V.r.VolumeControls}]]</cnx><cnx class="cnx-ad-volume-button cnx-ui-btn">[[${V.r.VolumeButton}]]</cnx></cnx>[[${V.r.SkipAdButton}]] ${this.I3()}<cnx class="cnx-ad-close-button cnx-over-ad-close-button cnx-ui-btn">[[${V.r.CloseButton}]]</cnx>${this.y3()}<cnx class="cnx-ad-progress-bar">[[${V.r.ProgressBar}]]</cnx></cnx><cnx class="cnx-ad-card"><svg class="${"cnx-ad-card-image"}" viewBox="0 0 16 9"></svg><cnx class="cnx-ad-card-text"><cnx>Continue watching</cnx><cnx class="${"cnx-ad-card-title"}"></cnx><cnx>after the ad</cnx></cnx></cnx>[[${V.r.AdLoadingScreen}]]</cnx>`}I3(){return 1===this.Y2.closeButtonLocation?`<cnx class="cnx-ad-close-button cnx-ad-floating-close-button cnx-ui-btn">[[${V.r.FloatingCloseButton}]]</cnx>`:""}y3(){return this.Y2.shouldShowExpandButton?`<cnx class="cnx-ad-expand-button cnx-ui-btn cnx-hide-on-volume-hover cnx-d-sm-none">[[${V.r.ExpandButton}]]</cnx>`:""}}var pt=e(7930),vt=e(7030),mt=e(6637),gt=e(5394),ft=e(3997);class It{constructor(t,i,e,r,n,h,o,a,d,c){this.$r=t,this.aT=i,this.oT=e,this.nT=r,this.mp=n,this.Lg=h,this.rT=o,this.qc=a,this.cs=d,this.ls=c,this.A3=[],this.b3=!1,this.Qk=!1,this._3=0,this.Dv=new s.x,this.x3=new s.x,this.S3=!1,this.fH=0,this.w3=!0,this.P3=!1,this.M3=!1,this.va=!1,this.C3=!1,this.Li=[],this.G$=new s.x,this.L3=new s.x,this.T3=new s.x,this.B3=new s.x,this._g=t=>{const i=t?{type:"AdPlayerInView"}:{type:"AdPlayerOutOfView"};this.x3.next(i),t&&this.Qk&&this.va&&this.x3.next({type:"AdPlayingInView"})},this.qG(),this.E3(),this.D3()}get onVpaidEvent(){return this.Dv.asObservable()}get onUiComponentEvent(){return this.L3.asObservable()}get onExperienceEvent(){return this.T3.asObservable()}get onLinearEvent(){return this.G$.asObservable()}get adUserInterface(){return this.R3}get adContainer(){return this._P}get secondaryAdContainer(){return this.d0}get firstAdShown(){return this.b3}get inImpression(){return this.Qk}get adInWin(){return this.qc.isAdInWin(n.k.LINEAR)}get inAdPodLoadingState(){return this.M3}get onFullcreenChange(){return this.B3.asObservable()}start(t,i){try{this.O3(i),this.F3(),this.setVolume(t),this.Gc()}catch(t){const{message:i,stack:e}=(0,mt.W$)(t);(0,ft.FH)({callStack:e,level:"Critical",exception:i,message:"linearAdhandler_start",sessionId:this.$r.sessionId})}}updateFloatingState(t){this.C3=t}getVolume(){return this._3}increaseVolume(t,i=!1){if(i&&this.V3(D.Z.VOLUME_CLICK),this._3+t>1)return void this.setVolume(1);const e=this._3+t;this.setVolume(e)}decreaseVolume(t,i=!1){if(i&&this.V3(D.Z.VOLUME_CLICK),this.getVolume()-t<0)return void this.setVolume(0);const e=this.getVolume()-t;this.setVolume(e)}toggleMute(t=!1){if(t&&this.V3(0===this._3?D.Z.UNMUTE_CLICK:D.Z.MUTE_CLICK),0===this._3)return this.fH=this.fH>0?this.fH:.2,void this.setVolume(this.fH);this.fH=this._3,this.setVolume(0)}hide(){var t;(0,U.IV)(this.aT,"cnx-in-ad","cnx-in-ad-overlay");const i=this.aT.parentElement;i&&(0,U.IV)(i,"cnx-in-ad-container"),null===(t=this.R3)||void 0===t||t.hide(),this.cs.adBreakEnd.next()}show(){var t,i;const e=["cnx-in-ad"],s=null===(i=null===(t=this.qc)||void 0===t?void 0:t.getCurrentAdMetadata(n.k.LINEAR))||void 0===i?void 0:i.adType;s===r.Z9.VIDEO_OVERLAY&&e.push("cnx-in-ad-overlay"),this.N3=s,(0,U.cn)(this.aT,...e);const h=this.aT.parentElement;h&&(0,U.cn)(h,"cnx-in-ad-container"),this.R3.show(),this.R3.updateVolume(this._3),this.U3(),this.cs.adBreakStart.next({adSkippableInSeconds:this.W3?this.$r.skipAdAfter:0,isLinear:!0})}setVolume(t){this._3=t,this.qc.setAdVolume(n.k.LINEAR,t),this.R3&&this.R3.updateVolume(t),this.L3.next({type:q.C.Volume,payload:{volume:t}})}resizeAd(t,i){this.inImpression&&(this.updateContinueReadingCard(),this.j3())}adStateChange(t,i){this.qc.onAdStateChange(n.k.LINEAR,t,i)}getMainAdContainerWidth(){return this.qc.getMainAdContainerWidth(n.k.LINEAR)}resumeWithoutUserInteraction(){this.inImpression&&this.qc.resumeAd(n.k.LINEAR,!1)}play(){if(!this.inImpression)return;this.qc.resumeAd(n.k.LINEAR,!0),this.T3.next({type:"userInteraction",payload:{playback:!0}}),this.va=!0}updateContinueReadingCard(){const t=this.qc.getCurrentAdMediaSize(n.k.LINEAR);(0,W.$K)(t)&&(this.q3(t)?this.R3.showContinueReadingCard(this._P):this.R3.hideContinueReadingCard(this._P))}setContinueReadingCard(t){this.R3.setContinueReadingCard({imageSrc:lt.Q.getSmartCroppedImageUrl(t.imageSrc,270,150,this.Lg,!0),title:t.title})}hideContinueReadingCard(){this.R3.hideContinueReadingCard(this._P)}setAdMarkerTitle(t){this.R3.addAdMarkerTitle(t),this.S3=!0,this.aT.clientWidth>=320&&this.R3.showAdMarkerTitle()}hideAdMarkerTitle(){this.R3.hideAdMarkerTitle()}pause(){if(!this.inImpression)return;this.qc.pauseAd(n.k.LINEAR,!0),this.T3.next({type:"userInteraction",payload:{playback:!1}}),this.va=!1}togglePlay(t=!1){t&&this.V3(this.va?D.Z.PAUSE_CLICK:D.Z.PLAY_CLICK),this.va?this.pause():this.play()}stopAd(t){const i=()=>{this.Dv.next({type:ct.f.AdStopped,payload:{payload:{adType:r.Z9.VIDEO_VIDEO}}});const i="forceStopAdSlot"===t;this.G$.next({type:"hideLinearEvent",forced:i}),this.w3=!1};this.qc?(i(),this.qc.stopAd(n.k.LINEAR,t)):this.inAdPodLoadingState&&i()}enterAdPodLoadingState(){this.M3=!0;const{width:t,height:i}=this.qc.getAdContainerSize(this.N3);this.R3.showAdLoadingScreen(lt.Q.getSmartCroppedImageUrl(this.H3,t,i,this.Lg),this.z3,this.nT.getNextSlotIndex(),this.nT.getTotalNumberOfSlots())}setAdLoadingBackgroundUrl(t){this.H3=t}destroy(){var t,i;(0,o.i)(this.Li),null===(t=this.mp.services.ViewabilityService)||void 0===t||t.off(this.aT,this._g),null===(i=this.R3)||void 0===i||i.destroy()}Gc(){this.Li.push(this.G3(),this.J3())}Y3(t){switch(t.type){case ct.f.AdPaused:this.G$.next({type:"pauseLinearEvent"});break;case ct.f.AdPlaying:this.G$.next({type:"resumeLinearEvent"});break;case ct.f.AdImpression:this.G$.next({type:"showLinearEvent",payload:t.payload});break;case ct.f.AdSkipped:this.G$.next({type:"skipLinearEvent"});break;case ct.f.AdStopped:this.G$.next({type:"hideLinearEvent"});break;case ct.f.AdError:this.inImpression&&this.G$.next({type:"hideLinearEvent"})}}X3(t){var i;this.Q3(),this.updateContinueReadingCard(),t.payload.adDuration=null===(i=this.qc.getCurrentAdMetadata(n.k.LINEAR))||void 0===i?void 0:i.duration,t.payload.adDuration||this.b3||this.show(),this.b3=!0,this.Qk=!0,this.P3&&this.W3(),t.payload.adDuration?this.R3.addDurationAdMarker():this.R3.removeDurationAdMarker(),this.R3.updateDuration(t.payload.adDuration),this.R3.changeState(0),this.z3=t.payload.clickThroughUrl,this.K3(t.payload.selectedAdSlot)}O3(t){const i=function(t,i){const{logoUrl:e,closeButtonMode:s,floatingSettings:{floatingCloseButtonMode:r},isCloseButton:n,sharingDestinations:h}=t;return{logoUrl:e,isMobile:i.isMobile,closeButtonMode:s,floatingCloseButtonMode:r,isCloseButton:n,sharingDestinations:h,tooltipBackgroundColor:"#0d192d",tooltipTextColor:"#fff"}}(this.$r,this.mp.config),{services:{GlobalDomUtilsService:e,ViewabilityService:s,InteractionService:r},config:{isMobile:n}}=this.mp;this.R3=new at(e,s,r,this.aT,new ut(t).template,t,i),n&&(0,U.cn)(this.aT,"cnx-in-mobile"),this.R3.hide()}F3(){this._P=this.Z3(),this.t5(this._P),this.A3.push(this._P)}Z3(t=""){return this.mp.services.GlobalDomUtilsService.createElementByString(`<div class= "cnx-ad-container cnx-full-height ${t}"></div>`)}t5(t){this.aT.appendChild(t)}qG(){}K3(t){this.A3.filter((i=>i!==t)).forEach((t=>{(0,U.cn)(t,"cnx-mod-invisible")}))}Q3(){this.R3.hideSkipAdButton()}q3(t){if((0,gt.Ph)("cnxShowAdCard",this.mp.config.pageUrl))return!0;let i=!1;if(t.adType===r.Z9.VIDEO_VIDEO){const e=this.aT.clientWidth*(t.heightRatio/t.widthRatio);i=this.aT.clientHeight-e>=76}return t.adType===r.Z9.VIDEO_OVERLAY&&(i=this.aT.clientHeight-t.height>=76),i}i5(){this.qc&&this.inImpression?this.qc.skipAd(n.k.LINEAR):this.M3&&(this.Dv.next({type:ct.f.AdSkipped}),this.U3())}E3(){var t;null===(t=this.mp.services.ViewabilityService)||void 0===t||t.on(this.aT,(t=>this._g(t)),{threshold:dt.fJ})}D3(){const t=this.nT.onCurrentPodChange.subscribe((()=>{const t=this.nT.getTotalNumberOfSlots();if(t>1){const i=this.nT.getCurrentSlotIndex();i>=t&&(0,ft.FH)({level:"Warn",exception:JSON.stringify({currentSlot:i,totalNumberOfSlots:t}),message:"AdHandler_Ad_Pod_Overflow",sessionId:this.$r.sessionId},{pacing:10,extraLogsPercentage:100}),this.R3.addPodAdMarker(i,t)}else this.R3.removeAddPodAdMarker()}));this.Li.push(t)}G3(){return this.qc.onLinearVpaidEvent.subscribe((t=>{let i=!1;switch(t.type){case ct.f.AdLoaded:this.P3=this.e5(t.payload),this.P3&&(t.payload.payload.adLoadedData.skipOffset=this.$r.skipAdAfter);break;case ct.f.AdPaused:this.va=!1,this.R3.changeState(1);break;case ct.f.AdPlaying:this.va=!0,this.R3.changeState(0);break;case ct.f.AdImpression:this.va=!0,this.X3(t.payload);break;case ct.f.AdSkipped:this.V3(D.Z.AD_SKIP_CLICK),this.s5(),i=!0;break;case ct.f.AdStopped:case ct.f.AdError:if(this.r5())return;this.s5(),i=!0;break;case ct.f.AdClick:this.V3(D.Z.AD_CLICK);break;case ct.f.AdClickThru:this.V3(D.Z.AD_CLICK_THROUGH,t.payload.payload.clickThru)}this.w3&&(this.Dv.next(t),this.Y3(t)),this.w3=!0,i&&(this.Qk=!1,this.va=!1,this.R3.changeState(1))}))}J3(){return this.R3.onUiEvent.subscribe((t=>{switch(t.type){case q.C.Volume:this.n5(t.payload.volume),this.V3(D.Z.VOLUME_CLICK);break;case q.C.Play:this.V3(D.Z.PLAY_CLICK),this.play();break;case q.C.Pause:this.V3(D.Z.PAUSE_CLICK),this.pause();break;case q.C.Expand:this.V3(D.Z.FULL_SCREEN_CLICK),this.B3.next(q.C.Expand);break;case q.C.Collapse:this.V3(D.Z.EXIT_FULL_SCREEN_CLICK),this.B3.next(q.C.Collapse);break;case q.C.Close:{this.T3.next({type:"userInteraction",payload:{playback:!1}});const t=this.C3?D.Z.FLOATING_CLOSE_CLICK:D.Z.EMBEDDED_CLOSE_CLICK;this.V3(t),this.L3.next({type:q.C.Close});break}case q.C.Mute:this.n5(0),this.V3(D.Z.MUTE_CLICK);break;case q.C.Unmute:this.n5(1),this.V3(D.Z.UNMUTE_CLICK);break;case q.C.SkipAd:this.i5()}}))}W3(){this.R3.showSkipAdButton(this.$r.skipAdAfter)}V3(t,i){var e,s;const r=null===(e=this.qc)||void 0===e?void 0:e.getCurrentAdMetadata(n.k.LINEAR);if(!r)return;const{advertiserLineItemId:h,publisherLineItemId:o}=r,a=this.qc.getCurrentAdBreakType(),{currentMediaMetadata:{mediaId:d,insights:c,sentimentAnalysis:l},iasSegmentCodes:u,adTrackingRequestMeta:p,lineItemAbTest:v}=this.ls;this.cs.adClick.next(new D.F({type:t,publisherLineItemId:o,advertiserLineItemId:h,mediaId:d,iasSegmentCodeList:u,insightIndexList:c,sentimentAnalysis:l,lineItemAbTest:v,adRollType:a,metadata:p,pageInsightIndexList:null===(s=pt.k.pageInsights)||void 0===s?void 0:s.insights,clickUrl:i}))}e5(t){var i;const e=null===(i=this.qc)||void 0===i?void 0:i.getCurrentAdMetadata(n.k.LINEAR);if(!e)return!1;const{adSourceType:s,duration:r}=e,{skipOffset:h}=t.payload.adLoadedData;return!(0,vt.AK)(s,h)&&(0,vt.Xj)(r,this.$r)}s5(){this.A3.forEach((t=>{(0,U.IV)(t,"cnx-mod-invisible")}))}U3(){this.M3=!1,this.R3.hideAdLoadingScreen()}n5(t){this.setVolume(t),this.T3.next({type:"userInteraction",payload:{volume:!0}})}j3(){this.S3&&this.aT.clientWidth>=320?this.R3.showAdMarkerTitle():this.R3.hideAdMarkerTitle()}}var yt=e(6240);class At extends It{X3(t){super.X3(t),this.$r.outstreamAdAsContent&&this.h5()}r5(){return this.$r.outstreamAdAsContent}qG(){this.$r.isOutStreamType()||this.$r.isLiveType()||(this.yr=(0,h.TF)(this.mp.config.sessionId,yt.U),this.yr.startListeningToAdEvents(E(this.Dv,this.x3)))}h5(){this.R3.hideProgressBar(),this.R3.hideAdMarker(),this.Q3()}}const bt=20;class _t{constructor(t,i,e,r,n,h,o,a,d,c){this.$r=t,this.aT=i,this.oT=e,this.nT=r,this.mp=n,this.Lg=h,this.rT=o,this.qc=a,this.cs=d,this.ls=c,this.A3=[],this.Qk=!1,this.SF="normal",this.o5=!1,this.Li=[],this.Nq=new s.x,this.Dv=new s.x,this.T3=new s.x}get onExperienceEvent(){return this.T3.asObservable()}get onNonLinearEvent(){return this.Nq.asObservable()}get onVpaidEvent(){return this.Dv.asObservable()}get adContainer(){return this._P}get inImpression(){return this.Qk}get adInWin(){return this.qc.isAdInWin(n.k.NONLINEAR)}start(){try{this.F3(),this.Gc()}catch(t){const{message:i,stack:e}=(0,mt.W$)(t);(0,ft.FH)({callStack:e,level:"Critical",exception:i,message:"nonLinearAdhandler_start",sessionId:this.$r.sessionId})}}hide(){(0,U.IV)(this.aT,"cnx-in-ad-non-linear"),this.cs.adBreakEnd.next()}show(){(0,U.cn)(this.aT,"cnx-in-ad-non-linear"),this.cs.adBreakStart.next({adSkippableInSeconds:0,isLinear:!1})}adStateChange(t,i){this.inImpression&&(t===r.It.PRE_ROLL_SLOT||t===r.It.POST_ROLL_SLOT?this.pause():this.resumeWithoutUserInteraction(t),this.qc.onAdStateChange(n.k.NONLINEAR,t,i))}contentPlaybackStateChanged(t){this.o5=t,this.o5||this.pause()}resizeAd(t,i,e){this.inImpression&&this.o5&&(this.a5()?this.pause():this.resumeWithoutUserInteraction(e))}resumeWithoutUserInteraction(t){this.inImpression&&t!==r.It.PRE_ROLL_SLOT&&t!==r.It.POST_ROLL_SLOT&&(this.a5()||(this.show(),this.qc.resumeAd(n.k.NONLINEAR,!1)))}pause(){if(!this.inImpression)return;this.hide();this.qc.pauseAd(n.k.NONLINEAR,!0),this.T3.next({type:"userInteraction",payload:{playback:!1}})}stopAd(t){if(!this.inImpression)return;const i=()=>{this.Dv.next({type:ct.f.AdStopped,payload:{payload:{adType:r.Z9.VIDEO_NON_LINEAR}}}),this.Nq.next({type:"hideNonLinearEvent"})};this.qc&&(i(),this.qc.stopAd(n.k.NONLINEAR,t))}destroy(){(0,o.i)(this.Li)}Gc(){this.Li.push(this.qc.onNonlinearVpaidEvent.subscribe((t=>{switch(t.type){case ct.f.AdImpression:this.X3(t.payload);break;case ct.f.AdUserClose:this.V3(D.Z.AD_USER_CLOSE);break;case ct.f.AdError:this.s5();break;case ct.f.AdClickThru:this.V3(D.Z.AD_CLICK_THROUGH,t.payload.payload.clickThru)}this.Dv.next(t),this.d5(t)})))}d5(t){switch(t.type){case ct.f.AdImpression:this.show(),this.Nq.next({type:"showNonLinearEvent",payload:t.payload});break;case ct.f.AdUserClose:this.hide();break;case ct.f.AdStopped:this.hide(),this.Nq.next({type:"hideNonLinearEvent"});break;case ct.f.AdError:this.inImpression&&this.Nq.next({type:"hideNonLinearEvent"})}}X3(t){this.Qk=!0,this.K3(t.payload.selectedAdSlot)}F3(){this._P=this.Z3(),this.t5(this._P),this.A3.push(this._P)}Z3(t=""){return this.mp.services.GlobalDomUtilsService.createElementByString(`<div class= "cnx-non-linear-ad-container cnx-full-height ${t}"></div>`)}t5(t){this.aT.appendChild(t)}K3(t){this.A3.filter((i=>i!==t)).forEach((t=>{(0,U.cn)(t,"cnx-mod-hide")}))}V3(t,i){var e,s;const r=null===(e=this.qc)||void 0===e?void 0:e.getCurrentAdMetadata(n.k.NONLINEAR);if(!r)return;const{advertiserLineItemId:h,publisherLineItemId:o}=r,a=this.qc.getCurrentAdBreakType(),{currentMediaMetadata:{mediaId:d,insights:c,sentimentAnalysis:l},iasSegmentCodes:u,adTrackingRequestMeta:p,lineItemAbTest:v}=this.ls;this.cs.adClick.next(new D.F({type:t,publisherLineItemId:o,advertiserLineItemId:h,mediaId:d,iasSegmentCodeList:u,insightIndexList:c,sentimentAnalysis:l,lineItemAbTest:v,adRollType:a,metadata:p,pageInsightIndexList:null===(s=pt.k.pageInsights)||void 0===s?void 0:s.insights,clickUrl:i}))}s5(){this.A3.forEach((t=>{(0,U.IV)(t,"cnx-mod-hide")}))}a5(){var t;const i=null===(t=this.qc.getCurrentAdMediaSize(n.k.NONLINEAR))||void 0===t?void 0:t.height;if(!(0,W.r)(i))return!0;const e=this.adContainer.clientHeight,s=(0,nt.Tc)(e,bt);return Math.ceil(s)<i}}class xt extends _t{}var St=e(8671),wt=e(6213);const kt=(0,wt.A)({IDLE:0,LOADING:1,CONSUMED_LOADING:2,LOADED:3,STARTING:4,IMPRESSION:5,CONSUMED_LOADED:6,INVALIDATED:7});class Pt{constructor(){this.requestNumber=0}}var Mt=e(9404),Ct=e(2693),Lt=e(3677);function Tt(t){return t.every((t=>0!==t.priceOutcome))}function Bt(t,i){(0,ft.FH)({level:"Error",message:`DynamicPricing_algo_error_${t}`,exception:i.message},{pacing:5,throttle:1,shouldSendMaxLog:!1})}function Et(t){const i=t.findIndex((t=>t.isStartingPricePoint));if(-1!==i)return i;const e=(0,h.AU)(Lt.n).getUserWinningPrices();if(!e)return t[0].isStartingPricePoint=!0,0;if(!Object.keys(e.adv).some((t=>(0,Ct.o)(t))))return t[0].isStartingPricePoint=!0,0;const s=Math.max(...e.adv[Mt.Ro]),r=(0,nt.GD)(t.map((t=>t.price)),s);return t[r].isStartingPricePoint=!0,r}function Dt(t){const i=t.find((t=>0===t.priceOutcome));if((0,W.$K)(i))return{price:i.price,index:t.indexOf(i)};const e=t.length-1;return{price:t[e].price,index:e}}function Rt(t,i,e){t.adxFloorPrices&&t.adxFloorPrice&&e&&t.updatePriceStatus(e,i),2!==i&&3!==i||function(t){if(!t.adxFloorPrices)return;(Tt(t.adxFloorPrices)||t.adxFloorPrices.some((t=>2===t.priceOutcome)))&&(t.resetAllAdxPricesStatus(),t.resetPrice())}(t)}function Ot(t,i){try{if(!(0,ot.BZ)(t))return null;switch(i){case"elevator":return function(t){if(!(0,ot.BZ)(t))return null;const i=t.find((t=>2===t.priceOutcome));if((0,W.$K)(i))return{price:i.price,index:t.indexOf(i)};const e=t.find((t=>0===t.priceOutcome));if((0,W.$K)(e))return{price:e.price,index:t.indexOf(e)};const s=t.length-1;return{price:t[s].price,index:s}}(t);case"reset":return Dt(t);case"adxReset":return function(t){const i=Et(t);if(0===t[i].priceOutcome)return{price:t[i].price,index:i};const e=t.slice(i+1).find((t=>0===t.priceOutcome));if((0,W.$K)(e))return{price:e.price,index:t.indexOf(e)};const s=t.length-1;return{price:t[s].price,index:s}}(t);case"binarySearch":return function(t){if(3!==t[0].priceOutcome)return{price:t[0].price,index:0};let i=1,e=t.length-1,s=Math.floor((i+e)/2);for(;i<=e;){if(0===t[s].priceOutcome||1===t[s].priceOutcome)return{price:t[s].price,index:s};3===t[s].priceOutcome&&(i=s+1),2===t[s].priceOutcome&&(e=s-1),s=Math.floor((i+e)/2)}return{price:t[i].price,index:i}}(t);case"adxBinarySearch":return function(t){const i=Et(t);if(0===t[i].priceOutcome||1===t[i].priceOutcome)return{price:t[i].price,index:i};let e=3===t[i].priceOutcome?i+1:0,s=3===t[i].priceOutcome?t.length-1:i-1,r=Math.floor((e+s)/2);for(;e<=s;){if(0===t[r].priceOutcome||1===t[r].priceOutcome)return{price:t[r].price,index:r};3===t[r].priceOutcome&&(e=r+1),2===t[r].priceOutcome&&(s=r-1),r=Math.floor((e+s)/2)}if(e===t.length){const i=t.length-1;return{price:t[i].price,index:i}}return{price:t[e].price,index:e}}(t);default:return Bt(i,new Error("Invalid algo at get")),Dt(t)}}catch(t){return Bt(i,(0,mt.W$)(t)),null}}function Ft(t,i,e){const s=t.protoLineItem.dynamicPricingAlgorithm;if((0,W.QM)(s))try{switch(s){case"elevator":case"binarySearch":case"adxBinarySearch":!function(t,i,e){t.adxFloorPrices&&t.adxFloorPrice&&e&&t.updatePriceStatus(e,i)}(t,i,e);break;case"reset":case"adxReset":Rt(t,i,e);break;default:Bt(s,new Error("Invalid algo at update")),Rt(t,i,e)}}catch(t){Bt(s,(0,mt.W$)(t))}}class Vt{constructor(t){this.Vc=t,this.td=new Map}incrementAndCheck(t){if(t.index!==this.Vc.adxFloorPricesLength-1&&0!==t.index)return;const i=(this.td.get(t.index)||0)+1;this.td.set(t.index,i),i>=3&&this.ed(t)}ed(t){const{lineItemId:i,algo:e}=this.Vc;(0,ft.FH)({message:`P:${t.price};${0===t.index?"U":"L"}`,exception:`A: ${e}`,callStack:"AlgoExtremityCounter",level:"Info",sessionId:`lineitemid: ${i}`},{pacing:5,throttle:1,shouldSendMaxLog:!1})}}function $t(t,i,e){try{if(!i||!(0,ot.BZ)(e))return!1;const s=.5,r=e.length>1?Math.floor(e.length*s):1,n=[...e].sort(((t,i)=>t-i)),h=Object.keys(i.adv).some((t=>(0,Ct.o)(t)))?i.adv[Mt.Ro]:function(t){return Object.values(t.adv).flat()}(i),o=h.map((t=>n.map((i=>Math.abs(t-i))))).map((t=>n[t.indexOf(Math.min(...t))])),a=(0,ot.RY)(o);return(0,ot.T7)(a).slice(0,r).includes(t)}catch(t){const{message:i}=(0,mt.W$)(t);return(0,ft.FH)({level:"Error",message:"YoScoreCalculatorUtils_shouldPrioritizeAdx",exception:i},{pacing:1,throttle:1,shouldSendMaxLog:!1}),!1}}function Nt(t){const{priority:i,shouldUseNetCPM:e}=t,s=e?function(t){const{cpm:i,discount:e,fixedInfraCpmFee:s,infrastructureFeeCustomer:n,infrastructureFee:h,openMarketRevSharePercentage:o,pmpRevSharePercentage:a,isPrivateMarket:d,isPublisherLineItem:c,servingFeeCpmCustomer:l,servingFeeRevShareCustomer:u,servingFeeTypeCustomer:p,creativeType:v}=t;let m=i-i*((0,W.r)(null==e?void 0:e.rate)?e.rate/100:0);if(c)m-=m*((0,W.r)(h)?h/100:0),p===St.Pl.SERVING_FIXED_CPM?m-=null!=l?l:0:p===St.Pl.REV_SHARE&&(v===r.H6.THIRD_PARTY||v===r.H6.MEDIA_FILE?m-=null!=l?l:0:m-=m*((0,W.r)(u)?u/100:0));else{m-=null!=s?s:0,m-=m*((0,W.r)(h)?h/100:0),m-=m*((0,W.r)(n)?n/100:0);const t=d?a:o;m-=m*((0,W.r)(t)?t/100:0)}return m}(t):function(t){const{cpm:i,grossNetPercentageDifference:e}=t;return i-e/100*i}(t);return s+200*i}const Ut={1:t=>t.creativeType===r.H6.RTB,2:t=>t.creativeType===r.H6.HEADER_BIDDER,3:t=>[r.H6.TAM,r.H6.TAM_DEAL,r.H6.TAM_PRIVATE_AUCTION].includes(t.creativeType),4:t=>Boolean(t.isAdxAccount)&&!t.isAdxLookup&&(0,ot.BZ)(t.adxFloorPricePredictionList)};function Wt(t){const i=Object.keys(Ut).find((i=>(0,Ut[i])(t)));return(0,W.$K)(i)?Number(i):void 0}var jt=e(7415),qt=e(5008);function Ht(t){return t.isPmp}const zt={[qt.cZ.PMP]:t=>Ht(t),[qt.cZ.OPEN_MARKET]:t=>function(t){const{advertiserLineItemId:i,publisherLineItemId:e}=t;return!Ht(t)&&i!==e}(t),[qt.cZ.SELF_SERVED]:t=>function(t){const{advertiserLineItemId:i,publisherLineItemId:e}=t;return!Ht(t)&&i===e}(t)};function Gt(t){const i=Object.keys(zt).find((i=>(0,zt[i])(t.settings.adManagerLineItem.protoLineItem)));if(!(0,W.$K)(i))return qt.cZ.DEMAND_TYPE_UNSPECIFIED;const e=Number.parseInt(i,10);return qt.cZ[qt.cZ[e]]}function Jt(t,i){return t.find((t=>t.adManagerLineItem.protoLineItem.advertiserLineItemId===i)).adManagerLineItem}const Yt=({playerSkippability:t,playerSkipMin:i,playerSkipAfter:e,lineItemSkippability:s,lineItemSkipMin:n})=>{let h={skippable:!0,skipafter:e};switch(t){case St._n.ALLOW_NON_SKIP_ADS_IF_THEY_ARE_SHORTER_THAN:h=function({skippabitySettings:t,playerSkipMin:i,lineItemSkippability:e,lineItemSkipMin:s}){e===r.rr.REQUIRE_PUBLISHER_TO_ALLOW_NON_SKIPPABLE_ADS_SHORTER_THAN?s<i?t.skipmin=i:(t.skipmin=s,t.minDuration=s):t.skipmin=i;return t}({skippabitySettings:h,playerSkipMin:i,lineItemSkippability:s,lineItemSkipMin:n});break;case St._n.REQUIRE_ADS_TO_BE_SKIPPABLE:s===r.rr.REQUIRE_PUBLISHER_TO_ALLOW_NON_SKIPPABLE_ADS_SHORTER_THAN&&(h.skipmin=n,h.minDuration=n)}return h};function Xt(t,i){return t===r.Z9.VIDEO_NON_LINEAR&&i===jt.n.BANNER}function Qt(t,i){return{adTag:(0,W.$K)(t.url)?t.url:i.adTag,requestCap:(0,W.$K)(t.contentRequestCap)?t.contentRequestCap:i.requestCap,impressionCap:(0,W.$K)(t.contentImpressionCap)?t.contentImpressionCap:i.impressionCap,resetRequestCapTimeSeconds:(0,W.$K)(t.resetRequestsCapTime)?t.resetRequestsCapTime:i.resetRequestCapTimeSeconds,resetImpressionCapTimeSeconds:(0,W.$K)(t.resetImpressionsCapTime)?t.resetImpressionsCapTime:i.resetImpressionCapTimeSeconds,resetCapType:(0,W.$K)(t.resetCapType)?t.resetCapType:i.resetCapType,externalVastXml:t.vastXml}}var Kt=e(5694),Zt=e(4159);class ti{constructor(t,i,e,s,r=!1){this.sd=t,this.rd=i,this.nd=e,this.ll=r,this.yoScore=0,this.priceBasedYoScore=0,this.historicalMetrics=new Pt,this.bidsInFetch=new Set,this.aggregators=new Set,this.od=!1,this.hasAggregator=(0,W.$K)(Wt(t)),this.hd=this.dd(),this.resetPrice(s)}get isRTB(){return this.sd.creativeType===r.H6.RTB}get timeBetweenRequests(){return this.hasAggregator?this.sd.creativeType===r.H6.RTB&&this.sd.timeBetweenRequestsSeconds||10:6}get protoLineItem(){return this.sd}get adxFloorPrice(){return this.ld}get adxFloorPrices(){return this.hd}get timeBetweenRequestsIdentifier(){return(0,W.$K)(this.ld)?this.ld.id:this.sd.advertiserLineItemId}get didBid(){return this.od}updateMetadata(t){const i=Qt(t,this.sd);this.sd=(0,Kt.R)(this.sd,i)}updatePriceStatus(t,i){const e=this.getAdxFloorPriceObjectsByPrice(t);(0,ot.BZ)(e)&&(e.forEach((t=>{t.priceOutcome=i})),this.resetPrice())}resetAllAdxPricesStatus(){this.hd&&this.hd.forEach((t=>{t.priceOutcome=0}))}resetPrice(t){this.ud(t)}getAdxFloorPriceObjectsByPrice(t){var i;return(null===(i=this.hd)||void 0===i?void 0:i.filter((i=>i.price===t)))||[]}registerBid(){this.od=!0}pd(){var t;const{floorPrice:i,customCpm:e,dynamicPricingAlgorithm:s}=this.sd;if((0,W.r)(i))return i;if((0,W.r)(e))return e;if((0,W.$K)(this.hd)){const i=Ot(this.hd,s);if(i)return null===(t=this.md)||void 0===t||t.incrementAndCheck(i),this.ld=this.hd[i.index],i.price}return 0}ud(t){const i=this.pd(),{grossNetPercentageDifference:e,lineItemPriority:s,rpmExploration:n,isAdxAccount:o,isAdxLookup:a,infrastructureFee:d,fixedInfraCpmFee:c,isDeal:l,publisherLineItemId:u,advertiserLineItemId:p,creativeMarketType:v,creativeType:m}=this.sd,{infrastructureFeeCustomer:g,servingFeeTypeCustomer:f,servingFeeCpmCustomer:I,servingFeeRevShareCustomer:y}=this.nd,{openMarketRevSharePercentage:A,pmpRevSharePercentage:b}=this.rd,_={cpm:i,priority:s,grossNetPercentageDifference:e,rpmScore:n,isAdxNonLookup:o&&!a,adxPrices:t,shouldUseNetCPM:this.ll,infrastructureFee:d,openMarketRevSharePercentage:A,pmpRevSharePercentage:b,fixedInfraCpmFee:c,isDeal:l,isPublisherLineItem:u===p,isPrivateMarket:v===r.ao.PMP,infrastructureFeeCustomer:g,servingFeeTypeCustomer:f,servingFeeCpmCustomer:I,servingFeeRevShareCustomer:y,creativeType:m};this.yoScore=function(t,i){if(i)return Math.random();const e=(0,h.AU)(Lt.n).getUserWinningPrices(),{rpmScore:s,priority:r,cpm:n,adxPrices:o,isAdxNonLookup:a}=t;return 1e6*r+s+(a&&$t(n,e,o)?100:0)+n/1e6}(_,this.hasAggregator),this.priceBasedYoScore=function(t,i){return i?Math.random():Nt(t)}(_,this.hasAggregator)}dd(){if(!this.protoLineItem.adxFloorPricePredictionList||!(0,ot.BZ)(this.protoLineItem.adxFloorPricePredictionList))return;if(this.protoLineItem.isAdxLookup)return;const t=this.protoLineItem.adxFloorPricePredictionList.slice(-9).map(((t,i)=>({price:(0,Zt.R)(t.floorPriceObfuscated),priceOutcome:0,adxData:t,id:`${this.protoLineItem.advertiserLineItemId}${t.floorPriceObfuscated}`,index:i}))).sort(((t,i)=>i.price-t.price));return"reset"!==this.sd.dynamicPricingAlgorithm&&(this.md=new Vt({lineItemId:this.protoLineItem.advertiserLineItemId,algo:this.protoLineItem.dynamicPricingAlgorithm,adxFloorPricesLength:t.length})),t}}const ii="uncategorized";class ei{resetCapsBasedOnExternalEvent(t){const i=this.vd.keys();for(const e of i)this.gd(e,t)&&this.fd(e,ii)}resetCapsOnLineItemMetadataUpdate(t){this.fd(t,ii)}gd(t,i){return t.protoLineItem.resetCapType===i}Id(t){return this.gd(t,r.yX.TIME_CAPPING)&&this.Ad(t)>0}}class si{constructor(t){this.yd=t,this._d=new Map}setNumberOfImpressions({value:t,categoryId:i}){(0,W.$K)(i)&&this.yd===r.yX.OPPORTUNITY_CAPPING||(i=ii),this._d.set(i,t)}getNumberOfImpressions({categoryId:t}){return(0,W.$K)(t)&&this.yd===r.yX.OPPORTUNITY_CAPPING||(t=ii),this._d.get(t)||0}}var ri=e(6468);class ni extends ei{constructor(t=Date.now()){super(),this.bd=t,this.vd=new Map}canCall(t,i){this.Sd(t);const e=this.vd.get(t);return void 0===e||(0===t.protoLineItem.impressionCap||e.getNumberOfImpressions({categoryId:i})<t.protoLineItem.impressionCap)}registerImpressionForLineItem(t,i){let e=this.vd.get(t);return void 0===e&&(this.vd.set(t,new si(t.protoLineItem.resetCapType)),e=this.vd.get(t),this.Id(t)&&(e.nextImpressionCapResetTimestamp=this.wd(this.Ad(t)))),e.setNumberOfImpressions({value:e.getNumberOfImpressions({categoryId:i})+1,categoryId:i}),this}registerRequestForLineItem(t,i){return this}registerUnfulfilledRequest(t,i){return this}destroy(){this.vd.clear()}fd(t,i){var e;null===(e=this.vd.get(t))||void 0===e||e.setNumberOfImpressions({value:0,categoryId:i})}Ad(t){return t.protoLineItem.resetImpressionCapTimeSeconds*ri.s_}Sd(t,i=Date.now()){if(!this.Id(t))return;const e=this.vd.get(t);void 0!==e&&this.Pd(t,i)&&(e.setNumberOfImpressions({value:0}),e.nextImpressionCapResetTimestamp=this.wd(this.Ad(t),i))}Pd(t,i){return i>=this.vd.get(t).nextImpressionCapResetTimestamp}wd(t,i=Date.now()){const e=Math.ceil((i-this.bd)/t)*t;return this.bd+e}}class hi{constructor(t){this.yd=t,this.Md=new Map}setNumberOfRequests({value:t,categoryId:i}){(0,W.$K)(i)&&this.yd===r.yX.OPPORTUNITY_CAPPING||(i=ii),this.Md.set(i,t)}getNumberOfRequests({categoryId:t}){return(0,W.$K)(t)&&this.yd===r.yX.OPPORTUNITY_CAPPING||(t=ii),this.Md.get(t)||0}}class oi extends ei{constructor(t=Date.now()){super(),this.bd=t,this.allowResetOnTime=!0,this.vd=new Map}canCall(t,i){this.Sd(t);const e=this.vd.get(t);return void 0===e||(0===t.protoLineItem.requestCap||e.getNumberOfRequests({categoryId:i})<t.protoLineItem.requestCap)}registerRequestForLineItem(t,i,e=Date.now()){let s=this.vd.get(t);return void 0===s&&(this.vd.set(t,new hi(t.protoLineItem.resetCapType)),s=this.vd.get(t),this.Id(t)&&(s.nextRequestCapResetTimestamp=this.wd(this.Ad(t)))),s.setNumberOfRequests({value:s.getNumberOfRequests({categoryId:i})+1,categoryId:i}),this}registerImpressionForLineItem(t){return this}registerUnfulfilledRequest(t,i){return this}getAvailableRequestsForLineItem(t,i){const e=this.vd.get(t);return void 0===e?t.protoLineItem.requestCap:t.protoLineItem.requestCap-e.getNumberOfRequests({categoryId:i})}restoreOneCapForLineItem(t,i){if(t.protoLineItem.shouldIgnoreFilledRequests){const e=this.vd.get(t);if(void 0===e)return;const s=e.getNumberOfRequests({categoryId:i});s>0&&e.setNumberOfRequests({value:s-1,categoryId:i})}}destroy(){this.vd.clear()}fd(t,i){var e;null===(e=this.vd.get(t))||void 0===e||e.setNumberOfRequests({value:0,categoryId:i})}Ad(t){return t.protoLineItem.resetRequestCapTimeSeconds*ri.s_}Sd(t,i=Date.now()){if(!this.Id(t))return;const e=this.vd.get(t);void 0!==e&&this.Pd(t,i)&&(e.setNumberOfRequests({value:0}),e.nextRequestCapResetTimestamp=this.wd(this.Ad(t),i))}Pd(t,i){return i>=this.vd.get(t).nextRequestCapResetTimestamp&&this.allowResetOnTime}wd(t,i=Date.now()){const e=Math.ceil((i-this.bd)/t)*t;return this.bd+e}}class ai{constructor(){this.vd=new Map}registerRequestForLineItem(t,i){return this.kd(t,i),this}registerImpressionForLineItem(t,i){return this}registerUnfulfilledRequest(t,i){return this.kd(t,i),this}canCall(t,i,e=Date.now()){if(t.isRTB)return!0;const s=this.vd.get(t.timeBetweenRequestsIdentifier);if(void 0===s||void 0===s.lastRequestTimestamp)return!0;if(0===t.timeBetweenRequests)return!0;if(e>=s.lastRequestTimestamp+t.timeBetweenRequests*ri.s_)return!0;return!(s.categoryId===i||t.protoLineItem.resetCapType!==r.yX.OPPORTUNITY_CAPPING)}destroy(){this.vd.clear()}kd(t,i){let e=this.vd.get(t.timeBetweenRequestsIdentifier);void 0===e&&(e={},this.vd.set(t.timeBetweenRequestsIdentifier,e)),e.lastRequestTimestamp=Date.now(),e.categoryId=i}}var di=e(701),ci=e(6418),li=e(4318);const ui={1:10,2:0,3:0,4:0};class pi{constructor(){this.vd=new Map}registerRequestForAggregator(t,i){return this.kd(t,i),this}registerRequestForLineItem(t,i){return this}registerImpressionForLineItem(t,i){return this}registerUnfulfilledRequest(t,i){return this}canCall(t,i,e=Date.now()){const s=Wt(t.protoLineItem);if(t.hasAggregator&&s&&ui[s]){const t=this.vd.get(s);if(!t||!t.lastRequestTimestamp)return!0;const r=e>=t.lastRequestTimestamp+ui[s]*ri.s_,n=t.categoryId!==i;return!(!r&&!n)}return!0}destroy(){this.vd.clear()}kd(t,i){if(ui[t]){let e=this.vd.get(t);if(e){this.xd(e,i);const s=Object.assign(Object.assign({},e),{lastRequestTimestamp:Date.now(),categoryId:i});this.vd.set(t,s)}else e={},this.vd.set(t,{lastRequestTimestamp:Date.now(),categoryId:i})}}xd(t,i,e=Date.now()){const s=(e-(t.lastRequestTimestamp||0))/ri.s_,r=t.categoryId===i?"seconds_between_rtb_requests_same_opportunity_distribution":"seconds_between_rtb_requests_different_opportunities_distribution";(0,li.q)([{name:r,value:Math.round(s),tagList:[`bundleAbPart: ${ci.ABService.part}`],type:di.t.DISTRIBUTION}])}}class vi{constructor(){this.Ld=[]}canCall(t,i){return this.Ld.every((e=>e.canCall(t,i)))}registerRequestForAggregator(t,i){return this.Ld.forEach((e=>{e.registerRequestForAggregator&&e.registerRequestForAggregator(t,i)})),this}registerRequestForLineItem(t,i){return this.Ld.forEach((e=>{e.registerRequestForLineItem(t,i)})),this}registerImpressionForLineItem(t,i){return this.Ld.forEach((e=>{e.registerImpressionForLineItem(t,i)})),this}registerUnfulfilledRequest(t,i){return this.Ld.forEach((e=>{e.registerUnfulfilledRequest(t,i)})),this}registerCallingValidator(t){return this.Ld.push(t),this}registerCallingValidators(t){return t.forEach((t=>{this.registerCallingValidator(t)})),this}destroy(){this.Ld.forEach((t=>{t.destroy()}))}}class mi{constructor(){this.Cd=Date.now(),this.Td={advertiser:{}}}addPrebid(t){(0,W.$K)(this.Td.advertiser[t])||this.Bd(t),this.Td.advertiser[t].prebidData.push({timestamp:Date.now()})}addBid(t,i){(0,W.$K)(this.Td.advertiser[t])||this.Bd(t),this.Td.advertiser[t].bidsFloorPriceList.push({timestamp:Date.now(),floorPrice:i})}addImpression(t,i){(0,W.$K)(this.Td.advertiser[t])||this.Bd(t),this.Td.advertiser[t].impressionRevenueList.push({timestamp:Date.now(),obfuscatedPrice:i})}shouldRequestLineItem(t){const i=Date.now();return!(this.Dd(i,3)&&this.Rd(t,i,5)<-.5&&this.Od(t,i,3)>=11.5&&this.Fd(t,i,10,.1)<.35)}Dd(t,i){return t-this.Cd>=i*ri.uD}Rd(t,i,e){const s=this.Td.advertiser[t];if(!(0,W.$K)(s))return-1;const r=this.Vd(s.impressionRevenueList,i,e).map((t=>t.obfuscatedPrice));let n=0;return(0,ot.BZ)(r)&&(n=r.reduce(((t,i)=>t+(0,Zt.R)(i)))),this.Nd(n)}Od(t,i,e){const s=this.Td.advertiser[t];if(!(0,W.$K)(s))return-1;const r=this.Vd(s.prebidData,i,e).length;return this.Nd(r)}Fd(t,i,e,s){const r=this.Td.advertiser[t];if(!(0,W.$K)(r))return-1;const n=this.Vd(r.impressionRevenueList,i,e).map((t=>t.floorPrice)),h=this.Ud(n,s);return this.Nd(h)}Vd(t,i,e){const s=i-ri.s_,r=i-e*ri.uD,n=[];for(let i=t.length-1;i>=0&&t[i].timestamp>=r;i--)t[i].timestamp<=s&&n.push(t[i]);return n}Nd(t){return 0===t?-1:t}Bd(t){this.Td.advertiser[t]={prebidData:[],bidsFloorPriceList:[],impressionRevenueList:[]}}Ud(t,i){if(0===t.length)return 0;if(i<=0)return t[0];if(i>=1)return t[t.length-1];const e=((t=t.sort(((t,i)=>t-i))).length-1)*i,s=Math.floor(e),r=s+1,n=e%1;return r>=t.length?t[s]:t[s]*(1-n)+t[r]*n}}const gi=(t,i)=>({[St.Fx.AUTOPLAY]:i!==St.zj.MUTE?1:2,[St.Fx.CLICK_TO_PLAY]:3,[St.Fx.SCROLL_TO_PLAY]:i!==St.zj.MUTE?5:6}[t]),fi=t=>t===St.xU.IN_STREAM?1:3;function Ii(t){const i=t.replace(/\s/g,"").match(/"bidder":.+?(?=",)/);if(i)return i.toString().split('bidder":"')[1]}var yi=e(7582),Ai=e(2817),bi=e(9721),_i=e(3248);class xi{constructor(t){this.data=t,(0,W.QM)(this.data.cnxBidId)||(this.data.cnxBidId=(0,mt.qs)())}}var Si=e(2411),wi=e(9819),ki=e(2181),Pi=e(9235),Mi=e(8224);const Ci=[{w:300,h:250},{w:728,h:90},{w:320,h:50},{w:300,h:600},{w:160,h:600},{w:970,h:250},{w:300,h:50},{w:336,h:280},{w:320,h:100},{w:320,h:320},{w:300,h:300},{w:120,h:600},{w:970,h:90},{w:900,h:550},{w:320,h:480},{w:250,h:250},{w:200,h:200}],Li=[{w:450,h:50}],Ti={17:[{w:300,h:250},{w:320,h:50},{w:728,h:90},{w:300,h:600},{w:160,h:600},{w:970,h:250},{w:300,h:50},{w:320,h:100},{w:336,h:280},{w:120,h:600},{w:970,h:90},{w:320,h:480},{w:800,h:250},{w:300,h:105},{w:300,h:100},{w:750,h:300},{w:750,h:200},{w:320,h:320},{w:250,h:250},{w:300,h:300}]},Bi=.1;function Ei(t,i,e,s=2e4,r=.7,n=1){const h=Date.now(),o={cachedFloorPrice:i,timestamp:h};if(t||!(0,W.$K)(e)||i.floorPrices.length<=1)return o;const a=e.timestamp;if(function(t,i){return t>=i}(h-a,s)){const t=Object.assign({},i);return t.floorPrices=function(t,i,e,s=Bi){return t.floorPrices.map(((t,r)=>{const n=i+r*s,h=t*e,o=h<=n?n:h;return(0,mt.ox)(o)}))}(i,r,n),{cachedFloorPrice:t,timestamp:h}}return{cachedFloorPrice:i,timestamp:a}}var Di=e(5435);class Ri{constructor(){this.creativeView=[],this.start=[],this.firstQuartile=[],this.midpoint=[],this.thirdQuartile=[],this.impression=[],this.viewable_impression=[],this.complete=[],this.mute=[],this.unmute=[],this.pause=[],this.rewind=[],this.resume=[],this.fullscreen=[],this.exitFullscreen=[],this.expand=[],this.collapse=[],this.close=[],this.closeLinear=[],this.acceptInvitationLinear=[],this.acceptInvitation=[],this.skip=[],this.progress=[],this.playerExpand=[],this.playerCollapse=[],this.adExpand=[],this.adCollapse=[],this.fullScreen=[],this.canPlayThrough=[],this.stalled=[],this.waiting=[],this.otherAdInteraction=[]}}class Oi{constructor(t,i){this.ks=i,this.clickTrackings=[],this.customClicks=[],this.errorUrls=[],this.impressions=[],this.trackingEvents=new Ri,t.inLine?this.Wd(t.inLine):this.jd(t.wrapper)}Wd(t){this.zd(t.errors),this.Hd(t.impressions),this.Gd(t.creatives)}jd(t){this.zd(t.errors),this.Hd(t.impressions),this.Gd(t.creatives)}Jd(t){this.Xd(t.trackingEvents),this.Kd(t.videoClicks)}Kd(t){t&&(this.Qd(t.clickTrackings),this.Zd(t.customClicks))}Qd(t){this.clickTrackings.push(...t)}Zd(t){this.customClicks.push(...t)}Xd(t){t.forEach((t=>{try{this.trackingEvents[t.name].push(t.uri)}catch(i){const{stack:e}=(0,mt.W$)(i);(0,ft.FH)({message:"AdManager_VastResponse_tracker",exception:`${t.name}`,callStack:e,level:"Info",sessionId:this.ks})}}))}Gd(t){t.forEach((t=>{t.linear?this.Jd(t.linear):t.nonLinear&&this.Xd(t.nonLinear.trackingEvents)}))}zd(t){this.errorUrls.push(...t)}Hd(t){this.impressions.push(...t)}}const Fi={[Di.fV.IMPRESSION]:"adImpression",[Di.fV.COMPLETE_25]:"adQuartileFirst",[Di.fV.COMPLETE_50]:"adQuartileSecond",[Di.fV.COMPLETE_75]:"adQuartileThird",[Di.fV.VIEW_COMPLETION]:"adQuartileFourth",[Di.fV.VIDEO_CLICK]:"adClick",[Di.fV.PAUSE]:"adPause",[Di.fV.RESUME]:"adResume",[Di.fV.MUTE]:"adMute",[Di.fV.UNMUTE]:"adUnmute"};class Vi{constructor(){this.adError=[],this.adWin=[],this.adImpression=[],this.adViewableImpression=[],this.adStarted=[],this.adVideoStart=[],this.adQuartileFirst=[],this.adQuartileSecond=[],this.adQuartileThird=[],this.adQuartileFourth=[],this.adClick=[],this.adPause=[],this.adResume=[],this.adSkip=[],this.adMute=[],this.adUnmute=[],this.adUserClose=[],this.adUserAcceptInvitation=[],this.adUserMinimize=[]}}function $i(t,i,e,s,r,n=window.document.head,h){if(!Array.isArray(t))return;const{width:o,height:a}=s.adContainerState.get(e.adType),{adBreakType:d}=s.adBreakState,{mediaDescription:c,mediaDuration:l,mediaId:u,mediaUrl:p,mediaTitle:v}=s.media,m=s.sound?0:1;t.forEach((t=>{if(t.url)try{const s=i.replace(t.url,e.vendorId,e.advertiserLineItemId,{adMacros:{adWidth:o,adHeight:a,adPostion:d,errorCode:h,mute:m,plcmt:r},mediaMacros:{mediaDescription:c,mediaDuration:l,mediaId:u,mediaUrl:p,mediaTitle:v}});switch(t.type){case Di.$b.IMAGE:(0,mt.Hh)([s],window);break;case Di.$b.JAVASCRIPT:(0,U.dZ)({src:s},window.document.head,window);break;case Di.$b.IAS:(0,U.dZ)({src:s,attributes:[{name:"data-cnx-gc",value:""}]},n,window)}}catch(t){}}))}function Ni(t,i,e,s,r,n=900,h=window.document.head){$i(t,i,e,s,r,h,n)}function Ui(t){return{type:Di.$b.IMAGE,url:t}}function Wi(t,i){const{triggerType:e,type:s,url:r}=t;(function(t,i){return i[Fi[t]]})(e,i).push({type:s,url:r})}function ji(t,i){t.forEach((t=>Wi(t,i)))}function qi(t){return t.map((t=>Ui(t)))}function Hi(t,i,e,s=St.EZ.PROVIDER_UNSPECIFIED,r,n){const h=function(t,i){const e=new Vi;ji(i.protoLineItem.trackerList,e);const s=[...t.billingNoticeUrlList,t.adQualityCheckUrl].filter((t=>(0,W.QM)(t))).map((t=>Ui(t)));return e.adImpression.push(...s),(0,W.QM)(t.winNoticeUrl)&&e.adWin.push(Ui(t.winNoticeUrl)),e}(t,i),{requestedFloorPrice:o,isUserSynced:a,encryptedPrice:d,dspId:c,adomain:l,seatId:u,campaignId:p,cnxBidId:v,shouldLogAuctionInformation:m,auctionBidId:g,rtbRequestId:f,liveRampType:I,floorPriceInformation:y,discount:A,serverBillingNoticeUrlList:b,wasIiqLookupUsed:_,demandPartnerName:x,isMalwareScanNeeded:S,creativeId:w,width:k,height:P,vastContent:M,mime:C,obfuscatedPrice:L,bidRequestTesterApplied:T}=t;return{lineItem:i,vastTracker:h,state:e,requestMetadata:new xi({requestedFloorPrice:o,assertiveYieldFPP:n,isUserSynced:a,requestNumber:i.historicalMetrics.requestNumber,encryptedPrice:d,dspId:c,rtbAdomain:l,rtbSeatId:u,rtbCampainId:p,cnxBidId:v,requestTrackingHandledByServer:!0,shouldLogAuctionInformation:m,auctionBidId:g,rtbRequestId:f,liveRampType:I,floorPriceInformation:y,discount:A,serverBillingNoticeUrlList:b,wasIiqLookupUsed:_,identityPartnerUsed:s,demandPartnerName:x,isMalwareScanNeeded:S,identitySourceProviderList:r,wasBidRequestTesterApplied:T}),creativeId:w,dimensions:{width:k,height:P},html:M,mime:C,obfuscatedPrice:L,vastTag:M}}var zi=e(6345),Gi=e(8882),Ji=e(8598),Yi=e(6882),Xi=e(9017),Qi=e(574),Ki=e(534);function Zi(t){return i=t,e=St.Fo,Object.values(e).includes(i)?t:St.Fo.NONE;var i,e}var te=e(7715),ie=e(8341),ee=e(7018),se=e(8165);function re(t,i,e,s,r){const n=`/${t.split("-")[0]}`;let h="";return(0,W.QM)(r)&&!i?[n,s,r,(0,wt.R)(e)].filter((t=>t)).join("/"):(i&&(h=function(t){const i=new URL(function(t){return t.replace(/^https?:\/\/(?:www\.)?/,"https://")}(t)),e=i.hostname.split("."),s=i.pathname.split("/").filter((t=>t));return e.length>2?`${e[0]}/${e[1]}`:s.length>0?`${e[0]}/${s[0]}`:`${e[0]}`}(i)),[n,h,(0,wt.R)(e)].filter((t=>t)).join("/"))}const ne={[St.cr.AD_BREAK_TYPE_UNSPECIFIED]:Pi.cr.OUTSTREAM,[St.cr.PRE_ROLL]:Pi.cr.PRE_ROLL,[St.cr.MID_ROLL]:Pi.cr.MID_ROLL,[St.cr.POST_ROLL]:Pi.cr.POST_ROLL};class he{constructor(t,i,e,s,r,n,o,a){this.up=t,this.pp=i,this.mp=e,this.ls=s,this.vp=r,this.gp=n,this.fp=o,this.Ip=a,this.Ap=new Map,this.yp=new Map,this._p=!1,this.bp=!1,this.Sp=(0,h.TF)(this.mp.config.sessionId,Xi.G),this._p=this.Sp.isOmsdkFullSupport;const d=(0,h.AU)(Ki.w);this._i=d.userManagerService,this.je=(0,h.AU)(ee.H),this.bn=(0,h.TF)(this.mp.config.sessionId,"MonetizationService")}request(t){var i;return(0,yi.mG)(this,void 0,void 0,(function*(){const{width:e,height:s}=t.callingState,r=this.wp(e,s),n=yield this.Pp(t),h=null===(i=this.Ip)||void 0===i?void 0:i.cachedFloorPrice;return!r||Object.keys(n.lineItemsMap).length<=0?{bids:[],noBids:[]}:(n.isCallAssertiveYield&&(0,mt.Vm)([90,10])&&(0,ft.FH)({message:"RtbCallAggregator_request_callAssertiveYield",exception:this.ls.region,level:"Info"},{pacing:1}),this.Mp(n).then((i=>((0,W.$K)(n.liverampAtsEnvelope)&&this.je.updateLiverampEnvelopeStatus(i.liveRampEnvelopeStatus),this.xp(i,t,h)))).catch((t=>{const{message:i}=(0,mt.W$)(t);return(0,ft.FH)({message:"RtbCallAggregator",exception:i,level:"Warn",sessionId:this.mp.config.sessionId},{pacing:1}),{bids:[],noBids:[]}})))}))}xp(t,i,e){const s={bids:[],noBids:[]};return i.lineItemRequestDataList.forEach((e=>{var s;(null===(s=t.lineItemResponseList)||void 0===s?void 0:s.find((t=>t.id===e.adManagerLineItem.protoLineItem.advertiserLineItemId)))||this.gp.registerUnfulfilledRequest(e.adManagerLineItem,i.callingState.adOpportunity.id)})),t.lineItemResponseList.forEach((t=>{const r=Jt(i.lineItemRequestDataList,t.id),n=(0,ot.BZ)(t.bidList)||(0,W.r)(t.noBidsCount);if(this.Lp(t),(0,W.$K)(t.cachedFloorPrice)&&!this.Ap.has(t.id)){const i=Ei(r.didBid,t.cachedFloorPrice,this.yp.get(r.protoLineItem.advertiserLineItemId));this.yp.set(t.id,i)}n||this.gp.registerUnfulfilledRequest(r,i.callingState.adOpportunity.id),t.bidList.forEach((n=>{const h=r.protoLineItem,o=this.Cp(h);if(o&&(n=o),this.Tp(h,n))return(0,ft.FH)({level:"Warn",message:"RtbCallAggregator_nonLinear_banner_0_dimensions",exception:`lineItemId:${r.protoLineItem.advertiserLineItemId}`,sessionId:this.mp.config.sessionId},{throttle:5}),void s.noBids.push(this.Ep(r));const a=Hi(n,r,i.callingState,t.identityProvider,t.identitySourceProviderList,e);s.bids.push(a)}));const h=t.noBidsCount;for(let t=0;t<h;t++)s.noBids.push(this.Ep(r))})),(0,W.$K)(t.assertiveYield)&&!(0,W.Ft)(t.assertiveYield)&&this.fp.saveAuctionPayload(t.assertiveYield,s),s}Lp(t){var i;const e=null===(i=this.Ap.get(t.id))||void 0===i?void 0:i.prices;if(!(0,ot.BZ)(e))return;const s=t.cachedFloorPrice.floorPrices[0],r=e.filter((t=>t.price===s)),n=t.bidList.length>0;r.forEach((t=>{t.priceOutcome=n?2:3})),(n||Tt(e))&&e.forEach((t=>{t.priceOutcome=0}))}Cp(t){}Tp(t,i){var e;return Xt(t.adType,null===(e=t.nonlinearLineItemSettings)||void 0===e?void 0:e.requestType)&&(!i.height||!i.width)}Ep(t){return{lineItem:t,requestMetadata:new xi({requestNumber:t.historicalMetrics.requestNumber,partnerReason:_i.zI.REASON_UNSPECIFIED,requestTrackingHandledByServer:!0}),reason:_i.iu.NO_BID}}Dp(t,i){if(t.protoLineItem.adType!==r.Z9.VIDEO_OVERLAY)return null;const e=i.adContainerState.get(r.Z9.VIDEO_VIDEO),s=i.adContainerState.get(r.Z9.VIDEO_OVERLAY),{width:n,height:h}=s;return e.height!==h||e.width!==n?{width:n,height:h}:void 0}Rp(t,i){const e={};return this.bp=!1,t.filter((t=>this.Op(t))).forEach((t=>{const s=t.adManagerLineItem,r=this.Dp(s,i),n=this.Fp(s);this.bp=this.bp||s.protoLineItem.shouldUseAutoGeneratedGpid;let h=null;try{h=this.Vp(s)}catch(t){const{message:i}=(0,mt.W$)(t);throw(0,ft.FH)({message:"RtbCallAggregator_getFloorPrice_error",level:"Critical",exception:i},{pacing:5,throttle:1}),(0,mt.W$)(t)}const{protoLineItem:{vendorId:o,advertiserLineItemId:a,publisherLineItemId:d},historicalMetrics:{requestNumber:c}}=s,l=this._i.isConsent(o);e[a]=new Pi.kH({availableRequests:t.maxAvailableRequests,hasGdprConsent:l,cachedFloorPrice:h||void 0,publisherLineItemId:d,slotHeight:null==r?void 0:r.height,slotWidth:null==r?void 0:r.width,requestNumber:c,minDurationSeconds:n.minDuration,skipAfterSeconds:n.skipafter,skipMinSeconds:n.skipmin,skipType:n.skip})})),e}Vp(t){var i,e,s,r,n,h;const o=null===(i=this.Ip)||void 0===i?void 0:i.getFloorPriceListUsingFactors();if((0,ot.BZ)(o))return new ki._({floorPrices:o,useFirstPrices:o.length});if(t.protoLineItem.floorPricesNewModel&&(0,ot.BZ)(null===(e=t.protoLineItem.floorPricesNewModel)||void 0===e?void 0:e.priceList)){let i=[];const e=this.Ap.get(t.protoLineItem.advertiserLineItemId),h=this.je.hasUid2();if((null==e?void 0:e.hasUid2)===h)i=(null===(s=this.Ap.get(t.protoLineItem.advertiserLineItemId))||void 0===s?void 0:s.prices)||[];else{i=(h?null===(r=t.protoLineItem.uid2FloorPrice)||void 0===r?void 0:r.priceList:null===(n=t.protoLineItem.floorPricesNewModel)||void 0===n?void 0:n.priceList).slice(0,4).sort(((t,i)=>i.price-t.price)).map((t=>({price:(0,mt.ox)(t.price),priceOutcome:0,floorPriceBypassReason:Zi(t.bypassReason)}))),this.Ap.set(t.protoLineItem.advertiserLineItemId,{hasUid2:h,prices:i})}const o=Ot(i,"reset");return(0,W.Ft)(o)?((0,ft.FH)({message:"RtbCallAggregator_getFloorPrice_nextBestFloorPrice_is_null",level:"Critical"},{pacing:5,throttle:1}),null):new ki._({floorPrices:[o.price],useFirstPrices:1})}return(null===(h=this.yp.get(t.protoLineItem.advertiserLineItemId))||void 0===h?void 0:h.cachedFloorPrice)||null}Fp(t){const i=Yt({playerSkippability:this.pp.skippability,playerSkipMin:this.pp.skipMin,playerSkipAfter:this.pp.skipAdAfter,lineItemSkippability:t.protoLineItem.skippabilityType,lineItemSkipMin:t.protoLineItem.allowSkipAfterSeconds}),e=i.skippable?Pi.rH.ENABLED:Pi.rH.DISABLED;return Object.assign(Object.assign({},i),{skip:e})}Op(t){if(t.adManagerLineItem.protoLineItem.shouldBeCalledInEveryAo)return!0;const{adType:i,demandPartnerId:e,nonlinearLineItemSettings:s,advertiserLineItemId:n}=t.adManagerLineItem.protoLineItem,{width:h,height:o}=this.ls.playerDimensions;return i===r.Z9.VIDEO_VIDEO||this.Np(i,h,o,e,null==s?void 0:s.requestType)?this.vp.shouldRequestLineItem(n):((0,ft.FH)({message:"RtbCallAggregator_not_supported_banner_sizes",level:"Info"},{pacing:1,throttle:100}),!1)}$p(t){return t===St.cr.AD_BREAK_TYPE_UNSPECIFIED||this.up?Pi.cr.OUTSTREAM:ne[t]}Pp(t){var i,e,s;return(0,yi.mG)(this,void 0,void 0,(function*(){const{width:r,height:n,viewability:o,sound:a,clickToPlay:d,adBreakState:c,media:{mediaSourceUrl:l}}=t.callingState,{adTrackingRequestMeta:u,lineItemAbTest:p,region:v,playerDimensions:{width:m,height:g},shouldLogAuctionPriceType:f,shouldUseNetCPM:I}=this.ls,y=(0,h.AU)(ie.c),A=yield y.getLoadedCookieDeprecationLabel(),b=new wi.H({id:null===(i=this._i)||void 0===i?void 0:i.syncedPanoIndivId,type:St.RI.PANO_INDIV}),_=this.je.getProtoData(),x=this._i.getConsentPayload(),S=this._i.isGDPR(),w=this._i.getDeviceId(),k=this._i.isSellUserAllowed(),P=this._i.getUsPrivacyString(),M=this._i.gdprConsentMode,C=this.mp.services.MacrosService.getExtraMacros(),L=(0,h.AU)(Lt.n);let T=!1;1===ci.ABService.clientAb3.value&&L.isLocalStorageEnabled&&L.isUserReccurentWithNoBids()&&L.isRecurrentUser()&&(T=!0);const B={},E={};if(f){const t=I?1:0;B[4]=`${t}`,E[4]=`${t}`}return(0,Ji.p)(new Pi.id({metadata:u,isGdprCompliant:S,gdprConsent:x||void 0,hasSoundOn:a,videoWidth:r,videoHeight:n,isInTestMode:"true"===(0,gt.Ph)("cnxRtbTest",this.mp.config.pageUrl),isInExplorationMode:this.mp.config.explorationMode,isPlayerInView:o,isOutstream:this.up,domain:this.mp.config.domainURL,hasClickToPlayInteraction:d,sdkAppVersion:this.mp.config.appVersion,deviceId:w,isSellingUserNotAllowedByCcpa:!k,usPrivacy:P||void 0,gdprConsentMode:M,customMacrosMap:C,maxAdDurationSeconds:t.maxAdDuration,lineItemsMap:this.Rp(t.lineItemRequestDataList,t.callingState),maxBidPriceAvailable:t.maxBidPrice,playerWidth:m,playerHeight:g,useNewSkippabilityMode:!0,lineItemAbTest:p,connectionType:se.n.getConnectionType(this.mp.config.deviceType),hasOmsdkSupport:this._p,omsdkVersion:this.Sp.omsdkVersion,identityProviderData:_,isUserIdentificationPending:null===(e=this._i)||void 0===e?void 0:e.userIdentificationPending,adRollType:this.$p(c.adBreakType),coreSyncTimestamp:null===(s=this._i)||void 0===s?void 0:s.coreSyncTimestamp,isCallAssertiveYield:"us-east-2"===v,lotamePanorama:b,cookieDeprecationLabel:A,gppConsent:this._i.getGppString(),gppSectionIdList:this._i.getGppSid(),isLowFloorEnabled:T,videoUrl:l,floorPricesStrategyType:this.bn.floorPricesStrategyType,gpid:this.bp?re(this.mp.config.playerId,this.mp.config.pageUrl,Si.Y[this.mp.config.deviceType],this.mp.config.accountNameWithoutPlatform,this.mp.config.bundleID):void 0,dynamicElkFieldsBidMap:B,dynamicElkFieldsPrebidMap:E}))}))}Mp(t){return(0,te.Ou)({endpoint:Qi.n.endPoints.ads.api.rtb,protoRequest:Pi.id,protoResponse:Mi.gu,requestData:t,queryParams:{[Gi.Fk]:zi.g.version,[Gi.cc]:Qi.n.tier},shouldLogErrors:!1,shouldSetClientHintsHeaders:!0})}wp(t,i){return 0!==t&&0!==i||((0,ft.FH)({message:"AdManager_BidderCaller_dimensions",exception:`width:${t}_height:${i}_destroyed:${Yi.S.playerDestroyed}`,level:"Warn",sessionId:this.mp.config.sessionId},{throttle:5}),!1)}Np(t,i,e,s,r){let n=Ci;return 17===s&&(n=Ti[17]),Xt(t,r)?(n=[...n,...Li],n.some((t=>i>=t.w&&t.h<=50))):n.some((t=>i>=t.w&&e>=t.h))}}const oe=["video/mp4","video/webm","application/javascript","video/ogg","video/mpeg"],ae=1e3,de=15e3,ce=[2,3,5,6],le={VPAID_1:1,VPAID_2:2},ue=[le.VPAID_1,le.VPAID_2],pe=[le.VPAID_1,le.VPAID_2],ve=(t,i)=>{const{skip:e,skippable:s,skipmin:r,skipafter:n}=i,{width:h,height:o,isOutstreamContext:a,maxAdDuration:d,initialSoundMode:c,playbackMode:l,plcmt:u}=t,p=fi(u),v=a?{}:void 0;return{video:Object.assign(Object.assign({w:Math.floor(h),h:Math.floor(o),playerSize:[Math.floor(h),Math.floor(o)],context:a?"outstream":"instream",mimes:oe,protocols:ce,linearity:1,api:ue,frameworks:pe,maxduration:d,minduration:0,skip:e,skippable:s,skipmin:r,skipafter:n,placement:p,renderer:v,playbackmethod:[gi(l,c)],pos:0},u?{plcmt:u}:null),{minbitrate:ae,maxbitrate:de})}};class me{constructor(t,i,e,s,r){this._appSettings=t,this.Ll=i,this._i=e,this.Wp=s,this.jp=r,this.qp={PAGE_URL:()=>this.Ll.pageUrl,APP_BUNDLE:()=>this._appSettings.bundleID,APP_NAME:()=>this._appSettings.appName,APP_DEVICE_ID:t=>this.zp(t),CNX_AD_UNIT:()=>this.Hp(),CNX_SUPPLY_TYPE:()=>this.Gp(),CNX_VIDEO_CONTEXT:t=>this.Jp(t),CNX_INTEGRATION_MODE:()=>this.Ll.isAmp?"AMP":void 0,WIDTH:t=>Math.floor(t.videoWidth),HEIGHT:t=>Math.floor(t.videoHeight),CNX_SUPPLY_CHAIN:t=>t.supplyChain,CNX_VIDEO_API:()=>Object.values(le),CNX_VIDEO_FRAMEWORKS:()=>pe,CNX_VIDEO_MIMES:()=>oe,CNX_VIDEO_PROTOCOLS:()=>ce,CNX_VIDEO_LINEARITY:()=>1,CNX_VIDEO_MAX_DURATION:t=>t.videoMaxAdDuration,CNX_VIDEO_LANGUAGE:()=>"en",CNX_VIDEO_ID:t=>t.mediaId,CNX_ATS_ENVELOPE:t=>t.liveRampEnvelope,CNX_VIDEO_SKIPPABLE:t=>t.skippabilitySettings.skippable,CNX_VIDEO_SKIP_OFFSET:t=>t.skippabilitySettings.skipafter,CNX_VIDEO_PLAYBACK_METHOD_INTEGER:()=>this.Yp(),CNX_VIDEO_PLAYBACK_METHOD_STRING:()=>this.Xp(),CNX_VIDEO_PLACEMENT:t=>fi(t.plcmt),CNX_VIDEO_SIZE_ID:()=>this.Kp(),CNX_VIDEO_START_DELAY:()=>this.jp,CNX_VIDEO_VOLUME:t=>t.videoVolume,DNT:()=>{},USER_LANGUAGE:()=>this.Qp(),USER_LAT:()=>this.Ll.geoLocation.lat,USER_LONG:()=>this.Ll.geoLocation.lon}}getMacroValue(t,i){const e=this.qp[t];if(e)return e(i)}hasMacroValue(t,i){return(0,W.$K)(this.getMacroValue(t,i))}zp(t){const i=this._i.isConsent(t.vendorId);return this._i.isConsentConnatix()&&i?this._i.getTrackableUser():void 0}Hp(){return this.Wp.isOutstream?"outstream":"instream"}Gp(){return this.Ll.isInApp?"mobile_app":this.Ll.isMobile?"mobile_web":"web"}Jp(t){if(this.Wp.isOutstream)return"outstream";return{[St.cr.AD_BREAK_TYPE_UNSPECIFIED]:"pre_roll",[St.cr.PRE_ROLL]:"pre_roll",[St.cr.MID_ROLL]:"mid_roll",[St.cr.POST_ROLL]:"post_roll"}[t.adBreakType]}Yp(){return gi(this.Wp.playbackMode,this.Wp.initialSoundMode)}Xp(){const t=this.Wp.playbackMode,i=this.Wp.initialSoundMode;return t===St.Fx.AUTOPLAY?i===St.zj.ON?"auto_play_sound_on":i===St.zj.MUTE?"auto_play_sound_off":"auto_play_sound_unknown":t===St.Fx.CLICK_TO_PLAY?"click_to_play":void 0}Kp(){return this.Wp.isOutstream?203:201}Qp(){const t=navigator.language;if((0,W.QM)(t))return t.split("-")[0].toUpperCase()}}var ge=e(8678);class fe{constructor(t,i={}){this.Zp=t,this.tm=i,this.im="{{",this.sm="}}",this.rm=new RegExp(`${this.im}(.*?)${this.sm}`,"g")}replaceMacros(t,i){const e=(0,ge.Ed)(t,this.rm);if(!(0,ot.BZ)(e))return t;const s=this.zr(t,e,i);return this.replaceMacros(s,i)}setMacros(t){this.tm=Object.assign(Object.assign({},this.tm),t)}zr(t,i,e){const s=t;return i.reduce(((t,i)=>this.nm(t,i,e)),s)}nm(t,i,e){const s=this.om(i);if(!this.am(s,e))return t.replace(i,null);let r=null,n=!1;this.hm(s,e)?r=this.Zp.getMacroValue(s,e):this.dm(s)&&(r=this.tm[s],(0,W.HD)(r)||(n=!0));const h=this.lm(r);if(n){return t.replace(`"${i}"`,h).replace(i,h)}return t.replace(i,h)}am(t,i){return this.hm(t,i)||this.dm(t)}hm(t,i){return this.Zp.hasMacroValue(t,i)}dm(t){return(0,W.$K)(this.tm[t])}om(t){return t.replace(this.im,"").replace(this.sm,"")}lm(t){return[null,void 0,NaN].includes(t)?null:Array.isArray(t)||(0,W.as)(t)?JSON.stringify(t):`${t}`}}const Ie={AppNexus:"appnexus",IndexExchange:"ix",OpenX:"openx",Pubmatic:"pubmatic",RhythmOne:"rhythmone",Rubicon:"rubicon",Telaria:"telaria",MediaNet:"medianet",Adman:"adman",SynacorMedia:"synacormedia",Undertone:"undertone",AmxRTB:"amx",Smaato:"smaato",SmartAdServer:"smartadserver",TheMediaGrid:"grid",Rise:"rise",YahooAds:"yahooAds",Unruly:"unruly",Kargo:"kargo",SmileWanted:"smilewanted",TrustX:"trustx",CadentApertureMx:"cadent_aperture_mx",KrushMedia:"krushmedia",Conversant:"conversant",Criteo:"criteo",TripleLift:"triplelift",PulsePoint:"pulsepoint",Adtelligent:"adtelligent",Yieldmo:"yieldmo",PgamMedia:"pgammedia",NextMillennium:"nextMillennium",AdYouLike:"adyoulike",FreeWheelSSP:"freewheel-ssp",ColossusSSP:"colossusssp",ResetDigital:"resetdigital",MediaFuse:"mediafuse",Sharethrough:"sharethrough",Insticator:"insticator",Sonobi:"sonobi",Ozone:"ozone",ShowHeroes:"showheroes-bs",SeedTag:"seedtag",MinuteMedia:"minutemedia",Sovrn:"sovrn",KueezRtb:"kueezrtb"};function ye(t,i,e){(0,ft.FH)({level:"Critical",message:`PrebidJS_${t}_adapter_missing_${i}_li_${e}`})}function Ae(t,i,e){const s=i.map((t=>t.join("_and_"))).join("_or_");(0,ft.FH)({level:"Critical",message:`PrebidJS_${t}_adapter_needs_${s}_li_${e}`})}class be{get config(){return this.Vc}}var _e=e(6197);var xe=e(976);const Se={[Ie.AppNexus]:new class extends be{constructor(){super(...arguments),this.Vc={vendorId:32,gdprSupport:!0,ccpaSupport:!0}}getBidParams(t,i){const e=Object.assign({},t);if(!(0,W.hj)(e.placementId))return void ye("appnexus","placementId",i.lineItemId);const{floorPrice:s,deviceId:r,os:n,skippabilitySettings:h}=i;if((0,W.r)(s)&&(e.reserve=s),(0,W.QM)(r))switch(e.app=Object.assign({},e.app),n){case _e.M.Android:e.app.device_id={aaid:r};break;case _e.M.Ios:e.app.device_id={idfa:r}}return e.video=Object.assign(Object.assign({},e.video),{skippable:!!h.skip,skipoffset:h.skipafter}),e}},[Ie.IndexExchange]:new class extends be{constructor(){super(...arguments),this.Vc={vendorId:10,gdprSupport:!0,ccpaSupport:!0}}getBidParams(t,i){const e=Object.assign({},t);if(!(0,W.QM)(e.siteId))return void ye("ix","siteId",i.lineItemId);const{floorPrice:s,isOutstream:r}=i;if((0,W.r)(s)&&(e.bidFloor=s,e.bidFloorCur="USD"),r){const{inFloating:t,hasFloatingCapability:s,playerWidth:r,playerHeight:n}=i;e.video.playerConfig={floatOnScroll:s,floatSize:t?[r,n]:void 0}}return e}},[Ie.OpenX]:new class extends be{constructor(){super(...arguments),this.Vc={vendorId:69,gdprSupport:!0,ccpaSupport:!0}}getBidParams(t,i){const e=Object.assign({},t),{lineItemId:s}=i;if(!(0,W.QM)(e.unit))return void ye("openx","unit",s);if(!(0,W.QM)(e.delDomain))return void ye("openx","delDomain",s);const{floorPrice:r}=i;return(0,W.r)(r)&&(e.customFloor=r),e}},[Ie.Pubmatic]:new class extends be{constructor(){super(...arguments),this.Vc={vendorId:76,gdprSupport:!0,ccpaSupport:!0}}getBidParams(t,i){const e=Object.assign({},t);if(!(0,W.QM)(e.publisherId))return void ye("pubmatic","publisherId",i.lineItemId);const s=i.floorPrice;return(0,W.r)(s)&&(e.kadfloor=String(s)),i.isOutstream&&(e.outstreamAU=i.adUnitCode),e.kadpageurl=i.pageUrl,e}},[Ie.RhythmOne]:new class extends be{constructor(){super(...arguments),this.Vc={vendorId:36,gdprSupport:!0,ccpaSupport:!1}}getBidParams(t,i){if((0,W.QM)(t.placementId))return t;ye("rhythmone","placementId",i.lineItemId)}},[Ie.Rubicon]:new class extends be{constructor(){super(...arguments),this.Vc={vendorId:52,gdprSupport:!0,ccpaSupport:!0}}getBidParams(t,i){const e=Object.assign({},t),{lineItemId:s}=i;if(!(0,W.hj)(e.accountId))return void ye("rubicon","accountId",s);if(!(0,W.hj)(e.siteId))return void ye("rubicon","siteId",s);if(!(0,W.hj)(e.zoneId))return void ye("rubicon","zoneId",s);const r=i.floorPrice;return(0,W.r)(r)&&(e.floor=r),e}},[Ie.Telaria]:new class extends be{constructor(){super(...arguments),this.Vc={vendorId:52,gdprSupport:!0,ccpaSupport:!1}}getBidParams(t,i){const e=Object.assign({},t),{lineItemId:s,pageUrl:r}=i;if((0,W.QM)(t.adCode)){if((0,W.QM)(t.supplyCode))return e.srcPageUrl=r,t;ye("telaria","supplyCode",s)}else ye("telaria","adCode",s)}},[Ie.MediaNet]:new class extends be{constructor(){super(...arguments),this.Vc={vendorId:142,gdprSupport:!0,ccpaSupport:!0}}getBidParams(t,i){const e=Object.assign({},t),{lineItemId:s,pageUrl:r}=i;if(!(0,W.QM)(e.cid))return void ye("medianet","cid",s);if(!(0,W.QM)(e.crid))return void ye("medianet","crid",s);const{floorPrice:n}=i;return(0,W.r)(n)&&(e.bidFloor=n),e.site=Object.assign(Object.assign({},e.site||{}),{page:r}),e}},[Ie.Adman]:new class extends be{constructor(){super(...arguments),this.Vc={vendorId:149,gdprSupport:!0,ccpaSupport:!0}}getBidParams(t,i){const e=Object.assign({},t);if(!(0,W.QM)(e.placementId))return void ye("adman","placementId",i.lineItemId);const{floorPrice:s}=i;return(0,W.r)(s)&&(e.bidfloor=s),e.traffic="video",e}},[Ie.SynacorMedia]:new class extends be{constructor(){super(...arguments),this.Vc={vendorId:void 0,gdprSupport:!1,ccpaSupport:!0}}getBidParams(t,i){const e=Object.assign({},t),{lineItemId:s}=i;if(!(0,W.QM)(e.seatId))return void ye("synacormedia","seatId",s);if(!(0,W.QM)(e.tagId))return void ye("synacormedia","tagId",s);const{floorPrice:r}=i;return(0,W.r)(r)&&(e.bidfloor=r),e}},[Ie.Undertone]:new class extends be{constructor(){super(...arguments),this.Vc={vendorId:677,gdprSupport:!0,ccpaSupport:!0}}getBidParams(t,i){const e=Object.assign({},t),{lineItemId:s,skippabilitySettings:r}=i;if((0,W.hj)(e.publisherId)){if((0,W.QM)(e.placementId))return e.video=Object.assign(Object.assign({},e.video||{}),{skippable:!!r.skip}),e;ye("undertone","placementId",s)}else ye("undertone","publisherId",s)}},[Ie.AmxRTB]:new class extends be{constructor(){super(...arguments),this.Vc={vendorId:737,gdprSupport:!0,ccpaSupport:!0}}getBidParams(t,i){const e=Object.assign({},t);if(!(0,W.QM)(e.tagId))return void ye("amx","tagId",i.lineItemId);const{floorPrice:s}=i;return(0,W.r)(s)&&(e.floor=s),e}},[Ie.Smaato]:new class extends be{constructor(){super(...arguments),this.Vc={vendorId:82,gdprSupport:!0,ccpaSupport:!0}}getBidParams(t,i){const{lineItemId:e}=i;if((0,W.QM)(t.publisherId)){if((0,W.QM)(t.adspaceId))return t;ye("smaato","adspaceId",e)}else ye("smaato","publisherId",e)}},[Ie.SmartAdServer]:new class extends be{constructor(){super(...arguments),this.Vc={vendorId:18,gdprSupport:!0,ccpaSupport:!0}}getBidParams(t,i){const e=Object.assign({},t),{lineItemId:s}=i;if(!(0,W.hj)(e.siteId))return void ye("smartadserver","siteId",s);if(!(0,W.hj)(e.pageId))return void ye("smartadserver","pageId",s);if(!(0,W.hj)(e.formatId))return void ye("smartadserver","formatId",s);const{floorPrice:r}=i;return(0,W.r)(r)&&(e.bidfloor=r),e}},[Ie.TheMediaGrid]:new class extends be{constructor(){super(...arguments),this.Vc={vendorId:686,gdprSupport:!0,ccpaSupport:!0}}getBidParams(t,i){const e=Object.assign({},t);if(!(0,W.r)(e.uid))return void ye("grid","uid",i.lineItemId);const{floorPrice:s}=i;return(0,W.r)(s)&&(e.bidFloor=s),e}},[Ie.Rise]:new class extends be{constructor(){super(...arguments),this.Vc={vendorId:1043,gdprSupport:!0,ccpaSupport:!0}}getBidParams(t,i){const e=Object.assign({},t);if(!(0,W.QM)(e.org))return void ye("rise","org",i.lineItemId);const{floorPrice:s}=i;return(0,W.r)(s)&&(e.floorPrice=s),e}},[Ie.YahooAds]:new class extends be{constructor(){super(...arguments),this.Vc={vendorId:25,gdprSupport:!0,ccpaSupport:!0}}getBidParams(t,i){const e=Object.assign({},t),s=(0,W.QM)(e.pos)&&(0,W.QM)(e.dcn),r=(0,W.QM)(e.pubId);if(!s&&!r)return void ye("yahooAds","required",i.lineItemId);const{floorPrice:n}=i;return(0,W.r)(n)&&(e.bidOverride={imp:{bidfloor:n}}),e}},[Ie.Unruly]:new class extends be{constructor(){super(...arguments),this.Vc={vendorId:36,gdprSupport:!1,ccpaSupport:!1}}getBidParams(t,i){const e=Object.assign({},t);if((0,W.hj)(e.siteId))return i.isOutstream&&(e.featureOverrides={canRunUnmissable:!0}),(0,W.r)(i.floorPrice)&&(e.floor=i.floorPrice),e;ye("unruly","siteId",i.lineItemId)}},[Ie.Kargo]:new class extends be{constructor(){super(...arguments),this.Vc={vendorId:972,gdprSupport:!0,ccpaSupport:!0}}getBidParams(t,i){if((0,W.QM)(t.placementId))return t;ye("kargo","placementId",i.lineItemId)}},[Ie.SmileWanted]:new class extends be{constructor(){super(...arguments),this.Vc={vendorId:639,gdprSupport:!0,ccpaSupport:!0}}getBidParams(t,i){const e=Object.assign({},t);if(!(0,W.QM)(e.zoneId))return void ye("smilewanted","zoneId",i.lineItemId);const{floorPrice:s}=i;return(0,W.r)(s)&&(e.bidfloor=s),e}},[Ie.TrustX]:new class extends be{constructor(){super(...arguments),this.Vc={vendorId:void 0,gdprSupport:!0,ccpaSupport:!0}}getBidParams(t,i){const e=Object.assign({},t);if(!(0,W.hj)(e.uid))return void ye("trustx","uid",i.lineItemId);const{floorPrice:s}=i;return(0,W.r)(s)&&(e.bidFloor=s),e}},[Ie.CadentApertureMx]:new class extends be{constructor(){super(...arguments),this.Vc={vendorId:183,gdprSupport:!0,ccpaSupport:!0}}getBidParams(t,i){const e=Object.assign({},t);if(!(0,W.QM)(e.tagid))return void ye("cadent_aperture_mx","tagid",i.lineItemId);const{floorPrice:s}=i;return(0,W.r)(s)&&(e.bidfloor=s.toString()),e}},[Ie.KrushMedia]:new class extends be{constructor(){super(...arguments),this.Vc={vendorId:void 0,gdprSupport:!0,ccpaSupport:!0}}getBidParams(t,i){const e=Object.assign({},t);if(!(0,W.QM)(e.key))return void ye("krushmedia","key",i.lineItemId);const{floorPrice:s}=i;return(0,W.r)(s)&&(e.bidfloor=s),e.traffic="video",e}},[Ie.Conversant]:new class extends be{constructor(){super(...arguments),this.Vc={vendorId:24,gdprSupport:!0,ccpaSupport:!0}}getBidParams(t,i){const e=Object.assign({},t);if(!(0,W.QM)(e.site_id))return void ye("conversant","site_id",i.lineItemId);e.secure=1;const{floorPrice:s}=i;return(0,W.r)(s)&&(e.bidfloor=s),e}},[Ie.Criteo]:new class extends be{constructor(){super(...arguments),this.Vc={vendorId:91,gdprSupport:!0,ccpaSupport:!0}}getBidParams(t,i){const e=Object.assign({},t);if((0,W.hj)(e.networkId))return e;ye("criteo","networkId",i.lineItemId)}},[Ie.TripleLift]:new class extends be{constructor(){super(...arguments),this.Vc={vendorId:28,gdprSupport:!0,ccpaSupport:!0}}getBidParams(t,i){const e=Object.assign({},t);if(!(0,W.QM)(e.inventoryCode))return void ye("triplelift","inventoryCode",i.lineItemId);const{floorPrice:s}=i;return(0,W.r)(s)&&(e.floor=s),e}},[Ie.PulsePoint]:new class extends be{constructor(){super(...arguments),this.Vc={vendorId:81,gdprSupport:!0,ccpaSupport:!0}}getBidParams(t,i){const e=Object.assign({},t);if(!(0,W.hj)(e.cp))return void ye("pulsepoint","cp",i.lineItemId);if(!(0,W.hj)(e.ct))return void ye("pulsepoint","ct",i.lineItemId);const{floorPrice:s}=i;return(0,W.r)(s)&&(e.bidfloor=s),e}},[Ie.Adtelligent]:new class extends be{constructor(){super(...arguments),this.Vc={vendorId:410,gdprSupport:!0,ccpaSupport:!0}}getBidParams(t,i){const e=Object.assign({},t);if((0,W.hj)(e.aid))return e;ye("adtelligent","aid",i.lineItemId)}},[Ie.Yieldmo]:new class extends be{constructor(){super(...arguments),this.Vc={vendorId:173,gdprSupport:!0,ccpaSupport:!0}}getBidParams(t,i){const e=Object.assign({},t);if(!(0,W.QM)(e.placementId))return void ye("yieldmo","placementId",i.lineItemId);const{floorPrice:s}=i;return(0,W.r)(s)&&(e.bidFloor=s),e}},[Ie.PgamMedia]:new class extends be{constructor(){super(...arguments),this.Vc={vendorId:void 0,gdprSupport:!0,ccpaSupport:!0}}getBidParams(t,i){const e=Object.assign({},t);if((0,W.QM)(e.AV_PUBLISHERID)){if((0,W.QM)(e.AV_CHANNELID))return e;ye("pgammedia","AV_CHANNELID",i.lineItemId)}else ye("pgammedia","AV_PUBLISHERID",i.lineItemId)}},[Ie.NextMillennium]:new class extends be{constructor(){super(...arguments),this.Vc={vendorId:1060,gdprSupport:!0,ccpaSupport:!0}}getBidParams(t,i){const e=Object.assign({},t);if((0,W.QM)(e.placement_id)||(0,W.QM)(e.group_id))return e;Ae("nextMillennium",[["placement_id"],["group_id"]],i.lineItemId)}},[Ie.AdYouLike]:new class extends be{constructor(){super(...arguments),this.Vc={vendorId:259,gdprSupport:!0,ccpaSupport:!0}}getBidParams(t,i){const e=Object.assign({},t);if((0,W.QM)(e.placement))return e;ye("adyoulike","placement",i.lineItemId)}},[Ie.FreeWheelSSP]:new class extends be{constructor(){super(...arguments),this.Vc={vendorId:285,gdprSupport:!0,ccpaSupport:!0}}getBidParams(t,i){const e=Object.assign({},t);if((0,W.QM)(t.zoneId))return e;ye("freewheel-ssp","zoneId",i.lineItemId)}},[Ie.ColossusSSP]:new class extends be{constructor(){super(...arguments),this.Vc={vendorId:void 0,gdprSupport:!0,ccpaSupport:!0}}getBidParams(t,i){const e=Object.assign({},t),s=(0,W.hj)(e.placement_id),r=(0,W.hj)(e.group_id);if(s||r)return e;Ae("colossusssp",[["placement_id"],["group_id"]],i.lineItemId)}},[Ie.ResetDigital]:new class extends be{constructor(){super(...arguments),this.Vc={vendorId:void 0,gdprSupport:!0,ccpaSupport:!1}}getBidParams(t,i){const e=Object.assign({},t),s=(0,W.QM)(e.pubId),r=(0,W.QM)(e.zoneId);if(s||r)return e;Ae("resetdigital",[["pubId"],["zoneId"]],i.lineItemId)}},[Ie.MediaFuse]:new class extends be{constructor(){super(...arguments),this.Vc={vendorId:void 0,gdprSupport:!0,ccpaSupport:!0}}getBidParams(t,i){const e=Object.assign({},t);if(!(0,W.hj)(e.placementId))return void ye("mediafuse","placementId",i.lineItemId);const{floorPrice:s,deviceId:r,os:n,skippabilitySettings:h}=i;if((0,W.r)(s)&&(e.reserve=s),(0,W.QM)(r))switch(e.app=Object.assign({},e.app),n){case _e.M.Android:e.app.device_id={aaid:r};break;case _e.M.Ios:e.app.device_id={idfa:r}}return e.video=Object.assign(Object.assign({},e.video),{skippable:!!h.skip,skipoffset:h.skipafter}),e}},[Ie.Sharethrough]:new class extends be{constructor(){super(...arguments),this.Vc={vendorId:80,gdprSupport:!0,ccpaSupport:!0}}getBidParams(t,i){const e=Object.assign({},t);if(!(0,W.QM)(e.pkey))return void ye("sharethrough","pkey",i.lineItemId);const{floorPrice:s}=i;return(0,W.r)(s)&&(e.floor=s),e}},[Ie.Insticator]:new class extends be{constructor(){super(...arguments),this.Vc={vendorId:910,gdprSupport:!0,ccpaSupport:!1}}getBidParams(t,i){const e=Object.assign({},t);if(!(0,W.QM)(e.adUnitId))return void ye("insticator","adUnitId",i.lineItemId);const s=i.floorPrice;return(0,W.r)(s)&&(e.floor=s,e.bidfloorcur="USD"),e}},[Ie.Sonobi]:new class extends be{constructor(){super(...arguments),this.Vc={vendorId:104,gdprSupport:!0,ccpaSupport:!0}}getBidParams(t,i){const e=Object.assign({},t);if(!(0,W.QM)(e.placement_id)&&!(0,W.QM)(e.ad_unit))return void Ae("sonobi",[["placement_id"],["ad_unit"]],i.lineItemId);const s=i.floorPrice;return(0,W.r)(s)&&(e.floor=s),e}},[Ie.Ozone]:new class extends be{constructor(){super(...arguments),this.Vc={vendorId:524,gdprSupport:!0,ccpaSupport:!0}}getBidParams(t,i){const e=Object.assign({},t),{siteId:s,placementId:r,publisherId:n}=e;if((0,W.QM)(s))if((0,W.QM)(r)){if((0,W.QM)(n))return e;ye("ozone",(0,xe.$0)({publisherId:n}),i.lineItemId)}else ye("ozone",(0,xe.$0)({placementId:r}),i.lineItemId);else ye("ozone",(0,xe.$0)({siteId:s}),i.lineItemId)}},[Ie.ShowHeroes]:new class extends be{constructor(){super(...arguments),this.Vc={vendorId:111,gdprSupport:!0,ccpaSupport:!0}}getBidParams(t,i){const e=Object.assign({},t),{unitId:s}=e;if((0,W.QM)(s))return e;ye("showHeroes",(0,xe.$0)({unitId:s}),i.lineItemId)}},[Ie.SeedTag]:new class extends be{constructor(){super(...arguments),this.Vc={vendorId:157,gdprSupport:!0,ccpaSupport:!0}}getBidParams(t,i){const e=Object.assign({},t),{adUnitId:s,publisherId:r}=e;if(!(0,W.QM)(s))return void ye("seedtag",(0,xe.$0)({adUnitId:s}),i.lineItemId);if(!(0,W.QM)(r))return void ye("seedtag",(0,xe.$0)({publisherId:r}),i.lineItemId);return e.placement="inStream",e}},[Ie.MinuteMedia]:new class extends be{constructor(){super(...arguments),this.Vc={vendorId:918,gdprSupport:!0,ccpaSupport:!0}}getBidParams(t,i){const e=Object.assign({},t),{org:s}=e;if(!(0,W.QM)(s))return void ye("minutemedia",(0,xe.$0)({org:s}),i.lineItemId);const{floorPrice:r}=i;return(0,W.r)(r)&&(e.floorPrice=r),e}},[Ie.Sovrn]:new class extends be{constructor(){super(...arguments),this.Vc={vendorId:13,gdprSupport:!0,ccpaSupport:!0}}getBidParams(t,i){const e=Object.assign({},t),{lineItemId:s}=i;if(!(0,W.hj)(Number(e.tagid)))return void ye("sovrn","tagId",s);const{floorPrice:r}=i;return(0,W.r)(r)&&(e.bidfloor=r),e}},[Ie.KueezRtb]:new class extends be{constructor(){super(...arguments),this.Vc={vendorId:1165,gdprSupport:!0,ccpaSupport:!0}}getBidParams(t,i){const e=Object.assign({},t),{lineItemId:s,floorPrice:r}=i;if((0,W.QM)(e.cId)){if((0,W.QM)(e.pId))return(0,W.r)(r)&&(e.bidFloor=r),e;ye("kueezRtb","pId",s)}else ye("kueezRtb","cId",s)}}},we=t=>({id:t.appId,name:t.appName,bundle:t.bundleID,domain:t.domainURL,storeurl:t.storeURL,cat:t.appCategories,ver:t.appVersion,privacypolicy:t.appPrivacyPolicy,paid:t.appIsPaid}),ke="https://prebid.adnxs.com/pbc/v1/cache",Pe=t=>{if(!(0,W.as)(t))return null;return`1.0,1!${(0,W.QM)(t.businessDomain)?encodeURI(t.businessDomain):""},${(0,W.QM)(t.supplyChainId)?encodeURI(t.supplyChainId):""},1`},Me=t=>({name:"uid2",value:{uid2:{id:t}}}),Ce=(t,i,e,s,r,n,h,o,a)=>{const d=Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({usePrebidCache:!0,enableTIDs:!0},((t,i)=>{const e={userSync:{syncEnabled:!0,iframeEnabled:!0,pixelEnabled:!0,filterSettings:{iframe:{bidders:"*",filter:"include"},image:{bidders:"*",filter:"include"}},syncsPerBidder:0,syncDelay:3e3,auctionDelay:0,aliasSyncEnabled:!0,userIds:[{name:"criteo"}]}};return(0,W.QM)(t)&&e.userSync.userIds.push({name:"identityLink",params:{pid:t,notUse3P:!1},storage:{name:"idl_env",type:"html5",expires:15,refreshInSeconds:1800}}),(0,W.QM)(i)&&e.userSync.userIds.push(Me(i)),e})(r,n)),{ix:{timeout:900}}),{targetingControls:{addTargetingKeys:["CACHE_ID"]}}),{yahooAds:{mode:"video"}}),(t=>({realTimeData:{dataProviders:[{name:"permutive",params:(0,W.as)(t)?t:{}}]}}))(a));return d.floors={},(0,W.QM)(o)&&(d.pageUrl=o),d.usePrebidCache&&(d.cache={url:ke}),h&&(d.schain=(t=>({validation:"strict",config:{ver:"1.0",complete:1,nodes:[{asi:t.businessDomain,hp:1,sid:(0,W.QM)(t.supplyChainId)?t.supplyChainId:null}]}}))(h)),(t||i||e)&&(d.consentManagement=((t,i,e)=>{const s=e?{gpp:{cmpApi:"iab",timeout:2e3}}:{};return t?Object.assign(Object.assign({},s),{gdpr:{cmpApi:"iab",timeout:2e3,defaultGdprScope:!0,allowAuctionWithoutConsent:!1,rules:[{purpose:"storage",enforcePurpose:!0,enforceVendor:!0,vendorExceptions:["permutive"]},{purpose:"basicAds",enforcePurpose:!0,enforceVendor:!0},{purpose:"measurement",enforcePurpose:!0,enforceVendor:!0}]}}):i?Object.assign(Object.assign({},s),{usp:{cmpApi:"iab",timeout:2e3}}):s})(t,i,e)),s.isInApp&&(d.ortb2={app:we(s)}),d};class Le{constructor(){this.Li=[],this.je=(0,h.AU)(ee.H)}init(t){this.um(t)}destroy(){(0,o.i)(this.Li)}um(t){var i,e;const s=null===(i=this.je.onPartnerResponse(St.EZ.PUBLISHER))||void 0===i?void 0:i.subscribe((i=>{this.pm(t,i)})),r=null===(e=this.je.onPartnerResponse(St.EZ.INTENT_IQ))||void 0===e?void 0:e.subscribe((i=>{this.vm(t,i)}));r&&this.Li.push(r),s&&this.Li.push(s)}pm(t,i){if(!i)return;const e=this.je.getUid2Token(St.EZ.PUBLISHER),s=Me(e);this.gm(t,s)}vm(t,i){if(!i)return;const e=(t=>({name:"pubProvidedId",params:{eids:t.map((t=>({source:t.source,uids:t.idList.map((t=>({id:t})))})))}}))(this.je.getEidsByPartner(St.EZ.INTENT_IQ));this.gm(t,e)}gm(t,i){const e={userSync:{userIds:[i]}};t.mergeConfig(e),t.refreshUserIds({submoduleNames:[i.name]})}}var Te=e(8473),Be=e(9995);const Ee="pbjs";class De{constructor(t,i){this.nt=t,this.ks=i,this.fm=!0,this.Im=new Be.o(this.nt,this.ks),this.Am=new Le}loadPrebidJs(t,i){return new Promise(((e,s)=>{if(this._m)return e(this._m);this.insertPrebidJs().then((s=>{this._m=s,this._m.setConfig(t),this._m.setBidderConfig({bidders:[Ie.TrustX,Ie.TripleLift,Ie.Conversant,Ie.Criteo,Ie.Kargo],config:{localStorageWriteAllowed:!0}},this.fm),(0,ot.BZ)(i)&&this._m.setBidderConfig({bidders:[...i],config:{schain:{validation:"strict",config:{ver:"1.0",complete:1,nodes:[{asi:"connatix.com",sid:"102900",hp:1},...t.schain?t.schain.config.nodes:[]]}}}},!0),this.Am.init(s),e(s)})).catch((t=>s(t)))}))}insertPrebidJs(){return new Promise(((t,i)=>{const e=Te.f.getCidKeyValueObject(),s=e&&"7cbcea0d-4ce2-4c75-9a8d-fbe02a192c24"===e[Gi.ym]?Qi.n.endPoints.ads.assets.plugins.prebidGannettScript:Qi.n.endPoints.ads.assets.plugins.prebidScript;this.Im.loadIframe({customHead:J.h`<style>body,html{display:none}</style>`,customHtml:J.h`<script id="cnx-prebid-loader" src="${s}"></script>`,customIframeAttributes:[{key:"class",value:"cnx-prebid-loader"}],container:this.nt.querySelector("body"),visible:!1}).then((e=&gt;{if(e.iframe.contentWindow[Ee])return this.bm(e.iframe),t(e.iframe.contentWindow[Ee]);i(new Error("pbjs could not be found on the iframe window"))})).catch((t=&gt;{i(t)}))}))}destroy(){this.Am.destroy()}bm(t){const i=this.nt.global.permutive;(0,W.$K)(i)&amp;&amp;(t.contentWindow.permutive=i)}}function Re(t,i){t.sort(((t,i)=&gt;t.width===i.width?t.bitrate-i.bitrate:t.width-i.width));for(let e=0;e<t.length;e++)if(t[e].width>=i)return t[e-1]||t[e];return t[t.length-1]}const Oe=()=&gt;`cnx_bid_slot_${(0,mt.qs)()}`;class Fe{constructor(t,i,e,s,r,n,h,o,a,d){this.Sm=t,this.wm=i,this.nt=e,this.Pm=s,this._i=r,this.Vc=n,this.Mm=h,this.re=o,this.km=a,this.xm=d,this.Rl=this.Vc.pageUrl,this.ks=this.Vc.sessionId,this._r=this.Vc.os.os,this.Lm=new De(this.nt,this.ks)}requestHeaderBidder(t,i){return new Promise(((e,s)=&gt;{this.Cm().then((s=&gt;{const r=t.map((t=&gt;this.Tm(s,t,i).then((t=&gt;t))));Promise.all(r).then((t=&gt;{e(t)}))})).catch((t=&gt;{s(_i.iu.NO_BID)}))}))}setMacros(t){this.Sm.setMacros(t)}destroy(){this.Lm.destroy()}Bm(t,i){const e={lineItemSkippability:t,lineItemSkipMin:i,playerSkippability:this.Pm.skippability,playerSkipMin:this.Pm.skipMin,playerSkipAfter:this.Pm.skipAdAfter},s=Yt(e),r=s.skippable?1:0;return Object.assign({skip:r},s)}Tm(t,i,e){return new Promise((s=&gt;{let r=[];if(i.availableRequests&gt;0)if((0,W.$K)(i.lineItem.floorPricesNewModel)&amp;&amp;(0,ot.BZ)(i.lineItem.floorPricesNewModel.priceList)){const s=i.lineItem.floorPricesNewModel.priceList.map((t=&gt;t.price));r=this.Em(i.lineItem.floorPricesNewModel,i.availableRequests,i.maxBidPrice).map((r=&gt;this.Dm(t,i.lineItem,i.bidderName,i.bidderParams,s,r,e)))}else{const s={requestedFloorPrice:i.lineItem.floorPrice,floorPriceInformation:new Ai.$({floorPrices:[],floorPriceIndexUsed:-1,bypassReason:St.Fo.FIXED_CPM})},n=this.Dm(t,i.lineItem,i.bidderName,i.bidderParams,[],s,e);r.push(n)}Promise.all(r).then((t=&gt;{const e=[],r=[],n=i.lineItem.advertiserLineItemId;t.forEach((t=&gt;{t.reason?r.push(t):e.push(t)}));s({bids:e,noBids:r,lineItemId:n})}))}))}Dm(t,i,e,s,r,n,h){return new Promise((o=&gt;{this.Rm(t,i,e,s,r,n,h).then((t=&gt;{o(t)})).catch((t=&gt;{o(t)}))}))}Cm(){const t=Ce(this._i.isGDPR(),this._i.isCcpaApplicable(),!!this._i.getGppString(),this.Vc,this.km,this.re,this.wm,this.Rl,this.xm);return new Promise(((i,e)=&gt;{this.Lm.loadPrebidJs(t,this.Mm).then((t=&gt;{i(t)})).catch((t=&gt;{const{message:i,stack:s}=(0,mt.W$)(t);(0,ft.FH)({message:"AdManager_HeaderBidder_unable_to_load_prebidJs_script",exception:i,callStack:s,level:"Critical",sessionId:this.ks},{pacing:1}),e(t)}))}))}Om(t){const i=Object.keys(t),e=i.filter((i=&gt;!(0,W.as)(t[i]))),s=i.filter((i=&gt;(0,W.as)(t[i])));return e.forEach((i=&gt;{null!==t[i]&amp;&amp;"null"!==t[i]||delete t[i]})),s.forEach((i=&gt;{this.Om(t[i])})),t}Rm(t,i,e,s,r,n,h){return new Promise(((o,a)=&gt;{const d=this.Bm(i.skippabilityType,i.allowSkipAfterSeconds),c=i.shouldUseAutoGeneratedGpid?re(this.Vc.playerId,this.Vc.pageUrl,Si.Y[this.Vc.deviceType],this.Vc.accountNameWithoutPlatform,this.Vc.bundleID):null,l=((t,i,e,s,r)=&gt;{const n=(0,mt.qs)(),h={code:(0,mt.qs)(),transactionId:n,mediaTypes:ve(t,e),ortb2Imp:{ext:{tid:n},source:{tid:n}},bids:[]};s&amp;&amp;h.ortb2Imp&amp;&amp;(h.ortb2Imp.ext.gpid=s);let o=0;if(!t.isOutstreamContext)switch(t.adBreakType){case St.cr.PRE_ROLL:o=0;break;case St.cr.MID_ROLL:o=1;break;case St.cr.POST_ROLL:o=-2;break;default:o=0}return h.mediaTypes.video.startdelay=o,(0,W.r)(i)&amp;&amp;(h.floors=(t=&gt;({currency:"USD",schema:{fields:["mediaType"]},values:{video:t}}))(i)),h})(h,n.requestedFloorPrice,d,c);try{const{width:t,height:e,maxAdDuration:r,videoVolume:n,inFloating:o,adBreakType:a,mediaLanguage:c,mediaId:u,liveRampEnvelope:p,plcmt:v}=h,m=this.Sm.replaceMacros(s,{videoWidth:t,videoHeight:e,videoMaxAdDuration:r,vendorId:i.vendorId,skippabilitySettings:d,videoVolume:n,inFloating:o,adBreakType:a,mediaLanguage:c,mediaId:u,supplyChain:Pe(this.wm),liveRampEnvelope:p,plcmt:v}),g=JSON.parse(m),f=this.Om(g);l.bids=[f]}catch(t){const{message:i,stack:s}=(0,mt.W$)(t);(0,ft.FH)({message:"AdManager_HeaderBidder_unable_to_parse_header_bidder",exception:i,callStack:s,level:"Warn",sessionId:this.ks});const r=Object.assign({bidderName:e,reason:_i.iu.NO_BID},n);return void a(r)}const u=Oe();l.bids.forEach((t=&gt;this.Fm(t,n.requestedFloorPrice,i.advertiserLineItemId,u,d,h,l.code,this._i.getDeviceId(),this._r))),t.que.push((()=&gt;{t.addAdUnits(l);const s={timeout:i.headerBidderTimeoutMiliseconds,adUnits:[l],bidsBackHandler:()=&gt;{var s;try{const h=t.getHighestCpmBids(l.code)[0];if(!h){const t=Object.assign({bidderName:e,reason:_i.iu.CS_EMPTY_RESPONSE},n);return void a(t)}let d,c;if(this.Nm(h))d=((t,i)=&gt;i===Ie.Rubicon?`https://prebid-server.rubiconproject.com/cache?uuid=${t.adserverTargeting.hb_cache_id}`:`${ke}?uuid=${t.adserverTargeting.hb_cache_id}`)(h,e);else if(d=h.vastUrl,c=h.vastXml||h.ad,!d&amp;&amp;!c){(0,ft.FH)({level:"Warn",message:"AdManager_HeaderBidder_no_content",exception:JSON.stringify(h),sessionId:this.ks});const t=Object.assign({bidderName:e,reason:_i.iu.CS_EMPTY_RESPONSE},n);return void a(t)}const p=h.cpm||h.adResponse.ad.cpm,{advertiserLineItemId:v}=i,m=Object.assign(Object.assign({},n),{bidderName:e,adTagUrl:d,adTagXml:c,lineItemId:v,cpm:p,slotId:u,bidId:l.code});(0,W.r)(n.requestedFloorPrice)&amp;&amp;p<n.requestedfloorprice&&(0,ft.fh)({message:"admanager_headerbidderrequester_cpm_lower_than_floorprice",level:"warn",exception:`floorprices_${r}_floorprice_${n.requestedfloorprice}_index_${null===(s=n.floorpriceinformation)||void 0="d?void" 0:d.getbidparams;if(!c)return;const{width:l,height:u,isoutstreamcontext:p,maxadduration:v,adbreaktype:m,infloating:g,hasfloatingcapability:f}="n;t.params=c(t.params,{playerWidth:l,playerHeight:u,maxDuration:v,pageUrl:this.Rl,floorPrice:i,lineItemId:e,isOutstream:p,bidSlotId:s,skippabilitySettings:r,adBreakType:m,adUnitCode:h,inFloating:g,hasFloatingCapability:f,deviceId:o,os:a})}Nm(t){return" 0:s.floorpriceindexused}_cpm_${p}_li_${v}`,callstack:e,sessionid:this.ks},{shouldsendmaxlog:!1,throttle:5}),o(m)}catch(t){const{message:i,stack:s}='(0,mt.W$)(t);(0,ft.FH)({level:"Warn",message:"AdManager_HeaderBidder_Prebidjs_error",exception:i,callStack:s,sessionId:this.ks});const' c="null===(d=Se[t.bidder])||void" d;const="" r="Object.assign({bidderName:e,reason:_i.iu.NO_BID},n);a(r)}}};t.requestBids(s)}))}))}Fm(t,i,e,s,r,n,h,o,a){var" t.adservertargeting&&(0,w.qm)(t.adservertargeting.hb_cache_id)}em(t,i,e){if(0="i)return[];const{priceList:s,useFirstPrices:r}=t,n=s.map((({price:t})=">t)),h=s.map(((t,i)=&gt;{if(i<r)return{requestedfloorprice:t.price,floorpriceinformation:new ai.$({floorprices:n,floorpriceindexused:i,bypassreason:zi(t.bypassreason)})}})).filter((t="">(0,W.$K)(t)));return this.$m(h,i,e)}$m(t,i,e){let s=i;const r=t.filter((({requestedFloorPrice:t})=&gt;t&gt;=e&amp;&amp;s&gt;0&amp;&amp;(s--,!0)));if((0,ot.BZ)(r))return r;return[{requestedFloorPrice:e,floorPriceInformation:new Ai.$({floorPrices:t.map((({requestedFloorPrice:t})=&gt;t)),floorPriceIndexUsed:-1,bypassReason:St.Fo.BID_IN_HAND})}]}}var Ve=e(4582);class $e{constructor(t){this._i=t}isAdapterCallable(t){const i=(t=&gt;{const i=Object.keys(Ie).find((i=&gt;Ie[i]===t));if(i)return Ie[i]})(t);return!!i&amp;&amp;(this._i.isGDPR()?this.Um(i):!this._i.isCcpaApplicable()||this.Wm(i))}jm(t){return Se[t].config.gdprSupport}Um(t){if(this.jm(t))return!0;const i=Se[t].config.vendorId,e=(0,W.hj)(i)?`${i}`:"";return this._i.isConsent(e,Ve.m)}Wm(t){return!!Se[t].config.ccpaSupport||!!this._i.isSellUserAllowed()}}class Ne{constructor(t,i,e,s,r,n){this.Wp=t,this.wm=i,this.mp=e,this._appSettings=s,this.Pm=r,this.Mm=n,this.qm=new Map;const o=(0,h.AU)(Ki.w),{services:{GlobalDomUtilsService:a},config:d}=this.mp,c=new me(this._appSettings,d,o.userManagerService,this.Wp,null),l=this._appSettings.customJsTargetingObject,u=new fe(c,l),p=(0,h.TF)(d.sessionId,"ExternalPrebidJSPermutiveConfig"),v=(0,h.AU)(ee.H).getUid2Token(St.EZ.PUBLISHER);this.zm=new Fe(u,this.wm,a,this.Pm,o.userManagerService,d,this.Mm,v,this.Wp.liveRampPubId,p),this.Hm=new $e(o.userManagerService),this.je=(0,h.AU)(ee.H)}request(t){const{width:i,height:e}=t.callingState,s=!(0,nt.ON)({width:i,height:e});this.Gm(t.lineItemRequestDataList);const r=this.Jm(t.lineItemRequestDataList);return(0,ot.BZ)(r)&amp;&amp;s?(t.lineItemRequestDataList=r,this.Ym(t).then((i=&gt;Promise.resolve(this.Xm(i,t)))).catch((()=&gt;Promise.resolve({bids:[],noBids:[]})))):Promise.resolve({bids:[],noBids:[]})}setMacros(t){this.zm.setMacros(t)}destroy(){this.zm.destroy()}Xm(t,i){const e={bids:[],noBids:[]};return t.forEach((t=&gt;{const s=Jt(i.lineItemRequestDataList,t.lineItemId),{protoLineItem:{trackerList:r},historicalMetrics:{requestNumber:n}}=s;t.bids.forEach((t=&gt;{const{bidId:h,requestedFloorPrice:o,bidderName:a,floorPriceInformation:d,adTagUrl:c,adTagXml:l,cpm:u,slotId:p}=t,v=new Vi,m=new xi({requestedFloorPrice:o,prebidJsBidderName:a,requestNumber:n,floorPriceInformation:d});ji(r,v),((0,W.QM)(c)||(0,W.QM)(l))&amp;&amp;e.bids.push({bidId:h,lineItem:s,requestMetadata:m,state:i.callingState,vastTracker:v,shouldRequestWithCredentials:!1,vastTag:l,url:c,prebidjsCPM:u,slotId:p})})),t.noBids.forEach((t=&gt;{const{requestedFloorPrice:i,bidderName:r,floorPriceInformation:h,reason:o}=t,a=new xi({requestedFloorPrice:i,requestNumber:n,prebidJsBidderName:r,floorPriceInformation:h});e.noBids.push({lineItem:s,requestMetadata:a,reason:o})}))})),e}Ym(t){const{callingState:{width:i,height:e,media:{mediaLanguage:s,mediaId:r},soundVolume:n,inFloating:h,adBreakState:{adBreakType:o}},maxAdDuration:a,maxBidPrice:d,lineItemRequestDataList:c}=t,{hasFloatingCapability:l,isOutstream:u,initialSoundMode:p,playbackMode:v,plcmt:m}=this.Wp,g={width:i,height:e,maxAdDuration:a,hasFloatingCapability:l,inFloating:h,adBreakType:o,mediaLanguage:s,mediaId:r,initialSoundMode:p,playbackMode:v,plcmt:m,videoVolume:n,isOutstreamContext:u,liveRampEnvelope:this.je.getLiverampValidEnvelope()},f=c.map((t=&gt;this.Km(t,d)));return this.zm.requestHeaderBidder(f,g)}Km(t,i){const{adManagerLineItem:e,maxAvailableRequests:s}=t,{bidderName:r,bidderParamsJSONStringWithMacros:n}=this.qm.get(e);return{availableRequests:s,lineItem:e.protoLineItem,maxBidPrice:i,bidderName:r,bidderParams:n}}Jm(t){return t.filter((t=&gt;{var i;const e=(null===(i=this.qm.get(t.adManagerLineItem))||void 0===i?void 0:i.bidderName)||"";return this.Qm(e)}))}Gm(t){t.map((t=&gt;t.adManagerLineItem)).filter((t=&gt;!this.qm.has(t))).forEach((t=&gt;{try{const i=t.protoLineItem.prebidJsBidParamsJsonString,e=Ii(i);this.qm.set(t,{bidderName:e,bidderParamsJSONStringWithMacros:i})}catch(i){this.Zm((0,mt.W$)(i),t.protoLineItem.advertiserLineItemId)}}))}Zm(t,i){(0,ft.FH)({message:"PrebidJS_cannot_parse_bidderParams_"+i,level:"Warn",exception:`${t}`,sessionId:this.mp.config.sessionId},{throttle:1,shouldSendMaxLog:!1})}Qm(t){return this.Hm.isAdapterCallable(t)}}const Ue="apstag",We="https://aax.amazon-adsystem.com/e/dtb/vast";function je(t){var i,e;return{amzniid:t.amzniid||(null===(i=t.targeting)||void 0===i?void 0:i.amzniid),amznbid:t.amznbid||(null===(e=t.targeting)||void 0===e?void 0:e.amznbid)}}class qe{constructor(t){this.tv=t.amznbid,this.iv=t.amzniid}get amazonBidCode(){return this.tv}getVast(){return`${We}?b=${this.iv}&amp;pp=${this.tv}&amp;rnd=${(0,mt.qs)()}`}}function He(t){const i=function(t){var i;return t.amzndeals||(null===(i=t.targeting)||void 0===i?void 0:i.amzndeals)}(t);return(0,ot.BZ)(i)?i.map((i=&gt;{const e=`${i}amzniid`;return{targetingDeal:i,targetingKey:e,targetingValue:t.targeting[e]}})).filter((t=&gt;(0,W.QM)(t.targetingValue))):[]}class ze{constructor(t){this.sv=t.targetingDeal,this.rv=t.targetingKey,this.nv=t.targetingValue}get targetingDeal(){return this.sv}get targetingKey(){return this.rv}get targetingValue(){return this.nv}getVast(){return`${We}?b=${this.nv}&amp;rnd=${(0,mt.qs)()}`}}function Ge(t){var i,e;return{amzniid_sp:t.amzniid_sp||(null===(i=t.targeting)||void 0===i?void 0:i.amzniid_sp),amznbid_sp:t.amznbid_sp||(null===(e=t.targeting)||void 0===e?void 0:e.amznbid_sp)}}class Je{constructor(t){this.tv=t.amznbid_sp,this.iv=t.amzniid_sp}get amazonBidCode(){return this.tv}getVast(){return`${We}?b=${this.iv}&amp;rnd=${(0,mt.qs)()}`}}function Ye(t,i){const e=[];switch(t.creativeType){case r.H6.TAM:if(function(t){const i=je(t);return(0,W.QM)(i.amzniid)&amp;&amp;(0,W.QM)(i.amznbid)}(i)){const t=je(i);e.push(new qe(t))}break;case r.H6.TAM_DEAL:if(function(t){const i=He(t);return(0,ot.BZ)(i)}(i)){const s=He(i).filter((i=&gt;i.targetingDeal===t.amazonDealId)).map((t=&gt;new ze(t)));e.push(...s)}break;case r.H6.TAM_PRIVATE_AUCTION:if(function(t){const i=Ge(t);return(0,W.QM)(i.amzniid_sp)&amp;&amp;(0,W.QM)(i.amznbid_sp)}(i)){const t=Ge(i);e.push(new Je(t))}}return e}class Xe{constructor(t,i){this.ov=t,this.av=[],i.forEach((t=&gt;{const i=Ye(this.ov,t);this.av.push(...i)}))}get amazonBidList(){return this.av}get lineItem(){return this.ov}get hasCoreTamDependency(){return this.av.every((t=&gt;(0,W.QM)(t.amazonBidCode)))}}var Qe=e(8839);class Ke{constructor(t,i,e,s,r,n,h){this.mp=t,this.hv=i,this.dv=e,this.nt=s,this._i=r,this.ks=n,this.ls=h;const o=this.mp.config.topWindow;this.cv=(0,mt.pE)(o).topFrame}requestBids(t){return this.lv(t)}lv(t){return(0,yi.mG)(this,void 0,void 0,(function*(){try{yield this.uv();let i=null;t.some((t=&gt;t.shouldUseAutoGeneratedGpid))&amp;&amp;(i=re(this.mp.config.playerId,this.mp.config.pageUrl,Si.Y[this.mp.config.deviceType],this.mp.config.accountNameWithoutPlatform,this.mp.config.bundleID));const e=yield this.pv(i),s=this.mv(t,e),r=yield this.vv(s);return this.gv(s,r)}catch(i){return this.fv(t,i)}}))}fv(t,i){return i.message?t.map((t=&gt;({bids:[],lineItemId:t.advertiserLineItemId,noBids:[{reason:_i.iu.CS_REQUEST_EXCEPTION}]}))):t.map((t=&gt;({bids:[],lineItemId:t.advertiserLineItemId,noBids:[{reason:i}]})))}gv(t,i){return t.map((t=&gt;{const e=i.filter((i=&gt;t.lineItem.advertiserLineItemId===i.lineItemId));return this.Iv(t,e)}))}Iv(t,i){return t.hasCoreTamDependency?this.Av(t,i):this.yv(t)}yv(t){const i=t.amazonBidList.map((i=&gt;({vastTag:i.getVast(),ofskp:(0,Zt.p)(t.lineItem.floorPrice),slotId:Oe()})));return(0,ot.BZ)(i)?{bids:i,lineItemId:t.lineItem.advertiserLineItemId,noBids:[]}:{bids:[],lineItemId:t.lineItem.advertiserLineItemId,noBids:[{reason:_i.iu.NO_BID}]}}Av(t,i){const e=i.map((i=&gt;this._v(t,i))).filter((t=&gt;t.amazonBid&amp;&amp;!(0,W.Cz)(t.coreTamRequestOutput.rejectReason,_i.iu))).map((t=&gt;({encryptedPrice:t.coreTamRequestOutput.coreTamBidResponse.encryptedBidPrice,vastTag:t.amazonBid.getVast(),ofskp:t.coreTamRequestOutput.coreTamBidResponse.obfuscatedPrice,slotId:Oe()}))),s=i.filter((t=&gt;t.rejectReason)).map((t=&gt;({reason:t.rejectReason})));return(0,ot.BZ)(e)||(0,ot.BZ)(s)?{bids:e,noBids:s,lineItemId:t.lineItem.advertiserLineItemId}:{bids:[],lineItemId:t.lineItem.advertiserLineItemId,noBids:[{reason:_i.iu.NO_BID}]}}_v(t,i){return{coreTamRequestOutput:i,amazonBid:t.amazonBidList.find((t=&gt;t.amazonBidCode===i.coreTamCode))}}vv(t){return(0,yi.mG)(this,void 0,void 0,(function*(){const i=t.reduce(this.bv,[]);return this.Sv(i)}))}bv(t,i){return[...t,...i.amazonBidList.filter((t=&gt;t.amazonBidCode)).map((t=&gt;({lineItemId:i.lineItem.advertiserLineItemId,coreTamCode:t.amazonBidCode})))]}mv(t,i){return t.map((t=&gt;new Xe(t,i)))}Sv(t){return this.dv.callCoreTam(t)}pv(t){return new Promise(((i,e)=&gt;{if(!(0,W.$K)(this.wv))return void e(_i.iu.NO_LIB_IN_PAGE);const s={slotID:this.hv,mediaType:"video"};null!==t&amp;&amp;(s.slotParams={gpid:t}),this.wv.fetchBids({slots:[s]},(t=&gt;{(0,ot.BZ)(t)?i(t):e(_i.iu.EMPTY_RESPONSE)}))}))}uv(){return(0,yi.mG)(this,void 0,void 0,(function*(){if(!(0,W.$K)(this.wv)){if((0,W.QM)(this.ls.amazonTamPubId)){const t=yield this.Pv();return this.wv=t,void this.wv.init({pubID:this.ls.amazonTamPubId,deals:!0})}this.wv=this.cv[Ue]}}))}Mv(t){if(!this._i.isConsentRequired())return;const i=this._i.getConsentApiFromWindow();if((0,W.$K)(i)){const e=this._i.getGdprConsentApiType();(0,U.O7)(t,Qe.USER_CONSENT_API_MAPPING[e].windowPropertyName,i)}else(0,ft.FH)({message:"TamRequester_Required__tcfapi_NotFound",level:"Info"},{throttle:1,shouldSendMaxLog:!1})}Pv(){const t=new Be.o(this.nt,this.ks);return new Promise(((i,e)=&gt;{t.loadIframe({customHead:J.h`<style>body,html{display:none}</style>`,customHtml:J.h`<script aax2="" apstag.js"}"="" c.amazon-adsystem.com="" https:="" id="cnx-apstag-loader" src="${"></script>`,customIframeAttributes:[{key:"class",value:"cnx-apstag-loader"}],container:this.nt.querySelector("body"),visible:!1,title:dt.$b}).then((t=&gt;{if(this.Mv(t.iframe.contentWindow),t.iframe.contentWindow[Ue])return i(t.iframe.contentWindow[Ue]);e(new Error("Amazon TAM not found"))})).catch((t=&gt;{e((0,mt.W$)(t))}))}))}}var Ze=e(2283),ts=e(8602);const is=Ze.w.makeMessageType("contracts.core.atam.v1.AmazonTamRequest",(()=&gt;[{no:1,name:"line_item_id",kind:"scalar",T:9},{no:2,name:"code",kind:"scalar",T:9},{no:3,name:"metadata",kind:"message",T:ts.S}])),es=Ze.w.makeMessageType("contracts.core.atam.v1.AmazonTamResponse",(()=&gt;[{no:1,name:"error_message",kind:"scalar",T:9},{no:10,name:"encrypted_bid_price",kind:"scalar",T:9},{no:12,name:"obfuscated_price",kind:"scalar",T:1}]));class ss{constructor(t){this.ls=t}callCoreTam(t){return(0,yi.mG)(this,void 0,void 0,(function*(){const i=t.map((t=&gt;{const i=new is({code:t.coreTamCode,lineItemId:t.lineItemId,metadata:this.ls.adTrackingRequestMeta});return this.kv(i)}));return Promise.all(i)}))}kv(t){return(0,yi.mG)(this,void 0,void 0,(function*(){const{lineItemId:i,code:e}=t;try{const s=yield(0,te.Ou)({endpoint:Qi.n.endPoints.ads.api.tam,protoRequest:is,protoResponse:es,requestData:t,queryParams:{[Gi.Fk]:zi.g.version,[Gi.cc]:Qi.n.tier},shouldLogErrors:!0});return(0,W.QM)(s.errorMessage)?{lineItemId:i,coreTamCode:e,rejectReason:_i.iu.REQUEST_EXCEPTION}:(0,W.QM)(s.encryptedBidPrice)?{lineItemId:i,coreTamCode:e,coreTamBidResponse:s}:{lineItemId:i,coreTamCode:e,rejectReason:_i.iu.INVALID_RESPONSE}}catch(t){return{lineItemId:i,coreTamCode:e,rejectReason:_i.iu.REQUEST_EXCEPTION}}}))}}class rs{constructor(t,i,e){this.mp=t,this.xv=i,this.ls=e;const s=(0,h.AU)(Ki.w),{services:{GlobalDomUtilsService:r},config:{sessionId:n}}=this.mp;this.Lv=new Ke(this.mp,this.xv,new ss(this.ls),r,s.userManagerService,n,this.ls)}request(t){const{width:i,height:e}=t.callingState;return!(0,nt.ON)({width:i,height:e})?this.Cv(t).then((i=&gt;Promise.resolve(this.Tv(i,t)))).catch((()=&gt;Promise.resolve({bids:[],noBids:[]}))):Promise.resolve({bids:[],noBids:[]})}Cv(t){const i=t.lineItemRequestDataList.map((t=&gt;t.adManagerLineItem.protoLineItem));return this.Lv.requestBids(i)}Tv(t,i){const e={bids:[],noBids:[]};return t.forEach((t=&gt;{const s=Jt(i.lineItemRequestDataList,t.lineItemId),{protoLineItem:{trackerList:r},historicalMetrics:{requestNumber:n}}=s;t.bids.forEach((t=&gt;{const h=new Vi,o=new xi({encryptedPrice:t.encryptedPrice,requestNumber:n});ji(r,h),e.bids.push({requestMetadata:o,vastTracker:h,lineItem:s,url:t.vastTag,state:i.callingState,obfuscatedPrice:t.ofskp,shouldRequestWithCredentials:!1,slotId:t.slotId})})),t.noBids.forEach((t=&gt;{e.noBids.push({lineItem:s,requestMetadata:new xi({requestNumber:n}),reason:t.reason})}))})),e}}class ns{constructor(t){this.Bv=t}request(t){const{width:i,height:e}=t.callingState;if((0,nt.ON)({width:i,height:e}))return Promise.resolve({bids:[],noBids:[]});const s=t.lineItemRequestDataList[0].adManagerLineItem,{adxFloorPrice:r,historicalMetrics:n,protoLineItem:h}=s,{trackerList:o}=h;if(!(0,W.$K)(r))return(0,ft.FH)({message:"DynamicAdxCallAggregator_adxFloorPriceNotDefined",level:"Error"},{throttle:1,shouldSendMaxLog:!1}),Promise.resolve({bids:[],noBids:[]});const a=new Vi;ji(o,a);const d={bids:[{lineItem:s,vastTracker:a,requestMetadata:this.Ev(r,n.requestNumber,s),state:t.callingState,plcmt:this.Bv}],noBids:[]};return Promise.resolve(d)}Ev(t,i,e){const s=!!(0,h.AU)(ee.H).getIdForIma(e);return new xi({requestNumber:i,wasIiqLookupUsed:s,floorPriceInformation:new Ai.$({adxPredictedFloorPrice:(0,Zt.R)(t.adxData.predictedPriceObfuscated)}),requestedFloorPrice:t.price})}}const hs={HandlingSdkUrl:"HandlingSdkUrl",NetworkRequestUrl:"NetworkRequestUrl",InvalidCreativeType:"InvalidCreativeType",XmlInvalidString:"XmlInvalidString",XmlParseGeneral:"XmlParseGeneral",XmlInvalidTree:"XmlInvalidTree",XmlInvalidAd:"XmlInvalidAd",XmlAdaptorWrapperLimit:"XmlAdaptorWrapperLimit",VastVersionNotSupported:"VastVersionNotSupported",VastMediaFilesNotSupported:"VastMediaFilesNotSupported",HTMLUnknownMimeType:"HTMLUnknownMimeType",HTMLNotEnoughData:"HTMLNotEnoughData",ImaAdsManagerInit:"ImaAdsManagerInit",ImaVastEmptyResponse:"ImaVastEmptyResponse",ImaRequestException:"ImaRequestException",ImaTimeout:"ImaTimeout",ImaInvalidResponse:"ImaInvalidResponse",InvalidCreativeUrl:"InvalidCreativeUrl",BidIsNotTargetingAllowedEver:"BidIsNotTargetingAllowedEver",ExternalSdkTimeout:"ExternalSdkTimeout",ExternalSdkInvalidResponse:"ExternalSdkInvalidResponse",VastContainsBannedUrls:"VastContainsBannedUrls"},os={[hs.HandlingSdkUrl]:_i.iu.CS_REQUEST_EXCEPTION,[hs.NetworkRequestUrl]:_i.iu.CS_REQUEST_EXCEPTION,[hs.InvalidCreativeType]:_i.iu.CS_INVALID_RESPONSE,[hs.XmlInvalidString]:_i.iu.CS_EMPTY_RESPONSE,[hs.XmlParseGeneral]:_i.iu.CS_INVALID_RESPONSE,[hs.XmlInvalidTree]:_i.iu.CS_INVALID_RESPONSE,[hs.XmlInvalidAd]:_i.iu.CS_INVALID_RESPONSE,[hs.XmlAdaptorWrapperLimit]:_i.iu.CS_INVALID_RESPONSE,[hs.VastVersionNotSupported]:_i.iu.VAST_VERSION_NOT_SUPPORTED,[hs.HTMLUnknownMimeType]:_i.iu.CS_INVALID_RESPONSE,[hs.HTMLNotEnoughData]:_i.iu.CS_INVALID_RESPONSE,[hs.ImaAdsManagerInit]:_i.iu.CS_REQUEST_EXCEPTION,[hs.ImaVastEmptyResponse]:_i.iu.CS_INVALID_RESPONSE,[hs.ImaRequestException]:_i.iu.CS_REQUEST_EXCEPTION,[hs.ImaTimeout]:_i.iu.TIMEOUT,[hs.ImaInvalidResponse]:_i.iu.CS_INVALID_RESPONSE,[hs.InvalidCreativeUrl]:_i.iu.CS_REQUEST_EXCEPTION,[hs.BidIsNotTargetingAllowedEver]:_i.iu.BID_IS_NOT_TARGETING_ALLOWED_EVER,[hs.VastMediaFilesNotSupported]:_i.iu.CS_INVALID_RESPONSE,[hs.ExternalSdkTimeout]:_i.iu.TIMEOUT,[hs.ExternalSdkInvalidResponse]:_i.iu.CS_INVALID_RESPONSE,[hs.VastContainsBannedUrls]:_i.iu.VAST_HAS_BANNED_URLS};var as=e(5695);class ds{constructor(){this.Dv=new s.x}get onVpaidEvent(){return this.Dv.asObservable()}hasErrorInsideIframe(){return!1}handshakeVersion(t="2.0"){return"2.0"}}class cs{constructor(t){this.Rv=t,this.Ov=new Map,(0,W.$K)(this.Rv.settings.bidLifecycle)||(this.Rv.settings.bidLifecycle={})}get Fv(){return this.Ov.get(3)&amp;&amp;this.Ov.get(2)?this.Ov.get(3)-this.Ov.get(2):0}get Vv(){return this.Ov.get(1)&amp;&amp;this.Ov.get(0)?this.Ov.get(1)-this.Ov.get(0):0}get Nv(){return this.Ov.get(3)&amp;&amp;this.Ov.get(4)?this.Ov.get(4)-this.Ov.get(3):0}onTrackingLifecycleEvent(t){switch(this.Ov.set(t,Date.now()),t){case 1:this.Uv();break;case 3:this.Wv();break;case 4:this.qv()}}Uv(){this.Rv.settings.bidLifecycle.winToAdLoadedTime=this.Vv}Wv(){this.Rv.settings.bidLifecycle.startAdToImpressionTime=this.Fv}qv(){this.Rv.settings.bidLifecycle.adImpressionToAdReplacedTime=this.Nv}}e(1825);const ls=[ct.f.AdImpression,ct.f.AdSkipped,ct.f.AdStopped,ct.f.AdError,ct.f.AdVideoFirstQuartile,ct.f.AdVideoMidpoint,ct.f.AdVideoThirdQuartile,ct.f.AdVideoComplete],us="cnx-ad-bid-slot-selected",ps="Connatix Ad";class vs extends ds{constructor(t,i){super(),this.Xt=t,this.settings=i,this.bidStatusHistory=[],this.zv=null,this.Hv=null,this.Gv=null,this.Jv=null,this.Yv=null,this.Xv=null,this.Kv=void 0,this.Qv=new s.x,this.Zv=new s.x,this.tg=!1,this.eg=!1,this.ig=!1,this.sg=!1,this.rg=!1,this.ng=!1,this.og=!1,this.ag=!1,this.hg=[],this.dg=null,this.cg=new s.x,this.Li=[],this.lg=!1,this.ug=!1,this.pg=()=&gt;{this.mg=402,this.vg({type:ct.f.AdError,payload:{errorCode:402,errorMessage:"timeout_loaded"}}),this.gg()},this.fg=()=&gt;{this.vg({type:ct.f.AdError,payload:{errorMessage:"timeout",errorCode:304}}),this.hg.length&amp;&amp;(0,ft.FH)({message:"BidAdaptor_ImpressionTimeout",exception:`advertiserLineItemId:${this.settings.adManagerLineItem.protoLineItem.advertiserLineItemId}_creativeId:${this.creativeId}_bidid:${this.settings.bidId}`,callStack:JSON.stringify(this.hg),level:"Warn",sessionId:this.settings.sessionId}),this.gg()},this.Ig=()=&gt;{this.Ag(),this.yg("VIEWABLE_IMPRESSION_TIMEOUT").clearTimeout(),this.settings.viewabilityService.off(this.Gv,this._g)},this._g=t=&gt;{const i=this.yg("VIEWABLE_IMPRESSION_TIMEOUT");this.cg.next(t),t?i.timeoutHandle.timeoutId||i.setTimeout():i.clearTimeout()},this.bg=()=&gt;{this.vg({type:ct.f.AdSkipped}),this.gg()},this.Sg=()=&gt;{this.vg({type:ct.f.AdStopped,payload:{shouldTrackPostBid:!0}}),this.gg()},this.yg=t=&gt;{const i=this.wg[t];return{timeoutHandle:i,setTimeout:()=&gt;{i.timeoutId=this.Xt.setTimeout((()=&gt;{i.callback()}),i.timeout)},clearTimeout:()=&gt;{null!==i.timeoutId&amp;&amp;(this.Xt.clearTimeout(i.timeoutId),i.timeoutId=null)}}},this.status=kt.IDLE,this.price=this.settings.price,this.yoScore=this.settings.yoScore,this.Pg=Date.now(),this.Mg=this.settings.vastResponse,this.creativeId=this.settings.externalCreativeId,this.kg=`cnx-ad-bid-slot-id-${this.settings.requestMetadata.data.cnxBidId}`,this.xg=`cnx-ad-slot-${this.settings.bidId}`,this.ug=!!i.vpMuteRemoved;const{adType:e}=this.settings.adManagerLineItem.protoLineItem;this.wg={IMPRESSION_TIMEOUT:{callback:this.fg,timeout:25e3,timeoutId:null},VIEWABLE_IMPRESSION_TIMEOUT:{callback:this.Ig,timeout:dt.xs[e],timeoutId:null},SKIP_AD_TIMEOUT:{callback:this.bg,timeout:500,timeoutId:null},STOP_AD_TIMEOUT:{callback:this.Sg,timeout:500,timeoutId:null},AD_LOADED_TIMEOUT:{callback:this.pg,timeout:25e3,timeoutId:null}},this.Lg=i.urlSuffixerService}get vpMuteRemoved(){return this.ug}get vastResponse(){return this.Mg}get status(){return this.Cg}get onStatusChanged(){return this.Qv.asObservable()}get createdTimestamp(){return this.Pg}get loadingTimeMs(){return this.Tg}get startingTimeMs(){return this.Bg}get started(){return this.sg}get errorReason(){return this.Eg}get blockedUrl(){return this.Dg}get vastErrorCode(){return this.mg}get shouldTrackPostbid(){return this.lg}get onAdSlotViewabilityChanged(){return this.cg.asObservable()}get wasAdReplaced(){return this.tg}get replacedBid(){return this.Rg}get impressionStarted(){return this.eg}get creativeId(){return this.Kv}get onAdViewableImpression(){return this.Zv.asObservable()}get skipOffset(){var t,i,e;return null===(e=null===(i=null===(t=this.settings.adLoadedPayload)||void 0===t?void 0:t.payload)||void 0===i?void 0:i.adLoadedData)||void 0===e?void 0:e.skipOffset}set status(t){this.Cg=t,this.bidStatusHistory.push(kt[t]),this.Qv.next(t),t===kt.INVALIDATED&amp;&amp;this.Og()}set creativeId(t){(0,W.QM)(this.creativeId)||(this.Kv=t)}getSlotId(){return this.xg}invalidate(){this.sg||(this.status=kt.INVALIDATED)}skipAd(){this.yg("SKIP_AD_TIMEOUT").setTimeout()}stopAd(t){this.yg("STOP_AD_TIMEOUT").setTimeout()}startAd(){const{adManagerLineItem:t,bidId:i,requestMetadata:e,sessionId:s}=this.settings;this.Fg=Date.now(),this.sg=!0,this.status=kt.STARTING,this.og&amp;&amp;(0,ft.FH)({message:"AdManager_ABaseBidAdaptor_samebid",exception:"startAd",callStack:`adv:${t.protoLineItem.advertiserLineItemId} bidid: ${this.xg}`,level:"Critical",sessionId:s}),this.og=!0,this.yg("IMPRESSION_TIMEOUT").setTimeout()}initAd(t,i,e,s,r,n,h){this.Vg=Date.now(),this.status=kt.LOADING,this.ng&amp;&amp;(0,ft.FH)({message:"AdManager_ABaseBidAdaptor_samebid",exception:"initAd",callStack:`adv:${this.settings.adManagerLineItem.protoLineItem.advertiserLineItemId} bidid: ${this.xg}`,level:"Critical",sessionId:this.settings.sessionId}),this.ng=!0,this.yg("AD_LOADED_TIMEOUT").setTimeout(),this.Ng(h),this.$g=new cs(this),this.$g.onTrackingLifecycleEvent(0)}setAdVolume(t){this.Jv.volume=t,(0,U.Q1)(this.Jv,t),t&lt;=0?this.settings.adEnforcer.start(1):this.settings.adEnforcer.stop(1)}markAdAsReplaced(){this.tg=!0,this.$g.onTrackingLifecycleEvent(4)}setReplacedBid(t){this.Rg||(this.Rg=t)}getTrackerSlot(){return this.Yv}Ug(t){const{adManagerLineItem:{protoLineItem:{adType:i,skipMode:e}}}=this.settings,{verificationScriptResources:s,containers:r,skipOffset:n}=t.payload,h={type:ct.f.AdLoaded,payload:{adType:i,adLoadedData:{skipOffset:(0,W.hj)(n)?n:void 0},adSkipMode:e,vastVerifications:s,containers:r}};return this.settings.adLoadedPayload=h,h}Wg(){if(this.Yv){const t=this.Yv.getAttribute("aria-hidden");this.Yv.setAttribute("aria-hidden","true"===t?"false":"true")}}jg(t){const{adManagerLineItem:{protoLineItem:{adType:i,skipMode:e,cnxCreativeId:s,advertiserLineItemId:r}},requestMetadata:{data:{rtbAdomain:n,rtbCampainId:h}}}=this.settings;return{type:ct.f.AdImpression,payload:{adType:i,adSkipMode:e,adSourceData:{creativeId:s,adId:r,length:this.getAdDuration(),adVideoUrl:this.adVideoUrl,name:ps,skipOffset:this.skipOffset},customAdData:{ADVERTISER:n,CREATIVE_ID:this.creativeId,CAMPAIGN_ID:h}}}}qg(t){const{adManagerLineItem:{protoLineItem:{adType:i,skipMode:e,cnxCreativeId:s,advertiserLineItemId:r}},requestMetadata:{data:{rtbAdomain:n,rtbCampainId:h}}}=this.settings;return{type:ct.f.AdVideoStart,payload:{adType:i,adSkipMode:e,adSourceData:{creativeId:s,adId:r,length:this.getAdDuration(),name:ps},customAdData:{ADVERTISER:n,CREATIVE_ID:this.creativeId,CAMPAIGN_ID:h},logInMobiInfo:t.payload.logInMobiInfo}}}zg(t){this.vg({type:ct.f.AdError,payload:{errorMessage:`invalidVpaidEvent-${t.type}`,errorCode:900}})}vg(t){if(t.payload||(t.payload={}),this.Hg(t.type),t.payload.adType=this.settings.adManagerLineItem.protoLineItem.adType,!this.Gg(t))return void this.zg(t);const{adManagerLineItem:i,bidId:e,requestMetadata:s}=this.settings,{cnxBidId:r}=s.data;switch(t.type){case ct.f.AdLoaded:0,this.$g.onTrackingLifecycleEvent(1),this.yg("AD_LOADED_TIMEOUT").clearTimeout(),this.Dv.next(this.Ug(t)),this.ig=!0,this.Tg=(0,W.hj)(this.Vg)?Date.now()-this.Vg:0,this.status=kt.LOADED;break;case ct.f.AdImpression:this.Bg=(0,W.hj)(this.Fg)?Date.now()-this.Fg:0,this.$g.onTrackingLifecycleEvent(3),this.yg("IMPRESSION_TIMEOUT").clearTimeout(),this.Jg(),(0,U.cn)(this.Yv,us),this.Wg(),this.Dv.next(this.jg(t)),this.eg=!0,this.status=kt.IMPRESSION;break;case ct.f.AdVideoStart:this.$g.onTrackingLifecycleEvent(2),this.Dv.next(this.qg(t));break;case ct.f.AdStopped:case ct.f.AdSkipped:case ct.f.AdError:this.Yg(t);break;case ct.f.AdClickThru:i.protoLineItem.advertiserLineItemId===F&amp;&amp;(0,ft.FH)({message:"Sovrn_AddGenerator_ClickThru",exception:`url:${t.payload.url}`,level:"Info"},{pacing:5}),this.Dv.next({adClickThru:t.payload.url,type:t.type,payload:{adType:i.protoLineItem.adType}});break;default:this.Dv.next(t)}}Yg(t){var i;this.rg?(0,ft.FH)({message:"AdManager_ABaseBidAdaptor_double_destroy",exception:this.settings.adManagerLineItem.protoLineItem.advertiserLineItemId,level:"Warn",sessionId:this.settings.sessionId}):((0,W.hj)(this.Tg)||((0,W.hj)(this.Vg)?this.Tg=Date.now()-this.Vg:this.Tg=0),(0,W.hj)(this.Bg)||((0,W.hj)(this.Fg)?this.Bg=Date.now()-this.Fg:this.Bg=0),ct.f.AdError===t.type&amp;&amp;(this.Eg=t.payload.errorMessage,this.Dg=t.payload.blockedUrl,this.lg=!0),ct.f.AdStopped===t.type&amp;&amp;(this.Eg="adStopped",this.lg=!!(null===(i=t.payload)||void 0===i?void 0:i.shouldTrackPostBid)),ct.f.AdSkipped===t.type&amp;&amp;(this.Eg="adStopped",this.lg=!1),this.Og(),this.Dv.next(t),this.Cg!==kt.INVALIDATED&amp;&amp;(this.ig?this.status=kt.CONSUMED_LOADED:(this.Cg!==kt.LOADING&amp;&amp;(0,ft.FH)({message:"Bid_idle_consumed",level:"Warn",sessionId:this.settings.sessionId},{throttle:1,shouldSendMaxLog:!1}),this.status=kt.CONSUMED_LOADING)))}Xg(){return this.settings.adSlotContainerRecycler.requestAdSlot(this.settings.adContainer)}Og(){try{this.rg=!0,this.Yv&amp;&amp;((0,U.IV)(this.Yv,us),(0,U.IV)(this.Yv,this.kg),this.Yv.removeAttribute("id")),this.Gv&amp;&amp;this.Gv.removeAttribute("id"),this.Wg(),(0,o.i)(this.Li),this.gg(),this.settings.adEnforcer.deregisterContainer(this.Yv),this.settings.viewabilityService.off(this.Gv,this._g),null!==this.dg&amp;&amp;this.Xt.clearTimeout(this.dg),this.Kg()}catch(t){this.Qg("ABaseBidAdaptor","_destroy",(0,mt.W$)(t))}}Kg(){this.dg=this.Xt.setTimeout((()=&gt;{this.settings.adSlotContainerRecycler.destroyAdSlot(this.Xv)}),500)}Ag(){const{adManagerLineItem:{protoLineItem:{advertiserLineItemId:t,publisherLineItemId:i}},requestMetadata:{data:{rtbSeatId:e,dspId:s,rtbAdomain:r}}}=this.settings;this.Zv.next({advertiserLineItemId:t,publisherLineItemId:i,rtbSeatId:e,dspId:s,rtbAdomain:r})}Jg(){const t=dt.fJ,i=this.Gv;this.settings.viewabilityService.on(i,this._g,{threshold:t}),this._g(this.settings.viewabilityService.check({threshold:t,element:i}))}Qg(t,i,e){const s=this.settings.adManagerLineItem.protoLineItem.advertiserLineItemId,r=this.creativeId;(0,ft.FH)({message:`AdManager_${t}_${i}`,exception:`advertiserLineItemId:${s}_creativeId:${r}_errorMessage:${null==e?void 0:e.message}`,callStack:null==e?void 0:e.stack,level:"Warn",sessionId:this.settings.sessionId},{throttle:10})}Ng(t){this.Xv=this.Xg(),this.Yv=this.Xv.slotsContainer,(0,U.cn)(this.Yv,this.kg),this.Gv=this.Xv.adSlot,this.Gv.id=this.xg;const i=this.settings.adManagerLineItem.protoLineItem.adType===r.Z9.VIDEO_VIDEO?"video":"display";(0,U.cn)(this.Gv,`cnx-ad-slot-${i}-type`),this.Yv.id=this.settings.bidSlotId,this.Jv=this.Xv.videoSlot,this.Jv.volume=t,(0,U.Q1)(this.Jv,t),this.settings.adEnforcer.registerContainer(this.Yv,this.xg),this.Li.push(this.settings.adEnforcer.onEnforcerEvent.subscribe((t=&gt;{this.Zg(t)}))),this.settings.adEnforcer.start(15)}gg(){Object.keys(this.wg).forEach((t=&gt;{this.yg(t).clearTimeout()}))}Gg(t){return!(!this.eg&amp;&amp;(t.type===ct.f.AdStopped||t.type===ct.f.AdSkipped))}Zg(t){if(t.detectedContainer!==this.Yv)return;let i;switch(t.type){case"baduri_detected":i="AdManager_enforcer_BadUri";break;case"malware_detected":i="AdManager_enforcer_malware",this.vg({type:ct.f.AdError,payload:{errorMessage:"malwareDetected",errorCode:900}});break;case"volume_detected":i="AdManager_enforcer_soundBlock",this.vg({type:ct.f.AdError,payload:{errorMessage:"volumeDetected",errorCode:900}})}(0,ft.FH)({message:i,exception:t.message,level:"Warn",sessionId:this.settings.sessionId,callStack:`advertiserLineItemId:${this.settings.adManagerLineItem.protoLineItem.advertiserLineItemId}_publisherLineItemId:${this.settings.adManagerLineItem.protoLineItem.publisherLineItemId}_creativeId:${this.settings.externalCreativeId}_html:${this.settings.htmlToLog}`})}Hg(t){if(!this.ng&amp;&amp;(ls.includes(t)||t===ct.f.AdLoaded)){if(this.hg.push(t),this.ag)return;this.ag=!0,(0,ft.FH)({message:`${this.adMediaType||""}BidAdaptor_AdIdle_${t}BeforeInitAd`,exception:`advertiserLineItemId:${this.settings.adManagerLineItem.protoLineItem.advertiserLineItemId}_creativeId:${this.creativeId}_bidid:${this.settings.bidId}`,callStack:"PostBidInitAd",level:"Warn",sessionId:this.settings.sessionId})}if(this.ig&amp;&amp;!this.og&amp;&amp;ls.includes(t)){if(this.hg.push(t),this.ag)return;this.ag=!0,(0,ft.FH)({message:`${this.adMediaType||""}BidAdaptor_AdLoaded_${t}WithoutStartAd`,exception:`advertiserLineItemId:${this.settings.adManagerLineItem.protoLineItem.advertiserLineItemId}_creativeId:${this.creativeId}_bidid:${this.settings.bidId}`,callStack:"PostBidStartAd",level:"Warn",sessionId:this.settings.sessionId})}}}const ms={Html:"text/html",Javascript:"application/javascript"};var gs=e(6623);const fs=J.h`<div aria-label="Close ad" class="${$.p0.CloseButton}" role="button" tabindex="0">${'<svg viewbox="0 0 73 18" xmlns="http://www.w3.org/2000/svg"><path d="M32.266 8.293c-.105.902-.439 1.6-1.002 2.092s-1.303.732-2.233.732c-1.008 0-1.816-.361-2.426-1.084s-.908-1.689-.908-2.9v-.82c0-.793.141-1.49.422-2.092s.688-1.062 1.207-1.383 1.121-.486 1.805-.486c.906 0 1.633.254 2.18.762s.865 1.203.955 2.098h-1.131c-.098-.68-.311-1.172-.639-1.477s-.779-.457-1.365-.457c-.719 0-1.283.266-1.693.797s-.609 1.287-.609 2.268v.826c0 .926.193 1.662.58 2.209s.928.82 1.623.82c.625 0 1.104-.141 1.436-.422s.559-.779.668-1.482h1.131zM34.815 11h-1.084V2h1.084v9zm1.453-3.229c0-.621.121-1.18.363-1.676s.586-.879 1.02-1.148a2.79 2.79 0 0 1 1.494-.404c.863 0 1.561.299 2.092.897s.803 1.393.803 2.385V7.9c0 .617-.119 1.172-.357 1.664a2.67 2.67 0 0 1-1.014 1.143c-.437.273-.941.41-1.512.41-.859 0-1.557-.299-2.092-.896s-.797-1.389-.797-2.373v-.076zm1.09.129c0 .703.162 1.268.486 1.693a1.57 1.57 0 0 0 1.312.639c.551 0 .988-.215 1.313-.645s.486-1.039.486-1.816c0-.695-.166-1.258-.498-1.687a1.56 1.56 0 0 0-1.312-.65c-.535 0-.967.213-1.295.639s-.492 1.035-.492 1.828zm9.732 1.418c0-.293-.111-.52-.334-.68s-.604-.305-1.154-.422-.982-.258-1.307-.422-.559-.359-.715-.586-.229-.496-.229-.809c0-.52.219-.959.656-1.318s1.004-.539 1.688-.539c.719 0 1.301.186 1.746.557s.674.846.674 1.424h-1.09c0-.297-.127-.553-.381-.768s-.566-.322-.949-.322c-.395 0-.703.086-.926.258a.81.81 0 0 0-.334.674c0 .262.104.459.311.592s.58.26 1.119.381.983.266 1.318.434.584.371.744.609a1.5 1.5 0 0 1 .246.861 1.63 1.63 0 0 1-.68 1.365c-.453.34-1.041.51-1.764.51-.508 0-.957-.09-1.348-.27s-.697-.43-.92-.75a1.84 1.84 0 0 1-.328-1.049h1.084c.02.363.164.652.433.867s.633.316 1.078.316c.41 0 .738-.082.984-.246a.77.77 0 0 0 .375-.668zm5.127 1.799c-.859 0-1.559-.281-2.098-.844s-.809-1.322-.809-2.267v-.199c0-.629.119-1.189.358-1.682s.578-.883 1.008-1.16a2.56 2.56 0 0 1 1.406-.422c.824 0 1.465.271 1.922.814s.686 1.32.686 2.332v.451h-4.295c.016.625.197 1.131.545 1.518s.797.574 1.336.574c.383 0 .707-.078.973-.234a2.44 2.44 0 0 0 .697-.621l.662.516c-.531.816-1.328 1.225-2.391 1.225zm-.135-5.684a1.44 1.44 0 0 0-1.102.481c-.297.316-.48.762-.551 1.336h3.176v-.082c-.031-.551-.18-.977-.445-1.277s-.625-.457-1.078-.457zM62.84 11c-.062-.125-.113-.348-.152-.668-.504.523-1.105.785-1.805.785-.625 0-1.139-.176-1.541-.527a1.71 1.71 0 0 1-.598-1.348c0-.66.25-1.172.75-1.535s1.211-.551 2.121-.551h1.055v-.498c0-.379-.113-.68-.34-.902s-.561-.34-1.002-.34c-.387 0-.711.098-.973.293s-.393.432-.393.709h-1.09c0-.316.111-.621.334-.914s.531-.531.914-.703.811-.258 1.272-.258c.73 0 1.303.184 1.717.551s.629.865.645 1.506v2.918c0 .582.074 1.045.223 1.389V11H62.84zm-1.799-.826c.34 0 .662-.088.967-.264s.525-.404.662-.686v-1.3h-.85c-1.328 0-1.992.389-1.992 1.166 0 .34.113.605.34.797s.517.287.873.287zm4.148-2.396c0-.973.23-1.754.691-2.344a2.18 2.18 0 0 1 1.811-.891c.742 0 1.33.254 1.764.762V2h1.084v9h-.996l-.053-.68c-.434.531-1.037.797-1.811.797a2.17 2.17 0 0 1-1.799-.902c-.461-.601-.691-1.387-.691-2.355v-.082zm1.084.123c0 .719.148 1.281.445 1.687s.707.609 1.23.609c.688 0 1.189-.309 1.506-.926V6.359a1.59 1.59 0 0 0-1.494-.896c-.531 0-.945.205-1.242.615s-.445 1.018-.445 1.822zM16 1.41L14.59 0 9 5.59 3.41 0 2 1.41 7.59 7 2 12.59 3.41 14 9 8.41 14.59 14 16 12.59 10.41 7 16 1.41z"></path></svg>'}</div>`;class Is{constructor(t){this.tf=new s.x,this.ef=new s.x,this.if=new s.x,this.sf=new s.x,this.rf=new s.x,this.nf="",this.af="div-cnx-display",this.hf=()=&gt;{this.ef.next()},this.df=t.shouldEmbedDisplayAdInSafeIframe,this.nt=t.globalDomUtilsService,this.cf=t.adType,this.Gv=t.adContainer,this.ks=t.sessionId,this.ds=t.advertiserLineItemId,this.lf=t.htmlTemplate,this.uf=t.mime,this.pf=t.adSize}get onDisplayAd(){return this.tf.asObservable()}get onError(){return this.if.asObservable()}get onClickClose(){return this.ef.asObservable()}get onClickAd(){return this.sf.asObservable()}get onClickThruAd(){return this.rf.asObservable()}destroy(){this.vf&amp;&amp;(this.vf.removeEventListener("click",this.hf),this.gf.removeChild(this.vf))}ff(t){this.Im=new Be.o(this.nt,this.ks),this.gf=t?this.If(this.Gv,t):this.Gv;const i=`<div id="${this.af}">${this.uf===ms.Html?this.lf:""}</div>`;let e="",s="";switch(this.cf){case r.Z9.VIDEO_OVERLAY:e=`#${this.af}{position:absolute;left:50%;top:50%;transform:translate(-50%,-50%)}`,s=`#${this.af}{border:3px solid white}`;break;case r.Z9.VIDEO_NON_LINEAR:e=`#${this.af}{width: 100%; height: 100%}`}return this.nf="html, body {position:relative;width:100%;height:100%}"+e+s+"#"+this.af+" iframe{display:block}",this.Im.loadIframe({customHead:J.h`<style>${this.nf}</style>`,customHtml:i,container:this.gf,customReportingLog:{heavyAdBlockTypeEnum:gs.l.OVERLAY_IFRAME,advertiserLineItemId:this.ds},iframePosition:this.cf===r.Z9.VIDEO_NON_LINEAR?"relative":"absolute",iframeCustomDimensions:this.pf||void 0,iframePointerEvents:"all",title:dt.$b,safeIframeSettings:{isEnabled:this.df,mode:"DISPLAY"},iframeId:this.df?"cnx-iframe_"+(0,mt.qs)():""}).then((t=&gt;(this.cf===r.Z9.VIDEO_NON_LINEAR&amp;&amp;this.Af(),t)))}If(t,i){if(!i.width||!i.height)return t;let e,s;if(this.cf===r.Z9.VIDEO_NON_LINEAR)e=s="100%";else e=i.width+"px",s=i.height+"px";const n=this.nt.createElementByString(`<div class="cnx-iframe-container" style="width: ${e}; height: ${s}"></div>`);return t.appendChild(n),n}Af(){this.vf=this.nt.createElementByString(fs),this.gf.appendChild(this.vf),this.vf.addEventListener("click",this.hf)}}class ys extends Is{constructor(){super(...arguments),this.yf=()=&gt;{this.sf.next()},this._f=()=&gt;{(0,U.dA)(this.bf)?this.rf.next():this.sf.next()}}createBanner(t){this.ff(t).then((t=&gt;{this.Sf=t.iframe;const i=this.Sf.contentWindow;if(this.wf=i.document.getElementById(this.af),this.uf===ms.Javascript&amp;&amp;(0,U.ML)(this.wf,i,this.lf),""===this.Sf.contentWindow.document.head.innerHTML){const t=this.nf;this.Pf(t)}this.cf===r.Z9.VIDEO_NON_LINEAR&amp;&amp;this.Mf(),this.cf===r.Z9.VIDEO_OVERLAY&amp;&amp;this.kf(),this.onDisplayBanner()})).catch((t=&gt;{const{message:i}=(0,mt.W$)(t);(0,ft.FH)({message:"DisplayAd_friendltiframe_not_loaded",level:"Warn",exception:i},{pacing:5}),this.if.next()}))}onDisplayBanner(){this.tf.next()}getAdMediaDimensions(){return{width:this.wf.clientWidth||this.Sf.contentWindow.document.body.clientWidth,height:this.wf.clientHeight||this.Sf.contentWindow.document.body.clientHeight}}destroy(){var t,i;super.destroy(),this.Sf&amp;&amp;this.Gv&amp;&amp;(0,U.bX)(this.Sf),this.Im&amp;&amp;(this.Im.destroy(),this.Im=null),null===(t=this.wf)||void 0===t||t.removeEventListener("click",this.yf),this.cf===r.Z9.VIDEO_OVERLAY&amp;&amp;(null===(i=this.bf)||void 0===i||i.removeEventListener("click",this._f))}Mf(){var t;null===(t=this.wf)||void 0===t||t.addEventListener("click",this.yf)}kf(){this.bf=(0,U.sc)(this.wf),this.bf.addEventListener("click",this._f,!0)}Pf(t){const i=this.Sf.contentWindow.document.createElement("style"),e=this.Sf.contentWindow.document.createTextNode(t);i.appendChild(e),this.Sf.contentWindow.document.head.appendChild(i)}}class As extends Is{constructor(){super(...arguments),this.xf=null,this.pe=null,this.Lf=null,this.Cf=null,this.Tf=t=&gt;{if(!t.data)return;if(this.pe&amp;&amp;this.pe!==t.source)return;const{type:i,cnxIframeId:e,payload:s}=t.data;if(i&amp;&amp;e&amp;&amp;(!this.Lf||this.Lf===e))switch(i){case"adCreated":this.pe=t.source,this.Cf=s,this.tf.next();break;case"onClickAd":this.sf.next();break;case"onClickThruAd":this.rf.next();break;case"onError":{const{message:t,stack:i}=(0,mt.W$)(s);(0,ft.FH)({level:"Warn",message:"DisplayAdSafeIframeWrapper_bridge_error",exception:t,callStack:i},{pacing:5}),this.if.next();break}}}}createBanner(t){this.ff(t).then((t=&gt;{if(this.Sf=t.iframe,this.xf=t.iframe.contentWindow,this.Lf=t.iframe.id,!this.xf)throw new Error("DisplayAdSafeIframeWrapper_missing_target_window");window.addEventListener("message",this.Tf),this.onDisplayBanner()})).catch((t=&gt;{const{message:i}=(0,mt.W$)(t);(0,ft.FH)({message:"DisplayAd_safeiframe_not_loaded",level:"Warn",exception:i},{pacing:5}),this.if.next()}))}onDisplayBanner(){const t={customHead:this.nf,htmlSource:this.lf,sourceType:this.uf,adType:this.cf};this.Bf("createAd",t)}getAdMediaDimensions(){var t,i;return{width:null===(t=this.Cf)||void 0===t?void 0:t.width,height:null===(i=this.Cf)||void 0===i?void 0:i.height}}destroy(){super.destroy(),null===window||void 0===window||window.removeEventListener("message",this.Tf),this.Lf&amp;&amp;this.xf&amp;&amp;this.Bf("destroy"),this.Sf&amp;&amp;this.Gv&amp;&amp;(0,U.bX)(this.Sf),this.Im&amp;&amp;(this.Im.destroy(),this.Im=null)}Bf(t,i){if(!this.Lf)return void(0,ft.FH)({level:"Warn",message:"DisplayAdSafeIframeWrapper_missing_iframe_id",exception:t},{throttle:1,shouldSendMaxLog:!1});if(!this.xf)return void(0,ft.FH)({level:"Warn",message:"DisplayAdSafeIframeWrapper_missing_target_window",exception:t},{throttle:1,shouldSendMaxLog:!1});const e={type:t,cnxIframeId:this.Lf};i&amp;&amp;(e.payload=i),this.xf.postMessage(e,{targetOrigin:"*"})}}class bs{constructor(t,i,e,r,n,h,o,a){this.Ef=t,this.Df=i,this.ds=e,this.nt=r,this.ks=n,this.cf=h,this.Rf=o,this.df=a,this.tf=new s.x,this.ef=new s.x,this.if=new s.x,this.sf=new s.x,this.rf=new s.x,this.Li=[]}get onDisplayAd(){return this.tf.asObservable()}get onError(){return this.if.asObservable()}get onClickClose(){return this.ef.asObservable()}get onClickAd(){return this.sf.asObservable()}get onClickThruAd(){return this.rf.asObservable()}initializeAd(t,i){try{const e={shouldEmbedDisplayAdInSafeIframe:this.df,globalDomUtilsService:this.nt,adType:this.cf,adContainer:t,sessionId:this.ks,advertiserLineItemId:this.ds,htmlTemplate:this.Df,mime:this.Ef};if(this.cf===r.Z9.VIDEO_NON_LINEAR){const{width:t,height:i}=this.Rf;e.adSize={width:t,height:i}}this.df?this.Of=new As(e):this.Of=new ys(e),this.Li.push(this.Of.onDisplayAd.subscribe((()=&gt;{this.tf.next()})),this.Of.onError.subscribe((()=&gt;{this.if.next("displayIntegratorIframeLoad")})),this.Of.onClickClose.subscribe((()=&gt;{this.ef.next()})),this.Of.onClickAd.subscribe((()=&gt;{this.sf.next()})),this.Of.onClickThruAd.subscribe((()=&gt;{this.rf.next()}))),this.Of.createBanner(i)}catch(t){this.if.next("wrapperInitAdError")}}getAdMediaDimensions(){var t;return null===(t=this.Of)||void 0===t?void 0:t.getAdMediaDimensions()}destroy(){var t;(0,o.i)(this.Li),null===(t=this.Of)||void 0===t||t.destroy()}}var _s=e(9493);const xs={0:ct.f.AdVideoFirstQuartile,1:ct.f.AdVideoMidpoint,2:ct.f.AdVideoThirdQuartile,3:ct.f.AdVideoComplete};class Ss extends vs{constructor(t,i,e){var s;let n;super(i,e),this.Ff=t,this.Xt=i,this.settings=e,this.adSourceType=as.wS.AD_SOURCE_TYPE_UNSPECIFIED,this.As=500,this.Vf=[],this.settings.adManagerLineItem.protoLineItem.adType===r.Z9.VIDEO_NON_LINEAR?(this.adMediaType="displayHtmlNonLinear",this.Nf="htmlNonLinear",n=null===(s=this.settings.adManagerLineItem.protoLineItem.nonlinearLineItemSettings)||void 0===s?void 0:s.adTimeSeconds):(this.adMediaType="displayHtml",this.Nf="html",n=this.settings.adManagerLineItem.protoLineItem.overlayTimeSeconds);const h=n*ri.s_;this.$f=new _s.B(this.Xt,h,this.As),this.Vf.push(this.$f.onTimeUpdate.subscribe((()=&gt;{this.vg({type:ct.f.AdRemainingTimeChange})})),this.$f.onTimeElapsed.subscribe((()=&gt;{this.stopAd("htmlTimerElapsed")})),this.$f.onQuartile.subscribe((t=&gt;{this.vg({type:xs[t],payload:{}})})))}get adVideoUrl(){return this.Nf}get declaredDurationInSeconds(){return this.settings.adManagerLineItem.protoLineItem.overlayTimeSeconds}initAd(t,i,e,s,r,n,h){try{super.initAd(t,i,e,s,r,n,h),this.Uf=t,this.Wf=i,this.vg({type:ct.f.AdLoaded,payload:{}})}catch(t){const{message:i}=(0,mt.W$)(t);this.vg({type:ct.f.AdError,payload:{errorMessage:`adaptorInitAdError_${i}`,errorCode:900}})}}startAd(){try{super.startAd(),this.jf=new bs(this.settings.mime,this.settings.html,this.settings.adManagerLineItem.protoLineItem.advertiserLineItemId,this.settings.globalDomUtilsService,this.settings.sessionId,this.settings.adManagerLineItem.protoLineItem.adType,this.settings.dimensions,this.Ff.shouldEmbedDisplayAdInSafeIframe),this.Vf.push(this.jf.onDisplayAd.subscribe((()=&gt;{this.$f.start(),this.vg({type:ct.f.AdStarted}),this.vg({type:ct.f.AdVideoStart}),this.vg({type:ct.f.AdImpression,payload:{}})})),this.jf.onError.subscribe((t=&gt;{this.vg({type:ct.f.AdError,payload:{errorMessage:t,errorCode:900}}),this.$f.stop()})),this.jf.onClickClose.subscribe((()=&gt;{this.vg({type:ct.f.AdUserClose,payload:{}}),this.stopAd(R)})),this.jf.onClickAd.subscribe((()=&gt;{this.vg({type:ct.f.AdClick})})),this.jf.onClickThruAd.subscribe((()=&gt;{this.vg({type:ct.f.AdClickThru,payload:{}})}))),this.jf.initializeAd(this.Gv,{width:this.Uf,height:this.Wf})}catch(t){const{message:i}=(0,mt.W$)(t);this.vg({type:ct.f.AdError,payload:{errorMessage:`adaptorStartAdError_${i}`,errorCode:900}})}}stopAd(t){try{super.stopAd(t),this.$f.stop(),this.vg({type:ct.f.AdStopped,payload:{shouldTrackPostBid:!0}})}catch(t){this.Qg("HtmlBidAdaptor","stopAd",(0,mt.W$)(t))}}skipAd(){try{super.skipAd(),this.vg({type:ct.f.AdSkipped})}catch(t){this.Qg("HtmlBidAdaptor","skipAd",(0,mt.W$)(t))}}pauseAd(){try{this.$f.stop(),this.vg({type:ct.f.AdPaused})}catch(t){this.Qg("HtmlBidAdaptor","pauseAd",(0,mt.W$)(t))}}resumeAd(){try{this.$f.start(),this.vg({type:ct.f.AdPlaying})}catch(t){this.Qg("HtmlBidAdaptor","resumeAd",(0,mt.W$)(t))}}collapseAd(){}expandAd(){}getAdDuration(){return this.$f.timerDuration/ri.s_}getAdRemainingTime(){return this.$f.timeRemaining/ri.s_}getAdVolume(){return 0}getAdMediaSize(){var t;return null===(t=this.jf)||void 0===t?void 0:t.getAdMediaDimensions()}setAdVolume(t){}resizeAd(t,i,e){this.Uf=t,this.Wf=i}Og(){var t;try{super.Og(),this.$f.stop(),(0,o.i)(this.Vf),null===(t=this.jf)||void 0===t||t.destroy()}catch(t){this.Qg("HtmlBidAdaptor","_destroy",(0,mt.W$)(t))}}}var ws=e(5269);class ks{constructor(t,i,e,s){this.qf=t,this.zf=i,this.Hf=e,this.Gf=s,this.Jf=[],this.Yf=(t,i)=&gt;{if(i.fatal)switch(i.type){case this.qf.ErrorTypes.NETWORK_ERROR:if(i.details===this.qf.ErrorDetails.MANIFEST_PARSING_ERROR||i.details===this.qf.ErrorDetails.MANIFEST_LOAD_ERROR)return void this.Kf();this.Qf.startLoad();break;case this.qf.ErrorTypes.MEDIA_ERROR:this.Qf.recoverMediaError();break;default:this.Kf()}},this.Zf=()=&gt;{this.Qf.off(this.qf.Events.MEDIA_ATTACHED,this.Zf),this.Qf.loadSource(this.zf),this.Qf.once(this.qf.Events.MANIFEST_PARSED,this.tI)},this.tI=()=&gt;{this.Qf.off(this.qf.Events.MANIFEST_PARSED,this.tI),this.eI(),this.Gf.forceMaxLevel&amp;&amp;this.iI(),this.Gf.forceResolutionHeight&amp;&amp;this.sI(this.Gf.forceResolutionHeight),this.nI()},(this.Gf.forceMaxLevel||this.Gf.forceResolutionHeight)&amp;&amp;(ws.yt.capLevelToPlayerSize=!1)}start(t,i){this.nI=t,this.Kf=i,this.qf&amp;&amp;(0,ws.fh)()?(this.Qf=new this.qf(Object.assign({},ws.yt)),this.oI()):this.Kf()}destroy(t){try{this.Qf&amp;&amp;(this.Qf.destroy(),this.Qf=null)}catch(i){const{message:e,stack:s}=(0,mt.W$)(i);(0,ft.FH)({sessionId:t,level:"Warn",message:"AdManager_HlsAdSourceHandler_destroy",exception:e,callStack:s})}}oI(){this.Qf.on(this.qf.Events.ERROR,this.Yf),this.Qf.attachMedia(this.Hf),this.Qf.once(this.qf.Events.MEDIA_ATTACHED,this.Zf)}iI(){const t=this.Qf.levels.length-1;this.aI(t)}sI(t){const i=this.Jf.find((i=&gt;i.height===t));i&amp;&amp;this.aI(i.level)}aI(t){this.Qf.currentLevel=t,this.Qf.startLevel=t,this.Qf.nextLevel=t}eI(){this.Qf.levels.forEach(((t,i)=&gt;{this.Jf.push({level:i,height:t.height})}))}}var Ps=e(626),Ms=e(4144);const Cs="huffpost",Ls=540,Ts=["d426a992-f367-434b-827b-d3561b6af50c","e3bcb71c-7486-4955-a5fe-c94bade4948d"];class Bs extends ds{constructor(t,i,e,s,r,n,h,o,a,d,c,l=!1,u){super(),this.nt=t,this.hI=i,this.dI=e,this._r=s,this.ds=r,this.cI=n,this.lI=h,this.ks=o,this.uI=a,this.pI=d,this.qf=c,this.mI=l,this.Di=u,this.vI=!1,this.gI=new Ms.v(this.nt),this.fI=Object.values(Ps.wB),this.II=!1,this.AI=!1,this.yI=!0,this._I=!1,this.bI=[{event:ct.f.AdVideoStart,position:0},{event:ct.f.AdVideoFirstQuartile,position:25},{event:ct.f.AdVideoMidpoint,position:50},{event:ct.f.AdVideoThirdQuartile,position:75},{event:ct.f.AdVideoComplete,position:100}],this.SI=this.bI[0],this.wI=t=&gt;{try{switch(t.type){case Ps.wB.Pause:if(this.lI&amp;&amp;!this.yI)return this.yI=!0,void this.MI("pause_event_loopAd");this.AI=!1;break;case Ps.wB.Play:!this.AI&amp;&amp;this.mI&amp;&amp;this.dI.pause();break;case Ps.wB.Canplay:case Ps.wB.Durationchange:this.kI();break;case Ps.wB.Timeupdate:this.xI();break;case Ps.wB.Error:{const t=this.dI.networkState===HTMLMediaElement.NETWORK_NO_SOURCE?401:400;this.Dv.next({type:ct.f.AdError,payload:{errorCode:t,errorMessage:"vastVideoTagEventError"}});break}case"click":this.Dv.next({type:ct.f.AdClickThru,payload:{playerHandles:!1,url:this.cI}});break;case Ps.wB.Mute:case Ps.wB.Unmute:case Ps.wB.Volumechange:this.Dv.next({type:ct.f.AdVolumeChange})}}catch(t){const{message:i,stack:e}=(0,mt.W$)(t);(0,ft.FH)({level:"Critical",callStack:e,message:"AdManager_VastIntegrator_onVideoEvent",exception:i,sessionId:this.ks},{throttle:10,shouldSendMaxLog:!1})}}}initAd(t,i,e,s,r,n){try{this.dI=n.videoSlot,this.Uf=t,this.Wf=i,this.LI(this.cI,this.dI.parentElement),this.resizeAd(t,i,e),this.CI(this.dI),this.pI&amp;&amp;(0,ws.fh)()?this.TI(this.qf):(this.dI.setAttribute("src",this.hI),this.dI.setAttribute("preload","metadata"),this.dI.load()),this.gI.isDocumentVisible()||this.kI()}catch(t){const{message:i}=(0,mt.W$)(t);this.Dv.next({type:ct.f.AdError,payload:{errorMessage:`wrapperInitAdError_${i}`,errorCode:900}})}}startAd(){try{(0,U.cn)(this.dI,"cnx-ad-video-slot"),this.AI=!0,this.ds&amp;&amp;Ts.includes(this.ds)&amp;&amp;(this.II=!0),this.gI.isDocumentVisible()?this.dI.play().then((()=&gt;{this.Dv.next({type:ct.f.AdStarted}),this.BI(),this.EI(!0)})).catch((t=&gt;{if(this.Dv.next({type:ct.f.AdError,payload:{errorMessage:"playPromiseReject",errorCode:900}}),this.II){const{message:i,stack:e}=(0,mt.W$)(t);(0,ft.FH)({level:"Info",message:"INMOBI_DOCUMENT_VISIBLE_REJECTED_PLAY_EVENT",exception:`advLineItemId: ${this.ds}, promiseError: ${i}`,callStack:e,sessionId:this.ks},{throttle:1e3})}})):(this.Dv.next({type:ct.f.AdStarted}),this.BI(),this.EI(!1),this.dI.play().then((()=&gt;{this.DI(),this.II&amp;&amp;(0,ft.FH)({level:"Info",message:"INMOBI_DOCUMENT_NOT_VISIBLE_RESOLVED_PLAY_EVENT",exception:`advLineItemId: ${this.ds}`,sessionId:this.ks},{throttle:1e3})})).catch((t=&gt;{if(this.II){const{message:i,stack:e}=(0,mt.W$)(t);(0,ft.FH)({level:"Info",message:"INMOBI_DOCUMENT_NOT_VISIBLE_REJECTED_PLAY_EVENT",exception:`advLineItemId: ${this.ds}, promiseError: ${i}`,callStack:e,sessionId:this.ks},{throttle:1e3})}})))}catch(t){const{message:i}=(0,mt.W$)(t);this.Dv.next({type:ct.f.AdError,payload:{errorMessage:`wrapperStartAdError_${i}`,errorCode:900}})}}stopAd(t){this.mI&amp;&amp;this.dI.pause(),"videoComplete"===t&amp;&amp;this.lI?this.Dv.next({type:ct.f.AdStopped,payload:{shouldTrackPostBid:!1}}):this.Dv.next({type:ct.f.AdStopped,payload:{shouldTrackPostBid:!0}})}resizeAd(t,i,e){(0,U.T7)(this.dI,{width:`${t}px`,height:`${i}px`}),this.Dv.next({type:ct.f.AdSizeChange})}pauseAd(){this.AI=!1,this.uI&amp;&amp;void 0===this.SI&amp;&amp;(this.SI=this.bI[0]),this.dI.pause(),this.Dv.next({type:ct.f.AdPaused})}resumeAd(){this.lI&amp;&amp;void 0===this.SI&amp;&amp;(this.SI=this.bI[0]),this.AI=!0,this.MI("resumeAd"),this.DI(),this.Dv.next({type:ct.f.AdPlaying})}expandAd(){}collapseAd(){}skipAd(){this.Dv.next({type:ct.f.AdSkipped})}getAdRemainingTime(){return this.dI.duration-this.dI.currentTime}getAdDuration(){return this.dI.duration||0}getAdVolume(){return this.dI.volume}setAdVolume(t){this.dI.volume=t}getAdMediaWidth(){return this.dI.videoWidth}getAdMediaHeight(){return this.dI.videoHeight}destroy(){if(!this.uI&amp;&amp;!this.lI)try{(0,U.IV)(this.dI,"cnx-ad-video-slot"),this.OI(this.dI),this.dI.removeAttribute("src"),this.FI&amp;&amp;(this.FI.destroy(this.ks),this.FI=null)}catch(t){const{message:i,stack:e}=(0,mt.W$)(t);(0,ft.FH)({level:"Warn",message:"AdManager_VastIntegrator_destroyAd",exception:i,callStack:e,sessionId:this.ks})}}CI(t){this.fI.forEach((i=&gt;{t.addEventListener(i,this.wI)})),this.VI&amp;&amp;this.VI.addEventListener("click",this.wI)}EI(t){if(this.II){const i=t?"INMOBI_IMPRESSION_EVENT_DOCUMENT_VISIBLE":"INMOBI_IMPRESSION_EVENT_DOCUMENT_NOT_VISIBLE";(0,ft.FH)({level:"Info",exception:`advLineItemId: ${this.ds}`,message:i,sessionId:this.ks},{throttle:1e3})}}DI(){this._r===_e.M.Ios&amp;&amp;(0,U.UR)(this.dI)}TI(t){let i={forceMaxLevel:!0};this.Di&amp;&amp;this.Di.includes(Cs)&amp;&amp;(i={forceMaxLevel:!1,forceResolutionHeight:Ls}),this.FI=new ks(t,this.hI,this.dI,i),this.FI.start((()=&gt;{this.kI()}),(()=&gt;{this.Dv.next({type:ct.f.AdError,payload:{errorMessage:"srcNotSupported",errorCode:403}})}))}LI(t,i){this.VI=this.nt.createElement("a"),t&amp;&amp;(this.VI.href=t,this.VI.target="_blank"),(0,U.cn)(this.VI,"cnx-ad-slot"),this.VI.setAttribute("title","Advertisement link"),this.VI.setAttribute("role","link"),this.VI.setAttribute("tabindex","-1"),this.VI.setAttribute("aria-disabled","true"),i.appendChild(this.VI),this.VI.addEventListener("click",this.wI)}OI(t){this.fI.forEach((i=&gt;{t.removeEventListener(i,this.wI)})),this.VI&amp;&amp;this.VI.removeEventListener("click",this.wI)}kI(){this.vI||(this.vI=!0,this.Dv.next({type:ct.f.AdLoaded,payload:{}}))}xI(){this.Dv.next({type:ct.f.AdRemainingTimeChange});const t=(0,nt.dQ)(0,this.dI.duration,0,100,this.dI.currentTime);if(this.SI&amp;&amp;t&gt;=this.SI.position){this.SI.event===ct.f.AdVideoStart&amp;&amp;this.II&amp;&amp;(0,ft.FH)({level:"Info",message:"INMOBI_AD_VIDEO_START_EVENT_FIRED",exception:`advLineItemId: ${this.ds}`,sessionId:this.ks},{throttle:1e3}),this._I||(this.SI.event===ct.f.AdVideoStart&amp;&amp;this.II?this.Dv.next({type:ct.f.AdVideoStart,payload:{logInMobiInfo:this.II}}):this.Dv.next({type:this.SI.event}));const t=this.SI;this.SI=this.bI[this.bI.indexOf(this.SI)+1],t.event===ct.f.AdVideoComplete&amp;&amp;(this.lI&amp;&amp;(this.dI.currentTime=.01),this.yI=!1,this.stopAd("videoComplete"),this._I=!0)}}MI(t){try{this.dI.play().catch((i=&gt;{const{message:e,stack:s}=(0,mt.W$)(i);(0,ft.FH)({level:"Warn",message:`AdManager_VastIntegrator_play_${t}`,exception:`playError: ${e}`,callStack:s,sessionId:this.ks})}))}catch(i){const{message:e,stack:s}=(0,mt.W$)(i);(0,ft.FH)({level:"Warn",message:`AdManager_VastIntegrator__play_${t}`,exception:`promiseError: ${e}`,callStack:s})}}BI(){this.VI&amp;&amp;(this.VI.removeAttribute("tabindex"),this.VI.removeAttribute("aria-disabled")),this.Dv.next({type:ct.f.AdImpression,payload:{}})}}class Es extends vs{constructor(t,i){super(t,i),this.Xt=t,this.settings=i,this.adMediaType="cnxMedia",this.adSourceType=as.wS.CNX_MEDIA,this.NI=[]}get adVideoUrl(){return this.$I}get declaredDurationInSeconds(){return this.settings.adManagerLineItem.protoLineItem.durationSeconds}initAd(t,i,e,s,r,n,h){try{let o;super.initAd(t,i,e,s,r,n,h);let a=!1;if((0,W.QM)(this.settings.externalMediaFile))o=this.UI(this.settings.externalMediaFile);else if((0,W.QM)(this.settings.externalHlsFile))o=this.UI(this.settings.externalHlsFile),a=!0;else{if(!(0,ot.BZ)(this.settings.renditions))return void this.vg({type:ct.f.AdError,payload:{errorMessage:"noRenditions",errorCode:401}});o=this.WI(this.settings.renditions,i,this.settings.mediaId)}this.$I=o,this.jI=new Bs(this.settings.globalDomUtilsService,this.$I,this.Jv,this.settings.os,this.settings.adManagerLineItem.protoLineItem.advertiserLineItemId,this.settings.clickUrl,this.settings.shouldLoopAdWhenFinished,this.settings.sessionId,this.settings.shouldPauseAdWhenFinished,a,this.settings.hlsModule,this.settings.isInApp,this.settings.pageDomain),this.NI.push(this.jI.onVpaidEvent.subscribe((t=&gt;{this.vg(t)}))),this.jI.initAd(t,i,e,s,r,{slot:this.Gv,videoSlot:this.Jv})}catch(t){const{message:i}=(0,mt.W$)(t);this.vg({type:ct.f.AdError,payload:{errorMessage:`adaptorInitAdError_${i}`,errorCode:900}})}}startAd(){try{super.startAd(),this.jI.startAd()}catch(t){const{message:i}=(0,mt.W$)(t);this.vg({type:ct.f.AdError,payload:{errorMessage:`adaptorStartAdError_${i}`,errorCode:900}})}}stopAd(t){super.stopAd(t),this.jI?this.jI.stopAd(t):(0,ft.FH)({message:"stopAd",exception:t,level:"Warn",sessionId:this.settings.sessionId})}resizeAd(t,i,e){try{this.jI.resizeAd(t,i,e)}catch(t){this.Qg("CnxMediaBidAdaptor","resizeAd",(0,mt.W$)(t))}}pauseAd(){try{this.jI.pauseAd()}catch(t){this.Qg("CnxMediaBidAdaptor","pauseAd",(0,mt.W$)(t))}}resumeAd(){try{this.jI.resumeAd()}catch(t){this.Qg("CnxMediaBidAdaptor","resumeAd",(0,mt.W$)(t))}}expandAd(){try{this.jI.expandAd()}catch(t){this.Qg("CnxMediaBidAdaptor","expandAd",(0,mt.W$)(t))}}collapseAd(){try{this.jI.collapseAd()}catch(t){this.Qg("CnxMediaBidAdaptor","collapseAd",(0,mt.W$)(t))}}skipAd(){try{super.skipAd(),this.jI.skipAd()}catch(t){this.Qg("CnxMediaBidAdaptor","skipAd",(0,mt.W$)(t))}}getAdRemainingTime(){try{return this.jI.getAdRemainingTime()}catch(t){return this.Qg("CnxMediaBidAdaptor","getAdRemainingTime",(0,mt.W$)(t)),0}}getAdDuration(){try{return this.jI?this.jI.getAdDuration():this.settings.adManagerLineItem.protoLineItem.durationSeconds}catch(t){return this.Qg("CnxMediaBidAdaptor","getAdDuration",(0,mt.W$)(t)),0}}getAdVolume(){try{return this.jI.getAdVolume()}catch(t){return this.Qg("CnxMediaBidAdaptor","getAdVolume",(0,mt.W$)(t)),0}}getAdMediaSize(){return{width:this.jI.getAdMediaWidth(),height:this.jI.getAdMediaHeight()}}setAdVolume(t){try{super.setAdVolume(t),this.jI.setAdVolume(t)}catch(t){this.Qg("CnxMediaBidAdaptor","setAdVolume",(0,mt.W$)(t))}}Og(){var t;if(!this.settings.shouldPauseAdWhenFinished&amp;&amp;!this.settings.shouldLoopAdWhenFinished)try{super.Og(),(0,o.i)(this.NI),null===(t=this.jI)||void 0===t||t.destroy()}catch(t){this.Qg("CnxMediaBidAdaptor","_destroy",(0,mt.W$)(t))}}UI(t){return(null==t?void 0:t.includes(Qi.n.endPoints.ads.base.video))?this.Lg.appendParamsToUrl(t):t}WI(t,i,e){let s;s=t.filter((t=&gt;"h264"===t.codec));const r=(0,nt.DE)(i,s.map((t=&gt;t.height)));return s=s.filter((t=&gt;t.height===r)),s.length&gt;0?this.Lg.appendParamsToUrl(`${Qi.n.endPoints.ads.base.video}${e}/${s[0].file}`):null}}var Ds=Array.isArray;function Rs(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];var 0,(0,yi.ev)([],(0,yi.cr)(h))):h),i.some((function(t,i){return!t.length&&r[i]}))&&t.complete()}}),(function(){r[n]="!0,!i[n].length&amp;&amp;t.complete()})))},h=0;!t.closed&amp;&amp;h&lt;s.length;h++)n(h);return" 1="t.length&amp;&amp;Ds(t[0])?t[0]:t}(t);return" _.y((function(t){var="" e="(0,y.jO)(t),s=function(t){return" fs{constructor(t,i,e){this.qi="t,this.HI=i,this.GI=e,this.af=`div-gpt-ad-1589549806211-${(0,mt.qs)()}`,this.JI=new" function(){i="r=null}})):I.E}const" h="i.map((function(t){return" i="s.map((function(){return[]})),r=s.map((function(){return!1}));t.add((function(){i=r=null}));for(var" n="function(n){(0,l.Xf)(s[n]).subscribe((0,v.x)(t,(function(s){if(i[n].push(s),i.every((function(t){return" os="[[88,31],[120,20],[120,30],[120,60],[120,90],[125,125],[168,28],[168,42],[180,150],[200,200],[200,446],[216,36],[216,54],[220,90],[234,60],[240,133],[250,250],[250,360],[292,30],[300,31],[300,50],[300,75],[300,100],[300,250],[320,50],[320,100],[320,240],[336,280],[400,350],[468,60],[480,320]];class" s.length?new="" s.x,this._f="()=" s.x,this.if="new" s.x,this.rf="new" s.x,this.sf="new" s.x,this.tf="new" s.x,this.xi="new" s.x,this.yi="new" t.length}))){var="" t.shift()}));t.next(e?e.apply(void="">{(0,U.dA)(this.KI)?this.rf.next():this.sf.next()}}get onCreativeReceived(){return this.XI.asObservable()}get onDisplayAd(){return this.tf.asObservable()}get onError(){return this.if.asObservable()}get onClickAd(){return this.sf.asObservable()}get onClickThruAd(){return this.rf.asObservable()}getAdMediaHeight(){return this.ZI?this.ZI.clientHeight:0}getAdMediaWidth(){return this.ZI?this.ZI.clientWidth:0}initializeAd(t,i){try{this.tA=t,this.Ng(t);const e=this.eA(i.width,i.height);this.qI.cmd.push((()=&gt;{this.iA=this.qI.defineSlot(this.GI,e,this.af).addService(this.qI.pubads()).setTargeting("domains",this.HI),this.qI.enableServices(),this.sA(),this.qI.pubads().isInitialLoadDisabled()&amp;&amp;this.qI.pubads().refresh([this.iA]),this.qI.display(this.af)}))}catch(t){this.if.next("wrapperInitAdError")}}destroy(){var t;this.qI.cmd.push((()=&gt;{this.qI.destroySlots&amp;&amp;this.iA&amp;&amp;this.qI.destroySlots([this.iA])})),null===(t=this.KI)||void 0===t||t.removeEventListener("click",this._f)}sA(){this.qI.pubads().addEventListener("slotOnload",(t=&gt;{t.slot===this.iA&amp;&amp;this.YI.next(t)})),this.qI.pubads().addEventListener("slotRenderEnded",(t=&gt;{t.slot===this.iA&amp;&amp;(this.JI.next(t),t.isEmpty&amp;&amp;this.YI.next(null))})),Rs([this.JI,this.YI]).pipe((0,c.U)((([t,i])=&gt;({slotRenderEndedEvent:t,slotOnloadEvent:i})))).subscribe((t=&gt;{var i;const{slotRenderEndedEvent:e}=t;if(e.isEmpty)return void this.if.next("adxOverlayNoFill");this.ZI=null===(i=this.tA)||void 0===i?void 0:i.getElementsByTagName("iframe")[0];const s=e.creativeId;s&amp;&amp;this.XI.next(s.toString()),this.kf(),this.tf.next()}))}Ng(t){t.id=this.af}eA(t,i){return Os.filter((e=&gt;!Array.isArray(e)||!(0,ot.fn)(e)||(0,ot.BZ)(e)&amp;&amp;e[0]&lt;=t&amp;&amp;e[1]&lt;=i))}kf(){this.KI=(0,U.sc)(this.tA),this.KI.addEventListener("click",this._f,!0)}}var Vs=e(7975);class $s extends vs{constructor(t,i){super(t,i),this.Xt=t,this.settings=i,this.adMediaType="displayAdx",this.adSourceType=as.wS.AD_SOURCE_TYPE_UNSPECIFIED,this.Nf="adx",this.nA={0:ct.f.AdVideoFirstQuartile,1:ct.f.AdVideoMidpoint,2:ct.f.AdVideoThirdQuartile,3:ct.f.AdVideoComplete},this.oA=[];const e=this.settings.adManagerLineItem.protoLineItem.overlayTimeSeconds*ri.s_;this.$f=new _s.B(this.Xt,e,500),this.oA.push(this.$f.onTimeUpdate.subscribe((()=&gt;{this.vg({type:ct.f.AdRemainingTimeChange})})),this.$f.onTimeElapsed.subscribe((()=&gt;{this.stopAd("adxTimerElapsed")})),this.$f.onQuartile.subscribe((t=&gt;{this.vg({type:this.nA[t],payload:{}})})))}get adVideoUrl(){return this.Nf}get declaredDurationInSeconds(){return this.settings.adManagerLineItem.protoLineItem.durationSeconds}initAd(t,i,e,s,r,n,h){try{super.initAd(t,i,e,s,r,n,h),this.Cf={width:t,height:i},this.aA().then((t=&gt;{this.hA=new Fs(t,this.settings.domain,this.settings.adxAdUnitPath),this.oA.push(this.hA.onCreativeReceived.subscribe((t=&gt;{this.creativeId=t}))),this.vg({type:ct.f.AdLoaded,payload:{skipOffset:0}})})).catch((t=&gt;{const{message:i}=(0,mt.W$)(t);this.vg({type:ct.f.AdError,payload:{errorMessage:`adxOverlayGptScriptLoad_${i}`,errorCode:900}})}))}catch(t){const{message:i}=(0,mt.W$)(t);this.vg({type:ct.f.AdError,payload:{errorMessage:`adaptorInitAdError_${i}`,errorCode:900}})}}startAd(){try{super.startAd(),this.oA.push(this.hA.onDisplayAd.subscribe((()=&gt;{this.vg({type:ct.f.AdStarted}),this.vg({type:ct.f.AdVideoStart}),this.vg({type:ct.f.AdImpression,payload:{}}),this.$f.start()})),this.hA.onError.subscribe((t=&gt;{this.vg({type:ct.f.AdError,payload:{errorMessage:t,errorCode:900}}),this.$f.stop()})),this.hA.onClickAd.subscribe((()=&gt;{this.vg({type:ct.f.AdClick})})),this.hA.onClickThruAd.subscribe((()=&gt;{this.vg({type:ct.f.AdClickThru,payload:{}})}))),this.hA.initializeAd(this.Gv,this.Cf)}catch(t){const{message:i}=(0,mt.W$)(t);this.vg({type:ct.f.AdError,payload:{errorMessage:`adaptorStartAdError_${i}`,errorCode:900}})}}stopAd(t){try{super.stopAd(t),this.$f.stop(),this.vg({type:ct.f.AdStopped,payload:{shouldTrackPostBid:!0}})}catch(t){this.Qg("AdxBidAdaptor","stopAd",(0,mt.W$)(t))}}resizeAd(t,i,e){this.Cf&amp;&amp;(this.Cf.width=t,this.Cf.height=i)}pauseAd(){try{this.$f.stop(),this.vg({type:ct.f.AdPaused})}catch(t){this.Qg("AdxBidAdaptor","pauseAd",(0,mt.W$)(t))}}resumeAd(){try{this.$f.start(),this.vg({type:ct.f.AdPlaying})}catch(t){this.Qg("AdxBidAdaptor","resumeAd",(0,mt.W$)(t))}}expandAd(){}collapseAd(){}skipAd(){try{super.skipAd(),this.vg({type:ct.f.AdSkipped})}catch(t){this.Qg("AdxBidAdaptor","skipAd",(0,mt.W$)(t))}}getAdRemainingTime(){return this.$f.timeRemaining/ri.s_}getAdDuration(){return this.$f.timerDuration/ri.s_}getAdVolume(){return 0}getAdMediaSize(){return{width:this.hA.getAdMediaWidth(),height:this.hA.getAdMediaHeight()}}setAdVolume(t){}Og(){var t;try{super.Og(),this.$f.stop(),(0,o.i)(this.oA),null===(t=this.hA)||void 0===t||t.destroy()}catch(t){this.Qg("AdxBidAdaptor","_destroy",(0,mt.W$)(t))}}aA(){const t=(0,mt.pE)(window).topFrame;if(t.googletag)return Promise.resolve(t.googletag);t.googletag=window.googletag||{cmd:[]};return(0,h.AU)(Vs.f).fetchGoogleTag()}}var Ns=e(4429);const Us={REQUEST_SUCCESS:"requestSuccess",AD_ERROR:"adError",CLICK:"click",LOADED:"loaded",IMPRESSION:"impression",STARTED:"start",FIRST_QUARTILE:"firstQuartile",MIDPOINT:"midpoint",THIRD_QUARTILE:"thirdQuartile",COMPLETE:"complete",ALL_ADS_COMPLETED:"allAdsCompleted",DURATION_CHANGE:"durationChange",PAUSED:"pause",RESUMED:"resume",STOPPED:"stop",LINEAR_CHANGED:"liniarChanged",SKIPPABLE_STATE_CHANGED:"skippableStateChanged",SKIPPED:"skip",VOLUME_CHANGED:"volumeChange",USER_CLOSE:"userclose",LOG:"log"};class Ws extends ds{constructor(t,i,e){super(),this.mi=t,this.cA=i,this.lA=e,this.XI=new s.x,this.uA=new s.x,this.pA="",this.mA=0,this.vA=0,this.fA=0,this.IA=0,this.AA()}get onCreativeReceived(){return this.XI.asObservable()}get onNonCriticalError(){return this.uA.asObservable()}initAd(t,i,e){this.cA.emitSdkEvent("initAd",{width:t,height:i,viewMode:e})}startAd(){this.cA.emitSdkEvent("startAd")}stopAd(){this.cA.emitSdkEvent("stopAd")}resizeAd(t,i,e){this.cA.emitSdkEvent("resizeAd",{width:t,height:i,viewMode:e})}pauseAd(){this.cA.emitSdkEvent("pauseAd")}resumeAd(){this.cA.emitSdkEvent("resumeAd")}expandAd(){this.cA.emitSdkEvent("expandAd")}collapseAd(){this.cA.emitSdkEvent("collapseAd")}skipAd(){this.cA.emitSdkEvent("skipAd")}getAdRemainingTime(){return 0}getAdDuration(){return this.mA||this.mi.adManagerLineItem.protoLineItem.durationSeconds||0}getAdVolume(){return this.IA}setAdVolume(t){this.cA.emitSdkEvent("setAdVolume",{volume:t})}getAdMediaWidth(){return this.vA}getAdMediaHeight(){return this.fA}getMediaFile(){return this.pA}destroy(){this.cA.destroy()}AA(){Object.keys(Us).forEach((t=&gt;{const i=Us[t];i===Us.AD_ERROR&amp;&amp;this.cA.subscribeToSdkEvent(i,(t=&gt;this.su(t))),i===Us.LOADED&amp;&amp;this.cA.subscribeToSdkEvent(i,(t=&gt;this.Iu(t))),i===Us.IMPRESSION&amp;&amp;this.cA.subscribeToSdkEvent(i,(t=&gt;this.ru(t))),i===Us.VOLUME_CHANGED?this.cA.subscribeToSdkEvent(i,(t=&gt;this.yA(t))):this.cA.subscribeToSdkEvent(i,(()=&gt;this._A(i)))}))}Iu(t){const{creativeId:i,skipOffset:e,clickThroughUrl:s,mediaUrl:r,adDuration:n,mediaWidth:h,mediaHeight:o}=t;this.XI.next(i),this.pA=r,this.mA=n,this.vA=h,this.fA=o;const a=this.mi.adManagerLineItem.protoLineItem.publisherLineItemId||"";(0,Ns.HJ)(a,s).then((t=&gt;{t?this.Dv.next({type:ct.f.AdError,payload:{errorMessage:"domainBlocked",errorCode:900,blockedUrl:s}}):this.Dv.next({type:ct.f.AdLoaded,payload:{skipOffset:e}})})).catch((t=&gt;{const{message:i}=(0,mt.W$)(t);(0,ft.FH)({level:"Info",message:"ExternalAdWrapper_isExchangeDomainBlocked",exception:i},{pacing:1,throttle:1,shouldSendMaxLog:!1})})),(0,Ns.Q4)(this.lA,s).then((t=&gt;{t?this.Dv.next({type:ct.f.AdError,payload:{errorMessage:"domainBlocked",errorCode:900,blockedUrl:s}}):this.Dv.next({type:ct.f.AdLoaded,payload:{skipOffset:e}})})).catch((t=&gt;{const{message:i}=(0,mt.W$)(t);(0,ft.FH)({level:"Info",message:"ExternalAdWrapper_isPublisherDomainBlocked",exception:i},{pacing:1,throttle:1,shouldSendMaxLog:!1})}))}ru(t){this.mA=t.adDuration,this.Dv.next({type:ct.f.AdVideoStart}),this.Dv.next({type:ct.f.AdImpression,payload:{}})}yA(t){this.IA=t.volume,this.Dv.next({type:ct.f.AdVolumeChange})}_A(t){switch(t){case Us.CLICK:this.Dv.next({type:ct.f.AdClickThru,payload:{}});break;case Us.STARTED:this.Dv.next({type:ct.f.AdStarted});break;case Us.FIRST_QUARTILE:this.Dv.next({type:ct.f.AdVideoFirstQuartile});break;case Us.MIDPOINT:this.Dv.next({type:ct.f.AdVideoMidpoint});break;case Us.THIRD_QUARTILE:this.Dv.next({type:ct.f.AdVideoThirdQuartile});break;case Us.COMPLETE:this.Dv.next({type:ct.f.AdVideoComplete});break;case Us.DURATION_CHANGE:this.Dv.next({type:ct.f.AdDurationChange});break;case Us.PAUSED:this.Dv.next({type:ct.f.AdPaused});break;case Us.RESUMED:this.Dv.next({type:ct.f.AdPlaying});break;case Us.STOPPED:this.Dv.next({type:ct.f.AdStopped,payload:{shouldTrackPostBid:!0}});break;case Us.LINEAR_CHANGED:this.Dv.next({type:ct.f.AdLinearChange});break;case Us.SKIPPABLE_STATE_CHANGED:this.Dv.next({type:ct.f.AdSkippableStateChange});break;case Us.SKIPPED:this.Dv.next({type:ct.f.AdSkipped});break;case Us.USER_CLOSE:this.Dv.next({type:ct.f.AdUserClose});break;case Us.LOG:this.Dv.next({type:ct.f.AdLog})}}su(t){t.nonCriticalError?this.uA.next(t.nonCriticalError):this.Dv.next({type:ct.f.AdError,payload:{errorMessage:"ExternalSdkError",errorCode:t.errorCode}})}}class js extends vs{constructor(t,i,e,s){super(t,i),this.cA=e,this.adMediaType="external",this.adSourceType=as.wS.AD_SOURCE_TYPE_UNSPECIFIED,this.bA=[],this.SA=new Ws(i,e,s)}get adVideoUrl(){return this.SA.getMediaFile()}get declaredDurationInSeconds(){return this.SA.getAdDuration()}initAd(t,i,e,s,r,n,h){try{super.initAd(t,i,e,s,r,n,h),this.bA.push(this.SA.onVpaidEvent.subscribe((t=&gt;{this.vg(t)})),this.SA.onCreativeReceived.subscribe((t=&gt;{this.creativeId=t})),this.SA.onNonCriticalError.subscribe((t=&gt;{this.Qg("ExternalBidAdaptor",t.event,t.error)}))),this.SA.initAd(t,i,e)}catch(t){this.cA.emitSdkEvent("destroyAd");const{message:i}=(0,mt.W$)(t);this.vg({type:ct.f.AdError,payload:{errorMessage:`adaptorInitAdError_${i}`,errorCode:900}})}}startAd(){try{super.startAd(),this.SA.startAd()}catch(t){this.cA.emitSdkEvent("destroyAd");const{message:i}=(0,mt.W$)(t);this.vg({type:ct.f.AdError,payload:{errorMessage:`adaptorStartAdError_${i}`,errorCode:900}})}}stopAd(t){try{super.stopAd(t),this.SA.stopAd()}catch(t){this.Qg("ExternalBidAdaptor","stopAd",(0,mt.W$)(t))}}resizeAd(t,i,e){this.SA.resizeAd(t,i,e)}pauseAd(){this.SA.pauseAd()}resumeAd(){this.SA.resumeAd()}expandAd(){this.SA.expandAd()}collapseAd(){this.SA.collapseAd()}skipAd(){this.SA.skipAd()}getAdRemainingTime(){return this.SA.getAdRemainingTime()}getAdDuration(){return this.SA.getAdDuration()}getAdVolume(){return this.SA.getAdVolume()}getAdMediaSize(){return{width:this.SA.getAdMediaWidth(),height:this.SA.getAdMediaHeight()}}setAdVolume(t){try{super.setAdVolume(t),this.SA.setAdVolume(t)}catch(t){this.Qg("ExternalBidAdaptor","setAdVolume",(0,mt.W$)(t))}}Og(){try{super.Og(),this.SA.destroy()}catch(t){this.Qg("ExternalBidAdaptor","_destroy",(0,mt.W$)(t))}}}const qs=["9026814","9053547"],Hs=["octob.azureedge.net/oc.js","lzi.azureedge.net/lz.js","tinlc.azureedge.net/pt.js","bm-rb.azureedge.net/rb.js","foluo.azureedge.net/fo.js","vpv-ger.azureedge.net/VpaidVideoAd1.js"],zs=["fakeurl.com"];class Gs extends ds{constructor(t,i,e,r,n,h,o,a,d,c){super(),this.wA=t,this._r=i,this.PA=e,this.MA=r,this.kA=n,this.xA=h,this.LA=o,this.lA=a,this.CA=d,this.TA=c,this.BA={totalAds:1,adPodIndex:1,isFollowUpAdInPod:!1,isPod:!1,durationInSeconds:0},this.XI=new s.x,this.EA=t=&gt;{var i;if(!this.DA(t))return;this.CA.storeAdErrorEvent(t);let e="";try{const s=t.getError();e=`${s.getMessage()}_${s.getErrorCode()}_${s.getVastErrorCode()}_${(null===(i=s.getInnerError())||void 0===i?void 0:i.message)||""}`}catch(t){}this.Dv.next({type:ct.f.AdError,payload:{errorMessage:"imaError_"+e,errorCode:900}})},this._A=t=&gt;{const i=this.wA.AdEvent.Type;switch(this.CA.storeAdEvent(t),t.type){case i.CLICK:this.Dv.next({type:ct.f.AdClickThru,payload:{}});break;case i.LOADED:this.Iu(t);break;case i.IMPRESSION:{if(this.BA.isFollowUpAdInPod)break;const t={adsManager:this.kA,adContainer:this.RA,viewMode:this.OA(this.FA),adTag:this.MA};this.Dv.next({type:ct.f.AdVideoStart}),this.Dv.next({type:ct.f.AdImpression,payload:{imaMetadata:t}});break}case i.STARTED:if(this.BA.isFollowUpAdInPod)break;this.Dv.next({type:ct.f.AdStarted});break;case i.FIRST_QUARTILE:if(this.BA.isFollowUpAdInPod)break;this.Dv.next({type:ct.f.AdVideoFirstQuartile});break;case i.MIDPOINT:if(this.BA.isFollowUpAdInPod)break;this.Dv.next({type:ct.f.AdVideoMidpoint});break;case i.THIRD_QUARTILE:if(this.BA.isFollowUpAdInPod)break;this.Dv.next({type:ct.f.AdVideoThirdQuartile});break;case i.COMPLETE:this.Dv.next({type:ct.f.AdVideoComplete}),this.BA.isPod||this.Dv.next({type:ct.f.AdStopped,payload:{shouldTrackPostBid:!0}});break;case i.ALL_ADS_COMPLETED:this.Dv.next({type:ct.f.AdStopped,payload:{shouldTrackPostBid:!0}});break;case i.DURATION_CHANGE:this.Dv.next({type:ct.f.AdDurationChange});break;case i.PAUSED:this.Dv.next({type:ct.f.AdPaused});break;case i.RESUMED:this.Dv.next({type:ct.f.AdPlaying});break;case i.LINEAR_CHANGED:this.Dv.next({type:ct.f.AdLinearChange});break;case i.SKIPPABLE_STATE_CHANGED:this.Dv.next({type:ct.f.AdSkippableStateChange});break;case i.SKIPPED:this.Dv.next({type:ct.f.AdSkipped});break;case i.VOLUME_CHANGED:this.Dv.next({type:ct.f.AdVolumeChange});break;case i.USER_CLOSE:this.Dv.next({type:ct.f.AdUserClose});break;case i.LOG:this.Dv.next({type:ct.f.AdLog})}},this.AA()}get onCreativeReceived(){return this.XI.asObservable()}initAd(t,i,e,s,r,n){this.RA=n.slot,this.dI=n.videoSlot,this.FA=e||"normal";try{this.CA.storeCustomEvent("wInitAd"),this.kA.setVolume(0),this.kA.init(t,i,this.OA(this.FA))}catch(t){this.Dv.next({type:ct.f.AdError,payload:{errorMessage:"imaManagerInit",errorCode:900}})}}startAd(){try{this.CA.storeCustomEvent("wStartAd"),this.kA.start()}catch(t){const{message:i}=(0,mt.W$)(t);this.Dv.next({type:ct.f.AdError,payload:{errorMessage:`wrapperStartAdError_${i}`,errorCode:900}})}}stopAd(t){this.CA.storeCustomEvent(t?`wStopAd-reason-${t}`:"wStopAd-reason-unknown"),this.kA.stop(),this.Dv.next({type:ct.f.AdStopped,payload:{shouldTrackPostBid:!0}})}resizeAd(t,i,e){this.kA.resize(t,i,this.OA(e))}pauseAd(){this.CA.storeCustomEvent("wPauseAd"),this.kA.pause()}resumeAd(){this.CA.storeCustomEvent("wResumeAd"),this.kA.resume(),this._r===_e.M.Ios&amp;&amp;(0,U.UR)(this.dI)}expandAd(){this.kA.expand()}collapseAd(){this.kA.collapse()}skipAd(){this.CA.storeCustomEvent("wSkipAd"),this.kA.skip()}getAdRemainingTime(){return this.kA.getRemainingTime()||0}getAdDuration(){return this.BA.isPod?this.BA.durationInSeconds||this.VA.getDuration():this.VA?this.VA.getDuration():0}getAdVolume(){return this.kA.getVolume()}getAdMediaWidth(){return this.VA?this.VA.getVastMediaWidth():0}getAdMediaHeight(){return this.VA?this.VA.getVastMediaHeight():0}setAdVolume(t){this.kA.setVolume(t)}getMediaFile(){return this.VA?this.VA.getMediaUrl():void 0}getAdPodInfo(){return this.BA}destroy(){this.CA.storeCustomEvent("wDestroy");try{this.NA(),setTimeout((()=&gt;{this.CA.log(),this.kA.destroy()}))}catch(t){}}AA(){this.PA.addEventListener(this.wA.AdErrorEvent.Type.AD_ERROR,this.EA),this.kA.addEventListener(this.wA.AdErrorEvent.Type.AD_ERROR,this.EA),Object.keys(this.wA.AdEvent.Type).forEach((t=&gt;{this.kA.addEventListener(this.wA.AdEvent.Type[t],this._A,!1)}))}NA(){this.PA.removeEventListener(this.wA.AdErrorEvent.Type.AD_ERROR,this.EA),this.kA.removeEventListener(this.wA.AdErrorEvent.Type.AD_ERROR,this.EA),Object.keys(this.wA.AdEvent.Type).forEach((t=&gt;{this.kA.removeEventListener(this.wA.AdEvent.Type[t],this._A,!1)}))}OA(t){return"fullscreen"===t?this.wA.ViewMode.FULLSCREEN:this.wA.ViewMode.NORMAL}$A(t){return qs.includes(t)}DA(t){const i=t.getUserRequestContext();return!i||i.id===this.xA.id}Iu(t){var i;if(this.VA=t.getAd(),this.UA(null===(i=this.VA)||void 0===i?void 0:i.getAdPodInfo()),this.BA.isFollowUpAdInPod)return;if(this.$A(this.VA.getAdId()))return void this.Dv.next({type:ct.f.AdError,payload:{errorMessage:"vpaidInvalid",errorCode:900}});this.XI.next(this.VA.getCreativeId());let e=-1,s="";try{e=this.VA.getSkipTimeOffset();const i=t.getAdData().clickThroughUrl;s=(0,W.QM)(i)?i:void 0}catch(t){}(0,Ns.HJ)(this.LA,s).then((t=&gt;{t?this.Dv.next({type:ct.f.AdError,payload:{errorMessage:"domainBlocked",errorCode:900,blockedUrl:s}}):this.Dv.next({type:ct.f.AdLoaded,payload:{skipOffset:e}})})).catch((t=&gt;{const{message:i}=(0,mt.W$)(t);(0,ft.FH)({level:"Info",message:"AdImaWrapper_isExchangeDomainBlocked",exception:i},{pacing:1,throttle:1,shouldSendMaxLog:!1})})),(0,Ns.Q4)(this.lA,s).then((t=&gt;{t?this.Dv.next({type:ct.f.AdError,payload:{errorMessage:"domainBlocked",errorCode:900,blockedUrl:s}}):this.Dv.next({type:ct.f.AdLoaded,payload:{skipOffset:e}})})).catch((t=&gt;{const{message:i}=(0,mt.W$)(t);(0,ft.FH)({level:"Info",message:"AdImaWrapper_isPublisherDomainBlocked",exception:i},{pacing:1,throttle:1,shouldSendMaxLog:!1})}))}UA(t){t&amp;&amp;this.TA&amp;&amp;(this.BA.totalAds=t.getTotalAds(),this.BA.adPodIndex=t.getAdPosition(),this.BA.isPod=t.getTotalAds()&gt;1,this.BA.isFollowUpAdInPod=this.BA.isPod&amp;&amp;t.getAdPosition()&gt;1,this.BA.durationInSeconds=t.getMaxDuration())}}class Js{constructor(t,i){this.WA=i,this.jA=[],this.nr=!1,this.qA=Date.now(),this.zA="",this.pA="",this.HA="",this.GA="",this.JA=0,this.YA="",this.nr=t===O}storeCustomEvent(t){this.nr&amp;&amp;this.jA.push({imaEvent:t,timestamp:Date.now()})}storeAdEvent(t){if(!this.nr)return;if(t.type===this.WA.AdEvent.Type.AD_PROGRESS)return void this.XA(t);const i=t.getAd();this.zA||(this.zA=(null==i?void 0:i.getContentType())||""),this.pA||(this.pA=(null==i?void 0:i.getMediaUrl())||""),this.HA||(this.HA=(null==i?void 0:i.getApiFramework())||""),this.jA.push({imaEvent:t.type,timestamp:Date.now()})}storeAdErrorEvent(t){if(!this.nr)return;const i=t.getError();this.jA.push({imaEvent:`error-${i.getErrorCode()}`,timestamp:Date.now()})}storeLogTriggerEvent(t){this.nr&amp;&amp;(this.storeCustomEvent(`trigger-${t}`),this.GA=t)}log(){if(this.nr&amp;&amp;this.GA)try{const t=this.jA.reduce(((t,i)=&gt;`${t}${i.imaEvent}:${i.timestamp-this.qA},`),"");(0,ft.FH)({message:"Ima_Invalid_Vpaid_Event",exception:this.GA,invalidVpaidLogs:{adContentType:this.zA,mediaUrl:this.pA,apiFramework:this.HA,adProgressData:this.YA,adProgressCount:this.JA,events:t},callStack:"",level:"Info"},{throttle:Number.POSITIVE_INFINITY,shouldSendMaxLog:!1})}catch(t){}}XA(t){if(this.JA++,!(this.JA&gt;2)){try{this.YA=JSON.stringify(t.getAdData())}catch(t){}this.jA.push({imaEvent:t.type,timestamp:Date.now()})}}}class Ys extends vs{constructor(t,i,e,s){super(t,i),this.Xt=t,this.settings=i,this.lA=e,this.Ff=s,this.adMediaType="ima",this.adSourceType=as.wS.IMA,this.Xv=null,this.KA=[],this.Xv=this.settings.imaAdSlotContainer,this.CA=new Js(this.settings.adManagerLineItem.protoLineItem.publisherLineItemId,this.settings.imaSdk),this.CA.storeCustomEvent("bConstruct");const r=this.settings.adManagerLineItem.protoLineItem.publisherLineItemId,n=r!==O||this.Ff.shouldForceAdPods;this.QA=new Gs(this.settings.imaSdk,this.settings.os,this.settings.imaAdsLoader,this.settings.url,this.settings.imaAdsManager,this.settings.requestAdsContext,r,this.lA,this.CA,n)}get adVideoUrl(){return this.QA.getMediaFile()}get declaredDurationInSeconds(){return this.QA.getAdDuration()}initAd(t,i,e,s,r,n,h){try{super.initAd(t,i,e,s,r,n,h),this.KA.push(this.QA.onVpaidEvent.subscribe((t=&gt;{t.type===ct.f.AdLoaded&amp;&amp;(this.adPodInfo=this.QA.getAdPodInfo()),this.vg(t)})),this.QA.onCreativeReceived.subscribe((t=&gt;{this.creativeId=t}))),this.QA.initAd(t,i,e,s,r,{slot:this.Gv,videoSlot:this.Jv})}catch(t){const{message:i}=(0,mt.W$)(t);this.vg({type:ct.f.AdError,payload:{errorMessage:`adaptorInitAdError_${i}`,errorCode:900}})}}startAd(){try{super.startAd(),this.QA.startAd()}catch(t){const{message:i}=(0,mt.W$)(t);this.vg({type:ct.f.AdError,payload:{errorMessage:`adaptorStartAdError_${i}`,errorCode:900}})}}stopAd(t){try{super.stopAd(t),this.QA.stopAd(t)}catch(t){this.Qg("ImaBidAdaptor","stopAd",(0,mt.W$)(t))}}resizeAd(t,i,e){try{this.QA.resizeAd(t,i,e)}catch(t){this.Qg("ImaBidAdaptor","resizeAd",(0,mt.W$)(t))}}pauseAd(){try{this.QA.pauseAd()}catch(t){this.Qg("ImaBidAdaptor","pauseAd",(0,mt.W$)(t))}}resumeAd(){try{this.QA.resumeAd()}catch(t){this.Qg("ImaBidAdaptor","resumeAd",(0,mt.W$)(t))}}expandAd(){try{this.QA.expandAd()}catch(t){this.Qg("ImaBidAdaptor","expandAd",(0,mt.W$)(t))}}collapseAd(){try{this.QA.collapseAd()}catch(t){this.Qg("ImaBidAdaptor","collapseAd",(0,mt.W$)(t))}}skipAd(){try{super.skipAd(),this.QA.skipAd()}catch(t){this.Qg("ImaBidAdaptor","skipAd",(0,mt.W$)(t))}}getAdRemainingTime(){try{return this.QA.getAdRemainingTime()}catch(t){return this.Qg("ImaBidAdaptor","getAdRemainingTime",(0,mt.W$)(t)),0}}getAdDuration(){try{return this.QA&amp;&amp;this.QA.getAdDuration()||this.settings.adManagerLineItem.protoLineItem.durationSeconds}catch(t){return this.Qg("ImaBidAdaptor","getAdDuration",(0,mt.W$)(t)),0}}getAdVolume(){try{return this.QA.getAdVolume()}catch(t){return this.Qg("ImaBidAdaptor","getAdVolume",(0,mt.W$)(t)),0}}getAdMediaSize(){return{width:this.QA.getAdMediaWidth(),height:this.QA.getAdMediaHeight()}}setAdVolume(t){try{super.setAdVolume(t),this.QA.setAdVolume(t)}catch(t){this.Qg("ImaBidAdaptor","setAdVolume",(0,mt.W$)(t))}}jg(t){const i=super.jg(t);return i.payload.adSourceData.imaMetadata=t.payload.imaMetadata,i}Xg(){return this.Xv}Kg(){this.settings.adSlotContainerRecycler.recycleAdSlot(this.Xv)}zg(t){this.CA.storeLogTriggerEvent(t.type),super.zg(t)}Og(){try{super.Og(),(0,o.i)(this.KA),this.QA.destroy()}catch(t){this.Qg("ImaBidAdaptor","_destroy",(0,mt.W$)(t))}}}class Xs{constructor(t,i,e,r,n){this.ty=t,this.vt=i,this.ks=e,this.ds=r,this.df=n,this.tf=new s.x,this.if=new s.x,this.sf=new s.x,this.ef=new s.x,this.Li=[]}get onDisplayAd(){return this.tf.asObservable()}get onError(){return this.if.asObservable()}get onClickAd(){return this.sf.asObservable()}get onClickClose(){return this.ef.asObservable()}destroy(){var t;null===(t=this.Of)||void 0===t||t.destroy()}initializeAd(t,i,e,s){this.iy=t,this.sy(s,i,e)}getAdMediaDimensions(){var t;return null===(t=this.Of)||void 0===t?void 0:t.getAdMediaDimensions()}sy(t,i,e){this.ny=this.vt.createElement("img"),this.ny.onload=()=&gt;{this.oy(t,i,e)},this.ny.onerror=()=&gt;{this.if.next("nonLinearVastImageLoadFailure")},this.ny.src=this.ty}oy(t,i,e){const s=this.hy(t,i,e);this.ly(s,t,i)}hy(t,i,e){let s;return s=t?this.uy(i,e):`height:${i.height}px; width: ${i.width}px;`,`<img alt="" src="${this.ty}" style="${s} display: block; pointer-events: all; cursor: pointer"/>`}ly(t,i,e){const{width:s,height:n}=e,h={shouldEmbedDisplayAdInSafeIframe:this.df,globalDomUtilsService:this.vt,adType:r.Z9.VIDEO_NON_LINEAR,adContainer:this.iy,sessionId:this.ks,advertiserLineItemId:this.ds,htmlTemplate:t,mime:ms.Html,adSize:{width:s,height:n,scalable:i?{maxHeightPercent:bt,maxWidthPercent:80}:void 0}};this.df?this.Of=new As(h):this.Of=new ys(h),this.Li.push(this.Of.onDisplayAd.subscribe((()=&gt;{this.tf.next()})),this.Of.onClickClose.subscribe((()=&gt;{this.ef.next()})),this.Of.onClickAd.subscribe((()=&gt;{this.sf.next()})),this.Of.onError.subscribe((()=&gt;{this.if.next("displayIntegratorIframeLoad")}))),this.Of.createBanner(e)}uy(t,i){const e=(0,nt.Tc)(i.height,bt),s=(0,nt.Tc)(i.width,80),r=t.height/e;return t.width/s&gt;r?"width: 100%;":"height: 100%;"}}const Qs={0:ct.f.AdVideoFirstQuartile,1:ct.f.AdVideoMidpoint,2:ct.f.AdVideoThirdQuartile,3:ct.f.AdVideoComplete};class Ks extends vs{constructor(t,i,e){super(i,e),this.Ff=t,this.Xt=i,this.settings=e,this.adMediaType="nonLinearVast",this.adSourceType=as.wS.VAST_MEDIA,this.py=[],this.As=500,this.my=0,this.vy=()=&gt;{this.gy.nonLinearClickTracking.uri&amp;&amp;this.settings.globalDomUtilsService.trackWithImages([this.gy.nonLinearClickTracking.uri]),this.gy.nonLinearClickThrough&amp;&amp;this.settings.globalDomUtilsService.open(this.gy.nonLinearClickThrough,"_blank"),this.vg({type:ct.f.AdClickThru,payload:{url:this.gy.nonLinearClickThrough}})}}get adVideoUrl(){return this.Nf}get declaredDurationInSeconds(){return this.my/ri.s_}initAd(t,i,e,s,r,n,h){try{if(super.initAd(t,i,e,s,r,n,h),!(0,ot.BZ)(this.settings.vastResponse.nonLinearFiles))return this.mg=503,void this.vg({type:ct.f.AdError,payload:{errorMessage:"nonLinearUnsupportedMedia",errorCode:this.mg}});if(this.gy=this.Iy(),!this.gy)return this.mg=501,void this.vg({type:ct.f.AdError,payload:{errorMessage:"nonLinearUnsupportedMedia",errorCode:this.mg}});this.Ay(),this.yy(),this.vg({type:ct.f.AdLoaded,payload:{}})}catch(t){(0,W.$K)(this.mg)||(this.mg=500);const{message:i}=(0,mt.W$)(t);this.vg({type:ct.f.AdError,payload:{errorMessage:`adaptorInitAdError_${i}`,errorCode:this.mg}})}}startAd(){super.startAd(),this.$f.start(),this.py.push(this._y.onDisplayAd.subscribe((()=&gt;{this.vg({type:ct.f.AdStarted}),this.vg({type:ct.f.AdVideoStart}),this.vg({type:ct.f.AdImpression,payload:{}})})),this._y.onError.subscribe((t=&gt;{this.mg=502,this.vg({type:ct.f.AdError,payload:{errorMessage:t,errorCode:this.mg}})})),this._y.onClickAd.subscribe((()=&gt;this.vy())),this._y.onClickClose.subscribe((()=&gt;{this.vg({type:ct.f.AdUserClose,payload:{}}),this.stopAd(R)})));const{height:t,width:i,scalable:e}=this.gy,s={height:t,width:i},r={height:this.Jv.clientHeight,width:this.Jv.clientWidth};this._y.initializeAd(this.Gv,s,r,e)}getAdMediaSize(){var t;return null===(t=this._y)||void 0===t?void 0:t.getAdMediaDimensions()}resizeAd(t,i,e){}pauseAd(){try{this.$f.stop(),this.vg({type:ct.f.AdPaused}),this.Wg()}catch(t){this.Qg("NonLinearVastBidAdaptor","pauseAd",(0,mt.W$)(t))}}resumeAd(){this.$f.start(),this.Wg()}expandAd(){}collapseAd(){}getAdRemainingTime(){return this.$f.timeRemaining}getAdDuration(){return this.my/ri.s_}getAdVolume(){return 0}Og(){var t,i;try{super.Og(),null===(t=this.$f)||void 0===t||t.stop(),(0,o.i)(this.py),null===(i=this._y)||void 0===i||i.destroy()}catch(t){this.Qg("NonLinearBidAdaptor","_destroy",(0,mt.W$)(t))}}Ay(){this.gy.staticResource&amp;&amp;(this._y=new Xs(this.gy.staticResource.uri,this.settings.globalDomUtilsService,this.settings.sessionId,this.settings.adManagerLineItem.protoLineItem.advertiserLineItemId,this.Ff.shouldEmbedDisplayAdInSafeIframe),this.Nf=this.gy.staticResource.creativeType,this.by())}by(){this.Jv.style.visibility="hidden"}yy(){var t;this.my=(null===(t=this.settings.adManagerLineItem.protoLineItem.nonlinearLineItemSettings)||void 0===t?void 0:t.adTimeSeconds)*ri.s_,this.$f=new _s.B(this.Xt,this.my,this.As),this.py.push(this.$f.onTimeUpdate.subscribe((()=&gt;{this.vg({type:ct.f.AdRemainingTimeChange})})),this.$f.onTimeElapsed.subscribe((()=&gt;{this.stopAd("nonLinearTimerElapsed")})),this.$f.onQuartile.subscribe((t=&gt;{this.vg({type:Qs[t],payload:{}})})))}Iy(){let t;if(t=this.settings.vastResponse.nonLinearFiles.find((t=&gt;!0===t.scalable)),!t){const i=(0,nt.Tc)(this.Jv.clientHeight,bt);t=this.settings.vastResponse.nonLinearFiles.find((t=&gt;t.height&lt;=i&amp;&amp;t.width&lt;=this.Jv.clientWidth))}return t}}var Zs=e(5196);class tr{constructor(t,i,e){this.Xt=t,this.Dv=i,this.mi=e,this.Sy=[],this.wy=[],this.As=500,this.wy.push(this.Dv.subscribe((t=&gt;{t.type===ct.f.AdPaused&amp;&amp;this.Ks(),t.type===ct.f.AdPlaying&amp;&amp;this.Ys()})))}init(){(0,W.$K)(this.mi.offset)?this.Py(this.mi.offset,(()=&gt;this.My())):this.My()}destroy(){var t;this.ky(),this.xy.removeEventListener("click",this.Ly.bind(this)),null===(t=this.$f)||void 0===t||t.disable(),(0,o.i)(this.Sy),(0,o.i)(this.wy),this.Sy=[],this.wy=[]}Cy(t){if(!(0,W.QM)(t)&amp;&amp;!(0,W.hj)(t))return"left: 0;";switch(t){case"left":return"left: 0;";case"right":return"right: 0;";default:return`left: ${t}px;`}}Ty(t){if(!(0,W.QM)(t)&amp;&amp;!(0,W.hj)(t))return"top: 0;";switch(t){case"top":return"top: 0;";case"bottom":return"bottom: 0;";default:return`top: ${t}px;`}}By(t){return(0,W.QM)(t)||(0,W.hj)(t)?"auto"===t?`width: ${t};`:`width: ${t}px;`:"width: auto;"}Ey(t){return(0,W.QM)(t)||(0,W.hj)(t)?"auto"===t?`height: ${t};`:`height: ${t}px;`:"height: auto;"}My(){this.xy=this.Dy(),this.xy.addEventListener("click",this.Ly.bind(this)),this.mi.$container.appendChild(this.xy),(0,W.$K)(this.mi.duration)&amp;&amp;this.Py(this.mi.duration,(()=&gt;this.destroy())),(0,W.$K)(this.mi.iconViewTracking)&amp;&amp;this.mi.globalDomUtilsService.trackWithImages([this.mi.iconViewTracking])}Py(t,i){this.$f=new _s.B(this.Xt,t,this.As),this.Sy.push(this.$f.onTimeElapsed.subscribe((()=&gt;{i()}))),this.$f.start()}ky(){this.xy.remove()}Ks(){var t;null===(t=this.$f)||void 0===t||t.stop()}Ys(){var t;null===(t=this.$f)||void 0===t||t.start()}Dy(){return this.mi.globalDomUtilsService.createElementByString(J.h`<cnx class="${" cnx-vast-icon"}"="" style="position:absolute;${this.Cy(this.mi.xPosition)}${this.Ty(this.mi.yPosition)}${this.By(this.mi.width)}${this.Ey(this.mi.height)}">${this.Ry()}</cnx>`)}Ly(){if(!(0,W.$K)(this.mi.iconClicks))return;const{iconClickTracking:t,iconClickThrough:i}=this.mi.iconClicks;(0,ot.BZ)(t)&amp;&amp;this.mi.globalDomUtilsService.trackWithImages(t),(0,W.QM)(i)&amp;&amp;this.mi.globalDomUtilsService.open(i,"_blank")}}class ir extends tr{Ry(){return`<img src="${this.mi.resource}">`}}class er extends tr{Ry(){return this.mi.resource}}class sr extends tr{Ry(){return`<iframe src="${this.mi.resource}"></iframe>`}}const rr=["AdChoices"];class nr{constructor(t,i,e,s,r){this.tA=t,this.Oy=i,this.vt=e,this.Xt=s,this.Dv=r,this.Fy=[]}initIcons(){if(!(0,ot.BZ)(this.Oy))return;const t=this.Vy(this.Oy);(0,ot.BZ)(t)&amp;&amp;(this.Ny=this.$y(),this.tA.appendChild(this.Ny),t.forEach((t=&gt;{const i=this.Uy(t);i.init(),this.Fy.push(i)})))}destroy(){for(;0!==this.Fy.length;){const t=this.Fy.length-1;this.Fy[t].destroy(),this.Fy.pop()}}$y(){return this.vt.createElementByString('<cnx class="cnx-vast-icons"></cnx>')}Vy(t){let i=[...t].filter((t=&gt;rr.includes(t.program))).filter((t=&gt;(0,W.QM)(t.staticResource)||(0,W.QM)(t.htmlResource)||(0,W.QM)(t.iframeResource)));return i=(0,ot.qy)("program",i.reverse()),i}Uy(t){const{width:i,height:e,xPosition:s,yPosition:r,staticResource:n,htmlResource:h,iframeResource:o,iconViewTracking:a,iconClicks:d,duration:c,offset:l}=t,u={globalDomUtilsService:this.vt,$container:this.Ny,resource:n||h||o,iconClicks:d,width:i,height:e,xPosition:s,yPosition:r,iconViewTracking:a,duration:c,offset:l};switch(u.resource){case n:return new ir(this.Xt,this.Dv,u);case h:return new er(this.Xt,this.Dv,u);case o:return new sr(this.Xt,this.Dv,u)}}}class hr{constructor(t,i){this.Wy=t,this.ur=i}getContentParts(){return{head:this.jy(),body:this.zy()}}jy(){return J.h`<style>.ad-element,body,html{width:100%;height:100%}body{overflow:hidden}</style>`}zy(){return J.h`<div class="ad-element" id="cnx-ad-element"></div><script src="${this.Wy}"></script><script>window.Object.defineProperty(Object.prototype,"cnxInnerTag",{enumerable:!1,writable:!0,value:"${this.ur}"}),window.Object.defineProperty(Function.prototype,"cnxInnerTag",{enumerable:!1,writable:!0,value:"${this.ur}"}),cnxtimeouts=[],cnxintervals=[],oldSetTimeout=setTimeout,setTimeout=function(e,t){var n=oldSetTimeout.apply(null,arguments);return cnxtimeouts.push(n),n},oldSetInterval=setInterval,setInterval=function(e,t){var n=oldSetInterval.apply(null,arguments);return cnxintervals.push(n),n},clearAll=function(){setTimeout=function(){},setInterval=function(){};for(var e=0;e<cnxtimeouts.length;e++)clearTimeout(cnxtimeouts[e]);for(e=0;e<cnxintervals.length;e++)clearInterval(cnxintervals[e])}</script>`}}class or{constructor(t,i,e,s,r,n,h){this.Wy=t,this.Hy=i,this.nt=e,this.ks=s,this.ur=r,this.ds=n,this.Gy=h,this.Im=new Be.o(this.nt,this.ks)}loadAdUnitIframe(t){return new Promise(((i,e)=&gt;{this.Jy(t).then((t=&gt;{this.Gy||(t.adContainer=t.iframe.contentWindow.document.querySelector(".ad-element")),i(t)})).catch((t=&gt;{e(t)}))}))}destroyAdUnit(){var t;try{if(!this.Gy){const i=null===(t=this.Im.iframe)||void 0===t?void 0:t.contentWindow,e=null==i?void 0:i.clearAll;e&amp;&amp;e()}}catch(t){const{message:i,stack:e}=(0,mt.W$)(t);(0,ft.FH)({message:"AdManager_VPAIClient_destroyAdUnit",exception:i,callStack:e,level:"Warn",sessionId:this.ks},{throttle:2,shouldSendMaxLog:!0})}this.Im.destroy(),this.Im=null}Jy(t){let i,e;if(!this.Gy){const t=new hr(this.Wy,this.ur).getContentParts();e=t.body,i=t.head}return this.Im.loadIframe({customHead:e,customHtml:i,container:t,customReportingLog:{heavyAdBlockTypeEnum:gs.l.VPAID_IFRAME,advertiserLineItemId:this.ds},iframeId:`cnx-ifr-${this.Hy}`,iframeClass:"omid-elem",title:dt.$b,safeIframeSettings:{isEnabled:this.Gy,mode:"VPAID"}})}}class ar extends ds{constructor(){super(...arguments),this.Yy=["handshakeVersion","initAd","startAd","stopAd","skipAd","resizeAd","pauseAd","resumeAd","expandAd","collapseAd","subscribe","unsubscribe"],this.Xy=Object.keys(ct.f),this.Ky=null}Qy(t,i){this.Dv.next({type:ct.f.AdError,payload:{errorMessage:t,errorCode:i}})}}class dr extends ar{constructor(t,i,e,s,r){super(),this.ds=t,this.Kv=i,this.hI=e,this.ks=s,this._r=r,this.Zy=null,this.t_=[],this.e_=new Set,this.i_=new Set,this.r_=(t,i,e)=&gt;{const s={url:t,playerHandles:e};this.n_(ct.f.AdClickThru,s)},this.n_=(t,i)=&gt;{if(this.i_.add(t),!this.e_.has(t))return t!==ct.f.AdImpression||this.i_.has(ct.f.AdLoaded)?void this.o_(t,i):((0,ft.FH)({message:"AdManager_AdVpaidWrapper_ImpressionBeforeAdLoaded",exception:`advertiserLineItemId:${this.ds}_creativeId:${this.Kv}_vpaidSrc:${this.hI}`,callStack:JSON.stringify((0,ot.ee)(this.i_)),level:"Warn",sessionId:this.ks},{throttle:1e3}),this.e_.add(ct.f.AdLoaded),void this.o_(ct.f.AdLoaded,i))},this.o_=(t,i)=&gt;{switch(t){case ct.f.AdError:this.Dv.next({type:ct.f.AdError,payload:{errorMessage:(0,W.HD)(i)?i:JSON.stringify(i),errorCode:901}});break;case ct.f.AdLoaded:this.Dv.next({type:ct.f.AdLoaded,payload:{skipOffset:(0,W.as)(i)?i.skipOffset:void 0}});break;case ct.f.AdImpression:this.Dv.next({type:ct.f.AdImpression,payload:{}});break;case ct.f.AdClickThru:this.Dv.next({type:ct.f.AdClickThru,payload:(0,W.as)(i)?i:{}});break;default:this.Dv.next({type:ct.f[t]})}}}adUnitLoaded(t,i){this.Ky=i;const{adContainer:e,iframe:s}=t,{videoSlot:r}=i.environmentVars;if(!e||!r)return void this.Qy("vpaidOnLoad",900);const n=s.contentWindow;if(!n)return void this.Qy("vpaidInvalid",901);const h=n.getVPAIDAd;if("function"!=typeof h)return void this.Qy("vpaidGetVpaidAdError",401);if(this.Zy=h(),!this.a_())return void this.Qy("vpaidInvalid",901);this.h_();const{width:o,height:a,vastViewMode:d,desireBitrate:c,creativeData:l}=i;this.initAd(o,a,d,c,l,{slot:e,videoSlot:r})}initAd(t,i,e,s,r,n){var h;null===(h=this.d_())||void 0===h||h.initAd(t,i,e,s,r,n)}startAd(){var t;this.i_.has(ct.f.AdImpression)&amp;&amp;!this.e_.has(ct.f.AdImpression)&amp;&amp;((0,ft.FH)({message:"AdManager_AdVpaidWrapper_brokenImpressionHandle",exception:`advertiserLineItemId:${this.ds}_creativeId:${this.Kv}_vpaidSrc:${this.hI}`,callStack:JSON.stringify((0,ot.ee)(this.i_)),level:"Warn",sessionId:this.ks},{throttle:1e3}),this.e_.add(ct.f.AdImpression),this.Dv.next({type:ct.f.AdImpression,payload:{}})),null===(t=this.d_())||void 0===t||t.startAd()}stopAd(t){var i;this.Zy?null===(i=this.d_())||void 0===i||i.stopAd(t):(0,ft.FH)({message:"stopAd",exception:t,level:"Warn",sessionId:this.ks})}resizeAd(t,i,e){var s;null===(s=this.d_())||void 0===s||s.resizeAd(t,i,e)}pauseAd(){var t;null===(t=this.d_())||void 0===t||t.pauseAd()}resumeAd(){var t;null===(t=this.d_())||void 0===t||t.resumeAd(),this._r===_e.M.Ios&amp;&amp;this.Ky&amp;&amp;(0,U.UR)(this.Ky.environmentVars.videoSlot)}expandAd(){var t;null===(t=this.d_())||void 0===t||t.expandAd()}collapseAd(){var t;null===(t=this.d_())||void 0===t||t.collapseAd()}skipAd(){var t;null===(t=this.d_())||void 0===t||t.skipAd()}getAdRemainingTime(){var t;return null===(t=this.d_())||void 0===t?void 0:t.getAdRemainingTime()}getAdDuration(){var t;return null===(t=this.d_())||void 0===t?void 0:t.getAdDuration()}getAdVolume(){var t;return null===(t=this.d_())||void 0===t?void 0:t.getAdVolume()}setAdVolume(t){var i;null===(i=this.d_())||void 0===i||i.setAdVolume(t)}destroy(){this.c_(),this.t_.length=0,this.Zy=null}hasErrorInsideIframe(){return!1}h_(){this.Xy.forEach((t=&gt;{var i;let e=this.n_.bind(this,ct.f[t]);ct.f[t]===ct.f.AdClickThru&amp;&amp;(e=this.r_),this.t_.push({handler:e,event:t}),null===(i=this.Zy)||void 0===i||i.subscribe(e,t)}))}c_(){this.t_.forEach((t=&gt;{var i;null===(i=this.Zy)||void 0===i||i.unsubscribe(t.handler,t.event)}))}a_(){const t=this.d_();return this.Yy.every((i=&gt;(0,W.mf)(null==t?void 0:t[i])))}d_(){if(this.Zy)return this.Zy}}var cr=e(3026);class lr extends ar{constructor(t,i,e,s,r){super(),this.ks=t,this._r=i,this.g_=e,this.Kv=s,this.Hy=r,this.f_=(0,h.AU)(cr.g),this.xf=null,this.pe=null,this.Lf=null,this.I_=!1,this.A_=!1,this.y_=()=&gt;{this.Dv.next({type:ct.f.AdError,payload:{errorMessage:"geoedgeMalwareDetected",errorCode:901}})},this.__=t=&gt;{if(!t.data)return;if(this.pe&amp;&amp;this.pe!==t.source)return;const{type:i,cnxIframeId:e,payload:s}=t.data;if(!i||!e)return;if(this.Lf&amp;&amp;this.Lf!==e)return;switch(i){case"adCreated":try{if(this.pe=t.source,!this.Ky)return void this.Qy("vpaidOnLoad",901);const{width:i,height:e,vastViewMode:s,desireBitrate:r,creativeData:n}=this.Ky;this.initAd(i,e,s,r,n)}catch(t){this.Dv.next({type:ct.f.AdError,payload:{errorMessage:"vpaidOnLoad",errorCode:901}})}break;case"scriptNotLoaded":this.Qy("vpaidScriptNotLoaded",901);break;case"vpaidObjectNotFound":this.Qy("vpaidGetVpaidAdError",401);break;case"invalidVpaid":this.Qy("vpaidInvalid",901);break;case"sourceNotFound":this.Qy("vpaidParentWindowSourceNotFound",901);break;case"originNotFound":this.Qy("vpaidParentWindowOriginNotFound",901);break;case"createAdPayloadMissing":this.Qy("vpaidCreateAdPayloadNotFound",901);break;case"initAdPayloadMissing":this.Qy("vpaidInitAdPayloadNotFound",901);break;case"impressionBeforeAdLoaded":(0,ft.FH)({message:"AdManager_AdVpaidWrapper_ImpressionBeforeAdLoaded",level:"Warn"},{throttle:1e3});break;case"alreadyAdStopped":(0,ft.FH)({message:"stopAd",exception:null==s?void 0:s.reason,level:"Warn",sessionId:this.ks});break;case"brokenImpressionHandle":(0,ft.FH)({message:"AdManager_AdVpaidWrapper_brokenImpressionHandle",level:"Warn"},{throttle:1e3});break;case"vpaidDestroyFailed":(0,ft.FH)({level:"Warn",message:"AdManager_VpaidIntegrator_destroyAd_safe"});break;case"safeIframeTryCatch":this.I_=!0,this.Dv.next({type:ct.f.AdError,payload:{errorMessage:`${s.message}`,errorCode:901}});break;case"errorInsideVpaid":{this.I_=!0;let t=null;try{t=s.message}catch(t){}this.Dv.next({type:ct.f.AdError,payload:{errorMessage:`${t}`,errorCode:901}});break}case"unhandledRejection":{this.I_=!0;let t=null;try{t=s.reason}catch(t){}this.Dv.next({type:ct.f.AdError,payload:{errorMessage:`${t}`,errorCode:901}});break}case"startAdError":this.Dv.next({type:ct.f.AdError,payload:{errorMessage:"wrapperStartAdError",errorCode:901}});break;case"loadAdError":this.Dv.next({type:ct.f.AdError,payload:{errorMessage:"vpaidOnLoad",errorCode:901}});break;case"AdError":this.Dv.next({type:ct.f.AdError,payload:{errorMessage:(0,W.HD)(s)?s:JSON.stringify(s),errorCode:901}});break;case"AdLoaded":(0,W.as)(s)&amp;&amp;(0,W.$K)(s.adDuration)&amp;&amp;!(0,W.Ft)(s.adDuration)&amp;&amp;(this.b_=s.adDuration),this.Dv.next({type:ct.f.AdLoaded,payload:{skipOffset:(0,W.as)(s)?s.skipOffset:void 0}});break;case"AdImpression":(0,W.as)(s)&amp;&amp;(0,W.$K)(s.adDuration)&amp;&amp;!(0,W.Ft)(s.adDuration)&amp;&amp;(this.b_=s.adDuration),this.Dv.next({type:ct.f.AdImpression,payload:{}});break;case"AdClickThru":if(this.A_){this.Dv.next({type:ct.f.AdClickThru,payload:(0,W.as)(s)?s:{}});break}(0,ft.FH)({level:"Warn",message:"AdManager_AdVpaidSafeIframeWrapper_clickThroughWithoutUserInteraction",exception:`creativeId: ${this.Kv}`},{pacing:1}),setTimeout((()=&gt;{this.A_&amp;&amp;(0,ft.FH)({level:"Warn",message:"AdManager_AdVpaidSafeIframeWrapper_clickThruEventTimeout",exception:`creativeId: ${this.Kv}`},{pacing:1})}),100);break;case"AdVolumeChange":(0,W.as)(s)&amp;&amp;(0,W.$K)(s.adVolume)&amp;&amp;!(0,W.Ft)(s.adVolume)&amp;&amp;(this.S_=s.adVolume),this.Dv.next({type:ct.f.AdVolumeChange});break;case"AdDurationChange":(0,W.as)(s)&amp;&amp;(0,W.$K)(s.adDuration)&amp;&amp;!(0,W.Ft)(s.adDuration)&amp;&amp;(this.b_=s.adDuration),this.Dv.next({type:ct.f.AdDurationChange});break;case"AdRemainingTimeChange":(0,W.as)(s)&amp;&amp;(0,W.$K)(s.adRemainingTime)&amp;&amp;!(0,W.Ft)(s.adRemainingTime)&amp;&amp;(this.w_=s.adRemainingTime),this.Dv.next({type:ct.f.AdRemainingTimeChange});break;case"IframeUserInteraction":this.A_=!0;break;default:this.Dv.next({type:ct.f[i]})}}}adUnitLoaded(t,i){if(this.Ky=i,this.xf=t.iframe.contentWindow,this.Lf=t.iframe.id,!this.xf)return void this.Qy("vpaidInvalid",901);window.addEventListener("message",this.__);const e=this.f_.getCodeForIframe(this.Hy,t.iframe);void 0!==e&amp;&amp;this.f_.onImpressionBlock(this.Hy,this.Kv,this.y_);const s={vpaidSrc:this.g_,mandatoryVpaidMethodNameList:this.Yy,subscribeToVpaidEventNameList:this.Xy,geoedgeCodeForIframe:e};this.Bf("createAd",s)}initAd(t,i,e,s,r){const n={width:t,height:i,viewMode:e,desireBitrate:s,creativeData:r};this.Bf("initAd",n)}startAd(){this.Bf("startAd")}stopAd(t){const i={reason:t};this.Bf("stopAd",i)}resizeAd(t,i,e){const s={width:t,height:i,viewMode:e};this.Bf("resizeAd",s)}pauseAd(){this.Bf("pauseAd")}resumeAd(){this.Bf("resumeAd",{os:this._r})}expandAd(){this.Bf("expandAd")}collapseAd(){this.Bf("collapseAd")}skipAd(){this.Bf("skipAd")}getAdRemainingTime(){return this.w_}getAdDuration(){return this.b_}getAdVolume(){return this.S_}setAdVolume(t){this.S_=t;const i={volume:t};this.Bf("setAdVolume",i)}destroy(){this.f_.stopMonitoring(this.Hy),null===window||void 0===window||window.removeEventListener("message",this.__),this.Bf("destroy")}hasErrorInsideIframe(){return this.I_}Bf(t,i){if(!this.Lf)return void(0,ft.FH)({level:"Warn",message:"AdVpaidSafeIframeWrapper_missing_iframe_id",exception:t},{throttle:1,shouldSendMaxLog:!1});if(!this.xf)return void(0,ft.FH)({level:"Warn",message:"AdVpaidSafeIframeWrapper_missing_target_window",exception:t},{throttle:1,shouldSendMaxLog:!1});const e={type:t,cnxIframeId:this.Lf};i&amp;&amp;(e.payload=i),this.xf.postMessage(e,{targetOrigin:"*"})}}class ur extends ds{constructor(t,i,e,s,r,n,h,o,a){super(),this.hI=t,this.Hy=i,this.nt=e,this.ks=s,this.P_=r,this.ds=n,this.Kv=h,this._r=o,this.Gy=a,this.M_=null,this.k_=null,this.Li=[],this.Gy?this.x_=new lr(this.ks,this._r,this.hI,this.Kv,this.Hy):this.x_=new dr(this.ds,this.Kv,this.hI,this.ks,this._r),this.Li.push(this.x_.onVpaidEvent.subscribe((t=&gt;{t.type===ct.f.AdImpression&amp;&amp;this.x_.resumeAd(),this.Dv.next(t)})))}initAd(t,i,e,s,r,n){try{const s={width:t,height:i,vastViewMode:e,desireBitrate:-1,creativeData:r,environmentVars:n};this.k_=new or(this.hI,this.Hy,this.nt,this.ks,this.P_,this.ds,this.Gy),this.M_=this.k_.loadAdUnitIframe(n.slot).then((t=&gt;{this.L_(t,s)})).catch((t=&gt;{this.Dv.next({type:ct.f.AdError,payload:{errorMessage:"vpaidOnLoad",errorCode:901}})}))}catch(t){this.Dv.next({type:ct.f.AdError,payload:{errorMessage:"vpaidOnLoad",errorCode:901}})}}startAd(){try{this.x_.startAd()}catch(t){this.Dv.next({type:ct.f.AdError,payload:{errorMessage:"wrapperStartAdError",errorCode:901}})}}stopAd(t){var i;null===(i=this.M_)||void 0===i||i.then((()=&gt;{this.x_.stopAd(t)}))}resizeAd(t,i,e){this.x_.resizeAd(t,i,e)}pauseAd(){this.x_.pauseAd()}resumeAd(){this.x_.resumeAd()}expandAd(){this.x_.expandAd()}collapseAd(){this.x_.collapseAd()}skipAd(){this.x_.skipAd()}getAdRemainingTime(){return this.x_.getAdRemainingTime()}getAdDuration(){return this.x_.getAdDuration()}getAdVolume(){return this.x_.getAdVolume()}setAdVolume(t){this.x_.setAdVolume(t)}destroy(){var t;try{this.Li.forEach((t=&gt;t.unsubscribe())),this.x_.destroy(),null===(t=this.k_)||void 0===t||t.destroyAdUnit()}catch(t){const{message:i,stack:e}=(0,mt.W$)(t);(0,ft.FH)({level:"Warn",message:"AdManager_VpaidIntegrator_destroyAd",exception:i,callStack:e,sessionId:this.ks})}}hasErrorInsideIframe(){return this.x_.hasErrorInsideIframe()}L_(t,i){this.x_.adUnitLoaded(t,i)}}const pr=["fb1bdb1d-9743-4237-94e3-35d254e13564","e9d12322-f412-4a4a-aacc-a0d36f91544c","cbee7f7d-b0ba-453b-a28f-a23bc304481e"],vr=["omid"],mr=["d4951dcc-ded7-4802-9eac-86ff2f365bd2","be35b190-05fc-4311-92c5-669931445a73","d5245a4a-10d8-4b70-831b-5b3f4971acd9","c8fbe6a4-41b3-45f2-a8cb-099c47c25caa","9e9c4cc5-6cda-4f75-b7d7-3f3efcd7c86b","073f8952-248e-49fe-a7ad-71331273520f","e923a448-9d18-46c1-acf9-25c21813c8b6","abae60aa-bb95-4b79-8ac9-c7ae4ee12472","3ec823f6-513b-4878-ade8-d5a985f5da8b","5db5f037-3967-4b43-9d1c-d292d6306c04","9e9c4cc5-6cda-4f75-b7d7-3f3efcd7c86b","d09e6f4d-26fb-41bb-bc12-6eb7788657a9","eb689ac4-3c80-480f-a4aa-178e8f8ebf83","1d509895-a65f-4a59-bace-4dd0f9ea7379"],gr=["d51ef482-de62-4d3c-8a5a-986136f4794a","eefc32fc-ac01-4255-86e2-dad45a12a5f8","a6559c8d-ae2e-4c56-b609-8f15a7bb8376","4dd82d05-defd-4488-a36f-1bf4f3a4605e","e0e53e49-db28-4d61-b141-2002b9426ab9","b7b726f7-4bfa-4497-acfe-e63579b34c13"];class fr extends vs{constructor(t,i,e){super(t,i),this.Xt=t,this.settings=i,this.lA=e,this.adSourceType=as.wS.AD_SOURCE_TYPE_UNSPECIFIED,this.wy=[],this.Sp=(0,h.TF)(this.settings.sessionId,Xi.G)}get adVideoUrl(){var t;return null===(t=this.C_)||void 0===t?void 0:t.src}get declaredDurationInSeconds(){return this.settings.vastResponse.duration/ri.s_}initAd(t,i,e,s,r,n,h){var o,a;try{super.initAd(t,i,e,s,r,n,h),Promise.all([(0,Ns.HJ)(this.settings.adManagerLineItem.protoLineItem.publisherLineItemId,null===(o=this.settings.vastResponse)||void 0===o?void 0:o.linearClickThrough),(0,Ns.Q4)(this.lA,null===(a=this.settings.vastResponse)||void 0===a?void 0:a.linearClickThrough)]).then((([r,n])=&gt;{var h,o,a,d,c,l;if(r||n)return void this.vg({type:ct.f.AdError,payload:{errorMessage:"domainBlocked",errorCode:900,blockedUrl:null===(h=this.settings.vastResponse)||void 0===h?void 0:h.linearClickThrough}});if(this.C_=this.T_(t),null===this.C_)return void this.vg({type:ct.f.AdError,payload:{errorMessage:"vastUnsupportedMedia",errorCode:401}});if((null===(o=this.C_.src)||void 0===o?void 0:o.includes(Qi.n.endPoints.ads.base.video))&amp;&amp;(this.C_.src=this.Lg.appendParamsToUrl(this.C_.src)),this.adMediaType=this.C_.type,1===this.C_.getMediaFileType())this.zv=!1,this.B_=new Bs(this.settings.globalDomUtilsService,this.C_.src,this.Jv,this.settings.os,this.settings.adManagerLineItem.protoLineItem.advertiserLineItemId,null===(a=this.settings.vastResponse)||void 0===a?void 0:a.linearClickThrough,this.settings.shouldLoopAdWhenFinished,this.settings.sessionId),this.adSourceType=as.wS.VAST_MEDIA;else{this.zv=!0,this.Hv=this.C_.src;const t=this.Gy();this.B_=new ur(this.C_.src,this.settings.bidId,this.settings.globalDomUtilsService,this.settings.sessionId,this.xg,this.settings.adManagerLineItem.protoLineItem.advertiserLineItemId,this.creativeId,this.settings.os,t),this.adSourceType=as.wS.VPAID}(0,ot.BZ)(null===(d=this.settings.vastResponse)||void 0===d?void 0:d.icons)&amp;&amp;(this.E_=new nr(this.Yv,this.settings.vastResponse.icons,this.settings.globalDomUtilsService,this.Xt,this.B_.onVpaidEvent)),this.wy.push(this.B_.onVpaidEvent.subscribe((t=&gt;{var i,e,s,r;if(t.type===ct.f.AdLoaded&amp;&amp;(t.payload.skipOffset=null===(i=this.settings.vastResponse)||void 0===i?void 0:i.skipoffset,t.payload.containers={slot:this.Gv,videoSlot:this.Jv},t.payload.verificationScriptResources=null===(e=this.settings.vastResponse)||void 0===e?void 0:e.verifications.filter((t=&gt;{var i;return(0,ot.d3)(null===(i=t.javaScriptResource)||void 0===i?void 0:i.apiFramework,vr)})).map((t=&gt;{const{javaScriptResource:i,vendor:e,verificationParameters:s,trackingEvents:r}=t;return{javaScriptResource:i.url,vendor:e,verificationParameters:s,trackingEvents:r}}))),t.type!==ct.f.AdClickThru)t.type===ct.f.AdStarted&amp;&amp;(null===(r=this.E_)||void 0===r||r.initIcons()),t.type===ct.f.AdError&amp;&amp;(this.mg=t.payload.errorCode),this.vg(t);else{this.D_=t.payload.url;const i=t.payload.url||(null===(s=this.settings.vastResponse)||void 0===s?void 0:s.linearClickThrough),e=e=&gt;{e?this.vg({type:ct.f.AdError,payload:{errorMessage:"domainBlocked",errorCode:900,blockedUrl:i}}):(i&amp;&amp;t.payload.playerHandles&amp;&amp;(this.settings.globalDomUtilsService.open(i,"_blank"),t.payload.url=i),this.vg(t))};Promise.all([(0,Ns.HJ)(this.settings.adManagerLineItem.protoLineItem.publisherLineItemId,i),(0,Ns.Q4)(this.lA,i)]).then((([t,i])=&gt;{e(t||i)})).catch((()=&gt;{(0,ft.FH)({level:"Info",message:"VastBidAdaptor_isDomainBlocked_clickThru_error"},{pacing:1,throttle:1,shouldSendMaxLog:!1})}))}})));const u={AdParameters:null===(c=this.settings.vastResponse)||void 0===c?void 0:c.adParameters,adParameters:null===(l=this.settings.vastResponse)||void 0===l?void 0:l.adParameters};this.B_.initAd(t,i,e,s,u,{slot:this.Gv,videoSlot:this.Jv})})).catch((t=&gt;{this.R_(t)}))}catch(t){this.R_(t)}}startAd(){var t;try{super.startAd();const i=null===(t=this.settings.adLoadedPayload)||void 0===t?void 0:t.payload.vastVerifications;if(!(0,ot.BZ)(i))return void this.B_.startAd();this.Sp.isOmsdkFullSupport?this.wy.push(this.Sp.omidResourcesReady.pipe((0,Zs.P)((t=&gt;t))).subscribe((()=&gt;{this.B_.startAd()})),this.Sp.verificationNotExecuted.subscribe((()=&gt;{this.Xu()}))):(this.Xu(),this.B_.startAd())}catch(t){const i=this.mg||400;this.mg=i;const{message:e}=(0,mt.W$)(t);this.vg({type:ct.f.AdError,payload:{errorCode:i,errorMessage:`adaptorStartAdError_${e}`}})}}stopAd(t){super.stopAd(t),this.B_?this.B_.stopAd(t):(0,ft.FH)({message:"stopAd",exception:t,level:"Warn",sessionId:this.settings.sessionId})}resizeAd(t,i,e){try{this.B_.resizeAd(t,i,e)}catch(t){this.Qg("VastBidAdaptor","resizeAd",(0,mt.W$)(t))}}pauseAd(){try{this.B_.pauseAd()}catch(t){this.Qg("VastBidAdaptor","pauseAd",(0,mt.W$)(t))}}resumeAd(){try{this.B_.resumeAd()}catch(t){this.Qg("VastBidAdaptor","resumeAd",(0,mt.W$)(t))}}expandAd(){try{this.B_.expandAd()}catch(t){this.Qg("VastBidAdaptor","expandAd",(0,mt.W$)(t))}}collapseAd(){try{this.B_.collapseAd()}catch(t){this.Qg("VastBidAdaptor","collapseAd",(0,mt.W$)(t))}}skipAd(){try{super.skipAd(),this.B_.skipAd()}catch(t){this.Qg("VastBidAdaptor","skipAd",(0,mt.W$)(t))}}getAdRemainingTime(){try{return this.B_.getAdRemainingTime()}catch(t){return this.Qg("VastBidAdaptor","getAdRemainingTime",(0,mt.W$)(t)),0}}getAdDuration(){try{return this.B_&amp;&amp;this.B_.getAdDuration()||Math.round(this.settings.vastResponse.duration/ri.s_)}catch(t){return this.Qg("VastBidAdaptor","getAdDuration",(0,mt.W$)(t)),0}}getAdVolume(){try{return this.B_.getAdVolume()}catch(t){return this.Qg("VastBidAdaptor","getAdVolume",(0,mt.W$)(t)),0}}getAdMediaSize(){let t=0,i=0;return this.B_ instanceof Bs?(t=this.B_.getAdMediaWidth(),i=this.B_.getAdMediaHeight()):(t=this.C_.width,i=this.C_.height),{width:t,height:i}}setAdVolume(t){try{super.setAdVolume(t),this.B_.setAdVolume(t)}catch(t){this.Qg("VastBidAdaptor","setAdVolume",(0,mt.W$)(t))}}hasErrorInsideIframe(){return!(!this.zv||!this.B_)&amp;&amp;this.B_.hasErrorInsideIframe()}qg(t){const i=super.qg(t);return this.O_(i)}jg(t){const i=super.jg(t);return this.O_(i)}Og(){var t,i;if(!this.settings.shouldLoopAdWhenFinished)try{super.Og(),(0,o.i)(this.wy),null===(t=this.B_)||void 0===t||t.destroy(),null===(i=this.E_)||void 0===i||i.destroy()}catch(t){this.Qg("VastBidAdaptor","_destroy",(0,mt.W$)(t))}}O_(t){var i,e;return t.payload.adSourceData.name=null===(i=this.settings.vastResponse)||void 0===i?void 0:i.adTitle,t.payload.clickThroughUrl=this.D_||(null===(e=this.settings.vastResponse)||void 0===e?void 0:e.linearClickThrough),t}F_(t){return t.filter((t=&gt;1===t.getMediaFileType()))}T_(t){var i,e;const s=this.F_(null===(i=this.settings.vastResponse)||void 0===i?void 0:i.mediaFiles),r=s.filter((t=&gt;"video/mp4"===t.type)),n=null===(e=this.settings.vastResponse)||void 0===e?void 0:e.mediaFiles.filter((t=&gt;0===t.getMediaFileType()));return this.V_()&amp;&amp;this.N_()&amp;&amp;(null==n?void 0:n.length)?Re(n,t):r.length?Re(r,t):s.length?Re(s,t):(null==n?void 0:n.length)?Re(n,t):null}N_(){const{advertiserLineItemId:t}=this.settings.adManagerLineItem.protoLineItem;return pr.includes(t)}V_(){var t,i;const e=null===(t=this.settings.vastResponse)||void 0===t?void 0:t.extensions.filter((t=&gt;"AdVerifications"===t.type));return(0,ot.BZ)(e)||(0,ot.BZ)(null===(i=this.settings.vastResponse)||void 0===i?void 0:i.verifications)}R_(t){const i=this.mg||400;this.mg=i;const{message:e}=(0,mt.W$)(t);this.vg({type:ct.f.AdError,payload:{errorCode:i,errorMessage:`adaptorInitAdError_${e}`}})}Xu(){Ni(this.settings.vastTracker.adError,this.settings.adMacroReplacer,this.settings.adManagerLineItem.protoLineItem,this.settings.callingState,this.settings.plcmt,410)}Gy(){var t;const{shouldRenderVpaidInSecureIframe:i,cnxCreativeId:e,publisherLineItemId:s}=this.settings.adManagerLineItem.protoLineItem;let r=i;return mr.includes(s)&amp;&amp;(r=!1),(gr.includes(e)||(null===(t=this.C_.src)||void 0===t?void 0:t.includes("https://am.contobox.com/v3/frontend/creatives/getcode.js")))&amp;&amp;(r=!1),r}}const Ir=["cnxima","native"];class yr{constructor(t){this.mediaFiles=[],this.nonLinearFiles=[],this.adTitle=void 0,this.adParameters=void 0,this.linearClickThrough=void 0,this.creativeId=void 0,this.creativeAdId=void 0,this.extensions=[],this.verifications=[],this.universalAdIds=[],this.vastXmls=[],this.icons=[],this.wrapperUrls=[],t.forEach((t=&gt;{this.vastXmls.push(t.xml),t.inLine?(this.adTitle=t.inLine.adTitle,this.extensions=t.inLine.extensions,this.advertiserId=t.inLine.advertiserId,this.advertiserName=t.inLine.advertiserName,this.U_(t.inLine.extensions),this.W_(t.inLine.adVerifications),this.Gd(t.inLine.creatives)):t.wrapper&amp;&amp;(this.wrapperUrls.push(t.wrapper.VASTAdTagURI),this.Gd(t.wrapper.creatives),this.W_(t.wrapper.adVerifications),this.U_(t.wrapper.extensions))}))}U_(t){(0,ot.BZ)(t)&amp;&amp;t.forEach((t=&gt;{(0,ot.BZ)(t.adVerifications)&amp;&amp;this.W_(t.adVerifications)}))}W_(t){this.verifications=[...this.verifications,...t]}Jd(t){this.duration=t.duration,this.j_(t.mediaFiles),this.q_(t.skipoffset),this.z_(t.adParameters),t.videoClicks&amp;&amp;t.videoClicks.clickThrough&amp;&amp;this.LI(t.videoClicks.clickThrough),(0,ot.BZ)(t.icons)&amp;&amp;this.H_(t.icons)}J_(t){this.Y_(t.nonLinearAdList),this.z_(t.adParameters)}Y_(t){this.nonLinearFiles=[...this.nonLinearFiles,...t]}H_(t){this.icons.push(...t)}z_(t){this.adParameters=t}q_(t){this.skipoffset=t}j_(t){this.mediaFiles=[...this.mediaFiles,...t]}LI(t){this.linearClickThrough=t}Gd(t){t.forEach((t=&gt;{this.creativeId=t.id?t.id.toString():void 0,this.creativeAdId=t.adId,t.universalAdId&amp;&amp;this.universalAdIds.push(t.universalAdId),t.linear&amp;&amp;this.Jd(t.linear),t.nonLinear&amp;&amp;this.J_(t.nonLinear)}))}}var Ar=e(2293);function br(t,i,e){return(0,yi.mG)(this,void 0,void 0,(function*(){let s=null;if((0,W.QM)(i)){const i=yield(0,Ar.p)(t,e);if(!i.default)throw new Error(hs.NetworkRequestUrl);s=i.default}return s}))}function _r(t,i,e,s,r){let n=t;try{const t=i.callingState.adContainerState.get(i.adManagerLineItem.protoLineItem.adType);(0,W.$K)(t)&amp;&amp;(n=function(t,i,e,s){const{callingState:r,plcmt:n,videoInsightsCategories:h,adManagerLineItem:{protoLineItem:{vendorId:o,advertiserLineItemId:a}}}=s,{adBreakState:{adBreakType:d},sound:c,media:{mediaDescription:l,mediaDuration:u,mediaId:p,mediaTitle:v,mediaUrl:m}}=r,g={adHeight:e.height,adWidth:e.width,adPostion:d,mute:c?0:1,plcmt:n,videoInsightsCategories:h},f={mediaDescription:l,mediaDuration:u,mediaId:p,mediaTitle:v,mediaUrl:m};return i.replace(t,o,a,{adMacros:g,mediaMacros:f})}(n,e,t,i),n=s.appendParams(n,t))}catch(t){throw new Error(hs.InvalidCreativeUrl)}const{vpMutePrice:h,vpMuteShouldRemove:o,isAdxAccount:a}=r.protoLineItem;let d=!1;return a&amp;&amp;o&amp;&amp;h&amp;&amp;i.price&gt;=h&amp;&amp;(n=(0,gt.iO)(n,Mt.hR),d=!0),{finalUrl:n,vpMuteRemoved:d}}function xr(t,i,e){!function(t,i,e){const s=new Oi(t,e);i.adError.push(...qi(s.errorUrls)),i.adImpression.push(...qi(s.impressions)),i.adViewableImpression.push(...qi(s.trackingEvents.viewable_impression)),i.adClick.push(...qi(s.clickTrackings)),i.adMute.push(...qi(s.trackingEvents.mute)),i.adPause.push(...qi(s.trackingEvents.pause)),i.adQuartileFirst.push(...qi(s.trackingEvents.firstQuartile)),i.adQuartileSecond.push(...qi(s.trackingEvents.midpoint)),i.adQuartileThird.push(...qi(s.trackingEvents.thirdQuartile)),i.adQuartileFourth.push(...qi(s.trackingEvents.complete)),i.adResume.push(...qi(s.trackingEvents.resume)),i.adSkip.push(...qi(s.trackingEvents.skip)),i.adStarted.push(...qi(s.trackingEvents.creativeView)),i.adVideoStart.push(...qi([...s.trackingEvents.start])),i.adUnmute.push(...i.adUnmute,...qi(s.trackingEvents.unmute)),i.adUserAcceptInvitation.push(...qi([...s.trackingEvents.acceptInvitation,...s.trackingEvents.acceptInvitationLinear])),i.adUserClose.push(...qi(s.trackingEvents.close)),i.adUserMinimize.push(...i.adUserMinimize,...qi([...s.trackingEvents.collapse,...s.trackingEvents.playerCollapse,...s.trackingEvents.adCollapse]))}(t,i.vastTracker,i.sessionId),e.push(t)}function Sr(){return(0,yi.mG)(this,void 0,void 0,(function*(){return new Promise((t=&gt;{setTimeout((()=&gt;{t(null)}),25e3)}))}))}class wr{constructor(t,i,e){this.X_=t,this.cA=i,this.K_=e}loadAd(){return(0,yi.mG)(this,void 0,void 0,(function*(){if(!(yield Promise.race([this.Q_(),Sr()]).catch((t=&gt;{throw this.cA.destroy(),t}))))throw this.cA.destroy(),new Error(hs.ExternalSdkTimeout)}))}Q_(){return new Promise(((t,i)=&gt;{this.cA.subscribeToSdkEvent(Us.REQUEST_SUCCESS,(()=&gt;{t(!0)})),this.cA.subscribeToSdkEvent(Us.AD_ERROR,(()=&gt;{i(new Error(hs.ExternalSdkInvalidResponse))})),this.cA.emitSdkEvent("requestAd",{url:this.X_,lineitemId:this.K_})}))}}function kr(t){const{adxLastLookParam:i,custParam:e,adxUprParam:s}=t,{adxFloorPrice:r,upr:n}=function(t){const{adxMinPrice:i,adxLastLookMinPrice:e,adxUprMinPrice:s,adxLastLookMaxPrice:r,adxUprMaxPrice:n,adxLastLookIncrementPrice:h}=t;if(i&lt;=e)return{adxFloorPrice:e,upr:s};if(i&gt;=r)return{adxFloorPrice:r,upr:n};if(i&gt;=n)return{adxFloorPrice:Math.ceil(10*i)/10,upr:n};if(Number.isInteger(i))return{adxFloorPrice:i,upr:i};const o=(0,mt.Za)(i);return{adxFloorPrice:o+h,upr:o}}(t);return e?`${e}&amp;${i}=${r}&amp;${s}=${n}`:`${i}=${r}&amp;${s}=${n}`}function Pr(t,i,e){const s=function(t,i){const e=Mt.Zu,s={range:[Mt.VT,Mt.a7],increment:e};if(t&amp;&amp;0!==t.length||(t=[s]),t.sort(((t,i)=&gt;t.range[0]-i.range[0])),i<t[0].range[0])return r="t[t.length-1];if(i" t[0].range[0].tofixed(2);const="">r.range[1])return r.range[1].toFixed(2);for(let s=0;s<t.length;s++){const[r,n]=t[s].range,h=t[s].increment||e;if(i>=r&amp;&amp;i&lt;=n){let o=i;if(o=Math.ceil((i-r)/h)*h+r,o&lt;=i&amp;&amp;(o+=h),o&lt;=n)return o.toFixed(2);for(let i=s+1;i<t.length;i++){const[s,r]=t[i].range,n=t[i].increment||e;if(o>=s&amp;&amp;o&lt;=r){if(o=Math.ceil((o-s)/n)*n+s,o&lt;=r)return o.toFixed(2);break}}return n.toFixed(2)}}return i.toFixed(2)}(null==e?void 0:e.pacing,i),r=(null==e?void 0:e.key)||Mt.B7;return t?`${t}&amp;${r}=${s}`:`${r}=${s}`}class Mr{constructor(t,i,e,r,n,o,d,c,l,u=!1,p=null,v,m,g){this.wA=t,this.PA=i,this.Uf=e,this.Wf=r,this.MA=n,this.dI=o,this.Rl=d,this.Z_=c,this.ks=l,this.tb=u,this.eb=p,this.ib=v,this.sb=m,this.LA=g,this.rb=new s.x,this.if=new s.x,this.nb={id:(0,mt.qs)()},this.kA=null,this.EA=t=&gt;{if(!this.DA(t))return;const i=t.getError().getErrorCode();switch(this.tb&amp;&amp;(0,ft.FH)({message:"Ima_Error_Code",exception:t.getError().getMessage(),level:"Info",sessionId:this.ks},{throttle:5,shouldSendMaxLog:!1}),i){case this.wA.AdError.ErrorCode.VAST_EMPTY_RESPONSE:this.ob(hs.ImaVastEmptyResponse);break;case this.wA.AdError.ErrorCode.VAST_WRAPPER_ERROR:case this.wA.AdError.ErrorCode.VAST_MALFORMED_RESPONSE:this.ob(hs.ImaInvalidResponse);break;default:this.ob(hs.ImaRequestException)}},this.ab=t=&gt;{this.DA(t)&amp;&amp;(this.kA=t.getAdsManager(this.dI,{loadVideoTimeout:25*ri.s_}),this.hb(),this.cb.adsManager.next(this.kA),this.rb.next({imaAdsManager:this.kA,requestAdsContext:this.nb}))},this.cb=(0,h.TF)(l,a.k).imaEvents,this.PA.addEventListener(this.wA.AdsManagerLoadedEvent.Type.ADS_MANAGER_LOADED,this.ab),this.PA.addEventListener(this.wA.AdErrorEvent.Type.AD_ERROR,this.EA)}get onSuccess(){return this.rb.asObservable()}get onError(){return this.if.asObservable()}loadAd(){const t=new this.wA.AdsRequest;if(t.omidAccessModeRules={[google.ima.OmidVerificationVendor.OTHER]:google.ima.OmidAccessMode.DOMAIN,[google.ima.OmidVerificationVendor.INTEGRAL_AD_SCIENCE]:google.ima.OmidAccessMode.FULL,[google.ima.OmidVerificationVendor.MOAT]:google.ima.OmidAccessMode.FULL,[google.ima.OmidVerificationVendor.DOUBLEVERIFY]:google.ima.OmidAccessMode.FULL,[google.ima.OmidVerificationVendor.PIXELATE]:google.ima.OmidAccessMode.FULL,[google.ima.OmidVerificationVendor.NIELSEN]:google.ima.OmidAccessMode.FULL,[google.ima.OmidVerificationVendor.COMSCORE]:google.ima.OmidAccessMode.FULL,[google.ima.OmidVerificationVendor.MEETRICS]:google.ima.OmidAccessMode.FULL,[google.ima.OmidVerificationVendor.GOOGLE]:google.ima.OmidAccessMode.FULL},this.LA===O&amp;&amp;(t.vastLoadTimeout=1e4),(0,W.QM)(this.eb))t.adsResponse=this.eb;else{let i=(0,gt.Ph)("cust_params",this.MA);((0,W.$K)(this.ib)||this.Z_)&amp;&amp;(this.Z_?i=kr({adxLastLookIncrementPrice:Mt.P8,adxLastLookMaxPrice:Mt.zt,adxLastLookMinPrice:Mt.FH,adxLastLookParam:Mt.wF,adxUprParam:Mt.rU,adxMinPrice:this.Z_,adxUprMaxPrice:Mt.qx,adxUprMinPrice:Mt.$w,custParam:i}):(0,W.$K)(this.ib)&amp;&amp;(i=this.lb(i,this.ib)));const e=new URL(this.MA);(0,W.QM)(i)&amp;&amp;e.searchParams.set("cust_params",i),t.adTagUrl=e.href}this.Z_&amp;&amp;(0,ft.FH)({message:"Adx_lookup_finalUrl",level:"Info",callStack:`${t.adTagUrl}`,sessionId:this.ks},{pacing:1}),t.linearAdSlotWidth=t.nonLinearAdSlotWidth=this.Uf,t.linearAdSlotHeight=t.nonLinearAdSlotHeight=this.Wf,t.pageUrl=this.Rl,(0,W.QM)(this.sb)&amp;&amp;this.PA.getSettings().setPpid(this.sb),this.PA.requestAds(t,this.nb)}destroy(){var t;try{this.hb(),null===(t=this.kA)||void 0===t||t.destroy()}catch(t){}}lb(t,i){const{uprQueryName:e,uprQueryValue:s}=i.adxData;return t?`${t}&amp;${e}=${s}&amp;dy=1`:`${e}=${s}&amp;dy=1`}ob(t){this.if.next(t)}hb(){this.PA.removeEventListener(this.wA.AdsManagerLoadedEvent.Type.ADS_MANAGER_LOADED,this.ab),this.PA.removeEventListener(this.wA.AdErrorEvent.Type.AD_ERROR,this.EA)}DA(t){const i=t.getUserRequestContext();return!i||i.id===this.nb.id}}function Cr(){return(0,yi.mG)(this,void 0,void 0,(function*(){return new Promise((t=&gt;{setTimeout((()=&gt;{t(null)}),25e3)}))}))}class Lr{constructor(t,i,e){this.imaAdSlot=t,this.imaDependencies=i,this.ks=e,this.ub=null,this.pb=!1,this.mb=[]}getImaAdModule(){return(0,yi.mG)(this,void 0,void 0,(function*(){try{const t=yield Promise.race([this.vb(),Cr()]);if(!t)throw new Error(hs.ImaTimeout);return this.pb=!0,this.ub&amp;&amp;(0,o.i)(this.mb),t}catch(t){throw this.pb=!0,this.ub&amp;&amp;((0,o.i)(this.mb),this.ub.destroy(),this.imaDependencies.adSlotContainerRecycler.recycleAdSlot(this.imaAdSlot)),(0,mt.W$)(t)}}))}gb(){return this.imaDependencies.adContainerState.get(this.imaDependencies.adType)}vb(){return(0,yi.mG)(this,void 0,void 0,(function*(){try{const t=yield this.imaAdSlot.fetchImaDependencies();return yield this.fb(t)}catch(t){throw(0,mt.W$)(t)}}))}fb(t){if(this.pb)throw new Error(hs.ImaRequestException);return new Promise(((i,e)=&gt;{const s=this.gb();if(!(0,W.$K)(s)||!(0,W.$K)(this.imaDependencies.url))throw new Error(hs.ImaRequestException);const r=this.imaDependencies.publisherLineItemId===O;this.ub=new Mr(t.imaSdk,t.imaAdsLoader,s.width,s.height,this.imaDependencies.url,this.imaAdSlot.videoSlot,this.imaDependencies.pageUrl,this.imaDependencies.adxMinPrice,this.ks,r,this.imaDependencies.xml,this.imaDependencies.adxFloorPrice,this.imaDependencies.ppid,this.imaDependencies.publisherLineItemId),this.mb.push(this.ub.onSuccess.subscribe((e=&gt;{i(Object.assign(Object.assign({},e),t))})),this.ub.onError.subscribe((t=&gt;{e(new Error(t))}))),this.ub.loadAd()}))}}class Tr extends Error{constructor(t){super(t.errorReason),this.vastErrorTrackers=[],this.vastErrorCode=t.vastErrorCode||900,this.vastErrorTrackers=t.errorUrlTrackers||[]}}function Br(t){return/^\s*$/.test(t)?null:/^(?:true|false)$/i.test(t)?"true"===t.toLowerCase():(0,gt.jv)(t)?t:isFinite(Number(t))?parseFloat(t):isFinite(Date.parse(t))?new Date(t):"string"==typeof t?t.trim():t}function Er(t){let i=0,e="";if(this.keyAttributes||(this.keyAttributes={}),t.hasChildNodes()){for(let i,s,r,n=0;n<t.childnodes.length;n++)i=t.childnodes.item(n),(i.nodetype-1|1)===node.text_node?e+=i.nodetype===node.text_node?i.nodevalue.trim():i.nodevalue:1!==i.nodetype||i.prefix||(s=i.nodename.tolowercase(),r=new 0="t.hasAttributes?t.attributes.length" er(i),this.hasownproperty(s)?(this[s].constructor!="Array&amp;&amp;(this[s]=[this[s]]),this[s].push(r)):this[s]=r);this.keyValue=e?Br(e):null}if(void">0:t.hasAttributes()){let e;for(;i<t.attributes.length;i++)e=t.attributes.item(i),this.keyattributes[e.name.tolowercase()]=br(e.value.trim())}}function &apos;="" &gt;="" &quot;="" dr(t){if(t&&t.keyvalue)return="" g,"="" g,"'").replace(="" g,'"').replace(="" rr(t){if("string"="typeof" t)return="" t.keyvalue}function="" t.replace(="">").replace(/&lt;/g,"&lt;").replace(/&amp;/g,"&amp;")}class Or{constructor(t){this.iconClickTracking=[],this.iconClickThrough=Dr(t.iconclickthrough),(0,W.$K)(t.iconclicktracking)&amp;&amp;(this.iconClickTracking=this.Ib((0,ot.qo)(t.iconclicktracking)))}Ib(t){return(0,ot.BZ)(t)?t.map((t=&gt;Dr(t))):[]}}var Fr=e(2206);class Vr{constructor(t){var i,e,s,r,n,h,o;this.program=null===(i=t.keyAttributes)||void 0===i?void 0:i.program,this.width=null===(e=t.keyAttributes)||void 0===e?void 0:e.width,this.height=null===(s=t.keyAttributes)||void 0===s?void 0:s.height,this.pxRatio=null===(r=t.keyAttributes)||void 0===r?void 0:r.pxratio,this.xPosition=null===(n=t.keyAttributes)||void 0===n?void 0:n.xposition,this.yPosition=null===(h=t.keyAttributes)||void 0===h?void 0:h.yposition,this.apiFramework=null===(o=t.keyAttributes)||void 0===o?void 0:o.apiframework,this.offset=(0,W.$K)(t.keyAttributes.offset)?(0,Fr.pP)(t.keyAttributes.offset):void 0,this.duration=(0,W.$K)(t.keyAttributes.duration)?(0,Fr.pP)(t.keyAttributes.duration):void 0,this.staticResource=Dr(t.staticresource),this.iframeResource=Dr(t.iframeresource),this.htmlResource=Dr(t.htmlresource),this.iconViewTracking=Dr(t.iconviewtracking),(0,W.$K)(t.iconclicks)&amp;&amp;(this.iconClicks=new Or(t.iconclicks))}}class $r{constructor(t,i){this.ks=i,this.delivery=void 0,this.type=void 0,this.width=0,this.height=0,this.codec=void 0,this.id=void 0,this.bitrate=void 0,this.minBitrate=void 0,this.maxBitrate=void 0,this.scalable=void 0,this.maintainAspectRatio=void 0,this.apiFramework=void 0,this.src=void 0,this.isSupported=!0,this.Ab=["text/javascript","text/javascript1.0","text/javascript1.2","text/javascript1.4","text/jscript","application/javascript","application/x-javascript","text/ecmascript","text/ecmascript1.0","text/ecmascript1.2","text/ecmascript1.4","text/livescript","application/ecmascript","application/x-ecmascript"],this.yb="VPAID",this.delivery=t.keyAttributes.delivery,this.type=t.keyAttributes.type,this.width=t.keyAttributes.width,this.height=t.keyAttributes.height,this.codec=t.keyAttributes.codec,this.id=t.keyAttributes.id,this.bitrate=t.keyAttributes.bitrate,this.minBitrate=t.keyAttributes.minbitrate,this.maxBitrate=t.keyAttributes.maxbitrate,this.scalable=t.keyAttributes.scalable,this.maintainAspectRatio=t.keyAttributes.maintainaspectratio,this.apiFramework=t.keyAttributes.apiframework,this.src=Dr(t),this.isSupported=this._b()}getMediaFileType(){return this.apiFramework===this.yb||(0,ot.d3)(this.type,this.Ab)?0:1}_b(){if("VPAID"===this.apiFramework||(0,ot.d3)(this.type,this.Ab))return!0;if("application/x-shockwave-flash"===this.type||"video/x-flv"===this.type)return!1;if(!(0,W.QM)(this.type))return(0,ft.FH)({message:"MediaFile_type_not_provided",level:"Warn",sessionId:this.ks}),!0;const t=document.createElement("video").canPlayType(this.type);return!!(0,W.QM)(t)}}class Nr{constructor(t){this.clickThrough=void 0,this.clickTrackings=[],this.customClicks=[],this.clickThrough=Dr(t.clickthrough),this.clickTrackings=this.bb((0,ot.qo)(t.clicktracking)),this.customClicks=this.bb((0,ot.qo)(t.customclick))}bb(t){const i=[];return void 0!==t[0]&amp;&amp;t.forEach((t=&gt;{i.push(Dr(t))})),i}}class Ur{constructor(t,i){this.name=t.keyAttributes.event,this.uri=Dr(t),"progress"===this.name&amp;&amp;(this.offset=(0,Fr.QI)(t.keyAttributes.offset,i))}}function Wr(t,i){const e=[];return void 0!==t[0]&amp;&amp;t.forEach((t=&gt;{e.push(new Ur(t,i))})),e}function jr(t){const i=[];return void 0!==t[0]&amp;&amp;t.forEach((t=&gt;{i.push(Dr(t))})),i}function qr(t){return jr(t)}function Hr(t){return jr(t)}class zr{constructor(t,i){this.ks=i,this.duration=void 0,this.mediaFiles=[],this.icons=[],this.trackingEvents=[],this.skipoffset=void 0,this.videoClicks=void 0,this.duration=(0,Fr.pP)(Dr(t.duration)),this.skipoffset=(0,Fr.QI)(t.keyAttributes.skipoffset,this.duration),t.mediafiles&amp;&amp;(this.mediaFiles=this.Sb((0,ot.qo)(t.mediafiles.mediafile))),t.trackingevents&amp;&amp;(this.trackingEvents=Wr((0,ot.qo)(t.trackingevents.tracking),this.duration)),t.videoclicks&amp;&amp;(this.videoClicks=new Nr(t.videoclicks)),t.adparameters&amp;&amp;(this.adParameters=Dr(t.adparameters),t.adparameters["@xmlEncoded"]&amp;&amp;(this.adParameters=Rr(this.adParameters))),t.icons&amp;&amp;t.icons.icon&amp;&amp;(this.icons=this.wb((0,ot.qo)(t.icons.icon)))}isSupported(){return!0}Sb(t){const i=[];return void 0!==t[0]&amp;&amp;t.forEach((t=&gt;{const e=new $r(t,this.ks);i.push(e)})),i}wb(t){return(0,ot.BZ)(t)?t.map((t=&gt;new Vr(t))):[]}}class Gr{constructor(t,i){var e;this.ks=i,this.minSuggestedDuration=void 0,this.staticResource={},this.htmlResource={},this.iframeResource={},this.nonLinearClickTracking={},this.id=t.keyAttributes.id,this.width=t.keyAttributes.width,this.height=t.keyAttributes.height,this.expandedWidth=t.keyAttributes.expandedheight,this.expandedHeight=t.keyAttributes.expandedwidth,this.scalable=t.keyAttributes.scalable,this.maintainAspectRatio=t.keyAttributes.maintainaspectratio,this.apiFramework=t.keyAttributes.apiframework,this.minSuggestedDuration=(0,Fr.pP)(t.keyAttributes.minsuggestedduration),this.nonLinearClickThrough=null===(e=t.nonlinearclickthrough)||void 0===e?void 0:e.keyValue,t.nonlinearclicktracking&amp;&amp;(this.nonLinearClickTracking.id=t.nonlinearclicktracking.keyAttributes.id,this.nonLinearClickTracking.uri=t.nonlinearclicktracking.keyValue),t.staticresource&amp;&amp;(this.staticResource.creativeType=t.staticresource.keyAttributes.creativetype,this.staticResource.uri=t.staticresource.keyValue),t.iframeresource&amp;&amp;(this.iframeResource.uri=t.iframeresource.keyValue),t.htmlresource&amp;&amp;(this.htmlResource.uri=t.htmlresource.keyValue)}isSupported(){return"VPAID"===this.apiFramework?((0,ft.FH)({message:"AdManager_NonLinearAd_VPAID_found",level:"Info",sessionId:this.ks},{pacing:10,shouldSendMaxLog:!1}),!1):this.width&amp;&amp;this.height?!(!this.staticResource.creativeType||!this.staticResource.uri)||(this.htmlResource.uri&amp;&amp;(0,ft.FH)({message:"AdManager_NonLinearAd_htmlResource_found",level:"Info",sessionId:this.ks},{pacing:10,shouldSendMaxLog:!1}),this.iframeResource.uri&amp;&amp;(0,ft.FH)({message:"AdManager_NonLinearAd_iframeResource_found",level:"Info",sessionId:this.ks},{pacing:10,shouldSendMaxLog:!1}),!1):((0,ft.FH)({message:"AdManager_NonLinearAd_no_dimensions",level:"Info",sessionId:this.ks},{pacing:10,shouldSendMaxLog:!1}),!1)}}class Jr{constructor(t,i){if(this.ks=i,this.nonLinearAdList=[],this.trackingEvents=[],this.Pb=!1,t.nonlinear){const i=(0,ot.qo)(t.nonlinear);this.nonLinearAdList=this.Mb(i),this.Pb=(0,ot.BZ)(i)&amp;&amp;0===this.nonLinearAdList.length}t.trackingevents&amp;&amp;(this.trackingEvents=Wr((0,ot.qo)(t.trackingevents.tracking))),t.adparameters&amp;&amp;(this.adParameters=Dr(t.adparameters),t.adparameters["@xmlEncoded"]&amp;&amp;(this.adParameters=Rr(this.adParameters)))}get hasInvalidResource(){return this.Pb}isSupported(){return!0}Mb(t){return t.map((t=&gt;new Gr(t,this.ks))).filter((t=&gt;t.isSupported()))}}class Yr{constructor(t,i){if(this.id=void 0,this.sequence=void 0,this.adId=void 0,this.linear=void 0,this.nonLinear=void 0,this.universalAdId=void 0,this.id=t.keyAttributes.id,this.sequence=t.keyAttributes.sequence,this.adId=t.keyAttributes.adid,this.universalAdId=Dr(t.universaladid),t.linear)try{this.linear=new zr(t.linear,i)}catch(t){const{message:e,stack:s}=(0,mt.W$)(t);(0,ft.FH)({sessionId:i,callStack:s,level:"Warn",exception:e,message:"Creative_Linear"})}if(t.nonlinearads)try{this.nonLinear=new Jr(t.nonlinearads,i)}catch(t){const{message:e,stack:s}=(0,mt.W$)(t);(0,ft.FH)({sessionId:i,callStack:s,level:"Warn",exception:e,message:"Creative_NonLinear"})}}isSupported(){return!0}}function Xr(t,i){const e=[];return t.forEach((t=&gt;{e.push(new Yr(t,i))})),e}class Qr{constructor(t){var i,e;this.url=t.keyValue,this.apiFramework=null===(i=t.keyAttributes)||void 0===i?void 0:i.apiframework,this.browserOptional=null===(e=t.keyAttributes)||void 0===e?void 0:e.browseroptional}}class Kr{constructor(t,i){var e,s;try{this.vendor=t.keyAttributes.vendor,t.javascriptresource&amp;&amp;(this.javaScriptResource=new Qr(t.javascriptresource)),this.verificationParameters=null===(e=t.verificationparameters)||void 0===e?void 0:e.keyValue,this.trackingEvents=(null===(s=t.trackingevents)||void 0===s?void 0:s.tracking)?Wr((0,ot.qo)(null==t?void 0:t.trackingevents.tracking)):[]}catch(t){const{message:e,stack:s}=(0,mt.W$)(t);(0,ft.FH)({sessionId:i,message:"OMID_Verification_parse_error",level:"Warn",callStack:s,exception:e})}}}function Zr(t,i){return t.map((t=&gt;new Kr(t,i)))}class tn{constructor(t,i){var e;this.adVerifications=void 0,this.type=t.keyAttributes.type,this.adVerifications=(null===(e=null==t?void 0:t.adverifications)||void 0===e?void 0:e.verification)?Zr((0,ot.qo)(t.adverifications.verification),i):[]}}function en(t,i){return t.map((t=&gt;new tn(t,i)))}class sn{constructor(t,i){var e,s,r,n;this.description=void 0,this.advertiserName=void 0,this.advertiserId=void 0,this.surveys=void 0,this.errors=void 0,this.pricing=void 0,this.extensions=void 0,this.adVerifications=void 0,this.adTitle=Dr(t.adtitle),this.adSystem=Dr(t.adsystem),this.impressions=qr((0,ot.qo)(t.impression)),this.creatives=(null===(e=t.creatives)||void 0===e?void 0:e.creative)?Xr((0,ot.qo)(t.creatives.creative),i):[],this.description=Dr(t.description),this.advertiserName=Dr(t.advertiser),this.advertiserId=null===(s=t.advertiser)||void 0===s?void 0:s.keyAttributes.id,this.surveys=Dr(t.survey),this.errors=Hr((0,ot.qo)(t.error)),this.pricing=Dr(t.pricing),this.extensions=(null===(r=t.extensions)||void 0===r?void 0:r.extension)?en((0,ot.qo)(t.extensions.extension),i):[],this.adVerifications=(null===(n=t.adverifications)||void 0===n?void 0:n.verification)?Zr((0,ot.qo)(t.adverifications.verification),i):[]}isSupported(){return!0}}class rn{constructor(t,i){var e,s,r;this.adSystem=void 0,this.impressions=[],this.VASTAdTagURI=void 0,this.creatives=[],this.errors=void 0,this.fallowAdditionalWrappers=void 0,this.allowMultipleAds=void 0,this.fallbackOnNoAd=void 0,this.adVerifications=void 0,this.extensions=void 0,this.adSystem=Dr(t.adsystem),this.impressions=qr((0,ot.qo)(t.impression)),this.VASTAdTagURI=Dr(t.vastadtaguri),this.creatives=(null===(e=t.creatives)||void 0===e?void 0:e.creative)?Xr((0,ot.qo)(t.creatives.creative),i):[],this.errors=Hr((0,ot.qo)(t.error)),this.fallowAdditionalWrappers=t.keyAttributes.followadditionalwrappers||!0,this.allowMultipleAds=t.keyAttributes.allowmultipleads,this.fallbackOnNoAd=t.keyAttributes.fallbackonnoad,this.adVerifications=(null===(s=null==t?void 0:t.adverifications)||void 0===s?void 0:s.verification)?Zr((0,ot.qo)(t.adverifications.verification),i):[],this.extensions=(null===(r=null==t?void 0:t.extensions)||void 0===r?void 0:r.extension)?en((0,ot.qo)(t.extensions.extension),i):[]}}class nn{constructor(t,i,e){this.ks=i,this.xml=e,Array.isArray(t)?this.kb(t):this.xb(t)}isSupported(){return!0}xb(t){this.id=t.keyAttributes.id,this.sequence=t.keyAttributes.sequence,t.inline?this.inLine=new sn(t.inline,this.ks):t.wrapper&amp;&amp;(this.wrapper=new rn(t.wrapper,this.ks))}kb(t){const i=t.filter((t=&gt;{const i=this.Lb(t).filter((t=&gt;t.linear));return!!(0,ot.BZ)(i)}));(0,ot.BZ)(i)&amp;&amp;this.xb(i[0])}Lb(t){return t.inline?(0,ot.qo)(t.inline.creatives.creative):t.wrapper?(0,ot.qo)(t.wrapper.creatives.creative):[]}}class hn{constructor(t=2,i){this.Cb=t,this.ks=i}parseVastXml(t){var i,e;try{if(!function(t){const i=(new DOMParser).parseFromString(t,"text/xml").documentElement.querySelector("parsererror");return(0,W.Ft)(i)}(t))return{hasError:!0,vastErrorCode:100,errorReason:hs.XmlInvalidString};if(this.Tb(t))return{hasError:!0,vastErrorCode:900,errorReason:hs.XmlInvalidAd};if(this.Bb(t))return{hasError:!0,vastErrorCode:900,errorReason:hs.VastContainsBannedUrls};const s=new DOMParser,r=new Er(s.parseFromString(t,"application/xml").documentElement);if(!this.Eb(r))return{hasError:!0,vastErrorCode:101,errorReason:hs.XmlInvalidTree};if(!this.Db(r,this.Cb))return{hasError:!0,vastErrorCode:102,errorReason:hs.VastVersionNotSupported};const n=new nn(r.ad,this.ks,t);let h=[],o=[];(0,ot.BZ)(null===(i=null==n?void 0:n.inLine)||void 0===i?void 0:i.creatives)&amp;&amp;(h=n.inLine.creatives.filter((t=&gt;{var i;return(0,ot.BZ)(null===(i=null==t?void 0:t.linear)||void 0===i?void 0:i.mediaFiles)})),o=null===(e=null==n?void 0:n.inLine)||void 0===e?void 0:e.creatives.filter((t=&gt;{var i;return(0,ot.BZ)(null===(i=null==t?void 0:t.nonLinear)||void 0===i?void 0:i.nonLinearAdList)})));const a=this.Rb(n,h,o);return a.isValid?this.Fb(n,o)?{hasError:!1,result:n}:{hasError:!0,vastErrorCode:403,errorReason:hs.VastMediaFilesNotSupported,errorUrlTrackers:this.Vb(n)}:2===a.reason&amp;&amp;this.Nb(n)?{hasError:!0,vastErrorCode:503,errorReason:hs.XmlInvalidAd,errorUrlTrackers:this.Vb(n)}:{hasError:!0,vastErrorCode:101,errorReason:hs.XmlInvalidAd}}catch(t){return{hasError:!0,vastErrorCode:900,errorReason:hs.XmlParseGeneral}}}Vb(t){var i;const e=[];return null===(i=null==t?void 0:t.inLine)||void 0===i||i.errors.forEach((t=&gt;{e.push({url:t,type:Di.$b.IMAGE})})),e}Nb(t){var i,e;return null===(e=null===(i=t.inLine)||void 0===i?void 0:i.creatives)||void 0===e?void 0:e.some((t=&gt;{var i;return null===(i=t.nonLinear)||void 0===i?void 0:i.hasInvalidResource}))}Fb(t,i){var e,s;if((0,W.$K)(t.wrapper))return!0;null===(e=null==t?void 0:t.inLine)||void 0===e||e.creatives.forEach((t=&gt;{var i;(0,ot.BZ)(null===(i=null==t?void 0:t.linear)||void 0===i?void 0:i.mediaFiles)&amp;&amp;(t.linear.mediaFiles=this.Ub(t.linear.mediaFiles))}));const r=null===(s=null==t?void 0:t.inLine)||void 0===s?void 0:s.creatives.reduce(((t,i)=&gt;{var e;return(0,ot.BZ)(null===(e=null==i?void 0:i.linear)||void 0===e?void 0:e.mediaFiles)?[...t,...i.linear.mediaFiles]:t}),[]);return!(!(0,ot.BZ)(r)&amp;&amp;!(0,ot.BZ)(i))}Ub(t){return t.filter((t=&gt;t.isSupported))}Tb(t){return Hs.some((i=&gt;t.includes(i)))}Db(t,i){const e=parseInt(t.keyAttributes.version,10);return!(e&amp;&amp;e<i)}eb(t){return!!t.ad}rb(t,i,e){const s="t.wrapper;return" t.inline||s?s&&!s.vastadtaguri?{isvalid:!1,reason:1}:s||(0,ot.bz)(i)||(0,ot.bz)(e)?{isvalid:!0}:{isvalid:!1,reason:2}:{isvalid:!1,reason:0}}bb(t){return="" zs.some((i="">t.includes(i)))}}const on={[r.H6.EXTERNAL]:t=&gt;t.floorPrice||t.customCpm,[r.H6.MEDIA_FILE]:t=&gt;t.floorPrice||t.customCpm,[r.H6.THIRD_PARTY]:t=&gt;t.adxLookupPrice||t.floorPrice||t.customCpm||t.adxFloorPrice,[r.H6.HEADER_BIDDER]:t=&gt;t.prebidjsCPM,[r.H6.RTB]:t=&gt;(0,Zt.R)(t.obfuscatedPrice),[r.H6.TAM]:t=&gt;(0,Zt.R)(t.obfuscatedPrice),[r.H6.TAM_DEAL]:t=&gt;(0,Zt.R)(t.obfuscatedPrice),[r.H6.TAM_PRIVATE_AUCTION]:t=&gt;(0,Zt.R)(t.obfuscatedPrice)};class an{constructor(t,i){this.Wb=t,this.cA=i,this.Li=[]}subscribeToSdkEvent(t,i){const e=t=&gt;{t.id===this.Wb&amp;&amp;i(t)};this.Li.push((()=&gt;{this.cA.remove(t,e)})),this.cA.on(t,e)}emitSdkEvent(t,i){this.cA.publish(t,Object.assign(Object.assign({},i),{id:this.Wb}))}destroy(){this.Li.forEach((t=&gt;t())),this.Li.length=0,this.emitSdkEvent("destroyAd")}}var dn=e(466),cn=e(7068),ln=e(3841);class un{constructor(t){this.zb=t,this.Hb=!1,this.ls=(0,h.TF)(this.zb.sessionId,ln.B),this.bn=(0,h.TF)(this.zb.sessionId,"MonetizationService")}fetchBid(t){var i,e;return(0,yi.mG)(this,void 0,void 0,(function*(){const s=this.Gb(t),{lineItem:n,requestMetadata:{data:{cnxBidId:h,encryptedPrice:o}}}=t,{protoLineItem:{creativeType:a}}=n,{price:d,bidId:c,yoScore:l,isIma:u}=s,p={bidPrice:d,bidId:c,yoScore:l,isIma:u,adManagerLineItem:n,encryptedPrice:o},v=null===(e=null===(i=this.zb.standaloneService.bestAd)||void 0===i?void 0:i.bid)||void 0===e?void 0:e.cnxBidId;let m;a===r.H6.RTB&amp;&amp;(0,W.QM)(h)&amp;&amp;h===v&amp;&amp;(p.yoScore=Number.MAX_SAFE_INTEGER,s.yoScore=Number.MAX_SAFE_INTEGER);try{!function(t,i){t.onBidFetchStart.next(i),i.adManagerLineItem.bidsInFetch.add(i.bidId)}(this.zb.adEvents,p),m=yield this.Jb(t,s)}catch(t){throw(0,mt.W$)(t)}finally{!function(t,i){t.onBidFetchEnd.next(i),i.adManagerLineItem.bidsInFetch.delete(i.bidId)}(this.zb.adEvents,p)}return m.shouldBeDiscarded=p.shouldBeDiscarded,m}))}Jb(t,i){return(0,yi.mG)(this,void 0,void 0,(function*(){const e=t.url||i.adManagerLineItem.protoLineItem.adTag||"",s=t.vastTag;switch(t.lineItem.protoLineItem.creativeType){case r.H6.EXTERNAL:case r.H6.THIRD_PARTY:return t.lineItem.protoLineItem.adType===r.Z9.VIDEO_OVERLAY?this.Yb(i):function(t,i,e){if(!t)return!1;const{isExternallyManaged:s,isAdxAccount:r}=i.protoLineItem;return s||r||e.includes(`${Ir[0]}=${Ir[1]}`)}(this.zb.canUseExternalAdService,t.lineItem,e)?this.Xb(i,e,t):t.lineItem.protoLineItem.externalVastXml?this.Kb(t.lineItem.protoLineItem.externalVastXml,i,t):this.Qb(e,i,t);case r.H6.MEDIA_FILE:return this.Zb(i);case r.H6.RTB:return this.tS(i,t);case r.H6.HEADER_BIDDER:return(0,W.QM)(s)?this.Kb(s,i,t):this.Qb(e,i,t);case r.H6.TAM:case r.H6.TAM_DEAL:case r.H6.TAM_PRIVATE_AUCTION:return this.Qb(e,i,t);default:throw new Error(hs.InvalidCreativeType)}}))}Gb(t){const{lineItem:i,obfuscatedPrice:e,vastTracker:s,state:n,requestMetadata:h,prebidjsCPM:o,slotId:a,bidId:d,creativeId:c,adxMinPrice:l,plcmt:u,url:p}=t,{globalDomUtilsService:v,viewabilityService:m,adEnforcer:g,os:f,adSlotContainerRecycler:I,urlSuffixerService:y,sessionId:A,adContainerMap:b}=this.zb,{currentMediaMetadata:{videoInsightsCategories:_},pmpRevSharePercentage:x,openMarketRevSharePercentage:S,shouldUseNetCPM:w}=this.ls,{creativeType:k,floorPrice:P,customCpm:M,adType:C,grossNetPercentageDifference:L,lineItemPriority:T,rpmExploration:B,advertiserLineItemId:E,publisherLineItemId:D,isAdxAccount:R,isAdxLookup:O,adxFloorPricePredictionList:F,adTag:V,infrastructureFee:$,fixedInfraCpmFee:N,isDeal:U,creativeMarketType:j}=i.protoLineItem,{requestedFloorPrice:q,discount:H}=h.data;let z=function(t,i){return(0,on[t])(i)}(k,{floorPrice:P,customCpm:M,obfuscatedPrice:e,prebidjsCPM:o,adxFloorPrice:q||0,adxLookupPrice:l});(0,W.r)(z)||((0,ft.FH)({message:"AdManager_BidFactory_no_cpm_on_bid",level:"Error",callStack:`advLId: ${E}, pubLId: ${D} Creative type: ${k} isAdx: ${R} hasAggregator: ${i.hasAggregator} adxLookup: ${O} prices_length: ${F.length}`,exception:`${p||V||""}`,sessionId:A},{throttle:1,shouldSendMaxLog:!1}),z=0);const{infrastructureFeeCustomer:G,servingFeeTypeCustomer:J,servingFeeCpmCustomer:Y,servingFeeRevShareCustomer:X}=this.bn,Q=Nt({priority:T,grossNetPercentageDifference:L,cpm:z,rpmScore:B,shouldUseNetCPM:w,infrastructureFee:$,openMarketRevSharePercentage:S,pmpRevSharePercentage:x,discount:H,fixedInfraCpmFee:N,isDeal:U,isPublisherLineItem:D===E,isPrivateMarket:j===r.ao.PMP,infrastructureFeeCustomer:G,servingFeeTypeCustomer:J,servingFeeCpmCustomer:Y,servingFeeRevShareCustomer:X,creativeType:k});const K=b.get(C);if(!(0,W.$K)(K))throw new Error("AdManager_BidFactory_adContainer_is_undefined");return{adContainer:K,requestMetadata:h,globalDomUtilsService:v,viewabilityService:m,adEnforcer:g,os:f,adSlotContainerRecycler:I,urlSuffixerService:y,sessionId:A,yoScore:Q,price:z,vastTracker:s,plcmt:u,cpm:o||P||M,adManagerLineItem:i,callingState:n,externalCreativeId:c,bidId:d||(0,mt.qs)(),bidSlotId:a||Oe(),isIma:(0,cn.$v)(i),adxFloorPrice:i.getAdxFloorPriceObjectsByPrice(q)[0],videoInsightsCategories:_}}eS(t,i){const{mime:e,html:s,dimensions:r}=i;if(!(0,W.$K)(e)||!(0,W.$K)(s)||!(0,W.$K)(r))throw new Error(hs.HTMLNotEnoughData);if(n=e,!Object.values(ms).includes(n))throw new Error(hs.HTMLUnknownMimeType);var n;return t.htmlToLog=s,new Ss(this.zb.featureFlags,this.zb.timerService,Object.assign(Object.assign({},t),{html:s,mime:e,dimensions:r}))}Zb(t){return(0,yi.mG)(this,void 0,void 0,(function*(){const{adManagerLineItem:{protoLineItem:{externalHlsFile:i,mediaCreativeId:e,renditionList:s,mediaCreativeClickUrl:r,externalMediaFile:n}}}=t,{shouldPauseAdWhenFinished:h,shouldLoopAdWhenFinished:o,isInApp:a,pageDomain:d,sessionId:c,timerService:l,globalDomUtilsService:u}=this.zb;return new Es(l,Object.assign(Object.assign({},t),{hlsModule:yield br(u.global,i,c),mediaId:e,renditions:s,clickUrl:r,externalMediaFile:n,externalHlsFile:i,shouldPauseAdWhenFinished:h,shouldLoopAdWhenFinished:o,isInApp:a,pageDomain:d}))}))}Yb(t){return new $s(this.zb.timerService,Object.assign(Object.assign({},t),{adxAdUnitPath:(i=t.adManagerLineItem.protoLineItem.adTag,i.slice(24)),domain:this.zb.pageDomain}));var i}Qb(t,i,e,s){return(0,yi.mG)(this,void 0,void 0,(function*(){const{finalUrl:n,vpMuteRemoved:o}=_r(t,i,this.zb.adMacroReplacer,this.zb.imaVastUrlBuilderService,e.lineItem),a=Object.assign(Object.assign({},i),{vpMuteRemoved:o});if(i.isIma||(0,cn.m5)(n)){if(i.adManagerLineItem.protoLineItem.adType!==r.Z9.VIDEO_NON_LINEAR){const t=(0,h.AU)(ee.H).getIdForIma(i.adManagerLineItem),r=null==s?void 0:s.vastAdsChain;return this.iS(a,{url:n,adxMinPrice:e.adxMinPrice,ppid:t,vastAdsChain:r})}(0,ft.FH)({message:"AdManager_BidFactory_found_ima_in_nonLinear",level:"Info",sessionId:i.sessionId})}return this.sS(n,a,e,s)}))}Xb(t,i,e){return(0,yi.mG)(this,void 0,void 0,(function*(){const{finalUrl:s,vpMuteRemoved:r}=_r(i,t,this.zb.adMacroReplacer,this.zb.imaVastUrlBuilderService,e.lineItem),n=Object.assign(Object.assign({},t),{vpMuteRemoved:r,url:s}),o=t.bidId,a=(0,h.TF)(t.sessionId,dn.P),d=new an(o,a),c=new wr(s,d,t.adManagerLineItem.protoLineItem.advertiserLineItemId);try{yield c.loadAd()}catch(t){throw(0,mt.W$)(t)}return new js(this.zb.timerService,n,d,this.ls.accountId)}))}iS(t,i){return(0,yi.mG)(this,void 0,void 0,(function*(){const{advertiserLineItemId:e,publisherLineItemId:s,adType:r,isAdxAccount:n}=t.adManagerLineItem.protoLineItem,h=(0,W.$K)(i.url)?i.url:"",o=(0,W.$K)(i.xml)?i.xml:"",{adSlotContainerRecycler:a,adxFloorPrice:d,adContainer:c,callingState:{adContainerState:l}}=t,{ppid:u,adxMinPrice:p}=i,{pageUrl:v,sessionId:m,featureFlags:g,timerService:f}=this.zb,{accountId:I,bundleLoadTimestamp:y}=this.ls,A={advertiserLineItemId:e,publisherLineItemId:s,adType:r,url:h,xml:o,ppid:u,pageUrl:v,adContainerState:l,adSlotContainerRecycler:a,adxFloorPrice:d,adxMinPrice:p};let b;const _=this.zb.adSlotContainerRecycler.requestAdSlotIma(c,!!p),x=new Lr(_,A,m);try{!1===this.Hb&amp;&amp;n&amp;&amp;Te.f.isAxelCid()&amp;&amp;(this.Hb=!0,(0,li.q)([{name:"time_before_first_adx",value:Date.now()-y}])),b=yield x.getImaAdModule()}catch(t){throw(0,mt.W$)(t)}const S=i.vastAdsChain,{imaSdk:w,imaAdsLoader:k,imaAdsManager:P,requestAdsContext:M}=b;return new Ys(f,Object.assign(Object.assign({},t),{imaSdk:w,imaAdsLoader:k,imaAdsManager:P,requestAdsContext:M,pageUrl:v,imaAdSlotContainer:_,url:h,vastAd:o||h,vastResponse:S?new yr(S):void 0}),I,g)}))}sS(t,i,e,s){return(0,yi.mG)(this,void 0,void 0,(function*(){const r=!(0,W.$K)(e.shouldRequestWithCredentials)||e.shouldRequestWithCredentials;let n="";try{n=yield(0,te.XV)(t,r)}catch(t){if(!1===r)throw new Tr({hasError:!0,errorReason:hs.NetworkRequestUrl,vastErrorCode:301})}if(!(0,W.QM)(n)){try{n=yield(0,te.XV)(t,!1)}catch(t){throw new Tr({hasError:!0,errorReason:hs.NetworkRequestUrl,vastErrorCode:301})}if(!(0,W.QM)(n))throw new Tr({hasError:!0,errorReason:hs.XmlInvalidString,vastErrorCode:303})}return this.Kb(n,i,e,s)}))}Kb(t,i,e,s){return(0,yi.mG)(this,void 0,void 0,(function*(){const n=new hn(2,i.sessionId).parseVastXml(t);if(!0===n.hasError){const{errorReason:t,vastErrorCode:i,errorUrlTrackers:e}=n;throw new Tr({hasError:!0,errorUrlTrackers:e,errorReason:t,vastErrorCode:i})}const h=(0,W.$K)(s)?s.vastAdsChain:[];if(xr(n.result,i,h),n.result.wrapper){const t=(0,W.$K)(s)?s.maxWrapperLimit:10;if(t&lt;=0)throw new Tr({hasError:!0,errorReason:hs.XmlAdaptorWrapperLimit,vastErrorCode:302});return this.Qb(n.result.wrapper.VASTAdTagURI,i,e,{vastAdsChain:h,maxWrapperLimit:t-1})}const{adType:o}=i.adManagerLineItem.protoLineItem;if(!function(t,i){const e=new yr(t),{mediaFiles:s,nonLinearFiles:n}=e;return i===r.Z9.VIDEO_VIDEO&amp;&amp;(0,ot.BZ)(s)||i===r.Z9.VIDEO_NON_LINEAR&amp;&amp;(0,ot.BZ)(n)}(h,o))throw new Tr({hasError:!0,errorReason:hs.InvalidCreativeType,vastErrorCode:201});if(o===r.Z9.VIDEO_NON_LINEAR)return new Ks(this.zb.featureFlags,this.zb.timerService,Object.assign(Object.assign({},i),{vastResponse:new yr(h)}));const{adMacroReplacer:a,shouldLoopAdWhenFinished:d,timerService:c}=this.zb;return new fr(c,Object.assign(Object.assign({},i),{vastResponse:new yr(h),shouldLoopAdWhenFinished:d,adMacroReplacer:a,vastAd:t}),this.ls.accountId)}))}tS(t,i){return(0,yi.mG)(this,void 0,void 0,(function*(){const e=t.isIma;if(function(t){const{protoLineItem:i}=t.adManagerLineItem;return i.adType===r.Z9.VIDEO_VIDEO}(t)||function(t){var i;const{protoLineItem:e}=t.adManagerLineItem;return e.adType===r.Z9.VIDEO_NON_LINEAR&amp;&amp;(null===(i=e.nonlinearLineItemSettings)||void 0===i?void 0:i.requestType)===jt.n.VIDEO}(t)){if(!(0,W.$K)(i.vastTag))throw new Error(hs.InvalidCreativeUrl);return e?this.iS(t,{xml:i.vastTag}):this.Kb(i.vastTag,t,i)}return this.eS(t,i)}))}}class pn{constructor(t){this.rS=t,this.nS=0,this.T=Promise.resolve()}start(){(0===this.nS||2===this.nS)&amp;&amp;(this.nS=1,this.oS())}stop(){this.nS=2}setPromiseNotifier(t){return this.aS=t,this}setIdleNotifier(t){return this.hS=t,this}getState(){return this.nS}dS(){const t=this.rS();void 0!==t?this.T=t.then((t=&gt;{this.aS&amp;&amp;this.aS(t)})).then((()=&gt;{2===this.nS&amp;&amp;(this.nS=0)})):this.nS=0}oS(){0===this.nS?this.hS&amp;&amp;this.hS():1===this.nS&amp;&amp;(this.dS(),this.T.then((()=&gt;{this.oS()})))}}class vn{constructor(t,i=1){this.rS=t,this.cS=i,this.lS=[],this.uS(i)}start(){return this.lS.forEach((t=&gt;{t.start()})),this}stop(){return this.lS.forEach((t=&gt;{t.stop()})),this}setPromiseNotifier(t){return this.lS.forEach((i=&gt;{i.setPromiseNotifier(t)})),this}setAllThreadsIdleNotifier(t){return this.pS=t,this.mS(),this}setNumberOfThreads(t){if(t&lt;=0)return;this.cS=t;const i=t-this.cS;i&gt;0?this.uS(i):i&lt;0&amp;&amp;this.vS(i)}getState(){return this.lS.reduce(((t,i)=&gt;(t[i.getState()]++,t)),{0:0,1:0,2:0})}uS(t){for(let i=0;i<t;i++){const i="0;i&lt;t;i++)this.lS.pop().stop()}mS(){const" pn(this.rs).setpromisenotifier(this.as);this.ls.push(t)}}vs(t){t="Math.min(t,this.lS.length);for(let" t="()=">{this.getState()[0]===this.lS.length&amp;&amp;this.pS()};this.lS.forEach((i=&gt;{i.setIdleNotifier(t)}))}}class mn{constructor(){this.gS=new Set}static getInstance(){return this.ir||(this.ir=new mn),this.ir}add(t,i,e){t.filter((t=&gt;!this.gS.has(t))).forEach((t=&gt;{this.gS.add(t),function(t,i){const e=t.lineItems.find((t=&gt;{const{advertiserLineItemId:e,publisherLineItemId:s}=t.protoLineItem;return[e,s].includes(i)}));(0,W.$K)(e)&amp;&amp;t.remove(e)}(i,t),function(t,i){t.getBidsByLineItemId(i).forEach((t=&gt;t.invalidate()))}(e,t)}))}hasLineItemById(t,i){return this.gS.has(t)||this.gS.has(i)}clear(){this.gS.clear()}}function gn(t,i){return t.some((t=&gt;{const{audienceTargetingFilterList:e}=t;return!!(0,ot.BZ)(e)&amp;&amp;function(t,i=[]){return t.every((t=&gt;{const e=t.audienceIdList;if(!(0,ot.BZ)(e))return!1;const s=(0,ot.tN)(e,i).length,n=e.length;switch(t.rule){case r.$d.INCLUDE_ANY:return s&gt;0;case r.$d.INCLUDE_ALL:return s===n;case r.$d.EXCLUDE_ANY:return 0===s;case r.$d.EXCLUDE_ALL:return s!==n;default:return!1}}))}(e,i)}))}function fn(t,i,e,s){return!(0,ot.BZ)(t)||!(!i&amp;&amp;e)&amp;&amp;gn(t,s)}function In(t,i){return Object.keys(i).some((e=&gt;i[e]===t[e]))}function yn(t,i){return!t.protoLineItem.adBreakSettings||t.protoLineItem.adBreakSettings.adBreakTargetingList.some((t=&gt;{if(t.adRollType===i.adBreakState.adBreakType)return function(t,i){switch(t){case r.JX.ALL:return!0;case r.JX.AD_POD:return i;case r.JX.SINGLE_AD:return!i;default:return!0}}(t.adBatchType,i.adBreakState.isAdPodBreak)}))}function An(t,i){if((0,ot.BZ)(i.itemList)&amp;&amp;Array.isArray(t)){const e=(0,ot.tN)(t,i.itemList).length;return i.choiceCriteria===r.bW.ONLY?e&gt;0:0===e}const e=(0,ot.d3)(t,i.itemList);return i.choiceCriteria===r.bW.ONLY?e:!e}function bn(t,i){return function(t,i,e){const{advertiserAudienceTargetingCaseList:s,publisherAudienceTargetingCaseList:r,canUseConnatixDataGraph:n}=t.protoLineItem,h=fn(s,n,i,e),o=fn(r,n,i,e);return h&amp;&amp;o}(t,i.isIdentityEnhanced,i.userAudienceIdList)}function _n(t,i){return!t||0===i||t&lt;=i}function xn(t,i,e){switch(t){case r.$d.INCLUDE_ANY:if(0===i)return!1;break;case r.$d.INCLUDE_ALL:if(i!==e.length)return!1;break;case r.$d.EXCLUDE_ANY:if(i&gt;0)return!1;break;case r.$d.EXCLUDE_ALL:if(i===e.length)return!1}return!0}function Sn(t,i,e){return t.some((t=&gt;function(t,i,e){for(let s=0;s<t.filterlist.length;s++){const n="t.filterList[s],h=n.hashedItemIdList,o=i.filter((t=">h.includes(t))).length,a=e.filter((t=&gt;h.includes(t))).length,d=xn(n.type,o,h),c=xn(n.type,a,h);switch(n.level){case r.kp.MEDIA:if(!d)return!1;break;case r.kp.PAGE:if(!c)return!1;break;case r.kp.BOTH:if(!d||!c)return!1}}return!0}(t,i,e)))}function wn(t,i,e){return!!function(t,i){const e=i.adContainerState.get(t.protoLineItem.adType).viewability;return!t.protoLineItem.isViewabilityRequired||e}(t,i)&amp;&amp;(!!function(t,i){return!t.protoLineItem.isSoundRequired||i.sound}(t,i)&amp;&amp;(!!yn(t,i)&amp;&amp;(!!function(t,i){return!(t.protoLineItem.mediaIdTargeting&amp;&amp;!An(i.media.mediaId,t.protoLineItem.mediaIdTargeting)||t.protoLineItem.mediaKeywordsTargeting&amp;&amp;!An(i.media.mediaKeywords,t.protoLineItem.mediaKeywordsTargeting)||t.protoLineItem.mediaLanguageTargeting&amp;&amp;!An(i.media.mediaLanguage,t.protoLineItem.mediaLanguageTargeting))}(t,i)&amp;&amp;(!!function(t,i){var e;const s=null===(e=t.protoLineItem.adBreakSettings)||void 0===e?void 0:e.adPodTargeting;if(!s)return!0;if(!i.adBreakState.isAdPodBreak)return!0;const n=i.adBreakState.adPodSlotIndex;let h=!0;switch(s.adSlotTargetingType){case r.vE.INTERVAL:(n<s.adslotpositionlist[0]||n>s.adSlotPositionList[1])&amp;&amp;(h=!1);break;case r.vE.SPECIFIC_SLOTS:s.adSlotPositionList.includes(n)||(h=!1)}return s.targetingType===r.Yd.EXCEPT&amp;&amp;(h=!h),h}(t,i)&amp;&amp;(!!function(t,i){var e,s;const{advertiserContextualTargetingList:r,publisherContextualTargetingList:n}=t.protoLineItem,h=(null===(e=i.media.mediaInsights)||void 0===e?void 0:e.insights)||[],o=(null===(s=i.page.insights)||void 0===s?void 0:s.insights)||[];return!((0,ot.BZ)(r)&amp;&amp;!Sn(r,h,o)||(0,ot.BZ)(n)&amp;&amp;!Sn(n,h,o))}(t,i)&amp;&amp;(!!function(t,i){const{playerSizeTargetings:e,adType:s}=t.protoLineItem,{width:n}=i.adContainerState.get(s);return!((0,W.$K)(e)&amp;&amp;(0,W.as)(e)&amp;&amp;(0,W.hj)(n))||(e.sizeChoiceCriteria===r.gA.GREATHER_THAN?!(0,W.hj)(e.minWidth)||n&gt;=e.minWidth:e.sizeChoiceCriteria===r.gA.SMALLER_THAN?!(0,W.hj)(e.maxWidth)||n&lt;=e.maxWidth:e.sizeChoiceCriteria!==r.gA.BETWEEN||!(0,W.hj)(e.maxWidth)||!(0,W.hj)(e.minWidth)||n&gt;=e.minWidth&amp;&amp;n&lt;=e.maxWidth)}(t,i)&amp;&amp;(!!function(t,i){const{playerOrientationTargeting:e}=t.protoLineItem;switch(e){case r.Cj.ORIENTATION_TARGETING_LANDSCAPE:if(1===i.playerOrientation)return!1;break;case r.Cj.ORIENTATION_TARGETING_PORTRAIT:if(2===i.playerOrientation)return!1}return!0}(t,i)&amp;&amp;(!!function(t,i){let e=!0;return t.protoLineItem.queryTargetingList.filter((t=&gt;t.rule===r.Ob.ONLY)).forEach((t=&gt;{In(t.queryStringTargetingMap,i.queryJsTargeting)||(e=!1)})),t.protoLineItem.queryTargetingList.filter((t=&gt;t.rule===r.Ob.EXCEPT)).forEach((t=&gt;{In(t.queryStringTargetingMap,i.queryJsTargeting)&amp;&amp;(e=!1)})),e}(t,i)&amp;&amp;(!!function(t){return!(t.protoLineItem.isExternal&amp;&amp;!(0,W.QM)(t.protoLineItem.adTag)&amp;&amp;!(0,W.QM)(t.protoLineItem.externalVastXml)&amp;&amp;!(0,W.QM)(t.protoLineItem.prebidJsBidParamsJsonString)&amp;&amp;!(0,W.QM)(t.protoLineItem.externalMediaFile)&amp;&amp;!(0,W.QM)(t.protoLineItem.externalHlsFile))}(t)&amp;&amp;!!bn(t,e))))))))))}function kn(t,i,e){const s=t.getAdDuration(),{sessionMaxAdDuration:r,remainingAdDuration:n,maxAdDuration:h}=i.adBreakState,{adManagerLineItem:o,dimensions:a}=t.settings,{adType:d,nonlinearLineItemSettings:c}=o.protoLineItem;return!!wn(o,i,e)&amp;&amp;(!!_n(s,r)&amp;&amp;(!!_n(s,n)&amp;&amp;(!!_n(s,h)&amp;&amp;(!!function(t,i,e,s){if(!Xt(t,null==i?void 0:i.requestType))return!0;const r=Math.ceil((0,nt.Tc)(s.height,bt));return!(!e||(null==e?void 0:e.width)&gt;s.width||(null==e?void 0:e.height)&gt;r)}(d,c,a,i)&amp;&amp;!!function(t,i){return!(t.protoLineItem.shouldRemoveOutOfFocus&amp;&amp;!i.isPageInFocus)}(o,i)))))}class Pn{constructor(t,i){this.ls=t,this._i=i}appendParams(t,i){if(!this.fS()||this.ls.isInApp)return t;const e=new URL(t);return e.searchParams.set("tfcd","0"),e.searchParams.set("gdfp_req","1"),e.searchParams.set("unviewed_position_start","1"),e.searchParams.set("env","vp"),e.searchParams.set("hl","en"),e.searchParams.set("sdk_apis","1,2"),e.searchParams.set("output","vast"),e.searchParams.set("correlator",String((0,mt.Ae)(10))),e.searchParams.set("sid",(0,mt.qs)()),e.searchParams.set("scor",String((0,mt.Ae)(10))),e.searchParams.set("url",this.IS()),e.searchParams.set("description_url",this.IS()),e.searchParams.set("sz",function(t){return`${t.width}x${t.height}`}(i)),e.searchParams.set("gdpr",this.AS()),e.searchParams.set("npa",this.yS()),this._i.isPersonalisedAdsAllowed()&amp;&amp;e.searchParams.set("gdpr_consent",this._S()),e.href}fS(){return(0,W.QM)(this.ls.pageUrl)&amp;&amp;"true"===(0,gt.Ph)("cnxImaTest",this.ls.pageUrl)}IS(){return(0,W.QM)(this.ls.pageUrl)?encodeURIComponent(this.ls.pageUrl):""}AS(){return this._i.isConsentRequired()?"1":"0"}_S(){return(0,W.QM)(this._i.getConsentPayload())?this._i.getConsentPayload():""}yS(){return this._i.isPersonalisedAdsAllowed()?"0":"1"}}class Mn{constructor(t,i){this.settings=t,this.cs=i,this.bS=new Map,this.Li=[],this.SS=!1,this.PS=new s.x,this.MS=new s.x,this.kS=new s.x,this.xS=new s.x,this.LS=!1,this.CS=!1,this.TS=()=&gt;{const t=this.BS();if(!t)return void this.settings.auctionManager.onNothingToCall();const{lineItemList:i,state:e}=t;return!1===this.CS&amp;&amp;Te.f.isAxelCid()&amp;&amp;(this.CS=!0,(0,li.q)([{name:"time_before_first_ad",value:Date.now()-this.settings.generalRepository.bundleLoadTimestamp}])),this.PS.next(i),this.ES(i,e).then((()=&gt;{this.MS.next(i),this.DS()})).catch((()=&gt;{this.MS.next(i),this.DS()}))},this.je=(0,h.AU)(ee.H);const e=(0,h.AU)(Ki.w);this.Li.push(this.settings.lineItemServices.lineItemServicesTimer.onTimer().subscribe((()=&gt;{this.RS()})),this.settings.adSelector.getBidEvents(1).subscribe((()=&gt;{this.RS()})),this.settings.adSelector.getBidEvents(2).subscribe((()=&gt;{this.RS()})),this.settings.adSelector.getBidEvents(6).subscribe((()=&gt;{this.RS()})),this.settings.adxLastLookService.onForceCallAdxLastLook.subscribe((({adxLineItem:t,state:i,isForcedAdxLastLook:e})=&gt;{this.OS(t,i,void 0,e).finally((()=&gt;{this.MS.next([t])}))}))),this.FS=new vn(this.TS,5),this.VS=new Pn(this.settings.generalRepository,e.userManagerService);const r=(0,h.AU)(tt.f),n=(0,h.TF)(this.settings.app.config.sessionId,"FeatureFlags"),{adEnforcer:o,adSelector:a,adMacroReplacer:d,adContainerMap:c,app:l,os:u,adSlotContainerRecycler:p,playerData:v,generalRepository:m,pauseAdWhenFinished:g,loopAdWhenFinished:f,skipAdSettings:I,appSettings:y,schainSettings:A,biddersWithConnatixSchain:b,amazonSlotId:_,lineItemServices:{lineItemServicesTimer:x},adRequestGatekeeper:S,callingValidationAggregator:w,assertiveYieldService:k,assertiveYieldFloorPriceService:P}=this.settings,{services:{GlobalDomUtilsService:M,ViewabilityService:C,UrlSuffixerService:L,InteractionService:T,StandaloneService:B},config:{sessionId:E,pageUrl:D,pageDomain:R,isInApp:O,canUseExternalAdService:F}}=l;this.NS=new un({globalDomUtilsService:M,viewabilityService:C,timerService:r,adEnforcer:o,os:u,adSlotContainerRecycler:p,urlSuffixerService:L,interactionService:T,standaloneService:B,sessionId:E,pageUrl:D,pageDomain:R,adContainerMap:c,shouldPauseAdWhenFinished:g,shouldLoopAdWhenFinished:f,isInApp:O,canUseExternalAdService:F,adEvents:this.cs,adMacroReplacer:d,imaVastUrlBuilderService:this.VS,featureFlags:n}),a.hasAggregatorType(1)&amp;&amp;this.bS.set(1,{auctionPending:!1,caller:new he(v.isOutstream,I,l,m,S,w,k,P)}),a.hasAggregatorType(2)&amp;&amp;this.bS.set(2,{auctionPending:!1,caller:new Ne(v,A,l,y,I,b)}),a.hasAggregatorType(3)&amp;&amp;this.bS.set(3,{auctionPending:!1,caller:new rs(l,_,m)}),a.hasAggregatorType(4)&amp;&amp;this.bS.set(4,{auctionPending:!1,caller:new ns(v.plcmt)}),this.FS.setAllThreadsIdleNotifier((()=&gt;{x.start()}))}get onLineItemsRequestStart(){return this.PS.asObservable()}get onLineItemsRequestEnd(){return this.MS.asObservable()}get onBid(){return this.kS.asObservable()}get onFirstAggregatedBatchFinished(){return this.xS.asObservable()}call(t){this.$S=t,this.FS.setNumberOfThreads(t.maxParallelCalls),this.SS=!0,!this.LS&amp;&amp;(0,ot.BZ)(this.settings.standaloneService.lineItemWithBidsList)?(this.LS=!0,this.US().then((()=&gt;{this.RS()}))):this.RS()}stop(){this.SS=!1,this.FS.stop()}setMacros(t){const i=this.bS.get(2);i&amp;&amp;i.caller.setMacros(t)}destroy(){this.stop(),this.settings.callingValidationAggregator.destroy(),(0,o.i)(this.Li),this.bS.forEach((t=&gt;{var i,e;null===(e=(i=t.caller).destroy)||void 0===e||e.call(i)}))}US(){return(0,yi.mG)(this,void 0,void 0,(function*(){return this.settings.standaloneService.lineItemWithBidsList.forEach((t=&gt;{const{lineItem:i,bidList:e}=t,s=this.settings.adSelector.geLineItemById(i.advertiserLineItemId);e.forEach((t=&gt;(0,yi.mG)(this,void 0,void 0,(function*(){try{yield this.WS(t,s)}catch(t){(0,ft.FH)({message:"AdManager_AdCallerController_injectStandaloneBidsIfPossible",level:"Info"},{throttle:3,shouldSendMaxLog:!1})}}))))})),Promise.resolve()}))}WS(t,i){return(0,yi.mG)(this,void 0,void 0,(function*(){const{currentState:e,predictedState:s}=this.$S.stateSettings,r=Hi(t,i,e||s),{lineItem:n,state:h}=r;return this.settings.callingValidationAggregator.registerRequestForLineItem(n,this.jS()),this.OS(n,h,r)}))}DS(){let t=!0;this.bS.forEach((i=&gt;{i.auctionPending&amp;&amp;(t=!1)})),t&amp;&amp;this.xS.next()}RS(){this.SS&amp;&amp;this.FS.start()}BS(){const t=this.$S.stateSettings.currentState||this.$S.stateSettings.predictedState;if(!t)return void(0,ft.FH)({message:"AdCallerController_no_state",level:"Info",sessionId:this.settings.sessionId},{throttle:10,shouldSendMaxLog:!1});const i=this.settings.adSelector.getAllCallableLineItems(t),e=this.settings.adSelector.getBestCallableLineItem(i,t);return e||void 0}ES(t,i){return t[0].hasAggregator?this.qS(t,i):this.OS(t[0],i)}OS(t,i,e,s){return(0,yi.mG)(this,void 0,void 0,(function*(){const r=Date.now(),n=this.zS(t,i,this.settings.playerData.plcmt,e,s);(0,W.$K)(e)||this.HS(t,i),Ft(t,1,n.requestMetadata.data.requestedFloorPrice);let h=null;try{h=yield this.NS.fetchBid(n),this.GS(h,r)}catch(e){const{message:s}=(0,mt.W$)(e);let h,o;e instanceof Tr&amp;&amp;(h=e.vastErrorCode,o=e.vastErrorTrackers);const a=os[s]||_i.iu.REQUEST_EXCEPTION;this.JS(i,t,a,n.requestMetadata,n.vastTracker,Date.now()-r,hs[s],h,o)}}))}zS(t,i,e,s,r){if((0,W.$K)(s))return s;const n=t.protoLineItem.isAdxLookup?this.settings.adxLastLookService.getAdxLastLookPrice():void 0,h=this.YS(t,r),o=new xi(h),a=new Vi,d={lineItem:t,vastTracker:a,requestMetadata:o,state:i,adxMinPrice:n,plcmt:e};return ji(t.protoLineItem.trackerList,a),d}YS(t,i){const e=!!this.je.getIdForIma(t),{adxFloorPrice:s,protoLineItem:{isAdxAccount:r,isAdxLookup:n,floorPrice:h},historicalMetrics:{requestNumber:o}}=t,a={requestNumber:o,isForcedAdxLastLook:!!i,wasIiqLookupUsed:e};if(!n){if(s)return Object.assign(Object.assign({},a),{floorPriceInformation:new Ai.$({adxPredictedFloorPrice:(0,Zt.R)(s.adxData.predictedPriceObfuscated)}),requestedFloorPrice:s.price});if(r)return Object.assign(Object.assign({},a),{requestedFloorPrice:h})}return a}HS(t,i){this.settings.callingValidationAggregator.registerRequestForLineItem(t,this.jS(i)),t.historicalMetrics.requestNumber++}GS(t,i){try{this.XS(t,Date.now()-i)}catch(t){const{message:i,stack:e}=(0,mt.W$)(t);(0,ft.FH)({message:"AdManager_AdCallerController_handleBidFactoryRequestSuccess",exception:i,callStack:e,level:"Critical",sessionId:this.settings.sessionId},{throttle:5})}}qS(t,i){const e=Wt(t[0].protoLineItem),s=this.bS.get(e);e&amp;&amp;this.settings.callingValidationAggregator.registerRequestForAggregator(e,this.jS()),t.forEach((t=&gt;t.aggregators.add(s.caller))),s.auctionPending=!0;const{maxAdDuration:r,remainingAdDuration:n}=i.adBreakState,h={lineItemRequestDataList:t.map((t=&gt;({adManagerLineItem:t,maxAvailableRequests:this.settings.lineItemServices.requestCapsService.getAvailableRequestsForLineItem(t,this.jS())}))),callingState:i,maxAdDuration:(0,vt.S)(r,n),maxBidPrice:this.settings.adSelector.getBestAllowedBidPrice(i)};try{const e=t[0].protoLineItem.adType;this.KS(i.width,i.height,e)}catch(t){}return this.QS(s,h,t,i)}QS(t,i,e,s){return t.caller.request(i).then((i=&gt;{i.bids.length||i.noBids.length||e.forEach((t=&gt;{this.HS(t)})),e.forEach((i=&gt;{i.aggregators.delete(t.caller),i.historicalMetrics.requestNumber++})),i.noBids.forEach((t=&gt;{this.settings.callingValidationAggregator.registerRequestForLineItem(t.lineItem,this.jS()),this.JS(s,t.lineItem,t.reason,t.requestMetadata)}));const r=i.bids.map((t=&gt;(this.settings.callingValidationAggregator.registerRequestForLineItem(t.lineItem,this.jS()),this.OS(t.lineItem,t.state,t))));return Promise.all(r)})).finally((()=&gt;{t.auctionPending=!1}))}XS(t,i){var e;if(t.shouldBeDiscarded)return;const{bidId:s,callingState:r,cpm:n,vastTracker:{adImpression:h},adManagerLineItem:o,requestMetadata:{data:{requestNumber:a,isUserSynced:d,prebidJsBidderName:c,dspId:l,encryptedPrice:u,rtbAdomain:p,rtbSeatId:v,cnxBidId:m,identityPartnerUsed:g,isForcedAdxLastLook:f,requestedFloorPrice:I,floorPriceInformation:y,requestTrackingHandledByServer:A}}}=t.settings,b=this.je.getTrackingData(o,g),{protoLineItem:{advertiserLineItemId:_,publisherLineItemId:x}}=o,{playerDimensions:{height:S,width:w},videoPlacement:k,shouldLogAuctionPriceType:P,shouldUseNetCPM:M}=this.settings.generalRepository,C={1:`${se.n.getConnectionType(this.settings.app.config.deviceType)}`,2:Te.f.getCidForElkTracking(),3:`${!!f}`};P&amp;&amp;(C[4]=""+(M?1:0));const L=new bi.u({advertiserLineItemId:_,publisherLineItemId:x,requestedFloorPrice:I,requestNumber:a,isUserSynced:d,prebidJsBidderName:c,customClientPrice:n,timeSpentMilliseconds:i,dspId:l,encryptedPrice:u,rtbAdomain:p,creativeId:t.creativeId||(null===(e=t.vastResponse)||void 0===e?void 0:e.creativeId),rtbSeatId:v,cnxBidId:m,floorPriceInformation:y,dynamicElkFieldsMap:C,eventTimestamp:BigInt(Date.now()),identityProviderData:b,playerHeight:S,playerWidth:w,videoPlacement:k});this.cs.adBid.next({shouldTrackBid:!A,bidTracking:L,impressionTrackerList:h}),this.settings.adRequestGatekeeper.addBid(_,I),function(t,i){const{protoLineItem:e}=t.settings.adManagerLineItem,{advertiserLineItemId:s,publisherLineItemId:r}=e,{sessionMaxAdDuration:n}=i.adBreakState;return _n(t.getAdDuration(),n)&amp;&amp;!mn.getInstance().hasLineItemById(s,r)}(t,r)?(Ft(o,2,I),this.kS.next(t)):this.settings.auctionInfoLogging.bidIsNotWinnableEverInSession(t)}JS(t,i,e,s,r,n,o,a,d=[]){const c=[...(null==r?void 0:r.adError)||[],...d];(0,ot.BZ)(c)&amp;&amp;Ni(c,this.settings.adMacroReplacer,i.protoLineItem,t,this.settings.playerData.plcmt,a);const l=this.je.getTrackingData(i,s.data.identityPartnerUsed),{playerDimensions:{height:u,width:p},videoPlacement:v,shouldUseNetCPM:m,shouldLogAuctionPriceType:g}=this.settings.generalRepository;Ft(i,3,s.data.requestedFloorPrice);const{protoLineItem:{advertiserLineItemId:f,publisherLineItemId:I}}=i;if(!s.data.requestTrackingHandledByServer){const t=(0,h.AU)(Lt.n),{data:{partnerCustomHeaders:i,partnerReason:r,requestedFloorPrice:o,floorPriceInformation:a,requestNumber:d,isUserSynced:c,prebidJsBidderName:y,isForcedAdxLastLook:A}}=s,b={1:`${se.n.getConnectionType(this.settings.app.config.deviceType)}`,2:Te.f.getCidForElkTracking(),3:`${!!A}`,5:`${t.getLocalStorageType()}`,6:`${t.getUserVisitCount()}`};g&amp;&amp;(b[4]=""+(m?1:0)),this.cs.adPrebid.next(new _i.X4({advertiserLineItemId:f,publisherLineItemId:I,partnerCustomHeaders:i,partnerReason:r,requestedFloorPrice:o,requestNumber:d,isUserSynced:c,prebidJsBidderName:y,reason:e,timeSpentMilliseconds:n,identityProviderData:l,floorPriceInformation:a,dynamicElkFieldsMap:b,eventTimestamp:BigInt(Date.now()),playerHeight:u,playerWidth:p,videoPlacement:v}))}this.settings.adRequestGatekeeper.addPrebid(f)}jS(t){return(t||this.$S.stateSettings.currentState||this.$S.stateSettings.predictedState).adOpportunity.id}KS(t,i,e){var s;if(!(0,nt.ON)({width:t,height:i}))return;if(!(0,W.hj)(e))return;const r=this.settings.adContainerMap.get(e);if(!r)return;const n=null===(s=this.settings.app.services.GlobalDomUtilsService)||void 0===s?void 0:s.checkElementDomTreeStatus(r,!0),h=(0,mt.lU)((0,mt.pE)(window),window),o=(null==n?void 0:n.detached)?"Info":"Warn";(0,ft.FH)({message:"AdManager_BidderCaller_dimensions",exception:`width:${t}_height:${i}_destroyed:${null==n?void 0:n.detached}_hidden:${null==n?void 0:n.hidden}_adtype:${e}`,level:o,sessionId:this.settings.sessionId,pageUrl:h},{throttle:1,shouldSendMaxLog:!1,extraLogsPercentage:100})}}var Cn=e(1844);const Ln="cnx-ad-slots",Tn="cnx-ad-container",Bn="cnx-non-linear-ad-container";class En{constructor(t,i,e,n,h){this.ZS=t,this.tw=i,this.ew=e,this.iw=n,this.vt=h,this.sw=new s.x,this.rw=new Map,this.nw=[],this.forceTriggerUpdateState=()=&gt;{this.nw.forEach((t=&gt;this.ow(t)))},this.ow=(t,i)=&gt;{this.rw.set(t,this.aw(this.tw.get(t),i))},this.hw=t=&gt;{this.dw([r.Z9.VIDEO_VIDEO],t)},this.cw=t=&gt;{this.dw([r.Z9.VIDEO_OVERLAY],t)},this.uw=t=&gt;{this.dw([r.Z9.VIDEO_NON_LINEAR],t)},this.ro=()=&gt;{this.dw(this.nw)},this.dw=(t,i)=&gt;{t.forEach((t=&gt;this.ow(t,i))),this.sw.next()},this.pw=()=&gt;{this.tw.forEach(((t,i)=&gt;{i!==r.Z9.VIDEO_NON_LINEAR||t.classList.contains(Bn)?(i===r.Z9.VIDEO_VIDEO||i===r.Z9.VIDEO_OVERLAY&amp;&amp;!t.classList.contains(Tn))&amp;&amp;t.classList.add(Tn):t.classList.add(Bn)}));const t=this.getMainContainer().parentElement;if(t.querySelector(`#${Ln}`))return;const i=this.vt.createElementByString(`<style>${Cn.Z}</style>`);i.setAttribute("id",Ln),t.appendChild(i)},this.mw={[r.Z9.VIDEO_VIDEO]:this.hw,[r.Z9.VIDEO_OVERLAY]:this.cw,[r.Z9.VIDEO_NON_LINEAR]:this.uw},this.nw=[...this.tw.keys()],this.nw.forEach((t=&gt;this.ow(t))),this.pw(),this.gw()}get onContainerStateUpdate(){return this.sw.asObservable()}getContainerMap(){return this.tw}getContainerStateMap(){return this.rw}getMainContainer(){return this.tw.get(this.ZS)}getMainContainerState(){return this.getContainerStateMap().get(this.ZS)}destroy(){this.tw.forEach(((t,i)=&gt;{this.ew.off(t,this.ro),this.iw.off(t,this.mw[i])}))}gw(){this.tw.forEach(((t,i)=&gt;{this.ew.on(t,this.ro),this.iw.on(t,this.mw[i],{threshold:dt.fJ})}))}aw(t,i){let e=i;return void 0===e&amp;&amp;(e=this.iw.check({element:t,threshold:dt.fJ})),{width:t.clientWidth,height:t.clientHeight,viewability:e}}}class Dn{constructor(t,i){this.fw=t=&gt;t.cnxEnfStorage?t.cnxEnfStorage:null,this.W=t;try{this.fw(this.W)||this.Iw(this.W)}catch(t){const{message:e,stack:s}=(0,mt.W$)(t);(0,ft.FH)({sessionId:i,message:"AdManager_EnforcerMemory_bind_enforcement",exception:e,callStack:s,level:"Critical"})}}enforce(t,i){if((0,W.cL)(t))try{t.contentWindow.self===top||t.contentWindow.Function.prototype.cnxInnerTag||t.contentWindow.Object.defineProperty(t.contentWindow.Function.prototype,"cnxInnerTag",{enumerable:!1,writable:!0,value:i}),t.contentWindow.self===top||t.contentWindow.Object.prototype.cnxInnerTag||t.contentWindow.Object.defineProperty(t.contentWindow.Object.prototype,"cnxInnerTag",{enumerable:!1,writable:!0,value:i})}catch(t){}}stopEnforce(){}clearEnforce(t){try{const i=this.fw(this.W);i.eventListeners[t]&amp;&amp;(i.eventListeners[t].forEach((t=&gt;{t.element.removeEventListener(t.type,t.handler,t.options)})),i.eventListeners[t]=[]),i.setInterval[t]&amp;&amp;(i.setInterval[t].forEach((t=&gt;this.W.clearInterval(t))),i.setInterval[t]=[]),i.setTimeout[t]&amp;&amp;(i.setTimeout[t].forEach((t=&gt;this.W.clearTimeout(t))),i.setTimeout[t]=[])}catch(t){}}Iw(t){(0,U.ML)(t.document.head,t,'!function(){function n(n){window["cnx"+n]||(window["cnx"+n]=window[n],window[n]=function(e){var t="";try{e&amp;&amp;(t=function n(e,t){try{if(!e)return"";if(e.cnxInnerTag)return e.cnxInnerTag;if(t&lt;2){var r=t+1;return n(e.caller,r)}}catch(n){return""}return""}(e))}catch(n){}var r=window["cnx"+n].apply(null,arguments);if(t){var i=window.cnxEnfStorage;i[n][t]=i[n][t]||[],i[n][t].push(r)}return r})}window.cnxEnfStorage={setTimeout:{},setInterval:{},eventListeners:{},errors:[]};var e=window.location.hostname.split("."),t=window.btoa(e[e.length-2]+"."+e[e.length-1]);-1===["dG16LmNvbQ==","YmlsbGJvYXJkLmNvbQ==","aG9sbHl3b29kcmVwb3J0ZXIuY29t","dmliZS5jb20=","aG9yb3Njb3BlLmNvbQ==","YXN0cm9sb2d5LmNvbQ==","YWhvcmFtaXNtby5jb20="].indexOf(t)&amp;&amp;(!function(){const n=window.EventTarget?window.EventTarget.prototype:window.document;n.cnxAddEventListener||(n.cnxAddEventListener=n.addEventListener,n.addEventListener=function(n,e,t){var r=this||window;if(e&amp;&amp;e.cnxInnerTag){var i=window.cnxEnfStorage;i.eventListeners[e.cnxInnerTag]=i.eventListeners[e.cnxInnerTag]||[],i.eventListeners[e.cnxInnerTag].push({element:r,type:n,handler:e,options:t})}try{r.cnxAddEventListener(n,e,t)}catch(n){n.message="adlstn_"+n.message,i.errors.push(n)}})}(),n("setTimeout"),n("setInterval"))}();')}}class Rn{enforce(t){(0,W.cL)(t)&amp;&amp;this.Aw(t.contentWindow)}stopEnforce(){}clearEnforce(){}Aw(t){const i=function(){};t.Element.prototype.scrollIntoView=i,t.Element.prototype.scrollIntoViewIfNeeded=i,t.scroll=i,t.scrollTo=i,t.scrollBy=i}}const On="cnxpl-vl",Fn="cnxpl-rf";class Vn{constructor(){this.yw=!0,this._w=new s.x,this.bw=[],this.Sw=t=&gt;{if(this.yw)return;const i=t.target;if(i.volume&gt;0&amp;&amp;(i.volume=0,!i.paused)){const t=i.getAttribute(Fn);this._w.next(t)}t.preventDefault?t.preventDefault():t.returnValue=!1}}get onVolumeDetected(){return this._w.asObservable()}enforce(t,i){let e=t;(0,W.cL)(t)&amp;&amp;(e=t.contentDocument||t.contentWindow.document),this.yw=!1;(0,ot.Sz)(e.getElementsByTagName("video")).forEach((t=&gt;{this.ww(t,i)}))}stopEnforce(){this.yw=!0}clearEnforce(t){try{const i=[];this.bw=this.bw.filter((e=&gt;e.getAttribute(Fn)!==t||(i.push(e),!1))),i.forEach((t=&gt;{t.removeAttribute(On),t.removeAttribute(Fn),t.removeEventListener("volumechange",this.Sw)}))}catch(t){}}ww(t,i){t&amp;&amp;!t.getAttribute(On)&amp;&amp;(t.volume=0,t.setAttribute(On,"true"),t.setAttribute(Fn,i),t.addEventListener("volumechange",this.Sw),this.bw.push(t))}}const $n=["octob.azureedge.net/oc.js","lzi.azureedge.net/lz.js","tinlc.azureedge.net/pt.js","bm-rb.azureedge.net/rb.js","foluo.azureedge.net/fo.js","vpv-ger.azureedge.net/VpaidVideoAd1.js"];class Nn{constructor(){this.Pw=["viralgains","serving-sys.com","commercialadsdistributor",...$n],this.Mw=["beachfrontmedia","commercialadsdistributor",...$n],this.kw=["commercialadsdistributor",...$n],this.xw=["pixel.clearstream.tv","pixel.clrstm.com",...$n],this.y_=new s.x,this.Lw=new s.x}get onMalwareDetected(){return this.y_.asObservable()}get onBadUriDetected(){return this.Lw.asObservable()}enforce(t,i){if((0,W.cL)(t)){this.Cw=i;try{this.Tw(t),this.Bw(t),this.Ew(t),this.Dw(t)}catch(t){}}}stopEnforce(){}clearEnforce(){}Rw(t,i,e,s){t.every((t=&gt;!e.includes(t)))&amp;&amp;!i.getAttribute("cnx")&amp;&amp;(i.setAttribute("cnx","true"),this.Lw.next({referenceId:this.Cw,enforcementMessage:`${s}-${i}`}))}Tw(t){const i=t.getAttribute("src");i&amp;&amp;(this.Pw.forEach((t=&gt;{i.includes(t)&amp;&amp;this.y_.next({referenceId:this.Cw,enforcementMessage:`malware-${t}`})})),this.Rw(["//","about:blank","about:self","javascript:"],t,i,"iframe"))}Bw(t){(0,ot.Sz)(t.contentDocument.getElementsByTagName("script")).forEach((t=&gt;{const i=t.getAttribute("src");i&amp;&amp;(this.Mw.forEach((t=&gt;{i.includes(t)&amp;&amp;this.y_.next({referenceId:this.Cw,enforcementMessage:`malware-${t}`})})),this.Rw(["//"],t,i,"script"))}))}Ew(t){(0,ot.Sz)(t.contentDocument.getElementsByTagName("a")).forEach((t=&gt;{const i=t.getAttribute("href");i&amp;&amp;this.kw.forEach((t=&gt;{i.includes(t)&amp;&amp;this.y_.next({referenceId:this.Cw,enforcementMessage:`malware-${t}`})}))}))}Dw(t){(0,ot.Sz)(t.contentDocument.getElementsByTagName("img")).forEach((t=&gt;{const i=t.getAttribute("src");i&amp;&amp;this.xw.forEach((t=&gt;{i.includes(t)&amp;&amp;this.y_.next({referenceId:this.Cw,enforcementMessage:`malware-${t}`})}))}))}}class Un{constructor(t,i,e,r){if(this.Ow=e,this.Vw=null,this.Nw=new Map,this.Uw=0,this.Ww=300,this.Li=[],this.jw=new Map,this.Zg=new s.x,this.Nw.set(4,new Dn(i,r)),e||this.Nw.set(2,new Rn),!t){const t=new Vn;this.Nw.set(1,t),this.Li.push(t.onVolumeDetected.subscribe((t=&gt;{this.qw("volume_detected",t,"")})))}const n=new Nn;this.Li.push(n.onBadUriDetected.subscribe((t=&gt;{this.qw("baduri_detected",t.referenceId,t.enforcementMessage)})),n.onMalwareDetected.subscribe((t=&gt;{this.qw("malware_detected",t.referenceId,t.enforcementMessage)}))),this.Nw.set(8,n)}get onEnforcerEvent(){return this.Zg.asObservable()}registerContainer(t,i){this.jw.get(t)||this.jw.set(t,i)}deregisterContainer(t){this.jw.get(t)&amp;&amp;(this.Nw.forEach((i=&gt;{i.clearEnforce(this.jw.get(t))})),this.jw.delete(t),this.jw.size||this.stop(15))}start(t){this.Ow&amp;&amp;(t^=2),this.Uw|=t,null===this.Vw&amp;&amp;(this.Vw=setInterval((()=&gt;{try{this.jw.forEach(((t,i)=&gt;{this.zw(i,t)}))}catch(t){}}),this.Ww))}stop(t){this.Uw&amp;=~t,0===this.Uw&amp;&amp;(clearInterval(this.Vw),this.Vw=null),this.Nw.forEach(((i,e)=&gt;{t&amp;e&amp;&amp;i.stopEnforce()}))}destroy(){this.stop(15),(0,o.i)(this.Li),this.jw.forEach(((t,i)=&gt;{this.deregisterContainer(i)}))}zw(t,i){(0,ot.Sz)(t.getElementsByTagName("iframe")).forEach((t=&gt;{try{this.zw(t,i)}catch(t){}})),this.Nw.forEach(((e,s)=&gt;{this.Uw&amp;s&amp;&amp;e.enforce(t,i)}))}qw(t,i,e){let s;this.jw.forEach(((t,e)=&gt;{t===i&amp;&amp;(s=e)})),this.Zg.next({message:e,type:t,detectedContainer:s})}}var Wn=e(8061),jn=e(1082),qn=e(9313),Hn=e(1434);function zn(t){return t.yoScore}const Gn="video",Jn="video",Yn="kpS2yP94aQw5Yi5d2";class Xn{constructor(t,i){this.mi=t,this.cs=i,this.Hw=!1,this.Gw=void 0,this.Jw=!1,this.Yw=!1,this.Xw=[],this.Li=[],this.Kw=!1,this.Qw=new s.x,this.Zw=new s.x,this.tP=-1,this.eP=1,this.iP=0,this.je=(0,h.AU)(ee.H),this.Pt=(0,h.AU)(Lt.n),this.bn=(0,h.TF)(t.sessionId,"MonetizationService"),this.Li.push(this.mi.adSelector.getBidEvents(3).subscribe((()=&gt;{this.sP()})),this.mi.adSelector.getBidEvents(5).subscribe((t=&gt;{try{this.rP(t)}catch(t){const{message:i}=(0,mt.W$)(t);(0,ft.FH)({message:"AdImpressionerController_handleAdImpression_error",level:"Info",exception:i,sessionId:this.mi.sessionId},{pacing:5})}})),this.mi.adSelector.getBidEvents(6).subscribe((t=&gt;{t.started&amp;&amp;t.status!==kt.INVALIDATED&amp;&amp;this.nP(t)})),this.mi.impressionCapsTimer.onTimer().subscribe((()=&gt;{this.sP()})))}get onAdSelected(){return this.Qw.asObservable()}get onAdFinished(){return this.Zw.asObservable()}start(t){this.oP=t,this.Hw=!0,this.sP()}stop(){this.Hw=!1}destroy(){this.stop(),(0,o.i)(this.Li),this.Gw&amp;&amp;this.aP()}sP(){var t;if(!this.hP())return;const i=this.mi.adSelector.getBestBidAllowedByStatus([kt.LOADED],this.oP);i&amp;&amp;(this.Gw&amp;&amp;this.dP(i)?(this.iP++,this.Gw.markAdAsReplaced(),i.setReplacedBid(this.Gw),null===(t=this.Gw)||void 0===t||t.stopAd("removeStartedBid"),this.aP(),this.cP(i)):this.Gw||this.cP(i))}cP(t){this.mi.adxLastLookService.callAdxLookup({state:this.oP,startingBid:t}),this.Pt.cacheUserWinningPrices(t.settings.adManagerLineItem.protoLineItem.advertiserAccountId,t.settings.price),this.Gw=t,this.mi.internalAuctionSnapshot.takeSnapshot(this.Gw,this.oP,this.oP.adOpportunity.timestamp),this.Qw.next(t),this.lP(),this.uP(t),t.startAd()}aP(){this.Gw&amp;&amp;(this.Gw=void 0,(0,o.i)(this.Xw),this.Xw=[])}hP(){const t=this.iP&gt;=this.eP;return!(!this.Yw||t)||!(!this.Hw||this.Jw)}dP(t){if(!this.mi.removeBidIfHigherYoScore&amp;&amp;!this.Yw)return!1;if(this.iP&gt;=this.eP)return!1;return!!(this.Gw&amp;&amp;zn(this.Gw)<zn(t))}lp(){const +(this.mi.generalrepository.shouldusenetcpm?1:0)),w.adtype="r.Z9.VIDEO_VIDEO){const{price:i,dimensions:e}=t.settings,{width:s,height:r}=e||{};null===(v=this.mi.assertiveYieldFloorPriceService)||void" 0="e?void" 0,vt="w.adType===r.Z9.VIDEO_VIDEO&amp;&amp;(0,W.$K)(this.mi.assertiveYieldFloorPriceService),mt={1:N,2:U,4:`${L}`,5:`${w.isViewabilityRequired}`,6:`${(0,W.$K)(null===(o=tt.highestLosingBidLineItem)||void" 0:_.settings.admanagerlineitem.protolineitem.advertiserlineitemid}),assertiveyield:dt,assertiveyieldfpp:q,bidrequesttesterapplied:z,floorpricesstrategytype:et,isaycontrolgroup:dt,vpmuteremoved:t.vpmuteremoved});this.cs.adimpression.next(rt),this.fp(t)}ap(t,i){var="" 0:a.lineitempriority:0}`,7:`${(0,w.$k)(tt.bidstatus)?tt.bidstatus:null}`,8:`${(0,w.$k)(t.price)?t.price:0}`,9:`${(0,w.$k)(null="(d=tt.firstLoser)||void" 0:a.settings.bidlifecycle)||void="" 0:b.adimpressiontoadreplacedtime,advertiserlineitemidreplaced:null="(_=t.replacedBid)||void" 0:c.demandtype)?null="(l=tt.firstLoser)||void" 0:d.customclientprice)?tt.firstloser.customclientprice:0}`,11:`${st}`,10:`${(0,w.$k)(null="(c=tt.firstLoser)||void" 0:e.creativeid),timespentmilliseconds:t.startingtimems,dspid:v,cnxbidid:m,initadtoadloadedtimemilliseconds:null="M?void" 0:e.lotamepanorama,ut="(null===(s=this.mi.videoAdsDurationService)||void" 0:f.wintoadloadedtime,startadtoadimpressiontimemilliseconds:null="(I=t.settings.bidLifecycle)||void" 0:g.creativeid),rtbseatid:z,isusersynced:g,timespentmilliseconds:t.startingtimems,vastmediatype:t.admediatype,dspid:j,cnxbidid:y,initadtoadloadedtimemilliseconds:null="(f=t.settings.bidLifecycle)||void" 0:i.startadtoimpressiontime,detecteddurationseconds:p,declareddurationseconds:m,isinexplorationmode:gt,requestnumber:x,floorprice:d,floorpriceinformation:e,admediafilewidth:t.width,admediafileheight:t.height,bidelapsedtimeseconds:c,adrolltype:x.adbreaktype,liveramptype:o,internalauction:b,auctioninformation:i,dynamicelkfieldsmap:mt,hasadskip:this.kw,discount:r,identityproviderdata:ot,assertiveyieldprobability:ct,playerwidth:it,playerheight:yt,pageinsightindexlist:null="(y=pt.k.pageInsights)||void" 0:i.vendorname)||"connatixad"),this.je.reportexternalwin({biddingplatformid:4,partnerauctionid:t.settings.callingstate.adopportunity.id,biddercode:e,cpm:t.price,currency:"usd",placementid:t.settings.bidslotid})}np(t){this.ip(t),this.mi.loopadwhenfinished?t.resumead():this.mi.pauseadwhenfinished?t.pausead():(this.zw.next(t),this.ap(),t.wasadreplaced||(this.ip='0,this.sP()))}IP(t){if(this.Jw&amp;&amp;(this.Jw=!1,this.Yw=!1,"domainBlocked"!==t.errorReason))return;if(!t.shouldTrackPostbid)return;const' 0:l.demandtype:0}`,12:(0,w.hj)(rt)?`${rt}`:"0",13:`${(0,w.$k)(et)?et.verifyingbidsinauction:0}`,14:`${(0,w.$k)(et)?et.idlebidsinauction:0}`,15:`${(0,w.$k)(et)?et.loadingbidsinauction:0}`,16:`${(0,w.$k)(et)?et.loadedbidsinauction:0}`,17:`${(0,w.$k)(this.mp.id)?this.mp.id:""}`,18:`${(0,w.$k)(null="(u=tt.highestLosingBidLineItem)||void" 0:m.wintoadloadedtime,requestnumber:g,floorprice:f,bidelapsedtimeseconds:r,adrolltype:s.adbreaktype,auctionpostbidreason:n,liveramptype:o,discount:h,floorpriceinformation:y,auctioninformation:i,identityproviderdata:_,assertiveyieldprobability:x,dynamicelkfieldsmap:w,eventtimestamp:bigint(date.now()),playerheight:s.height,playerwidth:s.width,videoplacement:this.mi.generalrepository.videoplacement,adclickurl:t.blockedurl});this.cs.adpostbid.next(c)}up(t){this.xw.push(t.onvpaidevent.subscribe((i="" 0:n.price)||0;null="(m=this.mi.assertiveYieldFloorPriceService)||void" 0:n.remainingadsduration)="" 0:o.lineitempriority)?null="(a=tt.highestLosingBidLineItem)||void" 0:p.creativetype:null}`,19:`${(0,w.$k)(tt.firstloserisima)?tt.firstloserisima:null}`,20:`${it}`,21:`${this.tp}`,22:`${se.n.getconnectiontype(this.mi.devicetype)}`,23:te.f.getcidforelktracking(),27:`${(0,w.$k)(t.settings.adxfloorprice)?t.settings.adxfloorprice.index:-1}`,29:`${!!$}`,30:`${vt}`,98:`${this.pt.getlocalstoragetype()}`,99:`${this.pt.getuservisitcount()}`};if(this.mi.generalrepository.shouldlogauctionpricetype&&(mt[31]="" 0:s.remainingadsduration)?math.round((null="(n=this.mi.videoAdsDurationService)||void" 0:t.allloserstatusinfo;let="" 0:t.firstloser,e="null==t?void" 0:u.creativetype)?null="(p=tt.highestLosingBidLineItem)||void" 0:y.insights,iassegmentcodelist:wt,sentimentanalysis:_t,lineitemabtest:xt,metadata:pt,insightindexlist:bt,videoplacement:st,initialgdprconsentmode:mt,mediaid:at,serverbillingnoticeurllist:f,lotamepanorama:lt,isscannedformalware:at,integrationtype:ct,adoverridedata:new="" _='this.je.getTrackingData(t.settings.adManagerLineItem,d,I),x=this.mi.assertiveYieldService.getAssertiveYieldProbability(t),S=this.mi.generalRepository.playerDimensions,w={1:`${A}`,2:(0,W.hj)(b)?`${b}`:"0",7:`${(0,W.$K)(this.mP.id)?this.mP.id:""}`,8:`${this.tP}`,9:`${se.n.getConnectionType(this.mi.deviceType)}`,10:Te.f.getCidForElkTracking(),12:`${!!a}`,14:`${this.Pt.getLocalStorageType()}`,15:`${this.Pt.getUserVisitCount()}`};(0,W.$K)(t.adPodInfo)&amp;&amp;(w[11]=`${t.adPodInfo.totalAds}`),this.mi.generalRepository.shouldLogAuctionPriceType&amp;&amp;(w[13]=""+(this.mi.generalRepository.shouldUseNetCPM?1:0));const{adManagerLineItem:{protoLineItem:{advertiserLineItemId:k,publisherLineItemId:P}},bidLifecycle:M}=t.settings,C=new' a,b;(0,w.$k)(this.mi.internalauctionsnapshot.lastsnapshot)&&(a="this.mi.internalAuctionSnapshot.lastSnapshot.auctionEndType,b=this.mi.internalAuctionSnapshot.lastSnapshot.deltaTimestampAdStartAdOpportunity);const" auction="" b;if((0,w.$k)(this.mi.internalauctionsnapshot.lastsnapshot)){const{winnerdemandtype:t,firstloser:i,firstopenmarketloser:e}="this.mi.internalAuctionSnapshot.lastSnapshot;B=new" e,s,n,o,a,d,c,l,u,p,v,m,g,f,i,y,a,b,_;const{adbreakstate:x,adcontainerstate:s}="this.oP,{protoLineItem:w,adxFloorPrice:k}=t.settings.adManagerLineItem,P=(0,W.hj)((0,nt.oK)(t.getAdDuration(),2))?(0,nt.oK)(t.getAdDuration(),2):0,M=(0,W.hj)((0,nt.oK)(t.declaredDurationInSeconds,2))?(0,nt.oK)(t.declaredDurationInSeconds,2):0,C=(0,Fr.H8)(t.createdTimestamp),L=S.get(w.adType).viewability,T=t.getAdMediaSize();let" e;const{adbreakstate:s}="this.oP,r=(0,Fr.H8)(t.createdTimestamp),n=(0,W.$K)(i)?this.mi.auctionInfoLogging.getGeneralPostbidReason(t.errorReason):Wn.W.NONE,{discount:h,liveRampType:o,isForcedAdxLastLook:a,identityPartnerUsed:d,prebidJsBidderName:c,isUserSynced:l,rtbSeatId:u,rtbAdomain:p,dspId:v,cnxBidId:m,requestNumber:g,requestedFloorPrice:f,identitySourceProviderList:I,floorPriceInformation:y}=t.settings.requestMetadata.data;let" e;i&&(e="(null==i?void" found",level:"warn",sessionid:this.mi.sessionid},{throttle:1,shouldsendmaxlog:!1});const{floorpriceinformation:e,requestedfloorprice:d,discount:r,liveramptype:o,serverbillingnoticeurllist:f,identitypartnerused:v,isforcedadxlastlook:$,rtbrequestid:n,auctionbidid:u,encryptedprice:j,prebidjsbiddername:q,rtbadomain:h,rtbseatid:z,isusersynced:g,dspid:j,cnxbidid:y,requestnumber:x,assertiveyieldfpp:q,identitysourceproviderlist:k,wasbidrequesttesterapplied:z}="t.settings.requestMetadata.data,tt=this.yP(),it=(0,W.$K)(tt.firstLoser)?100*(t.price-tt.firstLoser.customClientPrice):null,et=tt.allLoserStatusInfo;let" hn.y({adalivetimereplacedmilliseconds:null="(b=null===(A=t.replacedBid)||void" ht="t.settings.cpm;k&amp;&amp;(ht=D),w.isAdxLookup&amp;&amp;(ht=t.price);const" i="this.mi.auctionInfoLogging.onPostBid(t);this.AP(t,i)}yP(){const" internal="" jn.q({adpodslotposition:x.adpodslotindex,adsourcetype:t.adsourcetype,advertiserlineitemid:lt,publisherlineitemid:tt,dynamicservingfieldsmap:bt,customclientprice:ht,encryptedprice:j,prebidjsbiddername:q,rtbadomain:h,creativeid:t.creativeid||(null="(g=t.vastResponse)||void" n="this.mi.adSelector.getBestBidAllowedByStatus([kt.LOADING,kt.LOADED],this.oP),h=(null==n?void" no="" ot="this.je.getTrackingData(t.settings.adManagerLineItem,V,K),at=(0,h.AU)(cr.g).isBidMonitored(t.settings.bidId),dt=this.mi.assertiveYieldService.getAssertiveYieldOnImpression(t),ct=this.mi.assertiveYieldService.getAssertiveYieldProbability(t),lt=null===(e=this.mi.userManagerService)||void" qt.bp({winnerdemandtype:t,firstloser:i,firstopenmarketloser:e})}else(0,ft.fh)({message:"adimpressionercontroller:="" ri.s_):void="" s,r,n;return(0,w.$k)(i)&&(s="i.lineItem,n=i.isIma,r=i.status),{firstLoser:i,bidStatus:r,highestLosingBidLineItem:s,allLoserStatusInfo:e,firstLoserIsIma:n}}gP(t,i){var" snapshot="" st,rt;(0,w.$k)(this.mi.internalauctionsnapshot.lastsnapshot)&&(st="this.mi.internalAuctionSnapshot.lastSnapshot.auctionEndType,rt=this.mi.internalAuctionSnapshot.lastSnapshot.deltaTimestampAdStartAdOpportunity);let" t="this.mi.internalAuctionSnapshot.lastSnapshot,i=null==t?void" this.mp='t,void(this.tP=0);this.tP++}rP(t){this.Jw&amp;&amp;((0,ft.FH)({message:"AdManager_ABaseBidAdaptor_multipleImpressions",exception:`advertiserLineItemId:${t.settings.adManagerLineItem.protoLineItem.advertiserLineItemId}_creativeId:${t.creativeId}`,callStack:`${t.adMediaType}`,level:"Critical",sessionId:this.mi.sessionId},{throttle:1e3,extraLogsPercentage:5}),(0,ft.FH)({message:"StartedBidInImpression_bidStatusHistory",exception:`${t.adMediaType}_advertiserLineItemId:${t.settings.adManagerLineItem.protoLineItem.advertiserLineItemId}_creativeId:${t.creativeId}_vastAd:${JSON.stringify(t.settings.vastAd)}`,callStack:`${JSON.stringify(t.bidStatusHistory)}`,level:"Info",sessionId:this.mi.sessionId},{throttle:1e3})),this.Jw=!0,this.Yw=Boolean(t.settings.adManagerLineItem.protoLineItem.isPerformanceOverrideAd),this.Kw=this.vP(t.skipOffset,t.getAdDuration()),this.mi.adRequestGatekeeper.addImpression(t.settings.adManagerLineItem.protoLineItem.advertiserLineItemId,t.settings.obfuscatedPrice),this.mi.impressionCapsService.registerImpressionForLineItem(t.settings.adManagerLineItem,this.oP.adOpportunity.id),this.mi.requestCapsService.restoreOneCapForLineItem(t.settings.adManagerLineItem,this.oP.adOpportunity.id);const' wn.q({adpodslotposition:s.adpodslotindex,adsourcetype:t.adsourcetype,advertiserlineitemid:k,publisherlineitemid:p,error:t.errorreason,isbidloaded:!0,prebidjsbiddername:c,vastmediatype:t.admediatype,isusersynced:l,rtbseatid:u,rtbadomain:p,creativeid:t.creativeid||(null="(e=t.vastResponse)||void">{const e=function(t,i){switch(t){case ct.f.AdImpression:return i.adImpression;case ct.f.AdClickThru:return i.adClick;case ct.f.AdStarted:return i.adStarted;case ct.f.AdVideoStart:return i.adVideoStart;case ct.f.AdVideoFirstQuartile:return i.adQuartileFirst;case ct.f.AdVideoMidpoint:return i.adQuartileSecond;case ct.f.AdVideoThirdQuartile:return i.adQuartileThird;case ct.f.AdVideoComplete:return i.adQuartileFourth;case ct.f.AdPaused:return i.adPause;case ct.f.AdPlaying:return i.adResume;case ct.f.AdSkipped:return i.adSkip;case ct.f.AdUserClose:return i.adUserClose;case ct.f.AdUserAcceptInvitation:return i.adUserAcceptInvitation;case ct.f.AdUserMinimize:return i.adUserMinimize;case ct.f.AdError:return i.adError;default:return}}(i.type,t.settings.vastTracker);!(0,ot.BZ)(e)&amp;&amp;i.type===ct.f.AdImpression&amp;&amp;(t.adSourceType===as.wS.VPAID||t.adSourceType===as.wS.VAST_MEDIA)&amp;&amp;(0,ft.FH)({message:"AdManager_AdImpressionController_tracker_impression_not_found",exception:`creativeId: ${t.creativeId}, advertiserLineItemId: ${t.settings.adManagerLineItem.protoLineItem.advertiserLineItemId}`,level:"Info",sessionId:this.mi.sessionId},{shouldSendMaxLog:!1});let s;i.type===ct.f.AdError&amp;&amp;(s=i.payload.errorCode||900),$i(e,this.mi.adMacroReplacer,t.settings.adManagerLineItem.protoLineItem,t.settings.callingState,this.mi.plcmt,t.getTrackerSlot(),s)})),t.onAdViewableImpression.subscribe((i=&gt;{var e;const{publisherLineItemId:s,advertiserLineItemId:r,rtbSeatId:n,dspId:h,rtbAdomain:o}=i,a=t.settings.requestMetadata.data.discount;const{generalRepository:{currentMediaMetadata:{mediaId:d,insights:c,sentimentAnalysis:l},lineItemAbTest:u,adTrackingRequestMeta:p,iasSegmentCodes:v},adMacroReplacer:m,plcmt:g}=this.mi,f=null===(e=pt.k.pageInsights)||void 0===e?void 0:e.insights;this.cs.adInView.next(new qn.f({mediaId:d,publisherLineItemId:s,advertiserLineItemId:r,rtbSeatId:n,dspId:h,adRollType:this.oP.adBreakState.adBreakType,hasAdSkip:this.Kw,rtbAdomain:o,iasSegmentCodeList:v,discount:a,metadata:p,sentimentAnalysis:l,lineItemAbTest:u,insightIndexList:c,pageInsightIndexList:f}));const{settings:{vastTracker:{adViewableImpression:I},adManagerLineItem:{protoLineItem:y},callingState:A}}=t;$i(I,m,y,A,g)})))}vP(t,i){if((0,W.hj)(t)&amp;&amp;t&gt;=0)return!0;return(0,vt.Xj)(i,this.mi.skipAdSettings)}}class Qn{constructor(t,i){this._P=t,this.ls=i,this.bP=!1,this.SP=!1,this.wP=!1}get predictMode(){return this.bP}get adFetchingAllowed(){return this.SP}get impressionsAllowed(){return this.wP}get currentAdPlayerState(){return this.PP}get predictedAdPlayerState(){return this.MP}partialStateUpdate(t){this.PP&amp;&amp;(this.PP=Object.assign(Object.assign({},this.PP),t)),this.MP&amp;&amp;(this.MP=Object.assign(Object.assign({},this.MP),t))}getCurrentAdManagerState(t=!1){let i=this.PP;!this.currentAdPlayerState&amp;&amp;t&amp;&amp;(i=this.MP);const e=this._P.getContainerStateMap();return this.getAdManagerState(i,e)}getPredictedAdManagerState(){const t=this.MP,i=this.kP();return this.getAdManagerState(t,i)}getAdManagerState(t,i){if(!t)return;const{width:e,height:s,viewability:r}=this._P.getMainContainerState(),{clickToPlay:n,mediaMetadata:h,sound:o,adBreakState:a,linearAdOpportunity:d,playerOrientation:c,inFloating:l,queryJsTargeting:u}=t;return{width:e,height:s,viewability:r,clickToPlay:n,media:h,sound:!!o,soundVolume:o,adContainerState:i,adBreakState:a,adOpportunity:d,playerOrientation:c,page:{insights:pt.k.pageInsights},inFloating:l,auctionEndType:this.xP,isPageInFocus:this.ls.isPageInFocus,queryJsTargeting:u}}getCallSettings(){return{maxParallelCalls:5,stateSettings:{currentState:this.getCurrentAdManagerState(),predictedState:this.getPredictedAdManagerState()}}}getWinSettings(){return{desiredBitRate:1,maxParallelWins:10,vastViewMode:this.currentAdPlayerState?this.currentAdPlayerState.vastViewMode:this.predictedAdPlayerState.vastViewMode,stateSettings:{currentState:this.getCurrentAdManagerState(),predictedState:this.getPredictedAdManagerState()}}}enableImpression(t){this.bP=!1,this.PP=t,this.MP||(this.MP=this.PP),this.SP=!0}disableImpression(){this.wP=!1,this.SP=!1}enablePredict(t,i){this.PP=null,this.bP=!0,this.MP=t,this.MP.prefetchStateType=i,this.SP=!0}auctionEnd(t){this.xP=t,this.wP=!0}auctionStopCalling(){this.predictMode&amp;&amp;(this.SP=!1)}kP(){var t;let i;return 1===(null===(t=this.MP)||void 0===t?void 0:t.prefetchStateType)?(i=new Map,this._P.getContainerStateMap().forEach(((t,e)=&gt;{i.set(e,Object.assign(Object.assign({},t),{viewability:!0}))}))):i=this._P.getContainerStateMap(),i}}function Kn(t){return[...t].sort(((t,i)=&gt;zn(i)-zn(t)))}function Zn(t){return Kn(t)[0]}class th{constructor(t,i,e,s){this.LP=t,this.CP=i,this.TP=e,this.BP=s;const r=(0,h.AU)(Ki.w);this._i=r.userManagerService}getRequestEvents(t){return this.CP.getEvents(t)}hasAggregatorType(t){return this.LP.hasAggregatorType(t)}getAll(){return this.LP.lineItems}getAllByAggregator(t){return this.LP.getByAggregation(t)}getById(t){return this.LP.getByLineItemById(t)}getAllByRequest(t){return t?this.CP.lineItems:(0,ot.V7)(this.LP.lineItems,this.CP.lineItems)}getAllCallable(t){return this.LP.lineItems.filter((t=&gt;!mn.getInstance().hasLineItemById(t.protoLineItem.advertiserLineItemId,t.protoLineItem.publisherLineItemId))).filter((i=&gt;this.EP(i,t))).filter((i=&gt;wn(i,t,this._i))).filter((i=&gt;this.DP(i,t)))}getBestCallable(t,i){if(!i)return;const e=this.RP(t);return e?{state:i,lineItemList:this.OP(e,t)}:void 0}DP(t,i){const{hasAggregator:e,protoLineItem:s}=t;return!(!e&amp;&amp;!s.shouldBeCalledInEveryAo)||this.FP(t,i)}FP(t,i){const e=zn(t),s=this.getAllByRequest(!0),r=this.TP.getBidsByStatus([kt.IDLE,kt.LOADING,kt.LOADED]).filter((t=&gt;this.VP(t,i))).some((i=&gt;t.priceBasedYoScore<zn(i))),n=s.some((t=>e<zn(t)));return!r&&!n}ep(t,i){if(t.aggregators.size>0)return!1;const{advertiserLineItemId:e,shouldBeCalledInEveryAo:s,isAdxLookup:r,isAdxExternalLookup:n}=t.protoLineItem,h=this.TP.getBidsByLineItemId(e).filter((t=&gt;t.status!==kt.IMPRESSION));return!(!t.hasAggregator&amp;&amp;(h.length&gt;0||t.bidsInFetch.size&gt;0)&amp;&amp;!s||r||n)&amp;&amp;this.BP.callingValidationAggregator.canCall(t,i.adOpportunity.id)}RP(t){let i=t;return t.some((t=&gt;t.hasAggregator))&amp;&amp;(i=i.filter((t=&gt;t.hasAggregator))),Zn(i)}OP(t,i){if(t.hasAggregator){const{creativeType:e}=t.protoLineItem;return Kn(i.filter((t=&gt;e===t.protoLineItem.creativeType)))}return[t]}VP(t,i){return this.BP.impressionCapsValidationService.canCall(t.settings.adManagerLineItem,i.adOpportunity.id)&amp;&amp;kn(t,i,this._i)}}var ih=e(6873);class eh{constructor(t,i,e,s){this.NP=t,this.TP=i,this.BP=e,this.mi=s,this.$P=(t,i)=&gt;{const e=[],s=[];for(const r of t)this.isBidTargetingAllowed(r,i)?e.push(r):s.push(r);return{allowedBidList:e,notAllowedBidList:s}};const r=(0,h.AU)(Ki.w);this._i=r.userManagerService}getBidEvents(t){return this.TP.getEvents(t)}hasReachTheMaxNumberOfReadyBids(){const{maxNumberOfWins:t}=this.mi;if(-1===t)return!1;return this.TP.getBidsByStatus([kt.LOADING,kt.LOADED,kt.STARTING,kt.IMPRESSION]).length&gt;=t}hasLoadingBids(){const t=this.TP.getBidsByStatus([kt.LOADING]);return(0,ot.BZ)(t)}hasLoadedBids(){const t=this.TP.getBidsByStatus([kt.LOADED]);return(0,ot.BZ)(t)}hasUnstartedBids(){return this.TP.getBidsByStatus([kt.LOADED,kt.LOADING,kt.STARTING]).length&gt;0}hasAdsEligibleForFill(t){const i=this.NP.bidInFetchList.filter((i=&gt;this.UP(i.adManagerLineItem,t))),e=this.TP.getBidsByStatus([kt.IDLE,kt.LOADING,kt.LOADED]).filter((i=&gt;this.isBidTargetingAllowed(i,t)));return(0,ot.BZ)(e)||(0,ot.BZ)(i)}getEligibleBidsInFetchInAuctionSortedDescBySelectionScore(t){return Kn(this.NP.bidInFetchList.filter((i=&gt;this.WP(i.adManagerLineItem,t))))}getEligibleBidsInAuctionSortedBySelectionScore(t){return Kn(this.TP.getBidsByStatus([kt.IDLE,kt.LOADING,kt.LOADED]).filter((i=&gt;this.isBidTargetingAllowed(i,t))))}isBestBidLoaded(t){const i=this.getEligibleBidsInAuctionSortedBySelectionScore(t);return!!(0,W.$K)(i[0])&amp;&amp;i[0].status===kt.LOADED}getBestLoadedBid(){return Zn(this.TP.getBidsByStatus([kt.LOADED]))}getAllLoadedBids(){return this.TP.getBidsByStatus([kt.LOADED])}getAllBidPricesSortedDesc(){return this.TP.getAllBids().map((t=&gt;t.price)).sort(((t,i)=&gt;i-t))}getBestAllowedBidPrice(t){return[...this.TP.getBidsByStatus([kt.IDLE,kt.LOADING,kt.LOADED])].filter((i=&gt;this.isBidTargetingAllowed(i,t))).sort(((t,i)=&gt;i.price-t.price)).map((t=&gt;t.price))[0]||0}getHighestPricedAllowedBidByStatus(t,i){return this.TP.getBidsByStatus(t).filter((t=&gt;this.isBidTargetingAllowed(t,i))).sort(((t,i)=&gt;i.price-t.price))[0]}getBestAllowedBidPricePubNET(t){return this.TP.getBidsByStatus([kt.IDLE,kt.LOADING,kt.LOADED]).filter((i=&gt;this.isBidTargetingAllowed(i,t))).map((t=&gt;function(t,i,e){const s=i?t-t*i/100:t;return e?s*e/100:s}(t.price,t.settings.adManagerLineItem.protoLineItem.infrastructureFee,this.jP(t.settings.adManagerLineItem.protoLineItem.creativeMarketType)))).sort(((t,i)=&gt;i-t))[0]||0}getWinnableBidPricesSortedDesc(){return this.TP.getBidsByStatus([kt.LOADING,kt.LOADED]).sort(((t,i)=&gt;i.price-t.price)).map((t=&gt;t.price))}getBestBidAllowedByStatus(t,i){const e=this.TP.getBidsByStatus(t);return this.qP(e,i)}getBestBidAllowed(t){const i=this.TP.getAllBids();return this.qP(i,t)}getBestBidPriceExceptAdxLookup(){const t=this.TP.getAllBidsExceptAdxLookup();return 0===t.length?0:this.zP(t)}selectBestBid(t,i){const e=(0,h.AU)(cr.g),s=t.filter((t=&gt;!e.isCreativeMalware(t.creativeId))).filter((t=&gt;{const{adType:i,creativeType:s}=t.settings.adManagerLineItem.protoLineItem,{isMalwareScanNeeded:r}=t.settings.requestMetadata.data;return!e.shouldBeScannedForMalware(s,i,r)||e.isGeoedgeLoaded()})),r=this.$P(s,i),{allowedBidList:n,notAllowedBidList:o}=r,a=(0,ot.BZ)(n)&amp;&amp;Zn(n)||null,d=o.map((t=&gt;({bid:t,lossReason:this.HP(t,i)}))),c=n.filter((t=&gt;t!==a)).map((t=&gt;({bid:t,lossReason:ih.S.COMPETITOR_PRIORITY})));return{state:i,selectedBid:a,unselectedBidList:[...d,...c]}}selectBestBidForWin(t,i){const e=this.GP(i),s=this.JP(t,i);return this.YP(e,s)}isBidTargetingAllowed(t,i){return this.BP.impressionCapsValidationService.canCall(t.settings.adManagerLineItem,i.adOpportunity.id)&amp;&amp;kn(t,i,this._i)}zP(t){return Math.max(...t.map((t=&gt;t.price)))}GP(t){const i=this.TP.getBidsByStatus([kt.IDLE]);return this.selectBestBid(i,t)}JP(t,i){const e=[...t,...this.TP.getBidsByStatus([kt.LOADED])];return this.selectBestBid(e,i)}YP(t,i){const e=Object.assign({},t);return t.selectedBid&amp;&amp;i.selectedBid?(zn(i.selectedBid)&gt;zn(t.selectedBid)&amp;&amp;(e.selectedBid=null,e.unselectedBidList.push({bid:t.selectedBid,lossReason:ih.S.COMPETITOR_PRIORITY})),e):e}HP(t,i){return _n(t.getAdDuration(),i.adBreakState.remainingAdDuration)?ih.S.AD_OPPORTUNITY_END:ih.S.TARGETING_MISMATCH}WP(t,i){const e=[r.H6.THIRD_PARTY,r.H6.EXTERNAL],s=t.protoLineItem.creativeType,n=e.includes(s),h=this.UP(t,i);return!n&amp;&amp;h}UP(t,i){return this.BP.impressionCapsValidationService.canCall(t,i.adOpportunity.id)&amp;&amp;wn(t,i,this._i)}qP(t,i){return Zn(t.filter((t=&gt;this.isBidTargetingAllowed(t,i))))}jP(t){return t===r.ao.OPEN_MARKET?this.mi.openMarketRevSharePercentage:this.mi.pmpRevSharePercentage}}class sh{constructor(t,i,e,s,r,n){this.LP=t,this.CP=i,this.NP=e,this.TP=s,this.BP=r,this.mi=n;const{callingValidationAggregator:h,impressionCapService:o,standaloneService:a}=this.BP,{maxNumberOfWins:d,openMarketRevSharePercentage:c,pmpRevSharePercentage:l}=this.mi;this.XP=new th(this.LP,this.CP,this.TP,{callingValidationAggregator:h,impressionCapsValidationService:o,standaloneService:a}),this.KP=new eh(this.NP,this.TP,{impressionCapsValidationService:o,standaloneService:a},{maxNumberOfWins:d,openMarketRevSharePercentage:c,pmpRevSharePercentage:l})}isBidTargetingAllowed(t,i){return this.KP.isBidTargetingAllowed(t,i)}geLineItemById(t){return this.XP.getById(t)}getLineItemRequestEvents(t){return this.XP.getRequestEvents(t)}getBidEvents(t){return this.KP.getBidEvents(t)}hasAggregatorType(t){return this.XP.hasAggregatorType(t)}getAllLineItems(){return this.XP.getAll()}getLineItemsByAggregation(t){return this.XP.getAllByAggregator(t)}getLineItemsByRequest(t){return this.XP.getAllByRequest(t)}getAllCallableLineItems(t){return this.XP.getAllCallable(t)}getBestCallableLineItem(t,i){return this.XP.getBestCallable(t,i)}hasUnstartedBids(){return this.KP.hasUnstartedBids()}hasLoadingBids(){return this.KP.hasLoadingBids()}hasLoadedBids(){return this.KP.hasLoadedBids()}isBestBidLoaded(t){return this.KP.isBestBidLoaded(t)}getAllLoadedBids(){return this.KP.getAllLoadedBids()}getBestLoadedBid(){return this.KP.getBestLoadedBid()}getBestBidPriceExceptAdxLookup(){return this.KP.getBestBidPriceExceptAdxLookup()}hasReachTheMaxNumberOfReadyBids(){return this.KP.hasReachTheMaxNumberOfReadyBids()}hasAdsEligibleForFill(t){return this.KP.hasAdsEligibleForFill(t)}getEligibleBidsInFetchInAuctionSortedDescBySelectionScore(t){return this.KP.getEligibleBidsInFetchInAuctionSortedDescBySelectionScore(t)}getEligibleBidsInAuctionSortedDescBySelectionScore(t){return this.KP.getEligibleBidsInAuctionSortedBySelectionScore(t)}getAllBidPricesSortedDesc(){return this.KP.getAllBidPricesSortedDesc()}getBestAllowedBidPrice(t){return this.KP.getBestAllowedBidPrice(t)}getHighestPricedAllowedBidByStatus(t,i){return this.KP.getHighestPricedAllowedBidByStatus(t,i)}getBestAllowedBidPricePubNET(t){return this.KP.getBestAllowedBidPricePubNET(t)}getWinnableBidPricesSortedDesc(){return this.KP.getWinnableBidPricesSortedDesc()}getBestBidAllowedByStatus(t,i){return this.KP.getBestBidAllowedByStatus(t,i)}getBestBidAllowed(t){return this.KP.getBestBidAllowed(t)}selectBestBid(t,i){return this.KP.selectBestBid(t,i)}selectBestBidForWin(t){const i=this.TP.getBidsByStatus([kt.LOADING]);return this.KP.selectBestBidForWin(i,t)}}const rh="cnx-ad-slot";class nh{constructor(t,i,e){this.parentContainer=t,this.vt=i,this.ks=e,this.isImaSlot=!1,this.isAdxLookupSlot=!1,this.slotsContainer=this.vt.createElementByString('<div class="cnx-ad-bid-slot"></div>');const s=this.vt.createElementByString(`<div class="${rh}"></div>`);this.adSlot=this.vt.createElementByString(`<div class="${rh}"></div>`),this.videoSlot=this.vt.createElementByString(`<video class="${rh} cnx-ad-video-slot"></video>`);const r=Qi.n.defaultVideoPosterURL;(0,W.QM)(r)&amp;&amp;this.videoSlot.setAttribute("poster",r),this.videoSlot.setAttribute("playsinline",""),this.videoSlot.setAttribute("webkit-playsinline",""),this.videoSlot.setAttribute("aria-label","Advertisement"),this.slotsContainer.setAttribute("aria-hidden","true"),s.appendChild(this.videoSlot),s.appendChild(this.adSlot),this.slotsContainer.appendChild(s),this.parentContainer.appendChild(this.slotsContainer)}destroy(){this.parentContainer.removeChild(this.slotsContainer)}sanitize(){this.QP()}QP(){this.parentContainer.querySelectorAll("[data-cnx-gc]").forEach((t=&gt;{(0,U.bX)(t)}))}}const hh=[];function oh(t,i,e,s,r,n=!0,h){const o=hh.find((i=&gt;i.src===t.src&amp;&amp;i.global===e));if(o){const{onLoadCallbacks:t,onErrorCallbacks:i,wasOnLoadCalled:e}=o;if(t.push(s),i.push(s),!e)return;if(e)return void ah(o)}hh.push({src:t.src,global:e,wasOnLoadCalled:!1,onLoadCallbacks:[s],onErrorCallbacks:[r]}),(0,U.dZ)(t,i,e,(()=&gt;function(t){const i=hh.find((i=&gt;i.src===t.src));i.wasOnLoadCalled=!0,ah(i)}(t)),(()=&gt;function(t){const i=hh.find((i=&gt;i.src===t.src)),e=hh.findIndex((i=&gt;i.src===t.src));i.onErrorCallbacks.forEach((t=&gt;{try{t()}catch(t){}})),hh.splice(e,1)}(t)),n,h)}function ah(t){t.onLoadCallbacks.forEach((t=&gt;{try{t()}catch(t){}})),t.onLoadCallbacks=[]}const dh="imaObjectNotFound",ch="imaScriptFailure",lh="//imasdk.googleapis.com/js/sdkloader/ima3.js";function uh(t){return t.google&amp;&amp;t.google.ima}class ph extends nh{constructor(){super(...arguments),this.isImaSlot=!0,this.isAdxLookupSlot=!1,this.ZP=!1,this.tM={imaAdDisplayContainer:void 0,imaAdsLoader:void 0,imaSdk:void 0}}fetchImaDependencies(){return(t=window,i=!0,e=this.ks,new Promise(((s,r)=&gt;{const n=uh(t);if(n)return void s(n);const h=i&amp;&amp;1===(0,mt.Vm)([99,1]);oh({src:lh},t.document.head,t,(()=&gt;{const i=uh(t);i?s(i):(h&amp;&amp;(0,ft.FH)({sessionId:e,message:"AdManager_ImaIntegrator_no_image_object_found_after_loading_script",level:"Critical"},{throttle:2,shouldSendMaxLog:!1}),r(dh))}),(()=&gt;{r(ch)}),h,"AdManager_ImaIntegrator_unable_to_insert_ima_sdk_script")}))).then((t=&gt;this.eM(t)));var t,i,e}destroy(){this.tM.imaAdsLoader&amp;&amp;this.tM.imaAdsLoader.destroy(),this.tM.imaAdDisplayContainer&amp;&amp;this.tM.imaAdDisplayContainer.destroy(),super.destroy()}sanitize(){this.tM.imaAdsLoader.contentComplete(),super.sanitize()}eM(t){if(this.ZP)return this.tM;t.settings.setDisableCustomPlaybackForIOS10Plus(!0);const i=this.iM(t),e=this.sM(t,i);return this.tM={imaSdk:t,imaAdDisplayContainer:i,imaAdsLoader:e},this.ZP=!0,this.tM}iM(t){const i=new t.AdDisplayContainer(this.adSlot,this.videoSlot);return i.initialize(),i}sM(t,i){const e=new t.AdsLoader(i);return e.getSettings().setVpaidMode(t.ImaSdkSettings.VpaidMode.ENABLED),e.getSettings().setAutoPlayAdBreaks(!1),e}}class vh extends ph{constructor(){super(...arguments),this.isAdxLookupSlot=!0}}class mh{constructor(t){this.settings=t,this.rM=new Set,this.nM=new Set}preloadImaSdkSlots(t){var i;i=window,(0,U.Qa)(lh,i);for(let i=1;i&lt;=3;i++){const i=new ph(t,this.settings.globalDomUtilsService,this.settings.sessionId);i.fetchImaDependencies(),this.rM.add(i)}}preloadImaSdkAdxLookupSlot(t){const i=new vh(t,this.settings.globalDomUtilsService,this.settings.sessionId);i.fetchImaDependencies(),this.rM.add(i)}requestAdSlot(t){const i=new nh(t,this.settings.globalDomUtilsService,this.settings.sessionId);return this.oM(i),i}requestAdSlotIma(t,i=!1){let e=i?this.aM():this.hM();return e||(e=i?new vh(t,this.settings.globalDomUtilsService,this.settings.sessionId):new ph(t,this.settings.globalDomUtilsService,this.settings.sessionId)),this.oM(e),e}getNumberOfUsedImaSlots(){return[...this.nM].map((t=&gt;t.isImaSlot&amp;&amp;!t.isAdxLookupSlot)).length}destroyAdSlot(t){this.nM.delete(t),t.destroy()}recycleAdSlot(t){if(this.nM.delete(t),this.dM(t)){[...this.rM].map((t=&gt;t.isImaSlot&amp;&amp;!t.isAdxLookupSlot)).length&gt;=3&amp;&amp;!t.isAdxLookupSlot?this.destroyAdSlot(t):(t.sanitize(),this.rM.add(t))}else this.destroyAdSlot(t)}dM(t){return t.isImaSlot}cM(t){return t.isAdxLookupSlot}aM(){let t=null;return this.rM.forEach((i=&gt;{this.cM(i)&amp;&amp;null===t&amp;&amp;(t=i)})),t}hM(){let t=null;return this.rM.forEach((i=&gt;{this.dM(i)&amp;&amp;null===t&amp;&amp;(t=i)})),t}oM(t){this.rM.delete(t),this.nM.add(t)}}class gh{constructor(t,i){this.mi=t,this.cs=i,this.Li=[],this.lM=!1,this.f_=(0,h.AU)(cr.g),this.uM=()=&gt;{var t;if(this.mi.adSelector.hasReachTheMaxNumberOfReadyBids())return void this.mi.auctionManager.onNothingToWin();const i=this.pM(),{selectedBid:e,state:s}=i;if(!e)return;const n=e.settings.bidId,{creativeType:h,adType:o}=e.settings.adManagerLineItem.protoLineItem,a=e.settings.requestMetadata.data.isMalwareScanNeeded;if(this.f_.shouldBeScannedForMalware(h,o,a)&amp;&amp;this.mM(e,n)){this.f_.stopMonitoring(n),e.invalidate();const t=this.mi.auctionInfoLogging.onPostBid(e);return void this.vM(e,t,!1,"geoedgeMalwareDetected")}o===r.Z9.VIDEO_VIDEO&amp;&amp;(null===(t=this.mi.assertiveYieldFloorPriceService)||void 0===t||t.updateMaxBidPricePerSlot(this.mi.playerId,e.price)),this.mi.auctionInfoLogging.winBid(e);const{width:d,height:c}=s.adContainerState.get(o);e.initAd(d,c,this.gM.vastViewMode,this.mi.desiredBitRateForWins,void 0,void 0,s.soundVolume);const{vastTracker:l,adManagerLineItem:u}=e.settings;return $i(l.adWin,this.mi.adMacroReplacer,u.protoLineItem,s,this.mi.plcmt),Promise.resolve()},this.je=(0,h.AU)(ee.H),this.FS=new vn(this.uM,10),this.Li.push(this.mi.adSelector.getBidEvents(0).subscribe((t=&gt;{if(!this.gM)return;const i=this.pM();this.mi.auctionInfoLogging.newBidAdded(t,i),this.IM()})),this.mi.adSelector.getBidEvents(4).subscribe((()=&gt;{this.IM()})),this.mi.adSelector.getBidEvents(6).subscribe((t=&gt;{if(!t.started&amp;&amp;t.status!==kt.INVALIDATED){const i=this.mi.auctionInfoLogging.onPostBid(t),e=!0;this.vM(t,i,e)}this.IM()})),this.mi.adSelector.getBidEvents(2).subscribe((t=&gt;{if(t.status!==kt.INVALIDATED){const i=this.mi.auctionInfoLogging.onPostBid(t);this.vM(t,i)}this.IM()})),this.mi.impressionCapsTimer.onTimer().subscribe((()=&gt;{this.IM()})))}win(t){this.gM=t,this.FS.setNumberOfThreads(t.maxParallelWins),this.lM=!0,this.IM()}stop(){this.lM=!1,this.FS.stop()}hasStarted(){return!!this.gM}destroy(){this.stop(),(0,o.i)(this.Li)}IM(){this.lM&amp;&amp;this.FS.start()}mM(t,i){var e;const{price:s,creativeId:r,settings:n,vastResponse:h}=t,o=Number(n.adManagerLineItem.protoLineItem.demandPartnerId);if(!this.f_.canMonitor(o,r))return!1;const a=n.requestMetadata.data.rtbAdomain?[n.requestMetadata.data.rtbAdomain]:[],d=(null==h?void 0:h.mediaFiles.map((t=&gt;t.src)))||[],c=(null===(e=null==h?void 0:h.verifications)||void 0===e?void 0:e.flatMap((t=&gt;t.trackingEvents.map((t=&gt;t.uri)))))||[],l=(null==h?void 0:h.verifications.map((t=&gt;t.javaScriptResource.url)))||[],u=[null==h?void 0:h.linearClickThrough]||0,p=(null==h?void 0:h.wrapperUrls)||[],v=[...(m=n.vastTracker,[...m.adError.map((t=&gt;t.url)),...m.adWin.map((t=&gt;t.url)),...m.adImpression.map((t=&gt;t.url)),...m.adViewableImpression.map((t=&gt;t.url)),...m.adStarted.map((t=&gt;t.url)),...m.adVideoStart.map((t=&gt;t.url)),...m.adQuartileFirst.map((t=&gt;t.url)),...m.adQuartileSecond.map((t=&gt;t.url)),...m.adQuartileThird.map((t=&gt;t.url)),...m.adQuartileFourth.map((t=&gt;t.url)),...m.adClick.map((t=&gt;t.url)),...m.adPause.map((t=&gt;t.url)),...m.adResume.map((t=&gt;t.url)),...m.adSkip.map((t=&gt;t.url)),...m.adMute.map((t=&gt;t.url)),...m.adUnmute.map((t=&gt;t.url)),...m.adUserAcceptInvitation.map((t=&gt;t.url)),...m.adUserMinimize.map((t=&gt;t.url))]),...d,...c,...l,...u,...p];var m;const g={vast_creative_id:null==h?void 0:h.creativeId,vast_creative_ad_id:null==h?void 0:h.creativeAdId,creative_id:r,currency:"USD",cpm:s,height:n.adContainer.clientHeight,width:n.adContainer.clientWidth,slot_element_id:t.getSlotId(),advertiser_id:null==h?void 0:h.advertiserId,advertiser_name:null==h?void 0:h.advertiserName,universal_ad_ids:null==h?void 0:h.universalAdIds,vast_xmls:null==h?void 0:h.vastXmls,site:this.mi.generalRepository.pageUrl,adomains:a,demand_name:n.requestMetadata.data.demandPartnerName};return this.f_.startMonitoring(v,g,i)}pM(){const t=this.gM.stateSettings.currentState||this.gM.stateSettings.predictedState;return this.mi.adSelector.selectBestBidForWin(t)}vM(t,i,e=!1,s=""){var r,n,h,o,a;Ni(t.settings.vastTracker.adError,this.mi.adMacroReplacer,t.settings.adManagerLineItem.protoLineItem,t.settings.callingState,this.mi.plcmt,t.vastErrorCode);const{discount:d,liveRampType:c,prebidJsBidderName:l,isUserSynced:u,rtbSeatId:p,rtbAdomain:v,dspId:m,cnxBidId:g,requestNumber:f,requestedFloorPrice:I,identityPartnerUsed:y,identitySourceProviderList:A,floorPriceInformation:b}=t.settings.requestMetadata.data,_=(null===(n=null===(r=this.gM.stateSettings)||void 0===r?void 0:r.currentState)||void 0===n?void 0:n.adBreakState)||(null===(o=null===(h=this.gM.stateSettings)||void 0===h?void 0:h.predictedState)||void 0===o?void 0:o.adBreakState),x=this.je.getTrackingData(t.settings.adManagerLineItem,y,A),S=this.mi.assertiveYieldService.getAssertiveYieldProbability(t),w=(0,Fr.H8)(t.createdTimestamp),k=(0,W.$K)(i)?this.mi.auctionInfoLogging.getGeneralPostbidReason(t.errorReason):Wn.W.NONE,P=this.mi.generalRepository.playerDimensions,M={10:Te.f.getCidForElkTracking()};t.adPodInfo&amp;&amp;(M[11]=`${t.adPodInfo.totalAds}`),this.mi.generalRepository.shouldLogAuctionPriceType&amp;&amp;(M[13]=""+(this.mi.generalRepository.shouldUseNetCPM?1:0));const{adManagerLineItem:{protoLineItem:{advertiserLineItemId:C,publisherLineItemId:L}},bidLifecycle:T}=t.settings,B=new Wn.q({adPodSlotPosition:_.adPodSlotIndex,adSourceType:t.adSourceType,advertiserLineItemId:C,publisherLineItemId:L,error:s||t.errorReason,isBidLoaded:e,prebidJsBidderName:l,vastMediaType:t.adMediaType,isUserSynced:u,rtbSeatId:p,rtbAdomain:v,creativeId:t.creativeId||(null===(a=t.vastResponse)||void 0===a?void 0:a.creativeId),timeSpentMilliseconds:t.loadingTimeMs,dspId:m,cnxBidId:g,initAdToAdLoadedTimeMilliseconds:null==T?void 0:T.winToAdLoadedTime,requestNumber:f,floorPrice:I,floorPriceInformation:b,liveRampType:c,bidElapsedTimeSeconds:w,auctionInformation:i,auctionPostbidReason:k,discount:d,identityProviderData:x,assertiveYieldProbability:S,dynamicElkFieldsMap:M,eventTimestamp:BigInt(Date.now()),playerHeight:P.height,playerWidth:P.width,videoPlacement:this.mi.generalRepository.videoPlacement,adClickUrl:t.blockedUrl});this.cs.adPostbid.next(B)}}class fh{constructor(t,i){this.AM=t,this.yM=i,this._M=0,this.bM=new s.x,this.Li=[],this.SM=this.wM(),this.PM()}get onForceCallAdxLastLook(){return this.bM.asObservable()}forceCallAdxLookup(t,i){if(!t||!i)return;const e={adxLineItem:t,state:i};this.bM.next(e)}callAdxLookup(t){const{state:i,startingBid:e}=t;if(!this.SM||!i)return;const s=this.yM.getBidsByLineItemId(this.SM.protoLineItem.advertiserLineItemId),r=this.AM.getBestBidPriceExceptAdxLookup(),n=s.every((t=&gt;t.price<r)),h=!!(null==e?void 0:e.settings.admanagerlineitem.protolineitem.isadxlookup);if((n||h)&&this.am.hasunstartedbids()&&r="">0&amp;&amp;r<mt.zt-mt.p8){const i="this.yM.getAllBids().length" t="{adxLineItem:this.SM,state:i};this.bM.next(t)}}callAdxLookupIfNoFill(t){const">0;if(this.SM&amp;&amp;!i){const i={adxLineItem:this.SM,isForcedAdxLastLook:!0,state:t};this.bM.next(i)}}destroy(){(0,o.i)(this.Li)}getAdxLastLookPrice(){let t=this.AM.getBestBidPriceExceptAdxLookup()+Mt.P8;return t&amp;&amp;t<mt.fh&&(t=mt.fh),t<this._m?this._m:t}pm(){this.li.push(this.am.getbidevents(3).subscribe((t=>{t.settings.adManagerLineItem.protoLineItem.isAdxLookup&amp;&amp;t.price&gt;this._M&amp;&amp;(this._M=t.price)})))}wM(){return this.AM.getAllLineItems().find((t=&gt;t.protoLineItem.isAdxLookup))}}var Ih=e(2502);class yh{constructor(t,i,e){this.AM=t,this.cs=i,this.ks=e,this.MM=new Map}bidIsNotWinnableEverInSession(t){if(!this.kM(t))return;const i=[...this.AM.getAllBidPricesSortedDesc(),t.price].sort(((t,i)=&gt;i-t)),e=this.xM(i);this.yc(t.settings.requestMetadata.data.cnxBidId,e,ih.S.TARGETING_MISMATCH)}newBidAdded(t,i){this.kM(t)&amp;&amp;(i.selectedBid?i.selectedBid!==t?this.LM(t,i):this.CM(t):this.LM(t,i))}winBid(t){if(this.TM=t,!this.kM(t))return;const i=this.AM.getAllBidPricesSortedDesc(),e=this.xM(i);this.MM.set(t,e)}getLastWinningBid(){return this.TM}onPostBid(t){return this.BM(t)}onImpression(t){return this.BM(t)}getGeneralPostbidReason(t){switch(t){case"imaScriptFailure":case"imaObjectNotFound":case"imaManagerInit":case"initImasdkError":case"adxOverlayGptScriptLoad":case"displayIntegratorIframeLoad":return Wn.W.SDK_FAILURE;case"vastUnsupportedMedia":case"srcNotSupported":return Wn.W.UNSUPPORTED_MEDIA;case"domainBlocked":case"adaptorInitAdError":case"adaptorStartAdError":case"wrapperInitAdError":case"wrapperStartAdError":return Wn.W.TARGETING_MISMATCH;default:return Wn.W.CREATIVE_ERROR}}kM(t){return t.settings.requestMetadata.data.shouldLogAuctionInformation}CM(t){const{cnxBidId:i}=t.settings.requestMetadata.data,e=this.AM.getAllBidPricesSortedDesc(),s=this.xM(e);this.yc(i,s,ih.S.COMPETITOR_PRIORITY)}BM(t){const i=this.EM(t);return this.DM(t),i}LM(t,i){var e,s,r,n;const h=this.RM(t,i);if(!(0,W.$K)(h))return void this.OM("AdManager_AuctionInfoLogging_lossReason_cannot_be_found",t.settings.requestMetadata.data.cnxBidId,null===(n=null===(r=null===(s=null===(e=i.selectedBid)||void 0===e?void 0:e.settings)||void 0===s?void 0:s.requestMetadata)||void 0===r?void 0:r.data)||void 0===n?void 0:n.cnxBidId);const{cnxBidId:o}=t.settings.requestMetadata.data,a=this.AM.getAllBidPricesSortedDesc(),d=this.xM(a);this.yc(o,d,h)}EM(t){if(this.MM.has(t))return this.MM.get(t);this.kM(t)&amp;&amp;this.OM("AdManager_AuctionInfoLogging_cannot_find_win_bid_snapshot",t.settings.requestMetadata.data.cnxBidId)}DM(t){this.MM.has(t)&amp;&amp;this.MM.delete(t)}RM(t,i){var e;return null===(e=i.unselectedBidList.find((i=&gt;i.bid===t)))||void 0===e?void 0:e.lossReason}xM(t){const i=t[0]?(0,Zt.p)(t[0]):void 0,e=t[1]?(0,Zt.p)(t[1]):void 0;return i||this.OM("AdManager_AuctionInfoLogging_highestBidPrice_missing",`${i}`),new Ih.T({bidDensity:t.length,highestBidPriceObfuscated:i,secondHighestBidPriceObfuscated:e})}yc(t,i,e){this.cs.auctionInformation.next(new ih.k({auctionInformation:i,lossReason:e,cnxBidId:t}))}OM(t,i="",e=""){(0,ft.FH)({message:t,level:"Critical",callStack:i,exception:e,sessionId:this.ks},{throttle:5})}}var Ah=e(1145);class bh{constructor(t){this.mi=t,this.FM=3,this.VM=5,this.NM=90,this.$M=40,this.bn=(0,h.TF)(t.sessionId,"MonetizationService"),this.Ac=(0,h.TF)(t.sessionId,Ah.A);const i=(0,h.TF)(t.sessionId,"PlayerSettings");this.UM=i.auctionConfig}getScore(t,i,e,s){var n,h;const{adSelector:o,adContainer:a,adManagerState:d}=this.mi,{sessionPredictionsExchange:c,averageSessionTime:l}=this.bn,u=d.getPredictedAdManagerState()||d.getCurrentAdManagerState(),p=a.getContainerStateMap().get(r.Z9.VIDEO_VIDEO).viewability||!1,v=this.WM(o),m=(0,ot.ey)(v)||(0,ot.ey)(c)||this.FM,g=(0,nt.Vt)(v,this.NM)||(0,nt.Vt)(c,this.NM)||this.VM,f=o.getHighestPricedAllowedBidByStatus([kt.LOADED],u),I=o.isBestBidLoaded(u),y=(null===(n=o.getBestBidAllowed(u))||void 0===n?void 0:n.settings.adManagerLineItem.protoLineItem.lineItemPriority)&gt;(null==f?void 0:f.settings.adManagerLineItem.protoLineItem.lineItemPriority),A=s?this.$M:i/ri.s_,b=(Date.now()-e)/ri.s_,{timingWeight:_,remainingMaxAuctionTimeWeight:x,aboveAvgSessionLengthWeight:S,futureOpportunitiesWeight:w,bidWeight:k,hasHigherPriorityBidWeight:P,fppAvgHighestBidDiffWeight:M,fpp90HighestBidDiffWeight:C,previousAndCurrentBidDiffWeight:L,isBestBidLoadedWeight:T,otherWeight:B,isInViewWeight:E}=(null===(h=this.UM)||void 0===h?void 0:h.auctionWeights)||{},D=function(t){const{timing:i,bid:e,other:s,timing:{weight:r},bid:{weight:n},other:{weight:h}}=t,o=r*function(t){const{params:{predictedAverageSessionTimeInS:i,overallSessionTimeElapsedInS:e,maxAuctionTimeInS:s,auctionTimeInS:r,noOfOpportunities:n},paramsWeights:{remainingMaxAuctionTimeWeight:h,aboveAvgSessionLengthWeight:o,futureOpportunitiesWeight:a}}=t;return h*(s-r)+o*(e&gt;i?1:-1)+a*((i-e)/s&gt;n?1:0)}(i),a=n*function(t){const{params:{hasHigherPriorityBidAvailable:i,fpp90PPrice:e,fppAvgPrice:s,bestSessionBidPrice:r,isBestBidLoaded:n,highestBidPrice:h},paramsWeights:{hasHigherPriorityBidWeight:o,fppAvgHighestBidDiffWeight:a,fpp90HighestBidDiffWeight:d,previousAndCurrentBidDiffWeight:c,isBestBidLoadedWeight:l}}=t;return o*(i?1:0)+a*(s-h)+d*(e-h)+c*(r-h)+l*(n?1:0)}(e),d=h*function(t){const{params:{isInView:i},paramsWeights:{isInViewWeight:e}}=t;return e*(i?1:0)}(s);return o+a+d}({timing:{weight:null!=_?_:1,params:{predictedAverageSessionTimeInS:l,overallSessionTimeElapsedInS:this.Ac.overallSessionTimeElapsed/ri.s_,auctionTimeInS:b,maxAuctionTimeInS:A,noOfOpportunities:5},paramsWeights:{remainingMaxAuctionTimeWeight:null!=x?x:6,aboveAvgSessionLengthWeight:null!=S?S:2,futureOpportunitiesWeight:null!=w?w:1}},bid:{weight:null!=k?k:1,params:{highestBidPrice:(null==f?void 0:f.price)||0,fppAvgPrice:m,fpp90PPrice:g,bestSessionBidPrice:t,isBestBidLoaded:I,hasHigherPriorityBidAvailable:y},paramsWeights:{hasHigherPriorityBidWeight:null!=P?P:100,fppAvgHighestBidDiffWeight:null!=M?M:4,fpp90HighestBidDiffWeight:null!=C?C:2,previousAndCurrentBidDiffWeight:null!=L?L:8,isBestBidLoadedWeight:null!=T?T:-100}},other:{weight:null!=B?B:1,params:{isInView:p},paramsWeights:{isInViewWeight:null!=E?E:-4}}});return D}WM(t){return t.getAllLineItems().filter((t=&gt;t.protoLineItem.floorPricesNewModel)).reduce(((t,i)=&gt;((0,W.$K)(i.protoLineItem.floorPricesNewModel)&amp;&amp;i.protoLineItem.floorPricesNewModel.priceList.forEach((i=&gt;t.push(i.price))),t)),[])}}class _h{constructor(t){this.mi=t,this.jM=new s.x,this.qM=[],this.zM=!1,this.HM=!1,this.Li=[],this.GM="",this.JM=!1,t.featureFlags.shouldExpandInternalAuction&amp;&amp;(this.JM=!0),this.YM=new bh(t)}get onAuctionMechanismEnded(){return this.jM.asObservable()}startNewAuction(t){this.GM=t.auctionId,this.XM=t.callingState,this.HM=t.waitForNewReadyBid,this.KM=t.auctionStartStamp,this.ZM=t.auctionTimeout,this.tk=t.prefetchStatus,this.ek=t.highestSessionBid,this.ik(),this.sk(),this.PM(),this.rk()}cancelAuction(){this.ik()}updateState(t){if(this.XM=t,0===this.qM.length)return;const i=this.XM.stateSettings.currentState||this.XM.stateSettings.predictedState;if(!i)return;const e=this.mi.adSelector.getLineItemsByRequest(!0).map((t=&gt;t.protoLineItem.advertiserLineItemId)),s=this.mi.adSelector.getAllCallableLineItems(i).map((t=&gt;t.protoLineItem.advertiserLineItemId));this.qM=this.qM.filter((t=&gt;t.isAdCalled||(0,ot.d3)(t.lineItemId,s)||(0,ot.d3)(t.lineItemId,e))),this.rk()}onNothingToWin(){0!==this.qM.length&amp;&amp;this.qM.every((t=&gt;!0===t.isAdCalled))&amp;&amp;this.rk()}onNothingToCall(){0!==this.qM.length&amp;&amp;(this.nk(),this.rk())}nk(){const t=this.mi.adSelector.getLineItemsByRequest(!0).map((t=&gt;t.protoLineItem.advertiserLineItemId));this.qM=this.qM.filter((i=&gt;!0===i.isAdCalled||!1===i.isAdCalled&amp;&amp;(0,ot.d3)(i.lineItemId,t)))}ak(){this.ik(),this.jM.next(this.GM)}PM(){this.Li.push(this.mi.adSelector.getLineItemRequestEvents(1).subscribe((t=&gt;{this.hk(t),this.rk()})),this.mi.adSelector.getBidEvents(3).subscribe((t=&gt;{this.zM=!0,this.rk()})),this.mi.adSelector.getBidEvents(2).subscribe((t=&gt;{this.rk()})))}hk(t){this.qM.forEach((i=&gt;{t.some((t=&gt;t.protoLineItem.advertiserLineItemId===i.lineItemId))&amp;&amp;(i.isAdCalled=!0)}))}dk(){(0,o.i)(this.Li)}rk(){const t=this.XM.stateSettings.currentState||this.XM.stateSettings.predictedState,i=this.qM.every((t=&gt;!0===t.isAdCalled));0===this.qM.length||this.tk.prefetchEnded?this.ak():this.HM&amp;&amp;!this.zM||(this.JM&amp;&amp;this.ck(t)||i&amp;&amp;this.lk())&amp;&amp;this.ak()}lk(){return this.YM.getScore(this.ek,this.ZM,this.KM,this.tk.inPrefetchMode)&lt;0}ck(t){const i=new Set(this.qM.map((t=&gt;t.priority)));for(let e=r.fO.TOP;e&gt;=r.fO.HOUSE;e--){if(!i.has(e))continue;if(!this.qM.filter((t=&gt;t.priority===e)).every((t=&gt;!0===t.isAdCalled)))break;if(this.mi.adSelector.getEligibleBidsInAuctionSortedDescBySelectionScore(t).some((t=&gt;t.settings.adManagerLineItem.protoLineItem.lineItemPriority===e))&amp;&amp;this.mi.adSelector.isBestBidLoaded(t))return!0}return!1}ik(){this.qM=[],this.zM=!1,this.dk()}sk(){this.uk(),this.pk(),this.mk()}mk(){this.mi.adSelector.getLineItemsByRequest(!0).forEach((t=&gt;{this.vk(t)}))}pk(){const t=this.XM.stateSettings.currentState||this.XM.stateSettings.predictedState;if(!t)return void(0,ft.FH)({message:"ShortCircuitMechanism_registerClientSideLineItem_no_state",level:"Info",sessionId:this.mi.sessionId},{throttle:10,shouldSendMaxLog:!1});const i=this.mi.adSelector.getAllCallableLineItems(t).filter((t=&gt;!t.hasAggregator)),e=i.filter((t=&gt;t.protoLineItem.shouldBeCalledInEveryAo)),s=this.gk(i,t);if(!s)return void this.fk(e);const r=this.mi.adSelector.getBestLoadedBid();(r?zn(r):0)&gt;zn(s)?this.fk(e):(this.vk(s),e.filter((t=&gt;t!==s)).forEach((t=&gt;{this.vk(t)})))}uk(){const t=this.XM.stateSettings.currentState||this.XM.stateSettings.predictedState;if(!t)return void(0,ft.FH)({message:"ShortCircuitMechanism_registerAggregatedLineItems_no_state",level:"Info",sessionId:this.mi.sessionId},{throttle:1,shouldSendMaxLog:!1});this.mi.adSelector.getAllCallableLineItems(t).filter((t=&gt;t.hasAggregator)).forEach((t=&gt;{this.vk(t)}))}gk(t,i){const e=this.mi.adSelector.getBestCallableLineItem(t,i);if(e&amp;&amp;(0,ot.BZ)(e.lineItemList))return e.lineItemList[0]}vk(t,i=!1){return!this.qM.some((i=&gt;i.lineItemId===t.protoLineItem.advertiserLineItemId))&amp;&amp;(this.qM.push({isAdCalled:i,lineItemId:t.protoLineItem.advertiserLineItemId,priority:t.protoLineItem.lineItemPriority}),!0)}fk(t){t.forEach((t=&gt;{this.vk(t)}))}}class xh{constructor(t,i){this.Xt=t,this.mi=i,this.Ik=!1,this.KM=null,this.Ak=6e3,this.yk=new s.x,this.jM=new s.x,this._k=[],this.bk=6e3,this.ek=0,this.ce=null,this.tk={inPrefetchMode:!1,startTime:0,prefetchEnded:!1,adBreakType:St.cr.AD_BREAK_TYPE_UNSPECIFIED},this.Sk={id:"",auctionEnded:!1},this.wk=new _h({adSelector:i.adSelector,sessionId:i.sessionId,adBidPool:i.adBidPool,featureFlags:i.featureFlags,adManagerState:i.adManagerState,adContainer:i.adContainer}),i.featureFlags.shouldExpandInternalAuction&amp;&amp;(this.bk=1e4),this.Pk()}get onAuctionStopCalling(){return this.jM.asObservable()}get onAuctionEnd(){return this.yk.asObservable()}updateState(t){this.wk.updateState(t)}cancelAuction(){this.Ik||(this.tk.inPrefetchMode=!1,this.wk.cancelAuction(),this.Mk())}startPrefetch(t){var i,e;if(this.tk.inPrefetchMode)return;this.Ik=!1,this.KM=Date.now(),this.Mk();const s=(null===(i=t.stateSettings.currentState)||void 0===i?void 0:i.adBreakState.adBreakType)||(null===(e=t.stateSettings.predictedState)||void 0===e?void 0:e.adBreakState.adBreakType);this.tk={adBreakType:s,inPrefetchMode:!0,startTime:Date.now(),prefetchEnded:!1},this.kk(!0,t)}startAuction(t,i,e){var s,r;const n=this.xk(e);this.Ak=n;const h=(null===(s=t.stateSettings.currentState)||void 0===s?void 0:s.adBreakState.adBreakType)||(null===(r=t.stateSettings.predictedState)||void 0===r?void 0:r.adBreakState.adBreakType);if(h===St.cr.POST_ROLL&amp;&amp;h!==this.tk.adBreakType&amp;&amp;this.cancelAuction(),this.tk.adBreakType=h,this.Ik=!1,this.Sk.id===i)return void(this.Sk.auctionEnded&amp;&amp;(0,W.$K)(this.Sk.auctionEndedType)&amp;&amp;this.ak(this.Sk.auctionEndedType));this.KM=Date.now(),this.Sk={auctionEnded:!1,id:i},this.Mk();let o=n;this.tk.inPrefetchMode?(o-=Date.now()-this.tk.startTime,o&lt;0||this.tk.prefetchEnded?this.ak("prefetched"):this.Lk(o)):(this.tk.prefetchEnded=!1,this.kk(!1,t),this.Lk(o)),this.tk.inPrefetchMode=!1}startCustomAuction(t,i,e){this.KM=Date.now(),this.Ik=!0,this.Sk.id=e,this.kk(!1,t,i),this.Lk(this.bk,i)}onNothingToWin(){this.wk.onNothingToWin()}onNothingToCall(){this.wk.onNothingToCall()}destroy(){(0,o.i)(this._k)}xk(t){var i,e;const s=(0,h.TF)(this.mi.sessionId,"PlayerSettings"),r=(0,h.TF)(this.mi.sessionId,"FeatureFlags"),n=t&gt;ri.s_?t-ri.s_:void 0;let o=null!==(e=null===(i=s.auctionConfig)||void 0===i?void 0:i.auctionTimeoutInMs)&amp;&amp;void 0!==e?e:n;return r.shouldExpandInternalAuction&amp;&amp;(o=this.bk),(0,W.$K)(o)?o:this.bk}kk(t,i,e){var s;const r=this.mi.adManagerState.getPredictedAdManagerState()||this.mi.adManagerState.getCurrentAdManagerState();this.ek=Math.max(this.ek,(null===(s=this.mi.adSelector.getBestBidAllowed(r))||void 0===s?void 0:s.price)||0),this.wk.startNewAuction({callingState:i,auctionId:e,waitForNewReadyBid:t,auctionStartStamp:this.KM,auctionTimeout:this.Ak,prefetchStatus:this.tk,highestSessionBid:this.ek})}Pk(){this._k.push(this.wk.onAuctionMechanismEnded.subscribe((t=&gt;{this.Ck(t)})))}Ck(t){this.tk.prefetchEnded=!0,this.jM.next(),this.tk.inPrefetchMode||this.ak("short",t)}Lk(t,i){this.ce=this.Xt.setTimeout((()=&gt;{this.ak("timeout",i)}),t)}ak(t,i){this.Ik=!1,null!==this.KM&amp;&amp;(0,W.$K)(t)&amp;&amp;(this.Tk(t,Date.now()-this.KM),this.KM=null),this.Sk.auctionEnded=!0,this.Sk.auctionEndedType=t,this.cancelAuction();const e={type:t,auctionId:i};this.yk.next(e)}Mk(){this.Xt.clearTimeout(this.ce),this.ce=null}Tk(t,i){(0,ft.FH)({message:"AuctionManager_end_auction",exception:t,callStack:this.Bk(i),level:"Info",sessionId:this.mi.sessionId},{shouldSendMaxLog:!1,throttle:1e4,pacing:1})}Bk(t,i=0){const e=[0,.25,.5,.75,1,1.25,1.5,1.75,2,2.25,2.5,2.75,3,4,5][i];return void 0===e?"over_5s":t&lt;=1e3*e?`${e}`:this.Bk(t,i+1)}}var Sh=e(3932);const wh=30*ri.s_;class kh{constructor(){this.Ek=null}onAdRemoved(){this.Ek=null,this.Dk()}pauseViaUserInteraction(){this.Ek&amp;&amp;(this.Ek.pausedWithUserInteraction=!0)}resumeViaUserInteraction(){this.Ek&amp;&amp;(this.Ek.pausedWithUserInteraction=!1,this.Dk())}checkPauseAd(t,i){t&amp;&amp;(null===this.Ek&amp;&amp;this.Rk(t),i?this.Ok(t):this.Vk(t))}Rk(t){this.Ek={currentAd:t,isPaused:!1,pausedWithUserInteraction:!1,remainingTimeForAdToBePaused:wh,lastAdPausedStartedTimestamp:void 0},this.Dk()}Vk(t){this.Nk(t)&amp;&amp;(this.Ek.isPaused=!0,this.Ek.lastAdPausedStartedTimestamp=Date.now(),t.pauseAd(),this.Dk(),this.$k=setTimeout((()=&gt;{t.stopAd("pauseOutOfView"),this.Ek=null,this.Dk()}),this.Ek.remainingTimeForAdToBePaused))}Ok(t){t.settings.adManagerLineItem.protoLineItem.pauseAdOutOfView&amp;&amp;t.impressionStarted&amp;&amp;this.Ek.isPaused&amp;&amp;!this.Ek.pausedWithUserInteraction&amp;&amp;(this.Dk(),this.Ek.isPaused=!1,this.Ek.remainingTimeForAdToBePaused=this.Ek.remainingTimeForAdToBePaused-(Date.now()-this.Ek.lastAdPausedStartedTimestamp),t.resumeAd())}Dk(){clearTimeout(this.$k),this.$k=void 0}Nk(t){return t.settings.adManagerLineItem.protoLineItem.pauseAdOutOfView&amp;&amp;t.impressionStarted&amp;&amp;!this.Ek.isPaused&amp;&amp;!this.Ek.pausedWithUserInteraction}}const Ph=["11d44b9b-1330-432c-bcd7-4a095b47cdbd"];class Mh{constructor(t,i){this.Uk=t,this.Wk=i,this.jk=3e3,this.mA=null,this.qk=!1,Ph.includes(this.Uk.settings.adManagerLineItem.protoLineItem.advertiserLineItemId)||this.Uk.adPodInfo&amp;&amp;this.Uk.adPodInfo.totalAds&gt;1||this.zk()}destroy(){var t;this.Hk&amp;&amp;(this.Hk.unsubscribe(),this.Hk=null),null===(t=this.Gk)||void 0===t||t.stop()}zk(){this.Hk=this.Uk.onVpaidEvent.subscribe((t=&gt;{var i,e,s,r,n,h,o,a,d;switch(t.type){case ct.f.AdImpression:this.Jk();break;case ct.f.AdVideoFirstQuartile:this.Yk();break;case ct.f.AdVideoMidpoint:null===(i=this.Gk)||void 0===i||i.reset();break;case ct.f.AdVideoThirdQuartile:null===(e=this.Gk)||void 0===e||e.reset();break;case ct.f.AdVideoComplete:null===(s=this.Gk)||void 0===s||s.stop();break;case ct.f.AdStopped:null===(r=this.Gk)||void 0===r||r.stop();break;case ct.f.AdError:null===(n=this.Gk)||void 0===n||n.stop();break;case ct.f.AdPaused:null===(h=this.Gk)||void 0===h||h.stop();break;case ct.f.AdSkipped:null===(o=this.Gk)||void 0===o||o.stop();break;case ct.f.AdPlaying:null===(a=this.Gk)||void 0===a||a.start();break;case ct.f.AdUserClose:null===(d=this.Gk)||void 0===d||d.stop();break;case ct.f.AdExpandedChange:case ct.f.AdClickThru:case ct.f.AdInteraction:case ct.f.AdUserAcceptInvitation:case ct.f.AdLinearChange:case ct.f.AdUserMinimize:this.destroy()}}))}Jk(){const t=(0,h.AU)(tt.f);let i=this.Uk.getAdDuration();(0,W.r)(i)?(i*=1e3,this.qk=!0):i=1e3*this.Wk,this.mA=i;const e=this.Xk();this.Gk=new _s.B(t,e),this.Gk.onTimeElapsed.subscribe((()=&gt;{this.Hk.unsubscribe(),this.Hk=null,this.Uk.stopAd("adNotLoading")})),this.Gk.start()}Yk(){if(this.qk)this.Gk.reset();else{this.mA=4*this.Gk.timeElapsed;const t=this.Xk();this.Gk.reset(t)}}Xk(){return this.mA/4+this.jk}}class Ch{constructor(t,i,e,r,n,h){this.Uk=t,this._P=i,this.cs=e,this.Kk=r,this.mi=n,this.ls=h,this.Qk=!1,this.Kw=!1,this.Zk=[],this.tx=new kh,this.Dv=new s.x,this.zk(),this.sx=new Mh(this.Uk,this.mi.maxAdDuration),this.resizeAd()}get onVpaidEvent(){return this.Dv.asObservable()}get inImpression(){return this.Qk}setVastViewMode(t){this.mi.adViewMode=t;const{width:i,height:e}=this._P.getContainerStateMap().get(this.Uk.settings.adManagerLineItem.protoLineItem.adType);this.Uk.resizeAd(i,e,this.mi.adViewMode)}getAdVolume(){return this.Uk.getAdVolume()}setAdVolume(t,i){if(i){const{adMacroReplacer:e,adManagerState:s}=i;this.nx(t,s,e)}this.Uk.setAdVolume(t)}resizeAd(){const{width:t,height:i,viewability:e}=this._P.getContainerStateMap().get(this.Uk.settings.adManagerLineItem.protoLineItem.adType);this.tx.checkPauseAd(this.Uk,e),this.Uk.resizeAd(t,i,this.mi.adViewMode)}skipAd(){this.Uk.setAdVolume(0),this.Uk.skipAd()}stopAd(t){this.Uk.stopAd(t)}pauseAd(t){this.Uk.pauseAd(),t&amp;&amp;this.tx.pauseViaUserInteraction()}resumeAd(t){this.Uk.resumeAd(),t&amp;&amp;this.tx.resumeViaUserInteraction()}getMediaSize(){const t=this.Uk.getAdMediaSize().width,i=this.Uk.getAdMediaSize().height,{widthRatio:e,heightRatio:s}=(0,nt.dO)(t,i);return{width:t,height:i,widthRatio:e,heightRatio:s,adType:this.Uk.settings.adManagerLineItem.protoLineItem.adType}}getMetadata(){const{adSourceType:t,settings:i}=this.Uk,{adManagerLineItem:{protoLineItem:{advertiserLineItemId:e,publisherLineItemId:s,adType:r,skipMode:n}}}=i;return{advertiserLineItemId:e,publisherLineItemId:s,adType:r,duration:this.Uk.getAdDuration(),adSkipMode:n,adSourceType:t}}destroy(){this.Qk=!1,this.tx.onAdRemoved(),this.Hk.unsubscribe(),this.Hk=null,this.sx.destroy()}zk(){this.Hk=this.Uk.onVpaidEvent.subscribe((t=&gt;{switch(t.type){case ct.f.AdImpression:this.hx();break;case ct.f.AdVideoFirstQuartile:this.lx(as.NR.FIRST);break;case ct.f.AdVideoMidpoint:this.lx(as.NR.SECOND);break;case ct.f.AdVideoThirdQuartile:this.lx(as.NR.THIRD);break;case ct.f.AdVideoComplete:this.lx(as.NR.FOURTH)}this.Dv.next(t)}))}hx(){this.Kw=this.vP(this.Uk.skipOffset,this.Uk.getAdDuration()),this.Qk=!0;const{viewability:t}=this._P.getContainerStateMap().get(this.Uk.settings.adManagerLineItem.protoLineItem.adType);this.tx.checkPauseAd(this.Uk,t)}lx(t){var i;const e=this.Zk.includes(t)&amp;&amp;!(this.mi.pauseAdWhenFinished||this.mi.loopAdWhenFinished),s=this.Kk.adBreakState,{adManagerLineItem:r}=this.Uk.settings;if(e)return void(1===(0,mt.Vm)([99,1])&amp;&amp;(0,ft.FH)({message:"AdManager_AdImpressionerController_handleQuartilesTracking_track_same_quartile_twice",level:"Warn",exception:r.protoLineItem.advertiserLineItemId,callStack:this.Uk.adMediaType,sessionId:this.mi.sessionId}));this.Zk.push(t);const{requestMetadata:n}=this.Uk.settings,{advertiserLineItemId:h,publisherLineItemId:o}=r.protoLineItem,{rtbSeatId:a,rtbAdomain:d,dspId:c}=n.data,{currentMediaMetadata:{sentimentAnalysis:l,mediaId:u,insights:p},lineItemAbTest:v,iasSegmentCodes:m,adTrackingRequestMeta:g}=this.ls,f=g,I=null===(i=pt.k.pageInsights)||void 0===i?void 0:i.insights;this.cs.adQuartile.next(new Sh.Z({mediaId:u,advertiserLineItemId:h,publisherLineItemId:o,quartile:t,rtbSeatId:a,dspId:c,adRollType:s.adBreakType,hasAdSkip:this.Kw,rtbAdomain:d,iasSegmentCodeList:m,sentimentAnalysis:l,insightIndexList:p,metadata:f,lineItemAbTest:v,pageInsightIndexList:I}))}vP(t,i){if((0,W.hj)(t)&amp;&amp;t&gt;=0)return!0;return(0,vt.Xj)(i,this.mi.skipAdSettings)}nx(t,i,e){const s=this.Uk.getAdVolume();let r=null;0===s&amp;&amp;t&gt;0?r=this.Uk.settings.vastTracker.adUnmute:s&gt;0&amp;&amp;0===t&amp;&amp;(r=this.Uk.settings.vastTracker.adMute);const{plcmt:n}=this.mi,h=this.Uk.settings.adManagerLineItem.protoLineItem;r&amp;&amp;$i(r,e,h,i,n)}}class Lh{constructor(t,i){this.AM=t,this.ux=i}refreshImaSlots(t){if(this.ux.getNumberOfUsedImaSlots()&lt;=5)return;const i=this.AM.getAllLoadedBids().filter((t=&gt;"ima"===t.adMediaType&amp;&amp;!t.settings.adManagerLineItem.protoLineItem.isAdxLookup));if(i.length&lt;=5)return;i.sort(((i,e)=&gt;(this.AM.isBidTargetingAllowed(e,t)?1:0)-(this.AM.isBidTargetingAllowed(i,t)?1:0)||e.yoScore-i.yoScore)).slice(5).forEach((t=&gt;{t.invalidate()}))}}class Th extends qt.fW{constructor(t,i,e,s,r){super(r),this.lineItem=t,this.isIma=i,this.loserType=e,this.status=s}}class Bh{constructor(t,i,e,s,r){this.AM=t,this.Gw=i,this.adManagerState=e,this.ks=r,this.mx=[],this.vx=[],this.deltaTimestampAdStartAdOpportunity=Date.now()-s,this.mx=this.AM.getEligibleBidsInAuctionSortedDescBySelectionScore(this.adManagerState).filter((t=&gt;t!==this.Gw)),this.vx=this.AM.getEligibleBidsInFetchInAuctionSortedDescBySelectionScore(this.adManagerState),this.winnerDemandType=this.gx(),this.firstLoser=this.Ix(),this.allLoserStatusInfo=this.Ax(),this.firstOpenMarketLoser=this.yx(),this.auctionEndType=this.adManagerState.auctionEndType}gx(){return this.Gw?Gt(this.Gw):(this._x("ImpressionAuctionSnapshot: No winner bid found"),qt.cZ.DEMAND_TYPE_UNSPECIFIED)}Ax(){const t=this.vx.length;let i=0,e=0,s=0;return this.mx.forEach((t=&gt;{switch(t.status){case kt.IDLE:i++;break;case kt.LOADING:e++;break;case kt.LOADED:s++}})),{verifyingBidsInAuction:t,idleBidsInAuction:i,loadingBidsInAuction:e,loadedBidsInAuction:s}}Ix(){const t=this.mx[0],i=this.vx[0];if(!(0,W.$K)(t)&amp;&amp;!(0,W.$K)(i))return;let e=0;(0,W.$K)(t)&amp;&amp;(e=zn(t));let s,r,n,h,o,a,d,c,l,u=0;return(0,W.$K)(i)&amp;&amp;(u=zn(i)),e&gt;u?(s=Gt(t),r=t.price,n="bid",h=t.settings.requestMetadata.data.encryptedPrice,o=t.settings.adManagerLineItem.protoLineItem.advertiserLineItemId,a=t.settings.adManagerLineItem.protoLineItem,d=t.settings.isIma,c=t.status,l=t.settings.isIma?-1:t.getAdDuration()):(s=function(t){const i=Object.keys(zt).find((i=&gt;(0,zt[i])(t.protoLineItem)));if(!(0,W.$K)(i))return qt.cZ.DEMAND_TYPE_UNSPECIFIED;const e=Number.parseInt(i,10);return qt.cZ[qt.cZ[e]]}(i.adManagerLineItem),r=i.bidPrice,n="bid_in_fetch",h=i.encryptedPrice,o=i.adManagerLineItem.protoLineItem.advertiserLineItemId,a=i.adManagerLineItem.protoLineItem,d=i.isIma,c=-1,l=-2),new Th(a,d,n,c,{demandType:s,encryptedPrice:h,customClientPrice:r,advertiserLineItemId:o,adDurationSeconds:l})}yx(){const t=this.bx();if(!(0,W.$K)(t))return;const{settings:{requestMetadata:{data:{encryptedPrice:i}},cpm:e,adManagerLineItem:{protoLineItem:{advertiserLineItemId:s}}}}=t;return new qt.fW({demandType:qt.cZ.OPEN_MARKET,encryptedPrice:i,customClientPrice:e,advertiserLineItemId:s})}bx(){return this.mx.find((t=&gt;Gt(t)===qt.cZ.OPEN_MARKET))}_x(t){(0,ft.FH)({level:"Warn",message:t,sessionId:this.ks},{throttle:1,shouldSendMaxLog:!1})}}class Eh{constructor(t,i){this.AM=t,this.ks=i,this.Sx=null}get lastSnapshot(){return this.Sx}takeSnapshot(t,i,e){return this.Sx=new Bh(this.AM,t,i,e,this.ks),this.Sx}}var Dh=e(2134);let Rh=class{constructor(){this.wx=[]}get lineItems(){return[...this.wx]}add(t){this.wx.push(...t)}remove(t){this.wx.includes(t)&amp;&amp;(0,ot.sj)(this.wx,t)}getByAggregation(t){return this.lineItems.filter((i=&gt;i.hasAggregator===t))}getByLineItemById(t){return this.lineItems.find((i=&gt;i.protoLineItem.advertiserLineItemId===t))}getByPublisherLineItemId(t){return this.lineItems.find((i=&gt;i.protoLineItem.publisherLineItemId===t))}hasAggregatorType(t){return this.lineItems.some((i=&gt;(0,Ut[t])(i.protoLineItem)))}};Rh=(0,yi.gn)([(0,Dh.b2)(),(0,Dh.Yn)(Dh.Fw.ContainerScoped)],Rh);class Oh{constructor(){this.Px=new s.x,this.Mx=new s.x,this.kx={0:this.Px,1:this.Mx},this.xx={0:t=&gt;this.Px.next(t),1:t=&gt;this.Mx.next(t)}}getCallingObservable(t){return this.kx[t].asObservable()}triggerEvent(t,i){(0,this.xx[t])(i)}}let Fh=class{constructor(){this.jA=new Oh,this.Lx=[]}get lineItems(){return this.Lx}add(t){this.Lx=[...this.lineItems,...t],this.jA.triggerEvent(0,t)}remove(t){this.Lx=this.lineItems.filter((i=&gt;!(0,ot.d3)(i,t))),this.jA.triggerEvent(1,t)}getEvents(t){return this.jA.getCallingObservable(t)}};Fh=(0,yi.gn)([(0,Dh.b2)(),(0,Dh.Yn)(Dh.Fw.ContainerScoped)],Fh);let Vh=class{constructor(){this.bidInFetchList=[]}add(t){this.bidInFetchList.push(t)}remove(t){(0,ot.sj)(this.bidInFetchList,t)}getById(t){return this.bidInFetchList.find((i=&gt;i.bidId===t))}};Vh=(0,yi.gn)([(0,Dh.b2)(),(0,Dh.Yn)(Dh.Fw.ContainerScoped)],Vh);class $h{constructor(){this.kS=new s.x,this.Cx=new s.x,this.Tx=new s.x,this.Bx=new s.x,this.Ex=new s.x,this.Dx=new s.x,this.Rx=new s.x,this.Ox={0:this.kS,1:this.Cx,2:this.Dx,3:this.Tx,4:this.Bx,5:this.Ex,6:this.Rx},this.Vx={[kt.IDLE]:t=&gt;{this.kS.next(t)},[kt.LOADING]:t=&gt;{this.Cx.next(t)},[kt.LOADED]:t=&gt;{this.Tx.next(t)},[kt.STARTING]:t=&gt;{this.Bx.next(t)},[kt.IMPRESSION]:t=&gt;{this.Ex.next(t)},[kt.CONSUMED_LOADING]:t=&gt;{this.Dx.next(t)},[kt.CONSUMED_LOADED]:t=&gt;{this.Rx.next(t)},[kt.INVALIDATED]:t=&gt;{[kt.IDLE,kt.LOADING].includes(t.status)?this.Dx.next(t):this.Rx.next(t)}}}bidStatusChanged(t,i){(0,this.Vx[i])(t)}getBidObservable(t){return this.Ox[t].asObservable()}}let Nh=class{constructor(){this.av=[],this.Nx=new $h,this.$x=new Map}getEvents(t){return this.Nx.getBidObservable(t)}addBid(t){this.Ux(t),t.settings.adManagerLineItem.registerBid(),this.av.push(t),this.Nx.bidStatusChanged(t,kt.IDLE)}getAllBids(){return this.Wx(),this.av}getAllBidsExceptAdxLookup(){return this.getAllBids().filter((t=&gt;!t.settings.adManagerLineItem.protoLineItem.isAdxLookup))}getBidsByLineItemId(t){return this.getAllBids().filter((i=&gt;{const{advertiserLineItemId:e,publisherLineItemId:s}=i.settings.adManagerLineItem.protoLineItem;return[e,s].includes(t)}))}getBidsByStatus(t){return this.getAllBids().filter((i=&gt;t.includes(i.status)))}jx(t,i){[kt.CONSUMED_LOADING,kt.CONSUMED_LOADED,kt.INVALIDATED].includes(i)&amp;&amp;this.zx(t),this.Nx.bidStatusChanged(t,i)}zx(t){this.Hx(t),(0,ot.sj)(this.av,t)}Gx(){return this.av.filter((t=&gt;{const i=t.createdTimestamp,e=t.settings.adManagerLineItem.protoLineItem.networkExpiryTimeSeconds;return(0,W.r)(e)&amp;&amp;(0,Fr.H8)(i)&gt;=e}))}Wx(){this.Gx().forEach((t=&gt;t.invalidate()))}Ux(t){const i=t.onStatusChanged.subscribe((i=&gt;{this.jx(t,i)}));this.$x.set(t.settings.bidId,i)}Hx(t){const{bidId:i}=t.settings,e=this.$x.get(i);null==e||e.unsubscribe(),this.$x.delete(i)}};Nh=(0,yi.gn)([(0,Dh.b2)(),(0,Dh.Yn)(Dh.Fw.ContainerScoped)],Nh);class Uh{constructor(t){this.Xt=t,this.Jx=null,this.Yx=new s.x}start(){return this.Xx(),this}stop(){return this.Kx(),this}onTimer(){return this.Yx.asObservable()}destroy(){this.Kx()}Xx(){null===this.Jx&amp;&amp;(this.Jx=this.Xt.setInterval((()=&gt;{this.Yx.next()}),500))}Kx(){this.Xt.clearInterval(this.Jx),this.Jx=null}}const Wh={[St.cr.PRE_ROLL]:"preRoll",[St.cr.MID_ROLL]:"midRoll",[St.cr.POST_ROLL]:"postRoll"};class jh{constructor(t,i,e,s){this.Qx=t,this._i=i,this.Ll=e,this._appSettings=s}replace(t,i,e,s){this.Qx.setAdWidth(s.adMacros.adWidth),this.Qx.setAdHeight(s.adMacros.adHeight),this.Qx.setAdPosition(Wh[s.adMacros.adPostion]),this.Qx.setErrorCode(s.adMacros.errorCode),this.Qx.setMute(s.adMacros.mute),this.Qx.setPlcmt(s.adMacros.plcmt),s.adMacros.videoInsightsCategories&amp;&amp;this.Qx.setVideoInsights(s.adMacros.videoInsightsCategories.join("")),s.mediaMacros.mediaDescription&amp;&amp;this.Qx.setVideoDescription(s.mediaMacros.mediaDescription),s.mediaMacros.mediaDuration&amp;&amp;this.Qx.setVideoDuration(s.mediaMacros.mediaDuration),s.mediaMacros.mediaId&amp;&amp;this.Qx.setVideoId(s.mediaMacros.mediaId),s.mediaMacros.mediaTitle&amp;&amp;this.Qx.setVideoTitle(s.mediaMacros.mediaTitle),s.mediaMacros.mediaUrl&amp;&amp;this.Qx.setVideoUrl(s.mediaMacros.mediaUrl);const r=this._i.isConsent(i);this.Qx.setGDPR(this._i.isConsentRequired()?1:0),this.Qx.setConsent(r?1:0),this.Qx.setGDPRConsent(this._i.getConsentPayload()),this.Qx.setGppString(this._i.getGppString()),this.Qx.setGppSid(this._i.getGppSid()),this.Qx.setNPA(this._i.isPersonalisedAdsAllowed()?0:1);const n=re(this.Ll.playerId,this.Ll.pageUrl,Si.Y[this.Ll.deviceType],this.Ll.accountNameWithoutPlatform,this.Ll.bundleID);this.Qx.setGpid(n);const h=this._i.getTrackableUser(),o=this._i.isConsentConnatix()&amp;&amp;r?h:void 0;return this.Qx.setUUID(o),this.Qx.setNielsenSiteId(this._appSettings.bundleID),this.Qx.setNielsenPlacementId(e),this.Qx.setNielsenDeviceGrouping(this.Ll.deviceType),this.Qx.setNielsenOsGrouping(this.Ll.os.os),this.Qx.setNielsenUserId(o),this.Qx.setNielsenPlatform(this.Ll.isInApp),this.Qx.setNielsenOsVersion(this.Ll.os.osVersion),this.Qx.setNielsenUOO(this._i.isPersonalisedAdsAllowed()?0:1),this.Qx.setNielsenTimestamp(),this.Qx.setupMacros(t)}}var qh=e(999);let Hh=class{constructor(){this.Zx=[],this.tL=new Map,this.eL=new Map}saveAuctionPayload(t,i){this.Zx.push(t);const e=Array(t.demandPartnerIdList.length).fill(0);this.eL.set(t.requestId,e),i.bids.forEach((i=&gt;{const e=i.requestMetadata.data.cnxBidId;(0,W.QM)(e)&amp;&amp;(0,W.QM)(t.requestId)&amp;&amp;this.tL.set(e,t.requestId)}))}getAssertiveYieldOnImpression(t){const i=this.iL(t);if(!(0,W.$K)(i))return;const e=this.sL(i,t),s=this.eL.get(i.requestId);if(!(0,ot.BZ)(s))return;const r=Array(s.length).fill(0);return(0,W.Xc)(e)&amp;&amp;(s[e]+=t.price,r[e]=s[e],this.eL.set(i.requestId,s)),this.tL.delete(t.settings.bidId),new qh.l(Object.assign(Object.assign({},i),{costCpmList:r}))}getAssertiveYieldProbability(t){const i=this.iL(t);if(!(0,W.$K)(i))return;const e=this.sL(i,t);return(0,W.$K)(i)&amp;&amp;i.predictionList&amp;&amp;(0,W.$K)(e)?i.predictionList[e]:void 0}iL(t){if(!(0,W.QM)(t.settings.requestMetadata.data.cnxBidId))return;const i=this.tL.get(t.settings.requestMetadata.data.cnxBidId);return this.Zx.find((t=&gt;t.requestId===i))}sL(t,i){var e;return null===(e=t.demandPartnerIdList)||void 0===e?void 0:e.indexOf(`${i.settings.adManagerLineItem.protoLineItem.demandPartnerId}`)}};Hh=(0,yi.gn)([(0,Dh.b2)(),(0,Dh.Yn)(Dh.Fw.ContainerScoped)],Hh);var zh=e(5790);const Gh=`//${Yn}.ay.delivery/test/client-connatix.js`;let Jh=class{constructor(t,i){this.rL=null,this.Im=new Be.o(i,t.sessionId)}getAYClient(){return window.assertive&amp;&amp;this.nL(window.assertive)?Promise.resolve(window.assertive):this.oL()}nL(t){return(0,W.$K)(t.version)}oL(){return null!==this.rL||(this.rL=(0,mt.Up)((()=&gt;new Promise(((t,i)=&gt;{const e=J.h`<script>window.assertive={entityId:"${Yn}",floor:{enabled:!0,addToHashKey:!1,currency:"USD",prebid:!0,aps:!1,limit:{percentage:.2}}}</script><script id="assertive-yield-cnx-script" src="${Gh}"></script>`,s={container:window.document.body,customHtml:e,customIframeAttributes:[{key:"style",value:"display: none;"}]};this.Im.loadIframe(s).then((i=&gt;{const e=i.iframe.contentWindow.assertive;e.highestQualifiedBids={},window.assertive=e,t(e)})).catch((()=&gt;{i(new Error("AssertiveLoader_failed_script"))}))}))))),this.rL}};Jh=(0,yi.gn)([(0,Dh.ri)(),(0,yi.fM)(0,(0,Dh.f3)(ln.B)),(0,yi.fM)(1,(0,Dh.f3)("GlobalDomUtilsService")),(0,yi.w6)("design:paramtypes",[Object,Function])],Jh);let Yh=class{constructor(t,i,e){this.aL=t,this.ls=i,this.cs=e,this.hL=0,this.dL=!0,this.lL()}get cachedFloorPrice(){return this.hL}impression(t){this.lL((i=&gt;{i.logCustomImpression(t)}))}forceTrigger(t){this.lL((i=&gt;{this.uL(i,t)}))}updateMaxBidPricePerSlot(t,i){this.lL((e=&gt;{this.pL(e,t,i)}))}getFloorPriceListUsingFactors(){const{floorPriceFactorList:t}=this.ls;return 0!==this.hL&amp;&amp;(0,ot.BZ)(t)?(0,ot.gX)(t.map((t=&gt;t*this.hL))):[this.hL]}lL(t){this.aL.getAYClient().then((i=&gt;{t&amp;&amp;t(i)})).catch((t=&gt;this.mL(t)))}pL(t,i,e){t.highestQualifiedBids[i]=e,this.uL(t,i)}uL(t,i){var e;const s=null===(e=t.getPrebidFloor)||void 0===e?void 0:e.call(t,i),r=(0,W.hj)(s);(0,li.q)([{name:r?"ay_prediction":"ay_control_group",value:1,type:di.t.COUNTER,tagList:this.dL?["firstCall: true"]:void 0}]),this.dL=!1;const n=this.vL(s);this.hL=n,this.cs.assertiveYield.next(new zh.W({floorPrice:n,metadata:this.ls.adTrackingRequestMeta}))}vL(t){if(!(0,W.hj)(t))return 0;return t-1e-6&lt;0?(this.gL(t),0):t}mL(t){const{message:i,stack:e}=(0,mt.W$)(t);(0,ft.FH)({message:"AssertiveYieldFloorPriceService",level:"Warn",exception:i,callStack:e},{pacing:5,throttle:3,shouldSendMaxLog:!1})}gL(t){(0,ft.FH)({message:"AssertiveYieldFloorPriceService",level:"Warn",exception:"floorPrice is not a positive number",callStack:t.toString()},{pacing:5,throttle:3,shouldSendMaxLog:!1})}};Yh=(0,yi.gn)([(0,Dh.b2)(),(0,Dh.Yn)(Dh.Fw.ContainerScoped),(0,yi.fM)(0,(0,Dh.f3)(Jh)),(0,yi.fM)(1,(0,Dh.f3)(ln.B)),(0,yi.fM)(2,(0,Dh.f3)(a.k)),(0,yi.w6)("design:paramtypes",[Jh,Object,Object])],Yh);class Xh{constructor(t,i,e){this.mi=t,this.rc=i,this.cs=e,this.FL=new s.x,this.Li=[],this.VL=!1,this.Dv=new s.x,this.NL=new s.x,this.Wa=t=&gt;{mn.getInstance().add(t,this.LP,this.yM)},this.Ya=t=&gt;{this.NL.next(t)},this.$L=(t,i)=&gt;{const e=this.LP.lineItems.find((i=&gt;i.protoLineItem.advertiserLineItemId===t));e&amp;&amp;(e.protoLineItem.isViewabilityRequired=i)},this.sw=()=&gt;{var t;null===(t=this.UL)||void 0===t||t.resizeAd(),this.WL()},this.Sp=(0,h.TF)(this.mi.app.config.sessionId,Xi.G),this.bn=(0,h.TF)(this.mi.app.config.sessionId,"MonetizationService");const r=this.mi.adContainerMap.get(this.jL());this.qL=(0,U.LT)(r),this.cs.startBidTracking.next(),this.zL(),this.HL(),this.GL(),this.JL(),this.YL()}get onVpaidEvent(){return this.Dv.asObservable()}get onImpressionRevenueEvent(){return this.NL.asObservable()}get onNoFill(){return this.FL.asObservable()}setAdVolume(t){var i;this.Kk.partialStateUpdate({sound:t});const e={adManagerState:this.Kk.getCurrentAdManagerState(!0),adMacroReplacer:this.XL};null===(i=this.UL)||void 0===i||i.setAdVolume(t,e)}setAdViewMode(t){var i;this.Kk.partialStateUpdate({vastViewMode:t}),null===(i=this.UL)||void 0===i||i.setVastViewMode(t)}getCurrentAdMetadata(){var t;return null===(t=this.UL)||void 0===t?void 0:t.getMetadata()}getCurrentAdMediaSize(){var t;return null===(t=this.UL)||void 0===t?void 0:t.getMediaSize()}pauseAd(t){var i;null===(i=this.UL)||void 0===i||i.pauseAd(t)}resumeAd(t){var i;null===(i=this.UL)||void 0===i||i.resumeAd(t)}skipAd(){var t;null===(t=this.UL)||void 0===t||t.skipAd()}stopAd(t){var i;null===(i=this.UL)||void 0===i||i.stopAd(t)}setPlayerOrientation(t){this.Kk.partialStateUpdate({playerOrientation:t}),this.WL()}setQueryJsTargeting(t){this.Kk.partialStateUpdate({queryJsTargeting:t}),this.WL()}enableImpressions(t){this.Kk.enableImpression(t),this._P.forceTriggerUpdateState(),this.KL.allowResetOnTime=!0,this.QL(t),this.ZL()}isCurrentAdInImpression(){var t;return(null===(t=this.UL)||void 0===t?void 0:t.inImpression)||!1}disableImpressions(t=!1){(this.Kk.impressionsAllowed||t)&amp;&amp;(this.tC.stop(),this.eC.stop(),this.Kk.disableImpression(),this.UL&amp;&amp;!this.UL.inImpression&amp;&amp;this.mi.app.config.isInApp&amp;&amp;this.UL.stopAd("inApp_disable"))}enablePredict(t,i){if(this.mi.disablePrefetch)return;if(1===i&amp;&amp;this.mi.playerData.playbackMode===St.Fx.SCROLL_TO_PLAY)try{this.iC()}catch(t){const{message:i}=(0,mt.W$)(t);return void(0,ft.FH)({message:"Prefetch_logOutOfViewDistance_error",level:"Info",exception:i,sessionId:this.mi.app.config.sessionId},{pacing:1,throttle:1})}switch(this.Kk.enablePredict(t,i),i){case 1:this.KL.allowResetOnTime=!1;break;case 2:this.KL.allowResetOnTime=!0}this.ZL();const e=this.Kk.getCallSettings();this.sC.startPrefetch(e)}isLoadingAds(){return!!this.UL||this.AM.hasLoadingBids()}getMainContainerState(){return this._P.getMainContainerState()}getMainContainer(){return this._P.getMainContainer()}setCustomMacros(t){this.eC.setMacros(t)}destroy(){var t;this.disableImpressions(),(0,o.i)(this.Li),this.eC.destroy(),this.rC.destroy(),this.tC.destroy(),this.nC.destroy(),this.oC.destroy(),this.aC(),null===(t=this.UL)||void 0===t||t.stopAd("adManagerDestroy"),this.hC()}hasAdsEligibleForFill(t){const i=this.Kk.getAdManagerState(t,this._P.getContainerStateMap());return this.AM.hasAdsEligibleForFill(i)}hasUnstartedBids(){return this.AM.hasUnstartedBids()}dC(t){this.CP.remove(t)}yk(t,i){this.Kk.auctionEnd(this.cC(t)),this.Kk.impressionsAllowed&amp;&amp;this.lC(),this.uC()}ZL(){this.VL||(this.VL=!0,this._i.ccpaInfoLogging(this.mi.app.config.playerId));const t=this.Kk.getCallSettings();this.eC.call(t);const i=this.Kk.getWinSettings();this.rC.win(i)}uC(){this.pC&amp;&amp;0===this.yM.getAllBids().length&amp;&amp;(this.pC.impression({source:Gn,slotId:this.mi.app.config.playerId,highestPreBid:0,highestPreBid_partner:"",mediaType:Jn,preBidWon:!1,unfilled:!0}),this.pC.forceTrigger(this.mi.app.config.playerId))}iC(){const t=this._P.getMainContainer(),{topFrame:{innerHeight:i}}=(0,mt.pE)(window);if(!t)return void(0,ft.FH)({message:"Prefetch_no_container",level:"Info",sessionId:this.mi.app.config.sessionId},{pacing:1,throttle:1});const e=t.getBoundingClientRect(),s=e.top&gt;i,r=e.bottom&lt;0;if(s&amp;&amp;r)return void(0,ft.FH)({message:"Prefetch_impossible_coordinates",level:"Info",sessionId:this.mi.app.config.sessionId},{pacing:1,throttle:1});let n=0;s&amp;&amp;(n=e.top-i),r&amp;&amp;(n=e.bottom);const o=Math.round(n/i*10)/10;if(0!==o){(0,h.TF)(this.mi.app.config.sessionId,ln.B).prefetchDistance=o,(0,ft.FH)({message:`Prefetch_distance_${o}`,level:"Info",sessionId:this.mi.app.config.sessionId},{pacing:5,throttle:1})}}zL(){const t=(0,h.AU)(tt.f);this.nC=new Uh(t),this.mC=new ni,this.KL=new oi,this.vC=new ai,this.gC=new pi,this.gp=(new vi).registerCallingValidators([this.KL,this.mC,this.vC,this.gC]),this.vp=new mi;const i=(0,h.AU)(Ki.w);this._i=i.userManagerService,this.XL=new jh(this.mi.app.services.MacrosService,this._i,this.mi.app.config,this.mi.appSettings)}HL(){this.LP=new Rh,this.CP=new Fh,this.NP=new Vh,this.yM=new Nh;const{standaloneService:t,lineItemList:i,generalRepository:{openMarketRevSharePercentage:e,pmpRevSharePercentage:s}}=this.mi;this.AM=new sh(this.LP,this.CP,this.NP,this.yM,{callingValidationAggregator:this.gp,impressionCapService:this.mC,standaloneService:t},{maxNumberOfWins:-1,openMarketRevSharePercentage:e,pmpRevSharePercentage:s});const n=function(t){const i=t.filter((t=&gt;t.creativeType===r.H6.HEADER_BIDDER)).filter((t=&gt;t.advertiserLineItemId===t.publisherLineItemId)).map((t=&gt;Ii(t.prebidJsBidParamsJsonString)));return t.filter((t=&gt;{if(t.creativeType!==r.H6.HEADER_BIDDER)return!0;if(t.advertiserLineItemId===t.publisherLineItemId)return!0;const e=Ii(t.prebidJsBidParamsJsonString);return!i.includes(e)}))}(i),o=function(t){const i=t.filter((t=&gt;t.creativeType===r.H6.HEADER_BIDDER)).filter((t=&gt;t.advertiserLineItemId!==t.publisherLineItemId)).map((t=&gt;Ii(t.prebidJsBidParamsJsonString)));return[...new Set(i)]}(n),d=n.filter((t=&gt;t.isAdxAccount&amp;&amp;!t.isAdxLookup)).map((t=&gt;t.floorPrice)),{infrastructureFeeCustomer:c,servingFeeTypeCustomer:l,servingFeeCpmCustomer:u,servingFeeRevShareCustomer:p}=this.bn,v=n.map((t=&gt;new ti(t,{openMarketRevSharePercentage:e,pmpRevSharePercentage:s},{infrastructureFeeCustomer:c,servingFeeTypeCustomer:l,servingFeeCpmCustomer:u,servingFeeRevShareCustomer:p},d,this.mi.generalRepository.shouldUseNetCPM)));this.LP.add(v);const{app:{services:{ResizeObserver:m,ViewabilityService:g,GlobalDomUtilsService:f},config:{sessionId:I,canEnableAYFloorPriceService:y}}}=this.mi;this._P=new En(this.jL(),this.mi.adContainerMap,m,g,f),this.ux=new mh({globalDomUtilsService:f,recycleAdSlots:!0,sessionId:I}),this.Kk=new Qn(this._P,this.mi.generalRepository);const A=(0,h.AU)(tt.f),b=(0,h.TF)(I,"FeatureFlags");this.sC=new xh(A,{sessionId:I,adSelector:this.AM,adBidPool:this.yM,featureFlags:b,adManagerState:this.Kk,adContainer:this._P});const _=(0,h.TF)(I,a.k),x=(0,h.TF)(I,Hh);y&amp;&amp;(this.pC=(0,h.TF)(I,Yh),this.pC.forceTrigger(this.mi.app.config.playerId));const S=new yh(this.AM,_,I);this.oC=new fh(this.AM,this.yM);const{playerData:w,generalRepository:k,adContainerMap:P,amazonTamSlotId:M,app:C,appSettings:L,pbjsSchainSettings:T,skipPlayerSettings:B,disableScrollHijackEnforcement:E,pauseAdWhenFinished:D,loopAdWhenFinished:R,playerData:{plcmt:O}}=this.mi,{config:{playerId:F,isMobile:V,explorationMode:$,deviceType:N,os:{os:U}}}=C;this.eC=new Mn({playerData:w,generalRepository:k,auctionInfoLogging:S,adSelector:this.AM,adContainerMap:P,amazonSlotId:M,app:C,appSettings:L,schainSettings:T,biddersWithConnatixSchain:o,skipAdSettings:B,sessionId:I,adMacroReplacer:this.XL,lineItemServices:{lineItemServicesTimer:this.nC,requestCapsService:this.KL},adRequestGatekeeper:this.vp,standaloneService:t,adEnforcer:new Un(V,this.qL,E,I),pauseAdWhenFinished:D,loopAdWhenFinished:R,os:U,adSlotContainerRecycler:this.ux,callingValidationAggregator:this.gp,auctionManager:this.sC,adxLastLookService:this.oC,assertiveYieldService:x,assertiveYieldFloorPriceService:this.pC},_),this.rC=new gh({desiredBitRateForWins:1,playerId:F,sessionId:I,adSelector:this.AM,auctionManager:this.sC,auctionInfoLogging:S,impressionCapsTimer:this.nC,adMacroReplacer:this.XL,plcmt:O,assertiveYieldService:x,assertiveYieldFloorPriceService:this.pC,userManagerService:this._i,generalRepository:k},_);const W=(0,h.TF)(I,yt.U);this.tC=new Xn({adContainer:this._P,adSelector:this.AM,auctionInfoLogging:S,internalAuctionSnapshot:new Eh(this.AM,I),impressionCapsService:this.mC,impressionCapsTimer:this.nC,requestCapsService:this.KL,removeBidIfHigherYoScore:false,adRequestGatekeeper:this.vp,pauseAdWhenFinished:D,loopAdWhenFinished:R,adMacroReplacer:this.XL,explorationMode:$,playerId:F,skipAdSettings:B,fullSessionLog:k.canTrackAllRequests,deviceType:N,sessionId:I,adxLastLookService:this.oC,plcmt:O,userManagerService:this._i,generalRepository:k,videoAdsDurationService:W,assertiveYieldService:x,assertiveYieldFloorPriceService:this.pC},_),this.fC=new Lh(this.AM,this.ux)}GL(){this.Li.push(this.AM.getBidEvents(3).subscribe((t=&gt;{const i=this.Kk.getCurrentAdManagerState()||this.Kk.getPredictedAdManagerState();if(this.fC.refreshImaSlots(i),t.settings.adManagerLineItem.protoLineItem.publisherLineItemId===O){const e=t.getAdDuration(),s=i.adBreakState.remainingAdDuration;if(!(e&lt;=s)){const r={duration:e,maxAllowedDuration:s,isPod:!!(t.adPodInfo&amp;&amp;t.adPodInfo.totalAds&gt;1),isFetch:this.Kk.adFetchingAllowed,isImp:this.Kk.impressionsAllowed,auction:`${i.auctionEndType}`};(0,ft.FH)({message:"AdManager_Fbs_Duration",exception:"info",level:"Info",sessionId:this.mi.app.config.sessionId,callStack:"",durationLogs:r},{throttle:Number.POSITIVE_INFINITY,shouldSendMaxLog:!1})}}})))}JL(){this.Li.push(this.rc.onLineItemPlatformCapped.subscribe((t=&gt;{this.Wa(t)})),this.rc.onImpressionRevenue.subscribe((t=&gt;{this.Ya(t)})),this.rc.onLineItemViewabilityChange.subscribe((([t,i])=&gt;{this.$L(t,i)})))}YL(){this.Li.push(this.eC.onLineItemsRequestStart.subscribe((t=&gt;{this.CP.add(t)})),this.eC.onLineItemsRequestEnd.subscribe((t=&gt;{this.dC(t)})),this.cs.onBidFetchStart.subscribe((t=&gt;{this.NP.add(t)})),this.cs.onBidFetchEnd.subscribe((t=&gt;{this.NP.remove(t)})),this.eC.onBid.subscribe((t=&gt;{this.yM.addBid(t)})),this.sC.onAuctionEnd.subscribe((t=&gt;{this.yk(t.type,t.auctionId)})),this.sC.onAuctionStopCalling.subscribe((()=&gt;{this.IC()})),this._P.onContainerStateUpdate.subscribe((()=&gt;{this.sw()})),this.tC.onAdSelected.subscribe((t=&gt;{this.Qw(t)})),this.tC.onAdFinished.subscribe((t=&gt;{this.Zw()})))}cC(t){switch(t){case"prefetched":return 3;case"short":return 2;case"timeout":return this.AM.hasLoadedBids()?0:1;default:return}}IC(){this.Kk.predictMode&amp;&amp;this.eC.stop(),this.Kk.auctionStopCalling()}Qw(t){const{currentAdPlayerState:i,predictedAdPlayerState:e}=this.Kk,s=(i||e).vastViewMode,r=this.Kk.getCurrentAdManagerState()||this.Kk.getPredictedAdManagerState(),n=r.adBreakState.maxAdDuration,{skipPlayerSettings:h,loopAdWhenFinished:o,pauseAdWhenFinished:a,generalRepository:d,app:{config:{sessionId:c}},playerData:{plcmt:l}}=this.mi;this.UL=new Ch(t,this._P,this.cs,r,{adViewMode:s,maxAdDuration:n,skipAdSettings:h,loopAdWhenFinished:o,pauseAdWhenFinished:a,sessionId:c,plcmt:l},d),this.AC();const u=i||e;this.UL.setAdVolume(u.sound);const p=t.settings.adLoadedPayload.payload.vastVerifications;(0,ot.BZ)(p)&amp;&amp;this.Sp.isOmsdkFullSupport&amp;&amp;this.Sp.addVerificationNode(p,t.settings.adLoadedPayload.payload.containers),this.yC(t)}yC(t){var i;this.Dv.next({type:ct.f.AdLoaded,payload:null===(i=t.settings.adLoadedPayload)||void 0===i?void 0:i.payload})}Zw(){this.Sp.clearPendingProcesses(),this.hC()}WL(){this.Kk.adFetchingAllowed&amp;&amp;this.ZL(),this.Kk.impressionsAllowed&amp;&amp;this.lC()}lC(){(this.Kk.currentAdPlayerState||this.Kk.predictedAdPlayerState)&amp;&amp;this.Kk.currentAdPlayerState&amp;&amp;this.tC.start(this.Kk.getCurrentAdManagerState())}AC(){this._C=this.UL.onVpaidEvent.subscribe((t=&gt;{var i;if(t.type===ct.f.AdImpression)try{const t=(null===(i=this.Kk.getCurrentAdManagerState())||void 0===i?void 0:i.soundVolume)||0;this.UL.setAdVolume(t)}catch(t){const{message:i,stack:e}=(0,mt.W$)(t);(0,ft.FH)({level:"Warn",message:"AdManager_current_sound",exception:i,callStack:e,sessionId:this.mi.app.config.sessionId})}this.Dv.next(t)}))}hC(){var t;null===(t=this.UL)||void 0===t||t.destroy(),this.UL=null,this.aC()}aC(){var t;null===(t=this._C)||void 0===t||t.unsubscribe(),this._C=null}QL(t){const i=[this.mC,this.KL];t.newContent&amp;&amp;i.forEach((t=&gt;{t.resetCapsBasedOnExternalEvent(r.yX.CONTENT_CAPPING)}))}}class Qh extends Xh{constructor(t,i,e){if(super(t,i,e),this.bC="",this.SC=[],this.wC="",this.yk=(t,i)=&gt;{this.PC()||this.FL.next(),i!==this.bC?super.yk(t):this.MC({success:!0})},this.MC=()=&gt;{},this.kC=()=&gt;{},!t.disableImaAdSlotsPreload){const i=this._P.getMainContainer();this.ux.preloadImaSdkSlots(i),t.lineItemList.some((t=&gt;t.isAdxLookup))&amp;&amp;this.ux.preloadImaSdkAdxLookupSlot(i)}this.Li.push(this.cs.adBid.subscribe((t=&gt;{this.xC(t.bidTracking)})),this.cs.adPrebid.subscribe((t=&gt;{this.LC(t)})),this.AM.getBidEvents(6).subscribe((()=&gt;{this.PC()||this.FL.next()})))}enableImpressions(t){super.enableImpressions(t);const i=this.Kk.getCallSettings();this.sC.startAuction(i,t.linearAdOpportunity.id,t.adBreakState.adBreakTimeoutDuration)}disableImpressions(t=!1){(this.Kk.impressionsAllowed||t)&amp;&amp;(this.sC.cancelAuction(),super.disableImpressions(t))}setLineItemMetadata(t,i,e){const s=this.LP.getByPublisherLineItemId(t.id),r=this.CC(s,t,i);(0,W.mf)(e)&amp;&amp;(t.shouldCallAdWithUprKey?this.TC(s,i,e):e(r))}startConnatixAuction(t,i){this.MC=i,this.Kk.enablePredict(t,2);const e=this.Kk.getCallSettings();this.bC=(0,mt.qs)(),this.sC.startCustomAuction(e,this.bC,t.linearAdOpportunity.id),this.ZL()}ZL(){const t=this.Kk.getCallSettings();this.sC.updateState(t),super.ZL()}jL(){return r.Z9.VIDEO_VIDEO}TC(t,i,e){this.kC=e;const s=this.Kk.getAdManagerState(i,this._P.getContainerStateMap());s?this.oC.forceCallAdxLookup(t,s):this.kC({success:!1,errorReason:"Ad can not be called do to no player state"})}xC(t){if(t.advertiserLineItemId===this.wC){if(!this.rC.hasStarted())return void this.kC({success:!0});this.SC.push(this.yM.getEvents(3).subscribe((t=&gt;{t.settings.adManagerLineItem.protoLineItem.advertiserLineItemId===this.wC&amp;&amp;(this.kC({success:!0}),(0,o.i)(this.SC))})))}}LC(t){t.advertiserLineItemId===this.wC&amp;&amp;this.kC({success:!0})}CC(t,i,e){try{if(!(0,W.$K)(t))return{success:!1,errorReason:"No line item"};if(t.protoLineItem.isAdxExternalLookup=!1,!t.protoLineItem.isExternal)return{success:!1,errorReason:"Only js api defined creatives can be updated"};if(!this.BC(i,t))return{success:!1,errorReason:"Metadata invalid"};if(this.yM.getBidsByStatus([kt.STARTING,kt.IMPRESSION]).some((i=&gt;i.settings.adManagerLineItem===t)))return{success:!1,errorReason:"Ad already started"};if(t.updateMetadata(i),this.EC(i.id),this.DC(t),this.RC(t),i.shouldCallAdWithUprKey){t.protoLineItem.isAdxExternalLookup=!0;const s=this.Kk.getAdManagerState(e,this._P.getContainerStateMap()),r=s?this.AM.getBestAllowedBidPricePubNET(s):0;if(r){const e=i.adxKeyValueSetup;t.protoLineItem.adTag=this.OC(t.protoLineItem.adTag,r,e)}this.wC=i.id}return{success:!0}}catch(t){return{success:!1,errorReason:"The line item could not be updated"}}}OC(t,i,e){let s=Pr((0,gt.Ph)("cust_params",t),i,e);try{s=encodeURIComponent(s)}catch(i){return t}return(0,gt.Bp)(t,"cust_params",s)}RC(t){this.NP.bidInFetchList.filter((i=&gt;i.adManagerLineItem===t)).forEach((t=&gt;{t.shouldBeDiscarded=!0}))}BC(t,i){const{adTag:e,resetCapType:s,requestCap:n,impressionCap:h,resetRequestCapTimeSeconds:o,resetImpressionCapTimeSeconds:a}=Qt(t,i.protoLineItem);return!(!(0,W.QM)(e)&amp;&amp;!(0,W.QM)(t.vastXml)||!(0,W.$K)(s))&amp;&amp;(!(s===r.yX.OPPORTUNITY_CAPPING&amp;&amp;!(0,W.Xc)(n))&amp;&amp;(!(s!==r.yX.OPPORTUNITY_CAPPING&amp;&amp;!(0,W.r)(n)&amp;&amp;!(0,W.r)(h))&amp;&amp;!!this.FC(s,n,h,o,a)))}FC(t,i,e,s,n){return t!==r.yX.TIME_CAPPING||!((0,W.r)(i)&amp;&amp;!(0,W.Xc)(s))&amp;&amp;!((0,W.r)(e)&amp;&amp;!(0,W.Xc)(n))}DC(t){[this.mC,this.KL].forEach((i=&gt;{i.resetCapsOnLineItemMetadataUpdate(t)}))}EC(t){this.yM.getBidsByLineItemId(t).forEach((t=&gt;{t.invalidate()}))}PC(){const t=this.Kk.getCurrentAdManagerState()||this.Kk.getPredictedAdManagerState(),i=this.AM.getBestBidAllowed(t);return(0,W.$K)(i)}}class Kh extends Xh{enableImpressions(t){super.enableImpressions(t),this.yk()}jL(){return r.Z9.VIDEO_NON_LINEAR}}class Zh{constructor(t,i){this.VC=t,this.NC=i,this.$C=new s.x,this.Li=[],this.UC=!1;const e=(0,h.AU)(tt.f);this.$f=new _s.B(e),this.WC(),this.h_(),this.jC()}get onAdLifeEnding(){return this.$C.asObservable()}isDurationExpired(){return this.UC}destroy(){this.$f.disable(),this.Li.forEach((t=&gt;t.unsubscribe()))}WC(){this.Li.push(this.$f.onTimeElapsed.subscribe((()=&gt;{this.$f.stop(),this.UC=!0,this.$C.next()})))}h_(){this.Li.push(this.VC.subscribe((t=&gt;{switch(t.type){case ct.f.AdImpression:this.qC(t.payload.adSourceData.length);break;case ct.f.AdPlaying:this.jC();break;case ct.f.AdPaused:this.lu();break;case ct.f.AdStopped:case ct.f.AdSkipped:case ct.f.AdError:this.zC();break;case ct.f.AdVideoFirstQuartile:this.HC()}})))}lu(){this.$f.stop()}jC(){this.$f.start()}qC(t){if(this.GC=Date.now(),t){this.mA=t*ri.s_;const i=this.mA-this.NC;this.JC(i),this.$f.start()}}zC(){this.$f.stop(),this.UC=!1}HC(){if(this.mA)return;const t=Date.now()-this.GC;this.mA=4*t;const i=this.mA-t-this.NC;this.JC(i)}JC(t){const i=t&lt;0?0:t;this.$f.reset(i)}}class to{constructor(t,i,e,r){this.iw=t,this.vt=i,this.lI=e,this.YC=new s.x,this.XC=new s.x,this.KC=0,this.QC=r===St.ZA.SCROLL_TO_PLAY}get prefetchType(){return this.KC}get startSessionPrefetch(){return this.QC}get onMidSessionPrefetchReady(){return this.YC.asObservable()}get onPrefetchStart(){return this.XC.asObservable()}set startSessionPrefetch(t){this.QC=t}enablePrefetch(t,i,e){this.QC=!1,this.KC=t,this.XC.next(),null==e||e.enablePredict(i,t)}observeOutOfViewDistance(t,i,e,s){if(2===this.vt.getIframeMode())return void this.enablePrefetch(t,i,s);this.iw.observeOutOfViewDistance(e,1*this.vt.getViewportHeight(),(()=&gt;{this.iw.disconnectOutOfViewObserver(),this.enablePrefetch(t,i,s)}))}disablePrefetch(){this.KC=0}tryPreparingMidSessionPrefetch(t,i){if(!this.ZC(t))return;2===(null==t?void 0:t.disableReason)&amp;&amp;this.tT(t,i)&amp;&amp;this.YC.next(2)}ZC(t){return 0===this.KC&amp;&amp;null!==t&amp;&amp;t.adBreakLength!==Number.POSITIVE_INFINITY}tT(t,i){return i&amp;&amp;t.adBreakLength&lt;=1e4&amp;&amp;!this.lI}}class io{constructor(t,i,e,r){this.iw=t,this.vt=i,this.mi={[n.k.LINEAR]:{enable:!1,disablePayload:null,usePrefetch:!0},[n.k.NONLINEAR]:{enable:!1,disablePayload:null,usePrefetch:!1}},this.YC=new s.x,this.XC=new s.x,this.Li=[],this.eT(e,r)}get onMidSessionPrefetchReady(){return this.YC.asObservable()}get onPrefetchStart(){return this.XC.asObservable()}getAllLinearityKeys(){return Object.keys(this.mi)}enable(t){this.mi[t].enable=!0,this.mi[t].disablePayload=null}disable(t,i){this.mi[t].enable=!1,this.mi[t].disablePayload=i}getDisablePayload(t){return this.mi[t].disablePayload}setAdManager(t,i){this.mi[t].adManager=i,this.mi[t].usePrefetch&amp;&amp;(this.mi[t].adLifecycleObserver=new Zh(i.onVpaidEvent,1e4),this.Li.push(this.mi[t].adLifecycleObserver.onAdLifeEnding.subscribe((()=&gt;{const i=this.getDisablePayload(t),e=this.mi[t].adLifecycleObserver.isDurationExpired();this.mi[t].adPrefetch.tryPreparingMidSessionPrefetch(i,e)}))))}isAdManagerEnable(t){return this.mi[t].enable}getAllAdManagers(){return this.getAllLinearityKeys().map((t=&gt;this.mi[t].adManager))}getAllAvailableAdManagers(){return this.getAllAdManagers().filter((t=&gt;(0,W.$K)(t)))}getAdManagerByLinearity(t){return this.mi[t].adManager}usePrefetch(t){return this.mi[t].usePrefetch}enablePrefetch(t,i,e,s){this.usePrefetch(t)&amp;&amp;this.mi[t].adPrefetch.enablePrefetch(i,e,s)}observeOutOfViewDistance(t,i,e,s,r){this.usePrefetch(t)&amp;&amp;this.mi[t].adPrefetch.observeOutOfViewDistance(i,e,s,r)}startSessionPrefetch(t,i){this.mi[t].adPrefetch.startSessionPrefetch=i}disablePrefetch(t){this.usePrefetch(t)&amp;&amp;this.mi[t].adPrefetch.disablePrefetch()}getPrefetchType(t){if(this.usePrefetch(t))return this.mi[t].adPrefetch.prefetchType}hasStartSessionPrefetch(t){return!!this.usePrefetch(t)&amp;&amp;this.mi[t].adPrefetch.startSessionPrefetch}tryPreparingMidSessionPrefetch(t,i){var e;if(!this.usePrefetch(t))return;const s=(null===(e=this.mi[t].adLifecycleObserver)||void 0===e?void 0:e.isDurationExpired())||!1;this.mi[t].adPrefetch.tryPreparingMidSessionPrefetch(i,s)}destroy(){(0,o.i)(this.Li),this.getAllAvailableAdManagers().forEach((t=&gt;t.destroy()))}eT(t,i){this.getAllLinearityKeys().forEach((e=&gt;{this.mi[e].usePrefetch&amp;&amp;(this.mi[e].adPrefetch=new to(this.iw,this.vt,t,i),this.iT(e))}))}iT(t){const i=this.mi[t].adPrefetch;this.Li.push(i.onMidSessionPrefetchReady.subscribe((i=&gt;{this.YC.next({prefetchType:i,linearity:n.k[t]})})),i.onPrefetchStart.subscribe((()=&gt;{this.XC.next()})))}}const eo=t=&gt;{const{payload:{adType:i,adSkipMode:e,adLoadedData:{skipOffset:s}}}=t;return{payload:{adType:i,adSkipMode:e,adLoadedData:{skipOffset:s}}}},so=(t,i,e)=&gt;{const{payload:{adType:s,adSkipMode:r,clickThroughUrl:n,customAdData:h,adSourceData:{adId:o,adVideoUrl:a,creativeId:d,name:c,length:l,imaMetadata:u}}}=t;return{payload:{adType:s,adBreakType:e,adSkipMode:r,adSourceData:{adId:o,length:l,imaMetadata:u,adVideoUrl:a,creativeId:d,name:c},clickThroughUrl:n,customAdData:{ADVERTISER:null==h?void 0:h.ADVERTISER,CAMPAIGN_ID:null==h?void 0:h.CAMPAIGN_ID,CREATIVE_ID:h.CREATIVE_ID},adDuration:l,selectedAdSlot:i}}},ro=t=&gt;({payload:{adType:t.payload.adType}});var no=e(3203),ho=e(9395),oo=e(2295);class ao{constructor(t,i,e,r,h){this.$r=t,this.rT=i,this.nT=e,this.oT=r,this.aT=h,this.Li=[],this.hT=new s.x,this.dT=new s.x,this.cT=new s.x,this.lT=new s.x,this.uT=new s.x,this.pT=new s.x,this.mT=new s.x,this.vT=new s.x,this.XC=new s.x,this.gT=new Map,this.wx=[],this.fT=!0,this.IT=!1,this.AT=!0,this.yT={[n.k.LINEAR]:(t,i)=&gt;{const e=new Qh(t,t.trackingResponseService,i);this.mi.setAdManager(n.k.LINEAR,e)},[n.k.NONLINEAR]:(t,i)=&gt;{const e=new Kh(t,t.trackingResponseService,i);this.mi.setAdManager(n.k.NONLINEAR,e)}};const{playerData:{inFloating:o},queryJsTargeting:a,viewabilityService:d,globalDomUtilsService:c,loopAdWhenFinished:l,adPlaybackMode:u,canPrefetchBeforePreroll:p}=this.$r;this.Mn={mediaMetadata:{},clickToPlay:!1,linearAdOpportunity:new no.q,newContent:!1,sound:0,vastViewMode:"normal",adBreakState:this.nT.getAdBreakState(),playerOrientation:this.rT,inFloating:o,queryJsTargeting:a},this.mi=new io(d,c,l,u),this.fT=p}get onLinearNoFill(){return this.vT.asObservable()}get onAdsEnable(){return this.hT.asObservable()}get onLinearVpaidEvent(){return this.dT.asObservable()}get onNonlinearVpaidEvent(){return this.cT.asObservable()}get onLinearImpressionRevenue(){return this.lT.asObservable()}get onNonlinearImpressionRevenue(){return this.uT.asObservable()}get onLinearImpressionPrice(){return this.pT.asObservable()}get onNonlinearImpressionPrice(){return this.mT.asObservable()}get onPrefetchStart(){return this.XC.asObservable()}hasAdsEligibleForFill(){var t;return Boolean(null===(t=this.mi.getAdManagerByLinearity(n.k.LINEAR))||void 0===t?void 0:t.hasAdsEligibleForFill(this.Mn))}getLineItems(){return this.wx}getCurrentAdBreakType(){return this.Mn.adBreakState.adBreakType}canPrefetchAds(t){const i=this.mi.getAdManagerByLinearity(t);this._T(t,1,i)}initAd(t,i,e,s,r,h,o){this.bT(h),this.ST(o),this.mi.getAllLinearityKeys().forEach((t=&gt;{this.wT(n.k[t],{sound:r})})),this.Li.push(this.nT.onAdBreakRemainingTimeUpdate.subscribe((()=&gt;{this.wT(n.k.LINEAR,{adBreakState:this.nT.getAdBreakState()})})))}getNewLinearAdOpportunity(){return 0!==this.mi.getPrefetchType(n.k.LINEAR)||this.IT?this.Mn.linearAdOpportunity:new no.q}getAdContainerSize(t){const i=this.gT.get(t);return{height:(null==i?void 0:i.clientHeight)||0,width:(null==i?void 0:i.clientWidth)||0}}getMainAdContainerWidth(t){var i;return null===(i=this.mi.getAdManagerByLinearity(t))||void 0===i?void 0:i.getMainContainerState().width}getCurrentAdMetadata(t){var i;return null===(i=this.mi.getAdManagerByLinearity(t))||void 0===i?void 0:i.getCurrentAdMetadata()}getCurrentAdMediaSize(t){var i;return null===(i=this.mi.getAdManagerByLinearity(t))||void 0===i?void 0:i.getCurrentAdMediaSize()}isAdInWin(t){const i=this.mi.getAdManagerByLinearity(t);return(null==i?void 0:i.isLoadingAds())||!1}enableAds(t){this.IT=!1,this.mi.enable(t),this.wT(t),this.hT.next(t)}disableAds(t,i){this.mi.disable(t,i);const e=this.mi.getAdManagerByLinearity(t);if(!e)return;const s=4===(null==i?void 0:i.disableReason);e.disableImpressions(s),4!==(null==i?void 0:i.disableReason)&amp;&amp;1!==i.disableReason&amp;&amp;this.mi.usePrefetch(t)&amp;&amp;this.mi.tryPreparingMidSessionPrefetch(t,i)}disableAdvertising(){this.AT=!1}enableAdvertising(){this.AT=!0,this.mi.getAllLinearityKeys().forEach((t=&gt;{const i=n.k[t];this.enablePrefetchForLinearity(i)}))}setAdVolume(t,i){var e;null===(e=this.mi.getAdManagerByLinearity(t))||void 0===e||e.setAdVolume(i),this.wT(t,{sound:i})}pauseAd(t,i){var e;null===(e=this.mi.getAdManagerByLinearity(t))||void 0===e||e.pauseAd(i)}resumeAd(t,i){var e;null===(e=this.mi.getAdManagerByLinearity(t))||void 0===e||e.resumeAd(i)}skipAd(t){var i;null===(i=this.mi.getAdManagerByLinearity(t))||void 0===i||i.skipAd()}stopAd(t,i){var e;null===(e=this.mi.getAdManagerByLinearity(t))||void 0===e||e.stopAd(i)}onAdStateChange(t,i,e){const s=ho.H[i],r=ho.H[e];this.PT(t,s),this.MT(t,s,r),s===St.cr.PRE_ROLL&amp;&amp;(this.fT=!0)}onContentChange(){this.mi.getAllLinearityKeys().forEach((t=&gt;{this.wT(n.k[t],{newContent:!0})}))}setMediaRestrictions(t){const i=Object.assign(this.Mn.mediaMetadata,t);this.mi.getAllLinearityKeys().forEach((t=&gt;{const e=n.k[t];this.wT(e,{mediaMetadata:i})}))}userInteraction(){this.mi.getAllLinearityKeys().forEach((t=&gt;{this.wT(n.k[t],{clickToPlay:!0})}))}setPlayerOrientation(t){this.Mn.playerOrientation=t,this.mi.getAllAvailableAdManagers().forEach((i=&gt;i.setPlayerOrientation(t)))}updateJsQueryTargeting(t){this.Mn.queryJsTargeting=(0,xe.S1)(this.Mn.queryJsTargeting,t),this.kT()}removeJsQueryTargeting(t){this.Mn.queryJsTargeting=(0,xe.G_)(this.Mn.queryJsTargeting,t),this.kT()}setVastViewMode(t){this.xT({vastViewMode:t})}newLinearAdOpportunity(t){const i=n.k.LINEAR;this.mi.usePrefetch(i)&amp;&amp;(this.Mn.linearAdOpportunity=t,this.Mn.linearAdOpportunity.timestamp=Date.now(),this.wT(i,{linearAdOpportunity:this.Mn.linearAdOpportunity}),this.mi.disablePrefetch(i))}inFloatingChanged(t){this.Mn.inFloating=t}setCustomMacros(t){this.mi.getAllAvailableAdManagers().forEach((i=&gt;i.setCustomMacros(t)))}setLineItemMetadata(t,i){var e;const s=this.mi.getAdManagerByLinearity(n.k.LINEAR);(0,W.$K)(s)?null===(e=s.setLineItemMetadata)||void 0===e||e.call(s,t,this.Mn,i):i({success:!1,errorReason:"Ad manager not initialized"})}startConnatixAuction(t){var i;const e=this.mi.getAdManagerByLinearity(n.k.LINEAR);(0,W.$K)(e)?(this.Mn.linearAdOpportunity=new no.q,this.IT=!0,null===(i=e.startConnatixAuction)||void 0===i||i.call(e,this.Mn,t)):t({success:!1})}destroy(t){try{(0,o.i)(this.Li),this.mi.destroy()}catch(i){const{message:e,stack:s}=(0,mt.W$)(i);(0,ft.FH)({message:"AdManagerBridge_destroy",level:"Warn",exception:e,callStack:s,sessionId:t})}}enablePrefetchForLinearity(t){if(this.mi.usePrefetch(t)&amp;&amp;this.mi.hasStartSessionPrefetch(t)){const i=this.mi.getAdManagerByLinearity(t);this._T(t,1,i)}}startPrefetchForLinearity(t,i){const e=this.mi.getAdManagerByLinearity(t);1!==i?this._T(t,2,e):this.mi.hasStartSessionPrefetch(t)&amp;&amp;this._T(t,1,e)}CT(t){var i;return Boolean(null===(i=this.mi.getAdManagerByLinearity(t))||void 0===i?void 0:i.isCurrentAdInImpression())}kT(){this.mi.getAllAvailableAdManagers().forEach((t=&gt;t.setQueryJsTargeting(this.Mn.queryJsTargeting)))}bT(t){t.forEach((t=&gt;{this.gT.set(t.type,t.container)}))}MT(t,i,e=St.cr.AD_BREAK_TYPE_UNSPECIFIED){const s=e===St.cr.PRE_ROLL&amp;&amp;i===St.cr.MID_ROLL;this.wT(t,{adBreakState:this.nT.getAdBreakState()},s)}PT(t,i){this.Mn.adBreakState.adBreakType===i||this.CT(t)||this.stopAd(t,"AdBreakTypeChanged")}wT(t,i,e=!1){this.xT(i);const s=this.mi.getAdManagerByLinearity(t),r=null==s?void 0:s.hasUnstartedBids();if(e&amp;&amp;!r&amp;&amp;this.mi.disable(n.k.LINEAR,{disableReason:1}),s&amp;&amp;this.mi.isAdManagerEnable(t)){if(this.mi.usePrefetch(t)){const i=!1;this.mi.startSessionPrefetch(t,i)}if(t===n.k.NONLINEAR){const t=Object.assign(Object.assign({},this.Mn.adBreakState),{remainingAdDuration:0});s.enableImpressions(Object.assign(Object.assign({},this.Mn),{adBreakState:t}))}else s.enableImpressions(this.Mn);this.TT()}}xT(t){Object.assign(this.Mn,t),this.Mn.adBreakState=this.nT.getAdBreakState()}TT(){this.xT({clickToPlay:!1,newContent:!1})}_T(t,i,e){if(!this.fT||!this.AT||!this.oT&amp;&amp;this.$r.disableAdsInBackground)return;this.IT||(this.Mn.linearAdOpportunity=new no.q);const s=this.$r.viewabilityService.check({element:this.aT,threshold:.1});1!==i||s?this.mi.enablePrefetch(t,i,this.Mn,e):this.mi.observeOutOfViewDistance(t,i,this.Mn,this.aT,e)}BT(t,i,e){const s=(0,h.TF)(e.config.sessionId,oo.j),r=(0,h.TF)(e.config.sessionId,a.k),{playerData:n,generalRepository:o,standaloneService:d,amazonTamSlotId:c,prebidJsSupplyChain:l,skipPlayerSettings:u,disableScrollHijackEnforcement:p,pauseAdWhenFinished:v,loopAdWhenFinished:m,appSettings:g,disablePrefetch:f,disableImaAdSlotsPreload:I}=this.$r,y={playerData:n,generalRepository:o,standaloneService:d,trackingResponseService:s,lineItemList:i,adBreakHelper:this.nT,adContainerMap:this.gT,amazonTamSlotId:c,pbjsSchainSettings:l,skipPlayerSettings:u,disableScrollHijackEnforcement:!p,pauseAdWhenFinished:v,loopAdWhenFinished:m,app:e,appSettings:g,disablePrefetch:f,disableImaAdSlotsPreload:I};(0,this.yT[t])(y,r),this.Li.push(this.mi.onMidSessionPrefetchReady.subscribe((i=&gt;{const{linearity:e,prefetchType:s}=i,r=this.mi.getAdManagerByLinearity(e);this._T(t,s,r)})),this.mi.onPrefetchStart.subscribe((()=&gt;{this.XC.next()})))}ET(t,i){const e=this.mi.getAdManagerByLinearity(t);e&amp;&amp;this.Li.push(e.onVpaidEvent.subscribe((e=&gt;{var s,r,n;switch(e.type){case ct.f.AdLoaded:i.next({type:ct.f.AdLoaded,payload:eo(e)});break;case ct.f.AdImpression:{const n=null===(r=null===(s=this.mi.getAdManagerByLinearity(t))||void 0===s?void 0:s.getCurrentAdMetadata())||void 0===r?void 0:r.adType,h=this.gT.get(n),o=this.getCurrentAdBreakType();i.next({type:ct.f.AdImpression,payload:so(e,h,o)});break}case ct.f.AdVideoStart:case ct.f.AdError:i.next(e);break;case ct.f.AdClickThru:i.next({payload:{payload:{clickThru:e.adClickThru,adType:null===(n=e.payload)||void 0===n?void 0:n.adType}},type:e.type});break;default:i.next({type:e.type,payload:ro(e)})}})))}ST(t){const i=(0,h.TF)(t.config.sessionId,"MonetizationService");this.Li.push(i.onLineItemsReceived.subscribe((i=&gt;{const e=i.get(this.$r.generalRepository.playerId);this.wx=e,(0,ot.BZ)(e)&amp;&amp;(e.some((t=&gt;t.advertiserLineItemId===F))&amp;&amp;(0,ft.FH)({message:"Sovrn_AdGenerator_Served",level:"Info"},{pacing:5}),this.DT(n.k.NONLINEAR,e,t,this.cT),this.DT(n.k.LINEAR,e,t,this.dT))})))}DT(t,i,e,s){const r=(0,cn.mn)(i,t);(0,ot.BZ)(r)&amp;&amp;!(0,W.$K)(this.mi.getAdManagerByLinearity(t))&amp;&amp;(this.BT(t,r,e),this.ET(t,s),this.RT(t))}RT(t){if(t!==n.k.LINEAR){if(t===n.k.NONLINEAR){const i=this.mi.getAdManagerByLinearity(t);i&amp;&amp;this.Li.push(i.onImpressionRevenueEvent.subscribe((t=&gt;{this.uT.next(t),this.mT.next(t.impressionRevenue)})))}}else{const i=this.mi.getAdManagerByLinearity(t);i&amp;&amp;this.Li.push(i.onImpressionRevenueEvent.subscribe((t=&gt;{this.lT.next(t),this.pT.next(t.impressionRevenue)})),i.onNoFill.subscribe((()=&gt;{this.vT.next()})))}}}class co extends d{jG(){const{playbackMode:t,soundMode:i,floatingSettings:{hasFloatingCapability:e},videoPlacement:s}=this.$r,r={isOutstream:this.$r.isOutStreamType(),playbackMode:t,initialSoundMode:i,hasFloatingCapability:e,inFloating:this.UE,plcmt:s,liveRampPubId:this.ls.liveRampPubId};if(!(0,W.$K)(this.mp.services.ViewabilityService))throw new Error("ElementsAdHandler_viewabilityService_is_undefined");if(!(0,W.$K)(this.mp.services.GlobalDomUtilsService))throw new Error("ElementsAdHandler_globalDomUtilsService_is_undefined");const{pauseAdWhenFinished:n,loopAdWhenFinished:h,skipAdAfter:o,skipMin:a,skippability:d,adPlaybackMode:c,amazonTamSlotId:l,supplyChainSettings:u,disablePrefetch:p,disableAdsInBackground:v,prefetchOnPreroll:m,queryJsTargeting:g,disableImaAdSlotsPreload:f,disableScrollHijackEnforcement:I}=this.$r,{services:{ViewabilityService:y,GlobalDomUtilsService:A,StandaloneService:b}}=this.mp,_={playerData:r,appSettings:this._appSettings,generalRepository:this.ls,viewabilityService:y,globalDomUtilsService:A,standaloneService:b,pauseAdWhenFinished:n,loopAdWhenFinished:h,skipPlayerSettings:{skipAdAfter:o,skipMin:a,skippability:d},adPlaybackMode:c,amazonTamSlotId:l,prebidJsSupplyChain:u,disablePrefetch:p,disableAdsInBackground:v,canPrefetchBeforePreroll:m,queryJsTargeting:g,disableImaAdSlotsPreload:f,disableScrollHijackEnforcement:I};return new ao(_,this.rT,this.nT,this.oT,this.aT)}OX(t){return new At(this.$r,this.aT,this.oT,this.nT,this.mp,this.Lg,this.rT,this.qc,t,this.ls)}XQ(t){return new xt(this.$r,this.aT,this.oT,this.nT,this.mp,this.Lg,this.rT,this.qc,t,this.ls)}}var lo=e(2282);class uo extends co{constructor(){super(...arguments),this.c5=[],this.enterFullScreen=()=&gt;{this.$G.enterFullScreen().then().catch((t=&gt;{(0,ft.FH)({level:"Warn",message:"OutstreamAdHandler_enterFullscreen",sessionId:this.$r.sessionId})}))},this.exitFullscreen=()=&gt;{this.$G.exitFullScreen()},this.eq=()=&gt;{const{services:{InteractionService:t,EventsStorageService:i}}=this.mp;t.enableScrollEvent(),i.emitOnExitFullscreen(),this.linearAdUserInterface.collapse(),this.setVastViewMode("normal")},this.sq=()=&gt;{const{services:{InteractionService:t,EventsStorageService:i}}=this.mp;t.disableScrollEvent(),i.emitOnEnterFullscreen(),this.linearAdUserInterface.expand(),this.setVastViewMode("fullscreen")}}initFullScreen(){this.$G=new lo.I(this.mp.services.GlobalDomUtilsService,this.XZ.parentElement,this.mp.config.os.os),this._J()}destroy(){super.destroy(),(0,o.i)(this.c5)}q3(){return!1}_J(){this.c5.push(this.onFullcreenChange.subscribe((t=&gt;{t===q.C.Expand?this.enterFullScreen():this.exitFullscreen()}))),this.bJ()}bJ(){const t=this.$G.onFullScreenEnter.subscribe((()=&gt;this.sq())),i=this.$G.onFullScreenExit.subscribe((()=&gt;this.eq()));this.c5.push(i,t)}}const po="cnx-ad-video-size-slot";class vo extends It{updateContinueReadingCard(){const t=this.qc.getCurrentAdMediaSize(n.k.LINEAR);(0,W.$K)(t)&amp;&amp;(this.q3(t)?this.R3.showContinueReadingCard(this._P):this.R3.hideContinueReadingCard(this._P))}F3(){super.F3(),this.l5()}K3(t){super.K3(t),t===this.d0&amp;&amp;(0,U.cn)(this.aT,"cnx-in-ad-full")}i5(){super.i5(),this.qc.userInteraction()}r5(){return!1}l5(){this.d0=this.Z3(po),this.t5(this.d0),this.A3.push(this.d0)}}class mo extends d{jG(){const{playbackMode:t,soundMode:i,floatingSettings:{hasFloatingCapability:e},videoPlacement:s}=this.$r,r={isOutstream:!1,playbackMode:t,initialSoundMode:i,hasFloatingCapability:e,inFloating:this.UE,plcmt:s,liveRampPubId:this.ls.liveRampPubId};if(!(0,W.$K)(this.mp.services.ViewabilityService))throw new Error("PlayspaceAdHandler_viewabilityService_is_undefined");if(!(0,W.$K)(this.mp.services.GlobalDomUtilsService))throw new Error("PlayspaceAdHandler_globalDomUtilsService_is_undefined");const{pauseAdWhenFinished:n,loopAdWhenFinished:h,skipAdAfter:o,skipMin:a,skippability:d,adPlaybackMode:c,amazonTamSlotId:l,supplyChainSettings:u,disablePrefetch:p,disableAdsInBackground:v,queryJsTargeting:m,disableScrollHijackEnforcement:g}=this.$r,{services:{ViewabilityService:f,GlobalDomUtilsService:I,StandaloneService:y}}=this.mp,A={playerData:r,appSettings:this._appSettings,generalRepository:this.ls,viewabilityService:f,globalDomUtilsService:I,standaloneService:y,pauseAdWhenFinished:n,loopAdWhenFinished:h,skipPlayerSettings:{skipAdAfter:o,skipMin:a,skippability:d},adPlaybackMode:c,amazonTamSlotId:l,prebidJsSupplyChain:u,disablePrefetch:p,disableAdsInBackground:v,queryJsTargeting:m,canPrefetchBeforePreroll:!0,disableScrollHijackEnforcement:g};return new ao(A,this.rT,this.nT,this.oT,this.aT)}w0(t,i){return[{container:this.XZ,width:this.XZ.offsetWidth,height:this.XZ.offsetHeight,type:r.Z9.VIDEO_OVERLAY},{container:this.d0,width:this.d0.offsetWidth,height:this.d0.offsetHeight,type:r.Z9.VIDEO_VIDEO}]}OX(t){return new vo(this.$r,this.aT,this.oT,this.nT,this.mp,this.Lg,this.rT,this.qc,t,this.ls)}XQ(){}}},6240:(t,i,e)=&gt;{e.d(i,{U:()=&gt;f});var s=e(7582),r=e(6716),n=e(2134),h=e(1816),o=e(6468),a=e(6990),d=e(6982),c=e(9493),l=e(1573),u=e(3997),p=e(4463),v=e(822);const m=h.mW,g=h.lw;let f=class{constructor(t,i,e){this.Ff=t,this.kn=i,this.fL=e,this.IL=!1,this.Wk=m*o.s_,this.AL=[],this.yL=new r.x,this._L=new r.x,this.bL=new r.x,this.SL=!1,this.wL=!1}get remainingAdsDuration(){var t;return null===(t=this.PL)||void 0===t?void 0:t.timeRemaining}get maxAdDurationConsumed(){return this.yL}get canSkipVideo(){return this.bL}get newAdsLimitReached(){return this._L}startListeningToAdEvents(t){this.kL=t,this.zk(),this.Jk()}startListeningToContentEvents(t){this.xL=t,this.LL()}destroy(){var t;(0,p.i)(this.AL),null===(t=this.PL)||void 0===t||t.stop()}getRemainingAdsDurationInMs(){return this.CL()?this.PL?Math.round(this.PL.timeRemaining):m*o.s_:null}Yk(t){var i;(0,v.r)(t)&amp;&amp;(this.Wk=t*o.s_,null===(i=this.PL)||void 0===i||i.setTimerDuration(this.Wk))}zk(){var t;const i=null===(t=this.kL)||void 0===t?void 0:t.subscribe((t=&gt;{var i,e;switch(t.type){case a.f.AdImpression:this.wL&amp;&amp;this.TL(),this.BL();break;case a.f.AdPlaying:case"AdPlayingInView":this.BL();break;case"AdPlayerOutOfView":this.EL(!1);break;case"AdPlayerInView":this.EL(!0);break;case a.f.AdStopped:case a.f.AdSkipped:case a.f.AdError:this.bL.next(this.SL),null===(i=this.PL)||void 0===i||i.stop();break;case a.f.AdVideoComplete:case a.f.AdClickThru:case a.f.AdPaused:case a.f.AdUserClose:null===(e=this.PL)||void 0===e||e.stop()}}));i&amp;&amp;this.AL.push(i)}EL(t){var i;this.IL=t,t||null===(i=this.PL)||void 0===i||i.stop()}BL(){var t;this.IL&amp;&amp;(null===(t=this.PL)||void 0===t||t.start())}LL(){var t;const i=null===(t=this.xL)||void 0===t?void 0:t.subscribe((t=&gt;{var i;switch(t.type){case"newVideo":this.DL(),null===(i=this.PL)||void 0===i||i.reset(),this.bL.next(!1),this.SL=!1,this.RL(),this.Yk(t.durationInS),this.wL=!1;break;case"DurationUpdate":this.Yk(t.durationInS)}}));i&amp;&amp;this.AL.push(i)}RL(){var t,i;null===(t=this.PL)||void 0===t||t.reset(),null===(i=this.PL)||void 0===i||i.setTreshold(g*o.s_)}Jk(){const t=(0,l.AU)(d.f);this.PL=new c.B(t,this.Wk,500),this.PL.setTreshold(g*o.s_);const i=this.PL.onTimeElapsed.subscribe((()=&gt;{this.CL()&amp;&amp;this.yL.next(!0)}));if((0,v.r)(this.fL.skipToNextVideoAfter)){const t=this.PL.onTimeUpdate.subscribe((()=&gt;{var t;if(this.CL()){const i=null===(t=this.PL)||void 0===t?void 0:t.timeRemaining;i&amp;&amp;i&lt;=this.fL.skipToNextVideoAfter*o.s_&amp;&amp;(this.SL=!0)}}));this.AL.push(t)}const e=this.PL.onTresholdReached.subscribe((()=&gt;{this.CL()&amp;&amp;(this._L.next(!0),this.wL=!0)}));this.AL.push(i,e)}CL(){const t=this.Ff.enableAdContentRatioMechanism||this.Ff.enableAdContentRatioGuardsMechanism;return this.fL.isMechanismEnabled||t}DL(){if(!this.OL()&amp;&amp;this.Wk&amp;&amp;this.PL&amp;&amp;(0,v.$K)(this.PL.timeRemaining)){const t={contentDuration:Math.round(this.Wk/o.s_),remainingAdsDuration:Math.round(this.PL.timeRemaining/o.s_)};(0,u.FH)({level:"Info",message:"VideoAdsDurationService_Durations",exception:"",adsContentRatio:t,callStack:""},{pacing:5})}}TL(){var t;(0,u.FH)({level:"Warn",message:"VideoAdsDurationService_ImpressionAfterTimeConsumed",exception:"yielded impression after duration was consumed",sessionId:null===(t=this.kn)||void 0===t?void 0:t.sessionId},{extraLogsPercentage:100})}OL(){var t,i,e;return(null===(t=this.PL)||void 0===t?void 0:t.timeRemaining)===(null===(i=this.PL)||void 0===i?void 0:i.timerDuration)&amp;&amp;(null===(e=this.PL)||void 0===e?void 0:e.timerDuration)===m*o.s_}};f=(0,s.gn)([(0,n.b2)(),(0,n.Yn)(n.Fw.ContainerScoped),(0,s.fM)(0,(0,n.f3)("FeatureFlags")),(0,s.fM)(1,(0,n.f3)("GeneralMetadata")),(0,s.fM)(2,(0,n.f3)("VideoAdsDurationServiceSettings")),(0,s.w6)("design:paramtypes",[Object,Object,Object])],f)},3203:(t,i,e)=&gt;{e.d(i,{q:()=&gt;r});var s=e(6637);class r{constructor(){this.Wb=(0,s.qs)()}get id(){return this.Wb}get timestamp(){return this.sT}set timestamp(t){this.sT=t}}},2047:(t,i,e)=&gt;{e.d(i,{C:()=&gt;s});class s{constructor(){this.i=!1,this.promise=new Promise(((t,i)=&gt;{this.o=t,this.L=i}))}get isPending(){return!this.i}resolve(t){this.V(),this.o(t)}reject(t){this.V(),this.L(t)}V(){this.i||(this.i=!0)}}},2282:(t,i,e)=&gt;{e.d(i,{I:()=&gt;a});var s=e(6716),r=e(6197),n=e(2047),h=e(6637),o=e(3997);class a{constructor(t,i,e,r){if(this.vt=t,this._r=e,this.ks=r,this.C2=!1,this.S2=1e3,this.w2=!0,this.A2=new s.x,this.P2=new s.x,this.oF=!1,this.I2=()=&gt;{this.C2&amp;&amp;this.T2()},this.E2=t=&gt;{this.C2?null!==this.M2?this.T2():this.B2():this.A2.next("exitFullscreen")},this.B2=()=&gt;{this.oF=!1,this.V2.reject(),this.C2=!1,clearTimeout(this.L2)},this.TK=this.vt.hasIosFullscreenBehaviour(e)?i.getElementsByTagName("video")[0]:i,!this.TK)throw new Error("FullScreen element is missing");try{const t=this.D2();if(null==t)return void(this.w2=!1);this.O2=t.keys,this.F2=t.name,this.jK()}catch(t){this.w2=!1;const{message:i,stack:e}=(0,h.W$)(t);(0,o.nF)({message:"Fullscreen init failed",exception:i,callStack:e,level:"Critical",sessionId:this.ks})}}get fullscreenEnabled(){return this.vt.getDocumentProperty(this.O2.fullscreenEnabled)}get isFullscreen(){return this.oF}get onFullScreenExit(){return this.A2.asObservable()}get onFullScreenEnter(){return this.P2.asObservable()}get M2(){return this.vt.getDocumentProperty(this.O2.fullscreenElement)}enterFullScreen(){if(this.w2){this.V2=new n.C,this.C2=!0,clearTimeout(this.L2),this.L2=setTimeout(this.B2,this.S2);try{this.TK[this.O2.requestFullscreen]()}catch(t){this.B2()}return this.V2.promise}}exitFullScreen(){try{this.vt.exitFullscreen(this.O2.exitFullscreen,this._r===r.M.Ios?this.TK:void 0)}catch(t){const{message:i,stack:e}=(0,h.W$)(t);(0,o.nF)({message:"fullscreen_exit",exception:i,callStack:e,level:"Warn",sessionId:this.ks})}this.oF=!1}destroy(){this.isFullscreen&amp;&amp;this.exitFullScreen(),this.R2(),this.V2&amp;&amp;this.V2.isPending&amp;&amp;this.V2.reject()}D2(){let t;return t=this.vt.hasIosFullscreenBehaviour(this._r)?this.vt.getFullscreenKeys(this.TK):this.vt.getFullscreenKeys(),t}jK(){"moz"===this.F2||"ms"===this.F2?(this.vt.addEventListenerOnGlobal(this.O2.fullscreenchange,this.E2),this.vt.addEventListenerOnGlobal(this.O2.fullscreenerror,this.B2)):(this.TK.addEventListener(this.O2.fullscreenchange,this.E2),this.TK.addEventListener(this.O2.fullscreenerror,this.B2)),this.vt.hasIosFullscreenBehaviour(this._r)&amp;&amp;(this.TK.addEventListener("webkitbeginfullscreen",this.I2),this.TK.addEventListener("webkitendfullscreen",this.E2))}R2(){"moz"===this.F2||"ms"===this.F2?(this.vt.removeEventListenerOnGlobal(this.O2.fullscreenchange,this.E2),this.vt.removeEventListenerOnGlobal(this.O2.fullscreenerror,this.B2)):(this.TK.removeEventListener(this.O2.fullscreenchange,this.E2),this.TK.removeEventListener(this.O2.fullscreenerror,this.B2)),this._r===r.M.Ios&amp;&amp;(this.TK.removeEventListener("webkitbeginfullscreen",this.I2),this.TK.removeEventListener("webkitendfullscreen",this.E2))}T2(){this.oF=!0,this.P2.next("enterFullscreen"),this.V2.resolve(),this.C2=!1,clearTimeout(this.L2)}}},6916:(t,i,e)=&gt;{e.d(i,{r:()=&gt;s});const s=(0,e(6213).A)({PlayButton:0,BigPlayButton:1,VolumeButton:2,VolumeProgress:3,VolumeControls:4,ExpandButton:5,SettingsButton:6,CaptionButton:7,CaptionComponent:8,UpNextButton:9,UpNextBox:10,PreviousButton:11,LogoComponent:12,LogoOutstream:13,MoreButton:14,ElapsedTimeLabel:15,TotalDurationLabel:16,RemainingDurationLabel:17,ProgressBar:18,QualityMenu:19,QueStateOverlay:20,Loader:21,ContextMenu:22,ElementsSettingsMenu:23,CloseButton:24,PinnedCloseButton:25,SkipAdButton:26,AdLoadingScreen:27,NextProgressButton:28,StayProgressButton:29,CtaButton:30,PlayspaceProgressBar:31,PlayspaceSettingsMenu:32,ClickToPlayButton:33,OverlayComponent:34,SlideTitle:35,TopTitle:36,TopLogo:37,TopSlideTitle:38,TopStoryTitle:39,TextLabel:40,LivePoster:41,LiveIcon:42,ElementsCaptionMenu:43,PinnedTitle:44,FloatingCloseButton:45})},2191:(t,i,e)=&gt;{e.d(i,{C:()=&gt;s});const s=(0,e(6213).A)({Play:0,Pause:1,Replay:2,Volume:3,Mute:4,Unmute:5,DraggingStart:6,DraggingStopped:7,Seek:8,SeekingStart:9,SeekingStopped:10,Expand:11,Collapse:12,Quality:13,Close:14,Next:15,Prev:16,Settings:17,SettingsMenu:18,CaptionOn:19,CaptionOff:20,CaptionUpdate:21,CaptionMenu:22,VolumeHoverStart:23,VolumeHoverStopped:24,UIHideStart:25,UIShowStart:26,UIEndShowHide:27,ContextMenuOpen:28,ContextMenuClose:29,ContextClick:30,AboutClick:31,OverlayClick:32,LogoClicked:33,HoverStart:34,HoverEnd:35,StateChanged:36,RebindComponent:37,SkipAd:38,FocusStart:39,StayButton:40,NextButton:41,CtaClick:42,ApiButton:43})},142:(t,i,e)=&gt;{e.d(i,{P:()=&gt;n});var s=e(8866),r=e(6288);class n extends s._{constructor(t,i,e,s,r){super(),this.mediator=t,this.nt=i,this.qW=e,this.Tr=r,this.Ny=this.nt.createElementByString(s)}getContainer(){return this.Ny}getCoordinates(t){const i=this.nt.getElementCoordinates(this.Ny);return this.Tr&amp;&amp;t?(1==(1&amp;t)&amp;&amp;(i.clientY-=this.Ny.clientHeight),4==(4&amp;t)&amp;&amp;(i.clientX+=this.Ny.clientWidth)):i.clientX+=i.width/2,i}showComponent(t=!1){if(!this.Ny||!this.Ny.parentElement)return;const i=(0,r.pv)(this.Ny.parentElement,"cnx-ui-btn")?this.Ny.parentElement:this.Ny;t&amp;&amp;(0,r.GF)(i)?(0,r.Ji)(i):(0,r.Ho)(i)}hideComponent(t=!1){if(!this.Ny||!this.Ny.parentElement)return;const i=(0,r.pv)(this.Ny.parentElement,"cnx-ui-btn")?this.Ny.parentElement:this.Ny;t&amp;&amp;!(0,r.GF)(i)?(0,r.U6)(i,(()=&gt;(0,r.MV)(i))):(0,r.MV)(i)}destroy(){this.Ny.innerHTML="",this.Ny.style.display="none",this.qW.unregisterAll(this)}}},7525:(t,i,e)=&gt;{e.d(i,{Y:()=&gt;n});var s=e(6678),r=e(142);class n extends r.P{constructor(){super(...arguments),this.eventList=[s.y[s.y.Scroll],s.y[s.y.Click]],this.yt=!1,this.u5=t=&gt;{t.stopPropagation()},this.x$=t=&gt;{this.p5(t),this.GW(t)},this.v5=t=&gt;{this.p5(t)}}get isInitialized(){return this.yt}initComponent(){this.yt=!0;const t={interactionstart:this.u5,interaction:this.v5,click:this.x$};this.qW.register(this.Ny,this,this.qW,t),this.Tr&amp;&amp;(this.U(s.y[s.y.Click],this.qW,(()=&gt;{this.GW()})),this.relay(s.y[s.y.Scroll],this.qW,this,this.mediator))}destroy(){this.WT(this.qW),super.destroy()}p5(t){t.stopPropagation()}GW(t){}}},7672:(t,i,e)=&gt;{e.d(i,{h:()=&gt;o});var s=e(2191),r=e(7525),n=e(6288);class h extends r.Y{constructor(){super(...arguments),this.x$=t=&gt;{this.p5(t),this.GW(),this.g5()}}initComponent(){super.initComponent(),this.Ny.appendChild(this.nt.createElementByString('<cnx class="cnx-boom-elem"></cnx>'))}g5(){(0,n.cn)(this.Ny,"cnx-boom"),(0,n.Tp)(this.Ny),(0,n.cn)(this.Ny,"cnx-boom-anim");const t=i=&gt;{"transform"===i.propertyName&amp;&amp;((0,n.IV)(this.Ny,"cnx-boom"),(0,n.IV)(this.Ny,"cnx-boom-anim"),this.Ny.removeEventListener("transitionend",t))};this.Ny.addEventListener("transitionend",t)}}class o extends h{constructor(){super(...arguments),this.eventList=[s.C[s.C.HoverStart],s.C[s.C.HoverEnd],s.C[s.C.FocusStart],...this.eventList],this.f5=()=&gt;{(0,n.cn)(this.Ny,"cnx-mod-hover-s"),(0,n.cn)(this.Ny,"cnx-mod-hover"),this.Tr&amp;&amp;this.Ny.addEventListener("transitionend",(()=&gt;this.I5())),this.mediator.publish(this,s.C[s.C.HoverStart])},this.y5=()=&gt;{(0,n.IV)(this.Ny,"cnx-mod-hover"),this.mediator.publish(this,s.C[s.C.HoverEnd])},this.A5=()=&gt;{this.mediator.publish(this,s.C[s.C.FocusStart]),this.f5()},this.b5=()=&gt;{this.y5()}}initComponent(){super.initComponent(),this.Tr?(this.Ny.addEventListener("touchstart",this.f5,{passive:!0}),this.Ny.addEventListener("touchend",this.y5),this.Ny.addEventListener("touchcancel",this.y5)):(this.Ny.addEventListener("mouseenter",this.f5),(0,n.Iy)(this.Ny)&amp;&amp;(this.Ny.addEventListener("focusin",this.A5),this.Ny.addEventListener("focusout",this.b5)),this.Ny.addEventListener("mouseleave",this.y5))}destroy(){this.Tr?(this.Ny.removeEventListener("touchstart",this.f5),this.Ny.removeEventListener("touchend",this.y5),this.Ny.removeEventListener("touchcancel",this.y5)):(this.Ny.removeEventListener("mouseenter",this.f5),this.Ny.removeEventListener("mouseleave",this.y5),(0,n.Iy)(this.Ny)&amp;&amp;(this.Ny.removeEventListener("focusin",this.A5),this.Ny.removeEventListener("focusout",this.b5))),super.destroy()}p5(t){this.I5()}I5(){(0,n.IV)(this.Ny,"cnx-mod-hover"),(0,n.IV)(this.Ny,"cnx-mod-hover-s"),this.Tr&amp;&amp;this.Ny.removeEventListener("transitionend",(()=&gt;this.I5()))}}},3586:(t,i,e)=&gt;{e.d(i,{N:()=&gt;a});var s=e(6916),r=e(2191),n=e(5349),h=e(6288);class o extends n.s{constructor(t,i,e,s){super(i,e,s),this.mediator=t,this.Ny=this._5.getRenderedDom()}getContainer(){return this.Ny}initComponent(){this._5.initComponents()}showComponent(){(0,h.Ho)(this.Ny)}hideComponent(){(0,h.MV)(this.Ny)}}class a extends o{constructor(t,i,e,n){super(t,i,e,n),this.eventList=[r.C[r.C.Volume],r.C[r.C.VolumeHoverStart],r.C[r.C.VolumeHoverStopped],r.C[r.C.DraggingStopped],r.C[r.C.DraggingStart],r.C[r.C.HoverStart],r.C[r.C.HoverEnd],r.C[r.C.StateChanged],r.C[r.C.FocusStart]],this.x5=null,this.S5=.2,this.w5=600,this.k5=!1,this.f5=t=&gt;{clearTimeout(this.x5),(0,h.cn)(this.Ny,"cnx-mod-hover"),this.mediator.publish(this,r.C[r.C.VolumeHoverStart])},this.y5=()=&gt;{this.k5||(null!==this.x5&amp;&amp;clearTimeout(this.x5),this.x5=setTimeout((()=&gt;{(0,h.IV)(this.Ny,"cnx-mod-hover"),this.mediator.publish(this,r.C[r.C.VolumeHoverStopped])}),this.w5))},this.A5=()=&gt;{(0,h.cn)(this.Ny,"cnx-mod-hover"),this.mediator.publish(this,r.C[r.C.FocusStart]),this.mediator.publish(this,r.C[r.C.VolumeHoverStart])},this.b5=()=&gt;{(0,h.IV)(this.Ny,"cnx-mod-hover"),this.mediator.publish(this,r.C[r.C.VolumeHoverStopped])},this.P5=this.S5,this.$H=this.getComponent(s.r.VolumeButton),this.M5=this.getComponent(s.r.VolumeProgress),(0,h.IV)(this.$H.getContainer(),"cnx-ui-btn-hoverable")}initComponent(){super.initComponent(),this.Ny.addEventListener("mouseenter",this.f5),this.Ny.addEventListener("mouseleave",this.y5),this.Ny.addEventListener("focusin",this.A5),this.Ny.addEventListener("focusout",this.b5)}setVolume(t){const i=100*t;this.C5(i),this.L5(i)}destroy(){super.destroy(),this.Ny.removeEventListener("mouseenter",this.f5),this.Ny.removeEventListener("mouseleave",this.y5),this.Ny.removeEventListener("focusin",this.A5),this.Ny.removeEventListener("focusout",this.b5)}v3(t,i,e){let s;switch(t){case r.C[r.C.Volume]:s=i.payload/100,this.T5(s),this.C5(i.payload);break;case r.C[r.C.Mute]:s=0,this.L5(0);break;case r.C[r.C.Unmute]:s=this.P5,this.L5(100*this.P5);break;case r.C[r.C.DraggingStopped]:this.k5=!1,this.mediator.publish(this,r.C[r.C.DraggingStopped]),this.y5();break;case r.C[r.C.DraggingStart]:this.k5=!0,this.mediator.publish(this,r.C[r.C.DraggingStart]);break;case r.C[r.C.HoverStart]:this.mediator.publish(this,r.C[r.C.HoverStart],{payload:{targetComponent:e}});break;case r.C[r.C.HoverEnd]:this.mediator.publish(this,r.C[r.C.HoverEnd],{payload:{targetComponent:e}});break;case r.C[r.C.StateChanged]:this.mediator.publish(this,r.C[r.C.StateChanged],{payload:{targetComponent:e}})}void 0!==s&amp;&amp;this.B5(s)}T5(t){t<this.s5?this.p5=this.s5:this.p5=t}b5(t){this.mediator.publish(this,r.c[r.c.volume],{payload:t})}c5(t){0===t?this.$h.setstate(0):this.$h.setstate(1)}l5(t){this.m5.setprogress(t)}}},2764:(t,i,e)=>{e.d(i,{e:()=&gt;r});var s=e(6916);const r=e(5046).h`<cnx class="cnx-volume-container"><cnx class="cnx-ui-btn cnx-volume-btn">[[${s.r.VolumeButton}]]</cnx><cnx class="cnx-volume-bar">[[${s.r.VolumeProgress}]]</cnx></cnx>`},2197:(t,i,e)=&gt;{e.d(i,{$:()=&gt;n});var s=e(5349),r=e(6288);class n extends s.s{constructor(t,i,e,s,r){super(e,s,r),this.mediator=t,this.$container=i,this.$uiContainer=this._5.getRenderedDom(),i.appendChild(this.$uiContainer),this._5.initComponents()}changeState(t){const i=this.e3[t];i!==this.currentState&amp;&amp;this.currentState.canTransitionToState(i)&amp;&amp;(this.currentState.exitState(i),i.enterState())}hide(){(0,r.cn)(this.$uiContainer,"cnx-mod-display-none")}show(){(0,r.IV)(this.$uiContainer,"cnx-mod-display-none")}destroy(){super.destroy(),this.$uiContainer.parentNode.removeChild(this.$uiContainer)}}},2962:(t,i,e)=&gt;{e.d(i,{A:()=&gt;$});var s=e(3276);const r='<cnx class="cnx-ui-progress-label"><cnx-span role="timer"></cnx-span></cnx>';var n=e(6916),h=e(2191),o=e(7672);class a extends o.h{constructor(){super(...arguments),this.eventList=[h.C[h.C.Expand],h.C[h.C.Collapse],...this.eventList],this.E5="Full Screen (f)",this.D5="Exit Full Screen (f)"}get tooltip(){return 1===this.nS?this.D5:this.E5}initComponent(){super.initComponent(),this.Ny&amp;&amp;this.Ny.setAttribute("aria-label",this.tooltip)}setState(t){this.nS!==t&amp;&amp;(this.nS=t,this.R5())}GW(){switch(this.nS){case 0:default:this.mediator.publish(this,h.C[h.C.Expand]);break;case 1:this.mediator.publish(this,h.C[h.C.Collapse])}}R5(){this.Ny&amp;&amp;(this.Ny.setAttribute("aria-label",this.tooltip),1===this.nS?this.Ny.classList.add("cnx-mod-active"):this.Ny.classList.remove("cnx-mod-active"))}}var d=e(5046);const c=d.h`<cnx class="cnx-icon-button cnx-ui-btn-hoverable" role="button" tabindex="0"><cnx class="cnx-btn-container"><cnx class="cnx-expand-icon">${'<svg class="cnx-color-icon" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M4.6 3H10v2H5v5H3V4.6A1.58 1.58 0 0 1 4.6 3zM5 14v5h5v2H4.6A1.58 1.58 0 0 1 3 19.4V14h2zM19.4 3A1.58 1.58 0 0 1 21 4.6V10h-2V5h-5V3h5.4zM19 14h2v5.4a1.58 1.58 0 0 1-1.6 1.6H14v-2h5v-5z" fill-rule="evenodd"></path></svg>\n'}</cnx><cnx class="cnx-collapse-icon">${'<svg class="cnx-color-icon" fill-rule="evenodd" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M16.6 15a1.58 1.58 0 0 0-1.6 1.6V22h2v-5h5v-2h-5.4zM17 2h-2v5.4A1.58 1.58 0 0 0 16.6 9H22V7h-5V2zM7.4 15A1.58 1.58 0 0 1 9 16.6V22H7v-5H2v-2h5.4zM7 2h2v5.4A1.58 1.58 0 0 1 7.4 9H2V7h5V2z"></path></svg>\n'}</cnx></cnx></cnx>`,l='<svg class="cnx-color-icon" viewbox="0 0 22 22" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M18 5.4L16.6 4 11 9.6 5.4 4 4 5.4 9.6 11 4 16.6 5.4 18l5.6-5.6 5.6 5.6 1.4-1.4-5.6-5.6z"></path></svg>\n';var u=e(6939);function p(t,i,e,s=null,r=!0){if(r){const{expanded:r,hasPopup:h,label:o,controls:a}=s||{};return d.h`${s?`<cnx aria-controls="${a}" aria-expanded="${r}" aria-haspopup="${h}" aria-label="${o}" class="cnx-icon-button cnx-button-${n.r[t].toLowerCase()} cnx-ui-btn-hoverable" role="button" tabindex="0">`:`<cnx aria-label="${e}" class="cnx-icon-button cnx-button-${n.r[t].toLowerCase()} cnx-ui-btn-hoverable" role="button" tabindex="0">`}<cnx class="cnx-btn-container">${i}</cnx>`}return`<cnx class="cnx-button-${n.r[t].toLowerCase()}">${i}</cnx>`}const v="More",m="Close Player",g="Next (Shift + N)",f="Previous (Shift + P)",I={[n.r[n.r.MoreButton]]:{template:p(n.r.MoreButton,'<svg class="cnx-color-icon" viewbox="0 0 22 22" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M11 7c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2zm0 2c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm0 6c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2z"></path></svg>\n',"",{hasPopup:!0,expanded:!1,label:v,controls:"cnx-ui-cm-settings"}),tooltip:v,isHoverable:!0},[n.r[n.r.CloseButton]]:{template:p(n.r.CloseButton,l,m),tooltip:m,isHoverable:!0},[n.r[n.r.PinnedCloseButton]]:{template:p(n.r.CloseButton,l,m),tooltip:m,isHoverable:!0},[n.r[n.r.UpNextButton]]:{template:p(n.r.UpNextButton,u,g),tooltip:g,isHoverable:!0},[n.r[n.r.PreviousButton]]:{template:p(n.r.PreviousButton,u,f),tooltip:f,isHoverable:!0}};var y=e(7525);class A extends y.Y{constructor(t,i,e,s,r,h,o){super(t,i,e,s,r),this.tooltip=o,this.eventList=[],this.O5=n.r[h],this.eventList.push(this.O5)}GW(){this.mediator.publish(this,this.O5)}}class b extends o.h{constructor(t,i,e,s,r,h,o){super(t,i,e,s,r),this.tooltip=o,this.O5=n.r[h],this.eventList.push(this.O5)}GW(){this.mediator.publish(this,this.O5)}}class _{constructor(t,i,e,s){this.nt=t,this.qW=i,this.Tr=e,this.F5=new Map,Object.keys(s).forEach((t=&gt;this.V5(n.r[t],s[t])))}getButton(t,i){const{isHoverable:e,template:s,tooltip:r}=this.N5(t);return e?new b(i,this.nt,this.qW,s,this.Tr,t,r):new A(i,this.nt,this.qW,s,this.Tr,t,r)}isGeneralComponent(t){return this.F5.has(t)}N5(t){return this.F5.get(t)}V5(t,i){this.F5.set(t,i)}}var x=e(142),S=e(6288);class w extends x.P{constructor(){super(...arguments),this.eventList=[]}initComponent(){this.hide()}show(){(0,S.Ho)(this.Ny),(0,S.Tp)(this.Ny),(0,S.cn)(this.Ny,"cnx-mod-active")}hide(){(0,S.IV)(this.Ny,"cnx-mod-active"),(0,S.MV)(this.Ny)}}class k extends o.h{constructor(t,i,e,s,r,n){super(t,i,e,s,r),this.U5=n,this.eventList=[h.C[h.C.Play],h.C[h.C.Pause],h.C[h.C.Replay],h.C[h.C.StateChanged],...this.eventList],this.W5=!1,this.j5="Play (SPACE)",this.q5="Pause (SPACE)",this.setState(1)}get tooltip(){return 0===this.nS?this.j5:this.q5}toggleReplay(t){this.W5=t}setState(t){this.nS!==t&amp;&amp;(this.nS=t,this.R5(),this.Ny.setAttribute("aria-label",this.tooltip),this.mediator.publish(this,h.C[h.C.StateChanged]))}GW(){1===this.nS?this.mediator.publish(this,h.C[h.C.Pause]):this.W5?this.mediator.publish(this,h.C[h.C.Replay]):this.mediator.publish(this,h.C[h.C.Play]),this.Ny.setAttribute("aria-label",this.tooltip)}R5(){0===this.nS?this.Ny.setAttribute("aria-hidden","false"):this.U5&amp;&amp;this.Ny.setAttribute("aria-hidden","true")}}var P=e(1353);var M=e(1749);class C extends x.P{constructor(t,i,e,s,r=!1){super(t,i,e,s,r),this.H5=0,this.z5=null,this.G5=0,this.J5=0,this.Y5=100,this.X5()}setProgress(t){this.Q5();const i=this.K5((0,M.dQ)(0,100,0,this.H5,t));this.R5(i)}forceStartState(){this.Z5(this.J5)}forceEndState(){this.Z5(this.Y5)}initComponent(){this.Q5()}destroy(){super.destroy()}X5(){this.t4=this.Ny.getElementsByClassName("cnx-progress-fill")[0],this.uG=this.Ny.getElementsByClassName("cnx-progress-rail")[0]}Q5(){this.H5=this.i4||this.uG.getBoundingClientRect().width,this.z5=this.uG.getBoundingClientRect().left}R5(t){const i=this.K5(t);this.G5=i,this.t4.style.transform=`translateX(${i}px)`}e4(){return this.G5&gt;=0&amp;&amp;this.G5&lt;=this.H5}K5(t){return t&lt;0?0:t&gt;this.H5?this.H5:t}s4(){(0,S.cn)(this.Ny,"cnx-mod-no-transition")}r4(){(0,S.IV)(this.Ny,"cnx-mod-no-transition")}Z5(t){this.s4(),this.setProgress(t),(0,S.Tp)(this.t4),this.r4()}}class L extends C{constructor(t,i,e,s,r=!1){super(t,i,e,s,r),this.eventList=[h.C[h.C.DraggingStart],h.C[h.C.DraggingStopped]],this.n4=0,this.rR=null,this.h4=!1,this.o4=t=&gt;{this.Q5(),this.a4(this.NB(t)),this.Tr?this.Ny.addEventListener(this.RB,this.d4):this.nt.addEventListenerOnGlobal(this.RB,this.d4),this.EB()},this.d4=t=&gt;{null===this.rR&amp;&amp;(this.h4||(this.h4=!0,this.s4()),this.rR=this.nt.requestAnimationFrameHelper((()=&gt;{const i=this.c4+(this.NB(t)-this.AB);this.e4()&amp;&amp;this.l4(i),this.rR=null})))},this.u4=t=&gt;{t.stopPropagation(),this.Tr?this.Ny.removeEventListener(this.RB,this.d4):this.nt.removeEventListenerOnGlobal(this.RB,this.d4),this.h4=!1,this.r4(),this.FB()},this.v4=t=&gt;{const i=100*t.target.value/this.m4.max;this.g4(i),this.EB(),this.FB()},this.RB=r?"touchmove":"mousemove"}setProgress(t){if(super.setProgress(t),!this.m4)return;const i=Math.round(t/100*this.m4.max);this.m4.value=i}setMaxRange(t){this.m4.setAttribute("max",t.toString())}hideRangeInput(){this.m4&amp;&amp;(0,S.MV)(this.m4)}initComponent(){super.initComponent();const t={interactionstart:this.o4,interactionend:this.u4};this.qW.register(this.Ny,this,this.qW,t),this.m4&amp;&amp;(this.m4.addEventListener("input",this.v4),this.m4.addEventListener("change",this.v4))}destroy(){super.destroy(),this.m4&amp;&amp;(this.m4.removeEventListener("input",this.v4),this.m4.removeEventListener("change",this.v4))}X5(){super.X5(),this.f4=this.Ny.getElementsByClassName("cnx-progress-handle")[0],this.m4=this.Ny.querySelector('input[type="range"]')}Q5(){super.Q5(),this.n4=this.f4.getBoundingClientRect().width/2}R5(t){super.R5(t);const i=this.K5(t);this.f4.style.transform=`translateX(${i-this.n4}px)`}FB(){this.mediator.publish(this,h.C[h.C.DraggingStopped])}EB(){this.mediator.publish(this,h.C[h.C.DraggingStart])}NB(t){return this.Tr?t.touches.item(0).clientX:t.clientX}a4(t){this.c4=t-this.z5,this.AB=t,this.l4(this.c4)}l4(t){if(this.e4()){const i=this.K5(t),e=0,s=this.H5,r=0,n=100;this.R5(i),this.g4((0,M.dQ)(e,s,r,n,i))}}}var T=e(2206),B=e(822);class E extends L{constructor(t,i,e,s,r=!1){super(t,i,e,s,r),this.I4=!1,this.y4=t=&gt;{(0,S.cn)(this.Ny,"cnx-mod-hover"),this.I4=!0},this.A4=t=&gt;{const i=this.K5(t.clientX-this.z5);this.b4.style.transform=`translateX(${i}px)`},this._4=t=&gt;{this.b4.style.transform="translateX(0)",this.I4=!1,this.x4()},this.eventList=[...this.eventList,h.C[h.C.Seek],h.C[h.C.SeekingStart],h.C[h.C.SeekingStopped]]}updateWcagAttributes(t,i){if(!(0,B.hj)(t)||!(0,B.hj)(i))return;const e=(0,T.qt)(i),s=(0,T.qt)(t),r=this.m4;r&amp;&amp;(r.setAttribute("aria-label","Seek"),r.setAttribute("aria-valuemin","0"),r.setAttribute("aria-valuemax",`${Math.round(i)}`),r.setAttribute("aria-valuenow",`${Math.round(t)}`),r.setAttribute("aria-valuetext",`${s} of ${e}`))}initComponent(){super.initComponent(),this.Ny.addEventListener("mousemove",this.A4),this.Ny.addEventListener("mouseenter",this.y4),this.Ny.addEventListener("mouseleave",this._4),this.b4=this.Ny.getElementsByClassName("cnx-progress-follow")[0]}hide(){this.Ny.style.opacity="0"}show(){this.Ny.style.opacity="1"}destroy(){super.destroy(),this.Ny.removeEventListener("mousemove",this.A4),this.Ny.removeEventListener("mouseenter",this.y4),this.Ny.removeEventListener("mouseleave",this._4)}g4(t){this.mediator.publish(this,h.C[h.C.Seek],{payload:t-.1})}FB(){super.FB(),this.mediator.publish(this,h.C[h.C.SeekingStopped]),this.x4()}EB(){super.EB(),this.mediator.publish(this,h.C[h.C.SeekingStart])}x4(){this.I4||this.h4||(0,S.IV)(this.Ny,"cnx-mod-hover")}}class D extends x.P{constructor(){super(...arguments),this.eventList=[]}initComponent(){this.S4=this.Ny.getElementsByTagName("cnx-span")[0]}setTime(t){isNaN(t)||"number"!=typeof t?(0,S.cn)(this.Ny,"cnx-mod-invisible"):(this.S4.innerHTML=(0,T.to)(t),(0,S.IV)(this.Ny,"cnx-mod-invisible"))}}class R extends o.h{constructor(t,i,e,s,r,n){super(t,i,e,s,n),this.eventList=[h.C[h.C.Mute],h.C[h.C.Unmute],h.C[h.C.StateChanged],...this.eventList],this.w4="Mute (m)",this.P4="Unmute (m)",this.nS=r,this.Ny.setAttribute("aria-label",this.tooltip)}get tooltip(){return 0===this.nS?this.P4:this.w4}initComponent(){super.initComponent(),this.R5()}setState(t){this.nS!==t&amp;&amp;(this.nS=t,this.R5(),this.Ny.setAttribute("aria-label",this.tooltip),this.mediator.publish(this,h.C[h.C.StateChanged]))}setVolume(t){t&gt;0?this.setState(1):this.setState(0)}GW(){0===this.nS?(this.mediator.publish(this,h.C[h.C.Unmute]),this.setState(1)):(this.mediator.publish(this,h.C[h.C.Mute]),this.setState(0))}R5(){0===this.nS?(0,S.L_)(this.Ny,"cnx-sound-on","cnx-sound-off"):(0,S.L_)(this.Ny,"cnx-sound-off","cnx-sound-on")}}var O=e(4821);const F=d.h`<cnx class="cnx-icon-button cnx-ui-btn-hoverable" role="button" tabindex="0"><cnx class="cnx-btn-container"><cnx class="cnx-unmute-icon">${'<svg class="cnx-color-icon" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M0 7.913v7.913h4.946l5.935 5.045V1.978L4.946 7.913zm16.815 3.957c.03-2.078-1.12-3.994-2.967-4.946v9.9c1.847-.952 2.997-2.867 2.967-4.945zM13.848 0v2.077a10.39 10.39 0 0 1 0 19.585v2.077a12.05 12.05 0 0 0 8.9-11.87A12.05 12.05 0 0 0 13.848 0z"></path></svg>\n'}</cnx><cnx class="cnx-mute-icon">${O}</cnx></cnx></cnx>`;class V extends L{constructor(t,i,e,s,r=!1){super(t,i,e,s,r),this.M4=80,this.i4=this.M4,this.eventList.push(h.C[h.C.Volume])}setProgress(t){this.Ny.setAttribute("aria-valuenow",t.toString()),super.setProgress(t)}initComponent(){this.Ny.setAttribute("role","slider"),super.initComponent()}g4(t){this.mediator.publish(this,h.C[h.C.Volume],{payload:t})}}class ${constructor(t,i,e,h={},o={}){this.nt=t,this.qW=i,this.Ny=e,this.mi=h,this.C4={[n.r.PlayButton]:t=&gt;this.L4(!1,t),[n.r.BigPlayButton]:t=&gt;this.L4(!0,t),[n.r.VolumeProgress]:t=&gt;new V(t,this.nt,this.qW,'<cnx class="cnx-progress-bar"><cnx class="cnx-progress-rail-container"><cnx class="cnx-progress-rail"></cnx><cnx class="cnx-progress-fill cnx-color-icon"></cnx></cnx><cnx class="cnx-progress-handle cnx-color-icon"></cnx></cnx>'),[n.r.ExpandButton]:t=&gt;new a(t,this.nt,this.qW,c,this.mi.isMobile),[n.r.Loader]:t=&gt;new w(t,this.nt,this.qW,s.Z),[n.r.ElapsedTimeLabel]:t=&gt;new D(t,this.nt,this.qW,r),[n.r.TotalDurationLabel]:t=&gt;new D(t,this.nt,this.qW,r),[n.r.RemainingDurationLabel]:t=&gt;new D(t,this.nt,this.qW,r),[n.r.ProgressBar]:t=&gt;new E(t,this.nt,this.qW,'<cnx class="cnx-progress-bar cnx-video-progress"><cnx class="cnx-progress-rail-container"><cnx class="cnx-progress-rail"></cnx><cnx class="cnx-progress-fill cnx-color-accent"></cnx><cnx class="cnx-progress-follow"></cnx></cnx><cnx class="cnx-progress-handle cnx-color-accent"></cnx><cnx class="cnx-progress-hitarea"></cnx><cnx class="cnx-progress-input"><input class="cnx-progress-range" role="slider" step="5" type="range"/></cnx></cnx>',this.mi.isMobile),[n.r.VolumeButton]:t=&gt;new R(t,this.nt,this.qW,F,0,this.mi.isMobile)},this.L4=(t,i)=&gt;new k(i,this.nt,this.qW,function(t=!1){return d.h`<cnx class="cnx-icon-button cnx-ui-btn-hoverable ${t?" cnx-button-big-play":""}"="" role="button" tabindex="0"><cnx class="cnx-btn-container"><cnx class="cnx-play-icon">${P}</cnx><cnx class="cnx-pause-icon">${'<svg class="cnx-color-icon" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9 21H3V3h6v18zm12 0h-6V3h6v18z" fill-rule="evenodd"></path></svg>\n'}</cnx></cnx></cnx>`}(t),this.mi.isMobile,t),this.T4=t=&gt;i=&gt;{const e=this.C4[t];if(e)return e(i)},this.B4=new _(this.nt,this.qW,this.mi.isMobile,Object.assign(Object.assign({},I),o))}createComponent(t,i){const e=this.T4(t)(i);return e||(this.B4.isGeneralComponent(t)?this.B4.getButton(t,i):void 0)}}},5349:(t,i,e)=&gt;{e.d(i,{s:()=&gt;h});var s=e(8866),r=e(2191);class n{constructor(t,i){this.E4=t,this.nt=i,this.D4=/\[\[([0-9]+)]]/g,this.R4=[],this.O4=[],this.F4=this.nt.createElementByString(this.V4(this.E4))}getComponentList(){return this.R4}getRenderedDom(){return this.F4}registerSlot(t,i){const e=this.N4(t,i);if(null!==e){const s=i.getContainer();return e.parentNode.replaceChild(s,e),this.O4.push({component:i,slotName:t}),!0}return!1}initComponents(){this.O4.forEach((t=&gt;t.component.initComponent()))}U4(t){return`<cnx class="pl_${t}"></cnx>`}V4(t){return t.replace(this.D4,((t,i)=&gt;(this.R4.push(parseInt(i,10)),this.U4(i))))}N4(t,i){return this.O4.some((i=&gt;i.slotName===t))||this.O4.some((t=&gt;t.component===i))?null:this.F4.getElementsByClassName(`pl_${t}`)[0]}}class h extends s._{constructor(t,i,e){super(),this.vt=t,this.E4=i,this.W4=e,this.j4={},this._5=new n(i,t),this.q4()}getComponent(t){return this.j4[t]}destroy(){Object.keys(this.j4).forEach((t=&gt;{this.j4[t].destroy()}))}q4(){this._5.getComponentList().forEach((t=&gt;{const i=this.W4.createComponent(t,this);this.H4(t,i)}))}H4(t,i){this._5.registerSlot(t,i),this.j4[t]=i,this.z4(i)}z4(t){t.eventList.forEach((i=&gt;{this.U(i,t,(e=&gt;{i===r.C[r.C.RebindComponent]&amp;&amp;this.G4(t),this.v3(i,e,t)}))}))}G4(t){t&amp;&amp;(this.WT(t),this.z4(t))}}},843:(t,i,e)=&gt;{e.d(i,{q:()=&gt;l});var s=e(6916),r=e(2191);var n=e(1568),h=e(7030),o=e(6288);class a{constructor(t,i,e){this.J4=t,this.nt=i,this.Y4=[],this.K4={top:12,bottom:24,margin:4},this.Z4=!1,e&amp;&amp;(this.Z4=!0)}removeActiveTooltip(){this.t9&amp;&amp;this.M$(this.t9)}setDistanceValues(t){this.K4=Object.assign(Object.assign({},this.K4),t)}hoverStart(t){this.removeActiveTooltip(),this.t9=t,this.S$(t)}hoverEnd(t){this.t9=null,this.M$(t)}stateChanged(t){this.t9===t&amp;&amp;this.i9(t)}disableTooltips(){this.Z4=!0,this.e9()}enableTooltips(){this.Z4=!1,this.S$(this.t9)}s9(){this.r9=this.nt.getElementCoordinates(this.J4.parentElement)}n9(t,i){t.getElementsByClassName("cnx-tooltip-text")[0].innerHTML=i}S$(t){if(!t||!t.tooltip||this.Z4)return;if(this.Y4.some((i=&gt;i.component===t)))return;const i=this.nt.createElementByString('<cnx class="cnx-tooltip-holder cnx-color-tt-bg"><cnx class="cnx-tooltip-text cnx-color-tt-text">TEST</cnx></cnx>');this.n9(i,t.tooltip),this.s9();const e=t.getCoordinates();let s=!1;const{clientY:r,height:a}=e,{clientY:d,height:c}=this.nt.getElementCoordinates(this.J4);!(0,o.pv)(this.J4,"cnx-in-show-controls")&amp;&amp;!(0,h.mb)(this.J4)||r&lt;=d+c/2-a?e.clientY+=this.K4.top:(e.clientY-=this.K4.bottom,s=!0),this.J4.appendChild(i),(0,n.p)(i,e,this.r9,{alignMiddle:!0,alignTop:s,forceRight:!0,distanceFromMargin:this.K4.margin}),(0,o.Tp)(i),(0,o.cn)(i,"cnx-tooltip-animation-in"),this.Y4.push({component:t,domElement:i})}M$(t){if(!t.tooltip)return;const i=this.Y4.find((i=&gt;i.component===t));if(!i)return;const e=i.domElement;this.J4.removeChild(e),this.Y4=this.Y4.filter((i=&gt;i.component!==t))}i9(t){if(!t.tooltip)return;const i=this.Y4.find((t=&gt;t.component===this.t9));i&amp;&amp;this.n9(i.domElement,t.tooltip)}e9(){this.t9=null,this.Y4.forEach((t=&gt;this.M$(t.component)))}}var d=e(2197),c=e(1749);class l extends d.${constructor(t,i,e,s,r={},n){super(n,t,i,e,s),this.n3=new a(this.$uiContainer,i,r.isMobile)}updateDuration(t,i){const e=this.getComponent(s.r.ProgressBar);if(null==e||e.updateWcagAttributes(t,i),!(0,o.pv)(this.$uiContainer,"cnx-in-show-controls"))return;const r=this.getComponent(s.r.ElapsedTimeLabel),n=this.getComponent(s.r.TotalDurationLabel);if(r&amp;&amp;r.setTime(t),n&amp;&amp;n.setTime(i),e){const s=0,r=i,n=0,h=100;e.setMaxRange(Math.round(i)),e.setProgress((0,c.dQ)(s,r,n,h,t))}}updateVolume(t){}expand(){this.getComponent(s.r.ExpandButton).setState(1)}collapse(){this.getComponent(s.r.ExpandButton).setState(0)}v3(t,i,e){let s=e;switch(i.payload&amp;&amp;i.payload.targetComponent&amp;&amp;(s=i.payload.targetComponent),t){case r.C[r.C.HoverStart]:this.n3.hoverStart(s);break;case r.C[r.C.HoverEnd]:this.n3.hoverEnd(s);break;case r.C[r.C.StateChanged]:this.n3.stateChanged(s)}}}},4492:(t,i,e)=&gt;{e.d(i,{w:()=&gt;s});class s{constructor(t){this.ep=t}onClick(){}canTransitionToState(t){return!0}enterState(){this.K2(),this.ep.currentState=this}}},4052:(t,i,e)=&gt;{e.d(i,{d:()=&gt;n});var s=e(6916),r=e(4492);class n extends r.w{exitState(){var t;const i=this.ep.getComponent(s.r.BigPlayButton);null===(t=null==i?void 0:i.getContainer())||void 0===t||t.removeAttribute("tabindex"),this.ep.$uiContainer.classList.remove("cnx-is-paused")}K2(){var t;this.ep.$uiContainer.classList.add("cnx-is-paused");const i=this.ep.getComponent(s.r.PlayButton);i&amp;&amp;i.setState(0);const e=this.ep.getComponent(s.r.BigPlayButton);e&amp;&amp;(null===(t=e.getContainer())||void 0===t||t.setAttribute("tabindex","0"),e.setState(0))}}},3592:(t,i,e)=&gt;{e.d(i,{_:()=&gt;n});var s=e(6916),r=e(4492);class n extends r.w{exitState(){this.ep.$uiContainer.classList.remove("cnx-is-playing")}K2(){this.ep.$uiContainer.classList.add("cnx-is-playing");const t=this.ep.getComponent(s.r.PlayButton);t&amp;&amp;t.setState(1);const i=this.ep.getComponent(s.r.BigPlayButton);i&amp;&amp;i.setState(1)}}},1568:(t,i,e)=&gt;{function s(t,i,e,s){t.style.top=`${function(t,i,e,s,r){let n=i-s.clientY;const h=s.clientY+s.height-i;r.alignTop&amp;&amp;n&gt;t.offsetHeight?n-=t.offsetHeight:!r.alignTop&amp;&amp;h<t.offsetheight?n-=t.offsetheight-h:(n+=e,n+t.offsetheight>s.height&amp;&amp;(n=s.height-t.offsetHeight));return n}(t,i.clientY,i.height,e,s)}px`,t.style.left=`${function(t,i,e,s){const r=s.distanceFromMargin||0;let n=Math.ceil(i)-Math.ceil(e.clientX),h=i,o=h+t.offsetWidth;const a=e.clientX+e.width;if(s.alignMiddle){const i=t.offsetWidth/2;n-=Math.ceil(i),h-=i,o-=i}if(s.alignMiddle||s.forceRight)return e.clientX&gt;h?n=0+r:a<o&&(n-=math.ceil(o)-math.ceil(a)+r),n;o>a&amp;&amp;(n-=t.offsetWidth);return n}(t,i.clientX,e,s)}px`}e.d(i,{p:()=&gt;s})},5269:(t,i,e)=&gt;{e.d(i,{T_:()=&gt;d,VK:()=&gt;c,fh:()=&gt;o,vY:()=&gt;a,yt:()=&gt;h});var s=e(6637),r=e(5394),n=e(822);const h={enableWorker:!0,startFragPrefetch:!0,capLevelToPlayerSize:!0,maxBufferSize:5e6,maxBufferLength:5,maxMaxBufferLength:10,liveBackBufferLength:90,backBufferLength:1/0,lowLatencyMode:!0,ignoreDevicePixelRatio:!0,debug:"true"===(0,r.Ph)("cnxHlsDebug",(0,s.pE)(window).topFrame.location.href)};function o(){const t=self.MediaSource||self.WebKitMediaSource;if(!t)return!1;const i=self.SourceBuffer||self.WebKitSourceBuffer,e="function"==typeof t.isTypeSupported&amp;&amp;t.isTypeSupported('video/mp4; codecs="avc1.42E01E,mp4a.40.2"'),s=!i||i.prototype&amp;&amp;"function"==typeof i.prototype.appendBuffer&amp;&amp;"function"==typeof i.prototype.remove;return!!e&amp;&amp;!!s}const a=t=&gt;(0,n.QM)(t.canPlayType("application/vnd.apple.mpegurl"));function d(t){const i=[];return t.forEach((t=&gt;{i.some((i=&gt;i.height===t.height))||i.push(t)})),i}function c(t,i){return t.reduce(((t,e)=&gt;{if(!t)return e;const s=Math.abs(t.height-i);return Math.abs(e.height-i)<s?e:t}),void 0)}},466:(t,i,e)="">{e.d(i,{P:()=&gt;h});var s=e(7582),r=e(2134),n=e(6374);let h=class{constructor(){this.jb=!1,this.qb=[],this.ps=new n.Q}on(t,i){if(!this.jb&amp;&amp;"requestAd"===t){this.jb=!0;const t=1e3;this.qb.forEach((i=&gt;{setTimeout((()=&gt;{i()}),t)})),this.qb.length=0}this.ps.on(t,i)}publish(t,i){this.jb?this.ps.trigger(t,i):this.qb.push((()=&gt;{this.publish(t,i)}))}remove(t,i){this.ps.remove(t,i)}removeAll(){this.ps.removeAll(),this.qb.length=0}};h=(0,s.gn)([(0,r.b2)(),(0,r.Yn)(r.Fw.ContainerScoped),(0,s.w6)("design:paramtypes",[])],h)},9395:(t,i,e)=&gt;{e.d(i,{H:()=&gt;n,g:()=&gt;h});var s=e(8671),r=e(1027);const n={[r.It.PRE_ROLL_SLOT]:s.cr.PRE_ROLL,[r.It.MID_ROLL_SLOT]:s.cr.MID_ROLL,[r.It.POST_ROLL_SLOT]:s.cr.POST_ROLL};function h(t){return n[t]||s.cr.AD_BREAK_TYPE_UNSPECIFIED}},4582:(t,i,e)=&gt;{e.d(i,{m:()=&gt;s});const s=[1,2,4,7,8]},8839:(t,i,e)=&gt;{e.d(i,{USER_CONSENT_API_MAPPING:()=&gt;s});const s={0:{windowPropertyName:"__cmp",framePropertyName:"__cmpLocator",getVendorConsentDataMethodName:"getVendorConsents",getConsentDataMethodName:"getConsentData"},1:{windowPropertyName:"__tcfapi",framePropertyName:"__tcfapiLocator",getVendorConsentDataMethodName:"getTCData",consentUpdateMethodName:"addEventListener",removeUpdateListenerMethodName:"removeEventListener"}}},4821:t=&gt;{t.exports='<svg class="cnx-color-icon" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M11 2L8.25 4.25 11 7zM0 7v9h5l6 5v-6.5L3.85 7zm17 4.5c0-1.965-1.2-3.735-3-4.5v3l2.8 2.8a3.73 3.73 0 0 0 .2-1.3zm3.4 7.45l-1.85-1.85-2.65-2.6-1.9-1.95-3-3-4.15-4.1-4.95-5L1.45 0 0 1.45 17.15 18.6 19 20.4l3.55 3.6L24 22.55zM14 23a11.83 11.83 0 0 0 3.65-1.55l-1.25-1.3c-.747.498-1.553.902-2.4 1.2V23zm9-11.5A11.77 11.77 0 0 0 14 0v1.6A10.53 10.53 0 0 1 20 16l1.45 1.45A11.99 11.99 0 0 0 23 11.5z"></path></svg>\n'},1353:t=&gt;{t.exports='<svg class="cnx-color-icon" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M5 4v16l16-8z" fill-rule="evenodd"></path></svg>\n'},6939:t=&gt;{t.exports='<svg class="cnx-color-icon" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M18 21h3V3h-3v18zM3 21l14-9L3 3v18z" fill-rule="evenodd"></path></svg>'}}]);

</s?e:t}),void></o&&(n-=math.ceil(o)-math.ceil(a)+r),n;o></t.offsetheight?n-=t.offsetheight-h:(n+=e,n+t.offsetheight></cnx></cnx></this.s5?this.p5=this.s5:this.p5=t}b5(t){this.mediator.publish(this,r.c[r.c.volume],{payload:t})}c5(t){0===t?this.$h.setstate(0):this.$h.setstate(1)}l5(t){this.m5.setprogress(t)}}},2764:(t,i,e)=></mt.fh&&(t=mt.fh),t<this._m?this._m:t}pm(){this.li.push(this.am.getbidevents(3).subscribe((t=></mt.zt-mt.p8){const></r)),h=!!(null==e?void></zn(t)));return!r&&!n}ep(t,i){if(t.aggregators.size></zn(i))),n=s.some((t=></zn(t))}lp(){const></s.adslotpositionlist[0]||n></t.filterlist.length;s++){const></t;i++){const></i)}eb(t){return!!t.ad}rb(t,i,e){const></t.attributes.length;i++)e=t.attributes.item(i),this.keyattributes[e.name.tolowercase()]=br(e.value.trim())}}function></t.childnodes.length;n++)i=t.childnodes.item(n),(i.nodetype-1|1)===node.text_node?e+=i.nodetype===node.text_node?i.nodevalue.trim():i.nodevalue:1!==i.nodetype||i.prefix||(s=i.nodename.tolowercase(),r=new></t.length;i++){const[s,r]=t[i].range,n=t[i].increment||e;if(o></t.length;s++){const[r,n]=t[s].range,h=t[s].increment||e;if(i></t[0].range[0])return></img></arguments.length;i++)t[i]=arguments[i];var></r)return{requestedfloorprice:t.price,floorpriceinformation:new></n.requestedfloorprice&&(0,ft.fh)({message:"admanager_headerbidderrequester_cpm_lower_than_floorprice",level:"warn",exception:`floorprices_${r}_floorprice_${n.requestedfloorprice}_index_${null===(s=n.floorpriceinformation)||void></t.length;e++)if(t[e].width></body>
</html>
