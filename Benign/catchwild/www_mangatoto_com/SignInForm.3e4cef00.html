<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SignInForm.3e4cef00.html</title>
</head>
<body>

<script>
import{c as x}from"./index.6a5a335b.js";import{R as a}from"./index.8365acb2.js";import{g as N}from"./index.f5993dad.js";import{c as q}from"./client.56225896.js";import{j as e}from"./jsx-runtime.7d759e48.js";import{F as k,a as v}from"./Field_TPWD.1c1b3f95.js";import{u as w}from"./useMutation.bcca56b6.js";const S=/^[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/;function f(c){return c?!!S.test(c):null}async function I(c={},l=null){const r=N`
  mutation mut_account_signIn($uniq: String, $pass: String) {
    mut_account_signIn(
      uniq: $uniq,
      pass: $pass,
    ) {
      err tof int
    }
  }
  `;return(await q().rawRequest(r,c)).data.mut_account_signIn}function A(c){const{addrs:l=[],errorCode:r=0,onBack_data:s=n=>{}}=c,u=`username-${a.useId()}`,[t,p]=a.useState(()=>l?.[0]?l[0]:""),[i,d]=a.useState(null);a.useEffect(()=>{t?/^\d+$/.test(t)?d("userId"):f(t)?d("email"):d("username"):d(null)},[t]),a.useEffect(()=>{s(t)},[t]);function m(n){p(n.target.value)}return e.jsxs("div",{className:"form-control w-full space-y-1",children:[e.jsx("label",{htmlFor:u,className:"label",children:e.jsxs("span",{className:"label-text text-base font-bold",children:[e.jsx("span",{className:x(i&&i!=="email"?"opacity-50":""),children:"Email"}),e.jsx("span",{className:x(i&&i!=="username"?"opacity-50":""),children:" / Username"}),e.jsx("span",{className:x(i&&i!=="userId"?"opacity-50":""),children:" / User ID"})]})}),l?.length?e.jsx("select",{id:u,className:"select select-bordered py-0 !outline-0",value:t,onChange:m,children:l.map(n=>e.jsx("option",{children:n},n))}):e.jsx("input",{id:u,type:"text",className:"input input-bordered !outline-0",value:t,onChange:m}),r===11&&e.jsx("div",{className:"text-xs text-error",children:"Can not be empty"}),r===12&&e.jsx("div",{className:"text-xs text-error",children:"Account does not exist"}),r===13&&e.jsx("div",{className:"text-xs text-error",children:"Account has been deleted"}),r===14&&e.jsx("div",{className:"text-xs text-error",children:"Account got banned"})]})}function R(c){const{onBack_status:l=()=>{}}=c,[r,s]=a.useState(0),[_,u]=a.useState(""),[t,p]=a.useState(""),[i,d]=a.useState(""),[m,n]=a.useState("initial");a.useEffect(()=>{l(m)},[m]),a.useEffect(()=>{f(t)?u(t):u("")},[t]);const g=w(I,{onSuccess:o=>{if(o.err){switch(o.err){case"in_session":window.location.reload();return;case"account_not_exists":s(12);break;case"account_got_deleted":s(13);break;case"account_got_banned":s(14);break;case"password_incorrect":s(22);break;case"bad_request":case"system_error":default:s(99);break}n("initial");return}if(o.tof===!0){n("success"),window.location.reload();return}s(99),n("initial")},onError:o=>{s(99),n("initial")}});function h(){if(!t){s(11);return}if(!i){s(21);return}s(0),n("loading"),g.mutate({uniq:t,pass:i})}function j(o){p(o),s(0)}function b(o){d(o),s(0)}function y(o){s(o)}return e.jsxs("fieldset",{className:"py-3 flex flex-col select-none space-y-5",children:[e.jsx(A,{errorCode:r,onBack_data:j}),e.jsx(k,{errorCode:r,onBack_data:b,title:!t||_?"Password / Temporary password":e.jsxs(e.Fragment,{children:[e.jsx("span",{children:"Password"}),e.jsx("del",{className:"opacity-50",children:" / Temporary password"})]})}),e.jsx(v,{addr:_,spread:!1,onBack_error:y}),r===99&&e.jsx("div",{className:"text-xs text-error",children:"System error, plase try again later."}),e.jsxs("button",{className:"btn btn-block btn-primary",onClick:h,children:[m==="loading"&&e.jsx("span",{className:"loading loading-spinner loading-xs"}),"Sign In"]})]})}export{R as S};

</script>

</body>
</html>
