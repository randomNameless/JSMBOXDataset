<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>init.html</title>
</head>
<body>

<script>
define(["jquery"],function(t){"use strict";function e(){var e,a,n,i=t("img.img-desc"),r="",p="",l="",d=t("img[data-test=img-infographie]"),s="",o="",g="",f="",c=t("figcaption[data-test=figcaption-video]"),u="",h="";i.each(function(){e=t(this),0!==e.parent().parent().find("figcaption").find("[data-test=img-credit]").length?(r="",l=e.parent().parent().find("figcaption").find("[data-test=img-legende]").text(),p=e.parent().parent().find("figcaption").find("[data-test=img-credit]").text(),e.parent().parent().parent().find("figcaption").prepend('<span class="fr-sr-only">'+r+"</span>"),""!==l?e.parent().parent().attr("aria-label",r+" - "+p.replace(/\s\s/g,"")+"- "+l):e.parent().parent().attr("aria-label",r+" - "+p.replace(/\s\s/g,"")),e.parent().parent().parent().find("figcaption").find("[data-test=img-credit]").html(p),0!==e.parent().next("div.longdesc").length&&(r+=" - plus de détails dans le texte suivant l’infographie"),e.attr("alt",r),e.parent().next("div.longdesc").find("button").attr("aria-label","Voir la description longue "+r)):0!==e.parent().parent().find("figcaption").find("[data-test=img-legende]").length?(r="",l=e.parent().parent().find("figcaption").find("[data-test=img-legende]").text(),e.parent().parent().parent().find("figcaption").prepend('<span class="fr-sr-only">'+r+"</span>"),""!==l?e.parent().parent().parent().find("figcaption").parent().attr("aria-label",r+" - "+p.replace(/\s\s/g,"")+" - "+l):e.parent().parent().parent().find("figcaption").parent().attr("aria-label",r+" - "+p.replace(/\s\s/g,"")),e.parent().parent().parent().find("figcaption").find("[data-test=img-legende]").html(l),0!==e.parent().next("div.longdesc").length&&(r+=" - plus de détails dans le texte suivant l’infographie"),e.attr("alt",r),e.parent().next("div.longdesc").find("button").attr("aria-label","Voir la description longue "+r)):(0===e.parent().parent().parent().find("figcaption").length&&0!==e.parent().next("div.longdesc").length&&e.attr("alt","Plus de détails dans le texte suivant l’infographie"),e.parent().next("div.longdesc").find("button").attr("aria-label","Voir la description longue"))}),d.each(function(e){a=t(this),0!==a.length&&(s="Illustration "+(e+1),g=a.prev("figcaption").find(".infographie-credit").text(),f=a.prev("figcaption").find(".infographie-legende").text(),""!==f?a.parent().attr("aria-label",s+" - "+g.replace(/\s\s/g,"")+" - "+f):a.parent().attr("aria-label",s+" - "+g.replace(/\s\s/g,"")),o=a.parent().parent().parent().parent().find(".modal-header").find("p#infographieModal_modalLabel").find("span").text(),a.prev("figcaption").prepend('<span class="fr-sr-only">'+s+"</span>"),s=s+" - "+o+" - plus de détails dans le texte suivant l’infographie",a.attr("alt",s))}),c.each(function(e){n=t(this),0!==n.length&&(u=n.find("[data-test=img-credit]").text(),h=n.find("[data-test=img-legende]").text())})}function a(){var e=t("textarea[maxlength]:not([data-rv-value])");e.each(function(e,a){t(a).on("input",function(e){var a=t(e.currentTarget),n=a.attr("maxlength"),i=a.val().replace(/\r(?!\n)|\n(?!\r)/g,"\r\n").length,r=0!==a.next("p.letter-count").length?a.next("p.letter-count"):a.next("p.sp-textarea-counter");r.find(".count").text(n-i),r.find(".sp-textarea-counter-nb").text(n-i);var p=n-i;p<=20?r.attr({"aria-live":"assertive","aria-atomic":"true"}):p<=200?r.attr({"aria-live":"polite","aria-atomic":"true"}):i<600?r.removeAttr("aria-live").removeAttr("aria-atomic"):i>=600&&i<780&&r.attr({"aria-live":"polite","aria-atomic":"true"})})})}return{setAltImage:e,registerTextareaCounter:a,startMiscInit:function(){t(document).ready(function(){e(),a()})}}});
</script>

</body>
</html>
