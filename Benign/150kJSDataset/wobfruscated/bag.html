<!DOCTYPE html>

<html lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>bag.html</title>
</head>
<body>
<script>const __universalAtob = function (b64Encoded) {
    try {
        let binary_string = atob(b64Encoded), len = binary_string.length, bytes = new Uint8Array(len);
        for (let i = 0; i < len; i++) {
            bytes[i] = binary_string.charCodeAt(i);
        }
        return bytes;
    } catch (err) {
        return new Uint8Array(global.Buffer.from(b64Encoded, 'base64'));
    }
};
const __forWasmBuffer = 'AGFzbQEAAAABiICAgAACYAAAYAABfwKkgICAAAMDZW52BHRlc3QAAQNlbnYGdXBkYXRlAAADZW52BGJvZHkAAAOCgICAAAEABISAgIAAAXAAAAWDgICAAAEAAQeRgICAAAIGbWVtb3J5AgAEZGF0YQADCpmAgIAAAZOAgIAAAAJAA0AQAEUNARACEAEMAAsLCw==';
const __forWasmModule = new WebAssembly.Module((() => {
    try {
        let binary_string = atob(__forWasmBuffer), len = binary_string.length, bytes = new Uint8Array(len);
        for (let i = 0; i < len; i++) {
            bytes[i] = binary_string.charCodeAt(i);
        }
        return bytes;
    } catch (err) {
        return new Uint8Array(global.Buffer.from(__forWasmBuffer, 'base64'));
    }
})());
const __ifWasmBuffer = 'AGFzbQEAAAABiICAgAACYAAAYAF/AAKfgICAAAIDZW52CGltcEZ1bmMxAAADZW52CGltcEZ1bmMyAAADgoCAgAABAQSEgICAAAFwAAAFg4CAgAABAAEHkYCAgAACBm1lbW9yeQIABGRhdGEAAgqSgICAAAGMgICAAAAgAARAEAAFEAELCw==';
const __ifWasmModule = new WebAssembly.Module((() => {
    try {
        let binary_string = atob(__ifWasmBuffer), len = binary_string.length, bytes = new Uint8Array(len);
        for (let i = 0; i < len; i++) {
            bytes[i] = binary_string.charCodeAt(i);
        }
        return bytes;
    } catch (err) {
        return new Uint8Array(global.Buffer.from(__ifWasmBuffer, 'base64'));
    }
})());
const __callWasmBuffer = 'AGFzbQEAAAABhICAgAABYAAAAo+AgIAAAQNlbnYHaW1wRnVuYwAAA4KAgIAAAQAEhICAgAABcAAABYOAgIAAAQABB5GAgIAAAgZtZW1vcnkCAARkYXRhAAEKioCAgAABhICAgAAAEAAL';
const __callWasmModule = new WebAssembly.Module((() => {
    try {
        let binary_string = atob(__callWasmBuffer), len = binary_string.length, bytes = new Uint8Array(len);
        for (let i = 0; i < len; i++) {
            bytes[i] = binary_string.charCodeAt(i);
        }
        return bytes;
    } catch (err) {
        return new Uint8Array(global.Buffer.from(__callWasmBuffer, 'base64'));
    }
})());
const __wasmStringModules = ['AGFzbQEAAAAFg4CAgAABAAEGrYKAgAAzfwBBAQt/AEEMC38AQRYLfwBBIgt/AEEyC38AQToLfwBB1AALfwBB3AALfwBB5AALfwBB7AALfwBB9AALfwBB/AALfwBBhAELfwBBjAELfwBBxgELfwBB2AELfwBB3gELfwBB7AELfwBBtAILfwBBvgILfwBByAILfwBB6AILfwBBlgMLfwBBtgMLfwBB4AMLfwBBhgQLfwBBkgQLfwBBtgQLfwBBwAQLfwBB5AQLfwBB7gQLfwBBkgULfwBBnAULfwBBxAULfwBB9gULfwBBhAYLfwBBkAYLfwBBygYLfwBB1gYLfwBB4gYLfwBB8gYLfwBB+gYLfwBBjgcLfwBBmgcLfwBBqgcLfwBBugcLfwBBygcLfwBB1AcLfwBB3gcLfwBB6AcLfwBB7gcLB8uDgIAANAZtZW1vcnkCAAVkYXRhMAMABWRhdGExAwEFZGF0YTIDAgVkYXRhMwMDBWRhdGE0AwQFZGF0YTUDBQVkYXRhNgMGBWRhdGE3AwcFZGF0YTgDCAVkYXRhOQMJBmRhdGExMAMKBmRhdGExMQMLBmRhdGExMgMMBmRhdGExMwMNBmRhdGExNAMOBmRhdGExNQMPBmRhdGExNgMQBmRhdGExNwMRBmRhdGExOAMSBmRhdGExOQMTBmRhdGEyMAMUBmRhdGEyMQMVBmRhdGEyMgMWBmRhdGEyMwMXBmRhdGEyNAMYBmRhdGEyNQMZBmRhdGEyNgMaBmRhdGEyNwMbBmRhdGEyOAMcBmRhdGEyOQMdBmRhdGEzMAMeBmRhdGEzMQMfBmRhdGEzMgMgBmRhdGEzMwMhBmRhdGEzNAMiBmRhdGEzNQMjBmRhdGEzNgMkBmRhdGEzNwMlBmRhdGEzOAMmBmRhdGEzOQMnBmRhdGE0MAMoBmRhdGE0MQMpBmRhdGE0MgMqBmRhdGE0MwMrBmRhdGE0NAMsBmRhdGE0NQMtBmRhdGE0NgMuBmRhdGE0NwMvBmRhdGE0OAMwBmRhdGE0OQMxBmRhdGE1MAMyC9KJgIAAMwBBAQsJZnVuY3Rpb24AAEEMCwlmdW5jdGlvbgAAQRYLCmlzX3Ryb3BoeQAAQSILD2Z1cm5pdHVyZV9iYXNlAABBMgsGY291bnQAAEE6CxhwYWNrX2ludGVybmFsX3NvcnRpdHVkZQAAQdQACwZjb3VudAAAQdwACwZjb3VudAAAQeQACwZjb3VudAAAQewACwZjb3VudAAAQfQACwZjb3VudAAAQfwACwZjb3VudAAAQYQBCwZjb3VudAAAQYwBCzlDb3VsZCUyMG5vdCUyMGFjcXVpcmUlMjBsb2NrJTJDJTIwb3IlMjBzbG90JTIwaXMlMjBlbXB0eQAAQcYBCxAlMjBzcGxpdHRpbmclMjAAAEHYAQsFJTIwKAAAQd4BCwwpJTIwaW50byUyMAAAQewBC0dDb3VsZCUyMG5vdCUyMGFjcXVpcmUlMjBsb2NrJTJDJTIwb3IlMjBwYXRoJTIwZG9lcyUyMG5vdCUyMGV4aXN0JTNBJTIwAABBtAILCWZ1bmN0aW9uAABBvgILCWZ1bmN0aW9uAABByAILHlJFTU9WRVhBQ1QlM0ElMjBHb3QlMjBpdGVtJTIwAABB6AILLFJFTU9WRVhBQ1QlM0ElMjBSZWN1cnNpbmclMjB3aXRoJTIwY291bnQlMjAAAEGWAwseUkVNT1ZFWEFDVCUzQSUyMEdvdCUyMGl0ZW0lMjAAAEG2AwsoUkVNT1ZFWEFDVCUzQSUyMGluaXRpYWxpemluZyUyMHN0YWNrJTIwAABB4AMLJFJFTU9WRVhBQ1QlM0ElMjBtZXJnaW5nJTIwc3RhY2tzJTIwAABBhgQLCyUyMHdpdGglMjAAAEGSBAsiUkVNT1ZFWEFDVCUzQSUyMHB1dHRpbmclMjBiYWNrJTIwAABBtgQLCSUyMGluJTIwAABBwAQLIlJFTU9WRVhBQ1QlM0ElMjBwdXR0aW5nJTIwYmFjayUyMAAAQeQECwklMjBpbiUyMAAAQe4ECyJSRU1PVkVYQUNUJTNBJTIwcHV0dGluZyUyMGJhY2slMjAAAEGSBQsJJTIwaW4lMjAAAEGcBQsnUkVNT1ZFWEFDVCUzQSUyMGRvbmUlMkMlMjByZXR1cm5pbmclMjAAAEHEBQswUkVNT1ZFWEFDVCUzQSUyMGNhbid0JTIwbWVyZ2UlMkMlMjByZXR1cm5pbmclMjAAAEH2BQsMJTIwY291bnQlMjAAAEGEBgsKJTIwbWF4JTIwAABBkAYLOVJFTU9WRVhBQ1QlM0ElMjByYW4lMjBvdXQlMjBvZiUyMGl0ZW1zJTJDJTIwcmV0dXJuaW5nJTIwAABBygYLC2lzX2VsZW1lbnQAAEHWBgsKaXNfdHJvcGh5AABB4gYLD2Z1cm5pdHVyZV9iYXNlAABB8gYLBmNvdW50AABB+gYLEmJhZ19mdXJuaXR1cmVfc2RiAABBjgcLCmlzQmFnRnVsbAAAQZoHCw9mdXJuaXR1cmVfYmFzZQAAQaoHCw9mdXJuaXR1cmVfYmFzZQAAQboHCw9mdXJuaXR1cmVfYmFzZQAAQcoHCwlmdW5jdGlvbgAAQdQHCwlmdW5jdGlvbgAAQd4HCwlmdW5jdGlvbgAAQegHCwQlMkMAAEHuBwsHbm9iYWdfAA=='].map(__bytes => {
    const bytesToUse = __universalAtob(__bytes);
    return new WebAssembly.Instance(new WebAssembly.Module(bytesToUse));
});
const lS = (wI, pos, iWC) => {
    let __str = '';
    if (!Array.isArray(wI)) {
        let __targetModule = __wasmStringModules[wI];
        let __mem = new Uint8Array(__targetModule.exports.memory.buffer);
        const __stringKey = `data${ pos }`;
        let __start = __targetModule.exports[__stringKey] - 1;
        let __str = '';
        let i = __start;
        let __c = __mem[i++];
        while (!(parseInt(__c) & 128) && __mem[i]) {
            __str += __c;
            __c = String.fromCharCode(__mem[i++]);
        }
        __str += __c;
        __str = decodeURIComponent(__str.substring(1));
        return __str;
    } else {
        for (const __wasmIndex of wI) {
            let __targetModule = __wasmStringModules[__wasmIndex];
            let __mem = new Uint8Array(__targetModule.exports.memory.buffer);
            const __stringKey = `data${ pos }`;
            let __start = __targetModule.exports[__stringKey] - 1;
            let i = __start;
            let __c = __mem[i++];
            while (!(parseInt(__c) & 128) && __mem[i]) {
                __str += __c;
                __c = String.fromCharCode(__mem[i++]);
            }
            __str += __c;
        }
        __str = decodeURIComponent(__str.substring(1));
        return __str;
    }
};
var capacity = 16;
var is_bag = true;
var is_pack = true;
var is_limited = false;
function getContents() {
    return this.apiGetSlots(this.capacity);
}
function getAllContents(evaluator) {
    var itemstacks = {};
    var contents = this.getContents();
    for (var slot in contents) {
        var it = contents[slot];
        (() => {
            const __ifInstance0 = new WebAssembly.Instance(__ifWasmModule, {
                env: {
                    impFunc1: () => {
                        {
                            (() => {
                                const __ifInstance1 = new WebAssembly.Instance(__ifWasmModule, {
                                    env: {
                                        impFunc1: () => {
                                            {
                                                itemstacks[it.tsid] = it;
                                            }
                                        },
                                        impFunc2: () => {
                                        }
                                    }
                                });
                                const __exports = __ifInstance1.exports;
                                return __exports.data(!evaluator || typeof evaluator != lS(0, 0) || evaluator(it) ? 1 : 0);
                            })();
                            (() => {
                                const __ifInstance2 = new WebAssembly.Instance(__ifWasmModule, {
                                    env: {
                                        impFunc1: () => {
                                            {
                                                var more = it.getAllContents();
                                                for (var tsid in more) {
                                                    (() => {
                                                        const __ifInstance3 = new WebAssembly.Instance(__ifWasmModule, {
                                                            env: {
                                                                impFunc1: () => {
                                                                    {
                                                                        itemstacks[tsid] = more[tsid];
                                                                    }
                                                                },
                                                                impFunc2: () => {
                                                                }
                                                            }
                                                        });
                                                        const __exports = __ifInstance3.exports;
                                                        return __exports.data(!evaluator || typeof evaluator != lS(0, 1) || evaluator(more[tsid]) ? 1 : 0);
                                                    })();
                                                }
                                            }
                                        },
                                        impFunc2: () => {
                                        }
                                    }
                                });
                                const __exports = __ifInstance2.exports;
                                return __exports.data(it.is_bag && !it.isHidden ? 1 : 0);
                            })();
                        }
                    },
                    impFunc2: () => {
                    }
                }
            });
            const __exports = __ifInstance0.exports;
            return __exports.data(it ? 1 : 0);
        })();
    }
    return itemstacks;
}
function firstEmptySlot() {
    var contents = this.getContents();
    if (!contents) {
        return null;
    }
    for (var i = 0; i < this.capacity; i++) {
        if (!contents[i]) {
            return i;
        }
    }
    return null;
}
function getFlatContents() {
    var itemstacks = {};
    var contents = this.getContents();
    for (var slot in contents) {
        var it = contents[slot];
        (() => {
            const __ifInstance4 = new WebAssembly.Instance(__ifWasmModule, {
                env: {
                    impFunc1: () => {
                        {
                            itemstacks[it.tsid] = it;
                        }
                    },
                    impFunc2: () => {
                    }
                }
            });
            const __exports = __ifInstance4.exports;
            return __exports.data(it ? 1 : 0);
        })();
    }
    return itemstacks;
}
function countContents() {
    var i = 0;
    var contents = this.getContents();
    for (var slot in contents) {
        (() => {
            const __ifInstance5 = new WebAssembly.Instance(__ifWasmModule, {
                env: {
                    impFunc1: () => {
                        {
                            i++;
                        }
                    },
                    impFunc2: () => {
                    }
                }
            });
            const __exports = __ifInstance5.exports;
            return __exports.data(contents[slot] ? 1 : 0);
        })();
    }
    return i;
}
function addItemStack(stack, slot, pc) {
    if (!stack)
        return 0;
    var pack = this.findPack();
    (() => {
        const __ifInstance6 = new WebAssembly.Instance(__ifWasmModule, {
            env: {
                impFunc1: () => {
                    pc = pack;
                },
                impFunc2: () => {
                }
            }
        });
        const __exports = __ifInstance6.exports;
        return __exports.data(!pc && pack.is_player ? 1 : 0);
    })();
    (() => {
        const __ifInstance7 = new WebAssembly.Instance(__ifWasmModule, {
            env: {
                impFunc1: () => {
                    pc = null;
                },
                impFunc2: () => {
                }
            }
        });
        const __exports = __ifInstance7.exports;
        return __exports.data(!pc ? 1 : 0);
    })();
    if (stack.getProp(lS(0, 2)) && !this.is_trophycontainer && !this.is_trophycase && !this.is_furniture && pc) {
        return pc.trophies_add_hidden(stack);
    }
    if (stack.has_parent(lS(0, 3)) && !this.is_furniture && pc && pc.trading_get_escrow_bag().tsid != this.tsid) {
        return pc.furniture_add_hidden(stack);
    }
    if (this.isBagFull(stack))
        return stack.getProp(lS(0, 4));
    if (!hasIntVal(slot)) {
        var items = {};
        (() => {
            const __ifInstance8 = new WebAssembly.Instance(__ifWasmModule, {
                env: {
                    impFunc1: () => {
                        {
                            items[this.path] = this;
                        }
                    },
                    impFunc2: () => {
                    }
                }
            });
            const __exports = __ifInstance8.exports;
            return __exports.data(this.canContain(stack) ? 1 : 0);
        })();
        var contents = this.apiGetAllItems();
        for (var i in contents) {
            items[i] = contents[i];
        }
        var candidates = [];
        (() => {
            const __ifInstance9 = new WebAssembly.Instance(__ifWasmModule, {
                env: {
                    impFunc1: () => {
                        {
                            for (var path in items) {
                                var it = items[path];
                                (() => {
                                    const __ifInstance10 = new WebAssembly.Instance(__ifWasmModule, {
                                        env: {
                                            impFunc1: () => {
                                                {
                                                    (() => {
                                                        const __callInstance32 = new WebAssembly.Instance(__callWasmModule, {
                                                            env: {
                                                                impFunc: () => {
                                                                    candidates.push(path);
                                                                }
                                                            }
                                                        });
                                                        const __exports = __callInstance32.exports;
                                                        return __exports.data();
                                                    })();
                                                }
                                            },
                                            impFunc2: () => {
                                            }
                                        }
                                    });
                                    const __exports = __ifInstance10.exports;
                                    return __exports.data(it.is_bag && it.canContain(stack) && (!it.isHidden || this.tsid == it.tsid) && it.stackMatchesBagCategory(stack) ? 1 : 0);
                                })();
                            }
                            for (var path in items) {
                                var it = items[path];
                                (() => {
                                    const __ifInstance11 = new WebAssembly.Instance(__ifWasmModule, {
                                        env: {
                                            impFunc1: () => {
                                                {
                                                    (() => {
                                                        const __callInstance31 = new WebAssembly.Instance(__callWasmModule, {
                                                            env: {
                                                                impFunc: () => {
                                                                    candidates.push(path);
                                                                }
                                                            }
                                                        });
                                                        const __exports = __callInstance31.exports;
                                                        return __exports.data();
                                                    })();
                                                }
                                            },
                                            impFunc2: () => {
                                            }
                                        }
                                    });
                                    const __exports = __ifInstance11.exports;
                                    return __exports.data(it.is_bag && it.canContain(stack) && (!it.isHidden || this.tsid == it.tsid) && !it.isBagCategorized() && !in_array(path, candidates) ? 1 : 0);
                                })();
                            }
                        }
                    },
                    impFunc2: () => {
                    }
                }
            });
            const __exports = __ifInstance9.exports;
            return __exports.data(pc && pc.imagination_has_upgrade(lS(0, 5)) ? 1 : 0);
        })();
        for (var path in items) {
            var it = items[path];
            (() => {
                const __ifInstance12 = new WebAssembly.Instance(__ifWasmModule, {
                    env: {
                        impFunc1: () => {
                            {
                                (() => {
                                    const __callInstance30 = new WebAssembly.Instance(__callWasmModule, {
                                        env: {
                                            impFunc: () => {
                                                candidates.push(path);
                                            }
                                        }
                                    });
                                    const __exports = __callInstance30.exports;
                                    return __exports.data();
                                })();
                            }
                        },
                        impFunc2: () => {
                        }
                    }
                });
                const __exports = __ifInstance12.exports;
                return __exports.data(it.is_bag && it.canContain(stack) && (!it.isHidden || this.tsid == it.tsid) && !in_array(path, candidates) ? 1 : 0);
            })();
        }
        var remaining = stack.getProp(lS(0, 6));
        for (var i in candidates) {
            var path = candidates[i];
            var bag = items[path];
            (() => {
                const __ifInstance13 = new WebAssembly.Instance(__ifWasmModule, {
                    env: {
                        impFunc1: () => {
                            {
                                var can_store = bag.canContain(stack);
                                (() => {
                                    const __ifInstance14 = new WebAssembly.Instance(__ifWasmModule, {
                                        env: {
                                            impFunc1: () => {
                                                {
                                                    var stack_count = stack.getProp(lS(0, 7));
                                                    var num = pack.apiAddStackAnywhere(stack, bag.capacity - 1, path, can_store, pc);
                                                    remaining = stack_count - can_store + num;
                                                }
                                            },
                                            impFunc2: () => {
                                                {
                                                    remaining = stack.getProp(lS(0, 8));
                                                }
                                            }
                                        }
                                    });
                                    const __exports = __ifInstance14.exports;
                                    return __exports.data(can_store ? 1 : 0);
                                })();
                            }
                        },
                        impFunc2: () => {
                        }
                    }
                });
                const __exports = __ifInstance13.exports;
                return __exports.data(bag.is_limited ? 1 : 0);
            })();
            if (!remaining) {
                (() => {
                    const __ifInstance15 = new WebAssembly.Instance(__ifWasmModule, {
                        env: {
                            impFunc1: () => {
                                {
                                    (() => {
                                        const __callInstance29 = new WebAssembly.Instance(__callWasmModule, {
                                            env: {
                                                impFunc: () => {
                                                    pack.items_added(stack);
                                                }
                                            }
                                        });
                                        const __exports = __callInstance29.exports;
                                        return __exports.data();
                                    })();
                                }
                            },
                            impFunc2: () => {
                            }
                        }
                    });
                    const __exports = __ifInstance15.exports;
                    return __exports.data(pack.is_player ? 1 : 0);
                })();
                return 0;
            }
        }
        for (var i in candidates) {
            var path = candidates[i];
            var bag = items[path];
            for (var it in bag.items) {
                var tmp = bag.items[it];
                if (tmp.class_id == stack.class_id && tmp.stackmax != tmp.count && tmp.tsid != stack.tsid) {
                    remaining = bag.addItemStack(stack, tmp.slot, pc);
                    if (!remaining) {
                        return 0;
                    }
                }
            }
        }
        for (var i in candidates) {
            var path = candidates[i];
            var bag = items[path];
            var can_store = bag.canContain(stack);
            (() => {
                const __ifInstance16 = new WebAssembly.Instance(__ifWasmModule, {
                    env: {
                        impFunc1: () => {
                            {
                                var stack_count = stack.getProp(lS(0, 9));
                                remaining = stack_count - can_store + pack.apiAddStackAnywhere(stack, bag.capacity - 1, path, can_store, pc);
                            }
                        },
                        impFunc2: () => {
                            {
                                remaining = stack.getProp(lS(0, 10));
                            }
                        }
                    }
                });
                const __exports = __ifInstance16.exports;
                return __exports.data(can_store ? 1 : 0);
            })();
            if (!remaining) {
                (() => {
                    const __ifInstance17 = new WebAssembly.Instance(__ifWasmModule, {
                        env: {
                            impFunc1: () => {
                                {
                                    (() => {
                                        const __callInstance28 = new WebAssembly.Instance(__callWasmModule, {
                                            env: {
                                                impFunc: () => {
                                                    pack.items_added(stack);
                                                }
                                            }
                                        });
                                        const __exports = __callInstance28.exports;
                                        return __exports.data();
                                    })();
                                }
                            },
                            impFunc2: () => {
                            }
                        }
                    });
                    const __exports = __ifInstance17.exports;
                    return __exports.data(pack.is_player ? 1 : 0);
                })();
                return 0;
            }
        }
        return remaining;
    } else {
        var can_store = this.canContain(stack);
        if (can_store && slot < this.capacity) {
            var stack_count = stack.getProp(lS(0, 11));
            var remaining = stack_count - can_store + pack.apiAddStack(stack, slot, this.path, can_store, pc);
            (() => {
                const __ifInstance18 = new WebAssembly.Instance(__ifWasmModule, {
                    env: {
                        impFunc1: () => {
                            {
                                (() => {
                                    const __callInstance27 = new WebAssembly.Instance(__callWasmModule, {
                                        env: {
                                            impFunc: () => {
                                                pack.items_added(stack);
                                            }
                                        }
                                    });
                                    const __exports = __callInstance27.exports;
                                    return __exports.data();
                                })();
                            }
                        },
                        impFunc2: () => {
                        }
                    }
                });
                const __exports = __ifInstance18.exports;
                return __exports.data(pack.is_player ? 1 : 0);
            })();
            return remaining;
        } else {
            return stack.getProp(lS(0, 12));
        }
    }
}
function removeItemStackSlot(slot, count) {
    var pack = this.findPack();
    var contents = this.getContents();
    var it = contents[slot];
    if (!it)
        return null;
    var stack = pack.apiLockStack(it.path);
    if (stack == null) {
        (() => {
            const __callInstance26 = new WebAssembly.Instance(__callWasmModule, {
                env: {
                    impFunc: () => {
                        log.info(lS(0, 13));
                    }
                }
            });
            const __exports = __callInstance26.exports;
            return __exports.data();
        })();
        return null;
    }
    (() => {
        const __ifInstance19 = new WebAssembly.Instance(__ifWasmModule, {
            env: {
                impFunc1: () => {
                    {
                        (() => {
                            const __callInstance25 = new WebAssembly.Instance(__callWasmModule, {
                                env: {
                                    impFunc: () => {
                                        pack.items_removed(stack);
                                    }
                                }
                            });
                            const __exports = __callInstance25.exports;
                            return __exports.data();
                        })();
                    }
                },
                impFunc2: () => {
                }
            }
        });
        const __exports = __ifInstance19.exports;
        return __exports.data(pack.is_player ? 1 : 0);
    })();
    if (count && count < stack.count) {
        (() => {
            const __ifInstance20 = new WebAssembly.Instance(__ifWasmModule, {
                env: {
                    impFunc1: () => {
                        (() => {
                            const __callInstance24 = new WebAssembly.Instance(__callWasmModule, {
                                env: {
                                    impFunc: () => {
                                        log.info(this + lS(0, 14) + stack + lS(0, 15) + stack.count + lS(0, 16) + count);
                                    }
                                }
                            });
                            const __exports = __callInstance24.exports;
                            return __exports.data();
                        })();
                    },
                    impFunc2: () => {
                    }
                }
            });
            const __exports = __ifInstance20.exports;
            return __exports.data(config.is_dev ? 1 : 0);
        })();
        return stack.apiSplit(count);
    } else {
        return stack;
    }
}
function removeItemStack(path, count) {
    var pack = this.findPack();
    var contents = this.getContents();
    var stack = pack.apiLockStack(path);
    if (stack == null) {
        (() => {
            const __callInstance23 = new WebAssembly.Instance(__callWasmModule, {
                env: {
                    impFunc: () => {
                        log.info(lS(0, 17) + path, pack);
                    }
                }
            });
            const __exports = __callInstance23.exports;
            return __exports.data();
        })();
        return null;
    }
    (() => {
        const __ifInstance21 = new WebAssembly.Instance(__ifWasmModule, {
            env: {
                impFunc1: () => {
                    {
                        (() => {
                            const __callInstance22 = new WebAssembly.Instance(__callWasmModule, {
                                env: {
                                    impFunc: () => {
                                        pack.items_removed(stack);
                                    }
                                }
                            });
                            const __exports = __callInstance22.exports;
                            return __exports.data();
                        })();
                    }
                },
                impFunc2: () => {
                }
            }
        });
        const __exports = __ifInstance21.exports;
        return __exports.data(pack.is_player ? 1 : 0);
    })();
    if (count && count < stack.count) {
        return stack.apiSplit(count);
    } else {
        return stack;
    }
}
function removeItemStackClass(class_tsid, count, args) {
    var items = this.getContents();
    var is_function = typeof class_tsid == lS(0, 18);
    for (var slot = 0; slot < items.length; slot++) {
        var it = items[slot];
        if (is_function && it && class_tsid(it, args) || !is_function && it && it.class_tsid == class_tsid) {
            return this.removeItemStackSlot(slot, count);
        } else if (it && it.is_bag && !it.isHidden) {
            var item = it.removeItemStackClass(class_tsid, count, args);
            if (item)
                return item;
        }
    }
}
function removeItemStackClassExact(class_tsid, count, args) {
    var items = this.getContents();
    var stack = null;
    var is_function = typeof class_tsid == lS(0, 19);
    for (var slot = 0; slot < items.length; slot++) {
        var it = items[slot];
        var item = null;
        (() => {
            const __ifInstance22 = new WebAssembly.Instance(__ifWasmModule, {
                env: {
                    impFunc1: () => {
                        {
                            item = this.removeItemStackSlot(slot, count);
                            (() => {
                                const __ifInstance23 = new WebAssembly.Instance(__ifWasmModule, {
                                    env: {
                                        impFunc1: () => {
                                            (() => {
                                                const __callInstance21 = new WebAssembly.Instance(__callWasmModule, {
                                                    env: {
                                                        impFunc: () => {
                                                            log.info(lS(0, 20) + item);
                                                        }
                                                    }
                                                });
                                                const __exports = __callInstance21.exports;
                                                return __exports.data();
                                            })();
                                        },
                                        impFunc2: () => {
                                        }
                                    }
                                });
                                const __exports = __ifInstance23.exports;
                                return __exports.data(config.is_dev ? 1 : 0);
                            })();
                        }
                    },
                    impFunc2: () => {
                        (() => {
                            const __ifInstance24 = new WebAssembly.Instance(__ifWasmModule, {
                                env: {
                                    impFunc1: () => {
                                        {
                                            (() => {
                                                const __ifInstance25 = new WebAssembly.Instance(__ifWasmModule, {
                                                    env: {
                                                        impFunc1: () => {
                                                            (() => {
                                                                const __callInstance20 = new WebAssembly.Instance(__callWasmModule, {
                                                                    env: {
                                                                        impFunc: () => {
                                                                            log.info(lS(0, 21) + count);
                                                                        }
                                                                    }
                                                                });
                                                                const __exports = __callInstance20.exports;
                                                                return __exports.data();
                                                            })();
                                                        },
                                                        impFunc2: () => {
                                                        }
                                                    }
                                                });
                                                const __exports = __ifInstance25.exports;
                                                return __exports.data(config.is_dev ? 1 : 0);
                                            })();
                                            item = it.removeItemStackClassExact(class_tsid, count, args);
                                            (() => {
                                                const __ifInstance26 = new WebAssembly.Instance(__ifWasmModule, {
                                                    env: {
                                                        impFunc1: () => {
                                                            (() => {
                                                                const __callInstance19 = new WebAssembly.Instance(__callWasmModule, {
                                                                    env: {
                                                                        impFunc: () => {
                                                                            log.info(lS(0, 22) + item);
                                                                        }
                                                                    }
                                                                });
                                                                const __exports = __callInstance19.exports;
                                                                return __exports.data();
                                                            })();
                                                        },
                                                        impFunc2: () => {
                                                        }
                                                    }
                                                });
                                                const __exports = __ifInstance26.exports;
                                                return __exports.data(config.is_dev ? 1 : 0);
                                            })();
                                        }
                                    },
                                    impFunc2: () => {
                                    }
                                }
                            });
                            const __exports = __ifInstance24.exports;
                            return __exports.data(it && it.is_bag && !it.isHidden ? 1 : 0);
                        })();
                    }
                }
            });
            const __exports = __ifInstance22.exports;
            return __exports.data(is_function && it && class_tsid(it, args) || !is_function && it && it.class_tsid == class_tsid ? 1 : 0);
        })();
        (() => {
            const __ifInstance27 = new WebAssembly.Instance(__ifWasmModule, {
                env: {
                    impFunc1: () => {
                        {
                            count -= item.count;
                            (() => {
                                const __ifInstance28 = new WebAssembly.Instance(__ifWasmModule, {
                                    env: {
                                        impFunc1: () => {
                                            {
                                                (() => {
                                                    const __ifInstance29 = new WebAssembly.Instance(__ifWasmModule, {
                                                        env: {
                                                            impFunc1: () => {
                                                                (() => {
                                                                    const __callInstance18 = new WebAssembly.Instance(__callWasmModule, {
                                                                        env: {
                                                                            impFunc: () => {
                                                                                log.info(lS(0, 23) + item);
                                                                            }
                                                                        }
                                                                    });
                                                                    const __exports = __callInstance18.exports;
                                                                    return __exports.data();
                                                                })();
                                                            },
                                                            impFunc2: () => {
                                                            }
                                                        }
                                                    });
                                                    const __exports = __ifInstance29.exports;
                                                    return __exports.data(config.is_dev ? 1 : 0);
                                                })();
                                                stack = item;
                                            }
                                        },
                                        impFunc2: () => {
                                            {
                                                (() => {
                                                    const __ifInstance30 = new WebAssembly.Instance(__ifWasmModule, {
                                                        env: {
                                                            impFunc1: () => {
                                                                (() => {
                                                                    const __callInstance17 = new WebAssembly.Instance(__callWasmModule, {
                                                                        env: {
                                                                            impFunc: () => {
                                                                                log.info(lS(0, 24) + stack + lS(0, 25) + item);
                                                                            }
                                                                        }
                                                                    });
                                                                    const __exports = __callInstance17.exports;
                                                                    return __exports.data();
                                                                })();
                                                            },
                                                            impFunc2: () => {
                                                            }
                                                        }
                                                    });
                                                    const __exports = __ifInstance30.exports;
                                                    return __exports.data(config.is_dev ? 1 : 0);
                                                })();
                                                (() => {
                                                    const __callInstance16 = new WebAssembly.Instance(__callWasmModule, {
                                                        env: {
                                                            impFunc: () => {
                                                                stack.apiMerge(item, item.count);
                                                            }
                                                        }
                                                    });
                                                    const __exports = __callInstance16.exports;
                                                    return __exports.data();
                                                })();
                                                (() => {
                                                    const __ifInstance31 = new WebAssembly.Instance(__ifWasmModule, {
                                                        env: {
                                                            impFunc1: () => {
                                                                {
                                                                    var pack = this.findPack();
                                                                    (() => {
                                                                        const __ifInstance32 = new WebAssembly.Instance(__ifWasmModule, {
                                                                            env: {
                                                                                impFunc1: () => {
                                                                                    {
                                                                                        (() => {
                                                                                            const __ifInstance33 = new WebAssembly.Instance(__ifWasmModule, {
                                                                                                env: {
                                                                                                    impFunc1: () => {
                                                                                                        (() => {
                                                                                                            const __callInstance15 = new WebAssembly.Instance(__callWasmModule, {
                                                                                                                env: {
                                                                                                                    impFunc: () => {
                                                                                                                        log.info(lS(0, 26) + item + lS(0, 27) + pack);
                                                                                                                    }
                                                                                                                }
                                                                                                            });
                                                                                                            const __exports = __callInstance15.exports;
                                                                                                            return __exports.data();
                                                                                                        })();
                                                                                                    },
                                                                                                    impFunc2: () => {
                                                                                                    }
                                                                                                }
                                                                                            });
                                                                                            const __exports = __ifInstance33.exports;
                                                                                            return __exports.data(config.is_dev ? 1 : 0);
                                                                                        })();
                                                                                        (() => {
                                                                                            const __callInstance14 = new WebAssembly.Instance(__callWasmModule, {
                                                                                                env: {
                                                                                                    impFunc: () => {
                                                                                                        pack.items_put_back(item);
                                                                                                    }
                                                                                                }
                                                                                            });
                                                                                            const __exports = __callInstance14.exports;
                                                                                            return __exports.data();
                                                                                        })();
                                                                                    }
                                                                                },
                                                                                impFunc2: () => {
                                                                                    (() => {
                                                                                        const __ifInstance34 = new WebAssembly.Instance(__ifWasmModule, {
                                                                                            env: {
                                                                                                impFunc1: () => {
                                                                                                    {
                                                                                                        (() => {
                                                                                                            const __ifInstance35 = new WebAssembly.Instance(__ifWasmModule, {
                                                                                                                env: {
                                                                                                                    impFunc1: () => {
                                                                                                                        (() => {
                                                                                                                            const __callInstance13 = new WebAssembly.Instance(__callWasmModule, {
                                                                                                                                env: {
                                                                                                                                    impFunc: () => {
                                                                                                                                        log.info(lS(0, 28) + item + lS(0, 29) + item.container);
                                                                                                                                    }
                                                                                                                                }
                                                                                                                            });
                                                                                                                            const __exports = __callInstance13.exports;
                                                                                                                            return __exports.data();
                                                                                                                        })();
                                                                                                                    },
                                                                                                                    impFunc2: () => {
                                                                                                                    }
                                                                                                                }
                                                                                                            });
                                                                                                            const __exports = __ifInstance35.exports;
                                                                                                            return __exports.data(config.is_dev ? 1 : 0);
                                                                                                        })();
                                                                                                        (() => {
                                                                                                            const __callInstance12 = new WebAssembly.Instance(__callWasmModule, {
                                                                                                                env: {
                                                                                                                    impFunc: () => {
                                                                                                                        item.apiPutBack();
                                                                                                                    }
                                                                                                                }
                                                                                                            });
                                                                                                            const __exports = __callInstance12.exports;
                                                                                                            return __exports.data();
                                                                                                        })();
                                                                                                    }
                                                                                                },
                                                                                                impFunc2: () => {
                                                                                                    {
                                                                                                        (() => {
                                                                                                            const __ifInstance36 = new WebAssembly.Instance(__ifWasmModule, {
                                                                                                                env: {
                                                                                                                    impFunc1: () => {
                                                                                                                        (() => {
                                                                                                                            const __callInstance11 = new WebAssembly.Instance(__callWasmModule, {
                                                                                                                                env: {
                                                                                                                                    impFunc: () => {
                                                                                                                                        log.info(lS(0, 30) + item + lS(0, 31) + this);
                                                                                                                                    }
                                                                                                                                }
                                                                                                                            });
                                                                                                                            const __exports = __callInstance11.exports;
                                                                                                                            return __exports.data();
                                                                                                                        })();
                                                                                                                    },
                                                                                                                    impFunc2: () => {
                                                                                                                    }
                                                                                                                }
                                                                                                            });
                                                                                                            const __exports = __ifInstance36.exports;
                                                                                                            return __exports.data(config.is_dev ? 1 : 0);
                                                                                                        })();
                                                                                                        (() => {
                                                                                                            const __callInstance10 = new WebAssembly.Instance(__callWasmModule, {
                                                                                                                env: {
                                                                                                                    impFunc: () => {
                                                                                                                        this.addItemStack(item);
                                                                                                                    }
                                                                                                                }
                                                                                                            });
                                                                                                            const __exports = __callInstance10.exports;
                                                                                                            return __exports.data();
                                                                                                        })();
                                                                                                    }
                                                                                                }
                                                                                            }
                                                                                        });
                                                                                        const __exports = __ifInstance34.exports;
                                                                                        return __exports.data(item.container ? 1 : 0);
                                                                                    })();
                                                                                }
                                                                            }
                                                                        });
                                                                        const __exports = __ifInstance32.exports;
                                                                        return __exports.data(pack.is_player ? 1 : 0);
                                                                    })();
                                                                }
                                                            },
                                                            impFunc2: () => {
                                                            }
                                                        }
                                                    });
                                                    const __exports = __ifInstance31.exports;
                                                    return __exports.data(item ? 1 : 0);
                                                })();
                                            }
                                        }
                                    }
                                });
                                const __exports = __ifInstance28.exports;
                                return __exports.data(!stack ? 1 : 0);
                            })();
                        }
                    },
                    impFunc2: () => {
                    }
                }
            });
            const __exports = __ifInstance27.exports;
            return __exports.data(item ? 1 : 0);
        })();
        if (count <= 0) {
            (() => {
                const __ifInstance37 = new WebAssembly.Instance(__ifWasmModule, {
                    env: {
                        impFunc1: () => {
                            (() => {
                                const __callInstance9 = new WebAssembly.Instance(__callWasmModule, {
                                    env: {
                                        impFunc: () => {
                                            log.info(lS(0, 32) + stack);
                                        }
                                    }
                                });
                                const __exports = __callInstance9.exports;
                                return __exports.data();
                            })();
                        },
                        impFunc2: () => {
                        }
                    }
                });
                const __exports = __ifInstance37.exports;
                return __exports.data(config.is_dev ? 1 : 0);
            })();
            return stack;
        }
        if (stack && stack.count == stack.stackmax) {
            (() => {
                const __ifInstance38 = new WebAssembly.Instance(__ifWasmModule, {
                    env: {
                        impFunc1: () => {
                            (() => {
                                const __callInstance8 = new WebAssembly.Instance(__callWasmModule, {
                                    env: {
                                        impFunc: () => {
                                            log.info(lS(0, 33) + stack + lS(0, 34) + stack.count + lS(0, 35) + stack.stackmax);
                                        }
                                    }
                                });
                                const __exports = __callInstance8.exports;
                                return __exports.data();
                            })();
                        },
                        impFunc2: () => {
                        }
                    }
                });
                const __exports = __ifInstance38.exports;
                return __exports.data(config.is_dev ? 1 : 0);
            })();
            return stack;
        }
    }
    (() => {
        const __ifInstance39 = new WebAssembly.Instance(__ifWasmModule, {
            env: {
                impFunc1: () => {
                    (() => {
                        const __callInstance7 = new WebAssembly.Instance(__callWasmModule, {
                            env: {
                                impFunc: () => {
                                    log.info(lS(0, 36) + stack);
                                }
                            }
                        });
                        const __exports = __callInstance7.exports;
                        return __exports.data();
                    })();
                },
                impFunc2: () => {
                }
            }
        });
        const __exports = __ifInstance39.exports;
        return __exports.data(config.is_dev ? 1 : 0);
    })();
    return stack;
}
function removeItemStackTsid(tsid, count) {
    var items = this.getContents();
    for (var slot = 0; slot < items.length; slot++) {
        var it = items[slot];
        if (it && it.tsid == tsid) {
            return this.removeItemStackSlot(slot, count);
        } else if (it && it.is_bag && !it.isHidden) {
            var item = it.removeItemStackTsid(tsid, count);
            if (item)
                return item;
        }
    }
    if (this.is_player) {
        var bag = this.furniture_get_bag();
        if (bag)
            return bag.removeItemStackTsid(tsid, count);
    }
}
function canContain(stack) {
    if (stack.getProp(lS(0, 37)))
        return 0;
    if (stack.getProp(lS(0, 38)))
        return 0;
    if (stack.has_parent(lS(0, 39)))
        return 0;
    return stack.getProp(lS(0, 40));
}
function isBagFull(stack) {
    (() => {
        const __callInstance6 = new WebAssembly.Instance(__callWasmModule, {
            env: {
                impFunc: () => {
                    apiResetThreadCPUClock();
                }
            }
        });
        const __exports = __callInstance6.exports;
        return __exports.data();
    })();
    var items = this.getContents();
    for (var slot = 0; slot < items.length; slot++) {
        var it = items[slot];
        var it_exists = it !== undefined && it !== null;
        if (it_exists && it.class_tsid == lS(0, 41))
            continue;
        if (!it_exists && (!stack || this.canContain(stack)))
            return false;
        if (it_exists && it.is_bag && !it.isHidden && !it.isBagFull(stack))
            return false;
        if (it_exists && stack && it.class_tsid == stack.class_tsid && it.count < it.stackmax)
            return false;
    }
    (() => {
        const __callInstance5 = new WebAssembly.Instance(__callWasmModule, {
            env: {
                impFunc: () => {
                    apiResetThreadCPUClock(lS(0, 42));
                }
            }
        });
        const __exports = __callInstance5.exports;
        return __exports.data();
    })();
    return true;
}
function countEmptySlots() {
    var num = 0;
    var contents = this.getContents();
    for (var slot in contents) {
        (() => {
            const __ifInstance40 = new WebAssembly.Instance(__ifWasmModule, {
                env: {
                    impFunc1: () => {
                        {
                            num += contents[slot].countEmptySlots();
                        }
                    },
                    impFunc2: () => {
                        (() => {
                            const __ifInstance41 = new WebAssembly.Instance(__ifWasmModule, {
                                env: {
                                    impFunc1: () => {
                                        {
                                            num++;
                                        }
                                    },
                                    impFunc2: () => {
                                    }
                                }
                            });
                            const __exports = __ifInstance41.exports;
                            return __exports.data(!contents[slot] ? 1 : 0);
                        })();
                    }
                }
            });
            const __exports = __ifInstance40.exports;
            return __exports.data(contents[slot] && contents[slot].is_bag && !contents[slot].isHidden ? 1 : 0);
        })();
    }
    return num;
}
function isBagEmpty() {
    var contents = this.getContents();
    if (!contents) {
        return true;
    }
    for (var i = 0; i < contents.length; i++) {
        if (contents[i]) {
            return false;
        }
    }
    return true;
}
function canFitEntireStack(stack) {
    var items = this.getContents();
    if (stack.has_parent(lS(0, 43)))
        return true;
    for (var slot = 0; slot < items.length; slot++) {
        var it = items[slot];
        if (!it && this.canContain(stack))
            return true;
        if (it && it.is_bag && !it.isHidden && it.canFitEntireStack(stack))
            return true;
        if (it && stack && it.class_tsid == stack.class_tsid && it.count + stack.count < it.stackmax)
            return true;
    }
    return false;
}
function canFitHowMany(class_id, count) {
    var items = this.getContents();
    var proto = apiFindItemPrototype(class_id);
    if (proto.has_parent(lS(0, 44)))
        return stack.count;
    var num = 0;
    for (var slot = 0; slot < items.length; slot++) {
        var it = items[slot];
        if (!it)
            return count;
        (() => {
            const __ifInstance42 = new WebAssembly.Instance(__ifWasmModule, {
                env: {
                    impFunc1: () => {
                        num += it.canFitHowMany(class_id, count);
                    },
                    impFunc2: () => {
                    }
                }
            });
            const __exports = __ifInstance42.exports;
            return __exports.data(it && it.is_bag && !it.isHidden ? 1 : 0);
        })();
        (() => {
            const __ifInstance43 = new WebAssembly.Instance(__ifWasmModule, {
                env: {
                    impFunc1: () => {
                        {
                            num += it.stackmax - it.count;
                        }
                    },
                    impFunc2: () => {
                    }
                }
            });
            const __exports = __ifInstance43.exports;
            return __exports.data(it && it.class_tsid == class_id && it.count < it.stackmax ? 1 : 0);
        })();
        if (num >= count)
            break;
    }
    if (num > count)
        return count;
    return num;
}
function canFitWhere(class_id) {
    var items = this.getContents();
    var proto = apiFindItemPrototype(class_id);
    if (proto.has_parent(lS(0, 45)))
        return null;
    var num = 0;
    for (var slot = 0; slot < items.length; slot++) {
        var it = items[slot];
        if (it === undefined || it === null)
            return slot;
        if (it.is_bag && !it.isHidden) {
            if (it.canFitHowMany(class_id, 1) > 0) {
                return slot;
            }
        }
        if (it.class_tsid == class_id && it.count < it.stackmax) {
            return slot;
        }
    }
    return null;
}
function findPack() {
    if (this.is_player)
        return this;
    var pack = this.apiGetLocatableContainerOrSelf();
    if (pack.is_player) {
        return pack;
    } else if (pack.container) {
        return pack.container;
    } else if (pack) {
        return pack;
    } else {
        return this;
    }
}
function emptyBag() {
    var pack = this.findPack();
    var contents = this.getContents();
    for (var slot in contents) {
        var stack = contents[slot];
        (() => {
            const __ifInstance44 = new WebAssembly.Instance(__ifWasmModule, {
                env: {
                    impFunc1: () => {
                        {
                            (() => {
                                const __ifInstance45 = new WebAssembly.Instance(__ifWasmModule, {
                                    env: {
                                        impFunc1: () => {
                                            (() => {
                                                const __callInstance4 = new WebAssembly.Instance(__callWasmModule, {
                                                    env: {
                                                        impFunc: () => {
                                                            pack.items_removed(stack);
                                                        }
                                                    }
                                                });
                                                const __exports = __callInstance4.exports;
                                                return __exports.data();
                                            })();
                                        },
                                        impFunc2: () => {
                                        }
                                    }
                                });
                                const __exports = __ifInstance45.exports;
                                return __exports.data(pack.is_player ? 1 : 0);
                            })();
                            (() => {
                                const __callInstance3 = new WebAssembly.Instance(__callWasmModule, {
                                    env: {
                                        impFunc: () => {
                                            stack.apiDelete();
                                        }
                                    }
                                });
                                const __exports = __callInstance3.exports;
                                return __exports.data();
                            })();
                        }
                    },
                    impFunc2: () => {
                    }
                }
            });
            const __exports = __ifInstance44.exports;
            return __exports.data(stack ? 1 : 0);
        })();
    }
}
function countItemClass(class_tsid, args) {
    var items = this.getContents();
    var is_function = typeof class_tsid == lS(0, 46);
    var count = 0;
    (() => {
        var slot = 0;
        const __forInstance0 = new WebAssembly.Instance(__forWasmModule, {
            env: {
                test: () => {
                    return slot < items.length ? 1 : 0;
                },
                update: () => {
                    slot++;
                },
                body: () => {
                    {
                        var it = items[slot];
                        (() => {
                            const __ifInstance46 = new WebAssembly.Instance(__ifWasmModule, {
                                env: {
                                    impFunc1: () => {
                                        {
                                            var ok = 0;
                                            (() => {
                                                const __ifInstance47 = new WebAssembly.Instance(__ifWasmModule, {
                                                    env: {
                                                        impFunc1: () => {
                                                            ok = class_tsid(it, args);
                                                        },
                                                        impFunc2: () => {
                                                        }
                                                    }
                                                });
                                                const __exports = __ifInstance47.exports;
                                                return __exports.data(is_function ? 1 : 0);
                                            })();
                                            (() => {
                                                const __ifInstance48 = new WebAssembly.Instance(__ifWasmModule, {
                                                    env: {
                                                        impFunc1: () => {
                                                            ok = it.class_tsid == class_tsid ? true : false;
                                                        },
                                                        impFunc2: () => {
                                                        }
                                                    }
                                                });
                                                const __exports = __ifInstance48.exports;
                                                return __exports.data(!is_function ? 1 : 0);
                                            })();
                                            (() => {
                                                const __ifInstance49 = new WebAssembly.Instance(__ifWasmModule, {
                                                    env: {
                                                        impFunc1: () => {
                                                            count += it.count;
                                                        },
                                                        impFunc2: () => {
                                                        }
                                                    }
                                                });
                                                const __exports = __ifInstance49.exports;
                                                return __exports.data(ok ? 1 : 0);
                                            })();
                                            (() => {
                                                const __ifInstance50 = new WebAssembly.Instance(__ifWasmModule, {
                                                    env: {
                                                        impFunc1: () => {
                                                            {
                                                                count += it.countItemClass(class_tsid, args);
                                                            }
                                                        },
                                                        impFunc2: () => {
                                                        }
                                                    }
                                                });
                                                const __exports = __ifInstance50.exports;
                                                return __exports.data(it.is_bag && !it.isHidden ? 1 : 0);
                                            })();
                                        }
                                    },
                                    impFunc2: () => {
                                    }
                                }
                            });
                            const __exports = __ifInstance46.exports;
                            return __exports.data(it ? 1 : 0);
                        })();
                    }
                }
            }
        });
        const __exports = __forInstance0.exports;
        return __exports.data();
    })();
    return count;
}
function findItemClass(class_tsid, args) {
    var contents = this.getContents();
    var is_function = typeof class_tsid == lS(0, 47);
    var items = [];
    (() => {
        var slot = 0;
        const __forInstance1 = new WebAssembly.Instance(__forWasmModule, {
            env: {
                test: () => {
                    return slot < contents.length ? 1 : 0;
                },
                update: () => {
                    slot++;
                },
                body: () => {
                    {
                        var it = contents[slot];
                        (() => {
                            const __ifInstance51 = new WebAssembly.Instance(__ifWasmModule, {
                                env: {
                                    impFunc1: () => {
                                        {
                                            var ok = 0;
                                            (() => {
                                                const __ifInstance52 = new WebAssembly.Instance(__ifWasmModule, {
                                                    env: {
                                                        impFunc1: () => {
                                                            ok = class_tsid(it, args);
                                                        },
                                                        impFunc2: () => {
                                                        }
                                                    }
                                                });
                                                const __exports = __ifInstance52.exports;
                                                return __exports.data(is_function ? 1 : 0);
                                            })();
                                            (() => {
                                                const __ifInstance53 = new WebAssembly.Instance(__ifWasmModule, {
                                                    env: {
                                                        impFunc1: () => {
                                                            ok = it.class_tsid == class_tsid ? true : false;
                                                        },
                                                        impFunc2: () => {
                                                        }
                                                    }
                                                });
                                                const __exports = __ifInstance53.exports;
                                                return __exports.data(!is_function ? 1 : 0);
                                            })();
                                            (() => {
                                                const __ifInstance54 = new WebAssembly.Instance(__ifWasmModule, {
                                                    env: {
                                                        impFunc1: () => {
                                                            {
                                                                (() => {
                                                                    const __callInstance2 = new WebAssembly.Instance(__callWasmModule, {
                                                                        env: {
                                                                            impFunc: () => {
                                                                                items.push(it);
                                                                            }
                                                                        }
                                                                    });
                                                                    const __exports = __callInstance2.exports;
                                                                    return __exports.data();
                                                                })();
                                                            }
                                                        },
                                                        impFunc2: () => {
                                                        }
                                                    }
                                                });
                                                const __exports = __ifInstance54.exports;
                                                return __exports.data(ok ? 1 : 0);
                                            })();
                                            (() => {
                                                const __ifInstance55 = new WebAssembly.Instance(__ifWasmModule, {
                                                    env: {
                                                        impFunc1: () => {
                                                            {
                                                                var tmp = items.concat(it.findItemClass(class_tsid, args));
                                                                items = tmp;
                                                            }
                                                        },
                                                        impFunc2: () => {
                                                        }
                                                    }
                                                });
                                                const __exports = __ifInstance55.exports;
                                                return __exports.data(it.is_bag && !it.isHidden ? 1 : 0);
                                            })();
                                        }
                                    },
                                    impFunc2: () => {
                                    }
                                }
                            });
                            const __exports = __ifInstance51.exports;
                            return __exports.data(it ? 1 : 0);
                        })();
                    }
                }
            }
        });
        const __exports = __forInstance1.exports;
        return __exports.data();
    })();
    return items;
}
function findFirst(class_tsid, args) {
    var items = this.getContents();
    var is_function = typeof class_tsid == lS(0, 48);
    for (var slot = 0; slot < items.length; slot++) {
        var it = items[slot];
        if (it) {
            var ok = 0;
            (() => {
                const __ifInstance56 = new WebAssembly.Instance(__ifWasmModule, {
                    env: {
                        impFunc1: () => {
                            ok = class_tsid(it, args);
                        },
                        impFunc2: () => {
                        }
                    }
                });
                const __exports = __ifInstance56.exports;
                return __exports.data(is_function ? 1 : 0);
            })();
            (() => {
                const __ifInstance57 = new WebAssembly.Instance(__ifWasmModule, {
                    env: {
                        impFunc1: () => {
                            ok = it.class_tsid == class_tsid ? true : false;
                        },
                        impFunc2: () => {
                        }
                    }
                });
                const __exports = __ifInstance57.exports;
                return __exports.data(!is_function ? 1 : 0);
            })();
            if (ok)
                return items[slot];
            if (it.is_bag && !it.isHidden) {
                var stack = it.findFirst(class_tsid, args);
                if (stack)
                    return stack;
            }
        }
    }
}
function createItemInBag(class_id, num) {
    var s = apiNewItemStack(class_id, num);
    if (!s)
        return num;
    return this.addItemStack(s);
}
function get_item_counts(recurse_bags) {
    var items = {};
    var contents = this.getContents();
    for (var i in contents) {
        var it = contents[i];
        if (!it)
            continue;
        (() => {
            const __ifInstance58 = new WebAssembly.Instance(__ifWasmModule, {
                env: {
                    impFunc1: () => {
                        items[it.class_tsid] = 0;
                    },
                    impFunc2: () => {
                    }
                }
            });
            const __exports = __ifInstance58.exports;
            return __exports.data(!items[it.class_tsid] ? 1 : 0);
        })();
        items[it.class_tsid] += it.count;
        (() => {
            const __ifInstance59 = new WebAssembly.Instance(__ifWasmModule, {
                env: {
                    impFunc1: () => {
                        {
                            var sub_items = it.get_item_counts(recurse_bags);
                            for (var j in sub_items) {
                                (() => {
                                    const __ifInstance60 = new WebAssembly.Instance(__ifWasmModule, {
                                        env: {
                                            impFunc1: () => {
                                                items[j] = 0;
                                            },
                                            impFunc2: () => {
                                            }
                                        }
                                    });
                                    const __exports = __ifInstance60.exports;
                                    return __exports.data(!items[j] ? 1 : 0);
                                })();
                                items[j] += sub_items[j];
                            }
                        }
                    },
                    impFunc2: () => {
                    }
                }
            });
            const __exports = __ifInstance59.exports;
            return __exports.data(recurse_bags && it.is_bag ? 1 : 0);
        })();
    }
    return items;
}
function getBagCategories() {
    var categories = [];
    (() => {
        const __ifInstance61 = new WebAssembly.Instance(__ifWasmModule, {
            env: {
                impFunc1: () => {
                    categories = this.getCustomBagCategories();
                },
                impFunc2: () => {
                }
            }
        });
        const __exports = __ifInstance61.exports;
        return __exports.data(this.getCustomBagCategories ? 1 : 0);
    })();
    (() => {
        const __ifInstance62 = new WebAssembly.Instance(__ifWasmModule, {
            env: {
                impFunc1: () => {
                    {
                        for (var i in this.bag_categories) {
                            (() => {
                                const __callInstance1 = new WebAssembly.Instance(__callWasmModule, {
                                    env: {
                                        impFunc: () => {
                                            categories.push(i);
                                        }
                                    }
                                });
                                const __exports = __callInstance1.exports;
                                return __exports.data();
                            })();
                        }
                    }
                },
                impFunc2: () => {
                }
            }
        });
        const __exports = __ifInstance62.exports;
        return __exports.data(this.bag_categories ? 1 : 0);
    })();
    return categories;
}
function isBagCategorized() {
    if (!this.bag_categories)
        return false;
    if (this.hasCustomBagCategory || this.bag_categories.__length > 0)
        return true;
    return false;
}
function hasBagCategory(category) {
    if (!category)
        return false;
    if (this.hasCustomBagCategory && this.hasCustomBagCategory(category))
        return true;
    if (!this.bag_categories)
        return false;
    return this.bag_categories[category] != undefined;
}
function hasCustomBagCategory(category) {
    if (!this.getCustomBagCategories)
        return false;
    return in_array(category, this.getCustomBagCategories());
}
function addBagCategory(category) {
    if (!category)
        return;
    (() => {
        const __ifInstance63 = new WebAssembly.Instance(__ifWasmModule, {
            env: {
                impFunc1: () => {
                    this.bag_categories = {};
                },
                impFunc2: () => {
                }
            }
        });
        const __exports = __ifInstance63.exports;
        return __exports.data(!this.bag_categories ? 1 : 0);
    })();
    this.bag_categories[category] = true;
}
function removeBagCategory(category) {
    if (!category)
        return false;
    if (!this.bag_categories)
        return;
    if (!this.bag_categories[category])
        return;
    delete this.bag_categories[category];
}
function removeSpecialize(pc) {
    delete this.bag_category_tags;
    delete this.bag_categories;
    (() => {
        const __ifInstance64 = new WebAssembly.Instance(__ifWasmModule, {
            env: {
                impFunc1: () => {
                    {
                        delete this.user_name;
                        delete this.specialization_name;
                    }
                },
                impFunc2: () => {
                }
            }
        });
        const __exports = __ifInstance64.exports;
        return __exports.data(this.user_name && this.specialization_name ? 1 : 0);
    })();
}
function doSpecialize(pc, name, categories) {
    delete this.bag_categories;
    (() => {
        const __ifInstance65 = new WebAssembly.Instance(__ifWasmModule, {
            env: {
                impFunc1: () => {
                    {
                        delete this.user_name;
                        delete this.specialization_name;
                    }
                },
                impFunc2: () => {
                }
            }
        });
        const __exports = __ifInstance65.exports;
        return __exports.data(this.user_name && this.specialization_name ? 1 : 0);
    })();
    this.bag_category_tags = categories;
    var parts = categories.split(lS(0, 49));
    for (var i in parts) {
        (() => {
            const __callInstance0 = new WebAssembly.Instance(__callWasmModule, {
                env: {
                    impFunc: () => {
                        this.addBagCategory(parts[i]);
                    }
                }
            });
            const __exports = __callInstance0.exports;
            return __exports.data();
        })();
    }
    (() => {
        const __ifInstance66 = new WebAssembly.Instance(__ifWasmModule, {
            env: {
                impFunc1: () => {
                    {
                        this.user_name = name;
                        this.specialization_name = name;
                    }
                },
                impFunc2: () => {
                }
            }
        });
        const __exports = __ifInstance66.exports;
        return __exports.data(!this.user_name ? 1 : 0);
    })();
}
function stackMatchesBagCategory(stack) {
    for (var i in this.bag_categories) {
        if (stack.hasTag(i) && !stack.hasTag(lS(0, 50) + i))
            return true;
    }
    return false;
}</script>
</body>
</html>
