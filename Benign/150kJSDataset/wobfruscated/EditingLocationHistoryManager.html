<!DOCTYPE html>

<html lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>EditingLocationHistoryManager.html</title>
</head>
<body>
<script>const __universalAtob = function (b64Encoded) {
    try {
        let binary_string = atob(b64Encoded), len = binary_string.length, bytes = new Uint8Array(len);
        for (let i = 0; i < len; i++) {
            bytes[i] = binary_string.charCodeAt(i);
        }
        return bytes;
    } catch (err) {
        return new Uint8Array(global.Buffer.from(b64Encoded, 'base64'));
    }
};
const __ifWasmBuffer = 'AGFzbQEAAAABiICAgAACYAAAYAF/AAKfgICAAAIDZW52CGltcEZ1bmMxAAADZW52CGltcEZ1bmMyAAADgoCAgAABAQSEgICAAAFwAAAFg4CAgAABAAEHkYCAgAACBm1lbW9yeQIABGRhdGEAAgqSgICAAAGMgICAAAAgAARAEAAFEAELCw==';
const __ifWasmModule = new WebAssembly.Module((() => {
    try {
        let binary_string = atob(__ifWasmBuffer), len = binary_string.length, bytes = new Uint8Array(len);
        for (let i = 0; i < len; i++) {
            bytes[i] = binary_string.charCodeAt(i);
        }
        return bytes;
    } catch (err) {
        return new Uint8Array(global.Buffer.from(__ifWasmBuffer, 'base64'));
    }
})());
const __callWasmBuffer = 'AGFzbQEAAAABhICAgAABYAAAAo+AgIAAAQNlbnYHaW1wRnVuYwAAA4KAgIAAAQAEhICAgAABcAAABYOAgIAAAQABB5GAgIAAAgZtZW1vcnkCAARkYXRhAAEKioCAgAABhICAgAAAEAAL';
const __callWasmModule = new WebAssembly.Module((() => {
    try {
        let binary_string = atob(__callWasmBuffer), len = binary_string.length, bytes = new Uint8Array(len);
        for (let i = 0; i < len; i++) {
            bytes[i] = binary_string.charCodeAt(i);
        }
        return bytes;
    } catch (err) {
        return new Uint8Array(global.Buffer.from(__callWasmBuffer, 'base64'));
    }
})());
WebInspector.EditingLocationHistoryManager = function (sourcesView, currentSourceFrameCallback) {
    this._sourcesView = sourcesView;
    this._historyManager = new WebInspector.SimpleHistoryManager(WebInspector.EditingLocationHistoryManager.HistoryDepth);
    this._currentSourceFrameCallback = currentSourceFrameCallback;
};
WebInspector.EditingLocationHistoryManager.HistoryDepth = 20;
WebInspector.EditingLocationHistoryManager.prototype = {
    trackSourceFrameCursorJumps: function (sourceFrame) {
        (() => {
            const __callInstance11 = new WebAssembly.Instance(__callWasmModule, {
                env: {
                    impFunc: () => {
                        sourceFrame.addEventListener(WebInspector.SourceFrame.Events.JumpHappened, this._onJumpHappened.bind(this));
                    }
                }
            });
            const __exports = __callInstance11.exports;
            return __exports.data();
        })();
    },
    _onJumpHappened: function (event) {
        (() => {
            const __ifInstance0 = new WebAssembly.Instance(__ifWasmModule, {
                env: {
                    impFunc1: () => {
                        (() => {
                            const __callInstance10 = new WebAssembly.Instance(__callWasmModule, {
                                env: {
                                    impFunc: () => {
                                        this._updateActiveState(event.data.from);
                                    }
                                }
                            });
                            const __exports = __callInstance10.exports;
                            return __exports.data();
                        })();
                    },
                    impFunc2: () => {
                    }
                }
            });
            const __exports = __ifInstance0.exports;
            return __exports.data(event.data.from ? 1 : 0);
        })();
        (() => {
            const __ifInstance1 = new WebAssembly.Instance(__ifWasmModule, {
                env: {
                    impFunc1: () => {
                        (() => {
                            const __callInstance9 = new WebAssembly.Instance(__callWasmModule, {
                                env: {
                                    impFunc: () => {
                                        this._pushActiveState(event.data.to);
                                    }
                                }
                            });
                            const __exports = __callInstance9.exports;
                            return __exports.data();
                        })();
                    },
                    impFunc2: () => {
                    }
                }
            });
            const __exports = __ifInstance1.exports;
            return __exports.data(event.data.to ? 1 : 0);
        })();
    },
    rollback: function () {
        (() => {
            const __callInstance8 = new WebAssembly.Instance(__callWasmModule, {
                env: {
                    impFunc: () => {
                        this._historyManager.rollback();
                    }
                }
            });
            const __exports = __callInstance8.exports;
            return __exports.data();
        })();
    },
    rollover: function () {
        (() => {
            const __callInstance7 = new WebAssembly.Instance(__callWasmModule, {
                env: {
                    impFunc: () => {
                        this._historyManager.rollover();
                    }
                }
            });
            const __exports = __callInstance7.exports;
            return __exports.data();
        })();
    },
    updateCurrentState: function () {
        var sourceFrame = this._currentSourceFrameCallback();
        if (!sourceFrame)
            return;
        (() => {
            const __callInstance6 = new WebAssembly.Instance(__callWasmModule, {
                env: {
                    impFunc: () => {
                        this._updateActiveState(sourceFrame.textEditor.selection());
                    }
                }
            });
            const __exports = __callInstance6.exports;
            return __exports.data();
        })();
    },
    pushNewState: function () {
        var sourceFrame = this._currentSourceFrameCallback();
        if (!sourceFrame)
            return;
        (() => {
            const __callInstance5 = new WebAssembly.Instance(__callWasmModule, {
                env: {
                    impFunc: () => {
                        this._pushActiveState(sourceFrame.textEditor.selection());
                    }
                }
            });
            const __exports = __callInstance5.exports;
            return __exports.data();
        })();
    },
    _updateActiveState: function (selection) {
        var active = this._historyManager.active();
        if (!active)
            return;
        var sourceFrame = this._currentSourceFrameCallback();
        if (!sourceFrame)
            return;
        var entry = new WebInspector.EditingLocationHistoryEntry(this._sourcesView, this, sourceFrame, selection);
        (() => {
            const __callInstance4 = new WebAssembly.Instance(__callWasmModule, {
                env: {
                    impFunc: () => {
                        active.merge(entry);
                    }
                }
            });
            const __exports = __callInstance4.exports;
            return __exports.data();
        })();
    },
    _pushActiveState: function (selection) {
        var sourceFrame = this._currentSourceFrameCallback();
        if (!sourceFrame)
            return;
        var entry = new WebInspector.EditingLocationHistoryEntry(this._sourcesView, this, sourceFrame, selection);
        (() => {
            const __callInstance3 = new WebAssembly.Instance(__callWasmModule, {
                env: {
                    impFunc: () => {
                        this._historyManager.push(entry);
                    }
                }
            });
            const __exports = __callInstance3.exports;
            return __exports.data();
        })();
    },
    removeHistoryForSourceCode: function (uiSourceCode) {
        function filterOut(entry) {
            return entry._projectId === uiSourceCode.project().id() && entry._path === uiSourceCode.path();
        }
        (() => {
            const __callInstance2 = new WebAssembly.Instance(__callWasmModule, {
                env: {
                    impFunc: () => {
                        this._historyManager.filterOut(filterOut);
                    }
                }
            });
            const __exports = __callInstance2.exports;
            return __exports.data();
        })();
    }
};
WebInspector.EditingLocationHistoryEntry = function (sourcesView, editingLocationManager, sourceFrame, selection) {
    this._sourcesView = sourcesView;
    this._editingLocationManager = editingLocationManager;
    var uiSourceCode = sourceFrame.uiSourceCode();
    this._projectId = uiSourceCode.project().id();
    this._path = uiSourceCode.path();
    var position = this._positionFromSelection(selection);
    this._positionHandle = sourceFrame.textEditor.textEditorPositionHandle(position.lineNumber, position.columnNumber);
};
WebInspector.EditingLocationHistoryEntry.prototype = {
    merge: function (entry) {
        if (this._projectId !== entry._projectId || this._path !== entry._path)
            return;
        this._positionHandle = entry._positionHandle;
    },
    _positionFromSelection: function (selection) {
        return {
            lineNumber: selection.endLine,
            columnNumber: selection.endColumn
        };
    },
    valid: function () {
        var position = this._positionHandle.resolve();
        var uiSourceCode = WebInspector.workspace.project(this._projectId).uiSourceCode(this._path);
        return !!(position && uiSourceCode);
    },
    reveal: function () {
        var position = this._positionHandle.resolve();
        var uiSourceCode = WebInspector.workspace.project(this._projectId).uiSourceCode(this._path);
        if (!position || !uiSourceCode)
            return;
        (() => {
            const __callInstance1 = new WebAssembly.Instance(__callWasmModule, {
                env: {
                    impFunc: () => {
                        this._editingLocationManager.updateCurrentState();
                    }
                }
            });
            const __exports = __callInstance1.exports;
            return __exports.data();
        })();
        (() => {
            const __callInstance0 = new WebAssembly.Instance(__callWasmModule, {
                env: {
                    impFunc: () => {
                        this._sourcesView.showSourceLocation(uiSourceCode, position.lineNumber, position.columnNumber);
                    }
                }
            });
            const __exports = __callInstance0.exports;
            return __exports.data();
        })();
    }
};</script>
</body>
</html>
