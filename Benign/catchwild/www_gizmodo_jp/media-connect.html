<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>media-connect.html</title>
</head>
<body>

<script>
!function(){function e(t,n,i){function r(o,l){if(!n[o]){if(!t[o]){var s="function"==typeof require&&require;if(!l&&s)return s(o,!0);if(a)return a(o,!0);var u=new Error("Cannot find module '"+o+"'");throw u.code="MODULE_NOT_FOUND",u}var c=n[o]={exports:{}};t[o][0].call(c.exports,function(e){return r(t[o][1][e]||e)},c,c.exports,e,t,n,i)}return n[o].exports}for(var a="function"==typeof require&&require,o=0;o<i.length;o++)r(i[o]);return r}return e}()({1:[function(e,t,n){!function(t,i){if("function"==typeof define&&define.amd)define(["exports","./model/McnFormType"],i);else if(void 0!==n)i(n,e("./model/McnFormType"));else{var r={exports:{}};i(r.exports,t.McnFormType),t.mediaConnect=r.exports}}(this,function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var i=function(e){return e&&e.__esModule?e:{default:e}}(t),r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),o=function(){function e(t){n(this,e),this.data=[],this.name=t}return a(e,[{key:"settings",value:function(e){return this.ids=e.ids||[],this.limit=e.limit||0,this.mediaPrefix=e.mediaPrefix||"",this.shuffleType=e.shuffleType||"random",this.permalink=e.permalink||location.protocol+"//"+location.hostname+location.pathname,this}},{key:"checkType",value:function(e){for(var t=this.ids,n="",i=t.length,r=0;r<i;r++)t[r].id===e&&(n=t[r].name);return n}},{key:"checkSourceName",value:function(e){var t="";return-1!=e.indexOf("digiday.jp")?t="DIGIDAY":-1!=e.indexOf("glitty.jp")?t="GLITTY":-1!=e.indexOf("mylohas.net")?t="MYLOHAS":-1!=e.indexOf("cafeglobe.com")?t="cafeglobe":-1!=e.indexOf("genetv.jp")?t="geneTV":-1!=e.indexOf("lifehacker.jp")?t="lifehacker":-1!=e.indexOf("gizmodo.jp")?t="GIZMODO":-1!=e.indexOf("roomie.jp")?t="ROOMIE":-1!=e.indexOf("fuze.dj")?t="FUZE":-1!=e.indexOf("businessinsider.jp")&&(t="BUSINESS INSIDER"),t}},{key:"requestQueue",value:function(e){this.callback=e;for(var t=this.ids,n=t.length,i=0;i<n;i++)switch(t[i].method){case"getPopInAd":this[t[i].method](t[i].gender,t[i].deviceType,t[i].num);break;case"getOutBrain":this[t[i].method](t[i].id,t[i].testMode);break;case"getCxenseAd":this[t[i].method](t[i].id,t[i].num);break;default:this[t[i].method](t[i].id)}this.mergeData()}},{key:"mergeData",value:function(){for(var e=this,t=this.ids,n=!0,i=t.length,r=0;r<i;r++)if(void 0===this[t[r].name+"Data"]){n=!1,setTimeout(function(){e.mergeData()},200);break}if(n){for(var a=0;a<i;a++)for(var o=this[t[a].name+"Data"],l=o.length,s=0;s<l;s++){var u;!function(t){u=e.data.filter(function(e,n){if(""!==o[t].link.orig_url&&e.link.orig_url===o[t].link.orig_url)return!0}),e.data.length!==e.limit&&0===u.length&&e.data.push(o[t])}(s)}"none"!==this.shuffleType&&this.shuffle(),this.callback(this.data)}}},{key:"shuffle",value:function(){var e=this.data,t=e.length,n=void 0,i=void 0;if(0!=t.length){for(;t;)i=Math.floor(Math.random()*t--),n=e[t],e[t]=e[i],e[i]=n;if("random"!==this.shuffleType)for(var r=0;r<4;r++)if("REC"!==e[r].type)for(t=e.length;t;)if(t--,"REC"===e[t].type){n=e[t],e[t]=e[r],e[r]=n;break}}}},{key:"getCxenseRecommend",value:function(e){var t=this,n=function(e){for(var n=e.response.items,a=n.length,o=0;o<a;o++){t.recData=t.recData||[];var l=new i.default,s=n[o];if(s.url!==t.permalink){l.type="REC",l.link.target="_self",l.link.url=s.click_url,l.link.orig_url=s.url;var u=s["og-title"]||s.title||"No title";if(l.title=u.replace(t.mediaPrefix,""),l.thumbnail.src=s["og-image"]||s.dominantimage,void 0!==s.dominantthumbnaildimensions){var c=s.dominantthumbnaildimensions.match(/[0-9]+/g);2===c.length&&(l.thumbnail.width=c[0],l.thumbnail.height=c[1])}l.source_name=t.checkSourceName(l.link.orig_url),"object"===r(s["mdg-marker-articletypeslug"])?l.taxonomy.articletypeslug=s["mdg-marker-articletypeslug"]:"string"==typeof s["mdg-marker-articletypeslug"]&&l.taxonomy.articletypeslug.push(s["mdg-marker-articletypeslug"]),void 0===l.taxonomy.category&&(l.taxonomy.category=[]),"object"===r(s["mdg-marker-categorybasename"])?l.taxonomy.category=s["mdg-marker-categorybasename"]:"string"==typeof s["mdg-marker-categorybasename"]&&l.taxonomy.category.push(s["mdg-marker-categorybasename"]),"object"===r(s["mdg-marker-categoryslug"])?l.taxonomy.category=s["mdg-marker-categoryslug"]:"string"==typeof s["mdg-marker-categoryslug"]&&l.taxonomy.category.push(s["mdg-marker-categoryslug"]),t.recData.push(l)}}};cX.library.insertWidget({widgetId:e,renderFunction:n})}},{key:"getSponsoredValue",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];if(e&&e.length){var t=e.map(function(e){var t=e.key,n=e.value;if("テキスト"===t&&n.length)return n[0]});if(t.length)return t[0]}return"Sponsored"}},{key:"getCxenseAd",value:function(e,t){var n=this,r=function(e){var t=e.searchResult.spaces[0].ads,r=t.length,a=n.checkType(e.searchResult.spaces[0].id);n[a+"Data"]=n[a+"Data"]||[];for(var o=0;o<r;o++){var l=new i.default,s=t[o];s.creative.destinationUrl!==n.permalink&&(l.type=a.toUpperCase(),l.is_sponsored=!0,l.sponsoredValue=n.getSponsoredValue(s.creative.content),l.title=s.creative.title[0],l.link.orig_url=s.creative.destinationUrl,l.link.url=s.clickUrl,l.link.target=-1!==l.link.orig_url.indexOf(location.hostname)?"_self":"_blank",l.thumbnail.src=s.creative.images[0].source,l.thumbnail.width=s.creative.images[0].width,l.thumbnail.height=s.creative.images[0].height,l.source_name=n.checkSourceName(l.link.orig_url),n[a+"Data"].push(l))}};cX.library.insertAdSpace({adSpaceId:e,backend:"production",forwardHashArgs:!0,ps:t,pn:0,renderFunction:r})}},{key:"getOutBrain",value:function(e,t){var n=this,r={permalink:this.permalink,widgetId:e,testMode:t},a=function(e){var t=e.doc,r=t.length;n.outbrainData=n.outbrainData||[];for(var a=0;a<r;a++){var o=new i.default,l=t[a];l.orig_url!=n.permalink&&(o.type="OUTBRAIN",o.is_sponsored=!0,o.title=l.content,o.link.orig_url=l.orig_url,o.link.url=l.url,o.link.target="_blank",o.thumbnail.src=l.thumbnail.url,o.thumbnail.width=l.thumbnail.width,o.thumbnail.height=l.thumbnail.height,o.pub_date=l.publish_date,o.source_name=l.source_name,n.outbrainData.push(o))}};"undefined"!=typeof OBR&&OBR.extern.callRecs(r,a)}},{key:"getPopInAd",value:function(e,t,n){var i=this,r="https://discoveryplus.popin.cc/popin_discovery/ad",a="?",o={sex:e,device:t,media:"mediagene",ad:n,agency:"popinag",imp:1,callback:this.name+".popInCallback"},l=void 0;for(l in o)a+=l+"="+o[l]+"&";a=a.substr(0,a.length-1),r+=a,function(){var e=document.createElement("script");e.src=r,e.onerror=i.restorePopIn(),document.body.appendChild(e)}()}},{key:"restorePopIn",value:function(){this.popInData=this.popInData||[]}},{key:"popInCallback",value:function(e){window.data=e;var t=e.ad;if(void 0!==t&&void 0!==t.length&&0!==t.length){var n=t.length;this.popInData=this.popInData||[];for(var r=0;r<n;r++){var a=new i.default,o=t[r];o.orig_url!=this.permalink&&(a.type="POPIN",a.is_sponsored=!0,a.title=o.title,a.link.url=o.url,a.link.target="_blank",a.thumbnail.src=o.image,a.source_name=o.media,this.popInData.push(a))}}}}]),e}();window.MediaConnect=o;var l=new o("MCN");e.default=l,window.MCN=window.MCN||l})},{"./model/McnFormType":2}],2:[function(e,t,n){!function(e,t){if("function"==typeof define&&define.amd)define(["exports"],t);else if(void 0!==n)t(n);else{var i={exports:{}};t(i.exports),e.McnFormType=i.exports}}(this,function(e){"use strict";function t(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var n=function e(){t(this,e),this.type="",this.is_sponsored=!1,this.sponsoredValue="Sponsored",this.title="",this.pub_date="",this.link={orig_url:"",url:"",target:""},this.thumbnail={src:"",width:0,height:0},this.source_name="",this.taxonomy={articletypeslug:[]}};e.default=n})},{}]},{},[1]);
</script>

</body>
</html>
