<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>9337.91ab762391fb8195.html</title>
</head>
<body>

<script>
(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9337],{27561:function(e,t,i){var n=i(67990),r=/^\s+/;e.exports=function(e){return e?e.slice(0,n(e)+1).replace(r,""):e}},67990:function(e){var t=/\s/;e.exports=function(e){for(var i=e.length;i--&&t.test(e.charAt(i)););return i}},23279:function(e,t,i){var n=i(13218),r=i(7771),s=i(14841),o=Math.max,a=Math.min;e.exports=function(e,t,i){var c,h,d,u,l,p,f=0,m=!1,v=!1,g=!0;if("function"!=typeof e)throw TypeError("Expected a function");function w(t){var i=c,n=h;return c=h=void 0,f=t,u=e.apply(n,i)}function _(e){var i=e-p,n=e-f;return void 0===p||i>=t||i<0||v&&n>=d}function y(){var e,i,n,s=r();if(_(s))return S(s);l=setTimeout(y,(e=s-p,i=s-f,n=t-e,v?a(n,d-i):n))}function S(e){return(l=void 0,g&&c)?w(e):(c=h=void 0,u)}function b(){var e,i=r(),n=_(i);if(c=arguments,h=this,p=i,n){if(void 0===l)return f=e=p,l=setTimeout(y,t),m?w(e):u;if(v)return clearTimeout(l),l=setTimeout(y,t),w(p)}return void 0===l&&(l=setTimeout(y,t)),u}return t=s(t)||0,n(i)&&(m=!!i.leading,d=(v="maxWait"in i)?o(s(i.maxWait)||0,t):d,g="trailing"in i?!!i.trailing:g),b.cancel=function(){void 0!==l&&clearTimeout(l),f=0,c=p=h=l=void 0},b.flush=function(){return void 0===l?u:S(r())},b}},7771:function(e,t,i){var n=i(55639);e.exports=function(){return n.Date.now()}},14841:function(e,t,i){var n=i(27561),r=i(13218),s=i(33448),o=0/0,a=/^[-+]0x[0-9a-f]+$/i,c=/^0b[01]+$/i,h=/^0o[0-7]+$/i,d=parseInt;e.exports=function(e){if("number"==typeof e)return e;if(s(e))return o;if(r(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=r(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=n(e);var i=c.test(e);return i||h.test(e)?d(e.slice(2),i?2:8):a.test(e)?o:+e}},19337:function(e,t,i){"use strict";i.r(t),i.d(t,{default:function(){return C}});var n=i(85893),r=i(23279),s=i.n(r),o=i(9008),a=i.n(o),c=i(11163),h=i(67294),d=i(56064),u=i(42238),l=i.n(u),p=i(55877),f=i(90789),m=i(80309),v=i(48094);let g=async(e,t)=>{let i=new URL("https://api.mindbox.ru/v3/operations/async");i.searchParams.set("endpointId","startru-website"),i.searchParams.set("operation","AvtorizaciyaVLk"),i.searchParams.set("deviceUUID",e),fetch(i,{method:"POST",headers:{Authorization:'Mindbox secretKey="'.concat("nyQNK1KEQbkU67cIHqMa",'"'),Accept:"application/json","Content-Type":"application/json; charset=utf-8"},body:JSON.stringify({customer:{ids:{websiteID:t}}})})};var w=i(91579),_=i(5694),y=i(39468),S=i(90954),b=i(37131);let k={setInitialCardsCount:y.Mp,setClickHouseData:y.u6,setCookieAgreement:y.eX,getDeviceSize:y.KT,setUserBrowser:y.k8,setUserOs:y.xC,renderMobile:y.d8,authRefreshed:_.wc,setStartDeviceId:_.Tt,selectProfile:w.tM,setProfileType:w.uM,fetchAllData:w.pi,setScreen:y.I2,setCardsCount:y.Wx,setDevEnv:y.sQ,setRuDomain:y.Gy,setPreviousPageUrl:y.u_,setInnerWindowSize:y.gC,fetchedPinStatus:_._8,fetchPaymentMethods:S.F,setClientLocale:y.FZ};class I extends h.PureComponent{componentDidMount(){(0,v.kT)("startOrigin"),this.getEnvType(),this.checkElementsCount(),this.checkRenderType(),this.checkSliderSize(),this.checkOrigin(),this.getDeviceInfo(),this.getOSInfo(),this.setAppHeightCSSProperty(),this.fetchedAuth||(this.fetchedAuth=!0,this.fetchAuthData(),this.fetchPinStatus()),-1===window.location.pathname.indexOf("web/fail")&&((0,v.kT)("defaultBuy"),(0,v.kT)("addCard"),(0,v.kT)("channel"),(0,v.kT)("coupon_tariff_id"),(0,v.kT)("coupon_price"),(0,v.kT)("coupon_currency"),(0,v.kT)("coupon_duration"),(0,v.kT)(m.sy)),this.props.setCookieAgreement("true"===(0,v.ej)("startCookieAgreement")),window.addEventListener("resize",this.resizeEvent),this.resizeEvent();let e=(0,m.wF)(b.Router);this.props.setScreen(e);let t="";t=localStorage.getItem("real_referrer")!==document.referrer?document.referrer:localStorage.getItem("inner_referrer")||"",localStorage.setItem("real_referrer",document.referrer),this.props.setPreviousPageUrl(t),b.Router.events.on("beforeHistoryChange",()=>{this.props.setPreviousPageUrl(window.location.href),localStorage.setItem("inner_referrer",window.location.href)}),b.Router.events.on("beforeHistoryChange",()=>{this.videoUnitElementCount=0,this.checkElementsCount()}),b.Router.events.on("routeChangeStart",this.setAuthRoute)}componentDidUpdate(e){let{redirect:t}=this.state,{router:i,outerSource:n}=this.props,{currentProfile:r}=this.props.profile,{authData:s}=this.props.registration,{productId:o}=this.props.systemInformation,{switchProfile:a}=this.props.toggle,{router:c}=e,{authData:h}=e.registration,{productId:d}=e.systemInformation,u=(0,m.wF)(b.Router);if(s&&h&&!0===h.virtual&&!1===s.virtual&&g((0,v.ej)("mindboxDeviceUUID"),s._id),s&&(JSON.stringify(s)!==JSON.stringify(h)||o!==d||JSON.stringify(i)!==JSON.stringify(c))){var l;let e=(0,m.wF)(i),t=(0,m.wF)(c),{_id:o,profile_id:a,type:h,profile_for_child:d}=s,{startDeviceId:p,userOs:f,userBrowser:g,deviceData:w,productId:_,referer_screen:y,previousPageUrl:S}=this.props.systemInformation,b=r&&r._id||a,k=r&&r.child||d,I=navigator.language||navigator.userLanguage;I=I.split("-")[0];let C=s.devices&&s.devices.map(e=>"web"===e.type?e:null),U={account_id:o,account_type:h?h.toLowerCase():"",environment:"https://api.start.ru"!==this.apiUrl?"development":"production",event_producer:n?"".concat(n,"_start_client"):"start_client",profile_id:b,profile_for_child:k?1:0,device_type:w,device_language:I,device_uid:p||C&&C.length&&C[C.length-1]&&C[C.length-1].uid,user_os:f?f.os:"",user_os_version:f?f.osVersion:"",platform_id:"start",full_url:encodeURIComponent(window.location.href),user_browser:g?g.browserName:"",user_browser_version:g?g.browserVersion:"",traffic_source:"mlk"===this.getMLK()?"megafon_mlk":JSON.stringify((0,v.CX)(window.location.search)),screen_type:null==e?void 0:e.screenType,screen_attributes_id:null==e?void 0:e.screenAttributesId,screen_attributes_ab_tag:s.tags||"",referer_screen_type:null==t?void 0:t.screenType,referer_screen_attributes_id:null==t?void 0:t.screenAttributesId,product_id:_||"",event_version:"1.0",event_time:new Date().getTime(),request_referer:encodeURIComponent(S),exp_ids:s.ab?(0,v.dJ)(s,"exp_id"):"",group_ids:s.ab?(0,v.dJ)(s,"group_id"):""};this.props.setScreen(u),this.props.setClickHouseData(U),this.props.setClientLocale(null===(l=s.current_country_code)||void 0===l?void 0:l.toLowerCase())}if((h&&s&&h._id&&s._id&&h._id!==s._id||h&&(!s||!s._id))&&(0,v.kT)("".concat(h._id)),(!h&&s||h&&s&&h._id&&s._id!==h._id)&&this.canUpdate){this.canUpdate=!1;let e="".concat(this.apiUrl).concat(f.ve.profile).concat(this.apiKey);fetch(e,{credentials:"include"}).then(e=>{e.status<400&&e.json().then(e=>{this.props.selectProfile(e),this.props.setProfileType(e.child),this.props.fetchAllData(e,s,this.apiUrl,this.apiKey,this.props.systemInformation.locale),this.canUpdate=!0})})}(!h&&s||h&&s&&h._id!==s._id)&&!s.virtual&&this.props.fetchPaymentMethods(),b.Router&&"/"===b.Router.route&&r&&r.child&&!t&&!a&&this.setState({redirect:!0},()=>{b.Router.pushRoute("/kids").then(()=>{this.setState({redirect:!1})})}),!b.Router||"/kids"!==b.Router.route||!r||r.child||t||a||this.setState({redirect:!0},()=>{b.Router.pushRoute("/").then(()=>{this.setState({redirect:!1})})})}componentWillUnmount(){window.removeEventListener("resize",this.resizeEvent),b.Router.events.off("routeChangeStart",this.setAuthRoute)}checkElementsCount(){let{viewport:e}=this.props.systemInformation,t=2;for(let i=0;i<e.list.length;i++){if(window.innerWidth<e.list[i]){t=0===i?e.data[e.list[i]]:e.data[e.list[i-1]];break}t=8}t!==this.videoUnitElementCount&&(this.videoUnitElementCount=t,this.props.setInitialCardsCount(this.videoUnitElementCount),this.props.setCardsCount(this.videoUnitElementCount))}getOSInfo(){let e=new(l()),t=e.getOS().name,i=e.getOS().version,n=e.getBrowser().name,r=e.getBrowser().version;this.props.setUserOs({os:t||"Unknown OS",osVersion:i||"Unknown OSVersion"}),this.props.setUserBrowser({browserName:n||"Unknown browser",browserVersion:r||"Unknown version"})}render(){let{authData:e}=this.props.registration,t=null;return(e&&e.subscriptions&&e.subscriptions.length&&(t=(0,f.Ik)(e.subscriptions)),t)?(0,n.jsx)(a(),{children:(0,n.jsx)("meta",{name:"apple-media-service-subscription",content:"expires=".concat(t.expiration-parseInt(new Date().getTime()/1e3),", type=subscription")})}):null}constructor(e){super(e),this.getMLK=()=>new URLSearchParams(window.location.search).get("app"),this.getEnvType=()=>{let e=window.location.host,t=e&&-1!==e.indexOf("stage.");Array.from(Array(10).keys()).map(i=>{-1!==e.indexOf("dev".concat(i+1,"."))&&(t=!0)}),!t&&/^enigma\d{1}\./.test(window.location.hostname)&&(t=!0),this.props.setDevEnv(t),this.props.setRuDomain(t?"ru.tech":".ru")},this.resizeEvent=s()(()=>{this.checkElementsCount(),this.checkRenderType(),this.checkSliderSize(),this.checkInnerWindowSize(),this.setAppHeightCSSProperty()},300),this.checkInnerWindowSize=()=>{let e=document.documentElement.clientWidth,t=document.documentElement.clientHeight,i=window.innerWidth,n=window.innerHeight;this.props.setInnerWindowSize({clientWidth:e,clientHeight:t,innerWidth:i,innerHeight:n})},this.checkOrigin=()=>{if(-1===window.location.host.indexOf("payment")){(0,v.kT)("startOrigin");let e=window.location.host;e===m.b3&&(e=(0,f.Dx)(this.apiUrl)),(0,v.d8)("startOrigin",e)}},this.checkRenderType=()=>{this.props.renderMobile(window.innerWidth<=767)},this.checkSliderSize=()=>{let e=.9*window.innerWidth>window.innerHeight?"staticHeight":"autoHeight";(0,v.kT)("startSliderHeight"),(0,v.d8)("startSliderHeight",e)},this.setAppHeightCSSProperty=()=>{let e=.01*window.innerHeight;document.documentElement.style.setProperty("--app-height","".concat(e,"px"))},this.getDeviceInfo=()=>{let{deviceData:e}=this.props.systemInformation;e?window.innerWidth<=767&&"mobile_web"!==e?this.props.getDeviceSize("mobile_web"):window.innerWidth>767&&window.innerWidth<=1024&&"tablet_web"!==e?this.props.getDeviceSize("tablet_web"):window.innerWidth>1024&&"desktop_web"!==e&&this.props.getDeviceSize("desktop_web"):this.props.getDeviceSize(window.innerWidth<=767?"mobile_web":window.innerWidth<=1024?"tablet_web":"desktop_web")},this.setAuthRoute=e=>{if("/auth"===e||"/signup"===e||"/signin"===e||"/logout"===e){let e=new URL(window.location.href),t=e.pathname,i=e.search,n=e.hash;t&&!["/signin","/signup","/logout","/auth"].includes(t)&&(0,v.rU)("".concat(t).concat(i).concat(n))}},this.fetchAuthData=()=>{let e=new URLSearchParams(window.location.search).get("auth_token"),{router:t}=this.props,i=e?"".concat(this.apiUrl).concat(f.ve.authRefresh).concat(this.apiKey,"&auth_token=").concat(e):"".concat(this.apiUrl).concat(f.ve.authRefresh).concat(this.apiKey);fetch(i,{credentials:"include",method:"POST"}).then(e=>{if(e.status<400)e.json().then(e=>{this.props.authRefreshed(e);let t=e.devices&&e.devices.map(e=>"web"===e.type?e:null);t&&t.length&&t[t.length-1]&&this.props.setStartDeviceId(t[t.length-1].uid)});else{let e=(0,p.v4)();this.props.setStartDeviceId(e);let i="".concat(this.apiUrl).concat(f.ve.authDeviceLogin).concat(this.apiKey),n={device_id:e,device_type:"web",traffic_source:"mlk"===this.getMLK()?"megafon_mlk":window.location.search,is_child:"/kids"===t.pathname};fetch(i,{credentials:"include",method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)}).then(e=>e.json().then(e=>{this.props.authRefreshed(e)})).catch(e=>{console.error(e)})}})},this.fetchPinStatus=()=>{let e="".concat(this.apiUrl).concat(f.ve.pin.status).concat(this.apiKey);fetch(e,{credentials:"include",method:"GET"}).then(e=>e.json().then(e=>{this.props.fetchedPinStatus(e)})).catch(e=>{console.error(e)})},this.state={tariffRequested:!1,redirect:!1},this.videoUnitElementCount=0,this.fetchedAuth=!1,this.canUpdate=!0,this.apiUrl=e.systemInformation.API_URL||m.T5,this.apiKey=e.systemInformation.API_KEY||m.$h}}var C=(0,c.withRouter)((0,d.$j)(e=>({systemInformation:e.systemInformation,registration:e.registration,profile:e.profile,toggle:e.toggle}),k)(I))},90954:function(e,t,i){"use strict";i.d(t,{F:function(){return o},u:function(){return s}});var n=i(90789),r=i(80309);let s=e=>({type:"FETCH_PAYMENTS_LOAD",payload:e}),o=()=>async(e,t)=>{var i,o;let a=(null===(i=t().systemInformation)||void 0===i?void 0:i.API_URL)||r.T5,c=(null===(o=t().systemInformation)||void 0===o?void 0:o.API_KEY)||r.$h,h="".concat(a).concat(n.ve.getPaymentMethods).concat(c);try{let t=await fetch(h,{credentials:"include"}),i=await t.json();t.status<400&&i&&i.length&&e(s(i))}catch(e){}}}}]);
</script>

</body>
</html>
