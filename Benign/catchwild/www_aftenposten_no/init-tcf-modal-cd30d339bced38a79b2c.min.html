<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>init-tcf-modal-cd30d339bced38a79b2c.min.html</title>
</head>
<body>

<script>
(self.webpackChunkfastenposten=self.webpackChunkfastenposten||[]).push([[5709,1271],{51504:e=>{function t(){}t.prototype={on:function(e,t,i){var s=this.e||(this.e={});return(s[e]||(s[e]=[])).push({fn:t,ctx:i}),this},once:function(e,t,i){var s=this;function r(){s.off(e,r),t.apply(i,arguments)}return r._=t,this.on(e,r,i)},emit:function(e){for(var t=[].slice.call(arguments,1),i=((this.e||(this.e={}))[e]||[]).slice(),s=0,r=i.length;s<r;s++)i[s].fn.apply(i[s].ctx,t);return this},off:function(e,t){var i=this.e||(this.e={}),s=i[e],r=[];if(s&&t)for(var o=0,n=s.length;o<n;o++)s[o].fn!==t&&s[o].fn._!==t&&r.push(s[o]);return r.length?i[e]=r:delete i[e],this}},e.exports=t,e.exports.TinyEmitter=t},23113:(e,t,i)=>{"use strict";(0,i(44505).initTCFModal)()},84919:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TCFModal=void 0;const s=i(50712);class r{static setup(e){var t;r.localStorageKey=e.localStorageDismissedKey,r.enabled=(null===(t=e.enabled)||void 0===t||t)&&!(0,s.getItemFromLocalStorage)(r.localStorageKey);try{r.srcBaseUrl=new URL(e.srcBaseUrl)}catch(t){throw new this.TCFModalError(`Provided \`baseUrl\` is invalid! (${e.srcBaseUrl})`)}r.initialized=!0}static open(e,t){if(!r.initialized)throw new this.TCFModalError("Setup must be performed before opening the modal! Usage: `TCFModal.setup({...options}); TCFModal.open()`");if(!r.enabled)return!1;const i=new URL(e,r.srcBaseUrl);t&&Object.keys(t).forEach((e=>{i.searchParams.set(e,String(t[e]))}));const s=document.createElement("iframe");return s.src=i.href,s.classList.add("tcf-modal-frame"),r.listen(),r.currentIframe=s,document.body.appendChild(s),document.body.style.overflow="hidden",!0}static close(){return!(!r.currentIframe||!r.isOpen()||(r.mute(),document.body.removeChild(r.currentIframe),r.currentIframe=void 0,document.body.style.overflow="",0))}static eventHandler(e){var t,i;if(e.origin!==r.srcBaseUrl.origin||e.source!==(null===(t=r.currentIframe)||void 0===t?void 0:t.contentWindow)||"event"!==(null===(i=e.data)||void 0===i?void 0:i.kind))return;const o=e.data;return"modal_close"===o.name?(r.close(),void(0,s.saveItemToLocalStorage)(r.localStorageKey,Date.now().toString())):"modal_replace"===o.name?(r.close(),void r.open(o.data.path)):void("mark_as_seen"!==o.name?"track_click"!==o.name?"track_view"!==o.name||window.pulse("track","engagementEvent",{type:"View",action:"Click",object:Object.assign({},o.data)}):window.pulse("track","engagementEvent",{action:"Click",object:Object.assign({},o.data)}):(0,s.saveItemToLocalStorage)(r.localStorageKey,Date.now().toString()))}static listen(){r.listening||(r.listening=!0,window.addEventListener("message",r.eventHandler))}static mute(){r.listening&&(window.removeEventListener("message",r.eventHandler),r.listening=!1)}static isOpen(){return!!r.currentIframe&&document.body.contains(r.currentIframe)}}t.TCFModal=r,r.initialized=!1,r.enabled=!0,r.listening=!1,r.TCFModalError=class extends Error{constructor(e){super(`[TCFModal] :: ${null!=e?e:"Unknown error."}`)}}},96975:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isValidConsentOrPaySegment=t.getConsentOrPaySegment=void 0;const i=["a-free","a-targeting"],s={design:{start:50,end:64},adType:{start:65,end:80},price:{start:81,end:90}},r=[{abxRange:{start:66,end:73},segment:"a-free"},{abxRange:{start:74,end:81},segment:"a-targeting"}];t.isValidConsentOrPaySegment=e=>!!e&&i.includes(e),t.getConsentOrPaySegment=(e,t)=>{var i;if(((e,t)=>t>=s[e].start&&t<=s[e].end)(e,t))return null===(i=r.find((e=>t>=e.abxRange.start&&t<=e.abxRange.end)))||void 0===i?void 0:i.segment}},44505:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.initTCFModal=t.ACTIVE_CONSENT_OR_PAY_TEST=void 0;const s=i(40893),r=i(96975),o=i(84919),n=i(99417),a=i(50712);t.ACTIVE_CONSENT_OR_PAY_TEST="adType",t.initTCFModal=()=>{var e;const i=new URLSearchParams(window.location.search).get("FF_tcf-modal");if(!i)return void console.debug("TCF Modal: No feature flag set");if(window.isHermesApp)return;const c=new Date(null!==(e=(0,n.getBrowserCookieValue)("consentDate"))&&void 0!==e?e:"");if(isNaN(c.getTime())&&!i)return void console.debug(`TCF Modal: Consent date is not valid: '${c}'`);const l=Math.ceil(((new Date).getTime()-c.getTime())/864e5);if(l<14&&!i)return void console.debug(`TCF Modal: Not enough days since consent: ${l}/14`);if((0,a.getItemFromLocalStorage)("tcf-modal-dismissed")&&!i)return void console.debug("TCF Modal: User was exposed to and dismissed the previous test");const d=(0,s.abTestValue)()||NaN,u=(0,r.isValidConsentOrPaySegment)(i)?i:(0,r.getConsentOrPaySegment)(t.ACTIVE_CONSENT_OR_PAY_TEST,d);if(!u)return void console.debug(`TCF Modal: AB test value ${d} is not included in the test`);const h={srcBaseUrl:window.location.origin,localStorageDismissedKey:"tcf-modal-dismissed",enabled:!0};try{o.TCFModal.setup(h),o.TCFModal.open("tcf-modal/consentpay",{segment:u}),console.log(`TCFModal initialized successfully with segment: ${u}`)}catch(e){console.warn("Error initializing TCFModal: ",e)}}},40893:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.abTestValue=function(){const e=(0,s.getCookieValue)("abx2"),t=parseInt(e,10);return t<0||t>=100||Number.isNaN(t)?null:t},t.userAbGroup=async function(){const e=c();if(void 0!==e)return e;const t=(0,n.getCachedSessionData)();if(t)return l(t.user.userId.toString());try{const e=await(0,r.getSessionData)();if(!e)return;return l(e.user.userId.toString())}catch(e){return void console.error("Failed to calculate A/B group - failed to get user session data",e)}};const s=i(40132),r=i(69784),o=i(49966),n=i(44362),a=i(70321),c=()=>{const e=new URLSearchParams(window.location.search).get("userabgroup");if(null===e)return;const t=Number.parseInt(e,10);return(0,a.isUserAbGroup)(t)?t:void 0},l=e=>{if(e&&0!==e.length)return Math.abs((0,o.basicHash)(e)%10)}},40132:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getCookieValue=function(e){const t=document.cookie.split(";");for(let i=0;i<t.length;i++){const s=t[i].split("=",2),r=s[0].replace(/^\s+|\s+$/g,""),o=s[1];if(r===e)return decodeURIComponent(o)}return""}},70898:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.fasten=void 0;const s=i(25954);function r(e,t){var i;const s=document.querySelector(`meta[name='${e}']`);return null!==(i=null==s?void 0:s.dataset[t])&&void 0!==i?i:null}function o(e){var t;const i=document.querySelector(`meta[name='${e}']`);return null!==(t=null==i?void 0:i.content)&&void 0!==t?t:null}t.fasten={publicationId:function(){return o("publication-id")},siteVersion:function(){return o("site-version")},sectionName:function(){return r("section-info","sectionName")},sectionPath:function(){return r("section-info","sectionPath")},pathName:function(){return window.location.pathname.replace(/^\//,"")},isMobileApp:s.isMobileApp,isAndroidApp:s.isAndroidApp,fetch:function(e,t,i=null,s="json",r=!1,o=null){return new Promise((function(n,a){const c=new XMLHttpRequest;c.open(e,t),i&&Object.keys(i).forEach((e=>c.setRequestHeader(e,i[e]))),c.responseType=s,c.withCredentials=r,c.onload=function(){this.status>=200&&this.status<300?n(c.response):a({status:this.status,statusText:c.statusText})},c.onerror=function(){a({status:this.status,statusText:c.statusText})},c.send(o)}))},devMode:"true"===r("section-info","devMode")}},3108:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.removeItemFromLocalStorage=t.saveItemToLocalStorage=t.getItemFromLocalStorage=void 0;const s=i(50712);t.getItemFromLocalStorage=e=>{let t;try{t=JSON.parse((0,s.getItemFromLocalStorage)(e))}catch(t){return(0,s.removeItemFromLocalStorage)(e),null}return!t||!t._expires||t._expires<Date.now()?null:t.value},t.saveItemToLocalStorage=(e,t,i)=>{const r={value:t,_expires:Date.now()+i};(0,s.saveItemToLocalStorage)(e,JSON.stringify(r))},t.removeItemFromLocalStorage=s.removeItemFromLocalStorage},50712:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.removeItemFromLocalStorage=t.saveItemToLocalStorage=t.getItemFromLocalStorage=t.isLocalStorageSupported=void 0;const i="undefined"!=typeof window&&"undefined"!=typeof Storage&&!!localStorage&&"function"==typeof localStorage.getItem&&"function"==typeof localStorage.setItem;t.isLocalStorageSupported=i,t.getItemFromLocalStorage=e=>i?window.localStorage.getItem(e):null,t.saveItemToLocalStorage=(e,t)=>{i&&window.localStorage.setItem(e,t)},t.removeItemFromLocalStorage=e=>{i&&window.localStorage.removeItem(e)}},69784:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getUserContextData=t.getUserStatus=t.logoutAction=t.loginAction=t.getLoginUrl=t.getSessionData=t.initUserSession=void 0;const s=i(91271),r=i(71347),o=i(74513),n=i(44362),a=i(535),c=i(70898),l=(()=>{const{clientId:e,env:t,sessionDomain:i,redirectUriDomain:s,useOriginAsRedirectUri:o,redirectUriPath:n,varnishCookieExpiresIn:a}=r.frontendConfig.accountSdkConfig;return{clientId:e,redirectUri:`${"PRE"===t||o?window.location.origin:s}${n}`,sessionDomain:i,env:t,varnishCookie:{expiresIn:a,domain:i.split(".").slice(-2).join(".")}}})(),d=new s.Identity(l),u=new s.Monetization(l);let h=null;window.Identity=d,t.initUserSession=async()=>{d.enableVarnishCookie(l.varnishCookie);const e=(0,n.getCachedSessionData)();(0,o.setBodyClasses)(e);const i=await(0,t.getSessionData)();(0,o.setBodyClasses)(i),(0,o.setSessionCookies)(i),!r.frontendConfig.accountSdkConfig.simplifiedLoginWidget||i||c.fasten.isMobileApp()||(0,a.showSimplifiedLoginWidget)(d)},t.getSessionData=async()=>h||(h=(async()=>{if(await d.isLoggedIn()){const{userId:e,uuid:t,familyName:i,givenName:s,sig:r,result:o,userStatus:n}=await d.getUser(),{entitled:a=!1,allowedFeatures:c=[]}=await u.hasAccess(window.frontendConfig.accountSdkConfig.productId.split(","),e)||{};return{user:{familyName:i,givenName:s,userId:e,uuid:t,result:o,userStatus:n,userToken:r},access:{entitled:a,allowedFeatures:c}}}return!1})(),h.then((e=>{e?(0,n.setCachedSessionData)(e):(0,n.clearCachedSessionData)()})).catch((()=>{(0,n.clearCachedSessionData)()})),h),t.getLoginUrl=()=>d.loginUrl({state:"dunno"}),t.loginAction=(e={state:"fallbackState"})=>{d.login(e)},t.logoutAction=()=>{(0,n.clearCachedSessionData)(),(0,o.setSessionCookies)(null),d.logout(window.location.href)},t.getUserStatus=async()=>{const e=await(0,t.getSessionData)();return{isLoggedIn:e&&!!e.user.userId,isSubscriber:e&&e.access.entitled}},t.getUserContextData=async()=>await d.getUserContextData(),window.accountSession={loginAction:t.loginAction}},44362:function(e,t,i){"use strict";var s=this&&this.__rest||function(e,t){var i={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&t.indexOf(s)<0&&(i[s]=e[s]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(s=Object.getOwnPropertySymbols(e);r<s.length;r++)t.indexOf(s[r])<0&&Object.prototype.propertyIsEnumerable.call(e,s[r])&&(i[s[r]]=e[s[r]])}return i};Object.defineProperty(t,"__esModule",{value:!0}),t.clearCachedSessionData=t.setCachedSessionData=t.getCachedSessionData=void 0;const r=i(50712),o="fasten-session-cache";t.getCachedSessionData=()=>{try{const e=(0,r.getItemFromLocalStorage)(o);return e?JSON.parse(e):null}catch(e){return null}},t.setCachedSessionData=e=>{const t=(e=>{if(e&&e.user){const t=e.user,{userToken:i}=t;return{user:s(t,["userToken"]),access:e.access}}return e})(e);(0,r.saveItemToLocalStorage)(o,JSON.stringify(t))},t.clearCachedSessionData=()=>{(0,r.removeItemFromLocalStorage)(o)}},74513:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setSessionCookies=t.setBodyClasses=void 0,t.setBodyClasses=e=>{const t=document.body.classList;e?(t.remove("imp-no-session"),t.add("imp-logged-in"),e.access.entitled?t.add("imp-has-product"):t.remove("imp-has-product")):(t.remove("imp-logged-in"),t.remove("imp-has-product"),t.add("imp-no-session"))};const i=e=>{const t=new Date;return t.setDate(t.getDate()+e),t.toUTCString()};t.setSessionCookies=e=>{e?(document.cookie=`curate-Id=${e.user.userId}; expires=${i(14)}; path=/;`,document.cookie=`SP_ABO=${e.access.allowedFeatures.join(",")}; expires=${i(365)}; path=/;`):(document.cookie="curate-Id=nothing; expires=Thu, 01 Jan 1970 00:00:00 GMT; path=/;",document.cookie="SP_ABO=nothing; expires=Thu, 01 Jan 1970 00:00:00 GMT; path=/;")}},535:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.showSimplifiedLoginWidget=void 0;const s=i(3108),r=i(71347),o="simplified_login_state";t.showSimplifiedLoginWidget=e=>{r.frontendConfig.accountSdkConfig.simplifiedLoginWidget&&!(0,s.getItemFromLocalStorage)(o)&&e.showSimplifiedLoginWidget({state:"fallback"}).then((e=>{e&&(0,s.saveItemToLocalStorage)(o,!0,72e5)})).catch((e=>{e.toString().includes("Missing user data")||console.error("Simplified login widget error",e)}))}},99417:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.deleteBrowserCookie=t.setBrowserCookie=t.getBrowserCookieValue=void 0;const i=()=>"undefined"!=typeof window;t.getBrowserCookieValue=e=>{var t;try{if(!i())return null;const s=`; ${document.cookie}`.split(`; ${e}=`);if(2===s.length){const e=null===(t=s.pop())||void 0===t?void 0:t.split(";").shift();return e?decodeURIComponent(e):null}return null}catch(e){return null}},t.setBrowserCookie=(e,t,s)=>{i()&&(document.cookie=`${e}=${t};expires=${s.toUTCString()};path=/`)},t.deleteBrowserCookie=e=>{i()&&(document.cookie=`${e}=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/;`)}},71347:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.frontendConfigWithOverwrite=t.frontendConfig=void 0;const s=i(74461);window.frontendConfig||s.console.error("It looks that you are trying to read frontend config, but you have not included it in your HTML template"),t.frontendConfig=window.frontendConfig,t.frontendConfigWithOverwrite=e=>window.frontendConfig},83559:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.console=void 0;const s=i(52492);t.console=s.stdConsole},74461:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.console=void 0;var s=i(83559);Object.defineProperty(t,"console",{enumerable:!0,get:function(){return s.console}})},52492:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.stdConsole=void 0,t.stdConsole=console},70321:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isUserAbGroup=t.isAnonymousSession=t.isPulseSession=t.isSpidSession=t.ANONYMOUS_SESSION_TYPE=t.PULSE_SESSION_TYPE=t.SPID_SESSION_TYPE=void 0,t.SPID_SESSION_TYPE="spid",t.PULSE_SESSION_TYPE="pulse",t.ANONYMOUS_SESSION_TYPE="anonymous",t.isSpidSession=e=>!!e&&"object"==typeof e&&e.type===t.SPID_SESSION_TYPE&&!!e.userId,t.isPulseSession=e=>!!e&&"object"==typeof e&&e.type===t.PULSE_SESSION_TYPE&&!!e.userId,t.isAnonymousSession=e=>!!e&&"object"==typeof e&&e.type===t.ANONYMOUS_SESSION_TYPE,t.isUserAbGroup=e=>"number"==typeof e&&Number.isInteger(e)&&e>=0&&e<=9},49966:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.basicHash=function(e){let t=0;if(!e||0==e.length)return t;for(let i=0;i<e.length;i++)t=(t<<5)-t+e.charCodeAt(i),t|=0;return t}},25954:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isIosApp=t.isAndroidApp=t.isMobileApp=void 0,t.isMobileApp=()=>-1!==(window.navigator.userAgent||"").toLowerCase().indexOf("hermes"),t.isAndroidApp=()=>(0,t.isMobileApp)()&&null!==window.navigator.userAgent.match(/android/i),t.isIosApp=()=>(0,t.isMobileApp)()&&!(0,t.isAndroidApp)()},91271:(e,t,i)=>{"use strict";i.r(t),i.d(t,{Identity:()=>M,Monetization:()=>N,Payment:()=>V});const s=["boolean","number","string"];class r extends Error{constructor(e,t){if(super(e),this.name="SDKError","object"==typeof t)try{Object.assign(this,t)}catch(e){}}toString(){const e=`${this.name}: ${this.message}`,t=Object.keys(this).filter((e=>"name"!==e&&s.includes(typeof this[e]))).map((e=>`    ${e}: ${this[e]}`)).join("\n");return t?`${e}\n${t}`:e}}function o(e,t="Assertion failed"){if(!e)throw new r(t)}function n(e){return"string"==typeof e}function a(e){return"string"==typeof e&&e.length>0}function c(e){return"object"==typeof e&&null!==e}function l(e){return c(e)&&Object.keys(e).length>0}function d(e,...t){try{const i=new URL(e);return t.every((e=>i[e]))}catch(e){return!1}}function u(e){return"function"==typeof e}function h(e,t,i=!1){return!(!n(e)||!Array.isArray(t))&&(i?-1!==t.indexOf(e):t.some((t=>n(t)&&e.toUpperCase()===t.toUpperCase())))}function p(...e){const t={};if(!e||!e.length)throw new r("No objects to clone");return e.forEach((e=>{o(c(e)),l(e)&&Object.entries(e).forEach((([e,i])=>{void 0!==i&&(t[e]=c(i)?g(i):i)}))})),t}function g(e){return o("object"==typeof e,`obj should be an object (even null) but it is ${e}`),JSON.parse(JSON.stringify(e))||e}function m(e,t){return o(a(e),'"url" param must be a non empty string: '+typeof e),l(t)&&d(t[e])?t[e]:(o(d(e,"hostname"),`Bad URL given: '${e}'`),e)}const f={SPiD:{LOCAL:"http://id.localhost",DEV:"https://identity-dev.schibsted.com",PRE:"https://identity-pre.schibsted.com",PRO:"https://login.schibsted.com",PRO_NO:"https://payment.schibsted.no",PRO_FI:"https://login.schibsted.fi",PRO_DK:"https://login.schibsted.dk"},BFF:{LOCAL:"http://id.localhost/authn/",DEV:"https://identity-dev.schibsted.com/authn/",PRE:"https://identity-pre.schibsted.com/authn/",PRO:"https://login.schibsted.com/authn/",PRO_NO:"https://payment.schibsted.no/authn/",PRO_FI:"https://login.schibsted.fi/authn/",PRO_DK:"https://login.schibsted.dk/authn/"},SESSION_SERVICE:{LOCAL:"http://session-service.id.localhost",DEV:"https://session-service.identity-dev.schibsted.com",PRE:"https://session-service.identity-pre.schibsted.com",PRO:"https://session-service.login.schibsted.com",PRO_NO:"https://session-service.payment.schibsted.no",PRO_FI:"https://session-service.login.schibsted.fi",PRO_DK:"https://session-service.login.schibsted.dk"}},S={LOCAL:"id.localhost",DEV:"schibsted.com",PRE:"schibsted.com",PRO:"schibsted.com",PRO_NO:"spid.no",PRO_FI:"schibsted.fi",PRO_DK:"schibsted.dk"};var w=i(51504);class v{constructor(e){this.store=e,this.get=e=>this.store.getItem(e),this.set=(e,t)=>this.store.setItem(e,t),this.delete=e=>this.store.removeItem(e)}}class _{constructor(){this.store={},this.get=e=>this.store[e],this.set=(e,t)=>this.store[e]=t,this.delete=e=>delete this.store[e]}}const b=Math.pow(2,31)-1;class y{constructor(e){!function(e){if(!e)return!1;try{const t=e(),i="x-x-x-x".replace(/x/g,(()=>Math.random())),s="TEST-VALUE";t.setItem(i,s);const r=t.getItem(i);return t.removeItem(i),r===s}catch(e){return!1}}(e)?(this.cache=new _,this.type="ObjectLiteralStorage"):(this.cache=new v(e()),this.type="WebStorage")}get(e){try{let t=function(e){try{return JSON.parse(e)}catch(e){return null}}(this.cache.get(e));return t&&Number.isInteger(t.expiresOn)&&t.expiresOn>Date.now()?t.value:(this.delete(e),null)}catch(e){throw new r(e)}}set(e,t,i=0){if(!(i<=0)){i=Math.min(b,i);try{const s=Math.floor(Date.now()+i);this.cache.set(e,JSON.stringify({expiresOn:s,value:t})),setTimeout((()=>this.delete(e)),i)}catch(e){throw new r(e)}}}delete(e){try{this.cache.delete(e)}catch(e){throw new r(e)}}}const U={scrollbars:"yes",location:"yes",status:"no",menubar:"no",toolbar:"no",resizable:"yes"};function I(e,t,i="",s={}){o(c(e),`window was supposed to be an object but it is ${e}`),o(c(e.screen),"window should be a valid Window object but it lacks a 'screen' property"),o(u(e.open),"window should be a valid Window object but it lacks an 'open' function"),o(d(t),"Invalid URL for popup");const{height:r,width:n}=e.screen;let a=p(U,s);Number.isFinite(a.width)&&Number.isFinite(n)&&(a.left=(n-a.width)/2),Number.isFinite(a.height)&&Number.isFinite(r)&&(a.top=(r-a.height)/2);const l=(o(c(h=a),`Object must be an object but it is '${h}'`),Object.keys(h).map((e=>`${e}=${h[e]}`)).join(","));var h;return e.open(t,i,l)}const C=(e,...t)=>"function"==typeof e&&e((e=>e.map((e=>c(e)?JSON.stringify(e,null,2):e)).join(" "))(t));function P(e){const t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,(e=>t[e]))}const k=()=>window.fetch&&window.fetch.bind(window);class O{constructor({serverUrl:e="PRE",envDic:t,fetch:i=k(),log:s,defaultParams:r={}}){o(c(r),"defaultParams should be a non-null object"),this.url=new URL(m(e,t)),this.defaultParams=r,s&&(o(u(s),`log must be a function but it is ${s}`),this.log=s),i&&(o(u(i),"Fetch should be a function"),this.fetch=i)}async go({method:e,headers:t,pathname:i,data:s={},useDefaultParams:l=!0,fetchOptions:d={method:e,credentials:"include"}}){o(u(this.fetch),"Can't make a call. The reference to fetch is missing or not a function."),o(a(e),`Method must be a non empty string but it is "${e}"`),o(a(i),`Pathname must be string but it is "${i}"`),o(c(s),"data must be a non-null object"),d.headers=c(t)?p(t):{};const h=this.makeUrl(i,s,l);C(this.log,"Request:",d.method.toUpperCase(),h),C(this.log,"Request Headers:",d.headers),C(this.log,"Request Body:",d.body);try{const e=await this.fetch(h,d);if(C(this.log,"Response Code:",e.status,e.statusText),!e.ok)throw new r(e.statusText,{code:e.status});const t=await e.json();return C(this.log,"Response Parsed:",t),t}catch(t){let i=n(t)?t:"Unknown RESTClient error";throw c(t)&&n(t.message)&&(i=t.message),new r(`Failed to '${e}' '${h}': '${i}'`,t)}}makeUrl(e="",t={},i=!0){const s=new URL(e,this.url);return s.search=O.search(t,i,this.defaultParams),s.href}get(e,t){return this.go({method:"get",pathname:e,data:t})}static search(e,t,i){const s=t?p(i,e):p(e);return Object.keys(s).filter((e=>""!==s[e])).map((e=>`${P(e)}=${P(s[e])}`)).join("&")}}const T=O;function D(e){null!==e.SPiD&&"object"==typeof e.SPiD||(e.SPiD={}),null!==e.SPiD.Talk&&"object"==typeof e.SPiD.Talk||(e.SPiD.Talk={}),u(e.SPiD.Talk.response)||(e.SPiD.Talk.response=(t,i)=>e[t](i))}const E="5.1.0",L="hasSession-cache",j="sessionCallBlocked-cache",x="tab-id-cache",$=Math.floor(1e5*Math.random()),A=()=>window;class M extends w{constructor({clientId:e,redirectUri:t,sessionDomain:i,env:s="PRE",log:r,window:n=A(),callbackBeforeRedirect:l=()=>{}}){super(),o(a(e),"clientId parameter is required"),o(c(n),"The reference to window is missing"),o(!t||d(t),"redirectUri parameter is invalid"),o(i&&d(i),"sessionDomain parameter is not a valid URL"),D(n),this._sessionInitiatedSent=!1,this.window=n,this.clientId=e,this.sessionStorageCache=new y((()=>this.window&&this.window.sessionStorage)),this.localStorageCache=new y((()=>this.window&&this.window.localStorage)),this.redirectUri=t,this.env=s,this.log=r,this.callbackBeforeRedirect=l,this._sessionDomain=i,this._enableSessionCaching=!0,this._session={},this._setSessionServiceUrl(i),this._setSpidServerUrl(s),this._setBffServerUrl(s),this._setOauthServerUrl(s),this._setGlobalSessionServiceUrl(s),this._unblockSessionCall()}_getTabId(){if(this._enableSessionCaching){return this.sessionStorageCache.get(x)||(this.sessionStorageCache.set(x,$,2592e6),$)}}_isSessionCallBlocked(){return this.localStorageCache.get(j)}_blockSessionCall(){this.localStorageCache.set(j,!0,3e5)}_unblockSessionCall(){this.localStorageCache.delete(j)}_setSpidServerUrl(e){o(n(e),`url parameter is invalid: ${e}`),this._spid=new T({serverUrl:m(e,f.SPiD),log:this.log,defaultParams:{client_id:this.clientId,redirect_uri:this.redirectUri}})}_setOauthServerUrl(e){o(n(e),`url parameter is invalid: ${e}`),this._oauthService=new T({serverUrl:m(e,f.SPiD),log:this.log,defaultParams:{client_id:this.clientId,redirect_uri:this.redirectUri}})}_setBffServerUrl(e){o(n(e),`url parameter is invalid: ${e}`),this._bffService=new T({serverUrl:m(e,f.BFF),log:this.log,defaultParams:{client_id:this.clientId,redirect_uri:this.redirectUri}})}_setSessionServiceUrl(e){o(n(e),`domain parameter is invalid: ${e}`);const t=`sdrn:${S[this.env]}:client:${this.clientId}`;this._sessionService=new T({serverUrl:e,log:this.log,defaultParams:{client_sdrn:t,redirect_uri:this.redirectUri,sdk_version:E}})}_setGlobalSessionServiceUrl(e){o(n(e),`url parameter is invalid: ${e}`);const t=`sdrn:${S[this.env]}:client:${this.clientId}`;this._globalSessionService=new T({serverUrl:m(e,f.SESSION_SERVICE),log:this.log,defaultParams:{client_sdrn:t,sdk_version:E}})}_emitSessionEvent(e,t){t.userId&&this.emit("login",t),e.userId&&!t.userId&&this.emit("logout",t),e.userId&&t.userId&&e.userId!==t.userId&&this.emit("userChange",t),e.userId||t.userId?this.emit("sessionChange",t):this.emit("notLoggedin",t),t.userId&&!this._sessionInitiatedSent&&(this._sessionInitiatedSent=!0,this.emit("sessionInit",t)),e.userStatus!==t.userStatus&&this.emit("statusChange",t)}_closePopup(){this.popup&&(this.popup.closed||this.popup.close(),this.popup=null)}enableVarnishCookie(e){let t,i=0;Number.isInteger(e)?i=e:"object"==typeof e&&(i=e.expiresIn||i,t=e.domain||t),o(Number.isInteger(i),"'expiresIn' must be an integer"),o(i>=0,"'expiresIn' cannot be negative"),this.setVarnishCookie=!0,this.varnishExpiresIn=i,this.varnishCookieDomain=t}_maybeSetVarnishCookie(e){if(!this.setVarnishCookie)return;const t=new Date;if(this.varnishExpiresIn||"number"==typeof e.expiresIn&&e.expiresIn>0){const i=this.varnishExpiresIn||e.expiresIn;t.setTime(t.getTime()+1e3*i)}else t.setTime(0);let i=this.varnishCookieDomain||("string"==typeof e.baseDomain?e.baseDomain:document.domain)||"";const s=[`SP_ID=${e.sp_id}`,`expires=${t.toUTCString()}`,"path=/",`domain=.${i}`].join("; ");document.cookie=s}_maybeClearVarnishCookie(){this.setVarnishCookie&&this._clearVarnishCookie()}_clearVarnishCookie(){const e=this._session&&"string"==typeof this._session.baseDomain?this._session.baseDomain:document.domain;let t=this.varnishCookieDomain||e||"";document.cookie=`SP_ID=nothing; expires=Thu, 01 Jan 1970 00:00:00 GMT; path=/; domain=.${t}`}logSettings(){if(!this.log&&!window.console)throw new r("You have to provide log method in constructor");const e=this.log||console.log,t={clientId:this.clientId,redirectUri:this.redirectUri,env:this.env,sessionDomain:this._sessionDomain,sdkVersion:E};e(`Schibsted account SDK for browsers settings: \n${JSON.stringify(t,null,2)}`)}hasSession(){if(this._isSessionCallBlocked())return this._session;if(this._hasSessionInProgress)return this._hasSessionInProgress;const e=e=>{if(e.error)throw new r("HasSession failed",e.error);return this._maybeSetVarnishCookie(e),this._emitSessionEvent(this._session,e),this._session=e,e};return this._hasSessionInProgress=(async()=>{if(this._enableSessionCaching){let t=this.sessionStorageCache.get(L);if(t)return e(t)}let t=null;try{t=await this._sessionService.get("/v2/session",{tabId:this._getTabId()})}catch(e){if(e&&400===e.code&&this._enableSessionCaching){const t=1e3*(e.expiresIn||300);this.sessionStorageCache.set(L,{error:e},t)}throw e}if(t){if(((e={})=>{const t=Object.keys(e);return 1===t.length&&"redirectURL"===t[0]})(t))return this._blockSessionCall(),await this.callbackBeforeRedirect(),this._sessionService.makeUrl(t.redirectURL,{tabId:this._getTabId()});if(this._enableSessionCaching){const e=1e3*(t.expiresIn||300);this.sessionStorageCache.set(L,t,e)}}return e(t)})().then((e=>(this._hasSessionInProgress=!1,d(e)?this.window.location.href=e:e)),(e=>{throw this.emit("error",e),this._hasSessionInProgress=!1,new r("HasSession failed",e)})),this._hasSessionInProgress}async isLoggedIn(){try{return"result"in await this.hasSession()}catch(e){return!1}}clearCachedUserSession(){this.sessionStorageCache.delete(L)}async isConnected(){try{return!!(await this.hasSession()).result}catch(e){return!1}}async getUser(){const e=await this.hasSession();if(!e.result)throw new r("The user is not connected to this merchant");return g(e)}async getUserId(){const e=await this.hasSession();if(e.userId&&e.result)return e.userId;throw new r("The user is not connected to this merchant")}async getExternalId(e,t=""){const{pairId:i}=await this.hasSession();if(!i)throw new r("pairId missing in user session!");if(!e||0===e.length)throw new r("externalParty cannot be empty");return(async e=>{return(t=(new TextEncoder).encode(e),crypto.subtle.digest("SHA-256",t)).then((e=>{return t=e,Array.from(new Uint8Array(t)).map((e=>e.toString(16).padStart(2,"0"))).join("");var t}));var t})(((e,t,i)=>i?`${e}:${t}:${i}`:`${e}:${t}`)(i,e,t))}async getUserSDRN(){const{sdrn:e}=await this.hasSession();if(e)return e;throw new r("Failed to get SDRN from user session")}async getUserUuid(){const e=await this.hasSession();if(e.uuid&&e.result)return e.uuid;throw new r("The user is not connected to this merchant")}async getUserContextData(){try{return await this._globalSessionService.get("/user-context")}catch(e){return null}}login({state:e,acrValues:t="",scope:i="openid",redirectUri:s=this.redirectUri,preferPopup:r=!1,loginHint:o="",tag:n="",teaser:a="",maxAge:c="",locale:l="",oneStepLogin:d=!1,prompt:u="select_account"}){this._closePopup(),this.sessionStorageCache.delete(L);const h=this.loginUrl({state:e,acrValues:t,scope:i,redirectUri:s,loginHint:o,tag:n,teaser:a,maxAge:c,locale:l,oneStepLogin:d,prompt:u});return r&&(this.popup=I(this.window,h,"Schibsted account",{width:360,height:570}),this.popup)?this.popup:(this.window.location.href=h,null)}async getSpId(){try{return(await this.hasSession()).sp_id||null}catch(e){return null}}logout(e=this.redirectUri){this.sessionStorageCache.delete(L),this._maybeClearVarnishCookie(),this.emit("logout"),this.window.location.href=this.logoutUrl(e)}loginUrl({state:e,acrValues:t="",scope:i="openid",redirectUri:s=this.redirectUri,loginHint:r="",tag:n="",teaser:c="",maxAge:l="",locale:u="",oneStepLogin:p=!1,prompt:g="select_account"}){return"object"!=typeof arguments[0]&&(e=arguments[0],t=arguments[1],i=arguments[2]||i,s=arguments[3]||s,r=arguments[4]||r,n=arguments[5]||n,c=arguments[6]||c,l=isNaN(arguments[7])?l:arguments[7]),o(!t||h(t,["","otp-email"],!0)||t.split(" ").every((e=>h(e,["password","otp","sms","eid-dk","eid-no","eid-se","eid-fi","eid"],!0))),`The acrValues parameter is not acceptable: ${t}`),o(d(s),`loginUrl(): redirectUri must be a valid url but is ${s}`),o(a(e),`the state parameter should be a non empty string but it is ${e}`),this._oauthService.makeUrl("oauth/authorize",{response_type:"code",redirect_uri:s,scope:i,state:e,acr_values:t,login_hint:r,tag:n,teaser:c,max_age:l,locale:u,one_step_login:p||"",prompt:t?"":g})}logoutUrl(e=this.redirectUri){o(d(e),"logoutUrl(): redirectUri is invalid");const t={redirect_uri:e};return this._sessionService.makeUrl("logout",t)}accountUrl(e=this.redirectUri){return this._spid.makeUrl("profile-pages",{response_type:"code",redirect_uri:e})}phonesUrl(e=this.redirectUri){return this._spid.makeUrl("profile-pages/about-you/phone",{response_type:"code",redirect_uri:e})}async showSimplifiedLoginWidget(e,t){const i=await this.getUserContextData(),s={client_id:this.clientId};t&&t.encoding&&(s.encoding=t.encoding);const o=this._bffService.makeUrl("simplified-login-widget",s,!1),n=async e=>("function"==typeof e.state&&(e.state=await e.state()),e);return new Promise(((s,a)=>{if(!i||!i.display_text||!i.identifier)return a(new r("Missing user data"));const c={displayText:i.display_text,env:this.env,clientName:i.client_name,clientId:this.clientId,providerId:i.provider_id,windowWidth:()=>window.innerWidth,windowOnResize:e=>{window.onresize=e}};t&&t.locale&&(c.locale=t.locale);const l=async()=>{this.login(Object.assign(await n(e),{loginHint:i.identifier}))},d=async()=>{this.login(Object.assign(await n(e),{loginHint:i.identifier,prompt:"login"}))},u=()=>{this.emit("simplifiedLoginOpened")},h=()=>{this.emit("simplifiedLoginCancelled")};if(window.openSimplifiedLoginWidget)return window.openSimplifiedLoginWidget(c,l,d,u,h),s(!0);const p=document.createElement("script");p.type="text/javascript",p.src=o,p.onload=()=>{window.openSimplifiedLoginWidget(c,l,d,u,h),s(!0)},p.onerror=()=>{a(new r("Error when loading simplified login widget content"))},document.getElementsByTagName("body")[0].appendChild(p)}))}}const F=()=>window;class N extends w{constructor({clientId:e,redirectUri:t,env:i="PRE",sessionDomain:s,window:r=F()}){super(),D(r),o(a(e),"clientId parameter is required"),this.cache=new y((()=>r&&r.sessionStorage)),this.clientId=e,this.env=i,this.redirectUri=t,this._setSpidServerUrl(i),s&&(o(d(s),"sessionDomain parameter is not a valid URL"),this._setSessionServiceUrl(s))}_setSpidServerUrl(e){o(n(e),`url parameter is invalid: ${e}`),this._spid=new T({serverUrl:m(e,f.SPiD),defaultParams:{client_id:this.clientId,redirect_uri:this.redirectUri}})}_setSessionServiceUrl(e){o(n(e),`domain parameter is invalid: ${e}`);const t=`sdrn:${S[this.env]}:client:${this.clientId}`;this._sessionService=new T({serverUrl:e,log:this.log,defaultParams:{client_sdrn:t,redirect_uri:this.redirectUri,sdk_version:E}})}async hasAccess(e,t){if(!this._sessionService)throw new r("hasAccess can only be called if 'sessionDomain' is configured");if(!t)throw new r("'userId' must be specified");if(!Array.isArray(e))throw new r("'productIds' must be an array");const i=e.sort(),s=this._accessCacheKey(e,t);let o=this.cache.get(s);if(!o){o=await this._sessionService.get(`/hasAccess/${i.join(",")}`);const e=o.ttl;this.cache.set(s,o,1e3*e)}return o.entitled?(this.emit("hasAccess",{ids:i,data:o}),o):null}clearCachedAccessResult(e,t){this.cache.delete(this._accessCacheKey(e,t))}_accessCacheKey(e,t){return`prd_${e.sort()}_${t}`}subscriptionsUrl(e=this.redirectUri){return o(d(e),"subscriptionsUrl(): redirectUri is invalid"),this._spid.makeUrl("account/subscriptions",{redirect_uri:e})}productsUrl(e=this.redirectUri){return o(d(e),"productsUrl(): redirectUri is invalid"),this._spid.makeUrl("account/products",{redirect_uri:e})}}const R=()=>window;class V{constructor({clientId:e,redirectUri:t,env:i="PRE",publisher:s,window:r=R()}){D(r),o(a(e),"clientId parameter is required"),this.clientId=e,this.redirectUri=t,this.window=r,this.publisher=s,this._setSpidServerUrl(i),this._setBffServerUrl(i)}_setSpidServerUrl(e){o(n(e),`url parameter is invalid: ${e}`),this._spid=new T({serverUrl:m(e,f.SPiD),defaultParams:{client_id:this.clientId,redirect_uri:this.redirectUri}})}_setBffServerUrl(e){o(n(e),`url parameter is invalid: ${e}`),this._bff=new T({serverUrl:m(e,f.BFF),defaultParams:{client_id:this.clientId,redirect_uri:this.redirectUri}})}_closePopup(){this.popup&&(this.popup.closed||this.popup.close(),this.popup=null)}payWithPaylink({paylink:e,preferPopup:t,redirectUri:i=this.redirectUri}){o(d(i),"payWithPaylink(): redirectUri is invalid"),this._closePopup();const s=this.purchasePaylinkUrl(e,i);return t&&(this.popup=I(this.window,s,"Schibsted account",{width:360,height:570}),this.popup)?this.popup:(this.window.location.href=s,null)}purchaseHistoryUrl(e=this.redirectUri){return o(d(e),"purchaseHistoryUrl(): redirectUri is invalid"),this._spid.makeUrl("account/purchasehistory",{redirect_uri:e})}redeemUrl(e,t=this.redirectUri){return o(d(t),"redeemUrl(): redirectUri is invalid"),this._spid.makeUrl("account/redeem",{voucher_code:e})}purchasePaylinkUrl(e,t=this.redirectUri){return o(d(t),"purchasePaylinkUrl(): redirectUri is invalid"),o(a(e),"purchasePaylinkUrl(): paylinkId is required"),this._bff.makeUrl("payment/purchase",{paylink:e,redirect_uri:t})}purchaseProductFlowUrl(e,t=this.redirectUri){return o(d(t),"purchaseProductUrl(): redirectUri is invalid"),o(a(e),"purchaseProductFlowUrl(): productId is required"),this._bff.makeUrl("flow/checkout",{response_type:"code",flow:"payment",product_id:e,redirect_uri:t})}purchaseCampaignFlowUrl(e,t,i,s=this.redirectUri){return o(d(s),"purchaseCampaignFlowUrl(): redirectUri is invalid"),o(a(e),"purchaseCampaignFlowUrl(): campaignId is required"),o(a(t),"purchaseCampaignFlowUrl(): productId is required"),this._bff.makeUrl("flow/checkout",{response_type:"code",flow:"payment",campaign_id:e,product_id:t,voucher_code:i,redirect_uri:s})}purchasePromoCodeProductFlowUrl(e,t="",i=this.redirectUri){return o(d(i),"purchasePromoCodeProductFlowUrl(): redirectUri is invalid"),o(a(e),"purchasePromoCodeProductFlowUrl(): code is required"),o(a(this.publisher),"purchasePromoCodeProductFlowUrl(): publisher is required in the constructor"),this._bff.makeUrl("payment/purchase/code",{code:e,publisher:this.publisher,state:t,redirect_uri:i})}}}},e=>{e(e.s=23113)}]);
//# sourceMappingURL=init-tcf-modal-cd30d339bced38a79b2c.min.js.map
</script>

</body>
</html>
