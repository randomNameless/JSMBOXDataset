<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>9382.6fe0d43a96fdf4d9.html</title>
</head>
<body>

<script>
(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9382],{58642:function(e,n,t){"use strict";t.d(n,{t:function(){return p}});var r=t(67294),c=t(11163),u=t(11752),o=t.n(u),a=t(2497),i=t(9891),s=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,t=(0,r.useRef)(e),c=(0,r.useRef)();(0,r.useEffect)(function(){t.current=e},[e]),(0,r.useEffect)(function(){return c.current=setInterval(function(){return t.current()},n),function(){return clearInterval(c.current)}},[n]),(0,r.useEffect)(function(){var e=c.current;return function(){return clearInterval(e)}},[]);var u=(0,r.useCallback)(function(){clearInterval(c.current)},[c]),o=(0,r.useCallback)(function(){clearInterval(c.current),c.current=setInterval(t.current,n)},[c,t,n]);return{intervalRef:c,stop:u,reset:o}},f=function(){var e=(0,r.useState)(!document.hidden),n=e[0],t=e[1],c=(0,r.useCallback)(function(){return t(!document.hidden)},[]);return(0,r.useEffect)(function(){return document.addEventListener("visibilitychange",c),function(){return document.removeEventListener("visibilitychange",c)}},[]),n},l=o()().publicRuntimeConfig,p=function(){var e=f(),n=(0,c.useRouter)(),t=(0,a.I0)(),u=(0,r.useCallback)(function(){t((0,i.Sk)())},[]),o=s((0,r.useCallback)(function(){e&&u()},[e]),l.USER_AUTH_CHECK_DELAY),p=(0,r.useCallback)(function(){u(),o.reset()},[o]);return(0,r.useEffect)(function(){o.reset()},[e]),(0,r.useEffect)(function(){return u(),n.events.on("routeChangeStart",p),function(){return n.events.off("routeChangeStart",p)}},[]),null}},89382:function(e,n,t){"use strict";t.r(n),t.d(n,{Link:function(){return _}});var r,c=t(67294),u=t(94184),o=t.n(u),a=t(11163),i=t(11752),s=t.n(i),f=t(41664),l=t.n(f),p=t(96502),v=t.n(p),d=t(92115);function h(){return(h=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e}).apply(this,arguments)}var b=c.memo(function(e){return c.createElement("svg",h({width:21,height:20,viewBox:"0 0 21 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},e),r||(r=c.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M10.5 1.75a3.75 3.75 0 100 7.5 3.75 3.75 0 000-7.5zM5.25 5.5a5.25 5.25 0 1110.5 0 5.25 5.25 0 01-10.5 0zM10.5 14.75c-3.907 0-7.24 1.916-8.855 4.633a.75.75 0 01-1.29-.766C2.27 15.397 6.121 13.25 10.5 13.25c4.38 0 8.23 2.148 10.145 5.367a.75.75 0 11-1.29.766c-1.615-2.717-4.947-4.633-8.855-4.633z",fill:"#fff"})))}),k=t(48236),m=t(21399),g=t(58642),w=t(85893),y=s()().publicRuntimeConfig,_=c.memo(function(){var e=(0,k.Z)(function(e){return e.user}).auth,n=(0,a.useRouter)(),t=(0,c.useCallback)(function(t){t.preventDefault(),e.authorized?"/profile"===n.pathname?n.reload():n.push("/profile"):"/profile"!==n.pathname&&-1===window.location.search.indexOf("backurl")&&n.push("/profile?backurl=".concat(window.location.href))},[e.authorized,n.pathname]),r=(0,c.useMemo)(function(){return e.authorized?(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)(d.Z,{size:"medium",theme:"transparent",className:o()(v().icon,{}),svg:(0,w.jsx)(b,{}),handleClick:t}),(0,w.jsx)(g.t,{})]}):(0,w.jsx)(l(),{href:"/profile",onClick:t,className:v().link,children:"Войти"})},[e.authorized]);return m.Z.toBoolean(y.USER_AUTH_DISABLED)?null:r})},9891:function(e,n,t){"use strict";t.d(n,{$b:function(){return y},Sk:function(){return R},_W:function(){return w},e$:function(){return g},gG:function(){return O},mZ:function(){return _}});var r=t(59499),c=t(50029),u=t(87757),o=t.n(u),a=t(85034),i=t(11752),s=t.n(i),f=t(76489),l=t(82730),p=t(21399),v=t(11163),d=t.n(v);function h(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),t.push.apply(t,r)}return t}var b=s()().publicRuntimeConfig,k=function(e){return{type:l.OL,error:e instanceof Error?{message:e.message}:e}},m=function(){return{type:l.ku}},g=function(e){return{type:l.XX,payload:{data:e}}},w=function(e){var n;return n=(0,c.Z)(o().mark(function n(t){var r,c,u,i,s;return o().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return t(m()),n.next=3,a.Z.post("".concat(b.USER_AUTH_API_URL,"/api/v2/authorizations/widget/check"),JSON.stringify(e),{},{getRawResponse:!0});case 3:if(c=(r=n.sent).response,u=r.data,n.prev=6,!u.errors){n.next=9;break}throw{code:u.errors.code,message:u.errors.message};case 9:if(429!==c.status){n.next=11;break}throw{code:null,message:"Слишком много попыток входа. Попробуйте позже."};case 11:return i=d().query.backurl,s="/profile/auth",i&&(s+="?backurl=".concat(i)),n.next=16,d().replace(s);case 16:t(g(u.user)),n.next=22;break;case 19:n.prev=19,n.t0=n.catch(6),t(k(n.t0));case 22:case"end":return n.stop()}},n,null,[[6,19]])})),function(e){return n.apply(this,arguments)}},y=function(e){var n;return n=(0,c.Z)(o().mark(function n(t){var c,u,i,s;return o().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return t(m()),n.next=3,a.Z.post("".concat(b.USER_AUTH_API_URL,"/api/v1/oauth/").concat(e.provider),JSON.stringify((0,r.Z)({},e.provider,{code:e.code,redirect_uri:e.redirectURI})),{},{getRawResponse:!0});case 3:if(c=n.sent.data,n.prev=5,!(null!==(u=c.errors)&&void 0!==u&&null!==(u=u.confirmation)&&void 0!==u&&u.code)){n.next=8;break}throw{code:null,message:c.errors.confirmation.code};case 8:return i=d().query.backurl,s="/profile/auth",i&&(s+="?backurl="+i),n.next=13,d().replace(s);case 13:t(g(c.user)),n.next=19;break;case 16:n.prev=16,n.t0=n.catch(5),t(k(n.t0));case 19:case"end":return n.stop()}},n,null,[[5,16]])})),function(e){return n.apply(this,arguments)}},_=function(){return{type:l.qO}},O=function(e){return{type:l.ge,payload:function(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?h(Object(t),!0).forEach(function(n){(0,r.Z)(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):h(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}({},e)}},R=function(){var e;return e=(0,c.Z)(o().mark(function e(n){var t;return o().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t=f.parse(document.cookie).userToken1tv)){e.next=6;break}return e.next=4,a.Z.get("".concat(b.USER_AUTH_API_URL,"/api/v1/profiles"),"",{},{bearerToken:t,getRawResponse:!0}).then(function(e){var t;(null===(t=e.response)||void 0===t?void 0:t.status)===403&&n(_())}).catch(function(e){p.Z.errMessage("Check auth error. ".concat(null==e?void 0:e.message))});case 4:e.next=7;break;case 6:n(_());case 7:case"end":return e.stop()}},e)})),function(n){return e.apply(this,arguments)}}},96502:function(e){e.exports={icon:"Link_icon__KS1cL",notification:"Link_notification__OFema",link:"Link_link__lZDBf"}}}]);
</script>

</body>
</html>
