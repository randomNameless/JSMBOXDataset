<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>header.v3.html</title>
</head>
<body>

<script>
// JavaScript Document
var MMlarghezzaSitoAdv = window.innerWidth || document.documentElement.clientWidth || document.body.clientWidth;
/*--------------------CLS MASTHEAD ----------------------------------------------------*/
// per controllare lo scroll ed aggiungere una classe che mi permette di cambiare la posizione del background
let scrollPosBody = 0;//document.body.scrollTop || document.documentElement.scrollTop;
let gapScrollBody = 100;
let statusOpenMh = false;
let statusOpenMhTimer = false;


window.addEventListener("scroll", function () {
	scrollPosBody = document.body.scrollTop || document.documentElement.scrollTop;

	if (scrollPosBody <= gapScrollBody && MMlarghezzaSitoAdv < 780 && typeof emptyStrip !== 'undefined'){
		if(!emptyStrip && document.getElementById(divslotnameStrip)){
		console.log('[mediamond][minimh]===>call openMiniMh 1');
		openMiniMh();
		}
	}
});

//controllo della posizione della skin allo scrollTop
openMiniMh = () => {
	console.log('[mediamond][minimh]===>openMiniMh');
	// console.log('[mediamond][minimh]===>stripadv offsetheight:',document.getElementById(divslotnameStrip).offsetHeight);
	// console.log('[mediamond][minimh]===>statusOpenMh:',statusOpenMh);
	if (!statusOpenMh) {//lo faccio aprire una sola volta
		if (scrollPosBody <= gapScrollBody) {
			console.log('[mediamond][minimh]===>prima apertura su scroll top');
// 			document.querySelector('#mm-stripadv-point-cls').setAttribute('style', 'height:134px;-webkit-transition: height 2s ease-out; -moz-transition: height 2s ease-out; -o-transition: height 2s ease-out; transition: height 2s ease-out;overflow:hidden;z-index:0;');
// 			document.getElementById('stripadv').setAttribute("style", "display:block;");
            //if(document.querySelector(divslotnameStrip)){
				if(sizeStrip[1]>100){
					var sizeMiniMh = 134;
				}else{
					var sizeMiniMh = sizeStrip[1];
				}
            document.getElementById(divslotnameStrip).setAttribute('style', 'height:'+sizeMiniMh+'px;-webkit-transition: height 2s ease-out; -moz-transition: height 2s ease-out; -o-transition: height 2s ease-out; transition: height 2s ease-out;overflow:hidden;z-index:0;');
            //}
			statusOpenMh = true;
		} else {
			console.log('[mediamond][minimh]===>prima posizione su scroll');
// 			document.querySelector('#mm-stripadv-point-cls').setAttribute('style', 'height:1px;');
// 			document.getElementById('stripadv').setAttribute("style", "display:none;");
            //document.querySelector('#mm-stripadv-point-cls').setAttribute('style', 'height:1px;');
			document.getElementById(divslotnameStrip).setAttribute("style", "height:1px;");
		}
	} else {
		console.log('[mediamond][minimh]===>posizione successive su su scroll');
		if(statusOpenMhTimer){
			document.getElementById(divslotnameStrip).setAttribute("style", "z-index:0;position:initial;margin-top:0px;");//margin-top:40px;
		}else{
			document.getElementById(divslotnameStrip).setAttribute("style", "z-index:0;position:initial;");//margin-top:40px;
		}
	
// 		document.querySelector('#mm-stripadv-point-cls').setAttribute('style', 'height:1px;');
	}
}
minimhcls = () => {
	console.log('[mediamond][minimh]===>minimhcls');
	if (scrollPosBody > gapScrollBody) {
		console.log('[mediamond][strip]===>posizione fixed - scrollPosBody:', scrollPosBody);
		setTimeout(() => {
			if(!emptyStrip && document.getElementById(divslotnameStrip)){
			document.getElementById(divslotnameStrip).setAttribute("style", "height:134px;z-index:0;position:fixed;");
				openMiniMh();
			}
			statusOpenMhTimer=true;
			startStripMobile(true);
		}, 7000);
	} else {
		console.log('[mediamond][strip]===>posizione NON fixed: - scrollPosBody:', scrollPosBody);
		if(!emptyStrip && document.getElementById(divslotnameStrip)){
			openMiniMh();
		}
		startStripMobile(true);
	}
	// 	document.getElementById('stripadv').setAttribute("style","height:138px;-webkit-transition: height 2s ease-out; -moz-transition: height 2s ease-out; -o-transition: height 2s ease-out; transition: height 2s ease-out;overflow:hidden;");
}
//faccio caricare la strip in un secondo momento per poi ottimizzarla per la CLS
let startStripMobile = (initiator) => {
	if (typeof startStripMobileCheck !== 'undefined') return false;
	if (window.innerWidth > 480) return false;
	console.log('[strip mobile 2021] initiator', initiator);
	window.startStripMobileCheck = 1;
	googletag.cmd.push(function () {
		if (document.getElementById('div-gpt-320x50') && MMstatusStrip) {
			mm_stript2 = googletag.defineSlot(MMsezioneTag, [320, 50], 'div-gpt-320x50').
				setTargeting("pos", "1").
				setCollapseEmptyDiv(true, true).
				addService(googletag.pubads());

			googletag.pubads().addEventListener('slotRenderEnded', function (event) {
				if (event.slot === window.mm_stript2) {
					// sizeStrip = event.size;
					console.log('[mediamond][strip]===>event.isEmpty',event.isEmpty)
					if (!event.isEmpty)
						ChangePosition();
					MMloadSticky = true;
					//globalRefreshTag(mm_stript2);
				}
			});
			googletag.display('div-gpt-320x50');
			googletag.pubads().refresh([mm_stript2]);

		}
	})
}
/*--------------------FINE CLS MASTHEAD ----------------------------------------------------*/
//vengono definite delle variabili che poi verranno utilizzate nei js per l'erogazione dei formati
var MMdatiSkin = new Array();
var nomeSito = 'ilgiornale';
var MMstatusStrip = true;
var MMstatusLb = true;
var MMstatusRichMedia = true;
var MMstatusSkin = true;
var MMstatusBox = true;
var statusInread = true;
let MMstatusRefresh300x250 = false; //mi serve per gestire il refres del box
var statusSeedTag = true;
var MMstatusPromoBox = true;
var MMstatusNativePromoBox = true;
var MMstatusAdv = true;
var MMstatusPersonalizzazioniWeb = false;
var idSitoDfp = '244175897';
var KruxSegments;
var KruxUser;
var ppid = '';
var MMstatusConsent = false;//controllo se Ã¨ stato dato il consenso alla cookie policy
var MMblog = false;//si attiva solo sui blog
//per differenziare le varie sezioni
var MMSitoHp = window.location.href;
var MMarrayUrlSkin = new Array();
MMarrayUrlSkin = MMSitoHp.split('/');
/*controllo per togliere la skin momentaneamente*/
var MMarrayUrlSkinControllo = new Array();
MMarrayUrlSkinControllo = MMSitoHp.split('?');
var VerificaSottocanale = MMarrayUrlSkin[3].substr(0, 1);
//url modificata per passarla nel settargheting
var urlSetTargheting = MMarrayUrlSkinControllo[0].replace('http://', '').replace('https://', '').replace('www.', '').replace('?refresh', '').replace('?utm_source=Zemanta&utm_medium=referral', '').replace(/\//gi, '_').replace('=', '_', 'ig').replace('!', '_', 'ig').replace('+', '_', 'ig').replace('*', '_', 'ig').replace('#', '_', 'ig').replace('^', '_', 'ig').replace('~', '_', 'ig').replace(';', '_', 'ig').replace('(', '_', 'ig').replace(')', '_', 'ig').replace('[', '_', 'ig').replace(']', '_', 'ig').replace('"', '_', 'ig').replace("'", "_", "ig").replace('<', '_', 'ig').replace('>', '_');
var cssTemplateSkin = 1;
var MMPosition = 'init';
/* varibile per il canale della tag*/
var MMsezioneTag;





//caricamento del file utility
function mediamondLoader(objAttr, chainId = null, elementType = "script", target = document.body) {
	return new Promise(function (resolve, reject) {
		let element = document.createElement(elementType);

		for (const property in objAttr) {
			element.setAttribute(property, objAttr[property]);
		}
		let path = objAttr.src || objAttr.href;
		element.onload = () => {
			resolve(element);
			console.log(`[mediamondLoader] ${path} caricato!`, "chainId_" + chainId + " Time: " + performance.now());
		};
		element.onerror = e => {
			reject(
				new Error(`[mediamondLoader] Errore sul caricamento di ${path}`)
			);
			console.log(e);
		};

		target.appendChild(element);
	});
}

let statusApprovazione = false;//inserito per risolvere un problema sul sito
initGptCMP = (val) => {
	console.log('[mediamond][adv]===>initGptIubenda:',(performance.now()/1000));
	if(!statusApprovazione && val == 0){
		statusApprovazione = true;
		mediamondLoader({
			src: "https://adv.mediamond.it/hp_sponsor/utility_mediamond.v2.js",
			async: true
		}).then(
			element => checkGoogleReady()
		);
	}
};



checkGoogleReady = () =>{
	console.log('[mediamond][cmp]===> checkGoogleReady');
		if (window.googletag && googletag.apiReady) {
			initTagGpt();
		}else{
			console.log('[mediamond][cmp]===> no lib google');
			timerGPTLib = setTimeout(function(){checkGoogleReady();},500);
		}
}

//+++++++++++++++++++++++++++++++++++++++++++++++++++++++++

function sendAdUnit(canaleSito) {
	MMsezioneTag = '/4758/' + canaleSito;
}
//
if (MMarrayUrlSkin[2] == 'www.ilgiornale.it' || MMarrayUrlSkin[2] == 'm.ilgiornale.it') {
	if (MMarrayUrlSkin[3] == '' || VerificaSottocanale == '?' || MMSitoHp == 'http://www.ilgiornale.it/#/senato/tempo-reale/1') {
		sendAdUnit('altri_ilgiornale/home');
	} else if (MMarrayUrlSkin[4] == 'economia' || MMarrayUrlSkinControllo[0] == 'https://www.ilgiornale.it/sezioni/economia.html') {
		sendAdUnit('altri_ilgiornale/economia');
		MMstatusRefresh300x250 = true;
	} else if (MMarrayUrlSkin[4] == 'motori' || MMarrayUrlSkinControllo[0] == 'https://www.ilgiornale.it/sezioni/auto-moto-motori.html') {
		sendAdUnit('altri_ilgiornale/motori');
		MMstatusRefresh300x250 = true;
	} else if (MMarrayUrlSkin[3] == 'video' || MMarrayUrlSkinControllo[0] == 'https://www.ilgiornale.it/sezioni/video.html') {
		sendAdUnit('altri_ilgiornale/video');
		MMstatusRefresh300x250 = true;
	} else if (MMarrayUrlSkin[4] == 'sport' || MMarrayUrlSkinControllo[0] == 'https://www.ilgiornale.it/sezioni/sport.html') {
		sendAdUnit('altri_ilgiornale/sport');
		MMstatusRefresh300x250 = true;
	} else if (MMarrayUrlSkin[4] == 'politica' || MMarrayUrlSkinControllo[0] == 'https://www.ilgiornale.it/sezioni/interni.html') {
		sendAdUnit('altri_ilgiornale/politica');
		MMstatusRefresh300x250 = true;
	} else if (MMarrayUrlSkin[4] == 'cronache' || MMarrayUrlSkinControllo[0] == 'https://www.ilgiornale.it/sezioni/cronache.html') {
		sendAdUnit('altri_ilgiornale/cronaca');
		MMstatusRefresh300x250 = true;
	} else if (MMarrayUrlSkin[4] == 'milano' || MMarrayUrlSkinControllo[0] == 'https://www.ilgiornale.it/sezioni/milano.html') {
		sendAdUnit('altri_ilgiornale/milano');
		MMstatusRefresh300x250 = true;
	} else if (MMarrayUrlSkin[4] == 'sport' || MMarrayUrlSkinControllo[0] == 'https://www.ilgiornale.it/sezioni/sport.html') {
		sendAdUnit('altri_ilgiornale/sport');
		MMstatusRefresh300x250 = true;
	} else {
		sendAdUnit('altri_ilgiornale/altre');
		MMstatusRefresh300x250 = true;
	}
} else if (MMarrayUrlSkin[2] == 'blog.ilgiornale.it') {
	sendAdUnit('altri_ilgiornale/altre');
	MMstatusRefresh300x250 = true;
	MMblog = true;
} else {
	sendAdUnit('altri_ilgiornale/altre');
	MMstatusRefresh300x250 = true;
}
//cerco la sotto stringa sulle url dei pubbliredazionali dalla url principale per poi poter settare una adunit pubbli
var MMurlPubbli = new Array();
var MMstatusPubbli;
MMurlPubbli.push("speciale-nessuno");
for (t = 0; t < MMurlPubbli.length; t++) {
	MMstatusPubbli = MMSitoHp.indexOf(MMurlPubbli[t]);
	if (MMstatusPubbli > 0) {
		sendAdUnit('altri_ilgiornale/publi');
	}
}
if (typeof (mediamondTag) == undefined || typeof (mediamondTag) == 'undefined') {
	//usando le tag di wordpress settate nell'array mediamondTag
	mediamondTag = '';
}
if (mediamondTag == 'elezioni' || MMarrayUrlSkin[2] == 'elezioni.ngn.ilgiornale.it' || MMSitoHp == 'http://www.ilgiornale.it/sezioni/interni.html#/senato/tempo-reale/1') {
	sendAdUnit('altri_ilgiornale/publi/speciale_elezioni');
	statusInread = false;
}
//no adv
if(MMarrayUrlSkinControllo[1] == 'noadvmediamond'){
	MMstatusAdv = false;
	console.log('[mediamond][adv]===>disattivazione temporanea adv');
}
//krux////////////////////////////////////////////////////
window.Krux || ((Krux = function () { Krux.q.push(arguments); }).q = []);
(function () {
	function retrieve(n) {
		var k = 'kx' + '' + n, ls = (function () {
			try {
				return window.localStorage;
			} catch (e) {
				return null;
			}
		})();
		if (ls) {
			return ls[k] || '';
		} else if (navigator.cookieEnabled) {
			var m = document.cookie.match(k + '=([^;]*)');
			return (m && unescape(m[1])) || '';
		} else {
			return '';
		}
	}
	Krux.user = retrieve('user');
	Krux.segments = retrieve('segs') ? retrieve('segs').split(',') : [];
})();
///////////////////////////////////////////////////////////
var sezionePaginaKey = new Array();
var keywordURL = '';
function cercaSezioneUrl() {
	//ciclo tutte le parole dell'array
	var numeroMMarrayUrlSkin = MMarrayUrlSkin.length;
	for (u = 3; u < (MMarrayUrlSkin.length - 1); u++) {
		sezionePaginaKey.push((MMarrayUrlSkin[u].replace('#', '')).toLowerCase());
	}
	var urlFinaleArticolo = MMarrayUrlSkin[(numeroMMarrayUrlSkin - 1)].split('-');
	var urlArrayArticoloCompleto = sezionePaginaKey.concat(urlFinaleArticolo);
	for (i = 0; i < urlArrayArticoloCompleto.length; i++) {
		keywordURL += (urlArrayArticoloCompleto[i].replace('#', '')) + ',';
	}
	//aggiungo alle kw anche quello che sta oltre il ?
	if (MMarrayUrlSkinControllo[1] != undefined && MMarrayUrlSkinControllo[1] != '') {
		keywordURL += MMarrayUrlSkinControllo[1] + ',';
	}
}
cercaSezioneUrl();
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/// STRUTTURA SRA ///////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
var idCampagnaBox;
var idCampagnaMastHead;

var MMerogazioneSkin = false;
var campaignIdStrip;
var creativeIdStrip;
var lineItemIdStrip;
var sizeStrip;
var sizeLb;
var campaignIdBox;
var creativeIdBox;
var lineItemIdBox;
var sizeBox;
var OggiHp = new Date;
var GiornoHp = OggiHp.getDate();
var MeseHp = OggiHp.getMonth() + 1;
if (MMlarghezzaSitoAdv < 970) {
	//mobile
	divslotnameBox = 'adv-gpt-box-mobile-container1';
	divslotpromobox1 = 'adv-gpt-promobox-mobile-container1';
	divslotpromobox2 = 'adv-gpt-promobox-mobile-container2';
	divslotpromobox3 = 'adv-gpt-promobox-mobile-container3';
	divslotpromobox4 = 'adv-gpt-promobox-mobile-container4';
	MMstatusLb = false;
} else {
	//desktop
	divslotnameBox = 'adv-gpt-box-container1';
	divslotpromobox1 = 'adv-gpt-promobox-container1';
	divslotpromobox2 = 'adv-gpt-promobox-container2';
	divslotpromobox3 = 'adv-gpt-promobox-container3';
	divslotpromobox4 = 'adv-gpt-promobox-container4';
}
divslotnameStrip = 'adv-gpt-masthead-skin-container1';
divslotnameStripId = '#adv-gpt-masthead-skin-container1';
//
if (MMlarghezzaSitoAdv < 970) {//il refresh deve essere attivo solo su desktop
	MMstatusRefresh300x250 = false;
}

///++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
//++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
//pubmatic senza consenso
initOpenWrap = () => {
	console.log('[mediamond][no-consent]===>initOpenWrap');
	mediamondLoader({
	src: "https://adv.mediamond.it/librerie/js-no-consent/ilgiornale/adv_no_consent.js",
	async: true
	});
}
//
//if(MMarrayUrlSkinControllo[1]=="testpubmaticnoconsent"){
let checkConsentPolicy = () => { 
	console.log('[mediamond][no-consent]');
	try{
		__tcfapi('addEventListener', 2, function(tcdataadv,success) {
			//your custom callback code can be included here
			console.log("[mediamond][no-consent]retrieving TCDATA:", tcdataadv);
			//console.log("[mediamond][no-consent]retrieving TCDATA:", tcdata);
			if (success) {
				console.log("[mediamond][no-consent]success:", success);
				console.log("[mediamond][no-consent]stringa di consenso:",tcdataadv.tcString);
				if (tcdataadv.hasOwnProperty('purpose')
				&& tcdataadv['purpose'].hasOwnProperty('consents')
				&& tcdataadv['purpose']['consents'].hasOwnProperty('1')
				&& tcdataadv['purpose']['consents']['1'] == true 
				&& tcdataadv['purpose']['consents']['2'] == true 
				&& tcdataadv['purpose']['consents']['3'] == true) {
					// consent ok nothing to do
					//console.log('PrebidAds: consent ok nothing to do');
					console.log('[mediamond][no-consent]===>consenso dato');
					statusConsent = true;
					clearInterval(timerCheckConsent);
				} else {
					//initOpenWrap();
					//console.log('[mediamond][no-consent]===>consenso NON dato ',tcdataadv.eventStatus);
					if (tcdataadv.eventStatus==="cmpuishown") {  
						console.log('[mediamond][no-consent]===>Utente non ha mai espresso preferenza');
						//console.log('[mediamond][no-consent]===>',tcdataadv.eventStatus);
					}else{
						clearInterval(timerCheckConsent);
						initOpenWrap();
						console.log('[mediamond][no-consent]===>consenso negato');
						//console.log('[mediamond][no-consent]===>',tcdataadv.eventStatus);
					}
				}
			}
		});
	}catch(err){
		console.log('[mediamond][no-consent]',err);
	}
}
let timerCheckConsent = setInterval(checkConsentPolicy,500);
//++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
//++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
function initTagGpt() {

	//leggo il cookie del UID
	try {
		var ppidcookie = Cookies.get("_mediamond_UID");
		//console.log('utag definito');
		if(ppidcookie != null)
		ppid = Cookies.get("_mediamond_UID");
	} catch (error) {
		console.log('ppid cookie:',error)
	}

	MMstatusConsent = true;
	/*--------------------------------CLS MASTHEAD---------------------------------------------------------------------*/
	//configurazione fatta per l'ottimizzazione del CLS
	if (MMlarghezzaSitoAdv > 760) {
		// if(MMarrayUrlSkinControllo[1] != 'optcls=1'){
		// 	document.getElementById(divslotnameStrip).style.position = 'absolute';
		// 	document.getElementById(divslotnameStrip).style.display = 'none';
		// }
	} else {
		if (scrollPosBody > gapScrollBody) {
			document.getElementById(divslotnameStrip).setAttribute("style", "position:fixed;height:1px;min-height:1px;top:62px;z-index:100;background-color: #fff;");
		}
// 		//inserisco un div per avere un punto di riferimento per aprire lo spazio
// 		var poitClsMobileStrip = document.createElement('div');
// 		poitClsMobileStrip.setAttribute('id', 'mm-stripadv-point-cls');
// 		poitClsMobileStrip.setAttribute('style', 'height:1px;');
// 		document.querySelector(".d").insertBefore(poitClsMobileStrip, document.querySelector("#stripadv").nextSibling);
	}
	// 	document.getElementById('stripadv').setAttribute("style","height:1px;overflow:hidden;");
	/*---------------------------------FINE CLS MASTHEAD--------------------------------------------------------------------*/
	if (MMstatusAdv) {
		if (MMarrayUrlSkin[2] == 'investimenti.ilgiornale.it') {
			keywordURL += 'moneyfarm,';
		}
		if (MMlarghezzaSitoAdv > 970) {
			var lipHpsponsor = document.createElement("script");
			lipHpsponsor.async = false;
			lipHpsponsor.type = "text/javascript";
			lipHpsponsor.src = "//adv.mediamond.it/hpsponsor/ilgiornale/hpsponsor_dinamic.v3.js";
			var node = document.getElementsByTagName("body")[0];
			node.parentNode.insertBefore(lipHpsponsor, node);
		}
		//creo un div in cui erogare la tag del out of page
let stOop = document.createElement('style');
	
	let	cssOop = '#adv-gpt-outofpage  {\n';
		cssOop += '   position: fixed;\n';
		cssOop += '   height: 100%;\n';
		cssOop += '   width: 100%;\n';
		cssOop += '   overflow:hidden;\n';
		cssOop += '   top:0;\n';
		cssOop += '   left:0;\n';
		cssOop += '   z-index:-1;\n';
		cssOop += '}\n';

		cssOop += '@media screen and (max-width: 999px) {\n';

		cssOop += '		#adv-gpt-outofpage > div[id^="google_ads_iframe"] {\n';
		cssOop += '  		margin-top: 30vw;\n';
		cssOop += '  		min-height: 600px;\n';
		cssOop += '		}\n';

		cssOop += '}\n';

	document.head.appendChild(stOop);
	stOop.appendChild(document.createTextNode(cssOop));

	//creo un div in cui erogare la tag del out of page
	if(!document.getElementById('adv-gpt-outofpage')) {
		var oopDiv = document.createElement('div');
		oopDiv.setAttribute('id', 'adv-gpt-outofpage');
	
		document.body.appendChild(oopDiv);
	}

	document.getElementById("adv-gpt-outofpage").innerHTML = "<img src='//static.mediamond.it/img_generiche/20x20.png' style='width:25px;height:25px'>";//per iasÃƒÂ¹
		
		
		var newdiv = document.createElement('div');
		newdiv.setAttribute('id', 'gpt-inread');
		newdiv.setAttribute("style", "position:absolute;width:1px;height:1px;overflow:hidden;");
		var node = document.getElementsByTagName("body")[0];
		node.appendChild(newdiv);
		//creo un div in cui erogare la tag della strip 320x50
		if (MMlarghezzaSitoAdv < 760) {
			var newdiv = document.createElement('div');
			newdiv.setAttribute('id', 'div-gpt-320x50');
			newdiv.setAttribute("style", "position:absolute;width:1px;height:1px;overflow:hidden;");
			var node = document.getElementsByTagName("body")[0];
			node.appendChild(newdiv);
			//jQuery("<div id='" + divslotnameStrip + "'></div>").insertBefore(".container");

		}

		if (typeof (ADX_label) != undefined && typeof (ADX_label) != 'undefined') {
		} else {
			ADX_label = '';
		}

		if (typeof (Krux) != undefined && typeof (Krux) != 'undefined') {
			KruxSegments = Krux.segments;
			KruxUser = Krux.user;
		} else {
			KruxSegments = '';
			KruxUser = '';
		}

		let rifPointInread = document.querySelector('.typography--content > p:nth-of-type(2)');
		if (rifPointInread) {
		    let divInread = document.createElement("div");
		    divInread.id = "adv-video-article";
		    rifPointInread.insertAdjacentElement('afterend', divInread);
		}



		googletag.cmd.push(function () {
			if (MMstatusRichMedia) {
				richmedia = googletag.defineOutOfPageSlot(MMsezioneTag, 'adv-gpt-outofpage').addService(googletag.pubads());
			}
			if (MMarrayUrlSkinControllo[0] != 'noskin') {
				if (devTypeUtility == "mobile_web_ipad" || devTypeUtility == "mobile_web_android_tablet") {
					var mappingStrip = googletag.sizeMapping().
						addSize([0, 0], [[320,50],[320,100],[720, 240]]).
						addSize([401, 499], [720, 240]).
						addSize([971, 500], [[100, 100], [970, 250]]).
						build();
				} else {
					var mappingStrip = googletag.sizeMapping().
						addSize([0, 0], [[320,50],[320,100],[720, 240]]).
						addSize([971, 500], [[100, 100], [970, 250]]).
						build();
				}
			} else {
				if (devTypeUtility == "mobile_web_ipad" || devTypeUtility == "mobile_web_android_tablet") {
					var mappingStrip = googletag.sizeMapping().
						addSize([0, 0], [[320,50],[320,100],[720, 240]]).
						addSize([401, 499], [720, 240]).
						addSize([971, 500], [[970, 250]]).
						build();
				} else {
					var mappingStrip = googletag.sizeMapping().
						addSize([0, 0], [[320,50],[320,100],[720, 240]]).
						addSize([971, 500], [[970, 250]]).
						build();
				}
			}
			var mappingBox = googletag.sizeMapping().
				addSize([0, 0], [[300, 250]]).//modifica richiesta dall'editore
				addSize([971, 500], [[300, 250], [300, 600]]).
				build();

			//strip
			if (document.getElementById(divslotnameStrip) && MMstatusStrip) {
				mm_stript1 = googletag.defineSlot(MMsezioneTag, [970, 250], divslotnameStrip)
				.defineSizeMapping(mappingStrip)
				.setTargeting("pos", "1")
				.setCollapseEmptyDiv(false)//non collassa mai
				.addService(googletag.pubads());
			}
			
			if (document.getElementById(divslotnameBox) && MMstatusBox) {
				mm_box1 = googletag.defineSlot(MMsezioneTag, [300, 250], divslotnameBox)
					.defineSizeMapping(mappingBox)
					.setTargeting("pos", "1")
					.setCollapseEmptyDiv(false)//non collassa mai
					.addService(googletag.pubads());
			}
			if (document.getElementById('adv-gpt-leaderboard-container') && MMstatusLb) {
				mm_leaderbord1 = googletag.defineSlot(MMsezioneTag, [728, 90], 'adv-gpt-leaderboard-container')
					.setTargeting("pos", "1")
					.setCollapseEmptyDiv(true, true)
					.addService(googletag.pubads());
			}
			if (MMstatusPromoBox) {
				if ((document.getElementById("adv-gpt-promobox-container1") && MMlarghezzaSitoAdv >= 970) || (document.getElementById("adv-gpt-promobox-mobile-container1") && MMlarghezzaSitoAdv < 970)) {
					promobox1 = googletag.defineSlot(MMsezioneTag, [301, 101], divslotpromobox1)
						.addService(googletag.pubads())
						.setCollapseEmptyDiv(true)
						.setTargeting("pos", "1");
				}
				if ((document.getElementById("adv-gpt-promobox-container2") && MMlarghezzaSitoAdv >= 970) || (document.getElementById("adv-gpt-promobox-mobile-container2") && MMlarghezzaSitoAdv < 970)) {
					promobox2 = googletag.defineSlot(MMsezioneTag, [[301, 101], 'fluid'], divslotpromobox2)
						.addService(googletag.pubads())
						.setCollapseEmptyDiv(true)
						.setTargeting("pos", "2");
				}
				if ((document.getElementById("adv-gpt-promobox-container3") && MMlarghezzaSitoAdv >= 970) || (document.getElementById("adv-gpt-promobox-mobile-container3") && MMlarghezzaSitoAdv < 970)) {
					promobox3 = googletag.defineSlot(MMsezioneTag, [301, 101], divslotpromobox3)
						.addService(googletag.pubads())
						.setCollapseEmptyDiv(true)
						.setTargeting("pos", "3");
				}
				if ((document.getElementById("adv-gpt-promobox-container4") && MMlarghezzaSitoAdv >= 970) || (document.getElementById("adv-gpt-promobox-mobile-container4") && MMlarghezzaSitoAdv < 970)) {
					promobox4 = googletag.defineSlot(MMsezioneTag, [301, 101], divslotpromobox4)
						.addService(googletag.pubads())
						.setCollapseEmptyDiv(true)
						.setTargeting("pos", "4");
				}
			}

			if (document.getElementById('adv-video-article') && statusInread) {
				mm_inread = googletag.defineSlot(MMsezioneTag, [640, 5], 'gpt-inread').addService(googletag.pubads()).setCollapseEmptyDiv(true);
			}
			googletag.pubads().setTargeting("purl", "" + urlSetTargheting + "");
			googletag.pubads().setTargeting("keywordURL", ["" + keywordURL + ""]);
			googletag.pubads().setTargeting("sezionePagina", ["" + sezionePaginaKey + ""]);
			googletag.pubads().setTargeting("adx", ADX_label);
			googletag.pubads().setTargeting("ksg", KruxSegments);
			googletag.pubads().setTargeting("kuid", KruxUser);
			googletag.pubads().setTargeting("blog", "" + MMblog + "");
			googletag.pubads().setTargeting("publisher_id", ppid);
			googletag.pubads().setPublisherProvidedId(ppid);
			googletag.pubads().enableSingleRequest();
			googletag.pubads().disableInitialLoad();
			googletag.enableServices();
			googletag.pubads().addEventListener('slotOnload', function (event) {
				if (document.getElementById('adv-gpt-leaderboard-container') && MMstatusLb) {
					if (event.slot === mm_leaderbord1) {
						if (sizeLb == '728,90') {
						}
					}
				}
				if (document.getElementById(divslotnameBox) && MMstatusBox) {
					if (event.slot === mm_box1) {
					}
				}
			});
			//////////////////////////////////////////////////////////////////////////
			googletag.pubads().addEventListener('slotRenderEnded', function (event) {
				
				if (document.getElementById('adv-gpt-leaderboard-container') && MMstatusLb) {
					sizeLb = event.size;
					if (event.slot === mm_leaderbord1) {
						console.log('[mediamond][lb]====>event.isEmpty:'+event.isEmpty);
						if (sizeLb == '728,90') {
							if (event.isEmpty == false) {
								document.body.classList.add("ig-leaderboard-visible");
							}
						}
					}
				}
				if (document.getElementById(divslotnameBox) && MMstatusBox) {
					if (event.slot === mm_box1) {
						console.log('[mediamond][adv]===>slotRenderEnded:',(performance.now()/1000));
						campaignIdBox = event.campaignId;
						creativeIdBox = event.creativeId;
						lineItemIdBox = event.lineItemId;
						sizeBox = event.size;
						idCampagnaBox = event.campaignId;
						document.getElementById(divslotnameBox).style.textAlign = 'center';
					}
				}
				if (document.getElementById(divslotnameStrip) && MMstatusStrip) {
					if (event.slot === mm_stript1) {
						sizeCompletaStrip = event.size;
						idCampagnaMastHead = event.campaignId;
						campaignIdStrip = event.campaignId;;
						creativeIdStrip = event.creativeId;;
						lineItemIdStrip = event.lineItemId;
						sizeStrip = event.size;
						console.log('[mediamond][strip]===>sizeStrip',sizeStrip)
						if(sizeStrip == '100,100'){
							//document.getElementById(divslotnameStrip).style.position = 'absolute';
							document.getElementById(divslotnameStrip).style.display = 'none';
							document.querySelector('.banner-mm').style.opacity = '0';
						}
						if (MMlarghezzaSitoAdv <= 720 && sizeCompletaStrip == '720,240' && !event.isEmpty) {
							ResizeIframe4();
							console.log('[mediamond][minimh]===>chiamta ResizeIframe4');
						}
						if (MMlarghezzaSitoAdv >= 970 && sizeCompletaStrip == '970,250') {
							document.getElementById(divslotnameStrip).style.marginTop = '10px';
							document.getElementById(divslotnameStrip).style.marginBottom = '10px';
							document.getElementById(divslotnameStrip).style.textAlign = 'center';
						}
						emptyStrip = event.isEmpty;
						if (event.isEmpty == false) {
							document.getElementById(divslotnameStrip).style.display = 'block';
						}else{
							startStripMobile(true);
						}
						if (sizeStrip != '100,100' && sizeStrip != null) {

							/*--------------------CLS MASTHEAD ----------------------------------------------------*/
							console.log('[mediamond][strip]===>onload mm_stript1 status Empty:', emptyStrip);
							if (MMlarghezzaSitoAdv > 760) {
								document.getElementById(divslotnameStrip).style.position = 'initial';
								document.getElementById(divslotnameStrip).style.display = 'block';
							} else if (!emptyStrip) {
								document.getElementById(divslotnameStrip).style.display = 'block';
								minimhcls();
							} else if (emptyStrip) {
								document.getElementById(divslotnameStrip).style.display = 'none';
								startStripMobile(true);
							}
							/*--------------------CLS MASTHEAD ----------------------------------------------------*/
	
						}

					}
				}

			});

		});
		/*configurazione ias per ottimizzazione --------------------------------------------------------------------------------------------------- */
		// The following lines provide an example of how you can encapsulate the call to
		// DFP in a function that ensures the ads are requested only once. If you use
		// lazy loading and need to call DFP multiple times for the same page, we can
		// provide a different example that manages such a case (ensuring that only
		// new ad slots are refreshed).
		var adserverRequestSent = false;
		function requestAds() {
			if (adserverRequestSent) return;
			clearTimeout(IASPET_TIMEOUT);
			googletag.pubads().refresh(); // Display the ads
			
			adserverRequestSent = true;
		}
		// Initial IAS setup
		var iasDataHandler;
		window.__iasPET = window.__iasPET || {};
		window.__iasPET.queue = window.__iasPET.queue || [];
		window.__iasPET.pubId = '929824'; // constant for your account
		var IASPET_TIMEOUT = 2000; // max milliseconds to wait for a PET response
		var __iasPETTimeoutRequestAds = setTimeout(requestAds, IASPET_TIMEOUT);
		var iasDataHandler = function (adSlotData) {
			clearTimeout(__iasPETTimeoutRequestAds);
			window.__iasPET.setTargetingForGPT();
			requestAds();
		};

		// make the PET request
		googletag.cmd.push(function () {
			// read the currently defined GPT ad slots for sending to the PET endpoint
			// defined all GPT ad slots before calling PET
			var gptSlots = googletag.pubads().getSlots();
			var iasPETSlots = [];
			for (var i = 0; i < gptSlots.length; i++) {
				var sizes = gptSlots[i].getSizes().map(function (size) {
					if (size.getWidth && size.getHeight)
						return [size.getWidth(), size.getHeight()];
					else
						return [1, 1];
				});
				iasPETSlots.push({
					adSlotId: gptSlots[i].getSlotElementId(),
					//size: can either be a single size (for example, [728, 90])
					// or an array of sizes (for example, [[728, 90], [970, 90]])
					size: sizes,
					adUnitPath: gptSlots[i].getAdUnitPath()
				});
			}
			// make the request to PET. if your page makes multiple ad requests to DFP
			// (for example, lazily loaded ads, infinite scrolling pages, etc.), make
			// a request to PET before every request to DFP
			window.__iasPET.queue.push({
				adSlots: iasPETSlots,
				dataHandler: iasDataHandler
			});
		});
		/* fine configurazione ias -------------------------------------------------------------------------------------------- */
		
		//seedtag
		// if (MMstatusAdv) {
		// 	initSeedTag();
		// }
		
		
	}//if(MMstatusAdv){
}//initTagGpt

function ChangePosition() {
	scollStrip = true;
	document.querySelector('#div-gpt-320x50').setAttribute('style', 'left: 0; position:fixed; bottom:0; height:50px; z-index:999999;text-align:center;width:100%;background-color:#fff;-webkit-box-shadow: 0px -3px 3px 0px rgba(50, 50, 50, 0.75);box-shadow: 0px -3px 3px 0px rgba(50, 50, 50, 0.75);-webkit-transition: all 0.3s ease-in-out;');
}
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/// FINE STRUTTURA SRA ///////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

//-----------------------------------------------------------------------------------------------------------
var nRefresh = 0;
//funzione per il refresh
function MediamondTagRefresh() {
	//viene fatto il refresh della tag dopo la 4Â° chiamata
	if (nRefresh == 4) {
		googletag.pubads().refresh([window.mm_box1]);
		nRefresh = 0;
	} else {
		nRefresh++;
	}
}
//---------------------------------------------------------------------------------------------------------
var arraySlot = new Array();
var arraySlotMh = new Array();
var posNew = 1;
//controllo lo scrol della pagina
window.addEventListener('load', function () {
	console.log('[mediamond][scroll]===>load');
	window.addEventListener('scroll', function () {
		//console.log('[mediamond][scroll]===>scroll');
		if (MMstatusAdv && MMstatusConsent) {
			for (n = 2; n < 20; n++) {
				if (document.getElementById("adv-gpt-box-container" + n) && MMlarghezzaSitoAdv >= 970 && MMstatusBox) {
					//console.log('[mediamond][scroll]===>if generate');
					if (arraySlot[n] == undefined) {
						console.log('[mediamond][scroll]===>func generate');
						generaGpt(n);
					}
				}
				if (document.getElementById("adv-gpt-box-mobile-container" + n) && MMlarghezzaSitoAdv < 970 && MMstatusBox) {
					if (arraySlot[n] == undefined) {
						generaGpt(n);
					}
				}
				if (document.getElementById("adv-gpt-masthead-skin-container" + n) && MMstatusStrip) {
					if (arraySlotMh[n] == undefined) {
						generaGptMh(n);
					}
				}
			}
		}//if(MMstatusAdv){
	});
});//load
//questa funzione genera le tag gpt
function generaGpt(nSlot) {
	console.log('[mediamond][scroll]===>generaGpt:',nSlot);
	posNew = nSlot;
	if (MMlarghezzaSitoAdv < 970) {
		divslotnameNew = 'adv-gpt-box-mobile-container' + nSlot;
	}else{
		divslotnameNew = 'adv-gpt-box-container' + nSlot;
	}

	googletag.cmd.push(function () {

		window['mm_box' + posNew] = googletag.defineSlot(MMsezioneTag, [[300, 250],[300, 600]], divslotnameNew).addService(googletag.pubads())
			.setTargeting("pos", "" + posNew + "").setCollapseEmptyDiv(true).setTargeting("ksg", KruxSegments).setTargeting("kuid", KruxUser);
		googletag.pubads().setTargeting("idcampagna", "" + idCampagnaBox + "");
		googletag.pubads().setTargeting("purl", "" + urlSetTargheting + "");
		googletag.enableServices();
	});

	arraySlot[nSlot] = "pieno";
	googletag.cmd.push(function () { googletag.display(divslotnameNew); });
	googletag.pubads().refresh([window['mm_box' + posNew]]);
}
//per generare il masthead **************************************************************
function generaGptMh(nSlot) {
	console.log('[mediamond][scroll]===>generaGpt strip:',nSlot);
	posNewStrip = nSlot;

	divslotnameStripNew = 'adv-gpt-masthead-skin-container' + nSlot;

	googletag.cmd.push(function () {

		
		var mappingStrip = googletag.sizeMapping().
			addSize([0, 0], [[720, 240]]).
			addSize([401, 499], [720, 240]).
			addSize([971, 500], [970, 250]).
			build();


		window['mm_strip' + posNewStrip] = googletag.defineSlot(MMsezioneTag, [[300, 250],[300, 600]], divslotnameStripNew).addService(googletag.pubads()).defineSizeMapping(mappingStrip)
			.setTargeting("pos", "" + posNewStrip + "").setCollapseEmptyDiv(true).setTargeting("ksg", KruxSegments).setTargeting("kuid", KruxUser);
		googletag.pubads().setTargeting("idcampagna", "" + idCampagnaBox + "");
		googletag.pubads().setTargeting("purl", "" + urlSetTargheting + "");
		googletag.enableServices();
	});
	
	arraySlotMh[nSlot] = "pieno";
	googletag.cmd.push(function () { googletag.display(divslotnameStripNew); });
	googletag.pubads().refresh([window['mm_strip' + posNewStrip]]);
}
/* cerco di modificare la larghezza dell'iframe per renderlo dinamico sotto i 1024*/
var width_window = window.innerWidth || document.documentElement.clientWidth || document.body.clientWidth;
mediamondAdv1 = new Object();


//controllo dimensioni minimasthead
timerCheckIframe = setInterval(function(){CheckIframe();}, 1000);
function CheckIframe() {
	if(MMlarghezzaSitoAdv<980){
		//console.log('===>CheckIframe 3.1');
		for (MMnIframeGoogleLoop=2;MMnIframeGoogleLoop<40;MMnIframeGoogleLoop++){
		//console.log('[mediamond]===> height iframe'+MMnIframeGoogleLoop+':'+document.getElementById("google_ads_iframe_"+MMsezioneTag+"_"+MMnIframeGoogleLoop).offsetHeight);
			if (document.getElementById("google_ads_iframe_"+MMsezioneTag+"_"+MMnIframeGoogleLoop)) {
				if(document.getElementById("google_ads_iframe_"+MMsezioneTag+"_"+MMnIframeGoogleLoop).offsetHeight <= 240 && document.getElementById("google_ads_iframe_"+MMsezioneTag+"_"+MMnIframeGoogleLoop).offsetHeight != 0){

					var iFrameGptMastHead = document.getElementById("google_ads_iframe_"+MMsezioneTag+"_"+MMnIframeGoogleLoop);
					var divGptMastHead = document.getElementById("google_ads_iframe_"+MMsezioneTag+"_"+MMnIframeGoogleLoop+"__container__");
					var iFrameGptMastHeadWidth = document.getElementById("google_ads_iframe_"+MMsezioneTag+"_"+MMnIframeGoogleLoop).offsetWidth;

					iFrameGptMastHead.style.width = MMlarghezzaSitoAdv+'px';
					divGptMastHead.style.width = MMlarghezzaSitoAdv+'px';
					var divGptMastHeadHeightVal = document.getElementById("google_ads_iframe_"+MMsezioneTag+"_"+MMnIframeGoogleLoop).offsetHeight;
					var divGptMastHeadWidthVal = document.getElementById("google_ads_iframe_"+MMsezioneTag+"_"+MMnIframeGoogleLoop).offsetWidth - 20;
					var divGptMastHeadHeightValNew = Math.ceil(((MMlarghezzaSitoAdv*720)/240)/9);
					divGptMastHead.style.height = divGptMastHeadHeightValNew+'px';
					iFrameGptMastHead.style.height = divGptMastHeadHeightValNew+'px';
				}
			}		
		}//for (n=2;n<4;n++){
	}
}
///+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
// seedtag
function setCookieSeedTag(name, value, last) {
	//console.log('[mediamond]===>set cookie');
	if (last) {
		var now = new Date();
		var expires = new Date();
		expires.setTime(now.getTime() + (parseInt(last) * 60 * 1000));
		document.cookie = name + '=' + escape(value) + '; expires=' +
			expires.toGMTString() + '; path=/';
	} else {
		document.cookie = name + '=' + escape(value) + '; expires= ; path=/';
	}
}

function getCookieSeedTag(name) {
	console.log('[mediamond]===>get cookie');
	var nameEQ = name + "=";
	var ca = document.cookie.split(';');
	for (var i = 0; i < ca.length; i++) {
		var c = ca[i];
		while (c.charAt(0) == ' ') c = c.substring(1, c.length);
		if (c.indexOf(nameEQ) == 0) return c.substring(nameEQ.length, c.length);
	}
	return null;
}


//Ã¨ lanciato dall'editore
function initSeedTag() {
	//rimosso per richiesta di Fabio Buonacasa - email mercoledÃ¬ 23/02/2022 15:24 - OBJ: Rimozione tag Seedtag il Giornale
	// if (statusSeedTag) {
	// console.log('[mediamond][seedtag]===>init seedtag');
	// 	var cookieSeedtag = getCookieSeedTag('mediamond');
	// 	if (cookieSeedtag == "" || cookieSeedtag == null) {
	// 		if (cookieSeedtag != 'seedtag_' + nomeSito) {

	// 			(function () {
    //                 var st = document.createElement('script');
    //                 st.type = 'text/javascript';
    //                 st.async = true;
    //                 st.src = ('https:' == document.location.protocol
    //                   ? 'https'
    //                   : 'http') + '://t.seedtag.com/t/9075-3377-01.js?v=' + Math.random();
    //                 var s = document.getElementsByTagName('script')[0];
    //                 s.parentNode.insertBefore(st, s);
    //               })();
	// 			//
	// 			setCookieSeedTag('mediamond', 'seedtag_' + nomeSito, 60);//espresso in minuti	
	// 		}//if(cookieSeedtag != 'seedtag_'+nomeSito){
	// 	}//if (userOvl != ""  && userOvl != null) {
	// }//statusSeedTag
}//function initSeedTag(){
//fine seedtag /////////////////////////////////////////////////////////////////////////////////////////////
//++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
//js utility ///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
// var lipHpsponsor = document.createElement("script");
// lipHpsponsor.async = false;
// lipHpsponsor.type = "text/javascript";
// var useSSL = "https:" == document.location.protocol;
// lipHpsponsor.src = (useSSL ? "https:" : "http:") + "//adv.mediamond.it/hp_sponsor/utility_mediamond.js";
// var node = document.getElementsByTagName("script")[0];
// node.parentNode.insertBefore(lipHpsponsor, node);


//mi serve per sapere quanto ci mette a caricare il file
console.log('[mediamond][adv]===>load js mediamond:',(performance.now()/1000));
</script>

</body>
</html>
