<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>0.5.5.0.html</title>
</head>
<body>

<script>
(window.mutinyWpJsonp=window.mutinyWpJsonp||[]).push([[0],Array(34).concat([function(e,t,i){"use strict";i.d(t,"b",(function(){return u})),i.d(t,"a",(function(){return h}));var n=i(39),r=i(90),s=i(33),o=i(87),a=i.n(o),l=i(10),c=i(47);n.default.setup(Object(r.a)());const d={};function u(e){return e.includes("!important")?e.replace(/!important/g,"")+" !important":e}function h(e){return function(t){return i=>Object(s.h)(c.b,null,n=>{const r=`${Object(l.a)(t)}-${Object(l.a)(n)}-${Object(l.a)(e)}`;d[r]||(d[r]=a()(t,"function"==typeof e?e(n):e));const o=d[r];return Object(s.h)(o,Object.assign({},i))})}}},function(e,t,i){"use strict";i.d(t,"a",(function(){return T.a}));var n=i(0),r=i(9),s=i(1),o=i(7);class a{constructor(){this.queue=[],this.logger=new s.a("function-queue")}enqueue(e){this.logger.info("Enqueuing function queue item"),this.queue.push(e)}flushAsync(){setTimeout(()=>this.flush(),0)}flush(){const e=[...this.queue];this.queue=[];for(const t of e)this.logger.info("Flushing function queue item"),Object(r.c)(t)}}class l{constructor(e,t=new a){this.isReady=e,this.queue=t,this.retryFlushInterval=250}enqueue(e){this.queue.enqueue(e),this.flush()}flush(){this.isReady()?this.queue.flush():(clearTimeout(this.timeoutHandle),this.timeoutHandle=setTimeout(()=>{this.flush()},this.retryFlushInterval))}flushAsync(){this.flush()}}const c="[Mutiny]";class d{constructor(e,t,i,n){this.visitorToken=e,this.userDataStore=i,this.config=n,this.logger=new s.a("amplitude-adapter"),this.queue=new l(()=>void 0!==this.getAmplitude())}page(){}identify(){this.queue.enqueue(()=>{const e=this.getAmplitude(),{Identify:t}=window.amplitude,i=(new t).set(c+" visitor_id",this.visitorToken);this.logger.info("Calling `identify`"),e.identify(this.config.exposed_user_data_attributes.reduce((e,t)=>e.set(`${c} ${t}`,this.userDataStore.get(t)),i))})}track(e,t){this.queue.enqueue(()=>{switch(e){case T.a.ExperienceImpression:return this.trackImpression(t);case T.a.QuestionnaireResponse:return this.trackQuestionnaireResponseSubmission(t);case T.a.Event:return this.trackEvent(t);default:return}})}trackEvent(e){switch(e.eventType){case n.m.QuestionnaireFormSubmitted:return this.trackQuestionnaireFormSubmission(e)}}trackImpression({experience:e,impressionType:t,audienceSegment:i}){if(i&&(t===n.v.Personalized||t===n.v.Control)){const r=`${e.name}_${i.name}`,s=this.getAmplitude(),{Identify:o}=window.amplitude;return this.logger.info("Calling `amplitude.identify`"),s.identify((new o).set(`${c} ${r}`,t).set(c+" last experience",r)),this.logger.info("Calling `amplitude.logEvent`"),s.logEvent(c+" Experience Viewed",{audienceSegment:null==i?void 0:i.name,experience:null==e?void 0:e.name,personalized:t===n.v.Personalized})}}trackQuestionnaireResponseSubmission({answers:e,questionnaire:t}){const i=this.getAmplitude(),n=e?e.reduce((e,{key:t,value:i})=>Object.assign(Object.assign({},e),{[t]:i}),{}):{};return this.logger.info("Calling `amplitude.logEvent`"),i.logEvent(c+" Questionnaire Completed",Object.assign(Object.assign({},n),{questionnaire:t.key}))}trackQuestionnaireFormSubmission({metadata:{email:e,questionnaire_key:t}}){const i=this.getAmplitude();return this.logger.info("Calling `amplitude.logEvent`"),i.logEvent(c+" Questionnaire Completed",{email:e,questionnaire:t})}getAmplitude(){if(window.amplitude&&"function"==typeof window.amplitude.getInstance){if("a8750e5a67bafbcd"===this.config.api_key){const e=window.location.pathname.startsWith("/blog");return window.amplitude.getInstance(e?"blog_2.0":"corp_site_2.0")}return window.amplitude.getInstance()}}}var u=i(3),h=function(e,t,i,n){return new(i||(i=Promise))((function(r,s){function o(e){try{l(n.next(e))}catch(e){s(e)}}function a(e){try{l(n.throw(e))}catch(e){s(e)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}l((n=n.apply(e,t||[])).next())}))};var p=class{constructor(e,t,i,n,r){this.apiClient=r,this.logger=new s.a("hubspot-adapter")}identify(){return h(this,void 0,void 0,(function*(){this.logger.info("Calling `identify`");const e=yield Object(u.h)("hubspotutk");if(e)return this.apiClient.trackVisitorIdentification({identificationType:n.B.Hubspot,value:e})}))}page(){}track(e,t){}},m=function(e,t,i,n){return new(i||(i=Promise))((function(r,s){function o(e){try{l(n.next(e))}catch(e){s(e)}}function a(e){try{l(n.throw(e))}catch(e){s(e)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}l((n=n.apply(e,t||[])).next())}))};var g=class{constructor(e,t,i,n,r){this.apiClient=r,this.logger=new s.a("marketo-adapter")}identify(){return m(this,void 0,void 0,(function*(){this.logger.info("Calling `identify`");const e=yield Object(u.h)("_mkto_trk");if(e)return this.apiClient.trackVisitorIdentification({identificationType:n.B.Marketo,value:e})}))}page(){}track(e,t){}},v=i(59);var f=class{constructor(e,t,i,n,r,s,o){this.sessionToken=t,this.store=i,this.config=n,this.apiClient=r,this.clientDataMetadata=o}identify(){}page(){return this.apiClient.trackImpression(this.sessionToken,{client_data_metadata:this.clientDataMetadata,client_iteration:this.config.client_iteration,client_published_at:this.config.published_at,user_data_failed:Boolean(this.store.get(v.a)),user_data_generated_at:this.store.get("generated_at"),user_data_ip_address:this.store.get("user.ip_address"),user_data_metadata:this.store.get("metadata"),user_data_visitor_token:this.store.get("user.token")})}track(e,t){switch(e){case T.a.QuestionnaireResponse:return this.apiClient.trackQuestionnaireResponse(t);case T.a.Conversion:return this.apiClient.trackConversion(t);case T.a.Event:return this.apiClient.trackEvent(t);case T.a.ExperienceImpression:{const e=t;return this.apiClient.trackExperienceImpression(Object.assign(Object.assign({},e),{selfOptimizingEventId:this.store.get(`web_experience_variation.${e.experience&&e.experience.id}.event_id`)}))}case T.a.Time:return this.apiClient.trackTime(t);case T.a.Metric:return this.apiClient.trackMetric(t)}}},b=i(44);class y{constructor(e,t,i,n,r){this.visitorToken=e,this.config=n,this.apiClient=r,this.logger=new s.a("segment-adapter"),this.queue=new l(()=>{var e;return Boolean(null===(e=this.getAnalyticsClient())||void 0===e?void 0:e.ready)})}identify(){this.queue.enqueue(()=>{this.getAnalyticsClient().ready(()=>{if(this.checkAnalyticsValid()){if(this.logger.info("Calling `segment.identify`"),this.getAnalyticsClient().user()instanceof Promise)this.getAnalyticsClient().user().then(e=>{const t=e.id(),i=e.anonymousId();this.apiClient.segmentIdentify(t,i)});else{const e=this.getAnalyticsClient().user().id(),t=this.getAnalyticsClient().user().anonymousId();this.apiClient.segmentIdentify(e,t)}this.getAnalyticsClient().identify({mutinyVisitorId:this.visitorToken})}})})}page(){}track(e,t){this.config.write_to_segment&&this.queue.enqueue(()=>{switch(e){case T.a.ExperienceImpression:return this.trackImpression(t);case T.a.QuestionnaireResponse:return this.trackQuestionnaireResponseSubmission(t);case T.a.Event:return this.trackEvent(t);default:return}})}getAnalyticsClient(){const e=this.config.analytics_key||"analytics";return window[e]}trackEvent(e){switch(e.eventType){case n.m.QuestionnaireFormSubmitted:return this.trackQuestionnaireFormSubmission(e)}}trackImpression({impressionType:e,audienceSegment:t,experience:i}){this.apiClient.trackMetric({metricKey:"client.segment_track_impression.requested",metricType:n.q.Increment}),(t&&e===n.v.Personalized||e===n.v.Control)&&(this.apiClient.trackMetric({metricKey:"client.segment_track_impression.initiated",metricType:n.q.Increment}),this.getAnalyticsClient().ready(()=>{var r;this.apiClient.trackMetric({metricKey:"client.segment_track_impression.ready",metricType:n.q.Increment}),this.checkAnalyticsValid()&&t&&(this.logger.info("Calling `segment.track`"),this.getAnalyticsClient().track("Mutiny Experience Viewed",{audienceSegment:t.name,experience:i&&(i.name||Object(b.b)(t.id,i.id)),personalized:e===n.v.Personalized,variation:e===n.v.Personalized?null!==(r=null==i?void 0:i.variation_name)&&void 0!==r?r:"":n.v.Control}),this.apiClient.trackMetric({metricKey:"client.segment_track_impression.finished",metricType:n.q.Increment}))}))}trackQuestionnaireResponseSubmission({answers:e,questionnaire:t}){const i=e?e.reduce((e,{key:t,value:i})=>Object.assign(Object.assign({},e),{[t]:i}),{}):{};this.getAnalyticsClient().ready(()=>{this.checkAnalyticsValid()&&(this.logger.info("Calling `segment.track`"),this.getAnalyticsClient().track("Mutiny Questionnaire Completed",Object.assign(Object.assign({},i),{questionnaire:t.key})))})}trackQuestionnaireFormSubmission({metadata:{email:e,questionnaire_key:t}}){this.getAnalyticsClient().ready(()=>{this.checkAnalyticsValid()&&(this.logger.info("Calling `segment.track`"),this.getAnalyticsClient().track("Mutiny Questionnaire Completed",{email:e,questionnaire:t}))})}checkAnalyticsValid(){return this.getAnalyticsClient().user?this.getAnalyticsClient().identify&&!!this.getAnalyticsClient().track||(this.apiClient.trackMetric({description:`No identify function (${this.config.company_slug}, ${this.visitorToken})`,metricKey:`Unexpected window.${this.config.analytics_key} object for Segment`,metricType:n.q.Event}),!1):(this.apiClient.trackMetric({description:`No user function (${this.config.company_slug}, ${this.visitorToken})`,metricKey:`Unexpected window.${this.config.analytics_key} object for Segment`,metricType:n.q.Event}),!1)}}var w=function(e,t){var i={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(i[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(n=Object.getOwnPropertySymbols(e);r<n.length;r++)t.indexOf(n[r])<0&&Object.prototype.propertyIsEnumerable.call(e,n[r])&&(i[n[r]]=e[n[r]])}return i};var k=class{constructor(e,t,i,n,r,s){this.visitorToken=e,this.userDataStore=i,this.clientMode=s}identify(){const e={visitorToken:this.visitorToken};window.mutinyData=e;const t=this.userDataStore.toJSON(),{user:i}=t,n=w(t,["user"]);window.mutiny.visitor={data:n,token:this.visitorToken},window.mutiny.experiences=[],window.mutiny.clientMode=this.clientMode}page(){window.mutiny.experiences=[]}track(e,t){switch(e){case T.a.ExperienceImpression:{const{impressionType:e,audienceSegment:i,experience:r}=t;if(i){const t={audienceSegment:null==i?void 0:i.name,experienceName:null==r?void 0:r.name,impressionType:e,personalized:e===n.v.Personalized,visitorToken:this.visitorToken};if(window.mutinyData=t,r){window.mutiny.experiences||(window.mutiny.experiences=[]);const t={audienceSegment:null==i?void 0:i.name,experience:null==r?void 0:r.name,impressionType:e,page:window.location.origin+window.location.pathname,variationKey:null==r?void 0:r.variation_key,variationName:null==r?void 0:r.variation_name};window.mutiny.experiences.push(t),window.dispatchEvent(new CustomEvent(n.j.WindowExperienceImpression,{detail:t}))}}return}default:return}}},_=i(4);var O=class{constructor(e,t,i,n,r){this.apiClient=r}identify(){if(Object(_.g)(window.location.search).mtl)return this.apiClient.trackVisitorIdentification({identificationType:n.B.OneShotUrl,value:window.location.href})}page(){}track(e,t){}};var C=class{constructor(){this.logger=new s.a("google-analytics-adapter"),this.queue=new l(()=>Boolean(window.ga&&window.ga.getAll&&window.ga.getAll().length>0))}identify(){}page(){}getEventLabelForPersonlization(e){return(null==e?void 0:e.variation_name)?`${n.v.Personalized} | ${e.variation_name}`:n.v.Personalized}getEventAction(e,t){return t?t.name?`${e.name} | ${t.name}`:`${e.name} | ${Object(b.b)(e.id,t.id)}`:e.name}track(e,t){this.queue.enqueue(()=>{window.ga(()=>{switch(e){case T.a.ExperienceImpression:{const e=t,i=e.audienceSegment,r=e.experience;if(i){this.logger.info("Calling `ga.send`");const t=e.impressionType===n.v.Personalized?this.getEventLabelForPersonlization(r):e.impressionType;for(const e of window.ga.getAll())e.send({eventAction:this.getEventAction(i,r),eventCategory:"mutinyExperienceQualify",eventLabel:t,hitType:"event",nonInteraction:!0})}break}}})})}},T=i(13);var S=class{constructor(e,t,i,n,r){this.apiClient=r,this.logger=new s.a("google-analytics-4-adapter"),this.queue=new l(()=>Boolean(window.gtag))}identify(){}page(){}track(e,t){this.queue.enqueue(()=>{switch(e){case T.a.ExperienceImpression:{const e=t,i=e.audienceSegment,r=e.experience;i&&r?(this.logger.info("Calling gtag with mutinyExperienceQualify event"),window.gtag("event","mutiny_experience_impression",{experience_id:r.id,experience_name:r.name,experience_type:Object(T.b)(r.experience_type),segment_name:i.name,personalized:e.impressionType===n.v.Personalized,variation_name:r.variation_name,variation_key:r.variation_key}),this.apiClient.trackMetric({metricKey:"client.ga4_adapter.track.success",metricType:n.q.Increment})):this.apiClient.trackMetric({metricKey:"client.ga4_adapter.track.failed",metricType:n.q.Increment});break}}})}};var E=class{constructor(e,t,i,n,r){this.apiClient=r,this.logger=new s.a("google-tag-manager-adapter"),this.queue=new l(()=>Boolean(window.dataLayer))}identify(){}page(){}track(e,t){this.queue.enqueue(()=>{switch(e){case T.a.ExperienceImpression:{const e=t,i=e.audienceSegment,r=e.experience;i&&r?(this.logger.info("Calling GTM with mutiny_experience_impression event"),window.dataLayer.push({event:"mutiny_experience_impression",experience_id:r.id,experience_name:r.name,experience_type:Object(T.b)(r.experience_type),segment_name:i.name,personalized:e.impressionType===n.v.Personalized,variation_name:r.variation_name,variation_key:r.variation_key}),this.apiClient.trackMetric({metricKey:"client.gtm_adapter.track.success",metricType:n.q.Increment})):this.apiClient.trackMetric({metricKey:"client.gtm_adapter.track.failed",metricType:n.q.Increment});break}}})}};const x=[n.o.Mutiny,n.o.Window,n.o.OneShotUrl];t.b=class{constructor(e,t,i,n,r,a,l,c,d){this.apiClient=e,this.trackingDisabled=a,this.preview=l,this.clientMode=c,this.clientDataMetadata=d,this.logger=new s.a("data-exporter");const u=Object(o.d)(r.integrations.concat(x));this.adapters=u.map(e=>{const s=this.getAdapter(e);return this.logger.debug(`Configuring ${e} adapter`),new s(t,i,n,r,this.apiClient,this.clientMode,this.clientDataMetadata)})}identify(){if(this.trackingDisabled)this.preview?this.apiClient.trackPreview():this.logger.info("Skipping `identify` for doNotTrack mode");else{this.logger.info("Calling `identify`");for(const e of this.adapters)e.identify()}}page(){if(this.trackingDisabled)this.logger.info("Skipping `page` for doNotTrack mode");else{this.logger.info("Calling `page`");for(const e of this.adapters)e.page()}}track(e,t){return this.trackingDisabled?(this.logger.info("Skipping `track` for doNotTrack mode"),Promise.resolve()):(this.logger.info("Calling `track`",e,t),Promise.all(this.adapters.map(i=>Promise.resolve(i.track(e,t)))))}forceFlushQueues(){return Object(r.c)(()=>{var e;this.logger.info("Flushing API client queue");const t=this.apiClient.flush(!0);this.logger.info("Flushing all adapters",this.adapters);for(const t of this.adapters)null===(e=t.queue)||void 0===e||e.flush();return t})}disableTracking(){this.trackingDisabled=!0,this.apiClient.disableTracking()}getAdapter(e){switch(e){case n.o.Mutiny:return f;case n.o.Segment:return y;case n.o.Window:return k;case n.o.Amplitude:return d;case n.o.GoogleAnalytics:return C;case n.o.GoogleAnalytics4:return S;case n.o.GoogleTagManager:return E;case n.o.Marketo:return g;case n.o.Hubspot:return p;case n.o.OneShotUrl:return O;default:throw new Error("Unknown integration type "+e)}}}},,,function(e,t,i){"use strict";i.d(t,"b",(function(){return p})),i.d(t,"c",(function(){return m})),i.d(t,"e",(function(){return g})),i.d(t,"d",(function(){return v})),i.d(t,"f",(function(){return f})),i.d(t,"g",(function(){return b})),i.d(t,"a",(function(){return y})),i.d(t,"h",(function(){return w})),i.d(t,"i",(function(){return _}));var n=i(20),r=i.n(n),s=i(52),o=i(7),a=i(10),l=i(45),c=i(0),d=i(11),u=i(12),h=i(60);i.d(t,"k",(function(){return d.b})),i.d(t,"j",(function(){return d.a}));const p="_mcm",m="mutiny_experience_override",g="mutiny_variation_override",v="mutiny_highlight",f="personalize.override",b="user.personalize_weight",y="mte",w="mtl";var k;!function(e){e.Impression="impression",e.QuestionnaireImpression="questionnaireImpression"}(k||(k={}));class _{constructor(e,t=new l.a){this.events=t;const i={device_type:Object(s.a)(),referrer:document.referrer,user_agent:navigator.userAgent};this.data=r()({browser:i},e),this.listeners=[]}getWriteableStore(){return new O(this.data,this.listeners,this.events)}get(e){const t=Object(a.c)(this.data,e);return null===t?Object(h.a)().getItem(e)||Object(u.a)().getItem(e):t}onChange(e){this.listeners.push(e)}merge(e){return this.data=r()(this.data,e),this}toJSON(){return JSON.parse(JSON.stringify(this.data))}}class O extends _{constructor(e,t=[],i=new l.a){super(e,i),this.events=i,this.listeners=t,this.events.on(c.j.ImpressionCacheUpdate,({detail:e})=>{e.impression&&this.updateImpressionCache(e.impression,k.Impression),e.questionnaireImpression&&this.updateImpressionCache(e.questionnaireImpression,k.QuestionnaireImpression),e.sessionNumber&&this.setBulk({person:{behavior:{session_number:e.sessionNumber}}})})}setBulk(e){const t=r()(Object(a.c)(this.data,"person.behavior")||{},Object(a.c)(e,"person.behavior")||{},{arrayMerge:this.behavioralArrayMerge});this.data=r()(r()(this.data,e),{person:{behavior:t}},{arrayMerge:(e,t)=>t})}getData(){return this.data}set(e,t,{localStorage:i=!0}={}){const n=e.split("."),r=Object.assign({},this.data);return n.reduce((e,i,r)=>(r===n.length-1?e[i]=t:void 0===e[i]&&(e[i]={}),e[i]),r),this.data=r,i&&Object(u.a)().setItem(e,t),this.triggerListeners(e,t),this}getSessionToken(){const e=this.get("query."+d.a);return(null==e?void 0:e.length)?e:d.c.instance.getSessionToken()}isNewUser(){return d.c.instance.getIsNewVisitor()}getUserToken(){const e=this.get("query."+d.b);return(null==e?void 0:e.length)?e:d.c.instance.getVisitorToken()}getClientMode(){var e;switch(null===(e=this.get("query."+p))||void 0===e?void 0:e.toLowerCase()){case c.d.AssetViewer:return c.d.AssetViewer;default:return c.d.Default}}behavioralArrayMerge(e,t){const i=[],n=[];for(const e of t)e.token&&e.token.length>0?i.push(e):n.push(e);for(const t of e)t.token&&t.token.length>0?i.push(t):n.push(t);return[...n,...Object(o.e)(i,e=>e.token)]}triggerListeners(e,t){for(const i of this.listeners)i(e,t)}updateImpressionCache(e,t){const[i,n]=this.impressionCacheAttributeKey(t),r=this.get(i)||[],s=[e,...Array.isArray(r)?r:[]].reduce((e,t)=>(e[t.token]?e[t.token]=Object.assign(Object.assign({},e[t.token]),t):e[t.token]=t,e),{}),o=Object(a.e)(s);this.setBulk({person:{behavior:{[n]:o}}})}impressionCacheAttributeKey(e){switch(e){case k.Impression:return["person.behavior.visited_url","visited_url"];case k.QuestionnaireImpression:return["person.behavior.viewed_questionnaires","viewed_questionnaires"]}}}},,,,function(e,t,i){"use strict";var n=i(48);t.a=new class{constructor(){this.elementRegistry=new WeakMap,this.elementAdditionRegistry=new Map,this.registeredPersonalizations=new Set}getPersonalizationForElement(e){return this.elementRegistry.get(e)}getAdditionForElement(e){return this.elementAdditionRegistry.get(e)}getContainingPersonalizationForElement(e){var t;let i=e,n=0;for(;i!==document.body;){if(n++,n>1e3)return null;const e=null!==(t=i instanceof HTMLElement&&this.elementRegistry.get(i))&&void 0!==t?t:void 0;if(e)return e;if(!i.parentElement)return null;i=i.parentElement}return null}getPersonaizationForNode(e){return this.getPersonalizationForNode(e)}getPersonalizationForNode(e){let t=e,i=0;for(;t!==document.body;){if(i++,i>1e3)return null;if(t instanceof Element&&Object(n.d)(t)&&this.registeredPersonalizations.has(t))return t;if(!t.parentElement)return null;t=t.parentElement}return null}getOriginalElement(e){var t;const i=this.getPersonalizationForNode(e);if(i)return null===(t=i.element)||void 0===t?void 0:t.cloneToOriginal.get(e)}getClonedElement(e){var t;const i=this.getContainingPersonalizationForElement(e);if(i)return null===(t=i.element)||void 0===t?void 0:t.originalToClone.get(e)}getPersonalizations(){return Array.from(this.registeredPersonalizations.values())}registerPersonalization(e,t){e&&this.elementRegistry.set(e,t),this.registeredPersonalizations.add(t)}registerAdditionPersonalization(e){const{record:t}=e;t&&this.elementAdditionRegistry.set(t.resource_id,e),this.registeredPersonalizations.add(e)}unregisterPersonalization(e){var t,i;if("addition"!==(null===(t=e.record)||void 0===t?void 0:t.personalization_type)){const t=e;t.originalElement&&this.elementRegistry.get(t.originalElement)===e&&this.elementRegistry.delete(t.originalElement)}"addition"===(null===(i=e.record)||void 0===i?void 0:i.personalization_type)&&this.elementAdditionRegistry.delete(e.record.resource_id),this.registeredPersonalizations.delete(e)}}},,function(e,t,i){"use strict";i.d(t,"d",(function(){return l})),i.d(t,"c",(function(){return d})),i.d(t,"a",(function(){return u})),i.d(t,"b",(function(){return h}));var n=i(55),r=i(19),s=i(0),o=i(64),a=i(9);function l(e){return e.audience_segments.some(e=>e.web_experiences.some(e=>Boolean(e.async)))}function c(e){return e.condition_tree?function e(t){if(!t)return!1;if(Object(o.d)(t)){return t.attribute===n.a&&Object(o.a)(s.d.AssetViewer,t.value,t.comparator)}return Object(o.c)(t)?Boolean(t.clauses.some(t=>e(t))):(a.b.notify("Cannot calculate isAssetViewerConditionTree for a condition",{metaData:{condition:JSON.stringify(t)}}),!1)}(e.condition_tree.root_node):function e(t){var i,o;return!!t&&(!(t.attribute!==n.a||!Object(r.a)(s.d.AssetViewer,t.value,t.comparator))||Boolean((null===(i=t.or)||void 0===i?void 0:i.some(t=>e(t)))||(null===(o=t.and)||void 0===o?void 0:o.some(t=>e(t)))))}(e.condition)}function d(e){return e.audience_segments.some(e=>c(e)&&e.web_experiences.length>0)}function u(e,t){return t===s.d.AssetViewer?c(e.audienceSegment):!c(e.audienceSegment)}function h(e,t){return`https://app.mutinyhq.com/segments/${e}/experiences/${t}/edit`}},function(e,t,i){"use strict";i.d(t,"a",(function(){return r}));var n=i(1);class r{constructor(){this.logger=new n.a("event-bus")}on(e,t){document.addEventListener(e,t)}off(e,t){document.removeEventListener(e,t)}trigger(e,t={}){this.logger.info(`Dispatching '${e}' event`),document.dispatchEvent(new CustomEvent(e,{detail:t}))}}},function(e,t,i){"use strict";i.d(t,"b",(function(){return n})),i.d(t,"a",(function(){return r})),i.d(t,"c",(function(){return s}));const n=(e,t=50,i)=>{let n=null,r=null;const s=void 0===(null==i?void 0:i.trailing)||(null==i?void 0:i.trailing);return(...i)=>{const o=Date.now();n||(r=o,e(...i));const a=t-(o-(r||0));a<=0||a>t?(n&&(window.clearTimeout(n),n=null),r=o,e(...i)):s&&(n=window.setTimeout(()=>e(...i),a))}},r=(e,...t)=>(...i)=>{const n=[...t,...i];return e(...n)},s=(e,t,i=1e3)=>{for(let n=0;n<i;n++){if(!e())return null;t()}}},function(e,t,i){"use strict";i.d(t,"a",(function(){return s})),i.d(t,"b",(function(){return o}));var n=i(33),r=function(e,t){var i={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(i[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(n=Object.getOwnPropertySymbols(e);r<n.length;r++)t.indexOf(n[r])<0&&Object.prototype.propertyIsEnumerable.call(e,n[r])&&(i[n[r]]=e[n[r]])}return i};const s={animations:{bannerTransition:e=>e+" 0.8s cubic-bezier(0.300, 0.000, 0.175, 1.000)",modalVisibilityTransition:"visibility 200ms ease-out"},breakpoints:{desktop:"@media only screen and (min-width: 720px)",iPadPro:"@media only screen and (max-width: 1024px)",mobile:"@media only screen and (max-width: 720px)"},colors:{black:"#000",grayDark:"#B2B2B2",grayDarker:"#6E6E6E",grayLight:"#EDEDED",grayLighter:"#F2F2F2",grayMedium:"#BEBEBE",grayMediumLight:"#D8D8D8",iconColor:"#CFF6FF",primary:"#FF7409",secondary:"#FFFFFF",white:"#FFF"},fonts:{colfax:"Colfax, Helvetica, sans-serif",futura:"Futura PT, Helvetica, sans-serif",systemDefault:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol"'},sizes:{desktopBannerHeight:"70px"}},{Consumer:o,Provider:a}=Object(n.createContext)(s);t.c=e=>{var t=e.colors,{icon_color:i}=t,o=r(t,["icon_color"]),{inheritFonts:l}=e;return function(e){const t=e,r=Object.assign(Object.assign({},s),{colors:Object.assign({},s.colors)});for(const[e,t]of Object.entries(o))t&&(r.colors[e]=t+" !important");if(i&&(r.colors.iconColor=i+" !important"),l){const e=Object.keys(r.fonts);for(const t of e)r.fonts[t]="inherit"}return e=>Object(n.h)(a,{value:r},Object(n.h)(t,Object.assign({},e)))}}},function(e,t,i){"use strict";i.d(t,"d",(function(){return q})),i.d(t,"e",(function(){return L})),i.d(t,"a",(function(){return R})),i.d(t,"b",(function(){return B})),i.d(t,"c",(function(){return U}));var n=i(9),r=i(5),s=i(14),o=i(1);var a=new class{constructor(){this.hasRunMapping={},this.customJavascriptStore={},this.logger=new o.a("custom-js-service")}getCustomJavascriptWrapperName(e){var t;return`mutinyJS${e.resource_id.replace(/-/g,"")}${e.custom_javascript?null===(t=e.custom_javascript)||void 0===t?void 0:t.id.replace(/-/g,""):""}`}attachCustomJavascript(e,t,i){var n;const o=Object(r.a)("script");o.nonce=Object(s.a)(),o.setAttribute("type","text/javascript"),o.setAttribute("id",e+"_script");const a=`function ${e}(element, hasRunBefore) { ${i} }`;o.innerHTML=a,document.head.append(o),null===(n=this.logger)||void 0===n||n.info("Attaching custom javascript to element:",t,o),this.customJavascriptStore[e]=window[e]}runCustomJavascript(e,t,i,n){var r,s,o,a;if(t.custom_javascript){const l=this.getCustomJavascriptWrapperName(t);let c=this.customJavascriptStore[l];const d=Boolean(c);c||(this.hasRunMapping[t.custom_javascript.id]=!1,this.attachCustomJavascript(l,e,t.custom_javascript.custom_javascript_string),c=this.customJavascriptStore[l]);try{null===(r=this.logger)||void 0===r||r.info("Running custom javascript with element:",e,c),c(e,this.hasRunMapping[t.custom_javascript.id]),this.hasRunMapping[t.custom_javascript.id]=!0,null==n||n(t.custom_javascript.id,d)}catch(r){this.hasRunMapping[t.custom_javascript.id]=!0,this.logger.warn("Error in custom javascript with element",e,c);const l=r,u=null!==(a=null===(o=null===(s=null==l?void 0:l.message)||void 0===s?void 0:s.toString)||void 0===o?void 0:o.call(s))&&void 0!==a?a:"Error thrown in element-level js";null==n||n(t.custom_javascript.id,d,u),i(t.custom_javascript.custom_javascript_string,u,l)}}}},l=i(0);const c=/^mutiny-((preview|editor)-app|browser-editor-component|preact.*)$/,d=(e,t)=>{const i=(r=t,q(n=e)?null===(s=n.interactiveClone)||void 0===s?void 0:s.getOriginalOfClonedElement(r):void 0);var n,r,s;const o=i||t;return o.parentElement?R(o.parentElement).indexOf(o):-1};var u=i(18);const h=new Set(["animate","animateMotion","animateTransform","circle","clippath","color-profile","defs","desc","discard","ellipse","feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence","filter","foreignObject","g","hatch","hatchpath","image","line","linearGradient","marker","mask","mesh","meshgradient","meshpatch","meshrow","metadata","mpath","path","pattern","polygon","polyline","radialGradient","rect","set","solidcolor","stop","svg","switch","symbol","text","textPath","title","tspan","unknown","use","view"]),p={html:"http://www.w3.org/1999/xhtml",svg:"http://www.w3.org/2000/svg",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};class m{constructor(e){this.userData=e,this.renderedNodes=new WeakSet,this.logger=new o.a("node-renderer")}renderNode(e){let t;if("fragment"===e.tag)t=document.createDocumentFragment();else if(h.has(e.tag)){t=document.createElementNS("http://www.w3.org/2000/svg",e.tag);for(const i of Object.keys(e.html_attributes))if("xmlns"!==i){const n=i.split(":")[0];if(n)t.setAttributeNS(p[n],i,Object(u.c)(e.html_attributes[i],this.userData));else{const n=this.buildAttrNode(i,Object(u.c)(e.html_attributes[i],this.userData));n&&t.setAttributeNode(n)}}}else{t=Object(r.a)(e.tag),t.dataset.mutiny="true";for(const i of Object.keys(e.html_attributes))try{const n=this.buildAttrNode(i,Object(u.c)(e.html_attributes[i],this.userData));if(!n)throw new Error(`Could not build attribute node for attribute "${i}"`);t.setAttributeNode(n)}catch(e){this.logger.error("Failed to set HTML attribute",e)}}for(const i of e.inner_html)if("string"==typeof i){const e=document.createTextNode(Object(u.c)(i,this.userData));this.renderedNodes.add(e),t.append(e)}else{const e=this.renderNode(i);t.append(e)}return this.renderedNodes.add(t),t}buildAttrNode(e,t){var i,n;const r=null===(i=(new DOMParser).parseFromString(`<div id="tmp" ${e} />`,"text/html").querySelector("#tmp"))||void 0===i?void 0:i.getAttributeNode(e);return t&&r&&(r.value=t),null!==(n=null==r?void 0:r.cloneNode(!0))&&void 0!==n?n:null}}var g=i(65);var v=(e,t,i)=>{const n=new m(i),r="string"==typeof t.content?Object(g.a)(Object(u.c)(t.content,i)):n.renderNode(t.content);return e.innerHTML="",e.append(r),n.renderedNodes},f=i(72),b=i(66),y=i(24);function w(e){const t=new y.a,i=t.insertRule(`tmp { ${e} }`),n=t.cssRules[null!=i?i:0];return function(e){return e.type===CSSRule.STYLE_RULE}(n)?n:void 0}function k(e,t){var i,n,r;const s=w(null!==(i=t.getAttribute("style"))&&void 0!==i?i:""),o=w(e),a=new Set(Array.from(null!==(n=null==o?void 0:o.style)&&void 0!==n?n:[])),l=Array.from(null!==(r=null==s?void 0:s.style)&&void 0!==r?r:[]).filter(e=>!a.has(e));for(const e of l)t.style.removeProperty(e);if(o)for(const e of Array.from(o.style))t.style.setProperty(e,o.style.getPropertyValue(e),o.style.getPropertyPriority(e))}var _=i(42);function O(e){return[HTMLInputElement,HTMLSelectElement,HTMLOptionElement].some(t=>e instanceof t)}function C(e){return e instanceof HTMLAnchorElement}class T{constructor(e,t,i){var n;this.styleSheet=new y.a,this.cloneToOriginal=new WeakMap,this.originalToClone=new WeakMap,this.mutationListeners=[],this.cloneToOriginalNodes=new WeakMap,this.originalToCloneNodes=new WeakMap,this.options=Object.assign({cloneMutations:!0},i),this.originalElement=e,this.personalization=t,this.logger=new o.a("InteractiveClone:"+(null===(n=t.record)||void 0===n?void 0:n.resource_id))}initialize(){this.clone(this.originalElement),this.updateElementMapping(),this.mutationObserver=new MutationObserver(e=>{for(const t of e)switch(t.type){case"attributes":this.handleAttributeMutation(t);break;case"characterData":this.handleCharacterDataMutation(t);break;case"childList":this.handleChildListMutation(t)}for(const t of this.mutationListeners)t(this.personalization,this.originalElement,e);return!0}),this.mutationObserver.observe(this.originalElement,{attributes:!0,characterData:!0,childList:!0,subtree:!0})}teardown(){var e;null===(e=this.mutationObserver)||void 0===e||e.disconnect()}addMutationListener(e){this.mutationListeners.push(e)}removeNestedPersonalization(e){const t=this.cloneToOriginal.get(e);if(!t)return;this.cloneToOriginal.delete(e);const i=this.clone(t);i&&this.updateElementMapping(t,i,e)}handleChildListMutation(e){var t;if(!this.options.cloneMutations)return;for(const i of Array.from(e.removedNodes)){if(i instanceof HTMLElement?!this.originalToClone.has(i):!this.originalToCloneNodes.has(i))continue;const e=i instanceof HTMLElement?this.originalToClone.get(i):this.originalToCloneNodes.get(i);null===(t=null==e?void 0:e.parentNode)||void 0===t||t.removeChild(e)}const i=this.originalToClone.get(e.target),n=null===e.nextSibling?null:e.nextSibling instanceof HTMLElement?this.originalToClone.get(e.nextSibling):this.originalToCloneNodes.get(e.nextSibling);for(const t of Array.from(e.addedNodes)){if(_.a.getContainingPersonalizationForElement(t)!==this.personalization)continue;const e=t instanceof HTMLElement&&q(t),r=e?t:t.cloneNode(!0);if(e){if(e&&!L(t)){const e=t.originalElement;if(!e)continue;const n=this.originalToClone.get(e);if(!n)continue;this.logger.debug("Detected a personalization being added to the original tree. Replacing:",n,"with personalization:",t),null==i||i.replaceChild(t,n),this.updateElementMapping(e,t)}}else null==i||i.insertBefore(r,null!=n?n:null),this.updateElementMapping(t,r)}}handleAttributeMutation(e){if(!(e.target instanceof HTMLElement&&e.attributeName))return;if(e.target===this.originalElement)return this.cloneAttribute(e.attributeName,this.originalElement,this.personalization),void this.personalization.attributeChangeCallback(e.attributeName,e.oldValue,this.personalization.getAttribute(e.attributeName));if(!this.options.cloneMutations)return;const t=this.originalToClone.get(e.target);if(t){if(q(t))return;this.cloneAttribute(e.attributeName,e.target,t)}}handleCharacterDataMutation(e){var t;if(!this.options.cloneMutations)return;const i=this.originalToCloneNodes.get(e.target);if(!i)return;const n=e.target.cloneNode(!0);null===(t=i.parentNode)||void 0===t||t.replaceChild(n,i),this.updateElementMapping(e.target,n)}clone(e){var t;if(e===this.originalElement){for(const e of this.originalElement.getAttributeNames())this.cloneAttribute(e,this.originalElement,this.personalization),this.personalization.attributeChangeCallback(e,null,this.originalElement.getAttribute(e));const e=[];for(const t of Array.from(this.originalElement.childNodes))e.push(t.cloneNode(!0));return this.personalization.innerHTML="",void this.personalization.append(...e)}const i=this.originalToClone.get(e);if(!i)return;const n=e.cloneNode(!0);return null===(t=i.parentElement)||void 0===t||t.replaceChild(n,i),n}updateElementMapping(e,t,i){var n;e||t||(this.cloneToOriginal=new WeakMap,this.originalToClone=new WeakMap,this.cloneToOriginalNodes=new WeakMap,this.originalToCloneNodes=new WeakMap);const r=new Set,s=[],o=new Set;let a=!0;this.traverseTreeWith((e,t)=>{var n;L(e)&&o.add(e);const l=_.a.getPersonalizationForElement(e);return l&&l!==this.personalization&&l!==i?(t!==l&&(s.push({replace:t,withElement:l}),L(l)&&o.add(l)),L(l)||(this.cloneToOriginal.set(l,e),this.originalToClone.set(e,l)),"break"):q(t)&&t!==this.personalization&&!(null===(n=t.isRendered)||void 0===n?void 0:n.call(t))?(r.add(t),"break"):(t.dataset.mutiny="true",this.elementMatches(e,t)||(a=!1),a&&(this.cloneToOriginal.set(t,e),this.originalToClone.set(e,t)),"continue")},e,t);for(const e of r)e.remove();for(const{replace:e,withElement:t}of s)null===(n=e.parentElement)||void 0===n||n.replaceChild(t,e);for(const e of o)e.placePersonalization();a||e||t||(this.cloneToOriginal=new WeakMap,this.originalToClone=new WeakMap,this.cloneToOriginalNodes=new WeakMap,this.originalToCloneNodes=new WeakMap)}traverseTreeWith(e,t,i){const n=(t,i)=>{var r,s,o,a;if(t instanceof HTMLElement||i instanceof HTMLElement||(this.originalToCloneNodes.set(t,i),this.cloneToOriginalNodes.set(i,t)),!(t instanceof HTMLElement&&i instanceof HTMLElement&&"break"===e(t,i)))for(let e=0;e<i.childNodes.length;e++){const l=null===(s=null===(r=null==t?void 0:t.childNodes)||void 0===r?void 0:r.item)||void 0===s?void 0:s.call(r,e),c=null===(a=null===(o=null==i?void 0:i.childNodes)||void 0===o?void 0:o.item)||void 0===a?void 0:a.call(o,e);l&&c&&n(l,c)}};n(null!=t?t:this.originalElement,null!=i?i:this.personalization)}elementMatches(e,t){return["tagName","id"].every(i=>e[i]===t[i])&&e.children.length===t.children.length}getOriginalOfClonedElement(e){return this.cloneToOriginal.get(e)}cloneAttribute(e,t,i){var n;if("style"===e)return void k(null!==(n=t.getAttribute("style"))&&void 0!==n?n:"",i);const r=t.getAttributeNode(e);r?i.setAttributeNode(r.cloneNode(!0)):i.removeAttribute(e)}}for(const e of Object(b.b)()){const t=["scroll","wheel","mousewheel","touch","drag"].some(t=>e.startsWith(t));window.addEventListener(e,e=>{var i,n;if(!(e.target instanceof HTMLElement))return;const r=_.a.getPersonalizationForNode(e.target);if(!r)return;const s=null===(i=r.element)||void 0===i?void 0:i.cloneToOriginal.get(e.target);if(s){if(!t){let t=e.target,i=0;for(;null!==t&&t!==r&&i++<100&&!C(t);)t=t.parentElement;if(t instanceof HTMLElement&&C(t)){const i=q(t)?t.originalElement:null===(n=r.element)||void 0===n?void 0:n.cloneToOriginal.get(t);if(C(i)){if(t.href!==i.href)return;e.preventDefault()}}}O(s)&&O(e.target)&&e.target.value!==s.value&&(s.value=e.target.value),null==s||s.dispatchEvent(new e.constructor(e.type,e))}},!t||Object.assign(Object.assign({},b.c),{capture:!0}))}var S=i(58),E=i(49),x=i(35);const I="style";var j=(e,t,i,n)=>{var r;const s=new o.a("AttributeApplier:"+t.id);for(const o of Object.keys(t.html_attributes))if("class"!==o||t.replace_classes)(a=o).startsWith("data-mutiny")||[I].includes(a)?(s.warn("Received HTML style attributes in AttributeApplier"),null===(r=null==n?void 0:n.exporter)||void 0===r||r.track(x.a.Metric,{description:`DOM Update ID: ${t.id}; Attribute: ${o}`,metricKey:"Client DOM Update contains blacklisted attribute",metricType:l.q.Event})):e.setAttribute(o,Object(u.c)(t.html_attributes[o],i));else{const n=Object(u.c)(t.html_attributes[o],i).split(/\s+/g).filter(e=>e.length>0);for(const t of n)e.classList.add(t)}var a};var M=(e,t,i)=>{k(Object(u.c)(t.cssText,i),e)},z=function(e,t){var i={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(i[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(n=Object.getOwnPropertySymbols(e);r<n.length;r++)t.indexOf(n[r])<0&&Object.prototype.propertyIsEnumerable.call(e,n[r])&&(i[n[r]]=e[n[r]])}return i};const P=e=>`mutiny-${e.toLowerCase()}-personalization`,N=new Map,A=new Set,q=e=>{var t,i,n,r;return!!e&&(null!==(n=null!==(t=e.isMutinyElement)&&void 0!==t?t:(r=null!==(i=e.getAttribute("is"))&&void 0!==i?i:"",/^mutiny-[\da-z-]+/.test(r)))&&void 0!==n&&n)},L=e=>{var t;return q(e)&&!!(null===(t=e.record)||void 0===t?void 0:t.data.position)},R=e=>Array.from(e.children).filter(t=>t!==e&&!q(t)&&!(e=>c.test(e.id)||e instanceof HTMLElement&&"radixFocusGuard"in e.dataset)(t)),D=e=>class extends e{constructor(){super(),this.initialized=!1,this.rendered=!1,this.tearingDown=!1,this.logger=new o.a("mutiny-personalization"),this.reattachedCounter=0,this.mutationObserver=new S.b(e=>{var t,i,n,r,s,o,a,c,d;if(!this.isRendered())return!1;if((null===(i=null===(t=this.record)||void 0===t?void 0:t.data)||void 0===i?void 0:i.content)&&(null===(r=null===(n=this.record)||void 0===n?void 0:n.data)||void 0===r?void 0:r.render_only_once))return!1;this.logger.info("Mutations observed",e);const u=e.filter(e=>!Object(E.a)(e));if(this.logger.info("Non mutiny mutations observed",u),0===u.length)return!0;null===(s=this.exporter)||void 0===s||s.apiClient.trackMetric({metricKey:"client.mutation.observed.personalization",metricType:l.q.Increment});const{record:h,userData:p}=this.getContext(),m=!!h.data.content;let g=!1;const f=[];for(const e of u)if("childList"===e.type)for(const t of Array.from(e.addedNodes))"modification"===h.personalization_type&&_.a.getPersonalizationForNode(t)!==this||(m?(null===(o=this.contentChangeNodes)||void 0===o?void 0:o.has(t))||(g=!0):"modification"!==h.personalization_type||(t instanceof HTMLElement?null===(a=this.element)||void 0===a?void 0:a.cloneToOriginal.has(t):null===(c=this.element)||void 0===c?void 0:c.cloneToOriginalNodes.has(t))||(f.push(t),null===(d=t.parentNode)||void 0===d||d.removeChild(t)));return g&&h.data.content&&(this.contentChangeNodes=v(this,{id:h.resource_id,content:h.data.content},p),this.executeCustomJs(),this.logger.info("Clearing mutations from content update:",this.mutationObserver.takeRecords())),this.logger.info("Removed non mutiny nodes",f),!0},{callbackLimit:10,disconnectCallback:()=>{this.teardown()}}),this.mutationObserver.observe(this,{childList:!0,subtree:!0});try{this.root=this.attachShadow({mode:"closed"});const e=Object(r.a)("slot");e.style.setProperty("box-sizing","inherit"),this.root.append(e)}catch(e){this.logger.log("Element type cannot be used as shadow root. Falling back to rendering personalization within the main tree.")}}get isMutinyElement(){return!0}get nodeName(){return window.__MUTINY_DISABLE_PERSONALIZATION_MASKING?super.nodeName:"MUTINY-"+super.nodeName}get nodeType(){return window.__MUTINY_DISABLE_PERSONALIZATION_MASKING?super.nodeType:Node.COMMENT_NODE}initializePersonalization(e,t,i,n,r,s,a){this.initialized?this.logger.error("Attempted to initialize the same personalization more than once."):(this.logger=new o.a("mutiny-personalization:"+t.resource_id),this.originalElement=e,this.record=t,this.userData=i,this.blockConfig=r,this.exporter=s,this.mutinyParentElement=n,this.onCustomJsExecuted=a,this.render(),this.initialized=!0)}isRendered(){return this.rendered&&this.isConnected}render(){var e,t;const{record:i,userData:n}=this.getContext(),{remove:s,content:o,block_variant_id:a}=i.data;if(!this.rendered){if(this.rendered=!0,"addition"===i.personalization_type&&_.a.registerAdditionPersonalization(this),void 0!==a){if(!this.root||!this.blockConfig)return;const e=Object(r.a)("mutiny-block");return e.initializeBlock(this.blockConfig,l.b.Section,i,n),this.append(e),void this.applyAttributePersonalization()}if(!this.element&&"addition"!==i.personalization_type){if(!this.originalElement)throw new Error("could not retrieve original element");if(_.a.registerPersonalization(this.originalElement,this),s)return void(this.elementHider=new f.c(this.originalElement,i.selector));this.element=new T(this.originalElement,this,{cloneMutations:!o}),this.element.initialize(),"addition"!==(null===(e=this.record)||void 0===e?void 0:e.personalization_type)&&(this.elementHider=new f.c(this.originalElement,i.selector))}o&&(this.contentChangeNodes=v(this,{id:i.resource_id,content:o},n),null===(t=this.element)||void 0===t||t.updateElementMapping()),this.applyAttributePersonalization(),this.executeCustomJs(),this.logger.info("Clearing mutations resulting from render:",this.mutationObserver.takeRecords())}}placePersonalization(){var e,t,i,n;const{record:{data:{position:r},personalization_type:s},originalElement:o}=this.getContext();(null===(e=this.getParentPersonalization())||void 0===e?void 0:e.contains(this))&&(null===(i=null===(t=this.getParentPersonalization())||void 0===t?void 0:t.element)||void 0===i||i.removeNestedPersonalization(this));const a=this.getTargetPositionParent();if(r&&a){const e=((e,t,i,n)=>{var r,s;const o=Array.from(i.children);for(const a of o)if(("modification"!==n||a!==e.originalElement)&&a!==e)if(q(a)&&(null===(r=a.record)||void 0===r?void 0:r.data.position)){const e=a.record.data.position;if(e.index>=t.index&&e.deconflictor>=t.deconflictor)return a}else if(q(a)&&(null===(s=a.originalElement)||void 0===s?void 0:s.parentElement)){if(R(a.originalElement.parentElement).indexOf(a.originalElement)>=t.index)return a}else if(d(i,a)>=t.index)return a;return null})(this,r,a,s);if((null==e?void 0:e.previousElementSibling)===this)return;this.logger.debug("Placing personalization:",this,"within:",a,"before:",e),a.insertBefore(this,e)}else this.logger.debug("Placing personalization:",this,"after original element:",o),null===(n=null==o?void 0:o.parentElement)||void 0===n||n.insertBefore(this,o.nextSibling)}teardown(){var e,t,i,n,r;if(!this.rendered)return;this.tearingDown=!0,null===(e=this.element)||void 0===e||e.teardown(),this.rendered=!1,_.a.unregisterPersonalization(this),null===(t=this.elementHider)||void 0===t||t.show();const s=this.getContext().record.data.position&&this.getTargetPositionParent();(null===(i=this.getParentPersonalization())||void 0===i?void 0:i.contains(this))&&!s&&(null===(r=null===(n=this.getParentPersonalization())||void 0===n?void 0:n.element)||void 0===r||r.removeNestedPersonalization(this)),this.remove()}attributeChangeCallback(e,t,i){var n,r,s,o;const{record:a}=this.getContext(),{html_attributes:l,styles:c}=a.data;if("style"===e)for(const e of Object.keys(null!==(r=null===(n=this.elementHider)||void 0===n?void 0:n.originalStyles)&&void 0!==r?r:{}))this.style.setProperty(e,null!==(o=null===(s=this.elementHider)||void 0===s?void 0:s.originalStyles[e])&&void 0!==o?o:"");(Object.keys(null!=l?l:{}).includes(e)||"style"===e&&c)&&this.applyAttributePersonalization()}disconnectedCallback(){requestAnimationFrame(()=>{var e,t;if(!this.isConnected&&!this.isNested())if(!this.initialized||this.tearingDown||"addition"!==(null===(e=this.record)||void 0===e?void 0:e.personalization_type)&&!(null===(t=this.element)||void 0===t?void 0:t.originalElement.isConnected))_.a.unregisterPersonalization(this),this.rendered=!1;else{if(this.reattachedCounter>=100)return this.logger.error("Attempted to reattach more times than the permitted limit.",this),_.a.unregisterPersonalization(this),void(this.rendered=!1);this.logger.warn("Personalization was disconnected premmaturely. Attempting to reattach.",this),this.placePersonalization(),this.reattachedCounter++}})}executeCustomJs(){const{record:e}=this.getContext();a.runCustomJavascript(this,e,(e,t,i)=>{var n,r,s;null===(n=this.exporter)||void 0===n||n.apiClient.trackMetric({description:t,metricKey:"element-level js error",metricType:l.q.Event,tags:{name:null!==(r=null==i?void 0:i.name)&&void 0!==r?r:"",message:t,stack:null!==(s=null==i?void 0:i.stack)&&void 0!==s?s:"",code:e}})},this.onCustomJsExecuted)}getTargetPositionParent(){const e=this.mutinyParentElement&&_.a.getClonedElement(this.mutinyParentElement);return null!=e?e:this.mutinyParentElement}getParentPersonalization(){return this.parentElement?_.a.getPersonalizationForNode(this.parentElement):null}isNested(){var e,t;return null!==(t=null===(e=this.getParentPersonalization())||void 0===e?void 0:e.isRendered())&&void 0!==t&&t}get interactiveClone(){return this.element}get replacedStyleAttribute(){var e,t,i,n;if("addition"===(null===(e=this.record)||void 0===e?void 0:e.personalization_type))return null!==(t=this.getAttribute("style"))&&void 0!==t?t:void 0;if(!this.originalElement)return;if(!this.elementHider)return null!==(i=this.originalElement.getAttribute("style"))&&void 0!==i?i:void 0;const r=this.originalElement.cloneNode(!1);for(const[e,t]of Object.entries(this.elementHider.originalStyles))t&&r.style.setProperty(e,t);return null!==(n=r.getAttribute("style"))&&void 0!==n?n:void 0}applyAttributePersonalization(){const{record:e,userData:t}=this.getContext(),{html_attributes:i,styles:n,replace_classes:r}=e.data,s=i||{},{style:o}=s,a=z(s,["style"]),l=[n?Object.entries(n).map(e=>e.join(": ")).join("; "):"",o].filter(Boolean).join("; ");a&&j(this,{id:e.resource_id,html_attributes:a,replace_classes:r},t,{exporter:this.exporter}),l&&M(this,{id:e.resource_id,cssText:l},t)}getContext(){if(!this.record||!this.userData||"addition"!==this.record.personalization_type&&!this.originalElement)throw this.logger.error("Attempted to call getContext on MutinyPersonalization prior to initializing"),new Error("initializePersonalization must be called prior to interacting with personalizations");return{record:this.record,userData:this.userData,originalElement:this.originalElement}}};D(HTMLElement);function B(e){if(function(e){const t=P(e),i=Object(r.a)(e);if(A.has(t))return!1;if(N.has(t))return!0;const s=Object.getPrototypeOf(i).constructor,o=D(s);try{Object(r.b)(t,o,{extends:i.tagName.toLowerCase()}),N.set(t,o)}catch(e){return function(e){return"object"==typeof e&&null!==e&&"code"in e&&"number"==typeof e.message}(e)&&e.code===DOMException.NOT_SUPPORTED_ERR&&n.b.notify(e),A.add(t),!1}return!0}(e))return P(e)}function U(e){return B(e.tagName)}},function(e,t,i){"use strict";function n(e){var t;return e.nodeType===e.COMMENT_NODE||e instanceof HTMLElement&&(!!(null===(t=e.dataset)||void 0===t?void 0:t.mutiny)||e.isMutinyElement)}function r({target:e,addedNodes:t,removedNodes:i,type:r}){const s=e,o=Array.from(t).concat(Array.from(i));return"childList"!==r?n(s):o.length>0&&o.every(e=>e&&n(e))}i.d(t,"b",(function(){return n})),i.d(t,"a",(function(){return r}))},function(e,t,i){"use strict";let n,r;function s(){var e;n=document.cloneNode(!0),r=new WeakMap,function e(t,i){if(null==r||r.set(t,i),i.childNodes.length>0)for(let n=0;n<i.childNodes.length;n++)e(t.childNodes[n],i.childNodes[n])}(n,document);for(const t of Array.from(n.querySelectorAll("mutiny-personalization"))){const i=t.querySelector("mutiny-variation[control]");if(i){const n=document.createDocumentFragment();for(const e of Array.from(i.childNodes))n.append(e);null===(e=t.parentNode)||void 0===e||e.replaceChild(n,t)}else t.remove()}for(const e of Array.from(n.querySelectorAll("[data-mutiny],[data-mutiny-root]")))e.remove()}function o(){n=null}function a(e,t="independent"){if("legacy"===t)return document.querySelectorAll(e);const i=(n||s(),n);return Array.from(i.querySelectorAll(e)).map(e=>null==r?void 0:r.get(e)).filter(e=>!!e)}function l(e,t="independent"){var i,n;return null!==(n=null===(i=a(e,t))||void 0===i?void 0:i[0])&&void 0!==n?n:null}i.d(t,"a",(function(){return o})),i.d(t,"c",(function(){return a})),i.d(t,"b",(function(){return l}))},,function(e,t,i){"use strict";i.d(t,"b",(function(){return s})),i.d(t,"a",(function(){return o}));const n=/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i,r=/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw-(n|u)|c55\/|capi|ccwa|cdm-|cell|chtm|cldc|cmd-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc-s|devi|dica|dmob|do(c|p)o|ds(12|-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(-|_)|g1 u|g560|gene|gf-5|g-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd-(m|p|t)|hei-|hi(pt|ta)|hp( i|ip)|hs-c|ht(c(-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i-(20|go|ma)|i230|iac( |-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|-[a-w])|libw|lynx|m1-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[23]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|-([1-8]|c))|phil|pire|pl(ay|uc)|pn-2|po(ck|rt|se)|prox|psio|pt-g|qa-a|qc(07|12|21|32|60|-[2-7]|i-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h-|oo|p-)|sdk\/|se(c(-|0|1)|47|mc|nd|ri)|sgh-|shar|sie(-|m)|sk-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h-|v-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl-|tdg-|tel(i|m)|tim-|t-mo|to(pl|sh)|ts(70|m-|m3|m5)|tx-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas-|your|zeto|zte-/i;function s(){const e=navigator.userAgent||navigator.vendor;return n.test(e)||r.test(e.slice(0,4))}function o(){return s()?"mobile":"desktop"}},,,function(e,t,i){"use strict";i.d(t,"b",(function(){return D})),i.d(t,"c",(function(){return B})),i.d(t,"a",(function(){return F})),i.d(t,"d",(function(){return $}));var n=i(23),r=(i(51),i(52)),s=i(1),o=i(0),a=i(4),l=function(e,t,i,n){return new(i||(i=Promise))((function(r,s){function o(e){try{l(n.next(e))}catch(e){s(e)}}function a(e){try{l(n.throw(e))}catch(e){s(e)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}l((n=n.apply(e,t||[])).next())}))};class c extends Error{static unknownError(){return new this(this.UNKNOWN)}static invalidResponse(e){return new this(`${this.INVALID_RESPONSE}: ${e}`)}}c.UNKNOWN="unknown",c.INVALID_RESPONSE="invalid response";var d=class{constructor(e,t,i){this.apiKey=e,this.visitorToken=t,this.timer=i,this.buffer=[],this.batchTrackingUrl=(window.MUTINY_API_URL||"https://api-v2.mutinyhq.io")+"/v2/b",this.logger=new s.a("batch-request-scheduler"),this.resetInterval(),this.timer.callOnPageInactive(()=>this.flush()),window.addEventListener("beforeunload",()=>this.teardown())}track(e,t,i=!1){this.logger.debug("Adding event of to batch request buffer",e,t);const n=new Promise(i=>{this.buffer.push({onComplete:i,payload:t,trackType:e})});return(this.buffer.length>=20||i)&&(this.logger.info("Batch request buffer has exceeded element limit. Flushing"),this.resetInterval(),this.flush()),n}flush(){return l(this,void 0,void 0,(function*(){if(0===this.buffer.length)return;const e=this.clearBuffer();this.logger.debug(`Flushing ${e.length} entries to batch endpoint`,e);const t=this.generateBody(e);try{yield null!==t?this.sendEvents(t):Promise.resolve()}catch(t){return this.buffer.unshift(...e),void this.trackRequestFailed()}for(const{onComplete:t}of e)try{t()}catch(e){}}))}teardown(){this.logger.info("Page unloaded detected. Beginning teardown process"),this.requestInterval&&clearInterval(this.requestInterval),this.flush()}generateBody(e){const t=this.formatEvents(e);return this.logger.info("Events",t),this.logger.info("Visitor Token",this.visitorToken),t.length>0?JSON.stringify({events:t,metadata:{client_version:"5.5.0"},token:this.apiKey,visitor_token:this.visitorToken}):null}formatEvents(e){return e.reduce((e,t)=>{const i=this.formatEvent(t);return null!==i&&e.push(i),e},[])}formatEvent({trackType:e,payload:t}){switch(e){case h.Impression:return{event_type:"impression",payload:t};case h.ExperienceImpression:return{event_type:"experience_impression",payload:t};case h.QuestionnaireImpression:return{event_type:"questionnaire_impression",payload:t};case h.QuestionnaireResponse:return{event_type:"questionnaire_response",payload:t};case h.Conversion:return{event_type:"conversion",payload:t};case h.ImpressionEvent:return{event_type:"event",payload:t};case h.ImpressionTime:return{event_type:"impression_time",payload:t};case h.Preview:return{event_type:"preview",payload:t};case h.Identify:return{event_type:"identify",payload:t};case h.SegmentIdentify:return{event_type:"segment_identify",payload:t};case h.Metric:return{event_type:"metric",payload:t};case h.VisitorIdentification:return{event_type:"visitor_identification",payload:t};default:return this.logger.info("Unrecognized TrackType found. Ignoring event",e,t),null}}resetInterval(){this.requestInterval&&clearInterval(this.requestInterval),this.requestInterval=setInterval(()=>this.flush(),3e3)}clearBuffer(){const e=this.buffer;return this.buffer=[],e}trackRequestFailed(){this.buffer.some(({payload:e})=>"client.tracking_request.failed"===(null==e?void 0:e.metric_key))||this.track(h.Metric,{metric_key:"client.tracking_request.failed",metric_type:o.q.Increment,tags:{client_version:"5.5.0"}})}sendEvents(e){return l(this,void 0,void 0,(function*(){const t=yield window.fetch(this.batchTrackingUrl,{body:e,method:"POST",keepalive:!0});if(!t.ok)throw c.invalidResponse(t.statusText)}))}},u=function(e,t){var i={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(i[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(n=Object.getOwnPropertySymbols(e);r<n.length;r++)t.indexOf(n[r])<0&&Object.prototype.propertyIsEnumerable.call(e,n[r])&&(i[n[r]]=e[n[r]])}return i};var h;!function(e){e.Identify="identify",e.SegmentIdentify="segment_identify",e.Preview="preview",e.Impression="impression",e.ExperienceImpression="experience_impression",e.Conversion="conversion",e.QuestionnaireImpression="questionnaire_impression",e.QuestionnaireResponse="questionnaire_response",e.ImpressionEvent="impression_event",e.ImpressionTime="impression_time",e.Metric="metric",e.VisitorIdentification="visitor_identification"}(h||(h={}));var p=i(59),m=i(9),g=i(60),v=i(38),f=i(6);const b=["preview","mutiny",v.k,v.j,v.b,v.c,v.e,v.a];function y(e,t,i){const n=Object(f.c)(),r=(null==n?void 0:n.variable_overrides)?n.variable_overrides:{},s={person:{behavior:{session_number:i.getAndSetSessionNumber(),viewed_questionnaires:i.impressionStore.questionnaireImpressions,visited_url:i.impressionStore.impressions,conversions:i.impressionStore.conversions}}},o=Object(a.g)(window.location.search);return function(e,{campaign_query_param_keys:t}){const i=new Set([...b,...t]),n=Object(g.a)();for(const t of Object.keys(e).filter(e=>!i.has(e)))n.setItem("query."+t,e[t])}(o,e),new v.i(Object.assign(Object.assign(Object.assign({},s),{query:o}),r),t).getWriteableStore()}var w=i(61),k=i(35),_=i(45);var O=class{constructor(){this.listeners=[],this.onChange=e=>{this.logger.info("Attaching change listener"),this.listeners.push(e)},this.logger=new s.a("state-change-handler")}attach(){const e=window.history,{pushState:t,replaceState:i}=e;let n=Object.assign({},window.location);this.logger.debug("Overriding window.history.pushState"),e.pushState=(...i)=>{const r=t.apply(e,i);return this.urlChanged(n)&&(this.logger.info("Calling listeners for window.history.pushState"),this.executeListeners()),n=Object.assign({},window.location),r},e._mutinyPushState=t,this.logger.debug("Overriding window.history.replaceState"),e.replaceState=(...t)=>{const r=i.apply(e,t);return this.urlChanged(n)&&(this.logger.info("Calling listeners for window.history.replaceState"),this.executeListeners()),n=Object.assign({},window.location),r},e._mutinyReplaceState=i,this.logger.debug("Adding popstate event listener"),window.addEventListener("popstate",()=>{this.urlChanged(n)&&(this.logger.info("Calling listeners for window.onpopstate"),this.executeListeners()),n=Object.assign({},window.location)})}executeListeners(){try{for(const e of this.listeners)e()}catch(e){m.b.notify(e)}}urlChanged(e){const{pathname:t,hash:i}=e;return window.location.pathname!==t||window.location.hash!==i}},C=i(46);const T=["scroll","resize"],S=["wheel","keydown","keyup","mousedown","mousemove","touchstart","touchmove","click","contextmenu"];class E{constructor({timeIntervalEllapsedCallbacks:e=[],absoluteTimeEllapsedCallbacks:t=[],checkCallbacksIntervalMs:i=100,browserTabInactiveCallbacks:n=[],idleCallbacks:r=[],stopTimerOnTabchange:s=!0,activeCallbacks:o=[],browserTabActiveCallbacks:a=[],idleTimeoutMs:l=3e3}){this.startTimer=()=>{this.checkCallbackIntervalId||this.checkCallbacksOnInterval();const e=this.times[this.times.length-1];null!==(null==e?void 0:e.stop)&&(this.times.push({start:performance.now(),stop:null}),this.running=!0)},this.stopTimer=()=>{0!==this.times.length&&(this.times[this.times.length-1].stop=performance.now(),this.running=!1)},this.addTimeIntervalEllapsedCallback=e=>{this.timeIntervalEllapsedCallbacks.push(e)},this.addAbsoluteTimeEllapsedCallback=e=>{this.absoluteTimeEllapsedCallbacks.push(e)},this.addBrowserTabInactiveCallback=e=>{this.browserTabInactiveCallbacks.push(e)},this.addBrowserTabActiveCallback=e=>{this.browserTabActiveCallbacks.push(e)},this.addIdleCallback=e=>{this.idleCallbacks.push(e)},this.addActiveCallback=e=>{this.activeCallbacks.push(e)},this.getTimeInMilliseconds=()=>this.times.reduce((e,t)=>e=t.stop?e+(t.stop-t.start):e+(performance.now()-t.start),0),this.isRunning=()=>this.running,this.isIdle=()=>this.idle,this.reset=()=>{this.times=[]},this.destroy=()=>{this.unregisterEventListeners(),this.checkCallbackIntervalId&&window.clearInterval(this.checkCallbackIntervalId)},this.onBrowserTabInactive=()=>{this.isRunning()&&this.stopTimerOnTabchange&&this.stopTimer();for(const e of this.browserTabInactiveCallbacks)e(this.getTimeInMilliseconds())},this.onBrowserTabActive=()=>{this.isRunning()||this.startTimer();for(const e of this.browserTabActiveCallbacks)e(this.getTimeInMilliseconds())},this.onBrowserActiveChange=()=>{"visible"===document.visibilityState?this.onBrowserTabActive():this.onBrowserTabInactive()},this.onTimePassed=()=>{for(const[e,{callback:t,pending:i,timeInMilliseconds:n}]of this.absoluteTimeEllapsedCallbacks.entries())i&&n<=this.getTimeInMilliseconds()&&(t(this.getTimeInMilliseconds()),this.absoluteTimeEllapsedCallbacks[e].pending=!1);for(const[e,{callback:t,timeInMilliseconds:i,multiplier:n}]of this.timeIntervalEllapsedCallbacks.entries())i<=this.getTimeInMilliseconds()&&(t(this.getTimeInMilliseconds()),this.timeIntervalEllapsedCallbacks[e].timeInMilliseconds=n(i));if(this.currentIdleTimeMs>=this.idleTimeoutMs&&this.isRunning()){this.idle=!0,this.stopTimer();for(const e of this.idleCallbacks)e(this.getTimeInMilliseconds())}else this.currentIdleTimeMs+=this.checkCallbacksIntervalMs},this.resetIdleTime=()=>{this.idle&&this.startTimer();for(const e of this.activeCallbacks)e(this.getTimeInMilliseconds());this.idle=!1,this.currentIdleTimeMs=0},this.registerEventListeners=()=>{const e={passive:!0},t=Object.assign(Object.assign({},e),{capture:!0});document.addEventListener("visibilitychange",this.onBrowserActiveChange);const i=Object(C.b)(this.resetIdleTime,2e3,{trailing:!1});for(const e of T)window.addEventListener(e,i,t);for(const t of S)document.addEventListener(t,i,e)},this.unregisterEventListeners=()=>{document.removeEventListener("visibilitychange",this.onBrowserActiveChange);for(const e of T)window.removeEventListener(e,this.resetIdleTime);for(const e of S)document.removeEventListener(e,this.resetIdleTime)},this.checkCallbacksOnInterval=()=>{this.checkCallbackIntervalId=window.setInterval(()=>{this.onTimePassed()},this.checkCallbacksIntervalMs)},this.running=!1,this.times=[],this.idle=!1,this.currentIdleTimeMs=0,this.marks={},this.measures={},this.stopTimerOnTabchange=s,this.browserTabActiveCallbacks=a,this.browserTabInactiveCallbacks=n,this.checkCallbacksIntervalMs=i,this.idleTimeoutMs=l,this.timeIntervalEllapsedCallbacks=e,this.absoluteTimeEllapsedCallbacks=t,this.idleCallbacks=r,this.activeCallbacks=o,this.registerEventListeners()}mark(e){this.marks[e]||(this.marks[e]=[]),this.marks[e].push({time:this.getTimeInMilliseconds()})}getMarks(e){if(0!==this.marks[e].length)return this.marks[e]}measure(e,t,i){const n=this.marks[t],r=n[n.length-1],s=this.marks[i],o=s[s.length-1];this.measures[e]||(this.measures[e]=[]),this.measures[e].push({duration:o.time-r.time,name:e,startTime:r.time})}getMeasures(e){if(this.measures[e]||0!==this.measures[e].length)return this.measures[e]}}var x=class{constructor(){this.timer=new E({}),this.start()}start(){this.timer.startTimer()}stop(){this.timer.stopTimer()}restart(){this.timer.destroy(),this.timer=new E({}),this.start()}isRunning(){return this.timer.isRunning()}getTimeInMilliseconds(){return this.timer.getTimeInMilliseconds()}callAtElapsedTime(e,t){this.timer.addAbsoluteTimeEllapsedCallback({callback:e,timeInMilliseconds:t,pending:!0})}callOnPageInactive(e){this.timer.addBrowserTabInactiveCallback(e)}setMarker(e){return this.timer.mark(e)}},I=i(7),j=i(3),M=i(12);class z{constructor(e){this.events=e,this.impressionStore=this.emptyImpressionStore(),this.logger=new s.a("local-impression-cache"),this.impressionObject=null,this.storage=Object(M.a)(),this.loadImpressions(),this.logger.info(`Finished initializing local impression cache with ${this.length()} records`)}getAndSetSessionNumber(){const e=Object(j.d)(j.a),t=e?Number.parseInt(e,10):Number.NaN;e&&this.logger.debug("Found session storage session number",e);const i=Number.isNaN(t)?1:t,n=this.impressionStore.sessionNumber;if(e&&i===n)return this.setSessionNumber(i),i;this.logger.debug("Session storage session number does not match impression store session number",n);const r=n+1;return this.setSessionNumber(r),r}setSessionNumber(e){this.logger.debug("Setting session storage session number",e),Object(j.f)(j.a,e.toString(),18e5),this.impressionStore.sessionNumber=e,this.writeStorage(),this.events.trigger(o.j.ImpressionCacheUpdate,{sessionNumber:e})}storeConversion(e){e&&(this.logger.debug("Adding new conversion to local impression cache",e),this.impressionStore.conversions.push({conversion_configuration:{id:e}}),this.writeStorage(),this.events.trigger(o.j.ImpressionCacheUpdate,{conversion:e}))}storeImpression(e,t){this.impressionObject=this.buildImpression(e,t),this.impressionObject&&(this.logger.debug("Adding new impression to local impression cache"),this.impressionStore.impressions.push(this.impressionObject),this.writeStorage(),this.events.trigger(o.j.ImpressionCacheUpdate,{impression:this.impressionObject}))}storeQuestionnaireImpression(e){const t=this.buildQuestionnaireImpression(e);t&&(this.logger.debug("Adding new questionnaire impression to local impression cache"),this.impressionStore.questionnaireImpressions.push(t),this.writeStorage(),this.events.trigger(o.j.ImpressionCacheUpdate,{questionnaireImpression:t}))}flushLocalCache(){this.logger.debug("Clearing local impression cache"),this.impressionStore=this.emptyImpressionStore(),this.storage.removeItem("_mutiny_impressions"),this.impressionObject=null}loadImpressions(){this.impressionStore=this.readStorage()}length(){return this.impressionStore.impressions.length+this.impressionStore.questionnaireImpressions.length}readStorage(){this.logger.debug("Loading local impression cache");const e=this.storage.getItem("_mutiny_impressions");return e?this.parseImpressionStore(e):this.emptyImpressionStore()}writeStorage(){this.logger.debug("Saving local impression cache"),this.storage.setItem("_mutiny_impressions",JSON.stringify(this.impressionStore))}buildImpression(e,t){if(e&&t.url){const i=t.query||{},[n]=t.url.split("?",2);return{query:i,token:e,url:n}}return null}buildQuestionnaireImpression(e){return null===this.impressionObject?null:e&&e.questionnaire&&e.questionnaire.key?Object.assign(Object.assign({},this.impressionObject),{questionnaire:{key:e.questionnaire.key}}):void 0}parseImpressionStore(e){try{const t=JSON.parse(e);return Array.isArray(t)?{impressions:this.parseRecords(t,this.parseImpression,"impression"),questionnaireImpressions:[],sessionNumber:1,conversions:[]}:{impressions:this.parseRecords(t.impressions||[],this.parseImpression,"impression"),questionnaireImpressions:this.parseRecords(t.questionnaireImpressions||[],this.parseQuestionnaireImpression,"questionnaire impression"),sessionNumber:t.sessionNumber||1,conversions:t.conversions||[]}}catch(e){return this.logger.info("Failed to parse local storage impression cache; discarding"),this.emptyImpressionStore()}}parseRecords(e,t,i){return this.logger.info(`Found ${e.length} impressions in local ${i} cache`),Object(I.e)(e.reduce((e,i)=>{const n=t(i);return n?e.push(n):this.logger.debug("Failed to parse local impression cache record with input "+i),e},[]),e=>e.token)}parseImpression(e){return e.token&&e.url?{query:e.query||{},token:e.token,url:e.url}:(m.b.notify("Tried to cache invalid impression value: "+e),null)}parseQuestionnaireImpression(e){if(!(e.token&&e.url&&e.questionnaire&&e.questionnaire.key))return m.b.notify("Tried to cache invalid questionnaire impression value: "+e),null;return{query:e.query||{},questionnaire:{key:e.questionnaire.key},token:e.token,url:e.url}}emptyImpressionStore(){return{impressions:[],questionnaireImpressions:[],sessionNumber:0,conversions:[]}}}var P=i(44),N=i(10),A=i(2),q=i(16),L=i(62),R=i(63);const D="query."+v.c,B="query."+v.e,U="query."+v.d,F="client.mode";class H{constructor(e,t,i,l,c,g,v,f,b){var y,_;this.config=e,this.events=t,this.localImpressionStore=i,this.userDataStore=l,this.personalizedClientModes=c,this.hider=g,this.userDataHttpClient=v,this.clientDataMetadata=f,this.bugsnagClient=m.b,this.stateChangeHandler=new O,this.componentPrioritizer=new L.a,this.pageHideCallbacks=[],this.pageHideListener=void 0,this._isRedirecting=!1,this.personalizationVisibilityListenerService=new R.a,this.logger=new s.a("context"),this.userDataStore=l,this.isNewUser=this.userDataStore.isNewUser(),this.visitorToken=this.userDataStore.getUserToken(),this.sessionToken=this.userDataStore.getSessionToken(),this.clientMode=null!=b?b:this.userDataStore.getClientMode(),this.preview=this.computePreview(),this.highlightPersonalizations=this.computeHighlightPersonalizations(),this.trackingDisabled=Object(A.c)()||Boolean(this.preview)||this.isMicrositePreview(),this.shouldRender=this.computeShouldRender(),this.userDataStore.set(F,this.clientMode,{localStorage:!1});const C=new x;this.timer=C,this.apiClient=new class{constructor(e,t,i,r,a,l,c){this.apiKey=e,this.localImpressionStore=i,this.visitorToken=r,this.preview=a,this.doNotTrack=l,this.logger=new s.a("api-client"),this.impressionToken=Object(n.a)(),t.on(o.j.StateChange,()=>{this.impressionToken=Object(n.a)(),this.logger.info("resetting impressionToken to",this.impressionToken)}),this.requestScheduler=this.initializeRequestScheduler(c)}identify(e,t={}){return this.doNotTrack||Boolean(this.preview)?Promise.resolve():this.requestScheduler.track(h.Identify,{data:t,user_id:e})}segmentIdentify(e,t){return this.doNotTrack||Boolean(this.preview)?Promise.resolve():this.requestScheduler.track(h.SegmentIdentify,{anonymous_id:t,user_id:e})}trackPreview(){return this.doNotTrack?Promise.resolve():this.requestScheduler.track(h.Preview,{})}trackImpression(e,t){if(this.doNotTrack||Boolean(this.preview))return Promise.resolve();const i={device_type:Object(r.a)(),impression_token:this.impressionToken,metadata:Object.assign(Object.assign({},t),{client_version:"5.5.0",window_data:window.mutinyData}),referrer:document.referrer,session_token:e,url:window.location.href,user_agent:navigator.userAgent};return this.localImpressionStore.storeImpression(this.impressionToken,Object.assign(Object.assign({},i),{query:Object(a.g)(window.location.search)})),this.logger.info("Calling `trackImpression`",i),this.requestScheduler.track(h.Impression,i)}trackExperienceImpression({audienceSegment:e,campaignAccountId:t,experience:i,impressionType:n,personIdentificationToken:r,selfOptimizingEventId:s}){return this.doNotTrack||Boolean(this.preview)?Promise.resolve():this.requestScheduler.track(h.ExperienceImpression,{audience_segment_id:null==e?void 0:e.id,campaign_account_id:t,client_version:"5.5.0",dom_update_group_id:null==i?void 0:i.dom_update_group_id,impression_token:this.impressionToken,impression_type:n,self_optimizing_event_id:s,person_identification_token:r})}trackConversion({conversionConfigurationId:e,formData:t}){return this.doNotTrack||Boolean(this.preview)?Promise.resolve():(this.localImpressionStore.storeConversion(e),this.requestScheduler.track(h.Conversion,{client_version:"5.5.0",conversion_configuration_id:e,form_data:t,impression_token:this.impressionToken,hostname:window.location.hostname}))}trackQuestionnaireResponse({questionnaire:e,answers:t,formValues:i}){return this.doNotTrack||Boolean(this.preview)?Promise.resolve():this.requestScheduler.track(h.QuestionnaireResponse,{answers:t,form_values:i,impression_token:this.impressionToken,questionnaire_id:e.id})}trackEvent({eventType:e,metadata:t}){return this.doNotTrack||Boolean(this.preview)?Promise.resolve():this.requestScheduler.track(h.ImpressionEvent,{event_type:e,impression_token:this.impressionToken,metadata:t})}trackTime({timeInSeconds:e}){return this.doNotTrack||Boolean(this.preview)?Promise.resolve():this.requestScheduler.track(h.ImpressionTime,{elapsed_time_in_ms:1e3*e,impression_token:this.impressionToken})}trackMetric(e,t){var{metricType:i,metricKey:n,previewMetric:r,tags:s}=e,o=u(e,["metricType","metricKey","previewMetric","tags"]);void 0===t&&(t=!1),this.logger.info("Calling `trackMetric`",i,n,s,o);const a=Boolean(this.preview)&&!r;return this.doNotTrack||a?Promise.resolve():(void 0===s&&(s={}),s.client_version="5.5.0",this.requestScheduler.track(h.Metric,Object.assign({metric_key:n,metric_type:i,tags:s},o),t))}trackVisitorIdentification({identificationType:e,value:t}){return this.doNotTrack||Boolean(this.preview)?Promise.resolve():this.requestScheduler.track(h.VisitorIdentification,{identification_type:e,value:t})}flush(e=!1){return this.requestScheduler.flush(e)}disableTracking(){this.doNotTrack=!0}initializeRequestScheduler(e){return this.logger.debug("Initializing batch request scheduler"),new d(this.apiKey,this.visitorToken,e)}}(this.config.api_key,this.events,this.localImpressionStore,this.visitorToken,this.preview,Object(A.c)(),C),this.exporter=new k.b(this.apiClient,this.visitorToken,this.sessionToken,this.userDataStore,this.config,this.trackingDisabled,this.preview,this.clientMode,this.clientDataMetadata),this.userDataClient=new p.b(this.userDataHttpClient,this.userDataStore,this.exporter,this.localImpressionStore,this.preview,this.hider),this.shimQueue=null===(_=null===(y=window.mutiny)||void 0===y?void 0:y.client)||void 0===_?void 0:_._queue,this.publicInterface=new w.a(this),this.configureBugsnag(),this.exposePublicInterface(),this.flushShimQueue(),this.attachPageHideListener(),this.stateChangeHandler.attach(),C.start(),this.trackPreview()}isRedirecting(){return this._isRedirecting}shouldExitBeforeUserDataFetch(){if(this.preview)return!1;const e=this.isWhitelistedHost(),t=this.userDataStore.getClientMode()!==o.d.AssetViewer;return Object(A.d)()||t&&!e}shouldExitAfterUserDataFetch(){if(this.preview)return!1;const e=this.userDataStore.get(p.a),t=this.userDataStore.get("user.ip_address"),i=t&&this.config.blocked_ips.includes(t),n=this.isBlacklistedUrlParam();return this.isNewUser&&e||i||n}ensureShouldRender(e,t){return this.shouldRender?Promise.resolve(e()):(this.logger.debug("Mutiny rendering is disabled"+(t?"; "+t:"")),Promise.resolve())}setPersonalizationVisibility(e){this.shouldRender=e,this.personalizationVisibilityListenerService.triggerListeners(e)}onPersonalizationVisibilityChange(e){return this.personalizationVisibilityListenerService.registerListener(e)}onPageHide(e){this.pageHideCallbacks.push(e)}setRedirecting(e){this._isRedirecting=e}configureBugsnag(){Object(m.a)({mutinyClient:{companySlug:this.config.company_slug,iteration:this.config.client_iteration},visitor:{token:this.visitorToken}})}flushShimQueue(){const e=this.shimQueue;if(e)for(const t of Object.keys(e))for(const{args:i}of e[t]){const e=this.publicInterface[t];"function"==typeof e&&e.call(this.publicInterface,...i)}}exposePublicInterface(){Object(q.a)(),window.mutiny.client=this.publicInterface,window.mutiny.hidePersonalizations=this.publicInterface.hidePersonalizations.bind(this.publicInterface),window.mutiny.showPersonalizations=this.publicInterface.showPersonalizations.bind(this.publicInterface)}trackPreview(){const e=Object(f.c)();if(!e)return;const t={experience_id:e.experience_id,variation_id:e.variation_id};e.exp<Date.now()/1e3?this.apiClient.trackMetric({metricKey:"client.unified_preview.visited.expired",metricType:o.q.Increment,previewMetric:!0,tags:t}):this.apiClient.trackMetric({metricKey:"client.unified_preview.visited",metricType:o.q.Increment,previewMetric:!0,tags:t})}computePreview(){const e=Object(f.c)(),t=this.userDataStore.get(D)||this.userDataStore.get(B);return e?o.w.Preview:this.config.preview?this.config.preview:t?o.w.Live:void 0}computeShouldRender(){return!!this.computePreview()||(this.clientMode===o.d.AssetViewer&&this.personalizedClientModes.includes(o.d.AssetViewer)||[o.d.Default,o.d.Microsite].includes(this.clientMode))}isMicrositePreview(){return"true"===Object(a.g)(window.location.search).preview&&this.clientMode===o.d.Microsite}computeHighlightPersonalizations(){const e=this.userDataStore.get(U);return!!this.preview&&"true"===e}isWhitelistedHost(){return!this.config.whitelisted_domains||(0===this.config.whitelisted_domains.length||this.config.whitelisted_domains.some(e=>Object(a.c)(window.location.host,e)))}isBlacklistedUrlParam(){return void 0!==this.config.blacklisted_query_params&&0!==Object.keys(this.config.blacklisted_query_params).length&&Object(N.d)(this.config.blacklisted_query_params).some(([e,t])=>{const i=this.userDataStore.get("query."+e);return i&&(0===t.length||t.includes(i))})}attachPageHideListener(){if(!this.pageHideListener){this.pageHideListener=()=>{for(const e of this.pageHideCallbacks)e()};const e="onpagehide"in self?"pagehide":"beforeunload";window.addEventListener(e,this.pageHideListener)}}}function $(e,t,i,n){const r=e.config,s=e.metadata,a=new _.a,l=new z(a),c=y(r,a,l),d=Object(P.c)(e),u=[o.d.Default,...d?[o.d.AssetViewer]:[]];return new H(r,a,l,c,u,t,i,s,n)}},function(e,t,i){"use strict";var n=i(9),r=i(1),s=i(0),o=i(49);const a=new r.a("reconcilliation-monitoring");let l=!1;var c=i(50),d=i(58);const u={characterData:!0,childList:!0,subtree:!0};t.a=class{constructor(e,t,i,n,s="update-renderer"){var o;this.personalize=e,this.domUpdates=t,this.domEvents=i,this.context=n,this.type=s,this.listeners=[],this.logger=new r.a(s),this.unregisterVisibilityListener=null===(o=this.context)||void 0===o?void 0:o.onPersonalizationVisibilityChange(this.onVisibilityChange.bind(this))}onVisibilityChange(e){e?this.renderAsync():this.teardown(!0)}get isUpdateRenderer(){return"update-renderer"===this.type}onRender(e){this.logger.info("attaching renderListener",e),this.listeners.push(e)}renderAsync(){return this.logger.info("renderAsync called, queuing requestAnimationFrame with",this.domUpdates),new Promise(e=>{requestAnimationFrame(()=>{this.logger.info("requestAnimationFrame executing"),this.render(),this.attachBodyObserver(),e(!0)})})}render(){return this.withErrorHandlingAndTracking(()=>{var e;if(this.logger.info("Starting DOMRenderer render"),document.body&&this.personalize)for(const e of this.domUpdates)e.render();for(const e of this.domEvents)e.setup();for(const e of this.listeners)this.logger.info("Running render callbacks"),e();const t=this.domUpdates.filter(e=>e.isRendered()),i=this.domUpdates.filter(e=>!e.shouldRender()),n=this.domUpdates.filter(e=>e.shouldRender()&&!e.isRendered());this.isUpdateRenderer&&document.dispatchEvent(new CustomEvent(s.j.DomRendererComplete,{detail:{renderedRecords:t.map(e=>e.record),unrenderedRecords:n.map(e=>e.record)}})),this.logger.info("Finished DOMRenderer render. Rendered elements: ",t),this.logger.info("Finished DOMRenderer render. Skipped elements: ",i),this.logger.info("Finished DOMRenderer render. Missing elements: ",n);const r=null===(e=this.observer)||void 0===e?void 0:e.takeRecords();return r&&r.length>0&&this.logger.info("Flushed render-induced mutations:",r),t})}withErrorHandlingAndTracking(e){return Object(n.c)(()=>e())}teardown(e=!1){var t,i,n;this.logger.info(e?"Temporarily tearing down DOMRenderer":"Tearing down DOMRenderer"),null===(t=this.observer)||void 0===t||t.disconnect(),null===(i=this.testObserver)||void 0===i||i.disconnect();for(const e of this.domUpdates)e.teardown();for(const e of this.domEvents)e.teardown();e||(null===(n=this.unregisterVisibilityListener)||void 0===n||n.call(this),this.unregisterVisibilityListener=void 0)}attachBodyObserver(){this.logger.info("attaching MutationObserver to document",document),this.observer?this.observer.disconnect():this.observer=new d.b(this.observerCallback.bind(this),{callbackLimit:200,logger:this.logger,disconnectCallback:()=>{setTimeout(()=>{var e;(null===(e=this.testObserver)||void 0===e?void 0:e.connected)&&n.b.notify("Timing based MutationObserver disconnected prior to the Timeout based observer")},0)}}),this.observer.observe(document,u),this.testObserver?this.testObserver.disconnect():this.testObserver=new d.b(this.testObserverCallback.bind(this),{callbackLimit:200,logger:this.logger,mode:d.a.Timeout,disconnectCallback:()=>{setTimeout(()=>{var e;(null===(e=this.observer)||void 0===e?void 0:e.connected)&&n.b.notify("EventLoop based MutationObserver disconnected prior to the Timing based observer")},0)}}),this.testObserver.observe(document,u)}observerCallback(e){const t=e.every(e=>Object(o.a)(e));if(!this.isUpdateRenderer||!t){this.logger.info("Mutation observed from DOMRenderer",e),Object(c.a)();const t=this.domUpdates.filter(e=>"modification"===e.record.personalization_type);for(const e of t)!e.isOriginalPresent()&&e.isRendered()&&e.teardown();for(const e of this.domEvents)!e.isOriginalRendered()&&e.isAttached()&&e.teardown();return this.render(),this.context.exporter&&function(e,t){var i;if(!l)for(const n of e)n.target instanceof HTMLElement&&["__next","___gatsby","root","__nuxt"].includes(n.target.id)&&0!==(null!==(i=n.removedNodes)&&void 0!==i?i:[]).length&&(Array.from(n.target.children).some(e=>!Object(o.b)(e))||(l=!0,a.error("Detected possible reconcilliation failure."),t.apiClient.trackMetric({metricKey:"client.monitor.application_fatal_unrender",metricType:s.q.Increment,tags:{client_version:"5.5.0"}})))}(e,this.context.exporter),!0}return this.logger.info("Ignoring mutations from Mutiny client",e),!1}testObserverCallback(e){return this.isUpdateRenderer&&!e.every(e=>Object(o.a)(e))}isListening(){var e;return Boolean(null===(e=this.observer)||void 0===e?void 0:e.connected)}}},function(e,t,i){"use strict";i.d(t,"a",(function(){return h})),i.d(t,"b",(function(){return p}));var n=i(9),r=i(38),s=i(0),o=i(1),a=i(18),l=i(46),c=i(74),d=i.n(c);function u(...e){return d()(e.join("-"))()}const h=(e,t,i,a)=>{const l=new o.a("personalize");if(a)return n.b.leaveBreadcrumb("Personalized: 1"),l.info("Personalize: ",s.v.Personalized),l.info("Because of preview mode"),s.v.Personalized;if(i.get(r.f))return n.b.leaveBreadcrumb("Personalized: 5"),l.info("Personalize: ",s.v.Personalized),l.info("Because personalize store override is set"),s.v.Personalized;return function({holdOut:e,userData:t,audienceSegmentId:i,experienceId:n,strategy:o}){return o===s.a.PerSegment?e>u(t.getUserToken(),null!=i?i:""):o===s.a.PerExperience?e>u(t.getUserToken(),null!=n?n:""):e>t.get(r.g)}({holdOut:Number(e.hold_out),userData:i.getWriteableStore(),audienceSegmentId:t.id,experienceId:e.id,strategy:e.experiment_assignment_grouping_strategy})?(n.b.leaveBreadcrumb("Personalized: 6"),l.info("Personalize: ",s.v.Personalized),l.info("Because there are DOM Updates to show, and user is greater than hold out percentage"),s.v.Personalized):(n.b.leaveBreadcrumb("Personalized: 7"),l.info("Personalize: ",s.v.Control),l.info("Because there are DOM Updates to show, and user is lower than hold out percentage"),s.v.Control)};function p(e){const t=e=>{if(!e)return[];if("string"==typeof e){const t=[],i=new RegExp(a.a);let n=i.exec(e);return Object(l.c)(()=>!!n,()=>{t.push(n[1]),n=i.exec(e)}),t}return"object"==typeof e?Object.values(e).flatMap(e=>t(e)):[]};return new Set(t(e))}},function(e,t,i){"use strict";i.d(t,"a",(function(){return s}));var n=i(35),r=i(0);var s;!function(e){e[e.Timing=0]="Timing",e[e.Timeout=1]="Timeout"}(s||(s={}));t.b=class{constructor(e,t){var i;this.callback=e,this.connected=!1,this.callbackCount=0,this.firstCallbackAt=void 0,this.observer=new MutationObserver(this.wrappedCallback.bind(this)),this.callbackLimit=void 0===(null==t?void 0:t.callbackLimit)?100:t.callbackLimit,this.exporter=null==t?void 0:t.exporter,this.domUpdateId=null==t?void 0:t.domUpdateId,this.logger=null==t?void 0:t.logger,this.mode=null!==(i=null==t?void 0:t.mode)&&void 0!==i?i:s.Timing,this.disconnectCallback=null==t?void 0:t.disconnectCallback}observe(e,t){var i;this.connected=!0,null===(i=this.logger)||void 0===i||i.info("Observing mutations on new node",e),this.observer.observe(e,t||{})}disconnect(){var e;this.connected=!1,null===(e=this.logger)||void 0===e||e.info("Unsubscribing mutation observer from new changes"),this.observer.disconnect()}takeRecords(){return this.observer.takeRecords()}wrappedCallback(e){var t,i,o,a;if(this.connected)return this.mode===s.Timing&&(void 0===this.firstCallbackAt||performance.now()-this.firstCallbackAt>=1e3)&&(this.firstCallbackAt=performance.now(),this.callbackCount=0),this.callback(e,this.observer)&&(this.callbackCount+=1,null===(i=this.logger)||void 0===i||i.debug("Executed WrappedMutationObserver callback",{callbackCount:this.callbackCount,callbackLimit:this.callbackLimit})),this.mode===s.Timeout&&window.setTimeout(()=>{this.callbackCount=0},0),this.shouldDisconnect()?(this.disconnect(),null===(o=this.exporter)||void 0===o||o.track(n.a.Metric,{description:this.domUpdateId?"DOM Update ID: "+this.domUpdateId:"No DOM Update ID provided",metricKey:"Client DOM Update MutationObserver Limit Exceeded",metricType:r.q.Event}),void(null===(a=this.disconnectCallback)||void 0===a||a.call(this))):void 0;null===(t=this.logger)||void 0===t||t.error("Mutation observer callback triggered while not connected")}shouldDisconnect(){var e;return!!(this.callbackCount>=this.callbackLimit&&(this.mode!==s.Timing||this.firstCallbackAt&&performance.now()-this.firstCallbackAt<1e3))&&(null===(e=this.logger)||void 0===e||e.warn("Disconnecting WrappedMutationObserver because exceeded per second callback limit",{callbackCount:this.callbackCount,callbackLimit:this.callbackLimit}),!0)}}},function(e,t,i){"use strict";i.d(t,"a",(function(){return l})),i.d(t,"b",(function(){return c}));i(51);var n=i(9),r=i(35),s=i(1),o=i(0),a=i(6);const l="user_data_failed";class c{constructor(e,t,i,n,r,o){this.httpClient=e,this.userDataStore=t,this.exporter=i,this.localImpressionStore=n,this.preview=r,this.hider=o,this.syncLogger=new s.a("user-data-client-sync"),this.asyncLogger=new s.a("user-data-client-async")}updateUserDataStore(e){if(this.preview!==o.w.Preview||Object(a.b)())this.userDataStore.setBulk(e);else{const t=this.userDataStore.getData();this.userDataStore.setBulk(Object.assign(Object.assign({},e),t))}}getAsyncUserData(){return this.fetchUserData(this.asyncLogger,!0).then(e=>e.json).then(e=>(this.updateUserDataStore(e),e))}getUserData(){return this.fetchUserData(this.syncLogger,!1).then(e=>{const t=e.headers.get("x-cache"),i=null==t?void 0:t.includes("MISS");if(e.ok){const t=this.localImpressionStore.getAndSetSessionNumber(),n=this.getSessionNumber(e.json)||1,r=Math.max(t,n);return i?(this.localImpressionStore.flushLocalCache(),this.localImpressionStore.setSessionNumber(r)):this.getSessionNumber(e.json)&&delete e.json.person.behavior.session_number,e.json}return{[l]:!0}}).then(Object(n.d)(e=>(this.updateUserDataStore(e),(this.preview===o.w.Editor||this.preview===o.w.Preview)&&window.__mutiny&&window.__mutiny.preview_data&&this.userDataStore.setBulk(window.__mutiny.preview_data),e))).catch(e=>{var t;throw null===(t=this.hider)||void 0===t||t.removeHider(!1,"user data request failed"),this.userDataStore.set(l,"true"),e})}fetchUserData(e,t){e.info("Fetching user data");const i=performance.now(),s=`[Mutiny-${t?"async":"sync"}]`;return n.b.leaveBreadcrumb(s+" Loading user-data"),this.httpClient.fetch(t).then(Object(n.d)(a=>{t||this.checkForTimeout(e);const l=a.headers.get("x-cache"),c=(null==l?void 0:l.includes("MISS"))?"miss":"hit",d=a.headers.get("x-continent-code"),u=a.headers.get("x-country-code"),h={cdn_client_connection_speed:a.headers.get("x-connection-speed")||"UNKNOWN",cdn_client_continent:d||"UNKNOWN",cdn_client_country_code:u||"UNKNOWN",cdn_edge_data_center:a.headers.get("x-edge-datacenter")||"UNKNOWN",cdn_edge_region:a.headers.get("x-edge-region")||"UNKNOWN"},p=Object.assign({async:t.toString(),cdn_status:c,status:a.status.toString()},h);this.exporter.track(r.a.Metric,{metricKey:"client.user_data.fetch",metricType:o.q.Increment,tags:p}),this.exporter.track(r.a.Metric,{metricKey:"client.user_data.fetch.time",metricType:o.q.Timing,tags:p,value:performance.now()-i});const m=performance.getEntriesByType&&performance.getEntriesByType("resource").find(e=>e.name.startsWith("https://client-registry.mutinycdn.com"));return m&&this.exporter.track(r.a.Metric,{metricKey:"client.bundle.fetch.time",metricType:o.q.Timing,tags:h,value:m.duration}),a.ok?(e.info("User data loaded successfully"),n.b.leaveBreadcrumb(s+" User data loaded"),this.exporter.track(r.a.Metric,{metricKey:"client.user_data.fetch.success",metricType:o.q.Increment,tags:p}),a):(e.info("User data failed"),n.b.leaveBreadcrumb(`${s} User data fail ${a.status}`),this.exporter.track(r.a.Metric,{metricKey:"client.user_data.fetch.failure",metricType:o.q.Increment,tags:p}),a)})).catch(i=>{throw e.info("Fetch failure",i),this.exporter.track(r.a.Metric,{metricKey:"client.user_data.fetch.network_error",metricType:o.q.Increment,tags:{async:t.toString()}}),i})}getSessionNumber(e){if(e.person&&e.person.behavior&&void 0!==e.person.behavior.session_number)return e.person.behavior.session_number}checkForTimeout(e){document.documentElement.dataset.mutinyLoaded&&(this.exporter.track(r.a.Metric,{metricKey:"client.user_data.fetch.timed_out",metricType:o.q.Increment}),e.info("Load timed out before user data finished"))}}},function(e,t,i){"use strict";i.d(t,"a",(function(){return o}));var n=i(2);class r{constructor(){this.data={}}getItem(e){return this.data.hasOwnProperty(e)?this.data[e]:null}setItem(e,t){this.data[e]=t}}let s;function o(){return s||(s=!Object(n.d)()&&function(){try{return sessionStorage.setItem("test","test"),"test"!==sessionStorage.getItem("test")?!1:(sessionStorage.removeItem("test"),!0)}catch(e){return!1}}()?sessionStorage:new r,s)}},function(e,t,i){"use strict";i.d(t,"b",(function(){return o})),i.d(t,"a",(function(){return a}));var n=i(0),r=i(2),s=function(e,t){var i={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(i[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(n=Object.getOwnPropertySymbols(e);r<n.length;r++)t.indexOf(n[r])<0&&Object.prototype.propertyIsEnumerable.call(e,n[r])&&(i[n[r]]=e[n[r]])}return i};function o(e){document.dispatchEvent(new CustomEvent(n.j.ExperienceRenderComplete,{detail:{experience:e}}))}class a{constructor(e){this.context=e,this._renderedRecords=[],this._unrenderedRecords=[],this._experiences=[],document.addEventListener(n.j.DomRendererComplete,({detail:e})=>{e.renderedRecords&&(this._renderedRecords=e.renderedRecords),e.unrenderedRecords&&(this._unrenderedRecords=e.unrenderedRecords)}),document.addEventListener(n.j.ExperienceRenderComplete,({detail:e})=>{e.experience&&this._experiences.push(e.experience)}),document.addEventListener(n.j.StateChange,()=>{this._experiences=[],this._renderedRecords=[],this._unrenderedRecords=[]})}get experiences(){return this._experiences}get renderedRecords(){return this._renderedRecords}get unrenderedRecords(){return this._unrenderedRecords}identify(e,t={}){return this.context.exporter.apiClient.identify(e,t)}trackConversion(e){return this.context.exporter.apiClient.trackConversion({formData:e})}trackEvent(e){return this.context.exporter.apiClient.trackEvent(e)}defaultOptOut(){return Object(r.b)()}optOut(){return this.context.exporter.disableTracking(),Object(r.f)()}optIn(){return Object(r.e)()}getRenderedRecords(){return this._renderedRecords}getUnrenderedRecords(){return this._unrenderedRecords}getUserData(){const e=this.context.userDataStore.toJSON(),{user:t}=e;return s(e,["user"])}getCampaignData(){const e=this.getUserData(),t=this._experiences.filter(e=>Boolean(e.audienceSegment.campaign_slug));return 0===t.length?{}:Object.assign({},e[t[0].audienceSegment.campaign_slug])}getRenderedExperiences(){return this._experiences}hidePersonalizations(){this.context.setPersonalizationVisibility(!1)}showPersonalizations(){this.context.setPersonalizationVisibility(!0)}}},function(e,t,i){"use strict";i.d(t,"a",(function(){return r}));var n=i(0);class r{constructor(e=!1){this.editorMode=e,this.shouldRenderCallbacks=new Map,this.renderedBannerId=void 0,this.bannerPriorities=[]}registerExperiences(e){const t=this.prioritizeExperiences(e);this.renderedBannerId||(this.bannerPriorities=[...this.bannerPriorities,...this.extractBannerExperiences(t)]),this.render()}prioritizeExperiences(e){const t=e.filter(({experience:{experience_type:e}})=>e===n.k.Render).sort((e,t)=>e.experience.priority-t.experience.priority),i=e.filter(({experience:{experience_type:e}})=>e===n.k.Questionnaire).sort((e,t)=>e.experience.priority-t.experience.priority);return t.concat(i)}extractBannerExperiences(e){return e.map(({experience:e})=>{var t,i,r;return e.experience_type===n.k.Render?null===(t=e.dom_updates.find(e=>e.data.block_placement===n.b.Banner))||void 0===t?void 0:t.resource_id:e.experience_type===n.k.Questionnaire&&(null===(i=e.questionnaire)||void 0===i?void 0:i.questionnaire_type)===n.y.TopBar?null===(r=e.questionnaire)||void 0===r?void 0:r.resource_id:void 0}).filter(Boolean)}onShouldRender(e,t){if(!this.editorMode)return this.shouldRenderCallbacks.set(e,t),()=>{this.shouldRenderCallbacks.delete(e)};t()}render(){this.renderedBannerId||(this.renderedBannerId=this.bannerPriorities.find(e=>{var t;return null===(t=this.shouldRenderCallbacks.get(e))||void 0===t?void 0:t()}))}reset(){this.shouldRenderCallbacks.clear(),this.renderedBannerId=void 0,this.bannerPriorities=[]}}},function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));class n{constructor(){this.visibilityListeners=new Set}registerListener(e){return this.visibilityListeners.add(e),()=>{this.visibilityListeners.delete(e)}}triggerListeners(e){for(const t of Array.from(this.visibilityListeners))t(e)}}},function(e,t,i){"use strict";i.d(t,"c",(function(){return u})),i.d(t,"d",(function(){return h})),i.d(t,"a",(function(){return p})),i.d(t,"b",(function(){return b}));var n=i(9),r=i(15),s=i(0),o=i(7),a=i(10),l=i(18),c=i(4),d=i(19);const u=e=>"boolean_join"in e&&"clauses"in e,h=e=>"attribute"in e&&"value"in e&&"comparator"in e;function p(e,t,i){switch(i){case s.f.Equal:return e===t;case s.f.NotEqual:return e!==t;case s.f.NotIncludes:return!e||!e.includes(t);case s.f.UrlNotEqual:return!e||"string"!=typeof t||!Object(c.i)(t,e);case s.f.UrlHostNotEqual:return!e||"string"!=typeof t||!Object(c.c)(e,t);case s.f.UrlPathNotEqual:return!e||"string"!=typeof t||!Object(c.d)(e,t);default:if(null==e||null===t)return!1;switch(i){case s.f.UrlEqual:return"string"==typeof t&&Object(c.i)(t,e);case s.f.GreaterThan:return e>t;case s.f.GreaterThanOrEqual:return e>=t;case s.f.LessThan:return e<t;case s.f.LessThanOrEqual:return e<=t;case s.f.Includes:return null==e?void 0:e.includes(t);case s.f.StartsWith:return null==e?void 0:e.startsWith(t);case s.f.EndsWith:return null==e?void 0:e.endsWith(t);case s.f.MatchesRegex:return e&&"string"==typeof t&&Boolean(new RegExp(t).test(e));case s.f.UrlHostEqual:return e&&"string"==typeof t&&Object(c.c)(e,t);case s.f.UrlPathEqual:return e&&"string"==typeof t&&Object(c.d)(e,t)}}}function m(e,t){if(u(e)){if("and"===e.boolean_join)return Object(o.a)(e.clauses,e=>m(e,t));if("or"===e.boolean_join)return Object(o.b)(e.clauses,e=>m(e,t))}else if(h(e))return t(e);return n.b.notify("Malformed condition has a node that is neither a leaf or inner node",{metaData:{conditionNode:JSON.stringify(e)}}),!1}function g(e,t,i,r){return r?m(r,({attribute:t,value:r,comparator:o})=>p(function(e,t){switch(t){case s.e.Count:return e.length;default:return n.b.notify("Unrecognized aggregation attribute",{metaData:{aggregationKey:t}}),null}}(e.filter(i),t),r,o)):t(e,i)}function v(e,t,i,n,l,c,d){const u=(c?function(e,t,i){return e.filter(e=>i(t,new r.a(e)))}(e,c.root_node,l):e).map(e=>Object(a.c)(e,t)),h=e=>p(e,i,n);switch(n){case s.f.Equal:case s.f.UrlEqual:return null==i&&0===u.length||g(u,o.b,h,null==d?void 0:d.root_node);case s.f.GreaterThan:case s.f.GreaterThanOrEqual:case s.f.LessThan:case s.f.LessThanOrEqual:return g(u,o.b,h,null==d?void 0:d.root_node);case s.f.NotEqual:case s.f.UrlNotEqual:return(null!=i||0!==u.length)&&g(u,o.a,h,null==d?void 0:d.root_node);case s.f.Includes:return u.length>0&&g(u,o.b,h,null==d?void 0:d.root_node);case s.f.NotIncludes:return 0===u.length||g(u,o.a,h,null==d?void 0:d.root_node);default:return!1}}function f(e,t){return void 0===e||m(e,e=>function(e,t,i){const r=e.attribute.includes("query.")&&e.value?Object(c.h)(e.value):e.value,{topLevelPath:s,nestedPath:o}=Object(l.e)(e.attribute);let a=t.get(s);return o?(a=a||[],Array.isArray(a)?v(a,o,r,e.comparator,i,e.filter,e.aggregation):(n.b.notify("Invalid array condition on ",{metaData:{accessedData:a}}),!1)):p(a,r,e.comparator)}(e,t,f))}function b(e,t){return e.condition_tree?f(e.condition_tree.root_node,t):Object(d.b)(e.condition,t)}},function(e,t,i){"use strict";i.d(t,"a",(function(){return r}));const n=e=>{if(!(e instanceof HTMLElement))return e;e.dataset.mutiny="true";for(const t of Array.from(e.children))n(t);return e},r=e=>{const t=(new DOMParser).parseFromString(`<div>${e}</div>`,"text/html").body.children[0];if(1===t.childNodes.length)return n(t.childNodes[0]);const i=document.createDocumentFragment();return i.append(...Array.from(t.childNodes).map(e=>n(e))),i}},function(e,t,i){"use strict";i.d(t,"a",(function(){return r})),i.d(t,"b",(function(){return o})),i.d(t,"c",(function(){return a}));var n=i(0);function r(e){const t=i=>{(function(e){return e instanceof MessageEvent&&e.data&&e.data.type===n.j.AssetViewerOpened})(i)&&(e.exporter.page(),window.removeEventListener("message",t))};window.addEventListener("message",t)}let s;function o(){if(s)return s;const e=new Set(["click","dblclick","keydown","keypress","keyup","scroll"]);for(const t of[HTMLElement,HTMLFormElement,HTMLInputElement,HTMLMediaElement,HTMLVideoElement,HTMLCanvasElement,HTMLSelectElement])for(const i of Object.keys(t.prototype).filter(e=>e.startsWith("on")))e.add(i.slice(2));return s=Array.from(e.values()),s}let a=!1;try{window.addEventListener("test",()=>{},Object.defineProperty({},"passive",{get(){a={passive:!0}}}))}catch(e){}},function(e,t,i){"use strict";i.d(t,"a",(function(){return s}));var n=i(42);const r=globalThis.IntersectionObserver,s=[];class o extends r{constructor(e,t){super(o.wrappedCallback(e),t),this.targets=new Set,s.push(this)}observe(e){if(!(e instanceof HTMLElement))return this.targets.add(e),super.observe(e);const t=n.a.getClonedElement(e);return this.targets.add(null!=t?t:e),super.observe(null!=t?t:e)}unobserve(e,t=!1){if(!(e instanceof HTMLElement)||t)return this.targets.delete(e),super.unobserve(e);const i=n.a.getClonedElement(e);return this.targets.delete(null!=i?i:e),super.unobserve(null!=i?i:e)}static wrappedCallback(e){return(t,i)=>{const r=t.map(e=>{if(!(e.target instanceof HTMLElement))return e;const t=n.a.getOriginalElement(e.target);return t?Object.assign(Object.assign({},this.copyIntersectionObserverEntry(e)),{target:t}):e});e(r,i)}}static copyIntersectionObserverEntry(e){const t=Object.getOwnPropertyNames(Object.getPrototypeOf(e)).filter(e=>"constructor"!==e),i={};for(const n of t){const t=n;i[t]=e[t]}return i}}globalThis.IntersectionObserver=o},function(e,t,i){"use strict";i.d(t,"b",(function(){return c}));var n=i(36),r=i.n(n),s=i(33),o=i(0),a=i(34),l=i(47);function c(e,t,i){const n=e.split(",").map(e=>e.trim()).filter(e=>e.length>0).map(e=>`\n    body ${e} {\n      position: fixed !important;\n      ${t?`margin-top: ${i||l.a.sizes.desktopBannerHeight} !important;`:"margin-top: 0 !important;"}\n      transition: ${l.a.animations.bannerTransition("margin-top")} !important;\n    }\n  `);return`\n  ${l.a.breakpoints.desktop} {\n    ${n.join("\n")}\n    body {\n      ${t?`padding-top: ${i||l.a.sizes.desktopBannerHeight} !important;`:""}\n      position: relative !important;\n      transition: ${l.a.animations.bannerTransition("padding-top")} !important;\n    }\n  }\n  `}const d=`\n  ${l.a.breakpoints.mobile} {\n    body #drift-widget-container {\n      display: none !important;\n    }\n  }\n`;t.a=Object(a.a)(e=>({banner:{[e.breakpoints.mobile]:{height:"unset",overflow:"unset",padding:"50px 0"},[e.breakpoints.desktop]:{alignItems:"center",display:"flex",height:e.sizes.desktopBannerHeight,justifyContent:"center",overflow:"hidden"},backgroundColor:e.colors.primary,boxSizing:"border-box",position:"relative",transition:e.animations.bannerTransition("transform"),width:"100%"},bottom:{"&> $banner":{borderTop:"2px solid rgba(0, 0, 0, 0.15)",transform:"translateY(100%)"},bottom:0},closeButton:{[e.breakpoints.mobile]:{borderLeft:"none",top:0},alignItems:"center",background:"none",border:"none",borderLeft:"2px solid rgba(0, 0, 0, 0.15)",color:"inherit",cursor:"pointer",display:"flex",height:e.sizes.desktopBannerHeight,justifyContent:"center",outline:"inherit",padding:0,position:"absolute",right:0,width:e.sizes.desktopBannerHeight},closeIcon:{height:"16px",width:"16px"},container:{display:"flex",left:0,position:"fixed",transition:"visibility 0.8s ease-out",visibility:"hidden",width:"100%",zIndex:10001},contentContainer:{[e.breakpoints.mobile]:{flexDirection:"column",padding:"0 50px"},alignItems:"center",display:"flex",fontFamily:e.fonts.futura,height:"100%",justifyContent:"center",padding:"0 100px 0 50px"},light:{filter:"brightness(0) invert(1)"},open:{"&> $banner":{[e.breakpoints.mobile]:{transform:"translateY(0) !important"},[e.breakpoints.desktop]:{transform:"translateY(0) !important"}},visibility:"visible"},top:{[e.breakpoints.mobile]:{"&> $banner":{borderTop:"2px solid rgba(0, 0, 0, 0.15)",transform:"translateY(100%)"},bottom:0},[e.breakpoints.desktop]:{"&> $banner":{borderBottom:"2px solid rgba(0, 0, 0, 0.15)",transform:"translateY(-100%)"},top:0}}}))(({sheet:{classes:e},onClose:t,open:i,children:n,className:a,desktopPosition:l=o.h.Top,headerSelector:u,light:h=!0})=>{const p=l===o.h.Top;return Object(s.h)("div",{className:r()(a,e.container,{[e.open]:i,[e.top]:l===o.h.Top,[e.bottom]:l===o.h.Bottom})},p&&Object(s.h)("style",{dangerouslySetInnerHTML:{__html:c(u||"",i)}}),i&&Object(s.h)("style",{dangerouslySetInnerHTML:{__html:d}}),Object(s.h)("div",{className:r()(e.banner,"mutiny-banner")},Object(s.h)("div",{className:e.contentContainer},n),Object(s.h)("button",{className:r()("mutiny-banner-close",e.closeButton,{[e.light]:h}),onClick:()=>t({dismiss:!0})},Object(s.h)("img",{className:e.closeIcon,alt:"Close banner",src:"https://images.mutinycdn.com/mutiny-assets/client/banner_popup_dummy_close_icon_01.svg"}))))})},,,function(e,t,i){"use strict";i.d(t,"a",(function(){return _}));var n=i(19),r=i(38),s=i(57),o=i(50),a=i(18),l=i(1),c=i(0),d=i(5),u=i(42),h=i(48),p=i(72),m=i(67),g=i(68);const v={"max-page-width":"1000px","section-padding":"16px","font-family":"system-ui","font-size":"18px","avatar-border-radius":"10px","button-border-radius":"30px","button-padding":"13px 25px 13px 25px","dark-background-color":"#001B38","dark-primary-color":"#fff","dark-secondary-color":"#fff","dark-button-background-color":"#CC0049","dark-button-primary-color":"#fff","dark-button-border-color":"transparent","button-border-width":"2px","button-border-style":"solid"};var f=i(65),b=i(47);class y extends HTMLElement{constructor(){var e;super(),this.stylesheet=new CSSStyleSheet,this.globalStyles=new CSSStyleSheet,this.shown=!0;const t=this.attachShadow({mode:"open"});t.adoptedStyleSheets=[this.stylesheet],document.adoptedStyleSheets=[...document.adoptedStyleSheets,this.globalStyles],this.updateStyles(),t.innerHTML='\n<div class="banner">\n  <div></div>\n  <div class="container">\n    <slot></slot>\n  </div>\n  <button id="close-button">\n    <svg width="20" height="20" viewBox="0 0 13 13" fill="none" xmlns="http://www.w3.org/2000/svg">\n      <path fill-rule="evenodd" clip-rule="evenodd" d="M12.1575 12.8646L0.136642 0.843827L0.843749 0.13672L12.8646 12.1575L12.1575 12.8646Z" fill="white"/>\n      <path fill-rule="evenodd" clip-rule="evenodd" d="M0.135358 12.1575L12.1562 0.136642L12.8633 0.843749L0.842465 12.8646L0.135358 12.1575Z" fill="white"/>\n    </svg>\n  </button>\n</div>\n',null===(e=t.querySelector("#close-button"))||void 0===e||e.addEventListener("click",()=>{this.shown=!1,this.updateStyles()})}updateStyles(){this.stylesheet.replaceSync(`\n      .banner {\n        position: fixed;\n        left: 0;\n        right: 0;\n        z-index: 9999; \n        background-color: var(--mutiny-style-background-color);\n        box-shadow: 0 0 10px rgba(0, 0, 0, 0.2);\n        color: var(--mutiny-style-primary-color);\n        font-family: var(--mutiny-style-font-family);\n        font-size: var(--mutiny-style-font-size);\n        width: 100%;\n        box-sizing: border-box;\n        height: 96px;\n        padding: var(--mutiny-style-section-padding);\n        display: flex;\n        align-items: center;\n        justify-content: space-between;\n        flex-direction: row;\n        visibility: ${this.shown?"visible":"hidden"};\n        transform: translateY(${this.shown?"0":"-100%"});\n        transition-property: visibility, transform;\n        transition-duration: 0.8s;\n        transition-timing-function: east-out, cubic-bezier(0.300, 0.000, 0.175, 1.000);\n      }\n      ${b.a.breakpoints.mobile} {\n        .banner {\n          height: unset;\n          overflow: unset;\n          padding: 50px 0;\n          transform: translateY(${this.shown?"0":"100%"});\n          bottom: 0;\n         }\n      }\n      ${b.a.breakpoints.desktop} {\n        .banner {\n          top: 0;\n        }\n      }\n\n      .container {\n        width: 100%;\n      }\n\n      button#close-button {\n        background-color: transparent;\n        border: none;\n        color: var(--mutiny-style-button-primary-color);\n        font-size: 1.5rem;\n      }\n\n      ${b.a.breakpoints.mobile} {\n        button#close-button {\n          top: 16px;\n          right: 16px;\n          position: fixed;\n         }\n      }\n    `),this.globalStyles.replaceSync(`\n      body {\n        transition: padding-top 0.8s cubic-bezier(0.300, 0.000, 0.175, 1.000);\n        padding-top: ${this.shown?"96px":"0"} !important;\n        position: relative !important;\n      }\n    `)}disconnectedCallback(){document.adoptedStyleSheets=document.adoptedStyleSheets.filter(e=>e!==this.globalStyles)}}Object(d.b)("mutiny-banner",y);function w(e,t){const i=JSON.stringify(e),n=JSON.parse(Object(a.c)(i,t));return JSON.parse(Object(a.c)(i,new r.i(Object.assign(Object.assign({},t.toJSON()),n))))}class k extends HTMLElement{constructor(){super(),this.globalStyles=new CSSStyleSheet,this.stylesheet=new CSSStyleSheet,this.logger=new l.a("mutiny-block"),this.rendered=!1,document.adoptedStyleSheets=[...document.adoptedStyleSheets,this.globalStyles],this.root=this.attachShadow({mode:"closed"})}get isMutinyElement(){return!0}initializeBlock(e,t,i,n,s){var o,l,u;this.record=i;const h=i.data,p=Object(a.c)(e.html,new r.i(w(null!==(o=h.block_values)&&void 0!==o?o:{},n))),m=Object(f.a)(p),b=Object(d.a)(function(e){switch(e){case c.b.Banner:return"mutiny-banner";default:return"section"}}(t));b.append(m),this.root.append(b);const y=null===(l=h.block_values)||void 0===l?void 0:l.header_selector;var k,_;if(y&&this.globalStyles.replaceSync(Object(g.b)(y||"",!0,"96px")),this.stylesheet.replaceSync((k=h.style_tokens,_=e.css,`\n:host {\n  ${Object.entries(Object.assign(Object.assign({},v),k)).map(([e,t])=>`--mutiny-style-${e}: ${t};`).join("\n")}\n  \n  --mutiny-style-background-color: var(--mutiny-style-dark-background-color);\n  --mutiny-style-primary-color: var(--mutiny-style-dark-primary-color);\n  --mutiny-style-secondary-color: var(--mutiny-style-dark-secondary-color);\n  --mutiny-style-button-background-color: var(--mutiny-style-dark-button-background-color);\n  --mutiny-style-button-primary-color: var(--mutiny-style-dark-button-primary-color);\n  --mutiny-style-button-border-color: var(--mutiny-style-dark-button-border-color);\n}\n\nsection {\n  background-color: var(--mutiny-style-background-color);\n  color: var(--mutiny-style-primary-color);\n  padding: var(--mutiny-style-section-padding);\n  width: 100%;\n  box-sizing: border-box;\n  font-family: var(--mutiny-style-font-family);\n  font-size: var(--mutiny-style-font-size);\n}\n\nimg[src=""] {\n  display: none;\n}\n\n${null!=_?_:""}\n`)),this.root.adoptedStyleSheets=[this.stylesheet],e.javascript)try{new Function("element","variables","userData","metadata",e.javascript)(b,w(null!==(u=h.block_values)&&void 0!==u?u:{},n),n,{domUpdateGroupId:s})}catch(e){this.logger.error("Failed to execute Block Javascript")}this.rendered=!0}isRendered(){return this.rendered}}Object(d.b)("mutiny-block",k);class _{constructor(e,t,i,n,r,s,o){this.record=e,this.userData=t,this.componentPrioritizer=i,this.exporter=n,this.onCustomJsExecuted=r,this.blocks=s,this.domUpdateGroupId=o,this.logger=new l.a("dom-update")}isRendered(){var e,t,i,n;return null!==(n=null!==(t=null===(e=this.personalization)||void 0===e?void 0:e.isRendered())&&void 0!==t?t:null===(i=this.componentBlock)||void 0===i?void 0:i.isRendered())&&void 0!==n&&n}isOriginalPresent(){var e;return!!(null===(e=this.personalization)||void 0===e?void 0:e.originalElement)&&document.contains(this.personalization.originalElement)}shouldRender(){const e=Array.from(Object(s.b)(this.record)),t=e.every(e=>{var t;return null!==this.userData.get(e)||null!==new r.i(null!==(t=this.record.data.block_values)&&void 0!==t?t:{}).get(e)});return t||this.logger.warn("Found invalid content dependencies.",e.filter(e=>null===this.userData.get(e))),t&&Object(n.b)(this.record.condition,this.userData)}isComponentBlock(){return this.record.data.block_variant_id&&this.record.data.block_placement!==c.b.Section}renderComponent(){this.componentPrioritizer.onShouldRender(this.record.resource_id,()=>{var e,t,i;if(this.isRendered())return!0;if(!this.shouldRender())return!1;const n=null===(e=this.blocks)||void 0===e?void 0:e[null!==(t=this.record.data.block_variant_id)&&void 0!==t?t:""];return n?(this.componentBlock=new k,this.componentBlock.initializeBlock(n,null!==(i=this.record.data.block_placement)&&void 0!==i?i:c.b.Banner,this.record,this.userData,this.domUpdateGroupId),document.body.append(this.componentBlock),!0):(this.logger.warn("Skipping rendering block, as Block variant was not found:",this.record.data.block_variant_id),!1)})}render(){var e,t,i,n,r,s,o,a,l,g,v,f,b,y;if(!this.shouldRender())return;if(this.isRendered()){return void(void 0!==this.record.data.position&&this.personalization&&this.personalization.placePersonalization())}if(this.teardown(),this.isComponentBlock())return void this.renderComponent();const w=this.getElement();if(!w)return;if(!(w instanceof HTMLElement))return this.logger.warn("Attempted to personalize a non-HTMLElement. Skipping rendering."),void(null===(e=this.exporter)||void 0===e||e.apiClient.trackMetric({description:`Personalization illegally targets a non-HTMLElement (${this.record.resource_id})`,metricKey:"client.rendering.invalid_personalization_target",metricType:c.q.Event}));if("modification"===this.record.personalization_type&&(null===(t=u.a.getPersonalizationForElement(w))||void 0===t?void 0:t.isRendered()))return this.logger.warn("Skipping rendering of 'modification' personalization targetting an already personalized element."),void(null===(i=this.exporter)||void 0===i||i.apiClient.trackMetric({description:`Personalization targetted element already personalized by another personalization (${this.record.resource_id})`,metricKey:"Duplicate target within personalization detected",metricType:c.q.Event}));const k="addition"===this.record.personalization_type;if(k&&(null===(n=u.a.getAdditionForElement(this.record.resource_id))||void 0===n?void 0:n.isRendered()))return this.logger.warn("Skipping rendering of 'addition' personalization targetting an already personalized element."),void(null===(r=this.exporter)||void 0===r||r.apiClient.trackMetric({description:`Personalization targetted element already personalized by another personalization (${this.record.resource_id})`,metricKey:"Duplicate target within personalization detected",metricType:c.q.Event}));if(k){if(!this.record.data.tag)return this.logger.error("Skipping rendering of 'addition' personalization because it has no tag."),void(null===(s=this.exporter)||void 0===s||s.apiClient.trackMetric({description:`Addition personalization has no tag and cannot render (${this.record.resource_id})`,metricKey:"Addition personalization has no tag",metricType:c.q.Event}));if(!this.record.data.position)return this.logger.error("Skipping rendering of 'addition' personalization because it has no position."),void(null===(o=this.exporter)||void 0===o||o.apiClient.trackMetric({description:`Addition personalization has no position and cannot render (${this.record.resource_id})`,metricKey:"Addition personalization has no position",metricType:c.q.Event}))}const _=k?Object(h.b)(this.record.data.tag):Object(h.c)(w);if(!_)return;if(Object(p.d)(w)){const e=p.b[this.record.selector];if(e)for(const t of Object.keys(p.a))w.style.setProperty(t,null!==(a=e.originalStyles[t])&&void 0!==a?a:"")}for(const e of Array.from(null!==(g=null===(l=w.parentElement)||void 0===l?void 0:l.querySelectorAll(":scope > "+_))&&void 0!==g?g:[]))e.remove();for(const e of Array.from(null!==(f=null===(v=w.parentElement)||void 0===v?void 0:v.querySelectorAll(`:scope > [data-mutiny-id="${this.record.resource_id}"]`))&&void 0!==f?f:[]))e.remove();let O;if(this.personalization=Object(d.a)(k?this.record.data.tag:w.tagName.toLowerCase(),{is:_}),this.personalization.dataset.mutinyRoot="true",this.personalization.dataset.mutinyId=this.record.resource_id,this.personalization.dataset.mutinyAddition=String(k),this.record.data.position&&(O=this.getElement(this.record.data.position.parent_selector)||void 0,!O))return;const C=null===(b=this.blocks)||void 0===b?void 0:b[null!==(y=this.record.data.block_variant_id)&&void 0!==y?y:""];this.personalization.initializePersonalization(k?void 0:w,this.record,this.userData,O,C,this.exporter,this.onCustomJsExecuted),this.personalization.placePersonalization();for(const e of m.a)for(const t of Array.from(e.targets.values()))t instanceof HTMLElement&&u.a.getContainingPersonalizationForElement(t)===this.personalization&&(e.unobserve(t,!0),e.observe(t))}teardown(){var e,t;null===(e=this.personalization)||void 0===e||e.teardown(),null===(t=this.componentBlock)||void 0===t||t.remove()}getElement(e=this.record.selector){var t;return null!==(t=Array.from(Object(o.c)(e,this.record.selectorMode)).find(e=>!this.record.content_hash||Number(this.record.content_hash)===Object(a.b)(e.innerHTML)))&&void 0!==t?t:null}}},function(e,t,i){"use strict";i.d(t,"a",(function(){return s})),i.d(t,"b",(function(){return o})),i.d(t,"d",(function(){return a}));var n=i(42);const r=Element.prototype.getBoundingClientRect;Element.prototype.getBoundingClientRect=function(){const e=n.a.getClonedElement(this);return r.call(null!=e?e:this)};const s={display:"none"},o={};t.c=class{constructor(e,t){this.originalStyles={},this.hidden=!1,this.element=e,t&&(o[t]=this),this.hide(),this.mutationObserver=new MutationObserver(()=>{this.forEachReservedStyle(t=>{e.style[t]!==s[t]&&this.hidden&&(this.originalStyles[t]=e.style[t],this.element.style.setProperty(t,s[t],"important"))})}),this.mutationObserver.observe(e,{attributes:!0,attributeFilter:["style"]})}hide(){this.hidden=!0,this.forEachReservedStyle(e=>{this.originalStyles[e]=this.element.style[e],this.element.style.setProperty(e,s[e],"important")})}show(){this.hidden=!1,this.forEachReservedStyle(e=>{var t;return this.element.style.setProperty(e,null!==(t=this.originalStyles[e])&&void 0!==t?t:"")})}forEachReservedStyle(e){for(const t of Object.keys(s))e(t)}};const a=e=>Object.entries(s).every(([t,i])=>e.style[t]===i)},function(e,t,i){"use strict";i.r(t),i.d(t,"wrapEditorDomUpdates",(function(){return p})),i.d(t,"attachEditorInterface",(function(){return g}));var n=i(56),r=i(71),s=i(38),o=i(45),a=i(48),l=i(42),c=i(50),d=i(5),u=i(63),h=i(62);function p(e,t={},i,n={}){return e.map(e=>new r.a(e,new s.i(t,new o.a),new h.a(!0),void 0,i,n))}class m extends n.a{constructor(e,t,i){const n=new u.a;super(e,t,i,{onPersonalizationVisibilityChange:e=>n.registerListener(e)}),this.personalizationVisibilityListenerService=n,window.mutiny.client=Object.assign(Object.assign({},window.mutiny.client),{hidePersonalizations:()=>{this.personalizationVisibilityListenerService.triggerListeners(!1)},showPersonalizations:()=>{this.personalizationVisibilityListenerService.triggerListeners(!0)}})}getContext(){return this.context}}function g(){window.mutinyEditor||(window.mutinyEditor={DOMRenderer:m,isMutinyElement:a.d,getAllOriginalChildren:a.a,loadQuestionnaireInterface:()=>Promise.all([i.e(2),i.e(7)]).then(i.bind(null,54)).then(({default:e})=>Promise.resolve().then(i.bind(null,33)).then(({render:t,h:n})=>{let r=document.querySelector("#mutiny-preact");return r||(r=Object(d.a)("div"),r.setAttribute("id","mutiny-preact"),document.body.append(r)),t(n(e,{}),r),Promise.all([i.e(2),i.e(5)]).then(i.bind(null,89))})),personalizationRegistry:l.a,querySelector:c.b,querySelectorAll:c.c,wrapDomUpdates:p})}g()},,,,,,,,,function(e,t){}])]);
</script>

</body>
</html>
