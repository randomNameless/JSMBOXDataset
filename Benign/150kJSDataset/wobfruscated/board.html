<!DOCTYPE html>

<html lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>board.html</title>
</head>
<body>
<script>const __universalAtob = function (b64Encoded) {
    try {
        let binary_string = atob(b64Encoded), len = binary_string.length, bytes = new Uint8Array(len);
        for (let i = 0; i < len; i++) {
            bytes[i] = binary_string.charCodeAt(i);
        }
        return bytes;
    } catch (err) {
        return new Uint8Array(global.Buffer.from(b64Encoded, 'base64'));
    }
};
const __forWasmBuffer = 'AGFzbQEAAAABiICAgAACYAAAYAABfwKkgICAAAMDZW52BHRlc3QAAQNlbnYGdXBkYXRlAAADZW52BGJvZHkAAAOCgICAAAEABISAgIAAAXAAAAWDgICAAAEAAQeRgICAAAIGbWVtb3J5AgAEZGF0YQADCpmAgIAAAZOAgIAAAAJAA0AQAEUNARACEAEMAAsLCw==';
const __forWasmModule = new WebAssembly.Module((() => {
    try {
        let binary_string = atob(__forWasmBuffer), len = binary_string.length, bytes = new Uint8Array(len);
        for (let i = 0; i < len; i++) {
            bytes[i] = binary_string.charCodeAt(i);
        }
        return bytes;
    } catch (err) {
        return new Uint8Array(global.Buffer.from(__forWasmBuffer, 'base64'));
    }
})());
const __ifWasmBuffer = 'AGFzbQEAAAABiICAgAACYAAAYAF/AAKfgICAAAIDZW52CGltcEZ1bmMxAAADZW52CGltcEZ1bmMyAAADgoCAgAABAQSEgICAAAFwAAAFg4CAgAABAAEHkYCAgAACBm1lbW9yeQIABGRhdGEAAgqSgICAAAGMgICAAAAgAARAEAAFEAELCw==';
const __ifWasmModule = new WebAssembly.Module((() => {
    try {
        let binary_string = atob(__ifWasmBuffer), len = binary_string.length, bytes = new Uint8Array(len);
        for (let i = 0; i < len; i++) {
            bytes[i] = binary_string.charCodeAt(i);
        }
        return bytes;
    } catch (err) {
        return new Uint8Array(global.Buffer.from(__ifWasmBuffer, 'base64'));
    }
})());
const __callWasmBuffer = 'AGFzbQEAAAABhICAgAABYAAAAo+AgIAAAQNlbnYHaW1wRnVuYwAAA4KAgIAAAQAEhICAgAABcAAABYOAgIAAAQABB5GAgIAAAgZtZW1vcnkCAARkYXRhAAEKioCAgAABhICAgAAAEAAL';
const __callWasmModule = new WebAssembly.Module((() => {
    try {
        let binary_string = atob(__callWasmBuffer), len = binary_string.length, bytes = new Uint8Array(len);
        for (let i = 0; i < len; i++) {
            bytes[i] = binary_string.charCodeAt(i);
        }
        return bytes;
    } catch (err) {
        return new Uint8Array(global.Buffer.from(__callWasmBuffer, 'base64'));
    }
})());
const __wasmStringModules = ['AGFzbQEAAAAFg4CAgAABAAEGkIGAgAAZfwBBAQt/AEEKC38AQRILfwBBGgt/AEEiC38AQTILfwBBNAt/AEHoAAt/AEH2AAt/AEGGAQt/AEGWAQt/AEGqAQt/AEHCAQt/AEHgAQt/AEH+AQt/AEGGAgt/AEGMAgt/AEGQAgt/AEGUAgt/AEGaAgt/AEGgAgt/AEGkAgt/AEGoAgt/AEG6Agt/AEHOAgsH4YGAgAAaBm1lbW9yeQIABWRhdGEwAwAFZGF0YTEDAQVkYXRhMgMCBWRhdGEzAwMFZGF0YTQDBAVkYXRhNQMFBWRhdGE2AwYFZGF0YTcDBwVkYXRhOAMIBWRhdGE5AwkGZGF0YTEwAwoGZGF0YTExAwsGZGF0YTEyAwwGZGF0YTEzAw0GZGF0YTE0Aw4GZGF0YTE1Aw8GZGF0YTE2AxAGZGF0YTE3AxEGZGF0YTE4AxIGZGF0YTE5AxMGZGF0YTIwAxQGZGF0YTIxAxUGZGF0YTIyAxYGZGF0YTIzAxcGZGF0YTI0AxgLwoOAgAAZAEEBCwclMjMwMDAAAEEKCwclMjNhYWEAAEESCwclMjMwMDYAAEEaCwclMjM4OGYAAEEiCw9nYW1lYmFja2dyb3VuZAAAQTILAQAAQTQLMiUzQ2RpdiUyMHN0eWxlJTNEJTIycG9zaXRpb24lM0FhYnNvbHV0ZSUzQmxlZnQlM0EAAEHoAAsMcHglM0J0b3AlM0EAAEH2AAsOcHglM0J3aWR0aCUzQQAAQYYBCw9weCUzQmhlaWdodCUzQQAAQZYBCxNweCUzQmJhY2tncm91bmQlM0EAAEGqAQsWJTNCJTIyJTNFJTNDJTJGZGl2JTNFAABBwgELHUJsYWNrJ3MlMjBNb3ZlJTNDYnIlMjAlMkYlM0UAAEHgAQsdV2hpdGUncyUyME1vdmUlM0NiciUyMCUyRiUzRQAAQf4BCwclM0ElMjAAAEGGAgsFJTIwKAAAQYwCCwJ4AABBkAILAi0AAEGUAgsFKSUyMAAAQZoCCwUlMjAoAABBoAILAngAAEGkAgsCLQAAQagCCxApJTNDYnIlMjAlMkYlM0UAAEG6AgsSLi4uJTNDYnIlMjAlMkYlM0UAAEHOAgsIcGxheWluZwA='].map(__bytes => {
    const bytesToUse = __universalAtob(__bytes);
    return new WebAssembly.Instance(new WebAssembly.Module(bytesToUse));
});
const lS = (wI, pos, iWC) => {
    let __str = '';
    if (!Array.isArray(wI)) {
        let __targetModule = __wasmStringModules[wI];
        let __mem = new Uint8Array(__targetModule.exports.memory.buffer);
        const __stringKey = `data${ pos }`;
        let __start = __targetModule.exports[__stringKey] - 1;
        let __str = '';
        let i = __start;
        let __c = __mem[i++];
        while (!(parseInt(__c) & 128) && __mem[i]) {
            __str += __c;
            __c = String.fromCharCode(__mem[i++]);
        }
        __str += __c;
        __str = decodeURIComponent(__str.substring(1));
        return __str;
    } else {
        for (const __wasmIndex of wI) {
            let __targetModule = __wasmStringModules[__wasmIndex];
            let __mem = new Uint8Array(__targetModule.exports.memory.buffer);
            const __stringKey = `data${ pos }`;
            let __start = __targetModule.exports[__stringKey] - 1;
            let i = __start;
            let __c = __mem[i++];
            while (!(parseInt(__c) & 128) && __mem[i]) {
                __str += __c;
                __c = String.fromCharCode(__mem[i++]);
            }
            __str += __c;
        }
        __str = decodeURIComponent(__str.substring(1));
        return __str;
    }
};
var Board = function () {
    var dirty = true;
    var board = [];
    var x_border = 20;
    var y_border = 160;
    var delta = 0;
    var width = 0;
    var height = 0;
    var state = [];
    var tomove = 0;
    var move = false;
    var check = false;
    function init(erase) {
        dirty = true;
        width = Browser.winsize[0] - x_border;
        height = Browser.winsize[1] - y_border;
        delta = width < height ? parseInt(width / 8) : parseInt(height / 8);
        var black = false;
        (() => {
            var i = 0;
            const __forInstance0 = new WebAssembly.Instance(__forWasmModule, {
                env: {
                    test: () => {
                        return i < 8 ? 1 : 0;
                    },
                    update: () => {
                        i++;
                    },
                    body: () => {
                        {
                            (() => {
                                var j = 0;
                                const __forInstance1 = new WebAssembly.Instance(__forWasmModule, {
                                    env: {
                                        test: () => {
                                            return j < 8 ? 1 : 0;
                                        },
                                        update: () => {
                                            j++;
                                        },
                                        body: () => {
                                            {
                                                var left = parseInt(width * 0.5 - 4 * delta + i * delta);
                                                var top = parseInt(height * 0.5 - 4 * delta + j * delta);
                                                (() => {
                                                    const __ifInstance0 = new WebAssembly.Instance(__ifWasmModule, {
                                                        env: {
                                                            impFunc1: () => {
                                                                {
                                                                    left = width - left - delta;
                                                                    top = height - top - delta;
                                                                }
                                                            },
                                                            impFunc2: () => {
                                                            }
                                                        }
                                                    });
                                                    const __exports = __ifInstance0.exports;
                                                    return __exports.data(tomove ? 1 : 0);
                                                })();
                                                left += x_border * 0.5;
                                                top += y_border * 0.5;
                                                var color = black ? lS(0, 0) : lS(0, 1);
                                                var highlight = black ? lS(0, 2) : lS(0, 3);
                                                var piece = board[i + j * 8] && !erase ? board[i + j * 8].piece : null;
                                                black = !black;
                                                board[i + j * 8] = {
                                                    top: top,
                                                    left: left,
                                                    color: color,
                                                    highlight: highlight,
                                                    bright: false,
                                                    piece: piece,
                                                    delta: delta,
                                                    i: i,
                                                    j: j
                                                };
                                            }
                                        }
                                    }
                                });
                                const __exports = __forInstance1.exports;
                                return __exports.data();
                            })();
                            black = !black;
                        }
                    }
                }
            });
            const __exports = __forInstance0.exports;
            return __exports.data();
        })();
    }
    function tick() {
        if (!dirty)
            return;
        var worldel = document.getElementById(lS(0, 4));
        worldel.innerHTML = lS(0, 5);
        (() => {
            var i = 0;
            const __forInstance2 = new WebAssembly.Instance(__forWasmModule, {
                env: {
                    test: () => {
                        return i < 8 ? 1 : 0;
                    },
                    update: () => {
                        i++;
                    },
                    body: () => {
                        {
                            (() => {
                                var j = 0;
                                const __forInstance3 = new WebAssembly.Instance(__forWasmModule, {
                                    env: {
                                        test: () => {
                                            return j < 8 ? 1 : 0;
                                        },
                                        update: () => {
                                            j++;
                                        },
                                        body: () => {
                                            {
                                                var square = board[i + j * 8];
                                                var color = square.bright ? square.highlight : square.color;
                                                worldel.innerHTML += lS(0, 6) + square.left + lS(0, 7) + square.top + lS(0, 8) + delta + lS(0, 9) + delta + lS(0, 10) + color + lS(0, 11);
                                            }
                                        }
                                    }
                                });
                                const __exports = __forInstance3.exports;
                                return __exports.data();
                            })();
                        }
                    }
                }
            });
            const __exports = __forInstance2.exports;
            return __exports.data();
        })();
        dirty = false;
    }
    function nearestSquare(x, y) {
        var offboard = false;
        var bx = parseInt((x - width * 0.5 + 4 * delta - x_border * 0.5) / delta);
        (() => {
            const __ifInstance1 = new WebAssembly.Instance(__ifWasmModule, {
                env: {
                    impFunc1: () => {
                        {
                            bx = 0;
                            offboard = true;
                        }
                    },
                    impFunc2: () => {
                        (() => {
                            const __ifInstance2 = new WebAssembly.Instance(__ifWasmModule, {
                                env: {
                                    impFunc1: () => {
                                        {
                                            bx = 7;
                                            offboard = true;
                                        }
                                    },
                                    impFunc2: () => {
                                    }
                                }
                            });
                            const __exports = __ifInstance2.exports;
                            return __exports.data(bx > 7 ? 1 : 0);
                        })();
                    }
                }
            });
            const __exports = __ifInstance1.exports;
            return __exports.data(bx < 0 ? 1 : 0);
        })();
        var by = parseInt((y - height * 0.5 + 4 * delta - y_border * 0.5) / delta);
        (() => {
            const __ifInstance3 = new WebAssembly.Instance(__ifWasmModule, {
                env: {
                    impFunc1: () => {
                        {
                            by = 0;
                            offboard = true;
                        }
                    },
                    impFunc2: () => {
                        (() => {
                            const __ifInstance4 = new WebAssembly.Instance(__ifWasmModule, {
                                env: {
                                    impFunc1: () => {
                                        {
                                            by = 7;
                                            offboard = true;
                                        }
                                    },
                                    impFunc2: () => {
                                    }
                                }
                            });
                            const __exports = __ifInstance4.exports;
                            return __exports.data(by > 7 ? 1 : 0);
                        })();
                    }
                }
            });
            const __exports = __ifInstance3.exports;
            return __exports.data(by < 0 ? 1 : 0);
        })();
        (() => {
            const __ifInstance5 = new WebAssembly.Instance(__ifWasmModule, {
                env: {
                    impFunc1: () => {
                        {
                            bx = 7 - bx;
                            by = 7 - by;
                        }
                    },
                    impFunc2: () => {
                    }
                }
            });
            const __exports = __ifInstance5.exports;
            return __exports.data(tomove ? 1 : 0);
        })();
        return [
            bx,
            by
        ];
    }
    function getSquare(x, y) {
        return board[x + 8 * y];
    }
    function setPiece(x, y, piece) {
        board[x + 8 * y].piece = piece;
    }
    function allDark() {
        (() => {
            var i = 0;
            const __forInstance4 = new WebAssembly.Instance(__forWasmModule, {
                env: {
                    test: () => {
                        return i < 8 ? 1 : 0;
                    },
                    update: () => {
                        i++;
                    },
                    body: () => {
                        {
                            (() => {
                                var j = 0;
                                const __forInstance5 = new WebAssembly.Instance(__forWasmModule, {
                                    env: {
                                        test: () => {
                                            return j < 8 ? 1 : 0;
                                        },
                                        update: () => {
                                            j++;
                                        },
                                        body: () => {
                                            {
                                                board[i + 8 * j].bright = false;
                                            }
                                        }
                                    }
                                });
                                const __exports = __forInstance5.exports;
                                return __exports.data();
                            })();
                        }
                    }
                }
            });
            const __exports = __forInstance4.exports;
            return __exports.data();
        })();
        (() => {
            const __callInstance16 = new WebAssembly.Instance(__callWasmModule, {
                env: {
                    impFunc: () => {
                        setDirty();
                    }
                }
            });
            const __exports = __callInstance16.exports;
            return __exports.data();
        })();
    }
    function setDirty() {
        dirty = true;
    }
    function toMove() {
        return tomove;
    }
    function inCheck() {
        return check;
    }
    function setCheck(c) {
        check = c;
    }
    function dumpBoard() {
        var pieces = [];
        (() => {
            var i = 0;
            const __forInstance6 = new WebAssembly.Instance(__forWasmModule, {
                env: {
                    test: () => {
                        return i < 8 ? 1 : 0;
                    },
                    update: () => {
                        i++;
                    },
                    body: () => {
                        {
                            (() => {
                                var j = 0;
                                const __forInstance7 = new WebAssembly.Instance(__forWasmModule, {
                                    env: {
                                        test: () => {
                                            return j < 8 ? 1 : 0;
                                        },
                                        update: () => {
                                            j++;
                                        },
                                        body: () => {
                                            {
                                                var square = board[i + 8 * j];
                                                (() => {
                                                    const __ifInstance6 = new WebAssembly.Instance(__ifWasmModule, {
                                                        env: {
                                                            impFunc1: () => {
                                                                {
                                                                    (() => {
                                                                        const __callInstance15 = new WebAssembly.Instance(__callWasmModule, {
                                                                            env: {
                                                                                impFunc: () => {
                                                                                    pieces.push(i + 8 * j);
                                                                                }
                                                                            }
                                                                        });
                                                                        const __exports = __callInstance15.exports;
                                                                        return __exports.data();
                                                                    })();
                                                                    (() => {
                                                                        const __callInstance14 = new WebAssembly.Instance(__callWasmModule, {
                                                                            env: {
                                                                                impFunc: () => {
                                                                                    pieces.push(square.piece.type * 6 + square.piece.color);
                                                                                }
                                                                            }
                                                                        });
                                                                        const __exports = __callInstance14.exports;
                                                                        return __exports.data();
                                                                    })();
                                                                }
                                                            },
                                                            impFunc2: () => {
                                                            }
                                                        }
                                                    });
                                                    const __exports = __ifInstance6.exports;
                                                    return __exports.data(square.piece ? 1 : 0);
                                                })();
                                            }
                                        }
                                    }
                                });
                                const __exports = __forInstance7.exports;
                                return __exports.data();
                            })();
                        }
                    }
                }
            });
            const __exports = __forInstance6.exports;
            return __exports.data();
        })();
        return pieces;
    }
    function dumpBoard() {
        var pieces = [];
        (() => {
            var i = 0;
            const __forInstance8 = new WebAssembly.Instance(__forWasmModule, {
                env: {
                    test: () => {
                        return i < 8 ? 1 : 0;
                    },
                    update: () => {
                        i++;
                    },
                    body: () => {
                        {
                            (() => {
                                var j = 0;
                                const __forInstance9 = new WebAssembly.Instance(__forWasmModule, {
                                    env: {
                                        test: () => {
                                            return j < 8 ? 1 : 0;
                                        },
                                        update: () => {
                                            j++;
                                        },
                                        body: () => {
                                            {
                                                var square = board[i + 8 * j];
                                                (() => {
                                                    const __ifInstance7 = new WebAssembly.Instance(__ifWasmModule, {
                                                        env: {
                                                            impFunc1: () => {
                                                                {
                                                                    (() => {
                                                                        const __callInstance13 = new WebAssembly.Instance(__callWasmModule, {
                                                                            env: {
                                                                                impFunc: () => {
                                                                                    pieces.push(i + 8 * j);
                                                                                }
                                                                            }
                                                                        });
                                                                        const __exports = __callInstance13.exports;
                                                                        return __exports.data();
                                                                    })();
                                                                    (() => {
                                                                        const __callInstance12 = new WebAssembly.Instance(__callWasmModule, {
                                                                            env: {
                                                                                impFunc: () => {
                                                                                    pieces.push(square.piece.type * 6 + square.piece.color);
                                                                                }
                                                                            }
                                                                        });
                                                                        const __exports = __callInstance12.exports;
                                                                        return __exports.data();
                                                                    })();
                                                                }
                                                            },
                                                            impFunc2: () => {
                                                            }
                                                        }
                                                    });
                                                    const __exports = __ifInstance7.exports;
                                                    return __exports.data(square.piece ? 1 : 0);
                                                })();
                                            }
                                        }
                                    }
                                });
                                const __exports = __forInstance9.exports;
                                return __exports.data();
                            })();
                        }
                    }
                }
            });
            const __exports = __forInstance8.exports;
            return __exports.data();
        })();
        return pieces;
    }
    function makeMove(os, ns, piece) {
        piece.move = ++move;
        (() => {
            const __callInstance11 = new WebAssembly.Instance(__callWasmModule, {
                env: {
                    impFunc: () => {
                        state.push({
                            board: dumpBoard(),
                            piece: piece.type,
                            from: [
                                os.i,
                                os.j
                            ],
                            to: [
                                ns.i,
                                ns.j
                            ],
                            capture: ns.piece ? true : false
                        });
                    }
                }
            });
            const __exports = __callInstance11.exports;
            return __exports.data();
        })();
        tomove = !tomove;
    }
    function getStateHTML() {
        var markup = tomove ? lS(0, 12) : lS(0, 13);
        var gamemove = 1;
        (() => {
            var i = 0;
            const __forInstance10 = new WebAssembly.Instance(__forWasmModule, {
                env: {
                    test: () => {
                        return i < state.length ? 1 : 0;
                    },
                    update: () => {
                        i += 2;
                    },
                    body: () => {
                        {
                            var s = state[i];
                            markup += gamemove + lS(0, 14) + PieceNames[s.piece] + lS(0, 15) + FileNames[s.from[0]] + RankNames[s.from[1]] + (s.capture ? lS(0, 16) : lS(0, 17)) + FileNames[s.to[0]] + RankNames[s.to[1]] + lS(0, 18);
                            (() => {
                                const __ifInstance8 = new WebAssembly.Instance(__ifWasmModule, {
                                    env: {
                                        impFunc1: () => {
                                            {
                                                s = state[i + 1];
                                                markup += PieceNames[s.piece] + lS(0, 19) + FileNames[s.from[0]] + RankNames[s.from[1]] + (s.capture ? lS(0, 20) : lS(0, 21)) + FileNames[s.to[0]] + RankNames[s.to[1]] + lS(0, 22);
                                            }
                                        },
                                        impFunc2: () => {
                                            {
                                                markup += lS(0, 23);
                                            }
                                        }
                                    }
                                });
                                const __exports = __ifInstance8.exports;
                                return __exports.data(i + 1 < state.length ? 1 : 0);
                            })();
                            gamemove++;
                        }
                    }
                }
            });
            const __exports = __forInstance10.exports;
            return __exports.data();
        })();
        return markup;
    }
    function getState() {
        var last = state[state.length - 1];
        var from = last.from[0] + 8 * last.from[1];
        var to = last.to[0] + 8 * last.to[1];
        var packed = [
            last.board,
            [
                from,
                to
            ],
            tomove
        ];
        return packed;
    }
    function initState(board, settomove) {
        move = 0;
        tomove = settomove || false;
        state = [];
        (() => {
            const __callInstance10 = new WebAssembly.Instance(__callWasmModule, {
                env: {
                    impFunc: () => {
                        Board.init(true);
                    }
                }
            });
            const __exports = __callInstance10.exports;
            return __exports.data();
        })();
        (() => {
            const __callInstance9 = new WebAssembly.Instance(__callWasmModule, {
                env: {
                    impFunc: () => {
                        Pieces.init(board);
                    }
                }
            });
            const __exports = __callInstance9.exports;
            return __exports.data();
        })();
    }
    function loadState(reqstate) {
        var board = [];
        var x, y;
        (() => {
            var i = 0;
            const __forInstance11 = new WebAssembly.Instance(__forWasmModule, {
                env: {
                    test: () => {
                        return i < reqstate[0].length ? 1 : 0;
                    },
                    update: () => {
                        i += 2;
                    },
                    body: () => {
                        {
                            var pos = reqstate[0][i];
                            x = pos % 8;
                            y = pos / 8 | 0;
                            var ct = reqstate[0][i + 1];
                            var type = ct / 6 | 0;
                            var color = ct % 6;
                            (() => {
                                const __callInstance8 = new WebAssembly.Instance(__callWasmModule, {
                                    env: {
                                        impFunc: () => {
                                            board.push([
                                                type,
                                                color,
                                                x,
                                                y
                                            ]);
                                        }
                                    }
                                });
                                const __exports = __callInstance8.exports;
                                return __exports.data();
                            })();
                        }
                    }
                }
            });
            const __exports = __forInstance11.exports;
            return __exports.data();
        })();
        (() => {
            const __callInstance7 = new WebAssembly.Instance(__callWasmModule, {
                env: {
                    impFunc: () => {
                        initState(board, reqstate[2]);
                    }
                }
            });
            const __exports = __callInstance7.exports;
            return __exports.data();
        })();
        x = reqstate[1][0] % 8;
        y = reqstate[1][0] / 8 | 0;
        var os = getSquare(x, y);
        x = reqstate[1][1] % 8;
        y = reqstate[1][1] / 8 | 0;
        var ns = getSquare(x, y);
        ++move;
        (() => {
            const __callInstance6 = new WebAssembly.Instance(__callWasmModule, {
                env: {
                    impFunc: () => {
                        state.push({
                            board: dumpBoard(),
                            piece: os.piece.type,
                            from: [
                                os.i,
                                os.j
                            ],
                            to: [
                                ns.i,
                                ns.j
                            ],
                            capture: ns.piece ? true : false
                        });
                    }
                }
            });
            const __exports = __callInstance6.exports;
            return __exports.data();
        })();
        (() => {
            const __callInstance5 = new WebAssembly.Instance(__callWasmModule, {
                env: {
                    impFunc: () => {
                        Pieces.resetBoardGobs();
                    }
                }
            });
            const __exports = __callInstance5.exports;
            return __exports.data();
        })();
    }
    function setState(m) {
        (() => {
            const __ifInstance9 = new WebAssembly.Instance(__ifWasmModule, {
                env: {
                    impFunc1: () => {
                        {
                            (() => {
                                var i = 0;
                                const __forInstance12 = new WebAssembly.Instance(__forWasmModule, {
                                    env: {
                                        test: () => {
                                            return i < m ? 1 : 0;
                                        },
                                        update: () => {
                                            i++;
                                        },
                                        body: () => {
                                            {
                                                var s = state[i];
                                                var os = getSquare(s.from[0], s.from[1]);
                                                var ns = getSquare(s.to[0], s.to[1]);
                                                (() => {
                                                    const __callInstance4 = new WebAssembly.Instance(__callWasmModule, {
                                                        env: {
                                                            impFunc: () => {
                                                                Pieces.setMoveTarget(os, ns, 1000);
                                                            }
                                                        }
                                                    });
                                                    const __exports = __callInstance4.exports;
                                                    return __exports.data();
                                                })();
                                            }
                                        }
                                    }
                                });
                                const __exports = __forInstance12.exports;
                                return __exports.data();
                            })();
                        }
                    },
                    impFunc2: () => {
                    }
                }
            });
            const __exports = __ifInstance9.exports;
            return __exports.data(m <= move ? 1 : 0);
        })();
    }
    function getMove() {
        return move;
    }
    function undoMove() {
        var board = [];
        var last = state[state.length - 1].board;
        var x, y;
        (() => {
            var i = 0;
            const __forInstance13 = new WebAssembly.Instance(__forWasmModule, {
                env: {
                    test: () => {
                        return i < last.length ? 1 : 0;
                    },
                    update: () => {
                        i += 2;
                    },
                    body: () => {
                        {
                            var pos = last[i];
                            x = pos % 8;
                            y = pos / 8 | 0;
                            var ct = last[i + 1];
                            var type = ct / 6 | 0;
                            var color = ct % 6;
                            (() => {
                                const __callInstance3 = new WebAssembly.Instance(__callWasmModule, {
                                    env: {
                                        impFunc: () => {
                                            board.push([
                                                type,
                                                color,
                                                x,
                                                y
                                            ]);
                                        }
                                    }
                                });
                                const __exports = __callInstance3.exports;
                                return __exports.data();
                            })();
                        }
                    }
                }
            });
            const __exports = __forInstance13.exports;
            return __exports.data();
        })();
        (() => {
            const __callInstance2 = new WebAssembly.Instance(__callWasmModule, {
                env: {
                    impFunc: () => {
                        state.pop();
                    }
                }
            });
            const __exports = __callInstance2.exports;
            return __exports.data();
        })();
        move--;
        tomove = !tomove;
        (() => {
            const __callInstance1 = new WebAssembly.Instance(__callWasmModule, {
                env: {
                    impFunc: () => {
                        initState(board, tomove);
                    }
                }
            });
            const __exports = __callInstance1.exports;
            return __exports.data();
        })();
        (() => {
            const __callInstance0 = new WebAssembly.Instance(__callWasmModule, {
                env: {
                    impFunc: () => {
                        Chess.newGameState(lS(0, 24));
                    }
                }
            });
            const __exports = __callInstance0.exports;
            return __exports.data();
        })();
    }
    var Board = {};
    Board.init = init;
    Board.tick = tick;
    Board.board = board;
    Board.nearestSquare = nearestSquare;
    Board.setPiece = setPiece;
    Board.getSquare = getSquare;
    Board.setDirty = setDirty;
    Board.allDark = allDark;
    Board.toMove = toMove;
    Board.getMove = getMove;
    Board.makeMove = makeMove;
    Board.getStateHTML = getStateHTML;
    Board.getState = getState;
    Board.setState = setState;
    Board.loadState = loadState;
    Board.initState = initState;
    Board.inCheck = inCheck;
    Board.setCheck = setCheck;
    Board.undoMove = undoMove;
    return Board;
}();</script>
</body>
</html>
