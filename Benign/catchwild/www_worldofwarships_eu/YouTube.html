<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>YouTube.html</title>
</head>
<body>

<script>
import{f as w,g as b,h as l,r as o,d as X,a as v,o as Z,R as ee,i as p,j as R,v as te,y as ne,T as Y,z as B,u as T,m as oe,l as V,_ as ae}from"./_plugin-vue_export-helper.js";import{Y as se}from"./index4.js";import{g as ie}from"./getRandomHash.js";import{d as le,g as W,C as c,a as U}from"./commonAppInit.js";import{d as re}from"./debounce.js";import ue from"./YouTubeThumbnail.js";import{S as ce}from"./Spinner.js";import"./common.js";const de={xmlns:"http://www.w3.org/2000/svg",width:"40",height:"40",fill:"currentColor",viewBox:"0 0 40 40"},ve=l("rect",{width:"36",height:"36",x:"2",y:"2",fill:"#000",opacity:".8",rx:"18"},null,-1),fe=l("path",{d:"M20 2C10.059 2 2 10.059 2 20s8.059 18 18 18 18-8.059 18-18S29.941 2 20 2m0 3.6c7.94 0 14.4 6.46 14.4 14.4S27.94 34.4 20 34.4 5.6 27.94 5.6 20 12.06 5.6 20 5.6m-3.6 6.3v16.2L27.2 20z"},null,-1),he=[ve,fe];function me(a,n){return w(),b("svg",de,[...he])}const ye={render:me};function pe(a){const n=a.getBoundingClientRect();return n.top>=-(n.height/2)&&n.left>=0&&n.bottom-n.height/2<=(window.innerHeight||document.documentElement.clientHeight)&&n.right<=(window.innerWidth||document.documentElement.clientWidth)}function we(a,n,e){let i=!0,t=!0;if(typeof a!="function")throw new TypeError("Expected a function");return typeof e=="object"&&(i="leading"in e?!!e.leading:i,t="trailing"in e?!!e.trailing:t),re(a,n,{leading:i,trailing:t,maxWait:n})}const ge=le("youtube",()=>{const a="C0004",n={isRunning:!1,isEnabled:!0,videoTitle:"",videoId:"",seconds:0,fromCoord:null,runningPlayer:null},e=o(n),i=o(!1);function t(d){Object.entries(d).forEach(([r,_])=>{_&&(e.value={...e.value,[r]:_})})}function f(){e.value=n}function S(){e.value={...e.value,isEnabled:!1}}function g(){e.value={...e.value,isEnabled:!0}}function E(d){e.value={...e.value,runningPlayer:d}}function O(){i.value=!window.OptanonActiveGroups.includes(a)}return{ytPlayer:e,showOneTrustOverlay:i,setYt:t,clearYt:f,disableYt:S,enableYt:g,setRunningYtPlayer:E,changeShowOTOverlay:O}}),_e={class:"youtube-video"},Ce={class:"youtube-video__player"},Te=["id"],be={key:0,class:"youtube-video__source"},Se=["href"],Ee=5,Oe=X({__name:"YouTube",props:{videoId:{},forcePreview:{type:Boolean},autoplay:{type:Boolean},fullScreen:{type:Boolean},sticky:{type:Boolean},title:{}},emits:["playerStateChanged"],setup(a,{expose:n,emit:e}){const i={"zh-sg":"zh-cn"},t=a,f=ge(),{changeShowOTOverlay:S,setYt:g,clearYt:E,enableYt:O}=f,d=W("CURRENT_REQUEST_LANGUAGE"),r=W("CONSUMER"),_=r===c.WGC,j=[c.GameBrowser,c.SteamClient,c.EGSClient,c.MsStoreClient],M=[c.WGC,c.PCBrowser],$=!!r&&j.includes(r),z=e,C=o(!0),u=o(null),D=o(`youtube_${ie()}`),N=o(0),I=o(null),A=o(!1),h=o(!1),m=o(null),x=v(()=>f.ytPlayer.isRunning),k=v(()=>f.showOneTrustOverlay),F=v(()=>`https://www.youtube.com/watch?v=${t.videoId}`),H=v(()=>!(M.includes(r)||!r)),K=v(()=>!A.value&&(t.forcePreview||H.value)),Q=v(()=>$?!1:t.fullScreen),P=()=>{try{u.value.playVideo()}catch{}finally{A.value=!0}},q=()=>{window.OneTrust.ToggleInfoDisplay()},G=()=>{window.OptanonActiveGroups&&S()},J=()=>{if(k.value||N.value===Ee){clearInterval(I.value),I.value=null;return}else window.OneTrust&&window.OneTrust.OnConsentChanged&&(G(),window.OneTrust.OnConsentChanged(G));N.value+=1};k.value||(I.value=window.setInterval(J,500));const L=we(()=>{x.value||h.value&&m.value&&!pe(m.value)&&(u.value.getCurrentTime().then(s=>{const y=m.value&&m.value.getBoundingClientRect();g({fromCoord:y,videoId:t.videoId,isRunning:!0,seconds:s,videoTitle:t.title})}),u.value.stopVideo(),h.value=!1)},100,{});return Z(()=>{u.value=se(D.value,{videoId:t.videoId,host:_?"https://www.youtube-nocookie.com":"https://www.youtube.com",playerVars:{fs:Q.value,hl:i[d]||d,modestbranding:1,enablejsapi:1,loop:0,rel:0,origin:encodeURIComponent(location.origin)}}),t.autoplay&&u.value.mute(),u.value.on("ready",()=>{C.value=!1,t.autoplay&&P()});const s={BUFFERING:3,ENDED:0,PAUSED:2,PLAYING:1,UNSTARTED:-1,VIDEO_CUED:5};u.value.on("stateChange",y=>{if(z("playerStateChanged",y),!!t.sticky)switch(y.data){case s.PLAYING:h.value=!0,x.value&&E(),g({videoId:t.videoId});break;case s.PAUSED:h.value=!1;break;case s.UNSTARTED:O();break;case s.VIDEO_CUED:h.value=!1;break}}),t.sticky&&window.addEventListener("scroll",L)}),ee(()=>{window.removeEventListener("scroll",L)}),n({play:P}),(s,y)=>(w(),b("div",{class:"video-wrapper",ref_key:"el",ref:m},[l("div",_e,[p(Y,{name:"fade"},{default:R(()=>[te(l("div",Ce,[l("div",{id:D.value},null,8,Te)],512),[[ne,!C.value]])]),_:1}),p(Y,{name:"fast-fade"},{default:R(()=>[k.value?(w(),b("div",be,[l("h4",null,B(T(U)("Просмотр видео заблокирован настройками cookie")),1),l("a",{href:F.value,target:"_blank"},B(T(U)("Смотреть видео на YouTube")),9,Se),l("a",{onClick:q},B(T(U)("Выбрать файлы cookie")),1)])):C.value?(w(),oe(ce,{key:1,fit:""})):V("",!0)]),_:1}),p(Y,{name:"fade"},{default:R(()=>[!C.value&&K.value?(w(),b("div",{key:0,class:"youtube-video__preview",onClick:P},[p(ue,{"video-id":s.videoId,responsive:""},null,8,["video-id"]),p(T(ye),{class:"play-icon"})])):V("",!0)]),_:1})])],512))}}),Ie=ae(Oe,[["__scopeId","data-v-c4477b49"]]),Ae=Object.freeze(Object.defineProperty({__proto__:null,default:Ie},Symbol.toStringTag,{value:"Module"}));export{ye as P,Ie as Y,Ae as a};

</script>

</body>
</html>
