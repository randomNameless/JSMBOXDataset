<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>plugindestaquesservico.html</title>
</head>
<body>

<script>
var PST=PST||{};PST.DestaquesServico={ctx:void 0,collListItem:void 0,Buscar:function(){PST.DestaquesServico.ctx=new SP.ClientContext;var e=(PST.DestaquesServico.ctx.get_web(),PST.DestaquesServico.ctx.get_web().get_lists().getByTitle("Destaques de Serviços"));PST.DestaquesServico.ctx.load(e);var t=new SP.CamlQuery;t.set_viewXml("<View><Query><OrderBy><FieldRef Name='Ordem' Ascending='True' /></OrderBy></Query><RowLimit>4</RowLimit></View>"),PST.DestaquesServico.collListItem=e.getItems(t),PST.DestaquesServico.ctx.load(PST.DestaquesServico.collListItem),PST.DestaquesServico.ctx.executeQueryAsync(Function.createDelegate(this,PST.DestaquesServico.onQuerySucceeded),Function.createDelegate(this,PST.DestaquesServico.onQueryFailed))},GetItems:function(){for(var e,t=[],i=[],s=PST.DestaquesServico.collListItem.getEnumerator();s.moveNext();)t={Titulo:(e=s.get_current()).get_item("Title"),Icone:e.get_item("Icone"),Descricao:e.get_item("Descricao"),Link:e.get_item("Link").get_url(),Ordem:e.get_item("Ordem"),AbrirLink:e.get_item("AbrirLink")},i.push(t);PST.DestaquesServico.MontarAviso(i)},MontarAviso:function(e){$.get("/BibliotecaDeScripts/TemplateHTML/TemplateDestaquesServico.html",function(t){var i=_.template(t)({Conteudo:e});$("#secaoDestaquesServico").append(i)})},onQuerySucceeded:function(e,t){PST.DestaquesServico.GetItems()},onQueryFailed:function(e,t){console.log("Não foi possível recuperar os dados de avisos")}},$(document).ready(function(){_.templateSettings={interpolate:/\{\{(.+?)\}\}/g,evaluate:/\{%([\s\S]+?)%\}/g,escape:/\{%-([\s\S]+?)%\}/g},SP.SOD.loadMultiple(["SP.Runtime.js","SP.js"],function(){PST.DestaquesServico.Buscar()})});
</script>

</body>
</html>
