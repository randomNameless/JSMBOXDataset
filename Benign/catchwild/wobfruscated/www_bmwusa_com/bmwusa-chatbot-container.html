<!DOCTYPE html>

<html lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>bmwusa-chatbot-container.html</title>
</head>
<body>
<script>/*! BMWUSA Vite Build 1731603678170 */
var Ee=Object.defineProperty;var Ie=(n,e,t)=>e in n?Ee(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var _=(n,e,t)=>(Ie(n,typeof e!="symbol"?e+"":e,t),t),We=(n,e,t)=>{if(!e.has(n))throw TypeError("Cannot "+t)};var F=(n,e,t)=>{if(e.has(n))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(n):e.set(n,t)};var I=(n,e,t)=>(We(n,e,"access private method"),t);import{C as De}from"/etc.clientlibs/bmwusa/clientlibs/clientlib-site/bmwusa-clientlibs/bmwusa-chunks/resources/component.js";import{V as ye}from"/etc.clientlibs/bmwusa/clientlibs/clientlib-site/bmwusa-clientlibs/bmwusa-chunks/resources/vue.esm.js";import{i as be,n as b,m as te,a as Oe}from"/etc.clientlibs/bmwusa/clientlibs/clientlib-site/bmwusa-clientlibs/bmwusa-chunks/resources/_plugin-vue2_normalizer.js";import{d as he}from"/etc.clientlibs/bmwusa/clientlibs/clientlib-site/bmwusa-clientlibs/bmwusa-chunks/resources/display-status-label.js";import{f as Pe,$}from"/etc.clientlibs/bmwusa/clientlibs/clientlib-site/bmwusa-clientlibs/bmwusa-measurement-data.js";import"/etc.clientlibs/bmwusa/clientlibs/clientlib-site/bmwusa-clientlibs/bmwusa-chunks/resources/index.js";import"/etc.clientlibs/bmwusa/clientlibs/clientlib-site/bmwusa-clientlibs/bmwusa-chunks/resources/index.esm.js";import"/etc.clientlibs/bmwusa/clientlibs/clientlib-site/bmwusa-clientlibs/bmwusa-chunks/resources/is-author.js";import"/etc.clientlibs/bmwusa/clientlibs/clientlib-site/bmwusa-clientlibs/bmwusa-chunks/resources/baseDomain.js";import"/etc.clientlibs/bmwusa/clientlibs/clientlib-site/bmwusa-clientlibs/bmwusa-chunks/resources/getbyourl.js";import"/etc.clientlibs/bmwusa/clientlibs/clientlib-site/bmwusa-clientlibs/bmwusa-chunks/resources/scroll-to.js";import"/etc.clientlibs/bmwusa/clientlibs/clientlib-site/bmwusa-clientlibs/bmwusa-chunks/resources/uid.js";import"/etc.clientlibs/bmwusa/clientlibs/clientlib-site/bmwusa-clientlibs/bmwusa-chunks/resources/zipcode.js";ye.use(be);const H=new be.Store({state(){return{logs:[],chats:[],showLoading:!0,userID:null,isDotMenuOpen:!1,isLegalModalOpen:!1,isLegalAccepted:!1,isPopupOpen:!1,currentIntention:"",pageContext:{},currentContext:{path:"/vehicles/all-electric/i7/sedan/electric-bmw-m.html",pageType:"PDP",vehicleContext:{seriesName:"i7",bodyStyleName:"Sedan",modelName:"i7 M70"}},vehicleContexts:[{seriesName:"i7",bodyStyleName:"Sedan",modelName:"i7 M70"},{seriesName:"X1",bodyStyleName:"SUV",modelName:"X1 xDrive28i"},{seriesName:"3 Series",bodyStyleName:"Sedan",modelName:"330i xDrive Sedan"}],legalText:'By using the chatbot, you agree (1) to be bound by the BMW <a href="https://www.bmwusa.com/content/dam/bmw/common/footer/pdf/BMW-Terms-20240613.pdf.asset.1720805387970.pdf" target="_blank"><b>Terms</b></a> and <a href="https://my.bmwusa.com/privacypolicy" target="_blank"><b>Privacy Policy</b></a> that govern the use of this generative AI chatbot; (2) that we may use third-party service providers to provide the chatbot; and (3) that we may record and store your interactions with the chatbot.',hasSdkError:!1,hasWhizError:!1}},getters:{chats:n=>n.chats,isLegalModalOpen:n=>n.isLegalModalOpen,isLegalAccepted:n=>n.isLegalAccepted,isDotMenuOpen:n=>n.isDotMenuOpen,showLoading:n=>n.showLoading,currentIntention:n=>n.currentIntention,logs:n=>n.logs,legalText:n=>n.legalText,hasSdkError:n=>n.hasSdkError,hasWhizError:n=>n.hasWhizError},mutations:{addLog(n,e){n.logs.push(e)},addChat(n,e){n.chats.push(e)},addChatHistory(n,e){n.chats=e},clearAll(n){n.logs=[],n.chats=[]},showLoading(n,e){n.showLoading=e},setUserID(n,e){n.userID=e},updatePageContext(n,e){n.pageContext=e},updateIsDotMenuOpen(n,e){n.isDotMenuOpen=e},updateLegalModalStatus(n,e){n.isLegalModalOpen=e},updateLegalAcceptedStatus(n,e){n.isLegalAccepted=e},updatePopupStatus(n,e){n.isPopupOpen=e},setCurrentIntention(n,e){n.currentIntention=e},setHasSdkError(n,e){n.hasSdkError=e},setHasWhizError(n,e){n.hasWhizError=e}},actions:{addLog({commit:n},e){n("addLog",e)},addChat({commit:n,dispatch:e},t){var s,i,a,r;(s=t.entry.text)!=null&&s.includes("Predicted intent")||(n("addChat",t),t.isWhizMessage?e("setCurrentIntention",(r=(a=(i=t==null?void 0:t.entry.metadata)==null?void 0:i.chatState)==null?void 0:a.latestIntent)==null?void 0:r.name):e("setCurrentIntention","user_message"))},addChatHistory({commit:n,dispatch:e},t){var i,a,r,o,l;const s=t.map(c=>({entry:{text:c.isWhizMessage?c.text:c.message,message_id:c.messageId,timestamp:c.timestamp,metadata:c.metadata,from_history:!0},widgets:c.widgets,isWhizMessage:c.isWhizMessage})).reverse();n("addChatHistory",s),(i=s[s.length-1])!=null&&i.isWhizMessage?e("setCurrentIntention",(l=(o=(r=(a=s[s.length-1])==null?void 0:a.entry.metadata)==null?void 0:r.chatState)==null?void 0:o.latestIntent)==null?void 0:l.name):e("setCurrentIntention","user_message")},clearAll({commit:n}){n("clearAll")},showLoading({commit:n},e){n("showLoading",e)},getUserID({commit:n}){let e;localStorage.getItem("user_id")?e=localStorage.getItem("user_id"):(e=userIDUtil.generateUserID(),localStorage.setItem("user_id",e)),n("setUserID",e)},updatePageContext({commit:n},e){n("updatePageContext",e)},updateIsDotMenuOpen({commit:n},e){n("updateIsDotMenuOpen",e)},updateLegalModalOpen({commit:n},e){n("updateLegalModalStatus",e)},updateLegalAccepted({commit:n},e){n("updateLegalAcceptedStatus",e)},updatePopupOpen({commit:n},e){n("updatePopupStatus",e)},setCurrentIntention({commit:n},e){n("setCurrentIntention",e)},setHasSdkError({commit:n},e){n("setHasSdkError",e)},setHasWhizError({commit:n},e){n("setHasWhizError",e)}}});class Be{async init(){if(this.store=H,this.ai=window.ai,window.ai)this.store.dispatch("addLog",{msg:"AutoIntel SDK Loaded",isError:!1}),this.store.dispatch("addLog",{msg:`User ID: ${this.ai.user.id}`,isError:!1});else{this.store.dispatch("addLog",{msg:"Error! AutoIntel SDK  Not Loaded",isError:!0}),this.store.dispatch("setHasSdkError",!0),window._satellite&&window._satellite.track("AA_DC_ChatbotError");return}window.location.hostname!=="www.bmwusa.com"&&this.ai.enableStaging();const t=document.querySelector("#bmwusa-chatbot").getAttribute("data-whiz-secret");this.ai.whiz.setSecret(t),this.store.dispatch("addLog",{msg:`User ID: ${this.userID}`,isError:!1}),this.store.dispatch("addLog",{msg:"Creating Whiz Chat Session...",isError:!1}),this.ai.whiz.onConnect(()=>{this.store.dispatch("addLog",{msg:"Whiz Chat Session Initiated",isError:!1}),this.getHistory()}),this.ai.whiz.onDisconnect(()=>{this.store.dispatch("addLog",{msg:"Whiz Chat Session Disconnected",isError:!1})}),this.ai.whiz.onMessage(i=>{var o,l,c,d,h,g,u,p,y,w,v,z,C,T,A,ce,de;i.text.includes("Something went wrong")&&window._satellite&&window._satellite.track("AA_DC_ChatbotError"),(o=i.metadata)!=null&&o.showLoader||this.store.dispatch("showLoading",!1);const a=i.text?i.text:"";this.store.dispatch("addLog",{msg:`WhizMessage Received: ${a.substr(0,40)}...`,isError:!1}),(d=(c=(l=i.metadata)==null?void 0:l.chatState)==null?void 0:c.latestIntent)!=null&&d.name&&this.store.dispatch("addLog",{msg:`Intent: ${(u=(g=(h=i.metadata)==null?void 0:h.chatState)==null?void 0:g.latestIntent)==null?void 0:u.name}, Confidence: ${(w=(y=(p=i.metadata)==null?void 0:p.chatState)==null?void 0:y.latestIntent)==null?void 0:w.confidence}`,isError:!1}),((C=(z=(v=i.metadata)==null?void 0:v.replyTo)==null?void 0:z.entities)==null?void 0:C.length)>1&&i.metadata.replyTo.entities.forEach(q=>{this.store.dispatch("addLog",{msg:`Entity: ${q.entity}, Value: ${q.value}`,isError:!1})});let r=[];if(((T=i.widgets)==null?void 0:T.length)>0&&(r=i.widgets,this.store.dispatch("addLog",{msg:"WhizWidget Received",isError:!1})),this.store.dispatch("addChat",{entry:{text:a,message_id:i.messageId,timestamp:i.timestamp,metadata:i.metadata},widgets:r,isWhizMessage:!0}),((de=(ce=(A=i.metadata)==null?void 0:A.chatState)==null?void 0:ce.latestIntent)==null?void 0:de.name)==="session_start"&&this.ai.user.firstTimeUser){const q=this.store.getters.legalText;this.store.dispatch("addChat",{entry:{text:q,message_id:"frontend_legal",timestamp:i.timestamp,metadata:i.metadata},widgets:[],isWhizMessage:!0})}}),this.ai.whiz.onError(i=>{window._satellite&&window._satellite.track("AA_DC_ChatbotError"),this.store.dispatch("addLog",{msg:`Error ${i.errorCode}: ${i.message}`,isError:!0})});const s=/iPhone|iPad|iPod|Android/i.test(navigator.userAgent)?"Mobile":"Desktop";this.setPageContext(),this.ai.whiz.connect({pageContext:this.store.state.pageContext,language:"en",deviceType:s}).then(i=>{})}async getHistory(){this.store.dispatch("addLog",{msg:"Getting Chat History...",isError:!1}),this.ai.whiz.chat.getHistory().then(e=>{this.store.dispatch("addChatHistory",e),this.store.dispatch("showLoading",!1)})}getSeries(){var e,t,s,i;if(window.BMWdataLayer.page.primarySection==="build your own"){const a=document.querySelector(".chatbot-button");window.BMWdataLayer.page.pageLevel2==="series"&&(a.setAttribute("data-current-series",""),a.setAttribute("data-current-model",""));let r=a.getAttribute("data-current-series");return r?(r=r.slice(-2)=="-M"?r.slice(0,-2):r,/^\d$/.test(r)&&(r=`${r} Series`),r):(t=(e=window.BMWdataLayer.product)==null?void 0:e.detail)==null?void 0:t.series}return(i=(s=window.BMWdataLayer.product)==null?void 0:s.detail)==null?void 0:i.series}setPageContext(){var u,p,y,w,v,z,C;const e=window.BMWdataLayer,t=e.page.path,s=e.page.primarySection,i=(u=e.product.detail)==null?void 0:u.vin,a=(p=e.product.detail)==null?void 0:p.buildCode,r=this.getSeries(),o=(y=e.product.detail)==null?void 0:y.body,l=s==="build your own"?document.querySelector(".chatbot-button").getAttribute("data-current-model")||((w=e.product.detail)==null?void 0:w.name):(v=e.product.detail)==null?void 0:v.name,c=e.user.location,d=(z=e.user.selectedDealer)==null?void 0:z.DealerCenterID,h=(C=e.user.selectedDealer)==null?void 0:C.DealerName,g={path:t,pageType:s||"",vehicle:{...i&&{vin:i},...a&&{build_id:a},...r&&{series:r},...o&&{bodystyle:o},...l&&{model:l}},location:{...c&&{zipcode:c},...d&&{dealer_number:d},...h&&{dealer_name:h}}};this.store.dispatch("updatePageContext",g)}async clearHistory(){this.store.dispatch("addLog",{msg:"Clearing Chat History...",isError:!1}),this.store.dispatch("showLoading",!0);const e=/iPhone|iPad|iPod|Android/i.test(navigator.userAgent)?"Mobile":"Desktop";this.ai.whiz.chat.clearHistory().then(t=>{this.store.dispatch("showLoading",!1),this.store.dispatch("clearAll"),this.ai.whiz.disconnect(),this.ai.whiz.connect({pageContext:this.store.state.pageContext,language:"en",deviceType:e})})}async sendUserMessage(e){const t=Date.now();this.store.dispatch("addLog",{msg:`Sending User Message: ${e.substr(0,10)}...`,isError:!1}),this.store.dispatch("showLoading",!0),this.store.dispatch("addChat",{entry:{text:e,timestamp:t},isWhizMessage:!1}),this.ai.whiz.chat.sendUserMessage({message:String(e),timestamp:t})}async executeUserReplyAction(e){this.store.dispatch("addLog",{msg:`Sending User Action: ${e.data.reply}`,isError:!1}),this.store.dispatch("showLoading",!0),ai.whiz.chat.executeUserReplyAction(e)}async updateConnection(){this.store.dispatch("addLog",{msg:"Updating User Context",isError:!1}),this.setPageContext(),ai.whiz.chat.updateConnection({pageContext:this.store.state.pageContext})}async sendFeedback(e,t,s){this.ai.whiz.chat.sendFeedback({messageId:t,sentiment:e,comment:s||""}),this.store.dispatch("addLog",{msg:`Sending Feedback: ${e} to message: ${t} comment: ${s||"No Comment"}`,isError:!1})}async sendTextFeedback(e,t){this.ai.whiz.chat.sendFeedback({messageId:t,comment:e}),this.store.dispatch("addLog",{msg:`Sending Text Feedback: ${e} to message: ${t}`,isError:!1})}printLogs(){this.store.getters.logs.forEach((t,s)=>{console.log(s,t.msg)})}}const x=new Be;const Ue={name:"WhizButton",props:{ctaType:{type:String,default:"button"},theme:{type:String,default:"white"},size:{type:String,default:"md"},href:{type:String},ariaLabel:{type:String}},methods:{isExternal(n){return!n.includes("bmwusa.com")}}};var Ne=function(){var e=this,t=e._self._c;return e.ctaType==="anchor"?t("a",{class:[`whiz-button__${e.theme}`,`whiz-button__${e.size}`,"whiz-button","whiz-anchor"],attrs:{href:e.href,target:e.isExternal(e.href)?"_blank":!1,"aria-label":e.ariaLabel,title:e.ariaLabel,"analytics-on":"","analytics-event":`chatbot.${e.href}.link`}},[e._t("default")],2):t("button",{class:[`whiz-button__${e.theme}`,`whiz-button__${e.size}`,"whiz-button"],attrs:{title:e.ariaLabel,"aria-label":e.ariaLabel}},[e._t("default")],2)},qe=[],Fe=b(Ue,Ne,qe,!1,null,"a0c9bf38",null,null);const E=Fe.exports;const Ve={name:"DynamicModal",computed:{},props:{visibility:{type:Boolean,default:!1},modalType:{type:String}},methods:{closeModal(){this.$emit("closeModal"),this.modalType==="legalModal"&&this.$store.dispatch("updateLegalModalOpen",!1)},handleShadowClick(n){this.$refs.modalShadow&&this.$refs.modalShadow.contains(n.target)&&this.closeModal()},handleEscKey(n){(n.key==="Escape"||n.keyCode===27)&&this.closeModal()}},watch:{visibility(n){const e=document.querySelector(".chatbot-container.active");n?(document.addEventListener("click",this.handleShadowClick,{capture:!0}),document.addEventListener("keydown",this.handleEscKey,{capture:!0}),e.style.overflow="hidden"):(document.removeEventListener("click",this.handleShadowClick,{capture:!0}),document.removeEventListener("keydown",this.handleEscKey,{capture:!0}),e.style.overflow="auto")}}};var He=function(){var e=this,t=e._self._c;return t("div",{staticClass:"modal-container",attrs:{"aria-modal":"true"}},[t("div",{ref:"modalShadow",staticClass:"modal-shadow"}),t("div",{staticClass:"modal-content"},[t("button",{staticClass:"modal-close-button",on:{click:e.closeModal}},[t("svg",{attrs:{"aria-hidden":"true"}},[t("use",{attrs:{"xmlns:xlink":"http://www.w3.org/1999/xlink","xlink:href":"#icon-minimize"}})])]),t("div",{staticClass:"header-container"},[e._t("header")],2),t("div",{staticClass:"divider"}),t("div",{staticClass:"main-container"},[e._t("main")],2),t("div",{staticClass:"footer-container"},[e._t("footer")],2)])])},Ze=[],je=b(Ve,He,Ze,!1,null,null,null,null);const G=je.exports;const Ye={name:"ClearHistoryContents",components:{WhizModal:G,WhizButton:E},data(){return{cleanHistoryVisible:!1}},methods:{close(){this.cleanHistoryVisible=!1},clearHistory(){x.clearHistory(),this.$store.dispatch("updatePopupOpen",!1),this.$store.dispatch("updateLegalAccepted",!1),this.close()},showModal(){this.cleanHistoryVisible=!0}}};var Ke=function(){var e=this,t=e._self._c;return t("div",{directives:[{name:"show",rawName:"v-show",value:e.cleanHistoryVisible,expression:"cleanHistoryVisible"}],staticClass:"clear-history-container"},[t("WhizModal",{attrs:{visibility:e.cleanHistoryVisible},on:{closeModal:e.close},scopedSlots:e._u([{key:"header",fn:function(){return[t("h3",{staticClass:"modal-title"},[e._v("Clear & Start Over?")])]},proxy:!0},{key:"main",fn:function(){return[t("p",{staticClass:"modal-description"},[e._v("This action will clear your entire chat history and start a new conversation. Are you sure you want to continue?")])]},proxy:!0},{key:"footer",fn:function(){return[t("div",{staticClass:"cta-container"},[t("WhizButton",{attrs:{theme:"black"},nativeOn:{click:function(s){return e.clearHistory.apply(null,arguments)}}},[t("svg",{staticClass:"bin-icon",attrs:{"aria-hidden":"true"}},[t("use",{attrs:{"xmlns:xlink":"http://www.w3.org/1999/xlink","xlink:href":"#icon-garbage-bin"}})]),e._v(" Yes, clear ")]),t("WhizButton",{attrs:{theme:"white"},nativeOn:{click:function(s){return e.close.apply(null,arguments)}}},[e._v("No, cancel")])],1)]},proxy:!0}])})],1)},Qe=[],Ge=b(Ye,Ke,Qe,!1,null,"84d0fe88",null,null);const Xe=Ge.exports;function se(){return{async:!1,breaks:!1,extensions:null,gfm:!0,hooks:null,pedantic:!1,renderer:null,silent:!1,tokenizer:null,walkTokens:null}}let R=se();function we(n){R=n}const ve=/[&<>"']/,Je=new RegExp(ve.source,"g"),ke=/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/,et=new RegExp(ke.source,"g"),tt={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},ue=n=>tt[n];function k(n,e){if(e){if(ve.test(n))return n.replace(Je,ue)}else if(ke.test(n))return n.replace(et,ue);return n}const st=/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/ig;function it(n){return n.replace(st,(e,t)=>(t=t.toLowerCase(),t==="colon"?":":t.charAt(0)==="#"?t.charAt(1)==="x"?String.fromCharCode(parseInt(t.substring(2),16)):String.fromCharCode(+t.substring(1)):""))}const nt=/(^|[^\[])\^/g;function f(n,e){let t=typeof n=="string"?n:n.source;e=e||"";const s={replace:(i,a)=>{let r=typeof a=="string"?a:a.source;return r=r.replace(nt,"$1"),t=t.replace(i,r),s},getRegex:()=>new RegExp(t,e)};return s}function pe(n){try{n=encodeURI(n).replace(/%25/g,"%")}catch{return null}return n}const O={exec:()=>null};function ge(n,e){const t=n.replace(/\|/g,(a,r,o)=>{let l=!1,c=r;for(;--c>=0&&o[c]==="\\";)l=!l;return l?"|":" |"}),s=t.split(/ \|/);let i=0;if(s[0].trim()||s.shift(),s.length>0&&!s[s.length-1].trim()&&s.pop(),e)if(s.length>e)s.splice(e);else for(;s.length<e;)s.push("");for(;i<s.length;i++)s[i]=s[i].trim().replace(/\\\|/g,"|");return s}function W(n,e,t){const s=n.length;if(s===0)return"";let i=0;for(;i<s;){const a=n.charAt(s-i-1);if(a===e&&!t)i++;else if(a!==e&&t)i++;else break}return n.slice(0,s-i)}function at(n,e){if(n.indexOf(e[1])===-1)return-1;let t=0;for(let s=0;s<n.length;s++)if(n[s]==="\\")s++;else if(n[s]===e[0])t++;else if(n[s]===e[1]&&(t--,t<0))return s;return-1}function me(n,e,t,s){const i=e.href,a=e.title?k(e.title):null,r=n[1].replace(/\\([\[\]])/g,"$1");if(n[0].charAt(0)!=="!"){s.state.inLink=!0;const o={type:"link",raw:t,href:i,title:a,text:r,tokens:s.inlineTokens(r)};return s.state.inLink=!1,o}return{type:"image",raw:t,href:i,title:a,text:k(r)}}function rt(n,e){const t=n.match(/^(\s+)(?:```)/);if(t===null)return e;const s=t[1];return e.split(`
`).map(i=>{const a=i.match(/^\s+/);if(a===null)return i;const[r]=a;return r.length>=s.length?i.slice(s.length):i}).join(`
`)}class Z{constructor(e){_(this,"options");_(this,"rules");_(this,"lexer");this.options=e||R}space(e){const t=this.rules.block.newline.exec(e);if(t&&t[0].length>0)return{type:"space",raw:t[0]}}code(e){const t=this.rules.block.code.exec(e);if(t){const s=t[0].replace(/^ {1,4}/gm,"");return{type:"code",raw:t[0],codeBlockStyle:"indented",text:this.options.pedantic?s:W(s,`
`)}}}fences(e){const t=this.rules.block.fences.exec(e);if(t){const s=t[0],i=rt(s,t[3]||"");return{type:"code",raw:s,lang:t[2]?t[2].trim().replace(this.rules.inline.anyPunctuation,"$1"):t[2],text:i}}}heading(e){const t=this.rules.block.heading.exec(e);if(t){let s=t[2].trim();if(/#$/.test(s)){const i=W(s,"#");(this.options.pedantic||!i||/ $/.test(i))&&(s=i.trim())}return{type:"heading",raw:t[0],depth:t[1].length,text:s,tokens:this.lexer.inline(s)}}}hr(e){const t=this.rules.block.hr.exec(e);if(t)return{type:"hr",raw:W(t[0],`
`)}}blockquote(e){const t=this.rules.block.blockquote.exec(e);if(t){let s=W(t[0],`
`).split(`
`),i="",a="";const r=[];for(;s.length>0;){let o=!1;const l=[];let c;for(c=0;c<s.length;c++)if(/^ {0,3}>/.test(s[c]))l.push(s[c]),o=!0;else if(!o)l.push(s[c]);else break;s=s.slice(c);const d=l.join(`
`),h=d.replace(/\n {0,3}((?:=+|-+) *)(?=\n|$)/g,`
    $1`).replace(/^ {0,3}>[ \t]?/gm,"");i=i?`${i}
${d}`:d,a=a?`${a}
${h}`:h;const g=this.lexer.state.top;if(this.lexer.state.top=!0,this.lexer.blockTokens(h,r,!0),this.lexer.state.top=g,s.length===0)break;const u=r[r.length-1];if((u==null?void 0:u.type)==="code")break;if((u==null?void 0:u.type)==="blockquote"){const p=u,y=p.raw+`
`+s.join(`
`),w=this.blockquote(y);r[r.length-1]=w,i=i.substring(0,i.length-p.raw.length)+w.raw,a=a.substring(0,a.length-p.text.length)+w.text;break}else if((u==null?void 0:u.type)==="list"){const p=u,y=p.raw+`
`+s.join(`
`),w=this.list(y);r[r.length-1]=w,i=i.substring(0,i.length-u.raw.length)+w.raw,a=a.substring(0,a.length-p.raw.length)+w.raw,s=y.substring(r[r.length-1].raw.length).split(`
`);continue}}return{type:"blockquote",raw:i,tokens:r,text:a}}}list(e){let t=this.rules.block.list.exec(e);if(t){let s=t[1].trim();const i=s.length>1,a={type:"list",raw:"",ordered:i,start:i?+s.slice(0,-1):"",loose:!1,items:[]};s=i?`\\d{1,9}\\${s.slice(-1)}`:`\\${s}`,this.options.pedantic&&(s=i?s:"[*+-]");const r=new RegExp(`^( {0,3}${s})((?:[	 ][^\\n]*)?(?:\\n|$))`);let o=!1;for(;e;){let l=!1,c="",d="";if(!(t=r.exec(e))||this.rules.block.hr.test(e))break;c=t[0],e=e.substring(c.length);let h=t[2].split(`
`,1)[0].replace(/^\t+/,v=>" ".repeat(3*v.length)),g=e.split(`
`,1)[0],u=!h.trim(),p=0;if(this.options.pedantic?(p=2,d=h.trimStart()):u?p=t[1].length+1:(p=t[2].search(/[^ ]/),p=p>4?1:p,d=h.slice(p),p+=t[1].length),u&&/^ *$/.test(g)&&(c+=g+`
`,e=e.substring(g.length+1),l=!0),!l){const v=new RegExp(`^ {0,${Math.min(3,p-1)}}(?:[*+-]|\\d{1,9}[.)])((?:[ 	][^\\n]*)?(?:\\n|$))`),z=new RegExp(`^ {0,${Math.min(3,p-1)}}((?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$)`),C=new RegExp(`^ {0,${Math.min(3,p-1)}}(?:\`\`\`|~~~)`),T=new RegExp(`^ {0,${Math.min(3,p-1)}}#`);for(;e;){const A=e.split(`
`,1)[0];if(g=A,this.options.pedantic&&(g=g.replace(/^ {1,4}(?=( {4})*[^ ])/g,"  ")),C.test(g)||T.test(g)||v.test(g)||z.test(e))break;if(g.search(/[^ ]/)>=p||!g.trim())d+=`
`+g.slice(p);else{if(u||h.search(/[^ ]/)>=4||C.test(h)||T.test(h)||z.test(h))break;d+=`
`+g}!u&&!g.trim()&&(u=!0),c+=A+`
`,e=e.substring(A.length+1),h=g.slice(p)}}a.loose||(o?a.loose=!0:/\n *\n *$/.test(c)&&(o=!0));let y=null,w;this.options.gfm&&(y=/^\[[ xX]\] /.exec(d),y&&(w=y[0]!=="[ ] ",d=d.replace(/^\[[ xX]\] +/,""))),a.items.push({type:"list_item",raw:c,task:!!y,checked:w,loose:!1,text:d,tokens:[]}),a.raw+=c}a.items[a.items.length-1].raw=a.items[a.items.length-1].raw.trimEnd(),a.items[a.items.length-1].text=a.items[a.items.length-1].text.trimEnd(),a.raw=a.raw.trimEnd();for(let l=0;l<a.items.length;l++)if(this.lexer.state.top=!1,a.items[l].tokens=this.lexer.blockTokens(a.items[l].text,[]),!a.loose){const c=a.items[l].tokens.filter(h=>h.type==="space"),d=c.length>0&&c.some(h=>/\n.*\n/.test(h.raw));a.loose=d}if(a.loose)for(let l=0;l<a.items.length;l++)a.items[l].loose=!0;return a}}html(e){const t=this.rules.block.html.exec(e);if(t)return{type:"html",block:!0,raw:t[0],pre:t[1]==="pre"||t[1]==="script"||t[1]==="style",text:t[0]}}def(e){const t=this.rules.block.def.exec(e);if(t){const s=t[1].toLowerCase().replace(/\s+/g," "),i=t[2]?t[2].replace(/^<(.*)>$/,"$1").replace(this.rules.inline.anyPunctuation,"$1"):"",a=t[3]?t[3].substring(1,t[3].length-1).replace(this.rules.inline.anyPunctuation,"$1"):t[3];return{type:"def",tag:s,raw:t[0],href:i,title:a}}}table(e){const t=this.rules.block.table.exec(e);if(!t||!/[:|]/.test(t[2]))return;const s=ge(t[1]),i=t[2].replace(/^\||\| *$/g,"").split("|"),a=t[3]&&t[3].trim()?t[3].replace(/\n[ \t]*$/,"").split(`
`):[],r={type:"table",raw:t[0],header:[],align:[],rows:[]};if(s.length===i.length){for(const o of i)/^ *-+: *$/.test(o)?r.align.push("right"):/^ *:-+: *$/.test(o)?r.align.push("center"):/^ *:-+ *$/.test(o)?r.align.push("left"):r.align.push(null);for(let o=0;o<s.length;o++)r.header.push({text:s[o],tokens:this.lexer.inline(s[o]),header:!0,align:r.align[o]});for(const o of a)r.rows.push(ge(o,r.header.length).map((l,c)=>({text:l,tokens:this.lexer.inline(l),header:!1,align:r.align[c]})));return r}}lheading(e){const t=this.rules.block.lheading.exec(e);if(t)return{type:"heading",raw:t[0],depth:t[2].charAt(0)==="="?1:2,text:t[1],tokens:this.lexer.inline(t[1])}}paragraph(e){const t=this.rules.block.paragraph.exec(e);if(t){const s=t[1].charAt(t[1].length-1)===`
`?t[1].slice(0,-1):t[1];return{type:"paragraph",raw:t[0],text:s,tokens:this.lexer.inline(s)}}}text(e){const t=this.rules.block.text.exec(e);if(t)return{type:"text",raw:t[0],text:t[0],tokens:this.lexer.inline(t[0])}}escape(e){const t=this.rules.inline.escape.exec(e);if(t)return{type:"escape",raw:t[0],text:k(t[1])}}tag(e){const t=this.rules.inline.tag.exec(e);if(t)return!this.lexer.state.inLink&&/^<a /i.test(t[0])?this.lexer.state.inLink=!0:this.lexer.state.inLink&&/^<\/a>/i.test(t[0])&&(this.lexer.state.inLink=!1),!this.lexer.state.inRawBlock&&/^<(pre|code|kbd|script)(\s|>)/i.test(t[0])?this.lexer.state.inRawBlock=!0:this.lexer.state.inRawBlock&&/^<\/(pre|code|kbd|script)(\s|>)/i.test(t[0])&&(this.lexer.state.inRawBlock=!1),{type:"html",raw:t[0],inLink:this.lexer.state.inLink,inRawBlock:this.lexer.state.inRawBlock,block:!1,text:t[0]}}link(e){const t=this.rules.inline.link.exec(e);if(t){const s=t[2].trim();if(!this.options.pedantic&&/^</.test(s)){if(!/>$/.test(s))return;const r=W(s.slice(0,-1),"\\");if((s.length-r.length)%2===0)return}else{const r=at(t[2],"()");if(r>-1){const l=(t[0].indexOf("!")===0?5:4)+t[1].length+r;t[2]=t[2].substring(0,r),t[0]=t[0].substring(0,l).trim(),t[3]=""}}let i=t[2],a="";if(this.options.pedantic){const r=/^([^'"]*[^\s])\s+(['"])(.*)\2/.exec(i);r&&(i=r[1],a=r[3])}else a=t[3]?t[3].slice(1,-1):"";return i=i.trim(),/^</.test(i)&&(this.options.pedantic&&!/>$/.test(s)?i=i.slice(1):i=i.slice(1,-1)),me(t,{href:i&&i.replace(this.rules.inline.anyPunctuation,"$1"),title:a&&a.replace(this.rules.inline.anyPunctuation,"$1")},t[0],this.lexer)}}reflink(e,t){let s;if((s=this.rules.inline.reflink.exec(e))||(s=this.rules.inline.nolink.exec(e))){const i=(s[2]||s[1]).replace(/\s+/g," "),a=t[i.toLowerCase()];if(!a){const r=s[0].charAt(0);return{type:"text",raw:r,text:r}}return me(s,a,s[0],this.lexer)}}emStrong(e,t,s=""){let i=this.rules.inline.emStrongLDelim.exec(e);if(!i||i[3]&&s.match(/[\p{L}\p{N}]/u))return;if(!(i[1]||i[2]||"")||!s||this.rules.inline.punctuation.exec(s)){const r=[...i[0]].length-1;let o,l,c=r,d=0;const h=i[0][0]==="*"?this.rules.inline.emStrongRDelimAst:this.rules.inline.emStrongRDelimUnd;for(h.lastIndex=0,t=t.slice(-1*e.length+r);(i=h.exec(t))!=null;){if(o=i[1]||i[2]||i[3]||i[4]||i[5]||i[6],!o)continue;if(l=[...o].length,i[3]||i[4]){c+=l;continue}else if((i[5]||i[6])&&r%3&&!((r+l)%3)){d+=l;continue}if(c-=l,c>0)continue;l=Math.min(l,l+c+d);const g=[...i[0]][0].length,u=e.slice(0,r+i.index+g+l);if(Math.min(r,l)%2){const y=u.slice(1,-1);return{type:"em",raw:u,text:y,tokens:this.lexer.inlineTokens(y)}}const p=u.slice(2,-2);return{type:"strong",raw:u,text:p,tokens:this.lexer.inlineTokens(p)}}}}codespan(e){const t=this.rules.inline.code.exec(e);if(t){let s=t[2].replace(/\n/g," ");const i=/[^ ]/.test(s),a=/^ /.test(s)&&/ $/.test(s);return i&&a&&(s=s.substring(1,s.length-1)),s=k(s,!0),{type:"codespan",raw:t[0],text:s}}}br(e){const t=this.rules.inline.br.exec(e);if(t)return{type:"br",raw:t[0]}}del(e){const t=this.rules.inline.del.exec(e);if(t)return{type:"del",raw:t[0],text:t[2],tokens:this.lexer.inlineTokens(t[2])}}autolink(e){const t=this.rules.inline.autolink.exec(e);if(t){let s,i;return t[2]==="@"?(s=k(t[1]),i="mailto:"+s):(s=k(t[1]),i=s),{type:"link",raw:t[0],text:s,href:i,tokens:[{type:"text",raw:s,text:s}]}}}url(e){var s;let t;if(t=this.rules.inline.url.exec(e)){let i,a;if(t[2]==="@")i=k(t[0]),a="mailto:"+i;else{let r;do r=t[0],t[0]=((s=this.rules.inline._backpedal.exec(t[0]))==null?void 0:s[0])??"";while(r!==t[0]);i=k(t[0]),t[1]==="www."?a="http://"+t[0]:a=t[0]}return{type:"link",raw:t[0],text:i,href:a,tokens:[{type:"text",raw:i,text:i}]}}}inlineText(e){const t=this.rules.inline.text.exec(e);if(t){let s;return this.lexer.state.inRawBlock?s=t[0]:s=k(t[0]),{type:"text",raw:t[0],text:s}}}}const ot=/^(?: *(?:\n|$))+/,lt=/^( {4}[^\n]+(?:\n(?: *(?:\n|$))*)?)+/,ct=/^ {0,3}(`{3,}(?=[^`\n]*(?:\n|$))|~{3,})([^\n]*)(?:\n|$)(?:|([\s\S]*?)(?:\n|$))(?: {0,3}\1[~`]* *(?=\n|$)|$)/,U=/^ {0,3}((?:-[\t ]*){3,}|(?:_[ \t]*){3,}|(?:\*[ \t]*){3,})(?:\n+|$)/,dt=/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,xe=/(?:[*+-]|\d{1,9}[.)])/,Ce=f(/^(?!bull |blockCode|fences|blockquote|heading|html)((?:.|\n(?!\s*?\n|bull |blockCode|fences|blockquote|heading|html))+?)\n {0,3}(=+|-+) *(?:\n+|$)/).replace(/bull/g,xe).replace(/blockCode/g,/ {4}/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).getRegex(),ie=/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html|table| +\n)[^\n]+)*)/,ht=/^[^\n]+/,ne=/(?!\s*\])(?:\\.|[^\[\]\\])+/,ut=f(/^ {0,3}\[(label)\]: *(?:\n *)?([^<\s][^\s]*|<.*?>)(?:(?: +(?:\n *)?| *\n *)(title))? *(?:\n+|$)/).replace("label",ne).replace("title",/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/).getRegex(),pt=f(/^( {0,3}bull)([ \t][^\n]+?)?(?:\n|$)/).replace(/bull/g,xe).getRegex(),X="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|search|section|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul",ae=/<!--(?:-?>|[\s\S]*?(?:-->|$))/,gt=f("^ {0,3}(?:<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n *)+\\n|$)|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$)|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$))","i").replace("comment",ae).replace("tag",X).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex(),$e=f(ie).replace("hr",U).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("|table","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",X).getRegex(),mt=f(/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/).replace("paragraph",$e).getRegex(),re={blockquote:mt,code:lt,def:ut,fences:ct,heading:dt,hr:U,html:gt,lheading:Ce,list:pt,newline:ot,paragraph:$e,table:O,text:ht},fe=f("^ *([^\\n ].*)\\n {0,3}((?:\\| *)?:?-+:? *(?:\\| *:?-+:? *)*(?:\\| *)?)(?:\\n((?:(?! *\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)").replace("hr",U).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("blockquote"," {0,3}>").replace("code"," {4}[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",X).getRegex(),ft={...re,table:fe,paragraph:f(ie).replace("hr",U).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("table",fe).replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",X).getRegex()},_t={...re,html:f(`^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:"[^"]*"|'[^']*'|\\s[^'"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))`).replace("comment",ae).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^(#{1,6})(.*)(?:\n+|$)/,fences:O,lheading:/^(.+?)\n {0,3}(=+|-+) *(?:\n+|$)/,paragraph:f(ie).replace("hr",U).replace("heading",` *#{1,6} *[^
]`).replace("lheading",Ce).replace("|table","").replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").replace("|tag","").getRegex()},Se=/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,yt=/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,Me=/^( {2,}|\\)\n(?!\s*$)/,bt=/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,N="\\p{P}\\p{S}",wt=f(/^((?![*_])[\spunctuation])/,"u").replace(/punctuation/g,N).getRegex(),vt=/\[[^[\]]*?\]\([^\(\)]*?\)|`[^`]*?`|<[^<>]*?>/g,kt=f(/^(?:\*+(?:((?!\*)[punct])|[^\s*]))|^_+(?:((?!_)[punct])|([^\s_]))/,"u").replace(/punct/g,N).getRegex(),xt=f("^[^_*]*?__[^_*]*?\\*[^_*]*?(?=__)|[^*]+(?=[^*])|(?!\\*)[punct](\\*+)(?=[\\s]|$)|[^punct\\s](\\*+)(?!\\*)(?=[punct\\s]|$)|(?!\\*)[punct\\s](\\*+)(?=[^punct\\s])|[\\s](\\*+)(?!\\*)(?=[punct])|(?!\\*)[punct](\\*+)(?!\\*)(?=[punct])|[^punct\\s](\\*+)(?=[^punct\\s])","gu").replace(/punct/g,N).getRegex(),Ct=f("^[^_*]*?\\*\\*[^_*]*?_[^_*]*?(?=\\*\\*)|[^_]+(?=[^_])|(?!_)[punct](_+)(?=[\\s]|$)|[^punct\\s](_+)(?!_)(?=[punct\\s]|$)|(?!_)[punct\\s](_+)(?=[^punct\\s])|[\\s](_+)(?!_)(?=[punct])|(?!_)[punct](_+)(?!_)(?=[punct])","gu").replace(/punct/g,N).getRegex(),$t=f(/\\([punct])/,"gu").replace(/punct/g,N).getRegex(),St=f(/^<(scheme:[^\s\x00-\x1f<>]*|email)>/).replace("scheme",/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/).replace("email",/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/).getRegex(),Mt=f(ae).replace("(?:-->|$)","-->").getRegex(),zt=f("^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>").replace("comment",Mt).replace("attribute",/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/).getRegex(),j=/(?:\[(?:\\.|[^\[\]\\])*\]|\\.|`[^`]*`|[^\[\]\\`])*?/,Tt=f(/^!?\[(label)\]\(\s*(href)(?:\s+(title))?\s*\)/).replace("label",j).replace("href",/<(?:\\.|[^\n<>\\])+>|[^\s\x00-\x1f]*/).replace("title",/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/).getRegex(),ze=f(/^!?\[(label)\]\[(ref)\]/).replace("label",j).replace("ref",ne).getRegex(),Te=f(/^!?\[(ref)\](?:\[\])?/).replace("ref",ne).getRegex(),Lt=f("reflink|nolink(?!\\()","g").replace("reflink",ze).replace("nolink",Te).getRegex(),oe={_backpedal:O,anyPunctuation:$t,autolink:St,blockSkip:vt,br:Me,code:yt,del:O,emStrongLDelim:kt,emStrongRDelimAst:xt,emStrongRDelimUnd:Ct,escape:Se,link:Tt,nolink:Te,punctuation:wt,reflink:ze,reflinkSearch:Lt,tag:zt,text:bt,url:O},Rt={...oe,link:f(/^!?\[(label)\]\((.*?)\)/).replace("label",j).getRegex(),reflink:f(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",j).getRegex()},J={...oe,escape:f(Se).replace("])","~|])").getRegex(),url:f(/^((?:ftp|https?):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/,"i").replace("email",/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/).getRegex(),_backpedal:/(?:[^?!.,:;*_'"~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_'"~)]+(?!$))+/,del:/^(~~?)(?=[^\s~])([\s\S]*?[^\s~])\1(?=[^~]|$)/,text:/^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|https?:\/\/|ftp:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/},At={...J,br:f(Me).replace("{2,}","*").getRegex(),text:f(J.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()},V={normal:re,gfm:ft,pedantic:_t},D={normal:oe,gfm:J,breaks:At,pedantic:Rt};class S{constructor(e){_(this,"tokens");_(this,"options");_(this,"state");_(this,"tokenizer");_(this,"inlineQueue");this.tokens=[],this.tokens.links=Object.create(null),this.options=e||R,this.options.tokenizer=this.options.tokenizer||new Z,this.tokenizer=this.options.tokenizer,this.tokenizer.options=this.options,this.tokenizer.lexer=this,this.inlineQueue=[],this.state={inLink:!1,inRawBlock:!1,top:!0};const t={block:V.normal,inline:D.normal};this.options.pedantic?(t.block=V.pedantic,t.inline=D.pedantic):this.options.gfm&&(t.block=V.gfm,this.options.breaks?t.inline=D.breaks:t.inline=D.gfm),this.tokenizer.rules=t}static get rules(){return{block:V,inline:D}}static lex(e,t){return new S(t).lex(e)}static lexInline(e,t){return new S(t).inlineTokens(e)}lex(e){e=e.replace(/\r\n|\r/g,`
`),this.blockTokens(e,this.tokens);for(let t=0;t<this.inlineQueue.length;t++){const s=this.inlineQueue[t];this.inlineTokens(s.src,s.tokens)}return this.inlineQueue=[],this.tokens}blockTokens(e,t=[],s=!1){this.options.pedantic?e=e.replace(/\t/g,"    ").replace(/^ +$/gm,""):e=e.replace(/^( *)(\t+)/gm,(o,l,c)=>l+"    ".repeat(c.length));let i,a,r;for(;e;)if(!(this.options.extensions&&this.options.extensions.block&&this.options.extensions.block.some(o=>(i=o.call({lexer:this},e,t))?(e=e.substring(i.raw.length),t.push(i),!0):!1))){if(i=this.tokenizer.space(e)){e=e.substring(i.raw.length),i.raw.length===1&&t.length>0?t[t.length-1].raw+=`
`:t.push(i);continue}if(i=this.tokenizer.code(e)){e=e.substring(i.raw.length),a=t[t.length-1],a&&(a.type==="paragraph"||a.type==="text")?(a.raw+=`
`+i.raw,a.text+=`
`+i.text,this.inlineQueue[this.inlineQueue.length-1].src=a.text):t.push(i);continue}if(i=this.tokenizer.fences(e)){e=e.substring(i.raw.length),t.push(i);continue}if(i=this.tokenizer.heading(e)){e=e.substring(i.raw.length),t.push(i);continue}if(i=this.tokenizer.hr(e)){e=e.substring(i.raw.length),t.push(i);continue}if(i=this.tokenizer.blockquote(e)){e=e.substring(i.raw.length),t.push(i);continue}if(i=this.tokenizer.list(e)){e=e.substring(i.raw.length),t.push(i);continue}if(i=this.tokenizer.html(e)){e=e.substring(i.raw.length),t.push(i);continue}if(i=this.tokenizer.def(e)){e=e.substring(i.raw.length),a=t[t.length-1],a&&(a.type==="paragraph"||a.type==="text")?(a.raw+=`
`+i.raw,a.text+=`
`+i.raw,this.inlineQueue[this.inlineQueue.length-1].src=a.text):this.tokens.links[i.tag]||(this.tokens.links[i.tag]={href:i.href,title:i.title});continue}if(i=this.tokenizer.table(e)){e=e.substring(i.raw.length),t.push(i);continue}if(i=this.tokenizer.lheading(e)){e=e.substring(i.raw.length),t.push(i);continue}if(r=e,this.options.extensions&&this.options.extensions.startBlock){let o=1/0;const l=e.slice(1);let c;this.options.extensions.startBlock.forEach(d=>{c=d.call({lexer:this},l),typeof c=="number"&&c>=0&&(o=Math.min(o,c))}),o<1/0&&o>=0&&(r=e.substring(0,o+1))}if(this.state.top&&(i=this.tokenizer.paragraph(r))){a=t[t.length-1],s&&(a==null?void 0:a.type)==="paragraph"?(a.raw+=`
`+i.raw,a.text+=`
`+i.text,this.inlineQueue.pop(),this.inlineQueue[this.inlineQueue.length-1].src=a.text):t.push(i),s=r.length!==e.length,e=e.substring(i.raw.length);continue}if(i=this.tokenizer.text(e)){e=e.substring(i.raw.length),a=t[t.length-1],a&&a.type==="text"?(a.raw+=`
`+i.raw,a.text+=`
`+i.text,this.inlineQueue.pop(),this.inlineQueue[this.inlineQueue.length-1].src=a.text):t.push(i);continue}if(e){const o="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(o);break}else throw new Error(o)}}return this.state.top=!0,t}inline(e,t=[]){return this.inlineQueue.push({src:e,tokens:t}),t}inlineTokens(e,t=[]){let s,i,a,r=e,o,l,c;if(this.tokens.links){const d=Object.keys(this.tokens.links);if(d.length>0)for(;(o=this.tokenizer.rules.inline.reflinkSearch.exec(r))!=null;)d.includes(o[0].slice(o[0].lastIndexOf("[")+1,-1))&&(r=r.slice(0,o.index)+"["+"a".repeat(o[0].length-2)+"]"+r.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex))}for(;(o=this.tokenizer.rules.inline.blockSkip.exec(r))!=null;)r=r.slice(0,o.index)+"["+"a".repeat(o[0].length-2)+"]"+r.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);for(;(o=this.tokenizer.rules.inline.anyPunctuation.exec(r))!=null;)r=r.slice(0,o.index)+"++"+r.slice(this.tokenizer.rules.inline.anyPunctuation.lastIndex);for(;e;)if(l||(c=""),l=!1,!(this.options.extensions&&this.options.extensions.inline&&this.options.extensions.inline.some(d=>(s=d.call({lexer:this},e,t))?(e=e.substring(s.raw.length),t.push(s),!0):!1))){if(s=this.tokenizer.escape(e)){e=e.substring(s.raw.length),t.push(s);continue}if(s=this.tokenizer.tag(e)){e=e.substring(s.raw.length),i=t[t.length-1],i&&s.type==="text"&&i.type==="text"?(i.raw+=s.raw,i.text+=s.text):t.push(s);continue}if(s=this.tokenizer.link(e)){e=e.substring(s.raw.length),t.push(s);continue}if(s=this.tokenizer.reflink(e,this.tokens.links)){e=e.substring(s.raw.length),i=t[t.length-1],i&&s.type==="text"&&i.type==="text"?(i.raw+=s.raw,i.text+=s.text):t.push(s);continue}if(s=this.tokenizer.emStrong(e,r,c)){e=e.substring(s.raw.length),t.push(s);continue}if(s=this.tokenizer.codespan(e)){e=e.substring(s.raw.length),t.push(s);continue}if(s=this.tokenizer.br(e)){e=e.substring(s.raw.length),t.push(s);continue}if(s=this.tokenizer.del(e)){e=e.substring(s.raw.length),t.push(s);continue}if(s=this.tokenizer.autolink(e)){e=e.substring(s.raw.length),t.push(s);continue}if(!this.state.inLink&&(s=this.tokenizer.url(e))){e=e.substring(s.raw.length),t.push(s);continue}if(a=e,this.options.extensions&&this.options.extensions.startInline){let d=1/0;const h=e.slice(1);let g;this.options.extensions.startInline.forEach(u=>{g=u.call({lexer:this},h),typeof g=="number"&&g>=0&&(d=Math.min(d,g))}),d<1/0&&d>=0&&(a=e.substring(0,d+1))}if(s=this.tokenizer.inlineText(a)){e=e.substring(s.raw.length),s.raw.slice(-1)!=="_"&&(c=s.raw.slice(-1)),l=!0,i=t[t.length-1],i&&i.type==="text"?(i.raw+=s.raw,i.text+=s.text):t.push(s);continue}if(e){const d="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(d);break}else throw new Error(d)}}return t}}class Y{constructor(e){_(this,"options");_(this,"parser");this.options=e||R}space(e){return""}code({text:e,lang:t,escaped:s}){var r;const i=(r=(t||"").match(/^\S*/))==null?void 0:r[0],a=e.replace(/\n$/,"")+`
`;return i?'<pre><code class="language-'+k(i)+'">'+(s?a:k(a,!0))+`</code></pre>
`:"<pre><code>"+(s?a:k(a,!0))+`</code></pre>
`}blockquote({tokens:e}){return`<blockquote>
${this.parser.parse(e)}</blockquote>
`}html({text:e}){return e}heading({tokens:e,depth:t}){return`<h${t}>${this.parser.parseInline(e)}</h${t}>
`}hr(e){return`<hr>
`}list(e){const t=e.ordered,s=e.start;let i="";for(let o=0;o<e.items.length;o++){const l=e.items[o];i+=this.listitem(l)}const a=t?"ol":"ul",r=t&&s!==1?' start="'+s+'"':"";return"<"+a+r+`>
`+i+"</"+a+`>
`}listitem(e){let t="";if(e.task){const s=this.checkbox({checked:!!e.checked});e.loose?e.tokens.length>0&&e.tokens[0].type==="paragraph"?(e.tokens[0].text=s+" "+e.tokens[0].text,e.tokens[0].tokens&&e.tokens[0].tokens.length>0&&e.tokens[0].tokens[0].type==="text"&&(e.tokens[0].tokens[0].text=s+" "+e.tokens[0].tokens[0].text)):e.tokens.unshift({type:"text",raw:s+" ",text:s+" "}):t+=s+" "}return t+=this.parser.parse(e.tokens,!!e.loose),`<li>${t}</li>
`}checkbox({checked:e}){return"<input "+(e?'checked="" ':"")+'disabled="" type="checkbox">'}paragraph({tokens:e}){return`<p>${this.parser.parseInline(e)}</p>
`}table(e){let t="",s="";for(let a=0;a<e.header.length;a++)s+=this.tablecell(e.header[a]);t+=this.tablerow({text:s});let i="";for(let a=0;a<e.rows.length;a++){const r=e.rows[a];s="";for(let o=0;o<r.length;o++)s+=this.tablecell(r[o]);i+=this.tablerow({text:s})}return i&&(i=`<tbody>${i}</tbody>`),`<table>
<thead>
`+t+`</thead>
`+i+`</table>
`}tablerow({text:e}){return`<tr>
${e}</tr>
`}tablecell(e){const t=this.parser.parseInline(e.tokens),s=e.header?"th":"td";return(e.align?`<${s} align="${e.align}">`:`<${s}>`)+t+`</${s}>
`}strong({tokens:e}){return`<strong>${this.parser.parseInline(e)}</strong>`}em({tokens:e}){return`<em>${this.parser.parseInline(e)}</em>`}codespan({text:e}){return`<code>${e}</code>`}br(e){return"<br>"}del({tokens:e}){return`<del>${this.parser.parseInline(e)}</del>`}link({href:e,title:t,tokens:s}){const i=this.parser.parseInline(s),a=pe(e);if(a===null)return i;e=a;let r='<a href="'+e+'"';return t&&(r+=' title="'+t+'"'),r+=">"+i+"</a>",r}image({href:e,title:t,text:s}){const i=pe(e);if(i===null)return s;e=i;let a=`<img src="${e}" alt="${s}"`;return t&&(a+=` title="${t}"`),a+=">",a}text(e){return"tokens"in e&&e.tokens?this.parser.parseInline(e.tokens):e.text}}class le{strong({text:e}){return e}em({text:e}){return e}codespan({text:e}){return e}del({text:e}){return e}html({text:e}){return e}text({text:e}){return e}link({text:e}){return""+e}image({text:e}){return""+e}br(){return""}}class M{constructor(e){_(this,"options");_(this,"renderer");_(this,"textRenderer");this.options=e||R,this.options.renderer=this.options.renderer||new Y,this.renderer=this.options.renderer,this.renderer.options=this.options,this.renderer.parser=this,this.textRenderer=new le}static parse(e,t){return new M(t).parse(e)}static parseInline(e,t){return new M(t).parseInline(e)}parse(e,t=!0){let s="";for(let i=0;i<e.length;i++){const a=e[i];if(this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[a.type]){const o=a,l=this.options.extensions.renderers[o.type].call({parser:this},o);if(l!==!1||!["space","hr","heading","code","table","blockquote","list","html","paragraph","text"].includes(o.type)){s+=l||"";continue}}const r=a;switch(r.type){case"space":{s+=this.renderer.space(r);continue}case"hr":{s+=this.renderer.hr(r);continue}case"heading":{s+=this.renderer.heading(r);continue}case"code":{s+=this.renderer.code(r);continue}case"table":{s+=this.renderer.table(r);continue}case"blockquote":{s+=this.renderer.blockquote(r);continue}case"list":{s+=this.renderer.list(r);continue}case"html":{s+=this.renderer.html(r);continue}case"paragraph":{s+=this.renderer.paragraph(r);continue}case"text":{let o=r,l=this.renderer.text(o);for(;i+1<e.length&&e[i+1].type==="text";)o=e[++i],l+=`
`+this.renderer.text(o);t?s+=this.renderer.paragraph({type:"paragraph",raw:l,text:l,tokens:[{type:"text",raw:l,text:l}]}):s+=l;continue}default:{const o='Token with "'+r.type+'" type was not found.';if(this.options.silent)return console.error(o),"";throw new Error(o)}}}return s}parseInline(e,t){t=t||this.renderer;let s="";for(let i=0;i<e.length;i++){const a=e[i];if(this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[a.type]){const o=this.options.extensions.renderers[a.type].call({parser:this},a);if(o!==!1||!["escape","html","link","image","strong","em","codespan","br","del","text"].includes(a.type)){s+=o||"";continue}}const r=a;switch(r.type){case"escape":{s+=t.text(r);break}case"html":{s+=t.html(r);break}case"link":{s+=t.link(r);break}case"image":{s+=t.image(r);break}case"strong":{s+=t.strong(r);break}case"em":{s+=t.em(r);break}case"codespan":{s+=t.codespan(r);break}case"br":{s+=t.br(r);break}case"del":{s+=t.del(r);break}case"text":{s+=t.text(r);break}default:{const o='Token with "'+r.type+'" type was not found.';if(this.options.silent)return console.error(o),"";throw new Error(o)}}}return s}}class P{constructor(e){_(this,"options");this.options=e||R}preprocess(e){return e}postprocess(e){return e}processAllTokens(e){return e}}_(P,"passThroughHooks",new Set(["preprocess","postprocess","processAllTokens"]));var K,Le,B,ee,Q,Re;class Et{constructor(...e){F(this,K);F(this,B);F(this,Q);_(this,"defaults",se());_(this,"options",this.setOptions);_(this,"parse",I(this,B,ee).call(this,S.lex,M.parse));_(this,"parseInline",I(this,B,ee).call(this,S.lexInline,M.parseInline));_(this,"Parser",M);_(this,"Renderer",Y);_(this,"TextRenderer",le);_(this,"Lexer",S);_(this,"Tokenizer",Z);_(this,"Hooks",P);this.use(...e)}walkTokens(e,t){var i,a;let s=[];for(const r of e)switch(s=s.concat(t.call(this,r)),r.type){case"table":{const o=r;for(const l of o.header)s=s.concat(this.walkTokens(l.tokens,t));for(const l of o.rows)for(const c of l)s=s.concat(this.walkTokens(c.tokens,t));break}case"list":{const o=r;s=s.concat(this.walkTokens(o.items,t));break}default:{const o=r;(a=(i=this.defaults.extensions)==null?void 0:i.childTokens)!=null&&a[o.type]?this.defaults.extensions.childTokens[o.type].forEach(l=>{const c=o[l].flat(1/0);s=s.concat(this.walkTokens(c,t))}):o.tokens&&(s=s.concat(this.walkTokens(o.tokens,t)))}}return s}use(...e){const t=this.defaults.extensions||{renderers:{},childTokens:{}};return e.forEach(s=>{const i={...s};if(i.async=this.defaults.async||i.async||!1,s.extensions&&(s.extensions.forEach(a=>{if(!a.name)throw new Error("extension name required");if("renderer"in a){const r=t.renderers[a.name];r?t.renderers[a.name]=function(...o){let l=a.renderer.apply(this,o);return l===!1&&(l=r.apply(this,o)),l}:t.renderers[a.name]=a.renderer}if("tokenizer"in a){if(!a.level||a.level!=="block"&&a.level!=="inline")throw new Error("extension level must be 'block' or 'inline'");const r=t[a.level];r?r.unshift(a.tokenizer):t[a.level]=[a.tokenizer],a.start&&(a.level==="block"?t.startBlock?t.startBlock.push(a.start):t.startBlock=[a.start]:a.level==="inline"&&(t.startInline?t.startInline.push(a.start):t.startInline=[a.start]))}"childTokens"in a&&a.childTokens&&(t.childTokens[a.name]=a.childTokens)}),i.extensions=t),s.renderer){const a=this.defaults.renderer||new Y(this.defaults);for(const r in s.renderer){if(!(r in a))throw new Error(`renderer '${r}' does not exist`);if(["options","parser"].includes(r))continue;const o=r;let l=s.renderer[o];const c=a[o];a[o]=(...d)=>{s.useNewRenderer||(l=I(this,K,Le).call(this,l,o,a));let h=l.apply(a,d);return h===!1&&(h=c.apply(a,d)),h||""}}i.renderer=a}if(s.tokenizer){const a=this.defaults.tokenizer||new Z(this.defaults);for(const r in s.tokenizer){if(!(r in a))throw new Error(`tokenizer '${r}' does not exist`);if(["options","rules","lexer"].includes(r))continue;const o=r,l=s.tokenizer[o],c=a[o];a[o]=(...d)=>{let h=l.apply(a,d);return h===!1&&(h=c.apply(a,d)),h}}i.tokenizer=a}if(s.hooks){const a=this.defaults.hooks||new P;for(const r in s.hooks){if(!(r in a))throw new Error(`hook '${r}' does not exist`);if(r==="options")continue;const o=r,l=s.hooks[o],c=a[o];P.passThroughHooks.has(r)?a[o]=d=>{if(this.defaults.async)return Promise.resolve(l.call(a,d)).then(g=>c.call(a,g));const h=l.call(a,d);return c.call(a,h)}:a[o]=(...d)=>{let h=l.apply(a,d);return h===!1&&(h=c.apply(a,d)),h}}i.hooks=a}if(s.walkTokens){const a=this.defaults.walkTokens,r=s.walkTokens;i.walkTokens=function(o){let l=[];return l.push(r.call(this,o)),a&&(l=l.concat(a.call(this,o))),l}}this.defaults={...this.defaults,...i}}),this}setOptions(e){return this.defaults={...this.defaults,...e},this}lexer(e,t){return S.lex(e,t??this.defaults)}parser(e,t){return M.parse(e,t??this.defaults)}}K=new WeakSet,Le=function(e,t,s){switch(t){case"heading":return function(i){return!i.type||i.type!==t?e.apply(this,arguments):e.call(this,s.parser.parseInline(i.tokens),i.depth,it(s.parser.parseInline(i.tokens,s.parser.textRenderer)))};case"code":return function(i){return!i.type||i.type!==t?e.apply(this,arguments):e.call(this,i.text,i.lang,!!i.escaped)};case"table":return function(i){if(!i.type||i.type!==t)return e.apply(this,arguments);let a="",r="";for(let l=0;l<i.header.length;l++)r+=this.tablecell({text:i.header[l].text,tokens:i.header[l].tokens,header:!0,align:i.align[l]});a+=this.tablerow({text:r});let o="";for(let l=0;l<i.rows.length;l++){const c=i.rows[l];r="";for(let d=0;d<c.length;d++)r+=this.tablecell({text:c[d].text,tokens:c[d].tokens,header:!1,align:i.align[d]});o+=this.tablerow({text:r})}return e.call(this,a,o)};case"blockquote":return function(i){if(!i.type||i.type!==t)return e.apply(this,arguments);const a=this.parser.parse(i.tokens);return e.call(this,a)};case"list":return function(i){if(!i.type||i.type!==t)return e.apply(this,arguments);const a=i.ordered,r=i.start,o=i.loose;let l="";for(let c=0;c<i.items.length;c++){const d=i.items[c],h=d.checked,g=d.task;let u="";if(d.task){const p=this.checkbox({checked:!!h});o?d.tokens.length>0&&d.tokens[0].type==="paragraph"?(d.tokens[0].text=p+" "+d.tokens[0].text,d.tokens[0].tokens&&d.tokens[0].tokens.length>0&&d.tokens[0].tokens[0].type==="text"&&(d.tokens[0].tokens[0].text=p+" "+d.tokens[0].tokens[0].text)):d.tokens.unshift({type:"text",text:p+" "}):u+=p+" "}u+=this.parser.parse(d.tokens,o),l+=this.listitem({type:"list_item",raw:u,text:u,task:g,checked:!!h,loose:o,tokens:d.tokens})}return e.call(this,l,a,r)};case"html":return function(i){return!i.type||i.type!==t?e.apply(this,arguments):e.call(this,i.text,i.block)};case"paragraph":return function(i){return!i.type||i.type!==t?e.apply(this,arguments):e.call(this,this.parser.parseInline(i.tokens))};case"escape":return function(i){return!i.type||i.type!==t?e.apply(this,arguments):e.call(this,i.text)};case"link":return function(i){return!i.type||i.type!==t?e.apply(this,arguments):e.call(this,i.href,i.title,this.parser.parseInline(i.tokens))};case"image":return function(i){return!i.type||i.type!==t?e.apply(this,arguments):e.call(this,i.href,i.title,i.text)};case"strong":return function(i){return!i.type||i.type!==t?e.apply(this,arguments):e.call(this,this.parser.parseInline(i.tokens))};case"em":return function(i){return!i.type||i.type!==t?e.apply(this,arguments):e.call(this,this.parser.parseInline(i.tokens))};case"codespan":return function(i){return!i.type||i.type!==t?e.apply(this,arguments):e.call(this,i.text)};case"del":return function(i){return!i.type||i.type!==t?e.apply(this,arguments):e.call(this,this.parser.parseInline(i.tokens))};case"text":return function(i){return!i.type||i.type!==t?e.apply(this,arguments):e.call(this,i.text)}}return e},B=new WeakSet,ee=function(e,t){return(s,i)=>{const a={...i},r={...this.defaults,...a};this.defaults.async===!0&&a.async===!1&&(r.silent||console.warn("marked(): The async option was set to true by an extension. The async: false option sent to parse will be ignored."),r.async=!0);const o=I(this,Q,Re).call(this,!!r.silent,!!r.async);if(typeof s>"u"||s===null)return o(new Error("marked(): input parameter is undefined or null"));if(typeof s!="string")return o(new Error("marked(): input parameter is of type "+Object.prototype.toString.call(s)+", string expected"));if(r.hooks&&(r.hooks.options=r),r.async)return Promise.resolve(r.hooks?r.hooks.preprocess(s):s).then(l=>e(l,r)).then(l=>r.hooks?r.hooks.processAllTokens(l):l).then(l=>r.walkTokens?Promise.all(this.walkTokens(l,r.walkTokens)).then(()=>l):l).then(l=>t(l,r)).then(l=>r.hooks?r.hooks.postprocess(l):l).catch(o);try{r.hooks&&(s=r.hooks.preprocess(s));let l=e(s,r);r.hooks&&(l=r.hooks.processAllTokens(l)),r.walkTokens&&this.walkTokens(l,r.walkTokens);let c=t(l,r);return r.hooks&&(c=r.hooks.postprocess(c)),c}catch(l){return o(l)}}},Q=new WeakSet,Re=function(e,t){return s=>{if(s.message+=`
Please report this to https://github.com/markedjs/marked.`,e){const i="<p>An error occurred:</p><pre>"+k(s.message+"",!0)+"</pre>";return t?Promise.resolve(i):i}if(t)return Promise.reject(s);throw s}};const L=new Et;function m(n,e){return L.parse(n,e)}m.options=m.setOptions=function(n){return L.setOptions(n),m.defaults=L.defaults,we(m.defaults),m};m.getDefaults=se;m.defaults=R;m.use=function(...n){return L.use(...n),m.defaults=L.defaults,we(m.defaults),m};m.walkTokens=function(n,e){return L.walkTokens(n,e)};m.parseInline=L.parseInline;m.Parser=M;m.parser=M.parse;m.Renderer=Y;m.TextRenderer=le;m.Lexer=S;m.lexer=S.lex;m.Tokenizer=Z;m.Hooks=P;m.parse=m;m.options;m.setOptions;m.use;m.walkTokens;m.parseInline;M.parse;S.lex;const It={name:"WidgetLink",props:{action:{type:Object}},methods:{isExternal(n){return!n.includes("bmwusa.com")}}};var Wt=function(){var s,i,a,r,o,l;var e=this,t=e._self._c;return t("div",{staticClass:"widget-link"},[t("div",{staticClass:"widget-link__icon"},[t("svg",{attrs:{"aria-hidden":"true"}},[t("use",{attrs:{"xlink:href":"#icon-share-link"}})])]),t("a",{staticClass:"widget-link__link",attrs:{href:(i=(s=e.action)==null?void 0:s.data)==null?void 0:i.url,target:e.isExternal((r=(a=e.action)==null?void 0:a.data)==null?void 0:r.url)?"_blank":!1,"analytics-on":"","analytics-event":`chatbot.${(o=e.action)==null?void 0:o.data.url}.link`}},[e._v(" "+e._s((l=e.action)==null?void 0:l.title)+" ")])])},Dt=[],Ot=b(It,Wt,Dt,!1,null,"552a8d25",null,null);const Pt=Ot.exports;const Bt={name:"WidgetUserReply",props:{action:{type:Object},isOldChat:{type:Boolean}},methods:{userReply(n){x.executeUserReplyAction(n)}}};var Ut=function(){var e=this,t=e._self._c;return t("div",{staticClass:"widget-user-reply"},[t("button",{staticClass:"widget-user-reply__cta",attrs:{title:e.action.data.reply,disabled:e.isOldChat},on:{click:function(s){return e.userReply(e.action)}}},[e._v(e._s(e.action.title))])])},Nt=[],qt=b(Bt,Ut,Nt,!1,null,"760ec1df",null,null);const Ft=qt.exports;const Vt={name:"WidgetDealerSelector",props:{actions:{type:Array},isOldChat:{type:Boolean}},computed:{formattedAddress(){return this.actions.map(n=>{const e=n.data.dealer.address[0];return`${e.lineOne}, ${e.city}, ${e.state} ${e.zipcode.split("-")[0]}`})}},methods:{selectDealer(n){x.executeUserReplyAction(n)}}};var Ht=function(){var e=this,t=e._self._c;return t("section",{staticClass:"widget-dealer-selector-container widget"},e._l(e.actions,function(s,i){return t("button",{key:`dealer_${i}`,staticClass:"dealer-card whiz-action-button",attrs:{"aria-labelledby":"whizDealerTitle",disabled:e.isOldChat},on:{click:function(a){return e.selectDealer(s)}}},[t("div",{staticClass:"dealer-card__title-container"},[t("h2",{staticClass:"dealer-card__title",attrs:{id:"whizDealerTitle"}},[e._v(e._s(s.title))]),s.data.dealer.programFlags.mcertified?t("div",[t("svg",{staticClass:"dealer-card__logo",attrs:{"aria-hidden":"true"}},[t("use",{attrs:{"xlink:href":"#icon-bmw-m-badge-gray"}})])]):e._e()]),t("div",{staticClass:"dealer-card__address"},[e._v(e._s(e.formattedAddress[i]))])])}),0)},Zt=[],jt=b(Vt,Ht,Zt,!1,null,"d358f0d4",null,null);const Yt=jt.exports;const Kt={name:"WidgetSeriesSelector",props:{actions:{type:Array},isOldChat:{type:Boolean}},methods:{selectSeries(n){x.executeUserReplyAction(n)}}};var Qt=function(){var e=this,t=e._self._c;return t("section",{staticClass:"widget-series-selector-container widget",attrs:{"aria-label":"Select a series"}},e._l(e.actions,function(s){return t("button",{key:`${s}_button`,staticClass:"series-button whiz-action-button",attrs:{disabled:e.isOldChat},on:{click:function(i){return e.selectSeries(s)}}},[e._v(e._s(s==null?void 0:s.title))])}),0)},Gt=[],Xt=b(Kt,Qt,Gt,!1,null,"dceff67e",null,null);const Jt=Xt.exports;const es={name:"WidgetModelSelector",props:{actions:{type:Array},isOldChat:{type:Boolean}},computed:{modelActions(){return this.actions.filter(n=>n.title)}},methods:{selectModel(n){x.executeUserReplyAction(n)},modelTypeIcon(n){var e,t;if((e=n==null?void 0:n.metadata)!=null&&e.model.mPerformanceFlag)return"#icon-bmw-m-badge-gray";if(((t=n==null?void 0:n.metadata)==null?void 0:t.model.fuelType)==="E")return"#icon-bmw-i-badge-gray"}}};var ts=function(){var e=this,t=e._self._c;return t("section",{staticClass:"widget-model-selector-container widget"},e._l(e.modelActions,function(s,i){return t("button",{key:`model_${i}`,staticClass:"model-card whiz-action-button",attrs:{disabled:e.isOldChat},on:{click:function(a){return e.selectModel(s==null?void 0:s.actions[0])}}},[t("div",{staticClass:"model-image-container"},[e.modelTypeIcon(s)?t("svg",{staticClass:"model-type-icon",attrs:{"aria-hidden":"true"}},[t("use",{attrs:{"xlink:href":e.modelTypeIcon(s)}})]):e._e(),t("img",{staticClass:"model-image",attrs:{src:`${s.imageUrl}&resp=png&cut=3`}})]),t("p",{staticClass:"model-card__text"},[e._v(e._s(s.title))])])}),0)},ss=[],is=b(es,ts,ss,!1,null,"c030edb6",null,null);const ns=is.exports,_e={Convertible:{icon:"#icon-convertible-hollow",description:"2-door with retractable roof"},Coupe:{icon:"#icon-coupe-hollow",description:"2-door with a sporty roofline"},"Gran Coupe":{icon:"#icon-gran-coupe-hollow",description:"4-door with a sporty roofline"},Touring:{icon:"#icon-touring-hollow",description:"4-door with extended cargo space"},Roadster:{icon:"#icon-roadster-hollow",description:""},SAV:{icon:"#icon-sav-hollow",description:""},SUV:{icon:"#icon-sav-hollow",description:""},"Sports Activity Vehicle":{icon:"#icon-sav-hollow",description:""},"Sports Activity Coupe":{icon:"#icon-sav-hollow",description:""},Sedan:{icon:"#icon-sedan-hollow",description:""}};const as={name:"WidgetBodyStyleSelector",props:{actions:{type:Array},isOldChat:{type:Boolean}},methods:{selectBodyStyle(n){x.executeUserReplyAction(n)},getBodyStyleIcon(n){var e;return(e=_e[n.title])==null?void 0:e.icon},getBodyStyleDescription(n){var e;return(e=_e[n.title])==null?void 0:e.description}}};var rs=function(){var e=this,t=e._self._c;return t("section",{staticClass:"widget-body-style-selector-container widget"},e._l(e.actions,function(s,i){return t("button",{key:`bodyStyle_${i}`,staticClass:"body-style-card whiz-action-button",attrs:{disabled:e.isOldChat},on:{click:function(a){return e.selectBodyStyle(s)}}},[t("div",{staticClass:"body-style-card__icon"},[t("svg",[t("use",{attrs:{"xlink:href":e.getBodyStyleIcon(s)}})])]),t("div",{staticClass:"body-style-card__text-container"},[t("h2",{staticClass:"body-style-card__name"},[e._v(e._s(s.title))]),t("p",{staticClass:"body-style-card__description"},[e._v(e._s(e.getBodyStyleDescription(s)))])])])}),0)},os=[],ls=b(as,rs,os,!1,null,"60dc6dc3",null,null);const cs=ls.exports;const ds={name:"WidgetMonthlyPayment",components:{WhizModal:G,WhizButton:E},props:{widgets:{type:Array}},data(){return{financeModalVisible:!1,leaseModalVisible:!1,tooltipFinanceTitle:"ABOUT FINANCE PAYMENT",tooltipFinanceDescription:"Estimated payments exclude applicable taxes, title, registration, license, and documentary fees, and will vary depending upon the final price and terms agreed upon between you and your BMW Center. Calculation of this estimated payment may include a credit or rebate. The availability and amount of credits and rebates are subject to changes in law and subject to BMW Center participation, which could affect the estimated payment. Consult your selected BMW Center for more information regarding the availability of a credit or rebate on your chosen vehicle.",tooltipLeaseTitle:"ABOUT LEASE PAYMENT",tooltipLeaseDescription:"Estimated payments exclude applicable taxes, title, registration, license, and documentary fees, and will vary depending upon the final price and terms agreed upon between you and your BMW Center. Calculation of this estimated payment may include a credit or rebate. The availability and amount of credits and rebates are subject to changes in law and subject to BMW Center participation, which could affect the estimated payment. Consult your selected BMW Center for more information regarding the availability of a credit or rebate on your chosen vehicle. ---Estimated payments exclude applicable taxes, title, registration, license, and documentary fees, and will vary depending upon the final price and terms agreed upon between you and your BMW Center. Calculation of this estimated payment may include a credit or rebate. The availability and amount of credits and rebates are subject to changes in law and subject to BMW Center participation, which could affect the estimated payment. Consult your selected BMW Center for more information regarding the availability of a credit or rebate on your chosen vehicle"}},methods:{checkInventory(n){x.executeUserReplyAction(n)},showFinanceModal(){this.financeModalVisible=!0},showLeaseModal(){this.leaseModalVisible=!0},closeFinanceModal(){this.financeModalVisible=!1},closeLeaseModal(){this.leaseModalVisible=!1}}};var hs=function(){var e=this,t=e._self._c;return t("section",{staticClass:"widget-monthly-payment-container widget",attrs:{"aria-label":"Estimated monthly payments"}},[e.widgets[0].metadata.leaseOffer.monthlyPayment?t("div",{staticClass:"payment-card lease-container"},[t("p",{staticClass:"payment-type-title"},[e._v("Lease Amount")]),t("p",{staticClass:"monthly-amount-container"},[t("span",{staticClass:"monthly-amount"},[e._v("$"+e._s(e.widgets[0].metadata.leaseOffer.monthlyPayment.toLocaleString())+" ")]),t("span",[e._v("/ month "),t("button",{attrs:{"aria-label":"lease tooltip"},on:{click:e.showLeaseModal}},[t("svg",{staticClass:"tooltip-icon"},[t("use",{attrs:{"xlink:href":"#icon-info-circle"}})])])])]),t("p",{staticClass:"payment-detail-text"},[e._v(e._s(e.widgets[0].metadata.leaseOffer.term)+" months | "+e._s(e.widgets[0].metadata.leaseOffer.mileage.toLocaleString())+" annual mi")]),t("p",{staticClass:"payment-detail-text"},[e._v("$"+e._s(e.widgets[0].metadata.leaseOffer.downPayment.toLocaleString())+" due at signing")])]):e._e(),e.widgets[0].metadata.financeOffer.monthlyPayment?t("div",{staticClass:"payment-card finance-container"},[t("p",{staticClass:"payment-type-title"},[e._v("Finance Amount")]),t("p",{staticClass:"monthly-amount-container"},[t("span",{staticClass:"monthly-amount"},[e._v("$"+e._s(e.widgets[0].metadata.financeOffer.monthlyPayment.toLocaleString())+" ")]),t("span",[e._v("/ month "),t("button",{attrs:{"aria-label":"finance tooltip"},on:{click:e.showFinanceModal}},[t("svg",{staticClass:"tooltip-icon"},[t("use",{attrs:{"xlink:href":"#icon-info-circle"}})])])])]),t("p",{staticClass:"payment-detail-text"},[e._v(e._s(e.widgets[0].metadata.financeOffer.term)+" months | "+e._s(e.widgets[0].metadata.financeOffer.interestRate)+" APR")]),t("p",{staticClass:"payment-detail-text"},[e._v("$"+e._s(e.widgets[0].metadata.financeOffer.downPayment.toLocaleString())+" due at signing")])]):e._e(),t("div",{staticClass:"cta-container"},[t("WhizButton",{attrs:{theme:"blue",size:"full"},nativeOn:{click:function(s){return e.checkInventory(e.widgets[0].actions[0])}}},[e._v(" Check inventory for availability ")])],1),t("WhizModal",{directives:[{name:"show",rawName:"v-show",value:e.leaseModalVisible,expression:"leaseModalVisible"}],attrs:{visibility:e.leaseModalVisible},on:{closeModal:e.closeLeaseModal},scopedSlots:e._u([{key:"header",fn:function(){return[t("h2",{staticClass:"modal-title"},[e._v(e._s(e.tooltipLeaseTitle))])]},proxy:!0},{key:"main",fn:function(){return[t("p",{staticClass:"modal-description"},[e._v(e._s(e.tooltipLeaseDescription))])]},proxy:!0}])}),t("WhizModal",{directives:[{name:"show",rawName:"v-show",value:e.financeModalVisible,expression:"financeModalVisible"}],attrs:{visibility:e.financeModalVisible},on:{closeModal:e.closeFinanceModal},scopedSlots:e._u([{key:"header",fn:function(){return[t("h2",{staticClass:"modal-title"},[e._v(e._s(e.tooltipFinanceTitle))])]},proxy:!0},{key:"main",fn:function(){return[t("p",{staticClass:"modal-description"},[e._v(e._s(e.tooltipFinanceDescription))])]},proxy:!0}])})],1)},us=[],ps=b(ds,hs,us,!1,null,"9bbf5a6c",null,null);const gs=ps.exports;const ms={name:"InventoryRecommendationCard",components:{WhizButton:E},props:{widget:{type:Object}},data(){return{modelTitle:"",modelYear:"",imageUrl:"",msrp:"",vehicleProcessingCenter:"",statusText:"",inProduction:!1,detailURL:"",widgetType:"",statusText:{1:"At dealership",2:"Arriving soon",3:"In production"}}},created(){var n,e,t,s,i,a;this.modelTitle=this.widget.title,this.modelYear=(n=this.widget.metadata)==null?void 0:n.modelYear,this.imageUrl=`${(e=this.widget)==null?void 0:e.imageUrl}&resp=png&cut=3&bkgnd=transparent`,this.msrp=(t=this.widget.metadata)==null?void 0:t.totalMsrp,this.vehicleProcessingCenter=(s=this.widget.metadata)==null?void 0:s.vehicleProcessingCenter,this.statusText=this.getStatusText((i=this.widget.metadata)==null?void 0:i.orderStatus,this.vehicleProcessingCenter),this.inProduction=this.isInProduction((a=this.widget.metadata)==null?void 0:a.orderStatus,this.vehicleProcessingCenter),this.detailURL=`https://www.bmwusa.com/inventory/detail/${this.widget.metadata.vin}`,this.widgetType=this.widget.metadata.widgetType},methods:{getStatusText(n,e){return this.statusText[he(Number(n),e)]},isInProduction(n,e){return he(Number(n),e)===3},showMsrpModal(){this.$emit("showMsrpModal",!0)},showAvailabilityModal(){this.$emit("showAvailabilityModal",!0)}}};var fs=function(){var s;var e=this,t=e._self._c;return t("div",{staticClass:"inventory-recommendation-card recommendation-card",attrs:{"aria-roledescription":"slide","aria-lablledby":`carousel_item-${e.index}_heading`}},[t("div",{staticClass:"image-container",attrs:{"aria-hidden":"true"}},[t("img",{staticClass:"inventory-recommendation-card__image",attrs:{src:e.imageUrl}})]),t("div",{staticClass:"details-container"},[t("p",{staticClass:"year"},[e._v(e._s(e.modelYear))]),t("h2",{staticClass:"model-name",attrs:{id:`carousel_item-${e.index}_heading`}},[e._v(e._s(e.modelTitle))]),t("div",{staticClass:"msrp-and-availability"},[t("div",{staticClass:"msrp"},[t("p",{staticClass:"msrp__title"},[e._v("MSRP "),t("span",{staticClass:"info-icon"},[t("button",{attrs:{"aria-label":"msrp tooltip"},on:{click:e.showMsrpModal}},[t("svg",{staticClass:"tooltip-icon"},[t("use",{attrs:{"xlink:href":"#icon-info-circle"}})])])])]),t("p",{staticClass:"msrp__price"},[e._v("$"+e._s((s=e.msrp)==null?void 0:s.toLocaleString()))])]),t("div",{staticClass:"availability"},[t("p",{staticClass:"availability__title"},[e._v("Availability "),t("span",{staticClass:"info-icon"},[t("button",{attrs:{"aria-label":"availability tooltip"},on:{click:e.showAvailabilityModal}},[t("svg",{staticClass:"tooltip-icon"},[t("use",{attrs:{"xlink:href":"#icon-info-circle"}})])])])]),t("p",{staticClass:"availability__status"},[t("svg",{class:e.inProduction?"yellow-icon":"green-icon"},[t("use",{attrs:{"xmlns:xlink":"http://www.w3.org/1999/xlink","xlink:href":"#icon-byo-filled-circle"}})]),t("span",[e._v(e._s(e.statusText))])])])]),t("div",{staticClass:"cta-container"},[t("WhizButton",{attrs:{ctaType:"anchor",theme:"blue",size:"full",href:e.detailURL,ariaLabel:`link to ${e.modelTitle} inventory page`}},[e._v("View details")])],1)])])},_s=[],ys=b(ms,fs,_s,!1,null,"99bac2ba",null,null);const bs=ys.exports;const ws={name:"BYORecommendationCard",components:{WhizButton:E},props:{widget:{type:Object}},data(){return{modelTitle:"",modelYear:"",imageUrl:"",msrp:"",vehicleProcessingCenter:"",statusText:"",inProduction:!1,byoURL:"",widgetType:""}},created(){this.modelTitle=this.getModelTitle(this.widget.title),this.modelYear=this.getYear(this.widget.title),this.imageUrl=`${this.widget.imageUrl}&resp=png&cut=3&bkgnd=transparent`,this.msrp=this.formatMSRP(this.widget.subtitle),this.byoURL=this.getBYOURL(this.widget.actions),this.widgetType=this.widget.metadata.widgetType},methods:{getModelTitle(n){const e=n.split(" ");return e.shift(),e.join(" ")},getYear(n){return n.split(" ")[0]},getBYOURL(n){return n.find(e=>e.title==="View in BYO").data.url},formatMSRP(n){return`$${Math.floor(parseFloat(n.replace(/[\$,]/g,""))).toLocaleString()}`},showMsrpModal(){this.$emit("showMsrpModal",!0)}}};var vs=function(){var e=this,t=e._self._c;return t("div",{staticClass:"byo-recommendation-card recommendation-card",attrs:{"aria-roledescription":"slide","aria-lablledby":`carousel_item-${e.index}_heading`}},[t("div",{staticClass:"image-container",attrs:{"aria-hidden":"true"}},[t("img",{staticClass:"byo-recommendation-card__image",attrs:{src:e.imageUrl}})]),t("div",{staticClass:"details-container"},[t("p",{staticClass:"year"},[e._v(e._s(e.modelYear))]),t("h2",{staticClass:"model-name",attrs:{id:`carousel_item-${e.index}_heading`}},[e._v(e._s(e.modelTitle))]),t("div",{staticClass:"msrp-container"},[t("div",{staticClass:"msrp"},[t("p",{staticClass:"msrp__title"},[e._v("MSRP "),t("span",{staticClass:"info-icon"},[t("button",{attrs:{"aria-label":"msrp tooltip"},on:{click:e.showMsrpModal}},[t("svg",{staticClass:"tooltip-icon"},[t("use",{attrs:{"xlink:href":"#icon-info-circle"}})])])])]),t("p",{staticClass:"msrp__price"},[e._v(e._s(e.msrp))])])]),t("div",{staticClass:"cta-container"},[t("WhizButton",{attrs:{ctaType:"anchor",theme:"blue",size:"full",href:e.byoURL,ariaLabel:`link to ${e.modelTitle} build your own page`}},[e._v(" Build this vehicle ")])],1)])])},ks=[],xs=b(ws,vs,ks,!1,null,"91db26af",null,null);const Cs=xs.exports;const $s={name:"WidgetRecommendCarousel",components:{InventoryRecommendationCard:bs,BYORecommendationCard:Cs,WhizModal:G},props:{widgets:{type:Array}},data(){return{availabilityModalVisible:!1,msrpModalVisible:!1,availabilityTooltipTitle:"Availability Disclaimer",availabilityTooltipDescription:"Vehicle is located at this BMW Center. Due to demand, availability is subject to change without notice. Please contact this BMW Center for additional and most up-to-date information about this vehicle.",msrpTooltipTitle:"MSRP Disclaimer",msrpTooltipDescription:"Estimated payments exclude applicable taxes, title, registration, license, and documentary fees, and will vary depending upon the final price and terms agreed upon between you and your BMW Center."}},mounted(){this.updateScrimVisibility(),this.$refs.recommendationContainer.focus(),this.createIntersectionObserverForKeyboard()},methods:{createIntersectionObserverForKeyboard(){const n={root:document.querySelector(".whizapp__chat-container"),rootMargin:"0px",threshold:.55};new IntersectionObserver(t=>{t.forEach(s=>{s.isIntersecting?window.addEventListener("keydown",this.handleKeydown):window.removeEventListener("keydown",this.handleKeydown)})},n).observe(this.$refs.recommendationContainer)},showMsrpTooltipModal(){this.msrpModalVisible=!0},showAvailabilityTooltipModal(){this.availabilityModalVisible=!0},closeAvailabilityTooltipModal(){this.availabilityModalVisible=!1},closeMsrpTooltipModal(){this.msrpModalVisible=!1},scrollLeft(){const n=this.$refs.carouselInner.querySelector(".recommendation-card").clientWidth;this.$refs.carouselInner.scrollBy({left:-n,behavior:"smooth"}),this.updateScrimVisibility()},scrollRight(){const n=this.$refs.carouselInner.querySelector(".recommendation-card").clientWidth;this.$refs.carouselInner.scrollBy({left:n,behavior:"smooth"}),this.updateScrimVisibility()},handleKeydown(n){n.key==="ArrowLeft"?this.scrollLeft():n.key==="ArrowRight"&&this.scrollRight()},updateScrimVisibility(){const e=this.$refs.carouselInner.scrollWidth-this.$refs.carouselInner.clientWidth-15;this.$refs.carouselInner.scrollLeft>15?(this.$refs.leftScrim.style.display="block",this.$refs.leftButton.style.display="flex"):(this.$refs.leftScrim.style.display="none",this.$refs.leftButton.style.display="none"),this.$refs.carouselInner.scrollLeft<e?(this.$refs.rightScrim.style.display="block",this.$refs.rightButton.style.display="flex"):(this.$refs.rightScrim.style.display="none",this.$refs.rightButton.style.display="none")}}};var Ss=function(){var e=this,t=e._self._c;return t("div",[t("section",{ref:"recommendationContainer",staticClass:"recommendation-cards-container",attrs:{role:"region","aria-roledescription":"carousel","aria-label":"carousel recommendation cards"}},[t("div",{ref:"leftScrim",staticClass:"left-scrim"}),t("button",{ref:"leftButton",staticClass:"carousel-button carousel-left-button",attrs:{"aria-label":"Previous"},on:{click:e.scrollLeft}},[t("svg",{staticClass:"carousel-button__icon"},[t("use",{attrs:{"xlink:href":"#icon-arrow-chevron-left"}})])]),t("div",{ref:"carouselInner",staticClass:"recommendation-cards-container__inner",attrs:{role:"group"},on:{scroll:e.updateScrimVisibility}},e._l(e.widgets,function(s,i){return t("div",{key:`recommendation-card-${i}`},[s.metadata&&s.metadata.widgetType==="inventory"?t("InventoryRecommendationCard",{attrs:{widget:s},on:{showMsrpModal:e.showMsrpTooltipModal,showAvailabilityModal:e.showAvailabilityTooltipModal}}):e._e(),s.metadata&&s.metadata.widgetType==="recommendation"?t("BYORecommendationCard",{attrs:{widget:s},on:{showMsrpModal:e.showMsrpTooltipModal}}):e._e()],1)}),0),t("button",{ref:"rightButton",staticClass:"carousel-button carousel-right-button",attrs:{"aria-label":"Next"},on:{click:e.scrollRight}},[t("svg",{staticClass:"carousel-button__icon"},[t("use",{attrs:{"xlink:href":"#icon-arrow-chevron-right"}})])]),t("div",{ref:"rightScrim",staticClass:"right-scrim"})]),t("WhizModal",{directives:[{name:"show",rawName:"v-show",value:e.msrpModalVisible,expression:"msrpModalVisible"}],attrs:{visibility:e.msrpModalVisible},on:{closeModal:e.closeMsrpTooltipModal},scopedSlots:e._u([{key:"header",fn:function(){return[t("h2",{staticClass:"modal-title"},[e._v(e._s(e.msrpTooltipTitle))])]},proxy:!0},{key:"main",fn:function(){return[t("p",{staticClass:"modal-description"},[e._v(e._s(e.msrpTooltipDescription))])]},proxy:!0}])}),t("WhizModal",{directives:[{name:"show",rawName:"v-show",value:e.availabilityModalVisible,expression:"availabilityModalVisible"}],attrs:{visibility:e.availabilityModalVisible},on:{closeModal:e.closeAvailabilityTooltipModal},scopedSlots:e._u([{key:"header",fn:function(){return[t("h2",{staticClass:"modal-title"},[e._v(e._s(e.availabilityTooltipTitle))])]},proxy:!0},{key:"main",fn:function(){return[t("p",{staticClass:"modal-description"},[e._v(e._s(e.availabilityTooltipDescription))])]},proxy:!0}])})],1)},Ms=[],zs=b($s,Ss,Ms,!1,null,"78a85743",null,null);const Ts=zs.exports;const Ls={name:"WhizSuggestions",components:{WhizButton:E},props:{showTitle:{type:Boolean,default:!1},actions:{type:Object}},methods:{onSuggestionsClick(n){x.executeUserReplyAction(n)}}};var Rs=function(){var e=this,t=e._self._c;return t("section",{staticClass:"widget-suggestions-container",attrs:{"aria-label":"Suggestion buttons section"}},[e.showTitle?t("h3",{staticClass:"widget-suggestion-title"},[e._v("Some suggestions")]):e._e(),e._l(e.actions,function(s,i){return[s.type==="USER_REPLY"?t("WhizButton",{key:`suggestion_button_${i}`,attrs:{theme:"suggestion",size:"auto",ariaLabel:s.title},nativeOn:{click:function(a){return e.onSuggestionsClick(s)}}},[e._v(" "+e._s(s.title)+" ")]):s.type==="NAVIGATION"?t("WhizButton",{key:`suggestion_link_${i}`,attrs:{ctaType:"anchor",theme:"suggestion",size:"auto",href:s.data.url,ariaLabel:`link to ${s.title}`}},[e._v(" "+e._s(s.title)+" ")]):e._e()]})],2)},As=[],Es=b(Ls,Rs,As,!1,null,"3d634287",null,null);const Ae=Es.exports;const Is={name:"WhizResponse",components:{WidgetLink:Pt,WidgetUserReply:Ft,WidgetDealerSelector:Yt,WidgetSeriesSelector:Jt,WidgetBodyStyleSelector:cs,WidgetModelSelector:ns,WidgetMonthlyPayment:gs,WidgetRecommendCarousel:Ts,WhizSuggestions:Ae},props:{chat:{type:Object},chatIndex:{type:Number}},computed:{...te(["chats","showLoading"]),isWelcome(){var e,t,s,i;const n=(e=this.chat.entry)==null?void 0:e.metadata;if(!((t=n.chatState)!=null&&t.activeForm))return((s=n==null?void 0:n.chatState)==null?void 0:s.latestIntent.name)==="session_start"&&this.chats.length===1||((i=n.chatState)==null?void 0:i.latestIntent.name)==="greet"},isOldChat(){return this.chats[this.chats.length-1].entry.message_id==="frontend_legal"?!1:this.chatIndex!=this.chats.length-1||this.showLoading},showSuggestions(){if(this.isWelcome)return!0},showCarousel(){}},data(){return{timestamp:"",text:"",message_i:"",metadata:"",isPositiveDisabled:!1,isNegativeDisabled:!1}},created(){var n;m.use({breaks:!0,gfm:!0}),this.timestamp=this.chat.entry.timestamp,this.text=m.parse(this.chat.entry.text),this.message_id=this.chat.entry.message_id,this.metadata=(n=this.chat.entry)==null?void 0:n.metadata},methods:{showFeedback(n){var e;return!(this.chat.entry.from_history||!((e=this.chat.entry.metadata)!=null&&e.feedbackEnabled))},feedbackChat(n,e){e&&(n==="positive"?(this.isPositiveDisabled=!0,this.isNegativeDisabled=!1):(this.isPositiveDisabled=!1,this.isNegativeDisabled=!0),x.sendFeedback(n,e))}}};var Ws=function(){var e=this,t=e._self._c;return t("div",{staticClass:"whiz-response"},[t("div",{staticClass:"whiz-response__header"},[t("div",{staticClass:"whiz-response__icon"},[t("svg",{attrs:{"aria-hidden":"true"}},[t("use",{attrs:{"xmlns:xlink":"http://www.w3.org/1999/xlink","xlink:href":"#icon-chatbot-star"}})])]),t("div",{staticClass:"whiz-response__header-text"},[e.timestamp?t("time",[e._v(e._s(new Date(e.timestamp).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit",hour12:!0})))]):e._e(),e.text?t("div",{staticClass:"whiz-response__text"},[t("span",{domProps:{innerHTML:e._s(e.text)}})]):e._e(),e.showFeedback()?t("div",{staticClass:"whiz-response__feedback"},[t("button",{staticClass:"whiz-response__feedback--up",attrs:{type:"button","data-selected":e.isPositiveDisabled,disabled:e.isPositiveDisabled,title:"This did answer my question","analytics-on":"","analytics-event":"chatbot.positive-feedback"},on:{click:function(s){return e.feedbackChat("positive",e.message_id)}}},[t("svg",[t("use",{attrs:{"xmlns:xlink":"http://www.w3.org/1999/xlink","xlink:href":"#icon-chatbot-thumbs-up"}})]),t("span",{staticClass:"whiz-response__feedback-tooltip"},[e._v("This did answer my question")])]),t("button",{staticClass:"whiz-response__feedback--down",attrs:{type:"button","data-selected":e.isNegativeDisabled,disabled:e.isNegativeDisabled,title:"This didn't answer my question","analytics-on":"","analytics-event":"chatbot.negative-feedback"},on:{click:function(s){return e.feedbackChat("negative",e.message_id)}}},[t("svg",[t("use",{attrs:{"xmlns:xlink":"http://www.w3.org/1999/xlink","xlink:href":"#icon-chatbot-thumbs-down"}})]),t("span",{staticClass:"whiz-response__feedback-tooltip"},[e._v("This didn't answer my question")])])]):e._e()])]),e._l(e.chat.widgets,function(s,i){var a,r,o,l,c,d,h,g,u,p,y,w;return t("div",{key:`chat-widget_${i}`,staticClass:"whiz-response__widgets-container"},[e.showSuggestions?t("WhizSuggestions",{attrs:{actions:(r=(a=e.chat)==null?void 0:a.widgets[0])==null?void 0:r.actions,showTitle:!0}}):e._e(),((o=s.metadata)==null?void 0:o.widgetType)==="dealerSelect"?t("WidgetDealerSelector",{attrs:{actions:s.actions,isOldChat:e.isOldChat}}):e._e(),((l=s.metadata)==null?void 0:l.widgetType)==="seriesSelect"?t("WidgetSeriesSelector",{attrs:{actions:s.actions,isOldChat:e.isOldChat}}):e._e(),((c=s.metadata)==null?void 0:c.widgetType)==="bodystyleSelect"?t("WidgetBodyStyleSelector",{attrs:{actions:s.actions,isOldChat:e.isOldChat}}):e._e(),i===0&&((d=s.metadata)==null?void 0:d.widgetType)==="modelSelect"?t("WidgetModelSelector",{attrs:{actions:(h=e.chat)==null?void 0:h.widgets,isOldChat:e.isOldChat}}):e._e(),((g=s.metadata)==null?void 0:g.widgetType)==="estimatePayment"?t("WidgetMonthlyPayment",{attrs:{widgets:(u=e.chat)==null?void 0:u.widgets}}):e._e(),i===0&&(((p=s.metadata)==null?void 0:p.widgetType)==="inventory"||((y=s.metadata)==null?void 0:y.widgetType)==="recommendation")?t("WidgetRecommendCarousel",{attrs:{widgets:(w=e.chat)==null?void 0:w.widgets}}):e._e(),s.actions?t("div",{staticClass:"widget-actions-container widget"},[e._l(s.actions,function(v,z){var C,T;return[v.type==="NAVIGATION"&&!((C=s.metadata)!=null&&C.widgetType)?t("WidgetLink",{attrs:{action:v}}):e._e(),v.type==="USER_REPLY"&&!e.isWelcome&&!((T=s.metadata)!=null&&T.widgetType)?t("WidgetUserReply",{attrs:{action:v,isOldChat:e.isOldChat}}):e._e()]})],2):e._e()],1)})],2)},Ds=[],Os=b(Is,Ws,Ds,!1,null,null,null,null);const Ps=Os.exports;const Bs={name:"WhizError",components:{},props:{message:{type:String}},data(){return{timestamp:"",text:"",message_i:"",metadata:"",widgetType:"",actionType:"",isPositiveDisabled:!1,isNegativeDisabled:!1}},methods:{reload(){location.reload()}}};var Us=function(){var e=this,t=e._self._c;return t("div",{staticClass:"whiz-error"},[t("div",{staticClass:"whiz-error__icon"},[t("svg",{attrs:{"aria-hidden":"true"}},[t("use",{attrs:{"xmlns:xlink":"http://www.w3.org/1999/xlink","xlink:href":"#icon-chatbot-star"}})])]),t("div",{staticClass:"whiz-error__content"},[t("time",[e._v(e._s(new Date().toLocaleTimeString([],{hour:"2-digit",minute:"2-digit",hour12:!0})))]),t("div",{staticClass:"whiz-error__text"},[t("div",{staticClass:"error-header"},[t("svg",{staticClass:"icon-error",attrs:{"aria-hidden":"true"}},[t("use",{attrs:{"xmlns:xlink":"http://www.w3.org/1999/xlink","xlink:href":"#icon-whiz-error"}})]),t("span",{staticClass:"error-title"},[e._v("Hmm, something went wrong.")])]),t("span",{staticClass:"error-message"},[e._v(e._s(e.message))]),t("button",{staticClass:"error-button",on:{click:e.reload}},[e._v("Try Again")])])])])},Ns=[],qs=b(Bs,Us,Ns,!1,null,"3510190a",null,null);const Fs=qs.exports;const Vs={name:"DynamicPopup",computed:{...Oe(["isPopupOpen"])},methods:{expandModal(){this.$store.dispatch("updateLegalModalOpen",!0)}}};var Hs=function(){var e=this,t=e._self._c;return e.isPopupOpen?t("div",{staticClass:"popup-container",on:{click:e.expandModal}},[t("div",{staticClass:"popup-container__header"},[e._t("header"),t("button",{staticClass:"popup-expand-button"},[t("svg",{attrs:{"aria-hidden":"true"}},[t("use",{attrs:{"xmlns:xlink":"http://www.w3.org/1999/xlink","xlink:href":"#icon-maximize"}})])])],2),t("div",{staticClass:"popup-container__main"},[e._t("main")],2)]):e._e()},Zs=[],js=b(Vs,Hs,Zs,!1,null,"347859d5",null,null);const Ys=js.exports;const Ks={name:"LegalPopup",props:{},components:{WhizPopup:Ys}};var Qs=function(){var e=this,t=e._self._c;return t("WhizPopup",{scopedSlots:e._u([{key:"header",fn:function(){return[t("h3",{staticClass:"title"},[e._v("BMW USA Legal Disclaimer")])]},proxy:!0},{key:"main",fn:function(){return[t("p",{staticClass:"description"},[e._v("The information provided by the BMW AI Chatbot, including MSRP, vehicle availability, and specifications, is subject to change without notice. Taxes, fees, and additional charges are not included in the MSRP. Vehicle availability may vary due to supply constraints and demand.")])]},proxy:!0}])})},Gs=[],Xs=b(Ks,Qs,Gs,!1,null,"169ed264",null,null);const Js=Xs.exports;const ei={name:"ClearHistoryContents",props:{},components:{WhizModal:G,WhizButton:E},computed:{...te(["isLegalModalOpen"])},methods:{acceptLegal(){this.$store.dispatch("updateLegalModalOpen",!1),this.$store.dispatch("updatePopupOpen",!1),this.$store.dispatch("updateLegalAccepted",!0)}}};var ti=function(){var e=this,t=e._self._c;return t("div",{directives:[{name:"show",rawName:"v-show",value:e.isLegalModalOpen,expression:"isLegalModalOpen"}],staticClass:"clear-history-container"},[t("WhizModal",{attrs:{modalType:"legalModal"},scopedSlots:e._u([{key:"header",fn:function(){return[t("h3",{staticClass:"modal-title"},[e._v("BMW USA Legal Disclaimer")])]},proxy:!0},{key:"main",fn:function(){return[t("p",{staticClass:"modal-description"},[e._v("This BMW Concierge chatbot uses generative artificial intelligence. The chatbot may provide inaccurate or outdated information. We and our service providers may use your interactions with the chatbot to improve our services.")]),t("p",{staticClass:"modal-description"},[e._v("The generative AI chatbot, including MSRP, vehicle availability, and specification, is subject to change without notice. Taxes, fees, and additional charges are not included the MSRP. Vehicle availability may vary due to supply constraints and demand. Estimated payments exclude applicable taxes, title, registration, license, and documentary fees, and may vary depending on the final price and terms agreed upon between you and your BMW Center.")]),t("p",{staticClass:"modal-description"},[e._v("By using the chatbot, you agree (1) to be bound by the BMW "),t("a",{attrs:{href:"https://www.bmwusa.com/content/dam/bmw/common/footer/pdf/BMW-Terms-20240613.pdf.asset.1720805387970.pdf",target:"_blank"}},[t("b",[e._v("Terms")])]),e._v(" and "),t("a",{attrs:{href:"https://my.bmwusa.com/privacypolicy",target:"_blank"}},[t("b",[e._v("Privacy Policy")])]),e._v("; (2) that we may use third-party service providers to provide the chatbot; and (3) that we may record and store your interactions with the chatbot.")])]},proxy:!0},{key:"footer",fn:function(){return[t("div",{staticClass:"cta-container"},[t("WhizButton",{attrs:{theme:"blue",size:"xlg"},nativeOn:{click:function(s){return e.acceptLegal.apply(null,arguments)}}},[e._v(" Accept ")])],1)]},proxy:!0}])})],1)},si=[],ii=b(ei,ti,si,!1,null,"da522661",null,null);const ni=ii.exports;const ri={name:"WhizApp",components:{ClearHistoryContents:Xe,WhizError:Fs,WhizResponse:Ps,WhizSuggestions:Ae,LegalPopupContents:Js,LegalModalContents:ni},data(){return{input_chat:"",chatSubmittedOnce:!1}},computed:{...te(["chats","showLoading","isClearChatModalOpen","isLegalModalOpen","isLegalAccepted","isDotMenuOpen","currentIntention","hasSdkError","hasWhizError","showLoading"])},mounted(){x.init(),this.autoScrollDown(),PubSub.subscribe("chatbot-logs",()=>{x.printLogs()})},methods:{closeContainer(){PubSub.publish("chatbot.close",!0)},toggleDotMenu(){this.isDotMenuOpen?this.$store.dispatch("updateIsDotMenuOpen",!1):this.$store.dispatch("updateIsDotMenuOpen",!0)},closeDotMenu(){this.$store.dispatch("updateIsDotMenuOpen",!1)},handleDotMenuClickOutside(n){this.$refs.dotMenu&&!this.$refs.dotMenu.contains(n.target)&&!this.$refs.dotMenuButton.contains(n.target)&&this.closeDotMenu()},handleDotMenuEscKey(n){(n.key==="Escape"||n.keyCode===27)&&this.closeDotMenu()},openLegalModal(){this.$store.dispatch("updateLegalModalOpen",!0)},cleanHistory(){this.$refs.cleanHistoryContent.showModal(),this.closeDotMenu()},submitChat(){this.showLoading||(this.input_chat.length>1&&(x.sendUserMessage(this.input_chat),window._satellite&&!this.chatSubmittedOnce&&window._satellite.track("AA_DC_ChatBotInteraction"),this.chatSubmittedOnce=!0),this.input_chat="",this.isLegalAccepted||this.$store.dispatch("updatePopupOpen",!0))},autoScrollDown(){const n=this.$el.querySelector(".whizapp__chat-container"),e={childList:!0},t=function(i,a){var r;for(let o of i)if(o.type==="childList"){const l=n.getElementsByClassName("whizapp__chat-item"),c=(r=l[l.length-1])==null?void 0:r.offsetTop;n.scrollTo({top:c-80,left:0,behavior:"smooth"})}};new MutationObserver(t).observe(n,e)}},watch:{isDotMenuOpen(n){n?(document.addEventListener("click",this.handleDotMenuClickOutside,{capture:!0}),document.addEventListener("keydown",this.handleDotMenuEscKey,{capture:!0})):(document.removeEventListener("click",this.handleDotMenuClickOutside,{capture:!0}),document.removeEventListener("keydown",this.handleDotMenuEscKey,{capture:!0}))},showLoading(n){if(n){const e=this.$el.querySelector(".whizapp__chat-container");setTimeout(()=>{e.scrollTo({top:e.scrollHeight,left:0,behavior:"smooth"})},100)}}}};var oi=function(){var e=this,t=e._self._c;return t("div",{staticClass:"whizapp"},[t("header",[t("div",{staticClass:"whizapp__header-label"},[t("svg",{staticClass:"whizapp__header-logo",attrs:{"aria-hidden":"true"}},[t("use",{attrs:{"xmlns:xlink":"http://www.w3.org/1999/xlink","xlink:href":"#icon-bmw-logo-gray"}})]),t("div",{staticClass:"whizapp__header-title"},[e._v("Concierge")])]),t("div",{staticClass:"whizapp__header-menu"},[t("button",{ref:"dotMenuButton",attrs:{type:"button","aria-label":"open dropdown to clear history"},on:{click:e.toggleDotMenu}},[t("svg",[t("use",{attrs:{"xmlns:xlink":"http://www.w3.org/1999/xlink","xlink:href":"#icon-vertical-dots"}})])]),t("button",{attrs:{type:"button","aria-label":"minimize chatbot"},on:{click:e.closeContainer}},[t("svg",[t("use",{attrs:{"xmlns:xlink":"http://www.w3.org/1999/xlink","xlink:href":"#icon-minimize"}})])])]),e.isDotMenuOpen?t("div",{ref:"dotMenu",staticClass:"dot-menu-container"},[t("button",{staticClass:"clear-history-button",on:{click:e.cleanHistory}},[t("svg",[t("use",{attrs:{"xmlns:xlink":"http://www.w3.org/1999/xlink","xlink:href":"#icon-garbage-bin"}})]),e._v(" Clear chat history ")])]):e._e()]),t("main",[t("div",{staticClass:"whizapp__chat-container",attrs:{"aria-live":"polite","aria-atomic":"true","aria-relevant":"additions"}},[e.hasSdkError?t("div",{staticClass:"whizapp__chat-item"},[t("WhizError",{attrs:{message:"There appears to have been a problem loading the chat"}})],1):e._l(e.chats,function(s,i){var a,r,o,l;return t("div",{key:`chat_${i}`,staticClass:"whizapp__chat-item",class:s.isWhizMessage?"whizapp__chat-item--whiz":"whizapp__chat-item--user"},[s.isWhizMessage?t("WhizResponse",{attrs:{chat:s,chatIndex:i}}):((r=(a=s==null?void 0:s.entry)==null?void 0:a.metadata)==null?void 0:r.type)==="USER_REPLY"?t("div",{staticClass:"whiz-user"},[s.entry.timestamp?t("time",[e._v(e._s(new Date(s.entry.timestamp).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit",hour12:!0})))]):e._e(),(l=(o=s==null?void 0:s.entry)==null?void 0:o.metadata)!=null&&l.title?t("p",{staticClass:"whiz-user__text"},[e._v(e._s(s.entry.metadata.title))]):e._e()]):t("div",{staticClass:"whiz-user"},[s.entry.timestamp?t("time",[e._v(e._s(new Date(s.entry.timestamp).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit",hour12:!0})))]):e._e(),s.entry.text?t("p",{staticClass:"whiz-user__text"},[e._v(e._s(s.entry.text))]):e._e()])],1)}),e.hasWhizError?t("div",{staticClass:"whizapp__chat-item"},[t("WhizError",{attrs:{message:"There was a Whiz error"}})],1):e._e(),t("div",{directives:[{name:"show",rawName:"v-show",value:e.showLoading&&!e.hasSdkError,expression:"showLoading && !hasSdkError"}],staticClass:"whizapp__chat-loading"},[t("div",{staticClass:"whiz-response whiz-response__header whiz-response__loading"},[t("div",{staticClass:"whiz-response__icon"},[t("svg",[t("use",{attrs:{"xmlns:xlink":"http://www.w3.org/1999/xlink","xlink:href":"#icon-chatbot-star"}})])]),t("div",{staticClass:"whiz-response__loading-content"},[t("time",[e._v(e._s(new Date().toLocaleTimeString([],{hour:"2-digit",minute:"2-digit",hour12:!0})))]),t("div",{staticClass:"whiz-loader"})])])])],2)]),t("footer",[t("div",{staticClass:"whizapp__chat-input"},[t("input",{directives:[{name:"model",rawName:"v-model",value:e.input_chat,expression:"input_chat"}],attrs:{type:"text",placeholder:"Message BMW Concierge...",required:""},domProps:{value:e.input_chat},on:{keyup:function(s){return!s.type.indexOf("key")&&e._k(s.keyCode,"enter",13,s.key,"Enter")?null:e.submitChat.apply(null,arguments)},input:function(s){s.target.composing||(e.input_chat=s.target.value)}}}),t("button",{attrs:{type:"button",disabled:e.showLoading,"aria-label":"send to chatbot"},on:{click:e.submitChat}},[t("svg",[t("use",{attrs:{"xmlns:xlink":"http://www.w3.org/1999/xlink","xlink:href":"#icon-chatbot-up-arrow"}})])])]),t("p",{staticClass:"whizapp__disclaimer"},[t("svg",{attrs:{"aria-hidden":"true"}},[t("use",{attrs:{"xmlns:xlink":"http://www.w3.org/1999/xlink","xlink:href":"#icon-lock"}})]),e._v(" This is a generative AI chatbot. "),t("button",{attrs:{type:"button"},on:{click:e.openLegalModal}},[e._v("Click to learn more")]),e._v(". ")])]),t("ClearHistoryContents",{ref:"cleanHistoryContent"}),t("LegalModalContents")],1)},li=[],ci=b(ri,oi,li,!1,null,"10d2ce2b",null,null);const di=ci.exports,hi={name:"Chatbot",components:{WhizApp:di},data(){return{globalNavElem:null}}};var ui=function(){var e=this,t=e._self._c;return t("div",{staticClass:"chatbot-container"},[t("WhizApp")],1)},pi=[],gi=b(hi,ui,pi,!1,null,null,null,null);const mi=gi.exports;new De({el:"#bmwusa-chatbot-container",name:"Chatbot Container Component",isMounted:!1,subscriptions:{"chatbot.open":"open","chatbot.close":"close","chatbot.updateContext":"updateContext"},init(){this.handleEscKey=this.handleEscKey.bind(this),Pe(function(){document.addEventListener("set_user_completed",()=>{var n,e;(e=(n=window.ai)==null?void 0:n.user)!=null&&e.whizEnabled&&$.qs(".chatbot-container").removeAttribute("style")})})},open(){this.isMounted?x.updateConnection():(new ye({store:H,render:e=>e(mi)}).$mount("#bmwusa-chatbot-container"),this.isMounted=!0),$.qs(".chatbot-container").classList.add("active"),$.qs("#bmwusa-chatbot").classList.add("hidden"),$.qs(".chatbot-anchor > .chatbot-button")&&$.qs("#bmwusa-chatbot-clone").classList.add("hidden"),document.addEventListener("keydown",this.handleEscKey,{capture:!0}),window._satellite&&window._satellite.track("AA_DC_ChatBotOpen")},close(){$.qs(".chatbot-container").classList.remove("active"),$.qs(".chatbot-anchor > .chatbot-button")?$.qs("#bmwusa-chatbot-clone").classList.remove("hidden"):$.qs("#bmwusa-chatbot").classList.remove("hidden"),H.dispatch("updateIsDotMenuOpen",!1),H.dispatch("updateClearChatModalOpen",!1),document.removeEventListener("keydown",this.handleEscKey,{capture:!0}),window._satellite&&window._satellite.track("AA_DC_ChatbotClose")},updateContext(n,e){const t=$.qs(".chatbot-button");if(t){const s=e.series&&e.series.startsWith("M")&&e.series.length<3?`${e.series.substr(-1)} Series`:e.series;t.setAttribute("data-current-series",s||""),t.setAttribute("data-current-model",e.model?e.model:"")}},handleEscKey(n){(n.key==="Escape"||n.keyCode===27)&&this.close()}});</script>
</body>
</html>
