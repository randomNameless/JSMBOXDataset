<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>mySpotModal.html</title>
</head>
<body>

<script>
"use strict";function _typeof(a){"@babel/helpers - typeof";return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a})(a)}var VModal=window["vue-js-modal"]["default"];Vue.use(VModal),Vue.component("paginate",VuejsPaginate);var N_MODAL_MY_DATA={mySpotModalComponent:{data:function(){return{isVue:IS_VUE,imagePath:NAVITIME_WEB.IMAGE.STATIC_URL+"img/",allSpotList:[],folderData:[],selectMySpotList:[],selectTabNumber:0,parPage:20,offset:0,currentPage:1}},components:{"v-modal":VModal},created:function(){0===this.allSpotList.length&&this.fetchAllMySpotList(),0===this.folderData.length&&this.fetchMySpotList(),this.changeShowFolderList(0)},computed:{getMySpotMap:function(){var a=new Map;a.set(0,this.allSpotList);var b=1;return this.folderData.forEach(function(c){if(0!==c.myFolder.mySpotList.length){var d=c.mySpotList.map(function(a){return a});a.set(b,d),b++}}),a},getPageCount:function(){if(0!==this.getFolderContainSpots.length){var a=0;return 0!==this.selectTabNumber?a=this.getFolderContainSpots[this.selectTabNumber-1].myFolder.count:this.getFolderContainSpots.forEach(function(b){a+=b.myFolder.count}),Math.ceil(a/this.parPage)}return 0},getFolderContainSpots:function(){return this.folderData.filter(function(a){return 0!==a.myFolder.mySpotList.length})},modalCloseBool:function(){return this.isVue}},methods:{showModalDef:function(){this.$modal.show("modal-contents")},showMySpotModal:function(){this.isVue?this.$modal.show("modal-contents"):$("#js-vue-spot-modal").show()},hideMySpotModal:function(){this.isVue?this.$modal.hide("modal-contents"):$("#js-vue-spot-modal").hide()},fetchAllMySpotList:function(a){axios.get("/async/my/all/spot",{params:{_:Date.now(),limit:20,offset:this.offset}}).then(function(b){a?this.selectMySpotList=b.data:(this.allSpotList=b.data,this.changeShowFolderList(this.selectTabNumber))}.bind(this))},fetchMySpotList:function(a){this.loading=!0,axios.get("/async/my/spot/list",{params:{_:Date.now(),folderId:a,limit:20,offset:this.offset}}).then(function(b){a?this.selectMySpotList=b.data[0].mySpotList:(this.folderData=b.data,this.changeShowFolderList(this.selectTabNumber)),this.loading=!1}.bind(this))},getCategoryImg:function(a){return!a||"null"===a||a.startsWith("0",1)?this.imagePath+"category/category_icon_genre_00_919191.svg":a.startsWith("08")?a.startsWith("0802001")?this.imagePath+"category/icon-train.svg":a.startsWith("0802002")?this.imagePath+"category/icon-airplane.svg":a.startsWith("0802003")?this.imagePath+"category/icon-ferry.svg":a.startsWith("0821")||a.startsWith("0806002")||a.startsWith("0806003")?this.imagePath+"category/icon-bicycle.svg":a.startsWith("0805")||a.startsWith("0812")||a.startsWith("0819")?this.imagePath+"category/icon-parking.svg":a.startsWith("0815")?this.imagePath+"category/icon-bus.svg":this.imagePath+"category/icon-car.svg":this.imagePath+"category/category_icon_genre_"+a.slice(0,2)+"_919191.svg"},setSpot:function(a){this.$emit("setSelectSpot",a.mySpot)},scrollTop:function(){$(".modal-contents__spot").scrollTop(0)},changeShowFolderList:function(a){this.$set(this,"selectMySpotList",this.getMySpotMap.get(a)),this.$set(this,"selectTabNumber",a),this.currentPage=0,this.offset=0,this.resetPagenate()},resetPagenate:function(){document.getElementsByClassName("page-item")[0]&&document.getElementsByClassName("page-item")[0].getElementsByTagName("a")[0].click()},clickCallback:function(a){if(this.currentPage=Number(a),this.offset=20*(this.currentPage-1),0===this.selectTabNumber){var b=!0;this.fetchAllMySpotList(b)}else this.fetchMySpotList(this.selectMySpotList[0].folderId);this.scrollTop()}},template:'\n      <div class="my-spot">\n        <template v-if=\'isVue\'>\n          <div class="my-spot__btn" @click="showMySpotModal">\n            <div class="my-spot__btn__img">\n              <img :src="imagePath + \'top/autocomplete/star.svg\'" />\n            </div>\n            <div class="my-spot__btn__text">My地点</div>\n          </div>\n        </template>\n        <modal\n          name="modal-contents"\n          :width="800"\n          :height="550"\n          :clickToClose="modalCloseBool"\n        >\n          <div class="modal-contents">\n            <div class="modal-contents__head">\n              <h2 class="modal-contents__head__title">My地点</h2>\n              <div class="modal-contents__head__close" @click="hideMySpotModal">\n                <img\n                  :src="\n                    imagePath +\n                    \'route/comparison/point/cross-mark/gray_666666.svg\'\n                  "\n                alt="x"\n                />\n              </div>\n            </div>\n            <template v-if="allSpotList.length == 0">\n              <a href="/account/my/spot" class="modal-contents__error">\n                My地点を登録する\n              </a>\n            </template>\n            <template v-else>\n              <ul class="modal-contents__tab__list">\n                <li\n                  class="modal-contents__tab__item"\n                  :class="{\n                    \'modal-contents__tab__item--active\': selectTabNumber == 0,\n                  }"\n                  @click="changeShowFolderList(0)"\n                >\n                  すべてのMy地点\n                </li>\n                <li\n                  v-for="(folder, index) in getFolderContainSpots"\n                  class="modal-contents__tab__item"\n                  :class="{\n                    \'modal-contents__tab__item--active\':\n                    selectTabNumber == index + 1,\n                  }"                  \n                  @click="changeShowFolderList(index + 1)"\n                >\n                  {{ folder.myFolder.folderName }}\n                </li>\n              </ul>\n\n              <div class="modal-contents__spot">\n                <ul v-for="spot in selectMySpotList">\n                  <li class="modal-contents__spot__item" @click="setSpot(spot)">\n                    <div class="modal-contents__spot__item__category">\n                      <img\n                        :src="getCategoryImg(spot.mySpot.cateCode)"\n                        alt="category"\n                      />\n                    </div>\n                    <div class="modal-contents__spot__item__text">\n                      <div class="modal-contents__spot__item__name">\n                        {{ spot.mySpot.name }}\n                      </div>\n                      <div\n                        v-if="spot.address"\n                        class="modal-contents__spot__item__address"\n                      >\n                        ({{ spot.mySpot.address }})\n                      </div>\n                    </div>\n                  </li>\n                </ul>\n                <div v-if="selectMySpotList && selectMySpotList.length > 0">                  \n                  <paginate\n                    :page-count="getPageCount"\n                    :page-range="3"\n                    :margin-pages="2"\n                    :click-handler="clickCallback"\n                    :prev-text="\'＜\'"\n                    :next-text="\'＞\'"\n                    :container-class="\'pagination\'"\n                    :page-class="\'page-item\'">\n                  </paginate>\n                </div>\n              </div>                    \n            </template>\n          </div>\n        </modal>\n      </div>\n    '}};if(!IS_VUE)var app=new Vue({el:"#my-spot-modal",data:{mySpotList:[]},components:{mySpotModalComponent:N_MODAL_MY_DATA.mySpotModalComponent},methods:{selectSpot:function(a){$("#js-my-spot-modal__select-poi input[name='name']").val(a.name),$("#js-my-spot-modal__select-poi input[name='lat']").val(a.lat),$("#js-my-spot-modal__select-poi input[name='lon']").val(a.lon),$("#js-my-spot-modal__select-poi input[name='nodeId']").val(a.nodeId),$("#js-my-spot-modal__select-poi input[name='tel']").val(a.tel),$("#js-my-spot-modal__select-poi input[name='note']").val(a.note),$("#js-my-spot-modal__select-poi input[name='provId']").val(a.provId),$("#js-my-spot-modal__select-poi input[name='spotId']").val(a.spotId),$("#js-my-spot-modal__select-poi input[name='cateCode']").val(a.cateCode),$("#js-my-spot-modal__select-poi input[name='exeCode']").val(a.exeCode),$("#js-my-spot-modal__select-poi input[name='advId']").val(a.advId),$("#js-my-spot-modal__select-poi input[name='key']").val(a.key),$("#js-my-spot-modal__select-poi input[name='dispList']").val(a.dispList),$("#js-my-spot-modal__select-poi input[name='nameKana']").val(a.nameKana),$("#js-my-spot-modal__select-poi input[name='address']").val(a.address),$("#js-my-spot-modal__select-poi input[name='folderId']").val(a.folderId);var b=$("#js-my-spot-modal__select-poi").children("input"),c={};b.each(function(a,b){c[$(b).attr("name")]=$(b).val()}),c.coord={lat:c.lat,lon:c.lon},delete c.lat,delete c.lon;var d=$("#"+$("#select-box-for-vue").val()).parents(".search-box-content");return 0==d.length?this.setAroundPoiBoxInfo(a):(this.setPoiBoxInfo(d,c),this.$refs.myspot.hideMySpotModal(),void $("#select-box-for-vue").val(""))},setAroundPoiBoxInfo:function(a){var b="/maps/poi?";a.nodeId&&(b+="id="+a.nodeId+"&"),a.provId&&a.spotId?b+="code="+a.provId+"-"+a.spotId+"&":a.advId&&(b+="code="+a.advId+"&"),a.name&&(b+="name="+a.name+"&"),a.lat&&a.lon&&(b+="lat="+a.lat+"&lon="+a.lon),location.href=b},setPoiBoxInfo:function(a,b){"object"===_typeof(b)?(a.find("input[type=text]").val(b.name).addClass("selected"),a.find("input[type=text]").nextAll(".search-btn").attr("disabled",!0),a.find("input[type=hidden]").val(JSON.stringify(b)),a.find("#stay_time_select").show()):"string"==typeof b&&(a.find("input[type=text]").val(b).removeClass("selected"),a.find("input[type=text]").nextAll(".search-btn").attr("disabled",!1),a.find("input[type=hidden]").val(""),a.find("#stay_time_select").hide()),"via"===a.data("box")&&this.onChangeViaBox()},onChangeViaBox:function(){var a=!1;$(".route-search-via-box").each(function(){var b=$(this).find("input[type=hidden]").val();b&&(a=!0)}),a?($("#route-search-total-cond .move-cond").hide(),$("#route-search-total-cond #railwayCommuterPass").remove()):($("#route-search-total-cond .move-cond").show(),$("#route-search-total-cond #railwayCommuterPass").show(),$("#route-search-total-cond select[name='order']").append($("#route-search-total-cond select[name='order'] option")))}},mounted:function(){this.$refs.myspot.showModalDef()},template:"\n      <div>\n        <mySpotModalComponent ref='myspot' @setSelectSpot='selectSpot'></mySpotModalComponent>\n      </div>\n    "});
</script>

</body>
</html>
