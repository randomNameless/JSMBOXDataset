<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>acc.myaccount.min.html</title>
</head>
<body>

<script>
ACC.myaccount={_autoload:["bindLoginCredntials","bindShippingAddress","bindMfaResendEvent","bindPaymentMethod"],handleAddressSubmit:function(c,a){var b=false;$(c+' form input:not([type="hidden"]):not([disabled]), '+c+" form select").each(function(){if(($(this).val()==""||$(this).val()==null)&&!$(this).hasClass("address2-optional")){b=true}});if(b){$(a).attr("disabled","disabled")}else{$(a).removeAttr("disabled")}},bindLoginCredntials:function(){$(document).on("click","#mfaVerificationModalSubmit",function(b){b.preventDefault();var a="";$(".verify-code > input").each(function(){a+=this.value});console.log("MFACODE = "+a);oFormObject=document.forms.mfaVerificationForm;oFormObject.elements.mfaCode.value=a;$.ajax({url:"/my-account/mfa/verify",type:"POST",data:$("#mfaVerificationForm").serialize(),success:function(e,d,f){var c=$(e).find("#ajaxResult").attr("data-result");if(c==="error"){$("#append-mfa-error").html(e)}else{window.location.href="/my-account/login-credentials?ajaxResult=success"}},error:function(d,c,e){window.location.href="/my-account/login-credentials?ajaxResult=success"}})});$(document).on("keyup","#updateEmailForm input",function(b){$(this).parent().removeClass("form-error error");var a=$(this).attr("name");$("#error_"+a).hide()});if($("body").hasClass("page-login-credentials")){$("#update-email-button").on("click",function(){var a=$(this).data("emailvalidation");$.ajax({url:"/my-account/update-email",type:"POST",data:$("#updateEmailForm").serialize(),success:function(e,c,g){var b=$(e).find("#ajaxResult").attr("data-result");oFormObject=document.forms.updateEmailForm;var d=$(e).find("#ajaxResult").attr("data-emailvalidationrequired");if(a&&d!=undefined){oFormObject.elements.emailValidationRequired.value=d;$("#emailValidationRequired").prop("checked",d)}if(b==="success"){window.location.href="/my-account/login-credentials?ajaxResult=success"}else{if(b==="exception"){$("#append-upadate-email-form").html(e)}else{if(b==="error"){ACC.myaccount.checkAndDisplayError(JSON.parse(ACC.myaccount.getValue(e,"#formErrorField")))}else{if(b==="emailValidationPopup"){oFormObject.elements.showEmailValidationPopup.value=$(e).find("#ajaxResult").attr("data-showemailvalidationpopup");$("#showEmailValidationPopup").prop("checked",$(e).find("#ajaxResult").attr("data-showemailvalidationpopup"));var h=$("#emailValidationRequired").is(":checked");var f=$("#showEmailValidationPopup").is(":checked");if(h&&f){$("#model-button").click();ACC.analytics.fireErrorEvent1("validity_email_validation_error","[serverside]","[Validity:double check your email]")}}else{$("#mfaModal").modal("show");$("#mfaModal").html(e)}}}}},error:function(c,b,d){console.log("Error "+c)}})});$(document).on("keyup",".verify-code > input",function(b){var a=false;$(".verify-code > input").each(function(){if($(this).val()==""){a=true}});if(a){$("#mfaVerificationModalSubmit").attr("disabled","disabled")}else{$("#mfaVerificationModalSubmit").removeAttr("disabled")}})}},bindShippingAddress:function(){$(".add-edit-shipping-address").on("click",function(){var a=document.querySelector(".telephone-international");var b=window.intlTelInput(a,{utilsScript:"https://cdn.jsdelivr.net/npm/intl-tel-input@17.0.3/build/js/utils.js"});b.setCountry($("#address\\.country option:selected").val())});$(document).on("click","#submit-add-address",function(a){a.preventDefault();$.ajax({url:"/my-account/add-address",type:"POST",data:$("#addressForm").serialize(),success:function(c,b,e){var d=$($.parseHTML(c)).find("#addrSubmitDataResult").attr("data-result");if(d==="success"){$("#shippingDetailsModal").css("display","none");window.location.href="/my-account/address-book?ajaxResult=add"}else{if(d==="error"){$("#shippingDetailsModal").html(c)}else{$(".second-view").addClass("show-view");$(".first-view").css("display","none");$("#account-suggested-address").html(c)}}},error:function(c,b,d){}})});$(document).on("keyup","#myaccount-address-form form input, #myaccount-address-form form select",function(a){ACC.myaccount.handleAddressSubmit("#myaccount-address-form","#submit-add-address")});$(document).on("change","#myaccount-address-form form input, #myaccount-address-form form select",function(a){ACC.myaccount.handleAddressSubmit("#myaccount-address-form","#submit-add-address")});$(document).on("keyup","#myaccount-editaddress-form form input, #myaccount-editaddress-form form select",function(a){ACC.myaccount.handleAddressSubmit("#myaccount-editaddress-form","#submit-edit-address")});$(document).on("change","#myaccount-editaddress-form form input, #myaccount-editaddress-form form select",function(a){ACC.myaccount.handleAddressSubmit("#myaccount-editaddress-form","#submit-edit-address")});$(document).on("click","#submit-edit-address",function(b){b.preventDefault();var a=$(this).data("url");$.ajax({url:a,type:"POST",data:$(".editAddressForm").serialize(),success:function(d,c,f){var e=$($.parseHTML(d)).find("#addrSubmitDataResult").attr("data-result");if(e==="success"){$("#editShippingDetailsModal").css("display","none");window.location.href="/my-account/address-book?ajaxResult=update"}else{if(e==="error"){$("#editShippingDetailsModal").html(d)}else{$(".second-view").addClass("show-view");$(".first-view").css("display","none");$("#account-editsuggested-address").html(d)}}},error:function(d,c,e){}})});$(".edit-addres-modal").on("click",function(){$("#suggestPrefixClass").val("portEditAddress");var a=$(this).data("url");$.ajax({url:a,type:"GET",dataType:"html",success:function(c,b,d){$("#editShippingDetailsModal").modal("show");$("#editShippingDetailsModal").html(c);form_ctl.funcs.doValidate_editAddressForm();ACC.myaccount.handleAddressSubmit("#myaccount-editaddress-form","#submit-edit-address")},error:function(c,b,d){}})});$(".remove-addres-modal").on("click",function(){var a=$(this).data("url");$.ajax({url:a,type:"GET",success:function(c,b,d){$("#removeShippingDetailsModal").modal("show");$("#removeShippingDetailsModal").html(c)},error:function(c,b,d){}})});$(document).on("keyup","#address\\.postcode",function(c){var b=$("#address\\.country option:selected").val();var a=$(this).val();if(a.length>=5){$.ajax({url:"/util/get-address?postalCode="+a+"&countryIso="+b,type:"GET",success:function(e,d,f){if(e.city){$("#address\\.townCity").val(e.city)}if(e.state){$("#address\\.region").val(e.state);ACC.myaccount.processSelect($("#address\\.region"))}},error:function(e,d,f){console.log("error occurred while fetching address from zipcode")}})}})},bindMfaResendEvent:function(){let clickCnt=0;$(document).on("click","#resendMfaCode",function(a){a.preventDefault();clickCnt++;console.log("Click count = ",clickCnt);if(clickCnt==4){$(this).addClass("disableLink")}let data={};data.emailId=$("#emailId").val();data.mfaAction=$("#mfaAction").val();$.ajax({type:"POST",url:"/mfa/resend",data:$.param(data),success:function(c){if(c==="SUCCESS"){console.log("Successfully sent the MFA code");$("p[name='resend-mfa-msg']").css("opacity",0);$("p[name='sent-mfa-msg']").css("opacity",1);const b=setTimeout(function(){$("p[name='resend-mfa-msg']").css("opacity",1);$("p[name='sent-mfa-msg']").css("opacity",0);clearTimeout(b)},5000)}else{console.log("Couldn't send the MFA code, check hybris log for more details")}},error:function(c,d,b){console.log("Failed to send the MFA code. Error details ["+c+", "+d+", "+b+"]")}})})},bindPaymentMethod:function(){$(".add-payment-modal").on("click",function(){$("#addPaymentModal").modal("show")});$(".submit_addNewPaymentDetailsButton").on("click",function(a){a.preventDefault();var b=true;if($('input[name="payment-default-address"]:checked').length>0){oFormObject=document.forms.paymentDetailsForm;oFormObject.elements.defaultPaymentMethod.value=b}if($('input[name="payment-shipping-address"]:checked').length>0){oFormObject=document.forms.paymentDetailsForm;oFormObject.elements.saveAsShippingAddress.value=b}$.ajax({url:"/my-account/billing-address",type:"POST",data:$("#paymentDetailsForm").serialize(),success:function(e,d,f){var c=$(e).find("#ajaxResult").attr("data-result");if(c==="success"){ACC.paymentDetails.submit_addNewPaymentDetailsButton()}else{if(c==="error"){ACC.myaccount.checkAndDisplayErrorForAddress(JSON.parse(ACC.myaccount.getValue(e,"#formErrorField")))}else{if(c==="exception"){window.location.href="/my-account/payment-details?ajaxResult=error"}else{if(c==="avsReview"){$(".first-view").removeClass("show-view");$(".second-view").addClass("show-view");$(".first-view").css("display","none");$("#suggested-billing-address").html(e)}else{$("#addPaymentModal").modal("show")}}}}},error:function(d,c,e){console.log("Error "+d)}})});$(".remove-payment-modal").on("click",function(){var a=$(this).data("url");$.ajax({url:a,type:"GET",success:function(c,b,d){$("#removePaymentModal").modal("show");$("#removePaymentModal").html(c)},error:function(c,b,d){}})});$(document).on("click","#use_suggested_billing_address_button",function(a){a.preventDefault();if($("input:radio[name=addressType]:checked").val()=="entered"){ACC.myaccount.submitAddPayment(false)}else{ACC.myaccount.submitAddPayment(true)}});$(".edit-payment-modal").on("click",function(){var a=$(this).data("url");var b=$(this).data("buttontxt");$.ajax({url:a,type:"GET",success:function(d,c,e){$("#addPaymentModal").modal("show");form_ctl.funcs.doValidate_paymentDetailsForm();$("#lastInTheForm").text(b);$(".paymentaddressFirstName").val(d.billingAddress.firstName);$(".paymentaddressLastName").val(d.billingAddress.lastName);$(".paymentaddressLine1").val(d.billingAddress.line1);$(".paymentaddressLine2").val(d.billingAddress.line2);$(".paymentaddressPostcode").val(d.billingAddress.postalCode);$(".paymentaddressPhone").val(d.billingAddress.phone);$(".paymentaddressTown").val(d.billingAddress.town);$(".paymentaddressRegion").val(d.billingAddress.region.isocode);ACC.myaccount.processSelect($(".paymentaddressRegion"));$(".edit-pm_cc_exp_year").val(d.expiryYear.slice(-2));ACC.myaccount.processSelect($(".edit-pm_cc_exp_year"));ACC.paymentDetails.fillPaymetricField("Paymetric_Exp_Year",d.expiryYear.slice(-2),"#card_expirationYear");$(".edit-pm_cc_start_month").val(d.expiryMonth);ACC.myaccount.processSelect($(".edit-pm_cc_start_month"));ACC.paymentDetails.fillPaymetricField("Paymetric_Exp_Month",d.expiryMonth,"#card_expirationMonth");$("#paymentId").val(d.id);$(".paymentaddressLine2").trigger("change")},error:function(d,c,e){}})});$(document).on("keyup","#paymentDetailsForm input, #paymentDetailsForm select, #pm_RequestForm input, #pm_RequestForm select",function(c){var b=false;$('#paymentDetailsForm input:not([type="hidden"]):not([type="checkbox"]):not([disabled]), #paymentDetailsForm select').each(function(){if($(this).val()==""&&!$(this).hasClass("paymentaddressLine2")){b=true}});$('#pm_RequestForm input:not([type="hidden"]):not([type="checkbox"]):not([disabled]), #pm_RequestForm select').each(function(){if($(this).val()==""&&this.id!="Paymetric_Start_Month"&&this.id!="Paymetric_Start_Year"&&this.id!="Paymetric_IssuerNumber"){b=true}});if(b){$(".submit_addNewPaymentDetailsButton").attr("disabled","disabled")}else{var a=$("#pm_RequestForm").valid();var d=$("#paymentDetailsForm").valid();if(!a||!d){$(".submit_addNewPaymentDetailsButton").attr("disabled","disabled")}else{$(".submit_addNewPaymentDetailsButton").removeAttr("disabled")}}});$(document).on("change","#paymentDetailsForm input, #paymentDetailsForm select, #pm_RequestForm input, #pm_RequestForm select",function(b){var a=false;$('#paymentDetailsForm input:not([type="hidden"]):not([type="checkbox"]):not([disabled]), #paymentDetailsForm select').each(function(){if($(this).val()==""&&!$(this).hasClass("paymentaddressLine2")){a=true}});$('#pm_RequestForm input:not([type="hidden"]):not([type="checkbox"]):not([disabled]), #pm_RequestForm select').each(function(){if($(this).val()==""&&this.id!="Paymetric_Start_Month"&&this.id!="Paymetric_Start_Year"&&this.id!="Paymetric_IssuerNumber"){a=true}});if(a){$(".submit_addNewPaymentDetailsButton").attr("disabled","disabled")}else{$(".submit_addNewPaymentDetailsButton").removeAttr("disabled")}});$(document).on("keyup","#paymentAddressForm input",function(b){$(this).parent().removeClass("form-error error");var a=$(this).attr("name");$("#error_"+a).hide()})},submitAddPayment:function(a){if(a){oFormObject=document.forms.paymentDetailsForm;suggestedForm=document.forms.suggestedForm;oFormObject.elements["billingAddress.line1"].value=suggestedForm.elements.line1.value;oFormObject.elements["billingAddress.line2"].value=suggestedForm.elements.line2.value;oFormObject.elements["billingAddress.townCity"].value=suggestedForm.elements.townCity.value;oFormObject.elements["billingAddress.postcode"].value=suggestedForm.elements.postcode.value}ACC.paymentDetails.submit_addNewPaymentDetailsButton()},processSelect:function(a){var b=$(a);b.toggleClass("not_chosen",a.selectedIndex==0&&a.options[0].value.length==0);b.on("change",function(){$(this).toggleClass("not_chosen",this.selectedIndex==0&&this.options[0].value.length==0)})},getValue:function(b,c){var d=$(b).find(c).html();var a=$(d).val();return a},checkValidObject:function(a){if(a!=null&&a!="undefined"&&a!=""&&a!="{}"){return true}else{return false}},checkAndDisplayError:function(a){if(ACC.myaccount.checkValidObject(a)){$.each(a,function(b,c){$("#updateEmailForm").find("#error_"+b).html($.parseHTML(c));$("#updateEmailForm").find("#error_"+b).show();$("#updateEmailForm").find("#error_"+b).prev().addClass("form-error error")})}},checkAndDisplayErrorForAddress:function(a){if(ACC.myaccount.checkValidObject(a)){$.each(a,function(b,c){$("#paymentAddressForm").find("#error_"+b.replace(".","\\.")).text(c);$("#paymentAddressForm").find("#error_"+b.replace(".","\\.")).show();$("#paymentAddressForm").find("#error_"+b.replace(".","\\.")).removeClass("hidden");$("#paymentAddressForm").find("#error_"+b.replace(".","\\.")).prev().addClass("form-error error")})}}};
</script>

</body>
</html>
