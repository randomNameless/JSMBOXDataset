<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>8915-138b88313cf5a185.html</title>
</head>
<body>

<script>
"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8915],{40875:function(e,n,t){t.d(n,{s5:function(){return U},ZP:function(){return Comment},vm:function(){return O}});var a,l,i=t(91309),s=t(85893),r=t(67294);function CommentNewMark(e){var n=e.onHide,t=(0,r.useRef)(null),a=(0,i._)((0,r.useState)(null),2)[1],l=(0,r.useMemo)(function(){return new IntersectionObserver(function(e){var t=(0,i._)(e,1)[0];return a(function(e){return null!==e&&e.isIntersecting&&!t.isIntersecting&&t.boundingClientRect.top<0&&n(),t})})},[n]);return(0,r.useEffect)(function(){if(null!==t.current)return l.observe(t.current),function(){return l.disconnect()}},[l]),(0,s.jsx)("div",{ref:t})}var o=t(51905),m=t(30896),d=t(193),u=t(68075),c=t(45764),g=t(68096),v=t(34115),h=t(65400),f=t.n(h),p=t(94055),x=t(86896),y=t(44012),k=t(22578),j=t(72425),b=t(6982),C=t(16165),F=t(96842),N=t(25675),w=t.n(N),_=t(5152),K=t.n(_),S=t(27484),Z=t.n(S),V=t(26244),M=t(58545),E=t(33649),D=t(62443),I=t(44311),Comment_CommentMenu=function(e){var n=e.doUpvote,t=e.doDownvote;return(0,s.jsx)("div",{className:"comment-rating flex justify-between gap-2",children:(0,s.jsxs)("div",{className:"flex justify-end",children:[(0,s.jsx)(f(),{type:"link",onClick:n,style:{height:30},children:(0,s.jsx)("div",{"aria-label":"upvote",className:"vote-button vote-plus mr-2"})}),(0,s.jsx)(f(),{type:"link",onClick:t,style:{height:30},children:(0,s.jsx)("div",{"aria-label":"downvote",className:"vote-button vote-minus"})})]})})},B=t(17719),P=t(3490),Comment_CommentVote=function(e){var n=e.comment,t=(0,k.useFragment)(B,n),a=(0,k.useRelayEnvironment)(),l=(0,i._)((0,r.useState)(!1),2),o=l[0],m=l[1],doVote=function(e){(0,I.commitMutation)(a,{mutation:P,variables:{id:t.id,vote:e},onError:function(){m(!0)}})};if(o)return(0,s.jsx)(E.Z,{});var upvote=function(){return doVote("PLUS")},downvote=function(){return doVote("MINUS")},d=(t.rating>=3?"+":"")+(t.rating>=3||t.rating<=-3?t.rating:"≈0");return t.voted?(0,s.jsx)("div",{className:"comment-rating",children:(0,s.jsx)(M.Z,{rating:t.rating})}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"comment-rating lg:hidden",children:(0,s.jsx)(D.default,{placement:"bottomRight",title:"",content:(0,s.jsx)(Comment_CommentMenu,{doUpvote:upvote,doDownvote:downvote}),trigger:"click",children:(0,s.jsx)("div",{className:"hover:text-primary-hovered cursor-pointer underline",children:d})})}),(0,s.jsxs)("div",{className:"comment-rating hidden lg:flex gap-1",children:[(0,s.jsx)("button",{type:"button","aria-label":"Upvote",className:"vote-button vote-plus",onClick:upvote}),d,(0,s.jsx)("button",{type:"button","aria-label":"Downvote",className:"vote-button vote-minus",onClick:downvote})]})]})},L=t(42542);function _extends(){return(_extends=Object.assign?Object.assign.bind():function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])}return e}).apply(this,arguments)}var arrow_reply=function(e){return r.createElement("svg",_extends({xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",viewBox:"0 0 673 673"},e),a||(a=r.createElement("path",{"data-name":"Polygon 3",className:"arrow-reply_svg__cls-1",d:"M277.084 504.752.01 269.049 276.765 32.528Z"})),l||(l=r.createElement("path",{"data-name":"Polygon 2",className:"arrow-reply_svg__cls-1",d:"M616.467 651.388C592.3 504.969 549.71 431.8 476.872 394.709c-67.61-36.3-166.006-38.719-238.974-45.544l26.377-172.313c79.361 14.4 193.09 33.313 279 93.017 87.4 62.527 150.2 173.777 73.19 381.519"})))},A=K()(function(){return Promise.all([t.e(1272),t.e(8700),t.e(4337),t.e(2386),t.e(2891),t.e(170),t.e(8077),t.e(8465),t.e(6534),t.e(1361),t.e(5414)]).then(t.bind(t,24921))},{loadableGenerated:{webpack:function(){return[24921]}},suspense:!1}),R=K()(function(){return Promise.all([t.e(1272),t.e(8700),t.e(4337),t.e(2386),t.e(2891),t.e(170),t.e(8077),t.e(3818),t.e(8465),t.e(6534),t.e(1361),t.e(2347),t.e(8261)]).then(t.bind(t,31081))},{loadableGenerated:{webpack:function(){return[31081]}},suspense:!1}),T=K()(function(){return Promise.all([t.e(4337),t.e(4713),t.e(1187),t.e(2386),t.e(2891),t.e(4629),t.e(176),t.e(3812),t.e(9990)]).then(t.bind(t,16721))},{loadableGenerated:{webpack:function(){return[16721]}},suspense:!1}),U=t(37893),O=t(64639);function Comment(e){var n,t=e.comment,a=e.post,l=e.type,h=e.id,k=e.commentingAllowed,N=e.votingAllowed,_=e.isNew,K=e.hasChildren,S=e.highlighted,E=void 0!==S&&S,D=e.removeFromNewCommentsList,I=e.canBeBannedInTags,B=(0,m.Z)(),P=(0,j.Pi)(),U=(0,x.Z)(),O=(0,d.Z)(),H=(0,V.Z)(),Q=P.isUserBlockedByMe(t.user.username),$=(0,i._)((0,r.useState)(t.rating<-7.5||Q),2),z=$[0],G=$[1],q=(0,i._)((0,r.useState)(null!=_&&_),2),W=q[0],J=q[1],X=(0,b.Q)(t.user.id).id,Y=(0,b.Q)(a.id).id,ee=(0,b.Q)(t.id).id;(0,r.useEffect)(function(){if(E){var e;null===(e=document.getElementById("comment".concat(ee)))||void 0===e||e.scrollIntoView()}},[E,ee]);var en=(0,r.useCallback)(function(){void 0!==D&&D(ee),J(!1)},[J,ee,D]),et=(0,i._)((0,r.useState)(!1),2),ea=et[0],el=et[1],ei=(0,i._)((0,r.useState)(!1),2),es=ei[0],er=ei[1],eo=new Date(t.createdAt),em=(0,v.W)(eo),ed=em.value,eu=em.unit,ec=P.isAuthenticated&&(null===(n=P.me)||void 0===n?void 0:n.user.id)===t.user.id,eg=Z()(t.createdAt),ev=Z()().diff(eg,"minute")>=5,eh="Post"===l&&(P.superadmin||ec&&!ev&&!(void 0!==K&&K));return(0,s.jsxs)(s.Fragment,{children:[O&&W&&(0,s.jsx)("div",{className:"",children:(0,s.jsx)(CommentNewMark,{onHide:en})}),(0,s.jsxs)("div",{className:"comment".concat(t.banned?" banned":"").concat(E?" highlighted-anchor":"","\n            ").concat(W?" highlighted-new":""),id:h,onMouseEnter:W?function(){return en()}:void 0,children:["Best"===l&&1===t.level&&(0,s.jsx)("h3",{className:"dark:text-white-soft text-lg pb-3 font-bold best-comment-header",children:(0,s.jsx)(y.Z,{id:"BestComments.Header",defaultMessage:"Отличный комментарий!"})}),"Post"===l&&!es&&(0,s.jsx)("div",{className:"comment-ellipsis-button pr-2 md:pr-1.5 h-8",children:(0,s.jsx)(T,{comment:t,postId:Y,canEdit:eh,canBeBannedInTags:void 0===I?[]:I,setEditMode:er})}),z?(0,s.jsx)("div",{className:"comment-hidden",children:(0,s.jsx)(f(),{type:"link",onClick:function(){return G(!1)},children:(0,s.jsx)(y.Z,{id:"Comment.Hidden",defaultMessage:"Коммент скрыт. Показать?"})})}):(0,s.jsx)(s.Fragment,{children:es?(0,s.jsx)(R,{comment:t,editMode:es,setEditMode:er}):(0,s.jsx)("div",{className:"comment-content",children:(0,s.jsx)(L.Z,{post:a,content:t})})}),(0,s.jsxs)("div",{className:Q&&z?"hidden":"comment-footer",children:[(0,s.jsxs)("div",{className:"comment-username",children:[(0,s.jsxs)(o.Z,{route:(0,g.Z)(t.user.username),className:"flex-shrink-0",children:[" ",(0,s.jsx)("div",{className:"w-5 max-h-5 sm:w-8 sm:max-h-8 sm:h-8",children:(0,s.jsx)(w(),{src:"".concat((0,u.Z)(B,X),"/pics/avatar/user/").concat(X),title:t.user.username,alt:t.user.username,width:100,height:100,unoptimized:!0})})]}),(0,s.jsx)(o.Z,{route:(0,g.Z)(t.user.username),className:"truncate font-semibold underline hover:underline pr-4 pl-1 sm:pl-2",children:t.user.username}),(0,s.jsx)("div",{className:"hidden sm:inline flex-none font-normal",children:(0,s.jsx)(p.default,{title:U.formatRelativeTime(ed,eu,{numeric:"auto"}),children:U.formatDate(eo,{year:"numeric",month:"numeric",day:"numeric",hour:"numeric",minute:"numeric"})})}),"en"===t.locale&&"en"!==H.locale&&(0,s.jsx)("div",{className:"bg-gray-tag ml-2 px-1 rounded-sm text-white-soft",children:(0,s.jsx)(y.Z,{id:"Comment.En",defaultMessage:"en"})}),!1]}),k&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(f(),{type:"default",size:"small",shape:"round",href:"en"===t.locale&&"ru"===H.locale?"https://joyreactor.com/post/".concat(Y,"#comment").concat(ee):void 0,className:"ml-4 hidden md:inline-block",onClick:function(){el(!ea)},children:(0,s.jsx)("span",{className:"text-sm",children:(0,s.jsx)(y.Z,{id:"Comment.Respond",defaultMessage:"ответить"})})}),(0,s.jsx)(f(),{type:"default",ghost:!0,shape:"circle",size:"small",href:"en"===t.locale&&"ru"===H.locale?"https://joyreactor.com/post/".concat(Y,"#comment").concat(ee):void 0,className:"mx-6 content:ml-4 md:hidden",onClick:function(){el(!ea)},children:(0,s.jsx)(C.Z,{component:arrow_reply})})]}),"User"===l?(0,s.jsx)(o.Z,{route:(0,c.Z)(Y,ee),passHref:!0,children:(0,s.jsx)(f(),{type:"default",shape:"round",size:"small",className:"md:ml-4",children:(0,s.jsx)("span",{className:"text-sm",children:(0,s.jsx)(F.Z,{})})})}):(0,s.jsx)(o.Z,{route:(0,c.Z)(Y,ee),className:"comment-link",children:(0,s.jsx)(y.Z,{id:"Comment.Link",defaultMessage:"ссылка"})}),(0,s.jsx)("div",{className:"md:ml-auto w-10 md:w-20 justify-end flex",children:N?(0,s.jsx)(Comment_CommentVote,{comment:t}):(0,s.jsx)("div",{className:"comment-rating",children:(0,s.jsx)(M.Z,{rating:t.rating})})})]}),ea&&(0,s.jsx)(A,{parentId:t.id,postId:a.id,setFormVisibility:el})]})]})}},68915:function(e,n,t){t.d(n,{Z:function(){return CommentRender}});var a=t(40875),l=t(22578);function CommentRender(e){var n=e.comment,t=e.post,i=e.render,s=e.hasChildren,r=void 0===s||s,o=(0,l.useFragment)(a.s5,n),m=(0,l.useFragment)(a.vm,t);return null==m?null:i(o,m,r)}},58545:function(e,n,t){var a=t(85893);t(67294);var l=t(54490);n.Z=function(e){var n=e.rating,t=e.ratingGeneral;return(0,a.jsxs)("div",{className:"flex gap-1",children:[n>0?"+":"",(0,a.jsx)(l.BK,{value:n,minimumFractionDigits:1,maximumFractionDigits:1}),void 0!==t&&(0,a.jsx)("div",{className:"text-sm dark:bg-gray-tag px-0.5 rounded h-5",children:(0,a.jsx)(l.BK,{value:t,minimumFractionDigits:1,maximumFractionDigits:1})})]})}},3490:function(e,n,t){t.r(n);var a,l,i,s,r={fragment:{argumentDefinitions:a=[{defaultValue:null,kind:"LocalArgument",name:"id"},{defaultValue:null,kind:"LocalArgument",name:"vote"}],kind:"Fragment",metadata:null,name:"CommentVoteMutation",selections:[{alias:null,args:i=[l={kind:"Variable",name:"id",variableName:"id"},{kind:"Variable",name:"vote",variableName:"vote"}],concreteType:"Query",kind:"LinkedField",name:"vote",plural:!1,selections:[{alias:null,args:s=[l],concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{kind:"InlineFragment",selections:[{args:null,kind:"FragmentSpread",name:"CommentVote_comment"}],type:"Comment",abstractKey:null}],storageKey:null}],storageKey:null}],type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:a,kind:"Operation",name:"CommentVoteMutation",selections:[{alias:null,args:i,concreteType:"Query",kind:"LinkedField",name:"vote",plural:!1,selections:[{alias:null,args:s,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"rating",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"voted",storageKey:null}],type:"Comment",abstractKey:null}],storageKey:null}],storageKey:null}]},params:{cacheID:"15a2bdf35aef886d03dff6de77c7e62e",id:null,metadata:{},name:"CommentVoteMutation",operationKind:"mutation",text:"mutation CommentVoteMutation(\n  $id: ID!\n  $vote: VoteType!\n) {\n  vote(id: $id, vote: $vote) {\n    node(id: $id) {\n      __typename\n      ... on Comment {\n        ...CommentVote_comment\n      }\n      id\n    }\n  }\n}\n\nfragment CommentVote_comment on Comment {\n  id\n  rating\n  voted\n}\n"}};r.hash="86cc2c3a476046ea232bb17fd869ec42",n.default=r},17719:function(e,n,t){t.r(n);var a={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"CommentVote_comment",selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"rating",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"voted",storageKey:null}],type:"Comment",abstractKey:null};a.hash="e3b313d70e472da5c0c50f398d56f22f",n.default=a},37893:function(e,n,t){t.r(n);var a,l={argumentDefinitions:[{defaultValue:null,kind:"LocalArgument",name:"isVotable"}],kind:"Fragment",metadata:null,name:"Comment_comment",selections:[a={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,concreteType:"User",kind:"LinkedField",name:"user",plural:!1,selections:[a,{alias:null,args:null,kind:"ScalarField",name:"username",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"createdAt",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"rating",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"level",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"contentVersion",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"banned",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"contentEditedAt",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"locale",storageKey:null},{args:null,kind:"FragmentSpread",name:"EditableCommentContent_content"},{args:null,kind:"FragmentSpread",name:"Content_content"},{condition:"isVotable",kind:"Condition",passingValue:!0,selections:[{args:null,kind:"FragmentSpread",name:"CommentVote_comment"}]}],type:"Comment",abstractKey:null};l.hash="3322a3b1411af415bae89d308a69efd0",n.default=l},64639:function(e,n,t){t.r(n);var a={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"Comment_post",selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{args:null,kind:"FragmentSpread",name:"Content_post"}],type:"Post",abstractKey:null};a.hash="b5e4a9ad9194e915039a2a693dba652f",n.default=a}}]);
</script>

</body>
</html>
