<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>auth.min.html</title>
</head>
<body>

<script>
!function(){var e=function(){if(!(this instanceof e))return new e;this.cl="en",this.send_link="//"+window.location.host+"/forms/user_login/process",this.login_link="//"+window.location.host+"/user/login",this.reg_link="//"+window.location.host+"/user/reg",this.reset_link="//"+window.location.host+"/user/reset",this.logout_link="//"+window.location.host+"/user/logout",this.popupsLink="//"+window.location.host+"/static/tmpl/popups.json",this.settings_link="//"+window.location.host+"/user/settings",this.errorsLink="//"+window.location.host+"/static/tmpl/errors_forms.json",this.selectedForm="",this.login_btn="#do_login",this.reset_btn="#do_reset",this.reg_btn="#do_reg",this.logout_btn=".do_logout",this.target_list={login:this.login_link,reg:this.reg_link,reset:this.reset_link,logout:this.logout_link},this.domain,this.captcha_token="6LfxgZMaAAAAAIa35eABfSGOxv8OJDIAHuSmseDj",this.settings};e.fn=e.prototype={start:function(){let e=document.getElementById("auth_script");var t,o;return e&&(t=e.getAttribute("cl"),this.cl=t||"en"),"loading"!==document.readyState?this.init():(o=this,document.addEventListener("DOMContentLoaded",function(){o.init()})),this},setLang:function(e){this.cl=e},init:function(){var t=this;t.domain=global_domain||window.location,t.get_settings(function(e){e&&e.avatar&&0<e.avatar.length&&(document.querySelector(".site-header__login > a > i").style.backgroundImage="url('"+e.avatar+"')")}),document.querySelector("body").addEventListener("click",o=>{var e;if(o.target.closest(t.login_btn)&&(o.preventDefault(),olib.send(this.target_list.login,"get",olib.serialize(document.getElementById("login_form"),o),function(e){t.error_objects_notify(""),"ok"===e.status?t.formSuccessProcessing(e,o):t.formErrorProcessing(e,document.querySelector(".popup_login .popup__notice"))})),o.target.closest(t.reset_btn)&&(o.preventDefault(),e=document.getElementById("reset_email").value,olib.send(this.target_list.reset,"get","email="+e,function(e){"ok"===e.status?t.formSuccessProcessing(e,o):t.formErrorProcessing(e,document.querySelector(".popup_login .popup__notice"))})),o.target.closest(t.logout_btn)&&(o.preventDefault(),olib.send(this.target_list.logout,"get","",function(e){t.logout(),window.location.href="/"})),o.target.closest(t.reg_btn)&&(o.preventDefault(),olib.send(this.target_list.reg,"get",olib.serialize(document.getElementById("reg_form"),o),function(e){document.querySelector(".popup_login .popup__notice").style.display="",t.error_objects_notify(""),"ok"===e.status?t.formSuccessProcessing(e,o):t.formErrorProcessing(e,document.querySelector(".popup_login .popup__notice"))})),o.target.closest(".login__field_pass i")){let e=o.target.closest(".login__field_pass i").parentNode.querySelector("input"),t=o.target.closest(".login__field_pass i");t.classList.contains("hp")?(t.classList.remove("hp"),e.setAttribute("type","password")):(e.setAttribute("type","text"),t.classList.add("hp"))}o.target.closest(".js-login")&&(o.preventDefault(),t.load_form_errors("login"),document.querySelector(".popup")?t.openPopup(o,!1,!0,"popupLogin"):t.openPopup(o,!1,!1,"popupLogin")),o.target.closest(".js-register")&&(o.preventDefault(),t.load_form_errors("reg"),document.querySelector(".popup")?t.openPopup(o,!1,!0,"popupRegister"):t.openPopup(o,!1,!1,"popupRegister")),o.target.closest(".js-forgot")&&(o.preventDefault(),t.load_form_errors("reset"),document.querySelector(".popup")?t.openPopup(o,!1,!0,"popupForgot"):t.openPopup(o,!1,!1,"popupForgot")),o.target.closest(".popup-close")&&(o.preventDefault(),t.openPopup(o,!0)),o.target.closest(".popup-close-btn")&&(o.preventDefault(),t.openPopup(o,!0)),o.target.closest(".stay")&&(o.preventDefault(),t.openPopup(o,!0))})},openLogin:function(e){var t=this;"function"==typeof e&&(t.login_success_callback=e);e=document.querySelector(".js-login");document.querySelector(".popup")?t.openPopup(e,!1,!0,"popupLogin"):t.openPopup(e,!1,!1,"popupLogin")},openPopup:function(e,t,o,n){var r=this;if(o){let o=document.querySelector(".popup-wr");o.querySelector(".popup").remove(),fetch(this.popupsLink).then(e=>e.json()).then(e=>{let t=document.createElement("div");e[n]&&(t.innerHTML=e[n].content,t.querySelector(".popup-wr").classList.add("popup-wr_open"),t.querySelector(".popup").classList.add("opened"),o&&o.querySelector(".popup-wr .popup-centered").appendChild(t.querySelector(".popup")),r.popupOnLoad(n))}).catch(e=>{console.log(e)})}else t?((e.target||e).closest(".popup-wr_open").parentNode.remove(),document.querySelector("html").classList.remove("body-overflow")):fetch(this.popupsLink).then(e=>e.json()).then(e=>{let t=document.createElement("div");e[n]&&(t.innerHTML=e[n].content,t.querySelector(".popup-wr").classList.add("popup-wr_open"),t.querySelector(".popup").classList.add("opened"),document.querySelector("body").appendChild(t),document.querySelector("html").classList.add("body-overflow"),r.popupOnLoad(n))}).catch(e=>{console.log(e)})},formErrorProcessing:function(t,o){var n=this;let r=!0;o.innerHTML="",Object.keys(t.fields).map(function(e){t.fields[e]&&0<t.fields[e]&&(o.innerHTML+=(r?"":", ")+n.error_list(e,t.fields[e]),r=!1,n.error_objects_notify(e))})},formSuccessProcessing:function(e,t){"login"==this.selectedForm?(void 0!==e.uuid&&e.uuid.length?(olib.setCookie("session",e.uuid,parseInt(e.expire)),olib.setCookie("user_name",e.name,parseInt(e.expire)),localStorage.setItem("user_name",e.name),document.querySelector(".site-header__login").classList.remove("js-login"),document.querySelector(".site-header__login").classList.add("active"),document.querySelector(".site-header__login > a > span").innerHTML=e.name,document.querySelector(".site-header__login > a > i").style.backgroundImage="url('/static/img/ava-def.png')",document.querySelector(".site-header__login > a").setAttribute("href","/profile/"),this.openPopup(t,!0)):(document.querySelector("#reg_form").style.display="none",document.querySelector(".popup_login .popup__notice").style.color="white",document.querySelector(".popup__box").innerHTML='Login is successfull. Please click "Close" for continue!<br><div class="possibility__btn  popup-close-btn"><a>Close</a></div>',localStorage.setItem("user_name",e.name)),"function"==typeof this.login_success_callback?(this.login_success_callback(),this.login_success_callback=void 0):window.location.reload()):"reg"==this.selectedForm?void 0!==e.uuid&&e.uuid.length?(olib.setCookie("session",e.uuid,parseInt(e.expire)),olib.setCookie("user_name",e.name,parseInt(e.expire)),localStorage.setItem("user_name",e.name),document.querySelector(".site-header__login").classList.remove("js-login"),document.querySelector(".site-header__login > a > span").innerHTML=e.name,document.querySelector(".site-header__login > a").setAttribute("href","/profile/"),this.openPopup(t,!0),"function"==typeof this.login_success_callback?(this.login_success_callback(),this.login_success_callback=void 0):window.location.reload()):(document.querySelector("#reg_form").style.display="none",localStorage.setItem("user_name",e.name),document.querySelector(".popup_login .popup__notice").style.color="white",this.openPopup(t,!0),document.querySelector(".popup")?this.openPopup(t,!1,!0,"popupMsg"):this.openPopup(t,!1,!1,"popupMsg")):"reset"==this.selectedForm?(document.querySelector("#reset_form").style.display="none",document.querySelector(".popup_login .popup__notice").style.color="white",document.querySelector(".popup__box").innerHTML='<div style="100%"><h3 class="popup__title">New password was send to email. Please click "Close" for continue!</h3><br><div class="possibility__btn popup-close-btn"><a>Close</a></div></div>',document.querySelector(".popup__box-col_1").style.display="none",document.querySelector(".popup__box-col_2").style.display="none",document.querySelector(".forgot_suuccess").style.display=""):this.selectedForm},error_list:function(e,t){return this.form_errors[e]&&this.form_errors[e][""+t]?this.form_errors[e][""+t][this.cl]||this.form_errors[e][""+t].en:this.form_errors.unknown[599][this.cl]||this.form_errors.unknown[599].en},load_form_errors:function(t){var o=this;fetch(this.errorsLink).then(e=>e.json()).then(e=>{e&&e[t]&&(o.selectedForm=t,o.form_errors=e[t])}).catch(e=>{console.log(e)})},error_objects_notify:function(e){if("login"==this.selectedForm?"login"===e?document.querySelector(".login__field > input").classList.add("error"):"password"===e&&document.querySelector(".login__field_pass > input").classList.add("error"):"reset"===this.selectedForm?"email"===e&&document.getElementById("reset_email").classList.add("error"):"reg"===this.selectedForm?"email"===e?document.getElementById("reg_email").classList.add("error"):"password"===e?document.getElementById("reg_password").classList.add("error"):"password2"===e?document.getElementById("reg_password2").classList.add("error"):"name"===e?document.getElementById("reg_name").classList.add("error"):"agree"===e&&document.getElementById("reg_agree").classList.add("error"):this.selectedForm,""===e){let e=document.querySelectorAll(".error");e&&e.forEach(function(e){e.classList.remove("error")})}},popupOnLoad:function(e){"popupRegister"===e&&grecaptcha.render("reg_captcha_element",{sitekey:this.captcha_token}),"popupLogin"===e&&grecaptcha.render("login_captcha_element",{sitekey:this.captcha_token})},logout:function(){olib.setCookie("session","",-1),olib.setCookie("user_name","",-1)},get_settings:function(e){if(!this.settings)return this.load_settings(e);"function"==typeof e&&e(this.settings)},load_settings:function(t){var o=this;fetch(this.settings_link).then(e=>e.json()).then(e=>{if(e&&"ok"==e.status)return"function"==typeof t&&t(e.settings),o.settings=e.settings,e.settings}).catch(e=>{})}},window.oglob?oglob.oauth=e().start():window.oauth=e().start()}(),function(){var e=function(){if(!(this instanceof e))return new e;this.errorsLink="/static/tmpl/errors_forms.json",this.popupsLink="/static/tmpl/popups.json",this.domain};e.fn=e.prototype={start:function(){var e;return"loading"!==document.readyState?this.init():(e=this,document.addEventListener("DOMContentLoaded",function(){e.init()})),this},init:function(){this.domain=global_domain||window.location},send:function(e,t,o,n){"post"==t?fetch(e,{method:"POST",body:o,credentials:"same-origin"}).then(e=>e.json()).then(e=>{"function"==typeof n&&n(e)}).catch(e=>{console.log(e)}):fetch(e+(o&&0<o.length?"?"+o:""),{credentials:"same-origin"}).then(e=>e.json()).then(e=>{"function"==typeof n&&n(e)}).catch(e=>{console.log(e)})},serialize:function(e,t){(t=t||window.event).target=t.target||t.srcElement||null;var o,n="";if("object"==typeof e&&"FORM"==e.nodeName){for(i=e.elements.length-1;0<=i;i--)if((o=e.elements[i]).name&&"file"!=o.type&&"reset"!=o.type)if("select-multiple"==o.type)for(j=e.elements[i].options.length-1;0<=j;j--)o.options[j].selected&&(n+="&"+o.name+"="+encodeURIComponent(o.options[j].value).replace(/%20/g,"+"));else("submit"!=o.type&&"button"!=o.type||t.target==o)&&("checkbox"!=o.type&&"radio"!=o.type||o.checked)&&(n+="&"+o.name+"="+encodeURIComponent(o.value).replace(/%20/g,"+").replace(/%40/g,"@"))}else console.log("not form");return n.substr(1)},setCookie:function(e,t,o){var n,r="",s=this.domain&&0<this.domain.length?"domain="+this.domain+";":"";o&&((n=new Date).setTime(n.getTime()+1e3*o),r="; expires="+n.toUTCString()),document.cookie=e+"="+(t||"")+r+"; "+s+" path=/"},getCookie:function(e){for(var t=e+"=",o=document.cookie.split(";"),n=0;n<o.length;n++){for(var r=o[n];" "==r.charAt(0);)r=r.substring(1,r.length);if(0==r.indexOf(t))return r.substring(t.length,r.length)}return null},addScript:function(e,t){const o=document.getElementsByTagName("script")[0],n=document.createElement("script");n.type="text/javascript",n.async=!0,n.src=e,t&&Object.keys(t).length&&Object.keys(t).forEach(e=>n.setAttribute(e,t[e])),o.parentNode.insertBefore(n,o)},error_list:function(e,t){let o={};e=parseInt(e||0);let n="";if(500<e&&e<600){if(o[501]={},o[501].en="_OBJ_ is empty",o[501].ru="_OBJ_ не заполнен",o[502]={},o[502].en="_OBJ_ is uncorrected",o[502].ru="_OBJ_ некорректный",o[503]={},o[503].en="Value _OBJ_ to small",o[503].ru="Значение _OBJ_ слишком маленькое",o[504]={},o[504].en="Value _OBJ_ to big",o[504].ru="Значение _OBJ_ слишком большое",o[505]={},o[505].en="_OBJ_ is not equal",o[505].ru="_OBJ_ не соответствует",o[506]={},o[506].en="_OBJ_ is not found",o[506].ru="_OBJ_ не найден",o[599]={},o[599].en=t&&0<t.length?t:"Unknown error",o[599].ru=t&&0<t.length?t:"Неизвестная ошибка",o[e]){if(o[e][this.cl])n=o[e][this.cl];else{if(!o[e].en)return"Unknown Error";n=o[e].en}return n.replace(/_OBJ_/,t)}return"Unknown Error"}return"Unknown Error"},load_form_errors:function(t){fetch(this.errorsLink).then(e=>e.json()).then(e=>{if(e&&e[t])return e[t]}).catch(e=>{console.log(e)})},get_template:function(t){fetch(this.popupsLink).then(e=>e.json()).then(e=>{if(console.log(t),e&&e[t])return console.log(e[t]),e[t]}).catch(e=>{console.log(e)})},generateUUID:function(){var o=(new Date).getTime(),n=performance&&performance.now&&1e3*performance.now()||0;return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random();return 0<o?(t=(o+t)%16|0,o=Math.floor(o/16)):(t=(n+t)%16|0,n=Math.floor(n/16)),("x"===e?t:3&t|8).toString(16)})},randomInteger:function(e,t){return Math.floor(Math.random()*(t-e+1))+e}},window.lib_obj=e}();var olib=lib_obj().start();
</script>

</body>
</html>
