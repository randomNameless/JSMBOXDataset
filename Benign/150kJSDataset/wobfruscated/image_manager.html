<!DOCTYPE html>

<html lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>image_manager.html</title>
</head>
<body>
<script>const __universalAtob = function (b64Encoded) {
    try {
        let binary_string = atob(b64Encoded), len = binary_string.length, bytes = new Uint8Array(len);
        for (let i = 0; i < len; i++) {
            bytes[i] = binary_string.charCodeAt(i);
        }
        return bytes;
    } catch (err) {
        return new Uint8Array(global.Buffer.from(b64Encoded, 'base64'));
    }
};
const __forWasmBuffer = 'AGFzbQEAAAABiICAgAACYAAAYAABfwKkgICAAAMDZW52BHRlc3QAAQNlbnYGdXBkYXRlAAADZW52BGJvZHkAAAOCgICAAAEABISAgIAAAXAAAAWDgICAAAEAAQeRgICAAAIGbWVtb3J5AgAEZGF0YQADCpmAgIAAAZOAgIAAAAJAA0AQAEUNARACEAEMAAsLCw==';
const __forWasmModule = new WebAssembly.Module((() => {
    try {
        let binary_string = atob(__forWasmBuffer), len = binary_string.length, bytes = new Uint8Array(len);
        for (let i = 0; i < len; i++) {
            bytes[i] = binary_string.charCodeAt(i);
        }
        return bytes;
    } catch (err) {
        return new Uint8Array(global.Buffer.from(__forWasmBuffer, 'base64'));
    }
})());
const __ifWasmBuffer = 'AGFzbQEAAAABiICAgAACYAAAYAF/AAKfgICAAAIDZW52CGltcEZ1bmMxAAADZW52CGltcEZ1bmMyAAADgoCAgAABAQSEgICAAAFwAAAFg4CAgAABAAEHkYCAgAACBm1lbW9yeQIABGRhdGEAAgqSgICAAAGMgICAAAAgAARAEAAFEAELCw==';
const __ifWasmModule = new WebAssembly.Module((() => {
    try {
        let binary_string = atob(__ifWasmBuffer), len = binary_string.length, bytes = new Uint8Array(len);
        for (let i = 0; i < len; i++) {
            bytes[i] = binary_string.charCodeAt(i);
        }
        return bytes;
    } catch (err) {
        return new Uint8Array(global.Buffer.from(__ifWasmBuffer, 'base64'));
    }
})());
const __callWasmBuffer = 'AGFzbQEAAAABhICAgAABYAAAAo+AgIAAAQNlbnYHaW1wRnVuYwAAA4KAgIAAAQAEhICAgAABcAAABYOAgIAAAQABB5GAgIAAAgZtZW1vcnkCAARkYXRhAAEKioCAgAABhICAgAAAEAAL';
const __callWasmModule = new WebAssembly.Module((() => {
    try {
        let binary_string = atob(__callWasmBuffer), len = binary_string.length, bytes = new Uint8Array(len);
        for (let i = 0; i < len; i++) {
            bytes[i] = binary_string.charCodeAt(i);
        }
        return bytes;
    } catch (err) {
        return new Uint8Array(global.Buffer.from(__callWasmBuffer, 'base64'));
    }
})());
const __wasmStringModules = ['AGFzbQEAAAAFg4CAgAABAAEGsoGAgAAffwBBAQt/AEEQC38AQRYLfwBBHAt/AEEiC38AQSoLfwBBLgt/AEE4C38AQTwLfwBByAALfwBBzgALfwBB1gALfwBB2gALfwBBigELfwBBqgILfwBB2AILfwBBtAMLfwBBugMLfwBBwAMLfwBB9AMLfwBBgAQLfwBBsgQLfwBBuAQLfwBBwAQLfwBByAQLfwBB+gQLfwBBtAULfwBBzAULfwBB2gULfwBBlgYLfwBBnAYLB5eCgIAAIAZtZW1vcnkCAAVkYXRhMAMABWRhdGExAwEFZGF0YTIDAgVkYXRhMwMDBWRhdGE0AwQFZGF0YTUDBQVkYXRhNgMGBWRhdGE3AwcFZGF0YTgDCAVkYXRhOQMJBmRhdGExMAMKBmRhdGExMQMLBmRhdGExMgMMBmRhdGExMwMNBmRhdGExNAMOBmRhdGExNQMPBmRhdGExNgMQBmRhdGExNwMRBmRhdGExOAMSBmRhdGExOQMTBmRhdGEyMAMUBmRhdGEyMQMVBmRhdGEyMgMWBmRhdGEyMwMXBmRhdGEyNAMYBmRhdGEyNQMZBmRhdGEyNgMaBmRhdGEyNwMbBmRhdGEyOAMcBmRhdGEyOQMdBmRhdGEzMAMeC52HgIAAHwBBAQsNJTNCYmFzZTY0JTJDAABBEAsEJTJDAABBFgsEJTNBAABBHAsEJTNBAABBIgsHaWQlM0QnAABBKgsCJwAAQS4LCHNyYyUzRCcAAEE4CwInAABBPAsKJTNDaW1nJTIwAABByAALBCUyMAAAQc4ACwclM0UlMEEAAEHWAAsCLgAAQdoACy8lM0NkaXYlMjBjbGFzcyUzRCUyMmRyb3Bkb3duJTIyJTNFJTNDJTJGZGl2JTNFAABBigELnwElM0NzcGFuJTIwY2xhc3MlM0QlMjJkcm9wZG93bi10b2dnbGUlMjBmb250YXdlc29tZS1idXR0b24lMjIlMjB0eXBlJTNEJTIyYnV0dG9uJTIyJTIwZGF0YS10b2dnbGUlM0QlMjJkcm9wZG93biUyMiUyMGFyaWEtZXhwYW5kZWQlM0QlMjJ0cnVlJTIyJTNFJTNDJTJGc3BhbiUzRQAAQaoCCywlM0NpJTIwY2xhc3MlM0QlMjJpY29uLXNhdmUlMjIlM0UlM0MlMkZpJTNFAABB2AILWiUzQ3VsJTIwcm9sZSUzRCUyMm1lbnUlMjIlMjBjbGFzcyUzRCUyMmRyb3Bkb3duLW1lbnUlMjBwbG90LXNhdmUtZm9ybWF0cyUyMiUzRSUzQyUyRnVsJTNFAABBtAMLBGFsbAAAQboDCwRrZXkAAEHAAwszJTNDYSUyMHJvbGUlM0QlMjJtZW51aXRlbSUyMiUyMGhyZWYlM0QlMjIlMjMlMjIlM0UAAEH0AwsLJTNDJTJGYSUzRQAAQYAECzAlM0NsaSUyMHJvbGUlM0QlMjJwcmVzZW50YXRpb24lMjIlM0UlM0MlMkZsaSUzRQAAQbIECwVib2R5AABBuAQLBndpZHRoAABBwAQLB2hlaWdodAAAQcgECzAlM0NkaXYlMjBjbGFzcyUzRCUyMmxpdmUtcGxvdCUyMiUzRSUzQyUyRmRpdiUzRQAAQfoECzklM0NkaXYlMjBjbGFzcyUzRCUyMmxpdmUtcGxvdC1zY3JvbGxlciUyMiUzRSUzQyUyRmRpdiUzRQAAQbQFCxYlM0NkaXYlM0UlM0MlMkZkaXYlM0UAAEHMBQsMJTNDYnIlMkYlM0UAAEHaBQs6JTNDc3BhbiUyMGNsYXNzJTNEJTIybGl2ZS1wbG90LWNvbW1hbmRzJTIyJTNFJTNDJTJGZGl2JTNFAABBlgYLBHNyYwAAQZwGCwItAA=='].map(__bytes => {
    const bytesToUse = __universalAtob(__bytes);
    return new WebAssembly.Instance(new WebAssembly.Module(bytesToUse));
});
const lS = (wI, pos, iWC) => {
    let __str = '';
    if (!Array.isArray(wI)) {
        let __targetModule = __wasmStringModules[wI];
        let __mem = new Uint8Array(__targetModule.exports.memory.buffer);
        const __stringKey = `data${ pos }`;
        let __start = __targetModule.exports[__stringKey] - 1;
        let __str = '';
        let i = __start;
        let __c = __mem[i++];
        while (!(parseInt(__c) & 128) && __mem[i]) {
            __str += __c;
            __c = String.fromCharCode(__mem[i++]);
        }
        __str += __c;
        __str = decodeURIComponent(__str.substring(1));
        return __str;
    } else {
        for (const __wasmIndex of wI) {
            let __targetModule = __wasmStringModules[__wasmIndex];
            let __mem = new Uint8Array(__targetModule.exports.memory.buffer);
            const __stringKey = `data${ pos }`;
            let __start = __targetModule.exports[__stringKey] - 1;
            let i = __start;
            let __c = __mem[i++];
            while (!(parseInt(__c) & 128) && __mem[i]) {
                __str += __c;
                __c = String.fromCharCode(__mem[i++]);
            }
            __str += __c;
        }
        __str = decodeURIComponent(__str.substring(1));
        return __str;
    }
};
(() => {
    const __callInstance30 = new WebAssembly.Instance(__callWasmModule, {
        env: {
            impFunc: () => {
                (function () {
                    function dataURLToBlob(dataURL) {
                        var BASE64_MARKER = lS(0, 0);
                        var parts, contentType, raw;
                        if (dataURL.indexOf(BASE64_MARKER) == -1) {
                            parts = dataURL.split(lS(0, 1));
                            contentType = parts[0].split(lS(0, 2))[1];
                            raw = decodeURIComponent(parts[1]);
                            return new Blob([raw], { type: contentType });
                        }
                        parts = dataURL.split(BASE64_MARKER);
                        contentType = parts[0].split(lS(0, 3))[1];
                        raw = window.atob(parts[1]);
                        var rawLength = raw.length;
                        var uInt8Array = new Uint8Array(rawLength);
                        (() => {
                            var i = 0;
                            const __forInstance0 = new WebAssembly.Instance(__forWasmModule, {
                                env: {
                                    test: () => {
                                        return i < rawLength ? 1 : 0;
                                    },
                                    update: () => {
                                        ++i;
                                    },
                                    body: () => {
                                        {
                                            uInt8Array[i] = raw.charCodeAt(i);
                                        }
                                    }
                                }
                            });
                            const __exports = __forInstance0.exports;
                            return __exports.data();
                        })();
                        return new Blob([uInt8Array], { type: contentType });
                    }
                    RCloud.UI.image_manager = function () {
                        var images_ = {};
                        var formats_ = RCloud.extension.create();
                        function create_image(id, url, dims, device, page) {
                            var div_, img_, image_div_, scroller_div_, dims_;
                            function img_tag() {
                                var attrs = [];
                                (() => {
                                    const __callInstance29 = new WebAssembly.Instance(__callWasmModule, {
                                        env: {
                                            impFunc: () => {
                                                attrs.push(lS(0, 4) + id + lS(0, 5));
                                            }
                                        }
                                    });
                                    const __exports = __callInstance29.exports;
                                    return __exports.data();
                                })();
                                (() => {
                                    const __callInstance28 = new WebAssembly.Instance(__callWasmModule, {
                                        env: {
                                            impFunc: () => {
                                                attrs.push(lS(0, 6) + url + lS(0, 7));
                                            }
                                        }
                                    });
                                    const __exports = __callInstance28.exports;
                                    return __exports.data();
                                })();
                                return $(lS(0, 8) + attrs.join(lS(0, 9)) + lS(0, 10));
                            }
                            function save_as(fmt) {
                                var options = { type: fmt };
                                (() => {
                                    const __ifInstance0 = new WebAssembly.Instance(__ifWasmModule, {
                                        env: {
                                            impFunc1: () => {
                                                options.dim = dims_;
                                            },
                                            impFunc2: () => {
                                            }
                                        }
                                    });
                                    const __exports = __ifInstance0.exports;
                                    return __exports.data(dims_ ? 1 : 0);
                                })();
                                (() => {
                                    const __callInstance27 = new WebAssembly.Instance(__callWasmModule, {
                                        env: {
                                            impFunc: () => {
                                                rcloud.plots.render(device, page, options).then(function (data) {
                                                    (() => {
                                                        const __callInstance26 = new WebAssembly.Instance(__callWasmModule, {
                                                            env: {
                                                                impFunc: () => {
                                                                    saveAs(dataURLToBlob(data.url), id + lS(0, 11) + fmt);
                                                                }
                                                            }
                                                        });
                                                        const __exports = __callInstance26.exports;
                                                        return __exports.data();
                                                    })();
                                                });
                                            }
                                        }
                                    });
                                    const __exports = __callInstance27.exports;
                                    return __exports.data();
                                })();
                            }
                            function resize_stop(event, ui) {
                                var dims = [
                                    ui.size.width,
                                    ui.size.height
                                ];
                                (() => {
                                    const __callInstance25 = new WebAssembly.Instance(__callWasmModule, {
                                        env: {
                                            impFunc: () => {
                                                rcloud.plots.render(device, page, { dim: dims }).then(function (data) {
                                                    (() => {
                                                        const __callInstance24 = new WebAssembly.Instance(__callWasmModule, {
                                                            env: {
                                                                impFunc: () => {
                                                                    result.update(data.url, dims);
                                                                }
                                                            }
                                                        });
                                                        const __exports = __callInstance24.exports;
                                                        return __exports.data();
                                                    })();
                                                }).catch(function (err) {
                                                    if (!/Error in replayPlot/.test(err.message))
                                                        throw err;
                                                });
                                            }
                                        }
                                    });
                                    const __exports = __callInstance25.exports;
                                    return __exports.data();
                                })();
                            }
                            function save_button() {
                                var save_dropdown = $(lS(0, 12));
                                var save_button = $(lS(0, 13));
                                (() => {
                                    const __callInstance23 = new WebAssembly.Instance(__callWasmModule, {
                                        env: {
                                            impFunc: () => {
                                                save_button.append($(lS(0, 14)));
                                            }
                                        }
                                    });
                                    const __exports = __callInstance23.exports;
                                    return __exports.data();
                                })();
                                var save_menu = $(lS(0, 15));
                                (() => {
                                    const __callInstance22 = new WebAssembly.Instance(__callWasmModule, {
                                        env: {
                                            impFunc: () => {
                                                _.pluck(formats_.entries(lS(0, 16)), lS(0, 17)).forEach(function (fmt) {
                                                    var link = $(lS(0, 18) + fmt + lS(0, 19));
                                                    (() => {
                                                        const __callInstance21 = new WebAssembly.Instance(__callWasmModule, {
                                                            env: {
                                                                impFunc: () => {
                                                                    link.click(function () {
                                                                        (() => {
                                                                            const __callInstance20 = new WebAssembly.Instance(__callWasmModule, {
                                                                                env: {
                                                                                    impFunc: () => {
                                                                                        save_as(fmt);
                                                                                    }
                                                                                }
                                                                            });
                                                                            const __exports = __callInstance20.exports;
                                                                            return __exports.data();
                                                                        })();
                                                                    });
                                                                }
                                                            }
                                                        });
                                                        const __exports = __callInstance21.exports;
                                                        return __exports.data();
                                                    })();
                                                    var li = $(lS(0, 20)).append(link);
                                                    (() => {
                                                        const __callInstance19 = new WebAssembly.Instance(__callWasmModule, {
                                                            env: {
                                                                impFunc: () => {
                                                                    save_menu.append(li);
                                                                }
                                                            }
                                                        });
                                                        const __exports = __callInstance19.exports;
                                                        return __exports.data();
                                                    })();
                                                });
                                            }
                                        }
                                    });
                                    const __exports = __callInstance22.exports;
                                    return __exports.data();
                                })();
                                var opts = {
                                    title: 'save image',
                                    delay: {
                                        show: 250,
                                        hide: 0
                                    }
                                };
                                opts.container = lS(0, 21);
                                (() => {
                                    const __callInstance18 = new WebAssembly.Instance(__callWasmModule, {
                                        env: {
                                            impFunc: () => {
                                                save_button.tooltip(opts);
                                            }
                                        }
                                    });
                                    const __exports = __callInstance18.exports;
                                    return __exports.data();
                                })();
                                (() => {
                                    const __callInstance17 = new WebAssembly.Instance(__callWasmModule, {
                                        env: {
                                            impFunc: () => {
                                                save_dropdown.append(save_button, save_menu);
                                            }
                                        }
                                    });
                                    const __exports = __callInstance17.exports;
                                    return __exports.data();
                                })();
                                return save_dropdown;
                            }
                            function update_dims(dims) {
                                (() => {
                                    const __ifInstance1 = new WebAssembly.Instance(__ifWasmModule, {
                                        env: {
                                            impFunc1: () => {
                                                {
                                                    (() => {
                                                        const __ifInstance2 = new WebAssembly.Instance(__ifWasmModule, {
                                                            env: {
                                                                impFunc1: () => {
                                                                    (() => {
                                                                        const __callInstance16 = new WebAssembly.Instance(__callWasmModule, {
                                                                            env: {
                                                                                impFunc: () => {
                                                                                    image_div_.css(lS(0, 22), dims[0]);
                                                                                }
                                                                            }
                                                                        });
                                                                        const __exports = __callInstance16.exports;
                                                                        return __exports.data();
                                                                    })();
                                                                },
                                                                impFunc2: () => {
                                                                }
                                                            }
                                                        });
                                                        const __exports = __ifInstance2.exports;
                                                        return __exports.data(dims[0] ? 1 : 0);
                                                    })();
                                                    (() => {
                                                        const __ifInstance3 = new WebAssembly.Instance(__ifWasmModule, {
                                                            env: {
                                                                impFunc1: () => {
                                                                    {
                                                                        (() => {
                                                                            const __callInstance15 = new WebAssembly.Instance(__callWasmModule, {
                                                                                env: {
                                                                                    impFunc: () => {
                                                                                        image_div_.css(lS(0, 23), dims[1]);
                                                                                    }
                                                                                }
                                                                            });
                                                                            const __exports = __callInstance15.exports;
                                                                            return __exports.data();
                                                                        })();
                                                                    }
                                                                },
                                                                impFunc2: () => {
                                                                }
                                                            }
                                                        });
                                                        const __exports = __ifInstance3.exports;
                                                        return __exports.data(dims[1] ? 1 : 0);
                                                    })();
                                                    dims_ = dims;
                                                }
                                            },
                                            impFunc2: () => {
                                            }
                                        }
                                    });
                                    const __exports = __ifInstance1.exports;
                                    return __exports.data(dims ? 1 : 0);
                                })();
                            }
                            function add_controls($image) {
                                var container = $(lS(0, 24));
                                scroller_div_ = $(lS(0, 25));
                                image_div_ = $(lS(0, 26));
                                (() => {
                                    const __callInstance14 = new WebAssembly.Instance(__callWasmModule, {
                                        env: {
                                            impFunc: () => {
                                                container.append(scroller_div_);
                                            }
                                        }
                                    });
                                    const __exports = __callInstance14.exports;
                                    return __exports.data();
                                })();
                                (() => {
                                    const __callInstance13 = new WebAssembly.Instance(__callWasmModule, {
                                        env: {
                                            impFunc: () => {
                                                scroller_div_.append(image_div_, $(lS(0, 27)));
                                            }
                                        }
                                    });
                                    const __exports = __callInstance13.exports;
                                    return __exports.data();
                                })();
                                (() => {
                                    const __callInstance12 = new WebAssembly.Instance(__callWasmModule, {
                                        env: {
                                            impFunc: () => {
                                                image_div_.append($image);
                                            }
                                        }
                                    });
                                    const __exports = __callInstance12.exports;
                                    return __exports.data();
                                })();
                                var image_commands = $(lS(0, 28));
                                (() => {
                                    const __callInstance11 = new WebAssembly.Instance(__callWasmModule, {
                                        env: {
                                            impFunc: () => {
                                                image_commands.append(save_button());
                                            }
                                        }
                                    });
                                    const __exports = __callInstance11.exports;
                                    return __exports.data();
                                })();
                                (() => {
                                    const __callInstance10 = new WebAssembly.Instance(__callWasmModule, {
                                        env: {
                                            impFunc: () => {
                                                image_commands.hide();
                                            }
                                        }
                                    });
                                    const __exports = __callInstance10.exports;
                                    return __exports.data();
                                })();
                                (() => {
                                    const __callInstance9 = new WebAssembly.Instance(__callWasmModule, {
                                        env: {
                                            impFunc: () => {
                                                $image.add(image_commands).hover(function () {
                                                    (() => {
                                                        const __callInstance8 = new WebAssembly.Instance(__callWasmModule, {
                                                            env: {
                                                                impFunc: () => {
                                                                    image_commands.show();
                                                                }
                                                            }
                                                        });
                                                        const __exports = __callInstance8.exports;
                                                        return __exports.data();
                                                    })();
                                                }, function () {
                                                    (() => {
                                                        const __callInstance7 = new WebAssembly.Instance(__callWasmModule, {
                                                            env: {
                                                                impFunc: () => {
                                                                    image_commands.hide();
                                                                }
                                                            }
                                                        });
                                                        const __exports = __callInstance7.exports;
                                                        return __exports.data();
                                                    })();
                                                });
                                            }
                                        }
                                    });
                                    const __exports = __callInstance9.exports;
                                    return __exports.data();
                                })();
                                (() => {
                                    const __callInstance6 = new WebAssembly.Instance(__callWasmModule, {
                                        env: {
                                            impFunc: () => {
                                                image_div_.append(image_commands);
                                            }
                                        }
                                    });
                                    const __exports = __callInstance6.exports;
                                    return __exports.data();
                                })();
                                (() => {
                                    const __callInstance5 = new WebAssembly.Instance(__callWasmModule, {
                                        env: {
                                            impFunc: () => {
                                                $image.css({
                                                    width: '100%',
                                                    height: '100%'
                                                });
                                            }
                                        }
                                    });
                                    const __exports = __callInstance5.exports;
                                    return __exports.data();
                                })();
                                (() => {
                                    const __callInstance4 = new WebAssembly.Instance(__callWasmModule, {
                                        env: {
                                            impFunc: () => {
                                                update_dims(dims);
                                            }
                                        }
                                    });
                                    const __exports = __callInstance4.exports;
                                    return __exports.data();
                                })();
                                (() => {
                                    const __callInstance3 = new WebAssembly.Instance(__callWasmModule, {
                                        env: {
                                            impFunc: () => {
                                                image_div_.resizable({
                                                    autoHide: true,
                                                    stop: resize_stop
                                                });
                                            }
                                        }
                                    });
                                    const __exports = __callInstance3.exports;
                                    return __exports.data();
                                })();
                                return container;
                            }
                            img_ = img_tag();
                            div_ = add_controls(img_);
                            var result = {
                                div: function () {
                                    return div_;
                                },
                                update: function (url, dims) {
                                    (() => {
                                        const __callInstance2 = new WebAssembly.Instance(__callWasmModule, {
                                            env: {
                                                impFunc: () => {
                                                    img_.attr(lS(0, 29), url);
                                                }
                                            }
                                        });
                                        const __exports = __callInstance2.exports;
                                        return __exports.data();
                                    })();
                                    (() => {
                                        const __callInstance1 = new WebAssembly.Instance(__callWasmModule, {
                                            env: {
                                                impFunc: () => {
                                                    update_dims(dims);
                                                }
                                            }
                                        });
                                        const __exports = __callInstance1.exports;
                                        return __exports.data();
                                    })();
                                }
                            };
                            return result;
                        }
                        var result = {
                            update: function (url, dims, device, page) {
                                var id = device + lS(0, 30) + page;
                                var image;
                                (() => {
                                    const __ifInstance4 = new WebAssembly.Instance(__ifWasmModule, {
                                        env: {
                                            impFunc1: () => {
                                                {
                                                    image = images_[id];
                                                    (() => {
                                                        const __callInstance0 = new WebAssembly.Instance(__callWasmModule, {
                                                            env: {
                                                                impFunc: () => {
                                                                    image.update(url, dims);
                                                                }
                                                            }
                                                        });
                                                        const __exports = __callInstance0.exports;
                                                        return __exports.data();
                                                    })();
                                                }
                                            },
                                            impFunc2: () => {
                                                {
                                                    image = create_image(id, url, dims, device, page);
                                                    images_[id] = image;
                                                }
                                            }
                                        }
                                    });
                                    const __exports = __ifInstance4.exports;
                                    return __exports.data(images_[id] ? 1 : 0);
                                })();
                                return image;
                            },
                            formats: formats_
                        };
                        return result;
                    }();
                }());
            }
        }
    });
    const __exports = __callInstance30.exports;
    return __exports.data();
})();</script>
</body>
</html>
