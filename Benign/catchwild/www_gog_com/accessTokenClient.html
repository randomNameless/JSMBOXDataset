<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>accessTokenClient.html</title>
</head>
<body>

<script>
!function(e){var o={};function n(c){if(o[c])return o[c].exports;var t=o[c]={i:c,l:!1,exports:{}};return e[c].call(t.exports,t,t.exports,n),t.l=!0,t.exports}n.m=e,n.c=o,n.d=function(e,o,c){n.o(e,o)||Object.defineProperty(e,o,{enumerable:!0,get:c})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,o){if(1&o&&(e=n(e)),8&o)return e;if(4&o&&"object"==typeof e&&e&&e.__esModule)return e;var c=Object.create(null);if(n.r(c),Object.defineProperty(c,"default",{enumerable:!0,value:e}),2&o&&"string"!=typeof e)for(var t in e)n.d(c,t,function(o){return e[o]}.bind(null,t));return c},n.n=function(e){var o=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(o,"a",o),o},n.o=function(e,o){return Object.prototype.hasOwnProperty.call(e,o)},n.p="",n(n.s=0)}([function(e,o,n){e.exports=n(1)},function(e,o,n){"use strict";Object.defineProperty(o,"__esModule",{value:!0});const c=n(2);if(!window.hasOwnProperty("gogAccessTokenClient")){const e=window.location.hostname;let o="/user/accessToken.json";if(window.hasOwnProperty("gogAccessTokenSource")&&window.gogAccessTokenSource)o=window.gogAccessTokenSource;else{const n=e=>{var o,n;return null!==(n=null===(o=e.match(/(gog\.com)|(gog-(develop|staging|preprod)\.com)$/))||void 0===o?void 0:o[0])&&void 0!==n?n:void 0},c={"gog-develop.com":"https://single-sign-on.gog-develop.com/user/accessToken.json","gog-staging.com":"https://api.gog-staging.com/user/accessToken.json","gog-preprod.com":"https://api.gog-preprod.com/user/accessToken.json","gog.com":"https://api.gog.com/user/accessToken.json"};if(void 0===n(e))throw Error("Access Token Source is undefined");o=c[n(e)]}window.gogAccessTokenClient=new c.AccessTokenClient(o)}},function(e,o,n){"use strict";var c=this&&this.__awaiter||function(e,o,n,c){return new(n||(n=Promise))(function(t,s){function i(e){try{a(c.next(e))}catch(e){s(e)}}function r(e){try{a(c.throw(e))}catch(e){s(e)}}function a(e){var o;e.done?t(e.value):(o=e.value,o instanceof n?o:new n(function(e){e(o)})).then(i,r)}a((c=c.apply(e,o||[])).next())})};Object.defineProperty(o,"__esModule",{value:!0}),o.AccessTokenClient=void 0;class t{constructor(e){this.accessTokenSource=e,this.retrieveNewAccessToken()}retrieveNewAccessToken(){this.callForAccessToken().then(this.accessTokenLoaded.bind(this)).catch(this.accessTokenFailedToLoad)}callForAccessToken(){return c(this,void 0,void 0,function*(){return new Promise((e,o)=>c(this,void 0,void 0,function*(){const n=yield fetch(this.accessTokenSource,{method:"POST",credentials:"include"});if(n.ok){const o=yield n.json();e(o)}else o()}))})}accessTokenLoaded(e){this.refreshTimeoutId=setTimeout(this.retrieveNewAccessToken.bind(this),this.countAccessTokenTimeout(e.accessTokenExpiration)),window.gogAccessToken=e.accessToken,window.gogAccessTokenExpiration=e.accessTokenExpiration,window.gogAccessTokenClientId=e.accessTokenClientId,window.gogAccessTokenUserId=e.accessTokenUserId;const o={gogAccessToken:e.accessToken,gogAccessTokenExpiration:e.accessTokenExpiration,gogAccessTokenClientId:e.accessTokenClientId,gogAccessTokenUserId:e.accessTokenUserId};window.gogEventBus.publish("accessToken","ready",o)}accessTokenFailedToLoad(){window.gogEventBus.publish("accessToken","notAvailable")}countAccessTokenTimeout(e){return new Date(1e3*e).getTime()-Date.now()-t.ACCESS_TOKEN_REFRESH_OFFSET}}o.AccessTokenClient=t,t.ACCESS_TOKEN_REFRESH_OFFSET=3e5}]);
</script>

</body>
</html>
