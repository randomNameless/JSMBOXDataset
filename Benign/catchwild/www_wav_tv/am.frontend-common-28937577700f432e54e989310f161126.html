<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>am.frontend-common-28937577700f432e54e989310f161126.html</title>
</head>
<body>

<script>
//# sourceMappingURL=am.frontend-common.js.map
"use strict";
(function(f){f(window,window.jQuery)})(function(f,d){function m(d,a,b){_.isObject(a)&&_.extend(d.prototype,a);_.isObject(b)&&_.extend(d,b);return d}function e(d,a){_.each(d,function(b,c){a.hasOwnProperty(c)||(a[c]=b)});return a}d(function(){(new (m(function(){this.desktop=this.mobile=!1},{isMobile:function(){return this.mobile=/Android|webOS|iPhone|iPad|BlackBerry|Windows Phone|Opera Mini|IEMobile|Mobile/i.test(navigator.userAgent)},isDesktop:function(){return this.desktop=this.mobile?!1:!0},autoDetect:function(){this.isMobile();
this.isDesktop();return this}}))).autoDetect();var n=m(function(a){var b={invisible:"invisible",isHiding:"is-hiding",isVisible:"is-visible",isEdit:"is-edit"},c={offset:400},g={page:1};this.getSelectors=function(){return b};this.getAnimationProps=function(){return c};this.getStorage=function(){return g};this.setStorage=function(a){g=a};var k={form:d(".js-mobile-custom-search-form"),container:d(".js-mobile-custom-search-dialog"),listItem:d(".js-mobile-filters-parent-list-item"),item:d(".js-mobile-filters-child")},
l={back:d(".js-m-dialog-button-back"),byDefault:d(".js-m-dialog-button-default"),close:d(".js-m-dialog-close-button"),submit:d(".js-m-dialog-button-ok"),show:d(".js-m-mobile-filters-show-button")},f={byDefault:d(".js-mobile-filters-default"),all:d(".js-mobile-filters-checkbox"),sites:d('input[name="sites"]')},h={onSubmit:function(){},onCancel:function(){},onDefault:function(){},onBack:function(){}};_.each(["dom","buttons","checkboxes"],function(a){this[a]={}}.bind(this));_.isObject(a)?(a.dom?e(e(k,
a.dom),this.dom):e(k,this.dom),a.buttons?e(e(l,a.buttons),this.buttons):e(l,this.buttons),a.checkboxes?e(e(f,a.checkboxes),this.checkboxes):e(f,this.checkboxes),h={onSubmit:a.onSubmit?a.onSubmit:h.onSubmit,onCancel:a.onCancel?a.onCancel:h.onCancel,onDefault:a.onDefault?a.onDefault:h.onDefault,onBack:a.onBack?a.onBack:h.onBack}):(e(k,this.dom),e(l,this.buttons),e(f,this.checkboxes));_.each(h,function(a,c,b){this[c]=a}.bind(this))},{init:function(){if(!(1>this.dom.container.length))return this.bindEvents(),
this._initStorageData(),this},bindEvents:function(){_.each(this.buttons,function(a,b,c){a.on("click",this["_"+b+"Click"].bind(this))}.bind(this));this.dom.listItem.on("click",this._listItemClick.bind(this));this.dom.container.on("click",this._handleContainerClick.bind(this))},_listItemClick:function(a){a=d(a.currentTarget).data("child");a=d("#"+a);var b=this.getSelectors();this._toggleClasses([{element:this.dom.container,mod:b.isEdit},{element:a,mod:b.invisible}]);a.focus()},_handleContainerClick:function(a){if(this._isElementFiltersCheckbox(a.target)){a=
a.target;var b=d(a).attr("name"),c=d(a).attr("value"),g=d(a).attr("data-by-default");(this._isFilterChecked(a)?this._pushFilterToStorage.bind(this):this._popFilterFromStorage.bind(this))(b)({type:b,value:c,byDefault:g},this.getStorage())}},_isSitesFilter:function(a){return"sites"===a},_pushFilterToStorage:function(a){return this._isSitesFilter(a)?this._addSiteToStorage.bind(this):this._addFilterToStorage.bind(this)},_popFilterFromStorage:function(a){return this._isSitesFilter(a)?this._removeSiteFromStorage.bind(this):
this._removeFilterFromStorage.bind(this)},_addSiteToStorage:function(a,b){var c=_.clone(b);this._hasFilter(a.type,c)||(c[a.type]="");c[a.type]+=-1===c[a.type].indexOf(a.type)?a.value:"";this.setStorage(c)},_removeSiteFromStorage:function(a,b){var c=_.clone(b),d=c.sites.split("");c.sites=d.filter(function(c){return c!==a.value}).join("");this.setStorage(c)},_addFilterToStorage:function(a,b){var c=_.clone(b);c[a.type]=a.value;this.setStorage(c)},_removeFilterFromStorage:function(a,b){var c=_.clone(b),
d=Object.keys(c),d=d.filter(function(c){return c!==a.type}),d=d.reduce(function(a,b){a[b]=c[b];return a},{});a.byDefault&&(d[a.type]=a.byDefault);this.setStorage(d)},_initStorageData:function(){_.each(this.checkboxes.all,function(a,b){if(this._isFilterChecked(a)){var c=d(a).attr("name"),g=d(a).attr("value");this._pushFilterToStorage(c).bind(this)({type:c,value:g},this.getStorage())}}.bind(this))},_setStorageDataToDefault:function(){this.setStorage({sites:"vaeos",where:"ja",duration:"all",hd:"all",
withActress:"all",date:"all",trusted:"all",age:"all",sort:"all"});return this.getStorage()},_isElementFiltersCheckbox:function(a){return d(a).hasClass("js-mobile-filters-checkbox")},_isFilterChecked:function(a){return d(a).prop("checked")},_isFormExist:function(a){return 0<a.length},_hasFilter:function(a,b){return void 0!==b[a]},_backClick:function(a){d(a.currentTarget);var b=this.getSelectors(),c=b.invisible;this._toggleClasses([{element:this.dom.container,mod:b.isEdit},{element:this.dom.item.not("."+
c),mod:c}]);this.onBack();a.preventDefault()},_closeClick:function(a,b){var c=this.getSelectors(),g=this.getAnimationProps().offset,e=c.isHiding,c=c.isVisible;d(a.target);this.dom.container.addClass(e).removeClass(c);setTimeout(function(){this.dom.container.removeClass(e)}.bind(this),g);if("onsubmit"!==b)this.onCancel();a.preventDefault()},_submitClick:function(a){var b=this.getAnimationProps().offset;this._closeClick(a,"onsubmit");setTimeout(function(){if(this._isFormExist(this.dom.form))this.dom.form.submit();
else this.onSubmit(this.getStorage())}.bind(this),b);a.preventDefault()},_byDefaultClick:function(a){var b=null;_.each(this.checkboxes.all,function(a){a.checked=!1});_.each(this.checkboxes.byDefault,function(a){a.checked=!0});b=this._setStorageDataToDefault();this._closeClick(a);if(this._isFormExist(this.dom.form))this.dom.form.submit();else this.onDefault(b);a.preventDefault()},_showClick:function(a){a=this.getSelectors().isVisible;this.dom.container.addClass(a);if(f.filters)this.onShow()},onShow:function(){var a=
this._convertBBStorageToLocalStorageData(f.filters);this.setStorage(a);this._updateViewFromStorage(this.getStorage())},_updateViewFromStorage:function(a){this._resetAllCheckboxes();this._updateFiltersFromStorage(a);this._updateSitesFromStorage(a)},_updateFiltersFromStorage:function(a){var b=Object.keys(a),b=_.filter(b,function(a){return"sites"!==a}),b=_.reduce(b,function(b,d){return(b[d]=a[d])&&b},{});this._markActiveCheckboxes(this.checkboxes.all,b)},_updateSitesFromStorage:function(a){this._markActiveCheckboxes(this.checkboxes.sites,
a.sites)},_resetAllCheckboxes:function(){_.each(this.checkboxes.all,function(a){a.checked=!1})},_convertBBStorageToLocalStorageData:function(a){var b={},c,d,e=this;_.each(a,function(a,f){c=_.filter(a,function(a){return a&&a.active});e._hasDataInFilter(c)&&(d=e._convertFilterDependingOnType(f),b[f]=d(c))});return b},_hasDataInFilter:function(a){return a.length},_convertFilterDependingOnType:function(a){return"sites"===a?this._convertSiteFilter:this._convertOtherFilter},_convertSiteFilter:function(a){return _.reduce(a,
function(a,c){return a+c.letter},"")},_convertOtherFilter:function(a){return _.reduce(a,function(a,c){return c.key},"")},_markActiveCheckboxes:function(a,b){var c=null;_.each(b,function(b,d){(c=_.isString(d)?_.find(a,function(a){return a.name===d&&a.value===b}):_.find(a,function(a){return a.value===b}))&&(c.checked=!0)})},_toggleClasses:function(a){_.isArray(a)&&a.forEach(function(a){a.element.toggleClass(a.mod)})}});_.isObject(f.filter)?f.filter._mobileCustomSearch=function(a){return(new n(a)).init()}:
(new n).init()})});
</script>

</body>
</html>
