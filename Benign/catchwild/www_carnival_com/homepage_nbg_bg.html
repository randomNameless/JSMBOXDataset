<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>homepage_nbg_bg.html</title>
</head>
<body>

<script>
/*! For license information please see client.min.js.LICENSE.txt */
(function(){var __webpack_modules__={5251:function(t,n,e){var i;!function(r,o){"use strict";var a="function",u="undefined",c="object",s="string",f="model",l="name",d="type",v="vendor",h="version",p="architecture",g="console",m="mobile",_="tablet",w="smarttv",y="wearable",b="embedded",E="Amazon",I="Apple",A="ASUS",T="BlackBerry",S="Firefox",k="Google",R="Huawei",N="LG",C="Microsoft",D="Motorola",O="Opera",x="Samsung",M="Sharp",P="Sony",L="Xiaomi",U="Zebra",V="Facebook",F=function(t){for(var n={},e=0;e<t.length;e++)n[t[e].toUpperCase()]=t[e];return n},B=function(t,n){return typeof t===s&&-1!==z(n).indexOf(z(t))},z=function(t){return t.toLowerCase()},G=function(t,n){if(typeof t===s)return t=t.replace(/^\s\s*/,""),typeof n===u?t:t.substring(0,350)},j=function(t,n){for(var e,i,r,u,s,f,l=0;l<n.length&&!s;){var d=n[l],v=n[l+1];for(e=i=0;e<d.length&&!s&&d[e];)if(s=d[e++].exec(t))for(r=0;r<v.length;r++)f=s[++i],typeof(u=v[r])===c&&u.length>0?2===u.length?typeof u[1]==a?this[u[0]]=u[1].call(this,f):this[u[0]]=u[1]:3===u.length?typeof u[1]!==a||u[1].exec&&u[1].test?this[u[0]]=f?f.replace(u[1],u[2]):o:this[u[0]]=f?u[1].call(this,f,u[2]):o:4===u.length&&(this[u[0]]=f?u[3].call(this,f.replace(u[1],u[2])):o):this[u]=f||o;l+=2}},q=function(t,n){for(var e in n)if(typeof n[e]===c&&n[e].length>0){for(var i=0;i<n[e].length;i++)if(B(n[e][i],t))return"?"===e?o:e}else if(B(n[e],t))return"?"===e?o:e;return t},H={ME:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0",2e3:"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2",8.1:"NT 6.3",10:["NT 6.4","NT 10.0"],RT:"ARM"},Y={browser:[[/\b(?:crmo|crios)\/([\w\.]+)/i],[h,[l,"Chrome"]],[/edg(?:e|ios|a)?\/([\w\.]+)/i],[h,[l,"Edge"]],[/(opera mini)\/([-\w\.]+)/i,/(opera [mobiletab]{3,6})\b.+version\/([-\w\.]+)/i,/(opera)(?:.+version\/|[\/ ]+)([\w\.]+)/i],[l,h],[/opios[\/ ]+([\w\.]+)/i],[h,[l,"Opera Mini"]],[/\bopr\/([\w\.]+)/i],[h,[l,O]],[/(kindle)\/([\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer)[\/ ]?([\w\.]*)/i,/(avant |iemobile|slim)(?:browser)?[\/ ]?([\w\.]*)/i,/(ba?idubrowser)[\/ ]?([\w\.]+)/i,/(?:ms|\()(ie) ([\w\.]+)/i,/(flock|rockmelt|midori|epiphany|silk|skyfire|ovibrowser|bolt|iron|vivaldi|iridium|phantomjs|bowser|quark|qupzilla|falkon|rekonq|puffin|brave|whale(?!.+naver)|qqbrowserlite|qq|duckduckgo)\/([-\w\.]+)/i,/(weibo)__([\d\.]+)/i],[l,h],[/(?:\buc? ?browser|(?:juc.+)ucweb)[\/ ]?([\w\.]+)/i],[h,[l,"UCBrowser"]],[/microm.+\bqbcore\/([\w\.]+)/i,/\bqbcore\/([\w\.]+).+microm/i],[h,[l,"WeChat(Win) Desktop"]],[/micromessenger\/([\w\.]+)/i],[h,[l,"WeChat"]],[/konqueror\/([\w\.]+)/i],[h,[l,"Konqueror"]],[/trident.+rv[: ]([\w\.]{1,9})\b.+like gecko/i],[h,[l,"IE"]],[/yabrowser\/([\w\.]+)/i],[h,[l,"Yandex"]],[/(avast|avg)\/([\w\.]+)/i],[[l,/(.+)/,"$1 Secure Browser"],h],[/\bfocus\/([\w\.]+)/i],[h,[l,"Firefox Focus"]],[/\bopt\/([\w\.]+)/i],[h,[l,"Opera Touch"]],[/coc_coc\w+\/([\w\.]+)/i],[h,[l,"Coc Coc"]],[/dolfin\/([\w\.]+)/i],[h,[l,"Dolphin"]],[/coast\/([\w\.]+)/i],[h,[l,"Opera Coast"]],[/miuibrowser\/([\w\.]+)/i],[h,[l,"MIUI Browser"]],[/fxios\/([-\w\.]+)/i],[h,[l,S]],[/\bqihu|(qi?ho?o?|360)browser/i],[[l,"360 Browser"]],[/(oculus|samsung|sailfish|huawei)browser\/([\w\.]+)/i],[[l,/(.+)/,"$1 Browser"],h],[/(comodo_dragon)\/([\w\.]+)/i],[[l,/_/g," "],h],[/(electron)\/([\w\.]+) safari/i,/(tesla)(?: qtcarbrowser|\/(20\d\d\.[-\w\.]+))/i,/m?(qqbrowser|baiduboxapp|2345Explorer)[\/ ]?([\w\.]+)/i],[l,h],[/(metasr)[\/ ]?([\w\.]+)/i,/(lbbrowser)/i,/\[(linkedin)app\]/i],[l],[/((?:fban\/fbios|fb_iab\/fb4a)(?!.+fbav)|;fbav\/([\w\.]+);)/i],[[l,V],h],[/(kakao(?:talk|story))[\/ ]([\w\.]+)/i,/(naver)\(.*?(\d+\.[\w\.]+).*\)/i,/safari (line)\/([\w\.]+)/i,/\b(line)\/([\w\.]+)\/iab/i,/(chromium|instagram)[\/ ]([-\w\.]+)/i],[l,h],[/\bgsa\/([\w\.]+) .*safari\//i],[h,[l,"GSA"]],[/headlesschrome(?:\/([\w\.]+)| )/i],[h,[l,"Chrome Headless"]],[/ wv\).+(chrome)\/([\w\.]+)/i],[[l,"Chrome WebView"],h],[/droid.+ version\/([\w\.]+)\b.+(?:mobile safari|safari)/i],[h,[l,"Android Browser"]],[/(chrome|omniweb|arora|[tizenoka]{5} ?browser)\/v?([\w\.]+)/i],[l,h],[/version\/([\w\.\,]+) .*mobile\/\w+ (safari)/i],[h,[l,"Mobile Safari"]],[/version\/([\w(\.|\,)]+) .*(mobile ?safari|safari)/i],[h,l],[/webkit.+?(mobile ?safari|safari)(\/[\w\.]+)/i],[l,[h,q,{"1.0":"/8",1.2:"/1",1.3:"/3","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419","?":"/"}]],[/(webkit|khtml)\/([\w\.]+)/i],[l,h],[/(navigator|netscape\d?)\/([-\w\.]+)/i],[[l,"Netscape"],h],[/mobile vr; rv:([\w\.]+)\).+firefox/i],[h,[l,"Firefox Reality"]],[/ekiohf.+(flow)\/([\w\.]+)/i,/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo browser|minimo|conkeror|klar)[\/ ]?([\w\.\+]+)/i,/(seamonkey|k-meleon|icecat|iceape|firebird|phoenix|palemoon|basilisk|waterfox)\/([-\w\.]+)$/i,/(firefox)\/([\w\.]+)/i,/(mozilla)\/([\w\.]+) .+rv\:.+gecko\/\d+/i,/(polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf|sleipnir|obigo|mosaic|(?:go|ice|up)[\. ]?browser)[-\/ ]?v?([\w\.]+)/i,/(links) \(([\w\.]+)/i,/panasonic;(viera)/i],[l,h],[/(cobalt)\/([\w\.]+)/i],[l,[h,/master.|lts./,""]]],cpu:[[/(?:(amd|x(?:(?:86|64)[-_])?|wow|win)64)[;\)]/i],[[p,"amd64"]],[/(ia32(?=;))/i],[[p,z]],[/((?:i[346]|x)86)[;\)]/i],[[p,"ia32"]],[/\b(aarch64|arm(v?8e?l?|_?64))\b/i],[[p,"arm64"]],[/\b(arm(?:v[67])?ht?n?[fl]p?)\b/i],[[p,"armhf"]],[/windows (ce|mobile); ppc;/i],[[p,"arm"]],[/((?:ppc|powerpc)(?:64)?)(?: mac|;|\))/i],[[p,/ower/,"",z]],[/(sun4\w)[;\)]/i],[[p,"sparc"]],[/((?:avr32|ia64(?=;))|68k(?=\))|\barm(?=v(?:[1-7]|[5-7]1)l?|;|eabi)|(?=atmel )avr|(?:irix|mips|sparc)(?:64)?\b|pa-risc)/i],[[p,z]]],device:[[/\b(sch-i[89]0\d|shw-m380s|sm-[ptx]\w{2,4}|gt-[pn]\d{2,4}|sgh-t8[56]9|nexus 10)/i],[f,[v,x],[d,_]],[/\b((?:s[cgp]h|gt|sm)-\w+|sc[g-]?[\d]+a?|galaxy nexus)/i,/samsung[- ]([-\w]+)/i,/sec-(sgh\w+)/i],[f,[v,x],[d,m]],[/\((ip(?:hone|od)[\w ]*);/i],[f,[v,I],[d,m]],[/\((ipad);[-\w\),; ]+apple/i,/applecoremedia\/[\w\.]+ \((ipad)/i,/\b(ipad)\d\d?,\d\d?[;\]].+ios/i],[f,[v,I],[d,_]],[/(macintosh);/i],[f,[v,I]],[/\b(sh-?[altvz]?\d\d[a-ekm]?)/i],[f,[v,M],[d,m]],[/\b((?:ag[rs][23]?|bah2?|sht?|btv)-a?[lw]\d{2})\b(?!.+d\/s)/i],[f,[v,R],[d,_]],[/(?:huawei|honor)([-\w ]+)[;\)]/i,/\b(nexus 6p|\w{2,4}e?-[atu]?[ln][\dx][012359c][adn]?)\b(?!.+d\/s)/i],[f,[v,R],[d,m]],[/\b(poco[\w ]+)(?: bui|\))/i,/\b; (\w+) build\/hm\1/i,/\b(hm[-_ ]?note?[_ ]?(?:\d\w)?) bui/i,/\b(redmi[\-_ ]?(?:note|k)?[\w_ ]+)(?: bui|\))/i,/\b(mi[-_ ]?(?:a\d|one|one[_ ]plus|note lte|max|cc)?[_ ]?(?:\d?\w?)[_ ]?(?:plus|se|lite)?)(?: bui|\))/i],[[f,/_/g," "],[v,L],[d,m]],[/\b(mi[-_ ]?(?:pad)(?:[\w_ ]+))(?: bui|\))/i],[[f,/_/g," "],[v,L],[d,_]],[/; (\w+) bui.+ oppo/i,/\b(cph[12]\d{3}|p(?:af|c[al]|d\w|e[ar])[mt]\d0|x9007|a101op)\b/i],[f,[v,"OPPO"],[d,m]],[/vivo (\w+)(?: bui|\))/i,/\b(v[12]\d{3}\w?[at])(?: bui|;)/i],[f,[v,"Vivo"],[d,m]],[/\b(rmx[12]\d{3})(?: bui|;|\))/i],[f,[v,"Realme"],[d,m]],[/\b(milestone|droid(?:[2-4x]| (?:bionic|x2|pro|razr))?:?( 4g)?)\b[\w ]+build\//i,/\bmot(?:orola)?[- ](\w*)/i,/((?:moto[\w\(\) ]+|xt\d{3,4}|nexus 6)(?= bui|\)))/i],[f,[v,D],[d,m]],[/\b(mz60\d|xoom[2 ]{0,2}) build\//i],[f,[v,D],[d,_]],[/((?=lg)?[vl]k\-?\d{3}) bui| 3\.[-\w; ]{10}lg?-([06cv9]{3,4})/i],[f,[v,N],[d,_]],[/(lm(?:-?f100[nv]?|-[\w\.]+)(?= bui|\))|nexus [45])/i,/\blg[-e;\/ ]+((?!browser|netcast|android tv)\w+)/i,/\blg-?([\d\w]+) bui/i],[f,[v,N],[d,m]],[/(ideatab[-\w ]+)/i,/lenovo ?(s[56]000[-\w]+|tab(?:[\w ]+)|yt[-\d\w]{6}|tb[-\d\w]{6})/i],[f,[v,"Lenovo"],[d,_]],[/(?:maemo|nokia).*(n900|lumia \d+)/i,/nokia[-_ ]?([-\w\.]*)/i],[[f,/_/g," "],[v,"Nokia"],[d,m]],[/(pixel c)\b/i],[f,[v,k],[d,_]],[/droid.+; (pixel[\daxl ]{0,6})(?: bui|\))/i],[f,[v,k],[d,m]],[/droid.+ (a?\d[0-2]{2}so|[c-g]\d{4}|so[-gl]\w+|xq-a\w[4-7][12])(?= bui|\).+chrome\/(?![1-6]{0,1}\d\.))/i],[f,[v,P],[d,m]],[/sony tablet [ps]/i,/\b(?:sony)?sgp\w+(?: bui|\))/i],[[f,"Xperia Tablet"],[v,P],[d,_]],[/ (kb2005|in20[12]5|be20[12][59])\b/i,/(?:one)?(?:plus)? (a\d0\d\d)(?: b|\))/i],[f,[v,"OnePlus"],[d,m]],[/(alexa)webm/i,/(kf[a-z]{2}wi)( bui|\))/i,/(kf[a-z]+)( bui|\)).+silk\//i],[f,[v,E],[d,_]],[/((?:sd|kf)[0349hijorstuw]+)( bui|\)).+silk\//i],[[f,/(.+)/g,"Fire Phone $1"],[v,E],[d,m]],[/(playbook);[-\w\),; ]+(rim)/i],[f,v,[d,_]],[/\b((?:bb[a-f]|st[hv])100-\d)/i,/\(bb10; (\w+)/i],[f,[v,T],[d,m]],[/(?:\b|asus_)(transfo[prime ]{4,10} \w+|eeepc|slider \w+|nexus 7|padfone|p00[cj])/i],[f,[v,A],[d,_]],[/ (z[bes]6[027][012][km][ls]|zenfone \d\w?)\b/i],[f,[v,A],[d,m]],[/(nexus 9)/i],[f,[v,"HTC"],[d,_]],[/(htc)[-;_ ]{1,2}([\w ]+(?=\)| bui)|\w+)/i,/(zte)[- ]([\w ]+?)(?: bui|\/|\))/i,/(alcatel|geeksphone|nexian|panasonic(?!(?:;|\.))|sony(?!-bra))[-_ ]?([-\w]*)/i],[v,[f,/_/g," "],[d,m]],[/droid.+; ([ab][1-7]-?[0178a]\d\d?)/i],[f,[v,"Acer"],[d,_]],[/droid.+; (m[1-5] note) bui/i,/\bmz-([-\w]{2,})/i],[f,[v,"Meizu"],[d,m]],[/(blackberry|benq|palm(?=\-)|sonyericsson|acer|asus|dell|meizu|motorola|polytron)[-_ ]?([-\w]*)/i,/(hp) ([\w ]+\w)/i,/(asus)-?(\w+)/i,/(microsoft); (lumia[\w ]+)/i,/(lenovo)[-_ ]?([-\w]+)/i,/(jolla)/i,/(oppo) ?([\w ]+) bui/i],[v,f,[d,m]],[/(kobo)\s(ereader|touch)/i,/(archos) (gamepad2?)/i,/(hp).+(touchpad(?!.+tablet)|tablet)/i,/(kindle)\/([\w\.]+)/i,/(nook)[\w ]+build\/(\w+)/i,/(dell) (strea[kpr\d ]*[\dko])/i,/(le[- ]+pan)[- ]+(\w{1,9}) bui/i,/(trinity)[- ]*(t\d{3}) bui/i,/(gigaset)[- ]+(q\w{1,9}) bui/i,/(vodafone) ([\w ]+)(?:\)| bui)/i],[v,f,[d,_]],[/(surface duo)/i],[f,[v,C],[d,_]],[/droid [\d\.]+; (fp\du?)(?: b|\))/i],[f,[v,"Fairphone"],[d,m]],[/(u304aa)/i],[f,[v,"AT&T"],[d,m]],[/\bsie-(\w*)/i],[f,[v,"Siemens"],[d,m]],[/\b(rct\w+) b/i],[f,[v,"RCA"],[d,_]],[/\b(venue[\d ]{2,7}) b/i],[f,[v,"Dell"],[d,_]],[/\b(q(?:mv|ta)\w+) b/i],[f,[v,"Verizon"],[d,_]],[/\b(?:barnes[& ]+noble |bn[rt])([\w\+ ]*) b/i],[f,[v,"Barnes & Noble"],[d,_]],[/\b(tm\d{3}\w+) b/i],[f,[v,"NuVision"],[d,_]],[/\b(k88) b/i],[f,[v,"ZTE"],[d,_]],[/\b(nx\d{3}j) b/i],[f,[v,"ZTE"],[d,m]],[/\b(gen\d{3}) b.+49h/i],[f,[v,"Swiss"],[d,m]],[/\b(zur\d{3}) b/i],[f,[v,"Swiss"],[d,_]],[/\b((zeki)?tb.*\b) b/i],[f,[v,"Zeki"],[d,_]],[/\b([yr]\d{2}) b/i,/\b(dragon[- ]+touch |dt)(\w{5}) b/i],[[v,"Dragon Touch"],f,[d,_]],[/\b(ns-?\w{0,9}) b/i],[f,[v,"Insignia"],[d,_]],[/\b((nxa|next)-?\w{0,9}) b/i],[f,[v,"NextBook"],[d,_]],[/\b(xtreme\_)?(v(1[045]|2[015]|[3469]0|7[05])) b/i],[[v,"Voice"],f,[d,m]],[/\b(lvtel\-)?(v1[12]) b/i],[[v,"LvTel"],f,[d,m]],[/\b(ph-1) /i],[f,[v,"Essential"],[d,m]],[/\b(v(100md|700na|7011|917g).*\b) b/i],[f,[v,"Envizen"],[d,_]],[/\b(trio[-\w\. ]+) b/i],[f,[v,"MachSpeed"],[d,_]],[/\btu_(1491) b/i],[f,[v,"Rotor"],[d,_]],[/(shield[\w ]+) b/i],[f,[v,"Nvidia"],[d,_]],[/(sprint) (\w+)/i],[v,f,[d,m]],[/(kin\.[onetw]{3})/i],[[f,/\./g," "],[v,C],[d,m]],[/droid.+; (cc6666?|et5[16]|mc[239][23]x?|vc8[03]x?)\)/i],[f,[v,U],[d,_]],[/droid.+; (ec30|ps20|tc[2-8]\d[kx])\)/i],[f,[v,U],[d,m]],[/smart-tv.+(samsung)/i],[v,[d,w]],[/hbbtv.+maple;(\d+)/i],[[f,/^/,"SmartTV"],[v,x],[d,w]],[/(nux; netcast.+smarttv|lg (netcast\.tv-201\d|android tv))/i],[[v,N],[d,w]],[/(apple) ?tv/i],[v,[f,"Apple TV"],[d,w]],[/crkey/i],[[f,"Chromecast"],[v,k],[d,w]],[/droid.+aft(\w)( bui|\))/i],[f,[v,E],[d,w]],[/\(dtv[\);].+(aquos)/i,/(aquos-tv[\w ]+)\)/i],[f,[v,M],[d,w]],[/(bravia[\w ]+)( bui|\))/i],[f,[v,P],[d,w]],[/(mitv-\w{5}) bui/i],[f,[v,L],[d,w]],[/Hbbtv.*(technisat) (.*);/i],[v,f,[d,w]],[/\b(roku)[\dx]*[\)\/]((?:dvp-)?[\d\.]*)/i,/hbbtv\/\d+\.\d+\.\d+ +\([\w\+ ]*; *([\w\d][^;]*);([^;]*)/i],[[v,G],[f,G],[d,w]],[/\b(android tv|smart[- ]?tv|opera tv|tv; rv:)\b/i],[[d,w]],[/(ouya)/i,/(nintendo) ([wids3utch]+)/i],[v,f,[d,g]],[/droid.+; (shield) bui/i],[f,[v,"Nvidia"],[d,g]],[/(playstation [345portablevi]+)/i],[f,[v,P],[d,g]],[/\b(xbox(?: one)?(?!; xbox))[\); ]/i],[f,[v,C],[d,g]],[/((pebble))app/i],[v,f,[d,y]],[/droid.+; (glass) \d/i],[f,[v,k],[d,y]],[/droid.+; (wt63?0{2,3})\)/i],[f,[v,U],[d,y]],[/(quest( 2| pro)?)/i],[f,[v,V],[d,y]],[/(tesla)(?: qtcarbrowser|\/[-\w\.]+)/i],[v,[d,b]],[/droid .+?; ([^;]+?)(?: bui|\) applew).+? mobile safari/i],[f,[d,m]],[/droid .+?; ([^;]+?)(?: bui|\) applew).+?(?! mobile) safari/i],[f,[d,_]],[/\b((tablet|tab)[;\/]|focus\/\d(?!.+mobile))/i],[[d,_]],[/(phone|mobile(?:[;\/]| [ \w\/\.]*safari)|pda(?=.+windows ce))/i],[[d,m]],[/(android[-\w\. ]{0,9});.+buil/i],[f,[v,"Generic"]]],engine:[[/windows.+ edge\/([\w\.]+)/i],[h,[l,"EdgeHTML"]],[/webkit\/537\.36.+chrome\/(?!27)([\w\.]+)/i],[h,[l,"Blink"]],[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m|goanna)\/([\w\.]+)/i,/ekioh(flow)\/([\w\.]+)/i,/(khtml|tasman|links)[\/ ]\(?([\w\.]+)/i,/(icab)[\/ ]([23]\.[\d\.]+)/i],[l,h],[/rv\:([\w\.]{1,9})\b.+(gecko)/i],[h,l]],os:[[/microsoft (windows) (vista|xp)/i],[l,h],[/(windows) nt 6\.2; (arm)/i,/(windows (?:phone(?: os)?|mobile))[\/ ]?([\d\.\w ]*)/i,/(windows)[\/ ]?([ntce\d\. ]+\w)(?!.+xbox)/i],[l,[h,q,H]],[/(win(?=3|9|n)|win 9x )([nt\d\.]+)/i],[[l,"Windows"],[h,q,H]],[/ip[honead]{2,4}\b(?:.*os ([\w]+) like mac|; opera)/i,/cfnetwork\/.+darwin/i],[[h,/_/g,"."],[l,"iOS"]],[/(mac os x) ?([\w\. ]*)/i,/(macintosh|mac_powerpc\b)(?!.+haiku)/i],[[l,"Mac OS"],[h,/_/g,"."]],[/droid ([\w\.]+)\b.+(android[- ]x86|harmonyos)/i],[h,l],[/(android|webos|qnx|bada|rim tablet os|maemo|meego|sailfish)[-\/ ]?([\w\.]*)/i,/(blackberry)\w*\/([\w\.]*)/i,/(tizen|kaios)[\/ ]([\w\.]+)/i,/\((series40);/i],[l,h],[/\(bb(10);/i],[h,[l,T]],[/(?:symbian ?os|symbos|s60(?=;)|series60)[-\/ ]?([\w\.]*)/i],[h,[l,"Symbian"]],[/mozilla\/[\d\.]+ \((?:mobile|tablet|tv|mobile; [\w ]+); rv:.+ gecko\/([\w\.]+)/i],[h,[l,"Firefox OS"]],[/web0s;.+rt(tv)/i,/\b(?:hp)?wos(?:browser)?\/([\w\.]+)/i],[h,[l,"webOS"]],[/crkey\/([\d\.]+)/i],[h,[l,"Chromecast"]],[/(cros) [\w]+(?:\)| ([\w\.]+)\b)/i],[[l,"Chromium OS"],h],[/panasonic;(viera)/i,/(netrange)mmh/i,/(nettv)\/(\d+\.[\w\.]+)/i,/(nintendo|playstation) ([wids345portablevuch]+)/i,/(xbox); +xbox ([^\);]+)/i,/\b(joli|palm)\b ?(?:os)?\/?([\w\.]*)/i,/(mint)[\/\(\) ]?(\w*)/i,/(mageia|vectorlinux)[; ]/i,/([kxln]?ubuntu|debian|suse|opensuse|gentoo|arch(?= linux)|slackware|fedora|mandriva|centos|pclinuxos|red ?hat|zenwalk|linpus|raspbian|plan 9|minix|risc os|contiki|deepin|manjaro|elementary os|sabayon|linspire)(?: gnu\/linux)?(?: enterprise)?(?:[- ]linux)?(?:-gnu)?[-\/ ]?(?!chrom|package)([-\w\.]*)/i,/(hurd|linux) ?([\w\.]*)/i,/(gnu) ?([\w\.]*)/i,/\b([-frentopcghs]{0,5}bsd|dragonfly)[\/ ]?(?!amd|[ix346]{1,2}86)([\w\.]*)/i,/(haiku) (\w+)/i],[l,h],[/(sunos) ?([\w\.\d]*)/i],[[l,"Solaris"],h],[/((?:open)?solaris)[-\/ ]?([\w\.]*)/i,/(aix) ((\d)(?=\.|\)| )[\w\.])*/i,/\b(beos|os\/2|amigaos|morphos|openvms|fuchsia|hp-ux)/i,/(unix) ?([\w\.]*)/i],[l,h]]},$=function(t,n){if(typeof t===c&&(n=t,t=o),!(this instanceof $))return new $(t,n).getResult();var e=t||(typeof r!==u&&r.navigator&&r.navigator.userAgent?r.navigator.userAgent:""),i=typeof r!==u&&r.navigator&&r.navigator.userAgentData?r.navigator.userAgentData:o,a=n?function(t,n){var e={};for(var i in t)n[i]&&n[i].length%2==0?e[i]=n[i].concat(t[i]):e[i]=t[i];return e}(Y,n):Y;return this.getBrowser=function(){var t,n={};return n.name=o,n.version=o,j.call(n,e,a.browser),n.major=typeof(t=n.version)===s?t.replace(/[^\d\.]/g,"").split(".")[0]:o,n},this.getCPU=function(){var t={};return t.architecture=o,j.call(t,e,a.cpu),t},this.getDevice=function(){var t={};return t.vendor=o,t.model=o,t.type=o,j.call(t,e,a.device),!t.type&&i&&i.mobile&&(t.type=m),t},this.getEngine=function(){var t={};return t.name=o,t.version=o,j.call(t,e,a.engine),t},this.getOS=function(){var t={};return t.name=o,t.version=o,j.call(t,e,a.os),!t.name&&i&&"Unknown"!=i.platform&&(t.name=i.platform.replace(/chrome/i,"Chromium").replace(/mac/i,"Mac ")),t},this.getResult=function(){return{ua:this.getUA(),browser:this.getBrowser(),engine:this.getEngine(),os:this.getOS(),device:this.getDevice(),cpu:this.getCPU()}},this.getUA=function(){return e},this.setUA=function(t){return e=typeof t===s&&t.length>350?G(t,350):t,this},this.setUA(e),this};$.VERSION="0.7.33",$.BROWSER=F([l,h,"major"]),$.CPU=F([p]),$.DEVICE=F([f,v,d,g,m,w,_,y,b]),$.ENGINE=$.OS=F([l,h]),typeof n!==u?(t.exports&&(n=t.exports=$),n.UAParser=$):e.amdO?(i=function(){return $}.call(n,e,n,t))===o||(t.exports=i):typeof r!==u&&(r.UAParser=$)}("object"==typeof window?window:this)},8397:function(t,n,e){var i=e(6277)(),r=e(9282);t.exports=function(t,n){function e(n){if(!(this instanceof e))return new e(n);try{throw new Error(n)}catch(o){o.name=t,this.stack=o.stack}i&&this.stack&&(this.stack=r(this.stack,t,n)),this.message=n||"",this.name=t}return e.prototype=new(n||Error),e.prototype.constructor=e,e.prototype.inspect=function(){return this.message?"["+t+": "+this.message+"]":"["+t+"]"},e.prototype.name=t,e}},9282:function(t){"use strict";t.exports=function(t,n,e){var i=n;return e&&(i+=": "+e),t=i+t.slice(t.indexOf("\n"))}},6277:function(t){"use strict";t.exports=function(){var t=new Error("yep");return!!t.stack&&"Error: yep\n"===t.stack.substr(0,11)}},9745:function(t,n,e){t.exports=function(){"use strict";function t(t){return"function"==typeof t||"object"==typeof t&&null!==t}function n(t){return"function"==typeof t}undefined;var i=Array.isArray?Array.isArray:function(t){return"[object Array]"===Object.prototype.toString.call(t)},r=0,o=undefined,a=undefined,u=function(t,n){y[r]=t,y[r+1]=n,2===(r+=2)&&(a?a(b):I())};function c(t){a=t}function s(t){u=t}var f="undefined"!=typeof window?window:undefined,l=f||{},d=l.MutationObserver||l.WebKitMutationObserver,v="undefined"==typeof self&&"undefined"!=typeof process&&"[object process]"==={}.toString.call(process),h="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel;function p(){return function(){return process.nextTick(b)}}function g(){return void 0!==o?function(){o(b)}:w()}function m(){var t=0,n=new d(b),e=document.createTextNode("");return n.observe(e,{characterData:!0}),function(){e.data=t=++t%2}}function _(){var t=new MessageChannel;return t.port1.onmessage=b,function(){return t.port2.postMessage(0)}}function w(){var t=setTimeout;return function(){return t(b,1)}}var y=new Array(1e3);function b(){for(var t=0;t<r;t+=2)(0,y[t])(y[t+1]),y[t]=undefined,y[t+1]=undefined;r=0}function E(){try{undefined;var t=e(4774);return o=t.runOnLoop||t.runOnContext,g()}catch(n){return w()}}var I=undefined;function A(t,n){var e=arguments,i=this,r=new this.constructor(k);r[S]===undefined&&Q(r);var o,a=i._state;return a?(o=e[a-1],u((function(){return K(a,r,o,i._result)}))):j(i,r,t,n),r}function T(t){var n=this;if(t&&"object"==typeof t&&t.constructor===n)return t;var e=new n(k);return F(e,t),e}I=v?p():d?m():h?_():f===undefined?E():w();var S=Math.random().toString(36).substring(16);function k(){}var R=void 0,N=1,C=2,D=new H;function O(){return new TypeError("You cannot resolve a promise with itself")}function x(){return new TypeError("A promises callback cannot return that same promise.")}function M(t){try{return t.then}catch(n){return D.error=n,D}}function P(t,n,e,i){try{t.call(n,e,i)}catch(r){return r}}function L(t,n,e){u((function(t){var i=!1,r=P(e,n,(function(e){i||(i=!0,n!==e?F(t,e):z(t,e))}),(function(n){i||(i=!0,G(t,n))}),"Settle: "+(t._label||" unknown promise"));!i&&r&&(i=!0,G(t,r))}),t)}function U(t,n){n._state===N?z(t,n._result):n._state===C?G(t,n._result):j(n,undefined,(function(n){return F(t,n)}),(function(n){return G(t,n)}))}function V(t,e,i){e.constructor===t.constructor&&i===A&&e.constructor.resolve===T?U(t,e):i===D?(G(t,D.error),D.error=null):i===undefined?z(t,e):n(i)?L(t,e,i):z(t,e)}function F(n,e){n===e?G(n,O()):t(e)?V(n,e,M(e)):z(n,e)}function B(t){t._onerror&&t._onerror(t._result),q(t)}function z(t,n){t._state===R&&(t._result=n,t._state=N,0!==t._subscribers.length&&u(q,t))}function G(t,n){t._state===R&&(t._state=C,t._result=n,u(B,t))}function j(t,n,e,i){var r=t._subscribers,o=r.length;t._onerror=null,r[o]=n,r[o+N]=e,r[o+C]=i,0===o&&t._state&&u(q,t)}function q(t){var n=t._subscribers,e=t._state;if(0!==n.length){for(var i=undefined,r=undefined,o=t._result,a=0;a<n.length;a+=3)i=n[a],r=n[a+e],i?K(e,i,r,o):r(o);t._subscribers.length=0}}function H(){this.error=null}var Y=new H;function $(t,n){try{return t(n)}catch(e){return Y.error=e,Y}}function K(t,e,i,r){var o=n(i),a=undefined,u=undefined,c=undefined,s=undefined;if(o){if((a=$(i,r))===Y?(s=!0,u=a.error,a.error=null):c=!0,e===a)return void G(e,x())}else a=r,c=!0;e._state!==R||(o&&c?F(e,a):s?G(e,u):t===N?z(e,a):t===C&&G(e,a))}function W(t,n){try{n((function(n){F(t,n)}),(function(n){G(t,n)}))}catch(e){G(t,e)}}var X=0;function J(){return X++}function Q(t){t[S]=X++,t._state=undefined,t._result=undefined,t._subscribers=[]}function Z(t,n){this._instanceConstructor=t,this.promise=new t(k),this.promise[S]||Q(this.promise),i(n)?(this._input=n,this.length=n.length,this._remaining=n.length,this._result=new Array(this.length),0===this.length?z(this.promise,this._result):(this.length=this.length||0,this._enumerate(),0===this._remaining&&z(this.promise,this._result))):G(this.promise,tt())}function tt(){return new Error("Array Methods must be provided an Array")}function nt(t){return new Z(this,t).promise}function et(t){var n=this;return i(t)?new n((function(e,i){for(var r=t.length,o=0;o<r;o++)n.resolve(t[o]).then(e,i)})):new n((function(t,n){return n(new TypeError("You must pass an array to race."))}))}function it(t){var n=new this(k);return G(n,t),n}function rt(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}function ot(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}function at(t){this[S]=J(),this._result=this._state=undefined,this._subscribers=[],k!==t&&("function"!=typeof t&&rt(),this instanceof at?W(this,t):ot())}function ut(){var t=undefined;if("undefined"!=typeof e.g)t=e.g;else if("undefined"!=typeof self)t=self;else try{t=Function("return this")()}catch(r){throw new Error("polyfill failed because global object is unavailable in this environment")}var n=t.Promise;if(n){var i=null;try{i=Object.prototype.toString.call(n.resolve())}catch(r){}if("[object Promise]"===i&&!n.cast)return}t.Promise=at}return Z.prototype._enumerate=function(){for(var t=this.length,n=this._input,e=0;this._state===R&&e<t;e++)this._eachEntry(n[e],e)},Z.prototype._eachEntry=function(t,n){var e=this._instanceConstructor,i=e.resolve;if(i===T){var r=M(t);if(r===A&&t._state!==R)this._settledAt(t._state,n,t._result);else if("function"!=typeof r)this._remaining--,this._result[n]=t;else if(e===at){var o=new e(k);V(o,t,r),this._willSettleAt(o,n)}else this._willSettleAt(new e((function(n){return n(t)})),n)}else this._willSettleAt(i(t),n)},Z.prototype._settledAt=function(t,n,e){var i=this.promise;i._state===R&&(this._remaining--,t===C?G(i,e):this._result[n]=e),0===this._remaining&&z(i,this._result)},Z.prototype._willSettleAt=function(t,n){var e=this;j(t,undefined,(function(t){return e._settledAt(N,n,t)}),(function(t){return e._settledAt(C,n,t)}))},at.all=nt,at.race=et,at.resolve=T,at.reject=it,at._setScheduler=c,at._setAsap=s,at._asap=u,at.prototype={constructor:at,then:A,"catch":function(t){return this.then(null,t)}},at.polyfill=ut,at.Promise=at,at}()},4204:function(t){"use strict";t.exports=function(t){var n,e={};if(!(t instanceof Object)||Array.isArray(t))throw new Error("keyMirror(...): Argument must be an object.");for(n in t)t.hasOwnProperty(n)&&(e[n]=n);return e}},1335:function(t){"use strict";t.exports=function(t,n,e,i){Object.defineProperty(t,n,{get:function(){var t=e.call(this);return Object.defineProperty(this,n,{value:t,enumerable:!!i,writable:!0}),t},set:function(t){return Object.defineProperty(this,n,{value:t,enumerable:!!i,writable:!0}),t},enumerable:!!i,configurable:!0})}},2175:function(t){"use strict";var n=Element.prototype,e=n.matches||n.matchesSelector||n.webkitMatchesSelector||n.mozMatchesSelector||n.msMatchesSelector||n.oMatchesSelector;t.exports=function(t,n){if(e)return e.call(t,n);for(var i=t.parentNode.querySelectorAll(n),r=0;r<i.length;r++)if(i[r]==t)return!0;return!1}},5876:function(t){!function(){function n(t,n){var e,i,r,o,a,u,c,s;for(e=3&t.length,i=t.length-e,r=n,a=3432918353,u=461845907,s=0;s<i;)c=255&t.charCodeAt(s)|(255&t.charCodeAt(++s))<<8|(255&t.charCodeAt(++s))<<16|(255&t.charCodeAt(++s))<<24,++s,r=27492+(65535&(o=5*(65535&(r=(r^=c=(65535&(c=(c=(65535&c)*a+(((c>>>16)*a&65535)<<16)&4294967295)<<15|c>>>17))*u+(((c>>>16)*u&65535)<<16)&4294967295)<<13|r>>>19))+((5*(r>>>16)&65535)<<16)&4294967295))+((58964+(o>>>16)&65535)<<16);switch(c=0,e){case 3:c^=(255&t.charCodeAt(s+2))<<16;case 2:c^=(255&t.charCodeAt(s+1))<<8;case 1:r^=c=(65535&(c=(c=(65535&(c^=255&t.charCodeAt(s)))*a+(((c>>>16)*a&65535)<<16)&4294967295)<<15|c>>>17))*u+(((c>>>16)*u&65535)<<16)&4294967295}return r^=t.length,r=2246822507*(65535&(r^=r>>>16))+((2246822507*(r>>>16)&65535)<<16)&4294967295,r=3266489909*(65535&(r^=r>>>13))+((3266489909*(r>>>16)&65535)<<16)&4294967295,(r^=r>>>16)>>>0}var e=n;e.v2=function(t,n){for(var e,i=t.length,r=n^i,o=0;i>=4;)e=1540483477*(65535&(e=255&t.charCodeAt(o)|(255&t.charCodeAt(++o))<<8|(255&t.charCodeAt(++o))<<16|(255&t.charCodeAt(++o))<<24))+((1540483477*(e>>>16)&65535)<<16),r=1540483477*(65535&r)+((1540483477*(r>>>16)&65535)<<16)^(e=1540483477*(65535&(e^=e>>>24))+((1540483477*(e>>>16)&65535)<<16)),i-=4,++o;switch(i){case 3:r^=(255&t.charCodeAt(o+2))<<16;case 2:r^=(255&t.charCodeAt(o+1))<<8;case 1:r=1540483477*(65535&(r^=255&t.charCodeAt(o)))+((1540483477*(r>>>16)&65535)<<16)}return r=1540483477*(65535&(r^=r>>>13))+((1540483477*(r>>>16)&65535)<<16),(r^=r>>>15)>>>0},e.v3=n,t.exports=e}()},1812:function(t,n,e){t=e.nmd(t),function(){var i,r="Expected a function",o="__lodash_hash_undefined__",a=9007199254740991,u="[object Arguments]",c="[object Array]",s="[object Boolean]",f="[object Date]",l="[object Error]",d="[object Function]",v="[object GeneratorFunction]",h="[object Map]",p="[object Number]",g="[object Object]",m="[object RegExp]",_="[object Set]",w="[object String]",y="[object Symbol]",b="[object WeakMap]",E="[object ArrayBuffer]",I="[object Float32Array]",A="[object Float64Array]",T="[object Int8Array]",S="[object Int16Array]",k="[object Int32Array]",R="[object Uint8Array]",N="[object Uint8ClampedArray]",C="[object Uint16Array]",D="[object Uint32Array]",O=/[&<>"'`]/g,x=RegExp(O.source),M=/\w*$/,P=/^\[object .+?Constructor\]$/,L=/^(?:0|[1-9]\d*)$/,U={};U[I]=U[A]=U[T]=U[S]=U[k]=U[R]=U[N]=U[C]=U[D]=!0,U[u]=U[c]=U[E]=U[s]=U[f]=U[l]=U[d]=U[h]=U[p]=U[g]=U[m]=U[_]=U[w]=U[b]=!1;var V={};V[u]=V[c]=V[E]=V[s]=V[f]=V[I]=V[A]=V[T]=V[S]=V[k]=V[h]=V[p]=V[g]=V[m]=V[_]=V[w]=V[y]=V[R]=V[N]=V[C]=V[D]=!0,V[l]=V[d]=V[b]=!1;var F={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","`":"&#96;"},B={"function":!0,object:!0},z=B[typeof n]&&n&&!n.nodeType?n:i,G=B.object&&t&&!t.nodeType?t:i,j=G&&G.exports===z?z:i,q=rt(z&&G&&"object"==typeof e.g&&e.g),H=rt(B[typeof self]&&self),Y=rt(B[typeof window]&&window),$=rt(B[typeof this]&&this),K=q||Y!==($&&$.window)&&Y||H||$||Function("return this")();function W(t,n){return t.set(n[0],n[1]),t}function X(t,n){return t.add(n),t}function J(t,n){return tt(In(t),Ae)}function Q(t,n){return!!t.length&&et(t,n,0)>-1}function Z(t,n,e){for(var i=-1,r=t.length;++i<r;)if(e(n,t[i]))return!0;return!1}function tt(t,n){for(var e=-1,i=n.length,r=t.length;++e<i;)t[r+e]=n[e];return t}function nt(t,n,e){for(var r=-1,o=t.length;++r<o;){var a=t[r],u=n(a);if(null!=u&&(c===i?u==u:e(u,c)))var c=u,s=a}return s}function et(t,n,e){if(n!=n)return function(t,n,e){var i=t.length,r=n+(e?0:-1);for(;e?r--:++r<i;){var o=t[r];if(o!=o)return r}return-1}(t,e);for(var i=e-1,r=t.length;++i<r;)if(t[i]===n)return i;return-1}function it(t,n,e,i,r){return r(t,(function(t,r,o){e=i?(i=!1,t):n(e,t,r,o)})),e}function rt(t){return t&&t.Object===Object?t:null}function ot(t){return F[t]}function at(t){var n=!1;if(null!=t&&"function"!=typeof t.toString)try{n=!!(t+"")}catch(e){}return n}function ut(t,n){return t="number"==typeof t||L.test(t)?+t:-1,n=null==n?a:n,t>-1&&t%1==0&&t<n}var ct=Array.prototype,st=Object.prototype,ft=Function.prototype.toString,lt=st.hasOwnProperty,dt=0,vt=ft.call(Object),ht=st.toString,pt=K._,gt=RegExp("^"+ft.call(lt).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),mt=K.Reflect,_t=K.Symbol,wt=K.Uint8Array,yt=mt?mt.enumerate:i,bt=Object.getPrototypeOf,Et=Object.getOwnPropertySymbols,It=Object.create,At=st.propertyIsEnumerable,Tt=ct.splice,St=K.isFinite,kt=Object.keys,Rt=Math.max,Nt=On(K,"Map"),Ct=On(K,"Set"),Dt=On(K,"WeakMap"),Ot=On(Object,"create"),xt=Nt?ft.call(Nt):"",Mt=Ct?ft.call(Ct):"",Pt=Dt?ft.call(Dt):"",Lt=_t?_t.prototype:i,Ut=Lt?Lt.valueOf:i;function Vt(t){if(ue(t)&&!Zn(t)){if(t instanceof Ft)return t;if(lt.call(t,"__wrapped__"))return function(t){var n=new Ft(t.u,t.l);return n.I=In(t.I),n}(t)}return new Ft(t)}function Ft(t,n){this.u=t,this.I=[],this.l=!!n}function Bt(){}function zt(t,n){return Ot?t[n]!==i:lt.call(t,n)}function Gt(t){var n=-1,e=t?t.length:0;for(this.clear();++n<e;){var i=t[n];this.set(i[0],i[1])}}function jt(t){var n=-1,e=t?t.length:0;for(this.T=new Gt;++n<e;)this.push(t[n])}function qt(t,n){var e=t.T;if(Ln(n)){var i=e.T;return("string"==typeof n?i.string:i.hash)[n]===o}return e.has(n)}function Ht(t){var n=-1,e=t?t.length:0;for(this.clear();++n<e;){var i=t[n];this.set(i[0],i[1])}}function Yt(t,n){var e=Wt(t,n);return!(e<0)&&(e==t.length-1?t.pop():Tt.call(t,e,1),!0)}function $t(t,n){var e=Wt(t,n);return e<0?i:t[e][1]}function Kt(t,n){return Wt(t,n)>-1}function Wt(t,n){for(var e=t.length;e--;)if(Xn(t[e][0],n))return e;return-1}function Xt(t,n,e){var i=Wt(t,n);i<0?t.push([n,e]):t[i][1]=e}function Jt(t,n,e,r){return t===i||Xn(t,st[e])&&!lt.call(r,e)?n:t}function Qt(t,n,e){(e!==i&&!Xn(t[n],e)||"number"==typeof n&&e===i&&!(n in t))&&(t[n]=e)}function Zt(t,n,e){var r=t[n];lt.call(t,n)&&Xn(r,e)&&(e!==i||n in t)||(t[n]=e)}function tn(t){return"function"==typeof t?t:Te}function nn(t,n,e,r,o,a,c){var l;if(r&&(l=a?r(t,o,a,c):r(t)),l!==i)return l;if(!ae(t))return t;var b=Zn(t);if(b){if(l=function(t){var n=t.length,e=t.constructor(n);n&&"string"==typeof t[0]&&lt.call(t,"index")&&(e.index=t.index,e.input=t.input);return e}(t),!n)return In(t)}else{var O=Mn(t),x=O==d||O==v;if(ie(t))return function(t,n){if(n)return t.slice();var e=new t.constructor(t.length);return t.copy(e),e}(t,n);if(O==g||O==u||x&&!a){if(at(t))return a?t:{};if(l=function(t){return"function"!=typeof t.constructor||Un(t)?{}:en(bt(t))}(x?{}:t),!n)return l=function(t,n){return t&&Sn(n,we(n),t)}(l,t),e?Rn(t,l):l}else{if(!V[O])return a?t:{};l=function(t,n,e){var i=t.constructor;switch(n){case E:return Tn(t);case s:case f:return new i(+t);case I:case A:case T:case S:case k:case R:case N:case C:case D:return function(t,n){var e=n?Tn(t.buffer):t.buffer;return new t.constructor(e,t.byteOffset,t.length)}(t,e);case h:return function(t){return jn(function(t){var n=-1,e=Array(t.size);return t.forEach((function(t,i){e[++n]=[i,t]})),e}(t),W,new t.constructor)}(t);case p:case w:return new i(t);case m:return function(t){var n=new t.constructor(t.source,M.exec(t));return n.lastIndex=t.lastIndex,n}(t);case _:return jn(function(t){var n=-1,e=Array(t.size);return t.forEach((function(t){e[++n]=t})),e}(o=t),X,new o.constructor);case y:return r=t,Ut?Object(Ut.call(r)):{}}var r;var o}(t,O,n)}}c||(c=new Ht);var P=c.get(t);return P||(c.set(t,l),(b?un:ln)(t,(function(i,o){Zt(l,o,nn(i,n,e,r,o,t,c))})),e&&!b?Rn(t,l):l)}function en(t){return ae(t)?It(t):{}}function rn(t,n,e){if("function"!=typeof t)throw new TypeError(r);return setTimeout((function(){t.apply(i,e)}),n)}var on,an,un=(on=ln,function(t,n){if(null==t)return t;if(!te(t))return on(t,n);for(var e=t.length,i=an?e:-1,r=Object(t);(an?i--:++i<e)&&!1!==n(r[i],i,r););return t});function cn(t,n){var e=[];return un(t,(function(t,i,r){n(t,i,r)&&e.push(t)})),e}function sn(t,n,e,i){i||(i=[]);for(var r=-1,o=t.length;++r<o;){var a=t[r];n>0&&ne(a)&&(e||Zn(a)||Qn(a))?n>1?sn(a,n-1,e,i):tt(i,a):e||(i[i.length]=a)}return i}var fn=function(t){return function(n,e,i){for(var r=-1,o=Object(n),a=i(n),u=a.length;u--;){var c=a[t?u:++r];if(!1===e(o[c],c,o))break}return n}}();function ln(t,n){return t&&fn(t,n,we)}function dn(t,n){return cn(n,(function(n){return re(t[n])}))}function vn(t,n,e,r,o){return t===n||(null==t||null==n||!ae(t)&&!ue(n)?t!=t&&n!=n:function(t,n,e,r,o,a){var d=Zn(t),v=Zn(n),h=c,_=c;d||(h=(h=ht.call(t))==u?g:h);v||(_=(_=ht.call(n))==u?g:_);var y=h==g&&!at(t),b=_==g&&!at(n),E=h==_;a||(a=[]);var I=zn(a,(function(n){return n[0]===t}));if(I&&I[1])return I[1]==n;if(a.push([t,n]),E&&!y){var A=d||fe(t)?function(t,n,e,r,o,a){var u=-1,c=2&o,s=1&o,f=t.length,l=n.length;if(f!=l&&!(c&&l>f))return!1;var d=!0;for(;++u<f;){var v,h=t[u],p=n[u];if(v!==i){if(v)continue;d=!1;break}if(s){if(!An(n,(function(t){return h===t||e(h,t,r,o,a)}))){d=!1;break}}else if(h!==p&&!e(h,p,r,o,a)){d=!1;break}}return d}(t,n,e,r,o,a):function(t,n,e,i,r,o,a){switch(e){case s:case f:return+t==+n;case l:return t.name==n.name&&t.message==n.message;case p:return t!=+t?n!=+n:t==+n;case m:case w:return t==n+""}return!1}(t,n,h);return a.pop(),A}if(!(2&o)){var T=y&&lt.call(t,"__wrapped__"),S=b&&lt.call(n,"__wrapped__");if(T||S){A=e(T?t.value():t,S?n.value():n,r,o,a);return a.pop(),A}}if(!E)return!1;A=function(t,n,e,r,o,a){var u=2&o,c=we(t),s=c.length,f=we(n).length;if(s!=f&&!u)return!1;var l=s;for(;l--;){var d=c[l];if(!(u?d in n:lt.call(n,d)))return!1}var v=!0,h=u;for(;++l<s;){var p,g=t[d=c[l]],m=n[d];if(!(p===i?g===m||e(g,m,r,o,a):p)){v=!1;break}h||(h="constructor"==d)}if(v&&!h){var _=t.constructor,w=n.constructor;_==w||!("constructor"in t)||!("constructor"in n)||"function"==typeof _&&_ instanceof _&&"function"==typeof w&&w instanceof w||(v=!1)}return v}(t,n,e,r,o,a);return a.pop(),A}(t,n,vn,e,r,o))}function hn(t){var n=typeof t;return"function"==n?t:null==t?Te:("object"==n?mn:bn)(t)}function pn(t){t=null==t?t:Object(t);var n=[];for(var e in t)n.push(e);return n}function gn(t,n){var e=-1,i=te(t)?Array(t.length):[];return un(t,(function(t,r,o){i[++e]=n(t,r,o)})),i}function mn(t){var n=we(t);return function(e){var r=n.length;if(null==e)return!r;for(e=Object(e);r--;){var o=n[r];if(!(o in e)||!vn(t[o],e[o],i,3))return!1}return!0}}function _n(t,n,e,r,o){if(t!==n){var a=Zn(n)||fe(n)?i:ye(n);un(a||n,(function(u,c){if(a&&(u=n[c=u]),ae(u))o||(o=new Ht),function(t,n,e,r,o,a,u){var c=t[e],s=n[e],f=u.get(s);if(f)return void Qt(t,e,f);var l=a?a(c,s,e+"",t,n,u):i,d=l===i;d&&(l=s,Zn(s)||fe(s)?Zn(c)?l=c:ne(c)?l=In(c):(d=!1,l=nn(s,!a)):function(t){if(!ue(t)||ht.call(t)!=g||at(t))return!1;var n=bt(t);if(null===n)return!0;var e=n.constructor;return"function"==typeof e&&e instanceof e&&ft.call(e)==vt}(s)||Qn(s)?Qn(c)?l=Sn(v=c,ye(v)):!ae(c)||r&&re(c)?(d=!1,l=nn(s,!a)):l=c:d=!1);var v;u.set(s,l),d&&o(l,s,r,a,u);u["delete"](s),Qt(t,e,l)}(t,n,c,e,_n,r,o);else{var s=r?r(t[c],u,c+"",t,n,o):i;s===i&&(s=u),Qt(t,c,s)}}))}}function wn(t,n){return t=Object(t),jn(n,(function(n,e){return e in t&&(n[e]=t[e]),n}),{})}function yn(t,n){var e={};return function(t,n){null==t||fn(t,n,ye)}(t,(function(t,i){n(t,i)&&(e[i]=t)})),e}function bn(t){return function(n){return null==n?i:n[t]}}function En(t,n,e){var i=-1,r=t.length;n<0&&(n=-n>r?0:r+n),(e=e>r?r:e)<0&&(e+=r),r=n>e?0:e-n>>>0,n>>>=0;for(var o=Array(r);++i<r;)o[i]=t[i+n];return o}function In(t){return En(t,0,t.length)}function An(t,n){var e;return un(t,(function(t,i,r){return!(e=n(t,i,r))})),!!e}function Tn(t){var n=new t.constructor(t.byteLength);return new wt(n).set(new wt(t)),n}yt&&!At.call({valueOf:1},"valueOf")&&(pn=function(t){return function(t){for(var n,e=[];!(n=t.next()).done;)e.push(n.value);return e}(yt(t))});var Sn=kn;function kn(t,n,e,i){e||(e={});for(var r=-1,o=n.length;++r<o;){var a=n[r];Zt(e,a,i?i(e[a],t[a],a,e,t):t[a])}return e}function Rn(t,n){return Sn(t,xn(t),n)}function Nn(t){return Wn((function(n,e){var r=-1,o=e.length,a=o>1?e[o-1]:i;for(a="function"==typeof a?(o--,a):i,n=Object(n);++r<o;){var u=e[r];u&&t(n,u,r,a)}return n}))}function Cn(t,n,e,i){if("function"!=typeof t)throw new TypeError(r);var o=1&n,a=function(t){return function(){var n=arguments,e=en(t.prototype),i=t.apply(e,n);return ae(i)?i:e}}(t);return function u(){for(var n=-1,r=arguments.length,c=-1,s=i.length,f=Array(s+r),l=this&&this!==K&&this instanceof u?a:t;++c<s;)f[c]=i[c];for(;r--;)f[c++]=arguments[++n];return l.apply(o?e:this,f)}}var Dn=bn("length");function On(t,n){var e=t[n];return function(t){if(null==t)return!1;if(re(t))return gt.test(ft.call(t));return ue(t)&&(at(t)?gt:P).test(t)}(e)?e:i}var xn=Et||function(){return[]};function Mn(t){return ht.call(t)}function Pn(t){var n=t?t.length:i;return oe(n)&&(Zn(t)||se(t)||Qn(t))?function(t,n){for(var e=-1,i=Array(t);++e<t;)i[e]=n(e);return i}(n,String):null}function Ln(t){var n=typeof t;return"number"==n||"boolean"==n||"string"==n&&"__proto__"!=t||null==t}function Un(t){var n=t&&t.constructor;return t===("function"==typeof n&&n.prototype||st)}(Nt&&Mn(new Nt)!=h||Ct&&Mn(new Ct)!=_||Dt&&Mn(new Dt)!=b)&&(Mn=function(t){var n=ht.call(t),e=n==g?t.constructor:null,i="function"==typeof e?ft.call(e):"";if(i)switch(i){case xt:return h;case Mt:return _;case Pt:return b}return n});var Vn=Wn((function(t,n){return Zn(t)||(t=null==t?[]:[Object(t)]),n=sn(n,1),J(t)}));function Fn(t){return t?t[0]:i}function Bn(t){var n=Vt(t);return n.l=!0,n}function zn(t,n){return function(t,n,e,i){var r;return e(t,(function(t,e,o){if(n(t,e,o))return r=i?e:t,!1})),r}(t,hn(n),un)}function Gn(t,n){return un(t,tn(n))}function jn(t,n,e){return it(t,hn(n),e,arguments.length<3,un)}function qn(t,n){var e;if("function"!=typeof n)throw new TypeError(r);return t=de(t),function(){return--t>0&&(e=n.apply(this,arguments)),t<=1&&(n=i),e}}var Hn=Wn((function(t,n,e){return Cn(t,33,n,e)})),Yn=Wn((function(t,n){return rn(t,1,n)})),$n=Wn((function(t,n,e){return rn(t,ve(n)||0,e)}));var Kn=Wn((function(t,n){return Cn(t,32,i,n)}));function Wn(t,n){if("function"!=typeof t)throw new TypeError(r);return n=Rt(n===i?t.length-1:de(n),0),function(){for(var e=arguments,i=-1,r=Rt(e.length-n,0),o=Array(r);++i<r;)o[i]=e[n+i];var a=Array(n+1);for(i=-1;++i<n;)a[i]=e[i];return a[n]=o,t.apply(this,a)}}function Xn(t,n){return t===n||t!=t&&n!=n}function Jn(t,n){return t>n}function Qn(t){return ne(t)&&lt.call(t,"callee")&&(!At.call(t,"callee")||ht.call(t)==u)}var Zn=Array.isArray;function te(t){return null!=t&&oe(Dn(t))&&!re(t)}function ne(t){return ue(t)&&te(t)}var ee,ie=(ee=!1,function(){return ee});function re(t){var n=ae(t)?ht.call(t):"";return n==d||n==v}function oe(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=a}function ae(t){var n=typeof t;return!!t&&("object"==n||"function"==n)}function ue(t){return!!t&&"object"==typeof t}function ce(t){return"number"==typeof t||ue(t)&&ht.call(t)==p}function se(t){return"string"==typeof t||!Zn(t)&&ue(t)&&ht.call(t)==w}function fe(t){return ue(t)&&oe(t.length)&&!!U[ht.call(t)]}function le(t,n){return t<n}var de=Number,ve=Number;function he(t){return"string"==typeof t?t:null==t?"":t+""}var pe=Nn((function(t,n){Sn(n,we(n),t)})),ge=Nn((function(t,n){Sn(n,ye(n),t)})),me=Nn((function(t,n,e,i){kn(n,ye(n),t,i)}));var _e=Wn((function(t){return t.push(i,Jt),me.apply(i,t)}));function we(t){var n=Un(t);if(!n&&!te(t))return function(t){return kt(Object(t))}(t);var e=Pn(t),i=!!e,r=e||[],o=r.length;for(var a in t)!lt.call(t,a)||i&&("length"==a||ut(a,o))||n&&"constructor"==a||r.push(a);return r}function ye(t){for(var n=-1,e=Un(t),i=pn(t),r=i.length,o=Pn(t),a=!!o,u=o||[],c=u.length;++n<r;){var s=i[n];a&&("length"==s||ut(s,c))||"constructor"==s&&(e||!lt.call(t,s))||u.push(s)}return u}var be=Nn((function(t,n,e){_n(t,n,e)})),Ee=Wn((function(t,n){return null==t?{}:(n=gn(sn(n,1),String),wn(t,function(t,n,e,i){var r,o=-1,a=Q,u=!0,c=t.length,s=[],f=n.length;if(!c)return s;e&&(n=gn(n,(r=e,function(t){return r(t)}))),i?(a=Z,u=!1):n.length>=200&&(a=qt,u=!1,n=new jt(n));t:for(;++o<c;){var l=t[o],d=e?e(l):l;if(u&&d==d){for(var v=f;v--;)if(n[v]===d)continue t;s.push(l)}else a(n,d,i)||s.push(l)}return s}(ye(t),n)))}));var Ie=Wn((function(t,n){return null==t?{}:wn(t,sn(n,1))}));function Ae(t){return t?function(t,n){return gn(n,(function(n){return t[n]}))}(t,we(t)):[]}function Te(t){return t}var Se,ke=hn;function Re(t,n,e){var i=we(n),r=dn(n,i);null!=e||ae(n)&&(r.length||!i.length)||(e=n,n=t,t=this,r=dn(n,we(n)));var o=!ae(e)||!("chain"in e)||e.chain,a=re(t);return un(r,(function(e){var i=n[e];t[e]=i,a&&(t.prototype[e]=function(){var n=this.l;if(o||n){var e=t(this.u),r=e.I=In(this.I);return r.push({func:i,args:arguments,thisArg:t}),e.l=n,e}return i.apply(t,tt([this.value()],arguments))})})),t}Ft.prototype=en(Vt.prototype),Ft.prototype.constructor=Ft,Bt.prototype=Ot?Ot(null):st,Gt.prototype.clear=function(){this.T={hash:new Bt,map:Nt?new Nt:[],string:new Bt}},Gt.prototype["delete"]=function(t){var n=this.T;return Ln(t)?function(t,n){return zt(t,n)&&delete t[n]}("string"==typeof t?n.string:n.hash,t):Nt?n.map["delete"](t):Yt(n.map,t)},Gt.prototype.get=function(t){var n=this.T;return Ln(t)?function(t,n){if(Ot){var e=t[n];return e===o?i:e}return lt.call(t,n)?t[n]:i}("string"==typeof t?n.string:n.hash,t):Nt?n.map.get(t):$t(n.map,t)},Gt.prototype.has=function(t){var n=this.T;return Ln(t)?zt("string"==typeof t?n.string:n.hash,t):Nt?n.map.has(t):Kt(n.map,t)},Gt.prototype.set=function(t,n){var e=this.T;return Ln(t)?function(t,n,e){t[n]=Ot&&e===i?o:e}("string"==typeof t?e.string:e.hash,t,n):Nt?e.map.set(t,n):Xt(e.map,t,n),this},jt.prototype.push=function(t){var n=this.T;if(Ln(t)){var e=n.T;("string"==typeof t?e.string:e.hash)[t]=o}else n.set(t,o)},Ht.prototype.clear=function(){this.T={array:[],map:null}},Ht.prototype["delete"]=function(t){var n=this.T,e=n.array;return e?Yt(e,t):n.map["delete"](t)},Ht.prototype.get=function(t){var n=this.T,e=n.array;return e?$t(e,t):n.map.get(t)},Ht.prototype.has=function(t){var n=this.T,e=n.array;return e?Kt(e,t):n.map.has(t)},Ht.prototype.set=function(t,n){var e=this.T,i=e.array;i&&(i.length<199?Xt(i,t,n):(e.array=null,e.map=new Gt(i)));var r=e.map;return r&&r.set(t,n),this},Vt.assign=pe,Vt.assignIn=ge,Vt.before=qn,Vt.bind=Hn,Vt.chain=Bn,Vt.compact=function(t){return cn(t,Boolean)},Vt.concat=Vn,Vt.create=function(t,n){var e=en(t);return n?pe(e,n):e},Vt.defaults=_e,Vt.defer=Yn,Vt.delay=$n,Vt.filter=function(t,n){return cn(t,hn(n))},Vt.flatten=function(t){return(t?t.length:0)?sn(t,1):[]},Vt.flattenDeep=function(t){return(t?t.length:0)?sn(t,Infinity):[]},Vt.iteratee=ke,Vt.keys=we,Vt.map=function(t,n){return gn(t,hn(n))},Vt.mapValues=function(t,n){var e={};return n=hn(n),ln(t,(function(t,i,r){e[i]=n(t,i,r)})),e},Vt.matches=function(t){return mn(pe({},t))},Vt.merge=be,Vt.mixin=Re,Vt.negate=function(t){if("function"!=typeof t)throw new TypeError(r);return function(){return!t.apply(this,arguments)}},Vt.omit=Ee,Vt.omitBy=function(t,n){return n=hn(n),yn(t,(function(t,e){return!n(t,e)}))},Vt.once=function(t){return qn(2,t)},Vt.partial=Kn,Vt.pick=Ie,Vt.pickBy=function(t,n){return null==t?{}:yn(t,hn(n))},Vt.slice=function(t,n,e){var r=t?t.length:0;return n=null==n?0:+n,e=e===i?r:+e,r?En(t,n,e):[]},Vt.sortBy=function(t,n){var e=0;return n=hn(n),gn(gn(t,(function(t,i,r){return{value:t,index:e++,criteria:n(t,i,r)}})).sort((function(t,n){return function(t,n){if(t!==n){var e=null===t,r=t===i,o=t==t,a=null===n,u=n===i,c=n==n;if(t>n&&!a||!o||e&&!u&&c||r&&c)return 1;if(t<n&&!e||!c||a&&!r&&o||u&&o)return-1}return 0}(t.criteria,n.criteria)||t.index-n.index})),bn("value"))},Vt.tap=function(t,n){return n(t),t},Vt.thru=function(t,n){return n(t)},Vt.toArray=function(t){return te(t)?t.length?In(t):[]:Ae(t)},Vt.values=Ae,Vt.extend=ge,Re(Vt,Vt),Vt.clone=function(t){return ae(t)?Zn(t)?In(t):Sn(t,we(t)):t},Vt.cloneDeep=function(t){return nn(t,!0,!0)},Vt.escape=function(t){return(t=he(t))&&x.test(t)?t.replace(O,ot):t},Vt.every=function(t,n,e){return function(t,n){var e=!0;return un(t,(function(t,i,r){return e=!!n(t,i,r)})),e}(t,hn(n=e?i:n))},Vt.find=zn,Vt.findIndex=function(t,n){return t&&t.length?function(t,n,e){for(var i=t.length,r=e?i:-1;e?r--:++r<i;)if(n(t[r],r,t))return r;return-1}(t,hn(n)):-1},Vt.forEach=Gn,Vt.forOwn=function(t,n){return t&&ln(t,tn(n))},Vt.has=function(t,n){return null!=t&&lt.call(t,n)},Vt.head=Fn,Vt.identity=Te,Vt.includes=function(t,n,e,i){t=te(t)?t:Ae(t),e=e&&!i?de(e):0;var r=t.length;return e<0&&(e=Rt(r+e,0)),se(t)?e<=r&&t.indexOf(n,e)>-1:!!r&&et(t,n,e)>-1},Vt.indexOf=function(t,n,e){for(var i=t?t.length:0,r=((e="number"==typeof e?e<0?Rt(i+e,0):e:0)||0)-1,o=n==n;++r<i;){var a=t[r];if(o?a===n:a!=a)return r}return-1},Vt.isArguments=Qn,Vt.isArray=Zn,Vt.isBoolean=function(t){return!0===t||!1===t||ue(t)&&ht.call(t)==s},Vt.isDate=function(t){return ue(t)&&ht.call(t)==f},Vt.isEmpty=function(t){if(te(t)&&(Zn(t)||se(t)||re(t.splice)||Qn(t)))return!t.length;for(var n in t)if(lt.call(t,n))return!1;return!0},Vt.isEqual=function(t,n){return vn(t,n)},Vt.isFinite=function(t){return"number"==typeof t&&St(t)},Vt.isFunction=re,Vt.isNaN=function(t){return ce(t)&&t!=+t},Vt.isNull=function(t){return null===t},Vt.isNumber=ce,Vt.isObject=ae,Vt.isRegExp=function(t){return ae(t)&&ht.call(t)==m},Vt.isString=se,Vt.isUndefined=function(t){return t===i},Vt.last=function(t){var n=t?t.length:0;return n?t[n-1]:i},Vt.max=function(t){return t&&t.length?nt(t,Te,Jn):i},Vt.min=function(t){return t&&t.length?nt(t,Te,le):i},Vt.noConflict=function(){return K._===this&&(K._=pt),this},Vt.noop=function(){},Vt.reduce=jn,Vt.result=function(t,n,e){var r=null==t?i:t[n];return r===i&&(r=e),re(r)?r.call(t):r},Vt.size=function(t){return null==t?0:(t=te(t)?t:we(t)).length},Vt.some=function(t,n,e){return An(t,hn(n=e?i:n))},Vt.uniqueId=function(t){var n=++dt;return he(t)+n},Vt.each=Gn,Vt.first=Fn,Re(Vt,(Se={},ln(Vt,(function(t,n){lt.call(Vt.prototype,n)||(Se[n]=t)})),Se),{chain:!1}),Vt.VERSION="4.6.1",un(["pop","join","replace","reverse","split","push","shift","sort","splice","unshift"],(function(t){var n=(/^(?:replace|split)$/.test(t)?String.prototype:ct)[t],e=/^(?:push|sort|unshift)$/.test(t)?"tap":"thru",i=/^(?:pop|join|replace|shift)$/.test(t);Vt.prototype[t]=function(){var t=arguments;return i&&!this.l?n.apply(this.value(),t):this[e]((function(e){return n.apply(e,t)}))}})),Vt.prototype.toJSON=Vt.prototype.valueOf=Vt.prototype.value=function(){return t=this.u,jn(this.I,(function(t,n){return n.func.apply(n.thisArg,tt([t],n.args))}),t);var t},(Y||H||{})._=Vt,z&&G&&(j&&((G.exports=Vt)._=Vt),z._=Vt)}.call(this)},4816:function(t,n,e){t.exports=e(1812)._.noConflict()},984:function(t,n,e){var i=e(5876).v3,r=Math.pow(2,32),o=function(t,n){return(i(t,n)>>>0)/r};t.exports={Seed:{IGNORING:0,BUCKETING:1,FALLBACK:2,HOLDBACK:3,BEHAVIOR_EVENT:2716770798},hashToHex:function(t,n){var e=i(t,n);return(e>>>16).toString(16)+(65535&e).toString(16)},hashToInt:function(t,n,e){return Math.floor(o(t,n)*e)},hashToReal:o,toByteString:function(t){var n=String.fromCharCode;return t.replace(/[\S\s]/gi,(function(t){t=t.charCodeAt(0);var e=n(255&t);return t>255&&(e=n(t>>>8&255)+e),t>65535&&(e=n(t>>>16)+e),e}))}}},7276:function(t,n){n.generate=function e(t){return t?(t^16*Math.random()>>t/4).toString(16):([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,e)}},8136:function(t,n,e){var i=e(4816),r=e(9932).get("stores/audience_data"),o=e(8120),a=e(4141),u=e(967),c=e(5893);function s(t){var n=["type","selector","attributes","value"],e=i.extend({},t);return e.changeSet=i.map(t.changeSet,(function(t){return i.pick(c.dereferenceChangeId(t),n)})),e}n.emitLayerDecided=function(t){var n=t.decisionTicket?t.decisionTicket.audienceIds:[],e=i.map(n,(function(t){return{id:t,name:r.get(t).name}})),u={type:a.TYPES.LIFECYCLE,name:"layerDecided",data:i.extend(t,{audiences:e})},s=c.translateLayerEventToCampaignEvent(u);o.emit(u),o.emit(s)},n.emitViewActivated=function(t){var n={type:a.TYPES.LIFECYCLE,name:"viewActivated",data:t},e=c.translateViewActivatedToPageActivated(n);o.emit(n),o.emit(e)},n.emitViewsActivated=function(t){var n={type:a.TYPES.LIFECYCLE,name:"viewsActivated",data:t};o.emit(n)},n.emitPageDeactivated=function(t){var n={type:a.TYPES.LIFECYCLE,name:"pageDeactivated",data:t};o.emit(n)},n.emitActivateEvent=function(){o.emit({type:a.TYPES.LIFECYCLE,name:"activate"},!0)},n.emitActivatedEvent=function(){o.emit({type:a.TYPES.LIFECYCLE,name:"activated"})},n.emitInitializedEvent=function(){var t={type:a.TYPES.LIFECYCLE,name:"initialized"};window.optimizely&&(window.optimizely.initialized=!0),o.emit(t)},n.emitOriginsSyncedEvent=function(){var t={type:a.TYPES.LIFECYCLE,name:"originsSynced"};o.emit(t)},n.emitActionAppliedEvent=function(t){var n={type:t.type,campaignId:t.layerId,pageId:t.pageId,experimentId:t.experimentId,variationId:t.variationId};u.defineProperty(n,"changes",(function(){return s(t).changeSet}),"actionAppliedEvent");var e={type:a.TYPES.ACTION,name:"applied",data:n};o.emit(e)},n.emitActionsForDecisionAppliedEvent=function(t,n){var e={decision:t};u.defineProperty(e,"actions",(function(){return i.map(n,s)}),"appliedAllForDecisionEvent");var r={type:a.TYPES.ACTION,name:"appliedAllForDecision",data:e};o.emit(r)},n.emitSendEvents=function(){var t={type:a.TYPES.ANALYTICS,name:"sendEvents"};o.emit(t)},n.emitHoldEvents=function(){var t={type:a.TYPES.ANALYTICS,name:"holdEvents"};o.emit(t)}},953:function(t,n,e){var i=e(4816),r=e(8668),o=e(967),a=e(5893),u=e(3008),c=e(7179);function s(t,n,e,r){var o=t.getLayerState(r),a=n.get(r),c=e.get();if(!o||!a)return c?{layer:{name:c.layerName,id:c.layerId,policy:c.layerPolicy,integrationStringVersion:c.integrationStringVersion},experiment:{name:c.experimentName,id:c.experimentId},variation:{name:c.variationName,id:c.variationId},isLayerHoldback:!1}:null;if(u.isSingleExperimentPolicy(a.policy)&&o.decision.isLayerHoldback)return null;var s,f,l=o.decision.experimentId,d=o.decision.variationId;return l&&d&&(s=i.find(a.experiments,{id:l}))&&(f=i.find(s.variations,{id:d}))?{layer:{name:a.name,id:a.id,policy:a.policy,integrationStringVersion:a.integrationStringVersion},experiment:{name:s.name,id:s.id},variation:{name:f.name,id:f.id},isLayerHoldback:o.decision.isLayerHoldback}:null}function f(t,n,e,r,o,a,s){var f=[],l=t.getLayerStates();s.onlySingleExperiments&&(l=i.filter(l,(function(t){var e=n.get(t.layerId);return e&&u.isSingleExperimentPolicy(e.policy)})));var d=e.getActiveViewIds(),v=i.map(l,(function(t){var e,r=!!t.decision.variationId,a=t.decisionActivationId&&t.decisionActivationId===o.getActivationId(),u=c.getExperimentAndVariation(),s=u?u.variationId:null,f=r&&t.decision.variationId===s,l=(null==(e=n.get(null==t?void 0:t.layerId))?void 0:e.viewIds)||[],v=i.every(l,(function(t){return!i.includes(d,t)}));return i.extend(t,{isActive:r&&a&&!v||f,visitorRedirected:f})})),h=a?i.filter(v,a):v;return i.each(h,(function(t){var e=function(t,n,e,r){var o,a,u=t.layerId,c=n.get(u)||{},s=i.map(c.experiments,(function(t){return i.pick(t,["id","name"])}));if(!r&&c.decisionMetadata&&c.decisionMetadata.offerConsistency)return;var f={id:u,campaignName:c.name||null,experiment:null,allExperiments:s,variation:null,reason:t.decision.reason,isActive:!!t.isActive,visitorRedirected:t.visitorRedirected,isInCampaignHoldback:t.decision.isLayerHoldback};t.decision&&t.decision.experimentId&&(o=i.find(c.experiments,{id:t.decision.experimentId})),o&&(f.experiment=i.pick(o,["id","name","campaignName"])),o&&t.decision.variationId&&(a=i.find(o.variations,{id:t.decision.variationId})),a&&(f.variation=i.pick(a,["id","name"]));var l=i.map(t.decisionTicket.audienceIds,(function(t){return i.pick(e.get(t),["id","name"])}));return f.audiences=l,c.decisionMetadata&&c.decisionMetadata.offerConsistency&&(f.pageId=t.pageId),f}(t,n,r,s.includeOfferConsistency);e&&f.push(e)})),f}n.data=["stores/audience_data","stores/client_metadata","stores/event_data","stores/layer_data","stores/view_data","stores/group_data","stores/interest_group","stores/tag_group","stores/global",function(t,n,e,r,u,c,s,f,l){var d={},v={},h={},p={audiences:t.getAudiencesMap(),events:e.getEventsMap(),campaigns:d,pages:u.getPagesMap(),experiments:v,variations:h,projectId:l.getProjectId(),snippetId:l.getSnippetId(),accountId:l.getAccountId(),dcpServiceId:l.getDCPServiceId(),revision:l.getRevision(),clientName:n.getClientName(),clientVersion:n.getClientVersion()},g=a.dereferenceChangeId;return i.each(r.getAll(),(function(t){o.defineProperty(d,t.id,(function(){var n=i.extend({},t);return o.defineProperty(n,"changes",(function(){return i.map(t.changes,g)}),"campaign"),o.defineProperty(n,"experiments",(function(){return i.map(t.experiments,(function(t){return v[t.id]}))}),"campaign"),n}),"campaignMap","byId"),i.each(t.experiments,(function(t){o.defineProperty(v,t.id,(function(){var n=i.extend({},t);return o.defineProperty(n,"changes",(function(){return i.map(t.changes,g)}),"experiment"),o.defineProperty(n,"variations",(function(){return i.map(t.variations,(function(t){return h[t.id]}))}),"experiment"),n}),"experimentMap","byId"),i.each(t.variations,(function(t){o.defineProperty(h,t.id,(function(){var n=i.extend({},t);return o.defineProperty(n,"actions",(function(){return i.map(t.actions,(function(t){return i.extend({},t,{changes:i.map(t.changes,g)})}))}),"variation"),n}),"variationMap","byId")}))}))})),p.groups=c.getGroupsMap(),p}],n.visitor=["stores/visitor",function(t){return i.cloneDeep(t.getVisitorProfile())}],n.visitor_id=["stores/visitor_id",function(t){return{randomId:t.getRandomId()}}],n.state=["stores/audience_data","stores/layer_data","stores/layer","stores/view_data","stores/view","stores/global","stores/observed_redirect",function(t,n,e,o,a,l,d){return{getCampaignStates:function(r){var o={},u=f(e,n,a,t,l,r,{includeOfferConsistency:!1});return i.each(u,(function(t){o[t.id]=t})),o},getExperimentStates:function(r){var o=f(e,n,a,t,l,r,{includeOfferConsistency:!1,onlySingleExperiments:!0}),u=["audiences","variation","reason","visitorRedirected","isActive"];return i.reduce(o,(function(t,n){var e=n.allExperiments[0];return t[e.id]=i.extend({},i.pick(n,u),{id:e.id,experimentName:e.name,isInExperimentHoldback:n.isInCampaignHoldback}),t}),{})},getCampaignStateLists:function(r){var o={},u=f(e,n,a,t,l,r,{includeOfferConsistency:!0});return i.each(u,(function(t){var n=t.id;o[n]||(o[n]=[]),o[n].push(t)})),o},getPageStates:function(t){var n=a.getAll(),e=i.reduce(n,(function(t,n){var e=o.get(n.id);return t[n.id]=i.extend({},i.pick(e,["id","name","apiName","category","staticConditions","tags"]),i.pick(n,["isActive","metadata"])),t[n.id].isActive=!!t[n.id].isActive,t}),{});return t?i.pickBy(e,t):e},isGlobalHoldback:function(){return l.isGlobalHoldback()},getActivationId:function(){return l.getActivationId()},getVariationMap:function(){var t=e.getLayerStates(),r={};return i.each(t,(function(t){var e=n.get(t.layerId);if(t.decision&&t.decision.experimentId&&(r[t.decision.experimentId]={id:t.decision.variationId,name:null,index:null},e)){var o=i.find(e.experiments,{id:t.decision.experimentId});if(o&&t.decision.variationId)var a=i.find(o.variations,{id:t.decision.variationId}),u=i.findIndex(o.variations,{id:t.decision.variationId});a&&(r[t.decision.experimentId]={id:t.decision.variationId,name:a.name,index:u})}})),r},getActiveExperimentIds:function(){var t={};return i.each(this.getCampaignStateLists({isActive:!0}),(function(n){i.each(n,(function(n){t[n.experiment.id]=!0}))})),i.keys(t)},getRedirectInfo:function(){var t=c.getExperimentAndVariation();return t&&(t.referrer=c.getReferrer()),t},getDecisionString:function(t){if(!t)throw new Error("Must pass a config to getDecisionString");t=i.extend({maxLength:255,shouldCleanString:!1},t);var o=s(e,n,d,t.campaignId);return o?r.generateAnalyticsString(o.layer,o.experiment,o.variation,o.isLayerHoldback,t.maxLength,t.shouldCleanString):null},getDecisionObject:function(t){if(!t)throw new Error("Must pass a config to getDecisionObject");t=i.extend({maxLength:255,shouldCleanString:!1},t);var o=s(e,n,d,t.campaignId);if(!o)return null;var a=r.formatNamesAndIdsForAnalytics(o.layer,o.experiment,o.variation,t.shouldCleanString),c=i.mapValues(a.names,(function(n,e){return r.combineAndTruncateIdAndName(n,a.idStrings[e],t.maxLength)})),f={experiment:c.experiment,variation:c.variation};return u.isSingleExperimentPolicy(o.layer.policy)||i.extend(f,{campaign:c.layer,holdback:o.isLayerHoldback}),f}}}],n.utils=e(7044).create(),n.jquery=["env/jquery",function(t){return t}],n.event_emitter=e(6732)},3139:function(t,n,e){var i=e(7936),r=e(5343),o="optimizelyDataApi";n.registerFunction=function(t,n){var e=r.getGlobal(o);e||(e={},r.setGlobal(o,e)),e[t]||(e[t]=n)},n.unregisterFunction=function(t){var n=r.getGlobal(o);n&&n[t]&&(n[t]=function(){i.log('Ignoring attempt to call "'+o+"."+t+'" which has been unregistered.')})},n.getFunction=function(t){return r.getGlobal(o)[t]}},5622:function(t,n,e){var i=e(4816),r=e(7936),o=e(953),a=e(9932),u=a.get("stores/plugins"),c=e(9590),s=e(8738),f=e(349),l=[e(9495),e(1525),e(4689)],d=["clientMetadata","cookieDomain","disable","load","optOut","rum"];n.push=function(t,n){var e,o,a,u;if(!i.isArray(t)&&i.isObject(t))u=i.isUndefined(t.version)?1:t.version,e=t.type,a=[t];else if(i.isArray(t))u=0,e=t[0],a=t.slice(1);else{if(!i.isString(t))return r.warn("API / Ignoring non-array/object/string argument:",t),!1;u=0,e=t,a=[]}if(l[u]&&(o=l[u][e]),n&&-1===d.indexOf(e))return r.debug("API / Ignoring non high priority function:",e,a),!1;if(!o)return r.warn('API / No function found for "'+e+'" (v'+u+") with arguments:",a),!1;r.log('API / Executing: "'+e,'" with arguments:',a);try{o.apply(null,a),f.dispatch(c.RECORD_API_USAGE,{methodName:u?"v"+u+"."+e:e})}catch(s){r.error(s)}return!0},n.get=function(t){r.log('API / Getting module: "'+t+'"');var n=o[t];if(n?i.isArray(n)&&(n=a.evaluate(n)):n=u.getPlugin(s.PluginTypes.apiModules,t),n)return f.dispatch(c.RECORD_API_USAGE,{methodName:"get."+t}),n;r.warn('Module "'+t+'" not found.')}},967:function(t,n,e){var i=e(1335),r=e(9590),o=e(349),a=e(7936);n.defineProperty=function(t,n,e,u,c){i(t,n,(function(){var t=["prop",u,c||n].join(".");return a.debug('Evaluating getter: "'+t+'"'),o.dispatch(r.RECORD_API_USAGE,{methodName:t}),e()}),!0)}},9495:function(t,n,e){var i=e(4816),r=e(1525);function o(t){var n,e={};if(t)if(a(t))n=Number(t);else{if("object"!=typeof t)throw new Error("tracker: Revenue argument "+t+"not a number.");if("revenue"in(e=i.extend({},t))){if(!a(e.revenue))throw new Error("tracker: Revenue value "+e.revenue+"not a number.");n=Number(e.revenue),delete e.revenue}}return i.isUndefined(n)||(e.revenue=n),e}function a(t){return i.isNumber(t)||i.isString(t)&&Number(t)==t}n.activateGeoDelayedExperiments=function(t,n){n||(n=t.lists?"odds":"cdn3"),r.dataFromSource({data:t,source:n})},n.activateSiteCatalyst=function(t){t&&t.sVariable&&r.integrationSettings({id:"adobe_analytics",settings:{sVariableReference:t.sVariable}})},n.bucketVisitor=function(t,n){if(t&&n){var e={experimentId:String(t)};n>256?e.variationId=String(n):e.variationIndex=String(n),r.bucketVisitor(e)}},n.bucketUser=n.bucketVisitor,n.disable=function(t){r.disable({scope:t})},n.log=function(t){i.isUndefined(t)&&(t=!0),r.log({level:t?"INFO":"OFF"})},n.optOut=function(t){i.isUndefined(t)&&(t=!0),r.optOut({isOptOut:t})},n.setCookieDomain=function(t){r.cookieDomain({cookieDomain:t})},n.setCookieExpiration=function(t){r.cookieExpiration({cookieExpirationDays:t})},n.setDimensionValue=function(t,n){var e={};e[t]=n,r.user({attributes:e})},n.setUserId=function(t){r.user({userId:t})},n.setGA4UserId=function(t){r.ga4User({ga4UserId:t})},n.storeThirdPartyData=function(t,n){r.dataFromSource({source:t,data:n})},n.trackEvent=function(t,n){r.event({eventName:t,tags:o(n)})}},5893:function(t,n,e){var i=e(4816),r=e(9932),o=e(6836),a=e(967),u=r.get("stores/change_data");n.translateDecisionToCampaignDecision=function(t){return c(i.cloneDeep(t),{layerId:"campaignId",isLayerHoldback:"isCampaignHoldback"})},n.translateLayerEventToCampaignEvent=function(t){var e={};return a.defineProperty(e,"campaign",(function(){return function(t){var e=i.cloneDeep(t);return e.changes&&(e.changes=i.map(e.changes,n.dereferenceChangeId)),e.experiments&&i.each(e.experiments,(function(t){t.changes&&(t.changes=i.map(t.changes,n.dereferenceChangeId)),t.variations&&i.each(t.variations,(function(t){t.actions&&i.each(t.actions,(function(t){t.changes&&(t.changes=i.map(t.changes,n.dereferenceChangeId))}))}))})),e}(t.data.layer)}),"campaignEvent"),e.decisionTicket=t.data.decisionTicket,e.decision=this.translateDecisionToCampaignDecision(t.data.decision),e.audiences=t.data.audiences,{type:"lifecycle",name:"campaignDecided",data:e}},n.translateViewActivatedToPageActivated=function(t){return{type:"lifecycle",name:"pageActivated",data:{page:t.data.view}}},n.dereferenceChangeId=function(t){var n=u.getChange(t);return n?o.safeReference(n):t};var c=function(t,n){var e=i.omit(t,i.keys(n));return i.each(n,(function(n,i){e[n]=t[i]})),e}},7044:function(t,n,e){var i=e(212).Promise,r=e(6932).t,o=e(7940).poll,a=e(2763).b,u=e(4516).A;n.create=function(){return{observeSelector:r,poll:o,Promise:i,waitForElement:a,waitUntil:u}}},9901:function(t){t.exports={DEFAULT_INTERVAL:20}},6932:function(t,n,e){var i=e(4816),r=(e(9590),e(9932)),o=r.get("stores/directive"),a=e(8416),u=(e(6556),e(8738),e(349),e(7276).generate),c=e(7940),s=e(5343),f=(r.get("stores/rum"),{once:!1,onTimeout:null,timeout:null}),l={},d=function(t){d=function(){if(!o.shouldObserveChangesIndefinitely())return function(t){var n=c.poll(i.partial(h,t));l[t].cancelObservation=function(){n(),delete l[t]}};var t,n=function(){this.disconnect(),i.each(i.keys(l),h),this.observe(r,e)},e={attributes:!0,childList:!0,subtree:!0,characterData:!0},r=a.getDocumentElement();return t=new MutationObserver(n),function(n){var o=l[n];t.observe(r,e),o.cancelObservation=function(){delete l[n],i.isEmpty(l)&&t.disconnect()}}}(),d(t)};function v(t){var n=l[t];n&&n.cancelObservation&&n.cancelObservation()}function h(t){if(l[t]){if(function(t){var n=t.options.timeout;if(null!==n)if("function"==typeof n)try{return n()}catch(e){}else if(Date.now()-t.startTime>n)return!0;return!1}(l[t]))return 0===l[t].matchedCount&&i.isFunction(l[t].options.onTimeout)&&l[t].options.onTimeout(),void v(t);var n=a.querySelectorAll(l[t].selector);n.length&&(i.each(n,(function(n){n.S&&n.S[t]||l[t].callbackQueue.push(n)})),function(t){for(;l[t]&&l[t].callbackQueue.length;){var n=l[t].callbackQueue.shift();if(p(n,t),l[t].matchedCount=l[t].matchedCount+1,l[t].callback(n),l[t]&&l[t].options.once)return void v(t)}}(t))}}function p(t,n){t.S||(t.S={}),t.S[n]=!0}n.t=function(t,n,e){if(!function(t){try{a.querySelector(t)}catch(n){return!1}return!0}(t))throw new Error("observeSelector expects a valid css selector as its first argument");if(!i.isFunction(n))throw new Error("observeSelector expects a function as its second argument");if(e&&(!i.isObject(e)||i.isFunction(e)))throw new Error("observeSelector expects an object as its third argument");var r=u();return e=i.assign({},f,e||{}),l[r]={callback:n,callbackQueue:[],matchedCount:0,options:e,selector:t,startTime:Date.now()},d(r),s.setTimeout(i.bind(h,null,r),0),i.partial(v,r)}},7940:function(t,n,e){var i=e(4816),r=(e(9590),e(9932)),o=(e(8738),e(349),e(7276).generate),a=e(5343),u=e(9901).DEFAULT_INTERVAL,c=(r.get("stores/rum"),{});function s(t){c[t]&&i.each(c[t].callbacks,(function(t){t.call(null)}))}function f(t,n){c[n]&&c[n].callbacks[t]&&(delete c[n].callbacks[t],i.some(c[n].callbacks)||(clearInterval(c[n].id),delete c[n]))}n.poll=function(t,n){i.isNumber(n)||(n=u),c[n]||(c[n]={callbacks:{},id:a.setInterval(i.partial(s,n),n)});var e=o();return c[n].callbacks[e]=t,i.partial(f,e,n)},n.cancelAll=function(){i.each(c,(function(t,n){clearInterval(t.id),delete c[n]}))}},2763:function(t,n,e){var i=e(212).Promise,r=e(6932).t;n.b=function(t){return new i((function(n,e){r(t,n,{once:!0})}))}},4516:function(t,n,e){var i=e(212).Promise,r=e(7940).poll;n.A=function(t){return new i((function(n,e){if(t())n();else var i=r((function(){t()&&(i(),n())}))}))}},1525:function(t,n,e){var i=e(4816),r=e(9590),o=e(5622),a=e(953),u=e(4094),c=e(8738),s=e(5086),f=e(8136),l=e(9621),d=e(8064).U,v=e(8701),h=e(7357),p=(e(371),e(6611)),g=e(8120),m=e(349),_=e(9505),w=e(5508),y=e(7936),b=e(2121),E=(e(1659),e(4927)),I=e(1683),A=e(9932),T=A.get("stores/dimension_data"),S=A.get("stores/view"),k=A.get("stores/view_data"),R=A.get("stores/visitor_id"),N=A.get("stores/layer_data"),C=A.get("stores/directive"),D=n.ApiListenerError=d("ApiListenerError");n.event=function(t){var n;switch(t.eventType){case"click":n=function(t){var n;return t.eventData&&(n=p.create(t.eventData.id,t.eventData.apiName,"click",t.eventData)),function(){var t=s.trackClickEvent(n);t?y.log("API / Tracking click event:",t):y.log("API / Not tracking click event:",t)}}(t);break;case"decision":n=function(t){var n=t.eventData,e=w.createLayerState(n.layerId,n.experimentId,n.variationId,n.isLayerHoldback),i=w.createSingle(n.layerId,n.experimentId,n.variationId);return function(){w.recordLayerDecision(e.layerId,e.decisionTicket,e.decision),y.log("API / Tracking decision event:",e),s.trackDecisionEvent(e.decision,e.decisionTicket,i)}}(t);break;case"pageview":n=function(t){var n=E.create(t.eventData.id,t.eventData.apiName),e=E.createState(n.id);return function(){var t=s.trackViewActivation(n,e);t?y.log("API / Tracking pageview event:",t):y.log("API / Not tracking pageview event:",t)}}(t);break;default:n=function(t){var n;return t.eventId&&(n=p.create(t.eventId,t.eventName,"custom")),E.updateAllViewTags(),function(){s.trackCustomEvent(t.eventName,t.tags,n,t.properties)?y.log("API / Tracking custom event:",t.eventName,t.tags):y.log("API / Not tracking custom event:",t.eventName)}}(t)}R.getBucketingId()?n():m.dispatch(r.ADD_CLEANUP_FN,{lifecycle:c.Lifecycle.postActivate,cleanupFn:n})},n.clientMetadata=function(t){false},n.priorRedirectString=function(t){},n.microsnippetError=function(t){},n.rum=function(t){m.dispatch(r.SET_RUM_DATA,t.eventData)},n.initialViewStates=function(t){var n=i.map(t.states,(function(t,n){return{id:n,isActive:t}}));E.registerViews(n)},n.page=function(t){var n=k.getByApiName(t.pageName);if(!n)throw new Error('Unknown page "'+t.pageName+'"');var e=!t.hasOwnProperty("isActive")||t.isActive,i=function(){e?E.activateViaAPI(n,t.tags):(E.deactivate(n),y.log("API / Deactivated Page",E.description(n)))};R.getBucketingId()?i():m.dispatch(r.ADD_CLEANUP_FN,{lifecycle:c.Lifecycle.postViewsActivated,cleanupFn:i})},n.tags=function(t){E.setGlobalTags(t.tags)},n.user=function(t){y.log("API / Setting visitor custom attributes:",t.attributes),i.each(t.attributes,(function(t,n){var e,i,r=n,o=T.getById(n)||T.getByApiName(n);o&&(r=o.id,e=o.apiName,i=o.segmentId||o.id);var a={id:i,value:t};e&&(a.name=e),O(r,a,!0)}))},n.ga4User=function(t){t.ga4UserId?(y.log("API / Setting ga4 user id in the global store:",t.ga4UserId),m.dispatch(r.SET_GA4_USER_ID,t)):y.error('API / Argument "ga4UserId" is missing')};var O=function(t,n,e){var i=[{key:e?["custom",t]:[t],value:n,metadata:{lastModified:v.now()}}],o=function(){m.dispatch(r.SET_VISITOR_ATTRIBUTES,{attributes:i})};R.getBucketingId()?o():m.dispatch(r.ADD_CLEANUP_FN,{lifecycle:c.Lifecycle.postVisitorProfileLoad,cleanupFn:o})};n.optOut=function(t){var n=!t.hasOwnProperty("isOptOut")||t.isOptOut;h.setOptOut(n)},n.cookieExpiration=function(t){var n=t.cookieExpirationDays;n<90&&(y.error('Argument "cookieExpirationDays"=',n,"less than minimum days:",90,", setting to minimum."),n=90),y.log("API / Setting cookie age to",n,"days."),m.dispatch(r.SET_COOKIE_AGE,86400*n)},n.extendCookieLifetime=function(t){t=i.extend({isEnabled:!0},t),y.log("API / Setting cookie automatic lifetime extension to",t.isEnabled),m.dispatch(r.SET_COOKIE_AUTO_REFRESH,t.isEnabled)},n.cookieDomain=function(t){y.log("API / Setting cookie domain to",t.cookieDomain),m.dispatch(r.SET_COOKIE_DOMAIN,t.cookieDomain)},n.disable=function(t){if(t.scope){if("tracking"!==t.scope)throw new Error('Unknown "scope" for disable: '+t.scope);y.log("API / Disabling tracking"),m.dispatch(r.LOAD_DIRECTIVE,{trackingDisabled:!0})}else y.log("API / Disabling everything"),m.dispatch(r.LOAD_DIRECTIVE,{disabled:!0})},n.log=function(t){var n=t.level,e=t.match;i.isUndefined(n)&&(n="INFO"),i.isUndefined(e)&&(e=""),y.setLogMatcher(e),y.setLogLevel(n)},n.registerModule=function(t){var n="custom/"+t.moduleName;if(a[n]||o.get(n))throw new Error('Module name "'+n+'" is reserved. Will not be registered as plugin.');b.registerApiModule(n,t.module)},n.dataFromSource=function(t){var n=t.source;l.makeAsyncRequest(n),l.resolveRequest(n,t.data)},n.addListener=function(t){if(!i.isFunction(t.handler))throw new Error("A handler function must be supplied");(t=i.omit(t,"type")).publicOnly=!0,t.emitErrors=!0;var n=t.handler;t.handler=function(t){try{return n(t)}catch(e){throw new D(e)}},g.on(t)},n.removeListener=function(t){if(!t.token)throw new Error("Must supply a token to removeListener");g.off(t.token)},n.load=function(t){t.data=i.extend({},t.data),u.normalizeClientData(t.data),m.dispatch(r.DATA_LOADED,{data:t.data})},n.integrationSettings=function(t){if(!t.id)throw new Error("id is required");if(!t.settings)throw new Error("settings is required");m.dispatch(r.SET_INTEGRATION_SETTINGS,i.extend({},t.settings,{id:t.id}))},n.bucketVisitor=function(t){if(!t.variationId&&i.isUndefined(t.variationIndex)||t.variationId&&t.variationIndex)throw new Error("One of a variationId or a variationIndex is required.");if(!t.experimentId)throw new Error("An experimentId is required.");var n,e,r=t.campaignId;if(r){if(!(n=N.get(r)))throw new Error("Could not find layer "+r)}else if(!(r=(n=N.getLayerByExperimentId(t.experimentId)).id))throw new Error("Could not find layer for experiment "+t.experimentId);if(!(e=i.find(n.experiments,{id:t.experimentId})))throw new Error("Could not find experiment "+t.experimentId+" in layer "+r);var o=t.variationId;if(i.isUndefined(t.variationIndex)){if(!i.find(e.variations,{id:o}))throw new Error("Cound not find variation "+o+" in experiment "+t.experimentId)}else if(!(o=e.variations[t.variationIndex].id))throw new Error("Could not find variation at index "+t.variationIndex+" in experiment "+t.experimentId);I.updateVariationIdMap(r,t.experimentId,o),R.getBucketingId()&&I.persistVariationIdMap(),I.updateContextualMabMap(r,t.experimentId,{variationId:o}),R.getBucketingId()&&I.persistContextualMabMap()},n.waitForOriginSync=function(t){if(!i.isArray(t.canonicalOrigins))throw new Error("canonicalOrigins must be an array. Got: "+_.stringify(t.canonicalOrigins));i.each(t.canonicalOrigins,(function(t){if(!i.isString(t))throw new Error("Each item in canonicalOrigins must be a string. Found type "+(void 0===t?"undefined":(n=t)&&"undefined"!=typeof Symbol&&n.constructor===Symbol?"symbol":typeof n));var n})),m.dispatch(r.XDOMAIN_SET_CANONICAL_ORIGINS,{canonicalOrigins:t.canonicalOrigins})},n.disableCrossOrigin=function(){y.log("API / cross origin tracking is DISABLED"),m.dispatch(r.XDOMAIN_SET_DISABLED,{disabled:!0})},n.activate=function(){C.shouldActivate()?(i.forEach(S.getActiveViewStates(),(function(t){E.deactivate(k.get(t.id))})),m.dispatch(r.RESET_VIEW_STATES),f.emitActivateEvent()):y.debug("Not activating.")},n.sendEvents=function(){f.emitSendEvents()},n.holdEvents=function(){f.emitHoldEvents()}},4689:function(){},1327:function(t,n,e){var i=e(4816),r=e(8064).U,o=n.ActivationCodeError=r("ActivationCodeError"),a=n.ProjectJSError=r("ProjectJSError"),u=e(7234),c=e(9590),s=e(5086),f=e(8136),l=e(4036),d=e(4248),v=e(4094),h=e(8701),p=e(947),g=e(9932),m=e(7357),_=e(8416),w=e(8738),y=e(8120),b=e(4141),E=e(1284),I=e(349),A=e(1194),T=e(5508),S=e(871).mM,k=e(7936),R=e(3294),N=e(2899),C=e(2121),D=e(9801),O=e(212).Promise,x=e(2896),M=e(1659),P=e(3406),L=e(9612),U=e(4927),V=e(1683),F=e(5343),B=(g=e(9932)).get("stores/session"),z=g.get("stores/audience_data"),G=g.get("stores/action_data"),j=g.get("stores/cleanup"),q=g.get("stores/directive"),H=g.get("stores/global"),Y=g.get("stores/group_data"),$=g.get("stores/layer_data"),K=g.get("stores/layer"),W=g.get("stores/pending_events"),X=g.get("stores/plugins"),J=g.get("stores/rum"),Q=g.get("stores/visitor"),Z=g.get("stores/view_data"),tt=g.get("stores/view"),nt=g.get("stores/visitor_id"),et=g.get("stores/visitor_bucketing"),it=g.get("stores/xdomain"),rt=e(5622),ot=e(371),at=e(4892),ut=n;function ct(){var t=null;i.isNumber(t)&&0===$.getCount()?(k.log("Activating after delay of",t,"ms because no Experiments are running"),I.dispatch(c.SET_RUM_DATA,{data:{activateDfd:!0}}),F.setTimeout(f.emitActivateEvent,t)):f.emitActivateEvent()}function st(t){ot.handleError(t.data.error,t.data.metadata)}function ft(t,n){I.dispatch(c.SET_RUM_DATA,{data:{extras:{xdAttempt:t,xdError:n?n.toString():void 0}}})}function lt(t,n,e){t=t||[];var r=H.getGlobalHoldbackThreshold(),o=nt.getBucketingId();if(!o)throw new Error("bucketingId not set");var a,u=Q.getVisitorProfile();n&&(a=et.getVariationIdMap()[n.id]);var c={bucketingId:o,visitorProfile:u,audiences:t,globalHoldback:r,preferredVariationMap:a,layer:n};return n&&e&&p.isPageIdRelevant(n)?i.map(e,(function(t){return p.createTicket(i.extend({},c,{pageId:t}))})):[p.createTicket(c)]}function dt(t,e,r,o){try{var a=function(t){return{bucketingId:nt.getBucketingId(),preferredLayerId:et.getPreferredLayerMap()[t.id]}}(o),u=p.decideGroup(o,a);if(u.reason)return k.debug("Not activating Group",A.description(o),"; reason:",u.reason),J.getSampleRum()&&I.dispatch(c.RECORD_LAYER_FEATURE_USAGE,{feature:"mutex",entityId:o.id}),O.resolve();var s=$.get(u.layerId);if(!s)return k.debug("Visitor was bucketed into a Campaign ("+u.layerId+") which is not in this snippet"),O.resolve();var f=i.filter(s.pageIds,i.partial(i.includes,r));return i.isEmpty(f)?(k.debug("Not activating Group",A.description(o),"; reason: visitor was bucketed into a Campaign/Experiment not related to the currently-activating Page(s)"),O.resolve()):(J.getSampleRum()&&I.dispatch(c.RECORD_LAYER_FEATURE_USAGE,{feature:"mutex",entityId:o.id}),n.decideAndExecuteLayerASAP(t,e,f,s))}catch(l){return k.error("Error getting decision for Group",A.description(o),"; ",l),O.reject(l)}}function vt(t,n){var e={};return i.each(t,(function(t){i.isArray(t)?i.extend(e,vt(t,n)):i.isObject(t)&&n[t.type]&&(e[t.type]=!0)})),e}function ht(t){var n=[];return i.each(t,(function(t){n.push(t.name,t)})),n}function pt(t){var n=j.getCleanupFns(t);if(n.length>0){for(;n.length>0;)n.shift()();I.dispatch(c.CLEAR_CLEANUP_FN,{lifecycle:t})}}n.initialize=function(t){return this.initGlobalStore(t.clientData),this.initializePlugins(t.plugins)},n.initGlobalStore=function(t){v.normalizeClientData(t),y.on({filter:{type:"error"},handler:st}),I.dispatch(c.DATA_LOADED,{data:t}),k.log("Initialized with DATA:",t)},n.initializePlugins=function(t){if(i.isArray(window.optimizely)&&(window.optimizely=i.filter(window.optimizely,(function(t){var n=!0;return!rt.push(t,n)}))),m.setOptOut(q.shouldOptOut()),!q.isDisabled()&&!q.shouldOptOut()){at.queueBeacons(),_.isReady()?I.dispatch(c.SET_DOMCONTENTLOADED):_.addReadyHandler((function(){I.dispatch(c.SET_DOMCONTENTLOADED)})),N.time("projectJS");var e=H.getProjectJS();if(i.isFunction(e))try{E.apply(e)}catch(v){k.error("Error while executing projectJS: ",v),d.emitError(new a(v))}N.timeEnd("projectJS"),i.each(t||[],(function(t){try{t(C)}catch(v){d.emitInternalError(v)}})),i.each(H.getPlugins()||[],(function(t){try{E.apply(t,[C])}catch(v){d.emitError(v)}})),M.load();var r=y.on({filter:{type:"lifecycle",name:"activated"},handler:function(){Q.observe(V.persistVisitorProfile),K.observe(V.persistLayerStates),B.observe(V.persistSessionState),W.observe(R.persistPendingEvents),et.observe(V.persistVisitorBucketingStore),y.off(r)}});y.on({filter:{type:"lifecycle",name:"viewsActivated"},handler:n.onViewsActivated}),y.on({filter:{type:"lifecycle",name:"pageDeactivated"},handler:n.onPageDeactivated}),n.initializeApi();var o=R.getPendingEvents();if(o&&(I.dispatch(c.LOAD_PENDING_EVENTS,{events:o}),R.retryPendingEvents(o)),y.on({filter:{type:"lifecycle",name:"activate"},handler:n.activate}),f.emitInitializedEvent(),!q.shouldActivate())return O.resolve();var u=[];if(it.isDisabled())ct();else{var s=n.initializeXDomainStorage();if(u.push(s),Boolean(it.getCanonicalOrigins())){var l=P.makeTimeoutPromise(1e3);O.race([s,l])["catch"]((function(t){k.error("Failed to initialize xDomain storage: ",t)})).then(ct)["catch"](ot.handleError)}else ct()}return O.all(u)}k.log("Controller / Is disabled")},n.activate=function(){try{var t=[];k.log("Activated client"),pt(w.Lifecycle.preActivate);var n=h.now();I.dispatch(c.ACTIVATE,{activationId:String(n),activationTimestamp:n});var e=Z.getAll();U.registerViews(e),V.setId(V.getOrGenerateId()),t.push(s.trackPostRedirectDecisionEvent()),I.dispatch(c.MERGE_VARIATION_ID_MAP,{variationIdMap:V.getVariationIdMap()}),I.dispatch(c.MERGE_CONTEXTUAL_MAB_MAP,{contextualMabMap:V.getContextualMabMap()}),I.dispatch(c.MERGE_PREFERRED_LAYER_MAP,{preferredLayerMap:V.getPreferredLayerMap()}),pt(w.Lifecycle.postVisitorProfileLoad),t.push((v=X.getAllPlugins(w.PluginTypes.visitorProfileProviders),g=Q.getVisitorProfile(),V.populateEagerVisitorData(v,g)).then((function(){k.log("Populated visitor profile")})));var r=lt(),o=p.decideGlobal(r);k.log("Made global decision",r,"->",o),I.dispatch(c.RECORD_GLOBAL_DECISION,o);var a=s.trackClientActivation();a?k.log("Tracked activation event",a):k.log("Not tracking activation event");var u=ut.setUpViewActivation(e),l=[];return i.each(u,(function(t){l=l.concat(U.activateMultiple([t]))})),pt(w.Lifecycle.postViewsActivated),pt(w.Lifecycle.postActivate),f.emitActivatedEvent(),O.all(t).then((function(){y.emit({type:b.TYPES.LIFECYCLE,name:"activateDeferredDone"}),k.log("All immediate effects of activation resolved")}),d.emitError)}catch(m){return d.emitError(m),O.reject(m)}var v,g},ut.setUpViewActivation=function(t){var n=[];return i.each(t,(function(t){i.isBoolean(tt.getViewState(t.id).isActive)&&U.isActivationTypeImmediate(t.activationType)?k.debug("Skipping page: already evaluated, presumably at the edge",U.description(t)):U.shouldTriggerImmediately(t.activationType)?n.push(t):t.activationType===w.ViewActivationTypes.callback?(k.debug("Setting up conditional activation for Page",U.description(t)),ut.activateViewOnCallback(t)):t.activationType===w.ViewActivationTypes.polling?(k.debug("Setting up polling activation for Page",U.description(t)),D.pollFor(i.partial(E.apply,t.activationCode),null,i.partial(L.isTimedOut,h.now())).then((function(){U.activateMultiple([t])}))["catch"]((function(n){k.warn("Failed to activate view ",t,n)}))):t.activationType!==w.ViewActivationTypes.manual&&d.emitError(new Error("Unknown view activationType: "+t.activationType))})),n},ut.activateViewOnCallback=function(t){var n={pageId:t.id};Object.defineProperty(n,"isActive",{get:function(){return tt.isViewActive(t.id)}});try{E.apply(t.activationCode,[function(n){var e=i.extend({},n,{pageName:t.apiName,type:"page"});rt.push(e)},n])}catch(r){var e=new o("("+r.toString()+") in activationCode for "+U.description(t));d.emitError(e,{originalError:r,userError:!0})}},n.onViewsActivated=function(t){var e,r=t.data.views,o=i.map(r,"id");try{if(!nt.getBucketingId())throw new Error("View activated with no visitorId set");var a=function(t){var e=$.getAllByPageIds(t),r=q.getForceVariationIds(),o=q.getForceAudienceIds(),a=!i.isEmpty(r);a&&k.log("Force variations are in use. Disabling mutual exclusivity.");var u=a?{individual:e}:i.reduce(e,(function(t,n){return n.groupId?t.groups[n.groupId]||(t.groups[n.groupId]=Y.get(n.groupId)):t.individual.push(n),t}),{groups:{},individual:[]});k.log("Deciding Campaigns/Experiments for Page(s)",t);var c=i.map(u.groups,A.description).join(", ");k.log("Groups:",c);var s=i.map(u.individual,T.description).join(", ");k.log("Campaigns/Experiments not in Groups (by Campaign id):",s);var f=i.map(u.groups,i.partial(dt,r,o,t))||[],l=i.map(u.individual,(function(e){var a=i.filter(e.pageIds,i.partial(i.includes,t));return n.decideAndExecuteLayerASAP(r,o,a,e)})),d=f.concat(l);return O.all(d).then((function(n){var e=i.filter(n,(function(t){return!!t}));return k.log("All Campaigns/Experiments for Page(s) (by Campaign id)",t,"resolved:",i.map(e,T.description).join(", ")),e}))}(o)["catch"](d.emitError);return e=O.all(i.map(r,(function(t){var n=function(){U.parseViewTags(t);var n=s.trackViewActivation(t);n?k.log("Tracked activation for Page",U.description(t),n):k.log("Not Tracking activation for Page",U.description(t))};return _.isReady()?O.resolve(n()):D.pollFor(_.isReady,1e3).then(n)}))),O.all([a,e])}catch(u){d.emitError(u)}},n.onPageDeactivated=function(t){var n=t.data.page,e=G.getAllActionIdsByPageId(n.id);i.each(e,(function(t){var e=G.getActionState(t);e&&(i.each(e,(function(t,e){if(t.cancel)try{t.cancel(),k.debug("Controller / Canceled change",e,"observation due to deactivation of page:",n)}catch(i){k.error("Controller / Error canceling change",e,"observation upon deactivation of page.",i)}if(n.undoOnDeactivation&&t.undo)try{t.undo(),k.debug("Controller / Undid change",e,"due to deactivation of page:",n)}catch(r){k.error("Controller / Error undoing change upon deactivation of page.",r)}})),I.dispatch(c.REMOVE_ACTION_STATE,{actionId:t}),k.debug("Controller / Undid changes and/or canceled change observation due to deactivation of page:",n,t))}))},n.initializeApi=function(){var t={push:rt.push};t.get=rt.get;var n=window.optimizely;i.isArray(n)&&i.each(n,(function(n){t.push(n)})),t.data={note:"Obsolete, use optimizely.get('data') instead"},t.state={},window.optimizely=t},n.persistItemsWithId=function(t){return i.each(t,(function(t,n){V.checkKeyForVisitorId(n)&&S.setItem(n,t)})),t},n.initializeXDomainStorage=function(){var t=e(8340),r=!!V.getCurrentId(),o=!!r&&V.hasSomeData();r?o?k.log("xd / Existing visitor; has data on this origin"):k.log("xd / Existing visitor; new to this origin"):k.log("xd / New visitor");var a=H.getAccountId(),u="https://a752671897.cdn.optimizely.com".replace("__SUBDOMAIN__","a"+a+"."),s="/client_storage/a"+a+".html";t.subscribe((function(t,n){V.checkKeyForVisitorId(t)&&S.setItem(t,n)}));var l=t.fetchAll().then((function(n){if(!nt.getVisitorIdLocator()){var e=it.getCanonicalOrigins();if(e){var i=t.getXDomainUserId(n,e);i&&(k.log("Syncing cross-origin visitor randomId:",i),V.maybePersistVisitorId({randomId:i}))}}return V.deleteOldForeignData(),n})).then(n.persistItemsWithId).then((function(t){if(V.loadForeignData(),r&&!o){var n=!i.isEmpty(t);k.debug("xd / Loaded foreign data? ",n),ft(n)}k.log("Loaded visitor data from foreign origins"),f.emitOriginsSyncedEvent()}),(function(t){throw r&&!o&&(k.debug("xd / Failed to load foreign data:",t),ft(!1,t)),t}));return O.all([t.load(u,s)["catch"]((function(t){throw k.debug("xd / Failed to load iframe:",t),r&&!o&&ft(!1,t),t})),l["catch"]((function(t){k.debug("xd / Ignored error syncing foreign data (expected if waitForOriginSync used):",t.message),k.debug("xd / Enqueuing sync to happen after visitorId set."),I.dispatch(c.ADD_CLEANUP_FN,{lifecycle:w.Lifecycle.postVisitorProfileLoad,cleanupFn:f.emitOriginsSyncedEvent})}))])},n.decideAndExecuteLayerASAP=function(t,e,r,o){return new O((function(a,d){try{!function(t,n,e,r,o){if(n.length||e.length)return void o(lt([],void 0,r));var a=T.relatedAudienceIds(t),u=i.reduce(a,(function(t,n){var e=z.get(n);return!e||t.push(e),t}),[]),s=X.getAllPlugins(w.PluginTypes.audienceMatchers);if(J.getSampleRum()){var f={};if(i.each(u,(function(t){i.extend(f,vt(t.conditions,s))})),!i.isEmpty(f)){var d=i.keys(f);I.dispatch(c.RECORD_AUDIENCE_USAGE,{audienceTypes:d,layerId:t.id})}}var v=function(t){k.debug("Audience list for extracting types",t);try{var n=new Set(i(t).map("conditions").flattenDeep().filter((function(t){return"string"!=typeof t})).map("type").value());return n.has("time_and_day")&&n.add("currentTimestamp"),k.debug("Extracted unique types from audiences",n),n}catch(e){return k.error("An error occurred while extracting types from audiences:",e),new Set}}(u),h=X.getAllPlugins(w.PluginTypes.visitorProfileProviders),p=Q.getVisitorProfile();V.populateLazyVisitorData(h,p,v),function(t,n,e,r){var o=i.reduce(t,(function(t,e){return i.extend(t,l.requiredAudienceFieldsForConditions(e.conditions,n))}),{}),a=i.reduce(o,(function(t,n){if(i.isUndefined(V.getAttribute(n))){var e=V.getPendingAttributeValue(n);i.isUndefined(e)||t.push(e)}return t}),[]);if(0===a.length)return r();var u=[].concat(t),c=x.firstToResolve(i.map(a,(function(t){return O.resolve(t).then((function(){var t=Q.getVisitorProfile();if(u=i.filter(u,(function(e){return i.isUndefined(l.isInAudience(t,e,n))})),!i.isEmpty(u))throw new Error("At least one audience is still pending")}))})));O.race([c,new O((function(t,n){F.setTimeout(n,e)}))]).then((function(){k.log("Activating Campaign after pending Audiences resolved",t),r()}),(function(){k.log("Activating Campaign after timeout on Audiences",t),r()}))}(u,s,T.getActivationTimeout(t),(function(){var n=lt(u,t,r);i.map(n,(function(n){!function(t,n,e){var r=i.map(t.audienceIds,i.bind(z.get,z)),o=i.filter(n,(function(n){return!i.includes(t.audienceIds,n.id)}));k.log("When deciding Campaign",T.description(e),"visitor is in audiences:",ht(r),"and not in audiences:",ht(o))}(n,u,t)})),o(n)}))}(o,t,e,r,(function(l){i.each(l,(function(a){var l=a.pageId?[a.pageId]:r;k.debug("Deciding layer: ",o,"with decisionTicket: ",a,"and actionViewIds: ",l),function(t,e,r,o,a){var l=T.description(t);k.log("Activating Campaign",l,"on Page(s)",o),r.length&&(k.log("Applying force audienceIds:",r,"to Campaign",l),(a=i.cloneDeep(a)).audienceIds=r);var d=n.decideLayer(t,a,e),v=!(!e.length&&!r.length),h=n.getActionsForDecision(t,d,v),g=function(t,n){return i.filter(t,(function(t){return i.isUndefined(t.pageId)||i.includes(n,t.pageId)}))}(h.actions,o);if(h.maybeExecute&&function(t,n,e,r){var o=T.description(n);k.log("Preparing actions",t,"for Campaign",o,"on Page(s)",r),i.forEach(t,u.prepareAction)}(g,t,0,o),i.forEach(o,(function(){s.trackDecisionEvent(d,a)})),f.emitLayerDecided({layer:t,decisionTicket:a,decision:d}),d.error)throw d.error;if(J.getSampleRum()){I.dispatch(c.RECORD_LAYER_POLICY_USAGE,{policy:t.policy,layerId:t.id});var m=function(t){var n={};return i.each(t,(function(t){i.each(t.changeSet,(function(t){n[t.type]||(n[t.type]=!0)}))})),n}(h.actions);I.dispatch(c.RECORD_CHANGE_TYPE_USAGE,{changeTypes:i.keys(m),layerId:t.id}),i.isEmpty(t.integrationSettings)||I.dispatch(c.RECORD_INTEGRATION_USAGE,{integrations:T.getIntegrationTypes(t),layerId:t.id})}if(!p.isInCohort(d))return void k.log("Not activating Campaign: "+T.description(t)+"; not in the cohort because:",d.reason);h.maybeExecute&&function(t,n,e,r){var o=T.description(n);k.log("Executing actions",t,"for Campaign",o,"on Page(s)",r),O.all(i.map(t,(function(t){return u.executePreparedAction(t).then(i.partial(f.emitActionAppliedEvent,t))}))).then((function(){k.log("All page actions for",e,"applied:",t),f.emitActionsForDecisionAppliedEvent(e,t)}))["catch"]((function(t){k.warn("Error evaluating page actions for decision",e,"because:",t)}))}(g,t,d,o)}(o,t,e,l,a)})),a(o)}))}catch(v){k.error("Error getting decision for Campaign: "+T.description(o),v),d(v)}}))},n.decideLayer=function(t,n,e){var i;var r=T.description(t);i=e.length?p.getDummyLayerDecision(t,e):p.decideLayer(t,n),k.log("Recording decision for Campaign",r,n,"->",i),T.recordLayerDecision(t.id,n,i),i.variationId&&i.experimentId&&V.updateVariationIdMap(t.id,i.experimentId,i.variationId),t.groupId&&V.updatePreferredLayerMap(t.groupId,t.id);return i},n.getActionsForDecision=function(t,n,e){var i=T.description(t),r="NOT applying changes for Campaign",o={actions:[],maybeExecute:!1};if(o.actions=[].concat(G.getLayerActions(n.layerId)||[],G.getExperimentActions(n.experimentId)||[],G.getExperimentVariationActions(n.experimentId,n.variationId)||[]),!e&&H.isGlobalHoldback())return k.log(r,i,"(visitor is in global holdback)"),o;if(n.isLayerHoldback)return k.log(r,i,"(visitor is in layer holdback)"),o;if(!n.experimentId||!n.variationId)return k.log(r,i,"(visitor is not eligible for any Experiments)"),o;return o.maybeExecute=!0,k.log("Got Actions for Campaign:",i,o.actions),o}},8213:function(t,n,e){var i=e(212).Promise,r=e(8701),o=e(9932).get("stores/plugins"),a=e(8738),u=e(7936);n.create=function(t,n,e){var c={identifier:t.id,action:n,startTime:e||r.now()};try{var s=o.getPlugin(a.PluginTypes.changeAppliers,t.type);if(!s)throw new Error("Unrecognized change type "+t.type);return new s(t,c)}catch(f){return u.error("Change applier was never properly constructed:",f),{apply:function(){return i.reject(f)}}}}},9887:function(t){t.exports={SELECTOR_POLLING_MAX_TIME:2e3,CHANGE_DATA_KEY:"optimizelyChangeData",CHANGE_ID_ATTRIBUTE_PREFIX:"data-optly-"}},4760:function(t,n,e){var i=e(4816),r=e(9887).CHANGE_DATA_KEY;function o(t,n){return[t,n].join("_")}n.getData=function(t,n,e){var i=o(n,e);return t[r]&&t[r][i]?t[r][i]:null},n.hasData=function(t){return Boolean(t&&t[r]&&!i.isEmpty(t[r]))},n.removeData=function(t,n,e){t[r]&&delete t[r][o(n,e)]},n.setData=function(t,n,e,i){if("object"!=typeof i)throw new Error("setData expects an object");t[r]||(t[r]={}),t[r][o(n,e)]=i}},2262:function(t,n,e){var i=e(4204);t.exports={changeType:{CUSTOM_CODE:"custom_code",ATTRIBUTE:"attribute",APPEND:"append",REARRANGE:"rearrange",REDIRECT:"redirect",WIDGET:"widget"},DOMInsertionType:{AFTER:"after",APPEND:"append",BEFORE:"before",PREPEND:"prepend"},insertAdjacentHTMLType:{AFTER_BEGIN:"afterbegin",AFTER_END:"afterend",BEFORE_BEGIN:"beforebegin",BEFORE_END:"beforeend"},selectorChangeType:{CLASS:"class",HTML:"html",HREF:"href",SRC:"src",STYLE:"style",TEXT:"text",HIDE:"hide",REMOVE:"remove"},changeApplierState:i({APPLIED:null,APPLYING:null,UNAPPLIED:null,UNDOING:null}),changeState:i({BLOCKED:null,UNAPPLIED:null,APPLIED:null,APPLYING:null,UNDOING:null,TIMED_OUT:null,IGNORED:null,ERROR:null})}},7234:function(t,n,e){var i=e(4816),r=e(9590),o=e(4248),a=e(9621),u=e(8064).U,c=e(8701),s=e(9932),f=e(349),l=e(7936),d=e(212).Promise,v=e(9787),h=s.get("stores/global"),p=s.get("stores/action_data"),g=s.get("stores/change_data"),m=s.get("stores/session"),_=e(8213);e(9612).initialize();var w=u("ActionError");function y(t,n,e){if(p.getActionState(n.id)){var o=p.getChangeApplier(t.id,n.id);if(i.isUndefined(o)){var a={changeId:t.id,actionId:n.id,changeApplier:_.create(t,n,e)};f.dispatch(r.SET_CHANGE_APPLIER,a)}else l.warn("Action / Attempted to prepare a change which is already being applied: ",t)}else l.warn("Action / Attempted to prepare change for inactive action: ",n)}function b(t,n,e,r){if(!i.includes(r,n)){if(!t[String(n)]){var u=g.getChange(n);if(!u){var s="Change with id "+n+" is absent";return r.length&&(s+=" but listed as a dependency for "+r[r.length-1]),void l.warn(s)}t[String(n)]=new d((function(s){var f=i.map(u.dependencies||[],(function(i){return b(t,i,e,r.concat([n]))}));if(u.src){var h="change_"+u.src,m=a.makeAsyncRequest(h,(function(){return v.addScriptAsync("https://cdn.optimizely.com/public/752671897/data"+u.src,(function(){a.resolveRequest(h)}))})).then((function(){var t=g.getChange(u.id);t||o.emitError(new w("Failed to load async change from src: "+u.src)),y(t,e,c.now())}));f.push(m)}d.all(f).then((function(){var t=c.now(),i=p.getChangeApplier(n,e.id);return i?(l.debug("Action / Applying change:",u),i.apply().then((function(n){n?l.log(n):l.debug("Action / Applied change for the first time in "+(c.now()-t)+"ms:",u),s()}))):(l.debug("Action / Not applying change ",n," - No changeApplier found."),void s())}))["catch"]((function(t){l.error("Action / Failed to apply change:",u,t),s()}))}))}return t[String(n)]}l.error("Change with id "+n+" has circular dependencies: "+r.concat(n))}n.prepareAction=function(t){l.debug("Action / Preparing:",t),f.dispatch(r.ACTION_EXECUTED,{actionId:t.id,sessionId:m.getSessionId(),layerId:t.layerId,pageId:t.pageId,timestamp:c.now(),activationId:h.getActivationId()});var n=c.now();i.forEach(t.changeSet,(function(e){var o=i.isObject(e)?e.id:e,a=g.getChange(o);a||(f.dispatch(r.ADD_CHANGE,e),a=g.getChange(e.id)),a.src||y(a,t,n)}))},n.executePreparedAction=function(t){l.debug("Action / Executing:",t);var n={},e=i.map(t.changeSet,(function(e){var r=i.isObject(e)?e.id:e;return b(n,r,t,[])}));return d.all(e).then((function(){l.debug("changes for action id="+t.id+" applied")}))}},9612:function(t,n,e){var i=e(9887),r=e(9932).get("stores/directive");function o(){("interactive"===document.readyState||"complete"===document.readyState)&&(n.domReadyTime=Date.now())}n.domReadyTime=null,n.initialize=function(){o(),document.addEventListener("readystatechange",o,!0)},n.isTimedOut=function(t){var e=Date.now();if(!n.domReadyTime||!t)return!1;var o=Math.max(t,n.domReadyTime);return r.isEditor()&&(o=n.domReadyTime),!(e-o<i.SELECTOR_POLLING_MAX_TIME)}},5086:function(t,n,e){var i=e(4816),r=e(9590),o=e(4248),a=e(1623),u=e(8701),c=e(6637),s=e(9932),f=e(8416),l=e(8738),d=e(6518),v=e(8120),h=e(4141),p=e(6787),g=e(349),m=e(5508),_=e(7936),w=(e(2899),e(212).Promise),y=e(7179),b=e(1659),E=e(3406),I=e(1346),A=e(7276),T=s.get("stores/client_metadata"),S=s.get("stores/global"),k=s.get("stores/session"),R=s.get("stores/view"),N=s.get("stores/plugins"),C=s.get("stores/layer"),D=s.get("stores/layer_data"),O=s.get("stores/observed_redirect"),x=s.get("stores/pending_redirect"),M=s.get("stores/visitor"),P=s.get("stores/directive"),L=s.get("stores/event_data"),U=s.get("stores/visitor_id");function V(t,n){return i.extend({},t,{isLayerHoldback:n,isGlobalHoldback:!1,clientName:i.isNull(t.clientName)?c.NAME:t.clientName,integrationStringVersion:i.isNull(t.integrationStringVersion)?1:t.integrationStringVersion,anonymizeIP:i.isNull(S.getAnonymizeIP())?void 0:S.getAnonymizeIP(),activationId:S.getActivationId(),decisionTicketAudienceIds:[],sessionId:k.getSessionId(),activeViewStates:[],userFeatures:z(M.getVisitorProfile()),layerStates:C.getLayerStatesForAnalytics()})}function F(t){var n=y.getReferrer()||f.getReferrer();return{eventId:A.generate(),timestamp:u.now(),revision:S.getRevision(),clientName:T.getClientName(),clientVersion:T.getClientVersion(),projectId:S.getProjectId(),accountId:S.getAccountId(),activationId:S.getActivationId(),sessionId:k.getSessionId(),isGlobalHoldback:S.isGlobalHoldback(),namespace:S.getNamespace(),referrer:n,visitorId:U.getRandomId(),activeViewStates:t.activeViewStates,layerStates:t.layerStates,userFeatures:z(t.visitorProfile)}}function B(t){var n,e;return t.pageId?(n=t.pageId,(e=R.getViewState(n))&&e.isActive?e.metadata:{}):{}}function z(t){var n=N.getAllPlugins(l.PluginTypes.visitorProfileProviders),e=i.filter(n,{shouldTrack:!0}),r={id:null,type:null,name:"",value:null,shouldIndex:!0};return i.reduce(e,(function(n,e){try{var o=e.provides,a=t[o],u=[];if(!i.isUndefined(a)){i.isObject(a)?u=i.map(a,(function(t,n){var e=i.isObject(t)?t:{value:t};return i.extend({},{type:o,name:n},e)})):u.push({type:o,value:a});var c=i(u).map((function(t){return i.pick(i.extend({},r,t),i.keys(r))})).filter((function(t){return!!t.value})).value();n=n.concat(c)}}catch(s){_.warn("Error evaluating userFeature against visitorProfile:",s)}return n}),[])}function G(t,n,e){var r=function(t,n){var e=[];return i.each(N.getAllPlugins(l.PluginTypes.analyticsTrackers),(function(i,r){if(i[t]&&(!n||!i[n]))try{e.push({name:r,hookFn:s.evaluate(i[t])})}catch(o){_.error(o)}})),e}(t,e);_.debug("Found "+r.length+" analytics integrations defining a "+t+" hook"),_.debug("Calling each with data: ",n),i.each(r,(function(t){try{_.debug("Calling plugin: "+t.name),t.hookFn(n),_.debug("Called plugin: "+t.name)}catch(e){_.error(e)}}))}function j(t,n,e){var r=function(t,n){0;var e=[];return i.each(N.getAllPlugins(l.PluginTypes.analyticsTrackers),(function(r,o){i.includes(n,r[t])&&e.push({name:o,hookFn:r.trackLayerDecision})})),e}(t,n);_.debug("Found "+r.length+" analytics integrations  defining a trackLayerDecision "+t+" timing of "+n.join("|")),_.debug("Calling each with data: ",e),i.each(r,(function(t){try{_.debug("Calling plugin: "+t.name),t.hookFn(e),_.debug("Called plugin: "+t.name)}catch(n){_.error(n)}}))}n.trackClientActivation=function(){if(P.shouldSendTrackingData()){var t,n=(t=F({activeViewStates:[],visitorProfile:M.getVisitorProfile(),layerStates:C.getLayerStatesForAnalytics()}),i.extend(t,{eventTags:{}}));return G("onClientActivation",n),n}},n.trackCustomEvent=function(t,n,e,r){n=n||{},r=r||{},e||(e=L.getByApiName(t));var u=function(t,n,e,r){var o=F({activeViewStates:R.getActiveViewStates(),visitorProfile:M.getVisitorProfile(),layerStates:C.getLayerStatesForAnalytics()}),a=r&&r.pageId?B(r):R.getActiveViewTags(),u=i.extend({},a,n),c=r&&r.category?r.category:d.OTHER;return i.extend(o,{eventEntityId:r&&r.id,eventApiName:t,eventCategory:c,eventTags:u,eventProperties:e})}(t,n,r,e),c={name:t,type:p.CUSTOM,category:u.eventCategory,tags:i.omit(u.eventTags,"revenue")};if(i.isUndefined(n.revenue)||(c.revenue=n.revenue),o.emitAnalyticsEvent({name:e?e.name||e.apiName:t,apiName:e?e.apiName:void 0,type:p.CUSTOM,tags:i.omit(u.eventTags,"revenue"),category:u.eventCategory,metrics:c.revenue?{revenue:c.revenue}:{}},!P.shouldSendTrackingData()),P.shouldSendTrackingData())return a.addEvent(c),G("onCustomEvent",u),u},n.trackDecisionEvent=function(t,n,e){e||(e=D.get(t.layerId));var o=A.generate();g.dispatch(r.RECORD_LAYER_DECISION_EVENT_ID,{layerId:t.layerId,pageId:n.pageId,decisionId:o});var a=function(t,n,e,r){var o=null,a=null,c=null;if(n.experimentId){var s=i.find(r.experiments,{id:n.experimentId});if(s&&(o=s.name||null,c=s.integrationSettings,n.variationId)){var l=i.find(s.variations,{id:n.variationId});l&&(a=l.name||null)}}var d=y.getReferrer()||f.getReferrer();return{sessionId:k.getSessionId(),decisionTicketAudienceIds:e.audienceIds,visitorId:U.getRandomId(),decisionId:t,activationId:S.getActivationId(),namespace:S.getNamespace(),timestamp:u.now(),pageId:e.pageId||null,variationId:n.variationId,variationName:a,experimentId:n.experimentId,experimentName:o,layerId:n.layerId,layerName:r.name,layerPolicy:r.policy,accountId:S.getAccountId(),projectId:S.getProjectId(),revision:String(S.getRevision()),clientName:T.getClientName(),clientVersion:T.getClientVersion(),referrer:d,integrationStringVersion:r.integrationStringVersion||1,integrationSettings:i.extend({},r.integrationSettings,c)}}(o,t,n,e),c=x.isExpectingRedirect(),s=x.getLayerId(),l=m.description(e);if(c&&s===e.id&&(b.persist(a,"COOKIE"),_.log("Relaying decision for redirect Campaign",l)),P.shouldSendTrackingData()){var d=V(a,t.isLayerHoldback);if(c&&s===e.id){var v=I.TrackLayerDecisionTimingFlags.preRedirectPolicy;d.timing=v,j(v,[I.PreRedirectPolicies.PERSIST_BEFORE_AND_TRACK_DURING_REDIRECT],d),_.log("Called trackLayerDecision for redirect Campaign",l,d)}else{v=I.TrackLayerDecisionTimingFlags.nonRedirectPolicy;d.timing=v,j(v,[I.NonRedirectPolicies.TRACK_IMMEDIATELY],d),_.log("Called trackLayerDecision for non-redirect Campaign",l,d)}}else _.log("Analytics / Not tracking decision for Campaign",m.description(e))},n.trackPostRedirectDecisionEvent=function(){if(!P.shouldSendTrackingData()||O.hasTracked())return w.resolve();var t=O.get();if(!t)return w.resolve();var n=V(t,!1),e=I.TrackLayerDecisionTimingFlags.postRedirectPolicy;n.timing=e,j(e,[I.PostRedirectPolicies.TRACK_IMMEDIATELY],n);var i=new w((function(t){var n=v.on({filter:{type:h.TYPES.LIFECYCLE,name:"originsSynced"},handler:function(){t(),v.off(n)}})})),o=E.makeTimeoutPromise(1e3);return w.race([i,o]).then((function(){_.log("Calling trackers after successful sync")}),(function(t){_.warn("Calling trackers after failed sync:",t)})).then((function(){(n=V(t,!1)).timing=I.TrackLayerDecisionTimingFlags.postRedirectPolicy,j(I.TrackLayerDecisionTimingFlags.postRedirectPolicy,[I.PostRedirectPolicies.TRACK_AFTER_SYNC],n),g.dispatch(r.REGISTER_TRACKED_REDIRECT_DATA)}))["catch"]((function(t){_.error("Error when calling trackers after sync:",t)}))},n.trackClickEvent=function(t){var n=function(t){var n=F({activeViewStates:R.getActiveViewStates(),visitorProfile:M.getVisitorProfile(),layerStates:C.getLayerStatesForAnalytics()}),e=t.config&&t.config.selector?t.config.selector:t.eventFilter.selector,r=t.apiName,o=t.category||d.OTHER,a=t.id,u=B(t);return i.extend(n,{eventApiName:r,eventCategory:o,eventEntityId:a,eventTags:u,pageId:t.pageId,selector:e})}(t),e={name:t.apiName,type:t.eventType,category:n.eventCategory,tags:n.eventTags};if(o.emitAnalyticsEvent({name:t.name||t.apiName,apiName:t?t.apiName:void 0,type:t.eventType,category:n.eventCategory,tags:n.eventTags,metrics:{}},!P.shouldSendTrackingData()),P.shouldSendTrackingData())return a.addEvent(e),G("onClickEvent",n),n},n.trackViewActivation=function(t,n){if(n||(n=R.getViewState(t.id)),n.isActive){var e=function(t,n){var e=F({activeViewStates:R.getActiveViewStates(),visitorProfile:M.getVisitorProfile(),layerStates:C.getLayerStatesForAnalytics()});return i.extend(e,{pageId:t.id,pageApiName:t.apiName,viewCategory:t.category,eventTags:n.metadata})}(t,n);if(o.emitAnalyticsEvent({name:t.name||e.pageApiName,apiName:e.pageApiName,type:p.PAGEVIEW,category:e.viewCategory,tags:e.eventTags,metrics:{}},!P.shouldSendTrackingData()),P.shouldSendTrackingData())return a.addEvent({name:e.pageApiName,type:p.PAGEVIEW,category:e.viewCategory,tags:e.eventTags}),g.dispatch(r.TRACK_VIEW_ACTIVATED_EVENT,{pageId:t.id,eventData:e}),G("onPageActivated",e),e}else _.debug("Inactive view passed to `trackViewActivation`")}},1659:function(t,n,e){var i=e(4816),r=e(9590),o=e(7690),a=e(4248),u=e(9932),c=e(8738),s=e(349),f=e(7936),l=e(1346),d=u.get("stores/plugins"),v=".",h=[{name:"sessionId",relayName:"s"},{name:"decisionTicketAudienceIds",relayName:"as",valueToValueString:function(t){return i.map(t,encodeURIComponent).join(",")},encodeValueString:i.identity,decodeValueString:i.identity,valueFromValueString:function(t){return i.map(t.split(","),o.safeDecodeURIComponent)}},{name:"decisionId",relayName:"d"},{name:"activationId",relayName:"aId"},{name:"pageId",relayName:"vId",isNullable:!0},{name:"variationId",relayName:"v",isNullable:!0},{name:"referrer",relayName:"r"},{name:"timestamp",relayName:"t",valueFromValueString:Number},{name:"visitorId",relayName:"i"},{name:"projectId",relayName:"p"},{name:"revision",relayName:"n"},{name:"clientName",relayName:"cN",isNullable:!0},{name:"clientVersion",relayName:"cV"},{name:"namespace",relayName:"ns"},{name:"accountId",relayName:"a"},{name:"layerId",relayName:"l"},{name:"layerName",relayName:"lN",isNullable:!0},{name:"layerPolicy",relayName:"lP"},{name:"experimentId",relayName:"x",isNullable:!0},{name:"experimentName",relayName:"xN",isNullable:!0},{name:"variationName",relayName:"vN",isNullable:!0},{name:"integrationStringVersion",relayName:"isv",valueFromValueString:Number,isNullable:!0},{name:"integrationSettings",relayName:"iS",isMulti:!0,valueToValueString:function(t,n){var e=null;if(t){var r=d.getPlugin(c.PluginTypes.analyticsTrackers,n);if(r&&i.isFunction(r.serializeSettings))try{e=r.serializeSettings(t)}catch(o){f.warn("Analytics / Failed to persist integrationSettings for plugin:",n,o)}}return e},valueFromValueString:function(t,n){var e=null,r=d.getPlugin(c.PluginTypes.analyticsTrackers,n);if(r&&i.isFunction(r.deserializeSettings))try{e=r.deserializeSettings(t)}catch(o){f.warn("Analytics / Failed to persist integrationSettings for plugin:",n,o)}return e},isNullable:!0}],p={},g={};i.forEach(h,(function(t){p[t.name]=t,g[t.relayName]=t})),n.persist=function(t,n){n===l.RedirectRelayMedia.COOKIE?function(t){try{var n=function(t){var n=[],e=i.reduce(t,(function(t,e,r){var o=p[r];return o?(o.isMulti?i.forEach(e,(function(n,e){n=o.valueToValueString?o.valueToValueString(n,e):String(n),i.isNull(n)||(n=(o.encodeValueString||encodeURIComponent)(n),t.push(encodeURIComponent(o.relayName+v+e)+"="+n))})):i.isNull(e)||(e=(o.valueToValueString||String)(e),e=(o.encodeValueString||encodeURIComponent)(e),t.push(o.relayName+"="+e)),t):(n.push(r),t)}),[]);if(n.length)throw new Error("Relay / Don't know how to relay some fields: "+n);return e.sort(),e.join("&")}(t)}catch(e){return f.error("Relay / Error computing redirect relay cookie: ",e),void a.emitError(e)}f.debug("Relay / Setting redirect relay cookie:",n);try{o.set(c.COOKIES.REDIRECT,n,{maxAge:5,encodeValue:!1})}catch(r){f.error("Relay / Failed to set redirect relay cookie",r),a.emitError(r)}}(t):f.error("Relay / Unsupported redirect relay medium: "+n)},n.load=function(t){if(t||(t=function(){var t=o.get(c.COOKIES.REDIRECT,!1);if(t)return f.log("Relay / Found redirect cookie:",t),t}()),t){var n=function(t){var n={},e=t.split("&");return i.forEach(e,(function(t){var e=t.split("=");if(2===e.length){var r=o.safeDecodeURIComponent(e[0]),u=g[r];if(u||(u=i.find(h,(function(t){return t.isMulti&&0===r.indexOf(t.relayName+v)})))){var c=e[1];try{if(u.isMulti){n[u.name]=n[u.name]||{};var s=r.substring(u.relayName.length+v.length);c=(u.decodeValueString||o.safeDecodeURIComponent)(c),c=(u.valueFromValueString||i.identity)(c,s),n[u.name][s]=c}else c=(u.decodeValueString||o.safeDecodeURIComponent)(c),c=(u.valueFromValueString||i.identity)(c),n[u.name]=c}catch(l){return f.warn("Relay / Skipping segment due to decode or parse error:",t,l),void a.emitError(l)}}else f.warn("Relay / Skipping segment with unknown field identifier:",t,r)}else f.warn("Relay / Skipping invalid segment:",t)})),n}(t);if(n){var e=[];if(i.forEach(h,(function(t){(i.isNull(n[t.name])||i.isUndefined(n[t.name]))&&(t.isNullable?n[t.name]=null:(delete n[t.name],e.push(t.name)))})),!e.length)return s.dispatch(r.LOAD_REDIRECT_DATA,n),s.dispatch(r.ADD_CLEANUP_FN,{lifecycle:c.Lifecycle.postVisitorProfileLoad,cleanupFn:function(){var t,e;e=(t=n).pageId||void 0,s.dispatch(r.RECORD_LAYER_DECISION,{layerId:t.layerId,decision:{layerId:t.layerId,experimentId:t.experimentId,variationId:t.variationId,isLayerHoldback:!1},decisionTicket:{audienceIds:t.decisionTicketAudienceIds,bucketingId:t.visitorId,globalHoldback:0,preferredVariationMap:void 0,pageId:e,activationId:t.activationId},sessionId:t.sessionId,activationId:t.activationId,timestamp:t.timestamp,revision:t.revision,namespace:t.namespace,pageId:e}),s.dispatch(r.RECORD_LAYER_DECISION_EVENT_ID,{layerId:t.layerId,pageId:e,decisionId:t.decisionId}),s.dispatch(r.ACTION_EXECUTED,{sessionId:t.sessionId,layerId:t.layerId,pageId:t.pageId,timestamp:t.timestamp,activationId:t.activationId})}}),n;f.error("Relay / Observed redirect data with missing fields:",e)}}}},4248:function(t,n,e){var i=e(8120);n.emitError=function(t,n,e){i.emit({type:"error",name:t.name||"Error",data:{error:t,metadata:n}},e||!1,!0)},n.emitInternalError=function(t,e){n.emitError(t,e,!0)},n.emitAnalyticsEvent=function(t,n){var e={type:"analytics",name:"trackEvent",data:t};i.emit(e,n)}},4036:function(t,n,e){var i=e(4816),r=e(5175),o=e(6094),a=e(7936),u=e(1683);function c(t,n){var e="function"==typeof t?t(n):t;return"string"==typeof e&&(e=[e]),i.isArray(e)?e:(a.warn("Couldn't determine fieldsNeeded for matcher; assuming []"),[])}function s(t){return t.name?t.name+" ("+t.id+")":t.id}n.isInAudience=function(t,n,e){var u,f=function(t,n){return function(e){var r=e.type,u=n[r];if(!u)throw new Error("Audience / No matcher found for type="+r);if(u.fieldsNeeded)for(var s=c(u.fieldsNeeded,e),f=0;f<s.length;f++){var l=s[f],d=o.getFieldValue(t,l);if(i.isUndefined(d))return void a.debug("Audience / Required field",l,"for type",r,"has no value")}a.debug("Matching condition:",e,"to values:",t);var v=u.match(t,e);if(!i.isUndefined(v))return!!v}}(t,e);a.groupCollapsed("Checking audience",n.name,n.id,n),a.debug("Visitor Profile:",t);try{var l=r.evaluate(n.conditions,f)}catch(d){u=d,l=!1}return a.groupEnd(),u&&a.error("Audience / Error evaluating audience",s(n),":",u),a.log("Is "+(l?"in":"NOT in")+" audience:",s(n)),l},n.requiredAudienceFieldsForConditions=function f(t,n){var e={};return i.each(t,(function(t){if(i.isArray(t))i.extend(e,f(t,n));else if(i.isObject(t)){var r=n[t.type];if(r){var o=c(r.fieldsNeeded,t);i.each(o,(function(t){e[u.serializeFieldKey(t)]=t}))}}})),e}},8676:function(t,n){n.FIELDS={NAME:"n",TIME:"t",TYPE:"y",CATEGORY:"c",REVENUE:"r",SESSION_ID:"s",OPTIONS:"o",SESSION_INDEX:"si"},n.FIELDS_V0_2={name:n.FIELDS.NAME,time:n.FIELDS.TIME,type:n.FIELDS.TYPE,category:n.FIELDS.CATEGORY,tags:n.FIELDS.OPTIONS,session_index:n.FIELDS.SESSION_INDEX}},1215:function(t,n,e){var i=e(4816),r=e(8676),o=e(6094).getFieldValue,a=e(984);function u(t,n,e,o,a){this[r.FIELDS.NAME]=t,this[r.FIELDS.TYPE]=n,i.isString(e)&&e.trim().length>0&&(this[r.FIELDS.CATEGORY]=e),o&&i.keys(o).length>0&&(this[r.FIELDS.OPTIONS]=o),i.isUndefined(a)||(this[r.FIELDS.REVENUE]=a)}function c(t,n,e,o){this.eventBase=t,this[r.FIELDS.TIME]=n,i.isUndefined(e)||(this[r.FIELDS.SESSION_ID]=e),i.isUndefined(o)||(this[r.FIELDS.SESSION_INDEX]=o)}n.x=u,u.prototype.digest=function(){var t=function(t,n){return encodeURIComponent(t)+"="+encodeURIComponent(n)},n=[];if(n.push(t(r.FIELDS.NAME,this[r.FIELDS.NAME])),n.push(t(r.FIELDS.TYPE,this[r.FIELDS.TYPE])),this[r.FIELDS.CATEGORY]&&n.push(t(r.FIELDS.CATEGORY,this[r.FIELDS.CATEGORY])),this[r.FIELDS.REVENUE]&&n.push(t(r.FIELDS.REVENUE,this[r.FIELDS.REVENUE])),!this[r.FIELDS.OPTIONS])return n.join("&");var e=this[r.FIELDS.OPTIONS]||{},o=i.filter(i.keys(e),(function(t){return e.hasOwnProperty(t)}));o=o.sort();for(var a=0;a<o.length;a++)n.push(t(o[a],e[o[a]]));return n.join("&")},u.prototype.hash=function(){return this.hash_||(this.hash_=a.hashToHex(a.toByteString(this.digest()),a.Seed.BEHAVIOR_EVENT)),this.hash_},u.prototype.setHash=function(t){this.hash_=t},u.prototype.reHash=function(){this.hash_=null,this.hash()},u.prototype.equals=function(t){if(this.hash()!==t.hash()||this[r.FIELDS.NAME]!==t[r.FIELDS.NAME]||this[r.FIELDS.TYPE]!==t[r.FIELDS.TYPE]||this[r.FIELDS.CATEGORY]!==t[r.FIELDS.CATEGORY]||this[r.FIELDS.REVENUE]!==t[r.FIELDS.REVENUE])return!1;var n=this[r.FIELDS.OPTIONS]||{},e=t[r.FIELDS.OPTIONS]||{},o=i.filter(i.keys(n),(function(t){return n.hasOwnProperty(t)})),a=i.filter(i.keys(e),(function(t){return e.hasOwnProperty(t)}));if(o.length!==a.length)return!1;for(var u=0;u<o.length;u++){var c=o[u];if(!e.hasOwnProperty(c)||n[c]!==e[c])return!1}return!0},u.prototype.getValueOrDefault=function(t,n){var e=o(this,t);return i.isUndefined(e)?n:e},u.prototype.setFieldValue=function(t,n){t!==r.FIELDS.NAME&&t!==r.FIELDS.TYPE&&t!==r.FIELDS.CATEGORY&&t!==r.FIELDS.REVENUE&&t!==r.FIELDS.OPTIONS||(this[t]=n,this.reHash())},n.j=c,c.prototype.getValueOrDefault=function(t,n){if(0===t.length)return this;var e={};e[r.FIELDS.TIME]=this[r.FIELDS.TIME],e[r.FIELDS.SESSION_ID]=this[r.FIELDS.SESSION_ID],e[r.FIELDS.SESSION_INDEX]=this[r.FIELDS.SESSION_INDEX];var a=o(e,t);return i.isUndefined(a)?this.eventBase.getValueOrDefault(t,n):a},c.prototype.setFieldValue=function(t,n){t===r.FIELDS.TIME||t===r.FIELDS.SESSION_ID||t===r.FIELDS.SESSION_INDEX?this[t]=n:this.eventBase.setFieldValue(t,n)};var s={n:"name",y:"type",c:"category",r:"revenue",s:"session_id",o:"tags",si:"session_index"};c.prototype.readableEvent=function(){var t,n,e=function(t){return i.isString(t)?'"'+t+'"':t},o=this,a=[];i.each([r.FIELDS.NAME,r.FIELDS.TYPE,r.FIELDS.CATEGORY,r.FIELDS.REVENUE,r.FIELDS.SESSION_ID],(function(r){t=s[r],n=o.getValueOrDefault([r]),i.isUndefined(n)||a.push(t+": "+e(n))}));var u=[];if(t=s[r.FIELDS.OPTIONS],n=o.getValueOrDefault([r.FIELDS.OPTIONS]),i.isUndefined(n)||(i.each(n,(function(t,n){u.push(n+": "+String(e(t)))})),a.push(t+": {\n\t\t"+u.join(",\n\t\t")+"\n\t}")),n=o.getValueOrDefault([r.FIELDS.TIME]),i.isNumber(n)&&(n=e(new Date(n).toString())),!i.isUndefined(n)){a.push("timestamp: "+n)}return"{\n\t"+a.join(",\n\t")+"\n}"},c.prototype.toObject=function(t){var n,e,o={},a=this;i.each([r.FIELDS.NAME,r.FIELDS.TYPE,r.FIELDS.CATEGORY,r.FIELDS.REVENUE,r.FIELDS.OPTIONS,r.FIELDS.SESSION_INDEX],(function(t){n=s[t],e=a.getValueOrDefault([t],t===r.FIELDS.OPTIONS?{}:void 0),i.isUndefined(e)||(o[n]=e)}));var u=s[r.FIELDS.OPTIONS],c=s[r.FIELDS.REVENUE];if(t&&t.revenueAsTag&&o[c]&&(o[u]=o[u]||{},o[u][c]=o[c],delete o[c]),e=a.getValueOrDefault([r.FIELDS.TIME]),i.isNumber(e))if(t&&t.timeAsTimestamp){o.timestamp=new Date(e)}else{o.time=e}return o}},1623:function(t,n,e){var i=e(2755);n.initializeStore=i.initialize,n.addEvent=i.addEvent,n.getEvents=i.getEvents,n.getEventCount=i.getEventCount},3841:function(t,n,e){var i=e(1215).j,r=e(8701),o=e(8676),a=e(1215).x;n.CURRENT_SESSION_INDEX=0;var u=18e5;function c(t,e){var i;i=n.isInSameSession(t,e)?t.getValueOrDefault([o.FIELDS.SESSION_ID]):e.getValueOrDefault([o.FIELDS.TIME]),e.setFieldValue(o.FIELDS.SESSION_ID,i)}function s(t,e,i){var r,a=t.getValueOrDefault([o.FIELDS.SESSION_INDEX]);r=n.isInSameSession(e,t)?a:i?a+1:a-1,e.setFieldValue(o.FIELDS.SESSION_INDEX,r)}n.isInSameSession=function(t,n){var e=t.getValueOrDefault([o.FIELDS.TIME],0),i=n.getValueOrDefault([o.FIELDS.TIME],0);return Math.abs(e-i)<u},n.updateSessionId=function(t,n){if(t){var e=t.getValueOrDefault([o.FIELDS.TIME]),r=t.getValueOrDefault([o.FIELDS.SESSION_ID]),u=n.getValueOrDefault([o.FIELDS.TIME]);e="number"!=typeof e?u-36e5:e,r="number"!=typeof r?e:r,c(t=new i(new a("",""),e,r),n)}else n.setFieldValue(o.FIELDS.SESSION_ID,n.getValueOrDefault([o.FIELDS.TIME]))},n.updateSessionIndex=function(t,n){if(t){var e=t.getValueOrDefault([o.FIELDS.TIME]),r=t.getValueOrDefault([o.FIELDS.SESSION_INDEX]),u=n.getValueOrDefault([o.FIELDS.TIME]),c=t.getValueOrDefault([o.FIELDS.SESSION_ID]);e="number"!=typeof e?u-36e5:e,r="number"!=typeof r?0:r,c="number"!=typeof c?e:c,s(t=new i(new a("",""),e,c,r),n,!1)}else n.setFieldValue(o.FIELDS.SESSION_INDEX,0)},n.sessionize=function(t){var e=t.length;if(0!==e){t[0].setFieldValue(o.FIELDS.SESSION_ID,t[0].getValueOrDefault([o.FIELDS.TIME]));for(var i=1;i<e;i++)c(t[i-1],t[i]);var a=n.CURRENT_SESSION_INDEX,f=t[e-1].getValueOrDefault([o.FIELDS.TIME]);r.now()-f>u&&(a+=1),t[e-1].setFieldValue(o.FIELDS.SESSION_INDEX,a);for(i=e-1;i>0;i--)s(t[i],t[i-1],!0)}},n.reindexIfNecessary=function(t,n,e){var i=function(t){for(var n=0;n<t.length;n++){var e=t[n].getValueOrDefault([o.FIELDS.SESSION_INDEX]);t[n].setFieldValue(o.FIELDS.SESSION_INDEX,e+1)}};-1===t.getValueOrDefault([o.FIELDS.SESSION_INDEX])&&(i(n),i(e))},n.sessionSortPredicate=function(t,n){return t[o.FIELDS.TIME]-n[o.FIELDS.TIME]},n.applyMigrations=function(t){return!1}},2755:function(t,n,e){var i=e(4816),r=e(9590),o=e(8701),a=e(6518),u=e(349),c=e(7936),s=e(1683),f=n,l=e(1215).j,d=e(8676),v=e(1215).x,h=e(3841),p=e(9932),g=p.get("stores/visitor_events"),m=p.get("stores/visitor_events_manager"),_={EVENTBASE:"eb",HASH:"h",TIMEBASE:"tb",TIMESTAMPS:"ts",DELTA:"d",INDEX:"i"};function w(t){u.dispatch(r.SET_VISITOR_EVENTS,t)}function y(t){u.dispatch(r.UPDATE_BEHAVIOR_STORE,{key:"baseMap",value:t})}function b(t){u.dispatch(r.UPDATE_BEHAVIOR_STORE,{key:"eventQueue",value:t})}function E(t){u.dispatch(r.UPDATE_BEHAVIOR_STORE,{key:"lastEvent",value:t})}function I(){return g.getEvents()}function A(){return m.getBaseMap()}function T(){return m.getEventQueue()}function S(){return m.getLastEvent()}function k(){var t=I().concat(T()),n=!1;return t.length>1e3&&(t=t.slice(-1e3),n=!0),w(t),b([]),n}n.initialize=function(t,n){if(!m.getInitialized()){f.k(t,n);var e=I();e.length>0&&E(e[e.length-1]);var i=T();i.length>0&&E(i[i.length-1]),u.dispatch(r.UPDATE_BEHAVIOR_STORE,{key:"initialized",value:!0})}},n.addEvent=function(t){c.debug("Behavior store: adding event",t);var n=f.R(t);E(n),b(T().concat(n)),h.reindexIfNecessary(S(),I(),T()),f.N(T())},n.getEvents=function(){return T().length>0&&(k()&&h.sessionize(I()),f.C(I()),f.N(T())),I()},n.getEventCount=function(){return T().length+I().length},f.k=function(t,n){f.D(t,n)&&(f.C(I()),f.N(T())),h.sessionize(I())},f.D=function(t,n){if(0===t.length&&0===n.length)return w([]),b([]),!1;var e=!1,i=t[0]||n[0];return _.EVENTBASE in i?(w(f.O(t)),b(f.O(n))):(e=!0,w(f.M(t)),b(f.M(n))),T().length>0&&(k(),e=!0),w(f._updateBaseMapAndMaybeDedupe(I())),f._migrateEventBasesAndUpdateStore()&&(e=!0),e},f.M=function(t){for(var n=[],e=0;e<t.length;e++){var i=t[e],r=f.P(i);n[e]=new l(r,i[d.FIELDS.TIME])}return n},f._migrateEventBasesAndUpdateStore=function(){var t=!1,n=f.L();return h.applyMigrations(n)&&(t=!0,y({}),w(f._updateBaseMapAndMaybeDedupe(I())),b(f._updateBaseMapAndMaybeDedupe(T()))),t},f.V=function(){return o.now()},f.R=function(t){var n,e=t.name,i=t.type||"default",r=t.category||a.OTHER,o=t.tags||{};t.revenue&&(n=t.revenue);var u=new v(e,i,r,o,n);u=f.F(u);var c=f.V(),s=new l(u,c,-1);return h.updateSessionId(S(),s),h.updateSessionIndex(S(),s),s},f._updateBaseMapAndMaybeDedupe=function(t){for(var n=0;n<t.length;n++)t[n].eventBase=f.F(t[n].eventBase);return t},f.C=function(t){var n=f.B(t);s.persistBehaviorEvents(n)},f.N=function(t){var n=f.B(t);s.persistBehaviorEventQueue(n)},f.q=function(){var t;m.getCleared()||(w([]),b([]),f.C(I()),f.N(T()),y({}),E(null),t=!0,u.dispatch(r.UPDATE_BEHAVIOR_STORE,{key:"cleared",value:t}))},f.F=function(t){var n=t.hash(),e=A(),r=e[n];if(i.isUndefined(r))return e[n]=[t],y(e),t;for(var o=0;o<r.length;o++)if(t.equals(r[o]))return r[o];return r.push(t),y(e),t},f.L=function(){var t=[],n=A();for(var e in n)!n.hasOwnProperty(e)||(t=t.concat(n[e]));return t},f.B=function(t){for(var n=function(t){var n={};n[d.FIELDS.NAME]=t.getValueOrDefault([d.FIELDS.NAME]),n[d.FIELDS.TYPE]=t.getValueOrDefault([d.FIELDS.TYPE]);var e=t.getValueOrDefault([d.FIELDS.CATEGORY]);i.isUndefined(e)||(n[d.FIELDS.CATEGORY]=e);var r=t.getValueOrDefault([d.FIELDS.REVENUE]);i.isUndefined(r)||(n[d.FIELDS.REVENUE]=r);var o=t.getValueOrDefault([d.FIELDS.OPTIONS]);return i.isUndefined(o)||(n[d.FIELDS.OPTIONS]=o),n},e=_,r=[],o="_idx_",a=0;a<t.length;a++){var u,c,s=t[a],f=s.eventBase;if(f.hasOwnProperty(o)){u=r[f._idx_];var l=s[d.FIELDS.TIME]-(u[e.TIMEBASE]||0);(c={})[e.DELTA]=l,c[e.INDEX]=a,u[e.TIMESTAMPS].push(c)}else(u={})[e.EVENTBASE]=n(s),u[e.HASH]=f.hash(),u[e.TIMEBASE]=s[d.FIELDS.TIME],(c={})[e.DELTA]=0,c[e.INDEX]=a,u[e.TIMESTAMPS]=[c],r.push(u),f._idx_=r.length-1}for(a=0;a<t.length;a++)delete t[a].eventBase._idx_;return r},f.P=function(t,n){var e=new v(t[d.FIELDS.NAME],t[d.FIELDS.TYPE],t[d.FIELDS.CATEGORY],t[d.FIELDS.OPTIONS],t[d.FIELDS.REVENUE]);return i.isUndefined(n)||e.setHash(n),e},f.O=function(t){for(var n=_,e=[],i=0;i<t.length;i++)for(var r=t[i],o=f.P(r[n.EVENTBASE],r[n.HASH]),a=r[n.TIMEBASE],u=r[n.TIMESTAMPS],c=0;c<u.length;c++){var s=u[c],d=new l(o,a+s[n.DELTA]);e[s[n.INDEX]]=d}return e},n.deserialize=function(t){return f.O(t)},n.mergeAllEvents=function(t){var n=[].concat.apply([],t);return n.sort(h.sessionSortPredicate),h.sessionize(n),n}},9590:function(t,n,e){var i=e(4204);t.exports=i({LOG:null,SET_LOGLEVEL:null,INITIALIZE_STATE:null,SET_DOMCONTENTLOADED:null,ACTIVATE:null,UPDATE_BEHAVIOR_STORE:null,DATA_LOADED:null,SET_CLIENT_NAME:null,SET_CLIENT_VERSION:null,LOAD_PERSISTED_LAYER_STATES:null,RECORD_GLOBAL_DECISION:null,RECORD_LAYER_DECISION:null,ENSURE_ORIGINAL_PUSHSTATE:null,ENSURE_ORIGINAL_REPLACESTATE:null,SET_VISITOR_ATTRIBUTES:null,SET_VISITOR_ATTRIBUTE_PENDING:null,LOAD_EXISTING_VISITOR_PROFILE:null,SET_VISITOR_EVENTS:null,SET_FOREIGN_VISITOR_EVENTS:null,SET_FOREIGN_VISITOR_EVENT_QUEUE:null,SET_VISITOR_ID:null,SET_VISITOR_ID_VIA_API:null,SET_GA4_USER_ID:null,REFRESH_SESSION:null,LOAD_SESSION_STATE:null,UPDATE_VARIATION_ID_MAP:null,MERGE_VARIATION_ID_MAP:null,UPDATE_PREFERRED_LAYER_MAP:null,MERGE_PREFERRED_LAYER_MAP:null,UPDATE_CONTEXTUAL_MAB_MAP:null,MERGE_CONTEXTUAL_MAB_MAP:null,RECORD_LAYER_DECISION_EVENT_ID:null,TRACK_VIEW_ACTIVATED_EVENT:null,REGISTER_ASYNC_DEFERRED:null,RESOLVE_DEFERRED:null,REJECT_DEFERRED:null,REGISTER_PLUGIN:null,ADD_CLEANUP_FN:null,CLEAR_CLEANUP_FN:null,ACTION_EXECUTED:null,REGISTER_ACTION:null,SET_VIEW_ACTIVE_STATE:null,UPDATE_PARSED_VIEW_METADATA:null,UPDATE_USER_SUPPLIED_METADATA:null,REGISTER_VIEWS:null,SET_GLOBAL_TAGS:null,SET_VIEW_BATCHING:null,RESET_VIEW_STATES:null,ATTACH_EVENT_STREAM_PUBLISHERS:null,DETACH_EVENT_STREAM_PUBLISHERS:null,LOAD_DIRECTIVE:null,SET_COOKIE_AGE:null,SET_COOKIE_DOMAIN:null,SET_COOKIE_AUTO_REFRESH:null,XDOMAIN_SET_DEFAULT_FRAME:null,XDOMAIN_ADD_FRAME:null,XDOMAIN_SET_MESSAGE:null,XDOMAIN_ADD_SUBSCRIBER:null,XDOMAIN_SET_CANONICAL_ORIGINS:null,XDOMAIN_SET_DISABLED:null,ADD_EMITTER_HANDLER:null,REMOVE_EMITTER_HANDLER:null,SET_INTEGRATION_SETTINGS:null,ADD_CHANGE:null,SET_CHANGE_APPLIER:null,REMOVE_ACTION_STATE:null,ANNOUNCE_PENDING_REDIRECT:null,LOAD_REDIRECT_DATA:null,REGISTER_TRACKED_REDIRECT_DATA:null,SET_PENDING_EVENT:null,REMOVE_PENDING_EVENT:null,LOAD_PENDING_EVENTS:null,SANDBOXED_FUNCTIONS_ADDED:null,SET_RUM_DATA:null,RECORD_API_USAGE:null,INITIALIZE_CHANGE_METRICS:null,RECORD_ACTIVATION_TYPE_USAGE:null,RECORD_AUDIENCE_USAGE:null,RECORD_CHANGE_MACROTASK_RATE:null,RECORD_CHANGE_OVERHEATED:null,RECORD_CHANGE_TYPE_USAGE:null,RECORD_DOM_OBSERVATION_OCCURENCE:null,RECORD_INTEGRATION_USAGE:null,RECORD_LAYER_FEATURE_USAGE:null,RECORD_LAYER_POLICY_USAGE:null,RECORD_RECOMMENDATIONS_USAGE:null,RECORD_VIEW_FEATURE_USAGE:null,RECORD_VIEWS_INITIALLY_ACTIVATED_COUNT:null,RECORD_VISITOR_ID_LOCATOR_USAGE:null,RECORD_VISITOR_ID_ERROR:null,RECORD_STICKY_BUCKETING_FEATURE:null,SET_PERFORMANCE_MARKS_DATA:null,FINALIZE_BATCH_SNAPSHOT:null,REGISTER_PREVIOUS_BATCH:null,REGISTER_TRACKER_VISITOR:null,REGISTER_TRACKER_EVENT:null,REGISTER_TRACKER_DECISION:null,RESET_TRACKER_EVENTS:null,RESET_TRACKER_PREVIOUS_BATCHES:null,RESET_TRACKER_STORE:null,SET_TRACKER_POLLING:null,SET_TRACKER_BATCHING:null,SET_TRACKER_SEND_EVENTS:null,SET_TRACKER_PERSISTABLE_STATE:null,SET_TRACKER_DIRTY:null,UPDATE_TRACKER_VISITOR_ATTRIBUTES:null,SET_UA_DATA:null})},8738:function(t,n,e){var i=e(4816),r=e(4204);n.COOKIES={OPT_OUT:"optimizelyOptOut",PREVIEW:"optimizelyPreview",REDIRECT:"optimizelyRedirectData",SESSION_STATE:"optimizelySessionState",TOKEN:"optimizelyToken",VISITOR_ID:"optimizelyEndUserId",VISITOR_UUID:"optimizelyPPID"},n.LayerActivationTypes={CONDITIONAL:"conditional",IMMEDIATE:"immediate",MANUAL:"manual",READY:"ready",TIMEOUT:"timeout"},n.LogLevel={OFF:0,ERROR:1,WARN:2,INFO:3,DEBUG:4},n.Lifecycle=r({preActivate:null,postVisitorProfileLoad:null,postViewsActivated:null,postActivate:null}),n.ViewActivationTypes={immediate:"immediate",manual:"manual",callback:"callback",polling:"polling",URLChanged:"url_changed",DOMChanged:"dom_changed"},n.StorageKeys={PENDING_EVENTS:"pending_events",RELAYED_EVENTS:"relayed_events"},n.PluginTypes=r({visitorProfileProviders:null,viewProviders:null,audienceMatchers:null,viewMatchers:null,analyticsTrackers:null,viewTagLocators:null,userFeatureDefs:null,apiModules:null,changeAppliers:null,deciders:null,eventImplementations:null,viewTriggers:null}),n.ResourceTimingAttributes=r({connectStart:null,connectEnd:null,decodedBodySize:null,domainLookupStart:null,domainLookupEnd:null,duration:null,encodedBodySize:null,fetchStart:null,requestStart:null,responseStart:null,responseEnd:null,secureConnectionStart:null,startTime:null,transferSize:null,serverTiming:null}),n.RUMPerformanceTimingAttributes=r({blockTime:null}),n.AttributionTypes=r({FIRST_TOUCH:null,LAST_TOUCH:null}),n.SandboxedFunctions=r({XMLHttpRequest:null}),n.PerformanceData=r({performance_marks:null,resource_timing:null,performance_timing:null}),n.PerformanceCounters=r({mutation_observer_invocation:null,polling_invocation:null,match_selector_invocation:null}),n.VisitorStorageKeys={EVENTS:"events",EVENT_QUEUE:"event_queue",LAYER_MAP:"layer_map",LAYER_STATES:"layer_states",SESSION_STATE:"session_state",VISITOR_PROFILE:"visitor_profile",VARIATION_MAP:"variation_map",TRACKER_OPTIMIZELY:"tracker_optimizely",CONTEXTUAL_MAB:"contextual_mab"},n.AllStorageKeys=i.assign({},n.StorageKeys,n.VisitorStorageKeys),n.ListTargetingKeyTypes={COOKIE:"c",QUERY:"q",JS_VARIABLE:"j"},n.VisitorIdLocatorType={COOKIE:"cookie",JS_VARIABLE:"js",LOCALSTORAGE:"localStorage",QUERY:"query"},n.AllocationPolicyEnum={CMAB:"contextual-multi-arm-bandit",MIN_REGRET:"min-regret",MIN_TIME:"min-time",MANUAL:"manual"}},6518:function(t){t.exports={OTHER:"other"}},4141:function(t,n){n.TYPES={ACTION:"action",ANALYTICS:"analytics",EDITOR:"editor",LIFECYCLE:"lifecycle"}},6787:function(t){t.exports={CLICK:"click",CUSTOM:"custom",ENGAGEMENT:"engagement",PAGEVIEW:"pageview"}},1346:function(t,n,e){var i=e(4204);n.TrackLayerDecisionTimingFlags=i({preRedirectPolicy:null,postRedirectPolicy:null,nonRedirectPolicy:null}),n.PreRedirectPolicies=i({PERSIST_BEFORE_AND_TRACK_DURING_REDIRECT:null,PERSIST_BEFORE_REDIRECT:null}),n.PostRedirectPolicies=i({TRACK_IMMEDIATELY:null,TRACK_AFTER_SYNC:null}),n.NonRedirectPolicies=i({TRACK_IMMEDIATELY:null}),n.RedirectRelayMedia=i({COOKIE:null})},6618:function(t,n,e){var i=e(984),r=n.TOTAL_POINTS=1e4;n.bucketingNumber=function(t,n,e){return i.hashToInt(t+n,e,r)},n.isHoldback=function(t,e){return n.bucketingNumber(t,e.id,i.Seed.IGNORING)<(e.holdback||0)},n.chooseWeightedCandidate=function(t,e,r){for(var o=n.bucketingNumber(t,e,i.Seed.BUCKETING),a=0;a<r.length;a++)if(r[a].endOfRange>o)return r[a].entityId;throw new Error("Unable to choose candidate")}},2032:function(t,n,e){var i=e(4816),r=e(9590),o=e(6618),a=e(5175),u=e(4719).E,c=e(349),s=e(7936),f=e(468);n.isValidExperiment=function(t,n){var e,r=i.partial(i.includes,t);return s.groupCollapsed("Decision / Evaluating audiences for experiment:",n,t),e=!n.audienceIds||a.evaluate(n.audienceIds,r),s.groupEnd(),s.debug("Decision / Experiment",n,"is valid?",e),e},n.selectVariation=function(t,n,e,a,l){if(s.debug("Decision / Selecting variation for experiment:",t.id),!t.variations||0===t.variations.length)throw new u('No variations in selected experiment "'+t.id+'"');if(!t.weightDistributions&&t.variations.length>1)throw new u('On selected experiment "'+t.id+'", weightDistributions must be defined if # variations > 1');var d;if(t.bucketingStrategy&&"impression"===t.bucketingStrategy)if(1===t.variations.length)d=t.variations[0].id;else{var v=a;d=o.chooseWeightedCandidate(e+v,t.id,t.weightDistributions)}else if(d=1===t.variations.length?t.variations[0].id:o.chooseWeightedCandidate(e,t.id,t.weightDistributions),l&&l[t.id]){s.debug("Decision / Using preferredVariationMap to select variation for experiment:",t.id);var h=l[t.id];if(!i.find(t.variations,{id:h}))return c.dispatch(r.RECORD_STICKY_BUCKETING_FEATURE,{feature:"stoppedVariation",id:t.id}),s.debug("Decision / Preferred variation:",h,"not found on experiment:",t.id,". Visitor not bucketed."),null;h!==d&&(c.dispatch(r.RECORD_STICKY_BUCKETING_FEATURE,{feature:"preferredVariation",id:t.id}),d=h)}var p=f.processCmabExperiment(t,d);p&&(d=p);var g=i.find(t.variations,{id:d});if(g)return s.debug("Decision / Selected variation:",g),g;throw new u('Unable to find selected variation: "'+d+'".')},n.getExperimentById=function(t,n){var e=i.find(t.experiments,{id:n});if(e)return e;throw new u("Unable to find selected experiment.")},n.hasVariationActionsOnView=function(t,n){return s.debug("Decision / Checking variation:",t,"for actions on pageId:",n),!!i.find(t.actions,(function(t){return t.pageId===n&&!i.isEmpty(t.changes)}))}},4719:function(t,n){function e(t){this.message=t}e.prototype=new Error,n.E=e},947:function(t,n,e){var i=e(4816),r=e(9590),o=e(4248),a=e(4036),u=e(6618),c=e(2032),s=e(4719).E,f=e(9932),l=e(8738),d=e(349),v=e(1194),h=e(5508),p=e(7936),g=e(3008),m=f.get("stores/plugins"),_=f.get("stores/global"),w=f.get("stores/layer_data");function y(t){var n=m.getPlugin(l.PluginTypes.deciders,t);if(i.isEmpty(n))throw new Error("No deciders found for policy: "+t);return n}n.isPageIdRelevant=function(t){if(!t)return!1;var n=y(t.policy);return i.isFunction(n.includePageIdInDecisionTicket)?n.includePageIdInDecisionTicket(t):!0===n.includePageIdInDecisionTicket},n.createTicket=function(t){var n,e,r,o=i.pick(t,["bucketingId","globalHoldback","preferredVariationMap","pageId"]);return i.extend(o,{audienceIds:(n=t.visitorProfile,e=t.audiences,r=m.getAllPlugins(l.PluginTypes.audienceMatchers),i.reduce(e,(function(t,e){return a.isInAudience(n,e,r)&&t.push(e.id),t}),[])),activationId:_.getActivationId()}),o},n.decideGlobal=function(t){return{isGlobalHoldback:u.isHoldback(t.bucketingId,{id:null,holdback:t.globalHoldback})}},n.decideGroup=function(t,n){p.debug("Decision / Deciding layer for group: ",v.description(t));var e,o,a=n.preferredLayerId,c=!!a;try{(e=u.chooseWeightedCandidate(n.bucketingId,t.id,t.weightDistributions))&&"None"!==e||(o='Group traffic allocation. Visitor maps to a "hole" in the bucket space left by an experiment or campaign that\'s since been removed from the group')}catch(l){o="Group traffic allocation. Visitor maps to a point in the bucket space which has never been covered by any experiment or campaign."}if(c&&(p.debug("Decision / Using preferredLayerMap to select layer for group:",v.description(t)),a!==e&&(d.dispatch(r.RECORD_STICKY_BUCKETING_FEATURE,{feature:"preferredLayer",id:t.id}),e=a)),o)return{layerId:null,reason:o};if(!i.find(t.weightDistributions,{entityId:e})){var f="Visitor was"+(c?" sticky-":" non-sticky ")+"bucketed into a campaign ("+e+") which is not in the group";if(!c)throw new s(f);return{layerId:null,reason:f}}return{layerId:e}},n.decideLayer=function(t,n){var e,r;p.debug("Deciding: ",t,n);var a,f,l=y(t.policy),d={layerId:t.id,experimentId:null,variationId:null,isLayerHoldback:u.isHoldback(n.bucketingId,t)};if(i.isEmpty(t.experiments))throw new s("No experiments in layer.");try{if(l.decideLayer){p.debug("Decision / Using decider's custom decideLayer.");var v=l.decideLayer(t,n);e=v.experiment,r=v.variation}else p.debug("Decision / Using default decideLayer behavior."),e=l.selectExperiment(t,n.audienceIds,n.bucketingId),r=c.selectVariation(e,n.audienceIds,n.bucketingId,n.activationId,n.preferredVariationMap)}catch(h){a=h,(null!=(f=s)&&"undefined"!=typeof Symbol&&f[Symbol.hasInstance]?f[Symbol.hasInstance](a):a instanceof f)?d.reason=h.message:d.error=h}return d.experimentId=e?e.id:null,d.variationId=r?r.id:null,d.error&&(d.error.name="DecisionEngineError",o.emitError(d.error)),d},n.getDummyLayerDecision=function(t,n){var e,i=function(t,n){for(var e=0;e<t.experiments.length;e++)for(var i=0;i<t.experiments[e].variations.length;i++)if(n.indexOf(t.experiments[e].variations[i].id)>-1)return{experimentId:t.experiments[e].id,variationId:t.experiments[e].variations[i].id};return null}(t,n);return i?(p.log("Decision / Applying force variation:",i.variationId,"to Campaign",h.description(t)),e={layerId:t.id,variationId:i.variationId,experimentId:i.experimentId,isLayerHoldback:!1,reason:"force"}):(p.log("No variation matches ids:",n,"in Campaign",h.description(t)),e={layerId:t.id,variationId:null,experimentId:null,isLayerHoldback:!1,reason:"force"}),e},n.isInCohort=function(t){if(!t.experimentId||!t.variationId)return!1;var n=w.get(t.layerId);return!(g.isSingleExperimentPolicy(n.policy)&&t.isLayerHoldback)}},9932:function(t,n,e){var i=e(4816),r=e(7521),o=e(349),a=e(8616),u=r.create(),c={action_data:e(6541),async_request:e(9289),audience_data:e(9819),change_data:e(7525),cleanup:e(5518),client_metadata:e(2405),cookie_options:e(8176),event_data:e(8622),event_emitter:e(6841),dimension_data:e(325),directive:e(5973),global:e(5394),history:e(34),integration_settings:e(8726),layer:e(3974),layer_data:e(6346),log:e(9985),observed_redirect:e(3712),pending_events:e(3312),performance:e(1546),plugins:e(8692),provider_status:e(9147),pending_redirect:e(2856),rum:e(4182),sandbox:e(4544),session:e(9149),tracker_optimizely:e(1440),ua_data:e(7460),view:e(8892),view_data:e(1969),visitor:e(4264),visitor_attribute_entity:e(2676),visitor_events:e(310),visitor_events_manager:e(4685),visitor_id:e(275),visitor_bucketing:e(9092),xdomain:e(3666)};c.group_data=e(2275),o.registerStores(c),i.forOwn(c,(function(t,n){u.register("stores/"+n,o.getStore(n))})),u.register("core/plugins/matchers/key_value",a),t.exports=u},7357:function(t,n,e){var i=e(4816),r=e(9590),o=e(4248),a=e(7690),u=e(8064).U,c=e(8738),s=e(349),f=e(7936),l=n.JSONParseError=u("JSONParseError"),d=e(7266),v=e(9505),h=e(5343),p="optimizely_show_preview",g="optimizely_disable",m="optimizely_editor",_="optimizely_p13n",w="optimizely_x_audiences",y="optimizely_x",b="optimizely_show_preview",E="optimizely_opt_out",I="optimizely_token",A="optimizely_force_tracking";n.populateDirectiveData=function(){var t,n,e,u,T,S,k,R;!function(){var t="OFF",n=d.getQueryParamValue("optimizely_log");if(n){var e=n.split(":");""!==e[0]&&(t=String(e[0]).toUpperCase()),void 0!==e[1]&&f.setLogMatch(e[1])}f.setLogLevel(t)}(),function(){var t=h.getUserAgent()||"";if(!i.isString(t))return void f.warn("Directive / userAgent not a string");t=t.toLowerCase();var n=["googlebot","yahoo! slurp","bingbot","bingpreview","msnbot","keynote","ktxn","khte","gomezagent","alertsite","yottaamonitor","pingdom.com_bot","aihitbot","baiduspider","adsbot-google","mediapartners-google","applebot","catchpoint","phantomjs","moatbot","facebookexternalhit"],e=function(n){if(i.includes(t,n))return f.warn("Directive / Matches bot:",n),!0};i.some(n,e)&&(f.log("Directive / Disabling tracking"),s.dispatch(r.LOAD_DIRECTIVE,{trackingDisabled:!0}))}(),t=Boolean(i.result(window.optimizely,"initialized")),s.dispatch(r.LOAD_DIRECTIVE,{alreadyInitialized:t}),s.dispatch(r.LOAD_DIRECTIVE,{mutationObserverAPISupported:h.isMutationObserverAPISupported()}),function(){var t=a.get(c.COOKIES.OPT_OUT),n=d.getQueryParamValue(E),e="You have successfully opted out of Optimizely for this domain.",i="You are NOT opted out of Optimizely for this domain.";if("true"===n||"false"===n){var o="true"===n;s.dispatch(r.LOAD_DIRECTIVE,{shouldOptOut:o}),h.alert(o?e:i)}else t&&s.dispatch(r.LOAD_DIRECTIVE,{shouldOptOut:"true"===t})}(),function(){var t=!1,n=[p,g];n.push(m);for(var e=0;e<n.length;e++)if("true"===d.getQueryParamValue(n[e])){f.warn("Directive / Not activating because "+n[e]+" is set."),t=!0;break}s.dispatch(r.LOAD_DIRECTIVE,{disabled:t})}(),s.dispatch(r.LOAD_DIRECTIVE,{isEditor:!1}),s.dispatch(r.LOAD_DIRECTIVE,{isPreview:!1}),(n=d.getQueryParamValue(b))&&f.log("Directive / Is legacy preview mode"),s.dispatch(r.LOAD_DIRECTIVE,{isLegacyPreview:!!n}),s.dispatch(r.LOAD_DIRECTIVE,{isSlave:!1}),e=h.getGlobal("optlyDesktop"),(u=!(!e||i.isUndefined(e.p13nInner)))&&f.log("Directive / Is running in desktop app editor"),s.dispatch(r.LOAD_DIRECTIVE,{isRunningInDesktopApp:u}),(T="true"===d.getQueryParamValue(_))&&f.log("Directive / Is running in editor"),s.dispatch(r.LOAD_DIRECTIVE,{isRunningInV2Editor:T}),S=a.get(c.COOKIES.TOKEN)||null,k=d.getQueryParamValue(I)||S,s.dispatch(r.LOAD_DIRECTIVE,{projectToken:k}),function(){var t=a.get(c.COOKIES.PREVIEW),n=[],e=d.getQueryParamValue(w);if(e)n=a.safeDecodeURIComponent(e).split(",");else if(t)try{n=v.parse(t).forceAudienceIds}catch(h){var i=new l("Failed to parse previewCookie in registerForceAudienceIds: "+t),u={originalMessage:h.message,userError:!0};o.emitError(i,u)}n.length&&(f.log("Directive / Force Audience IDs:",n),s.dispatch(r.LOAD_DIRECTIVE,{forceAudienceIds:n}))}(),function(){var t=a.get(c.COOKIES.PREVIEW),n=[],e=d.getQueryParamValue(y);if(e)n=a.safeDecodeURIComponent(e).split(",");else if(t)try{n=v.parse(t).forceVariationIds}catch(h){var i=new l("Failed to parse previewCookie in registerForceVariationIds: "+t),u={originalMessage:h.message,userError:!0};o.emitError(i,u)}n.length&&(f.log("Directive / Force Variation IDs:",n),s.dispatch(r.LOAD_DIRECTIVE,{forceVariationIds:n}))}(),(R=d.getQueryParamValue(A))&&s.dispatch(r.LOAD_DIRECTIVE,{forceTracking:R})};n.setOptOut=function(t){t?(f.warn("Directive / Opting out"),a.set(c.COOKIES.OPT_OUT,"true",{maxAge:31536e4},!0)):a.remove(c.COOKIES.OPT_OUT),s.dispatch(r.LOAD_DIRECTIVE,{shouldOptOut:t})}},8701:function(t,n){n.now=function(){return+new Date}},6637:function(t,n){n.VERSION="0.214.0",n.NAME="js"},8416:function(t,n,e){var i=e(9932).get("stores/global");n.getDocumentElement=function(){return document.documentElement},n.getCookieString=function(){return document.cookie||""},n.setCookie=function(t){document.cookie=t},n.querySelector=function(t){return document.querySelector(t)},n.querySelectorAll=function(t){return document.querySelectorAll(t)},n.parseUri=function(t){var e=n.createElement("a");return e.href=t,e},n.childrenOf=function(t){return Array.prototype.slice.call(t.querySelectorAll("*"))},n.createElement=function(t){return document.createElement(t)},n.isReady=function(){return i.domContentLoadedHasFired()||"interactive"===document.readyState||"complete"===document.readyState},n.isLoaded=function(){return"complete"===document.readyState},n.addReadyHandler=function(t){return document.addEventListener("DOMContentLoaded",t),function(){n.removeReadyHandler(t)}},n.removeReadyHandler=function(t){return function(){document.removeEventListener("DOMContentLoaded",t)}},n.getReferrer=function(){return document.referrer},n.getReadyState=function(){return document.readyState},n.write=function(t){if("loading"!==n.getReadyState())throw new Error("Aborting attempt to write to already-loaded document");document.write(t)},n.appendToHead=function(t){return n.appendTo(document.head,t)},n.appendTo=function(t,n){t.appendChild(n)},n.addEventListener=function(t,n,e){return document.addEventListener(t,n,e),function(){document.removeEventListener(t,n,e)}},n.getCurrentScript=function(){if(document.currentScript)return document.currentScript},n.parentElement=function(t){for(var n=t.parentNode;n.nodeType!==Node.ELEMENT_NODE;)n=n.parentNode;return n}},871:function(t,n,e){var i,r,o="optimizely_data",a=e(8064).U,u=e(7409),c=e(5343),s=a("StorageError");try{r=c.getGlobal("localStorage")}catch(f){throw new s("Unable to read localStorage: "+f.toString())}if(!r)throw new s("localStorage is undefined");i=u.create(r,o),n.mM=i},6556:function(t,n){n.create=function(t){return new MutationObserver(t)},n.observe=function(t,n,e){t.observe(n,e)}},2107:function(t,n,e){var i=e(212).Promise,r=e(5343);n.estimateStorage=function(){var t=r.getGlobal("navigator");try{return t.storage.estimate()}catch(n){return i.resolve({usage:null,quota:null})}}},2899:function(t,n,e){var i=e(9590),r=e(8064).U,o=e(8701),a=e(349),u=e(5343),c=e(9932).get("stores/rum"),s="optimizely:",f=n.Error=r("PerformanceError");function l(){return u.getGlobal("performance")}n.time=function(t){if(c.getSampleRum()){var n=l();if(n&&n.mark){var e=s+t;n.clearMarks(e+"Begin"),n.mark(e+"Begin")}}},n.timeEnd=function(t){if(c.getSampleRum()){var n=l();if(n&&n.mark){var e=s+t,r=n.getEntriesByName(e+"Begin");if(0===r.length)throw new f("Called timeEnd without matching time: "+t);n.clearMarks(e+"End"),n.mark(e+"End");var o=t+"Time",u=n.getEntriesByName(e+"End")[0].startTime-r[0].startTime;a.dispatch(i.SET_PERFORMANCE_MARKS_DATA,{name:o,data:{startTime:Math.round(1e3*r[0].startTime)/1e3,duration:Math.round(1e3*u)/1e3}})}}},n.setMark=function(t,n,e){if(c.getSampleRum()){var r=l();if(r&&r.mark){var o=s+t;r.mark(o),a.dispatch(i.SET_PERFORMANCE_MARKS_DATA,{name:t,data:{startTime:Math.round(1e3*n)/1e3,duration:Math.round(1e3*e)/1e3}})}}},n.now=function(){var t=l();return t?t.now():o.now()}},5343:function(t,n,e){var i=e(4816),r=e(7936);n.getUserAgent=function(){return window.navigator.userAgent},n.getLocationSearch=function(){return window.location.search},n.getNavigatorLanguage=function(){return window.navigator.language||window.navigator.userLanguage},n.getHref=function(){return window.location.href},n.getLocation=function(){return window.location},n.setLocation=function(t){window.location.replace(t)},n.setGlobal=function(t,n){window[t]=n},n.getGlobal=function(t){return window[t]},n.getGlobalByPath=function(t){for(var n=t.split("."),e=window;n.length;)try{e=e[n.shift()]}catch(i){throw r.error("Attempted to access nonexistent property. Path ",t),new Error("Attempted to access nonexistent property. Path "+t)}return e},n.addEventListener=function(){return window.addEventListener.apply(window,arguments)},n.removeEventListener=function(){return window.removeEventListener.apply(window,arguments)},n.isMutationObserverAPISupported=function(){return!i.isUndefined(window.MutationObserver)},n.alert=function(t){alert(t)},n.setTimeout=function(t,n){return setTimeout((function(){try{t()}catch(n){r.warn("Deferred function threw error:",n)}}),n)},n.setInterval=function(t,n){return setInterval((function(){try{t()}catch(n){r.warn("Polling function threw error:",n)}}),n)}},6611:function(t,n,e){var i=e(4816);n.create=function(t,n,e,r){return i.extend({category:"other"},r,{id:t,apiName:n,eventType:e})}},8120:function(t,n,e){var i=e(4816),r=e(7276),o=e(9590),a=e(4248),u=e(9932),c=e(349),s=e(7936),f=u.get("stores/event_emitter");n.on=function(t){return t.token||(t.token=r.generate()),c.dispatch(o.ADD_EMITTER_HANDLER,t),t.token},n.off=function(t){c.dispatch(o.REMOVE_EMITTER_HANDLER,{token:t})},n.emit=function(t,n,e){var r=f.getHandlers(t,n);i.each(r,(function(i){try{i.handler.call({$di:u},t)}catch(r){!e&&i.emitErrors?(s.error("Error in handler for event:",t,r),a.emitError(r,null,n)):s.warn("Suppressed error in handler for event:",t,r)}}))}},6732:function(t,n,e){var i=e(8120);n.on=function(t){return t.publicOnly=!0,i.on(t)},n.off=i.off,n.emit=function(t){i.emit(t)}},1284:function(__unused_webpack_module,exports,__webpack_require__){var createError=__webpack_require__(8397),di=__webpack_require__(9932),Logger=__webpack_require__(7936),CSP_MODE=!1,EXEC_WITH_JQUERY=!0,ExecError=exports.Error=createError("ExecError");exports.apply=function(t,n){n=n||[],EXEC_WITH_JQUERY&&(n=n.concat(di.get("env/jquery")));try{return t.apply(void 0,n)}catch(e){throw Logger.warn("Error applying function",t,"with args:",n,e),new ExecError(e)}},exports.eval=function(str){if(CSP_MODE)throw new ExecError("eval is not supported in CSP mode");try{return EXEC_WITH_JQUERY&&(str="var $ = optimizely.get('jquery');"+str),eval(str)}catch(e){throw Logger.warn("Error executing JS:",str,e),new ExecError(e)}}},349:function(t,n,e){var i=e(9093);t.exports=i.create()},1194:function(t,n,e){var i=e(4816);n.description=function(t){var n=!!t.name?'"'+t.name+'" ':"",e=function(t){return i.map(t.weightDistributions,"entityId")}(t).join(", ");return n+"(id "+t.id+", campaigns: "+e+")"}},5508:function(t,n,e){var i=e(4816),r=e(9590),o=e(8701),a=e(9932),u=e(349),c=a.get("stores/global"),s=a.get("stores/session");n.recordLayerDecision=function(t,n,e){return u.dispatch(r.RECORD_LAYER_DECISION,{layerId:t,decision:e,decisionTicket:n,sessionId:s.getSessionId(),activationId:c.getActivationId(),timestamp:o.now(),revision:c.getRevision(),namespace:c.getNamespace(),pageId:n.pageId}),e},n.relatedAudienceIds=function(t){var n={},e=["and","or","not"];return i.each(t.experiments,(function(t){i.each(i.flattenDeep(t.audienceIds),(function(t){i.includes(e,t)||(n[t]=!0)}))})),i.keys(n)},n.getActivationTimeout=function(t){var n=t.activation;return n&&null!==n.timeout&&void 0!==n.timeout?n.timeout:2e3},n.description=function(t){return(t.name?'"'+t.name+'" ':"")+"("+t.id+")"},n.createSingle=function(t,n,e){return{id:t,policy:"single_experiment",holdback:0,experiments:[{id:n||"",variations:[{id:e||"",actions:[]}],audienceIds:[]}],integrationStringVersion:1}},n.createLayerState=function(t,n,e,i){return void 0===i&&(i=!1),{layerId:t,decision:{layerId:t,experimentId:n,variationId:e,isLayerHoldback:i||!1},decisionTicket:{audienceIds:[]}}},n.getIntegrationTypes=function(t){return i.keys(i.reduce(i.keys(t.integrationSettings),(function(t,n){return i.isNaN(Number(n))||(n="custom"),t[n]=1,t}),{}))}},9352:function(t,n,e){var i=e(4816);n.y=function(t,n){if(!n)return 0;for(var e=n.toString().split("."),r=t.toString().split("."),o=0;o<e.length;o++){if(i.isUndefined(r[o]))return-1;if(isNaN(Number(r[o]))){if(r[o]!==e[o])return-1}else{if(Number(r[o])<Number(e[o]))return-1;if(Number(r[o])>Number(e[o]))return 1}}return 0}},5175:function(t,n,e){var i=e(4816),r=e(9505),o=e(7936),a="or",u="not";var c={};function s(t,n){var e;if(i.isArray(t)){var u,s;t[0]in c?(u=t[0],s=t.slice(1)):(u=a,s=t),o.groupCollapsed('Condition / Applying operator "'+u+'" with args',r.stringify(s));try{e=c[u](s,n),o.debug("Condition / Result:",e)}finally{o.groupEnd()}return e}return e=n(t),o.debug("Condition / Evaluated:",r.stringify(t),":",e),e}c["and"]=function(t,n){for(var e,r,o=0;o<t.length;o++){if(!1===(e=s(t[o],n)))return!1;i.isUndefined(e)&&(r=!0)}if(!r)return!0},c[a]=function(t,n){for(var e,r=!1,o=0;o<t.length;o++){if(!0===(e=s(t[o],n)))return!0;i.isUndefined(e)&&(r=!0)}if(!r)return!1},c[u]=function(t,n){if(1!==t.length)return!1;var e=s(t[0],n);return i.isUndefined(e)?void 0:!e},t.exports={evaluate:s}},2826:function(t,n,e){var i=e(4816),r=e(5251);function o(t){if((t=(t||"").toLowerCase())in c)return t;var n=i.keys(c);return i.find(n,(function(n){var e=c[n];return i.includes(e,t)}))||"unknown"}function a(t,n,e){return n||("unknown"===t?"unknown":e?"mobile":"desktop_laptop")}n.parseUA=function(t){var n=new r(t),e=n.getBrowser(),i=n.getOS(),c=n.getDevice(),f=(i.name||"unknown").toLowerCase(),l=(e.name||"unknown").toLowerCase(),d=u(c.type,l,f);return{browser:{id:o(e.name),version:e.version},platform:{name:f,version:i.version},device:{model:s[c.model]||"unknown",type:a(l,c.type,d),isMobile:d}}};var u=function(t,n,e){if(i.includes(["mobile","tablet"],t)||i.includes(["opera mini"],n))return!0;return!!i.includes(["android","blackberry","ios","windows phone"],e)},c={gc:["chrome","chromium","silk","yandex","maxthon","chrome webview"],edge:["edge"],ie:["internet explorer","iemobile"],ff:["firefox","iceweasel"],opera:["opera","opera mini","opera tablet"],safari:["safari","mobile safari","webkit"],ucbrowser:["uc browser"]},s={iPhone:"iphone",iPad:"ipad"}},7521:function(t,n,e){var i=e(4816);function r(){this.H={}}r.prototype.register=function(t,n){if(1!==arguments.length){if(this.H[t])throw new Error("Module already registered for: "+t);this.H[t]=n}else{var e=this;i.each(t,(function(t,n){e.register(n,t)}))}},r.prototype.get=function(t){return this.H[t]},r.prototype.getModuleKeys=function(){var t=this.H;return i.keys(t)},r.prototype.evaluate=function(t){var n=t.length,e=t.slice(0,n-1),r=t[n-1];if("function"!=typeof r)throw new Error("Evaluate must take a function as last element in array");var o=i.map(e,i.bind(this.get,this));return r.apply(null,o)},r.prototype.reset=function(){this.H={}},t.exports={create:function(){return new r}}},4323:function(t,n,e){var i=e(4816);function r(t,n,e){this.Y=t,this.$=n,this.K=0,this.W=!1,this.X={},i.extend(this,e),this.J={},this.initialize&&this.initialize()}r.prototype.Z=function(t,n){var e=this.X[t];e&&"function"==typeof e&&e.call(this,n,t)},r.prototype.tt=function(){return i.cloneDeep(this.J)},r.prototype.on=function(t,n){this.X[t]=i.bind(n,this)},r.prototype.observe=function(t){return this.$.nt(this.Y,t)},r.prototype.emitChange=function(){this.W=!0,this.K++},r.prototype.hasChanges=function(){return this.W},r.prototype.resetChange=function(){this.W=!1},r.prototype.getStateId=function(){return this.K},r.prototype.et=function(){this.reset&&"function"==typeof this.reset&&this.reset(),this.initialize()},t.exports=r},9093:function(t,n,e){var i=e(4816),r=e(4323);function o(t){t=t||{},this.it={},this.rt={},this.ot=0,this.ut=[],this.ct=[]}function a(t,n){return function(){var e=t.indexOf(n);-1!==e&&t.splice(e,1)}}o.prototype.registerStores=function(t){i.forOwn(t,i.bind((function(t,n){this.it[n]=new r(n,this,t)}),this))},o.prototype.getStore=function(t){return this.it[t]},o.prototype.dispatch=function(t,n){this.dispatchId++,i.each(this.ut,i.bind((function(e){e.call(this,t,n)}),this)),i.forOwn(this.it,(function(e){e.Z(t,n)})),i.each(this.ct,i.bind((function(e){e.call(this,t,n)}),this)),i.forOwn(this.it,i.bind((function(t,n){t.hasChanges()&&this.rt[n]&&(t.resetChange(),i.each(this.rt[n],(function(n){n(t)})))}),this))},o.prototype.reset=function(){this.rt={},i.forOwn(this.it,(function(t,n){t.et()}))},o.prototype.getState=function(){var t={};return i.forOwn(this.it,(function(n,e){t[e]=n.tt()})),t},o.prototype.onPreAction=function(t){var n=this.ut;return n.push(t),a(n,t)},o.prototype.onPostAction=function(t){var n=this.ct;return n.push(t),a(n,t)},o.prototype.nt=function(t,n){return this.rt[t]||(this.rt[t]=[]),this.rt[t].push(n),a(this.rt[t],n)},t.exports={create:function(t){return new o(t)}}},9505:function(t,n,e){var i=e(4816);function r(t){var n,e,r=[Array.prototype],o=[];i.each(r,(function(t){i.isUndefined(t.toJSON)||(o.push(t.toJSON),delete t.toJSON)}));try{n=t()}catch(a){e=a}finally{i.each(o,(function(t,n){r[n].toJSON=t}))}if(e)throw e;return n}n.stringify=function(){return r(i.bind((function(){return JSON.stringify.apply(null,this)}),arguments))},n.parse=JSON.parse},7049:function(t,n,e){var i=e(4816);n.hasMatch=function(t,n,e){var r=!i.isUndefined(e)&&null!==e,o=!i.isUndefined(t)&&null!==t;switch(n||(o?"exact":"exists")){case"exists":return r;case"exact":return r&&String(e)===t;case"substring":return r&&String(e).indexOf(t)>-1;case"regex":try{return!(!o||!r)&&new RegExp(t).test(String(e))}catch(f){}return!1;case"range":var a=t.split(":"),u=parseFloat(a[0]),c=parseFloat(a[1]),s=parseFloat(e);return s>=u&&s<=c;default:return!1}}},212:function(t,n,e){t.exports=e(9745)},7409:function(t,n,e){var i=e(4816),r=e(7936);function o(t,n){this.st=t,this.ft=n}o.prototype.dt=function(t){return[this.ft,t].join("$$")},o.prototype.vt=function(t){return t.replace(this.ft+"$$","")},o.prototype.setItem=function(t,n){try{this.st.setItem(this.dt(t),n)}catch(e){r.warn("Failed to save",t,"to localStorage:",e)}},o.prototype.removeItem=function(t){this.st.removeItem(this.dt(t))},o.prototype.getItem=function(t){var n=null;try{n=this.st.getItem(this.dt(t))}catch(e){}return n},o.prototype.keys=function(){var t=i.keys(this.st);return i.map(i.filter(t,i.bind((function(t){return i.includes(t,this.ft)}),this)),i.bind(this.vt,this))},o.prototype.allKeys=function(){return i.keys(this.st)},o.prototype.allValues=function(){return i.values(this.st)},t.exports={create:function(t,n){return new o(t,n)},mockStorage:{keys:function(){},getItem:function(t){},removeItem:function(t){},setItem:function(t,n){}}}},2773:function(t,n,e){var i=e(8416),r=e(8120),o=e(6556);n.createDOMChangedObserver=function(){var t=i.getDocumentElement(),n={type:"viewTrigger",name:"DOMChanged"},e=o.create((function(){r.emit(n,!0)}));o.observe(e,t,{attributes:!0,childList:!0,subtree:!0,characterData:!0})}},3294:function(t,n,e){var i=e(4816),r=e(4248),o=e(8738),a=e(9505),u=e(871).mM,c=e(7936),s=e(9895),f=e(9932).get("stores/pending_events"),l=o.StorageKeys.PENDING_EVENTS;n.persistPendingEvents=function(){try{var t=f.getEventsString();u.setItem(l,t),e(8340).setItem(l,t)}catch(n){c.warn("PendingEvents / Unable to set localStorage key, error was: ",n),r.emitInternalError(n)}},n.getPendingEvents=function(){try{return a.parse(u.getItem(l))}catch(t){return null}},n.retryPendingEvents=function(t){i.forOwn(t,(function(t,n){s.retryableRequest(t.data,n,t.retryCount)})),i.isEmpty(t)||c.log("Retried pending events: ",t)}},2121:function(t,n,e){var i=e(4816),r=e(9590),o=e(9932),a=e(8738),u=e(8120),c=e(349);n.registerApiModule=function(t,n){i.isArray(n)&&(n=o.evaluate(n)),c.dispatch(r.REGISTER_PLUGIN,{type:a.PluginTypes.apiModules,name:t,plugin:n})},n.registerDependency=function(t,n){o.get(t)||o.register(t,n)},n.registerVisitorProfileProvider=function(t){c.dispatch(r.REGISTER_PLUGIN,{type:a.PluginTypes.visitorProfileProviders,name:t.provides,plugin:t})},n.registerViewProvider=function(t){c.dispatch(r.REGISTER_PLUGIN,{type:a.PluginTypes.viewProviders,name:t.provides,plugin:t})},n.registerAudienceMatcher=function(t,n){c.dispatch(r.REGISTER_PLUGIN,{type:a.PluginTypes.audienceMatchers,name:t,plugin:n})},n.registerViewMatcher=function(t,n){c.dispatch(r.REGISTER_PLUGIN,{type:a.PluginTypes.viewMatchers,name:t,plugin:n})},n.registerAnalyticsTracker=function(t,n){c.dispatch(r.REGISTER_PLUGIN,{type:a.PluginTypes.analyticsTrackers,name:t,plugin:n})},n.registerViewTagLocator=function(t,n){c.dispatch(r.REGISTER_PLUGIN,{type:a.PluginTypes.viewTagLocators,name:t,plugin:n})},n.registerAudiencePlugin=function(t){t.dependencies&&i.each(t.dependencies,(function(t,e){n.registerDependency(e,t)}));var e,r,a="vendor."+t.vendor;e=i.isString(t.provider)?o.get(t.provider)(t.vendor):i.isFunction(t.provider)?t.provider(t.vendor):i.cloneDeep(t.provider),n.registerVisitorProfileProvider(i.extend(e,{provides:a})),r=i.isString(t.matcher)?o.get(t.matcher):t.matcher;var u={fieldsNeeded:[a],match:function(t,n){return r(t[a],n)}};n.registerAudienceMatcher(a,u)},n.registerWidget=function(t){return i.isArray(t)&&(t=o.evaluate(t)),{showToken:u.on({filter:{type:"showWidget",name:t.widgetId},handler:t.showFn}),hideToken:u.on({filter:{type:"hideWidget",name:t.widgetId},handler:t.hideFn})}},n.registerChangeApplier=function(t,n){c.dispatch(r.REGISTER_PLUGIN,{type:a.PluginTypes.changeAppliers,name:t,plugin:n})},n.registerDecider=function(t,n){c.dispatch(r.REGISTER_PLUGIN,{type:a.PluginTypes.deciders,name:t,plugin:n})},n.registerEventImplementation=function(t,n){c.dispatch(r.REGISTER_PLUGIN,{type:a.PluginTypes.eventImplementations,name:t,plugin:n})},n.registerViewTrigger=function(t,n){c.dispatch(r.REGISTER_PLUGIN,{type:a.PluginTypes.viewTriggers,name:t,plugin:n})}},8668:function(t,n,e){var i=e(4816),r=e(9932),o=":",a="holdback",u="treatment",c="",s=e(7936),f=e(3008);function l(t){return t.replace(/[^a-zA-Z0-9\.\~\!\*\(\)\']+/g,"_")}n.formatNamesAndIdsForAnalytics=function(t,n,e,o){var a={layer:t.name||c,experiment:n.name||c,variation:e.name||c};o&&(a=i.mapValues(a,l));var u,s=!t.integrationStringVersion||1===t.integrationStringVersion;if(a.experiment===c&&s)if(u=n.audienceIds,!i.isEmpty(u)&&i.includes(["and","or","not"],u[0]))a.experiment="Exp";else{var f=r.get("stores/audience_data");a.experiment=function(t,n){return i.isEmpty(n)?"everyone_else":i.reduce(n,(function(n,e){var i=t.get(e);return i?n+l(i.name?i.name:i.id)+",":n}),"").slice(0,-1)}(f,n.audienceIds)}return{names:a,idStrings:{layer:"("+l(t.id)+")",experiment:"("+l(n.id)+")",variation:"("+l(e.id)+")"}}},n.combineAndTruncateIdAndName=function(t,n,e){var i=e-n.length;if(i<0&&(s.warn("maxLength must be at least long enough to fit the entity ID, which is length"+n.length+". Defaulting to only use entity ID as name."),t=c),t===c)return n;if(t.length>i){var r=Math.min(t.length,i);return(t=t.substring(0,r))+n}return t+" "+n},n.generateAnalyticsString=function(t,e,r,c,s,l){return t.integrationStringVersion&&2===t.integrationStringVersion?function(t,e,r,u,c,s){if(f.isSingleExperimentPolicy(t.policy)&&u)return;var l=!f.isSingleExperimentPolicy(t.policy)&&u,d=n.formatNamesAndIdsForAnalytics(t,e,r,s),v=[d.names.experiment,d.names.variation],h=[d.idStrings.experiment,d.idStrings.variation];f.isSingleExperimentPolicy(t.policy)||(v.unshift(d.names.layer),h.unshift(d.idStrings.layer));var p=i.reduce(h,(function(t,n){return t+n.length}),0),g=v.length-1+(l?1:0),m=p+g*o.length;if(l&&(m+=a.length),m>c)throw new Error("The analytics string size is too low to send the entity IDs.");for(var _=c-m,w=v.length,y=[],b=v.length-1;b>=0;b--){var E=v[b],I=Math.min(E.length,Math.floor(_/w));_-=I,w--,y.unshift(E.substring(0,I))}var A=i.map(y,(function(t,n){return t+h[n]}));return l&&A.push(a),A.join(o)}(t,e,r,c,s,l):function(t,e,r,c,s,l){var d=c?a:u,v=3*o.length,h=n.formatNamesAndIdsForAnalytics(t,e,r,l),p=h.names,g=h.idStrings,m=i.reduce(g,(function(t,n){return t+n.length}),0);if(m+v+d.length>s)throw new Error("The analytics string size is too low to send the campaign, experiment, and variation IDs.");var _=s-m-v-d.length,w={};w.variation=Math.min(p.variation.length,Math.floor(_/3)),_-=w.variation,w.experiment=Math.min(p.experiment.length,Math.floor(_/2)),_-=w.experiment,w.layer=_;var y={};i.each(p,(function(t,n){y[n]=t.substring(0,w[n])}));var b=[];return f.isSingleExperimentPolicy(t.policy)||b.push(y.layer+g.layer),(b=b.concat([y.experiment+g.experiment,y.variation+g.variation,d])).join(o)}(t,e,r,c,s,l)}},5719:function(t,n,e){var i=e(4816);t.exports=function(t,n){t=function(t){var n=t.split("?");if(n[1]){var e=n[1].split("#"),r=e[0],a=e[1],u=r.split("&"),c=[];return i.each(u,(function(t){0!==t.indexOf(o)&&c.push(t)})),n[1]="",c.length>0&&(n[1]="?"+c.join("&")),a&&(n[1]+="#"+a),n.join("")}return t}(t);var e=n.value;switch(n.match){case"exact":return(t=c(t))===c(e);case"regex":try{return Boolean(t.match(e))}catch(r){}return!1;case"simple":return(t=u(t))===(e=u(e));case"substring":return t=c(t,!0),e=c(e,!0),-1!==t.indexOf(e);default:return!1}};var r=["www."],o="optimizely_",a=["https?://.*?.?optimizelyedit.(com|test)/","https?://.*.?optimizelypreview.(com|test)/","https?://(edit|preview)(-hrd|-devel)?.optimizely.(com|test)/","https?://.*?.?optimizelyedit(-hrd)?.appspot.com/","https?://"];function u(t){return c(function(t){var n=t.indexOf("?");return-1!==n&&(t=t.substring(0,n)),-1!==(n=t.indexOf("#"))&&(t=t.substring(0,n)),t}(t))}function c(t,n){t=(t=t.replace("/?","?")).toLowerCase().replace(/[/&?]+$/,"");var e=a.slice(0);n||(e=e.concat(r));for(var i=e.length,o=0;o<i;o++){var u=e[o],c=new RegExp("^"+u);t=t.replace(c,"")}return t}},8616:function(t,n,e){var i=e(4816),r=e(6094).getFieldValue,o=e(7049);t.exports=function(t,n){var e=r(t,n.name.split("."));return i.isArray(e)?i.some(e,i.partial(o.hasMatch,n.value,n.match)):o.hasMatch(n.value,n.match,e)}},6541:function(t,n,e){var i=e(4816),r=e(9590),o=e(6836),a=e(7936);t.exports={initialize:function(){this.J={actions:{},actionState:{}},this.on(r.DATA_LOADED,this.ht),this.on(r.ACTION_EXECUTED,this._t),this.on(r.SET_CHANGE_APPLIER,this.wt),this.on(r.REMOVE_ACTION_STATE,this.yt)},ht:function(t){var n=this;i.isEmpty(t.data.layers)||(i.each(t.data.layers,(function(t){var e;if(t.changes){var r="layerId:"+t.id;e={id:r,layerId:t.id,changeSet:t.changes,type:"layer"},o.deepFreeze(e),n.J.actions[r]=e}i.each(t.experiments,(function(r){if(r.changes){var a="experimentId:"+r.id;e={id:a,layerId:t.id,experimentId:r.id,changeSet:r.changes,type:"experiment"},o.deepFreeze(e),n.J.actions[a]=e}i.each(r.variations,(function(a){i.each(a.actions,(function(i){var u=i.pageId||i.viewId,c=r.id+":"+a.id+":"+u;e={id:c,layerId:t.id,experimentId:r.id,variationId:a.id,pageId:u,changeSet:i.changes,type:"variation"},o.deepFreeze(e),n.J.actions[c]=e}))}))}))})),this.emitChange())},_t:function(t){var n=t.actionId;i.isUndefined(n)||this.J.actionState[n]||(this.J.actionState[n]={})},wt:function(t){var n=t.actionId,e=t.changeId;this.J.actionState[n]?this.J.actionState[n][e]=t.changeApplier:a.warn("Action Data / Attempted to set changeApplier for inactive action: ",n)},yt:function(t){delete this.J.actionState[t.actionId]},get:function(t){return o.safeReference(this.J.actions[t])},getActionState:function(t){return o.safeReference(this.J.actionState[t])},getByChangeId:function(t){return i.find(this.J.actions,{changeSet:[{id:t}]})},getAllActionIdsByPageId:function(t){return i.map(i.filter(this.J.actions,{pageId:t}),"id")},getChangeApplier:function(t,n){var e=this.J.actionState[n];if(e)return e[t]},getExperimentVariationActions:function(t,n){return o.safeReference(i.filter(this.J.actions,{experimentId:t,variationId:n}))},getLayerActions:function(t){return o.safeReference(i.filter(this.J.actions,{id:"layerId:"+t}))},getExperimentActions:function(t){return o.safeReference(i.filter(this.J.actions,{id:"experimentId:"+t}))},getAll:function(){return o.safeReference(i.values(this.J.actions))}}},9289:function(t,n,e){var i=e(9590);t.exports={initialize:function(){this.J={},this.on(i.REGISTER_ASYNC_DEFERRED,this.bt),this.on(i.RESOLVE_DEFERRED,this.Et),this.on(i.REJECT_DEFERRED,this.It)},getRequest:function(t){return this.J[t]},getPromise:function(t){var n=this.getRequest(t);if(n)return n.promise},bt:function(t){this.J[t.source]={promise:t.promise,resolver:t.resolver,rejecter:t.rejecter}},Et:function(t){var n=this.getRequest(t.source);if(!n)throw new Error("No request registered for source: "+t.source);n.resolver(t.resolveWith)},It:function(t){var n=this.getRequest(t.source);if(!n)throw new Error("No request registered for source: "+t.source);if(!n.rejecter)throw new Error("No rejecter registered for source: "+t.source);n.rejecter(t.rejectWith)}}},9819:function(t,n,e){var i=e(4816),r=e(9590),o=e(6836);function a(t,n){return n||(n={}),t?(i.each(t,(function(t){if(!i.isString(t)){if(i.isObject(t)){var e=t.type,r=t.name||"_";n[e]||(n[e]={}),n[e][r]=!0}i.isArray(t)&&a(t,n)}})),n):n}t.exports={initialize:function(){this.J={audiences:{},featuresNeeded:{}},this.on(r.DATA_LOADED,this.ht)},ht:function(t){i.isEmpty(t.data.audiences)||(i.each(t.data.audiences,i.bind((function(t){o.deepFreeze(t),i.merge(this.J.featuresNeeded,a(t.conditions)),this.J.audiences[t.id]=t}),this)),this.emitChange())},getAll:function(){return o.safeReference(i.values(this.J.audiences))},getFeaturesNeeded:function(t){return o.safeReference(this.J.featuresNeeded[t]||{})},getAudiencesMap:function(){return o.safeReference(this.J.audiences)},get:function(t){return o.safeReference(this.J.audiences[t])},getAudienceName:function(t){return i.find(i.values(this.J.audiences),{id:t}).name||"Aud "+t}}},7525:function(t,n,e){var i=e(4816),r=e(9590),o=e(6836);t.exports={initialize:function(){this.J={},this.on(r.ADD_CHANGE,this.At),this.on(r.DATA_LOADED,this.ht)},getChange:function(t){return this.J[t]},ht:function(t){i.isEmpty(t.data.changes)||i.each(t.data.changes,i.bind(this.At,this))},At:function(t){o.deepFreeze(t),this.J[t.id]=t,this.emitChange()}}},5518:function(t,n,e){var i=e(4816),r=e(9590),o=e(8738);t.exports={initialize:function(){this.J={},i.each(o.Lifecycle,i.bind((function(t){this.J[t]=[]}),this)),this.on(r.ADD_CLEANUP_FN,this.Tt),this.on(r.CLEAR_CLEANUP_FN,this.St)},getCleanupFns:function(t){return i.cloneDeep(this.J[t])},Tt:function(t){this.J[t.lifecycle].push(t.cleanupFn),this.emitChange()},St:function(t){var n=this.J[t.lifecycle];if(t.cleanupFn){var e=n.indexOf(t.cleanupFn);e>-1&&(n.splice(e,1),this.emitChange())}else this.J[t.lifecycle]=[],this.emitChange()}}},2405:function(t,n,e){var i=e(9590),r=e(6637);t.exports={initialize:function(){this.J={name:r.NAME,version:r.VERSION},this.on(i.SET_CLIENT_NAME,this.kt),this.on(i.SET_CLIENT_VERSION,this.Rt)},getClientName:function(){return this.J.name},getClientVersion:function(){return this.J.version},kt:function(t){t&&(this.J.name=t),this.emitChange()},Rt:function(t){t&&(this.J.version=t),this.emitChange()}}},8176:function(t,n,e){var i=e(9590);t.exports={initialize:function(){this.J={currentDomain:null,defaultAgeSeconds:15552e3,autoRefresh:true},this.on(i.SET_COOKIE_DOMAIN,this.Nt),this.on(i.SET_COOKIE_AGE,this.Ct),this.on(i.SET_COOKIE_AUTO_REFRESH,this.Dt)},getCurrentDomain:function(){return this.J.currentDomain},getDefaultAgeInSeconds:function(){return this.J.defaultAgeSeconds},getAutoRefresh:function(){return this.J.autoRefresh},Nt:function(t){this.J.currentDomain=t,this.emitChange()},Ct:function(t){this.J.defaultAgeSeconds=t,this.emitChange()},Dt:function(t){this.J.autoRefresh=t,this.emitChange()}}},325:function(t,n,e){var i=e(4816),r=e(9590),o=e(6836);t.exports={initialize:function(){this.J={},this.on(r.DATA_LOADED,this.ht)},ht:function(t){i.isEmpty(t.data.dimensions)||(i.each(t.data.dimensions,i.bind((function(t){o.deepFreeze(t),this.J[t.id]=t}),this)),this.emitChange())},getAll:function(){return o.safeReference(i.values(this.J))},getById:function(t){return o.safeReference(this.J[t])},getByApiName:function(t){return o.safeReference(i.find(i.values(this.J),{apiName:t}))}}},5973:function(t,n,e){var i=e(4816),r=e(9590);t.exports={initialize:function(){this.J={disabled:!1,forceAudienceIds:[],forceVariationIds:[],alreadyInitialized:!1,mutationObserverAPISupported:!1,isEditor:!1,isPreview:!1,isLegacyPreview:!1,isSlave:!1,previewLayerIds:[],projectToken:null,shouldOptOut:!1,trackingDisabled:!1,isRunningInV2Editor:!1,isRunningInDesktopApp:!1,forceTracking:!1},this.on(r.LOAD_DIRECTIVE,this.Ot)},getAll:function(){return i.cloneDeep(this.J)},conflictInObservingChanges:function(){return!this.J.mutationObserverAPISupported},isDisabled:function(){return this.J.disabled},isEditor:function(){return this.J.isEditor},clientHasAlreadyInitialized:function(){return this.J.alreadyInitialized},getForceAudienceIds:function(){return this.J.forceAudienceIds},getForceVariationIds:function(){return this.J.forceVariationIds},getPreviewLayerIds:function(){return this.J.previewLayerIds},getProjectToken:function(){return this.J.projectToken},getForceTracking:function(){return this.J.forceTracking},shouldActivate:function(){return!this.J.isEditor&&!this.isDisabled()},shouldBootstrapDataForPreview:function(){return this.J.isPreview},shouldBootstrapDataForEditor:function(){return this.J.isEditor},shouldInitialize:function(){return!(this.shouldLoadPreview()||this.isDisabled()||this.getProjectToken())},shouldLoadPreview:function(){return!(this.J.isPreview||this.J.isLegacyPreview||!this.getProjectToken()||this.J.isEditor)},shouldBailForDesktopApp:function(){return!this.J.isEditor&&this.J.isRunningInDesktopApp},shouldLoadInnie:function(){return!this.J.isSlave&&!this.J.isEditor&&this.J.isRunningInV2Editor},shouldObserveChangesIndefinitely:function(){return this.J.mutationObserverAPISupported},shouldObserveChangesUntilTimeout:function(){return!this.shouldObserveChangesIndefinitely()},shouldOptOut:function(){return this.J.shouldOptOut},shouldSendTrackingData:function(){return!this.J.trackingDisabled&&(!!this.J.forceTracking||!this.J.isPreview&&i.isEmpty(this.getForceVariationIds())&&i.isEmpty(this.getForceAudienceIds()))},isSlave:function(){return this.J.isSlave},isRunningInDesktopApp:function(){return this.J.isRunningInDesktopApp},isRunningInV2Editor:function(){return this.J.isRunningInV2Editor},Ot:function(t){i.extend(this.J,t),this.emitChange()}}},8622:function(t,n,e){var i=e(4816),r=e(9590),o=e(6836);t.exports={initialize:function(){this.J={},this.on(r.DATA_LOADED,this.ht)},getAll:function(){return o.safeReference(i.values(this.J))},getEventsMap:function(){return o.safeReference(this.J)},get:function(t){return o.safeReference(this.J[t])},getByApiName:function(t){return o.safeReference(i.find(i.values(this.J),{apiName:t}))},getByPageId:function(t){return o.safeReference(i.filter(this.J,{pageId:t}))},ht:function(t){i.isEmpty(t.data.events)||(i.each(t.data.events,i.bind((function(t){t.pageId||(t.pageId=t.viewId),o.deepFreeze(t),this.J[t.id]=t}),this)),this.emitChange())}}},6841:function(t,n,e){var i=e(4816),r=e(9590);function o(t){var n=[];return t&&i.isObject(t)?(t.type&&n.push(t.type),n.push("|"),t.type&&t.name&&n.push(t.name),n.join("")):"|"}t.exports={initialize:function(){this.J={handlers:{}},this.on(r.ADD_EMITTER_HANDLER,this.xt),this.on(r.REMOVE_EMITTER_HANDLER,this.Mt)},getHandlers:function(t,n){var e=[null,{type:t.type},{type:t.type,name:t.name}],r=[];return i.each(e,i.bind((function(t){var n=o(t),e=this.J.handlers[n];e&&(r=r.concat(e))}),this)),n&&(r=i.filter(r,(function(t){return!t.publicOnly}))),r},xt:function(t){var n=o(t.filter);this.J.handlers[n]||(this.J.handlers[n]=[]),this.J.handlers[n].push({handler:t.handler,token:t.token,publicOnly:!!t.publicOnly,emitErrors:!!t.emitErrors}),this.emitChange()},Mt:function(t){var n=!1,e=t.token;i.forOwn(this.J.handlers,i.bind((function(t,r){var o=i.filter(t,(function(t){return t.token!==e}));o.length!==t.length&&(n=!0,this.J.handlers[r]=o)}),this)),n&&this.emitChange()}}},5394:function(t,n,e){var i=e(4816),r=e(9590),o=e(6836);t.exports={initialize:function(){this.J={holdback:0,isGlobalHoldback:null,listTargetingKeys:[],revision:null,projectId:null,accountId:null,namespace:null,activationId:null,activationTimestamp:null,dcpServiceId:null,dcpKeyfieldLocators:[],recommenderServices:[],anonymizeIP:null,projectJS:null,snippetId:null,plugins:[],domContentLoaded:!1,experimental:{},ga4UserId:null},this.on(r.DATA_LOADED,this.Pt),this.on(r.ACTIVATE,this.Lt),this.on(r.RECORD_GLOBAL_DECISION,this.Ut),this.on(r.SET_DOMCONTENTLOADED,this.Vt),this.on(r.SET_GA4_USER_ID,this.Ft)},getRevision:function(){return this.J.revision},getGlobalHoldbackThreshold:function(){return this.J.holdback},getProjectId:function(){return this.J.projectId},getSnippetId:function(){return this.J.snippetId},getAccountId:function(){return this.J.accountId},getNamespace:function(){return this.J.namespace},getActivationId:function(){return this.J.activationId},getActivationTimestamp:function(){return this.J.activationTimestamp},getAnonymizeIP:function(){return this.J.anonymizeIP},isGlobalHoldback:function(){return!!this.J.isGlobalHoldback},getListTargetingKeys:function(){return this.J.listTargetingKeys.slice()},getDCPServiceId:function(){return this.J.dcpServiceId},getDCPKeyfieldLocators:function(){return this.J.dcpKeyfieldLocators},getRecommenderServices:function(){return this.J.recommenderServices},getProjectJS:function(){return this.J.projectJS},getPlugins:function(){return this.J.plugins},getExperimental:function(){return o.safeReference(this.J.experimental)},getGA4UserId:function(){return this.J.ga4UserId},domContentLoadedHasFired:function(){return this.J.domContentLoaded},Lt:function(t){this.J.activationId=t.activationId,this.J.activationTimestamp=t.activationTimestamp,this.J.isGlobalHoldback=null},Ut:function(t){var n=t.isGlobalHoldback;if(null!==this.J.isGlobalHoldback&&this.J.isGlobalHoldback!==n)throw new Error("Attempted to change already set global holdback!");this.J.isGlobalHoldback=n,this.emitChange()},Ft:function(t){var n=t.ga4UserId;if(!n)throw new Error('Argument "payload.ga4UserId" is missing');this.J.ga4UserId=n,this.emitChange()},Pt:function(t){var n=i.pick(t.data,["holdback","accountId","projectId","snippetId","namespace","revision","listTargetingKeys","dcpServiceId","dcpKeyfieldLocators","recommenderServices","anonymizeIP","plugins","projectJS","experimental","ga4UserId"]);if(0!==i.keys(n).length){i.extend(this.J,{listTargetingKeys:[],dcpServiceId:null,dcpKeyfieldLocators:[]},n),this.emitChange()}},Vt:function(){this.J.domContentLoaded=!0,this.emitChange()}}},2275:function(t,n,e){var i=e(4816),r=e(9590),o=e(6836);t.exports={initialize:function(){this.J={},this.on(r.DATA_LOADED,this.ht)},ht:function(t){i.isEmpty(t.data.groups)||(i.each(t.data.groups,i.bind((function(t){o.deepFreeze(t),this.J[t.id]=t}),this)),this.emitChange())},getAll:function(){return o.safeReference(i.values(this.J))},getGroupsMap:function(){return o.safeReference(this.J)},get:function(t){return o.safeReference(this.J[t])}}},34:function(t,n,e){var i=e(4816),r=e(9590),o=e(5343);t.exports={initialize:function(){this.J={originalPushState:null,originalReplaceState:null},this.on(r.ENSURE_ORIGINAL_PUSHSTATE,this.Bt),this.on(r.ENSURE_ORIGINAL_REPLACESTATE,this.zt)},getOriginalPushState:function(){return this.J.originalPushState},getOriginalReplaceState:function(){return this.J.originalReplaceState},Bt:function(){this.J.originalPushState||(this.J.originalPushState=i.bind(o.getGlobal("history").pushState,o.getGlobal("history")))},zt:function(){this.J.originalReplaceState||(this.J.originalReplaceState=i.bind(o.getGlobal("history").replaceState,o.getGlobal("history")))}}},8726:function(t,n,e){var i=e(4816),r=e(9590);t.exports={initialize:function(){this.J={},this.on(r.DATA_LOADED,this.ht),this.on(r.SET_INTEGRATION_SETTINGS,this.Gt)},ht:function(t){i.isEmpty(t.data.integrationSettings)||(i.each(t.data.integrationSettings,i.bind((function(t){this.J[t.id]=t}),this)),this.emitChange())},Gt:function(t){var n=this.J[t.id];n?i.extend(n,t):this.J[t.id]=t},getAll:function(){return i.cloneDeep(i.values(this.J))},get:function(t){return i.cloneDeep(this.J[t])},getReference:function(t){return this.J[t]}}},3974:function(t,n,e){var i=e(4816),r=e(9590),o=e(7936),a="*";t.exports={initialize:function(){this.J={},this.on(r.LOAD_PERSISTED_LAYER_STATES,this.jt),this.on(r.RECORD_LAYER_DECISION,this.qt),this.on(r.RECORD_LAYER_DECISION_EVENT_ID,this.Ht)},getLayerState:function(t,n){if(this.J[t]){var e=this.J[t];if(i.keys(e).length>1&&!n)throw new Error("View Id must be specified when more than one layerState for layer.");return n?i.cloneDeep(i.find(e,{pageId:n})):i.cloneDeep(e["*"])}},getLayerStates:function(t){var n=[];for(var e in this.J)i.forEach(this.J[e],(function(e){(i.isUndefined(t)||e.namespace===t)&&n.push(i.cloneDeep(e))}));return n},getLayerStatesForAnalytics:function(){var t=[];for(var n in this.J)i.forEach(this.J[n],(function(n){t.push(i.pick(n,["layerId","decision","decisionEventId"]))}));return t},jt:function(t){t.merge||(this.J={}),i.each(t.layerStates,i.bind((function(t){var n=t.layerId;t.pageId||(t.pageId=t.viewId);var e=t.pageId||a,r=this.J[n];if(i.isUndefined(r))this.J[n]={},this.J[n][e]=t;else{var o=r[e];(!o||t.decisionTimestamp>(o.decisionTimestamp||0))&&(this.J[n][e]=t)}}),this)),this.emitChange()},qt:function(t){var n={layerId:t.layerId,revision:t.revision,namespace:t.namespace,pageId:t.pageId,decisionTicket:t.decisionTicket,decision:t.decision,decisionActivationId:t.activationId,decisionTimestamp:t.timestamp,decisionEventId:null},e=this.J[t.layerId]||{};t.pageId?(delete e["*"],e[t.pageId]=n):(e={})["*"]=n,this.J[t.layerId]=e,this.emitChange()},Ht:function(t){var n=t.layerId,e=t.pageId||a;this.J[n]?this.J[n][e]?(this.J[n][e].decisionEventId=t.decisionId,this.emitChange()):o.warn("Not recording decision event: Layer state not found for view",e):o.warn("Not recording decision event: Campaign not registered",n)}}},6346:function(t,n,e){var i=e(4816),r=e(9590),o=e(6836),a=e(3008);t.exports={initialize:function(){this.J={layers:{},experiments:{},variations:{}},this.on(r.DATA_LOADED,this.ht)},ht:function(t){if(!i.isEmpty(t.data.layers)){var n=this;i.each(t.data.layers,(function(t){i.each(t.experiments,(function(e){t.pageIds||(t.pageIds=t.viewIds),e.campaignName||a.isSingleExperimentPolicy(t.policy)?a.isSingleExperimentPolicy(t.policy)&&t.groupId&&(e.groupId=t.groupId):e.campaignName=t.name,i.each(e.variations,(function(t){i.each(t.actions,(function(t){t.pageId||(t.pageId=t.viewId)})),n.J.variations[t.id]=t})),n.J.experiments[e.id]=e})),o.deepFreeze(t),n.J.layers[t.id]=t})),this.emitChange()}},getAll:function(){return o.safeReference(i.values(this.J.layers))},getCampaignsMap:function(){return o.safeReference(this.J.layers)},getExperimentsMap:function(){return o.safeReference(this.J.experiments)},getVariationsMap:function(){return o.safeReference(this.J.variations)},getCount:function(){return i.keys(this.J.layers).length},getAllByPageIds:function(t){return o.safeReference(i.filter(this.J.layers,(function(n){return i.some(t,i.partial(i.includes,n.pageIds))})))},get:function(t){return o.safeReference(this.J.layers[t])},getLayerByExperimentId:function(t){var n=i.find(this.J.layers,(function(n){return i.find(n.experiments,{id:t})}));return o.safeReference(n)},getExperimentByVariationId:function(t){var n;return i.some(this.J.layers,(function(e){return i.some(e.experiments,(function(e){return i.find(e.variations,{id:t})&&(n=e),n})),n})),o.safeReference(n)}}},9985:function(t,n,e){var i=e(9590);t.exports={initialize:function(){this.J={logs:[]},this.on(i.LOG,this.Yt)},getLogs:function(){return this.J.logs},Yt:function(t){this.J.logs.push(t),this.emitChange()},tt:function(){return this.J.logs.slice()}}},3712:function(t,n,e){var i=e(9590),r=e(6836);t.exports={initialize:function(){this.J={data:null,hasTracked:null},this.on(i.LOAD_REDIRECT_DATA,this.$t),this.on(i.REGISTER_TRACKED_REDIRECT_DATA,this.Kt)},get:function(){return r.safeReference(this.J.data)},hasTracked:function(){return this.J.hasTracked},$t:function(t){r.deepFreeze(t),this.J.data=t,this.J.hasTracked=!1,this.emitChange()},Kt:function(){this.J.hasTracked=!0}}},3312:function(t,n,e){var i=e(4816),r=e(9590),o=e(9505);t.exports={initialize:function(){this.J={},this.on(r.SET_PENDING_EVENT,this.Wt),this.on(r.REMOVE_PENDING_EVENT,this.Xt),this.on(r.LOAD_PENDING_EVENTS,this.Jt)},getEvents:function(){return this.J},getEventsString:function(){return o.stringify(this.J)},Wt:function(t){i.keys(this.J).length>=1e3&&this.Qt();var n=t.id,e=t.retryCount;this.J[n]&&this.J[n].retryCount===e||(this.J[n]={id:n,timeStamp:t.timeStamp,data:t.data,retryCount:e},this.emitChange())},Xt:function(t){delete this.J[t.id],this.emitChange()},Jt:function(t){this.J=t.events,this.Qt(),this.emitChange()},Qt:function(){for(var t=i.sortBy(this.J,"timeStamp"),n=0;n<=t.length-1e3;n++)delete this.J[t[n].id];this.emitChange()}}},2856:function(t,n,e){var i=e(4816),r=e(9590);t.exports={initialize:function(){this.J={layerId:null},this.on(r.ANNOUNCE_PENDING_REDIRECT,this.$t)},isExpectingRedirect:function(){return i.isString(this.J.layerId)},getLayerId:function(){return this.J.layerId},$t:function(t){this.isExpectingRedirect()||(this.J.layerId=t.layerId,this.emitChange())}}},1546:function(t,n,e){var i=e(4816),r=e(9590),o=e(8738);t.exports={initialize:function(){this.J={},this.J[o.PerformanceData.performance_marks]={},this.on(r.SET_PERFORMANCE_MARKS_DATA,this.Zt)},Zt:function(t){i.isUndefined(this.J[o.PerformanceData.performance_marks][t.name])&&(this.J[o.PerformanceData.performance_marks][t.name]=[]),this.J[o.PerformanceData.performance_marks][t.name].push(t.data),this.emitChange()},getMarks:function(){return i.mapValues(this.J[o.PerformanceData.performance_marks],(function(t){return i.map(t,(function(t){return[t.startTime,t.duration]}))}))},getDurationsFor:function(t){return i.reduce(t,i.bind((function(t,n){var e=this.J[o.PerformanceData.performance_marks][n];return e&&(t[n]=Math.round(i.reduce(e,(function(t,n){return t+n.duration}),0))),t}),this),{})}}},8692:function(t,n,e){var i=e(4816),r=e(9590),o=e(8738),a=e(7936);t.exports={initialize:function(){this.J=i.mapValues(o.PluginTypes,(function(){return{}})),this.on(r.REGISTER_PLUGIN,this.tn)},tn:function(t){var n=t.type,e=t.name,i=t.plugin;if(!n||!e)throw new Error("Missing information needed to register plugins: "+n+":"+e);if(!this.J[n])throw new Error("Invalid plugin type specified: "+n);this.J[n][e]=i,a.debug("Plugin Store: Registering Plugin :",t)},getAllPlugins:function(t){if(!t)return this.J;if(this.J[t])return this.J[t];throw new Error("Invalid plugin type: "+t)},getPlugin:function(t,n){if(!n||!t)throw new Error("Missing plugin parameters");return this.getAllPlugins(t)[n]||null}}},9147:function(t,n,e){var i=e(4816),r=e(9590),o=e(6094);t.exports={initialize:function(){this.J={},this.on(r.SET_VISITOR_ATTRIBUTE_PENDING,this.nn)},getPendingAttributeValue:function(t){return t=i.isArray(t)?t.concat("pending"):[t,"pending"],o.getFieldValue(this.J,t)},nn:function(t){o.setFieldValue(this.J,t.key,{pending:t.pending}),this.emitChange()}}},4182:function(t,n,e){var i=e(4816),r=e(9590);t.exports={initialize:function(){this.J={inRumSample:!1,id:null,src:null,RumHost:null,data:{extras:{}},apis:{},DOMObservation:{},featuresNeeded:{}},this.on(r.SET_RUM_DATA,this.en),this.on(r.RECORD_API_USAGE,this.rn),this.on(r.INITIALIZE_CHANGE_METRICS,this.an),this.on(r.RECORD_ACTIVATION_TYPE_USAGE,this.un),this.on(r.RECORD_AUDIENCE_USAGE,this.cn),this.on(r.RECORD_CHANGE_MACROTASK_RATE,this.sn),this.on(r.RECORD_CHANGE_OVERHEATED,this.fn),this.on(r.RECORD_CHANGE_TYPE_USAGE,this.ln),this.on(r.RECORD_DOM_OBSERVATION_OCCURENCE,this.dn),this.on(r.RECORD_INTEGRATION_USAGE,this.vn),this.on(r.RECORD_LAYER_FEATURE_USAGE,this.hn),this.on(r.RECORD_LAYER_POLICY_USAGE,this.pn),this.on(r.RECORD_VIEW_FEATURE_USAGE,this.gn),this.on(r.RECORD_VIEWS_INITIALLY_ACTIVATED_COUNT,this.mn),this.on(r.RECORD_VISITOR_ID_LOCATOR_USAGE,this._n),this.on(r.RECORD_VISITOR_ID_ERROR,this.wn),this.on(r.RECORD_STICKY_BUCKETING_FEATURE,this.yn)},en:function(t){i.merge(this.J,t),this.emitChange()},rn:function(t){this.J.apis[t.methodName]||(this.J.apis[t.methodName]=0),this.J.apis[t.methodName]++,this.emitChange()},an:function(){i.isUndefined(this.J.data.extras.changeMacrotaskRate)&&(this.J.data.extras.changeMacrotaskRate=0),i.isUndefined(this.J.data.extras.numOverheatedChanges)&&(this.J.data.extras.numOverheatedChanges=0)},sn:function(t){i.isUndefined(this.J.data.extras.changeMacrotaskRate)&&(this.J.data.extras.changeMacrotaskRate=0),t.changeMacrotaskRate>this.J.data.extras.changeMacrotaskRate&&(this.J.data.extras.changeMacrotaskRate=t.changeMacrotaskRate),this.emitChange()},fn:function(){i.isUndefined(this.J.data.extras.numOverheatedChanges)&&(this.J.data.extras.numOverheatedChanges=0),this.J.data.extras.numOverheatedChanges++,this.emitChange()},dn:function(t){this.J.DOMObservation[t.counterName]||(this.J.DOMObservation[t.counterName]=0),this.J.DOMObservation[t.counterName]++,this.emitChange()},bn:function(t,n,e){i.isUndefined(this.J.featuresNeeded[t])&&(this.J.featuresNeeded[t]={});var r=this.J.featuresNeeded[t];i.each(n,(function(t){r[t]||(r[t]={}),r[t][e]||(r[t][e]=!0)}))},vn:function(t){this.bn("integrations",t.integrations,t.layerId)},ln:function(t){this.bn("changeTypes",t.changeTypes,t.layerId)},un:function(t){this.bn("activationTypes",[t.activationType],t.entityId),this.emitChange()},gn:function(t){this.bn("viewFeatures",t.featuresUsed,t.entityId),this.emitChange()},hn:function(t){this.bn("layerFeatures",[t.feature],t.entityId),this.emitChange()},pn:function(t){this.bn("policy",[t.policy],t.layerId),this.emitChange()},cn:function(t){this.bn("audiences",t.audienceTypes,t.layerId),this.emitChange()},mn:function(t){this.J.data.extras.viewsInitiallyActivatedCount=t.viewsInitiallyActivatedCount,this.emitChange()},_n:function(t){this.bn("visitorIdLocatorType",[t.visitorIdLocatorType],t.entityId),this.emitChange()},wn:function(t){this.J.data.extras.errorCustomVisitorId=t.isError,this.emitChange()},yn:function(t){this.bn("stickyBucketing",[t.feature],t.id)},getSampleRum:function(){return this.J.inRumSample},getRumId:function(){return this.J.id},getRumHost:function(){return this.J.RumHost},getApiData:function(){return this.J.apis},getDOMObservationData:function(){return this.J.DOMObservation},getRumData:function(){return i.cloneDeep(this.J.data)},getScriptSrc:function(){return this.J.src},getFeaturesNeededData:function(){var t=this.J.featuresNeeded,n={};return i.forOwn(t,(function(t,e){var r=i.keys(t);i.isEmpty(r)||(n[e]={}),i.forEach(r,(function(r){n[e][r]=i.keys(t[r]).length}))})),n}}},4544:function(t,n,e){var i=e(9590);t.exports={initialize:function(){this.J={initialized:!1,natives:{}},this.on(i.SANDBOXED_FUNCTIONS_ADDED,this.En)},En:function(t){if(!t.sandboxedFunctions)throw new Error("No sandboxedFunctions found in payload");this.J.natives=t.sandboxedFunctions,this.J.initialized=!0,this.emitChange()},getAll:function(){return this.J.natives},get:function(t){if(!t)throw new Error("Missing name parameter");return this.J.natives[t]||null},isInitialized:function(){return this.J.initialized}}},9149:function(t,n,e){var i=e(4816),r=e(9590),o=e(8701),a=e(7276);t.exports={initialize:function(){this.J={lastSessionTimestamp:0,sessionId:null},this.on(r.REFRESH_SESSION,this.In),this.on(r.LOAD_SESSION_STATE,this.An)},getState:function(){return i.cloneDeep(this.J)},getSessionId:function(){return this.J.sessionId},An:function(t){this.J.sessionId=t.sessionId,this.J.lastSessionTimestamp=t.lastSessionTimestamp,this.emitChange()},In:function(){var t=o.now(),n=this.J.lastSessionTimestamp;(!this.J.sessionId||t-n>18e5)&&(this.J.sessionId=a.generate()),this.J.lastSessionTimestamp=t,this.emitChange()}}},1440:function(t,n,e){var i=e(4816),r=e(9590);t.exports={initialize:function(){this.Tn(),this.on(r.FINALIZE_BATCH_SNAPSHOT,this.Sn),this.on(r.REGISTER_PREVIOUS_BATCH,this.kn),this.on(r.REGISTER_TRACKER_VISITOR,this.Rn),this.on(r.REGISTER_TRACKER_EVENT,this.Nn),this.on(r.REGISTER_TRACKER_DECISION,this.Cn),this.on(r.RESET_TRACKER_EVENTS,this.Dn),this.on(r.RESET_TRACKER_STORE,this.Tn),this.on(r.RESET_TRACKER_PREVIOUS_BATCHES,this.On),this.on(r.SET_TRACKER_POLLING,this.xn),this.on(r.SET_TRACKER_BATCHING,this.Mn),this.on(r.SET_TRACKER_SEND_EVENTS,this.Pn),this.on(r.SET_TRACKER_PERSISTABLE_STATE,this.Ln),this.on(r.SET_TRACKER_DIRTY,this.Un),this.on(r.UPDATE_TRACKER_VISITOR_ATTRIBUTES,this.Vn)},getPersistableState:function(){return this.J.isDirty?this.hasEventsToSend()||this.hasPreviousBatchesToSend()?{data:this.J.data,decisions:this.J.decisions,decisionEvents:this.J.decisionEvents,previousBatches:this.J.previousBatches}:{}:null},Ln:function(t){i.isEmpty(this.J.data)||i.isEmpty(t.data)||(this.Sn(),this.J.previousBatches.push(this.getEventBatch())),this.J.data=t.data||{},this.J.decisions=t.decisions||[],this.J.decisionEvents=t.decisionEvents||[],i.isEmpty(this.J.previousBatches)||i.isEmpty(t.previousBatches)?this.J.previousBatches=t.previousBatches||[]:this.J.previousBatches=this.J.previousBatches.concat(t.previousBatches),this.emitChange()},Un:function(t){this.J.isDirty=t,this.emitChange()},Nn:function(t){var n=this.Fn();(i.isEmpty(n.snapshots)||!i.isEmpty(this.J.decisionEvents))&&this.Bn(),this.zn().events.push(t.event),this.J.decisions=t.decisions,this.Un(!0)},Cn:function(t){this.J.decisionEvents.push(t.decisionEvent),this.J.decisions=t.decisions,this.Un(!0)},Rn:function(t){i.isEmpty(this.J.data)?this.J.data=t.data:this.Sn(),this.J.data.visitors.push(t.visitor),this.J.decisions=t.decisions,this.J.decisionEvents=[],this.Un(!0)},kn:function(t){this.J.previousBatches.push(t),this.Un(!0)},Tn:function(){this.J={polling:!1,shouldBatch:!0,data:{},decisions:[],decisionEvents:[],canSend:!1,isDirty:!1,previousBatches:[]},this.emitChange()},Dn:function(){var t=this.Fn();this.J.data.visitors=[t],t.snapshots=[],this.Un(!0)},On:function(){this.J.previousBatches=[],this.Un(!0)},xn:function(t){this.J.polling=t,this.emitChange()},Mn:function(t){this.J.shouldBatch=t,this.emitChange()},Pn:function(t){this.J.canSend=t,this.emitChange()},getEventBatch:function(){return i.cloneDeep(this.J.data)},getPreviousBatches:function(){return i.cloneDeep(this.J.previousBatches)},Gn:function(){return this.J.decisionEvents.slice()},jn:function(){this.J.decisionEvents=[]},qn:function(){return this.J.decisions.slice()},isPolling:function(){return this.J.polling},shouldBatch:function(){return this.J.shouldBatch},zn:function(){return i.last(this.Fn().snapshots)},Fn:function(){return i.last(this.J.data.visitors)},Bn:function(){var t=this.Gn();this.Fn().snapshots.push({decisions:this.qn(),events:t}),this.jn(),this.Un(!0)},Sn:function(){this.J.decisionEvents.length>0&&this.Bn()},hasEventsToSend:function(){if(!i.isEmpty(this.J.decisionEvents))return!0;if(!i.isEmpty(this.J.data)&&i.some(this.J.data.visitors||[],(function(t){return t.snapshots.length>0})))return!0;return!1},hasPreviousBatchesToSend:function(){return!i.isEmpty(this.J.previousBatches)},canSend:function(){return this.J.canSend},Vn:function(t){var n=this.Fn();n&&(n.attributes=t.attributes)}}},7460:function(t,n,e){var i=e(4816),r=e(9590);t.exports={initialize:function(){this.J={},this.on(r.SET_UA_DATA,this.ht)},ht:function(t){i.isEmpty(this.J)&&(this.J=t.data)},get:function(){return i.cloneDeep(this.J)}}},8892:function(t,n,e){var i=e(4816),r=e(9590),o=e(7936),a={globalTags:{},viewStates:{},shouldBatch:!1};t.exports={initialize:function(){this.J=i.cloneDeep(a),this.on(r.REGISTER_VIEWS,this.Hn),this.on(r.SET_VIEW_ACTIVE_STATE,this.Yn),this.on(r.UPDATE_PARSED_VIEW_METADATA,this.$n),this.on(r.UPDATE_USER_SUPPLIED_METADATA,this.Kn),this.on(r.TRACK_VIEW_ACTIVATED_EVENT,this.Wn),this.on(r.SET_GLOBAL_TAGS,this.Xn),this.on(r.RESET_VIEW_STATES,this.Jn),this.on(r.SET_VIEW_BATCHING,this.Mn)},getAll:function(){var t={};for(var n in this.J.viewStates)t[n]=this.getViewState(n);return t},getActiveViewIds:function(){return i.reduce(this.J.viewStates,i.bind((function(t,n,e){return this.isViewActive(e)&&t.push(e),t}),this),[])},shouldBatch:function(){return this.J.shouldBatch},getViewState:function(t){var n=i.cloneDeep(this.J.viewStates[t]),e=this.J.globalTags;return n.metadata=i.extend({},n.parsedMetadata,e,n.userSuppliedMetadata),n},getActiveViewTags:function(){var t=this.getActiveViewStates(),n=i.map(t,(function(t){return t.metadata})),e=[{}].concat(n);return i.extend.apply(i,e)},getActivationEventId:function(t){return this.J.viewStates[t]?this.J.viewStates[t].activationEventId:null},getActiveViewStates:function(){return i.reduce(this.J.viewStates,i.bind((function(t,n,e){return this.isViewActive(e)&&t.push(this.getViewState(e)),t}),this),[])},isViewActive:function(t){var n=this.J.viewStates[t];return n||o.warn("No Page registered with id",t),!!n.isActive},getGlobalTags:function(){return i.cloneDeep(this.J.globalTags)},Jn:function(){this.J.viewStates={},this.emitChange()},Hn:function(t){i.each(t.views,i.bind((function(t){var n=t.id;this.J.viewStates[n]={id:n,isActive:i.isBoolean(t.isActive)?t.isActive:null,activatedTimestamp:null,activationEventId:null,parsedMetadata:{},userSuppliedMetadata:{}}}),this)),this.emitChange()},Yn:function(t){var n=t.view.id;if(!this.J.viewStates[n])throw new Error("No view exists with id "+n);this.J.viewStates[n].isActive=t.isActive,t.isActive?this.J.viewStates[n].activatedTimestamp=t.timestamp:(this.J.viewStates[n].parsedMetadata={},this.J.viewStates[n].userSuppliedMetadata={}),this.emitChange()},$n:function(t){var n=t.pageId;if(!this.J.viewStates[n])throw new Error("No view exists with id "+n);i.assign(this.J.viewStates[n].parsedMetadata,t.metadata),this.emitChange()},Kn:function(t){var n=t.pageId;if(!this.J.viewStates[n])throw new Error("No view exists with id "+n);i.assign(this.J.viewStates[n].userSuppliedMetadata,t.metadata),this.emitChange()},Wn:function(t){var n=t.pageId;this.J.viewStates[n]&&(this.J.viewStates[n].activationEventId=t.eventData.eventId,this.emitChange())},Xn:function(t){i.extend(this.J.globalTags,t),this.emitChange()},Mn:function(t){this.J.shouldBatch=t,this.emitChange()}}},1969:function(t,n,e){var i=e(4816),r=e(9590),o=e(6836);t.exports={initialize:function(){this.J={views:{},apiNamesToViews:{}},this.on(r.DATA_LOADED,this.ht)},getAll:function(){return o.safeReference(i.values(this.J.views))},getPagesMap:function(){return o.safeReference(this.J.views)},get:function(t){return o.safeReference(this.J.views[t])},getByApiName:function(t){return o.safeReference(this.J.apiNamesToViews[t])},apiNameToId:function(t){var n=this.J.apiNamesToViews[t];if(n)return n.id},idToApiName:function(t){var n=this.J.views[t];if(n)return n.apiName},getNumberOfPages:function(){return i.keys(this.J.views).length},getAllViewsForActivationType:function(t){return i.filter(this.J.views,{activationType:t})},ht:function(t){i.isEmpty(t.data.views)||(i.each(t.data.views,i.bind((function(t){o.deepFreeze(t),this.J.views[t.id]=t,this.J.apiNamesToViews[t.apiName]=t}),this)),this.emitChange())}}},4264:function(t,n,e){var i=e(4816),r=e(9590),o=e(6094);t.exports={initialize:function(){this.J={profile:{},metadata:{},visitorId:null},this.on(r.SET_VISITOR_ID_VIA_API,this.Qn),this.on(r.SET_VISITOR_ATTRIBUTES,this.Zn),this.on(r.LOAD_EXISTING_VISITOR_PROFILE,this.te)},getVisitorProfile:function(){return this.J.profile},getVisitorProfileMetadata:function(){return this.J.metadata},getAttribute:function(t){var n=this.J.profile;return i.cloneDeep(o.getFieldValue(n,t))},getAttributeMetadata:function(t){return i.cloneDeep(this.J.metadata[t])},getVisitorIdFromAPI:function(){return this.J.visitorId},te:function(t){this.J.profile=t.profile,this.J.metadata=t.metadata,this.emitChange()},Zn:function(t){i.each(t.attributes,i.bind((function(t){var n=t.key;o.setFieldValue(this.J.profile,n,t.value),t.metadata&&i.forOwn(t.metadata,i.bind((function(t,e){o.setFieldValue(this.J.metadata,n.concat(e),t)}),this))}),this)),this.emitChange()},Qn:function(t){this.J.visitorId=t,this.emitChange()}}},2676:function(t,n,e){var i=e(4816),r=e(9590);t.exports={initialize:function(){this.J={},this.on(r.DATA_LOADED,this.ne)},getCustomBehavioralAttributes:function(){return i.filter(this.J,(function(t){return!!t.rule_json}))},getVisitorAttribute:function(t){var n=i.values(this.J);if(t.datasourceId&&(n=i.filter(n,{dcp_datasource_id:String(t.datasourceId)})),t.attributeName&&t.attributeId)throw new Error("Must not specify both attribute name and attribute ID");if(t.attributeId){var e=this.J[t.attributeId];if(!e)throw new Error("Unrecognized attribute ID: "+t.attributeId);return e}if(t.attributeName){var r=i.filter(n,{name:t.attributeName});if(!r.length)throw new Error("Unrecognized attribute name: "+t.attributeName);if(r.length>1)throw new Error("Too many attributes with name: "+t.attributeName);return r[0]}throw new Error("Must specify attribute name or attribute ID")},ne:function(t){i.isEmpty(t.data.visitorAttributes)||(i.each(t.data.visitorAttributes,i.bind((function(t){this.J[t.id]=t}),this)),this.emitChange())}}},9092:function(t,n,e){var i=e(4816),r=e(9590),o=e(9505);t.exports={initialize:function(){this.J={variationIdMap:{},preferredLayerMap:{},contextualMabMap:{}},this.on(r.UPDATE_VARIATION_ID_MAP,this.ee),this.on(r.MERGE_VARIATION_ID_MAP,this.re),this.on(r.UPDATE_PREFERRED_LAYER_MAP,this.oe),this.on(r.MERGE_PREFERRED_LAYER_MAP,this.ae),this.on(r.UPDATE_CONTEXTUAL_MAB_MAP,this.ue),this.on(r.MERGE_CONTEXTUAL_MAB_MAP,this.ce)},getContextualMabMap:function(){return i.cloneDeep(this.J.contextualMabMap)},getContextualMabMapString:function(){return o.stringify(this.J.contextualMabMap)},ue:function(t){var n=this.J.contextualMabMap[t.layerId]||{};i.isEqual(n[t.experimentId],t.variationData)||(n[t.experimentId]=t.variationData,this.J.contextualMabMap[t.layerId]=n,this.emitChange())},ce:function(t){var n=this.J.contextualMabMap;i.forEach(t.contextualMabMap,(function(t,e){n[e]||(n[e]={}),i.forEach(t,(function(t,i){n[e][i]||(n[e][i]=t)}))})),this.J.contextualMabMap=n,this.emitChange()},getVariationIdMap:function(){return i.cloneDeep(this.J.variationIdMap)},getVariationIdMapString:function(){return o.stringify(this.J.variationIdMap)},ee:function(t){var n=this.J.variationIdMap[t.layerId]||{};n[t.experimentId]!==t.variationId&&(n[t.experimentId]=t.variationId,this.J.variationIdMap[t.layerId]=n,this.emitChange())},re:function(t){var n=this.getVariationIdMap(),e=t.variationIdMap;i.each(n||{},(function(t,n){e[n]?i.assign(e[n],t):e[n]=t})),this.J.variationIdMap=e,this.emitChange()},getPreferredLayerMap:function(){return i.cloneDeep(this.J.preferredLayerMap)},getPreferredLayerMapString:function(){return o.stringify(this.J.preferredLayerMap)},getPreferredLayerId:function(t){return this.J.preferredLayerMap[t]},oe:function(t){this.J.preferredLayerMap[t.groupId]!==t.layerId&&(this.J.preferredLayerMap[t.groupId]=t.layerId,this.emitChange())},ae:function(t){var n=this.getPreferredLayerMap(),e=t.preferredLayerMap;i.assign(e,n),this.J.preferredLayerMap=e,this.emitChange()}}},310:function(t,n,e){e(4816);var i=e(9590);e(1215).j;t.exports={initialize:function(){this.J={events:[],foreignEvents:{},foreignEventQueues:{}},this.on(i.SET_VISITOR_EVENTS,this.ht),this.on(i.SET_FOREIGN_VISITOR_EVENTS,this.se),this.on(i.SET_FOREIGN_VISITOR_EVENT_QUEUE,this.fe)},getEvents:function(){return this.J.events},getForeignEvents:function(){return this.J.foreignEvents},getForeignEventQueues:function(){return this.J.foreignEventQueues},ht:function(t){this.J.events=t,this.emitChange()},se:function(t){this.J.foreignEvents[t.key]=t.value},fe:function(t){this.J.foreignEventQueues[t.key]=t.value}}},4685:function(t,n,e){var i=e(9590);t.exports={initialize:function(){this.J={baseMap:{},eventQueue:[],lastEvent:null,initialized:!1,cleared:!1},this.on(i.UPDATE_BEHAVIOR_STORE,this.le)},getBaseMap:function(){return this.J.baseMap},getEventQueue:function(){return this.J.eventQueue},getLastEvent:function(){return this.J.lastEvent},getCleared:function(){return this.J.cleared},getInitialized:function(){return this.J.initialized},le:function(t){this.J[t.key]=t.value}}},275:function(t,n,e){var i=e(4816),r=e(9590);t.exports={initialize:function(){this.J={randomId:null,visitorIdLocator:null},this.on(r.SET_VISITOR_ID,this.ht),this.on(r.DATA_LOADED,this.de)},getBucketingId:function(){return this.getRandomId()},getRandomId:function(){return this.J.randomId},getVisitorIdLocator:function(){return this.J.visitorIdLocator},ht:function(t){i.extend(this.J,t),this.emitChange()},de:function(t){i.isEmpty(t.data.visitorIdLocator)||(this.J.visitorIdLocator=t.data.visitorIdLocator,this.emitChange())}}},3666:function(t,n,e){var i=e(4816),r=e(7936),o=e(9590);t.exports={initialize:function(){this.J={frames:[],defaultFrame:null,messages:[],subscribers:[],canonicalOrigins:null,disabled:!1},this.on(o.XDOMAIN_SET_DEFAULT_FRAME,this.ve),this.on(o.XDOMAIN_ADD_FRAME,this.he),this.on(o.XDOMAIN_SET_MESSAGE,this.pe),this.on(o.XDOMAIN_ADD_SUBSCRIBER,this.ge),this.on(o.XDOMAIN_SET_CANONICAL_ORIGINS,this.me),this.on(o.XDOMAIN_SET_DISABLED,this._e)},getMessages:function(){return i.cloneDeep(this.J.messages)},getOffset:function(){return 0===this.J.messages.length?0:this.J.messages[0].data.id},getNextMessageId:function(){return this.J.messages.length+this.getOffset()},getMessageById:function(t){return this.J.messages[t-this.getOffset()]},getSubscribers:function(){return this.J.subscribers},getFrames:function(){return this.J.frames},getNextFrameId:function(){return this.J.frames.length},getDefaultFrame:function(){return this.J.defaultFrame},getCanonicalOrigins:function(){return i.cloneDeep(this.J.canonicalOrigins)},isDisabled:function(){return this.J.disabled},ve:function(t){this.J.defaultFrame=t},he:function(t){this.J.frames.push(t)},pe:function(t){for(this.J.messages[t.messageId-this.getOffset()]=t.message;this.J.messages.length>1e3;){var n=this.J.messages.shift();r.debug("XDomainStorage: Cleared old message: "+n.data.id)}},ge:function(t){this.J.subscribers.push(t.subscriber)},me:function(t){this.J.canonicalOrigins=t.canonicalOrigins},_e:function(t){this.J.disabled=t.disabled}}},2524:function(t,n){n.locatorType={CSS_SELECTOR:"css_selector",JAVASCRIPT:"javascript",URL_REGEX:"url_regex"},n.valueType={STRING:"string",NUMBER:"number",CURRENCY:"currency"},n.nodeNames={INPUT:"INPUT",SELECT:"SELECT"}},8872:function(t,n,e){var i=e(8064).U;n.Error=i("TagError")},6530:function(t,n,e){var i=e(8738).PluginTypes,r=e(9932).get("stores/plugins");n.getTagValue=function(t){var e=r.getPlugin(i.viewTagLocators,t.locatorType);if(!e)throw new n.Error("No locator registered for tag locatorType: "+t.locatorType);return e(t)},n.enums=e(2524),n.Error=e(8872).Error},5289:function(t,n,e){var i=e(2524),r=e(8872).Error;function o(t,n,e){var i=new RegExp("^\\s*([+-]?)\\s*((\\d+)((?:\\"+n+"\\d{3})+)?)(?:\\"+e+"(\\d+))?\\s*$"),r=t.match(i);if(!r)return NaN;var o=r[3],a=r[4],u=r[5];if(a&&!u&&o.length>3&&4===a.length||!a&&o.length<=3&&u&&3===u.length)return NaN;var c=r[1],s=r[2].replace(new RegExp("\\"+n,"g"),"");return Number(c+s+(u?"."+u:""))}function a(t){var n=o(t=String(t),",",".");return isNaN(n)&&(n=o(t,".",",")),n}t.exports=function(t,n){var e;switch(t){case i.valueType.STRING:return n?String(n):"";case i.valueType.NUMBER:if(e=a(n),isNaN(e))throw new r('"'+n+'" cannot be parsed as a number');return e;case i.valueType.CURRENCY:if(e=a(e=String(n).replace(/^[^\d\,\.\-]*/g,"").replace(/[^\d\,\.\-]*$/g,"")),isNaN(e))throw new r('"'+n+'" cannot be parsed as currency');return Math.round(100*e)}throw new r("Unknown ViewTag type: "+t)}},9621:function(t,n,e){var i=e(9590),r=e(349),o=e(212).Promise,a=e(9932).get("stores/async_request");n.makeAsyncRequest=function(t,n){var e,u,c=a.getPromise(t);if(c)return c;var s=new o((function(t,n){e=t,u=n}));return r.dispatch(i.REGISTER_ASYNC_DEFERRED,{source:t,promise:s,resolver:e,rejecter:u}),n&&n(),s},n.resolveRequest=function(t,n){r.dispatch(i.RESOLVE_DEFERRED,{source:t,resolveWith:n})},n.rejectRequest=function(t,n){r.dispatch(i.REJECT_DEFERRED,{source:t,rejectWith:n})}},7266:function(t,n,e){var i=e(3485),r=e(5343);n.getLanguage=function(){return r.getNavigatorLanguage()},n.getQueryParams=i.getQueryParams,n.getQueryParamValue=i.getQueryParamValue,n.getUrl=function(){return r.getHref()}},7690:function(t,n,e){var i=e(4816),r=e(8064).U,o=e(8701),a=e(8416),u=e(5343),c=e(9590),s=e(9932),f=e(349),l=s.get("stores/cookie_options"),d=n.SetError=r("CookieSetError"),v=n.MismatchError=r("CookieMismatchError");n.getAll=function(t){var e,r,o,u,c;i.isUndefined(t)&&(t=!0),e=a.getCookieString().split(/\s*;\s*/);var s={};for(o=0;o<e.length;o++)if((u=(r=e[o]).indexOf("="))>0&&void 0===s[c=n.safeDecodeURIComponent(r.substring(0,u))]){var f=r.substring(u+1);t&&(f=n.safeDecodeURIComponent(f)),s[c]=f}return s},n.safeDecodeURIComponent=function(t){try{return decodeURIComponent(t)}catch(n){return t}},n.get=function(t,e){return n.getAll(e)[t]},n.set=function(t,e,r,s){r=i.extend({encodeValue:!0},r),!1!==s&&(s=!0);var g=[];if(i.isUndefined(r.domain)){var m=l.getCurrentDomain();m||(m=function(t,e){!1!==e&&(e=!0);for(var r,o,a=t.hostname.split("."),u=[],s=null,l=a.length-1;l>=0;l--)if(u.unshift(a[l]),r=u.join("."),!i.includes(h,r)){o={domain:e?"."+r:r};try{n.set(p,Math.random().toString(),o),n.remove(p,o),s=o.domain;break}catch(d){}}return f.dispatch(c.SET_COOKIE_DOMAIN,s),s}(u.getLocation(),!0)),r.domain=m}if(r.domain&&g.push("domain="+r.domain),i.isUndefined(r.path)&&(r.path="/"),r.path&&g.push("path="+r.path),i.isUndefined(r.expires)){var _=i.isUndefined(r.maxAge)?l.getDefaultAgeInSeconds():r.maxAge;r.expires=new Date(o.now()+1e3*_)}if(i.isUndefined(r.expires)||g.push("expires="+r.expires.toUTCString()),r.secure&&g.push("secure"),a.setCookie(t+"="+(r.encodeValue?encodeURIComponent(e):e)+";"+g.join(";")),s){var w=r.encodeValue,y=n.get(t,w);if(y!==e){if(!y)throw new d('Failed to set cookie "'+t+'"');throw new v('Expected "'+e+'" for "'+t+'", got "'+y+'"')}}},n.remove=function(t,e){for(var r=u.getLocation().hostname.split(".");r.length>0;)n.set(t,null,i.extend({},e,{domain:"."+r.join("."),expires:new Date(0)}),!1),r.shift()};var h=["optimizely.test"],p="optimizelyDomainTestCookie"},8064:function(t,n,e){var i=e(8397),r=i("InternalError");n.G=r,n.U=function(t){return i(t,r)}},4255:function(t,n,e){var i=e(4816),r=e(212).Promise;t.exports=function(){var t,n,e=new r((function(e,i){t=e,n=i}));return e.resolve=function(){return t.apply(null,i.toArray(arguments)),e},e.reject=function(){return n.apply(null,i.toArray(arguments)),e},e}},6836:function(t,n,e){var i=e(4816);n.deepFreeze=function(t){},n.safeReference=function(t){return i.cloneDeep(t)}},6094:function(t,n,e){var i=e(4816);n.getFieldValue=function(t,n){i.isArray(n)||(n=[n]);for(var e=t,r=0;r<n.length;r++){var o=n[r];if(!i.isObject(e)||!e.hasOwnProperty(o))return;e=e[o]}return e},n.setFieldValue=function(t,n,e){if(!i.isArray(n)||i.isEmpty(n))throw new Error("Attempted to set an invalid key path: "+n);for(var r=t,o=0;o<n.length-1;o++){var a=n[o];i.isObject(r[a])||(r[a]={}),r=r[a]}r[n[n.length-1]]=e}},7936:function(t,n,e){var i=e(4816),r=e(9590),o=e(8701),a=e(8738),u=e(349),c=e(9505);function s(){this.logLevel=null,this.logMatch=null,this.logs=[],this.timebase=o.now()}s.prototype.we=function(){return!i.isNull(this.logLevel)},s.prototype.setLogLevel=function(t){var n=this.ye(t);null===n?console.error("Unknown log level: "+t):this.logLevel!==n&&(this.log("Setting log level to "+n),this.logLevel=n,this.flush())},s.prototype.setLogMatcher=function(t){i.isString(t)?this.logMatcher=t:this.logMatcher="",this.logGroup=0},s.prototype.shouldLog=function(t){return this.we()&&this.logLevel>=t},s.prototype.matchesLogMessage=function(t,n){var e=this.logMatcher;if(!this.logMatcher)return!0;if(this.logGroup)return"GROUPSTART"===t?this.logGroup++:"GROUPEND"===t&&this.logGroup--,!0;var r=i.some(n,(function(t){if(!i.isString(t))try{t=c.stringify(t)}catch(n){}return i.isString(t)&&i.includes(t,e)}));return r&&"GROUPSTART"===t&&this.logGroup++,r},s.prototype.storeLog=function(t,n){var e={logLevel:t,logMessage:n};u.dispatch(r.LOG,e)},s.prototype.flush=function(){var t=e(9932).get("stores/log");this.logGroup=0;var n=t.getLogs();i.each(n,i.bind((function(t){this.be(t.logLevel,t.logMessage,!0)}),this))},s.prototype.be=function(t,n,e){var r,o=t;if(console)switch(t){case"GROUPSTART":r=console.groupCollapsed,o=a.LogLevel.DEBUG;break;case"GROUPEND":r=console.groupEnd,o=a.LogLevel.DEBUG;break;case a.LogLevel.ERROR:r=console.error;break;case a.LogLevel.WARN:r=console.warn;break;case a.LogLevel.DEBUG:r=console.debug;break;default:r=console.log}try{e||this.we()&&!this.shouldLog(o)||(i.isArray(n)&&i.isString(n[0])&&(n=this.Ee(n)),this.storeLog(t,n)),r&&this.shouldLog(o)&&this.matchesLogMessage(t,n)&&r.apply(console,n)}catch(u){console&&(console.error?console.error(u):console.log(u))}},s.prototype.debug=function(){this.be(a.LogLevel.DEBUG,[].slice.call(arguments))},s.prototype.log=function(){this.be(a.LogLevel.INFO,[].slice.call(arguments))},s.prototype.logAlways=function(){var t=this.Ee([].slice.call(arguments));console&&console.log&&console.log.apply&&console.log.apply(console,t),this.storeLog(a.LogLevel.INFO,t)},s.prototype.warn=function(){this.be(a.LogLevel.WARN,[].slice.call(arguments))},s.prototype.error=function(t){var n=[].slice.call(arguments);1===n.length&&t.stack?(this.be(a.LogLevel.ERROR,[this.Ie(),t]),this.be(a.LogLevel.INFO,[t.stack])):this.be(a.LogLevel.ERROR,n)},s.prototype.groupCollapsed=function(){this.be("GROUPSTART",[].slice.call(arguments))},s.prototype.groupEnd=function(){this.be("GROUPEND",[].slice.call(arguments))},s.prototype.Ee=function(t){var n=this.Ie().toString();return n.length<6&&(n=("     "+n).slice(-6)),[n+"| Optly / "+t[0]].concat(t.slice(1))},s.prototype.Ie=function(){return this.timebase?o.now()-this.timebase:0},s.prototype.ye=function(t){return t&&("TRUE"===(t=t.toUpperCase())&&(t="INFO"),"FALSE"===t&&(t="OFF"),"ALL"===t&&(t="DEBUG"),!i.isUndefined(a.LogLevel[t]))?a.LogLevel[t]:null},t.exports=new s},3253:function(t,n,e){var i;i=e(2175),t.exports=i},3008:function(t,n){n.isSingleExperimentPolicy=function(t){return"single_experiment"===t||"multivariate"===t}},9801:function(t,n,e){var i=e(4816),r=e(212).Promise,o=e(5343);n.pollFor=function(t,n,e){var a,u;return i.isFunction(e)?u=e:(a=e||100,u=function(){return--a<-1}),n=n||50,new r((function(e,i){!function r(){var a;if(!u()){try{var c=t();if(c)return e(c)}catch(s){a=s}return o.setTimeout(r,n)}i(a||new Error("Poll timed out"))}()}))}},2896:function(t,n,e){var i=e(4816),r=e(212).Promise;n.firstToResolve=function(t){return new r((function(n){i.each(t,(function(t){r.resolve(t).then(n,(function(){}))}))}))}},3485:function(t,n,e){var i=e(4816),r=e(5343);n.getQueryParams=function(){var t=r.getLocationSearch()||"";if(0===t.indexOf("?")&&(t=t.substring(1)),0===t.length)return[];for(var n=t.split("&"),e=[],i=0;i<n.length;i++){var o="",a="",u=n[i].split("=");u.length>0&&(o=u[0]),u.length>1&&(a=u[1]),e.push([o,a])}return e},n.getQueryParamValue=function(t){for(var e=n.getQueryParams(),i=0;i<e.length;i++)if(e[i][0]===t)return e[i][1]},n.queryStringFromMap=function(t){return i.map(t,(function(t,n){return n+"="+t})).join("&")}},8810:function(t,n,e){var i=e(4816),r=e(7936),o=e(5343);function a(t){this.windowLength=t,this.count=0,this.listeners={},this.isIncrementingTick=!1}a.prototype.countCurrentTick=function(){this.isIncrementingTick||(this.isIncrementingTick=!0,this.increment(),o.setTimeout(i.bind((function(){this.isIncrementingTick=!1}),this),0))},a.prototype.increment=function(){this.count+=1,i.forEach(this.listeners[String(this.count)],(function(t){t()})),o.setTimeout(i.bind(this.decrement,this),this.windowLength)},a.prototype.decrement=function(){this.count-=1,this.count<0&&(r.warn("Decremented down to negative count: ",this.count),this.count=0)},a.prototype.addListener=function(t,n){this.listeners[t]||(this.listeners[t]=[]),this.listeners[t].push(n)},t.exports=a},7179:function(t,n,e){var i=e(4816),r=e(9932).get("stores/observed_redirect");n.getReferrer=function(){var t=r.get();return t?t.referrer:null},n.getExperimentAndVariation=function(){var t=r.get();return t&&i.isString(t.variationId)?i.pick(t,["experimentId","variationId"]):null}},3768:function(t,n,e){var i=e(4816),r=e(9590),o=e(8701),a=e(9932),u=e(8416),c=e(8738),s=e(349),f=e(7936),l=a.get("stores/sandbox"),d=e(5343);n.shouldSandbox=function(){return!1},n.get=function(t){if(!t)throw new Error("Name is required");if(n.shouldSandbox()){l.isInitialized()||v();var e=l.get(t);if(e)return e}return d.getGlobal(t)};var v=function(){try{var t="optimizely_"+o.now(),n=u.createElement("iframe");n.name=t,n.style.display="none",u.appendToHead(n);var e=n.contentWindow,a=n.contentDocument;a.write("<scr"),a.write("ipt></scr"),a.write("ipt>"),a.close();var l=i.mapValues(c.SandboxedFunctions,(function(t){return e[t]}));s.dispatch(r.SANDBOXED_FUNCTIONS_ADDED,{sandboxedFunctions:l})}catch(d){f.warn("Unable to create a sandbox: ",d)}}},9787:function(t,n,e){var i=e(8416),r=e(7936),o=e(9895);n.addScriptAsync=function(t,n){var e=i.querySelector("head"),o=i.createElement("script");o.type="text/javascript",o.async=!0,o.src=t,n&&(o.onload=n),e.insertBefore(o,e.firstChild),r.debug("Asynchronously requesting "+t)},n.addScriptSync=function(t,e){try{var a="optimizely_synchronous_script_"+Math.floor(1e5*Math.random());if(-1!==t.indexOf('"'))return void r.error("Blocked attempt to load unsafe script: "+t);i.write("<scr"),i.write('ipt id="'+a+'" src="'+t+'"></scr'),i.write("ipt>");var u=i.querySelector("#"+a);if(!u)throw new Error("DocumentEnv.write failed to append script");u.onload=e,u.onerror=function(i){r.warn("Failed to load script ("+t+") synchronously:",i),n.addScriptAsync(t,e)}}catch(c){r.debug("DocumentEnv.write failed for "+t+": "+c.message);return o.request({url:t,async:!1,contentType:"text/plain",success:function(t){new Function(t.responseText)(),e&&e()}})["catch"]((function(i){r.error("Failed to load "+t+" via synchronous XHR: "+i.message),n.addScriptAsync(t,e)}))}}},3406:function(t,n,e){var i=e(212).Promise,r=e(5343);n.makeTimeoutPromise=function(t){return new i((function(n,e){r.setTimeout((function(){e(new Error("Timed out after "+t+" ms"))}),t)}))}},6349:function(t,n,e){var i=e(4816),r=e(2826),o=e(5343),a=e(9590),u=e(9932),c=e(349),s=u.get("stores/ua_data");n.get=function(){var t=s.get();return i.isEmpty(t)&&(t=r.parseUA(o.getUserAgent()),c.dispatch(a.SET_UA_DATA,{data:t})),t}},140:function(t,n){n.guessDomain=function(t,n){if(!t)return"";try{return n?t.match(/:\/\/(.[^/]+)/)[1]:t.match(/:\/\/(?:www[0-9]?\.)?(.[^/:]+)/)[1]}catch(e){return""}}},8340:function(t,n,e){var i=e(4816),r=e(212).Promise,o=e(9590),a=e(9932),u=e(349),c=e(4248),s=e(8064).U,f=e(8701),l=e(8416),d=e(9505),v=e(9801),h=e(1683),p=e(5343),g=e(7936),m=a.get("stores/xdomain"),_=n.Error=s("XDomainStorageError");function w(t){var n;if(i.find(m.getFrames(),{origin:t.origin})){try{n=d.parse(t.data)}catch(a){return void g.debug("XDomain","Ignoring malformed message event:",t)}if("ERROR"===n.type)u.dispatch(o.XDOMAIN_SET_DISABLED,{disabled:!0}),c.emitInternalError(new _("Xdomain Error: "+n.response));else if("SYNC"===n.type)i.each(m.getSubscribers(),(function(t){t(n.response.key,n.response.value)}));else{var e=m.getMessageById(n.id);if(!e){if(g.warn("XDomain","No stored message found for ID",n.id),i.isNumber(n.id)){var r=m.getNextMessageId();n.id>=r?c.emitInternalError(new _("Message ID is greater than expected maximum ID ("+n.id+">"+r+")")):n.id<0?c.emitInternalError(new _("Message ID is < 0: "+n.id)):c.emitInternalError(new _("No stored message found for message ID: "+n.id))}else c.emitInternalError(new _("Message ID is not a number: "+n.id));return}if(!e.resolver)return void g.warn("XDomain","Message already resolved, ignoring:",n.id);e.resolver(n.response),u.dispatch(o.XDOMAIN_SET_MESSAGE,{messageId:n.id,message:{data:{id:n.id,type:e.data.type,key:e.data.key},startTime:e.startTime,endTime:f.now()}})}}else g.debug("XDomain","No frame found for origin: "+t.origin)}function y(t,n){return n||(n=m.getDefaultFrame()),new r((function(e){var r={data:i.extend({},t,{id:m.getNextMessageId()}),resolver:e};n?m.isDisabled()||b(r,n):u.dispatch(o.XDOMAIN_SET_MESSAGE,{messageId:r.data.id,message:r})}))}function b(t,n){var e=t.data;u.dispatch(o.XDOMAIN_SET_MESSAGE,{messageId:t.data.id,message:i.extend({},t,{startTime:f.now()})}),n.target.postMessage(d.stringify(e),n.origin)}n.setItem=function(t,n,e){return y({type:"PUT",key:t,value:n},e)},n.getItem=function(t,n){return y({type:"GET",key:t},n)},n.fetchAll=function(t){return y({type:"GETALL"},t)},n.deleteData=function(t,n){return y({type:"DELETE",visitorId:t},n)},n.subscribe=function(t){u.dispatch(o.XDOMAIN_ADD_SUBSCRIBER,{subscriber:t})},n.loadIframe=function(t,n){return new r((function(e){var i=l.createElement("iframe");i.src=t+n,i.hidden=!0,i.setAttribute("tabindex","-1"),i.setAttribute("title","Optimizely Internal Frame"),i.style.display="none",i.height=0,i.width=0,i.onload=function(){var r={id:m.getNextFrameId(),target:i.contentWindow,origin:t,path:n};u.dispatch(o.XDOMAIN_ADD_FRAME,r),e(r)},l.appendTo(l.querySelector("body"),i)}))},n.getXDomainUserId=function(t,n){var e,r={},o=i.keys(t);return i.each(n,(function(t){r[t]=[],i.each(o,(function(n){var o=h.getUserIdFromKey(n,t);!e&&o&&(e=o),o&&!i.includes(r[t],o)&&r[t].push(o)}))})),g.debug("XDomain: Found userIds:",r),e},n.load=function(t,e){p.addEventListener("message",w);return v.pollFor((function(){return!!l.querySelector("body")})).then((function(){return n.loadIframe(t,e)})).then((function(t){u.dispatch(o.XDOMAIN_SET_DEFAULT_FRAME,t),m.isDisabled()||i.each(m.getMessages(),(function(n){n.startTime||b(n,t)}))}))}},9895:function(t,n,e){var i=e(4816),r=e(9590),o=e(8701),a=e(349),u=e(9505),c=e(7936),s=e(212).Promise,f=e(3768);n.isCORSSupported=function(){return"withCredentials"in new(f.get("XMLHttpRequest"))},n.request=function(t){return t=i.extend({method:"GET",async:!0,contentType:"text/plain;charset=UTF-8"},t),new s((function(e,r){if(!n.isCORSSupported())return r("CORS is not supported");var o=new(f.get("XMLHttpRequest"));o.onload=function(){t.success&&t.success(o),e(o)},o.onerror=function(){t.error&&t.error(o),r(o)},i.isObject(t.data)&&(t.data=u.stringify(t.data)),o.open(t.method,t.url,t.async),t.withCredentials&&(o.withCredentials=t.withCredentials),o.setRequestHeader("Content-Type",t.contentType),i.isObject(t.headers)&&i.forEach(t.headers,(function(t,n){o.setRequestHeader(n,t)})),o.send(t.data)}))},n.retryableRequest=function(t,e,u,f){if(!e)return s.reject(new Error("No id specified for request."));if(!n.isCORSSupported())return s.reject(new Error("CORS is not supported."));i.isUndefined(f)&&(f=3),i.isUndefined(u)&&(u=0);var l={id:e,timeStamp:o.now(),data:t,retryCount:u};return a.dispatch(r.SET_PENDING_EVENT,l),c.debug("Sending event ",e),n.request(t).then((function(t){return a.dispatch(r.REMOVE_PENDING_EVENT,{id:e}),t}),(function(t){throw l.retryCount>=f?(a.dispatch(r.REMOVE_PENDING_EVENT,{id:e}),c.warn("Event ",l," could not be sent after ",f," attempts.")):(l.retryCount++,a.dispatch(r.SET_PENDING_EVENT,l),c.debug("Event ",l," failed to send, with error ",t," It will be retried ",f-u," times.")),t}))},n.sendBeacon=n.request},4927:function(t,n,e){var i=e(4816),r=e(9590),o=e(8136),a=e(5175),u=e(8701),c=e(9932),s=e(8738),f=e(6787),l=e(349),d=e(7936),v=e(6530),h=c.get("stores/event_data"),p=c.get("stores/plugins"),g=c.get("stores/rum"),m=c.get("stores/view"),_=c.get("stores/view_data");function w(t,n){i.forEach(t,(function(t){if(t.eventType!==f.CUSTOM){var e=p.getPlugin(s.PluginTypes.eventImplementations,t.eventType);e?n?e.attach(t):e.detach(t):d.warn("No implementation found for event type:",t.eventType,"needed for event:",t)}}))}n.parseViewTags=function(t){var e=n.evaluateViewTags(t);n.setParsedViewTags(t.id,e)},n.updateAllViewTags=function(){var t=m.getActiveViewStates();i.each(t,(function(t){var e=_.get(t.id);n.parseViewTags(e)}))},n.evaluateViewTags=function(t){return t.tags?i.reduce(t.tags,(function(t,n){try{t[n.apiName]=v.getTagValue(n)}catch(r){e=r,(null!=(i=v.Error)&&"undefined"!=typeof Symbol&&i[Symbol.hasInstance]?i[Symbol.hasInstance](e):e instanceof i)?d.warn("Page / Ignoring unparseable tag",n,r):d.error(r)}var e,i;return t}),{}):{}},n.createViewTicket=function(){var t={};return i.each(p.getAllPlugins(s.PluginTypes.viewProviders),(function(n){t[n.provides]=c.evaluate(n.getter)})),t},n.registerViews=function(t){l.dispatch(r.REGISTER_VIEWS,{views:t})},n.activateViaAPI=function(t,e){e&&n.setUserSuppliedViewTags(t.id,e),n.activateMultiple([t],e)},n.getViewsAndActivate=function(t){var e=_.getAllViewsForActivationType(t);n.activateMultiple(e)},n.activateMultiple=function(t,e){var a=[];return i.each(t,(function(t){var u=m.getViewState(t.id),c=n.createViewTicket();if(u.isActive)if(t.deactivationEnabled)try{n.hasValidStaticConditions(t,c)||n.deactivate(t)}catch(v){d.error("Page / Error evaluating whether to deactivate page ",n.description(t),v)}else d.log("Not activating Page, already active ",n.description(t));else{try{if(!n.hasValidStaticConditions(t,c))return i.isBoolean(u.isActive)||n.setViewActiveState(t,!1),void d.log("Page / Failed to match page conditions for "+n.description(t),t.staticConditions)}catch(v){return i.isBoolean(u.isActive)||n.setViewActiveState(t,!1),void d.error("Page / Error evaluating whether to activate page ",n.description(t),v)}if(a.push(t),n.setViewActiveState(t,!0),d.log("Activated Page",n.description(t)),o.emitViewActivated({view:t,metadata:e}),g.getSampleRum()){var f=t.activationType||s.ViewActivationTypes.immediate;l.dispatch(r.RECORD_ACTIVATION_TYPE_USAGE,{activationType:f,entityId:t.id})}w(h.getByPageId(t.id),!0)}})),i.isEmpty(a)||o.emitViewsActivated({views:a}),a},n.deactivate=function(t){m.getViewState(t.id).isActive?(n.setViewActiveState(t,!1),d.log("Deactivated Page",n.description(t)),o.emitPageDeactivated({page:t}),w(h.getByPageId(t.id),!1)):d.log("Not deactivating Page, already inactive ",n.description(t))},n.setViewActiveState=function(t,n){l.dispatch(r.SET_VIEW_ACTIVE_STATE,{view:t,timestamp:u.now(),isActive:n})},n.setGlobalTags=function(t){l.dispatch(r.SET_GLOBAL_TAGS,t)},n.setParsedViewTags=function(t,n){l.dispatch(r.UPDATE_PARSED_VIEW_METADATA,{pageId:t,metadata:n})},n.setUserSuppliedViewTags=function(t,n){l.dispatch(r.UPDATE_USER_SUPPLIED_METADATA,{pageId:t,metadata:n})},n.hasValidStaticConditions=function(t,n){var e={};if(i.isEmpty(t.staticConditions))return!0;var o=p.getAllPlugins(s.PluginTypes.viewMatchers);d.groupCollapsed("Page / Evaluating staticConditions:",t.staticConditions),d.debug("Matching to current value:",n);var u=a.evaluate(t.staticConditions,(function(t){var i=t.type,r=o[i];if(!r)throw new Error("Page / No matcher found for type="+i);return r&&(e[t.type]||(e[t.type]=!0)),r.match(n,t)}));return d.groupEnd(),g.getSampleRum()&&u&&l.dispatch(r.RECORD_VIEW_FEATURE_USAGE,{featuresUsed:i.keys(e),entityId:t.id}),u},n.description=function(t){return'"'+t.name+'" ('+t.id+")"},n.isActivationTypeImmediate=function(t){return t===s.ViewActivationTypes.immediate||!t},n.shouldTriggerImmediately=function(t){return t===s.ViewActivationTypes.DOMChanged||t===s.ViewActivationTypes.URLChanged||t===s.ViewActivationTypes.immediate||!t},n.create=function(t,n){return{id:t,apiName:n,category:"other"}},n.createState=function(t){return{id:t,isActive:!0,metadata:{},parsedMetadata:{},userSuppliedMetadata:{}}}},1683:function(t,n,e){var i,r=e(4816),o=e(349),a=e(9590),u=e(1623),c=e(2755),s=e(7690),f=e(8701),l=e(9932),d=e(8738),v=e(9505),h=e(6094),p=e(871).mM,g=e(7936),m=e(212).Promise,_=e(3485),w=e(8738).VisitorStorageKeys,y=e(5343);i=e(8340);var b=l.get("stores/cookie_options"),E=l.get("stores/global"),I=l.get("stores/layer"),A=l.get("stores/plugins"),T=l.get("stores/rum"),S=l.get("stores/session"),k=l.get("stores/visitor_id"),R=l.get("stores/visitor_bucketing"),N=l.get("stores/visitor"),C=l.get("stores/provider_status");function D(t,n){var e=function(t,e){var i;n.attributionType&&(i=f.now()),o.dispatch(a.SET_VISITOR_ATTRIBUTES,{attributes:[{key:t,value:e,metadata:{lastModified:i}}]})};if(n.getter){var i=n.provides;if(r.isArray(i)||(i=[i]),!(n.isSticky&&!r.isUndefined(h.getFieldValue(t,i)))){var u;try{var c=l.evaluate(n.getter);r.isFunction(c)&&(c=c((function(){return h.getFieldValue(t,i)}),(function(t){e(i,t)}))),r.isUndefined(c)||(n.isAsync?(u=c.then((function(t){e(i,t)}),(function(t){g.warn('Failed to evaluate provider for "'+n.provides+'"; error was:',t)})),o.dispatch(a.SET_VISITOR_ATTRIBUTE_PENDING,{key:i,pending:u})):e(i,c))}catch(s){g.warn('Failed to evaluate getter for provider for "'+n.provides+'"; error was: '+s.message)}return u}}}function O(t){var n=P(t),e=p.getItem(n);return r.isString(e)&&(e=V(e)),e}function x(t){var n;if(t.layerId)n=t;else{var e=t;n={layerId:e.i,pageId:e.p,decisionTimestamp:e.t,decisionTicket:{audienceIds:e.a||[]},decision:{layerId:e.i,experimentId:e.x||null,variationId:e.v||null,isLayerHoldback:e.h||!1}}}return n}function M(t,n,e){try{var r=P(t);e||(n=v.stringify(n));try{p.setItem(r,n)}catch(o){throw g.warn("Visitor / Unable to set localStorage key, error was:",o),new Error("Unable to set localStorage")}i.setItem(r,n)}catch(o){g.warn("Unable to persist visitor data:",o.message)}}function P(t){var e=k.getBucketingId();if(!e)throw new Error("Visitor bucketingId not set");var i=n.getNamespace();if(!i)throw new Error("Namespace is not set");return[e,i,t].join("$$")}function L(t,e){if(!k.getBucketingId())throw new Error("Cannot update local store because bucketingId not set");if(U(t)){var i=n.getStorageKeyFromKey(t);if(r.includes(w,i)){var u=P(i);if(!(t.indexOf(u)<=0)&&(e=V(e)))if(i===w.EVENT_QUEUE)o.dispatch(a.SET_FOREIGN_VISITOR_EVENT_QUEUE,{key:t,value:c.deserialize(e)});else if(i===w.EVENTS)o.dispatch(a.SET_FOREIGN_VISITOR_EVENTS,{key:t,value:c.deserialize(e)});else if(i===w.LAYER_STATES)o.dispatch(a.LOAD_PERSISTED_LAYER_STATES,{layerStates:r.map(e,x),merge:!0});else if(i===w.VARIATION_MAP)o.dispatch(a.MERGE_VARIATION_ID_MAP,{variationIdMap:e});else if(i===w.CONTEXTUAL_MAB)o.dispatch(a.MERGE_CONTEXTUAL_MAB_MAP,{contextualMabMap:e});else if(i===w.VISITOR_PROFILE){var s=e;r.each(["custom"],(function(t){var n=A.getPlugin(d.PluginTypes.visitorProfileProviders,t);if(n){if(s.profile&&s.metadata){var e=function(t,n,e){var i=N.getAttribute(n),o=N.getAttributeMetadata(n),a=t.profile[n],u=t.metadata[n];if(r.isEmpty(i))return{data:a,metadata:u};var c={};return r.forOwn(a,(function(t,n){var i,a;o&&o[n]&&(i=o[n].lastModified),u&&u[n]&&(a=u[n].lastModified),(e===d.AttributionTypes.FIRST_TOUCH&&i>=a||e===d.AttributionTypes.LAST_TOUCH&&a>=i||r.isUndefined(i)&&a)&&(c.data=c.data||{},c.data[n]=t,a&&(c.metadata=c.metadata||{},c.metadata[n]=c.metadata[n]||{},c.metadata[n].lastModified=a))})),c}(s,t,n.attributionType);if(!r.isEmpty(e)){var i=[];r.forOwn(e.data,(function(n,r){var o=e.metadata[r],a={key:[t,r],value:n,metadata:o};i.push(a)})),o.dispatch(a.SET_VISITOR_ATTRIBUTES,{attributes:i})}}}else g.debug("Attribute type",t,"not used by any audiences")}))}}}}function U(t){return t.split("$$")[0].indexOf("://")>0}function V(t){try{return v.parse(t)}catch(n){return g.debug("Failed to parse: ",t,n),null}}n.getOrGenerateId=function(){return{randomId:n.getCurrentId()||"oeu"+f.now()+"r"+Math.random()}},n.getCurrentId=function(){var t=k.getVisitorIdLocator();return N.getVisitorIdFromAPI()||(t?function(t){var n,e=t.name;switch(t.type){case d.VisitorIdLocatorType.COOKIE:n=s.get(e);break;case d.VisitorIdLocatorType.JS_VARIABLE:n=y.getGlobalByPath(e);break;case d.VisitorIdLocatorType.LOCALSTORAGE:try{n=y.getGlobal("localStorage").getItem(e)}catch(u){throw new Error("Unable to read localStorage: "+u.toString())}break;case d.VisitorIdLocatorType.QUERY:n=_.getQueryParamValue(e)}try{if(!n)throw g.error("Visitor / Customer provided visitor id cannot be found. Type:",t.type," Name:",e),new Error("Failure to obtain visitor id from "+t.type);if(!r.isString(n)&&!r.isNumber(n))throw g.error("Visitor / Customer provided visitor id is not a string or number. Type:",t.type," Name:",e," Id Type:",(i=n)&&"undefined"!=typeof Symbol&&i.constructor===Symbol?"symbol":typeof i),new Error("Customer provided visitor id is not a string or number")}catch(c){throw T.getSampleRum()&&o.dispatch(a.RECORD_VISITOR_ID_ERROR,{isError:!0}),c}var i;T.getSampleRum()&&(o.dispatch(a.RECORD_VISITOR_ID_ERROR,{isError:!1}),o.dispatch(a.RECORD_VISITOR_ID_LOCATOR_USAGE,{visitorIdLocatorType:t.type,entityId:n}));return String(n)}(t):s.get(d.COOKIES.VISITOR_ID))},n.hasSomeData=function(){return p.keys().length>0},n.setId=function(t){var e,c,f=k.getBucketingId();o.dispatch(a.SET_VISITOR_ID,t),k.getBucketingId()!==f&&(!function(){!function(t,n){0;u.initializeStore(t,n)}(O(w.EVENTS)||[],O(w.EVENT_QUEUE)||[]);var t=(e=w.LAYER_STATES,i=k.getBucketingId(),c=[],s=new RegExp(i+"\\$\\$([^$]+?)\\$\\$"+e),r.each(p.keys(),(function(t){var n=t.match(s);if(n){var e={namespace:n[1],userId:i,item:V(p.getItem(t))};c.push(e)}})),c);var e,i,c,s;r.forEach(t,(function(t){t.item=r.map(t.item,x)})),l=t,v=[],r.each(l,(function(t){r.each(t.item,(function(n){n.namespace=t.namespace,v.push(n)}))})),g=v,o.dispatch(a.LOAD_PERSISTED_LAYER_STATES,{layerStates:r.filter(g,(function(t){return!!t.decision}))}),h=O(w.SESSION_STATE)||{},h=r.extend({lastSessionTimestamp:0,sessionId:null},h),o.dispatch(a.LOAD_SESSION_STATE,h),function(t){var n,e,i=A.getAllPlugins(d.PluginTypes.visitorProfileProviders),u=r.filter(i,(function(t){return r.isFunction(t.restorer)}));t.profile&&t.metadata?(n=t.profile,e=t.metadata):(n=t,e={});n=r.reduce(n,(function(t,n,e){var i=n,o=r.find(u,{provides:e});return o&&(i=o.restorer(n)),t[e]=i,t}),{}),o.dispatch(a.LOAD_EXISTING_VISITOR_PROFILE,{profile:n,metadata:e})}(O(w.VISITOR_PROFILE)||{});var f=O(w.TRACKER_OPTIMIZELY);f&&(m=f,o.dispatch(a.SET_TRACKER_PERSISTABLE_STATE,m));var l,v;var h;var g;var m;n.loadForeignData(),n.removeLegacySessionStateCookies()}(),n.deleteOldLocalData(),i.deleteData(t));try{k.getVisitorIdLocator()||n.maybePersistVisitorId(t)}catch(l){if(g.error("Visitor / Unable to persist visitorId, disabling tracking"),o.dispatch(a.LOAD_DIRECTIVE,{trackingDisabled:!0}),e=l,null!=(c=s.MismatchError)&&"undefined"!=typeof Symbol&&c[Symbol.hasInstance]?c[Symbol.hasInstance](e):e instanceof c)throw g.error("Visitor / Cookie not set to correct value:",l),new Error("Cookie mismatch error while persisting visitorId");throw l}n.refreshSession()},n.getVariationIdMap=function(){return O(w.VARIATION_MAP)||{}},n.updateVariationIdMap=function(t,n,e){o.dispatch(a.UPDATE_VARIATION_ID_MAP,{layerId:t,experimentId:n,variationId:e})},n.persistVariationIdMap=function(){var t=R.getVariationIdMapString();M(w.VARIATION_MAP,t,!0)},n.getContextualMabMap=function(){return O(w.CONTEXTUAL_MAB)||{}},n.updateContextualMabMap=function(t,n,e){o.dispatch(a.UPDATE_CONTEXTUAL_MAB_MAP,{layerId:t,experimentId:n,variationData:e})},n.persistContextualMabMap=function(){var t=R.getContextualMabMapString();M(w.CONTEXTUAL_MAB,t,!0)},n.getPreferredLayerMap=function(){return O(w.LAYER_MAP)||{}},n.updatePreferredLayerMap=function(t,n){o.dispatch(a.UPDATE_PREFERRED_LAYER_MAP,{groupId:t,layerId:n})},n.persistTrackerOptimizelyData=function(t){M(w.TRACKER_OPTIMIZELY,t)},n.refreshSession=function(){o.dispatch(a.REFRESH_SESSION)},n.populateEagerVisitorData=function(t,e){var i=r.filter(t,(function(t){return!t.isLazy}));return n.populateVisitorData(i,e)},n.populateLazyVisitorData=function(t,e,i){g.debug("Populating lazy visitor. List of all providers",t);var o=r.filter(t,(function(t){return t.isLazy&&i.has(t.provides)}));return g.debug("Filtered list of providers that are lazy and present in audiences",o),n.populateVisitorData(o,e)},n.populateVisitorData=function(t,n){n=n||{};var e=r.partial(D,n),i=r(t).filter({isAsync:!0}).map(e).filter().value();return r.forEach(r.filter(t,(function(t){return!t.isAsync})),e),i.length>0?m.all(i):m.resolve()},n.persistBehaviorEvents=function(t){M(w.EVENTS,t)},n.persistBehaviorEventQueue=function(t){M(w.EVENT_QUEUE,t)},n.getPersistedBehaviorEventCount=function(){var t=O(w.EVENTS)||[],n=O(w.EVENT_QUEUE)||[];return c.deserialize(t).length+c.deserialize(n).length},n.persistLayerStates=function(){var t=I.getLayerStates(n.getNamespace());t=r.map(t,(function(t){return r.omit(t,"namespace")})),M(w.LAYER_STATES,t)},n.persistSessionState=function(){M(w.SESSION_STATE,S.getState())},n.persistVisitorProfile=function(){M(w.VISITOR_PROFILE,function(){var t=N.getVisitorProfile(),n=N.getVisitorProfileMetadata(),e=A.getAllPlugins(d.PluginTypes.visitorProfileProviders);if(e){var i=r.reduce(e,(function(t,n){return n.provides&&(t[n.provides]=n),t}),{});t=r.omitBy(t,(function(t,n){var e=i[n];return e&&e.isTransient}))}return{profile:t,metadata:n}}())},n.persistVisitorBucketingStore=function(){var t;n.persistVariationIdMap(),t=R.getPreferredLayerMapString(),M(w.LAYER_MAP,t,!0),n.persistContextualMabMap()},n.getUserIdFromKey=function(t,e){var i;return r.includes(t,e)&&r.includes(t,"_")&&r.includes(t,"$$")&&r.includes(t.slice(t.indexOf("$$")),n.getNamespace())&&(i=t.slice(t.indexOf("_")+1,t.indexOf("$$"))),i},n.maybePersistVisitorId=function(t){t.randomId&&(b.getAutoRefresh()||n.getCurrentId()!==t.randomId?(s.set(d.COOKIES.VISITOR_ID,t.randomId),g.log("Persisting visitorId:",t.randomId)):g.log("Not persisting visitorId: value is not changed and also auto-refresh is disabled"))},n.getAttribute=function(t){return N.getAttribute(t)},n.getPendingAttributeValue=function(t){return C.getPendingAttributeValue(t)},n.isForeignKey=U,n.checkKeyForVisitorId=function(t){var e=k.getBucketingId()||n.getCurrentId(),i=n.getIdFromKey(t);return!i||i===e},n.getIdFromKey=function(t){var e=t.split("$$")[0],i=n.getStorageKeyFromKey(t);if(r.includes(d.StorageKeys,i))return null;var o=e.indexOf("_");return-1===o?e:e.substring(o+1)},n.getStorageKeyFromKey=function(t){var n,e=t.split("$$").pop();if(e.indexOf("://")>-1){var i=e.indexOf("_");n=e.substring(i+1)}else n=e;return r.includes(r.values(d.AllStorageKeys),n)?n:null},n.deleteOldLocalData=function(){var t=p.keys();r.each(t,(function(t){n.isForeignKey(t)||n.checkKeyForVisitorId(t)||p.removeItem(t)}))},n.deleteOldForeignData=function(){var t=p.keys();r.each(t,(function(t){n.isForeignKey(t)&&p.removeItem(t)}))},n.loadForeignData=function(){r.each(p.keys(),(function(t){var n=p.getItem(t);n&&L(t,n)}))},n.getNamespace=function(){return E.getNamespace()},n.serializeFieldKey=function(t){return r.isArray(t)?t.join("$$"):t},n.removeLegacySessionStateCookies=function(){var t=s.getAll();r.forEach(r.keys(t),(function(t){0===t.indexOf(d.COOKIES.SESSION_STATE+"$$")&&s.remove(t)}))}},4094:function(t,n,e){var i=e(4816),r=e(8738);n.normalizeClientData=function(t){!t.listTargetingKeys&&t.listTargetingCookies&&(t.listTargetingKeys=i.map(t.listTargetingCookies,(function(t){return{type:r.ListTargetingKeyTypes.COOKIE,key:t}})),delete t.listTargetingCookies)}},4979:function(t,n,e){e(9932).register("env/jquery",e(6031))},6031:function(t,n,e){var i,r=e(5343);try{i=$}catch(a){}var o=r.getGlobal("$");t.exports=i&&i!==o?i:o},371:function(t,n,e){e(4816),e(8064).G,e(8701);var i=e(9932),r=(e(8416),e(7936));e(5343),e(9895),i.get("stores/client_metadata"),i.get("stores/global");n.handleError=function(t,n){n?r.error("Uncaught error:",t,n):r.error("Uncaught error:",t)}},5954:function(t,n,e){var i=e(4816),r=e(9590),o=e(4248),a=e(9887),u=e(8064).U,c=e(4760),s=e(4255),f=e(9932).get("stores/directive"),l=e(8416),d=e(2262),v=e(349),h=e(7936),p=e(8810),g=e(9612),m=e(7044).create(),_=1e3,w=10,y=u("ChangeOverheatError");function b(t,n){if(this.change=t,this.identifier=n.identifier,this.startTime=n.startTime,f.shouldObserveChangesIndefinitely()){v.dispatch(r.INITIALIZE_CHANGE_METRICS),this.rateMeter=new p(_);var e=i.isNull(w)?Number.POSITIVE_INFINITY:w;this.rateMeter.addListener(e,i.bind((function(){h.warn("AppendChange",this,"has overheated and will no longer apply or reapply"),this.cancel(),v.dispatch(r.RECORD_CHANGE_OVERHEATED),o.emitError(new y("Change "+this.identifier+" has overheated"),{layerId:n.action&&n.action.layerId,experimentId:n.action&&n.action.experimentId,variationId:n.action&&n.action.variationId,changeId:t.id,changeType:t.type,movingWindowMilliseconds:_,maxMacroTasksInMovingWindow:e})}),this));for(var a=Math.min(e,50),u=0;u<=a;u++)this.rateMeter.addListener(u,i.partial((function(t){v.dispatch(r.RECORD_CHANGE_MACROTASK_RATE,{changeMacrotaskRate:t})}),u))}}b.prototype.numberOfRootNodes=function(t){var n=document.createElement("div");return n.innerHTML=t,n.childNodes.length},b.prototype.getSiblingElements=function(t,n,e){for(var i=t,r=[],o=0;o<n;o++)e?(r.push(i.nextSibling),i=i.nextSibling):(r.push(i.previousSibling),i=i.previousSibling);return r},b.prototype.apply=function(){this.applyDeferred=s();try{if(!this.numberOfRootNodes(this.change.value))throw new Error("No DOM elements to be created for this change: "+this.change.value);var t=i.partial(this.applyDeferred.reject,new Error("Unable to find selector.")),n={};f.shouldObserveChangesUntilTimeout()?n={timeout:i.partial(g.isTimedOut,this.startTime),onTimeout:t}:f.isEditor()&&m.waitUntil(i.partial(g.isTimedOut,this.startTime)).then(t,t),this.unobserveSelector=m.observeSelector(this.change.selector,i.bind(this.maybeApplyToElement,this),n);var e=l.querySelectorAll(this.change.selector);i.each(e,i.bind(this.maybeApplyToElement,this))}catch(r){this.applyDeferred.reject(r)}return this.applyDeferred},b.prototype.maybeApplyToElement=function(t){var n=a.CHANGE_ID_ATTRIBUTE_PREFIX+this.change.id;if(t.hasAttribute(n))return h.debug("Not applying AppendChange to element",t,"because it was inserted by this change"),void this.applyDeferred.resolve();this.rateMeter&&this.rateMeter.countCurrentTick(),i.bind(this.applyOrReapplyToElement,this,t,n)(),this.applyDeferred.resolve()},b.prototype.applyOrReapplyToElement=function(t,n){var e;switch(this.change.operator){case d.DOMInsertionType.AFTER:e=d.insertAdjacentHTMLType.AFTER_END;break;case d.DOMInsertionType.APPEND:e=d.insertAdjacentHTMLType.BEFORE_END;break;case d.DOMInsertionType.BEFORE:e=d.insertAdjacentHTMLType.BEFORE_BEGIN;break;case d.DOMInsertionType.PREPEND:e=d.insertAdjacentHTMLType.AFTER_BEGIN;break;default:e=d.insertAdjacentHTMLType.BEFORE_END}t.insertAdjacentHTML(e,this.change.value),t.setAttribute(n,""),c.setData(t,this.change.id,this.identifier,[]);var r,o,a=this.numberOfRootNodes(this.change.value)-1;e===d.insertAdjacentHTMLType.BEFORE_END?(r=t.lastChild,o=this.getSiblingElements(r,a,!1)):e===d.insertAdjacentHTMLType.AFTER_BEGIN?(r=t.firstChild,o=this.getSiblingElements(r,a,!0)):e===d.insertAdjacentHTMLType.BEFORE_BEGIN?(r=t.previousSibling,o=this.getSiblingElements(r,a,!1)):e===d.insertAdjacentHTMLType.AFTER_END&&(r=t.nextSibling,o=this.getSiblingElements(r,a,!0)),o.unshift(r),i.each(o,i.bind((function(t){var e=t.nodeType===Node.ELEMENT_NODE?t:l.parentElement(t);e.setAttribute(n,"");var r=c.getData(e,this.change.id,this.identifier)||[];r.push(t),c.setData(e,this.change.id,this.identifier,r),i.each(l.childrenOf(e),(function(t){t.setAttribute(n,"")}))}),this))},b.prototype.cancel=function(){this.unobserveSelector&&this.unobserveSelector()},b.prototype.undo=function(){var t=a.CHANGE_ID_ATTRIBUTE_PREFIX+this.change.id,n=l.querySelectorAll("["+t+"]");return i.each(n,i.bind((function(n){var e=c.getData(n,this.change.id,this.identifier)||[];i.each(e,(function(t){t.parentNode.removeChild(t)})),n.removeAttribute(t),c.removeData(n,this.change.id,this.identifier),i.each(l.childrenOf(n),(function(n){n.removeAttribute(t)}))}),this)),s().resolve(d.changeState.UNAPPLIED)},t.exports=function(t){t.registerChangeApplier(d.changeType.APPEND,b)}},8366:function(t,n,e){var i=e(4816),r=e(2262);n.transformVisibilityAttributesToCSS=function(t){if(!t.attributes)return t;if(t.attributes[r.selectorChangeType.HIDE]||t.attributes[r.selectorChangeType.REMOVE]){var n=i.extend({css:{}},i.cloneDeep(t));return t.attributes[r.selectorChangeType.HIDE]&&(n.css.visibility="hidden",delete n.attributes[r.selectorChangeType.HIDE]),t.attributes[r.selectorChangeType.REMOVE]&&(n.css.display="none",delete n.attributes[r.selectorChangeType.REMOVE]),n}return t},n.createStylesFromChange=function(t,n){if(i.isEmpty(n.css))return n.attributes.style;var e="",r=n.attributes.style||"";return i.each(n.css,(function(t,n){new RegExp(n+"\\s?:").test(r)||(e+=n+":"+t+";")})),i.isUndefined(n.attributes.style)?(t||"")+e:e+r}},1958:function(t,n,e){var i=e(4816),r=(e(212).Promise,e(9590)),o=e(4248),a=e(9887),u=e(8064).U,c=e(4760),s=e(4255),f=e(9932).get("stores/directive"),l=e(8416),d=e(2262),v=e(349),h=e(7936),p=e(6556),g=e(8810),m=e(9612),_=e(5343),w=e(8366),y=e(7044).create(),b={attributes:!0,childList:!0,subtree:!0,characterData:!0},E=1e3,I=10,A=u("ChangeOverheatError");function T(t,n){if(this.change=i.cloneDeep(t),this.change=w.transformVisibilityAttributesToCSS(this.change),this.identifier=n.identifier,this.startTime=n.startTime,this.disconnectObserverQueue=[],f.shouldObserveChangesIndefinitely()){v.dispatch(r.INITIALIZE_CHANGE_METRICS),this.rateMeter=new g(E);var e=i.isNull(I)?Number.POSITIVE_INFINITY:I;this.rateMeter.addListener(e,i.bind((function(){h.warn("AttributeChange",this,"has overheated and will no longer apply or reapply"),this.cancel(),v.dispatch(r.RECORD_CHANGE_OVERHEATED),o.emitError(new A("Change "+this.identifier+" has overheated"),{layerId:n.action&&n.action.layerId,experimentId:n.action&&n.action.experimentId,variationId:n.action&&n.action.variationId,changeId:t.id,changeType:t.type,movingWindowMilliseconds:E,maxMacroTasksInMovingWindow:e})}),this));for(var a=Math.min(e,50),u=0;u<=a;u++)this.rateMeter.addListener(u,i.partial((function(t){v.dispatch(r.RECORD_CHANGE_MACROTASK_RATE,{changeMacrotaskRate:t})}),u))}this.cancelled=!1}T.prototype.apply=function(){this.applyDeferred=s();try{if(i.isEmpty(this.change.attributes)&&i.isEmpty(this.change.css))return h.debug("Not applying empty AttributeChange"),this.applyDeferred.resolve(),this.applyDeferred;var t=i.partial(this.applyDeferred.reject,new Error("Unable to find selector.")),n={};f.shouldObserveChangesUntilTimeout()?n={timeout:i.partial(m.isTimedOut,this.startTime),onTimeout:t}:f.isEditor()&&y.waitUntil(i.partial(m.isTimedOut,this.startTime)).then(t,t),this.unobserveSelector=y.observeSelector(this.change.selector,i.bind(this.maybeApplyToElement,this),n);var e=l.querySelectorAll(this.change.selector);i.each(e,i.bind(this.maybeApplyToElement,this))}catch(r){this.applyDeferred.reject(r)}return this.applyDeferred},T.prototype.maybeApplyToElement=function(t){var n=a.CHANGE_ID_ATTRIBUTE_PREFIX+this.change.id;if(t.hasAttribute(n))return h.debug("AttributeChange not being applied. Element already changed, or is a child of an element that was changed by this AttributeChange. "+t),void this.applyDeferred.resolve();this.rateMeter&&this.rateMeter.countCurrentTick();var e=i.bind(this.applyOrReapplyToElement,this,t,n);e();var r=i.bind((function(){var n=i.bind((function(){this.cancelled||p.observe(o,t,b)}),this);return _.setTimeout(n)}),this),o=p.create(i.bind((function(){this.rateMeter&&this.rateMeter.countCurrentTick(),o.disconnect(),e(),r()}),this));r(),this.disconnectObserverQueue.push(i.bind(o.disconnect,o)),this.applyDeferred.resolve()},T.prototype.applyOrReapplyToElement=function(t,n){var e={};i.forOwn(this.change.attributes,(function(r,o){switch(o){case d.selectorChangeType.CLASS:i.isUndefined(t.className)||(e[d.selectorChangeType.CLASS]=t.className,t.className=r);break;case d.selectorChangeType.HREF:i.isUndefined(t.href)||(e[d.selectorChangeType.HREF]=t.href,t.href=r);break;case d.selectorChangeType.HTML:i.isUndefined(t.innerHTML)||(e[d.selectorChangeType.HTML]=t.innerHTML,t.innerHTML=r,i.each(l.childrenOf(t),(function(t){t.setAttribute(n,"")})));break;case d.selectorChangeType.SRC:i.isUndefined(t.src)||(e[d.selectorChangeType.SRC]=t.src,t.src=r);break;case d.selectorChangeType.STYLE:break;case d.selectorChangeType.TEXT:i.isUndefined(t.textContent)||(e[d.selectorChangeType.TEXT]=t.textContent,t.textContent=r);break;default:throw new Error("Unrecognized attribute: "+o)}}));var r=w.createStylesFromChange(t.style.cssText,this.change);i.isString(r)&&(e[d.selectorChangeType.STYLE]=t.style.cssText,t.style.cssText=r),t.setAttribute(n,""),c.setData(t,this.change.id,this.identifier,e)},T.prototype.cancel=function(){this.cancelled=!0,this.unobserveSelector&&this.unobserveSelector(),i.each(this.disconnectObserverQueue,(function(t){try{t()}catch(n){}}))},T.prototype.undo=function(){var t=l.querySelectorAll("["+a.CHANGE_ID_ATTRIBUTE_PREFIX+this.change.id+"]");return i.each(t,i.bind((function(t){var n=c.getData(t,this.change.id,this.identifier);n&&i.forOwn(n,(function(n,e){switch(e){case d.selectorChangeType.CLASS:t.className=n;break;case d.selectorChangeType.HREF:t.href=n;break;case d.selectorChangeType.HTML:t.innerHTML=n;break;case d.selectorChangeType.SRC:t.src=n;break;case d.selectorChangeType.STYLE:t.style.cssText=n;break;case d.selectorChangeType.TEXT:t.textContent=n;break;case d.selectorChangeType.HIDE:t.style.visibility=n;break;case d.selectorChangeType.REMOVE:t.style.display=n;break;default:throw new Error("Unrecognized attribute: "+e)}})),t.removeAttribute(a.CHANGE_ID_ATTRIBUTE_PREFIX+this.change.id),c.removeData(t,this.change.id,this.identifier)}),this)),s().resolve(d.changeState.UNAPPLIED)},t.exports=function(t){t.registerChangeApplier(d.changeType.ATTRIBUTE,T)}},433:function(t,n,e){var i=e(4816),r=e(4255),o=e(2262),a=e(1284);function u(t,n){if(!i.isFunction(t.value))throw new Error("Custom code must be a function");this.change=t}u.prototype.apply=function(){var t=r();try{a.apply(this.change.value),t.resolve()}catch(n){t.reject(n)}return t},u.prototype.undo=function(){return r().resolve(o.changeState.IGNORED)},t.exports=function(t){t.registerChangeApplier(o.changeType.CUSTOM_CODE,u)}},4543:function(t,n,e){var i=e(4816),r=e(4255),o=e(2262),a=e(6732);function u(t,n){this.change=i.extend({},t),this.identifier=n.identifier}u.prototype.apply=function(){return a.emit({type:"showWidget",name:this.change.widget_id,data:this.change}),r().resolve(o.changeState.APPLIED)},u.prototype.undo=function(){return a.emit({type:"hideWidget",name:this.change.widget_id,data:this.change}),r().resolve(o.changeState.UNAPPLIED)},t.exports=function(t){t.registerChangeApplier(o.changeType.WIDGET,u)}},8203:function(t,n,e){var i=e(4816),r=e(6618),o=e(2032),a=e(4719).E,u=(e(7936),{decideLayer:function(t,n){if(!t.decisionMetadata||!t.decisionMetadata.experimentPriorities)throw new a("No decisionMetadata.experimentPriorities on layer.");for(var e=t.decisionMetadata.experimentPriorities.length,i=0;i<e;i++){var r=c(t,n.audienceIds,n.bucketingId,i);if(r){var u=o.selectVariation(r,n.audienceIds,n.bucketingId,n.activationId,n.preferredVariationMap);if(!t.decisionMetadata.offerConsistency||o.hasVariationActionsOnView(u,n.pageId))return{experiment:r,variation:u}}}throw new a("No eligible experiment and variation found.")},includePageIdInDecisionTicket:function(t){return!(!t.decisionMetadata||!t.decisionMetadata.offerConsistency)}});function c(t,n,e,u){var c,s,f=t.decisionMetadata.experimentPriorities[u],l=null==(c=t.decisionMetadata)?void 0:c.experimentWeights,d=i.reduce(f,(function(e,i){var r=o.getExperimentById(t,i.entityId);return o.isValidExperiment(n,r)&&e.push(i.entityId),e}),[]);if(!i.isEmpty(d)){var v,h=i.filter(f,{endOfRange:null});if(h&&h.length===f.length){v=function(t){for(var n=[],e=Math.round(1e4/t.length),i=0;i<t.length;i++)n.push({entityId:t[i],endOfRange:e*(i+1)});return n[n.length-1].endOfRange=1e4,n}(d),i.isEmpty(l)}else{if(0!==h.length)throw new a("You must specify weights for all or none of the experiments in each priority layer.");v=function(t,n){for(var e=[],r=[],o=0,a=0;a<n.length;a++){var u=0;t.indexOf(n[a].entityId)>=0&&(o+=u=0===a?n[0].endOfRange:n[a].endOfRange-n[a-1].endOfRange,r.push({entityId:n[a].entityId,points:u}))}if(i.isEmpty(e))for(var c=0,s=0;s<r.length;s++){var f=Math.round(1e4*r[s].points/o)+c;e.push({entityId:r[s].entityId,endOfRange:f}),c=f}return e[e.length-1].endOfRange=1e4,e}(d,f)}if(s=r.chooseWeightedCandidate(e,t.id,v)){var p=o.getExperimentById(t,s);if(p)return p}}}t.exports=function(t){t.registerDecider("equal_priority",u)}},5736:function(t,n,e){var i=e(2032),r=e(4719).E,o={selectExperiment:function(t,n,e){if(t.experiments.length<1)throw new r("Unable to find experiment to bucket user into");var o=t.experiments[0];if(!i.isValidExperiment(n,o))throw new r('Audience conditions failed for experiment: "'+o.id+'".');return o}};t.exports=function(t){t.registerDecider("single_experiment",o),t.registerDecider("multivariate",o)}},7788:function(t,n,e){var i=function(t){return t&&"undefined"!=typeof Symbol&&t.constructor===Symbol?"symbol":typeof t},r=e(4816),o=e(4248),a=e(8064).U,u=e(8416),c=e(3253),s=n.Error=a("ClickDelegateError");function f(t){this.handler=t,this.events=[],this.unlistenFn=null,this.clickHandler=r.bind((function(t){r.forEach(this.events,r.bind((function(n){try{var e=n.config&&n.config.selector?n.config.selector:n.eventFilter.selector;(function(t,n,e){var a=t.target,u=0;for(;a;){var f;try{f=c(a,n)}catch(d){var l={typeofElementValue:void 0===a?"undefined":i(a),nodeName:r.result(a,["nodeName"],null),nodeType:r.result(a,["nodeType"],null),targetName:r.result(t,["target","nodeName"],null),targetType:r.result(t,["target","nodeType"],null),numParentsTraversed:u,selector:n,errorMessage:d.message,eventId:e.id};return o.emitError(new s("Unable to evaluate match for element"),l),!1}if(f)return!0;a=a.parentElement,u++}return!1})(t,e,n)&&this.handler(n)}catch(a){o.emitError(new s("Unable to handle click for selector"+e+":"+a.message))}}),this))}),this)}f.prototype.listen=function(){this.unlistenFn=u.addEventListener("click",this.clickHandler,!0)},f.prototype.unlisten=function(){this.unlistenFn&&(this.unlistenFn(),this.unlistenFn=null)},f.prototype.hasEvents=function(){return this.events.length>0},f.prototype.addEvent=function(t){this.events.push(t)},f.prototype.removeEvent=function(t){this.events=r.filter(this.events,(function(n){return n.apiName!==t.apiName}))},t.exports=f},7312:function(t,n,e){var i=e(5086),r=e(7788),o=e(7936),a=e(4927);function u(t){return"apiName: "+t.apiName+", selector: "+t.eventFilter.selector}t.exports=function(t){var n=new r((function(t){a.updateAllViewTags(),i.trackClickEvent(t)?o.log("Tracking click event:",t):o.log("Not tracking click event:",t)}));t.registerEventImplementation("click",{attach:function(t){n.hasEvents()||n.listen(),n.addEvent(t),o.debug("Started listening for click event ("+u(t)+"):",t)},detach:function(t){n.removeEvent(t),n.hasEvents()||n.unlisten(),o.debug("Stopped listening for click event ("+u(t)+"):",t)}})}},5983:function(t,n,e){var i=e(4816),r=e(521),o=e(1882),a=e(38);function u(t,n){var e=o.buildFromSpecV0_1(n);if(1!==e.length)throw new Error("Invalid query descriptor; verify that no aggregators are specified");return a.execute(e[0],t)}function c(t,n){return i.map(t,(function(t){return i.isFunction(t.toObject)?t.toObject(n):t}))}function s(t,n){if(!t)return["Descriptor not defined"];var e=[];return t.count&&e.push('Unexpected "count" clause specified'),t.pick&&t.pick.modifier&&-1===n.indexOf(t.pick.modifier)&&e.push('Invalid "pick" modifier "'+t.pick.modifier+'"'),i.each(t.filters,(function(t){i.isUndefined(t.modifier)||e.push('Unexpected "filter" modifier "'+t.modifier+'"')})),e.length>0?e:void 0}function f(t,n){var e={revenueAsTag:!1,timeAsTimestamp:!0};if(i.isUndefined(n))return c(r.getEvents(t),e);if(i.isNumber(n)){if(n<=0)throw new Error("Count must be a positive integer, got "+n);return c(r.getEvents(t).slice(-n),e)}var a=s(n,i.values(o.RECENCY_FILTERS));if(a)throw new Error(a.join("\n"));return c(u(r.getEvents(t),n),e)}function l(t,n){if(!(n=i.cloneDeep(n)||{}).pick)throw new Error('No "pick" clause provided in query descriptor');if(!n.pick.name)throw new Error('No field name provided in "pick" clause');n.pick.modifier=n.pick.modifier||o.FREQUENCY_FILTERS.MOST_FREQUENT;var e=s(n,i.values(o.FREQUENCY_FILTERS));if(e)throw new Error(e.join("\n"));return u(r.getEvents(t),n)}function d(t,n){var e=o.buildFromSpecV0_2(n),u=r.getEvents(t),s=c(a.execute(e,u),{revenueAsTag:!0,timeAsTimestamp:!1});return(n.pick||n.reduce&&"count"===n.reduce.aggregator)&&(s=i.flatten(s)),n.reduce&&(s=s[0]),s}t.exports=["stores/visitor_events",function(t){return{getEvents:i.partial(f,t),getByFrequency:i.partial(l,t),query:i.partial(d,t)}}]},7383:function(t,n,e){t.exports=function(t){t.registerApiModule("behavior",e(5983))}},9871:function(t,n,e){t.exports=function(t){t.registerVisitorProfileProvider(e(1780)),t.registerAudienceMatcher("behavior",e(8572))}},8572:function(t,n,e){var i=e(4816),r=e(9505),o=e(1882),a=e(38);t.exports={fieldsNeeded:["events"],match:function(t,n){var e,u=r.parse(n.value);return e=i.isUndefined(u.version)?[u]:o.buildFromSpecV0_1(u),i.every(e,(function(n){return a.isSatisfied(n,t.events)}))}}},1780:function(t,n,e){var i=e(521);t.exports={provides:"events",isTransient:!0,getter:[function(){return i.getEvents()}]}},8949:function(t,n,e){t.exports=function(t){t.registerVisitorProfileProvider(e(8876))}},8876:function(t,n,e){var i=e(4816),r=e(6713),o=e(521),a=e(9505),u=e(1882);t.exports={provides:"customBehavior",shouldTrack:!0,isLazy:!1,getter:["stores/global","stores/visitor_attribute_entity",function(t,n){var e=t.getProjectId(),c=i.filter(i.map(n.getCustomBehavioralAttributes(e),(function(t){try{return{id:t.id,granularity:r.GRANULARITY.ALL,rule:u.buildFromSpecV0_2(a.parse(t.rule_json))}}catch(n){return}}))),s=o.getEvents();return r.evaluate(c,s)}]}},3299:function(t,n,e){t.exports=function(t){t.registerVisitorProfileProvider(e(658)),t.registerAudienceMatcher("first_session",e(3025))}},3025:function(t){t.exports={fieldsNeeded:["first_session"],match:function(t){return!!t.first_session}}},658:function(t,n,e){var i=e(8676),r=e(521),o=e(6094).getFieldValue,a=e(3841).CURRENT_SESSION_INDEX;t.exports={provides:"first_session",shouldTrack:!0,getter:[function(){var t=r.getEvents();if(t&&t.length>0){var n=t[0];return o(n,[i.FIELDS.SESSION_INDEX])===a}return!0}]}},6713:function(t,n,e){var i=e(7936),r={FIELDS:e(8676).FIELDS},o=e(1882),a=e(38);n.GRANULARITY={ALL:"all",CURRENT_SESSION:"current_session",LAST_30_DAYS:"last_30_days",LAST_60_DAYS:"last_60_days"},n.evaluate=function(t,e){var u={};if(0===e.length){for(var c=0;c<t.length;c++)u[t[c].id]=t[c].defaultValue;return u}var s=function(t){if(0===t.length)return[];for(var n=t.length-1,e=r.FIELDS.SESSION_ID,i=t[n][e];n>0&&i===t[n-1][e];)n--;return t.slice(n)}(e),f=function(t,n){if(0===t.length||n<=0)return[];var e=+new Date-n*o.MILLIS_IN_A_DAY;e-=e%o.MILLIS_IN_A_DAY;for(var i=t.length;i>0&&e<=t[i-1][r.FIELDS.TIME];)i--;return t.slice(i)}(e,60);for(c=0;c<t.length;c++){var l=t[c],d=e;l.granularity===n.GRANULARITY.CURRENT_SESSION?d=s:l.granularity===n.GRANULARITY.LAST_60_DAYS&&(d=f);try{var v=d;l.rule&&(v=a.execute(l.rule,d)),u[l.id]=l.defaultValue,1===v.length?u[l.id]=v[0][0]||l.defaultValue:i.debug("Behavior / Rule for",l.id,"returned",v.length,"results, expected 1")}catch(h){i.error("Behavior / Rule for",l.id,"failed with",h.message||"")}}return u}},521:function(t,n,e){var i=e(4816),r=e(2755),o=e(9932).get("stores/visitor_events");n.getEvents=function(){var t=r.getEvents(),n=[].concat.apply([],i.values(o.getForeignEvents())),e=[].concat.apply([],i.values(o.getForeignEventQueues())),a=r.mergeAllEvents([t,n,e]);return a.slice(a.length-1e3)}},1882:function(t,n,e){var i=n,r=e(4816),o={FIELDS:e(8676).FIELDS,FIELDS_V0_2:e(8676).FIELDS_V0_2},a=e(9505),u=e(7936),c=e(38);i.MILLIS_IN_A_DAY=864e5,i.aggregateField=function(t,n){return r.isString(n)&&(n=[n]),n=n||c.DEFAULT_FIELD,[c.generateAlias(t,n)]},i.groupField=function(t){return r.isString(t)&&(t=[t]),[(t=t||c.DEFAULT_FIELD).join(".")]};var s={"<":"lt","<=":"lte",">":"gt",">=":"gte","=":"eq","==":"eq"};function f(t){return t=(t||"").toString().trim(),s[t]||t}function l(t,n,e){var a={where:n};if(t.count&&(a.limit=t.count),t.modifier===i.FREQUENCY_FILTERS.MOST_FREQUENT){var u=i.getFieldKeyPathForSource(t.name,e),c=i.aggregate("count"),s=i.aggregateField("count"),f=i.groupField(u);return r.extend(a,{select:[{field:f}],groupBy:i.groupBy([u]),aggregate:[c],orderBy:[{field:s,direction:"DESC"}]})}return r.extend(a,{orderBy:[{field:[o.FIELDS.TIME],direction:"DESC"}]})}i.fieldComparison=function(t,n,e){return t=f(t),r.isString(n)&&(n=[n]),"exists"===t?{op:t,args:[{field:n}]}:{op:t,args:[{field:n},{value:e}]}},i.relativeTimeComparison=function(t,n){return{op:f(t),args:[{op:"-",args:[{eval:"now"},{field:[o.FIELDS.TIME]}]},{value:n*i.MILLIS_IN_A_DAY}]}},i.rangeTimeComparison=function(t){return r.isArray(t)?{op:"between",args:[{field:[o.FIELDS.TIME]},{value:[t[0]||+new Date(0),t[1]||+new Date]}]}:(u.error("Rule builder","rangeTimeComparison passed invalid range",t),null)},i.groupBy=function(t){for(var n=[],e=0;e<t.length;e++)n[e]={field:t[e]};return n},i.aggregate=function(t,n){return r.isString(n)&&(n=[n]),{op:t,args:[{field:n=n||c.DEFAULT_FIELD}]}},i.SOURCE_TYPES={BEHAVIOR:"events",CUSTOM_BEHAVIOR:"custom_behavior",DCP:"dcp"},i.FREQUENCY_FILTERS={MOST_FREQUENT:"most_frequent",LEAST_FREQUENT:"least_frequent"},i.RECENCY_FILTERS={MOST_RECENT:"most_recent",LEAST_RECENT:"least_recent"},i.getFieldKeyPathForSource=function(t,n){n=n||i.SOURCE_TYPES.BEHAVIOR;var e=[];return r.isString(t)?(e=[t],n!==i.SOURCE_TYPES.BEHAVIOR||r.includes(r.values(o.FIELDS),t)||(e=[o.FIELDS.OPTIONS,t])):e=t,e},i.buildFromSpecV0_1=function(t){if(!(t.action||t.filters&&0!==t.filters.length))throw new Error('Audience spec must have an "action" field or at least one "filter" '+a.stringify(t));var n=i.fieldComparison("gt",o.FIELDS.TIME,0),e=[],c=[];if(t.action&&(c.push(i.fieldComparison("eq",o.FIELDS.NAME,t.action.value)),t.action.type&&c.push(i.fieldComparison("eq",o.FIELDS.TYPE,t.action.type))),t.time)if("last_days"===t.time.type)c.push(i.relativeTimeComparison("lte",t.time.days));else if("range"===t.time.type){var s=i.rangeTimeComparison([t.time.start,t.time.stop]);s&&c.push(s)}else u.error("Rule builder",'Audience spec has bad "time" type',t.time.type);if(n={op:"and",args:c},t.count&&e.push({where:i.fieldComparison(t.count.comparator,"0",t.count.value),from:{select:[{field:i.aggregateField("count")}],where:n,aggregate:[i.aggregate("count")]}}),t.filters&&r.each(t.filters,(function(r){var a,u,s=i.getFieldKeyPathForSource(r.name,t.source);if(r.modifier===i.FREQUENCY_FILTERS.MOST_FREQUENT?(a=i.aggregate("count"),u=i.aggregateField("count")):r.modifier===i.RECENCY_FILTERS.MOST_RECENT&&(a=i.aggregate("max",o.FIELDS.TIME),u=i.aggregateField("max",o.FIELDS.TIME)),a){var f=s,l=i.groupField(f);e.push({where:i.fieldComparison(r.comparator,"0",r.value),from:{select:[{field:l}],where:n,groupBy:i.groupBy([f]),aggregate:[a],orderBy:[{field:u,direction:"DESC"}],limit:1}})}else c.push(i.fieldComparison(r.comparator,s,r.value))})),t.pick){if(e.length>0)throw new Error('A "pick" clause must not be specified with "count" or "most_recent", "most_frequent" modifiers'+a.stringify(t));return[l(t.pick,n,t.source)]}return e.length>0?e:[{where:n}]},i.buildFromSpecV0_2=function(t){!function(t){var n=[];if(r.isUndefined(t))throw new Error("rule is undefined");if(!r.isObject(t))throw new Error("rule is not an Object");"0.2"!==t.version&&n.push('version: not "0.2"'),t.filter&&(r.isArray(t.filter)?r.each(t.filter,(function(t,e){var r=i.validateFieldKeyPathV0_2(t.field,i.FieldPurpose.FILTER);r&&n.push("filter["+e+"]: "+r);var o=i.validateComparatorAndValue(t.comparator,t.value);o&&n.push("filter["+e+"]: "+o)})):n.push("filter: not an array"));var e=[],o=[];t.sort&&(t.reduce&&t.reduce.aggregator&&"nth"!==t.reduce.aggregator&&n.push("sort: superfluous because we can apply aggregator "+a.stringify(t.reduce.aggregator)+" to unsorted items"),r.isArray(t.sort)?r.each(t.sort,(function(t,u){var c=i.validateFieldKeyPathV0_2(t.field,i.FieldPurpose.SORT);c&&n.push("sort["+u+"]: "+c),t.field&&"frequency"===t.field[0]?e.push(t):o.push(t);var s=function(t){var n="direction "+(a.stringify(t)||String(t));if(!r.includes(["ascending","descending"],t))return n+' is not "ascending" or "descending"'}(t.direction);s&&n.push("sort["+u+"]: "+s)})):n.push("sort: not an array"),e.length&&o.length&&n.push('sort: sorting by non-["frequency"] field is pointless because we are going to sort the picked values by ["frequency"]'),e.length&&!t.pick&&n.push('sort: sorting by ["frequency"] is impossible because no values have been picked'));if(t.pick){t.reduce&&"count"===t.reduce.aggregator&&n.push('pick: superfluous because we can apply aggregator "count" to raw events');var u=i.validateFieldKeyPathV0_2(t.pick.field);u&&n.push("pick: "+u)}if(t.reduce){var c=t.reduce.aggregator,s="aggregator "+(a.stringify(c)||String(c)),f=t.reduce.n,l="index "+(a.stringify(f)||String(f));r.includes(["sum","avg","max","min","count","nth"],c)||n.push("reduce: "+s+" is unknown"),r.includes(["sum","avg","max","min"],c)&&(t.pick||n.push("reduce: "+s+" is impossible to use because no values have been picked")),"nth"===c?((!r.isNumber(f)||isNaN(f)||parseInt(f,10)!==f||f<0)&&n.push("reduce: "+l+" is not a non-negative integer (mandated by "+s+")"),t.sort||n.push('reduce: aggregator "nth" is meaningless without a specific sort order')):r.isUndefined(f)||n.push("reduce: "+l+" is defined (not mandated by "+s+")")}if(n.length)throw new Error(n.join("\n"))}(t);var n={where:{op:"and",args:r.map(t.filter||[],(function(t){return"age"===t.field[0]?i.relativeTimeComparison(t.comparator||"eq",t.value/i.MILLIS_IN_A_DAY):i.fieldComparison(t.comparator||"eq",i.convertFieldKeyPathFromSpecV0_2(t.field),t.value)}))}};if(t.reduce&&"count"===t.reduce.aggregator)return r.extend(n,{aggregate:[{op:"count",args:[{field:["*"]}]}],select:[{field:["_count_*"]}]});var e=[],o=[];if(t.sort&&(r.each(t.sort,(function(t){r.includes(["ascending","descending"],t.direction)&&(r.includes(["time","age"],t.field[0])&&o.push(t),"frequency"===t.field[0]&&e.push(t))})),o.length&&!e.length&&(n.orderBy=r.filter(r.map(o,(function(t){return"time"===t.field[0]?{field:i.convertFieldKeyPathFromSpecV0_2(["time"]),direction:"ascending"===t.direction?"ASC":"DESC"}:"age"===t.field[0]?{field:i.convertFieldKeyPathFromSpecV0_2(["time"]),direction:"ascending"===t.direction?"DESC":"ASC"}:void 0}))))),t.pick&&t.pick.field){var u=i.convertFieldKeyPathFromSpecV0_2(t.pick.field);if(t.reduce&&r.includes(["avg","max","min","sum"],t.reduce.aggregator))return r.extend(n,{aggregate:[{op:t.reduce.aggregator,args:[{field:u}]}],select:[{field:[c.generateAlias(t.reduce.aggregator,u)]}]});n=e.length?r.extend(n,{groupBy:[{field:u}],aggregate:[{op:"count",args:[{field:["*"]}]}],orderBy:[{field:["_count_*"],direction:"ascending"===e[0].direction?"ASC":"DESC"}],select:[{field:[u.join(".")]}]}):r.extend(n,{select:[{field:u}]})}if(t.reduce&&"nth"===t.reduce.aggregator){var s=t.reduce.n;if(r.isNumber(s)&&s>=0&&Number(s)===Math.floor(Number(s)))return r.extend(n,{offset:s,limit:1})}return n},i.convertFieldKeyPathFromSpecV0_2=function(t){return"tags"===t[0]&&"revenue"===t[1]?["r"]:[o.FIELDS_V0_2[t[0]]].concat(t.slice(1))},i.FieldPurpose={FILTER:"filter",SORT:"sort",PICK:"pick"},i.validateFieldKeyPathV0_2=function(t,n){var e="field "+(a.stringify(t)||String(t));if(!r.isArray(t)||!r.every(t,r.isString))return e+" is not an array of strings";if("tags"===t[0]&&t.length>2||"tags"!==t[0]&&t.length>1)return e+" includes too many strings";if("tags"===t[0]&&t.length<2)return e+" does not specify an exact tag";if(t.length<1)return e+" does not specify a top-level field";var u=r.keys(o.FIELDS_V0_2),c=["age","frequency"];return n===i.FieldPurpose.FILTER&&(u.push("age"),c=["frequency"]),n===i.FieldPurpose.SORT&&(u=["time","age","frequency"],c=["name","type","category","tags"]),r.includes(c,t[0])?e+" is not supported here":r.includes(u,t[0])?void 0:e+" is unknown"},i.validateComparatorAndValue=function(t,n){var e="comparator "+(a.stringify(t)||String(t)),i="value "+(a.stringify(n)||String(n));if(!r.isString(t)&&!r.isUndefined(t))return e+" is not a string";switch(t){case void 0:case"eq":case"is":case"contains":break;case"lt":case"gt":case"lte":case"gte":if(!r.isNumber(n))return i+" is not a number (mandated by "+e+")";break;case"in":if(!r.isArray(n))return i+" is not an array (mandated by "+e+")";break;case"between":if(!(r.isArray(n)&&2===n.length&&r.isNumber(n[0])&&r.isNumber(n[1])&&n[0]<=n[1]))return i+" is not a pair of increasing numbers (mandated by "+e+")";break;case"regex":if(!(r.isString(n)||r.isArray(n)&&2===n.length&&r.isString(n[0])&&r.isString(n[1])))return i+" is not a pattern string or a [pattern string, flags string] array (mandated by "+e+")";break;case"exists":if(!r.isUndefined(n))return i+" is not undefined (mandated by "+e+")";break;default:return e+" is unknown"}}},38:function(t,n,e){var i=e(4816),r=e(8738),o=e(7936),a=i.bind(o.log,o),u=e(8701),c=e(6094).getFieldValue,s=e(9505),f=function(t,n,e){if(t.getValueOrDefault)return t.getValueOrDefault(n,e);if(!i.isArray(n))return e;var r=c(t,n);return void 0===r&&(r=e),r},l=function(t){return"string"==typeof t?t.trim().toLowerCase():t};n.clause={WHERE:"where",GROUP_BY:"groupBy",AGGREGATE:"aggregate",HAVING:"having",ORDER_BY:"orderBy",SELECT:"select",OFFSET:"offset",LIMIT:"limit",FROM:"from"},n.DEFAULT_FIELD=["*"],n.booleanOperators={eq:function(t){var n=i.map(t,l);return n[0]==n[1]},is:function(t){return t[0]===t[1]},gt:function(t){return t[0]>t[1]},lt:function(t){return t[0]<t[1]},gte:function(t){return t[0]>=t[1]},lte:function(t){return t[0]<=t[1]},"in":function(t){var n=i.map(t[1]||[],l);return i.includes(n,l(t[0]))},between:function(t){return t[1][0]<=t[0]&&t[0]<=t[1][1]},contains:function(t){var n=i.map(t,(function(t){return"string"==typeof t?t.toLowerCase():t}));return-1!==(n[0]||"").indexOf(n[1])},regex:function(t){try{var n,e;return i.isString(t[1])?(n=t[1],e="i"):(n=t[1][0]||"",e=t[1][1]||""),new RegExp(n,e).test(t[0])}catch(r){return o.error("Rules",'In operator "regex", error: '+(r.message||"invalid RegExp /"+[n,e].join("/"))),!1}},exists:function(t){return void 0!==t[0]},and:function(t){return i.every(t,(function(t){return t}))},or:function(t){return i.some(t,(function(t){return t}))},not:function(t){return!t[0]}},n.arithmeticOperators={"+":function(t){return(t[0]||0)+(t[1]||0)},"-":function(t){return(t[0]||0)-(t[1]||0)},"/":function(t){return(t[0]||0)/(t[1]||1)},"%":function(t){return(t[0]||0)%(t[1]||1)}},n.aggregateOperators={sum:function(t,e){for(var i=t[0]||n.DEFAULT_FIELD,r=0,o=0;o<e.length;o++)r+=f(e[o],i,0);return r},avg:function(t,e){if(0===e.length)return 0;for(var i=t[0]||n.DEFAULT_FIELD,r=0,o=0;o<e.length;o++)r+=f(e[o],i,0);return r/e.length},max:function(t,e){for(var i=t[0]||n.DEFAULT_FIELD,r=Number.NEGATIVE_INFINITY,o=0;o<e.length;o++)r=Math.max(r,f(e[o],i,Number.NEGATIVE_INFINITY));return r},min:function(t,e){for(var i=t[0]||n.DEFAULT_FIELD,r=Number.POSITIVE_INFINITY,o=0;o<e.length;o++)r=Math.min(r,f(e[o],i,Number.POSITIVE_INFINITY));return r},count:function(t,n){return n.length}};var d={now:function(){return u.now()}},v=function(t,e){if(e.hasOwnProperty("value"))return e.value;if(e.hasOwnProperty("field"))return f(t,e.field);if(e.hasOwnProperty("eval"))return e.eval in d?d[e.eval]():void o.error("Rules","Unknown function: "+e.eval);if(e.op){var r,a=(r=e.op)in n.booleanOperators?n.booleanOperators[r]:r in n.arithmeticOperators?n.arithmeticOperators[r]:null;if(a){var u=i.partial(v,t),c=e.args||[];return a(i.map(c,(function(t){return u(t)})),t)}o.error("Rules","Unknown operator: "+e.op)}else o.error("Rules","No operator specified: "+s.stringify(e))};n.generateAlias=function(t,n){return"_"+t+"_"+n.join(".")};n.rewrite=function(t){var e=[],r={};function a(t,u){if(i.isArray(t)&&("and"!==t[0]&&"or"!==t[0]&&"not"!==t[0]&&o.error("Rules","Unexpected operation "+t[0]+". Continuing optimistically."),t={op:t[0],args:t.slice(1)}),t.hasOwnProperty("field")||t.hasOwnProperty("value")||t.hasOwnProperty("eval"))return t;if(u&&t.op in n.aggregateOperators){var c=(t.args&&t.args[0]||{}).field||n.DEFAULT_FIELD,s=n.generateAlias(t.op,c);return s in r||(e.push({op:t.op,args:t.args}),r[s]=!0),{field:[s]}}for(var f=[],l=t.args||[],d=0;d<l.length;d++)f[d]=a(l[d],u);return{op:t.op,args:f}}var u={};t.hasOwnProperty(n.clause.WHERE)&&(u[n.clause.WHERE]=a(t[n.clause.WHERE],!1)),t.hasOwnProperty(n.clause.HAVING)&&(u[n.clause.HAVING]=a(t[n.clause.HAVING],!0)),(t.hasOwnProperty(n.clause.AGGREGATE)||e.length>0)&&(u[n.clause.AGGREGATE]=(t[n.clause.AGGREGATE]||[]).concat(e));for(var c=[n.clause.GROUP_BY,n.clause.ORDER_BY,n.clause.SELECT,n.clause.OFFSET,n.clause.LIMIT],s=0;s<c.length;s++)t.hasOwnProperty(c[s])&&(u[c[s]]=t[c[s]]);return t.hasOwnProperty(n.clause.FROM)&&(u[n.clause.FROM]=n.rewrite(t[n.clause.FROM])),u};var h=function(t,e){e=e||0;var r=[];if(t.hasOwnProperty(n.clause.WHERE)?t[n.clause.WHERE].op?t[n.clause.WHERE].op in n.booleanOperators||r.push("Non-boolean WHERE clause operator"):r.push("Missing WHERE clause operator"):r.push("Missing WHERE clause"),!t.hasOwnProperty(n.clause.HAVING)||(t[n.clause.HAVING].op?t[n.clause.HAVING].op in n.booleanOperators||r.push("Non-boolean HAVING clause operator"):r.push("Missing HAVING clause operator")),t.hasOwnProperty(n.clause.GROUP_BY)&&!t.hasOwnProperty(n.clause.AGGREGATE)&&r.push("No AGGREGATE clause specified with GROUP_BY clause"),t.hasOwnProperty(n.clause.SELECT)){var o=t[n.clause.SELECT];if(i.isArray(o))for(var a=0;a<o.length;a++)o[a].op&&o[a].op in n.aggregateOperators&&r.push('In SELECT clause, aggregate operator "'+o[a].op+'" specified in selector at index '+a);else r.push("SELECT clause must be an array")}if(t.hasOwnProperty(n.clause.OFFSET)){var u=t[n.clause.OFFSET];(!i.isNumber(u)||Number(u)<0||Number(u)!==Math.floor(Number(u)))&&r.push("OFFSET must be a non-negative integer")}if(t.hasOwnProperty(n.clause.LIMIT)){var c=t[n.clause.LIMIT];(!i.isNumber(c)||Number(c)<0||Number(c)!==Math.floor(Number(c)))&&r.push("LIMIT must be a non-negative integer")}return e>0&&(r=i.map(r,(function(t){return"Sub-rule "+e+": "+t}))),t.hasOwnProperty(n.clause.FROM)&&(r=r.concat(h(t[n.clause.FROM],e+1))),r},p=function(t,e){var r,u,c,l=e;if(t.hasOwnProperty(n.clause.FROM)&&(o.debug("Evaluating FROM clause:",t[n.clause.FROM]),l=p(t[n.clause.FROM],l),o.debug("Results after FROM:",l)),o.debug("Evaluating WHERE clause:",t[n.clause.WHERE]),l=i.filter(l,(function(e){return v(e,t[n.clause.WHERE])})),o.debug("Results after WHERE:",l),t.hasOwnProperty(n.clause.AGGREGATE)){o.debug("Evaluating AGGREGATE clause:",t[n.clause.AGGREGATE]);var d=function(t,n){var e={};if(void 0===t||!i.isArray(t)||0===t.length)return e["*"]={fieldValues:{},events:n},e;for(var r=i.map(t,(function(t){return t.field})),o=0;o<n.length;o++){for(var a=n[o],u=[],c={},l=0;l<r.length;l++){var d=r[l],v=f(a,d),h=d.join(".");c[h]=v,u.push(encodeURIComponent(h)+"="+encodeURIComponent(s.stringify(v)))}var p=u.join("&");e.hasOwnProperty(p)||(e[p]={fieldValues:c,events:[]}),e[p].events.push(a)}return e}(t[n.clause.GROUP_BY],l);l=function(t,n){var e=[];return i.each(t,(function(t,r){var o=i.extend({},t.fieldValues),a=n[r]||{};i.extend(o,a),e.push(o)})),e}(d,(r=t[n.clause.AGGREGATE],u=d,c={},i.each(u,(function(t,e){c[e]={};for(var i=0;i<r.length;i++){var a=r[i],u=a.op;if(u in n.aggregateOperators){var s=(a.args&&a.args[0]||{}).field||n.DEFAULT_FIELD,f=n.generateAlias(u,s),l=n.aggregateOperators[u]([s],t.events);c[e][f]=l}else o.error("Rules","Unknown aggregate operator "+u)}})),c)),o.debug("Results after AGGREGATE:",l)}t.hasOwnProperty(n.clause.HAVING)&&(o.debug("Evaluating HAVING clause:",t[n.clause.HAVING]),l=i.filter(l,(function(e){return v(e,t[n.clause.HAVING])})),o.debug("Results after HAVING:",l)),t.hasOwnProperty(n.clause.ORDER_BY)&&(o.debug("Evaluating ORDER_BY clause:",t[n.clause.ORDER_BY]),l=function(t,n){return i.isArray(t)?0===t.length?n:n.sort((function(n,e){for(var i=0;i<t.length;i++){var r=t[i],o="ASC"===(r.direction||"ASC")?1:-1,a=r.field,u=f(n,a,0),c=f(e,a,0);if(u<c)return-o;if(u>c)return o}return 0})):(a("Rules","groupBy rule must be an array"),n)}(t[n.clause.ORDER_BY],l),o.debug("Results after ORDER_BY:",l));var h,g=0;return t.hasOwnProperty(n.clause.OFFSET)&&(o.debug("Evaluating OFFSET clause:",t[n.clause.OFFSET]),g=Number(t[n.clause.OFFSET])),t.hasOwnProperty(n.clause.LIMIT)&&(o.debug("Evaluating LIMIT clause:",t[n.clause.LIMIT]),h=g+Number(t[n.clause.LIMIT])),(g>0||!i.isUndefined(h))&&(l=l.slice(g,h),o.debug("Results after OFFSET/LIMIT:",l)),t.hasOwnProperty(n.clause.SELECT)&&(o.debug("Evaluating SELECT clause:",t[n.clause.SELECT]),l=function(t,n){return i.map(n,(function(n){return i.map(t,(function(t){return v(n,t)}))}))}(t[n.clause.SELECT],l),o.debug("Results after SELECT:",l)),l};n.execute=function(t,e){t=n.rewrite(t),o.shouldLog(r.LogLevel.DEBUG)&&o.groupCollapsed("Evaluating Behavioral Rule"),o.debug("Rule:",t,s.stringify(t)),o.debug("Events:",e);var i=h(t);if(i.length>0)throw new Error("Rule "+s.stringify(t)+" has violations: "+i.join("\n"));var a=p(t,e);return o.debug("Rule result:",a),o.shouldLog(r.LogLevel.DEBUG)&&o.groupEnd(),a},n.isSatisfied=function(t,e){try{return n.execute(t,e).length>0}catch(i){return o.error("Rules","Error "+i.toString()+" while evaluating rule "+s.stringify(t)),!1}}},58:function(t,n,e){t.exports=function(t){t.registerDependency("sources/browser_id",e(4199)),t.registerVisitorProfileProvider(e(377)),t.registerVisitorProfileProvider(e(3172)),t.registerAudienceMatcher("browser_version",e(1826))}},1826:function(t,n,e){var i=e(9352).y;t.exports={fieldsNeeded:["browserVersion","browserId"],match:function(t,n){var e=n.value,r=t.browserId,o=t.browserVersion;if(0===e.indexOf(r)){var a=e.substr(r.length);return 0===i(o,a)}return!1}}},377:function(t){t.exports={provides:"browserId",shouldTrack:!0,isSticky:!0,getter:["sources/browser_id",function(t){return t.getId()}]}},3172:function(t){t.exports={provides:"browserVersion",getter:["sources/browser_id",function(t){return t.getVersion()}]}},4199:function(t,n,e){var i=e(6349);n.getId=function(){return i.get().browser.id},n.getVersion=function(){return i.get().browser.version}},9075:function(t,n,e){t.exports=function(t){t.registerVisitorProfileProvider(e(6162)),t.registerAudienceMatcher("campaign",e(9862))}},9862:function(t,n,e){var i=e(7049);t.exports={fieldsNeeded:["campaign"],match:function(t,n){return i.hasMatch(n.value,n.match,t.campaign)}}},6162:function(t,n,e){var i=e(7266);t.exports={provides:"campaign",shouldTrack:!0,isSticky:!0,getter:[function(){return i.getQueryParamValue("utm_campaign")}]}},2981:function(t,n,e){var i=e(4816),r=e(9505),o=e(9895),a=e(7936),u=e(1683),c=e(6377);n.getCmabPredictionUrl=function(){return"https://prediction.cmab.optimizely.com/predict"},n.getCmabPredictionUrlForExperiment=function(t){return t?n.getCmabPredictionUrl()+"/"+t:""},n.createPayload=function(t,n){var e=i.map(t.variations,"id"),r=c.getVisitorCmabAttributesForExperiment(t),o=c.getDcpCustomerIds(),a=c.getDcpServiceId();return{instances:[{visitorId:u.getCurrentId(),experimentId:t.id,cmabUUID:n,variationIds:e,attributes:r,dcpCustomerIds:o,dcpServiceId:a}]}},n.parseApiResponse=function(t){var n=null;try{n=r.parse(t)}catch(e){return a.error("CMAB API / Error parsing response:",e),null}return n&&n.predictions&&0!==n.predictions.length?n.predictions[0].variation_id.toString():(a.debug("CMAB API / No predictions found in API response",n),null)},n.validateVariationId=function(t,n){return t&&i.find(n.variations,{id:t})?(a.debug("CMAB API / Variation ID:",t,"from API response found in experiment:",n.id),t):(a.debug("CMAB API / Variation ID:",t,"from API response not found in experiment:",n.id),null)},n.handleCmabApiResponse=function(t,e){if(200!==t.status)return a.error("CMAB API / API call failed with status:",t.status,t.statusText),null;a.debug("CMAB API / API call successful:",t.responseText);var i=n.parseApiResponse(t.responseText);return n.validateVariationId(i,e)},n.makeSyncApiCallWithXHR=function(t,e){a.debug("CMAB API / SYNC / Making a synchronous API call to get variation.");try{var i=n.createPayload(t,e),o=n.getCmabPredictionUrlForExperiment(t.id),u=new XMLHttpRequest;return u.open("POST",o,!1),u.send(r.stringify(i)),n.handleCmabApiResponse(u,t)}catch(c){return a.error("CMAB API / SYNC / API call encountered an error:",c),null}},n.makeAsyncApiCall=function(t,e){a.debug("CMAB API / ASYNC / Making an asynchronous API call to get variation.");var i=n.createPayload(t,e),r=n.getCmabPredictionUrlForExperiment(t.id);return o.request({url:r,contentType:"application/json",method:"POST",data:i})}},468:function(t,n,e){var i=e(7936),r=e(6377),o=e(2981),a=e(242);n.isCmabEnabled=function(){return!0},n.isExperimentSyncApiEnabled=function(t){return!0},n.defaultToSnippetBucketing=function(t,n,e){i.debug("CMAB / Defaulting to snippet bucketing with variation:",n,"for experiment:",t.id),r.setCmabVariationDataInVisitorStore(t,n,e)},n.processCmabExperiment=function(t,e){if(!n.isCmabEnabled())return i.debug("CMAB / Feature flag is disabled. Defaulting to snippet bucketing with variation:",e,"for experiment:",t.id),e;if(i.debug("CMAB / Feature flag is enabled. Processing CMAB for experiment:",t.id),r.activateTimeoutForNonBucketedCmabExperiments(t),!r.isCmabExperiment(t))return e;var u=r.getCmabVariationDataFromVisitorStore(t);if(!r.isCmabTimeout(t,u))return u.variationId;a.startCmabApiCallPerformanceTimer(t.id);var c=null,s=r.generateCmabUUID();if(n.isExperimentSyncApiEnabled(t))try{return(c=o.makeSyncApiCallWithXHR(t,s))?(r.setCmabVariationDataInVisitorStore(t,c,s),a.endCmabApiCallPerformanceTimer(t.id),c):(n.defaultToSnippetBucketing(t,e,s),a.endCmabApiCallPerformanceTimer(t.id),e)}catch(f){return i.error("CMAB API / SYNC / API call failed with error:",f),n.defaultToSnippetBucketing(t,e,s),a.endCmabApiCallPerformanceTimer(t.id),null}return o.makeAsyncApiCall(t,s).then((function(u){return(c=o.handleCmabApiResponse(u,t))?(i.debug("CMAB API / ASYNC / Variation:",c,"for experiment:",t.id),r.setCmabVariationDataInVisitorStore(t,c,s),a.endCmabApiCallPerformanceTimer(t.id),c):(n.defaultToSnippetBucketing(t,e,s),a.endCmabApiCallPerformanceTimer(t.id),e)}),(function(r){return i.error("CMAB API / ASYNC / API call failed with error:",r),n.defaultToSnippetBucketing(t,e,s),a.endCmabApiCallPerformanceTimer(t.id),null})),n.defaultToSnippetBucketing(t,e,s),a.endCmabApiCallPerformanceTimer(t.id),e},n.getCmabUUIDAndUpdate30MinTimeout=function(t,n){var e=r.getCmabUUIDFromVisitorStore(t,n);return r.updateCmabTimeoutInVisitorStore(t,n),e}},242:function(t,n,e){e(2899),e(7936);n.startCmabApiCallPerformanceTimer=function(t){0},n.endCmabApiCallPerformanceTimer=function(t){0}},6377:function(t,n,e){var i=e(4816),r=e(984),o=e(9505),a=e(9932),u=e(7276),c=e(1683),s=e(7936),f=e(8738),l=e(8654),d=a.get("stores/visitor"),v=a.get("stores/plugins"),h=a.get("stores/global");n.generateCmabUUID=function(){return u.generate()},n.getCmabLayerIdFromExperiment=function(t){return t.experimentMetadata&&t.experimentMetadata.layerId||t.id},n.isCmabExperiment=function(t){var n=t.experimentMetadata&&t.experimentMetadata.allocationPolicy;return n?n===f.AllocationPolicyEnum.CMAB:(s.debug("No allocation policy found in metadata for experiment:",t.id),!1)},n.isCmabTimeout=function(t,e){if(!n.isCmabVariationStorageDataValid(e))return s.debug("CMAB / Timeout CMAB Storage Variation Data is invalid"),!0;var r=e.variationId;return i.find(t.variations,{id:r})?e.isTimeout?(s.debug("CMAB / Timeout flag is set:",e.cmabUUID),!0):n.hasAttributesChanged(t,e)?(s.debug("CMAB / Timeout User attributes have changed"),!0):n.has30MinOr24HrTimeoutOccurred(e)?(s.debug("CMAB / Timeout for 30 minutes or 24 hours:",e.cmabUUID),!0):(s.debug("CMAB / No timeout happened for:",e.cmabUUID),!1):(s.debug("CMAB / Timeout Variation ID:",r,"not found in experiment:",t.id),!0)},n.has30MinOr24HrTimeoutOccurred=function(t){if(!n.isCmabVariationStorageDataValid(t))return s.debug("CMAB / Timeout CMAB Storage Variation Data is invalid"),!0;var e=(new Date).getTime(),i=new Date(t.st30MinTimeout).getTime(),r=new Date(t.st24HrTimeout).getTime();return e-i>18e5||e-r>864e5},n.isCmabVariationStorageDataValid=function(t){if(!t)return!1;for(var n=["variationId","visitorId","cmabUUID","st30MinTimeout","st24HrTimeout","userAttributeHash"],e=0;e<n.length;e++){var i=n[e];if(!t[i])return s.debug("CMAB / Storage data not found: "+i+" is missing"),!1}return!0},n.activateTimeoutForNonBucketedCmabExperiments=function(t){var e=n.getCmabLayerIdFromExperiment(t),r=t.id;s.debug("CMAB / Visitor is bucketed into experiment id:",r+" from layer id:",e);var o=c.getContextualMabMap();if(o&&o[e]){var a=o[e];s.debug("CMAB / All CMAB experiments found for the layer id:",e,"are:",a),s.debug("CMAB / Excluding the currently bucketed experiment id: ",r," from all CMAB experiments found for the current layer id: ",e);var u=i.omit(a,r);u=i.omitBy(u,(function(t){return t.isTimeout})),s.debug("CMAB / Non-bucketed CMAB experiments which will be timed out:",u),i.forEach(u,(function(t,n){t.isTimeout=!0,c.updateContextualMabMap(e,n,t)})),c.persistContextualMabMap()}else s.debug("CMAB / No CMAB experiments found for the current layer id:",e)},n.getCmabUUIDFromVisitorStore=function(t,n){if(!n||!t)return null;var e=c.getContextualMabMap();return e&&e[t]&&e[t][n]?e[t][n].cmabUUID:null},n.updateCmabTimeoutInVisitorStore=function(t,e){var i;if(!e||!t)return null;var r=c.getContextualMabMap();if(null==r||null==(i=r[t])?void 0:i[e]){var o=r[t][e];o.isTimeout||n.has30MinOr24HrTimeoutOccurred(o)||(o.st30MinTimeout=(new Date).toISOString(),c.updateContextualMabMap(t,e,o),c.persistContextualMabMap())}},n.getCmabVariationDataFromVisitorStore=function(t){var e,i=n.getCmabLayerIdFromExperiment(t),r=c.getContextualMabMap();if(!(null==r||null==(e=r[i])?void 0:e[t.id]))return s.debug("CMAB / No CMAB store found for experiment:",t.id),null;s.debug("CMAB / CMAB store found for experiment:",t.id);var o=r[i][t.id];return s.debug("CMAB / Contextual MAB Variation Data:",o),o},n.setCmabVariationDataInVisitorStore=function(t,e,i){s.debug("CMAB / Setting CMAB store for experiment:",t.id+" with variation:",e+" and cmabUUID:",i);var r=(new Date).toISOString(),o=n.getCmabLayerIdFromExperiment(t),a=n.getVisitorAttributesHash(t),u={variationId:e,visitorId:c.getCurrentId(),cmabUUID:i,st30MinTimeout:r,st24HrTimeout:r,userAttributeHash:a,isTimeout:!1};c.updateContextualMabMap(o,t.id,u),c.persistContextualMabMap()},n.getStringifiedValue=function(t){if("string"==typeof t)return t;var n="";try{n=o.stringify(t)}catch(e){s.error("CMAB / Failed to stringify value for attributes:",t,e)}return n},n.getVisitorCmabAttributesForExperiment=function(t){var e,r=[],o=v.getAllPlugins(f.PluginTypes.audienceMatchers);if(!(null==t||null==(e=t.experimentMetadata)?void 0:e.cmabAttributes))return r;var a=t.experimentMetadata.cmabAttributes,u=a.customAttributes,c=a.standardAttributes;return i.forEach(u,(function(t){var e,i=(null==(e=d.getAttribute(["custom",t.id]))?void 0:e.value)||"";i=n.getStringifiedValue(i),r.push({id:t.id,type:t.type,value:i,client_api_name:t.clientApiName})})),i.forEach(c,(function(t){var e,i,a=(null==(e=o[t.id])||null==(i=e.fieldsNeeded)?void 0:i[0])||t.id,u=d.getAttribute(a)||"";u=n.getStringifiedValue(u),r.push({id:t.id,type:t.type,value:u})})),s.debug("CMAB / Current Visitor CMAB Attributes for Experiment:",t.id,"are:",r),r},n.generateAttributesHash=function(t){return r.hashToHex(r.toByteString(o.stringify(t)),r.Seed.BEHAVIOR_EVENT)},n.getVisitorAttributesHash=function(t){var e=n.getVisitorCmabAttributesForExperiment(t);return n.generateAttributesHash(e)},n.hasAttributesChanged=function(t,e){var i=n.getVisitorAttributesHash(t);return i!==e.userAttributeHash&&(s.debug("CMAB / User attributes hash has changed from:",e.userAttributeHash," to ",i),!0)},n.getDcpCustomerIds=function(){var t=h.getDCPKeyfieldLocators(),n=c.getCurrentId();return l.getCurrentAliases(t,n)},n.getDcpServiceId=function(){return h.getDCPServiceId()}},3270:function(t,n,e){t.exports=function(t){t.registerAudienceMatcher("code",e(5635))}},5635:function(t,n,e){var i=e(4816),r=e(1284);n.fieldsNeeded=[],n.match=function(t,n){if(i.isUndefined(n.value))return!0;if("function"==typeof n.value)try{return Boolean(r.apply(n.value))}catch(e){return!1}else try{return Boolean(r.eval(n.value))}catch(o){return!1}return!1}},3719:function(t,n,e){t.exports=function(t){t.registerVisitorProfileProvider(e(572)),t.registerAudienceMatcher("cookies",e(2648))}},2648:function(t,n,e){var i=e(7049);t.exports={fieldsNeeded:["cookies"],match:function(t,n){var e=n.name,r=n.value,o=n.match,a=t.cookies[e];return i.hasMatch(r,o,a)}}},572:function(t,n,e){var i=e(4816),r=e(7690),o=e(9932).get("stores/audience_data");t.exports={provides:"cookies",isLazy:!0,getter:[function(){var t=r.getAll(),n=o.getFeaturesNeeded("cookies");return i.reduce(t,(function(t,e,r){return i.has(n,r)&&(t[r]=e),t}),{})}]}},3685:function(t,n,e){t.exports=function(t){t.registerVisitorProfileProvider(e(3510));var n=e(7178);t.registerAudienceMatcher("custom_attribute",n),t.registerAudienceMatcher("custom_dimension",n)}},7178:function(t,n,e){var i=e(4816),r=e(7049);n.match=function(t,n){var e;return t.custom&&(e=t.custom[n.name]),i.isObject(e)&&(e=e.value),r.hasMatch(n.value,n.match,e)}},3510:function(t,n,e){var i=e(4816),r=e(8738),o=e(7936),a=e(9932).get("stores/dimension_data");t.exports={provides:"custom",attributionType:r.AttributionTypes.LAST_TOUCH,restorer:function(t){return i.reduce(t,(function(t,n,e){var r=e,u=a.getByApiName(e),c=a.getById(e);return i.isObject(n)?(!n.id&&u&&(c=u,r=u.id,i.extend(n,{id:c.segmentId||c.id})),!n.name&&c&&c.apiName&&(n.name=c.apiName),n.id||c||o.warn("Unable to determine ID for custom attribute:",e,"; segmentation is disabled."),t[r]=n,t):(o.error('Unable to restore custom attribute "'+e+'" because value is not an object'),t)}),{})},shouldTrack:!0}},8654:function(t,n,e){var i=e(4816),r=e(7266),o=e(7690),a=e(7936),u=e(5343),c="cookie",s="js_variable",f="query_param",l="uid";n.getCurrentAliases=function(t,n){var e={};return i.each(t,(function(t){if(!t.is_optimizely){var d=t.dcp_datasource_id,v=t.type,h=t.name||"";if(d){var p=null;switch(v){case c:p=o.get(h);break;case s:try{p=u.getGlobal(h)}catch(g){a.warn("Failed getting global DCP keyfieldLocator:",h)}break;case f:p=r.getQueryParamValue(h);break;case l:p=n}(i.isNumber(p)||i.isString(p))&&(e[d]=p)}else a.error("DCP / No DCP datasource id specified")}})),e}},7481:function(t,n,e){var i=e(4816),r=e(212).Promise;function o(t,n,e){var i=u(t,e),r=n.getAttribute("dcpData");if(r)return c(i,r)}function a(t,n,e,o){var a=u(t,o),s=n.getAttribute("dcpData");if(s){var f=c(a,s);if(!i.isUndefined(f))return r.resolve(f)}return e.getPendingAttributeValue("dcpData").then(i.partial(c,a))}function u(t,n){var e=t.getVisitorAttribute(n);if(!e.dcp_datasource_id)throw new Error("Unrecognized DCP data source ID");return e}function c(t,n){return((n.attributes||{})[t.dcp_datasource_id]||{})[t.id]}t.exports=["stores/visitor_attribute_entity","stores/visitor","stores/provider_status",function(t,n,e){return{getAttributeValue:i.partial(o,t,n),waitForAttributeValue:i.partial(a,t,n,e)}}]},406:function(t,n,e){t.exports=function(t){t.registerApiModule("dcp",e(7481)),t.registerDependency("sources/dcp",e(5478)),t.registerVisitorProfileProvider(e(5604)),t.registerAudienceMatcher("dynamic_customer_profile",e(5071))}},5071:function(t,n){n.fieldsNeeded=["dcpData"],n.match=function(t,n){return!!((t.dcpData||{}).conditionValuesResults||{})[n.value]}},5604:function(t,n,e){var i=e(4816),r=e(8654);t.exports={provides:"dcpData",isAsync:!0,isLazy:!1,getter:["stores/global","stores/visitor_id","stores/visitor","sources/dcp",function(t,n,e,o){return function(e,a){var u=t.getDCPKeyfieldLocators(),c=n.getBucketingId();if(!c)throw new Error("DCP: No bucketingId set");var s={},f=t.getProjectId(),l=t.getSnippetId();if(l===f){if(!t.getDCPServiceId())throw new Error("DCP: No dcpServiceId configured in Snippet");i.extend(s,{dcpServiceId:t.getDCPServiceId(),snippetId:l})}else{var d=i.find(u,(function(t){return t.is_optimizely}));if(!d||!d.dcp_datasource_id)throw new Error("DCP: No Optimizely datasource found in keyfield locators for Project");i.extend(s,{projectId:f,optlyDatasourceId:d.dcp_datasource_id})}var v=e()||{},h=r.getCurrentAliases(u,c);return i.matches(h)(v.aliases||{})||a(void 0),i.extend(s,{uid:c,currentAliases:h}),o.fetchDCPData(s)}}]}},5478:function(t,n,e){var i=e(4816),r=e(9621),o=e(8064).U,a=e(9505),u=e(7936),c=e(212).Promise,s=e(9895),f=n.DCPError=o("DCPError");n.fetchDCPData=function(t){var n=function(t){var n;if(t.projectId){var e=t;if(!e.optlyDatasourceId)return u.error("DCP / No Optimizely datasource id passed to getBaseURL."),null;n=[e.projectId,e.optlyDatasourceId.toString(),e.uid]}else{var r=t;n=["snippet",r.snippetId,r.dcpServiceId,r.uid]}var o=i.map(n,encodeURIComponent),a=[l].concat(o).join("/"),c=i.map(t.currentAliases,(function(t,n){return encodeURIComponent(n)+"="+encodeURIComponent(t)}));return i.isEmpty(c)||(a+="?"+c.join("&")),a}(t);if(!n)return c.resolve({});var e=i.partial(s.request,{url:n}),o="dcps_"+n;return r.makeAsyncRequest(o,(function(){e().then((function(t){var n;if(t.status>399)throw new f(t.status+": "+t.statusText);try{n=a.parse(t.response)}catch(e){throw new f("Error parsing response: "+e.toString())}if(!n)throw new f("No data received");return n}),(function(t){throw new f(t.status+": "+t.statusText)})).then(i.partial(r.resolveRequest,o),i.partial(r.rejectRequest,o))})).then((function(t){return t}))};var l="https://tapi.optimizely.com/api/targeting"},5307:function(t,n,e){t.exports=function(t){t.registerDependency("sources/device",e(5981)),t.registerVisitorProfileProvider(e(7684)),t.registerAudienceMatcher("device",e(3386))}},3386:function(t){t.exports={fieldsNeeded:["device"],match:function(t,n){return t.device===n.value}}},7684:function(t){t.exports={provides:"device",shouldTrack:!0,isSticky:!0,getter:["sources/device",function(t){return t.getDevice()}]}},5981:function(t,n,e){var i=e(6349);n.getDevice=function(){var t=i.get().device;return"unknown"!==t.model?t.model:"tablet"===t.type?"tablet":t.isMobile?"mobile":"desktop"}},6475:function(t,n,e){t.exports=function(t){t.registerVisitorProfileProvider(e(4387)),t.registerAudienceMatcher("device_type",e(5682))}},5682:function(t){t.exports={fieldsNeeded:["device_type"],match:function(t,n){return t.device_type===n.value}}},4387:function(t,n,e){var i=e(6349);t.exports={provides:"device_type",shouldTrack:!0,isSticky:!0,getter:[function(){var t=i.get().device;switch(t.type){case"mobile":return"phone";case"tablet":case"desktop_laptop":return t.type;default:return"other"}}]}},4767:function(t,n,e){t.exports=function(t){t.registerVisitorProfileProvider(e(9403)),t.registerAudienceMatcher("query",e(128))}},128:function(t,n,e){var i=e(4816),r=e(7049);n.fieldsNeeded=["queryParams"],n.match=function(t,n){var e=i.find(t.queryParams,(function(t){return t[0]===n.name}));return r.hasMatch(n.value,n.match,e?e[1]:null)}},9403:function(t,n,e){var i=e(7266);t.exports={provides:"queryParams",getter:[function(){return i.getQueryParams()}]}},2051:function(t,n,e){function i(t,n){return null!=n&&"undefined"!=typeof Symbol&&n[Symbol.hasInstance]?!!n[Symbol.hasInstance](t):t instanceof n}var r=e(4816),o=e(9505),a=e(7936),u=e(212).Promise,c=e(9895),s=1,f=2,l="itemMetadata",d="recos";function v(t){return t===f}function h(t,n){if(!function(t){return t===s}(n))return d in t?o.parse(t.recos):(a.warn('recommender / Expected key "recos" not found'),[]);var e=new RegExp("^reco(\\d+)$"),i=r.reduce(t,(function(n,i,a){var u=a.match(e);if(u){var c=o.parse(t[a]);c&&r.isObject(c)&&(n[u[1]]=c)}return n}),[]);return r.filter(i,(function(t){return!r.isUndefined(t)}))}function p(t,n){return[t,encodeURIComponent(n)].join("/")}function g(t,n){var e=function(t,n,e){if(!r.isArray(t)||r.isEmpty(t))throw new Error("No "+e+"s available");var i;if(n){if(!(i=r.find(t,{id:n})))throw new Error("No "+e+" found with specified id "+n)}else{if(t.length>1)throw new Error("No "+e+" id specified when there are more than one available.");i=t[0]}return i},i=e(t.getRecommenderServices(),n&&n.recommenderServiceId,"recommender service");return i.idTagName||(i.idTagName="id"),{recommenderService:i,recommender:e(i.recommenders,n&&n.recommenderId,"recommender")}}function m(t){return o.parse(t).data}function _(t,n){return c.request({url:p(t,n)}).then((function(t){var n=m(t.response),e={};return l in n&&(e=o.parse(n.itemMetadata)),e}))}function w(t,n,e,o){var a=!(!o||!o.fetchWithMetadata),u=o&&o.overrideServingUrl||n.servingUrl;return c.request({url:p(u,e)}).then((function(n){var e,u=m(n.response);return e=h(u,t.serviceVersion),a&&v(t.serviceVersion)?y(t,r.map(e,t.idTagName),o).then((function(t){return t=r.map(t,(function(t){return i(t,Error)&&(t={}),delete t.__proto__,t})),r.merge(e,t)})):e}))}function y(t,n,e){var i=e&&e.overrideCatalogUrl||t.catalogUrl;return r.isString(n)?_(i,n):u.all(r.map(n,(function(t){return _(i,t)["catch"]((function(n){return a.warn("recommender / Failed to get recommendations for item:",t,n),n}))})))}function b(t,n,e){var i=g(t,e);return w(i.recommenderService,i.recommender,n,{overrideServingUrl:e&&e.overrideServingUrl,overrideCatalogUrl:e&&e.overrideCatalogUrl,fetchWithMetadata:!0})}function E(t,n,e){var i=g(t,e),r=i.recommenderService,o=i.recommender;if(!v(r.serviceVersion))throw new Error("Recommender service "+r.id+" serves self-contained recos. Use `fetchRecommendations` API call");return w(r,o,n,{overrideServingUrl:e&&e.overrideServingUrl,fetchWithMetadata:!1})}function I(t,n,e){var i=g(t,e).recommenderService;if(!v(i.serviceVersion))throw new Error("Recommender service "+i.id+" serves self-contained recos. Use `fetchRecommendations` API call");return r.isArray(n)&&n.length>20?u.reject("Cannot fetch more than 20 items"):y(i,n,e)}function A(t,n,e,i){return new T(t,n,e,i)}function T(t,n,e,i){this.recommenderSettings=n;var r=g(t,n);this.recommenderService=r.recommenderService,this.recommender=r.recommender,this.targetId=e,i&&(this.preFilter=i.preFilter,this.canonicalize=i.canonicalize,this.postFilter=i.postFilter),this._globalStore=t,this.reset()}function S(){var t={recosNoMeta:[],recosNoMetaOffset:0,recos:[],recosOffset:0};return a.debug("recommender / fetching recommended items for",this.targetId,"from recommender",this.recommender.id),v(this.recommenderService.serviceVersion)?E(this._globalStore,this.targetId,this.recommenderSettings).then(r.bind((function(n){return t.recosNoMeta=r.filter(n,this.preFilter),t}),this)):b(this._globalStore,this.targetId,this.recommenderSettings).then(r.bind((function(n){return t.recos=r(n).filter(this.preFilter).map(this.canonicalize).filter(this.postFilter).value(),t}),this))}function k(t){var n=t.numNeeded,e=t.buffer,o=e.recosNoMeta.length-e.recosNoMetaOffset;if(n<=0||o<=0)return u.resolve(t);var c=Math.max(n,5),s=r.slice(e.recosNoMeta,e.recosNoMetaOffset,e.recosNoMetaOffset+c),f=r.map(s,this.recommenderService.idTagName);e.recosNoMetaOffset+=f.length;var l=t.recosSoFar;return a.debug("recommender / fetching metadata for",f,"from recommender",this.recommender.id),I(this._globalStore,f,this.recommenderSettings).then(r.bind((function(o){o=r.map(o,(function(t){return i(t,Error)?{}:t})),e.recos=r(s).merge(o).map(this.canonicalize).filter(this.postFilter).value();var a=r.slice(e.recos,0,n);return e.recosOffset=a.length,t.recosSoFar=l.concat(a),t.numNeeded-=a.length,t.numNeeded>0?k.call(this,t):t}),this))}T.prototype.reset=function(){this._bufferPromise=null},T.prototype.next=function(t){var n=Math.floor(r.isNumber(t)?t:1);if(n<=0)throw new Error("Invalid argument "+t+". Must be positive integer");this._bufferPromise||(this._bufferPromise=S.call(this));var e=this._bufferPromise.then(r.bind((function(t){var e=[];return t.recos.length-t.recosOffset>0&&(e=t.recos.slice(t.recosOffset,t.recosOffset+n),t.recosOffset+=e.length,n-=e.length),n<=0?{result:e,buffer:t}:k.call(this,{buffer:t,recosSoFar:e,numNeeded:n}).then((function(t){return{result:t.recosSoFar,buffer:t.buffer}}))}),this));return this._bufferPromise=e.then((function(t){return t.buffer})),e.then((function(t){return t.result}))},t.exports=["stores/global",function(t){return{fetchRecommendations:r.partial(b,t),fetchRecommendedItems:r.partial(E,t),fetchItemMetadata:r.partial(I,t),getRecommendationsFetcher:r.partial(A,t)}}]},2757:function(t,n,e){t.exports=function(t){t.registerApiModule("recommender",e(2051))}},6224:function(t,n,e){t.exports=function(t){t.registerVisitorProfileProvider(e(1914)),t.registerAudienceMatcher("referrer",e(6440))}},6440:function(t,n,e){var i=e(5719);n.fieldsNeeded=["referrer"],n.match=function(t,n){return null!==t.referrer&&i(t.referrer,n)}},1914:function(t,n,e){var i=e(8416),r=e(7179);t.exports={provides:"referrer",shouldTrack:!0,isSticky:!0,getter:[function(){var t=r.getReferrer()||i.getReferrer();return""===t&&(t=null),t}]}},8128:function(t,n,e){t.exports=function(t){t.registerVisitorProfileProvider(e(7018)),t.registerAudienceMatcher("source_type",e(3053))}},3053:function(t,n,e){var i=e(7049);n.fieldsNeeded=["source_type"],n.match=function(t,n){return i.hasMatch(n.value,n.match,t.source_type)}},7018:function(t,n,e){var i=e(7266),r=e(8416),o=e(7179),a=e(140),u=["google\\.\\w{2,3}(\\.\\w{2,3})?/(search|url)","bing\\.\\w{2,3}(\\.\\w{2,3})?/(search|url)","yahoo\\.\\w{2,3}(\\.\\w{2,3})?/search","baidu\\.\\w{2,3}(\\.\\w{2,3})?/","https://(www)?\\.google\\..*?/?$","https://search\\.yahoo\\..*?/?$","https://(www)?\\.bing\\..*?/?$"];t.exports={provides:"source_type",shouldTrack:!0,isSticky:!1,getter:[function(){return function(t,n){var e,c=t(),s=function(){if(i.getQueryParamValue("utm_source")||i.getQueryParamValue("utm_campaign")||i.getQueryParamValue("gclid")||i.getQueryParamValue("otm_source"))return"campaign";for(var t=o.getReferrer()||r.getReferrer(),n=0;n<u.length;n++){var e=u[n];if(t.match(e))return"search"}return t&&a.guessDomain(t)!==a.guessDomain(i.getUrl())?"referral":"direct"}();e=s,(!c||"direct"!==e)&&n(s)}}]}},7244:function(t,n,e){t.exports=function(t){t.registerVisitorProfileProvider(e(8545)),t.registerVisitorProfileProvider(e(7857)),t.registerAudienceMatcher("time_and_day",e(8548))}},8548:function(t,n,e){var i=e(1214);n.fieldsNeeded=["currentTimestamp"],n.match=function(t,n){return i.test(n.value,new Date(t.currentTimestamp))}},8545:function(t,n,e){var i=e(8701);t.exports={provides:"currentTimestamp",shouldTrack:!0,isLazy:!0,getter:[function(){return i.now()}]}},7857:function(t){t.exports={provides:"offset",shouldTrack:!0,isLazy:!0,getter:[function(){return(new Date).getTimezoneOffset()}]}},1214:function(t,n,e){var i=e(4816);function r(t){var n=t.split(":");if(2!==n.length)throw new Error("optly.timeAndDayInterval.timeStringToMinutes: Invalid time string "+t);return 60*parseInt(n[0],10)+parseInt(n[1],10)}n.test=function(t,n){var e=function(t){var n=t.split("_");if(3!==n.length)throw new Error("Invalid time and day string "+t);var e=n[2].split(",");return{start_time:n[0],end_time:n[1],days:e}}(t),o=r(e.start_time),a=r(e.end_time),u=60*n.getHours()+n.getMinutes(),c=["sunday","monday","tuesday","wednesday","thursday","friday","saturday"][n.getDay()];return u>=o&&u<=a&&i.includes(e.days,c)}},8835:function(t,n,e){t.exports=function(t){t.registerVisitorProfileProvider(e(9490))}},9490:function(t){t.exports={provides:"visitorId",getter:["stores/visitor_id",function(t){return t.getRandomId()}]}},7099:function(t,n,e){var i=e(9505),r=e(7936),o=e(2899),a=e(9801),u=e(1346),c=e(5343),s=e(9932).get("stores/rum"),f="google_analytics_4",l="gtag",d="dataLayer",v="optimizely_decision",h="experience_impression",p=function(t,n){return a.pollFor((function(){return function(t){var n=t.getGlobal(l);return n||null}(c)}),200,50).then((function(e){r.log("GA4 Integration: gtag finally exists, sending now."),s.getSampleRum()&&o.timeEnd("gtagReady"),r.debug("GA4 Integration: calling ga4 with data: "+i.stringify(t)),e("event",h,t),r.debug("GA4 Integration: calling ga4 with custom event data: "+i.stringify(n)),e("event",v,n)}))};var g=function(t,n){var e=c.getGlobal(d);r.debug("GA4 Integration: found dataLayer object "+e),e||(r.debug("GA4 Integration: dataLayer object dataLayer is empty, initializing it"),c.setGlobal(d,[]),e=c.getGlobal(d)),r.log("GA4 Integration: attempting push to dataLayer");try{var o=Object.assign({event:h},t);r.debug("GA4 Integration: pushing data to GTM: "+i.stringify(o)),e.push(o);var a=Object.assign({event:v},n);r.debug("GA4 Integration: pushing custom data to GTM: "+i.stringify(a)),e.push(a)}catch(u){r.warn("GA4 Integration: Push to dataLayer failed: "+u)}return Promise.resolve()},m={preRedirectPolicy:u.PreRedirectPolicies.PERSIST_BEFORE_REDIRECT,postRedirectPolicy:u.PostRedirectPolicies.TRACK_IMMEDIATELY,nonRedirectPolicy:u.NonRedirectPolicies.TRACK_IMMEDIATELY,trackLayerDecision:function(t){var n=t.integrationSettings;if(n&&n[f]){if(t.experimentId&&t.variationId){var e="on"===n[f].is_using_gtm;r.debug("GA4 Integration: is using GTM: "+e);var i,o,a="equal_priority"===t.layerPolicy;r.debug("GA4 Integration: is personalization campaign: "+a),a?(i="OPT-"+t.layerId+"("+t.layerName+")-"+t.experimentId+"("+t.experimentName+")-"+t.variationId+"("+t.variationName+")",o={Campaign:t.layerName+" ("+t.layerId+")",Variation:t.variationName+" ("+t.variationId+")",Holdback:t.isLayerHoldback}):(i="OPT-"+t.experimentId+"("+t.experimentName+")-"+t.variationId+"("+t.variationName+")",o={Experiment:t.experimentName+" ("+t.experimentId+")",Variation:t.variationName+" ("+t.variationId+")",Holdback:t.isLayerHoldback});var u={exp_variant_string:i,Holdback:t.isLayerHoldback};return e?g(u,o)["catch"]((function(t){r.warn("Tracker for GTM ",f,"failed:",t)})):p(u,o)["catch"]((function(t){r.warn("Tracker for ",f,"failed:",t)}))}r.debug("GA4 Integration: empty experiment or variation ID, exiting")}else r.debug("GA4 Integration: did not find vendor "+f+" in integration settings, exiting")},serializeSettings:i.stringify,deserializeSettings:i.parse};t.exports=function(t){t.registerAnalyticsTracker("google_analytics_4",m)}},2935:function(t,n,e){var i=e(9505),r=e(7936),o=e(9801),a=e(7179),u=e(1346),c=e(5343),s="google_universal_analytics",f=e(8668);var l=function(t,n){return o.pollFor((function(){return function(t){var n=t.getGlobal("GoogleAnalyticsObject");return n?t.getGlobal(n):null}(c)}),200,50).then((function(e){var i=n.universal_analytics_tracker,r=i?i+".":"",o=n.universal_analytics_slot,u=a.getReferrer();u&&e(r+"set","referrer",u);var c={nonInteraction:!0};c["dimension"+o]=t,e(r+"send","event","Optimizely","Assigned To Campaign",c)}))},d={preRedirectPolicy:u.PreRedirectPolicies.PERSIST_BEFORE_REDIRECT,postRedirectPolicy:u.PostRedirectPolicies.TRACK_IMMEDIATELY,nonRedirectPolicy:u.NonRedirectPolicies.TRACK_IMMEDIATELY,trackLayerDecision:function(t){var n=t.integrationSettings;if(n&&n[s]&&t.experimentId&&t.variationId){var e={id:t.layerId,name:t.layerName,policy:t.layerPolicy,integrationStringVersion:t.integrationStringVersion},i={id:t.experimentId,name:t.experimentName},o={id:t.variationId,name:t.variationName},a=t.isLayerHoldback,u=f.generateAnalyticsString(e,i,o,a,150,!0);if(u)return l(u,n[s])["catch"]((function(t){r.warn("Tracker for",s,"failed:",t)}))}},serializeSettings:i.stringify,deserializeSettings:i.parse};t.exports=function(t){t.registerAnalyticsTracker("google_universal_analytics",d)}},2225:function(t,n,e){var i=e(4816),r=e(4248),o=e(7276),a=e(9590),u=e(8064).U,c=e(9505),s=e(7936),f=e(1346),l=e(1683),d=e(5343),v=e(9895),h=e(9932),p=(e(8416),e(8120)),g=e(4141),m=e(349),_=h.get("stores/global"),w=h.get("stores/tracker_optimizely"),y=e(468),b=n.Error=u("OptimizelyTrackerError"),E="client_activation",I="campaign_activated",A="view_activated",T={revenue:{validate:M,sanitize:Math.floor,excludeFeature:!0},quantity:{validate:M,sanitize:Math.floor,excludeFeature:!0},value:{validate:M,sanitize:i.identity}},S="AUTO",k=[function(){return function(t){L(function(t){return i.extend({entity_id:t.pageId,key:t.pageApiName,timestamp:t.timestamp,uuid:t.eventId,type:A},D(t.eventTags))}(t),t.userFeatures,W(t.layerStates))}}],R=[function(){return function(t){!function(t){var n=i.isNull(_.getAnonymizeIP())?void 0:_.getAnonymizeIP(),e={account_id:t.accountId,anonymize_ip:n,client_name:t.clientName,client_version:t.clientVersion,project_id:t.projectId,visitors:[]};e.revision=t.revision,e.enrich_decisions=!0;var r={session_id:V(t.sessionId),visitor_id:t.visitorId,attributes:[],snapshots:[]},o=W(t.layerStates);m.dispatch(a.REGISTER_TRACKER_VISITOR,{data:e,visitor:r,decisions:o}),K()}(t),L(function(t){return{entity_id:null,type:E,uuid:t.eventId,timestamp:t.timestamp}}(t),t.userFeatures,W(t.layerStates))}}],N=[function(){return function(t){var n;L((n=t,i.extend({entity_id:n.eventEntityId,key:n.eventApiName,timestamp:n.timestamp,uuid:n.eventId,type:n.eventCategory,properties:O(n.eventProperties)},D(n.eventTags))),t.userFeatures,W(t.layerStates))}}],C=[function(){return function(t){var n;L((n=t,i.extend({entity_id:n.eventEntityId,key:n.eventApiName,timestamp:n.timestamp,uuid:n.eventId,type:n.eventCategory},D(n.eventTags))),t.userFeatures,W(t.layerStates))}}];function D(t){var n=function(t,n,e){try{x(n),t[e]=n}catch(i){r.emitError(new b("Bad value for eventTags["+e+"]: "+i.message))}return t},e=i.keys(T),o=i.omit(t,e),a=i.pick(t,e),u=i.reduce(o,n,{}),c=i.reduce(a,(function(t,e,i){var o=T[i];o.excludeFeature||n(u,e,i);try{o.validate(e),t[i]=o.sanitize(e),u[i]=t[i]}catch(a){r.emitError(new b("Bad value for eventMetrics["+i+"]: "+a.message))}return t}),{});return c.tags=u,c}function O(t){if(i.keys(t).length<=15)return t;var n={},e={},r=0;for(var o in t)r<15?n[o]=t[o]:e[o]=t[o],r++;return s.log("Custom event has more than 15 properties. The following properties were not pushed",e),n}function x(t){if(null==t)throw new Error("Feature value is null");if("object"==typeof t){var n;try{n=c.stringify(t)}catch(e){}throw new Error('Feature value is complex: "'+n)}}function M(t){if(null==t)throw new Error("Metric value is null");if(!i.isNumber(t))throw new Error("Metric value is not numeric")}function P(t){return i.reduce(t,(function(t,n){try{x(n.value),t.push({entity_id:n.id||null,key:n.name,type:n.type,value:n.value})}catch(e){s.warn("Error evaluating user feature",n,e)}return t}),[])}function L(t,n,e){m.dispatch(a.REGISTER_TRACKER_EVENT,{event:t,decisions:e}),U(n),K()}function U(t){var n=P(t);m.dispatch(a.UPDATE_TRACKER_VISITOR_ATTRIBUTES,{attributes:n})}function V(t){return S}function F(){if(w.canSend()){var t=w.hasEventsToSend(),n=w.hasPreviousBatchesToSend();t||n?(n&&(i.each(w.getPreviousBatches(),B),m.dispatch(a.RESET_TRACKER_PREVIOUS_BATCHES)),t&&(m.dispatch(a.FINALIZE_BATCH_SNAPSHOT),B(w.getEventBatch()),m.dispatch(a.RESET_TRACKER_EVENTS))):s.debug("Not sending events because there are no events to send")}else s.debug("Not sending events (holding)")}function B(t){s.debug("Sending ticket:",t);var n=o.generate();v.retryableRequest({url:"https://logx.optimizely.com/v1/events",method:"POST",data:z(t)},n)}function z(t){return i.extend({},i.pick(t,["account_id","anonymize_ip","client_name","client_version","enrich_decisions","project_id","revision"]),{visitors:i.map(t.visitors,G)})}function G(t){return{visitor_id:t.visitor_id,session_id:S,attributes:i.map(t.attributes,j),snapshots:i.map(t.snapshots,q)}}function j(t){return $(t,{entity_id:"e",key:"k",type:"t",value:"v"})}function q(t){var n=t.events;return n=function(t){var n=i.reduce(t,(function(t,n){var e;if(t[e=n.type===A&&i.isEmpty(n.tags)&&i.isEmpty(i.pick(n,i.keys(T)))?n.type:n.uuid]){var r=t[e].timestamp;n.timestamp>r&&(r=n.timestamp),t[e]=i.extend({},t[e],{key:t[e].key+"-"+(n.key||""),entity_id:t[e].entity_id+"-"+n.entity_id,timestamp:r})}else t[e]=n;return t}),{});return i.values(n)}(n),{activationTimestamp:_.getActivationTimestamp(),decisions:i.map(t.decisions,H),events:i.map(n,Y)}}function H(t){var n=$(t,{campaign_id:"c",experiment_id:"x",is_campaign_holdback:"h",variation_id:"v"});return n.m=t.metadata?$(t.metadata,{cmab_uuid:"cmab_uuid"}):{},n}function Y(t){return t.key===I&&(t.type=I,delete t.key),$(t,{entity_id:"e",key:"k",quantity:"q",revenue:"$",tags:"a",properties:"p",timestamp:"t",uuid:"u",value:"v",type:"y"})}function $(t,n){return i.reduce(t,(function(t,e,i){return i in n&&(t[n[i]||i]=e),t}),{})}function K(){if(w.shouldBatch()){if(!w.isPolling()){d.setTimeout((function t(){F(),w.isPolling()&&d.setTimeout(t,1e3)}),1e3),m.dispatch(a.SET_TRACKER_POLLING,!0),d.setTimeout((function(){m.dispatch(a.SET_TRACKER_BATCHING,!1),m.dispatch(a.SET_TRACKER_POLLING,!1)}),1e4)}}else F()}function W(t){return i.map(t,(function(t){var n=y.getCmabUUIDAndUpdate30MinTimeout(t.layerId,t.decision.experimentId),e=n?{cmab_uuid:n}:{};return{campaign_id:t.layerId,experiment_id:t.decision.experimentId,variation_id:t.decision.variationId,is_campaign_holdback:t.decision.isLayerHoldback,metadata:e}}))}function X(){var t=w.getPersistableState();if(t)try{s.debug("Persisting pending batch:",t),l.persistTrackerOptimizelyData(t),m.dispatch(a.SET_TRACKER_DIRTY,!1)}catch(n){s.debug("Failed to persist pending batch:",n)}}var J={trackLayerDecision:function(t){t.timing===f.TrackLayerDecisionTimingFlags.postRedirectPolicy?function(t){var n=P(t.userFeatures),e={account_id:t.accountId,anonymize_ip:t.anonymizeIP,client_name:t.clientName,client_version:t.clientVersion,project_id:t.projectId,visitors:[{session_id:V(t.sessionId),visitor_id:t.visitorId,attributes:n,snapshots:[{decisions:[{campaign_id:t.layerId,experiment_id:t.experimentId,variation_id:t.variationId,is_campaign_holdback:t.isLayerHoldback}],events:[{uuid:t.decisionId,entity_id:t.layerId,timestamp:t.timestamp,type:I}]}]}]};m.dispatch(a.REGISTER_PREVIOUS_BATCH,e),K()}(t):function(t){var n={entity_id:t.layerId,type:I,uuid:t.decisionId,timestamp:t.timestamp};m.dispatch(a.REGISTER_TRACKER_DECISION,{decisionEvent:n,decisions:W(t.layerStates)}),U(t.userFeatures),K()}(t)},postRedirectPolicy:f.PostRedirectPolicies.TRACK_AFTER_SYNC,nonRedirectPolicy:f.NonRedirectPolicies.TRACK_IMMEDIATELY,onPageActivated:k,onClientActivation:R,onClickEvent:C,onCustomEvent:N};t.exports=function(t){t.registerAnalyticsTracker("optimizely",J),p.on({filter:{type:g.TYPES.ANALYTICS,name:"sendEvents"},handler:function(){m.dispatch(a.SET_TRACKER_SEND_EVENTS,!0),w.isPolling()||F()}}),p.on({filter:{type:g.TYPES.ANALYTICS,name:"holdEvents"},handler:function(){m.dispatch(a.SET_TRACKER_SEND_EVENTS,!1)}}),m.dispatch(a.SET_TRACKER_SEND_EVENTS,!0);var n=p.on({filter:{type:"lifecycle",name:"activated"},handler:function(){w.observe(X),p.off(n)}})}},1652:function(t,n,e){var i=e(8416),r={match:function(t,n){return!!i.querySelector(n.value)}};t.exports=function(t){t.registerViewMatcher("element_present",r)}},2418:function(t,n,e){t.exports=function(t){t.registerViewProvider(e(4485)),t.registerViewMatcher("url",e(4576))}},4576:function(t,n,e){var i=e(5719);t.exports={fieldsNeeded:["url"],match:function(t,n){return i(t.url,n)}}},4485:function(t,n,e){var i=e(7266);t.exports={provides:"url",getter:[function(){return i.getUrl()}]}},8394:function(t,n,e){var i=e(3466),r=e(1284);t.exports=function(t,n){var e=t.locator;if("function"==typeof e){var o=r.apply(e,n);return i(t.valueType,o)}return null}},3466:function(t,n,e){var i=e(4816),r=e(6530).enums,o=e(6530).Error;t.exports=function(t,n){if(i.isUndefined(n)||i.isNull(n))return n;var e=n;switch(t){case r.valueType.STRING:i.isString(n)||(e=String(n));break;case r.valueType.NUMBER:if(e=Number(n),isNaN(e))throw new o(n+" is not a number");break;case r.valueType.CURRENCY:if(e=Number(n),isNaN(e)||Math.floor(e)!==e)throw new o(n+" cannot be parsed as currency (must be an integer)");break;default:throw new o("Unknown ViewTag type: "+t)}return e}},1572:function(t,n,e){var i=e(6530).enums.locatorType;t.exports=function(t){t.registerViewTagLocator(i.JAVASCRIPT,e(8394))}},2216:function(t,n,e){var i=e(8416),r=e(2524).nodeNames,o=e(5289);t.exports=function(t){var n,e=t.locator,a=i.querySelectorAll(e);if(a.length>0){var u=a[0];switch(u.nodeName){case r.INPUT:case r.SELECT:n=u.value.trim();break;default:n=(a[0].innerText||a[0].textContent).trim().replace(/\s+/g," ")}}return o(t.valueType,n)}},2971:function(t,n,e){var i=e(6530).enums.locatorType;t.exports=function(t){t.registerViewTagLocator(i.CSS_SELECTOR,e(2216))}},3108:function(t,n,e){var i=e(8416),r=e(8738),o=e(8120),a=e(2773),u=e(4927),c={token:void 0,setUpObserver:function(){a.createDOMChangedObserver(),this.token=o.on({filter:{type:"viewTrigger",name:"DOMChanged"},handler:function(){u.getViewsAndActivate(r.ViewActivationTypes.DOMChanged)}})},turnOffObserver:function(){o.off(this.token)}};t.exports=function(t){i.isReady()?c.setUpObserver():i.addReadyHandler(c.setUpObserver),t.registerViewTrigger("DOMChanged",c)}},8101:function(t,n,e){var i=e(4816),r=e(9590),o=e(9932),a=e(8738),u=e(8120),c=e(349),s=o.get("stores/history"),f=e(7936),l=e(212).Promise,d=e(4927),v=e(5343);function h(t){u.emit({type:"viewTrigger",name:"URLChanged",data:{source:t,newURL:v.getHref()}},!0)}t.exports=function(t){var n;n=function(){var t=s.getOriginalPushState().apply(this,arguments);return l.resolve().then((function(){h("pushState")}))["catch"]((function(t){f.error("Error while wrapPushState: ",t)})),t},c.dispatch(r.ENSURE_ORIGINAL_PUSHSTATE),v.getGlobal("history").pushState=n,function(){var t=function(){var t=s.getOriginalReplaceState().apply(this,arguments);return l.resolve().then((function(){h("replaceState")}))["catch"]((function(t){f.error("Error while wrapReplaceState: ",t)})),t};c.dispatch(r.ENSURE_ORIGINAL_REPLACESTATE),v.getGlobal("history").replaceState=t}(),v.addEventListener("popstate",p,!1),v.addEventListener("hashchange",g,!1),u.on({filter:{type:"viewTrigger",name:"URLChanged"},handler:function(){d.getViewsAndActivate(a.ViewActivationTypes.URLChanged)}}),t.registerViewTrigger("URLChanged")};var p=i.partial(h,"popstate"),g=i.partial(h,"hashchange")},3154:function(t,n,e){var i=e(4816),r=e(9932),o=e(8120),a=e(4141),u=e(5343),c=r.get("stores/directive"),s="optimizelyPreview",f=function(t){u.getGlobal(s).push(t)};n.initialize=function(t){c.isSlave()&&function(t){var n=!1;if(i.isArray(window.optimizely)&&i.each(window.optimizely,(function(e){i.isArray(e)&&"verifyPreviewProject"===e[0]&&String(e[1])===t&&(n=!0)})),!n)throw new Error("Preview projectId: "+t+" does not match expected")}(t),o.on({filter:{type:a.TYPES.ANALYTICS,name:"trackEvent"},handler:f}),o.on({filter:{type:a.TYPES.LIFECYCLE,name:"viewActivated"},handler:f}),o.on({filter:{type:a.TYPES.LIFECYCLE,name:"layerDecided"},handler:f}),o.on({filter:{type:"error"},publicOnly:!0,handler:f})},n.setupPreviewGlobal=function(){u.getGlobal(s)||u.setGlobal(s,[])},n.pushToPreviewGlobal=function(t){f(t)}},4892:function(t,n,e){var i=e(4816),r=e(7276),o=e(9621),a=e(1623),u=e(8701),c=e(8416),s=e(349),f=e(871).mM,l=e(7936),d=e(2107),v=e(212).Promise,h=e(1683),p=e(5343),g=e(9895),m=e(9590),_=e(8738),w=e(9932),y=w.get("stores/async_request"),b=w.get("stores/client_metadata"),E=w.get("stores/global"),I=w.get("stores/rum"),A=w.get("stores/performance"),T=w.get("stores/xdomain"),S=w.get("stores/view_data"),k=e(5622),R="https://rum.optimizely.com/rum",N="1.0";function C(t){return i.isEmpty(t)?v.resolve():(n=function(){return g.request({url:R,method:"POST",data:t,withCredentials:!0}).then((function(t){return o.resolveRequest("RUM_FIRST_BEACON",t),t}))["catch"]((function(t){throw l.error("POST to client-rum failed:",t),o.rejectRequest("RUM_FIRST_BEACON",t),t}))},(e=y.getPromise("RUM_FIRST_BEACON"))?e.then(n):o.makeAsyncRequest("RUM_FIRST_BEACON",n));var n,e}function D(){try{return!c.querySelector("body")}catch(t){return null}}function O(){var t=p.getGlobal("performance"),n=t?t.timing:{},e=A.getMarks()||{},r=I.getApiData(),o=I.getDOMObservationData(),a=k.get("state").getActiveExperimentIds(),u=I.getFeaturesNeededData(),s=c.parseUri(I.getScriptSrc()),l=I.getRumData()||{},v=l.extras||{};i.assign(v,{apiCalls:r,DOMObservationData:o,paintTimings:M(),activeExperimentIds:a,numPages:S.getNumberOfPages(),snippet:{scheme:s.protocol.slice(0,-1),host:s.host,path:s.pathname},networkInfo:x(),experimental:E.getExperimental(),featuresNeeded:u,beacon:{cjsOnload:!0}});var g=p.getGlobal("Prototype");g&&!i.isUndefined(g.Version)&&(v.prototypeJS=g.Version);var m=!1;m=!0;var _=T.getFrames();_.length&&(v.xdFramesLoaded=_.length);var w={id:I.getRumId(),v:N,project:E.getSnippetId()||E.getProjectId(),navigationTimings:n,userTimings:e,xd:m,apis:i.keys(r),extras:v,sampleRate:l.sampleRate};(function(){var t=f.keys(),n=i.filter(i.map(t,(function(t){var n=h.getStorageKeyFromKey(t);return n?{key:t,isForeign:h.isForeignKey(t),category:n,size:t.length+f.getItem(t).length}:null}))),e=i.reduce(n,(function(t,n){var e=n.key,i=h.getIdFromKey(e);return i?((n.isForeign?t.foreign:t.local)[i]=!0,t):t}),{local:{},foreign:{}}),r=i.chain(n).filter({isForeign:!0}).reduce((function(t,n){return t[n.key.split("_")[0]]=!0,t}),{}).value(),o={local:0,foreign:0},a={local:{},foreign:{}};i.forEach(n,(function(t){var n=t.isForeign?"foreign":"local";o[n]+=t.size,a[n][t.category]||(a[n][t.category]=0),a[n][t.category]+=t.size}));var u={numKeys:f.allKeys().length,sizeKeys:f.allKeys().toString().length,sizeValues:f.allValues().toString().length,idCounts:{local:i.keys(e.local).length,foreign:i.keys(e.foreign).length},foreignOriginCount:i.keys(r).length,byteTotals:o,byteTotalsByCategory:a};return d.estimateStorage().then((function(t){return i.assign(u,{storageEstimate:t})}))})().then((function(t){C(i.assign(w,{lsMetrics:t}))}))}function x(){var t=p.getGlobal("navigator");if(t&&t.connection)return i.pick(t.connection,["downlink","rtt","effectiveType"])}function M(){var t=p.getGlobal("performance");if(t)try{var n=t.getEntriesByType("paint");if(i.isEmpty(n))return;return i.reduce(n,(function(t,n){return t[n.name]=Math.round(n.startTime),t}),{})}catch(e){return}}n.initialize=function(){var t,n=r.generate().replace(/-/g,"");t=Math.random()<.01;var e=function(){var t=c.getCurrentScript();if(t)return t.src}();s.dispatch(m.SET_RUM_DATA,{id:n,RumHost:R,inRumSample:t,src:e,data:{id:n,sync:D(),timebase:u.now(),sampleRate:.01,url:e,extras:{initialDOMState:c.getReadyState()}}})},n.queueBeacons=function(){return I.getSampleRum()?(function(){try{p.getGlobal("requestAnimationFrame")((function(){var t=I.getRumData().timebase;s.dispatch(m.SET_RUM_DATA,{data:{render:u.now()-(t||0)}})}))}catch(t){return}}(),c.isLoaded()?p.setTimeout(O,3e3):p.addEventListener("load",O),new v((function(t,n){p.setTimeout((function(){(function(){!function(){var t={id:I.getRumId(),v:N,account:E.getAccountId(),project:E.getSnippetId()||E.getProjectId(),snippet:E.getSnippetId(),revision:E.getRevision(),clientVersion:b.getClientVersion(),hasSlave:!1,wxhr:!0,extras:{}},n=h.getPersistedBehaviorEventCount(),e=a.getEventCount();t.numBehaviorEvents=e;var r=e-n;i.extend(t.extras,{behaviorEventCountDiff:r,behaviorEventCountDecreased:r<0}),i.assign(t,function(){var t=p.getGlobal("performance");if(!t)return;var n,e=I.getScriptSrc();try{if(e){l.debug("Using derived script src: ",e);var r=t.getEntriesByName(e);r.length>0&&(n=r[0])}if(!n){var o=/\/\/[^.]+\.optimizely\.(com|test)\/(js|api\/client)\/[\d]+\.js/gi;l.debug("Scanning resource timing entries with regex");var a=t.getEntriesByType("resource");n=i.find(a,(function(t){return o.test(t.name)}))}if(n)return i.mapValues(_.ResourceTimingAttributes,(function(t,e){var i=n[e];return"number"==typeof i?Math.round(1e3*(i||0))/1e3:"serverTiming"===e?i||[]:void 0}))}catch(u){return}}(),A.getDurationsFor(i.values(_.RUMPerformanceTimingAttributes))),s.dispatch(m.SET_RUM_DATA,{data:t})}();var t=I.getRumData(),n=A.getMarks()||{};return t.extras=t.extras||{},t.extras.beacon={cjsTimeout:!0},t.userTimings=n,C(t=i.pickBy(t,(function(t){return!i.isUndefined(t)})))})().then(t,n)}),3e3)}))["catch"]((function(t){l.warn("RUM / Error sending data:",t)}))):v.resolve()}},4774:function(){}},__webpack_module_cache__={};function __webpack_require__(t){var n=__webpack_module_cache__[t];if(n!==undefined)return n.exports;var e=__webpack_module_cache__[t]={id:t,loaded:!1,exports:{}};return __webpack_modules__[t].call(e.exports,e,e.exports,__webpack_require__),e.loaded=!0,e.exports}__webpack_require__.amdO={},__webpack_require__.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),__webpack_require__.nmd=function(t){return t.paths=[],t.children||(t.children=[]),t};var __webpack_exports__={};!function(){try{!function(){var t=function(t){var n=[__webpack_require__(8835)];n.push(__webpack_require__(9871)),n.push(__webpack_require__(8949)),n.push(__webpack_require__(3299)),n.push(__webpack_require__(7383)),n.push(__webpack_require__(58)),n.push(__webpack_require__(9075)),n.push(__webpack_require__(3270)),n.push(__webpack_require__(3719)),n.push(__webpack_require__(3685)),n.push(__webpack_require__(406)),n.push(__webpack_require__(5307)),n.push(__webpack_require__(6475)),n.push(__webpack_require__(4767)),n.push(__webpack_require__(6224)),n.push(__webpack_require__(8128)),n.push(__webpack_require__(7244)),n.push(__webpack_require__(2935)),n.push(__webpack_require__(7099)),n.push(__webpack_require__(2225)),n.push(__webpack_require__(2418)),n.push(__webpack_require__(1652)),n.push(__webpack_require__(3108)),n.push(__webpack_require__(8101)),n.push(__webpack_require__(2971)),n.push(__webpack_require__(1572)),n.push(__webpack_require__(7312)),n.push(__webpack_require__(2757)),n.push(__webpack_require__(5954)),n.push(__webpack_require__(1958)),n.push(__webpack_require__(433)),n.push(__webpack_require__(4543)),n.push(__webpack_require__(8203)),n.push(__webpack_require__(5736)),f.initializePlugins(n)};window.performance&&window.performance.mark&&window.performance.mark("optimizely:blockBegin"),__webpack_require__(4892).initialize();var n=__webpack_require__(2899);n.time("gtagReady");var e=__webpack_require__(7936),i=__webpack_require__(9932);__webpack_require__(4979);var r=i.get("stores/directive");if(!__webpack_require__(9895).isCORSSupported())throw new Error("CORS is not supported on this browser, aborting.");var o,a=__webpack_require__(3139),u=__webpack_require__(7357),c=__webpack_require__(9787),s={"accountId": "752671897", "namespace": "a752671897", "revision": "83457", "anonymizeIP": false, "enableForceParameters": true, "experimental": {"trimPages": true}, "snippetId": "15126510756", "projectId": "15126510756", "layers": [{"changes": null, "id": "29620370050", "name": "Confirmation Total Text Change", "commitId": "29646250198", "groupId": null, "holdback": 0, "activation": {}, "integrationSettings": {"contentsquare": {}, "google_analytics_4": {}}, "integrationStringVersion": 2, "experiments": [{"audienceIds": null, "audienceName": "Everyone else", "changes": null, "id": "29623280086", "integrationSettings": null, "variations": [{"id": "29651290014", "name": "Original", "actions": [{"viewId": "11414832791", "changes": []}, {"viewId": "11408924095", "changes": []}, {"viewId": "9727881444", "changes": []}]}, {"id": "29600880101", "name": "Variation #1", "actions": [{"viewId": "11414832791", "changes": [{"id": "C445DBC1-7010-4E5F-A395-BED79DD1600B", "type": "custom_code", "value": function($){var $ = jQuery;
var utils = window.optimizely.get("utils");

utils.waitForElement('.ps-container>tbody>tr>td').then(function () {
	if($('.ps-container>tbody>tr>td:first').text() === 'Total Price:') {
    $('.ps-container>tbody>tr>td:first').text('Total:');
  }
});
}, "dependencies": []}]}, {"viewId": "11408924095", "changes": [{"id": "714C9495-4E43-4C13-911C-255C035BA4D5", "type": "custom_code", "value": function($){var $ = jQuery;
var utils = window.optimizely.get("utils");

utils.waitForElement('.ch-row .ch-amount-label').then(function () {
	if($('.ch-row .ch-amount-label:first').text() === 'Total Price:') {
    console.log($('.ch-row .ch-amount-label:first').text('Total:'));
  }
});
}, "dependencies": []}]}, {"viewId": "9727881444", "changes": []}]}], "weightDistributions": [{"entityId": "29600880101", "endOfRange": 10000}], "name": "Confirmation Total Text Change", "bucketingStrategy": null, "experimentMetadata": {"allocationPolicy": "manual", "layerId": "29620370050"}}], "policy": "single_experiment", "viewIds": ["11408924095", "11414832791", "9727881444"], "weightDistributions": null, "decisionMetadata": null}, {"changes": null, "id": "17769090697", "name": "Personalization | Footer - LPG Filter", "commitId": "17775820654", "groupId": null, "holdback": 0, "activation": {}, "integrationSettings": {}, "integrationStringVersion": 2, "experiments": [{"audienceIds": ["and", "17778270566"], "audienceName": "Tablet", "changes": null, "id": "17764350759", "integrationSettings": null, "variations": [{"id": "17778160573", "name": "48 hour fencing", "actions": [{"viewId": "9431051150", "changes": [{"dependencies": [], "type": "custom_code", "id": "257C1370-5F25-4035-B27D-4F53872E851E", "value": function($){var $ = window.jQuery;
var utils = window.optimizely.get('utils');
var yesURL = 'https://www.carnival.com/request-forms/lowest-price-guarantee.aspx?icid=cc_footer_popup_lpg_3112020';
var noURL = "https://www.carnival.com/core/requestforms/priceprotection.aspx?icid=cc_footer_popup_espp_3112020";
var handleTouchMove = function(e){
  e.preventDefault();
};
var jQueryUIScriptElement = document.createElement('script');
jQueryUIScriptElement.src = 'https://code.jquery.com/ui/1.12.1/jquery-ui.min.js';
var jQueryUIThemeLinkElement = document.createElement('link');
jQueryUIThemeLinkElement.href = 'https://code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css';
jQueryUIThemeLinkElement.rel = 'stylesheet';
document.head.appendChild(jQueryUIScriptElement);
document.head.appendChild(jQueryUIThemeLinkElement);
var currentDate = new Date((new Date()).toDateString());
var bookingDate;
var clearHighlightedDayID;

utils.waitForElement('#ccl-refresh-footer .link-lists a[href="/content/lowest-price-guarantee.aspx?icid=cc_footer_lpg_02212018"]').then(function() {
  //console.log('$lpg filter testing');
  if ( $('.lpg-background').length === 0 ) {
    $('body').append($('<div class="lpg-background"></div>'));
  
    var lpgModal = $('<div class="lpg-modal"></div>');
  
    lpgModal.append([
      $('<div></div>'),
      $('<h3 class="lpg-header">When did you make your reservation?</h3>'),
      $('<div class="date-selector-lpg-redirect"></div>'),
      $('<button class="lpg-submit">Submit</button>'),
      $('<span class="lpg-modal-close" tabindex="0"></span>')
    ]);
  
    $('body').prepend(lpgModal);
    //console.log('$pre jquery shit');
    var setupDatePickerIntervalID = setInterval(function(){
    	if(typeof $('.date-selector-lpg-redirect').datepicker == 'function'){
      	$('.date-selector-lpg-redirect').datepicker({
        	maxDate: 0
        });
        clearHighlightedDayID = setInterval(function(){
        	$('.ui-state-highlight').removeClass('ui-state-highlight');
        }, 100);
        clearInterval(setupDatePickerIntervalID);
      }
    }, 333);
    
    //console.log('$post jquery shit');
  
    $('.lpg-submit').click(function() {
      bookingDate = new Date(jQuery('.date-selector-lpg-redirect').datepicker('getDate'));
      // console.log('$booking date: ', bookingDate);
      // console.log('$current date: ', currentDate);
      // console.log('$less than 48hrs', (currentDate.getTime() - bookingDate.getTime() <= 172800000));
      //if less than 2 days (rounded to midnight)
      if((currentDate.getTime() - bookingDate.getTime()) <= 172800000){
      	window.location.href = yesURL;
      } else {
      	window.location.href = noURL;
      }

    });
  
    $('.lpg-background').height($(document).height());
    //console.log('$lpg filter testing event listener touchmove');
  
    $('.lpg-background').on('click', function(){
      document.removeEventListener('touchmove', handleTouchMove, { passive: false });
      $('.lpg-background').hide();
      $('.lpg-modal').hide();
      $('html').css({
        'overflow': 'auto'
      });
      $('body').css({
        'overflow': 'auto'
      });
      clearInterval(clearHighlightedDayID);
    });  
  
    //console.log('$lpg filter testing event listener bg click');
  
    
    $('.lpg-modal-close').on('click', function(){
      document.removeEventListener('touchmove', handleTouchMove, { passive: false });
      $('.lpg-background').hide();
      $('.lpg-modal').hide();
      $('html').css({
        'overflow': 'unset'
      });
      $('body').css({
        'overflow': 'unset'
      });
      clearInterval(clearHighlightedDayID);
    });
  
    //console.log('$lpg filter testing event listener close click');
  
    
    $('.lpg-modal-close').on('keypress', function(e){
      if(e.keyCode == 13){ // keyCode 13 should be 'enter' button
        document.removeEventListener('touchmove', handleTouchMove, { passive: false });
        $('.lpg-background').hide();
        $('.lpg-modal').hide();
        $('html').css({
          'overflow': 'unset'
        });
        $('body').css({
          'overflow': 'unset'
        });
        clearInterval(clearHighlightedDayID);
      }
    });
  
    //console.log('$lpg filter testing event listener tab close');
  
    $('#ccl-refresh-footer .link-lists a[href="/content/lowest-price-guarantee.aspx?icid=cc_footer_lpg_02212018"]').addClass('lpg-trigger');
  
    $('#ccl-refresh-footer .link-lists .lpg-trigger').click(function(e) {
      document.addEventListener('touchmove', handleTouchMove, { passive: false });
      e.preventDefault();
      e.stopPropagation();
      //console.log('$lpg click triggered');
      $('.lpg-modal').css('display', 'flex');
      $('.lpg-background').show();
      $('html').css({
        'overflow': 'hidden'
      });
      $('body').css({
        'overflow': 'hidden'
      });
  
    });
  }
});
}}, {"value": "<style>body {\n  position: relative;\n}\n\n.lpg-background {\n  opacity: 0.5;\n  height: 100vh;\n  width: 100vw;\n  z-index: 10000;\n  background-color: black;\n  position: fixed;\n  bottom: 0;\n  display: none;\n}\n\n.lpg-modal {\n  position: fixed;\n  width: 600px;\n  bottom: 5vh;\n  left: 5vw;\n  background-color: white;\n  display: none;\n  flex-direction: column;\n  z-index: 100000;\n  text-align: center;\n  font-family: tempo;\n  padding: 30px;\n}\n\n.lpg-header {\n  font-size: 23px;\n  color: #10559a;\n  font-family: \"Open Sans\";\n  margin-top: 15px;\n  letter-spacing: 1.2px;\n  font-weight: 600;\n}\n\n/* .ui-datepicker .ui-datepicker-header {\n  background-color: #10559a;\n  color: white;\n} */\n\n.date-selector-lpg-redirect {\n  /* width: 300px; */\n  font-size: 23px;\n  margin: 30px auto;\n}\n\n.lpg-submit {\n  background-color: #10559a;\n  color: white;\n  padding: 10px 30px;\n  max-width: 120px;\n  display: inline-block;\n  margin: auto;\n  border-radius: 4px;\n  text-transform: uppercase;\n  font-family: Tempo;\n  font-size: 16px;\n  letter-spacing: 1.5px;\n}\n\n.lpg-modal .lpg-modal-button {\n  text-transform: uppercase;\n  background-color: #c03;\n  color: white;\n  padding: 10px 20px;\n  margin-bottom: 30px;\n  align-self: center;\n  font-size: 14px;\n}\n\n.lpg-modal .lpg-modal-button:hover {\n  background-color: red;\n}\n\n.lpg-modal .lpg-modal-terms {\n  font-family: sans-serif;\n  font-weight: normal;\n  font-size: 10px;\n  margin-bottom: 10px;\n}\n\n.lpg-modal .lpg-modal-terms::before {\n  content: '\\002A';\n  font-family: sans-serif;\n  font-weight: normal;\n}\n\n.lpg-modal .lpg-modal-close {\n  position: absolute;\n  top: 0;\n  right: 0;\n  transform: translateX(-50%) translateY(50%);\n  height: 25px;\n  width: 25px;\n  background-image: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAoCAMAAAC7IEhfAAAANlBMVEUAAABkZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRNYWPcAAAAEnRSTlMAbgVGIGRfQyo5Mw9UFghYSzD6loocAAABTElEQVQ4y52V6w7CIAyFoVzdgOH7v6xc7A7MLSH2h9Hype0ppYrZdq8OI6U5lN/Fo9Fm5WB2owdM/tgdqk09McrHRJSiV/23vnKv6g6TW4fqe81crjUxBrTWnEePKg5FN3W3gynvnOLhSN9zIPU3vkF42FiW6VVtRQfdEF8fFUVb+4LY+3hvTjpURj1g4CMp49AwJkMPaTlgCQ0ytx/EIW1JV2rlZCCLAkQURe0uPCRH2WxnLg/CfftAQzvZucDuHuyAACbNySHVUfMnMZNXTqSqg7VB0MxxPwBOpKUfEKnBgURqiJm4Wv1FDNqDvCDRHjQcHDkm4ffnFaKLqZycynGFGArhmMNdYyiGMSO+aZCEMcPgtoi2cCAdBnd+CqQJUt/5jaew+rjS8nNdXwB4Sc8rJa8uqb/WHhap87FITNE7LNKV1Zz+WParfx8fuW4Jz0HmY4YAAAAASUVORK5CYII=);\n  background-position: center;\n  background-size: cover;\n}\n\n\n@media (min-width: 374px) and (orientation: portrait) {\n  .lpg-modal{\n    width: 80vw;\n    bottom: 10vh;\n    left: 10vw;\n  }\n}\n\n@media (min-width: 600px) and (orientation: portrait) {\n  .lpg-modal{\n    width: 50vw;\n    bottom: 35vh;\n    left: 25vw;\n  } \n}\n\n@media (min-width: 600px) and (orientation: landscape) {\n  .lpg-modal{\n    width: 40vw;\n    bottom: 30vh;\n    left: 30vw;\n  } \n\n  .date-selector-lpg-redirect {\n    /* width: 300px; */\n    font-size: 20px;\n  }\n}\n\n/* @media (min-width: 1025px){\n\t.lpg-modal{\n    width: 40vw;\n    left: 35vw;\n  }\n} */</style>", "selector": "head", "dependencies": [], "type": "append", "id": "7000474F-8872-4F7A-820F-F143558C03FB"}]}]}], "weightDistributions": null, "name": "LPG Filter: Booked w/in 48hrs [Tablet]", "bucketingStrategy": null, "experimentMetadata": {"allocationPolicy": "manual", "layerId": "17769090697"}}, {"audienceIds": ["and", "10261134200", "13231000241"], "audienceName": "All | Exclude Synthetic Script \"KTNX\",Desktop Only", "changes": null, "id": "17775230806", "integrationSettings": null, "variations": [{"id": "17738792241", "name": "48 hour fencing", "actions": [{"viewId": "9431051150", "changes": [{"dependencies": [], "type": "custom_code", "id": "656A1844-FEB5-46BD-9FC8-11C649F5C160", "value": function($){var $ = window.jQuery;
var utils = window.optimizely.get('utils');
var yesURL = 'https://www.carnival.com/request-forms/lowest-price-guarantee.aspx?icid=cc_footer_popup_lpg_3112020';
var noURL = "https://www.carnival.com/core/requestforms/priceprotection.aspx?icid=cc_footer_popup_espp_3112020";
var handleTouchMove = function(e){
  e.preventDefault();
};
var jQueryUIScriptElement = document.createElement('script');
jQueryUIScriptElement.src = 'https://code.jquery.com/ui/1.12.1/jquery-ui.min.js';
var jQueryUIThemeLinkElement = document.createElement('link');
jQueryUIThemeLinkElement.href = 'https://code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css';
jQueryUIThemeLinkElement.rel = 'stylesheet';
document.head.appendChild(jQueryUIScriptElement);
document.head.appendChild(jQueryUIThemeLinkElement);
var currentDate = new Date((new Date()).toDateString());
var bookingDate;
var clearHighlightedDayID;

utils.waitForElement('#ccl-refresh-footer .link-lists a[href="/content/lowest-price-guarantee.aspx?icid=cc_footer_lpg_02212018"]').then(function() {
  //console.log('$lpg filter testing');
  if ( $('.lpg-background').length === 0 ) {
    $('body').append($('<div class="lpg-background"></div>'));
  
    var lpgModal = $('<div class="lpg-modal"></div>');
  
    lpgModal.append([
      $('<div></div>'),
      $('<h3 class="lpg-header">When did you make your reservation?</h3>'),
      $('<div class="date-selector-lpg-redirect"></div>'),
      $('<button class="lpg-submit">Submit</button>'),
      $('<span class="lpg-modal-close" tabindex="0"></span>')
    ]);
  
    $('body').prepend(lpgModal);
    //console.log('$pre jquery shit');
    var setupDatePickerIntervalID = setInterval(function(){
    	if(typeof $('.date-selector-lpg-redirect').datepicker == 'function'){
      	$('.date-selector-lpg-redirect').datepicker({
        	maxDate: 0
        });
        clearHighlightedDayID = setInterval(function(){
        	$('.ui-state-highlight').removeClass('ui-state-highlight');
        }, 100);
        clearInterval(setupDatePickerIntervalID);
      }
    }, 333);
    
    //console.log('$post jquery shit');
  
    $('.lpg-submit').click(function() {
      bookingDate = new Date(jQuery('.date-selector-lpg-redirect').datepicker('getDate'));
      // console.log('$booking date: ', bookingDate);
      // console.log('$current date: ', currentDate);
      // console.log('$less than 48hrs', (currentDate.getTime() - bookingDate.getTime() <= 172800000));
      //if less than 2 days (rounded to midnight)
      if((currentDate.getTime() - bookingDate.getTime()) <= 172800000){
      	window.location.href = yesURL;
      } else {
      	window.location.href = noURL;
      }

    });
  
    $('.lpg-background').height($(document).height());
    //console.log('$lpg filter testing event listener touchmove');
  
    $('.lpg-background').on('click', function(){
      document.removeEventListener('touchmove', handleTouchMove, { passive: false });
      $('.lpg-background').hide();
      $('.lpg-modal').hide();
      $('html').css({
        'overflow': 'auto'
      });
      $('body').css({
        'overflow': 'auto'
      });
      clearInterval(clearHighlightedDayID);
    });  
  
    //console.log('$lpg filter testing event listener bg click');
  
    
    $('.lpg-modal-close').on('click', function(){
      document.removeEventListener('touchmove', handleTouchMove, { passive: false });
      $('.lpg-background').hide();
      $('.lpg-modal').hide();
      $('html').css({
        'overflow': 'unset'
      });
      $('body').css({
        'overflow': 'unset'
      });
      clearInterval(clearHighlightedDayID);
    });
  
    //console.log('$lpg filter testing event listener close click');
  
    
    $('.lpg-modal-close').on('keypress', function(e){
      if(e.keyCode == 13){ // keyCode 13 should be 'enter' button
        document.removeEventListener('touchmove', handleTouchMove, { passive: false });
        $('.lpg-background').hide();
        $('.lpg-modal').hide();
        $('html').css({
          'overflow': 'unset'
        });
        $('body').css({
          'overflow': 'unset'
        });
        clearInterval(clearHighlightedDayID);
      }
    });
  
    //console.log('$lpg filter testing event listener tab close');
  
    $('#ccl-refresh-footer .link-lists a[href="/content/lowest-price-guarantee.aspx?icid=cc_footer_lpg_02212018"]').addClass('lpg-trigger');
  
    $('#ccl-refresh-footer .link-lists .lpg-trigger').click(function(e) {
      document.addEventListener('touchmove', handleTouchMove, { passive: false });
      e.preventDefault();
      e.stopPropagation();
      //console.log('$lpg click triggered');
      $('.lpg-modal').css('display', 'flex');
      $('.lpg-background').show();
      $('html').css({
        'overflow': 'hidden'
      });
      $('body').css({
        'overflow': 'hidden'
      });
  
    });
  }
});
}}, {"value": "<style>body {\n  position: relative;\n}\n\n.lpg-background {\n  opacity: 0.5;\n  height: 100vh;\n  width: 100vw;\n  z-index: 10000;\n  background-color: black;\n  position: absolute;\n  bottom: 0;\n  display: none;\n}\n\n.lpg-modal {\n  position: fixed;\n  width: 600px;\n  bottom: 5vh;\n  left: 5vw;\n  background-color: white;\n  display: none;\n  flex-direction: column;\n  z-index: 100000;\n  text-align: center;\n  font-family: tempo;\n  padding: 30px;\n}\n\n.lpg-header {\n  font-size: 20px;\n  color: #10559a;\n  font-family: \"Open Sans\";\n  margin-top: 15px;\n  letter-spacing: 1.2px;\n  font-weight: 600;\n}\n\n/* .ui-datepicker .ui-datepicker-header {\n  background-color: #10559a;\n  color: white;\n} */\n\n.date-selector-lpg-redirect {\n  width: 300px;\n  font-size: 17px;\n  margin: 15px auto;\n}\n\n.lpg-submit {\n  background-color: #10559a;\n  color: white;\n  padding: 10px 30px;\n  max-width: 120px;\n  display: inline-block;\n  margin: auto;\n  border-radius: 4px;\n  text-transform: uppercase;\n  font-family: Tempo;\n  font-size: 16px;\n  letter-spacing: 1.5px;\n}\n\n.lpg-modal .lpg-modal-button {\n  text-transform: uppercase;\n  background-color: #c03;\n  color: white;\n  padding: 10px 20px;\n  margin-bottom: 30px;\n  align-self: center;\n  font-size: 14px;\n}\n\n.lpg-modal .lpg-modal-button:hover {\n  background-color: red;\n}\n\n.lpg-modal .lpg-modal-terms {\n  font-family: sans-serif;\n  font-weight: normal;\n  font-size: 10px;\n  margin-bottom: 10px;\n}\n\n.lpg-modal .lpg-modal-terms::before {\n  content: '\\002A';\n  font-family: sans-serif;\n  font-weight: normal;\n}\n\n.lpg-modal .lpg-modal-close {\n  position: absolute;\n  top: 0;\n  right: 0;\n  transform: translateX(-50%) translateY(50%);\n  height: 25px;\n  width: 25px;\n  background-image: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAoCAMAAAC7IEhfAAAANlBMVEUAAABkZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRNYWPcAAAAEnRSTlMAbgVGIGRfQyo5Mw9UFghYSzD6loocAAABTElEQVQ4y52V6w7CIAyFoVzdgOH7v6xc7A7MLSH2h9Hype0ppYrZdq8OI6U5lN/Fo9Fm5WB2owdM/tgdqk09McrHRJSiV/23vnKv6g6TW4fqe81crjUxBrTWnEePKg5FN3W3gynvnOLhSN9zIPU3vkF42FiW6VVtRQfdEF8fFUVb+4LY+3hvTjpURj1g4CMp49AwJkMPaTlgCQ0ytx/EIW1JV2rlZCCLAkQURe0uPCRH2WxnLg/CfftAQzvZucDuHuyAACbNySHVUfMnMZNXTqSqg7VB0MxxPwBOpKUfEKnBgURqiJm4Wv1FDNqDvCDRHjQcHDkm4ffnFaKLqZycynGFGArhmMNdYyiGMSO+aZCEMcPgtoi2cCAdBnd+CqQJUt/5jaew+rjS8nNdXwB4Sc8rJa8uqb/WHhap87FITNE7LNKV1Zz+WParfx8fuW4Jz0HmY4YAAAAASUVORK5CYII=);\n  background-position: center;\n  background-size: cover;\n}\n\n\n@media (min-width: 374px) {\n  .lpg-modal{\n    width: 80vw;\n    bottom: 10vh;\n    left: 10vw;\n  }\n}\n\n@media (min-width: 600px){\n  .lpg-modal{\n    width: 40vw;\n    bottom: 20vh;\n    left: 30vw;\n  } \n}\n\n@media (min-width: 1025px){\n\t.lpg-modal{\n    width: 30vw;\n    left: 35vw;\n  }\n}</style>", "selector": "head", "dependencies": [], "type": "append", "id": "8FCC4377-6CC4-426F-AE80-E0894F044A65"}]}]}], "weightDistributions": null, "name": "LPG Filter: Booked w/in 48hrs [Desktop]", "bucketingStrategy": null, "experimentMetadata": {"allocationPolicy": "manual", "layerId": "17769090697"}}], "policy": "equal_priority", "viewIds": ["9431051150"], "weightDistributions": null, "decisionMetadata": {"experimentPriorities": [[{"entityId": "17775230806", "endOfRange": null}], [{"entityId": "17764350759", "endOfRange": null}]], "experimentWeights": null, "offerConsistency": null}}, {"changes": null, "id": "26633140107", "name": "Test - Global Navigation ", "commitId": "29472560008", "groupId": null, "holdback": 0, "activation": {}, "integrationSettings": {"contentsquare": {}, "google_analytics_4": {"is_using_gtm": "on"}, "google_universal_analytics": {"universal_analytics_slot": "133", "universal_analytics_tracker": "t55"}}, "integrationStringVersion": 2, "experiments": [{"audienceIds": ["and", "10261134200", "20140060743"], "audienceName": "All | Exclude Synthetic Script \"KTNX\",Roy's Backup Cookie", "changes": null, "id": "26601400259", "integrationSettings": null, "variations": [{"id": "26570780312", "name": "Original", "actions": [{"viewId": "9431051150", "changes": []}]}, {"id": "26630750009", "name": "Variation #1", "actions": [{"viewId": "9431051150", "changes": [{"id": "99AAF0A1-7DB2-42FA-A716-361922F5D0C5", "type": "custom_code", "value": function($){var $ = jQuery;
var utils = window.optimizely.get("utils");
 
function globalNavOldHeader () {
    var singleQuote = "'";
    if($(window).width() < 1200) {
        if($('.globalNavBurgeMenu').length <1) {
            setTimeout(function () {
                if ($('.cgh-avatar__icon--authenticated').length > 0) {
                var userName = $('[data-testid="user-name"]:eq(0)').text();
                $('.cgh-header__secondary-menu-left').append('<div class="loginNotificationContainerMobile"><a class="navLoginContainerMobile" tabindex="0" role="button" aria-expanded="false" aria-label="Ahoy, '+userName+' Profile menu"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 32 32" fill="none" aria-hidden="true"><path d="M15.333 8.59949C12.6752 8.59949 10.5205 10.6865 10.5205 13.2607C10.5205 15.835 12.6752 17.922 15.333 17.922C17.9908 17.922 20.1455 15.835 20.1455 13.2607C20.1455 10.6865 17.9908 8.59949 15.333 8.59949ZM15.333 15.3795C14.1266 15.3795 13.1455 14.4287 13.1455 13.2607C13.1455 12.0901 14.1244 11.142 15.333 11.142C16.5416 11.142 17.5205 12.0923 17.5205 13.2607C17.5205 14.4314 16.5416 15.3795 15.333 15.3795ZM15.333 2.66699C7.6002 2.66699 1.33301 8.73721 1.33301 16.227C1.33301 23.7168 7.6002 29.787 15.333 29.787C23.0658 29.787 29.333 23.7168 29.333 16.227C29.333 8.73721 23.0658 2.66699 15.333 2.66699ZM15.333 27.2445C12.7775 27.2445 10.4243 26.4139 8.52441 25.0309C9.47051 23.2718 11.308 22.1595 13.3752 22.1595H17.2957C19.3602 22.1595 21.1955 23.2724 22.1454 25.0309C20.2439 26.4129 17.8869 27.2445 15.333 27.2445ZM24.0939 23.2454C22.6174 21.0101 20.1018 19.617 17.2908 19.617H13.3752C10.5664 19.617 8.05137 21.0074 6.57207 23.2443C4.9402 21.3385 3.95801 18.8913 3.95801 16.227C3.95801 10.1515 9.0609 5.20949 15.333 5.20949C21.6051 5.20949 26.708 10.152 26.708 16.227C26.708 18.8913 25.7236 21.3385 24.0939 23.2454Z" fill="white"/></svg></div>');
                $('.loginNotificationContainerMobile').append('<a class="loggedInNotificationCenter" tabindex="0" role="button" aria-expanded="false" aria-label="Notification Menu"><svg xmlns="http://www.w3.org/2000/svg" width="21" height="20" viewBox="0 0 21 20" fill="none" aria-hidden="true"><path fill-rule="evenodd" clip-rule="evenodd" d="M10.1881 0C14.3567 0 17.7633 3.40659 17.7633 7.57522V10.585C19.288 10.86 20.4513 12.1994 20.4513 13.8011V14.4981C20.4513 16.2976 18.983 17.766 17.1835 17.766L12.3267 17.7658C12.338 17.8511 12.3438 17.9381 12.3438 18.0265C12.3438 19.1168 11.4605 20 10.3703 20C9.28 20 8.39577 19.1168 8.39577 18.0265C8.39577 17.9381 8.40158 17.8511 8.41284 17.7658L3.26784 17.766C1.46834 17.766 0 16.2976 0 14.4981V13.8011C0 12.2888 1.03704 11.0104 2.43616 10.6408L2.61289 10.5994V7.57522C2.61289 3.40659 6.01948 0 10.1881 0ZM10.1881 1.974C7.10969 1.974 4.58688 4.4968 4.58688 7.57522V12.5072H3.26784C2.55855 12.5072 1.974 13.0918 1.974 13.8011V14.4981C1.974 15.2074 2.55855 15.792 3.26784 15.792H17.1835C17.8928 15.792 18.4773 15.2074 18.4773 14.4981V13.8011C18.4773 13.0918 17.8928 12.5072 17.1835 12.5072H15.7893V7.57522C15.7893 4.4968 13.2665 1.974 10.1881 1.974Z" fill="white"/></svg></a>');
                $('.loginNotificationContainerMobile').append('<div class="profileManagementModalContainer"><span tabindex="0"><svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 32 32" fill="none"><path d="M15.333 8.59852C12.6752 8.59852 10.5205 10.6855 10.5205 13.2598C10.5205 15.834 12.6752 17.921 15.333 17.921C17.9908 17.921 20.1455 15.834 20.1455 13.2598C20.1455 10.6855 17.9908 8.59852 15.333 8.59852ZM15.333 15.3785C14.1266 15.3785 13.1455 14.4277 13.1455 13.2598C13.1455 12.0892 14.1244 11.141 15.333 11.141C16.5416 11.141 17.5205 12.0913 17.5205 13.2598C17.5205 14.4304 16.5416 15.3785 15.333 15.3785ZM15.333 2.66602C7.6002 2.66602 1.33301 8.73623 1.33301 16.226C1.33301 23.7158 7.6002 29.786 15.333 29.786C23.0658 29.786 29.333 23.7158 29.333 16.226C29.333 8.73623 23.0658 2.66602 15.333 2.66602ZM15.333 27.2435C12.7775 27.2435 10.4243 26.413 8.52441 25.03C9.47051 23.2709 11.308 22.1585 13.3752 22.1585H17.2957C19.3602 22.1585 21.1955 23.2714 22.1454 25.03C20.2439 26.4119 17.8869 27.2435 15.333 27.2435ZM24.0939 23.2444C22.6174 21.0091 20.1018 19.616 17.2908 19.616H13.3752C10.5664 19.616 8.05137 21.0064 6.57207 23.2433C4.9402 21.3375 3.95801 18.8903 3.95801 16.226C3.95801 10.1505 9.0609 5.20852 15.333 5.20852C21.6051 5.20852 26.708 10.151 26.708 16.226C26.708 18.8903 25.7236 21.3375 24.0939 23.2444Z" fill="white"/></svg>AHOY, '+userName+' <a class ="profileManagementCloseModal" tabindex="0" role="button" aria-label="Close Profile Menu"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" fill="none" aria-hidden="true"><path d="M10.3798 8L15.7659 2.61408C16.0774 2.30259 16.0774 1.7971 15.7659 1.4851L14.5144 0.233621C14.2028 -0.0778738 13.6973 -0.0778738 13.3853 0.233621L7.99975 5.62004L2.61367 0.234121C2.30216 -0.0773737 1.79665 -0.0773737 1.48465 0.234121L0.233629 1.4851C-0.0778762 1.7966 -0.0778762 2.30209 0.233629 2.61408L5.61971 8L0.233629 13.3859C-0.0778762 13.6974 -0.0778762 14.2029 0.233629 14.5149L1.48515 15.7664C1.79665 16.0779 2.30216 16.0779 2.61417 15.7664L7.99975 10.38L13.3858 15.7659C13.6973 16.0774 14.2028 16.0774 14.5149 15.7659L15.7664 14.5144C16.0779 14.2029 16.0779 13.6974 15.7664 13.3854L10.3798 8Z" fill="white"/></svg></a></span></div>');
                $('.profileManagementModalContainer').append('<div></div><a href="/profilemanagement/profiles">My Profile</a><a href="/profilemanagement/profiles/benefits">My Benefits</a><a href="/profilemanagement/profiles/cruises">My Bookings</a><a href="/cruise-deals">My Offers</a><a href="/saved">Favorites</a><a class="logOutModal" href="/profilemanagement/accounts/logout" role="button">LOG OUT</a><p><a href="/help">FAQs</a><a class="navPostCruise" href="/post-cruise-inquiries">Post-Cruise Inquiries</a></p>');
    
                var messagesCount = [];
    
                // message count
                $.ajax({
                    url: 'https://www.carnival.com/shop/webinbox/messagecount', // Replace with your API endpoint
                    type: 'GET', // or 'POST', 'PUT', etc.
                    async: true,
                    dataType: 'json', // Expected data type from the server
                    success: function (response) {
                        messagesCount = response;
                        $('.loginNotificationContainerMobile').append('<div class="profileBellModal"><span class="navBellProfileContainer" tabindex="0"><svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 28 28" fill="none" aria-hidden="true"><path fill-rule="evenodd" clip-rule="evenodd" d="M14.2511 0.666016C19.8093 0.666016 24.3514 5.20814 24.3514 10.7663V14.7793C26.3843 15.146 27.9354 16.9318 27.9354 19.0675V19.9968C27.9354 22.3962 25.9776 24.354 23.5783 24.354L17.1026 24.3537C17.1176 24.4675 17.1253 24.5835 17.1253 24.7013C17.1253 26.155 15.9477 27.3327 14.494 27.3327C13.0403 27.3327 11.8614 26.155 11.8614 24.7013C11.8614 24.5835 11.8691 24.4675 11.8841 24.3537L5.02411 24.354C2.62478 24.354 0.666992 22.3962 0.666992 19.9968V19.0675C0.666992 17.0511 2.04972 15.3465 3.91521 14.8538L4.15084 14.7986V10.7663C4.15084 5.20814 8.69297 0.666016 14.2511 0.666016ZM14.2511 3.29801C10.1466 3.29801 6.78284 6.66175 6.78284 10.7663V17.3423H5.02411C4.07839 17.3423 3.29899 18.1217 3.29899 19.0675V19.9968C3.29899 20.9426 4.07839 21.722 5.02411 21.722H23.5783C24.524 21.722 25.3034 20.9426 25.3034 19.9968V19.0675C25.3034 18.1217 24.524 17.3423 23.5783 17.3423H21.7194V10.7663C21.7194 6.66175 18.3557 3.29801 14.2511 3.29801Z" fill="white"/></svg> Notifications ('+messagesCount.unread+') <a class="profileBellCloseContainer" tabindex="0" role="button" aria-label="Close Notification Menu"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" fill="none" aria-hidden="true"><path d="M10.3798 8L15.7659 2.61408C16.0774 2.30259 16.0774 1.7971 15.7659 1.4851L14.5144 0.233621C14.2028 -0.0778738 13.6973 -0.0778738 13.3853 0.233621L7.99975 5.62004L2.61367 0.234121C2.30216 -0.0773737 1.79665 -0.0773737 1.48465 0.234121L0.233629 1.4851C-0.0778762 1.7966 -0.0778762 2.30209 0.233629 2.61408L5.61971 8L0.233629 13.3859C-0.0778762 13.6974 -0.0778762 14.2029 0.233629 14.5149L1.48515 15.7664C1.79665 16.0779 2.30216 16.0779 2.61417 15.7664L7.99975 10.38L13.3858 15.7659C13.6973 16.0774 14.2028 16.0774 14.5149 15.7659L15.7664 14.5144C16.0779 14.2029 16.0779 13.6974 15.7664 13.3854L10.3798 8Z" fill="white"/></svg></a></span></div>');
                        $('.profileBellModal').append('<div></div><p class="profileBellMessageCount">You have '+messagesCount.unread+' messages in your inbox.</p><p>Tap here to read them.</p><a href="/inbox">View all notifications</a>');

                        utils.waitForElement('.loggedInNotificationCenter').then(function () {

                            if(messagesCount.unread === 1) {
                                $('.loggedInNotificationCenter').html('<svg xmlns="http://www.w3.org/2000/svg" width="34" height="28" viewBox="0 0 34 28" fill="none" aria-hidden="true"><path fill-rule="evenodd" clip-rule="evenodd" d="M12.1881 5.9999C16.3567 5.9999 19.7633 9.40649 19.7633 13.5751V16.5849C21.288 16.8599 22.4513 18.1993 22.4513 19.801V20.498C22.4513 22.2975 20.983 23.7659 19.1835 23.7659L14.3267 23.7657C14.338 23.851 14.3438 23.938 14.3438 24.0264C14.3438 25.1167 13.4605 25.9999 12.3703 25.9999C11.28 25.9999 10.3958 25.1167 10.3958 24.0264C10.3958 23.938 10.4016 23.851 10.4128 23.7657L5.26784 23.7659C3.46834 23.7659 2 22.2975 2 20.498V19.801C2 18.2887 3.03704 17.0103 4.43616 16.6407L4.61289 16.5993V13.5751C4.61289 9.40649 8.01948 5.9999 12.1881 5.9999ZM12.1881 7.9739C9.10969 7.9739 6.58688 10.4967 6.58688 13.5751V18.5071H5.26784C4.55855 18.5071 3.974 19.0917 3.974 19.801V20.498C3.974 21.2073 4.55855 21.7919 5.26784 21.7919H19.1835C19.8928 21.7919 20.4773 21.2073 20.4773 20.498V19.801C20.4773 19.0917 19.8928 18.5071 19.1835 18.5071H17.7893V13.5751C17.7893 10.4967 15.2665 7.9739 12.1881 7.9739Z" fill="white"/><path d="M10.0001 9C10.0001 4.02944 14.0295 0 19.0001 0H25.0001C29.9707 0 34.0001 4.02944 34.0001 9C34.0001 13.9706 29.9707 18 25.0001 18H19.0001C14.0295 18 10.0001 13.9706 10.0001 9Z" fill="#DC1125"/><path d="M24.0235 13H22.213V8.04297C22.213 7.90625 22.2149 7.73828 22.2188 7.53906C22.2228 7.33594 22.2286 7.12891 22.2364 6.91797C22.2442 6.70312 22.2521 6.50977 22.2599 6.33789C22.2169 6.38867 22.129 6.47656 21.9962 6.60156C21.8673 6.72266 21.7462 6.83203 21.6329 6.92969L20.6485 7.7207L19.7755 6.63086L22.5353 4.43359H24.0235V13Z" fill="white"/></svg>')
                            } else if (messagesCount.unread === 2) {
                                $('.loggedInNotificationCenter').html('<svg xmlns="http://www.w3.org/2000/svg" width="34" height="28" viewBox="0 0 34 28" fill="none" aria-hidden="true"><path fill-rule="evenodd" clip-rule="evenodd" d="M12.1881 5.9999C16.3567 5.9999 19.7633 9.40649 19.7633 13.5751V16.5849C21.288 16.8599 22.4513 18.1993 22.4513 19.801V20.498C22.4513 22.2975 20.983 23.7659 19.1835 23.7659L14.3267 23.7657C14.338 23.851 14.3438 23.938 14.3438 24.0264C14.3438 25.1167 13.4605 25.9999 12.3703 25.9999C11.28 25.9999 10.3958 25.1167 10.3958 24.0264C10.3958 23.938 10.4016 23.851 10.4128 23.7657L5.26784 23.7659C3.46834 23.7659 2 22.2975 2 20.498V19.801C2 18.2887 3.03704 17.0103 4.43616 16.6407L4.61289 16.5993V13.5751C4.61289 9.40649 8.01948 5.9999 12.1881 5.9999ZM12.1881 7.9739C9.10969 7.9739 6.58688 10.4967 6.58688 13.5751V18.5071H5.26784C4.55855 18.5071 3.974 19.0917 3.974 19.801V20.498C3.974 21.2073 4.55855 21.7919 5.26784 21.7919H19.1835C19.8928 21.7919 20.4773 21.2073 20.4773 20.498V19.801C20.4773 19.0917 19.8928 18.5071 19.1835 18.5071H17.7893V13.5751C17.7893 10.4967 15.2665 7.9739 12.1881 7.9739Z" fill="white"/><path d="M10.0001 9C10.0001 4.02944 14.0295 0 19.0001 0H25.0001C29.9707 0 34.0001 4.02944 34.0001 9C34.0001 13.9706 29.9707 18 25.0001 18H19.0001C14.0295 18 10.0001 13.9706 10.0001 9Z" fill="#DC1125"/><path d="M25.5353 13H19.547V11.7402L21.6974 9.56641C22.131 9.12109 22.4786 8.75 22.7403 8.45312C23.006 8.15234 23.1974 7.87891 23.3146 7.63281C23.4356 7.38672 23.4962 7.12305 23.4962 6.8418C23.4962 6.50195 23.4005 6.24805 23.2091 6.08008C23.0216 5.9082 22.7696 5.82227 22.4532 5.82227C22.1212 5.82227 21.7989 5.89844 21.4864 6.05078C21.1739 6.20312 20.8478 6.41992 20.5079 6.70117L19.5235 5.53516C19.7696 5.32422 20.0294 5.125 20.3028 4.9375C20.5802 4.75 20.9005 4.59961 21.2638 4.48633C21.631 4.36914 22.0704 4.31055 22.5821 4.31055C23.1446 4.31055 23.6271 4.41211 24.0294 4.61523C24.4356 4.81836 24.7481 5.0957 24.9669 5.44727C25.1856 5.79492 25.295 6.18945 25.295 6.63086C25.295 7.10352 25.2013 7.53516 25.0138 7.92578C24.8263 8.31641 24.5528 8.70312 24.1935 9.08594C23.838 9.46875 23.4083 9.89258 22.9044 10.3574L21.8028 11.3945V11.4766H25.5353V13Z" fill="white"/></svg>')
                            } else if (messagesCount.unread === 3) {
                                $('.loggedInNotificationCenter').html('<svg xmlns="http://www.w3.org/2000/svg" width="34" height="28" viewBox="0 0 34 28" fill="none" aria-hidden="true"><path fill-rule="evenodd" clip-rule="evenodd" d="M12.1881 5.9999C16.3567 5.9999 19.7633 9.40649 19.7633 13.5751V16.5849C21.288 16.8599 22.4513 18.1993 22.4513 19.801V20.498C22.4513 22.2975 20.983 23.7659 19.1835 23.7659L14.3267 23.7657C14.338 23.851 14.3438 23.938 14.3438 24.0264C14.3438 25.1167 13.4605 25.9999 12.3703 25.9999C11.28 25.9999 10.3958 25.1167 10.3958 24.0264C10.3958 23.938 10.4016 23.851 10.4128 23.7657L5.26784 23.7659C3.46834 23.7659 2 22.2975 2 20.498V19.801C2 18.2887 3.03704 17.0103 4.43616 16.6407L4.61289 16.5993V13.5751C4.61289 9.40649 8.01948 5.9999 12.1881 5.9999ZM12.1881 7.9739C9.10969 7.9739 6.58688 10.4967 6.58688 13.5751V18.5071H5.26784C4.55855 18.5071 3.974 19.0917 3.974 19.801V20.498C3.974 21.2073 4.55855 21.7919 5.26784 21.7919H19.1835C19.8928 21.7919 20.4773 21.2073 20.4773 20.498V19.801C20.4773 19.0917 19.8928 18.5071 19.1835 18.5071H17.7893V13.5751C17.7893 10.4967 15.2665 7.9739 12.1881 7.9739Z" fill="white"/><path d="M10.0001 9C10.0001 4.02944 14.0295 0 19.0001 0H25.0001C29.9707 0 34.0001 4.02944 34.0001 9C34.0001 13.9706 29.9707 18 25.0001 18H19.0001C14.0295 18 10.0001 13.9706 10.0001 9Z" fill="#DC1125"/><path d="M25.2013 6.34961C25.2013 6.74414 25.1192 7.08594 24.9552 7.375C24.7911 7.66406 24.5685 7.90039 24.2872 8.08398C24.0099 8.26758 23.6974 8.40234 23.3497 8.48828V8.52344C24.0372 8.60938 24.5587 8.82031 24.9142 9.15625C25.2735 9.49219 25.4532 9.94141 25.4532 10.5039C25.4532 11.0039 25.3302 11.4512 25.0841 11.8457C24.8419 12.2402 24.4669 12.5508 23.9591 12.7773C23.4513 13.0039 22.797 13.1172 21.9962 13.1172C21.5235 13.1172 21.0821 13.0781 20.672 13C20.2657 12.9258 19.8829 12.8105 19.5235 12.6543V11.1133C19.8907 11.3008 20.2755 11.4434 20.6778 11.541C21.0802 11.6348 21.4552 11.6816 21.8028 11.6816C22.4513 11.6816 22.9044 11.5703 23.1622 11.3477C23.4239 11.1211 23.5548 10.8047 23.5548 10.3984C23.5548 10.1602 23.4942 9.95898 23.3731 9.79492C23.2521 9.63086 23.0411 9.50586 22.7403 9.41992C22.4435 9.33398 22.0274 9.29102 21.4923 9.29102H20.8419V7.90234H21.504C22.0313 7.90234 22.4317 7.85352 22.7052 7.75586C22.9825 7.6543 23.17 7.51758 23.2677 7.3457C23.3692 7.16992 23.42 6.9707 23.42 6.74805C23.42 6.44336 23.3263 6.20508 23.1388 6.0332C22.9513 5.86133 22.6388 5.77539 22.2013 5.77539C21.9278 5.77539 21.6778 5.81055 21.4513 5.88086C21.2286 5.94727 21.0274 6.0293 20.8478 6.12695C20.6681 6.2207 20.5099 6.3125 20.3731 6.40234L19.5353 5.1543C19.8712 4.91211 20.2638 4.71094 20.713 4.55078C21.1661 4.39062 21.7052 4.31055 22.3302 4.31055C23.213 4.31055 23.9122 4.48828 24.4278 4.84375C24.9435 5.19922 25.2013 5.70117 25.2013 6.34961Z" fill="white"/></svg>')
                            } else if (messagesCount.unread === 4) {
                                $('.loggedInNotificationCenter').html('<svg xmlns="http://www.w3.org/2000/svg" width="34" height="28" viewBox="0 0 34 28" fill="none" aria-hidden="true"><path fill-rule="evenodd" clip-rule="evenodd" d="M12.1881 5.9999C16.3567 5.9999 19.7633 9.40649 19.7633 13.5751V16.5849C21.288 16.8599 22.4513 18.1993 22.4513 19.801V20.498C22.4513 22.2975 20.983 23.7659 19.1835 23.7659L14.3267 23.7657C14.338 23.851 14.3438 23.938 14.3438 24.0264C14.3438 25.1167 13.4605 25.9999 12.3703 25.9999C11.28 25.9999 10.3958 25.1167 10.3958 24.0264C10.3958 23.938 10.4016 23.851 10.4128 23.7657L5.26784 23.7659C3.46834 23.7659 2 22.2975 2 20.498V19.801C2 18.2887 3.03704 17.0103 4.43616 16.6407L4.61289 16.5993V13.5751C4.61289 9.40649 8.01948 5.9999 12.1881 5.9999ZM12.1881 7.9739C9.10969 7.9739 6.58688 10.4967 6.58688 13.5751V18.5071H5.26784C4.55855 18.5071 3.974 19.0917 3.974 19.801V20.498C3.974 21.2073 4.55855 21.7919 5.26784 21.7919H19.1835C19.8928 21.7919 20.4773 21.2073 20.4773 20.498V19.801C20.4773 19.0917 19.8928 18.5071 19.1835 18.5071H17.7893V13.5751C17.7893 10.4967 15.2665 7.9739 12.1881 7.9739Z" fill="white"/><path d="M10.0001 9C10.0001 4.02944 14.0295 0 19.0001 0H25.0001C29.9707 0 34.0001 4.02944 34.0001 9C34.0001 13.9706 29.9707 18 25.0001 18H19.0001C14.0295 18 10.0001 13.9706 10.0001 9Z" fill="#DC1125"/><path d="M25.7286 11.2246H24.6974V13H22.9278V11.2246H19.2716V9.96484L23.0274 4.43359H24.6974V9.81836H25.7286V11.2246ZM22.9278 9.81836V8.36523C22.9278 8.22852 22.9298 8.06641 22.9337 7.87891C22.9415 7.69141 22.9493 7.50391 22.9571 7.31641C22.9649 7.12891 22.9728 6.96289 22.9806 6.81836C22.9923 6.66992 23.0001 6.56641 23.004 6.50781H22.9571C22.8829 6.66797 22.8048 6.82422 22.7228 6.97656C22.6407 7.125 22.545 7.28125 22.4356 7.44531L20.8653 9.81836H22.9278Z" fill="white"/></svg>')
                            } else if (messagesCount.unread === 5) {
                                $('.loggedInNotificationCenter').html('<svg xmlns="http://www.w3.org/2000/svg" width="34" height="28" viewBox="0 0 34 28" fill="none" aria-hidden="true"><path fill-rule="evenodd" clip-rule="evenodd" d="M12.1881 5.9999C16.3567 5.9999 19.7633 9.40649 19.7633 13.5751V16.5849C21.288 16.8599 22.4513 18.1993 22.4513 19.801V20.498C22.4513 22.2975 20.983 23.7659 19.1835 23.7659L14.3267 23.7657C14.338 23.851 14.3438 23.938 14.3438 24.0264C14.3438 25.1167 13.4605 25.9999 12.3703 25.9999C11.28 25.9999 10.3958 25.1167 10.3958 24.0264C10.3958 23.938 10.4016 23.851 10.4128 23.7657L5.26784 23.7659C3.46834 23.7659 2 22.2975 2 20.498V19.801C2 18.2887 3.03704 17.0103 4.43616 16.6407L4.61289 16.5993V13.5751C4.61289 9.40649 8.01948 5.9999 12.1881 5.9999ZM12.1881 7.9739C9.10969 7.9739 6.58688 10.4967 6.58688 13.5751V18.5071H5.26784C4.55855 18.5071 3.974 19.0917 3.974 19.801V20.498C3.974 21.2073 4.55855 21.7919 5.26784 21.7919H19.1835C19.8928 21.7919 20.4773 21.2073 20.4773 20.498V19.801C20.4773 19.0917 19.8928 18.5071 19.1835 18.5071H17.7893V13.5751C17.7893 10.4967 15.2665 7.9739 12.1881 7.9739Z" fill="white"/><path d="M10.0001 9C10.0001 4.02944 14.0295 0 19.0001 0H25.0001C29.9707 0 34.0001 4.02944 34.0001 9C34.0001 13.9706 29.9707 18 25.0001 18H19.0001C14.0295 18 10.0001 13.9706 10.0001 9Z" fill="#DC1125"/><path d="M22.6642 7.52734C23.1876 7.52734 23.6524 7.62695 24.0587 7.82617C24.4688 8.02539 24.7911 8.31836 25.0255 8.70508C25.2599 9.0918 25.3771 9.56836 25.3771 10.1348C25.3771 10.752 25.2481 11.2852 24.9903 11.7344C24.7364 12.1797 24.3556 12.5215 23.8478 12.7598C23.3438 12.998 22.7149 13.1172 21.961 13.1172C21.5118 13.1172 21.088 13.0781 20.6896 13C20.295 12.9258 19.9493 12.8105 19.6524 12.6543V11.0898C19.9493 11.2461 20.3048 11.3789 20.7188 11.4883C21.1368 11.5938 21.5294 11.6465 21.8966 11.6465C22.256 11.6465 22.5587 11.5996 22.8048 11.5059C23.0509 11.4082 23.2364 11.2598 23.3614 11.0605C23.4903 10.8574 23.5548 10.5996 23.5548 10.2871C23.5548 9.86914 23.4142 9.54883 23.1329 9.32617C22.8517 9.10352 22.42 8.99219 21.838 8.99219C21.6153 8.99219 21.3829 9.01367 21.1407 9.05664C20.9024 9.09961 20.7032 9.14258 20.5431 9.18555L19.8224 8.79883L20.1446 4.43359H24.7911V5.96875H21.7325L21.5743 7.65039C21.7071 7.62305 21.8517 7.5957 22.0079 7.56836C22.1642 7.54102 22.3829 7.52734 22.6642 7.52734Z" fill="white"/></svg>')
                            } else if (messagesCount.unread === 6) {
                                $('.loggedInNotificationCenter').html('<svg xmlns="http://www.w3.org/2000/svg" width="34" height="28" viewBox="0 0 34 28" fill="none" aria-hidden="true"><path fill-rule="evenodd" clip-rule="evenodd" d="M12.1881 5.9999C16.3567 5.9999 19.7633 9.40649 19.7633 13.5751V16.5849C21.288 16.8599 22.4513 18.1993 22.4513 19.801V20.498C22.4513 22.2975 20.983 23.7659 19.1835 23.7659L14.3267 23.7657C14.338 23.851 14.3438 23.938 14.3438 24.0264C14.3438 25.1167 13.4605 25.9999 12.3703 25.9999C11.28 25.9999 10.3958 25.1167 10.3958 24.0264C10.3958 23.938 10.4016 23.851 10.4128 23.7657L5.26784 23.7659C3.46834 23.7659 2 22.2975 2 20.498V19.801C2 18.2887 3.03704 17.0103 4.43616 16.6407L4.61289 16.5993V13.5751C4.61289 9.40649 8.01948 5.9999 12.1881 5.9999ZM12.1881 7.9739C9.10969 7.9739 6.58688 10.4967 6.58688 13.5751V18.5071H5.26784C4.55855 18.5071 3.974 19.0917 3.974 19.801V20.498C3.974 21.2073 4.55855 21.7919 5.26784 21.7919H19.1835C19.8928 21.7919 20.4773 21.2073 20.4773 20.498V19.801C20.4773 19.0917 19.8928 18.5071 19.1835 18.5071H17.7893V13.5751C17.7893 10.4967 15.2665 7.9739 12.1881 7.9739Z" fill="white"/><path d="M10.0001 9C10.0001 4.02944 14.0295 0 19.0001 0H25.0001C29.9707 0 34.0001 4.02944 34.0001 9C34.0001 13.9706 29.9707 18 25.0001 18H19.0001C14.0295 18 10.0001 13.9706 10.0001 9Z" fill="#DC1125"/><path d="M19.4884 9.36133C19.4884 8.86914 19.5235 8.38281 19.5938 7.90234C19.6681 7.41797 19.795 6.96289 19.9747 6.53711C20.1544 6.10742 20.4063 5.72852 20.7306 5.40039C21.0548 5.06836 21.4669 4.80859 21.9669 4.62109C22.4669 4.42969 23.0724 4.33398 23.7833 4.33398C23.9513 4.33398 24.1466 4.3418 24.3692 4.35742C24.5958 4.36914 24.7833 4.39062 24.9317 4.42188V5.86914C24.7755 5.83398 24.6075 5.80664 24.4278 5.78711C24.2521 5.76367 24.0763 5.75195 23.9005 5.75195C23.1896 5.75195 22.6388 5.86523 22.2481 6.0918C21.8614 6.31836 21.588 6.63281 21.4278 7.03516C21.2716 7.43359 21.1798 7.89844 21.1524 8.42969H21.2286C21.338 8.23828 21.4747 8.06836 21.6388 7.91992C21.8067 7.77148 22.0099 7.6543 22.2481 7.56836C22.4864 7.47852 22.7657 7.43359 23.086 7.43359C23.586 7.43359 24.0196 7.54102 24.3868 7.75586C24.754 7.9668 25.0372 8.27344 25.2364 8.67578C25.4356 9.07812 25.5353 9.56836 25.5353 10.1465C25.5353 10.7637 25.4161 11.2949 25.1778 11.7402C24.9396 12.1855 24.6017 12.5273 24.1642 12.7656C23.7306 13 23.2149 13.1172 22.6173 13.1172C22.1798 13.1172 21.7716 13.043 21.3927 12.8945C21.0138 12.7422 20.6817 12.5117 20.3966 12.2031C20.1114 11.8945 19.8888 11.5059 19.7286 11.0371C19.5685 10.5645 19.4884 10.0059 19.4884 9.36133ZM22.5821 11.6699C22.9376 11.6699 23.2267 11.5488 23.4493 11.3066C23.672 11.0645 23.7833 10.6855 23.7833 10.1699C23.7833 9.75195 23.6856 9.42383 23.4903 9.18555C23.2989 8.94336 23.0079 8.82227 22.6173 8.82227C22.3517 8.82227 22.1173 8.88281 21.9142 9.00391C21.7149 9.12109 21.5606 9.27148 21.4513 9.45508C21.3419 9.63477 21.2872 9.82031 21.2872 10.0117C21.2872 10.2109 21.3146 10.4082 21.3692 10.6035C21.4239 10.7988 21.506 10.9766 21.6153 11.1367C21.7247 11.2969 21.8595 11.4258 22.0196 11.5234C22.1837 11.6211 22.3712 11.6699 22.5821 11.6699Z" fill="white"/></svg>')
                            } else if (messagesCount.unread === 7) {
                                $('.loggedInNotificationCenter').html('<svg xmlns="http://www.w3.org/2000/svg" width="34" height="28" viewBox="0 0 34 28" fill="none" aria-hidden="true"><path fill-rule="evenodd" clip-rule="evenodd" d="M12.1881 5.9999C16.3567 5.9999 19.7633 9.40649 19.7633 13.5751V16.5849C21.288 16.8599 22.4513 18.1993 22.4513 19.801V20.498C22.4513 22.2975 20.983 23.7659 19.1835 23.7659L14.3267 23.7657C14.338 23.851 14.3438 23.938 14.3438 24.0264C14.3438 25.1167 13.4605 25.9999 12.3703 25.9999C11.28 25.9999 10.3958 25.1167 10.3958 24.0264C10.3958 23.938 10.4016 23.851 10.4128 23.7657L5.26784 23.7659C3.46834 23.7659 2 22.2975 2 20.498V19.801C2 18.2887 3.03704 17.0103 4.43616 16.6407L4.61289 16.5993V13.5751C4.61289 9.40649 8.01948 5.9999 12.1881 5.9999ZM12.1881 7.9739C9.10969 7.9739 6.58688 10.4967 6.58688 13.5751V18.5071H5.26784C4.55855 18.5071 3.974 19.0917 3.974 19.801V20.498C3.974 21.2073 4.55855 21.7919 5.26784 21.7919H19.1835C19.8928 21.7919 20.4773 21.2073 20.4773 20.498V19.801C20.4773 19.0917 19.8928 18.5071 19.1835 18.5071H17.7893V13.5751C17.7893 10.4967 15.2665 7.9739 12.1881 7.9739Z" fill="white"/><path d="M10.0001 9C10.0001 4.02944 14.0295 0 19.0001 0H25.0001C29.9707 0 34.0001 4.02944 34.0001 9C34.0001 13.9706 29.9707 18 25.0001 18H19.0001C14.0295 18 10.0001 13.9706 10.0001 9Z" fill="#DC1125"/><path d="M20.3966 13L23.6134 5.95703H19.3888V4.43359H25.5353V5.57031L22.295 13H20.3966Z" fill="white"/></svg>')
                            } else if (messagesCount.unread === 8) {
                                $('.loggedInNotificationCenter').html('<svg xmlns="http://www.w3.org/2000/svg" width="34" height="28" viewBox="0 0 34 28" fill="none" aria-hidden="true"><path fill-rule="evenodd" clip-rule="evenodd" d="M12.1881 5.9999C16.3567 5.9999 19.7633 9.40649 19.7633 13.5751V16.5849C21.288 16.8599 22.4513 18.1993 22.4513 19.801V20.498C22.4513 22.2975 20.983 23.7659 19.1835 23.7659L14.3267 23.7657C14.338 23.851 14.3438 23.938 14.3438 24.0264C14.3438 25.1167 13.4605 25.9999 12.3703 25.9999C11.28 25.9999 10.3958 25.1167 10.3958 24.0264C10.3958 23.938 10.4016 23.851 10.4128 23.7657L5.26784 23.7659C3.46834 23.7659 2 22.2975 2 20.498V19.801C2 18.2887 3.03704 17.0103 4.43616 16.6407L4.61289 16.5993V13.5751C4.61289 9.40649 8.01948 5.9999 12.1881 5.9999ZM12.1881 7.9739C9.10969 7.9739 6.58688 10.4967 6.58688 13.5751V18.5071H5.26784C4.55855 18.5071 3.974 19.0917 3.974 19.801V20.498C3.974 21.2073 4.55855 21.7919 5.26784 21.7919H19.1835C19.8928 21.7919 20.4773 21.2073 20.4773 20.498V19.801C20.4773 19.0917 19.8928 18.5071 19.1835 18.5071H17.7893V13.5751C17.7893 10.4967 15.2665 7.9739 12.1881 7.9739Z" fill="white"/><path d="M10.0001 9C10.0001 4.02944 14.0295 0 19.0001 0H25.0001C29.9707 0 34.0001 4.02944 34.0001 9C34.0001 13.9706 29.9707 18 25.0001 18H19.0001C14.0295 18 10.0001 13.9706 10.0001 9Z" fill="#DC1125"/><path d="M22.5001 4.32227C22.9923 4.32227 23.4454 4.39844 23.8595 4.55078C24.2774 4.70312 24.6114 4.93359 24.8614 5.24219C25.1114 5.54688 25.2364 5.92969 25.2364 6.39062C25.2364 6.73438 25.1681 7.03516 25.0313 7.29297C24.8985 7.55078 24.7169 7.77734 24.4864 7.97266C24.256 8.16406 23.9942 8.33203 23.7013 8.47656C24.006 8.63672 24.295 8.82422 24.5685 9.03906C24.8419 9.25 25.0646 9.49805 25.2364 9.7832C25.4122 10.0684 25.5001 10.4004 25.5001 10.7793C25.5001 11.2559 25.3731 11.6699 25.1192 12.0215C24.8653 12.3691 24.5138 12.6387 24.0646 12.8301C23.6153 13.0215 23.0938 13.1172 22.5001 13.1172C21.8595 13.1172 21.3146 13.0254 20.8653 12.8418C20.4161 12.6582 20.0743 12.3965 19.8399 12.0566C19.6056 11.7129 19.4884 11.3027 19.4884 10.8262C19.4884 10.4355 19.5606 10.0957 19.7052 9.80664C19.8536 9.51758 20.0528 9.26953 20.3028 9.0625C20.5528 8.85156 20.8282 8.67188 21.129 8.52344C20.8751 8.36328 20.6427 8.18164 20.4317 7.97852C20.2247 7.77539 20.0587 7.54297 19.9337 7.28125C19.8126 7.01953 19.7521 6.71875 19.7521 6.37891C19.7521 5.92578 19.879 5.54688 20.1329 5.24219C20.3907 4.9375 20.7286 4.70898 21.1466 4.55664C21.5646 4.40039 22.0157 4.32227 22.5001 4.32227ZM21.1642 10.7207C21.1642 11.0293 21.2735 11.2852 21.4923 11.4883C21.7149 11.6875 22.0431 11.7871 22.4767 11.7871C22.9259 11.7871 23.2618 11.6914 23.4845 11.5C23.7071 11.3047 23.8185 11.0488 23.8185 10.7324C23.8185 10.5137 23.754 10.3223 23.6251 10.1582C23.5001 9.99414 23.3419 9.84766 23.1505 9.71875C22.9591 9.58594 22.7657 9.46289 22.5704 9.34961L22.4122 9.26758C22.1622 9.38086 21.9435 9.50781 21.756 9.64844C21.5724 9.78906 21.4278 9.94727 21.3224 10.123C21.2169 10.2988 21.1642 10.498 21.1642 10.7207ZM22.4884 5.64648C22.1915 5.64648 21.9454 5.72266 21.7501 5.875C21.5548 6.02734 21.4571 6.24219 21.4571 6.51953C21.4571 6.71484 21.504 6.88672 21.5978 7.03516C21.6954 7.17969 21.8224 7.30664 21.9786 7.41602C22.1388 7.52539 22.3126 7.62695 22.5001 7.7207C22.6798 7.63477 22.8478 7.53906 23.004 7.43359C23.1603 7.32812 23.2872 7.20117 23.3849 7.05273C23.4825 6.9043 23.5313 6.72656 23.5313 6.51953C23.5313 6.24219 23.4317 6.02734 23.2325 5.875C23.0372 5.72266 22.7892 5.64648 22.4884 5.64648Z" fill="white"/></svg>')
                            } else if (messagesCount.unread > 8) {
                                $('.loggedInNotificationCenter').html('<svg xmlns="http://www.w3.org/2000/svg" width="34" height="28" viewBox="0 0 34 28" fill="none" aria-hidden="true"><path fill-rule="evenodd" clip-rule="evenodd" d="M12.1881 5.9999C16.3567 5.9999 19.7633 9.40649 19.7633 13.5751V16.5849C21.288 16.8599 22.4513 18.1993 22.4513 19.801V20.498C22.4513 22.2975 20.983 23.7659 19.1835 23.7659L14.3267 23.7657C14.338 23.851 14.3438 23.938 14.3438 24.0264C14.3438 25.1167 13.4605 25.9999 12.3703 25.9999C11.28 25.9999 10.3958 25.1167 10.3958 24.0264C10.3958 23.938 10.4016 23.851 10.4128 23.7657L5.26784 23.7659C3.46834 23.7659 2 22.2975 2 20.498V19.801C2 18.2887 3.03704 17.0103 4.43616 16.6407L4.61289 16.5993V13.5751C4.61289 9.40649 8.01948 5.9999 12.1881 5.9999ZM12.1881 7.9739C9.10969 7.9739 6.58688 10.4967 6.58688 13.5751V18.5071H5.26784C4.55855 18.5071 3.974 19.0917 3.974 19.801V20.498C3.974 21.2073 4.55855 21.7919 5.26784 21.7919H19.1835C19.8928 21.7919 20.4773 21.2073 20.4773 20.498V19.801C20.4773 19.0917 19.8928 18.5071 19.1835 18.5071H17.7893V13.5751C17.7893 10.4967 15.2665 7.9739 12.1881 7.9739Z" fill="white"/><path d="M10.0001 9C10.0001 4.02944 14.0295 0 19.0001 0H25.0001C29.9707 0 34.0001 4.02944 34.0001 9C34.0001 13.9706 29.9707 18 25.0001 18H19.0001C14.0295 18 10.0001 13.9706 10.0001 9Z" fill="#DC1125"/><path d="M21.5605 8.08984C21.5605 8.58203 21.5234 9.07031 21.4492 9.55469C21.3789 10.0391 21.2539 10.4961 21.0742 10.9258C20.8945 11.3516 20.6425 11.7305 20.3183 12.0625C19.9941 12.3906 19.582 12.6484 19.082 12.8359C18.582 13.0234 17.9765 13.1172 17.2656 13.1172C17.0976 13.1172 16.9003 13.1094 16.6738 13.0938C16.4472 13.082 16.2597 13.0625 16.1113 13.0352V11.582C16.2675 11.6211 16.4336 11.6523 16.6093 11.6758C16.7851 11.6953 16.9628 11.7051 17.1425 11.7051C17.8574 11.7051 18.4082 11.5918 18.7949 11.3652C19.1855 11.1387 19.4589 10.8242 19.6152 10.4219C19.7753 10.0195 19.8671 9.55469 19.8906 9.02734H19.8203C19.707 9.21484 19.5722 9.38477 19.416 9.53711C19.2636 9.68555 19.0683 9.80469 18.83 9.89453C18.5918 9.98047 18.289 10.0234 17.9218 10.0234C17.4336 10.0234 17.0078 9.91797 16.6445 9.70703C16.2851 9.49219 16.0058 9.18359 15.8066 8.78125C15.6113 8.375 15.5136 7.88477 15.5136 7.31055C15.5136 6.68945 15.6308 6.1582 15.8652 5.7168C16.1035 5.27148 16.4414 4.92969 16.8789 4.69141C17.3164 4.45312 17.832 4.33398 18.4257 4.33398C18.8632 4.33398 19.2714 4.41016 19.6503 4.5625C20.0293 4.71094 20.3613 4.93945 20.6464 5.24805C20.9355 5.55664 21.1601 5.94727 21.3203 6.41992C21.4804 6.89258 21.5605 7.44922 21.5605 8.08984ZM18.4609 5.78711C18.1093 5.78711 17.8222 5.9082 17.5996 6.15039C17.3769 6.39258 17.2656 6.77148 17.2656 7.28711C17.2656 7.70117 17.3613 8.0293 17.5527 8.27148C17.7441 8.51367 18.0351 8.63477 18.4257 8.63477C18.6953 8.63477 18.9296 8.57617 19.1289 8.45898C19.3281 8.33789 19.4824 8.1875 19.5918 8.00781C19.705 7.82422 19.7617 7.63672 19.7617 7.44531C19.7617 7.24609 19.7343 7.04883 19.6796 6.85352C19.625 6.6582 19.5429 6.48047 19.4336 6.32031C19.3242 6.16016 19.1875 6.03125 19.0234 5.93359C18.8632 5.83594 18.6757 5.78711 18.4609 5.78711Z" fill="white"/><path d="M26.0725 8.13086H28.3401V9.41406H26.0725V11.6699H24.7893V9.41406H22.5217V8.13086H24.7893V5.8457H26.0725V8.13086Z" fill="white"/></svg>')
                            }

                            if(messagesCount.unread > 0) {
                                $('.loggedInNotificationCenter').attr('style', 'height: 32px;');
                                $('.loginNotificationContainerMobile').attr('style', 'width: auto;');
                            }
                        });
    
                        $('.profileBellModal a[href="/inbox"]').on('keydown swipe', function (e) {
                            if(e.which === 9 || e.type === "swiperight") {
                                $('.navBellProfileContainer').focus();
                            }
                        });
                    },
                    error: function (error) {
                        console.error("Error:", error);
                    }
                });
    
                $(document).on('click keypress', '.navLoginContainerMobile', function (e) {
                    if(e.type === "click" || e.which === 13) {
                        $('.profileManagementModalContainer').show();
                        $('.profileManagementCloseModal').focus();
                        $('body').addClass('hideOverflow');
                        $('.navLoginContainerMobile, .profileManagementModalContainer').attr('aria-expanded', 'true');
                        $('[role="main"], #ccl-mainContainer, #cclr-global-footer-root, .loggedInNotificationCenter, .cgh-header__secondary-menu-left>a, .globalNavBurgeMenu, .navLoginContainerMobile').attr('aria-hidden', 'true');
                    }
                });
    
                $(document).on('click keypress', '.profileManagementCloseModal', function (e) {
                    if(e.type === "click" || e.which === 13) {
                        $('.profileManagementModalContainer').hide();
                        $('body').removeClass('hideOverflow');
                        $('.navLoginContainerMobile, .profileManagementModalContainer').attr('aria-expanded', 'false');
                        $('[role="main"], #ccl-mainContainer, #cclr-global-footer-root, .loggedInNotificationCenter, .cgh-header__secondary-menu-left>a, .globalNavBurgeMenu, .navLoginContainerMobile').attr('aria-hidden', 'false');
                        $('.navLoginContainerMobile').focus();
                    }
                });
    
                $(document).on('click keypress', '.loggedInNotificationCenter', function (e) {
                    if(e.type === "click" || e.which === 13) {
                        $('.profileBellModal').show();
                        $('.profileBellCloseContainer').focus();
                        $('body').addClass('hideOverflow');
                        $('.loggedInNotificationCenter, .profileBellModal').attr('aria-expanded', 'true');
                        $('[role="main"], #ccl-mainContainer, #cclr-global-footer-root, .loggedInNotificationCenter, .cgh-header__secondary-menu-left>a, .globalNavBurgeMenu, .navLoginContainerMobile').attr('aria-hidden', 'true');
                    }
                });
    
                $(document).on('click keypress', '.profileBellCloseContainer', function (e) {
                    if(e.type === "click" || e.which === 13) {
                        $('.profileBellModal').hide();
                        $('body').removeClass('hideOverflow');
                        $('.loggedInNotificationCenter, .profileBellModal').attr('aria-expanded', 'false');
                        $('[role="main"], #ccl-mainContainer, #cclr-global-footer-root, .loggedInNotificationCenter, .cgh-header__secondary-menu-left>a, .globalNavBurgeMenu, .navLoginContainerMobile').attr('aria-hidden', 'false');
                        $('.loggedInNotificationCenter').focus();
                    }
                });
    
                $('.navPostCruise').on('keydown swipe', function (e) {
                    if(e.which === 9 || e.type === "swiperight") {
                        $('.profileManagementModalContainer>span').focus();
                    }
                });
    
                if($(window).width() > 767) {
                    $('.navLoginContainerMobile').append('<span class="loggedInName" aria-label="Ahoy, '+userName+'">Ahoy, <div>'+userName+'</div></span>');
                    var fontSize = 12;
                    var test = document.querySelector('.loggedInName div');
                    test.style.fontSize = fontSize;
                    var height = (test.clientHeight + 1) + "px";
                    var width = (test.offsetWidth + 1);
    
                    if(width > 139) {
                        $('.loggedInName').text($('.loggedInName').text().split(',')[1]);
                    }
                }
                }
                else {
                    
                    $('.cgh-header__secondary-menu-left').append('<a class="navLoginContainerMobile" href="javascript:window.Carnival.SSO.openLoginRegisterComponent('+singleQuote+'/login'+singleQuote+')" role="button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" style="margin-right: 4px;" aria-hidden="true"><path d="M11.5 6.44938C9.50664 6.44938 7.89062 8.0146 7.89062 9.94531C7.89062 11.876 9.50664 13.4412 11.5 13.4412C13.4934 13.4412 15.1094 11.876 15.1094 9.94531C15.1094 8.0146 13.4934 6.44938 11.5 6.44938ZM11.5 11.5344C10.5952 11.5344 9.85938 10.8213 9.85938 9.94531C9.85938 9.06736 10.5936 8.35625 11.5 8.35625C12.4064 8.35625 13.1406 9.06894 13.1406 9.94531C13.1406 10.8233 12.4064 11.5344 11.5 11.5344ZM11.5 2C5.70039 2 1 6.55266 1 12.17C1 17.7873 5.70039 22.34 11.5 22.34C17.2996 22.34 22 17.7873 22 12.17C22 6.55266 17.2996 2 11.5 2ZM11.5 20.4331C9.58334 20.4331 7.81844 19.8102 6.39355 18.773C7.10313 17.4536 8.48125 16.6194 10.0316 16.6194H12.9721C14.5204 16.6194 15.8969 17.454 16.6093 18.773C15.1832 19.8094 13.4154 20.4331 11.5 20.4331ZM18.0707 17.4338C16.9633 15.7573 15.0766 14.7125 12.9684 14.7125H10.0316C7.92508 14.7125 6.03877 15.7553 4.9293 17.433C3.70539 16.0036 2.96875 14.1682 2.96875 12.17C2.96875 7.61336 6.79592 3.90688 11.5 3.90688C16.2041 3.90688 20.0312 7.61376 20.0312 12.17C20.0312 14.1682 19.293 16.0036 18.0707 17.4338Z" fill="white"/></svg>Log In');
                }
            }, 150);
        
        $('.cgh-header__secondary-menu').prepend('<a class="globalNavBurgeMenu" aria-label=" main menu" tabindex="0" role="button" aria-expanded="false"></a>');
        if($('.primaryMenuNav').length < 1) {

            $('body').prepend($('<div class="primaryMenuNav"></div>'));
            $("<div class='secondaryNav'><div class='secondaryNavTopContainer' tabindex='0'><a class='secondaryNavBack' tabindex='0' aria-label='Back to main menu' role='button'><svg xmlns='http://www.w3.org/2000/svg' width='24' height='24' viewBox='0 0 24 24' fill='none' aria-hidden='true'><path d='M6.31821 11.2226L15.1184 2.32186C15.5427 1.89271 16.231 1.89271 16.6552 2.32186L17.6817 3.36013C18.1056 3.78882 18.106 4.48314 17.6835 4.91274L10.709 11.9998L17.6831 19.0873C18.106 19.5169 18.1051 20.2112 17.6813 20.6399L16.6548 21.6781C16.2305 22.1073 15.5422 22.1073 15.118 21.6781L6.31821 12.777C5.89393 12.3478 5.89393 11.6517 6.31821 11.2226Z' fill='#10559A'/></svg></a><a class='closeGlobalNav'  tabindex='0' role='button' aria-label='Close Main Menu'></a></div></div>").insertAfter($('.primaryMenuNav'));
        }
        
        if($('.primaryMenuNav .globalNavContainerMobile').length < 1) {
            $('.primaryMenuNav').prepend('<div class="globalNavContactContainer"><a class ="globalContactNumber" href="tel:1-800-764-7419">1.800.764.7419</a><a class="globalContactLink" href="/about-carnival/contact-us">Contact Us</a><a class="globalSearch" href="https://www.carnival.com/searchresults"><img src="//cdn.optimizely.com/img/752671897/990d2f21588b46ad8f2e0bb72521321a.svgz" alt=""/>Site Search</a><div class="countryContainer"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="14" viewBox="0 0 24 14" fill="none" aria-hidden="true"><rect y="0.0117188" width="11" height="7" fill="#10559A"/><rect x="11" y="1.01172" width="13" height="1" fill="white"/><rect x="11" y="3.01172" width="13" height="1" fill="white"/><rect x="11" y="5.01172" width="13" height="1" fill="white"/><rect y="7.01172" width="24" height="1" fill="white"/><rect y="9.01172" width="24" height="1" fill="white"/><rect y="11.0117" width="24" height="1" fill="white"/><rect x="11" y="0.0117188" width="13" height="1" fill="#DC1125"/><rect x="11" y="2.01172" width="13" height="1" fill="#DC1125"/><rect x="11" y="4.01172" width="13" height="1" fill="#DC1125"/><rect x="11" y="6.01172" width="13" height="1" fill="#DC1125"/><rect y="8.01172" width="24" height="1" fill="#DC1125"/><rect y="10.0117" width="24" height="1" fill="#DC1125"/><rect y="12.0117" width="24" height="1" fill="#DC1125"/></svg><select name="country" aria-label="Country Selector" class="globalCountry"><option value="https://www.carnival.com">United States</option><option value="https://www.carnival.com.au">Australia</option></select><svg xmlns="http://www.w3.org/2000/svg" width="16" height="17" viewBox="0 0 16 17" fill="none"><path d="M7.45593 11.7995L1.22537 5.93278C0.924876 5.64983 0.924876 5.1911 1.22537 4.90818L1.95207 4.22392C2.25205 3.94146 2.73823 3.94091 3.03892 4.22271L8.00002 8.87222L12.9611 4.22271C13.2618 3.94091 13.748 3.94146 14.0479 4.22392L14.7746 4.90818C15.0751 5.19113 15.0751 5.64986 14.7746 5.93278L8.5441 11.7995C8.24361 12.0824 7.75643 12.0824 7.45593 11.7995Z" fill="#10559A"/></svg></div></div>');
    
            $('.primaryMenuNav').prepend('<div class ="globalNavMainLinkContainer"><a class="globalNavPAC" tabindex="0" role="button">Plan a Cruise</a><a class="globalNavOS" tabindex="0" role="button">Our Ships</a><a class="globalNavDestinations" tabindex="0" role="button">Destinations</a><a role="button" class="globalNavDeals" tabindex="0">Deals</a><a class="globalNavVIFP" tabindex="0" role="button">VIFP Club</a></div>');
            $('.globalNavMainLinkContainer').append('<a class="globalNavMB" tabindex="0" role="button">Manage Bookings</a>');

            $('.primaryMenuNav').prepend('<a class="globalNavLoginContainer" tabindex="0" role="button" aria-label="Login"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 32 32" fill="none" aria-hidden="true"><path d="M15.3335 8.59925C12.6757 8.59925 10.521 10.6862 10.521 13.2605C10.521 15.8348 12.6757 17.9217 15.3335 17.9217C17.9913 17.9217 20.146 15.8348 20.146 13.2605C20.146 10.6862 17.9913 8.59925 15.3335 8.59925ZM15.3335 15.3792C14.1271 15.3792 13.146 14.4285 13.146 13.2605C13.146 12.0899 14.1249 11.1417 15.3335 11.1417C16.5421 11.1417 17.521 12.092 17.521 13.2605C17.521 14.4311 16.5421 15.3792 15.3335 15.3792ZM15.3335 2.66675C7.60068 2.66675 1.3335 8.73697 1.3335 16.2267C1.3335 23.7165 7.60068 29.7867 15.3335 29.7867C23.0663 29.7867 29.3335 23.7165 29.3335 16.2267C29.3335 8.73697 23.0663 2.66675 15.3335 2.66675ZM15.3335 27.2442C12.7779 27.2442 10.4247 26.4137 8.5249 25.0307C9.471 23.2716 11.3085 22.1592 13.3757 22.1592H17.2962C19.3607 22.1592 21.196 23.2721 22.1459 25.0307C20.2444 26.4126 17.8874 27.2442 15.3335 27.2442ZM24.0944 23.2451C22.6179 21.0098 20.1022 19.6167 17.2913 19.6167H13.3757C10.5669 19.6167 8.05186 21.0072 6.57256 23.244C4.94068 21.3382 3.9585 18.8911 3.9585 16.2267C3.9585 10.1512 9.06139 5.20925 15.3335 5.20925C21.6056 5.20925 26.7085 10.1518 26.7085 16.2267C26.7085 18.8911 25.7241 21.3382 24.0944 23.2451Z" fill="white"/></svg><span>Log In</span><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" fill="none" aria-hidden="true"><path d="M11.7878 8.54407L5.92106 14.7746C5.63811 15.0751 5.17938 15.0751 4.89646 14.7746L4.2122 14.0479C3.92974 13.748 3.9292 13.2618 4.211 12.9611L8.8605 7.99998L4.211 3.03892C3.9292 2.73823 3.92974 2.25205 4.2122 1.95207L4.89646 1.22537C5.17941 0.924876 5.63814 0.924876 5.92106 1.22537L11.7878 7.45593C12.0707 7.75639 12.0707 8.24357 11.7878 8.54407Z" fill="white" class="globalChevron"/></svg></a>');
    
            $('.primaryMenuNav').prepend('<div class="globalNavContainerMobile" tabindex="0"><a class="closeGlobalNav" tabindex="0" role="button" aria-label="Close Main Menu"></a><a class="carnivalLogo" href="/"><img class="logo" src="/-/media/images/header2013/carnival-logo-png.png" alt="Carnival Home Page"/></a></div>');

            if(window.location.origin === 'https://www.carnival.com') {
                $('.globalCountry').prepend('<img src="//cdn.optimizely.com/img/752671897/bbbf8c4aa64748de9e1f71465cfbff9c.svgz" alt="" />');
            }
        }

        utils.waitForElement('[data-testid="user-name"]').then(function () {
            var userName = $('[data-testid="user-name"]:eq(0)').text();
            $('.globalNavLoginContainer').addClass('globalNavLoginAuthenticated');
            $('.globalNavLoginAuthenticated span').text('Ahoy, '+userName+'');
            $('.globalNavLoginAuthenticated').attr('aria-label','Ahoy, '+userName+' Profile menu');
        });

        $('.globalNavBurgeMenu').bind('click keypress', function (e) {
            if(e.type === "click" || e.which === 13) {
                $('.primaryMenuNav').addClass('activeNav');
                $('body').addClass('hideOverflow');
                $('.cclr-global-header-wrapper, #ccl-mainContainer, #cclr-global-footer-root, .destination, .navLoginContainerMobile, .loggedInNotificationCenter, .cgh-header__secondary-menu-left>a, .globalNavBurgeMenu').attr('aria-hidden', 'true');
                $('.globalNavBurgeMenu').attr('aria-expanded', 'true');
                setTimeout(function () {
                    $('.closeGlobalNav').focus();
                }, 100);
            }
        });

        $('.closeGlobalNav').bind('click keypress', function (e) {
            if(e.type === "click" || e.which === 13) {
                $('.primaryMenuNav').removeClass('activeNav');
                $('body').removeClass('hideOverflow');
                $('.secondaryNav').hide();
                $('.secondaryNavLinkContainer').remove();
                $('.cclr-global-header-wrapper, #ccl-mainContainer, #cclr-global-footer-root, .destination, .navLoginContainerMobile, .loggedInNotificationCenter, .cgh-header__secondary-menu-left>a, .globalNavBurgeMenu').attr('aria-hidden', 'false');
                $('.globalNavBurgeMenu').attr('aria-expanded', 'false');
                $('.primaryMenuNav').attr('aria-hidden','false');
                $('.globalNavBurgeMenu').focus();
            }
        });


        $('.secondaryNavBack').bind('click keypress', function (e) {
            if(e.type === "click" || e.which === 13) {
                $('.secondaryNav').hide();
                $('.primaryMenuNav').attr('aria-hidden','false');
                $('.secondaryNavLinkContainer').remove();
                $('.closeGlobalNav').focus();
            }
        });

        $(document).on('click keypress', '.globalNavMainLinkContainer a', function (e) {
            if(e.type === "click" || e.which === 13) {
                $('.secondaryNav').show();
                $('.secondaryNavBack').focus();
                $('.primaryMenuNav').attr('aria-hidden', 'true');
            }
        });

        $('.globalNavPAC').bind('click keypress', function (e) {
            if (e.type === "click" || e.which === 13) {
                $('.secondaryNav').append('<div class="secondaryNavLinkContainer"><span class="secondaryNavLinkHeader">Plan a Cruise</span><div class="secondaryNavLinks"><div class="secondaryNavSectionContainer navSecondaryMainContainer"><span class= "secondaryNavSubHeader">Explore Planning</span><a href="/cruise-search">Find a Cruise</a><a href="/cruise-ships">Ships</a><a href="/cruise-to">Destinations</a><a href="/onboard">Onboard Activities</a><a href="/shore-excursions">Shore Excursions</a><a href="/cruise-from">Departure Ports</a></div><div class="secondaryNavSectionContainer"><span class= "secondaryNavSubHeader">Onboard Packages</span><a href="/drink-packages">Beverage Packages</a><a href="/internet-plans">Internet Plans</a><a href="/funshops">In-Room Gifts & Shopping</a></div><div class="secondaryNavSectionContainer"><span class= "secondaryNavSubHeader">More Planning Options</span><a href="https://help.carnival.com/app/answers/detail/a_id/3861/~/what-does-the-price-of-my-cruise-include%3F">What'+singleQuote+'s Included</a><a href="/personal-vacation-planners">Request Carnival Planner</a><a href="/airport-transfers">Airport Transportation</a><a href="/wedding-cruises">Weddings & Honeymoons</a><a href="/fly2fun">Fly2Fun</a><a href="/awaywego">Away We Go Blog</a><a href="/help">FAQs</a></div><div class="secondaryNavSectionContainer"><span class= "secondaryNavSubHeader">Featured Cruises</span><a tabindex="0" href="/cruise-from/florida">Cruises From Florida</a><a tabindex="0" href="/cruise-search?lastminute">Last-Minute Cruises</div></div></div></div>');
                $('.globalNavSecondaryPlan')
                $('.secondaryNavLinkContainer:eq(1)').remove();
            }
        });

        $('.globalNavOS').bind('click keypress', function (e) {
            if (e.type === "click" || e.which === 13) {
                $('.secondaryNav').append('<div class="secondaryNavLinkContainer"><span class="secondaryNavLinkHeader">Our Ships</span><div class="secondaryNavLinks"><div class="secondaryNavSectionContainer navSecondaryMainContainer"><span class= "secondaryNavSubHeader">Explore Our Ships</span><a href="/cruise-ships">Ships</a><a href="/onboard">Onboard Activities</a><a href="/dining">Dining</a><a href="/staterooms">Staterooms</a></div><div class="secondaryNavSectionContainer"><span class="secondaryNavSubHeader">Things To Do</span><a href="/onboard/cruise-activities">Activities</a><a href="/onboard/bars">Bars</a><a href="/onboard/casino">Casino</a><a href="/onboard/cruise-entertainment">Entertainment</a><a href="/onboard/cruise-events">Events</a><a href="/onboard/cruise-activities-for-kids ">Kids & Teens</a><a href="/onboard/outdoor">Outdoor</a><a href="/onboard/shopping ">Shops</a><a href="/onboard/spa-fitness">Spa & Fitness</a></div><div class="secondaryNavSectionContainer"><span class="secondaryNavSubHeader">Newest Ships</span><a href="/cruise-ships/carnival-jubilee">Carnival Jubilee</a><a href="/cruise-ships/carnival-firenze">Carnival Firenze</a><a href="/cruise-ships/carnival-venezia">Carnival Venezia</a><a href="/cruise-ships/carnival-celebration">Carnival Celebration</a><a href="/cruise-ships/carnival-luminosa">Carnival Luminosa</a></div></div></div></div>');
                $('.secondaryNavLinkContainer:eq(1)').remove();
            }
        });

        $('.globalNavDestinations').bind('click keypress', function (e) {
            if (e.type === "click" || e.which === 13) {
                $('.secondaryNav').append('<div class="secondaryNavLinkContainer"><span class="secondaryNavLinkHeader destinationsHeader">Destinations</span><div class="secondaryNavLinks"><div class="secondaryNavSectionContainer navSecondaryMainContainer"><span class ="secondaryNavSubHeader">Explore Destinations</span><a href="/cruise-to">All Destinations</a><a href="/shore-excursions">Shore Excursions</a><a href="/cruise-from">Departure Ports</a></div><div class="secondaryNavSectionContainer"><span class="secondaryNavSubHeader">Americas</span><a href="/cruise-to/alaska-cruises">Alaska</a><a href="/cruise-to/bahamas-cruises">The Bahamas</a><a href="/cruise-to/bermuda-cruises">Bermuda</a><a href="/cruise-to/canada-new-england-cruises">Canada & New England</a><a href="/cruise-to/caribbean-cruises">Caribbean</a><a href="/cruise-to/greenland-canada-cruises">Greenland & Canada</a><a href="/cruise-to/hawaii-cruises">Hawaii</a><a href="/cruise-to/mexico-cruises">Mexico</a><a href="/cruise-to/panama-canal-cruises">Panama Canal</a></div><div class="secondaryNavSectionContainer"><span class="secondaryNavSubHeader">Australia & South Pacific</span><a href="/cruise-to/australia-cruises">Australia</a><a href="/cruise-to/new-zealand-cruises">New Zealand</a><a href="/cruise-to/south-pacific-cruises">South Pacific</a></div><div class ="secondaryNavSectionContainer"><span class="secondaryNavSubHeader">Europe & Asia</span><a href="/cruise-to/asia-cruises">Asia</a><a href="/cruise-to/europe-cruises">Europe</a><a href="/cruise-to/transatlantic-cruises">Transatlantic</a><a href="/cruise-to/transpacific-cruises">Transpacific</a></div><div class ="secondaryNavSectionContainer"><span class="secondaryNavSubHeader">Featured Destinations</span><a href="/celebration-key">Celebration Key</a><a tabindex="0" href="/cruise-to/caribbean-cruises/amber-cove-cruises">Amber Cove</a><a tabindex="0" href="/cruise-to/caribbean-cruises/grand-turk-cruises">Grand Turk</a><a href="/cruise-to/bahamas-cruises/half-moon-cay-cruises">Half Moon Cay</a><a tabindex="0" href="/cruise-to/caribbean-cruises/mahogany-bay-cruises">Mahogany Bay</a><a tabindex="0" href="/cruise-to/bahamas-cruises/princess-cays-cruises">Princess Cays</a><a tabindex="0" href="/cruise-to/mexico-cruises/cozumel-cruises">Puerta Maya at Cozumel</a></div></div></div>');
                $('.secondaryNavLinkContainer:eq(1)').remove();
            }
        });

        $('.globalNavDeals').bind('click keypress', function (e) {
            if (e.type === "click" || e.which === 13) {
                $('.secondaryNav').append('<div class="secondaryNavLinkContainer"><span class="secondaryNavLinkHeader">Deals</span><div class="secondaryNavLinks"><div class="secondaryNavSectionContainer globalNavSecondaryDeals"><span class= "secondaryNavSubHeader">Explore Deals</span><a href="/cruise-deals">All Cruise Deals</a></div></div></div>');
                $('.secondaryNavLinkContainer:eq(1)').remove();
            }
        });

        $('.globalNavVIFP').bind('click keypress', function (e) {
            if (e.type === "click" || e.which === 13) {
                $('.secondaryNav').append('<div class="secondaryNavLinkContainer"><span class="secondaryNavLinkHeader">VIFP Club</span><div class="secondaryNavLinks"><div class="secondaryNavSectionContainer globalNavSecondaryVIFP"><span class= "secondaryNavSubHeader">Explore VIFP Club</span><a href="/vifp/overview">What It Is</a><a href="/vifp/benefits">What You Get</a><a href="/vifp/how-it-works">How It Works</a> </div></div></div>');
                $('.secondaryNavLinkContainer:eq(1)').remove();
            }
        });
        
        $(document).on('click keypress','.globalNavMB', function (e) {
            if (e.type === "click" || e.which === 13) {
                $('.secondaryNav').append('<div class="secondaryNavLinkContainer"><span class="secondaryNavLinkHeader">Manage Bookings</span><div class="secondaryNavLinks"><div class="secondaryNavSectionContainer navSecondaryMainContainer"><span class= "secondaryNavSubHeader">Manage Your Bookings</span><a href="/quickpay">Make a Payment</a><a href="/booked/planner">My Bookings</a><a href="/funshops">In-Room Gifts & Shopping</a><a href="/booked/details">Online Check-in</a></div><div class="secondaryNavSectionContainer"><span class="secondaryNavSubHeader">Getting There</span><a href="/fly2fun">Fly2Fun</a><a href="/help?topicid=3409">Travel Documentation</a><a href="/airport-transfers">Airport Transportation</a></div></div>');
                $('.secondaryNavLinkContainer:eq(1)').remove();
            }
        });

        $(document).on('click', '.globalNavLoginContainer', function () {
            if($('.globalNavLoginAuthenticated').length < 1) {
                document.querySelector('.navLoginContainerMobile').click();
            } else {
                $('.primaryMenuNav').removeClass('activeNav');
                document.querySelector('.loginNotificationContainerMobile .navLoginContainerMobile').click();
            }
        });

        $('.globalCountry').change(function () {
            window.location.href = $('.globalCountry').val();
        });

        $('.globalCountry').on('keydown swipe', function (e) {
            if(e.which === 9 || e.type === "swiperight") {
                $('.globalNavContainerMobile').focus();
            }
        });

        $(document).on('keydown swipe', '.secondaryNavLinks a:last', function (e) {
            if(e.which === 9 || e.type === "swiperight") {
                $('.secondaryNavTopContainer').focus();
            }
        });
    }

    } else {
        if($('.globalNavDesktopContainer').length < 1) {
        
            $('.cgh-header__secondary-menu-left').append('<div class="globalNavDesktopContainer"><button class="globalNavPlan" tabindex="0" role="button" aria-expanded="false">Plan a Cruise</button><button class="globalNavOurShips" tabindex="0" role="button" aria-expanded="false">Our Ships</button><button class="globalNavDestinations" tabindex="0" role="button" aria-expanded="false">Destinations</button><button class="globalNavDeals" tabindex="0" role="button" aria-expanded="false">Deals</button><button class="globalNavVIFP" tabindex="0" role="button" aria-expanded="false">VIFP Club</button><button class="myBookingNav" tabindex="0" role="button" aria-expanded="false">Manage Bookings</button></div>');
    
            $('.cgh-header__secondary-menu-right').prepend('<div class="globalNavSearch"><a class="globalNavSearchLink" href="/searchresults" aria-label="Search Carnival"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" aria-hidden="true"><path d="M21.8623 20.3155L17.1204 15.5736C17.0305 15.4837 16.9133 15.4368 16.7883 15.4368H16.2727C17.5031 14.0111 18.2492 12.1558 18.2492 10.1246C18.2492 5.63654 14.6127 2 10.1246 2C5.63654 2 2 5.63654 2 10.1246C2 14.6127 5.63654 18.2492 10.1246 18.2492C12.1558 18.2492 14.0111 17.5031 15.4368 16.2727V16.7883C15.4368 16.9133 15.4876 17.0305 15.5736 17.1204L20.3155 21.8623C20.4991 22.0459 20.796 22.0459 20.9795 21.8623L21.8623 20.9795C22.0459 20.796 22.0459 20.4991 21.8623 20.3155ZM10.1246 16.3743C6.67165 16.3743 3.87491 13.5776 3.87491 10.1246C3.87491 6.67165 6.67165 3.87491 10.1246 3.87491C13.5776 3.87491 16.3743 6.67165 16.3743 10.1246C16.3743 13.5776 13.5776 16.3743 10.1246 16.3743Z" fill="#10559A"/></svg></a></div>');

            $('.globalNavDesktopContainer').append('<nav class="globalNavSecondary" role="menuitem"></nav><div class="globalNavSecondaryBackgroundDrop"></div>');
 
            function navPlanFunction() {
                $('.globalNavSecondary div').remove();
                $('.globalNavDesktopContainer>button:not(.globalNavPlan)').removeClass('activeLink');
                $('.globalNavPlan').addClass('activeLink');
                $('.globalNavDesktopContainer>button:not(.globalNavPlan)').attr('aria-expanded','false');
                $('.globalNavPlan').attr('aria-expanded', 'true');
                $('.globalNavSecondary').append('<div class="globalNavSecondaryPlan"><div class= "globalNavSecondaryLinkContainer navSecondaryMainContainer"><span>Explore Planning</span><a href="/cruise-search" tabindex="0">Find a Cruise</a><a href="/cruise-ships" tabindex="0">Ships</a><a href="/cruise-to" tabindex="0">Destinations</a><a href="/onboard" tabindex="0">Onboard Activities</a><a href="/shore-excursions">Shore Excursions</a><a href="/cruise-from" tabindex="0">Departure Ports</a></div><div class = "globalNavSecondaryLinkContainer"><span>Onboard Packages</span><a href="/drink-packages" tabindex="0">Beverage Packages</a><a href="/internet-plans" tabindex="0">Internet Plans</a><a href="/funshops" tabindex="0">In-Room Gifts & Shopping</a></div><div class = "globalNavSecondaryLinkContainer"><span>More Planning Options</span><a href="https://help.carnival.com/app/answers/detail/a_id/3861/~/what-does-the-price-of-my-cruise-include%3F" tabindex="0">What' + singleQuote + 's Included</a><a href="/personal-vacation-planners">Request Carnival Planner</a><a href="/airport-transfers" tabindex="0">Airport Transportation</a><a href="/wedding-cruises">Weddings & Honeymoons</a><a href="/fly2fun" tabindex="0">Fly2Fun</a><a href="/awaywego">Away We Go Blog</a><a href="/help" tabindex="0">FAQs</a></div><div class = "globalNavSecondaryLinkContainer"><span>Featured Cruises</span><a href="/cruise-from/florida" tabindex="0">Cruises From Florida</a><a href="/cruise-search?lastminute" tabindex="0">Last-Minute Cruises</a></div></div>');
            }
 
            function navourShips() {
                $('.globalNavSecondary div').remove();
                $('.globalNavDesktopContainer>button:not(.globalNavOurShips)').removeClass('activeLink');
                $('.globalNavOurShips').addClass('activeLink');
                $('.globalNavDesktopContainer>button:not(.globalNavOurShips)').attr('aria-expanded','false');
                $('.globalNavOurShips').attr('aria-expanded', 'true');
                $('.globalNavSecondary').append('<div class="globalNavSecondaryOurShips"><div class = "globalNavSecondaryLinkContainer navSecondaryMainContainer"><span>Explore Our Ships</span><a href="/cruise-ships" tabindex="0">Ships</a><a href="/onboard" tabindex="0">Onboard Activities</a><a href="/dining" tabindex="0">Dining</a><a href="/staterooms" tabindex="0">Staterooms</a></div><div class = "globalNavSecondaryLinkContainer"><span>Things To Do</span><a href="/onboard/cruise-activities" tabindex="0">Activities</a><a href="/onboard/bars" tabindex="0">Bars</a><a href="/onboard/casino" tabindex="0">Casino</a><a href="/onboard/cruise-entertainment" tabindex="0">Entertainment</a><a href="/onboard/cruise-events" tabindex="0">Events</a><a href="/onboard/cruise-activities-for-kids " tabindex="0">Kids & Teens</a><a href="/onboard/outdoor" tabindex="0">Outdoor</a><a href="/onboard/shopping " tabindex="0">Shops</a><a href="/onboard/spa-fitness" tabindex="0">Spa & Fitness</a></div><div class = "globalNavSecondaryLinkContainer"><span>Newest Ships</span><a href="/cruise-ships/carnival-jubilee" tabindex="0">Carnival Jubilee</a><a href="/cruise-ships/carnival-firenze" tabindex="0">Carnival Firenze</a><a href="/cruise-ships/carnival-venezia" tabindex="0">Carnival Venezia</a><a href="/cruise-ships/carnival-celebration" tabindex="0">Carnival Celebration</a><a href="/cruise-ships/carnival-luminosa" tabindex="0">Carnival Luminosa</a></div></div>');
            }
 
            function navDestinations() {
                $('.globalNavSecondary div').remove();
                $('.globalNavDesktopContainer>button:not(.globalNavDestinations)').removeClass('activeLink');
                $('.globalNavDestinations').addClass('activeLink');
                $('.globalNavDesktopContainer>button:not(.globalNavDestinations)').attr('aria-expanded','false');
                $('.globalNavDestinations').attr('aria-expanded', 'true');
                $('.globalNavSecondary').append('<div class="globalNavSecondaryDestinations"><div class="globalNavSecondaryLinkContainer navSecondaryMainContainer"><span>Explore Destinations</span><a href="/cruise-to" tabindex="0">All Destinations</a><a href="/shore-excursions" tabindex="0">Shore Excursions</a><a href="/cruise-from">Departure Ports</a></div><div class="globalNavSecondaryLinkContainer"><span>Americas</span><a href="/cruise-to/alaska-cruises" tabindex="0">Alaska</a><a href="/cruise-to/bahamas-cruises" tabindex="0">The Bahamas</a><a href="/cruise-to/bermuda-cruises" tabindex="0">Bermuda</a><a href="/cruise-to/canada-new-england-cruises" tabindex="0">Canada & New England</a><a href="/cruise-to/caribbean-cruises" tabindex="0">Caribbean</a><a href="/cruise-to/greenland-canada-cruises" tabindex="0">Greenland & Canada</a><a href="/cruise-to/hawaii-cruises" tabindex="0">Hawaii</a><a href="/cruise-to/mexico-cruises" tabindex="0">Mexico</a><a href="/cruise-to/panama-canal-cruises" tabindex="0">Panama Canal</a></div><div class="globalNavSecondaryLinkContainer"><span>Australia & South Pacific</span><a href="/cruise-to/australia-cruises" tabindex="0">Australia</a><a href="/cruise-to/new-zealand-cruises" tabindex="0">New Zealand</a><a href="/cruise-to/south-pacific-cruises" tabindex="0">South Pacific</a></div><div class="globalNavSecondaryLinkContainer"><span>Europe & Asia</span><a href="/cruise-to/asia-cruises" tabindex="0">Asia</a><a href="/cruise-to/europe-cruises" tabindex="0">Europe</a><a href="/cruise-to/transatlantic-cruises" tabindex="0">Transatlantic</a><a href="/cruise-to/transpacific-cruises" tabindex="0">Transpacific</a></div><div class ="globalNavSecondaryLinkContainer"><span>Featured Destinations</span><a href="/celebration-key" tabindex="0">Celebration Key</a><a tabindex="0" href="/cruise-to/caribbean-cruises/amber-cove-cruises">Amber Cove</a><a tabindex="0" href="/cruise-to/caribbean-cruises/grand-turk-cruises">Grand Turk</a><a href="/cruise-to/bahamas-cruises/half-moon-cay-cruises" tabindex="0">Half Moon Cay</a><a tabindex="0" href="/cruise-to/caribbean-cruises/mahogany-bay-cruises">Mahogany Bay</a><a tabindex="0" href="/cruise-to/bahamas-cruises/princess-cays-cruises">Princess Cays</a><a tabindex="0" href="/cruise-to/mexico-cruises/cozumel-cruises">Puerta Maya at Cozumel</a></div></div>');
            }
 
            function navDeals() {
                $('.globalNavSecondary div').remove();
                $('.globalNavDesktopContainer>button:not(.globalNavDeals)').removeClass('activeLink');
                $('.globalNavDeals').addClass('activeLink');
                $('.globalNavDesktopContainer>button:not(.globalNavDeals)').attr('aria-expanded','false');
                $('.globalNavDeals').attr('aria-expanded', 'true');
                $('.globalNavSecondary').append('<div class="globalNavSecondaryDeals"><span>Explore Deals</span><a href="/cruise-deals" tabindex="0">All Cruise Deals</a><a></a></div>');
            }
 
            function navVifp() {
                $('.globalNavSecondary div').remove();
                $('.globalNavDesktopContainer>button:not(.globalNavVIFP)').removeClass('activeLink');
                $('.globalNavVIFP').addClass('activeLink');
                $('.globalNavDesktopContainer>button:not(.globalNavVIFP)').attr('aria-expanded','false');
                $('.globalNavVIFP').attr('aria-expanded', 'true');
                $('.globalNavSecondary').append('<div class="globalNavSecondaryVIFP"><span>Explore VIFP</span><a href="/vifp/overview" tabindex="0">What It Is</a><a href="/vifp/benefits" tabindex="0">What You Get</a><a href="/vifp/how-it-works" tabindex="0">How It Works</a></div>');
            }
 
            function bookingNav() {
                $('.globalNavSecondary div').remove();
                $('.globalNavDesktopContainer>button:not(.myBookingNav)').removeClass('activeLink');
                $('.myBookingNav').addClass('activeLink');
                $('.globalNavDesktopContainer>button:not(.myBookingNav)').attr('aria-expanded','false');
                $('.myBookingNav').attr('aria-expanded', 'true');
                $('.globalNavSecondary').append('<div class="globalNavSecondaryManageMyBooking"><div class="secondaryNaveManageMyBooking"><span>Manage Your Bookings</span><a class="makePaymentLink" href="/quickpay" tabindex="0">Make a Payment</a><a class="myBookingLink" href="/booked/planner" tabindex="0">My Bookings</a><a class="giftsAndShoppingLink" href="/funshops" tabindex="0">In-Room Gifts & Shopping</a><a class="onlineCheckinLink" href="/booked/details" tabindex="0">Online Check-In</a></div><div class="secondaryNaveManageMyBooking"><span>Getting There</span><a class="flyLink" href="/fly2fun" tabindex="0">Fly2Fun</a><a class="travelDocumentLink" href="/help?topicid=3409" tabindex="0">Travel Documentation</a><a class="portLink" href="/airport-transfers" tabindex="0">Airport Transportation</a></div></div>');
            }
    
            $(document).on('mouseover', '.globalNavDesktopContainer>button', function (e) {
                $('.globalNavSecondary').addClass('active');
                $('.globalNavSecondary').attr('aria-expanded', 'true');
                $('.globalNavSecondaryBackgroundDrop').addClass('active');
    
                // mouseOver press sub category
                if (e.target === document.querySelector('.globalNavPlan')) {
                    navPlanFunction();
                } else if (e.target === document.querySelector('.globalNavOurShips')) {
                    navourShips();
                } else if (e.target === document.querySelector('.globalNavDestinations')) {
                    navDestinations();
                } else if (e.target === document.querySelector('.globalNavDeals')) {
                    navDeals();
                } else if (e.target === document.querySelector('.globalNavVIFP')) {
                    navVifp();
                } else if (e.target === document.querySelector('.myBookingNav')) {
                    bookingNav();
                }
            });

            $(".globalNavPlan").bind("click", function(e) {
                if (e.type === "click") {
                    $('.globalNavSecondary').addClass('active');
                    $('.globalNavSecondary').attr('aria-expanded', 'true');
                    $('.globalNavSecondaryBackgroundDrop').addClass('active');
                    navPlanFunction();
                    $('.globalNavSecondaryPlan a:first').focus();
                }
            });

            $(".globalNavOurShips").bind("click", function(e) {
                if (e.type === "click") {
                    $('.globalNavSecondary').addClass('active');
                    $('.globalNavSecondary').attr('aria-expanded', 'true');
                    $('.globalNavSecondaryBackgroundDrop').addClass('active');
                    navourShips();
                    $('.globalNavSecondaryOurShips a:first').focus();
                }
            });

            $(".globalNavDestinations").bind("click", function(e) {
                if (e.type === "click") {
                    $('.globalNavSecondary').addClass('active');
                    $('.globalNavSecondary').attr('aria-expanded', 'true');
                    $('.globalNavSecondaryBackgroundDrop').addClass('active');
                    navDestinations();
                    $('.globalNavSecondaryDestinations a:first').focus();
                }
            });

            $(".globalNavDeals").bind("click", function(e) {
                if (e.type === "click") {
                    $('.globalNavSecondary').addClass('active');
                    $('.globalNavSecondary').attr('aria-expanded', 'true');
                    $('.globalNavSecondaryBackgroundDrop').addClass('active');
                    navDeals();
                    $('.globalNavSecondaryDeals a:first').focus();
                }
            });

            $(".globalNavVIFP").bind("click", function(e) {
                if (e.type === "click") {
                    $('.globalNavSecondary').addClass('active');
                    $('.globalNavSecondary').attr('aria-expanded', 'true');
                    $('.globalNavSecondaryBackgroundDrop').addClass('active');
                    navVifp();
                    $('.globalNavSecondaryVIFP a:first').focus();
                }
            });

            $(".myBookingNav").bind("click", function(e) {
                if (e.type === "click") {
                    $('.globalNavSecondary').addClass('active');
                    $('.globalNavSecondary').attr('aria-expanded', 'true');
                    $('.globalNavSecondaryBackgroundDrop').addClass('active');
                    bookingNav();
                    $('.globalNavSecondaryManageMyBooking a:first').focus();
                }
            });

            $(document).on('keydown', function (e) {
                if (e.key === "Escape") { 
                    // main nav
                    $('.globalNavSecondary, .globalNavSecondaryBackgroundDrop').removeClass('active');
                    $('.globalNavDesktopContainer button').removeClass('activeLink');
                    $('.globalNavDesktopContainer button, .globalNavSecondary').attr('aria-expanded', 'false');  

                    // profile menu
                    $('.profileBookingManagementContainer').removeClass('showPMContainer');
                    $('.profileBookingManagementContainer').attr('aria-expanded', 'false');
                    $('.loggedInLinkContainer').removeClass('activeBellMessageContainer');
                    $('.loggedInLinkContainer').attr('aria-expanded', 'false');

                    // notification menu
                    $('.profileNtoficiationContainer').removeClass('showPMContainer');
                    $('.profileNtoficiationContainer').attr('aria-expanded', 'false');
                    $('.loggedInNotificationCenter').removeClass('activeBellMessageContainer');
                    $('.loggedInNotificationCenter').attr('aria-expanded', 'false'); 
                }
            });

            $(document).on('keydown', '.manageProfileNav', function (e) {
                if (e.shiftKey && e.key === 'Tab') {
                    $('.profileBookingManagementContainer').removeClass('showPMContainer');
                    $('.loggedInLinkContainer').removeClass('activeBellMessageContainer');
                    $('.loggedInNotificationCenter').focus();
                    $('.profileBookingManagementContainer, .loggedInLinkContainer').attr('aria-expanded', 'false');
                } 
            });

            $(document).on('keydown', '.profileBookingContainer a', function (e) {
                if (e.key === "Escape") {
                    $('.loggedInLinkContainer').focus();
                    $('.profileBookingManagementContainer, .loggedInLinkContainer').attr('aria-expanded', 'false');
                } 
            });

            $(document).on('keydown', '.notificationsAnchor', function (e) {
                if (e.shiftKey && e.key === 'Tab') {
                    $('.loggedInNotificationCenter').attr('aria-expanded', 'false');
                    setTimeout(function () {
                        $('.loggedInNotificationCenter').focus();
                    }, 5);
                } if (e.key === "Escape") {
                    $('.loggedInNotificationCenter').focus();
                    $('.loggedInNotificationCenter').attr('aria-expanded', 'false');
                }
            });
    
            $(document).on('keydown', '.globalNavSecondary a', function (e) {
                // tab focus change
                if (e.target === document.querySelector('.globalNavSecondaryPlan a') && (e.shiftKey && e.key === 'Tab')) {
                    $('.globalNavOurShips').focus();
                    $('.globalNavSecondary, .globalNavSecondaryBackgroundDrop').removeClass('active');
                    $('.globalNavDesktopContainer button').removeClass('activeLink');
                    $('.globalNavPlan, .globalNavSecondary').attr('aria-expanded', 'false');   
                } else if (e.target === document.querySelector('.globalNavSecondaryOurShips a') && (e.shiftKey && e.key === 'Tab')) {
                    $('.globalNavDestinations').focus();
                    $('.globalNavSecondary, .globalNavSecondaryBackgroundDrop').removeClass('active');
                    $('.globalNavDesktopContainer button').removeClass('activeLink');
                    $('.globalNavOurShips, .globalNavSecondary').attr('aria-expanded', 'false');
                } else if (e.target === document.querySelector('.globalNavSecondaryDestinations a') && (e.shiftKey && e.key === 'Tab')) {
                    $('.globalNavDeals').focus();
                    $('.globalNavSecondary, .globalNavSecondaryBackgroundDrop').removeClass('active');
                    $('.globalNavDesktopContainer button').removeClass('activeLink');
                    $('.globalNavDestinations, .globalNavSecondary').attr('aria-expanded', 'false');
                } else if (e.target === document.querySelector('.globalNavSecondaryDeals a') && (e.shiftKey && e.key === 'Tab')) {
                    $('.globalNavDeals').focus();
                    $('.globalNavSecondary, .globalNavSecondaryBackgroundDrop').removeClass('active');
                    $('.globalNavDesktopContainer button').removeClass('activeLink');
                    $('.globalNavDeals, .globalNavSecondary').attr('aria-expanded', 'false');
                } else if (e.target === document.querySelector('.globalNavSecondaryVIFP a') && (e.shiftKey && e.key === 'Tab')) {
                    $('.myBookingNav').focus();
                    $('.globalNavSecondary, .globalNavSecondaryBackgroundDrop').removeClass('active'); 
                    $('.globalNavDesktopContainer button').removeClass('activeLink');
                    $('.globalNavVIFP, .globalNavSecondary').attr('aria-expanded', 'false');
                }  else if (e.target === document.querySelector('.globalNavSecondaryManageMyBooking a') && (e.shiftKey && e.key === 'Tab')) {
                    $('.globalNavSearchLink').focus();
                    $('.globalNavSecondary, .globalNavSecondaryBackgroundDrop').removeClass('active');
                    $('.globalNavDesktopContainer button').removeClass('activeLink');
                    $('.myBookingNav, .globalNavSecondary').attr('aria-expanded', 'false');
                }  
                
                // escape
                document.querySelectorAll('.globalNavSecondaryPlan a').forEach(function (planCruise) { 
                    if (e.target === planCruise && (e.key === "Escape")) {
                        $('.globalNavPlan').focus();
                    } 
                });

                document.querySelectorAll('.globalNavSecondaryOurShips a').forEach(function (ourShips) {
                    if (e.target === ourShips && (e.key === "Escape")) {
                        $('.globalNavOurShips').focus();
                    } 
                });

                document.querySelectorAll('.globalNavSecondaryDestinations a').forEach(function (destinations) {
                    if (e.target === destinations && (e.key === "Escape")) {
                        $('.globalNavDestinations').focus();
                    }
                });

                document.querySelectorAll('.globalNavSecondaryDeals a').forEach(function (deals) {
                    if (e.target === deals && (e.key === "Escape")) {
                        $('.globalNavDeals').focus();
                    }
                });

                document.querySelectorAll('.globalNavSecondaryVIFP a').forEach(function (vifp) {
                    if (e.target === vifp && (e.key === "Escape")) {
                        $('.globalNavVIFP').focus();
                    } 
                });

                document.querySelectorAll('.globalNavSecondaryManageMyBooking a').forEach(function (manageBooking) {
                    if (e.target ===  manageBooking && (e.key === "Escape")) {
                        $('.myBookingNav').focus();
                    }
                });
            });

            $(document).on('keydown', '.globalNavSecondary a', function (e) {
                // tab focus change
                if (e.target === document.querySelectorAll('.globalNavSecondaryPlan a')[document.querySelectorAll('.globalNavSecondaryPlan a').length - 1] && e.which == 9) {
                    $('.globalNavPlan').focus();
                    $('.globalNavSecondary, .globalNavSecondaryBackgroundDrop').removeClass('active');
                    $('.globalNavDesktopContainer button').removeClass('activeLink');
                } else if (e.target === document.querySelectorAll('.globalNavSecondaryOurShips a')[document.querySelectorAll('.globalNavSecondaryOurShips a').length - 1] && e.which == 9) {
                    $('.globalNavOurShips').focus();
                    $('.globalNavSecondary, .globalNavSecondaryBackgroundDrop').removeClass('active');
                    $('.globalNavDesktopContainer button').removeClass('activeLink');
                } else if (e.target === document.querySelectorAll('.globalNavSecondaryDestinations a')[document.querySelectorAll('.globalNavSecondaryDestinations a').length - 1] && e.which == 9) {
                    $('.globalNavDestinations').focus();
                    $('.globalNavSecondary, .globalNavSecondaryBackgroundDrop').removeClass('active');
                    $('.globalNavDesktopContainer button').removeClass('activeLink');
                } else if (e.target === document.querySelector('.globalNavSecondaryDeals a') && e.which == 9) {
                    $('.globalNavDeals').focus();
                    $('.globalNavSecondary, .globalNavSecondaryBackgroundDrop').removeClass('active');
                    $('.globalNavDesktopContainer button').removeClass('activeLink');
                } else if (e.target === document.querySelectorAll('.globalNavSecondaryVIFP a')[document.querySelectorAll('.globalNavSecondaryVIFP a').length - 1] && e.which == 9) {
                    $('.globalNavVIFP').focus();
                    $('.globalNavSecondary, .globalNavSecondaryBackgroundDrop').removeClass('active'); 
                    $('.globalNavDesktopContainer button').removeClass('activeLink');
                }  else if (e.target === document.querySelectorAll('.globalNavSecondaryManageMyBooking a')[document.querySelectorAll('.globalNavSecondaryManageMyBooking a').length - 1] && e.which == 9) {
                    $('.globalNavSecondaryManageMyBooking').focus();
                    $('.globalNavSecondary, .globalNavSecondaryBackgroundDrop').removeClass('active');
                    $('.globalNavDesktopContainer button').removeClass('activeLink');
                }  
            });

            $(document).on('keydown swipe', '.navPostCruise', function (e) {
                if(e.which === 9 ) {
                    $('.loggedInLinkContainer').focus();
                    $('.loggedInLinkContainer').removeClass('activeBellMessageContainer');
                    $('.profileBookingManagementContainer').removeClass('showPMContainer');
                    $('.profileBookingManagementContainer, .loggedInLinkContainer').attr('aria-expanded', 'false');
                }
            });

            $(document).on('keydown swipe', '.notificationsAnchor', function (e) {
                if(e.which === 9 || e.key === "Escape") {
                    $('.profileNtoficiationContainer').removeClass('showPMContainer');
                    $('.profileNtoficiationContainer, .loggedInNotificationCenter').attr('aria-expanded', 'false');
                    $('.loggedInNotificationCenter').removeClass('activeBellMessageContainer');
                } if(e.key === "Escape") {
                    $('.loggedInNotificationCenter').focus();
                } if (e.which === 9) {
                    $('.loggedInNotificationCenter ').focus();
                }
            });
    
            $('.globalNavSecondary, .globalNavDesktopContainer').on('mouseleave', function (e) {
                $('.globalNavSecondary').removeClass('active');
                $('.globalNavSecondary').attr('aria-expanded', 'false');
                $('.globalNavSecondaryBackgroundDrop').removeClass('active');
                // $('.globalNavSecondary div').remove();
                $('.globalNavDesktopContainer>button').removeClass('activeLink');
                $('.globalNavDesktopContainer>button').attr('aria-expanded', 'false');
            });
    
            // booked cruise
            var sailingInfo;
    
            var bookedCruises = [];
            var messagesCount = [];
    
            function bookedSailing(bookedCruises) {
                console.log(bookedCruises);
            }
    
    
            if ($('[data-testid="login"]').length > 0) {
                $('.cgh-header__profile-menu--desktop [data-testid="login"]').html('<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" style="margin-right: 4px;" aria-hidden="true"><path d="M11.5 6.44938C9.50664 6.44938 7.89062 8.0146 7.89062 9.94531C7.89062 11.876 9.50664 13.4412 11.5 13.4412C13.4934 13.4412 15.1094 11.876 15.1094 9.94531C15.1094 8.0146 13.4934 6.44938 11.5 6.44938ZM11.5 11.5344C10.5952 11.5344 9.85938 10.8213 9.85938 9.94531C9.85938 9.06736 10.5936 8.35625 11.5 8.35625C12.4064 8.35625 13.1406 9.06894 13.1406 9.94531C13.1406 10.8233 12.4064 11.5344 11.5 11.5344ZM11.5 2C5.70039 2 1 6.55266 1 12.17C1 17.7873 5.70039 22.34 11.5 22.34C17.2996 22.34 22 17.7873 22 12.17C22 6.55266 17.2996 2 11.5 2ZM11.5 20.4331C9.58334 20.4331 7.81844 19.8102 6.39355 18.773C7.10313 17.4536 8.48125 16.6194 10.0316 16.6194H12.9721C14.5204 16.6194 15.8969 17.454 16.6093 18.773C15.1832 19.8094 13.4154 20.4331 11.5 20.4331ZM18.0707 17.4338C16.9633 15.7573 15.0766 14.7125 12.9684 14.7125H10.0316C7.92508 14.7125 6.03877 15.7553 4.9293 17.433C3.70539 16.0036 2.96875 14.1682 2.96875 12.17C2.96875 7.61336 6.79592 3.90688 11.5 3.90688C16.2041 3.90688 20.0312 7.61376 20.0312 12.17C20.0312 14.1682 19.293 16.0036 18.0707 17.4338Z" fill="white"/></svg>Log In');
                $('[data-testid="login"]').attr('role', 'button');
    
                $('.cgh-header__secondary-menu-right').append($('.cgh-header__profile-menu--desktop [data-testid="login"]'));

            } else {
                utils.waitForElement('[data-testid="user-name"]').then(function () {
                    var userName = $('[data-testid="user-name"]:eq(0)').text();
                    if($('.loggedinContainer').length < 1) {

                        $('<div class="loggedinContainer"><a class="loggedInLinkContainer" tabindex="0" role="button" aria-expanded="false" aria-label="Ahoy, '+userName+' Profile menu"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 32 32" fill="none" aria-hidden="true"><path d="M15.3333 8.59917C12.6754 8.59917 10.5208 10.6861 10.5208 13.2604C10.5208 15.8347 12.6754 17.9217 15.3333 17.9217C17.9911 17.9217 20.1458 15.8347 20.1458 13.2604C20.1458 10.6861 17.9911 8.59917 15.3333 8.59917ZM15.3333 15.3792C14.1268 15.3792 13.1458 14.4284 13.1458 13.2604C13.1458 12.0898 14.1247 11.1417 15.3333 11.1417C16.5418 11.1417 17.5208 12.0919 17.5208 13.2604C17.5208 14.431 16.5418 15.3792 15.3333 15.3792ZM15.3333 2.66667C7.60044 2.66667 1.33325 8.73689 1.33325 16.2267C1.33325 23.7164 7.60044 29.7867 15.3333 29.7867C23.0661 29.7867 29.3333 23.7164 29.3333 16.2267C29.3333 8.73689 23.0661 2.66667 15.3333 2.66667ZM15.3333 27.2442C12.7777 27.2442 10.4245 26.4136 8.52466 25.0306C9.47075 23.2715 11.3083 22.1592 13.3754 22.1592H17.296C19.3604 22.1592 21.1958 23.272 22.1457 25.0306C20.2442 26.4126 17.8872 27.2442 15.3333 27.2442ZM24.0942 23.245C22.6176 21.0097 20.102 19.6167 17.2911 19.6167H13.3754C10.5667 19.6167 8.05161 21.0071 6.57231 23.244C4.94044 21.3382 3.95825 18.891 3.95825 16.2267C3.95825 10.1512 9.06114 5.20917 15.3333 5.20917C21.6054 5.20917 26.7083 10.1517 26.7083 16.2267C26.7083 18.891 25.7239 21.3382 24.0942 23.245Z" fill="white"/></svg><span class="loggedInName">Ahoy, <div>' + userName + '</div></span></a><a class="loggedInNotificationCenter" tabindex="0" role="button" aria-expanded="false" aria-label="Notification Menu"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" aria-hidden="true"><path fill-rule="evenodd" clip-rule="evenodd" d="M11.9559 -9.91821e-05C16.8479 -9.91821e-05 20.8456 4.08781 20.8456 9.09016V12.7018C22.6348 13.0319 24 14.6391 24 16.5612V17.3976C24 19.557 22.2769 21.3191 20.1651 21.3191L14.4656 21.3188C14.4788 21.4212 14.4856 21.5256 14.4856 21.6317C14.4856 22.94 13.4491 23.9999 12.1697 23.9999C10.8903 23.9999 9.85259 22.94 9.85259 21.6317C9.85259 21.5256 9.85941 21.4212 9.87263 21.3188L3.83487 21.3191C1.72312 21.3191 0 19.557 0 17.3976V16.5612C0 14.7464 1.21699 13.2124 2.85888 12.7689L3.06627 12.7192V9.09016C3.06627 4.08781 7.06397 -9.91821e-05 11.9559 -9.91821e-05ZM11.9559 2.3687C8.34335 2.3687 5.38279 5.39606 5.38279 9.09016V15.0086H3.83487C3.0025 15.0086 2.31652 15.7101 2.31652 16.5612V17.3976C2.31652 18.2488 3.0025 18.9503 3.83487 18.9503H20.1651C20.9975 18.9503 21.6835 18.2488 21.6835 17.3976V16.5612C21.6835 15.7101 20.9975 15.0086 20.1651 15.0086H18.5291V9.09016C18.5291 5.39606 15.5685 2.3687 11.9559 2.3687Z" fill="white"/></svg></a></div>').insertAfter($('.cgh-header__secondary-menu-options'));
                        $('.cgh-header__secondary-menu-right').attr('style', 'position: absolute; right: 0;');
                        var fontSize = 12;
                        var test = document.querySelector('.loggedInName div');
                        test.style.fontSize = fontSize;
                        var height = (test.clientHeight + 1) + "px";
                        var width = (test.offsetWidth + 1);
    
                        if(width > 139) {
                            $('.loggedInName').text($('.loggedInName').text().split(',')[1]);
                        }
                    }
                });
    
                utils.waitForElement('.loggedinContainer').then(function () {
    
                    $.ajax({
                        url: 'https://www.carnival.com/shop/webinbox/messagecount', // Replace with your API endpoint
                        type: 'GET', // or 'POST', 'PUT', etc.
                        async: true,
                        dataType: 'json', // Expected data type from the server
                        success: function (response) {
                            messagesCount = response;
                            // if(messagesCount.unread === 0) {
                            console.log('$test messages', messagesCount.unread.toString());
                            $('.loggedinContainer').append('<div class="profileNtoficiationContainer" role="menuitem"><div class="profileNotContainer"><span class="notificationHeadline">Notifications ('+messagesCount.unread+')</span><span class="messageInbox">You have '+messagesCount.unread+' messages in your inbox.</span><span class="messageSubTitle">Tap here to read them</span><a class ="notificationsAnchor" tabindex="0" href="/inbox">View all notifications</a></div></div>');

                            utils.waitForElement('.loggedInNotificationCenter').then(function () {
                                if(messagesCount.unread === 1) {
                                    $('.loggedInNotificationCenter').html('<svg xmlns="http://www.w3.org/2000/svg" width="34" height="28" viewBox="0 0 34 28" fill="none" aria-hidden="true"><path fill-rule="evenodd" clip-rule="evenodd" d="M12.1881 5.9999C16.3567 5.9999 19.7633 9.40649 19.7633 13.5751V16.5849C21.288 16.8599 22.4513 18.1993 22.4513 19.801V20.498C22.4513 22.2975 20.983 23.7659 19.1835 23.7659L14.3267 23.7657C14.338 23.851 14.3438 23.938 14.3438 24.0264C14.3438 25.1167 13.4605 25.9999 12.3703 25.9999C11.28 25.9999 10.3958 25.1167 10.3958 24.0264C10.3958 23.938 10.4016 23.851 10.4128 23.7657L5.26784 23.7659C3.46834 23.7659 2 22.2975 2 20.498V19.801C2 18.2887 3.03704 17.0103 4.43616 16.6407L4.61289 16.5993V13.5751C4.61289 9.40649 8.01948 5.9999 12.1881 5.9999ZM12.1881 7.9739C9.10969 7.9739 6.58688 10.4967 6.58688 13.5751V18.5071H5.26784C4.55855 18.5071 3.974 19.0917 3.974 19.801V20.498C3.974 21.2073 4.55855 21.7919 5.26784 21.7919H19.1835C19.8928 21.7919 20.4773 21.2073 20.4773 20.498V19.801C20.4773 19.0917 19.8928 18.5071 19.1835 18.5071H17.7893V13.5751C17.7893 10.4967 15.2665 7.9739 12.1881 7.9739Z" fill="white"/><path d="M10.0001 9C10.0001 4.02944 14.0295 0 19.0001 0H25.0001C29.9707 0 34.0001 4.02944 34.0001 9C34.0001 13.9706 29.9707 18 25.0001 18H19.0001C14.0295 18 10.0001 13.9706 10.0001 9Z" fill="#DC1125"/><path d="M24.0235 13H22.213V8.04297C22.213 7.90625 22.2149 7.73828 22.2188 7.53906C22.2228 7.33594 22.2286 7.12891 22.2364 6.91797C22.2442 6.70312 22.2521 6.50977 22.2599 6.33789C22.2169 6.38867 22.129 6.47656 21.9962 6.60156C21.8673 6.72266 21.7462 6.83203 21.6329 6.92969L20.6485 7.7207L19.7755 6.63086L22.5353 4.43359H24.0235V13Z" fill="white"/></svg>')
                                } else if (messagesCount.unread === 2) {
                                    $('.loggedInNotificationCenter').html('<svg xmlns="http://www.w3.org/2000/svg" width="34" height="28" viewBox="0 0 34 28" fill="none" aria-hidden="true"><path fill-rule="evenodd" clip-rule="evenodd" d="M12.1881 5.9999C16.3567 5.9999 19.7633 9.40649 19.7633 13.5751V16.5849C21.288 16.8599 22.4513 18.1993 22.4513 19.801V20.498C22.4513 22.2975 20.983 23.7659 19.1835 23.7659L14.3267 23.7657C14.338 23.851 14.3438 23.938 14.3438 24.0264C14.3438 25.1167 13.4605 25.9999 12.3703 25.9999C11.28 25.9999 10.3958 25.1167 10.3958 24.0264C10.3958 23.938 10.4016 23.851 10.4128 23.7657L5.26784 23.7659C3.46834 23.7659 2 22.2975 2 20.498V19.801C2 18.2887 3.03704 17.0103 4.43616 16.6407L4.61289 16.5993V13.5751C4.61289 9.40649 8.01948 5.9999 12.1881 5.9999ZM12.1881 7.9739C9.10969 7.9739 6.58688 10.4967 6.58688 13.5751V18.5071H5.26784C4.55855 18.5071 3.974 19.0917 3.974 19.801V20.498C3.974 21.2073 4.55855 21.7919 5.26784 21.7919H19.1835C19.8928 21.7919 20.4773 21.2073 20.4773 20.498V19.801C20.4773 19.0917 19.8928 18.5071 19.1835 18.5071H17.7893V13.5751C17.7893 10.4967 15.2665 7.9739 12.1881 7.9739Z" fill="white"/><path d="M10.0001 9C10.0001 4.02944 14.0295 0 19.0001 0H25.0001C29.9707 0 34.0001 4.02944 34.0001 9C34.0001 13.9706 29.9707 18 25.0001 18H19.0001C14.0295 18 10.0001 13.9706 10.0001 9Z" fill="#DC1125"/><path d="M25.5353 13H19.547V11.7402L21.6974 9.56641C22.131 9.12109 22.4786 8.75 22.7403 8.45312C23.006 8.15234 23.1974 7.87891 23.3146 7.63281C23.4356 7.38672 23.4962 7.12305 23.4962 6.8418C23.4962 6.50195 23.4005 6.24805 23.2091 6.08008C23.0216 5.9082 22.7696 5.82227 22.4532 5.82227C22.1212 5.82227 21.7989 5.89844 21.4864 6.05078C21.1739 6.20312 20.8478 6.41992 20.5079 6.70117L19.5235 5.53516C19.7696 5.32422 20.0294 5.125 20.3028 4.9375C20.5802 4.75 20.9005 4.59961 21.2638 4.48633C21.631 4.36914 22.0704 4.31055 22.5821 4.31055C23.1446 4.31055 23.6271 4.41211 24.0294 4.61523C24.4356 4.81836 24.7481 5.0957 24.9669 5.44727C25.1856 5.79492 25.295 6.18945 25.295 6.63086C25.295 7.10352 25.2013 7.53516 25.0138 7.92578C24.8263 8.31641 24.5528 8.70312 24.1935 9.08594C23.838 9.46875 23.4083 9.89258 22.9044 10.3574L21.8028 11.3945V11.4766H25.5353V13Z" fill="white"/></svg>')
                                } else if (messagesCount.unread === 3) {
                                    $('.loggedInNotificationCenter').html('<svg xmlns="http://www.w3.org/2000/svg" width="34" height="28" viewBox="0 0 34 28" fill="none" aria-hidden="true"><path fill-rule="evenodd" clip-rule="evenodd" d="M12.1881 5.9999C16.3567 5.9999 19.7633 9.40649 19.7633 13.5751V16.5849C21.288 16.8599 22.4513 18.1993 22.4513 19.801V20.498C22.4513 22.2975 20.983 23.7659 19.1835 23.7659L14.3267 23.7657C14.338 23.851 14.3438 23.938 14.3438 24.0264C14.3438 25.1167 13.4605 25.9999 12.3703 25.9999C11.28 25.9999 10.3958 25.1167 10.3958 24.0264C10.3958 23.938 10.4016 23.851 10.4128 23.7657L5.26784 23.7659C3.46834 23.7659 2 22.2975 2 20.498V19.801C2 18.2887 3.03704 17.0103 4.43616 16.6407L4.61289 16.5993V13.5751C4.61289 9.40649 8.01948 5.9999 12.1881 5.9999ZM12.1881 7.9739C9.10969 7.9739 6.58688 10.4967 6.58688 13.5751V18.5071H5.26784C4.55855 18.5071 3.974 19.0917 3.974 19.801V20.498C3.974 21.2073 4.55855 21.7919 5.26784 21.7919H19.1835C19.8928 21.7919 20.4773 21.2073 20.4773 20.498V19.801C20.4773 19.0917 19.8928 18.5071 19.1835 18.5071H17.7893V13.5751C17.7893 10.4967 15.2665 7.9739 12.1881 7.9739Z" fill="white"/><path d="M10.0001 9C10.0001 4.02944 14.0295 0 19.0001 0H25.0001C29.9707 0 34.0001 4.02944 34.0001 9C34.0001 13.9706 29.9707 18 25.0001 18H19.0001C14.0295 18 10.0001 13.9706 10.0001 9Z" fill="#DC1125"/><path d="M25.2013 6.34961C25.2013 6.74414 25.1192 7.08594 24.9552 7.375C24.7911 7.66406 24.5685 7.90039 24.2872 8.08398C24.0099 8.26758 23.6974 8.40234 23.3497 8.48828V8.52344C24.0372 8.60938 24.5587 8.82031 24.9142 9.15625C25.2735 9.49219 25.4532 9.94141 25.4532 10.5039C25.4532 11.0039 25.3302 11.4512 25.0841 11.8457C24.8419 12.2402 24.4669 12.5508 23.9591 12.7773C23.4513 13.0039 22.797 13.1172 21.9962 13.1172C21.5235 13.1172 21.0821 13.0781 20.672 13C20.2657 12.9258 19.8829 12.8105 19.5235 12.6543V11.1133C19.8907 11.3008 20.2755 11.4434 20.6778 11.541C21.0802 11.6348 21.4552 11.6816 21.8028 11.6816C22.4513 11.6816 22.9044 11.5703 23.1622 11.3477C23.4239 11.1211 23.5548 10.8047 23.5548 10.3984C23.5548 10.1602 23.4942 9.95898 23.3731 9.79492C23.2521 9.63086 23.0411 9.50586 22.7403 9.41992C22.4435 9.33398 22.0274 9.29102 21.4923 9.29102H20.8419V7.90234H21.504C22.0313 7.90234 22.4317 7.85352 22.7052 7.75586C22.9825 7.6543 23.17 7.51758 23.2677 7.3457C23.3692 7.16992 23.42 6.9707 23.42 6.74805C23.42 6.44336 23.3263 6.20508 23.1388 6.0332C22.9513 5.86133 22.6388 5.77539 22.2013 5.77539C21.9278 5.77539 21.6778 5.81055 21.4513 5.88086C21.2286 5.94727 21.0274 6.0293 20.8478 6.12695C20.6681 6.2207 20.5099 6.3125 20.3731 6.40234L19.5353 5.1543C19.8712 4.91211 20.2638 4.71094 20.713 4.55078C21.1661 4.39062 21.7052 4.31055 22.3302 4.31055C23.213 4.31055 23.9122 4.48828 24.4278 4.84375C24.9435 5.19922 25.2013 5.70117 25.2013 6.34961Z" fill="white"/></svg>')
                                } else if (messagesCount.unread === 4) {
                                    $('.loggedInNotificationCenter').html('<svg xmlns="http://www.w3.org/2000/svg" width="34" height="28" viewBox="0 0 34 28" fill="none" aria-hidden="true"><path fill-rule="evenodd" clip-rule="evenodd" d="M12.1881 5.9999C16.3567 5.9999 19.7633 9.40649 19.7633 13.5751V16.5849C21.288 16.8599 22.4513 18.1993 22.4513 19.801V20.498C22.4513 22.2975 20.983 23.7659 19.1835 23.7659L14.3267 23.7657C14.338 23.851 14.3438 23.938 14.3438 24.0264C14.3438 25.1167 13.4605 25.9999 12.3703 25.9999C11.28 25.9999 10.3958 25.1167 10.3958 24.0264C10.3958 23.938 10.4016 23.851 10.4128 23.7657L5.26784 23.7659C3.46834 23.7659 2 22.2975 2 20.498V19.801C2 18.2887 3.03704 17.0103 4.43616 16.6407L4.61289 16.5993V13.5751C4.61289 9.40649 8.01948 5.9999 12.1881 5.9999ZM12.1881 7.9739C9.10969 7.9739 6.58688 10.4967 6.58688 13.5751V18.5071H5.26784C4.55855 18.5071 3.974 19.0917 3.974 19.801V20.498C3.974 21.2073 4.55855 21.7919 5.26784 21.7919H19.1835C19.8928 21.7919 20.4773 21.2073 20.4773 20.498V19.801C20.4773 19.0917 19.8928 18.5071 19.1835 18.5071H17.7893V13.5751C17.7893 10.4967 15.2665 7.9739 12.1881 7.9739Z" fill="white"/><path d="M10.0001 9C10.0001 4.02944 14.0295 0 19.0001 0H25.0001C29.9707 0 34.0001 4.02944 34.0001 9C34.0001 13.9706 29.9707 18 25.0001 18H19.0001C14.0295 18 10.0001 13.9706 10.0001 9Z" fill="#DC1125"/><path d="M25.7286 11.2246H24.6974V13H22.9278V11.2246H19.2716V9.96484L23.0274 4.43359H24.6974V9.81836H25.7286V11.2246ZM22.9278 9.81836V8.36523C22.9278 8.22852 22.9298 8.06641 22.9337 7.87891C22.9415 7.69141 22.9493 7.50391 22.9571 7.31641C22.9649 7.12891 22.9728 6.96289 22.9806 6.81836C22.9923 6.66992 23.0001 6.56641 23.004 6.50781H22.9571C22.8829 6.66797 22.8048 6.82422 22.7228 6.97656C22.6407 7.125 22.545 7.28125 22.4356 7.44531L20.8653 9.81836H22.9278Z" fill="white"/></svg>')
                                } else if (messagesCount.unread === 5) {
                                    $('.loggedInNotificationCenter').html('<svg xmlns="http://www.w3.org/2000/svg" width="34" height="28" viewBox="0 0 34 28" fill="none" aria-hidden="true"><path fill-rule="evenodd" clip-rule="evenodd" d="M12.1881 5.9999C16.3567 5.9999 19.7633 9.40649 19.7633 13.5751V16.5849C21.288 16.8599 22.4513 18.1993 22.4513 19.801V20.498C22.4513 22.2975 20.983 23.7659 19.1835 23.7659L14.3267 23.7657C14.338 23.851 14.3438 23.938 14.3438 24.0264C14.3438 25.1167 13.4605 25.9999 12.3703 25.9999C11.28 25.9999 10.3958 25.1167 10.3958 24.0264C10.3958 23.938 10.4016 23.851 10.4128 23.7657L5.26784 23.7659C3.46834 23.7659 2 22.2975 2 20.498V19.801C2 18.2887 3.03704 17.0103 4.43616 16.6407L4.61289 16.5993V13.5751C4.61289 9.40649 8.01948 5.9999 12.1881 5.9999ZM12.1881 7.9739C9.10969 7.9739 6.58688 10.4967 6.58688 13.5751V18.5071H5.26784C4.55855 18.5071 3.974 19.0917 3.974 19.801V20.498C3.974 21.2073 4.55855 21.7919 5.26784 21.7919H19.1835C19.8928 21.7919 20.4773 21.2073 20.4773 20.498V19.801C20.4773 19.0917 19.8928 18.5071 19.1835 18.5071H17.7893V13.5751C17.7893 10.4967 15.2665 7.9739 12.1881 7.9739Z" fill="white"/><path d="M10.0001 9C10.0001 4.02944 14.0295 0 19.0001 0H25.0001C29.9707 0 34.0001 4.02944 34.0001 9C34.0001 13.9706 29.9707 18 25.0001 18H19.0001C14.0295 18 10.0001 13.9706 10.0001 9Z" fill="#DC1125"/><path d="M22.6642 7.52734C23.1876 7.52734 23.6524 7.62695 24.0587 7.82617C24.4688 8.02539 24.7911 8.31836 25.0255 8.70508C25.2599 9.0918 25.3771 9.56836 25.3771 10.1348C25.3771 10.752 25.2481 11.2852 24.9903 11.7344C24.7364 12.1797 24.3556 12.5215 23.8478 12.7598C23.3438 12.998 22.7149 13.1172 21.961 13.1172C21.5118 13.1172 21.088 13.0781 20.6896 13C20.295 12.9258 19.9493 12.8105 19.6524 12.6543V11.0898C19.9493 11.2461 20.3048 11.3789 20.7188 11.4883C21.1368 11.5938 21.5294 11.6465 21.8966 11.6465C22.256 11.6465 22.5587 11.5996 22.8048 11.5059C23.0509 11.4082 23.2364 11.2598 23.3614 11.0605C23.4903 10.8574 23.5548 10.5996 23.5548 10.2871C23.5548 9.86914 23.4142 9.54883 23.1329 9.32617C22.8517 9.10352 22.42 8.99219 21.838 8.99219C21.6153 8.99219 21.3829 9.01367 21.1407 9.05664C20.9024 9.09961 20.7032 9.14258 20.5431 9.18555L19.8224 8.79883L20.1446 4.43359H24.7911V5.96875H21.7325L21.5743 7.65039C21.7071 7.62305 21.8517 7.5957 22.0079 7.56836C22.1642 7.54102 22.3829 7.52734 22.6642 7.52734Z" fill="white"/></svg>')
                                } else if (messagesCount.unread === 6) {
                                    $('.loggedInNotificationCenter').html('<svg xmlns="http://www.w3.org/2000/svg" width="34" height="28" viewBox="0 0 34 28" fill="none" aria-hidden="true"><path fill-rule="evenodd" clip-rule="evenodd" d="M12.1881 5.9999C16.3567 5.9999 19.7633 9.40649 19.7633 13.5751V16.5849C21.288 16.8599 22.4513 18.1993 22.4513 19.801V20.498C22.4513 22.2975 20.983 23.7659 19.1835 23.7659L14.3267 23.7657C14.338 23.851 14.3438 23.938 14.3438 24.0264C14.3438 25.1167 13.4605 25.9999 12.3703 25.9999C11.28 25.9999 10.3958 25.1167 10.3958 24.0264C10.3958 23.938 10.4016 23.851 10.4128 23.7657L5.26784 23.7659C3.46834 23.7659 2 22.2975 2 20.498V19.801C2 18.2887 3.03704 17.0103 4.43616 16.6407L4.61289 16.5993V13.5751C4.61289 9.40649 8.01948 5.9999 12.1881 5.9999ZM12.1881 7.9739C9.10969 7.9739 6.58688 10.4967 6.58688 13.5751V18.5071H5.26784C4.55855 18.5071 3.974 19.0917 3.974 19.801V20.498C3.974 21.2073 4.55855 21.7919 5.26784 21.7919H19.1835C19.8928 21.7919 20.4773 21.2073 20.4773 20.498V19.801C20.4773 19.0917 19.8928 18.5071 19.1835 18.5071H17.7893V13.5751C17.7893 10.4967 15.2665 7.9739 12.1881 7.9739Z" fill="white"/><path d="M10.0001 9C10.0001 4.02944 14.0295 0 19.0001 0H25.0001C29.9707 0 34.0001 4.02944 34.0001 9C34.0001 13.9706 29.9707 18 25.0001 18H19.0001C14.0295 18 10.0001 13.9706 10.0001 9Z" fill="#DC1125"/><path d="M19.4884 9.36133C19.4884 8.86914 19.5235 8.38281 19.5938 7.90234C19.6681 7.41797 19.795 6.96289 19.9747 6.53711C20.1544 6.10742 20.4063 5.72852 20.7306 5.40039C21.0548 5.06836 21.4669 4.80859 21.9669 4.62109C22.4669 4.42969 23.0724 4.33398 23.7833 4.33398C23.9513 4.33398 24.1466 4.3418 24.3692 4.35742C24.5958 4.36914 24.7833 4.39062 24.9317 4.42188V5.86914C24.7755 5.83398 24.6075 5.80664 24.4278 5.78711C24.2521 5.76367 24.0763 5.75195 23.9005 5.75195C23.1896 5.75195 22.6388 5.86523 22.2481 6.0918C21.8614 6.31836 21.588 6.63281 21.4278 7.03516C21.2716 7.43359 21.1798 7.89844 21.1524 8.42969H21.2286C21.338 8.23828 21.4747 8.06836 21.6388 7.91992C21.8067 7.77148 22.0099 7.6543 22.2481 7.56836C22.4864 7.47852 22.7657 7.43359 23.086 7.43359C23.586 7.43359 24.0196 7.54102 24.3868 7.75586C24.754 7.9668 25.0372 8.27344 25.2364 8.67578C25.4356 9.07812 25.5353 9.56836 25.5353 10.1465C25.5353 10.7637 25.4161 11.2949 25.1778 11.7402C24.9396 12.1855 24.6017 12.5273 24.1642 12.7656C23.7306 13 23.2149 13.1172 22.6173 13.1172C22.1798 13.1172 21.7716 13.043 21.3927 12.8945C21.0138 12.7422 20.6817 12.5117 20.3966 12.2031C20.1114 11.8945 19.8888 11.5059 19.7286 11.0371C19.5685 10.5645 19.4884 10.0059 19.4884 9.36133ZM22.5821 11.6699C22.9376 11.6699 23.2267 11.5488 23.4493 11.3066C23.672 11.0645 23.7833 10.6855 23.7833 10.1699C23.7833 9.75195 23.6856 9.42383 23.4903 9.18555C23.2989 8.94336 23.0079 8.82227 22.6173 8.82227C22.3517 8.82227 22.1173 8.88281 21.9142 9.00391C21.7149 9.12109 21.5606 9.27148 21.4513 9.45508C21.3419 9.63477 21.2872 9.82031 21.2872 10.0117C21.2872 10.2109 21.3146 10.4082 21.3692 10.6035C21.4239 10.7988 21.506 10.9766 21.6153 11.1367C21.7247 11.2969 21.8595 11.4258 22.0196 11.5234C22.1837 11.6211 22.3712 11.6699 22.5821 11.6699Z" fill="white"/></svg>')
                                } else if (messagesCount.unread === 7) {
                                    $('.loggedInNotificationCenter').html('<svg xmlns="http://www.w3.org/2000/svg" width="34" height="28" viewBox="0 0 34 28" fill="none" aria-hidden="true"><path fill-rule="evenodd" clip-rule="evenodd" d="M12.1881 5.9999C16.3567 5.9999 19.7633 9.40649 19.7633 13.5751V16.5849C21.288 16.8599 22.4513 18.1993 22.4513 19.801V20.498C22.4513 22.2975 20.983 23.7659 19.1835 23.7659L14.3267 23.7657C14.338 23.851 14.3438 23.938 14.3438 24.0264C14.3438 25.1167 13.4605 25.9999 12.3703 25.9999C11.28 25.9999 10.3958 25.1167 10.3958 24.0264C10.3958 23.938 10.4016 23.851 10.4128 23.7657L5.26784 23.7659C3.46834 23.7659 2 22.2975 2 20.498V19.801C2 18.2887 3.03704 17.0103 4.43616 16.6407L4.61289 16.5993V13.5751C4.61289 9.40649 8.01948 5.9999 12.1881 5.9999ZM12.1881 7.9739C9.10969 7.9739 6.58688 10.4967 6.58688 13.5751V18.5071H5.26784C4.55855 18.5071 3.974 19.0917 3.974 19.801V20.498C3.974 21.2073 4.55855 21.7919 5.26784 21.7919H19.1835C19.8928 21.7919 20.4773 21.2073 20.4773 20.498V19.801C20.4773 19.0917 19.8928 18.5071 19.1835 18.5071H17.7893V13.5751C17.7893 10.4967 15.2665 7.9739 12.1881 7.9739Z" fill="white"/><path d="M10.0001 9C10.0001 4.02944 14.0295 0 19.0001 0H25.0001C29.9707 0 34.0001 4.02944 34.0001 9C34.0001 13.9706 29.9707 18 25.0001 18H19.0001C14.0295 18 10.0001 13.9706 10.0001 9Z" fill="#DC1125"/><path d="M20.3966 13L23.6134 5.95703H19.3888V4.43359H25.5353V5.57031L22.295 13H20.3966Z" fill="white"/></svg>')
                                } else if (messagesCount.unread === 8) {
                                    $('.loggedInNotificationCenter').html('<svg xmlns="http://www.w3.org/2000/svg" width="34" height="28" viewBox="0 0 34 28" fill="none" aria-hidden="true"><path fill-rule="evenodd" clip-rule="evenodd" d="M12.1881 5.9999C16.3567 5.9999 19.7633 9.40649 19.7633 13.5751V16.5849C21.288 16.8599 22.4513 18.1993 22.4513 19.801V20.498C22.4513 22.2975 20.983 23.7659 19.1835 23.7659L14.3267 23.7657C14.338 23.851 14.3438 23.938 14.3438 24.0264C14.3438 25.1167 13.4605 25.9999 12.3703 25.9999C11.28 25.9999 10.3958 25.1167 10.3958 24.0264C10.3958 23.938 10.4016 23.851 10.4128 23.7657L5.26784 23.7659C3.46834 23.7659 2 22.2975 2 20.498V19.801C2 18.2887 3.03704 17.0103 4.43616 16.6407L4.61289 16.5993V13.5751C4.61289 9.40649 8.01948 5.9999 12.1881 5.9999ZM12.1881 7.9739C9.10969 7.9739 6.58688 10.4967 6.58688 13.5751V18.5071H5.26784C4.55855 18.5071 3.974 19.0917 3.974 19.801V20.498C3.974 21.2073 4.55855 21.7919 5.26784 21.7919H19.1835C19.8928 21.7919 20.4773 21.2073 20.4773 20.498V19.801C20.4773 19.0917 19.8928 18.5071 19.1835 18.5071H17.7893V13.5751C17.7893 10.4967 15.2665 7.9739 12.1881 7.9739Z" fill="white"/><path d="M10.0001 9C10.0001 4.02944 14.0295 0 19.0001 0H25.0001C29.9707 0 34.0001 4.02944 34.0001 9C34.0001 13.9706 29.9707 18 25.0001 18H19.0001C14.0295 18 10.0001 13.9706 10.0001 9Z" fill="#DC1125"/><path d="M22.5001 4.32227C22.9923 4.32227 23.4454 4.39844 23.8595 4.55078C24.2774 4.70312 24.6114 4.93359 24.8614 5.24219C25.1114 5.54688 25.2364 5.92969 25.2364 6.39062C25.2364 6.73438 25.1681 7.03516 25.0313 7.29297C24.8985 7.55078 24.7169 7.77734 24.4864 7.97266C24.256 8.16406 23.9942 8.33203 23.7013 8.47656C24.006 8.63672 24.295 8.82422 24.5685 9.03906C24.8419 9.25 25.0646 9.49805 25.2364 9.7832C25.4122 10.0684 25.5001 10.4004 25.5001 10.7793C25.5001 11.2559 25.3731 11.6699 25.1192 12.0215C24.8653 12.3691 24.5138 12.6387 24.0646 12.8301C23.6153 13.0215 23.0938 13.1172 22.5001 13.1172C21.8595 13.1172 21.3146 13.0254 20.8653 12.8418C20.4161 12.6582 20.0743 12.3965 19.8399 12.0566C19.6056 11.7129 19.4884 11.3027 19.4884 10.8262C19.4884 10.4355 19.5606 10.0957 19.7052 9.80664C19.8536 9.51758 20.0528 9.26953 20.3028 9.0625C20.5528 8.85156 20.8282 8.67188 21.129 8.52344C20.8751 8.36328 20.6427 8.18164 20.4317 7.97852C20.2247 7.77539 20.0587 7.54297 19.9337 7.28125C19.8126 7.01953 19.7521 6.71875 19.7521 6.37891C19.7521 5.92578 19.879 5.54688 20.1329 5.24219C20.3907 4.9375 20.7286 4.70898 21.1466 4.55664C21.5646 4.40039 22.0157 4.32227 22.5001 4.32227ZM21.1642 10.7207C21.1642 11.0293 21.2735 11.2852 21.4923 11.4883C21.7149 11.6875 22.0431 11.7871 22.4767 11.7871C22.9259 11.7871 23.2618 11.6914 23.4845 11.5C23.7071 11.3047 23.8185 11.0488 23.8185 10.7324C23.8185 10.5137 23.754 10.3223 23.6251 10.1582C23.5001 9.99414 23.3419 9.84766 23.1505 9.71875C22.9591 9.58594 22.7657 9.46289 22.5704 9.34961L22.4122 9.26758C22.1622 9.38086 21.9435 9.50781 21.756 9.64844C21.5724 9.78906 21.4278 9.94727 21.3224 10.123C21.2169 10.2988 21.1642 10.498 21.1642 10.7207ZM22.4884 5.64648C22.1915 5.64648 21.9454 5.72266 21.7501 5.875C21.5548 6.02734 21.4571 6.24219 21.4571 6.51953C21.4571 6.71484 21.504 6.88672 21.5978 7.03516C21.6954 7.17969 21.8224 7.30664 21.9786 7.41602C22.1388 7.52539 22.3126 7.62695 22.5001 7.7207C22.6798 7.63477 22.8478 7.53906 23.004 7.43359C23.1603 7.32812 23.2872 7.20117 23.3849 7.05273C23.4825 6.9043 23.5313 6.72656 23.5313 6.51953C23.5313 6.24219 23.4317 6.02734 23.2325 5.875C23.0372 5.72266 22.7892 5.64648 22.4884 5.64648Z" fill="white"/></svg>')
                                } else if (messagesCount.unread > 8) {
                                    $('.loggedInNotificationCenter').html('<svg xmlns="http://www.w3.org/2000/svg" width="34" height="28" viewBox="0 0 34 28" fill="none" aria-hidden="true"><path fill-rule="evenodd" clip-rule="evenodd" d="M12.1881 5.9999C16.3567 5.9999 19.7633 9.40649 19.7633 13.5751V16.5849C21.288 16.8599 22.4513 18.1993 22.4513 19.801V20.498C22.4513 22.2975 20.983 23.7659 19.1835 23.7659L14.3267 23.7657C14.338 23.851 14.3438 23.938 14.3438 24.0264C14.3438 25.1167 13.4605 25.9999 12.3703 25.9999C11.28 25.9999 10.3958 25.1167 10.3958 24.0264C10.3958 23.938 10.4016 23.851 10.4128 23.7657L5.26784 23.7659C3.46834 23.7659 2 22.2975 2 20.498V19.801C2 18.2887 3.03704 17.0103 4.43616 16.6407L4.61289 16.5993V13.5751C4.61289 9.40649 8.01948 5.9999 12.1881 5.9999ZM12.1881 7.9739C9.10969 7.9739 6.58688 10.4967 6.58688 13.5751V18.5071H5.26784C4.55855 18.5071 3.974 19.0917 3.974 19.801V20.498C3.974 21.2073 4.55855 21.7919 5.26784 21.7919H19.1835C19.8928 21.7919 20.4773 21.2073 20.4773 20.498V19.801C20.4773 19.0917 19.8928 18.5071 19.1835 18.5071H17.7893V13.5751C17.7893 10.4967 15.2665 7.9739 12.1881 7.9739Z" fill="white"/><path d="M10.0001 9C10.0001 4.02944 14.0295 0 19.0001 0H25.0001C29.9707 0 34.0001 4.02944 34.0001 9C34.0001 13.9706 29.9707 18 25.0001 18H19.0001C14.0295 18 10.0001 13.9706 10.0001 9Z" fill="#DC1125"/><path d="M21.5605 8.08984C21.5605 8.58203 21.5234 9.07031 21.4492 9.55469C21.3789 10.0391 21.2539 10.4961 21.0742 10.9258C20.8945 11.3516 20.6425 11.7305 20.3183 12.0625C19.9941 12.3906 19.582 12.6484 19.082 12.8359C18.582 13.0234 17.9765 13.1172 17.2656 13.1172C17.0976 13.1172 16.9003 13.1094 16.6738 13.0938C16.4472 13.082 16.2597 13.0625 16.1113 13.0352V11.582C16.2675 11.6211 16.4336 11.6523 16.6093 11.6758C16.7851 11.6953 16.9628 11.7051 17.1425 11.7051C17.8574 11.7051 18.4082 11.5918 18.7949 11.3652C19.1855 11.1387 19.4589 10.8242 19.6152 10.4219C19.7753 10.0195 19.8671 9.55469 19.8906 9.02734H19.8203C19.707 9.21484 19.5722 9.38477 19.416 9.53711C19.2636 9.68555 19.0683 9.80469 18.83 9.89453C18.5918 9.98047 18.289 10.0234 17.9218 10.0234C17.4336 10.0234 17.0078 9.91797 16.6445 9.70703C16.2851 9.49219 16.0058 9.18359 15.8066 8.78125C15.6113 8.375 15.5136 7.88477 15.5136 7.31055C15.5136 6.68945 15.6308 6.1582 15.8652 5.7168C16.1035 5.27148 16.4414 4.92969 16.8789 4.69141C17.3164 4.45312 17.832 4.33398 18.4257 4.33398C18.8632 4.33398 19.2714 4.41016 19.6503 4.5625C20.0293 4.71094 20.3613 4.93945 20.6464 5.24805C20.9355 5.55664 21.1601 5.94727 21.3203 6.41992C21.4804 6.89258 21.5605 7.44922 21.5605 8.08984ZM18.4609 5.78711C18.1093 5.78711 17.8222 5.9082 17.5996 6.15039C17.3769 6.39258 17.2656 6.77148 17.2656 7.28711C17.2656 7.70117 17.3613 8.0293 17.5527 8.27148C17.7441 8.51367 18.0351 8.63477 18.4257 8.63477C18.6953 8.63477 18.9296 8.57617 19.1289 8.45898C19.3281 8.33789 19.4824 8.1875 19.5918 8.00781C19.705 7.82422 19.7617 7.63672 19.7617 7.44531C19.7617 7.24609 19.7343 7.04883 19.6796 6.85352C19.625 6.6582 19.5429 6.48047 19.4336 6.32031C19.3242 6.16016 19.1875 6.03125 19.0234 5.93359C18.8632 5.83594 18.6757 5.78711 18.4609 5.78711Z" fill="white"/><path d="M26.0725 8.13086H28.3401V9.41406H26.0725V11.6699H24.7893V9.41406H22.5217V8.13086H24.7893V5.8457H26.0725V8.13086Z" fill="white"/></svg>')
                                }
                            });

                            $('.loggedInNotificationCenter').bind('click keypress', function (e) {
                                if(e.type === "click" || e.which === 13) {
                                    $('.profileNtoficiationContainer').addClass('showPMContainer');
                                    $('.profileNtoficiationContainer').attr('aria-expanded', 'true');
                                    $('.loggedInNotificationCenter').addClass('activeBellMessageContainer');
                                    $('.profileBookingManagementContainer').removeClass('showPMContainer');
                                    $('.profileBookingManagementContainer').attr('aria-expanded', 'false');
                                    $('.loggedInLinkContainer.activeBellMessageContainer').removeClass('activeBellMessageContainer'); 
                                    $('.loggedInNotificationCenter').attr('aria-expanded', 'true'); 
                                    $('.notificationsAnchor').focus();
                                }
                                });
                            // }
                        },
                        error: function (error) {
                            console.error("Error:", error);
                        }
                    });
    
                    console.log('$test test message',messagesCount.unread)
                    $('.loggedinContainer').append('<div class="profileBookingManagementContainer" role="menuitem"><div class="profileBookingContainer"><a class="manageProfileNav" href="/profilemanagement/profiles">My Profile</a><a class="benefitsNav" href="/profilemanagement/profiles/benefits">My Benefits</a><a class="myCruises" href="/profilemanagement/profiles/cruises">My Bookings</a><a class="myOffersNav" href="/cruise-deals?vifp=">My Offers</a><a class="favoritesNav" href="/saved"><span>Favorites</span></a><a  class="logoutNav" tabindex="0" role="button"><span>LOG OUT</span></a><div class= "navHelpContainer"><a class="navFAQ" href="/help">FAQs</a><a class="navPostCruise" href="/post-cruise-inquiries">Post-Cruise Inquries</a></div></div></div>');
                });

                $(document).on('click', '.logoutNav', function () {
                    document.querySelector('.cgh-profile-menu-right [href="/profilemanagement/accounts/logout"]').click();
                });
    
                $(document).on('mouseover', '.loggedInLinkContainer, .loggedInLinkContainer svg, .loggedInLinkContainer span, .loggedInLinkContainer path, .loggedInLinkContainer span div, .profileBookingManagementContainer, .profileBookingManagementContainer div', function (e) {
                    $('.profileBookingManagementContainer').addClass('showPMContainer');
                    $('.profileBookingManagementContainer').attr('aria-expanded', 'true');
                    $('.loggedInLinkContainer').addClass('activeBellMessageContainer');
                    $('.profileNtoficiationContainer').removeClass('showPMContainer');
                    $('.profileNtoficiationContainer').attr('aria-expanded', 'false');
                    $('.loggedInNotificationCenter').removeClass('activeBellMessageContainer');
                    $('.loggedInLinkContainer').attr('aria-expanded', 'true');
                    // $('.profileBookingContainer').focus();
                });
    
    
                $(document).on('mouseover', '.loggedInNotificationCenter, .loggedInNotificationCenter svg, .loggedInNotificationCenter path, .profileNtoficiationContainer, .profileNtoficiationContainer div' , function (e) {
                    $('.profileNtoficiationContainer').addClass('showPMContainer');
                    $('.profileNtoficiationContainer').attr('aria-expanded', 'true');
                    $('.loggedInNotificationCenter').addClass('activeBellMessageContainer');
                    $('.profileBookingManagementContainer').removeClass('showPMContainer');
                    $('.profileBookingManagementContainer').attr('aria-expanded', 'false');
                    $('.loggedInLinkContainer.activeBellMessageContainer').removeClass('activeBellMessageContainer');
                    $('.loggedInNotificationCenter').attr('aria-expanded', 'true'); 
                    // $('.notificationsAnchor').focus();
                });

                utils.waitForElement('.loggedInLinkContainer').then(function () {
                    $('.loggedInLinkContainer').bind('click keypress', function (e) {
                        if(e.type === "click" || e.which === 13) {
                            $('.profileBookingManagementContainer').addClass('showPMContainer');
                            $('.profileBookingManagementContainer').attr('aria-expanded', 'true');
                            $('.loggedInLinkContainer').addClass('activeBellMessageContainer');
                            $('.profileNtoficiationContainer').removeClass('showPMContainer');
                            $('.profileNtoficiationContainer').attr('aria-expanded', 'false');
                            $('.loggedInNotificationCenter').removeClass('activeBellMessageContainer');
                            $('.loggedInLinkContainer').attr('aria-expanded', 'true');
                            $('.manageProfileNav').focus();
                        }
                    });
                });

                $(document).on('mouseout', '.loggedInLinkContainer, .loggedInLinkContainer svg, .loggedInLinkContainer span, .loggedInLinkContainer path, .loggedInLinkContainer span div.profileBookingManagementContainer, .profileBookingManagementContainer div', function (e) { 
                    $('.profileBookingManagementContainer').removeClass('showPMContainer');
                    $('.profileBookingManagementContainer').attr('aria-expanded', 'false');
                    $('.loggedInLinkContainer').removeClass('activeBellMessageContainer');
                    $('.loggedInLinkContainer').attr('aria-expanded', 'false');
                });
    
    
                $(document).on('mouseout', '.loggedInNotificationCenter, .loggedInNotificationCenter svg, .loggedInNotificationCenter path, .profileNtoficiationContainer, .profileNtoficiationContainer div' , function (e) {
                    $('.profileNtoficiationContainer').removeClass('showPMContainer');
                    $('.profileNtoficiationContainer').attr('aria-expanded', 'false');
                    $('.loggedInNotificationCenter').removeClass('activeBellMessageContainer');
                    $('.loggedInNotificationCenter').attr('aria-expanded', 'false'); 
                });
            }
        }
    }
}
utils.waitForElement('.cgh-header__menu-wrapper').then(function () {
    globalNavOldHeader ();
});

$(window).resize(function () {
    globalNavOldHeader ();
    if($(window).width() > 1199) {
        $('.secondaryNav').remove();
        $('.primaryMenuNav').remove();
        $('.loginNotificationContainerMobile').remove();
    } else {
        $('.globalNavDesktopContainer').remove();
        $('.globalNavSearch').remove();
        // $('.profileBookingManagementContainer').remove();
        // $('.profileNtoficiationContainer').remove();
    }
});
}, "dependencies": []}, {"id": "E561F1E5-9E3D-41DA-9862-905A486226EB", "type": "append", "selector": "head", "value": "<style>.cgh-header__main-menu-options-wrapper,\n.cgh-header__secondary-menu-right .cgh-header__secondary-menu-options {\n    display: none !important;\n}\n\n.loggedInName {\n    font-family: \"Open Sans\";\n    font-size: 12px;\n    font-style: normal;\n    font-weight: 700;\n    line-height: 16px;\n    color: #ffffff;\n    margin-left: 4px;\n    margin-right: 8px;\n    max-width: 139px;\n    text-overflow: ellipsis;\n    white-space: nowrap;\n    overflow: hidden;\n    text-transform: lowercase;\n}\n\n.loggedInName:first-line {\n    text-transform: capitalize;\n}\n\n.loggedInName>div {\n    display: inline;\n    text-transform: lowercase;\n}\n\n.loggedInName>div:first-line {\n    text-transform: capitalize;\n}\n\n@media only screen and (max-width: 767px) {\n    .loginNotificationContainerMobile {\n        width: 104px;\n        min-width: 104px !important;\n    }\n\n    .loginNotificationContainerMobile .navLoginContainerMobile svg {\n        margin-right: 16px !important;\n    }\n\n    .loggedInNotificationCenter {\n        margin-right: 0 !important;\n        margin-left: 0 !important;\n    }\n}\n\n@media only screen and (max-width: 1200px) {\n\n    @media only screen and (min-width: 768px) {\n        .cgh-header__secondary-menu {\n            max-width: 100% !important;\n            width: calc(100% - 8px) !important;\n            margin: 0 !important;\n            position: relative;\n        }\n\n        #cclr-global-header-root {\n            min-height: auto !important;\n        }\n\n        .loggedinContainer {\n            border-radius: 0px 0px 0px 16px;\n            background: var(--Gradient-My-Account-Nav-Blue-Gradient, linear-gradient(267deg, #0073E8 24.45%, #0D529B 99.9%));\n            backdrop-filter: blur(2px);\n            display: flex;\n            min-height: 60px;\n            align-items: center;\n            padding-right: 40px;\n            margin-left: 24px;\n            z-index: 10;\n            min-width: 224px;\n            z-index: 10000;\n            /* position: absolute;\n            right: -24px; */\n        }\n\n        .loggedInLinkContainer {\n            display: flex;\n            align-items: center;\n            padding-left: 16px;\n            height: 60px;\n        }\n\n        .profileBookingManagementContainer,\n        .profileNtoficiationContainer {\n            display: none;\n            position: absolute;\n            top: 60px;\n            right: 80px;\n            background: transparent;\n            padding-top: 8px;\n        }\n        \n        .profileBookingContainer,\n        .profileNotContainer {\n            display: flex;\n            background: #ffffff;\n            flex-direction: column;\n            padding: 24px;\n            width: 365px;\n            border-radius: 16px;\n            box-shadow: 0px 0px 6px 0px rgba(0, 0, 0, 0.18)\n        }\n\n        .profileNotContainer {\n            width: 375px;\n        }\n\n        .profileBookingManagementContainer a {\n            color: #10559a;\n            text-align: left;\n            font-family: \"Open Sans\";\n            font-size: 20px;\n            font-style: normal;\n            font-weight: 700;\n            line-height: 24px;\n            padding: 8px 0;\n            cursor: pointer;\n        }\n\n        .profileNtoficiationContainer {\n            right: 48px !important;\n        }\n\n        .showPMContainer {\n            display: flex !important;\n        }\n\n        .loggedInLinkContainer.activeBellMessageContainer {\n            border-radius: 0px 0px 0px 16px;\n        }\n        \n        .activeBellMessageContainer {\n            background: var(--buttons-blue-pressed, #0B3C6C);\n        }\n\n        .loggedinContainer .loggedInNotificationCenter {\n            height: 60px;\n            padding: 0 8px;\n            margin-right: 8px;\n            align-items: center;\n            display: flex;\n        }\n\n        .logoutNav {\n            margin-top: 24px;\n            display: flex;\n            justify-content: center;\n            margin-bottom: 16px;\n            border: 1px solid var(--Buttons-Blue-Gradient, #10559a);\n            border-radius: 4px;\n            padding: 16px !important;\n            cursor: pointer;\n            height: 48px;\n            align-items: center;\n        }\n\n        .navHelpContainer {\n            display: flex !important;\n            justify-content: center;\n        }\n    \n        .navHelpContainer>a {\n            padding: 0 0 0 16px !important;\n            font-family: \"Open Sans\";\n            font-size: 14px !important;\n            font-weight: 400 !important;\n            line-height: 18px !important;\n            letter-spacing: 0.014px;\n        }\n    }\n\n    .primaryMenuNav a,\n    .secondaryNav a {\n        cursor: pointer;\n    }\n\n    .cgh-avatar__icon, \n    .cgh-header__menu-toggle,\n    .cgh-saved {\n        display: none !important;\n    }\n\n    .cgh-header__menu-wrapper {\n        padding: 17px 16px !important;\n        margin-left: 0 !important;\n        height: 60px;\n    }\n\n    .secondaryNavLinkContainer {\n        margin-top: 24px;\n    }\n\n    .navLoginContainerMobile {\n        background-image: none;\n        background: var(--Buttons-Red-Gradient, linear-gradient(270deg, #EB0033 0%, #B90013 100%));\n        border: none;\n        border-radius: 4px;\n        color: #ffffff !important;\n        font-family: \"Open Sans\", Helvetica, Sans-Serif;\n        font-size: 14px;\n        font-style: normal;\n        font-weight: 700;\n        line-height: 18px;\n        width: 102px;\n        height: 40px;\n        display: flex;\n        align-items: center;\n        justify-content: center;\n        position: absolute;\n        right: 16px;\n    }\n\n    .loginNotificationContainerMobile .navLoginContainerMobile {\n        position: unset !important;\n    }\n\n    .cgh-header__secondary-menu {\n        align-items: center;\n        justify-content: flex-start !important;\n        margin-right: 4px !important;\n        z-index: 1000;\n    }\n\n    .cgh-header__secondary-menu-actions {\n        padding: 0;\n    }\n\n    .cgh-header__secondary-menu-left {\n        align-items: center;\n    }\n\n    .cgh-header__logo {\n        margin-left: 0 !important;\n        width: 103px !important;\n        height: 26px !important;\n    }\n\n    [data-testid=\"header\"] .kntnqz svg {\n        display: none;\n    }\n\n    [data-testid=\"header\"] [href=\"/profilemanagement/accounts/login\"] {\n        background: #DC1125 !important;\n        color: #ffffff;\n        width: 74px;\n        height: 40px;\n        border-radius: 24px;\n        justify-content: center;\n    }\n\n    .globalNavBurgeMenu {\n        background-image: url('//cdn.optimizely.com/img/752671897/e57c2f35bac941ec9f0e823bca1d0b49.svgz');\n        background-repeat: no-repeat;\n        width: 24px;\n        margin-right: 16px;\n        display: block;\n        height: 24px;\n    }\n\n    [data-testid=\"header\"] .eiwIVs {\n        display: flex;\n        align-items: baseline;\n    }\n\n    .primaryMenuNav {\n        background: #ffffff;\n        width: 100vw;\n        height: 100vh;\n        display: none;\n        flex-direction: column;\n        overflow: scroll;\n    }\n\n    .primaryMenuNav.activeNav {\n        display: flex;\n        position: fixed;\n        z-index: 10000;\n    }\n\n    .closeGlobalNav {\n        background: url('//cdn.optimizely.com/img/752671897/51cbdfdd2c3f47c6a0485b2067f48b63.svgz');\n        width: 24px;\n        height: 24px;\n        background-repeat: no-repeat;\n        margin-left: 8px;\n        background-position: center;\n        display: block;\n    }\n\n    .carnivalLogo {\n        width: 103px;\n        height: 26px;\n        margin-left: 16px;\n    }\n\n    .globalNavContainerMobile {\n        display: flex;\n        width: 100%;\n        height: 60px;\n        align-items: center;\n        padding: 8px;\n    }\n\n    .carnivalLogo>.logo {\n        width: 103px;\n        height: 26px;\n    }\n\n    .globalNavLoginContainer {\n        display: flex;\n        align-items: center;\n        background: linear-gradient(270deg, #EB0033 0%, #B90013 100%);\n        height: 60px;\n        padding: 16px;\n        position: relative;\n    }\n\n    .globalNavLoginContainer span {\n        font-family: \"Open Sans\", Helvetica, Sans-Serif;\n        font-size: 12px;\n        font-style: normal;\n        font-weight: 700;\n        line-height: 16px;\n        color: #ffffff;\n        margin-left: 4px;\n    }\n\n    .globalChevron {\n        position: absolute;\n        right: 0;\n    }\n\n    .globalNavMainLinkContainer {\n        font-family: \"Open Sans\", Helvetica, Sans-Serif;\n        font-size: 22px;\n        font-style: normal;\n        font-weight: 700;\n        line-height: 26px;\n        color: #10559a;\n        display: flex;\n        flex-direction: column;\n        padding: 24px 16px 16px;\n    }\n\n    .globalNavMainLinkContainer a {\n        padding-bottom: 24px;\n        color: #232323;\n    }\n\n    .hideOverflow {\n        overflow: hidden !important;\n        position: relative;\n        height: 100%;\n    }\n\n    .globalNavLoginContainer svg:last-child {\n        position: absolute;\n        right: 16px;\n    }\n\n    .globalNavContactContainer {\n        display: flex;\n        flex-direction: column;\n        color: #10559a;\n        padding: 0 16px 8px;\n    }\n\n    .globalContactNumber,\n    .globalContactLink {\n        font-family: \"Open Sans\", Helvetica, Sans-Serif;\n        font-size: 16px;\n        font-style: normal;\n        font-weight: 400;\n        line-height: 20px;\n        padding-bottom: 16px;\n        color: #10559a;\n        text-decoration: underline;\n    }\n\n    .globalContactNumber {\n        text-decoration: underline;\n        letter-spacing: 0.016px;\n    }\n\n    .globalSearch,\n    .globalCountry {\n        font-family: \"Open Sans\", Helvetica, Sans-Serif;\n        font-size: 14px;\n        font-style: normal;\n        font-weight: 700;\n        line-height: 18px;\n        letter-spacing: 0.014px;\n        padding-bottom: 16px;\n        display: flex;\n        align-items: center;\n        border: none;\n        color: #10559a;\n    }\n\n    .globalCountry svg {\n        margin-left: 8px;\n    }\n\n    .globalCountry img {\n        margin-right: 8px;\n    }\n\n    .countryContainer>svg {\n        margin-top: 2px;\n        margin-right: 8px;\n    }\n\n    .countryContainer>svg:last-of-type {\n        margin-left: 8px;\n    }\n\n    .countryContainer {\n        display: flex;\n    }\n\n    .globalSearch {\n        display: flex;\n        align-items: center;\n    }\n\n    .globalSearch img {\n        margin-right: 8px;\n    }\n\n    .globalMasterCard {\n        padding: 16px;\n        background: #f9f9f9;\n        display: flex;\n        flex-direction: row;\n    }\n\n    .globalMasterCardCopyContainer {\n        display: flex;\n        flex-direction: column;\n    }\n\n    .globalMasterCardHeader {\n        font-family: \"Open Sans\", Helvetica, Sans-Serif;\n        font-size: 14px;\n        font-style: normal;\n        font-weight: 700;\n        line-height: 18px;\n        color: #464646;\n    }\n\n    .globalMasterCardCopy {\n        font-family: \"Open Sans\", Helvetica, Sans-Serif;\n        font-size: 12px;\n        font-style: normal;\n        font-weight: 400;\n        line-height: 16px;\n        color: #464646;\n        padding-top: 4px;\n        padding-bottom: 16px;\n    }\n\n    .globalMasterCardCta {\n        color: #ffffff;\n        background: #10559a;\n        width: 104px;\n        height: 32px;\n        text-align: center;\n        font-family: Tempo, \"TempoStd\", \"Open Sans\", Helvetica, Sans-Serif;\n        font-size: 12px;\n        font-style: normal;\n        font-weight: 850;\n        line-height: 16px;\n        /* 133.333% */\n        text-transform: uppercase;\n        border-radius: 24px;\n        padding-top: 8px;\n    }\n\n    .globalMasterCardLogo {\n        margin-top: 10px;\n        margin-right: 12px;\n        width: 401px;\n        height: 87px;\n    }\n\n    .globalMasterCardLogo img {\n        width: 116px;\n        height: 87px;\n    }\n\n    .secondaryNav {\n        display: none;\n        width: 100vw;\n        height: 100vh;\n        background: #ffffff;\n        z-index: 10000;\n        position: fixed;\n        overflow: scroll;\n    }\n\n    .secondaryNavTopContainer {\n        display: flex;\n        justify-content: space-between;\n        padding: 16px;\n    }\n\n    .secondaryNavLinkHeader {\n        font-size: 22px;\n        font-style: normal;\n        font-weight: 700;\n        line-height: 26px;\n        color: #232323;\n        font-family: \"Open Sans\", Helvetica, Sans-Serif;\n        padding-top: 8px;\n        padding-left: 16px;\n    }\n\n    .secondaryNavLinks {\n        display: flex;\n        flex-direction: column;\n        padding: 24px 16px;\n        font-family: \"Open Sans\", Helvetica, Sans-Serif;\n        color: #10559a;\n        font-size: 14px;\n        line-height: 18px;\n        margin-bottom: 88px;\n    }\n\n    .secondaryNavLinks a {\n        padding-bottom: 16px;\n        font-weight: 600;\n        line-height: 18px;\n        color: #10559A;\n    }\n\n    .navSecondaryMainContainer a,\n    .globalNavSecondaryDeals a,\n    .globalNavSecondaryVIFP a   {\n        font-weight: 700 !important;\n        font-size: 18px !important;\n        line-height: 22px !important;\n    }\n\n    .secondaryNavSubHeader {\n        color: #464646;\n        font-family: \"Open Sans\", Helvetica, Sans-Serif;\n        font-size: 14px;\n        font-style: normal;\n        font-weight: 400;\n        line-height: 18px;\n        padding-bottom: 16px;\n    }\n\n    .secondaryNavSectionContainer {\n        display: flex;\n        flex-direction: column;\n        padding-bottom: 16px;\n    }\n\n    .destinationsHeader {\n        padding-top: 0;\n        padding-bottom: 24px;\n    }\n\n    .loginNotificationContainerMobile {\n        position: absolute;\n        top: 0;\n        right: 0;\n        border-radius: 0px 0px 0px 16px;\n        background: var(--My-Account-My-Account-Bubble, linear-gradient(270deg, #0073E8 0%, #0D529B 100%));\n        backdrop-filter: blur(2px);\n        display: flex;\n        height: 100%;\n        align-items: center;\n        min-width: 207px;\n        padding: 16px;\n        z-index: 10;\n    }\n\n    .globalNavLoginAuthenticated {\n        background: var(--Buttons-Blue-Gradient, linear-gradient(270deg, #0073E8 0%, #0D529B 100%)) !important;\n    }\n\n    .loginNotificationContainerMobile .navLoginContainerMobile {\n        background: transparent !important;\n        width: auto !important;\n        height: auto !important;\n    }\n\n    .loginNotificationContainerMobile .navLoginContainerMobile svg {\n        width: 32px;\n        height: 32px;\n        margin-right: 0px;\n    }\n\n    .profileManagementModalContainer,\n    .profileBellModal {\n        height: 100vh;\n        width: 100vw;\n        right: 0px;\n        top: -1px;\n        filter: drop-shadow(rgba(0, 0, 0, 0.18) 0px 0px 6px);\n        background-color: var(--white);\n        box-shadow: rgba(0, 0, 0, 0.18) 0px 0px 6px;\n        border-radius: 4px;\n        display: none;\n        position: fixed;\n        z-index: 10001;\n        overflow: scroll;\n    }\n\n    .profileManagementModalContainer span,\n    .profileBellModal span {\n        background: var(--My-Account-My-Account-Bubble, linear-gradient(270deg, #0073E8 0%, #0D529B 100%)) !important;\n        display: flex;\n        align-items: center;\n        margin-bottom: 24px;\n        color: #ffffff;\n        font-family: Tempo, \"TempoStd\", \"Open Sans\", Helvetica, Sans-Serif;\n        font-size: 20px;\n        font-style: normal;\n        font-weight: 850;\n        line-height: 24px; /* 120% */\n        text-transform: uppercase;\n        padding: 16px;\n    }\n\n    .profileManagementModalContainer span svg,\n    .profileBellModal span svg {\n        margin-right: 8px;\n    }\n\n    .profileManagementCloseModal,\n    .profileBellCloseContainer {\n        position: absolute;\n        right: 16px;\n        top: 22px;\n        width: auto !important;\n    }\n\n    .profileManagementModalContainer div,\n    .profileBellModal div {\n        height: 1px;\n        margin-bottom: 16px;\n    }\n\n    .profileManagementModalContainer>a {\n        display: block;\n        width: 100%;\n        margin-bottom: 16px;\n        font-family: \"Open Sans\";\n        font-size: 20px;\n        font-style: normal;\n        font-weight: 700;\n        line-height: 24px; \n        color: #10559a;\n        padding: 0 16px;\n    }\n\n    .logOutModal {\n        margin: 16px;\n        margin-top: 32px;\n        padding: 16px 24px !important;\n        border: 1px solid var(--Buttons-Blue, #10559A);\n        border-radius: 4px;\n        width: auto !important;\n        display: flex !important;\n        justify-content: center;\n        font-family: Tempo, \"TempoStd\", \"Open Sans\", Helvetica, Sans-Serif !important;\n    }\n\n    .profileManagementModalContainer p {\n        text-align: center;\n    }\n\n    .profileManagementModalContainer p a {\n        padding-left: 16px;\n        font-family: \"Open Sans\";\n        font-size: 14px;\n        font-style: normal;\n        font-weight: 400;\n        line-height: 18px;\n        letter-spacing: 0.014px;\n        color: #10559a;\n    }\n\n    .profileBellMessageCount {\n        color: var(--Text-Blue, #10559A) !important;\n        font-weight: 700 !important;\n    }\n\n    .profileBellModal p {\n        font-family: \"Open Sans\";\n        font-size: 14px;\n        font-style: normal;\n        font-weight: 400;\n        line-height: 18px;\n        color: #464646;\n        margin-left: 24px;\n        margin-top: 8px;\n    }\n\n    .profileBellModal a {\n        color: var(--Text-Blue, #10559A);\n        font-family: \"Open Sans\";\n        font-size: 14px;\n        font-style: normal;\n        font-weight: 400;\n        line-height: 18px;\n        letter-spacing: 0.014px;\n        margin-left: 24px;\n        text-decoration: underline;\n    }\n\n    .loggedInNotificationCenter {\n        height: 20px;\n        margin-right: 16px;\n        margin-left: 8px;\n    }\n}\n\n@media only screen and (min-width: 1200px) {\n\n    #cclr-global-header-root {\n        min-height: auto !important;\n        background: #ffffff !important;\n    }\n\n    .cgh-header__menu-wrapper {\n        box-shadow: none !important;\n    }\n\n    .cgh-header__menu-wrapper {\n        padding: 0 !important;\n    }\n\n    .cgh-header__secondary-menu {\n        max-width: none !important;\n        margin: 0 !important;\n        padding: 14px 40px !important;\n        width: 100% !important;\n        justify-content: flex-start !important;\n        position: relative;\n    }\n\n    .cgh-header {\n        box-shadow: 0px 0px 6px 0px rgba(24, 24, 24, 0.18);\n    }\n\n    .globalNavDesktopLogoContainer {\n        display: flex;\n        align-items: baseline;\n    }\n\n    .globalNavDesktopContainer {\n        padding-left: 48px;\n    }\n\n    .globalNavDesktopContainer>button {\n        margin-right: 24px;\n        font-family: \"Open Sans\", Helvetica, Sans-Serif;\n        font-size: 16px;\n        font-style: normal;\n        font-weight: 400;\n        line-height: 20px;\n        color: #232323;\n        display: inline-block;\n        border: none;\n        background: #fff;\n        padding: 0;\n    }\n\n    .globalNavLogin {\n        margin: 0 0 0 16px;\n    }\n\n    [data-testid=\"login\"] {\n        background: var(--Buttons-Red-Gradient, linear-gradient(270deg, #EB0033 0%, #B90013 100%));\n        border-radius: 4px;\n        width: 102px;\n        height: 40px;\n        margin: 0 16px !important;\n        color: #ffffff !important;\n        display: flex;\n        align-items: center;\n        justify-content: center;\n        font-family: \"Open Sans\", Helvetica, Sans-Serif;\n        font-size: 14px !important;\n        font-style: normal;\n        font-weight: 700 !important;\n        line-height: 18px !important;\n        text-decoration: none !important;\n    }\n\n    .cgh-header__secondary-menu-left {\n        align-items: baseline;\n    }\n\n    .cgh-header__logo {\n        height: 32px !important;\n        width: 126px !important;\n    }\n\n    .globalNavSecondaryBackgroundDrop {\n        background: rgba(216, 233, 253, 0.72);\n        backdrop-filter: blur(10px);\n        width: 100vw;\n        height: 100%;\n        display: none;\n        position: fixed;\n        margin-top: 4px;\n        left: 0;\n        z-index: 10999;\n    }\n\n    .globalNavSearch {\n        height: 24px;\n    }\n\n    .globalNavSearchLink {\n        cursor: pointer;\n    }\n\n    .globalNavSecondary {\n        border-radius: 0px 0px 24px 24px;\n        background: var(--Backgrounds-White, #FFF);\n        width: 100%;\n        height: auto;\n        position: absolute;\n        z-index: 100001;\n        padding-top: 24px;\n        left: 0;\n        top: 52px;\n        display: none;\n    }\n\n    .globalNavSecondary.active,\n    .globalNavSecondaryBackgroundDrop.active {\n        display: flex;\n    }\n\n    .globalNavSecondaryPlan,\n    .globalNavSecondaryOurShips,\n    .globalNavSecondaryDestinations,\n    .globalNavSecondaryManageMyBooking  {\n        margin-left: 220px;\n        display: flex;\n        flex-direction: row;\n        margin-bottom: 32px;\n    }\n    \n    .globalNavSecondaryDeals,\n    .globalNavSecondaryVIFP {\n        display: flex;\n        flex-direction: column;\n        margin-left: 220px;\n        margin-bottom: 32px;\n    }\n\n    .globalNavSecondaryOurShips span,\n    .globalNavSecondaryDestinations span {\n        color: #232323;\n        font-family: \"Open Sans\", Helvetica, Sans-Serif;\n        font-size: 14px;\n        line-height: 18px;\n        font-weight: 700;\n    }\n\n    .globalNavSecondaryOurShips a,\n    .globalNavSecondaryDestinations a,\n    .globalNavSecondaryDeals a,\n    .globalNavSecondaryVIFP a,\n    .globalNavSecondaryPlan a {\n        font-family: \"Open Sans\", Helvetica, Sans-Serif;\n        font-size: 14px;\n        line-height: 18px;\n        font-weight: 600;\n        color: #10559a;\n        margin-top: 16px;\n        cursor: pointer;\n        white-space: nowrap;\n    }\n\n    .globalNavPlan {\n        width: 104px;\n    }\n\n    .globalNavOurShips {\n        width: 77px;\n    }\n\n    .globalNavDestinations {\n        width: 102px;\n    }\n\n    .globalNavDeals {\n        width: 44px;\n    }\n\n    .globalNavVIFP {\n        width: 75px;\n    }\n\n    .myBookingNav {\n        width: 141px;\n    }\n\n    .cgh-profile-menu__action {\n        z-index: 10;\n    }\n\n    .globalNavPlan:hover,\n    .globalNavOurShips:hover,\n    .globalNavDestinations:hover,\n    .globalNavDeals:hover,\n    .globalNavVIFP:hover {\n        font-weight: 700;\n        color: #232323;\n        border-bottom: 2px solid #0B3C6C;\n    }\n\n    .globalNavDesktopContainer>button.activeLink {\n        font-weight: 700;\n        color: #232323;\n        border-bottom: 2px solid #0B3C6C;\n    }\n\n    .globalNavSecondaryOurShips span:first-of-type {\n        margin-top: 0;\n    }\n\n    /* logged in code */\n    .loggedinContainer {\n        border-radius: 0px 0px 0px 16px;\n        background: var(--Gradient-My-Account-Nav-Blue-Gradient, linear-gradient(267deg, #0073E8 24.45%, #0D529B 99.9%));\n        backdrop-filter: blur(2px);\n        display: flex;\n        min-height: 60px;\n        align-items: center;\n        padding-right: 40px;\n        margin-left: 24px;\n        z-index: 10;\n        min-width: 224px;\n        z-index: 10000;\n        /* position: absolute;\n        right: -24px; */\n    }\n\n    .cgh-header__secondary-menu-right {\n        position: absolute;\n        right: 24px;\n        top: 0;\n        height: 60px;\n    }\n\n    .cgh-header__secondary-menu-left {\n        height: 32px;\n    }\n\n    .loggedInLinkContainer {\n        display: flex;\n        align-items: center;\n        cursor: pointer;\n        height: 60px;\n        padding-left: 16px;\n        border-radius: 0px 0px 0px 16px;\n    }\n\n    .profileBookingManagementContainer,\n    .profileNtoficiationContainer {\n        display: none;\n        position: absolute;\n        top: 60px;\n        right: 80px;\n        background: transparent;\n        padding-top: 8px;\n    }\n    \n    .profileBookingContainer,\n    .profileNotContainer {\n        display: flex;\n        background: #ffffff;\n        flex-direction: column;\n        padding: 24px;\n        width: 365px;\n        border-radius: 16px;\n        box-shadow: 0px 0px 6px 0px rgba(0, 0, 0, 0.18)\n    }\n\n    .profileNotContainer {\n        width: 375px;\n    }\n\n    .profileBookingManagementContainer a {\n        color: #10559a;\n        text-align: left;\n        font-family: \"Open Sans\";\n        font-size: 20px;\n        font-style: normal;\n        font-weight: 700;\n        line-height: 24px;\n        padding: 8px 0;\n        cursor: pointer;\n    }\n\n    .showPMContainer {\n        display: flex !important;\n    }\n\n    .secondaryNaveManageMyBooking {\n        display: flex;\n        flex-direction: column;\n        margin-right: 100px;\n    }\n\n    .secondaryNaveManageMyBooking a {\n        margin: 8px 0;\n        color: var(--Text-Blue, #10559A);\n        font-family: \"Open Sans\";\n        font-size: 14px;\n        font-style: normal;\n        font-weight: 600;\n        line-height: 18px;\n    }\n\n    .secondaryNaveManageMyBooking span {\n        color: var(--Text-Dark-Grey, #464646);\n        font-family: \"Open Sans\";\n        font-size: 12px;\n        font-style: normal;\n        font-weight: 400;\n        line-height: 16px;\n        padding-bottom: 16px;\n    }\n\n    .myBookingLink,\n    .onlineCheckinLink,\n    .makePaymentLink,\n    .giftsAndShoppingLink {\n        font-size: 20px !important;\n        line-height: 24px !important;\n        font-weight: 700 !important;\n        margin-right: 52px;\n    }\n\n    .logoutNav {\n        margin-top: 24px;\n        display: flex;\n        justify-content: center;\n        margin-bottom: 16px;\n        border: 1px solid var(--Buttons-Blue-Gradient, #10559a);\n        border-radius: 4px;\n        padding: 16px !important;\n        cursor: pointer;\n        height: 48px;\n        align-items: center;\n        font-family: Tempo, \"TempoStd\", \"Open Sans\", Helvetica, Sans-Serif !important;\n    }\n\n    .logoutNav:hover {\n        background: #0E4883;\n        color: #ffffff;\n        border: 1px solid var(--Buttons-Blue-Gradient, #0E4883);\n    }\n\n    .logoutNav:active {\n        background: #0B3C6C;\n        color: #ffffff;\n        border: 1px solid var(--Buttons-Blue-Gradient, #0B3C6C);\n    }\n\n    .navHelpContainer {\n        display: flex !important;\n        justify-content: center;\n    }\n\n    .navHelpContainer>a {\n        padding: 0 0 0 16px !important;\n        font-family: \"Open Sans\";\n        font-size: 14px !important;\n        font-weight: 400 !important;\n        line-height: 18px !important;\n        letter-spacing: 0.014px;\n    }\n\n    .messageInbox {\n        color: var(--Text-Blue, #10559A);\n        font-family: \"Open Sans\";\n        font-size: 14px;\n        font-style: normal;\n        font-weight: 700;\n        line-height: 18px;\n        letter-spacing: 0.014px;\n        margin-bottom: 8px;\n    }\n\n    .messageSubTitle {\n        font-family: \"Open Sans\";\n        font-size: 14px;\n        font-style: normal;\n        font-weight: 400;\n        line-height: 18px;\n        color: var(--Text-Dark-Grey, #464646);\n    }\n\n    .notificationsAnchor {\n        margin-top: 24px;\n        font-family: \"Open Sans\";\n        font-size: 14px;\n        font-style: normal;\n        font-weight: 400;\n        line-height: 18px;\n        cursor: pointer;\n        letter-spacing: 0.014px;\n        text-decoration-line: underline !important;\n        color: var(--Text-Blue, #10559A);\n    }\n\n    .loggedInNotificationCenter {\n        height: 60px;\n        padding: 0 12px;\n        display: flex;\n        align-items: center;\n        cursor: pointer;\n    }\n\n    .activeBellMessageContainer {\n        background: var(--buttons-blue-pressed, #0B3C6C);\n    }\n\n\n    .profileNtoficiationContainer {\n        right: 54px;\n    }\n\n    .messageInbox {\n        color: var(--Text-Blue, #10559A);\n        font-family: \"Open Sans\";\n        font-size: 14px;\n        font-style: normal;\n        font-weight: 700;\n        line-height: 18px;\n        letter-spacing: 0.014px;\n        margin-bottom: 8px;\n    }\n\n    .messageSubTitle {\n        font-family: \"Open Sans\";\n        font-size: 14px;\n        font-style: normal;\n        font-weight: 400;\n        line-height: 18px;\n        color: var(--Text-Dark-Grey, #464646);\n    }\n\n    .notificationsAnchor {\n        margin-top: 24px;\n        font-family: \"Open Sans\";\n        font-size: 14px;\n        font-style: normal;\n        font-weight: 400;\n        line-height: 18px;\n        /* 128.571% */\n        letter-spacing: 0.014px;\n        text-decoration-line: underline;\n        color: var(--Text-Blue, #10559A);\n    }\n\n    .activeBellMessageContainer {\n        background: var(--buttons-blue-pressed, #0B3C6C);\n    }\n\n    .globalNavSecondaryLinkContainer {\n        display: flex;\n        flex-direction: column;\n        padding-right: 48px;\n    }\n\n    .globalNavSecondaryLinkContainer:last-of-type {\n        padding-right: 0 !important;\n    }\n\n    .navSecondaryMainContainer {\n        margin-right: 52px;\n    }\n\n    .globalNavSecondaryLinkContainer span,\n    .globalNavSecondaryDeals span,\n    .globalNavSecondaryVIFP span {\n        color: var(--Text-Dark-Grey, #464646);\n        font-family: \"Open Sans\";\n        font-size: 12px;\n        font-style: normal;\n        font-weight: 400;\n        line-height: 16px;\n        padding-bottom: 8px;\n    }\n\n    .navSecondaryMainContainer a,\n    .globalNavSecondaryDeals a,\n    .globalNavSecondaryVIFP a {\n        font-size: 20px !important;\n        font-weight: 700 !important;\n        line-height: 24px !important;\n        margin-top: 16px !important;\n        white-space: nowrap;\n    }\n\n    .notificationHeadline {\n        color: var(--Text-Dark-Grey, #464646);\n        font-family: \"Open Sans\";\n        font-size: 16px;\n        font-style: normal;\n        font-weight: 700;\n        line-height: 20px;\n        margin-bottom: 40px;\n    }\n}\n\n@media only screen and (min-width: 1400px) {\n    .globalNavSecondaryDeals,\n    .globalNavSecondaryVIFP,\n    .globalNavSecondaryPlan,\n    .globalNavSecondaryOurShips,\n    .globalNavSecondaryDestinations,\n    .globalNavSecondaryManageMyBooking  {\n        margin-right: 230px;\n    }\n}</style>", "dependencies": []}, {"id": "FD86673D-C03E-40BE-ADBE-5C2B810D72D6", "type": "append", "dependencies": [], "selector": "cgh-header__secondary-menu ", "value": "<img src='//cdn.optimizely.com/img/752671897/558b2806848948429b06f707a17aca95.svgz' />", "operator": "prepend"}, {"css": {}, "dependencies": [], "attributes": {}, "type": "attribute", "id": "E25D743D-FD0E-4D83-9852-BA8BAAEAA3FB", "selector": "[data-testid=\"login\"], .navLoginContainerMobile, [data-tealium-value=\"Login\"]"}, {"css": {}, "dependencies": [], "attributes": {}, "type": "attribute", "id": "72AD5748-DD31-461B-A274-5F862DC11277", "selector": ".cgh-menu-item-list [href=\"/cruise-deals.aspx\"]"}, {"css": {}, "dependencies": [], "attributes": {}, "type": "attribute", "id": "9D465842-60C3-4997-9D29-E24476F385B5", "selector": ".cgh-profile-menu-left [data-testid=\"create-account\"]"}, {"css": {}, "dependencies": [], "attributes": {}, "type": "attribute", "id": "031F629D-0061-45F8-9ED6-8F2AFDF0E161", "selector": ".globalNavSecondaryDeals a, .navSecondaryMainContainer [href=\"/cruise-deals\"]"}]}]}], "weightDistributions": [{"entityId": "26630750009", "endOfRange": 10000}], "name": "Test - Global Navigation ", "bucketingStrategy": null, "experimentMetadata": {"allocationPolicy": "manual", "layerId": "26633140107"}}], "policy": "single_experiment", "viewIds": ["21470231932", "22279790282", "9431051150", "9435920943"], "weightDistributions": null, "decisionMetadata": null}, {"changes": null, "id": "25261330827", "name": "Personalization - Combined Login & Account Creation Overlay", "commitId": "6412071114375168", "groupId": null, "holdback": 0, "activation": {}, "integrationSettings": {"contentsquare": {}}, "integrationStringVersion": 2, "experiments": [{"audienceIds": ["and", "10261134200", "20221400120"], "audienceName": "All | Exclude Synthetic Script \"KTNX\",roy test cookie exclusion", "changes": null, "id": "25218250938", "integrationSettings": null, "variations": [{"id": "25222860481", "name": "Variation #1", "actions": [{"viewId": "20742590357", "changes": [{"id": "5E4553AB-F8F4-440E-91CD-34114251F1DF", "type": "custom_code", "value": function($){var $ = jQuery;
var utils = window.optimizely.get("utils");

var coupleIMG = $('[src="//cdn.optimizely.com/img/752671897/3e416005db1940b49187616e613d1b5f.svg"]');
var checkIMG = $('[src="//cdn.optimizely.com/img/752671897/dcd8ef7fc9e04a10a6696025a7d54b83.svg"]').clone();
utils.waitForElement('.lr-view').then(function () {
    setTimeout(function () {
        var headingAttr = $('[aria-labelledby="lrh-heading"]').attr('style') + 'border-radius: 8px;';
        $('[aria-labelledby="lrh-heading"]').attr('style', headingAttr);
        $('#lrh-heading').attr('aria-hidden', 'false');
        // adding login on the left side
        $('.lr-login .lr-view-content').prepend('<h1 class="login-header" style="font-family: Open Sans; font-size: 20px; line-height: 24px; font-weight: 700; color: #464646; margin-top: 16px; aria-hidden="true"">Log In</h1>');
        // adding create account on the left side
        $('.lr-register .lr-view-content').prepend('<h1 class="login-header" style="font-family: Open Sans; font-size: 20px; line-height: 24px; font-weight: 700; color: #464646; margin-top: 16px; aria-hidden="true"">Create Account</h1>');
        $('.lr-view-content').prepend($('<span class="lrh-heading lrh-main-heading">Carnival Vifp Club</span>'));
        //  adding header above login
        $('.lr-view-content').prepend($('.lrh-heading'));
        $('<div class="logInRow" style="display: flex;"></div>').insertAfter($('.lrh'));

        $('.logInRow').prepend($('.lr-view-content'));
        // create account header
        $('.logInRow').append('<div class="logInRowLeft"><h2 class="joinVifpClub" style= "">VIFP Club</h2></div>');
        // adding X btn to join vifp club
        $('.lrh-close').insertAfter($('.logInRowLeft h2'));
        $('.lrh-close').attr('aria-label', 'Close button');
      $('[src="//cdn.optimizely.com/img/752671897/1199d2b3c6764e429051dea4edab0a55.svgz"]').attr('alt', '');
        // building list
        $('.logInRowLeft').append('<div style="margin-top: -8px;"><p style="font-family: Open Sans; font-size: 16px; color: #464646; font-weight: 700; margin: 24px 0px 16px; width: 342px;">Get exclusive member rates and offers. </br> Log in or create account.</p><ul style="font-family: Open Sans; font-size: 12px; line-height: 16px; color: #464646; list-style: none;padding: 0;"><li style="margin: 8px 0;"><img src ="//cdn.optimizely.com/img/752671897/dcd8ef7fc9e04a10a6696025a7d54b83.svg" /><span style="margin-left: 8px;">Special Offers</span></li><li style="margin: 8px 0;"><img src ="//cdn.optimizely.com/img/752671897/dcd8ef7fc9e04a10a6696025a7d54b83.svg" /><span style="margin-left: 8px;">Personalized Recommendations</span></li><li style="margin: 8px 0;"><img src ="//cdn.optimizely.com/img/752671897/dcd8ef7fc9e04a10a6696025a7d54b83.svg" /><span style="margin-left: 8px;">Members only cocktail receptions</span></li><li style="margin: 8px 0;"><img src ="//cdn.optimizely.com/img/752671897/dcd8ef7fc9e04a10a6696025a7d54b83.svg" /><span style="margin-left: 8px;">Priority boarding and much more!</span></li></ul></div>');
        // changing signup to create an account from create account cta
        $('.lr-register .lrc-submit-button').text('Create Account');

        $('.lr-view').parent().parent().addClass('loginReact');

        $('#username').focus();

        utils.waitForElement('.lsu-change-mode').then(function () {
            // adding create account btn to right side
            $('.logInRowLeft').append($('.lsu-change-mode'));
            $('.lsu-change-mode').attr('tabindex', '0');
            if(window.location.pathname === '/payment/bookings/checkout') { 
                $('.lsu-change-mode').hide(); 
            }
        });

        ownIDFixes ();
    }, 50);
    $('body').click(function (e) { 
        if(e.target== document.querySelector('.ReactModal__Overlay--after-open')) {
            document.getElementsByClassName("lrh-close")[0].click(); 
        }            
    });
});

$(document).on('click', '.fpc-back-cta', function () {
    fullBackToLogin();
});

utils.waitForElement('.lrc-submit-button').then(function () {

    // removing ! from login cta
    $('.lr-login .lrc-submit-button').text('LOG IN');
});

utils.waitForElement('[src="//cdn.optimizely.com/img/752671897/3e416005db1940b49187616e613d1b5f.svg"]').then(function () {
    // fixing the width of the image
    $('[src="//cdn.optimizely.com/img/752671897/3e416005db1940b49187616e613d1b5f.svg"]').attr('style', 'width: 363px;');
});

utils.waitForElement('.ff-input').then(function () {
    // removing placeholder
    $('.ff-input').attr('placeholder', '');
});

$(document).on('click', '.lr-login .lsu-change-mode', function () {
    utils.waitForElement('.lr-view').then(function () {
        loginToCreateAccountBtn();
    });
});

$(document).on("keydown", function (e) {
    var target = e.target;
    var shiftPressed = e.shiftKey;
    if (e.keyCode == 9 && $(target).is($('.lrh-close')) && $('.lsu-change-mode:not(:visible)')) {
        console.log('$tab')
        $('.lrh-heading').focus();
    } 
});

$(document).on('click', '.lr-register .lsu-change-mode', function () {
    utils.waitForElement('.lr-view').then(function () {
        createAccountToLoginBtn();
    });
});

$(document).on('click', '.fuaf-back-cta', function () {
    fullBackToLogin();
});

$(document).on('click', '.lrc-forgot-cta', function () {
    $('.login-header').remove();
});

$(document).on('click', '.fuf-cancel-cta', function () {
    fullBackToLogin();
});

$(document).on('click', '.aae-btn', function () {
    fullBackToLogin();
});

$(document).on('click', '.fpf-cancel-cta', function () {
    fullBackToLogin();
});

$(document).on('click', '.cp-cancel-cta', function () {
    fullBackToLogin();
    utils.waitForElement('.login-header').then(function () {
        setTimeout(function () {
            // adding create account on the left side
            $('.login-header').text('Create Account');
        }, 450);
    });
});


function loginToCreateAccountBtn() {
    // $('.lrh-heading').text('CARNIVAL VIFP CLUB');
    // adding create account on the left side
    $('.login-header').text('Create Account');
    // changing signup to create an account from create account cta
    
    setTimeout(function () {
        // removing placeholder
        $('.ff-input').attr('placeholder', '');
        $('.lr-register .lrc-submit-button').text('Create Account');
    }, 150);

    ownIDFixes ();
}

function createAccountToLoginBtn() {
    // $('.lrh-heading').text('CARNIVAL VIFP CLUB');
    // adding create account on the left side
    $('.login-header').text('Log In');
    setTimeout(function () {
        // removing placeholder
        $('.ff-input').attr('placeholder', '');
        // changing signup to create an account from create account cta
        $('.lr-login .lrc-submit-button').text('Log In');
    }, 150);

    ownIDFixes ();
}

function fullBackToLogin() {
    setTimeout(function () {
        console.log('back to login');
        // $('.lrh-heading').text('CARNIVAL VIFP CLUB');
        // adding login on the left side
        $('<h1 class="login-header" style="text-transform: capitalize; font-family: Open Sans; font-size: 20px; line-height: 24px; font-weight: 700; color: #464646; margin-top: 16px;">Log In</h1>').insertAfter('.lr-login .lrh-main-heading');
        $('.login-header:eq(1)').remove();
        createAccountToLoginBtn();
        utils.waitForElement('.lsu-change-mode').then(function () {
            // adding great account btn to right side
            $('.logInRowLeft').append($('.lsu-change-mode'));
            $('.lsu-change-mode:eq(1)').remove();
        });

        ownIDFixes ();
    }, 50);
}

function ownIDFixes () {
    utils.waitForElement('ownid-faceid-button-widget').then(function () {
        setTimeout(function () {
            if ($(window).width() < 960) {
                console.log('$width');
                var pswdStyle = $('#password').attr('style');
                $('#password').attr('style', 'margin-left: 90px !important; width: -webkit-fill-available !important');
            }
            document.querySelector('ownid-faceid-button-widget').shadowRoot.childNodes[1].childNodes[1].childNodes[1].attributes['style'].value = document.querySelector('ownid-faceid-button-widget').shadowRoot.childNodes[1].childNodes[1].childNodes[1].attributes['style'].value + 'border-radius: 8px;';
            
            document.querySelector('ownid-faceid-button-widget').shadowRoot.childNodes[1].childNodes.forEach((child, index) => { 
                if(child.className === 'or' && index > 2) {
                    console.log(child, index);
                  return child.remove();
                }
            });
        }, 50);
    });

    utils.waitForElement('ownid-fingerprint-button-widget').then(function () {
        setTimeout(function () {
            if ($(window).width() < 960) {
                console.log('$width');
                $('#password').attr('style', 'margin-left: 90px !important; width: -webkit-fill-available !important');
            }
            document.querySelector('ownid-fingerprint-button-widget').shadowRoot.childNodes[1].childNodes[1].childNodes[1].attributes['style'].value = document.querySelector('ownid-fingerprint-button-widget').shadowRoot.childNodes[1].childNodes[1].childNodes[1].attributes['style'].value + 'border-radius: 8px;';
            
            document.querySelector('ownid-fingerprint-button-widget').shadowRoot.childNodes[1].childNodes.forEach((child, index) => { 
                if(child.className === 'or' && index > 2) {
                    console.log(child,index);
                  return child.remove();
                }
            });
        }, 50);
    });
    
    $(document).ready(function () {
        ownid('destroy', 'login');
    
        window.ownid("login",
        {
    
            boxShadow: 'none',
            widgetPosition: 'end',
            infoTooltip: true,
            loginIdField: document.getElementById("username"),
            passwordField: document.getElementById("password"),
            passwordToggle: ".lrc-pwd-reveal-toggle",
            textColor:"#10549b",
            onError: (error) => onError({
                error: error
            }
    
            ),
            onLogin: (data) => onLogin({
                token: data.token
            })
        });
    });
}
}, "dependencies": []}, {"id": "B4E67F6C-1F1B-4DAE-AACA-4C5050C70697", "type": "append", "selector": "head", "value": "<style>.loginReact {\n    width: inherit !important;\n    max-width: inherit !important;\n    overflow: hidden !important;\n}\n\nownid-prompt-desktop,\n.lr-next-steps .lsu-change-mode,\n.lr-add-booking .lsu-change-mode {\n    display: none !important;\n}\n\n.lr-login,\n.lr-register {\n    min-height: 568px;\n    width: 872px;\n}\n\n.lr-forgot-password {\n    width: 872px;\n}\n\n.lr-forgot-username {\n    height: inherit;\n    min-width: 872px;\n}\n\n.lrh,\n.lr-login #lrh-heading,\n.lr-register #lrh-heading,\n.lr-forgot-password .lrh-main-heading, \n.lr-forgot-username .lrh-main-heading,\n.lr-next-steps .lrh-main-heading,\n.lr-next-steps .login-header{\n    display: none;\n}\n\n.lrh-heading {\n    color: #10559A !important;\n    font-size: 34px !important;\n    line-height: 40px !important;\n    text-align: left !important;\n}\n\n.lrh-close {\n    height: 24px !important;\n    width: 16px !important;\n    right: 56px !important;\n    top: 38px;\n}\n\n.lrh-close:after,\n.lrh-close:before {\n    width: 4px !important;\n    background: #10559a;\n}\n\n.lrc-field-label,\n.fuf-field-label,\n.ffr-label,\n.fpf-field-label {\n    font-size: 14px !important;\n    line-height: 18px !important;\n    color: #464646 !important;\n    margin-bottom: 8px !important;\n}\n\n.fuaf-message,\n.fum-owe .fum-owe-description,\n.fpc-owe-description,\n.cp-description-container {\n    font-size: 16px !important;\n    line-height: 20px !important;\n    color: #464646 !important;\n    text-align: left !important;\n}\n\n.lrc-envelope-icon,\n.lrc-padlock-icon,\n.fuf-field-row .ff-input,\n.fpf-field-row .ff-input,\n#firstName-pm,\n#lastName-pm,\n#gender-pm,\n#countryCode-pm,\n#domesticPhoneNumber-pm {\n    border: 1px solid #CBC9C9 !important;\n    color: #464646 !important;\n    border-radius: 4px !important;\n    font-size: 14px !important;\n    line-height: 18px !important;\n    width: 340px !important;\n    height: 56px !important;\n}\n\n.ff-input {\n    padding: 16px !important;\n}\n\n#dobMonth-pm {\n    padding: 14px !important;\n}\n\n.ffr-date-field .ff-input {\n    border: 1px solid #CBC9C9 !important;\n    border-radius: 4px !important;\n    font-size: 14px !important;\n    line-height: 18px !important;\n    height: 48px;\n    font-weight: 100;\n}\n\n.ff-input {\n    color: #10559a !important;\n}\n\n.ff-input {\n    color: #464646 !important;\n}\n\n.ff-select-wrapper-full img {\n    position: absolute;\n    right: 16px;\n    top: 20px;\n}\n\n.ccl-button-link:after,\n.cclr-button-link:after,\n.ccl-button-link:after,\n.cclr-button-link:after {\n    display: none;\n}\n\n.lr-view-content {\n    padding: 0 40px 0 48px !important;\n    width: 412px;\n    margin: 48px 0;\n}\n\n.lr-forgot-username .lr-view-content {\n    padding: 0 40px 0px 48px !important;\n}\n\n.lrc-pwd-reveal-toggle {\n    top: 56px !important;\n    margin-left: -120px !important;\n    font-size: 14px !important;\n}\n\n.ff-container {\n    padding: 24px 0 0 !important;\n}\n\n.fu-form,\n.fuf-submit-row,\n.lsu-form,\n.fpv-content,\n.fuaf-back {\n    margin-top: 0 !important;\n}\n\n.fpf-submit-row {\n    margin-top: 24px !important;\n}\n\n.fpc-back {\n    margin-top: 16px !important;\n}\n\n.fuf-form .ffr-date-field {\n    padding-bottom: 24px;\n}\n\n.fuaf-container {\n    padding: 16px 0 !important;\n\n}\n\n.fuaf-separator {\n    margin-top: 24px !important;\n    margin-bottom: 0 !important;\n}\n\n.lrc-password-row .ff-container {\n    padding: 12px 0 0 !important;\n}\n\n.lrc-password-row .lrc-field-label {\n    padding-left: 90px;\n}\n\n.lrc-link-right {\n    margin-top: 4px !important;\n    color: #10559A !important;\n    height: 16px;\n    line-height: 24px;\n}\n\n.lrc-forgot-cta {\n    color: #10559A !important;\n    font-size: 12px !important;\n    line-height: 16px;\n    top: -8px;\n    position: relative;\n    height: 16px;\n}\n\n.lrc-submit-button,\n.fpf-submit-button,\n.fuf-submit-button,\n#submit-guest-pm {\n    background-color: #10559A !important;\n    border-radius: 4px !important;\n    font-size: 18px !important;\n    line-height: 22px;\n    height: 48px;\n    width: 340px;\n}\n\n.lrc-submit-button:hover,\n.fpf-submit-button:hover,\n.fuf-submit-button:hover,\n#submit-guest-pm:hover {\n    background-color: #0E4883 !important;\n}\n\n#submit-guest-pm {\n    padding: initial !important;\n    margin-top: 16px;\n}\n\n.cp .cpc {\n    margin-bottom: 8px !important;\n}\n\n.lsu-footer {\n    border: none !important;\n    margin-top: 16px !important;\n    padding: 16px 0 0 0 !important;\n}\n\n.lsu-footer div {\n    display: flex;\n    flex-direction: column;\n    text-align: left;\n}\n\n.lsu-footer div .lsu-footer-label {\n    display: none;\n    margin-bottom: 8px;\n}\n\n.lrc-pwd-reveal-toggle:link,\n.lrc-pwd-reveal-toggle:hover,\n.lrc-pwd-reveal-toggle:visited,\n.lrc-pwd-reveal-toggle:active {\n    color: #10559A !important;\n}\n\n.lsu-change-mode {\n    color: #10559A !important;\n    font-size: 18px !important;\n    line-height: 18px;\n    font-family: Tempo, TempoStd, Open Sans, Helvetica, Sans-Serif;\n    height: 48px;\n    width: 180px;\n    top: 24px;\n    position: relative;\n    border: 1px solid #10559a;\n    border-radius: 4px;\n    text-transform: uppercase;\n    display: flex;\n    justify-content: center;\n    align-items: center;\n}\n\n.lsu-change-mode:hover {\n    background: #0E4883;\n    border: 1px solid #0E4883;\n    color: #FFFFFF !important;\n    text-decoration: none !important;\n}\n\n.lrc-submit-row {\n    margin-top: 24px !important;\n}\n\ninput.lrc-envelope-icon {\n    background: none !important;\n}\n\n.cgh-header__profile-menu--desktop img {\n    display: none;\n}\n\ninput:-internal-autofill-selected {\n    background-color: #FFFFFF !important;\n}\n\n.fpf-cancel,\n.fuf-link-center {\n    margin-top: 8px !important;\n}\n\n.fpf-cancel-cta,\n.fuf-cancel-cta,\n.fuaf-back-cta,\n.fpc-back-cta {\n    color: #10559a !important;\n    font-size: 14px !important;\n    line-height: 18px !important;\n}\n\n.lrh-close:after,\n.lrh-close:before {\n    display: none !important;\n}\n\n.ff-select-wrapper:after {\n    display: none;\n}\n\n.ffr-date-month {\n    width: 132px !important;\n    margin-right: 8px !important;\n}\n\n.ffr-date-day {\n    width: 96px !important;\n    margin-right: 8px !important;\n}\n\n.ffr-date-year {\n    width: 88px !important;\n}\n\n.fum-owe,\n.fpc-owe {\n    margin: 16px auto 0 !important;\n}\n\n.fpc-owe .fpc-owe-description {\n    text-align: left !important;\n    padding-bottom: 0 !important;\n}\n\n.fpc-owe {\n    color: #464646 !important;\n}\n\n.fuaf-heading {\n    font-size: 20px !important;\n    line-height: 24px !important;\n    text-align: left !important;\n    color: #464646 !important;\n    margin: 0 !important;\n    font-weight: 700;\n}\n\n.fuf-field-row .ff-input::placeholder,\n.fpf-field-row .ff-input::placeholder,\n#firstName-pm::placeholder,\n#lastName-pm::placeholder,\n#domesticPhoneNumber-pm::placeholder {\n    color: transparent !important;\n}\n\n.ffr-date-field .ff-input::placeholder {\n    font-weight: normal !important;\n}\n\nhr,\n.lr-forgot-username .lsu-change-mode,\n.lr-forgot-password .lsu-change-mode,\n.lr-complete-profile .lsu-change-mode,\n.lr-account-exists .lsu-change-mode,\n.lr-complete-profile .lrh-main-heading,\n.lr-complete-profile .login-header {\n    display: none;\n}\n\n.lr-view [contentEditable=true]:focus,\n.lr-view a[href]:focus,\n.lr-view area[href]:focus,\n.lr-view button:focus,\n.lr-view iframe:focus,\n.lr-view input:focus,\n.lr-view select:focus,\n.lr-view textarea:focus {\n    outline: 3px solid #00b5cb !important;\n    box-shadow: none !important;\n}\n\n.widget-container button {\n    border-radius: 8px;\n}\n\n.logInRowLeft {\n    height: 480px; \n    padding: 0 48px 48px 40px; \n    margin: 40px 0;\n    border-left: 1px solid #CBC9C9;\n}\n\n.joinVifpClub {\n    font-family: Open Sans; \n    font-size: 20px; \n    font-weight: 700; \n    line-height: 24px; \n    color: #464646;\n    margin-bottom: 16px;\n}\n\n.lrc-envelope-icon, .lrc-padlock-icon, .fuf-field-row .ff-input, .fpf-field-row .ff-input, #firstName-pm, #lastName-pm, #gender-pm, #countryCode-pm, #domesticPhoneNumber-pm {\n    width: 322px !important;\n}\n\n.lrc-pwd-reqs {\n    margin-top: 16px !important;\n    border-radius: 4px;\n    padding: 24px 24px 24px 48px !important;\n}\n\n.lrc-password-row #password {\n    padding-right: 43px !important;\n}\n\n.ffr-date-field  {\n    display: flex;\n    height: 102px;\n}\n\n/* Phone Styling*/\n@media only screen and (max-width: 768px) {\n    .lr-login, .lr-register {\n        height: inherit;\n        width: inherit;\n    }\n\n    .logInRow {\n        flex-direction: column;\n        align-items: center;\n    }\n\n    .ReactModal__Content--after-open[aria-labelledby=\"lrh-heading\"] {\n        overflow: auto !important;\n        width: calc(100% - 48px) !important;\n        height: calc(100% - 48px) !important;\n        margin-top: 24px;\n    }\n\n    .lr-view-content{\n        margin: 0 !important;\n        width: 100%;\n        padding: 24px 24px 0px 24px !important;\n    }\n\n    .logInRowLeft {\n        margin: 16px 0 24px 0 !important;\n        padding: 0px 24px 0 !important;\n        width: 100%;\n        height: 460px !important;\n        border-left: none;\n    }\n\n    .lrh-close {\n        top: 24px !important;\n        right: 32px !important;\n    }\n\n    .lsu-footer {\n        margin: 0 !important;\n        padding: 0 !important;\n    }\n\n    [src=\"//cdn.optimizely.com/img/752671897/0127960edb7748c79a5ff07c5b20bdb2.svgz\"],\n    [src=\"//cdn.optimizely.com/img/752671897/1199d2b3c6764e429051dea4edab0a55.svgz\"],\n    .lrc-submit-button, .fpf-submit-button, .fuf-submit-button, #submit-guest-pm, .lr-forgot-password, .lrc-envelope-icon, .lrc-padlock-icon, .fuf-field-row .ff-input, .fpf-field-row .ff-input, #firstName-pm, #lastName-pm, #gender-pm, #countryCode-pm, #domesticPhoneNumber-pm  {\n        width: 100% !important;\n    }\n\n    #username {\n        width: 100% !important;\n    }\n\n    .ff-input#password {\n        width: 66% !important;\n        min-width: -webkit-fill-available !important;\n    }\n\n    .lrh-heading {\n        font-size: 24px !important;\n        line-height: 28px !important;\n    }\n\n    .logInRowLeft br {\n        display: none;\n    }\n\n    .logInRowLeft h4 {\n        width: inherit !important;\n    }\n\n    .lr-forgot-username {\n        min-width: inherit !important;\n    }\n\n    .lr-forgot-username .lr-view-content,\n    .lr-forgot-password .lr-view-content {\n        padding: 24px 24px 0px  !important;\n    }\n\n    .joinVifpClub {\n        padding-top: 16px;\n        border-top: 1px solid #CBC9C9 !important;\n    }\n\n    .fpc-owe .fpc-owe-description {\n        width: 100%;\n    }\n\n    .lsu-change-mode {\n        height: auto !important;\n        width: 100%;\n        display: block;\n        text-align: center;\n        padding: 16px 24px !important;\n    }\n}</style>", "dependencies": []}, {"id": "FFE8063C-F8DA-4555-B570-9628D840168B", "type": "append", "dependencies": [], "selector": ".joinVifpClub", "value": "<img src='//cdn.optimizely.com/img/752671897/1199d2b3c6764e429051dea4edab0a55.svgz' />", "operator": "after"}, {"id": "1373D5BD-928A-4700-B09A-3016E1A0F923", "type": "append", "dependencies": [], "selector": ".lrh-close", "value": "<img src='//cdn.optimizely.com/img/752671897/51cbdfdd2c3f47c6a0485b2067f48b63.svgz' />", "operator": "prepend"}]}]}], "weightDistributions": null, "name": "All | Exclude Synthetic Script \"KTNX\" and Roy's Test Cookie Exclusion", "bucketingStrategy": null, "experimentMetadata": {"allocationPolicy": "manual", "layerId": "25261330827"}}, {"audienceIds": ["and", "10261134200", "19057934687"], "audienceName": "All | Exclude Synthetic Script \"KTNX\",Roy's Test Cookie", "changes": null, "id": "27154720238", "integrationSettings": null, "variations": [{"id": "27209840154", "name": "Variation #1", "actions": [{"viewId": "20742590357", "changes": [{"id": "5E4553AB-F8F4-440E-91CD-34114251F1DF", "type": "custom_code", "value": function($){var $ = jQuery;
var utils = window.optimizely.get("utils");

var coupleIMG = $('[src="//cdn.optimizely.com/img/752671897/3e416005db1940b49187616e613d1b5f.svg"]');
var checkIMG = $('[src="//cdn.optimizely.com/img/752671897/dcd8ef7fc9e04a10a6696025a7d54b83.svg"]').clone();
utils.waitForElement('.lr-view').then(function () {
    setTimeout(function () {
        var headingAttr = $('[aria-labelledby="lrh-heading"]').attr('style') + 'border-radius: 8px;';
        $('[aria-labelledby="lrh-heading"]').attr('style', headingAttr);
        $('#lrh-heading').attr('aria-hidden', 'false');
        // adding login on the left side
        $('.lr-login .lr-view-content').prepend('<h1 class="login-header" style="font-family: Open Sans; font-size: 20px; line-height: 24px; font-weight: 700; color: #464646; margin-top: 16px; aria-hidden="true"">Log In</h1>');
        // adding create account on the left side
        $('.lr-register .lr-view-content').prepend('<h1 class="login-header" style="font-family: Open Sans; font-size: 20px; line-height: 24px; font-weight: 700; color: #464646; margin-top: 16px; aria-hidden="true"">Create Account</h1>');
        $('.lr-view-content').prepend($('<span class="lrh-heading lrh-main-heading">Carnival Vifp Club</span>'));
        //  adding header above login
        $('.lr-view-content').prepend($('.lrh-heading'));
        $('<div class="logInRow" style="display: flex;"></div>').insertAfter($('.lrh'));

        $('.logInRow').prepend($('.lr-view-content'));
        // create account header
        $('.logInRow').append('<div class="logInRowLeft"><h2 class="joinVifpClub" style= "">VIFP Club</h2></div>');
        // adding X btn to join vifp club
        $('.lrh-close').insertAfter($('.logInRowLeft h2'));
        $('.lrh-close').attr('aria-label', 'Close button');
      $('[src="//cdn.optimizely.com/img/752671897/1199d2b3c6764e429051dea4edab0a55.svgz"]').attr('alt', '');
        // building list
        $('.logInRowLeft').append('<div style="margin-top: -8px;"><p style="font-family: Open Sans; font-size: 16px; color: #464646; font-weight: 700; margin: 24px 0px 16px; width: 342px;">Get exclusive member rates and offers. </br> Log in or create account.</p><ul style="font-family: Open Sans; font-size: 12px; line-height: 16px; color: #464646; list-style: none;padding: 0;"><li style="margin: 8px 0;"><img src ="//cdn.optimizely.com/img/752671897/dcd8ef7fc9e04a10a6696025a7d54b83.svg" /><span style="margin-left: 8px;">Special Offers</span></li><li style="margin: 8px 0;"><img src ="//cdn.optimizely.com/img/752671897/dcd8ef7fc9e04a10a6696025a7d54b83.svg" /><span style="margin-left: 8px;">Personalized Recommendations</span></li><li style="margin: 8px 0;"><img src ="//cdn.optimizely.com/img/752671897/dcd8ef7fc9e04a10a6696025a7d54b83.svg" /><span style="margin-left: 8px;">Members only cocktail receptions</span></li><li style="margin: 8px 0;"><img src ="//cdn.optimizely.com/img/752671897/dcd8ef7fc9e04a10a6696025a7d54b83.svg" /><span style="margin-left: 8px;">Priority boarding and much more!</span></li></ul></div>');
        // changing signup to create an account from create account cta
        $('.lr-register .lrc-submit-button').text('Create Account');

        $('.lr-view').parent().parent().addClass('loginReact');

        $('#username').focus();

        utils.waitForElement('.lsu-change-mode').then(function () {
            // adding create account btn to right side
            $('.logInRowLeft').append($('.lsu-change-mode'));
            $('.lsu-change-mode').attr('tabindex', '0');
            if(window.location.pathname === '/payment/bookings/checkout') { 
                $('.lsu-change-mode').hide(); 
            }
        });

        ownIDFixes ();
    }, 50);
    $('body').click(function (e) { 
        if(e.target== document.querySelector('.ReactModal__Overlay--after-open')) {
            document.getElementsByClassName("lrh-close")[0].click(); 
        }            
    });
});

$(document).on('click', '.fpc-back-cta', function () {
    fullBackToLogin();
});

utils.waitForElement('.lrc-submit-button').then(function () {

    // removing ! from login cta
    $('.lr-login .lrc-submit-button').text('LOG IN');
});

utils.waitForElement('[src="//cdn.optimizely.com/img/752671897/3e416005db1940b49187616e613d1b5f.svg"]').then(function () {
    // fixing the width of the image
    $('[src="//cdn.optimizely.com/img/752671897/3e416005db1940b49187616e613d1b5f.svg"]').attr('style', 'width: 363px;');
});

utils.waitForElement('.ff-input').then(function () {
    // removing placeholder
    $('.ff-input').attr('placeholder', '');
});

$(document).on('click', '.lr-login .lsu-change-mode', function () {
    utils.waitForElement('.lr-view').then(function () {
        loginToCreateAccountBtn();
    });
});

$(document).on("keydown", function (e) {
    var target = e.target;
    var shiftPressed = e.shiftKey;
    if (e.keyCode == 9 && $(target).is($('.lrh-close')) && $('.lsu-change-mode:not(:visible)')) {
        console.log('$tab')
        $('.lrh-heading').focus();
    } 
});

$(document).on('click', '.lr-register .lsu-change-mode', function () {
    utils.waitForElement('.lr-view').then(function () {
        createAccountToLoginBtn();
    });
});

$(document).on('click', '.fuaf-back-cta', function () {
    fullBackToLogin();
});

$(document).on('click', '.lrc-forgot-cta', function () {
    $('.login-header').remove();
});

$(document).on('click', '.fuf-cancel-cta', function () {
    fullBackToLogin();
});

$(document).on('click', '.aae-btn', function () {
    fullBackToLogin();
});

$(document).on('click', '.fpf-cancel-cta', function () {
    fullBackToLogin();
});

$(document).on('click', '.cp-cancel-cta', function () {
    fullBackToLogin();
    utils.waitForElement('.login-header').then(function () {
        setTimeout(function () {
            // adding create account on the left side
            $('.login-header').text('Create Account');
        }, 450);
    });
});


function loginToCreateAccountBtn() {
    // $('.lrh-heading').text('CARNIVAL VIFP CLUB');
    // adding create account on the left side
    $('.login-header').text('Create Account');
    // changing signup to create an account from create account cta
    
    setTimeout(function () {
        // removing placeholder
        $('.ff-input').attr('placeholder', '');
        $('.lr-register .lrc-submit-button').text('Create Account');
    }, 150);

    ownIDFixes ();
}

function createAccountToLoginBtn() {
    // $('.lrh-heading').text('CARNIVAL VIFP CLUB');
    // adding create account on the left side
    $('.login-header').text('Log In');
    setTimeout(function () {
        // removing placeholder
        $('.ff-input').attr('placeholder', '');
        // changing signup to create an account from create account cta
        $('.lr-login .lrc-submit-button').text('Log In');
    }, 150);

    ownIDFixes ();
}

function fullBackToLogin() {
    setTimeout(function () {
        console.log('back to login');
        // $('.lrh-heading').text('CARNIVAL VIFP CLUB');
        // adding login on the left side
        $('<h1 class="login-header" style="text-transform: capitalize; font-family: Open Sans; font-size: 20px; line-height: 24px; font-weight: 700; color: #464646; margin-top: 16px;">Log In</h1>').insertAfter('.lr-login .lrh-main-heading');
        $('.login-header:eq(1)').remove();
        createAccountToLoginBtn();
        utils.waitForElement('.lsu-change-mode').then(function () {
            // adding great account btn to right side
            $('.logInRowLeft').append($('.lsu-change-mode'));
            $('.lsu-change-mode:eq(1)').remove();
        });

        ownIDFixes ();
    }, 50);
}

function ownIDFixes () {
    utils.waitForElement('ownid-faceid-button-widget').then(function () {
        setTimeout(function () {
            if ($(window).width() < 960) {
                console.log('$width');
                var pswdStyle = $('#password').attr('style');
                $('#password').attr('style', 'margin-left: 90px !important; width: -webkit-fill-available !important');
            }
            document.querySelector('ownid-faceid-button-widget').shadowRoot.childNodes[1].childNodes[1].childNodes[1].attributes['style'].value = document.querySelector('ownid-faceid-button-widget').shadowRoot.childNodes[1].childNodes[1].childNodes[1].attributes['style'].value + 'border-radius: 8px;';
            
            document.querySelector('ownid-faceid-button-widget').shadowRoot.childNodes[1].childNodes.forEach((child, index) => { 
                if(child.className === 'or' && index > 2) {
                    console.log(child, index);
                  return child.remove();
                }
            });
        }, 50);
    });

    utils.waitForElement('ownid-fingerprint-button-widget').then(function () {
        setTimeout(function () {
            if ($(window).width() < 960) {
                console.log('$width');
                $('#password').attr('style', 'margin-left: 90px !important; width: -webkit-fill-available !important');
            }
            document.querySelector('ownid-fingerprint-button-widget').shadowRoot.childNodes[1].childNodes[1].childNodes[1].attributes['style'].value = document.querySelector('ownid-fingerprint-button-widget').shadowRoot.childNodes[1].childNodes[1].childNodes[1].attributes['style'].value + 'border-radius: 8px;';
            
            document.querySelector('ownid-fingerprint-button-widget').shadowRoot.childNodes[1].childNodes.forEach((child, index) => { 
                if(child.className === 'or' && index > 2) {
                    console.log(child,index);
                  return child.remove();
                }
            });
        }, 50);
    });
    
    $(document).ready(function () {
        ownid('destroy', 'login');
    
        window.ownid("login",
        {
    
            boxShadow: 'none',
            widgetPosition: 'end',
            infoTooltip: true,
            loginIdField: document.getElementById("username"),
            passwordField: document.getElementById("password"),
            passwordToggle: ".lrc-pwd-reveal-toggle",
            textColor:"#10549b",
            onError: (error) => onError({
                error: error
            }
    
            ),
            onLogin: (data) => onLogin({
                token: data.token
            })
        });
    });
}
}, "dependencies": []}, {"id": "B4E67F6C-1F1B-4DAE-AACA-4C5050C70697", "type": "append", "selector": "head", "value": "<style>.loginReact {\n    width: inherit !important;\n    max-width: inherit !important;\n    overflow: hidden !important;\n}\n\nownid-prompt-desktop,\n.lr-next-steps .lsu-change-mode,\n.lr-add-booking .lsu-change-mode {\n    display: none !important;\n}\n\n.lr-login,\n.lr-register {\n    min-height: 568px;\n    width: 872px;\n}\n\n.lr-forgot-password {\n    width: 872px;\n}\n\n.lr-forgot-username {\n    height: inherit;\n    min-width: 872px;\n}\n\n.lrh,\n.lr-login #lrh-heading,\n.lr-register #lrh-heading,\n.lr-forgot-password .lrh-main-heading, \n.lr-forgot-username .lrh-main-heading{\n    display: none;\n}\n\n.lrh-heading {\n    color: #10559A !important;\n    font-size: 34px !important;\n    line-height: 40px !important;\n    text-align: left !important;\n}\n\n.lrh-close {\n    height: 24px !important;\n    width: 16px !important;\n    right: 56px !important;\n    top: 38px;\n}\n\n.lrh-close:after,\n.lrh-close:before {\n    width: 4px !important;\n    background: #10559a;\n}\n\n.lrc-field-label,\n.fuf-field-label,\n.ffr-label,\n.fpf-field-label {\n    font-size: 14px !important;\n    line-height: 18px !important;\n    color: #464646 !important;\n    margin-bottom: 8px !important;\n}\n\n.fuaf-message,\n.fum-owe .fum-owe-description,\n.fpc-owe-description,\n.cp-description-container {\n    font-size: 16px !important;\n    line-height: 20px !important;\n    color: #464646 !important;\n    text-align: left !important;\n}\n\n.lrc-envelope-icon,\n.lrc-padlock-icon,\n.fuf-field-row .ff-input,\n.fpf-field-row .ff-input,\n#firstName-pm,\n#lastName-pm,\n#gender-pm,\n#countryCode-pm,\n#domesticPhoneNumber-pm {\n    border: 1px solid #CBC9C9 !important;\n    color: #464646 !important;\n    border-radius: 4px !important;\n    font-size: 14px !important;\n    line-height: 18px !important;\n    width: 340px !important;\n    height: 56px !important;\n}\n\n.ff-input {\n    padding: 16px !important;\n}\n\n#dobMonth-pm {\n    padding: 14px !important;\n}\n\n.ffr-date-field .ff-input {\n    border: 1px solid #CBC9C9 !important;\n    border-radius: 4px !important;\n    font-size: 14px !important;\n    line-height: 18px !important;\n    height: 48px;\n    font-weight: 100;\n}\n\n.ff-input {\n    color: #10559a !important;\n}\n\n.ff-input {\n    color: #464646 !important;\n}\n\n.ff-select-wrapper-full img {\n    position: absolute;\n    right: 16px;\n    top: 20px;\n}\n\n.ccl-button-link:after,\n.cclr-button-link:after,\n.ccl-button-link:after,\n.cclr-button-link:after {\n    display: none;\n}\n\n.lr-view-content {\n    padding: 0 40px 0 48px !important;\n    width: 412px;\n    margin: 48px 0;\n}\n\n.lr-forgot-username .lr-view-content {\n    padding: 0 40px 0px 48px !important;\n}\n\n.lrc-pwd-reveal-toggle {\n    top: 56px !important;\n    margin-left: -120px !important;\n    font-size: 14px !important;\n}\n\n.ff-container {\n    padding: 24px 0 0 !important;\n}\n\n.fu-form,\n.fuf-submit-row,\n.lsu-form,\n.fpv-content,\n.fuaf-back {\n    margin-top: 0 !important;\n}\n\n.fpf-submit-row {\n    margin-top: 24px !important;\n}\n\n.fpc-back {\n    margin-top: 16px !important;\n}\n\n.fuf-form .ffr-date-field {\n    padding-bottom: 24px;\n}\n\n.fuaf-container {\n    padding: 16px 0 !important;\n\n}\n\n.fuaf-separator {\n    margin-top: 24px !important;\n    margin-bottom: 0 !important;\n}\n\n.lrc-password-row .ff-container {\n    padding: 12px 0 0 !important;\n}\n\n.lrc-password-row .lrc-field-label {\n    padding-left: 90px;\n}\n\n.lrc-link-right {\n    margin-top: 4px !important;\n    color: #10559A !important;\n    height: 16px;\n    line-height: 24px;\n}\n\n.lrc-forgot-cta {\n    color: #10559A !important;\n    font-size: 12px !important;\n    line-height: 16px;\n    top: -8px;\n    position: relative;\n    height: 16px;\n}\n\n.lrc-submit-button,\n.fpf-submit-button,\n.fuf-submit-button,\n#submit-guest-pm {\n    background-color: #10559A !important;\n    border-radius: 4px !important;\n    font-size: 18px !important;\n    line-height: 22px;\n    height: 48px;\n    width: 340px;\n}\n\n.lrc-submit-button:hover,\n.fpf-submit-button:hover,\n.fuf-submit-button:hover,\n#submit-guest-pm:hover {\n    background-color: #0E4883 !important;\n}\n\n#submit-guest-pm {\n    padding: initial !important;\n    margin-top: 16px;\n}\n\n.cp .cpc {\n    margin-bottom: 8px !important;\n}\n\n.lsu-footer {\n    border: none !important;\n    margin-top: 16px !important;\n    padding: 16px 0 0 0 !important;\n}\n\n.lsu-footer div {\n    display: flex;\n    flex-direction: column;\n    text-align: left;\n}\n\n.lsu-footer div .lsu-footer-label {\n    display: none;\n    margin-bottom: 8px;\n}\n\n.lrc-pwd-reveal-toggle:link,\n.lrc-pwd-reveal-toggle:hover,\n.lrc-pwd-reveal-toggle:visited,\n.lrc-pwd-reveal-toggle:active {\n    color: #10559A !important;\n}\n\n.lsu-change-mode {\n    color: #10559A !important;\n    font-size: 18px !important;\n    line-height: 18px;\n    font-family: Tempo, TempoStd, Open Sans, Helvetica, Sans-Serif;\n    height: 48px;\n    width: 180px;\n    top: 24px;\n    position: relative;\n    border: 1px solid #10559a;\n    border-radius: 4px;\n    text-transform: uppercase;\n    display: flex;\n    justify-content: center;\n    align-items: center;\n}\n\n.lsu-change-mode:hover {\n    background: #0E4883;\n    border: 1px solid #0E4883;\n    color: #FFFFFF !important;\n    text-decoration: none !important;\n}\n\n.lrc-submit-row {\n    margin-top: 24px !important;\n}\n\ninput.lrc-envelope-icon {\n    background: none !important;\n}\n\n.cgh-header__profile-menu--desktop img {\n    display: none;\n}\n\ninput:-internal-autofill-selected {\n    background-color: #FFFFFF !important;\n}\n\n.fpf-cancel,\n.fuf-link-center {\n    margin-top: 8px !important;\n}\n\n.fpf-cancel-cta,\n.fuf-cancel-cta,\n.fuaf-back-cta,\n.fpc-back-cta {\n    color: #10559a !important;\n    font-size: 14px !important;\n    line-height: 18px !important;\n}\n\n.lrh-close:after,\n.lrh-close:before {\n    display: none !important;\n}\n\n.ff-select-wrapper:after {\n    display: none;\n}\n\n.ffr-date-month {\n    width: 132px !important;\n    margin-right: 8px !important;\n}\n\n.ffr-date-day {\n    width: 96px !important;\n    margin-right: 8px !important;\n}\n\n.ffr-date-year {\n    width: 88px !important;\n}\n\n.fum-owe,\n.fpc-owe {\n    margin: 16px auto 0 !important;\n}\n\n.fpc-owe .fpc-owe-description {\n    text-align: left !important;\n    padding-bottom: 0 !important;\n}\n\n.fpc-owe {\n    color: #464646 !important;\n}\n\n.fuaf-heading {\n    font-size: 20px !important;\n    line-height: 24px !important;\n    text-align: left !important;\n    color: #464646 !important;\n    margin: 0 !important;\n    font-weight: 700;\n}\n\n.fuf-field-row .ff-input::placeholder,\n.fpf-field-row .ff-input::placeholder,\n#firstName-pm::placeholder,\n#lastName-pm::placeholder,\n#domesticPhoneNumber-pm::placeholder {\n    color: transparent !important;\n}\n\n.ffr-date-field .ff-input::placeholder {\n    font-weight: normal !important;\n}\n\nhr,\n.lr-forgot-username .lsu-change-mode,\n.lr-forgot-password .lsu-change-mode,\n.lr-complete-profile .lsu-change-mode,\n.lr-account-exists .lsu-change-mode {\n    display: none;\n}\n\n.lr-view [contentEditable=true]:focus,\n.lr-view a[href]:focus,\n.lr-view area[href]:focus,\n.lr-view button:focus,\n.lr-view iframe:focus,\n.lr-view input:focus,\n.lr-view select:focus,\n.lr-view textarea:focus {\n    outline: 3px solid #00b5cb !important;\n    box-shadow: none !important;\n}\n\n.widget-container button {\n    border-radius: 8px;\n}\n\n.logInRowLeft {\n    height: 480px; \n    padding: 0 48px 48px 40px; \n    margin: 40px 0;\n    border-left: 1px solid #CBC9C9;\n}\n\n.joinVifpClub {\n    font-family: Open Sans; \n    font-size: 20px; \n    font-weight: 700; \n    line-height: 24px; \n    color: #464646;\n    margin-bottom: 16px;\n}\n\n.lrc-envelope-icon, .lrc-padlock-icon, .fuf-field-row .ff-input, .fpf-field-row .ff-input, #firstName-pm, #lastName-pm, #gender-pm, #countryCode-pm, #domesticPhoneNumber-pm {\n    width: 322px !important;\n}\n\n.lrc-pwd-reqs {\n    margin-top: 16px !important;\n    border-radius: 4px;\n    padding: 24px 24px 24px 48px !important;\n}\n\n.lrc-password-row #password {\n    padding-right: 43px !important;\n}\n\n.ffr-date-field  {\n    display: flex;\n    height: 102px;\n}\n\n/* Phone Styling*/\n@media only screen and (max-width: 768px) {\n    .lr-login, .lr-register {\n        height: inherit;\n        width: inherit;\n    }\n\n    .logInRow {\n        flex-direction: column;\n        align-items: center;\n    }\n\n    .ReactModal__Content--after-open[aria-labelledby=\"lrh-heading\"] {\n        overflow: auto !important;\n        width: calc(100% - 48px) !important;\n        height: calc(100% - 48px) !important;\n        margin-top: 24px;\n    }\n\n    .lr-view-content{\n        margin: 0 !important;\n        width: 100%;\n        padding: 24px 24px 0px 24px !important;\n    }\n\n    .logInRowLeft {\n        margin: 16px 0 24px 0 !important;\n        padding: 0px 24px 0 !important;\n        width: 100%;\n        height: 460px !important;\n        border-left: none;\n    }\n\n    .lrh-close {\n        top: 24px !important;\n        right: 32px !important;\n    }\n\n    .lsu-footer {\n        margin: 0 !important;\n        padding: 0 !important;\n    }\n\n    [src=\"//cdn.optimizely.com/img/752671897/0127960edb7748c79a5ff07c5b20bdb2.svgz\"],\n    [src=\"//cdn.optimizely.com/img/752671897/1199d2b3c6764e429051dea4edab0a55.svgz\"],\n    .lrc-submit-button, .fpf-submit-button, .fuf-submit-button, #submit-guest-pm, .lr-forgot-password, .lrc-envelope-icon, .lrc-padlock-icon, .fuf-field-row .ff-input, .fpf-field-row .ff-input, #firstName-pm, #lastName-pm, #gender-pm, #countryCode-pm, #domesticPhoneNumber-pm  {\n        width: 100% !important;\n    }\n\n    #username {\n        width: 100% !important;\n    }\n\n    .ff-input#password {\n        width: 66% !important;\n        min-width: -webkit-fill-available !important;\n    }\n\n    .lrh-heading {\n        font-size: 24px !important;\n        line-height: 28px !important;\n    }\n\n    .logInRowLeft br {\n        display: none;\n    }\n\n    .logInRowLeft h4 {\n        width: inherit !important;\n    }\n\n    .lr-forgot-username {\n        min-width: inherit !important;\n    }\n\n    .lr-forgot-username .lr-view-content,\n    .lr-forgot-password .lr-view-content {\n        padding: 24px 24px 0px  !important;\n    }\n\n    .joinVifpClub {\n        padding-top: 16px;\n        border-top: 1px solid #CBC9C9 !important;\n    }\n\n    .fpc-owe .fpc-owe-description {\n        width: 100%;\n    }\n\n    .lsu-change-mode {\n        height: auto !important;\n        width: 100%;\n        display: block;\n        text-align: center;\n        padding: 16px 24px !important;\n    }\n}</style>", "dependencies": []}, {"id": "FFE8063C-F8DA-4555-B570-9628D840168B", "type": "append", "dependencies": [], "selector": ".joinVifpClub", "value": "<img src='//cdn.optimizely.com/img/752671897/1199d2b3c6764e429051dea4edab0a55.svgz' />", "operator": "after"}, {"id": "1373D5BD-928A-4700-B09A-3016E1A0F923", "type": "append", "dependencies": [], "selector": ".lrh-close", "value": "<img src='//cdn.optimizely.com/img/752671897/51cbdfdd2c3f47c6a0485b2067f48b63.svgz' />", "operator": "prepend"}]}]}], "weightDistributions": null, "name": "Copy of All | Exclude Synthetic Script \"KTNX\" and Roy's Test Cookie", "bucketingStrategy": null, "experimentMetadata": {"allocationPolicy": "manual", "layerId": "25261330827"}}], "policy": "equal_priority", "viewIds": ["11496281470", "20742590357"], "weightDistributions": null, "decisionMetadata": {"experimentPriorities": [[{"entityId": "25218250938", "endOfRange": null}], [{"entityId": "27154720238", "endOfRange": null}]], "experimentWeights": null, "offerConsistency": null}}, {"changes": null, "id": "19982817360", "name": "Personalization | HP | FAC ", "commitId": "20058402726", "groupId": null, "holdback": 500, "activation": {}, "integrationSettings": {}, "integrationStringVersion": 2, "experiments": [{"audienceIds": ["and", "19886510107", "14246380333"], "audienceName": "RMKTG Itinerary Abandoner FAC ,Non-Booked Guest - AND - Not CH session", "changes": null, "id": "19994606742", "integrationSettings": null, "variations": [{"id": "20000707174", "name": "Variation #1", "actions": [{"viewId": "9414621687", "changes": [{"dependencies": [], "type": "custom_code", "id": "8BAE2DF8-814D-401C-AEBA-A6173BF6DBEE", "value": function($){var $ = window.jQuery || window.optimizely.get('jquery');
var utils = window.optimizely.get('utils');

utils.waitForElement('.cdc-mobile-filters').then(function(){

  var behavior = optimizely.get('behavior');
  var res =  behavior.query({
    "version": "0.2",
    "filter" : [
      {
        "field":["type"],
        "value":"pageview"
      },
      {
        "field":["name"],
        "value":"1912722625_shopping_funnel"
      }
    ]
  });

  var data = res[res.length -1].tags;

  var itinPort = data.embark_port_code;
  var itinDest = data.destination_code;

  utils.waitUntil(function() {
    var filtersOptions = $(".cdc-mobile-filters").scope().model.filterCollection.destinations.options;
    return filtersOptions && filtersOptions.length >= 5;
  }).then(function() {

    var destOps = $('.cdc-mobile-filters').scope().model.filterCollection.destinations.options;
    var portOps = $('.cdc-mobile-filters').scope().model.filterCollection.ports.options;

    var selectedDests = destOps.filter(function(dest) {return dest.code.toLowerCase() === itinDest.toLowerCase();});
    var selectedPorts = portOps.filter(function(port) {return port.code.toLowerCase() === itinPort.toLowerCase();});

    selectedDests.forEach(function(dest) {
      $(".cdc-mobile-filters").scope().model.filterCollection.destinations.selectedOptions.push(dest);
    });

    selectedPorts.forEach(function(port) {
      $(".cdc-mobile-filters").scope().model.filterCollection.ports.selectedOptions.push(port);
    });

    $(".cdc-mobile-filters").scope().model.filterCollection.destinations.onFiltersChanged($(".cdc-mobile-filters").scope().model.filterCollection.destinations.selectedOptions)
    $(".cdc-mobile-filters").scope().model.filterCollection.ports.onFiltersChanged($(".cdc-mobile-filters").scope().model.filterCollection.ports.selectedOptions)

    $('<span id="resetFACFilters" style="position: absolute;right: 10px;color: #07539c;top: 4px;font-weight: bold; height:40px; cursor: pointer;"><svg aria-hidden=true data-icon=redo-alt data-prefix=fas focusable=false role=img style="width:12px; margin-right:2px;" viewBox="0 0 512 512"xmlns=http://www.w3.org/2000/svg><path d="M256.455 8c66.269.119 126.437 26.233 170.859 68.685l35.715-35.715C478.149 25.851 504 36.559 504 57.941V192c0 13.255-10.745 24-24 24H345.941c-21.382 0-32.09-25.851-16.971-40.971l41.75-41.75c-30.864-28.899-70.801-44.907-113.23-45.273-92.398-.798-170.283 73.977-169.484 169.442C88.764 348.009 162.184 424 256 424c41.127 0 79.997-14.678 110.629-41.556 4.743-4.161 11.906-3.908 16.368.553l39.662 39.662c4.872 4.872 4.631 12.815-.482 17.433C378.202 479.813 319.926 504 256 504 119.034 504 8.001 392.967 8 256.002 7.999 119.193 119.646 7.755 256.455 8z"fill=currentColor></path></svg>Reset</span>').insertAfter('.cdc-widget-header')
  });
  $('#ccl-cruise-search-widget > ccl-cruise-search > div.ccs-container.ccs-container--widget > ccl-cruise-search-bar > div > div.cdc-filters-container.cdc-filters-container--mobile-visible > div > div.cdc-mobile-filters.ng-scope > a > span').text('CONTINUE SEARCHING')
  $('body').on('click',"#resetFACFilters", resetFilters);

});

function resetFilters(){
  $(".cdc-mobile-filters").scope().model.filterCollection.destinations.selectedOptions.splice(0,$(".cdc-mobile-filters").scope().model.filterCollection.destinations.selectedOptions.length);
  $(".cdc-mobile-filters").scope().model.filterCollection.ports.selectedOptions.splice(0,$(".cdc-mobile-filters").scope().model.filterCollection.ports.selectedOptions.length);
  $(".cdc-mobile-filters").scope().model.filterCollection.destinations.onFiltersChanged($(".cdc-mobile-filters").scope().model.filterCollection.destinations.selectedOptions);
  $(".cdc-mobile-filters").scope().model.filterCollection.ports.onFiltersChanged($(".cdc-mobile-filters").scope().model.filterCollection.ports.selectedOptions);
  $('#resetFACFilters').css('display','none');
  $('#ccl-cruise-search-widget > ccl-cruise-search > div.ccs-container.ccs-container--widget > ccl-cruise-search-bar > div > div.cdc-filters-container.cdc-filters-container--mobile-visible > div > div.cdc-mobile-filters.ng-scope > a > span').text('SEARCH CRUISES')
}
}}]}]}], "weightDistributions": null, "name": "Itinerary Abandoner - FAC Prepopulating", "bucketingStrategy": null, "experimentMetadata": {"allocationPolicy": "manual", "layerId": "19982817360"}}], "policy": "equal_priority", "viewIds": ["9414621687"], "weightDistributions": null, "decisionMetadata": {"experimentPriorities": [[{"entityId": "19994606742", "endOfRange": null}]], "experimentWeights": null, "offerConsistency": null}}, {"changes": [{"dependencies": [], "type": "custom_code", "id": "8BC38C5B-D94D-4BBA-8612-6E4018E44C9D", "value": function($){var $ = window.optimizely.get('jquery');

$( document ).ready(function() {
//set ktnx cookie  
	document.cookie = 'KTNX=true; expires=" + expires.toGMTString() + "; path=/';
  
//set override cookie 
  document.cookie = 'CclSessionOverrides=ProfileManagement.ShowHideConfig.UseCaptcha%3Dfalse%26BookedGuest.BookedGuestMiscConfigurationDto.EnableCaptcha%3Dfalse; path=/; domain=carnival.com';
  
  });
}}], "id": "9438510550", "name": "Synthetic Script Exclusion Cookie", "commitId": "10938101353", "groupId": null, "holdback": 0, "activation": {}, "integrationSettings": {}, "integrationStringVersion": 2, "experiments": [{"audienceIds": ["or", "9413671777"], "audienceName": "KTNX Cookie | DO NOT USE ", "changes": null, "id": "9418390860", "integrationSettings": null, "variations": [{"id": "9428400877", "name": "Original", "actions": []}], "weightDistributions": null, "name": "Synthetic Script Exclusion Cookie", "bucketingStrategy": null, "experimentMetadata": {"allocationPolicy": "manual", "layerId": "9438510550"}}], "policy": "single_experiment", "viewIds": ["9431051150"], "weightDistributions": null, "decisionMetadata": null}, {"changes": null, "id": "18910343000", "name": "Personalization:  HP | Courtesy Hold Takeover - tile section", "commitId": "6748374392111104", "groupId": null, "holdback": 500, "activation": {}, "integrationSettings": {"google_universal_analytics": {"universal_analytics_tracker": "t55", "universal_analytics_slot": "149"}}, "integrationStringVersion": 2, "experiments": [{"audienceIds": ["and", "13142870528"], "audienceName": "BG | Courtesy Hold Session", "changes": null, "id": "20571930140", "integrationSettings": null, "variations": [{"id": "20573820125", "name": "Variation #1", "actions": [{"viewId": "9414621687", "changes": [{"dependencies": [], "type": "custom_code", "id": "88D3DDE7-547B-4850-8A42-5CF5DB518242", "value": function($){var $ = window.jQuery;
var utils = window.optimizely.get('utils');
var chInfo = JSON.parse(optimizely.get('visitor').cookies.cclCH);

//Uplift Prequal




var roomTypeMap = {
  SU: "Suite",
  UL:'Interior',
  OB:'Balcony',
  OS: 'OceanView'
};

function getResults(url, callback){
  $.ajax({
    type: "GET",
    cache: true,
    url: url,
    fail:function(){console.log('fail');},
    success: callback
  });
}


function insertHtml(selector){
  var container = $('<div>').addClass('chSummary');

  var leftcontainer = $('<div>').addClass('leftSide');
  var itinTitle = $('<h3>').append(chInfo.ItineraryName).addClass('primaryHeading');
  leftcontainer.append(itinTitle);

  var itinSumm = $('<p>').append(chInfo.ShipName + ': ' ).addClass('secondaryHeading itinSum');
  leftcontainer.append(itinSumm);

  var shipPlan = $('<a>').attr('href','/cruise-ships/'+chInfo.ShipName.replace(' ', '-')+'?icid=icp_ccl_ch42415_v1_hm_cTile').append('Explore Ship Deck Plan').addClass('chLink');
  leftcontainer.append(shipPlan);

  var booking = $('<h3>').append('Booking #' +chInfo.BookingNumber).addClass('primaryHeading').css('margin-top','10px').attr('data-pii','');
  leftcontainer.append(booking);

  var params = chInfo.FindSimilarCruisesUrl.split('&');
  var roomType = params.filter(function(p) {return p.startsWith('roomType');})[0].split('=')[1];
  if(roomTypeMap[roomType] != undefined){
    var stateRoom = $('<p>').append("Stateroom: "+roomTypeMap[roomType]).addClass('secondaryHeading');
    leftcontainer.append(stateRoom);
  }

  var reviewLink = $('<a>').attr('href','/booked/details?icid=icp_ccl_ch42415_v1_hm_cTile').append('Review Booking Details').addClass('chLink');
  leftcontainer.append(reviewLink);

  var depositsArea = $('<div>').addClass('depositsArea');
  if(chInfo.DepositAmount){
    var depositOnly = $('<a>').append('TODAY\'S DEPOSIT').addClass('depositOnly').attr('href','/payment/booked/checkout?b='+chInfo.Token+'&icid=icp_ccl_ch42415_v1_hm_cTile');
    var depositAmount = $('<a>').append('$'+chInfo.DepositAmount).addClass('depositAmount').attr('href','/payment/booked/checkout?b='+chInfo.Token+'&icid=icp_ccl_ch42415_v1_hm_cTile');
    var payNow = $('<a>').attr('href','/payment/booked/checkout?b='+chInfo.Token+'&icid=icp_ccl_ch42415_v1_hm_cTile').addClass('payNow').append('Pay Now <i class="fa fa-caret-right"></i>');
    depositsArea.append(depositOnly);
    depositsArea.append(depositAmount);
    depositsArea.append(payNow);
  }
  else{
    var payDeposit = $('<a>').append('PAY TODAY\'S <br>DEPOSIT <i class="fa fa-caret-right"></i>').addClass('depositOnly').attr('href','/payment/booked/checkout?b='+chInfo.Token+'&icid=icp_ccl_ch42415_v1_hm_cTile').css('line-height','1');
    depositsArea.append(payDeposit);
  }

  container.append(leftcontainer);
  container.append(depositsArea);
  container.insertAfter(selector);

  getResults('/itinerary-api/2015/info?itinCode='+chInfo.ItineraryCode+'&embkCode='+chInfo.EmbarkationPortCode+'&shipCode='+chInfo.ShipCode+'&durDays='+chInfo.Days+'&sailDate='+formatDate(chInfo.StartDate), function(data){
    var ports = data.portList.join(' >  ');
    $('.itinSum').append(ports);
    $('.itinSum').append(' > <a style="color: #10559a !important; text-decoration: underline !important;" href="/booked/planner?icid=icp_ccl_ch42415_v1_hm_cTile">See More</a>');
  });
}

utils.waitForElement('.bucket-4').then(insertHtml);


function formatDate(date){
  var tempDate = new Date(date);
  var month = (tempDate.getMonth()+1).toString();
  month = month.length < 2 ? "0" + month : month;
  var day = tempDate.getDate().toString();
  day = day.length < 2 ? "0" + day : day;
  var year = tempDate.getFullYear().toString();
  return month+day+year;
}


var $ = $.jQuery || window.optimizely.get('jquery');
var utils = window.optimizely.get("utils");

utils.waitForElement('ccl-countdown').then(function() {
  //$('.ch-clock').empty().prepend('<div><span id="hours"></span><span class="clockColon">:</span><span id="minutes"></span><span class="clockColon">:</span><span id="seconds"></span></div>');

  //$('p.ch-title1').html('HOURS &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MINS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SECS');


  var now = new Date().getTime();

  if (!String.prototype.startsWith) {
    String.prototype.startsWith = function(searchString, position){
      position = position || 0;
      return this.substr(position, searchString.length) === searchString;
    };
  }

  var cookies = document.cookie.split(';');
  var chCookie = cookies.filter(function(each){
    return each.startsWith(' cclCH=');
  });

  var decoded = decodeURIComponent(chCookie[0]);
  decoded = decoded.slice(7);
  decoded = JSON.parse(decoded);

  var end = decoded.CourtesyHoldExpirationParts.split(',');
  var endDate = new Date();
  endDate.setFullYear(end[0]);
  endDate.setMonth(end[1]);
  endDate.setDate(end[2]);
  endDate.setHours(end[3]);
  endDate.setMinutes(end[4]);

  var countDownDate = new Date(endDate).toUTCString();

  //Call the function to get current time passing it a callback to get the date from request headers
  function getcurrentTime(callback){
    $.ajax({
      type: "GET",
      cache: false,
      url: 'https://www.carnival.com/pix/1px.gif',
      fail:function(){console.log('fail');},
      complete: callback
    });
  }

});


//VIFP Section 

//link-touts

function getData(callback) {
  $.ajax({
    cache: true,
    url:"https://www.carnival.com/ProfileManagement/api/v1.0/Profiles",
    fail: function() {
      console.log("fail");
    },
    success: callback
  });
}

function insertVIFPhtml(selector, name, loyaltyNumber, tier,totalPoints ,totalCruises, cruisesTillNextTier, NextTier){
  //console.log('$ '+selector+' ' + name+' ' + loyaltyNumber+' ' + tier+' ' +totalPoints+' ' +totalCruises+' ' + cruisesTillNextTier+' ' + NextTier);
  var className = "desktopVifp";

  if(selector == document.querySelector('footer.t-footer')){
    className = "mobVifp";
  }

  var vifpAssets = {
    BLUE : {color:'#C50F14', logo:'https://www.carnival.com/vifp/~/media/cclus/images/loyalty/icons/vifpbluegif.ashx'},
    RED : {color:'#C50F14', logo:'https://www.carnival.com/vifp/~/media/cclus/images/loyalty/icons/vifpredgif.ashx'},
    GOLD :{color:'#E9BE2F', logo:'https://www.carnival.com/vifp/~/media/cclus/images/loyalty/icons/vifpgoldgif.ashx'},
    PLATINUM: {color:'#B2B4B7', logo:'https://www.carnival.com/vifp/~/media/cclus/images/loyalty/icons/vifpplatinumgif.ashx'}
  };


  var detailsBanner = $('<div>').addClass('vifpDetails');
  detailsBanner.addClass(className);

  var	vifpDetails__leftSide = $('<div>').addClass('vifpDetails__leftSide');
  var vifpLogo = $('<img>').attr('src',vifpAssets[tier].logo);
  var vifpProfileLink = $('<a>').attr('href','/profilemanagement/profiles');
  vifpProfileLink.append(vifpLogo);


  var	vifpDetails__nameVifpNum = $('<div>').addClass('vifpDetails__nameVifpNum');
  var vifpDetails__name = $('<h5>').append(name).addClass('vifpDetails__name').attr('data-pii','');
  var vifpDetails__VifpNum = $('<p>').append('VIFP Club #: '+loyaltyNumber).addClass('vifpDetails__VifpNum').attr('data-pii','');

  vifpDetails__nameVifpNum.append(vifpDetails__name, vifpDetails__VifpNum);
  vifpDetails__leftSide.append(vifpProfileLink, vifpDetails__nameVifpNum);

  var	vifpDetails__rightSide = $('<div>').addClass('vifpDetails__rightSide');

  //Total Crises
  var totalDiv = $('<div>').addClass('vifpDetails__total');
  totalDiv.append('<h3>'+totalCruises+'</h3>');
  totalDiv.append('<p>TOTAL<br class="vifp-mob-only"> CRUISES</p>');
  vifpDetails__rightSide.append(totalDiv);


  //Total VIFP Points
  totalDiv = $('<div>').addClass('vifpDetails__total');
  totalDiv.append('<h3>'+totalPoints+'<h3>');
  totalDiv.append('<p>VIFP<br class="vifp-mob-only"> POINTS</p>');
  vifpDetails__rightSide.append(totalDiv);


  //Total VIFP Points
  if(NextTier === "RED" || NextTier === "GOLD" || NextTier === "PLATINUM" || NextTier === "DIAMOND"){  
    totalDiv = $('<div>').addClass('vifpDetails__total');
    totalDiv.append('<h3>'+cruisesTillNextTier+'<h3>');
    totalDiv.append('<p>VIFP POINTS<br>UNTIL '+NextTier+'</p>');
    vifpDetails__rightSide.append(totalDiv);
  }



  detailsBanner.append(vifpDetails__leftSide);
  detailsBanner.append(vifpDetails__rightSide);

  $(detailsBanner).insertBefore(selector);


}

getData(function(resp){
  var cruisesTillNextTier  = resp.tier.cruiseDaysToNextTier;
  var totalPoints = resp.tier.totalVifpPoints;
  var totalCruises = resp.bookings.length;
  var name = resp.firstName + " " + resp.lastName;
  var loyaltyNumber = resp.loyaltyNumber;
  var tier = resp.tier.tierTitle;
  var NextTier = resp.nextTier.tierName;

  utils.waitForElement('.bucket-5').then(function(targetselector){insertVIFPhtml(targetselector, name, loyaltyNumber, tier,totalPoints ,totalCruises, cruisesTillNextTier,NextTier );});

});



//end VIFP Section
}}, {"value": "<style>#toutsContainer2013 {\n  display: none !important;\n}\n\n.js-home-promo.js-hero-banners-personalizer-target{\n  display: none !important;\n}\n\n\n.cta-button{\n  clear: both;\n  border-radius: 0;\n  font-size: 170%;\n  font-family: \"tempo\", sans-serif;\n  border: none;\n  display: inline-block;\n  margin: 20px 0 0 0;\n  padding: 16px 32px;\n  line-height: 1;\n  text-transform: uppercase;\n  cursor: pointer;\n  color: #FFF;\n  background: #dc1125;\n}\n\n\n.chSummary{\n  border: solid 1px rgba(0,0,0,.3);\n  min-height: 200px;\n  padding: 20px;\n  box-sizing: border-box;\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  max-width: 1400px;\n  margin: 25px auto;\n}\n\n\n.leftSide{\n  max-width: 60%;\n}\n\n.primaryHeading{\n  font-size: 2rem;\n  font-weight: 600;\n  color: #464646;\n  font-family: \"Open sans\", sans-serif;\n}\n\n.secondaryHeading{\n  font-size: 1.2rem;\n  font-weight: 600;\n  color: #10559a;\n  line-height: 2;\n  font-family: \"Open sans\", sans-serif;\n}\n\n.chLink{\n  font-size: 1.5rem;\n  color: #10559a !important;\n  text-decoration: underline !important;\n}\n\n.depositsArea{\n  border-left: solid 1px #0000004d;\n  text-align: center;\n  padding: 30px 0 30px 20px;\n  height: 150px;\n  display: flex;\n  flex-direction: column;\n  justify-content: space-around;\n  box-sizing: border-box;\n  width: 35%;\n}\n\n.depositOnly{\n  font-size: 3rem;\n  font-family: tempo;\n  color: #10559a !important;\n}\n\n.depositAmount{\n  font-size: 4rem;\n  font-family: tempo;\n  color: #10559a !important;\n  line-height: 1;\n}\n\n.payNow{\n  color: #10559a !important;\n  font-family: \"Open Sans\", sans-serif;\n  font-size: 2rem;\n  font-weight: 600;\n}\n\n#hours, #minutes, #seconds {\n  font-size: 0.9em;\n}\n\n.clockColon {\n  margin: 5px;\n}\n\n\n@media screen and (max-width: 768px){\n  .chSummary{ \n    flex-direction: column;\n    margin-left: 20px;\n    max-width: 90vw;\n  }\n  .depositsArea {\n    padding: 20px 0 0;\n    border-left: none;\n    border-top: solid 1px #0000004d;\n    margin-top: 20px;\n    width: 100%;\n  }\n  .leftSide{\n    max-width: 100%;\n  }\t\n}\n\n@media screen and (max-width: 768px) and (-webkit-min-device-pixel-ratio: 2) {\n  .chSummary {\n    flex-direction: column;\n    width: 95%;\n    margin: 15px auto;\n    padding: 20px 20px;\n  }\n  .primaryHeading{\n    font-size: 1rem;\n  }\n  .chSummary > div:nth-child(1) > h3:nth-child(4){\n\t\tmargin-top: 20px !important;\n\t}\n  .secondaryHeading {\n    font-size: 1rem;\n    line-height: 1.5;\n    padding-top: 5px;\n    margin: 0;\n  }\n  .chLink {\n    font-size: 1rem;\n  }\n  .depositOnly {\n    font-size: 2rem;\n  }\n  .depositAmount {\n    font-size: 3rem;\n  }\n  .payNow{\n    font-size: 2rem;\n  }\n  .leftSide{\n    max-width: 100%;\n  }\t\n}\n\n\n@media screen and (max-width: 900px) and (-webkit-min-device-pixel-ratio: 2) and (orientation: landscape){\n  .primaryHeading {\n    font-size: 1.4rem;\n  }\n  .secondaryHeading {\n    font-size: 1.4rem;\n  }\n  .depositOnly {\n    font-size: 2rem;\n  }\n  .chLink {\n    font-size: 1.3rem;\n  }\n}\n\n\n\n.vifpDetails{\n  max-width: 1400px;\n  margin: auto;\n  display: flex;\n  justify-content: space-between;\n  height: 200px;\n  align-items: center;\n}\n\n.vifpDetails__leftSide{\n  display: flex;\n  justify-content: center;\n  width: 50%;\n}\n\n.vifpDetails__rightSide{\n  border-left: solid 1px #c3c3c3;\n  display: flex;\n  height: 55%;\n  width: 50%;\n  align-items: flex-start;\n  justify-content: center;\n  padding-top: 25px;\n}\n\n.vifpDetails__total{\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n  align-items: center;\n  margin: 0 40px;\n}\n\n.vifpDetails__total h3{\n  font-size: 4rem;\n  color: #000;\n  font-weight: 600;\n}\n\n.vifpDetails__total p{\n  font-size: 1.5rem;\n  color: #000;\n  text-align: center;\n}\n\n\n.vifpDetails__nameVifpNum{\n  padding-left: 20px;\n}\n\n.vifpDetails__name{\n  font-family: tempo;\n  color: #10559a;\n  font-size: 4rem;\n  line-height: 1;\n}\n\n.vifpDetails__VifpNum{\n  font-size: 1.5rem;\n}\n\n.vifp-mob-only{\n  display: none;\n}\n\n\n@media screen and (max-width: 768px) and (-webkit-min-device-pixel-ratio: 2) {\n  .vifpDetails{\n    max-width: 95%;\n    flex-direction: column;\n    justify-content: center;\n    margin-top: 20px;\n    margin-bottom: 20px;\n  }\n\n  .upLiftAttributes {\n    color: white;\n    font-size: 2.4rem !important;\n    text-shadow: none;\n  }\n\n  .vifpDetails__name {\n    font-size: 2rem;\n    text-align: center;\n  }\n\n  .vifpDetails__VifpNum {\n    font-size: 1rem;\n  }\n\n  .vifpDetails__nameVifpNum{\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n    justify-content: center;\n  }\n\n  .vifpDetails__rightSide {\n    border-left: none;\n    border-top: solid 1px #c3c3c3;\n    width: 100%;\n  }\n\n  .vifpDetails__total{\n    margin: 0;\n    width: 33%;\n  }\n\n  .vifpDetails__total h3 {\n    font-size: 3rem;\n  }\n\n  .vifpDetails__total p {\n    font-size: .8rem;\n    line-height: 1;\n  }\n  .vifp-mob-only{\n    display: block;\n  }\n\n  .vifpDetails__leftSide{\n    margin-bottom: 10px;\n    width: 100%;\n  }\n\n}\n\n@media only screen \n  and (min-width: 320px) \n  and (max-width: 325px)\n  and (-webkit-min-device-pixel-ratio: 2)\n  and (orientation: portrait) {\n\n    .vifpDetails__total p {\n      font-size: 0.7rem;\n    }\n\n}\n\n.wellQualifiedGuest{\n  color: #fff;\n  font-size: 1.8em;\n  letter-spacing: 2px;\n  line-height: 0.3;\n}\n\n\n\n@media (max-width: 1200px) {\n  .sec-banner{\n    font-size: 0.9rem;\n  }\n\n}\n\n\n@media (max-width: 1100px) {\n  .sec-banner{\n    font-size: 0.8rem;\n  }\n}\n\n@media (max-width: 900) {\n\n}</style>", "selector": "head", "dependencies": [], "type": "append", "id": "22C9C8BB-3F6B-4911-B83B-A634A32F5730"}]}]}], "weightDistributions": null, "name": "09012021 | CTile + Uplift (new logo)+ VIFP ", "bucketingStrategy": null, "experimentMetadata": {"allocationPolicy": "manual", "layerId": "18910343000"}}], "policy": "equal_priority", "viewIds": ["9414621687"], "weightDistributions": null, "decisionMetadata": {"experimentPriorities": [[{"entityId": "20571930140", "endOfRange": null}]], "experimentWeights": null, "offerConsistency": null}}, {"changes": null, "id": "30318700323", "name": "Personalization| Bucket 2", "commitId": "5863413469937664", "groupId": null, "holdback": 0, "activation": {}, "integrationSettings": {"contentsquare": {}, "google_analytics_4": {}}, "integrationStringVersion": 2, "experiments": [{"audienceIds": ["and", "14246380333", "4527279611576320", "6631919954165760"], "audienceName": "Non-Booked Guest - AND - Not CH session,Exclusion|Nov. Broadbase '24 | Casino,Exclusion |Nov. Core '24 | TGO", "changes": null, "id": "6048797948641280", "integrationSettings": null, "variations": [{"id": "5174262076538880", "name": "Variation #1", "actions": [{"viewId": "9414621687", "changes": [{"id": "EA68C2F7-411B-4298-90B2-FCEB4836D438", "type": "custom_code", "value": function($){var utils = window.optimizely.get('utils');
var dcp = window.optimizely.get("dcp");

 if ($(window).width() < 960) {
utils.waitForElement('#optimizely-extension-B3E6D66C-29C7-4E46-AE06-01A83C69D094 > span').then(function(elem) {
$("#optimizely-extension-B3E6D66C-29C7-4E46-AE06-01A83C69D094 > span").empty();
$("#optimizely-extension-B3E6D66C-29C7-4E46-AE06-01A83C69D094 > span").append('<span class="copy-pack-title" style="color: white; display: flex;align-items: center;justify-content: center; white-space: nowrap;line-height: 1;"><span style="color: rgb(16, 85, 154)!important;font-size: 36px;margin-left: 5px;margin-right: 5px;text-align: center;">SHARE EXPERIENCES AT<br>BEAUTIFUL DESTINATIONS</span></span>');
});
 }
}, "dependencies": []}, {"id": "DEAD840E-17AE-4D0C-882F-3AB38F56EF0F", "type": "append", "selector": "head", "value": "<style>.pack-item{\n  border-radius: 24px;\n}\n\n#optimizely-extension-0C44EDC1-3671-4BCC-920F-0CC700BF912C > span {\n\tdisplay: flex;\n}\n\n.bucket-2>.guide-pack>.guide-pack-title{    \n  display: flex;\n  align-items: center;\n  justify-content: center;\n  white-space: nowrap;\n  color: #10559a;\n}</style>", "dependencies": []}, {"id": "674D8DB2-2971-4F96-BF25-66255D8F5F07", "type": "widget", "dependencies": [], "name": "Utility Classes", "widget_id": "20108015752", "config": {}}, {"id": "B3E6D66C-29C7-4E46-AE06-01A83C69D094", "type": "widget", "dependencies": [], "name": "3/4 Tiles Guide Carousel | Desktop  (with onclick update) Caryn", "widget_id": "30453410332", "config": {"ThreeTilesCheck": "4-tiles", "TilesCheck": "4-tiles", "dskheight": "450px", "tile1": "<span class=\"responsive-pack-title\" style=\"line-height: 1;font-size: 16px;\" aria-hidden=\"true\">&nbsp;</span><span class=\"responsive-pack-title\" style=\"line-height: 1;font-size: 34px;\" aria-hidden=\"true\">THE BAHAMAS SAILINGS</span>", "color": "hp-text-blue-dark", "p5price": "numadults=2", "tile2": "<span class=\"responsive-pack-title\" style=\"line-height: 1;font-size: 16px;\" aria-hidden=\"true\">&nbsp;</span><span class=\"responsive-pack-title\" style=\"line-height: 1;font-size: 34px;\" aria-hidden=\"true\">Caribbean SAILINGS</span>", "p4price": "numadults=2&dest=e,et", "tile3": "<span class=\"responsive-pack-title\" style=\"line-height: 1;font-size: 16px;\" aria-hidden=\"true\">&nbsp;</span><span class=\"responsive-pack-title\" style=\"line-height: 1;font-size: 34px;\" aria-hidden=\"true\">MEXICO SAILINGS</span>", "p3price": "numadults=2&dest=m", "tile4": "<span class=\"responsive-pack-title\" style=\"line-height: 1;font-size: 16px;\" aria-hidden=\"true\">spotlight destination</span>\n  <span class=\"responsive-pack-title\" style=\"line-height: 1;font-size: 34px;margin-top: 3px;\" aria-hidden=\"true\">Europe Sailings</span>", "p2price": "numadults=2&dest=c", "tile5": "<span class=\"responsive-pack-title\" style=\"line-height: 1;font-size: 19px;\" aria-hidden=\"true\">CARNIVAL</span>\n  <span class=\"responsive-pack-title\" style=\"line-height: 1;font-size: 52px;margin-top: 3px;\" aria-hidden=\"true\">CELEBRATION<sup style=\"\n    font-size: .2em;\n    top: -12px;\n    position: relative;\n\">\u00ae</sup></span>", "p1price": "numadults=2&dest=b", "tile5Url": "/cruise-search?icid=crm_ccl_destination-alaska_092424_resp_pack_p4_public_2&dest=a", "tile4Url": "/cruise-search?icid=crm_ccl_destination-europe_112424_resp_pack_p4_public_2&dest=e", "p1aria": "The Bahamas", "tile3Url": "/cruise-search?icid=crm_ccl_destination-mexico_112424_resp_pack_p3_public_2&dest=m", "titleCSS": "", "p2aria": "Caribbean", "tile2Url": "/cruise-search?icid=crm_ccl_destination-caribbean_112424_resp_pack_p2_public_2&dest=c", "showprice": "true", "p3aria": "Mexico", "tile1Url": "/cruise-search?icid=crm_ccl_destination-bahamas_112424_resp_pack_p1_public_2&dest=bh", "p4aria": "Spotlight Destination. Europe", "p5aria": "", "cta": "SEARCH CRUISES", "tile5Image": "/~/media/Images/hp-merch/2023/Desktop/tiles/journeys-tile.jpg", "tile4Image": "/~/media/Images/hp-merch/2023/Desktop/tiles/journeys-tile.jpg", "backgroundColor": "background-color: white;", "appendTo": ".bucket-2", "pNum": "2", "tile3Image": "/~/media/Images/hp-merch/2023/Desktop/tiles/mexico-tile.jpg", "tile2Image": "/~/media/Images/hp-merch/2023/Desktop/tiles/bahamas-tile.jpg", "title": "<span style=\"width: 100%;display: block;margin: auto 25px auto 0;flex: 1;height: 2.5px; background-color: #10559a !important;\" aria-hidden=\"true\"></span> <span class=\"hp-text-blue\" style=\"margin-bottom:5px;font-size: 46px;\">SHARE EXPERIENCES AT BEAUTIFUL DESTINATIONS</span><span style=\" width: 100%;   display: block; margin: auto 0 auto 25px; flex: 1; height: 2.5px; background-color: #10559a !important;\" aria-hidden=\"true\"></span>", "tile1Image": "/~/media/Images/hp-merch/2023/Desktop/tiles/caribbean-tile.jpg", "mblheight": "450px", "packtitle": "title-top"}}, {"css": {}, "dependencies": [], "attributes": {}, "type": "attribute", "id": "6A9D3486-6E55-492E-B1CA-4445865548FC", "selector": ".pack-1"}]}]}], "weightDistributions": null, "name": "1101 Destination 4-Pack| Desktop - PUBLIC ONLY", "bucketingStrategy": null, "experimentMetadata": {"allocationPolicy": "manual", "layerId": "30318700323"}}, {"audienceIds": ["and", "14246380333"], "audienceName": "Non-Booked Guest - AND - Not CH session", "changes": null, "id": "4903465730703360", "integrationSettings": null, "variations": [{"id": "5582482880331776", "name": "Variation #1", "actions": [{"viewId": "9414621687", "changes": [{"id": "03953920-5573-4D6F-A387-E86DF95CF629", "type": "custom_code", "value": function($){var utils = window.optimizely.get('utils');
var dcp = window.optimizely.get("dcp");

 if ($(window).width() < 960) {
utils.waitForElement('#optimizely-extension-0C44EDC1-3671-4BCC-920F-0CC700BF912C > span').then(function(elem) {
$("#optimizely-extension-0C44EDC1-3671-4BCC-920F-0CC700BF912C > span").empty();
$("#optimizely-extension-0C44EDC1-3671-4BCC-920F-0CC700BF912C > span").append('<span class="copy-pack-title" style="color: white; display: flex;align-items: center;justify-content: center; white-space: nowrap;line-height: 1;"><span style="color: rgb(16, 85, 154)!important;font-size: 36px;margin-left: 5px;margin-right: 5px;text-align: center;">SHARE EXPERINCES AT<br>BEAUTIFUL DESTINATIONS</span></span>');
});
 }
}, "dependencies": []}, {"id": "347C528C-A6C0-4E8B-9498-ACF4463D0F06", "type": "append", "selector": "head", "value": "<style>#optimizely-extension-0C44EDC1-3671-4BCC-920F-0CC700BF912C > span {\n\tdisplay: flex;\n}\n\n.grid-item {\n    border-radius: 24px;\n}\n\n.bucket-2>.guide-pack>.guide-pack-title{    \n  display: flex;\n  align-items: center;\n  justify-content: center;\n  white-space: nowrap;\n  color: #10559a;\n}\n\n\n\n@media (max-width: 800px) {\n\n  #optimizely-extension-0C44EDC1-3671-4BCC-920F-0CC700BF912C > span {\n  \talign-self: center;\n  }\n}</style>", "dependencies": []}, {"id": "04979A67-9FC7-4197-9116-17D3E2477589", "type": "widget", "dependencies": [], "name": "Utility Classes", "widget_id": "20108015752", "config": {}}, {"id": "0C44EDC1-3671-4BCC-920F-0CC700BF912C", "type": "widget", "dependencies": [], "name": "Tetris Tile (static 5 tiles) | Responsive (Caryn Test)", "widget_id": "30531620018", "config": {"g5Url": "/cruise-search?icid=crm_ccl_destinations-europe_111924_resp_grid_g5_tgo-casino_2&dest=e", "g4Url": "/cruise-search?icid=crm_ccl_destinations-alaska_112424_resp_grid_g4_tgo-casino_2&dest=a", "g3Url": "/cruise-search?icid=crm_ccl_destinations-caribbean_112424_resp_grid_g3_tgo-casino_2&dest=c", "color": "hp-text-blue-dark", "g2Url": "/cruise-search?icid=crm_ccl_destinations-mexico_112424_resp_grid_g2_tgo-casino_2&dest=m", "g1Url": "/cruise-search?icid=crm_ccl_destinations-bahamas_112424_resp_grid_g1_tgo-casino_2&dest=bh", "g1": "THE BAHAMAS Sailings", "g2": "MEXICO Sailings", "showprice": "true", "g3": "CARIBBEAN sailings", "g4": "alaska sailings", "g5Image": "/~/media/Images/hp-merch/2024/extras/grid/europe-2.jpg", "g5": "Europe sailings", "g4Image": "/~/media/Images/hp-merch/2024/extras/grid/alaska-2.jpg", "g3Image": "/~/media/Images/hp-merch/2024/extras/grid/carribbean-2.jpg", "g2Image": "/~/media/Images/hp-merch/2024/extras/grid/mexico-2.jpg", "g1Image": "/~/media/Images/hp-merch/2024/extras/grid/bahamas-2.jpg", "appendTo": ".bucket-2", "ariatext": "SEARCH CRUISES", "title": "<span style=\"width: 100%;display: block;margin: auto 25px auto 0;flex: 1;height: 2.5px; background-color: #10559a !important;\" aria-hidden=\"true\"></span> <span class=\"hp-text-blue\" style=\"margin-bottom:5px;font-size: 46px;\">SHARE EXPERINCES AT BEAUTIFUL DESTINATIONS</span><span style=\" width: 100%;   display: block; margin: auto 0 auto 25px; flex: 1; height: 2.5px; background-color: #10559a !important;\" aria-hidden=\"true\"></span>", "g5Price": "numadults=2&dest=e", "g4Price": "numadults=2&dest=a", "g3Price": "numadults=2&dest=c", "g2Price": "numadults=2&dest=m", "g1Price": "numadults=2&dest=bh"}}, {"css": {}, "dependencies": [], "attributes": {}, "type": "attribute", "id": "0935CF30-4AEF-42F3-A17A-31DCD03BA937", "selector": ".grid-item"}]}]}], "weightDistributions": null, "name": "1112 Destination Grid - TGO and Casino (Cyber) | Responsive ", "bucketingStrategy": null, "experimentMetadata": {"allocationPolicy": "manual", "layerId": "30318700323"}}], "policy": "equal_priority", "viewIds": ["9414621687"], "weightDistributions": null, "decisionMetadata": {"experimentPriorities": [[{"entityId": "6048797948641280", "endOfRange": null}], [{"entityId": "4903465730703360", "endOfRange": null}]], "experimentWeights": null, "offerConsistency": null}}, {"changes": null, "id": "17437270564", "name": "Personalization: HP |  Pop-up Message", "commitId": "4960384640614400", "groupId": null, "holdback": 0, "activation": {}, "integrationSettings": {}, "integrationStringVersion": 2, "experiments": [{"audienceIds": ["and", "14246380333", "30450710279"], "audienceName": "Non-Booked Guest - AND - Not CH session,Un-Recognized User", "changes": null, "id": "21185040145", "integrationSettings": null, "variations": [{"id": "21148780279", "name": "Log in to get the best shopping experience", "actions": [{"viewId": "9414621687", "changes": [{"value": "<style>#mbl_lcb, #lcb-vifp-mbl {\n  display:none!important;\n}\n\n.loginExtension {\n  border-radius:24px;\n}</style>", "selector": "head", "dependencies": [], "type": "append", "id": "90E3A93C-E0EF-42F5-A579-7970346B2AA8"}, {"name": "Login widget on HP", "config": {"insertBeforeClassMobile": ".profile", "logInLink": "javascript:window.Carnival.SSO.openLoginRegisterComponent('/login')\"", "loginCtaCopyColor": "#10559a", "waitForElement": ".profile", "loginCtaBackgroundColor": "#FFFFFF", "loginCopyCta": "Log In", "appendLoginClassDesktop": ".bucket-2", "insertBeforeClassDesktop": ".profile", "logInCopy": "Log in to shop your best cruise deal"}, "id": "891B27CA-BA75-41F6-86E2-984B17CCF49C", "dependencies": [], "type": "widget", "widget_id": "20976822118"}]}]}], "weightDistributions": null, "name": "New Not Logged In", "bucketingStrategy": null, "experimentMetadata": {"allocationPolicy": "manual", "layerId": "17437270564"}}], "policy": "equal_priority", "viewIds": ["9414621687"], "weightDistributions": null, "decisionMetadata": {"experimentPriorities": [[{"entityId": "21185040145", "endOfRange": null}]], "experimentWeights": null, "offerConsistency": null}}, {"changes": null, "id": "28383870307", "name": "Personalization | Media Campaigns for CRM and Casino", "commitId": "29893370434", "groupId": null, "holdback": 500, "activation": {}, "integrationSettings": {"contentsquare": {}, "google_universal_analytics": {"universal_analytics_slot": "93", "universal_analytics_tracker": "t55"}}, "integrationStringVersion": 2, "experiments": [{"audienceIds": ["and", "29240640094"], "audienceName": "CRM Media Initiative", "changes": null, "id": "28554860503", "integrationSettings": null, "variations": [{"id": "28557960403", "name": "Variation #1", "actions": [{"viewId": "17923383190", "changes": [{"id": "12F5CD5F-E66D-4D07-BC81-E260A3F105BE", "type": "custom_code", "value": function($){var $ = window.jQuery;
var utils = window.optimizely.get('utils');
utils.waitForElement(".cd-hero-banner__slide-title").then(function(elem) {if ($(".cd-hero-banner__slide-title:contains('You look like a Very Important Fun Person. Join the Club!')").length > 0 && $('.cd-hero-card.logged-user').length<1){ $(".cd-hero-banner__slide-title").text("Enter your VIFP number to unlock your Exclusive Deal!");

$('.cd-hero-card-left__vifp-logo').hide();
//$('.cd-hero-banner__slide-item').attr('style',"background-image: linear-gradient(rgba(0, 0, 0, 0.4), rgba(0, 0, 0, 0.4)), url('//cdn.optimizely.com/img/752671897/6706c387d7c8499ea5ccc6ab5a19f924.jpg');background-position: left;");
$('.cd-hero-banner__slide-item').attr('style',"background-image: url('//cdn.optimizely.com/img/752671897/445f4856b2f24a9bb8753544b8f5b201.jpg');background-position: right;");
$('.cd-hero-banner__slide-title').attr('style',"width: 50%;font-family: 'tempo','tempo std';text-transform: uppercase;font-size: 48px;    margin-left: 120px;color:#10559a;");
}
if($(".cd-hero-card__generic-title:contains('You look like a Very Important Fun Person. Join the Club!')").length > 0 && $('.cd-hero-card.logged-user').length<1 && screen.width <= 480 ) {
  $('.cd-hero-card-left__vifp-logo').hide();
  $(".cd-hero-card__generic-title").text("Enter your VIFP number to unlock your Exclusive Deal!");
    $(".cd-hero-card").attr("style","width:100%;padding: 0;height: 64px;display:block");
   $(".cd-hero-banner__vifp-club").attr("style","height: 240px;background-image: url('/~/media/Images/LeadGeneration/travelzoo-mbl.jpg');background-size: cover;background-position: top;");
 $(".cd-hero-card__generic-title").attr("style","padding: 10px;color: #10559a;font-size: 29px;text-shadow: 5px -1px 7px #ffffffa6;font-family: 'TempoStd';");
}
if($(".cd-hero-card__generic-title:contains('Unlock Big Savings')").length > 0 && $('.cd-hero-card.logged-user').length<1 && screen.width <= 480 ) {
  $('.cd-hero-card-left__vifp-logo').hide();
  $(".cd-hero-card__generic-title").text("Enter your VIFP number to unlock your Exclusive Deal!");
    $(".cd-hero-card").attr("style","width:100%;padding: 0;height: 64px;display:block");
   $(".cd-hero-banner__vifp-club").attr("style","height: 240px;background-image: url('/~/media/Images/LeadGeneration/travelzoo-mbl.jpg');background-size: cover;background-position: top;");
 $(".cd-hero-card__generic-title").attr("style","padding: 10px;color: #10559a;font-size: 29px;text-shadow: 5px -1px 7px #ffffffa6;font-family: 'TempoStd';");
}
});
}, "dependencies": []}, {"id": "38DD8534-85FE-49B0-AFDC-E66B2CAB25ED", "type": "append", "selector": "head", "value": "<style>.cd-hero-banner__slide-title {\n    width: 60%;\n    font-size: 2.5rem;\n}</style>", "dependencies": []}]}]}], "weightDistributions": null, "name": "CRM Media Initiative", "bucketingStrategy": null, "experimentMetadata": {"allocationPolicy": "manual", "layerId": "28383870307"}}, {"audienceIds": ["and", "28377410507"], "audienceName": "Casino Media Initiative", "changes": null, "id": "28354410344", "integrationSettings": null, "variations": [{"id": "28409570167", "name": "Variation #1", "actions": [{"viewId": "17923383190", "changes": [{"id": "12F5CD5F-E66D-4D07-BC81-E260A3F105BE", "type": "custom_code", "value": function($){var $ = window.jQuery;
var utils = window.optimizely.get('utils');
utils.waitForElement(".cd-hero-banner__slide-title").then(function(elem) {if ($(".cd-hero-banner__slide-title:contains('You look like a Very Important Fun Person. Join the Club!')").length > 0 && $('.cd-hero-card.logged-user').length<1){ $(".cd-hero-banner__slide-title").html("Enter your<br>VIFP number to unlock your Casino Deal!");
$('.cd-hero-card-left__vifp-logo').hide();
//$('.cd-hero-banner__slide-item').attr('style',"background-image: linear-gradient(rgba(0, 0, 0, 0.4), rgba(0, 0, 0, 0.4)), url('//cdn.optimizely.com/img/752671897/6706c387d7c8499ea5ccc6ab5a19f924.jpg');background-position: left;");
$('.cd-hero-banner__slide-item').attr('style',"background-image: url('//cdn.optimizely.com/img/752671897/344058d328894cba886eea7326b9a28a.jpg');background-position: right;");
$('.cd-hero-banner__slide-title').attr('style',"width: 40%;font-family: 'tempo','tempo std';text-transform: uppercase;font-size: 48px;");
}
if($(".cd-hero-card__generic-title:contains('You look like a Very Important Fun Person. Join the Club!')").length > 0 && $('.cd-hero-card.logged-user').length<1 && screen.width <= 480 ) {
  $('.cd-hero-card-left__vifp-logo').hide();
  $(".cd-hero-card__generic-title").text("Enter your VIFP number to unlock your Casino Deal!");
    $(".cd-hero-card").attr("style","width:100%;padding: 0;height: 64px;display:block");
   $(".cd-hero-banner__vifp-club").attr("style","height: 240px;background-image: url('//cdn.optimizely.com/img/752671897/647ea0d038d248cca22bc128724ece9a.jpg');background-size: cover;background-position: top;");
 $(".cd-hero-card__generic-title").attr("style","background-color: #00000075;padding: 10px;color: #fff;text-shadow: 0px 0px 4px #000000;   font-size: 20px;");
}
});
}, "dependencies": []}, {"id": "38DD8534-85FE-49B0-AFDC-E66B2CAB25ED", "type": "append", "selector": "head", "value": "<style>.cd-hero-banner__slide-title {\n    width: 60%;\n    font-size: 2.5rem;\n}</style>", "dependencies": []}]}]}], "weightDistributions": null, "name": "Casino Media Initiative", "bucketingStrategy": null, "experimentMetadata": {"allocationPolicy": "manual", "layerId": "28383870307"}}], "policy": "equal_priority", "viewIds": ["17923383190", "29923880069"], "weightDistributions": null, "decisionMetadata": {"experimentPriorities": [[{"entityId": "28354410344", "endOfRange": null}], [{"entityId": "28554860503", "endOfRange": null}]], "experimentWeights": null, "offerConsistency": null}}, {"changes": null, "id": "30033850921", "name": "Personalization | HP | Hero & Btiles (Aug- ) DEV 8", "commitId": "5034674666340352", "groupId": null, "holdback": 0, "activation": {}, "integrationSettings": {"contentsquare": {}, "google_analytics_4": {}, "google_universal_analytics": {"universal_analytics_slot": "136", "universal_analytics_tracker": "t55"}}, "integrationStringVersion": 2, "experiments": [{"audienceIds": ["and", "4783120075", "14246380333", "10261134200", "4527279611576320", "6065805817806848"], "audienceName": "Desktop & Tablet ,Non-Booked Guest - AND - Not CH session,All | Exclude Synthetic Script \"KTNX\",Exclusion|Nov. Broadbase '24 | Casino,Nov. Core '24 | TGO", "changes": null, "id": "6712000189825024", "integrationSettings": null, "variations": [{"id": "5760782105837568", "name": "Variation #1", "actions": [{"viewId": "9414621687", "changes": [{"id": "8BDA6147-4C98-4240-88CE-9CA2DA579EE7", "type": "custom_code", "value": function($){var $ = window.jQuery;
var utils = window.optimizely.get('utils');
var dcp = window.optimizely.get("dcp");

utils.waitForElement(".profile").then(function() {
  $('<div class="carousels"></div>').insertBefore('.profile');
});

dcp.waitForAttributeValue({
    datasourceId: 5271970099494912,
    attributeName: "vifp_num"
  }).then(function(vifp) {
var tempLink1 ='&vifp='+vifp;
var salename = 'ozz';
window.hpHeroUrl = '/cruise-search?cruisedeals='+salename+'&icid=crm_ccl_'+salename+'_111124_hm_h1_tgo&rateCodes=OOJ'+tempLink1;
      utils.waitForElement('.heroContainer').then(function(){
      var tempLink3 = $('.heroContainer').attr('onclick');
      tempLink3 = tempLink3.substring(tempLink3.indexOf('\';'),0) + '&vifp='+vifp+'\'';
      $('.heroContainer').attr('onclick', tempLink3);
    });
var tempLink2 = $('.countdown-container').attr('href');
      tempLink2 += '?icid=icp_ccl_ooa_080124_hm_bb&cruisedeals=ooa&rateCodes=OOA&vifp='+vifp;
      $('.countdown-container').attr('href',tempLink2); 
/*utils.waitForElement('#optimizely-extension-6DE8CB6D-8521-4DB2-8A7A-B6C72050E950').then(function(){
      var tempLink = $('#optimizely-extension-6DE8CB6D-8521-4DB2-8A7A-B6C72050E950').attr('href');
      tempLink += '&vifp='+vifp;
      $('#optimizely-extension-6DE8CB6D-8521-4DB2-8A7A-B6C72050E950').attr('href',tempLink);
    });*/
      utils.waitForElement('#optimizely-extension-6DE8CB6D-8521-4DB2-8A7A-B6C72050E950').then(function(){
      var tempLink = $('#optimizely-extension-6DE8CB6D-8521-4DB2-8A7A-B6C72050E950').attr('onclick');
      tempLink = tempLink.substring(tempLink.indexOf('\';'),0) + '&vifp='+vifp+'\'';
      $('#optimizely-extension-6DE8CB6D-8521-4DB2-8A7A-B6C72050E950').attr('onclick', tempLink);
    });

});
}, "dependencies": []}, {"id": "06D4B137-3C40-4152-9A93-48E988AE04C7", "type": "append", "selector": "head", "value": "<style>.hero-header{\n    border-bottom-left-radius: 24px;\n      border-bottom-right-radius: 24px;\n}\n.itinImage-2,.itinCard-2,.dealsSeeMore{\n  border-radius:24px!important;\n}\n.hero-header{\ndisplay:flex!important; \n  flex-direction:column;\njustify-content:flex-start;\nalign-items:center;\n  background-size:contain!important;\n}\n.dealImage-2{\n  margin:0px!important;\n  border-top-left-radius: 24px!important;\n  border-top-right-radius: 24px!important;\n   border-bottom-left-radius: 0px!important;\n  border-bottom-right-radius: 0px!important;\n}\n\n.tile-item  {\n\tmargin: 5px!important;\n}\n\n\n#optimizely-extension-F25CA88B-A788-4FF0-B67F-4ACD180FD2E2 > div {\n\tmargin-bottom:20px!important;\n}\n\n.row-2-wrap {\n\tdisplay:none!important;\n}\n\n#optimizely-extension-6DE8CB6D-8521-4DB2-8A7A-B6C72050E950 {\n\tbackground-position: center;\n}\n\n\n#adtile-sub {\n  display:block!important;\n}\n\n.hero-attr {\n\tmargin-top:15%;\n}\n\n.hero-header > .heroContainer {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  box-sizing: border-box;\n  max-width: 960px !important;\nbackground-size:contain!important;\n  justify-content: center;\n  height: 75%;\n}\n\n.ctileBreak {\n  display: none;\n}\n\n.ctiletravel {\n  width:80%;\n  margin: 0 auto\n}\n\n.attrBTile {\n  position: relative;\n  padding-left: 15px;\n}\n\n.attrBTile::before {\n  content: 'UP';\n  position: absolute;\n  top: 5px;\n  left: 0;\n  font-size: 0.4em;\n}\n\n.attrBTile::after {\n  content: 'TO';\n  position: absolute;\n  bottom: 5px;\n  left: 0;\n  font-size: 0.4em;\n}\n\n.open-html-hero {\n  position: relative;\n}\n\n.faq-bar, .hero-headline {\n  display: none !important;\n}\n\n.cTileCta {\n  clear: both;\n  border-radius: 0;\n  font-size: 170%;\n  font-family: \"tempo\", sans-serif;\n  border: none;\n  display: inline-block;\n  margin: 20px 0 0 0;\n  padding: 16px 32px;\n  line-height: 1;\n  text-transform: uppercase;\n  cursor: pointer;\n  color: #FFF;\n  background: #DC1125;\n  border-radius: 4px;\n}\n\n.price-attributes {\n  display: flex;\n  font-size: 75px;\n  text-transform: uppercase;\n  font-family: 'Open Sans', sans-serif;\n  justify-content: center;\n  align-items: center;\n}\n\n.attrContainer {\n  display: flex;\n  text-align: center;\n  align-items: center;\n  flex-direction: column;\n}\n\n.leadingText-attr {\n  font-size: 0.22em;\n  line-height: 1;\n  font-weight:600!important;\n}\n\n.salePrice-attr {\n  display: flex;\n  flex-direction: row;\n  justify-content: center;\n  font-family: tempo;\n  margin-bottom: -0.15em;\n  margin-top: -0.15em;\n}\n\n.prePrice-attr {\n  font-size: 0.5em;\n  padding-top: 0.3em;\n}\n\n.midPrice-attr {\n  font-size: 0.5em;\n  display: flex;\n  align-items: center;\n  margin: 0 0.2em 0.2em 0.2em;\n}\n\n.attrPlus {\n  display: flex;\n  align-items: center;\n  align-self: center;\n}\n\n.attrPlus::after {\n  content: '+';\n  font-size: 0.5em;\n  margin-left: 0.2em;\n  margin-right: 0.2em;\n  padding-bottom: 0;\n  font-weight: 600;\n}\n\ndel {\n   position: relative;\n   text-decoration: none;\n   opacity: .7;\n   margin-right: 10px;\n}\n\ndel::after {\n   content: \"\";\n   position: absolute;\n   top: 0.44em;\n   left: 0.1em;\n   width: 2.3em;\n   height: 0.1em;\n   background: #c03;\n   transform: rotate(20deg);\n}\n\n.leadingTextRight\t{\n  text-align: center;\n}\n\n.leadingTextLeft\t{\n  text-align: center;\n}\n\n/*c tile styles*/\n.hero-price-attributes {\n  display:flex;\n  justify-content: center;\n  line-height: 1;\n}\n\n.hero-attr-container {\n  display: flex;\n  align-items: center;\n}\n\n.hero-sale-price-attr {\n  display:flex;\n}\n\n.hero-leading-text-attr {\n  font-size: .16em;\n  line-height: 1;\n  font-family:'Open Sans';\n  font-weight:600;\n}\n\n.hero-dollar-sign {\n  font-size: 0.4em;\n  margin-top: .21em;\n  margin-right: 1%;\n}\n\n.hero-asterisk {\n  font-size: 0.3em;\n  margin-top: 6%;\n}\n\ndel {\n  position: relative;\n  text-decoration: none;\n  opacity: .7;\n  margin-right: 10px;\n}\n\ndel::after {\n\t\tcontent: \"\";\n    position: absolute;\n    width: 1.65em;\n    height: 0.075em;\n    background: #c03;\n    transform: rotate(24deg);\n}\n\n@media screen and (max-width: 768px) {\n  .butter-bar\t{\n    display: none;\n  }\n}\n\n@media (max-width: 768px) {\n  #CountdownBar\t{\n    display: none !important;\n  }\n}\n\n\n@media (max-width: 1350px) {\n  .hero-header > .center {\n    margin:0 auto 0 170px;\n  }\n  .sec-banner {\n    font-size: 0.9rem;\n  }\n}\n\n@media (max-width: 1300px) {\n\n  .hero-header > .heroContainer{\n\n  }\n\n    #optimizely-extension-86F4CE9F-84BF-4726-AFD3-7E2601827409 {\n  \theight:377px!important;\n  }\n  \n  .responsive-c-tile{\n    margin-top:144px!important;\n  }\n  \n  .ck-button{\n    margin-top:98px!important;\n  }\n}\n\n\n@media (max-width: 1270px) {\n  #optimizely-extension-11F66527-760A-457E-8D4E-CCB5AD6114DD > div > div > div.hp-font-tempo.hp-text-center{\n  font-size:32px!important}\n  .sec-banner\t{\n    text-align: center;\n    font-size: 1rem;\n  }\n  .ctiletravel\t{\n    width:90%;\n    margin: 0 auto\n  }\n     \n}\n\n\n\n@media (max-width: 1200px) {\n  .hero-header > .center {\n    margin:0 auto 0 90px;\n  }\n \n}</style>", "dependencies": []}, {"id": "11F66527-760A-457E-8D4E-CCB5AD6114DD", "type": "widget", "dependencies": [], "name": "Hero | Desktop (with onclick update)", "widget_id": "30291230470", "config": {"img": "/~/media/Images/hp-merch/2024/desktop/heros/group-walking-icons.jpg", "waterMark": "", "left": "", "lnk": "/cruise-search?cruisedeals=ozz&icid=crm_ccl_ozz_112424_hm_h1_tgo_1&rateCodes=OZZ", "bottom": "110px", "waterShadowColor": "rgba(0, 0, 0, 1)", "openhtml": "<div class=\"hp-text-blue-dark\" style=\"margin-top: auto;display: flex;flex-direction: column;align-items: center;margin-left: 9%;margin-bottom: auto;\">\n  <div class=\"hp-font-tempo hp-text-center\" style=\"font-size: 34px;font-weight: 700;line-height:1\">PASS THE SAVINGS? YOU GOT IT!</div>\n    <div class=\"price-attributes hp-text-blue-dark\" style=\"font-size: 76px;display: flex;justify-content: center;align-content: center;align-items: flex-end;margin-top: 10px;\" aria-hidden=\"true\">\n<div class=\"attrContainer hp-flex-row\">\n      <span class=\"leadingText-attr hp-font-tempo \" style=\"\n \n    margin-right: 5px;text-align:right\n\">SAVE<br>UP TO</span>\n      <span class=\"salePrice-attr\" style=\"\"><span style=\"\n    font-size: .45em;\n    margin-top: 11px;\n\">$</span>950<sup style=\"font-size: 0.3em;margin-top: 12px;\">*</sup>\n  </span>   \n  \n      <span class=\"leadingText-attr hp-font-tempo \" style=\"\n   margin-right: 5px; text-align:left\n\">PER <br>ROOM</span>\n    </div>\n  \n     \n\n    </div>\n  <span aria-hidden=\"true\" style=\"\n    font-size: 25px;\n    text-align: center;\n    line-height: 1;\n    align-self: center;\n    margin-top: 11px;\n    color:#052049;\n\" class=\"hp-font-tempo \">- PLUS more perks -</span>\n  \n  \n    <a aria-label=\"Search cruises, Save up to $950 Per Room, Plus More Perks\" class=\"cTileCta ctaHover hp-text-shadow-none\" style=\"font-size: 170%;margin-top: 16px;color: white;\" tabindex=\"0\" href=\"/cruise-search?cruisedeals=ozz&icid=crm_ccl_ozz_111924_hm_h1_tgo_1&rateCodes=OZZ\">SEARCH CRUISES</a>\n  \n\n  </div>", "top": "", "backgroundColor": "rgba", "altText": "", "right": "220px", "waterTextColor": "rgba(16, 85, 154, 1)"}}, {"id": "E7752672-FC79-4DDE-8310-4B65C2DD7728", "type": "widget", "dependencies": [], "name": "Image Swap/Carousel | Hero/C Tile With PAUSE/PLAY", "widget_id": "5685106466619392", "config": {"images": "/~/media/Images/hp-merch/2024/desktop/heros/group-walking-icons.jpg,\n/~/media/Images/hp-merch/2024/desktop/heros/group-walking-icons-2.jpg", "speed": "1500", "selector": ".hero-header ", "location": "beforebegin", "buttonPlacement": ".hero-header > .heroContainer"}}]}]}], "weightDistributions": null, "name": "1124-1128 Core OZZ | Desktop", "bucketingStrategy": null, "experimentMetadata": {"allocationPolicy": "manual", "layerId": "30033850921"}}, {"audienceIds": ["and", "5283750624", "14246380333", "10261134200", "4527279611576320", "6065805817806848"], "audienceName": "Mobile Phones Only,Non-Booked Guest - AND - Not CH session,All | Exclude Synthetic Script \"KTNX\",Exclusion|Nov. Broadbase '24 | Casino,Nov. Core '24 | TGO", "changes": null, "id": "5911504185196544", "integrationSettings": null, "variations": [{"id": "6294572418990080", "name": "Variation #1", "actions": [{"viewId": "9414621687", "changes": [{"id": "5C088E48-BF86-43E3-BA85-A806E68A66BB", "type": "custom_code", "value": function($){var $ = window.jQuery;
var utils = window.optimizely.get('utils');
var dcp = window.optimizely.get("dcp");

utils.waitForElement(".profile").then(function() {
  $('<div class="carousels"></div>').insertBefore('.profile');
});

dcp.waitForAttributeValue({
  datasourceId: 5271970099494912,
  attributeName: "vifp_num"
}).then(function(vifp) {
  if(vifp)
  {

    utils.waitForElement('.hero-header-mobile').then(function(){
      var tempLink = $('.hero-header-mobile').attr('onclick');
      tempLink = tempLink.substring(tempLink.indexOf('\';'),0) + '&vifp='+vifp+'\'';
      $('.hero-header-mobile').attr('onclick', tempLink);
    });

    utils.waitForElement('.hero-header-mobile-landscape').then(function(){
      var tempLink = $('.hero-header-mobile-landscape').attr('onclick');
      tempLink = tempLink.substring(tempLink.indexOf('\';'),0) + '&vifp='+vifp+'\'';
      $('.hero-header-mobile-landscape').attr('onclick', tempLink);
    });

    utils.waitForElement('.hero-mobile-button').then(function(){
      var tempLink = $('.hero-mobile-button').attr('onclick');
      tempLink = tempLink.substring(tempLink.indexOf('\';'),0) + '&vifp='+vifp+'\'';
      $('.hero-mobile-button').attr('onclick', tempLink);
    });
  
  }
});
}, "dependencies": []}, {"id": "B08158EA-53D2-4AF5-8F07-C735B2BAC1DB", "type": "append", "selector": "head", "value": "<style>.hero-header-mobile{\n    border-bottom-left-radius: 24px;\n      border-bottom-right-radius: 24px;\n}\n.itinImage-2,.itinCard-2,.cardSeeMore{\n  border-radius:24px!important;\n}\n#adTile1{\ndisplay:none}\n#adTile2{\ndisplay:none}\n#adTile3{\ndisplay:none}\n.dealImage-2{\n  margin:0px!important;\n  border-top-left-radius: 24px!important;\n  border-top-right-radius: 24px!important;\n   border-bottom-left-radius: 0px!important;\n  border-bottom-right-radius: 0px!important;\n}\n/*CK tile */\n/*\n#ccl-mainContainer > div.js-home-promo.js-hero-banners-personalizer-target > div:nth-child(1) {\n\tdisplay: none!important;\n}*/\n\n\n.hero-header-mobile {\n  background-position: center!important;\n  background-size: cover!important;\n  height:640px!important;\n  \n}\n.cyber-lockup{\nmargin-top:21%;}\n\n.hero-mobile-content-wrapper {\n  height: 88%;\n  display: flex;\n  flex-direction: column;\n  justify-content:center;\n}\n\ndel {\n  position: relative;\n  text-decoration: none;\n  opacity: .7;\n  margin-right: 10px;\n}\n\ndel::after {\n\tcontent: \"\";\n  position: absolute;\n  top: 0.4em;\n  left: 0.07em;\n  width: 1.65em;\n  height: 0.075em;\n  background: #c03;\n  transform: rotate(24deg);\n}\n\n  /*button*/\n#optimizely-extension-4214BFA8-AD11-4312-8689-0BBBE96FA51F > div.hero-mobile-content-wrapper > div > button{\n  transform: scale(0.8)!important;\n}\n\n.price-attributes {\n  display: flex;\n  font-size: 55px;\n  text-transform: uppercase;\n  font-family: 'Open Sans', sans-serif;\n  justify-content: center;\n  margin:0;\n  align-items: center;\n  line-height: normal;\n}\n\n.attrContainer {\n  display: flex;\n  flex-direction: row;\n  text-align: center;\n  align-items: center;\n  font-family:'tempostd';\n}\n\n\n.leadingText-attr {\n  font-size: .22em;\n  font-family: 'Open Sans';\n  line-height: 1;\n  font-weight: 600!important;\n}\n\n.salePrice-attr {\n  display: flex;\n  flex-direction: row;\n  justify-content: center;\n  font-family:'tempostd';\n  align-items: flex-start;\n}\n\n.prePrice-attr {\n  font-size: 0.5em;\n  padding-top: 0.3em;\n}\n\n.midPrice-attr {\n  font-size: 0.5em;\n  display: flex;\n  align-items: center;\n  margin: 0 0.2em 0.2em 0.2em;\n}\n\n.plusone {\n  display: flex;\n  align-items: center;\n  align-self: flex-start;\n  padding-top: 20px;\n}\n\n.plusone::after {\n  content: '+';\n  font-size: 0.6em;\n  margin-left: 0em;\n  margin-right: 0.6em;\n  padding-bottom: 0;\n  padding-top: 0;\n}\n\n\n.attrPlus {\n  display: flex;\n  align-items: center;\n  align-self: center;\n}\n\n.attrPlus::after {\n  content: '+';\n  font-weight: 600;\n  font-size: 0.5em;\n  margin-left: 0.4em;\n  margin-right: 0.4em;\n  padding-top: 0.4em;\n}\n\n\n\n.leadingTextRight{\n  text-align: right;\n  padding-right: 5px;\n}\n\n.leadingTextLeft{\n  text-align: left;\n  padding-left: 5px;\n}\n\n#optimizely-extension-4214BFA8-AD11-4312-8689-0BBBE96FA51F > div.hero-mobile-content-wrapper > div > div.attrContainer.hp-flex-col > span.salePrice-attr{    \n  font-size: 3.2em!important;\n}\n\n.hero-mobile-sticky {\n  display:none!important;\n}\n\n\n  \n@media(min-width: 390px) and (max-width: 399px) {\n  #optimizely-extension-7EB304FD-8E13-4518-89EC-AE1D0F154068 > div > div > span{\n      font-size: 26px!important;\n}\n  .price-attributes{\n        font-size: 64px!important;}\n  .backToFunContainer{\n  margin-top:-26%!Important}\n}\n\n@media(min-width: 400px){\n#optimizely-extension-7EB304FD-8E13-4518-89EC-AE1D0F154068 > div > div > div:nth-child(1) > span{\n      font-size: 31px!important;\n}\n  .price-attributes{\n        font-size: 68px!important;}\n  .backToFunContainer{\n  margin-top:-26%!Important}\n\n\t.hero-header-mobile {\n \t  height:714px!important;\n\t}\n  .cyber-lockup{\nmargin-top:33%!important;}\n\n \n}\n\n@media(min-width: 410px){\n\n\n\n}\n\n@media(min-width: 420px){\n\n\n}\n\n@media(min-width: 430px){\n\n\n}\n\n@media (orientation: landscape) {\n  .cyber-lockup{\n    margin-top: 0% !important;}\n\n  \t#optimizely-extension-55536AAF-F1DB-4DD8-A395-AFF628BDF871l > div.hero-mobile-content-wrapper {\n    color: rgba(2, 35, 69, 1);\n    text-shadow: 2px 2px 6px rgb(26 26 26 / 13%);\n    margin-top: 39px!important;\n    margin-left: auto!important;\n    margin-right: auto!important;\n  }\n}</style>", "dependencies": []}, {"id": "7EB304FD-8E13-4518-89EC-AE1D0F154068", "type": "widget", "dependencies": [], "name": "Hero | Mobile (with onclick update)", "widget_id": "30314080267", "config": {"imgPortrait": "/~/media/Images/hp-merch/2024/mobile/heros/group-walking-icons.jpg", "imgLandscape": "/~/media/Images/hp-merch/2024/mobile/heros/group-walking-icons-lnds.jpg", "ctaURL": "/cruise-search?icid=crm_ccl_ozz_112424_mbl_hero_h1_tgo_1&cruisedeals=ozz&rateCodes=OZZ", "contentAlignment": "align-self:center", "contentExtraStyles": "", "priceAttributes": "<div class=\"backToFunContainer hp-text-blue-dark hp-text-shadow-none\" style=\"margin-top: -25%;\">\n        <div style=\"\nline-height:1;\ndisplay: flex;\nflex-direction: column;\nalign-content: center;\njustify-content: center;\nalign-items:center\n    \"><span style=\"font-family:tempo;text-align: center;font-size: 26px;line-height: .9;\">PASS THE SAVINGS? YOU GOT IT!</span>\n  </div>\n\n  <div class=\"price-attributes  hp-items-start hp-my-2 \" style=\"align-items: flex-end;font-size: 64px;display: flex;line-height: .9; \"  aria-hidden=\"true\">\n   \n      \n    <div class=\"attrContainer hp-flex-row attr-2 \" aria-hidden=\"true\">\n       \n<span class=\"leadingText-attr hp-font-tempo\" style=\" margin-right:5px;text-align:right;\">SAVE<br> UP TO</span><span class=\"salePrice-attr\" style=\"\"><span style=\"font-size: .4em;margin-top: 4px;\">$</span>950<sup style=\"font-size: .3em;top: 11px;position: relative;\">*</sup>\n</span><span class=\"leadingText-attr hp-font-tempo\" style=\"margin-left:5px;text-align:left\">PER <br> ROOM</span>\n      </div>\n    \n</div>\n  <span class=\"hp-font-tempo\" style=\"\n    line-height: 1;\n    font-size: 26px;\n    display: block;\n    text-align: center;\n\" aria-hidden=\"true\">- PLUS MORE PERKS -</span>\n  \n  <a aria-label=\"Search cruises,Save up to $950 Per Room, PLUS MORE PERKS\"  class=\"hero-mobile-button\" tabindex=\"0\" style=\"margin-top: 13px; text-shadow:none\" href=\"/cruise-search?icid=crm_ccl_ozz_112424_mbl_hero_h1_tgo_1&cruisedeals=ozz&rateCodes=OZZ\">SEARCH CRUISES</a>\n</div>", "landscapeMargins": "margin-top: 0vh;\n\nmargin-bottom: 0vh;\n\nmargin-left: 0vh;\n\nmargin-right:0vh;", "imageAlt": ""}}, {"id": "BD7F92F7-5195-4D9F-B03B-7358309DD48E", "type": "widget", "dependencies": [], "name": "Image Swap/Carousel | Hero/C Tile With PAUSE/PLAY", "widget_id": "5685106466619392", "config": {"images": "/~/media/Images/hp-merch/2024/mobile/heros/group-walking-icons.jpg,\n/~/media/Images/hp-merch/2024/mobile/heros/group-walking-icons-2.jpg", "speed": "1500", "selector": ".hero-header-mobile", "location": "beforebegin", "buttonPlacement": ""}}]}]}], "weightDistributions": null, "name": "1124-1128 Core OZZ | Mobile", "bucketingStrategy": null, "experimentMetadata": {"allocationPolicy": "manual", "layerId": "30033850921"}}, {"audienceIds": ["and", "4783120075", "14246380333", "10261134200", "6631919954165760", "4527279611576320"], "audienceName": "Desktop & Tablet ,Non-Booked Guest - AND - Not CH session,All | Exclude Synthetic Script \"KTNX\",Exclusion |Nov. Core '24 | TGO,Exclusion|Nov. Broadbase '24 | Casino", "changes": null, "id": "6750394110443520", "integrationSettings": null, "variations": [{"id": "4865925938151424", "name": "Version 1 - WITH ANIMATION", "actions": [{"viewId": "9414621687", "changes": [{"id": "C0A271A7-F03D-47FC-BE71-A2AE0A860C84", "type": "custom_code", "value": function($){var $ = window.jQuery;
var utils = window.optimizely.get('utils');
var dcp = window.optimizely.get("dcp");
}, "dependencies": []}, {"id": "6BF9C7D8-9D8F-4733-AE1B-AA98B30F91FE", "type": "append", "selector": "head", "value": "<style>#optimizely-extension-09BFD6C7-AAC7-40C0-863E-AD0D039C3992 {\n\tbottom: 10%!important;\n  left: 10px!important;\n}\n\n#hero-section {\n height: \t481px!important;;\n}\n\n.hero-header{\n    border-bottom-left-radius: 24px;\n      border-bottom-right-radius: 24px;\n}\n.itinImage-2,.itinCard-2,.dealsSeeMore{\n  border-radius:24px!important;\n}\n.hero-header{\ndisplay:flex!important; \n  flex-direction:column;\njustify-content:flex-start;\nalign-items:center;\n  background-size:contain!important;\n  height: 441px!important;\n}\n.dealImage-2{\n  margin:0px!important;\n  border-top-left-radius: 24px!important;\n  border-top-right-radius: 24px!important;\n   border-bottom-left-radius: 0px!important;\n  border-bottom-right-radius: 0px!important;\n}\n\n.tile-item  {\n\tmargin: 5px!important;\n}\n\n\n#optimizely-extension-F25CA88B-A788-4FF0-B67F-4ACD180FD2E2 > div {\n\tmargin-bottom:20px!important;\n}\n\n.row-2-wrap {\n\tdisplay:none!important;\n}\n\n#optimizely-extension-6DE8CB6D-8521-4DB2-8A7A-B6C72050E950 {\n\tbackground-position: center;\n}\n\n\n#adtile-sub {\n  display:block!important;\n}\n\n.hero-attr {\n\tmargin-top:15%;\n}\n\n.hero-header > .heroContainer {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  box-sizing: border-box;\n  max-width: 960px !important;\nbackground-size:contain!important;\n  justify-content: center;\n  height: 75%;\n}\n\n.ctileBreak {\n  display: none;\n}\n\n.ctiletravel {\n  width:80%;\n  margin: 0 auto\n}\n\n.attrBTile {\n  position: relative;\n  padding-left: 15px;\n}\n\n.attrBTile::before {\n  content: 'UP';\n  position: absolute;\n  top: 5px;\n  left: 0;\n  font-size: 0.4em;\n}\n\n.attrBTile::after {\n  content: 'TO';\n  position: absolute;\n  bottom: 5px;\n  left: 0;\n  font-size: 0.4em;\n}\n\n.open-html-hero {\n  position: relative;\n}\n\n.faq-bar, .hero-headline {\n  display: none !important;\n}\n\n.cTileCta {\n  clear: both;\n  border-radius: 0;\n  font-size: 170%;\n  font-family: \"tempo\", sans-serif;\n  border: none;\n  display: inline-block;\n  margin: 20px 0 0 0;\n  padding: 16px 32px;\n  line-height: 1;\n  text-transform: uppercase;\n  cursor: pointer;\n  color: #FFF;\n  background: #DC1125;\n  border-radius: 4px;\n}\n\n.price-attributes {\n  display: flex;\n  font-size: 75px;\n  text-transform: uppercase;\n  font-family: 'Open Sans', sans-serif;\n  justify-content: center;\n  align-items: center;\n}\n\n.attrContainer {\n  display: flex;\n  text-align: center;\n  align-items: center;\n  flex-direction: column;\n}\n\n.leadingText-attr {\n  font-size: 0.18em;\n  line-height: 1;\n  font-weight:600!important;\n}\n\n.salePrice-attr {\n  display: flex;\n  flex-direction: row;\n  justify-content: center;\n  font-family: tempo;\n  margin-bottom: -0.15em;\n  margin-top: -0.15em;\n}\n\n.prePrice-attr {\n  font-size: 0.5em;\n  padding-top: 0.3em;\n}\n\n.midPrice-attr {\n  font-size: 0.5em;\n  display: flex;\n  align-items: center;\n  margin: 0 0.2em 0.2em 0.2em;\n}\n\n.attrPlus {\n  display: flex;\n  align-items: center;\n  align-self: center;\n}\n\n.attrPlus::after {\n  content: '+';\n  font-size: 0.5em;\n  margin-left: 0.2em;\n  margin-right: 0.2em;\n  padding-bottom: 0;\n  font-weight: 600;\n}\n\ndel {\n   position: relative;\n   text-decoration: none;\n   opacity: .7;\n   margin-right: 10px;\n}\n\ndel::after {\n   content: \"\";\n   position: absolute;\n   top: 0.44em;\n   left: 0.1em;\n   width: 2.3em;\n   height: 0.1em;\n   background: #c03;\n   transform: rotate(20deg);\n}\n\n.leadingTextRight\t{\n  text-align: center;\n}\n\n.leadingTextLeft\t{\n  text-align: center;\n}\n\n/*c tile styles*/\n.hero-price-attributes {\n  display:flex;\n  justify-content: center;\n  line-height: 1;\n}\n\n.hero-attr-container {\n  display: flex;\n  align-items: center;\n}\n\n.hero-sale-price-attr {\n  display:flex;\n}\n\n.hero-leading-text-attr {\n  font-size: .16em;\n  line-height: 1;\n  font-family:'Open Sans';\n  font-weight:600;\n}\n\n.hero-dollar-sign {\n  font-size: 0.4em;\n  margin-top: .21em;\n  margin-right: 1%;\n}\n\n.hero-asterisk {\n  font-size: 0.3em;\n  margin-top: 6%;\n}\n\ndel {\n  position: relative;\n  text-decoration: none;\n  opacity: .7;\n  margin-right: 10px;\n}\n\ndel::after {\n\t\tcontent: \"\";\n    position: absolute;\n    width: 1.65em;\n    height: 0.075em;\n    background: #c03;\n    transform: rotate(24deg);\n}\n\n@media screen and (max-width: 768px) {\n  .butter-bar\t{\n    display: none;\n  }\n}\n\n@media (max-width: 768px) {\n  #CountdownBar\t{\n    display: none !important;\n  }\n}\n\n\n@media (max-width: 1350px) {\n  .hero-header > .center {\n    margin:0 auto 0 170px;\n  }\n  .sec-banner {\n    font-size: 0.9rem;\n  }\n}\n\n@media (max-width: 1300px) {\n\n  .hero-header > .heroContainer{\n\n  }\n\n    #optimizely-extension-86F4CE9F-84BF-4726-AFD3-7E2601827409 {\n  \theight:377px!important;\n  }\n  \n  .responsive-c-tile{\n    margin-top:144px!important;\n  }\n  \n  .ck-button{\n    margin-top:98px!important;\n  }\n}\n\n@media (max-width: 1285px) {\n\t#optimizely-extension-F2D2DA1F-D68A-4D2B-B9D9-8F4BB9C04647 {\n\t\theight: 287px!important;\n\t}\n  \n\t#hero-section {\n \t\theight: 443px!important;;\n\t}\n  \n  .hero-header {\n  \theight: 398px!important;\n  }\n  \n  #optimizely-extension-F2D2DA1F-D68A-4D2B-B9D9-8F4BB9C04647 > div { \n  \tmargin-left: -32%!important;\n  }\n  \n}\n\n@media (max-width: 1285px) {\n\t#optimizely-extension-97183214-C2B6-4AF4-B313-08DC16226A93 {\n\t\theight: 289px!important;\n\t}\n}\n\n@media (max-width: 1270px) {\n  .sec-banner\t{\n    text-align: center;\n    font-size: 1rem;\n  }\n  .ctiletravel\t{\n    width:90%;\n    margin: 0 auto\n  }\n     \n}\n\n\n\n@media (max-width: 1200px) {\n  .hero-header > .center {\n    margin:0 auto 0 90px;\n  }\n  #optimizely-extension-94D02531-F6CA-4C0F-A17F-18A2772FC249 > div > div > img {\n  \tmax-width: 567px!important;\n  }\n  .hero-header {\n  \theight: 402px!important;\n  }\n  #optimizely-extension-6A60D498-8E46-44B7-A5B3-7E5CCB10E366 {\n  \twidth: 1272px!important;\n  }\n \n}\n\n@media (max-width: 1100px) {\n  #optimizely-extension-09BFD6C7-AAC7-40C0-863E-AD0D039C3992 {\n  \tbottom: 21%!important;\n  }\n \n}</style>", "dependencies": []}, {"id": "6A60D498-8E46-44B7-A5B3-7E5CCB10E366", "type": "widget", "dependencies": [], "name": "Hero | Desktop (with onclick update)", "widget_id": "30291230470", "config": {"img": "/~/media/Images/hp-merch/2024/desktop/heros/thanksgiving1.jpg", "waterMark": "", "left": "", "lnk": "/cruise-search?cruisedeals=earlysaversale&icid=crm_ccl_earlysaversale_112424_hm_hero_h1_publicv1_1&ratecodes=OCS", "bottom": "110px", "waterShadowColor": "rgba(0, 0, 0, 1)", "openhtml": "<div class=\"hp-text-blue-dark\" style=\"\n        font-family: tempo;\n        line-height: 1.15;\n        display: flex;\n        flex-direction: column;\n        justify-content: center;\n        align-items: center;\n        margin-left: 7%;\n        margin-top: 4%;\n    \"><span class=\"\" style=\"\n    text-align:center;\n    font-size: 38px;\n    position: relative;\n    line-height: .9;\n    \">BIG SAVINGS WORTH SHARING</span>\n   \n    <div class=\"price-attributes hp-items-start\" style=\"\n    display: flex;\n    font-size: 76px;\n    align-items: flex-end;\n    margin-top: 10px;\n    margin-bottom: 3px;\n    \" aria-hidden=\"true\">\n           \n\n      \n       <div class=\"attrContainer hp-flex-col\" aria-hidden=\"true\">\n        <span class=\"leadingText-attr  hp-font-bold \" style=\"\n    font-weight: 650!important;\n   \n\">UP TO</span><span class=\"salePrice-attr\" style=\"\">40<span class=\"prePrice-attr hp-flex hp-flex-col\" style=\"font-size: .45em;padding-top: 14px;\"><span style=\"line-height:.8;align-self: start;\">%<sup style=\"font-size: 0.6em;top: 2px;position: relative;\">*</sup></span><span style=\"line-height:.9\">OFF</span></span>\n</span><span class=\"leadingText-attr hp-font-semibold\" style=\"\n    font-weight: 650!important;\n   \n    text-align: center;\n\">CRUISE RATES</span>\n      </div>\n        <div class=\"attrPlus\" style=\"margin-left: 20px;margin-right: 6px;margin-top: 8px;\" aria-hidden=\"true\"></div>\n            <div class=\"attrContainer hp-flex-col\" aria-hidden=\"true\">\n<span class=\"leadingText-attr  hp-font-semibold \" style=\"font-weight:650!important;text-align:center;\">REDUCED<br>DEPOSITS FROM</span> <span class=\"salePrice-attr\" style=\"\"><span style=\"font-size:.4em;margin-top: 12px;text-align:left;line-height:1;\">$</span>50<sup style=\"font-size: 0.3em;top: 10px;position: relative;display: none\">*</sup></span><span class=\"leadingText-attr  hp-font-semibold \" style=\"font-weight:650!important;text-align: center;margin-left: 7px;\">PER PERSON</span>\n      </div>  \n     </div>\n  <span aria-hidden=\"true\" style=\"\n    font-size: 23px;\n    text-align: center;\n    line-height: 1;\n    align-self: center;\n    margin-top: 11px;\n    color:#052049;\n\" class=\"hp-font-tempo \">- PLUS FREE ROOM UPGRADE -</span>\n  \n    <a aria-label=\"Search cruises, up to 40% off cruise rates, plus reduced deposits from $50 per person, plus free room upgrade.\" class=\"CTileCTA ctaHover hp-text-shadow-none\" style=\"font-size: 170%;margin-top: 14px;color: white;\" tabindex=\"0\" href=\"/cruise-search?cruisedeals=earlysaversale&icid=crm_ccl_earlysaversale_112424_hm_hero_h1_publicv1_1&ratecodes=OCS\">SEARCH CRUISES</a>\n        </div>", "top": "", "backgroundColor": "rgba", "altText": "", "right": "220px", "waterTextColor": "rgba(16, 85, 154, 1)"}}, {"id": "09BFD6C7-AAC7-40C0-863E-AD0D039C3992", "type": "widget", "dependencies": [], "name": "Image Swap/Carousel | Hero/C Tile With PAUSE/PLAY", "widget_id": "5685106466619392", "config": {"images": "/~/media/Images/hp-merch/2024/desktop/heros/thanksgiving1.jpg,/~/media/Images/hp-merch/2024/desktop/heros/thanksgiving2v2.jpg", "speed": "1500", "selector": ".hero-header ", "location": "beforebegin", "buttonPlacement": ".hero-header > .heroContainer"}}, {"id": "97183214-C2B6-4AF4-B313-08DC16226A93", "type": "widget", "dependencies": [], "name": "C Tile (with onclick update)", "widget_id": "30286280430", "config": {"inserAfterDesktop": ".row-2-wrap", "additionalStyles": "background-image: url(/~/media/Images/hp-merch/2024/desktop/ctiles/thanksgiving.jpg);\n    background-size: cover;\n    background-position: center;\n    background-size: cover;\n    background-repeat: no-repeat;\n    color: white;\n    margin-top: 15px;\n    height: 320px;\n    position: relative;\n    z-index: 1;\n    display: flex;\n    justify-content: center;\n    overflow: hidden;\n    align-items: center;\nborder-radius: 24px;", "innerHTML": "<div class=\"hp-text-blue-dark\" style=\"\n        font-family: tempo;\n        line-height: 1.15;\n        display: flex;\n        flex-direction: column;\n        justify-content: center;\n        align-items: center;\n        margin-left: -1%;\n        margin-top: -1%;\n        /* text-shadow:1px -3px 7px white, 0px 1px 3px white; */\n    \"><span class=\"\" style=\"\n    text-align:center;\n    font-size: 36px;\n    position: relative;\n    line-height: .9;\n    \">THANKFUL FOR<br>BONUS ONBOARD CREDIT</span>\n      \n    <div style=\"display: flex;flex-direction: column;margin-top: 9px;\"><span class=\"hp-text-red hp-font-tempo\" style=\"\n    font-size: 22px;\n    text-shadow: -1px -1px 1px white, 1px -1px 1px white, -1px 1px 1px white, 1px 1px 1px white, -1px 0px 1px white, 1px 0px 1px white;\n    margin-bottom: -11px;\n    margin-left: auto;\n    margin-right: auto;\n    right: 24px;\n    position: relative;\n    display: none;\">-BONUS-</span><div class=\"price-attributes hp-items-start\" style=\"\n    display: flex;\n    font-size: 77px;\n    align-items: flex-end;\n    margin-top: 0px;\n    margin-bottom: 3px;\n    \" aria-hidden=\"true\">\n           \n     <span class=\"leadingText-attr  hp-font-semibold \" style=\"font-weight:650!important;text-align: right;margin-top: auto;margin-bottom: auto;margin-right: 10px;\">UP<br>TO</span><div class=\"attrContainer hp-flex-col\" aria-hidden=\"true\">\n <span class=\"salePrice-attr\" style=\"\"><span style=\"font-size:.4em;margin-top: 12px;text-align:left;line-height:1;\">$</span>50<sup style=\"font-size: 0.3em;top: 11px;position: relative;\">*</sup></span>\n      </div>    \n        \n        \n       \n     <span class=\"leadingText-attr  hp-font-semibold \" style=\"font-weight:650!important;text-align: left;margin-left: 7px;margin-top: auto;margin-bottom: auto;\">ONBOARD<br>CREDIT</span></div></div>\n\n  \n    <a aria-label=\"shop this deal, Up to $50* onboard credit.\" class=\"CTileCTA ctaHover hp-text-shadow-none\" style=\"font-size: 170%;margin-top: 10px;color: white;\" tabindex=\"0\" href=\"/cruise-search?cruisedeals=earlysaversale&icid=crm_ccl_earlysaversale_112424_hm_ctile_ct1_publicv1_1&ratecodes=OCS\">SHOP THIS DEAL\n   </a>\n        </div>", "link": "/cruise-search?cruisedeals=earlysaversale&icid=crm_ccl_earlysaversale_112424_hm_ctile_ct1_publicv1_1&ratecodes=OCS", "location": "afterend", "btiletoggle": "sec-banner", "altText": ""}}]}]}, {"id": "6507195882274816", "name": "Version 2 - NO ANIMATION", "actions": [{"viewId": "9414621687", "changes": [{"id": "DBC6ACBB-2907-4388-A246-BA9F914086E3", "type": "custom_code", "value": function($){var $ = window.jQuery;
var utils = window.optimizely.get('utils');
var dcp = window.optimizely.get("dcp");
}, "dependencies": []}, {"id": "9C9EB2CE-9FC2-446F-B061-E031E1FDE6F9", "type": "append", "selector": "head", "value": "<style>#hero-section {\n height: \t481px!important;;\n}\n\n.hero-header\t{\n  border-bottom-left-radius: 24px;\n  border-bottom-right-radius: 24px;\n}\n.itinImage-2,.itinCard-2,.dealsSeeMore\t{\n  border-radius:24px!important;\n}\n\n.hero-header\t{\n\tdisplay:flex!important; \n  flex-direction:column;\n\tjustify-content:flex-start;\n\talign-items:center;\n  height: 441px!important;\n}\n\n.dealImage-2\t{\n  margin:0px!important;\n  border-top-left-radius: 24px!important;\n  border-top-right-radius: 24px!important;\n  border-bottom-left-radius: 0px!important;\n  border-bottom-right-radius: 0px!important;\n}\n\n.tile-item  {\n\tmargin: 5px!important;\n}\n\n\n#optimizely-extension-F25CA88B-A788-4FF0-B67F-4ACD180FD2E2 > div {\n\tmargin-bottom:20px!important;\n}\n\n.row-2-wrap {\n\tdisplay:none!important;\n}\n\n#optimizely-extension-6DE8CB6D-8521-4DB2-8A7A-B6C72050E950 {\n\tbackground-position: center;\n}\n\n\n#adtile-sub {\n  display:block!important;\n}\n\n.hero-attr {\n\tmargin-top:15%;\n}\n\n.hero-header > .heroContainer {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  box-sizing: border-box;\n  max-width: 960px !important;\n\tbackground-size:contain!important;\n  justify-content: center;\n  height: 75%;\n}\n\n.ctileBreak {\n  display: none;\n}\n\n.ctiletravel {\n  width:80%;\n  margin: 0 auto\n}\n\n.attrBTile {\n  position: relative;\n  padding-left: 15px;\n}\n\n.attrBTile::before {\n  content: 'UP';\n  position: absolute;\n  top: 5px;\n  left: 0;\n  font-size: 0.4em;\n}\n\n.attrBTile::after {\n  content: 'TO';\n  position: absolute;\n  bottom: 5px;\n  left: 0;\n  font-size: 0.4em;\n}\n\n.open-html-hero {\n  position: relative;\n}\n\n.faq-bar, .hero-headline {\n  display: none !important;\n}\n\n.cTileCta {\n  clear: both;\n  border-radius: 0;\n  font-size: 170%;\n  font-family: \"tempo\", sans-serif;\n  border: none;\n  display: inline-block;\n  margin: 20px 0 0 0;\n  padding: 16px 32px;\n  line-height: 1;\n  text-transform: uppercase;\n  cursor: pointer;\n  color: #FFF;\n  background: #DC1125;\n  border-radius: 4px;\n}\n\n.price-attributes {\n  display: flex;\n  font-size: 75px;\n  text-transform: uppercase;\n  font-family: 'Open Sans', sans-serif;\n  justify-content: center;\n  align-items: center;\n}\n\n.attrContainer {\n  display: flex;\n  text-align: center;\n  align-items: center;\n  flex-direction: column;\n}\n\n.leadingText-attr {\n  font-size: 0.18em;\n  line-height: 1;\n  font-weight:600!important;\n}\n\n.salePrice-attr {\n  display: flex;\n  flex-direction: row;\n  justify-content: center;\n  font-family: tempo;\n  margin-bottom: -0.15em;\n  margin-top: -0.15em;\n}\n\n.prePrice-attr {\n  font-size: 0.5em;\n  padding-top: 0.3em;\n}\n\n.midPrice-attr {\n  font-size: 0.5em;\n  display: flex;\n  align-items: center;\n  margin: 0 0.2em 0.2em 0.2em;\n}\n\n.attrPlus {\n  display: flex;\n  align-items: center;\n  align-self: center;\n}\n\n.attrPlus::after {\n  content: '+';\n  font-size: 0.5em;\n  margin-left: 0.2em;\n  margin-right: 0.2em;\n  padding-bottom: 0;\n  font-weight: 600;\n}\n\ndel {\n   position: relative;\n   text-decoration: none;\n   opacity: .7;\n   margin-right: 10px;\n}\n\ndel::after {\n   content: \"\";\n   position: absolute;\n   top: 0.44em;\n   left: 0.1em;\n   width: 2.3em;\n   height: 0.1em;\n   background: #c03;\n   transform: rotate(20deg);\n}\n\n.leadingTextRight\t{\n  text-align: center;\n}\n\n.leadingTextLeft\t{\n  text-align: center;\n}\n\n/*c tile styles*/\n.hero-price-attributes {\n  display:flex;\n  justify-content: center;\n  line-height: 1;\n}\n\n.hero-attr-container {\n  display: flex;\n  align-items: center;\n}\n\n.hero-sale-price-attr {\n  display:flex;\n}\n\n.hero-leading-text-attr {\n  font-size: .16em;\n  line-height: 1;\n  font-family:'Open Sans';\n  font-weight:600;\n}\n\n.hero-dollar-sign {\n  font-size: 0.4em;\n  margin-top: .21em;\n  margin-right: 1%;\n}\n\n.hero-asterisk {\n  font-size: 0.3em;\n  margin-top: 6%;\n}\n\ndel {\n  position: relative;\n  text-decoration: none;\n  opacity: .7;\n  margin-right: 10px;\n}\n\ndel::after {\n\t\tcontent: \"\";\n    position: absolute;\n    width: 1.65em;\n    height: 0.075em;\n    background: #c03;\n    transform: rotate(24deg);\n}\n\n@media screen and (max-width: 768px) {\n  .butter-bar\t{\n    display: none;\n  }\n}\n\n@media (max-width: 768px) {\n  #CountdownBar\t{\n    display: none !important;\n  }\n}\n\n\n@media (max-width: 1350px) {\n  .hero-header > .center {\n    margin:0 auto 0 170px;\n  }\n  .sec-banner {\n    font-size: 0.9rem;\n  }\n}\n\n@media (max-width: 1300px) {\n  #optimizely-extension-86F4CE9F-84BF-4726-AFD3-7E2601827409 {\n  \theight:377px!important;\n  }\n}\n\n@media (max-width: 1285px) {\n\t#optimizely-extension-02AD2E41-CF19-4F70-AF66-925CE67E3578 {\n\t\theight: 287px!important;\n\t}\n  \n\t#hero-section {\n \t\theight: 428px!important;;\n\t}\n  \n  .hero-header {\n  \theight: 398px!important;\n  }\n  \n  #optimizely-extension-F2D2DA1F-D68A-4D2B-B9D9-8F4BB9C04647 > div { \n  \tmargin-left: -32%!important;\n  }\n  \t#optimizely-extension-97183214-C2B6-4AF4-B313-08DC16226A93 {\n\t\theight: 289px!important;\n\t}\n  \n}\n\n@media (max-width: 1270px) {\n  .sec-banner\t{\n    text-align: center;\n    font-size: 1rem;\n  }\n  .ctiletravel\t{\n    width:90%;\n    margin: 0 auto\n  }\n     \n}\n\n\n\n@media (max-width: 1200px) {\n  .hero-header > .center {\n    margin:0 auto 0 90px;\n  }\n  #optimizely-extension-94D02531-F6CA-4C0F-A17F-18A2772FC249 > div > div > img {\n  \tmax-width: 567px!important;\n  }\n  .hero-header {\n  \theight: 402px!important;\n  }\n  #optimizely-extension-6A60D498-8E46-44B7-A5B3-7E5CCB10E366 {\n  \twidth: 1272px!important;\n  }\n \n}</style>", "dependencies": []}, {"id": "D7DAE562-8433-4225-9C55-F90E733B8D90", "type": "widget", "dependencies": [], "name": "Hero | Desktop (with onclick update)", "widget_id": "30291230470", "config": {"img": "/~/media/Images/hp-merch/2024/desktop/heros/thanksgiving1.jpg", "waterMark": "", "left": "", "lnk": "/cruise-search?cruisedeals=earlysaversale&icid=crm_ccl_earlysaversale_112424_hm_hero_h1_publicv2_1&ratecodes=OCS", "bottom": "110px", "waterShadowColor": "rgba(0, 0, 0, 1)", "openhtml": "<div class=\"hp-text-blue-dark\" style=\"\n        font-family: tempo;\n        line-height: 1.15;\n        display: flex;\n        flex-direction: column;\n        justify-content: center;\n        align-items: center;\n        margin-left: 7%;\n        margin-top: 1.5%;\n    \"><span class=\"\" style=\"\n    text-align:center;\n    font-size: 38px;\n    position: relative;\n    line-height: .9;\n    \">BIG SAVINGS WORTH SHARING</span>\n   \n    <div class=\"price-attributes hp-items-start\" style=\"\n    display: flex;\n    font-size: 76px;\n    align-items: flex-end;\n    margin-top: 10px;\n    margin-bottom: 3px;\n    \" aria-hidden=\"true\">\n           \n\n      \n       <div class=\"attrContainer hp-flex-col\" aria-hidden=\"true\">\n        <span class=\"leadingText-attr  hp-font-bold \" style=\"\n    font-weight: 650!important;\n   \n\">UP TO</span><span class=\"salePrice-attr\" style=\"\">40<span class=\"prePrice-attr hp-flex hp-flex-col\" style=\"font-size: .45em;padding-top: 14px;\"><span style=\"line-height:.8;align-self: start;\">%<sup style=\"font-size: 0.6em;top: 2px;position: relative;\">*</sup></span><span style=\"line-height:.9\">OFF</span></span>\n</span><span class=\"leadingText-attr hp-font-semibold\" style=\"\n    font-weight: 650!important;\n   \n    text-align: center;\n\">CRUISE RATES</span>\n      </div>\n        <div class=\"attrPlus\" style=\"margin-left: 20px;margin-right: 6px;margin-top: 8px;\" aria-hidden=\"true\"></div>\n            <div class=\"attrContainer hp-flex-col\" aria-hidden=\"true\">\n<span class=\"leadingText-attr  hp-font-semibold \" style=\"font-weight:650!important;text-align:center;\">REDUCED<br>DEPOSITS FROM</span> <span class=\"salePrice-attr\" style=\"\"><span style=\"font-size:.4em;margin-top: 12px;text-align:left;line-height:1;\">$</span>50<sup style=\"font-size: 0.3em;top: 10px;position: relative;display: none\">*</sup></span><span class=\"leadingText-attr  hp-font-semibold \" style=\"font-weight:650!important;text-align: center;margin-left: 7px;\">PER PERSON</span>\n      </div>  \n     </div>\n  <span aria-hidden=\"true\" style=\"\n    font-size: 23px;\n    text-align: center;\n    line-height: 1;\n    align-self: center;\n    margin-top: 11px;\n    color:#052049;\n\" class=\"hp-font-tempo \">- PLUS FREE ROOM UPGRADE -</span>\n  \n    <a aria-label=\"Search cruises, up to 40% off cruise rates, plus reduced deposits from $50 per person, plus free room upgrade.\" class=\"CTileCTA ctaHover hp-text-shadow-none\" style=\"font-size: 170%;margin-top: 14px;color: white;\" tabindex=\"0\" href=\"/cruise-search?cruisedeals=earlysaversale&icid=crm_ccl_earlysaversale_112424_hm_hero_h1_publicv2_1&ratecodes=OCS\">SEARCH CRUISES</a>\n        </div>", "top": "", "backgroundColor": "rgba", "altText": "", "right": "220px", "waterTextColor": "rgba(16, 85, 154, 1)"}}, {"id": "02AD2E41-CF19-4F70-AF66-925CE67E3578", "type": "widget", "dependencies": [], "name": "C Tile (with onclick update)", "widget_id": "30286280430", "config": {"inserAfterDesktop": ".row-2-wrap", "additionalStyles": "background-image: url(/~/media/Images/hp-merch/2024/desktop/ctiles/thanksgiving.jpg);\n    background-size: cover;\n    background-position: center;\n    background-size: cover;\n    background-repeat: no-repeat;\n    color: white;\n    margin-top: 15px;\n    height: 320px;\n    position: relative;\n    z-index: 1;\n    display: flex;\n    justify-content: center;\n    overflow: hidden;\n    align-items: center;\nborder-radius: 24px;", "innerHTML": "<div class=\"hp-text-blue-dark\" style=\"\n        font-family: tempo;\n        line-height: 1.15;\n        display: flex;\n        flex-direction: column;\n        justify-content: center;\n        align-items: center;\n        margin-left: -1%;\n        margin-top: -1%;\n        /* text-shadow:1px -3px 7px white, 0px 1px 3px white; */\n    \"><span class=\"\" style=\"\n    text-align:center;\n    font-size: 36px;\n    position: relative;\n    line-height: .9;\n    \">THANKFUL FOR<br>BONUS ONBOARD CREDIT</span>\n      \n    <div style=\"display: flex;flex-direction: column;margin-top: 9px;\"><span class=\"hp-text-red hp-font-tempo\" style=\"\n    font-size: 22px;\n    text-shadow: -1px -1px 1px white, 1px -1px 1px white, -1px 1px 1px white, 1px 1px 1px white, -1px 0px 1px white, 1px 0px 1px white;\n    margin-bottom: -11px;\n    margin-left: auto;\n    margin-right: auto;\n    right: 24px;\n    position: relative;\n    display: none;\">-BONUS-</span><div class=\"price-attributes hp-items-start\" style=\"\n    display: flex;\n    font-size: 77px;\n    align-items: flex-end;\n    margin-top: 0px;\n    margin-bottom: 3px;\n    \" aria-hidden=\"true\">\n           \n     <span class=\"leadingText-attr  hp-font-semibold \" style=\"font-weight:650!important;text-align: right;margin-top: auto;margin-bottom: auto;margin-right: 10px;\">UP<br>TO</span><div class=\"attrContainer hp-flex-col\" aria-hidden=\"true\">\n <span class=\"salePrice-attr\" style=\"\"><span style=\"font-size:.4em;margin-top: 12px;text-align:left;line-height:1;\">$</span>50<sup style=\"font-size: 0.3em;top: 11px;position: relative;\">*</sup></span>\n      </div>    \n        \n        \n       \n     <span class=\"leadingText-attr  hp-font-semibold \" style=\"font-weight:650!important;text-align: left;margin-left: 7px;margin-top: auto;margin-bottom: auto;\">ONBOARD<br>CREDIT</span></div></div>\n\n  \n    <a aria-label=\"shop this deal, Up to $50* onboard credit.\" class=\"CTileCTA ctaHover hp-text-shadow-none\" style=\"font-size: 170%;margin-top: 10px;color: white;\" tabindex=\"0\" href=\"/cruise-search?cruisedeals=earlysaversale&icid=crm_ccl_earlysaversale_112424_hm_ctile_ct1_publicv2_1&ratecodes=OCS\">SHOP THIS DEAL\n   </a>\n        </div>", "link": "/cruise-search?cruisedeals=earlysaversale&icid=crm_ccl_earlysaversale_112424_hm_ctile_ct1_publicv2_1&ratecodes=OCS", "location": "afterend", "btiletoggle": "sec-banner", "altText": ""}}]}]}], "weightDistributions": [{"entityId": "4865925938151424", "endOfRange": 5000}, {"entityId": "6507195882274816", "endOfRange": 10000}], "name": "1124-1126 Early Saver Bonus - Thanksgiving | Desktop", "bucketingStrategy": null, "experimentMetadata": {"allocationPolicy": "manual", "layerId": "30033850921"}}, {"audienceIds": ["and", "5283750624", "14246380333", "10261134200", "4527279611576320", "6631919954165760"], "audienceName": "Mobile Phones Only,Non-Booked Guest - AND - Not CH session,All | Exclude Synthetic Script \"KTNX\",Exclusion|Nov. Broadbase '24 | Casino,Exclusion |Nov. Core '24 | TGO", "changes": null, "id": "5027287591026688", "integrationSettings": null, "variations": [{"id": "6317163846303744", "name": "Version 1 - WITH ANIMATION", "actions": [{"viewId": "9414621687", "changes": [{"id": "C4F32103-6508-418B-BA65-ED2823AE88D5", "type": "custom_code", "value": function($){var $ = window.jQuery;
var utils = window.optimizely.get('utils');
var dcp = window.optimizely.get("dcp");

utils.waitForElement(".profile").then(function() {
  $('<div class="carousels"></div>').insertBefore('.profile');
});

dcp.waitForAttributeValue({
  datasourceId: 5271970099494912,
  attributeName: "vifp_num"
}).then(function(vifp) {
  if(vifp)
  {

    utils.waitForElement('.hero-header-mobile').then(function(){
      var tempLink = $('.hero-header-mobile').attr('onclick');
      tempLink = tempLink.substring(tempLink.indexOf('\';'),0) + '&vifp='+vifp+'\'';
      $('.hero-header-mobile').attr('onclick', tempLink);
    });

    utils.waitForElement('.hero-header-mobile-landscape').then(function(){
      var tempLink = $('.hero-header-mobile-landscape').attr('onclick');
      tempLink = tempLink.substring(tempLink.indexOf('\';'),0) + '&vifp='+vifp+'\'';
      $('.hero-header-mobile-landscape').attr('onclick', tempLink);
    });

    utils.waitForElement('.hero-mobile-button').then(function(){
      var tempLink = $('.hero-mobile-button').attr('onclick');
      tempLink = tempLink.substring(tempLink.indexOf('\';'),0) + '&vifp='+vifp+'\'';
      $('.hero-mobile-button').attr('onclick', tempLink);
    });
  
  }
});
}, "dependencies": []}, {"id": "F2B32574-6F7C-430D-9E2E-C51EB06BF80A", "type": "append", "selector": "head", "value": "<style>.hero-header-mobile{\n    border-bottom-left-radius: 24px;\n      border-bottom-right-radius: 24px;\n}\n.itinImage-2,.itinCard-2,.cardSeeMore{\n  border-radius:24px!important;\n}\n#adTile1{\ndisplay:none}\n#adTile2{\ndisplay:none}\n#adTile3{\ndisplay:none}\n.dealImage-2{\n  margin:0px!important;\n  border-top-left-radius: 24px!important;\n  border-top-right-radius: 24px!important;\n   border-bottom-left-radius: 0px!important;\n  border-bottom-right-radius: 0px!important;\n}\n/*CK tile */\n/*\n#ccl-mainContainer > div.js-home-promo.js-hero-banners-personalizer-target > div:nth-child(1) {\n\tdisplay: none!important;\n}*/\n\n\n.hero-header-mobile {\n  background-position: center!important;\n  background-size: cover!important;\n  height:609px!important;\n  \n}\n.cyber-lockup{\nmargin-top:21%;}\n\n.hero-mobile-content-wrapper {\n  height: 88%;\n  display: flex;\n  flex-direction: column;\n}\n\ndel {\n  position: relative;\n  text-decoration: none;\n  opacity: .7;\n  margin-right: 10px;\n}\n\ndel::after {\n\tcontent: \"\";\n  position: absolute;\n  top: 0.4em;\n  left: 0.07em;\n  width: 1.65em;\n  height: 0.075em;\n  background: #c03;\n  transform: rotate(24deg);\n}\n\n  /*button*/\n#optimizely-extension-4214BFA8-AD11-4312-8689-0BBBE96FA51F > div.hero-mobile-content-wrapper > div > button{\n  transform: scale(0.8)!important;\n}\n\n.price-attributes {\n  display: flex;\n  font-size: 55px;\n  text-transform: uppercase;\n  font-family: 'Open Sans', sans-serif;\n  justify-content: center;\n  margin:0;\n  align-items: center;\n  line-height: normal;\n}\n\n.attrContainer {\n  display: flex;\n  flex-direction: row;\n  text-align: center;\n  align-items: center;\n  font-family:'tempostd';\n}\n\n\n.leadingText-attr {\n  font-size: .19em;\n  font-family: 'Open Sans';\n  line-height: 1;\n  font-weight: 600!important;\n}\n\n.salePrice-attr {\n  display: flex;\n  flex-direction: row;\n  justify-content: center;\n  font-family:'tempostd';\n  align-items: flex-start;\n}\n\n.prePrice-attr {\n  font-size: 0.5em;\n  padding-top: 0.3em;\n}\n\n.midPrice-attr {\n  font-size: 0.5em;\n  display: flex;\n  align-items: center;\n  margin: 0 0.2em 0.2em 0.2em;\n}\n\n.plusone {\n  display: flex;\n  align-items: center;\n  align-self: flex-start;\n  padding-top: 20px;\n}\n\n.plusone::after {\n  content: '+';\n  font-size: 0.6em;\n  margin-left: 0em;\n  margin-right: 0.6em;\n  padding-bottom: 0;\n  padding-top: 0;\n}\n\n\n.attrPlus {\n  display: flex;\n  align-items: center;\n  align-self: center;\n}\n\n.attrPlus::after {\n  content: '+';\n  font-weight: 600;\n  font-size: 0.5em;\n  margin-left: 0.4em;\n  margin-right: 0.4em;\n  padding-top: 0.4em;\n}\n\n\n\n.leadingTextRight{\n  text-align: right;\n  padding-right: 5px;\n}\n\n.leadingTextLeft{\n  text-align: left;\n  padding-left: 5px;\n}\n\n#optimizely-extension-4214BFA8-AD11-4312-8689-0BBBE96FA51F > div.hero-mobile-content-wrapper > div > div.attrContainer.hp-flex-col > span.salePrice-attr{    \n  font-size: 3.2em!important;\n}\n\n.hero-mobile-sticky {\n  display:none!important;\n}\n\n\n  \n@media(min-width: 390px){\n}\n\n@media(min-width: 400px){\n\t.hero-header-mobile {\n \t  height:657px!important;\n\t}\n  \n  #optimizely-extension-FACA6900-FF84-40FA-9783-CC581A483062 > div > div{\n  \tmargin-top: 161px!important;\n  }\n \n}\n\n@media(min-width: 410px){\n  .hero-header-mobile {\n  \theight:691px!important;\n  }\n #optimizely-extension-FACA6900-FF84-40FA-9783-CC581A483062 > div > div {\n  \tmargin-top: 171px!important;\n  }\n  \n\n}\n\n@media(min-width: 420px){\n\t.hero-header-mobile {\n  \theight:695px!important;\n\t}\n    #optimizely-extension-FACA6900-FF84-40FA-9783-CC581A483062 > div > div {\n  \tmargin-top: 175px!important;\n  }\n\n}\n\n@media(min-width: 430px){\n\t.hero-header-mobile {\n\t  height:700px!important;\n\t}\n\n}\n\n@media (orientation: landscape) {\n \t#optimizely-extension-55536AAF-F1DB-4DD8-A395-AFF628BDF871l > div.hero-mobile-content-wrapper {\n    color: rgba(2, 35, 69, 1);\n    text-shadow: 2px 2px 6px rgb(26 26 26 / 13%);\n    margin-top: 39px!important;\n    margin-left: auto!important;\n    margin-right: auto!important;\n  }\n}</style>", "dependencies": []}, {"id": "FACA6900-FF84-40FA-9783-CC581A483062", "type": "widget", "dependencies": [], "name": "Hero | Mobile (with onclick update)", "widget_id": "30314080267", "config": {"imgPortrait": "/~/media/Images/hp-merch/2024/mobile/heros/thanksgiving1.jpg", "imgLandscape": "/~/media/Images/hp-merch/2024/mobile/heros/thanksgiving-lnds.jpg", "ctaURL": "/cruise-search?cruisedeals=earlysaversale&icid=crm_ccl_earlysaversale_112424_mbl_hero_h1_publicv1_1&ratecodes=OCS", "contentAlignment": "align-self:center", "contentExtraStyles": "", "priceAttributes": "<div class=\"hp-text-blue-dark hp-flex hp-center responsive-hero hp-text-shadow-none\" style=\"flex-direction:column;margin-top: 141px;align-items: center;\">\n<div class=\"hp-font-tempo hp-text-center clock-header\" style=\"font-size: 33px;line-height: .9;\">BIG SAVINGS WORTH SHARING</div>\n  \n     \n<div class=\"price-attributes  hp-items-start clock-hero-attributes\" style=\"\n    align-items: flex-end;\n    font-size: 55px;\n    display: flex;\n    margin-top: 7px;\n    line-height: .9;\n    \" aria-hidden=\"true\">\n    \n   \n        \n  <div class=\"attrContainer hp-flex-col attr-2\" aria-hidden=\"true\">\n     <span class=\"leadingText-attr\" style=\"font-weight: 650;\">UP TO</span>\n<span class=\"salePrice-attr\" style=\"\">40<span class=\"prePrice-attr hp-flex hp-flex-col\" style=\"font-size: .45em;padding-top: 4px;\"><span style=\"line-height:.8;align-self: start;\">%<sup style=\"font-size: .55em;top: -10px;position: relative;\">*</sup>\n</span><span style=\"line-height:.9\">OFF</span></span>\n</span><span class=\"leadingText-attr\" style=\"font-weight: 650;\">CRUISE RATES</span>\n      </div><div class=\"attrPlus plus1\" style=\"margin-left: 6px;margin-right: 2px;margin-top: -4px;\" aria-hidden=\"true\"></div><div class=\"attrContainer hp-flex-col attr-2\" aria-hidden=\"true\">\n        \n<span class=\"salePrice-attr\" style=\"\">FREE<sup style=\"font-size: .35em;top: 12px;position: relative;display: none;\">*</sup>\n</span><span class=\"leadingText-attr\" style=\"font-weight: 650;\">ROOM UPGRADE</span>\n      </div><div class=\"attrPlus plus1\" style=\"margin-left: 5px;margin-right: -6px;margin-top: -4px;\" aria-hidden=\"true\"></div>\n    \n \n\n           <div class=\"attrContainer hp-flex-col attr-2\" aria-hidden=\"true\">\n        \n<span class=\"leadingText-attr\" style=\" font-weight: 650;\">REDUCED<br>DEPOSITS FROM</span><span class=\"salePrice-attr\" style=\"\"><span style=\"font-size: .4em;margin-top: 3px;\">$</span>50<sup style=\"font-size: .35em;top: 12px;position: relative;display: none;\">*</sup>\n</span><span class=\"leadingText-attr\" style=\"font-weight: 650;\">PER PERSON</span>\n      </div></div> \n  \n<a aria-label=\"Search cruises, up to 40% off cruise rates, plus reduced deposits from $50 per person, plus free room upgrade.\"  tabindex=\"0\" class=\"tile-cta\" style=\"color: white;font-size: 16px!important;padding: 10px 16px!important;margin-top: 13px;\" href=\"/cruise-search?cruisedeals=earlysaversale&icid=crm_ccl_earlysaversale_112424_mbl_hero_h1_publicv1_1&ratecodes=OCS\">SEARCH CRUISES</a>\n\n</div>", "landscapeMargins": "margin-top: 0vh;\n\nmargin-bottom: 0vh;\n\nmargin-left: 0vh;\n\nmargin-right:0vh;", "imageAlt": ""}}, {"id": "6759DE1E-69DC-4195-8AEF-6FFB20AC4C96", "type": "widget", "dependencies": [], "name": "Image Swap/Carousel | Hero/C Tile With PAUSE/PLAY", "widget_id": "5685106466619392", "config": {"images": "/~/media/Images/hp-merch/2024/mobile/heros/thanksgiving1.jpg,/~/media/Images/hp-merch/2024/mobile/heros/thanksgiving2.jpg", "speed": "1500", "selector": "#optimizely-extension-FACA6900-FF84-40FA-9783-CC581A483062", "location": "beforebegin", "buttonPlacement": ".hero-mobile-content-wrapper"}}, {"id": "C500292B-4E27-4AE3-A88F-188F4F306D58", "type": "widget", "dependencies": [], "name": "B Tile | Mobile (with onclick update)", "widget_id": "30333950668", "config": {"order": "0", "bTileBG": "/~/media/Images/hp-merch/2024/mobile/tiles/thanksgiving.jpg", "clickThrough": "/cruise-search?cruisedeals=earlysaversale&icid=crm_ccl_earlysaversale_112424_mbl_btile_b1_publicv1_1&ratecodes=OCS", "b1Copy": "<div class=\"hp-text-blue-dark hp-flex hp-center responsive-hero hp-text-shadow-none\" style=\"flex-direction:column;margin-top: -70%;align-items: center;\">\n<div class=\"hp-font-tempo hp-text-center clock-header\" style=\"font-size: 37px;line-height: 1;\">THANKFUL FOR<br>BONUS ONBOARD CREDIT</div>\n  \n     \n<div class=\"price-attributes  hp-items-start clock-hero-attributes\" style=\"\n    align-items: flex-end;\n    font-size: 76px;\n    display: flex;\n    margin-top: 8px;\n    line-height: .9;\n    \" aria-hidden=\"true\">\n    \n   \n        \n  <div class=\"attrContainer hp-flex-row attr-2\" aria-hidden=\"true\">\n        \n<span class=\"leadingText-attr\" style=\"font-weight: 650;text-align: right;margin-right: 7px;\">UP<br>TO</span><span class=\"salePrice-attr\" style=\"\"><span style=\"font-size: .4em;margin-top: 3px;\">$</span>50<sup style=\"font-size: .35em;top: 14px;position: relative;\">*</sup>\n</span><span class=\"leadingText-attr\" style=\"font-weight: 650;text-align: left;margin-left: 3px;\">ONBOARD<br>CREDIT</span>\n      </div>\n    \n\n  \n\n           </div>\n<a aria-label=\"shop this deal, Up to $50* onboard credit.\" tabindex=\"0\" class=\"tile-cta\" style=\"\ncolor: white;    font-size: 16px!important;\n    padding: 10px 16px!important;\n    margin-top: 12px;\n    \" href=\"/cruise-search?cruisedeals=earlysaversale&icid=crm_ccl_earlysaversale_112424_mbl_btile_b1_publicv1_1&ratecodes=OCS\">SHOP THIS DEAL</a>\n\n</div>", "copyMargin": "", "contentPosition": "center", "altText": ""}}]}]}, {"id": "5281394096603136", "name": "Version 2 - NO ANIMATION", "actions": [{"viewId": "9414621687", "changes": [{"id": "DE784085-283C-4E8D-8A92-CCD2989E3EC8", "type": "append", "selector": "head", "value": "<style>.hero-header-mobile{\n    border-bottom-left-radius: 24px;\n      border-bottom-right-radius: 24px;\n}\n.itinImage-2,.itinCard-2,.cardSeeMore{\n  border-radius:24px!important;\n}\n#adTile1{\ndisplay:none}\n#adTile2{\ndisplay:none}\n#adTile3{\ndisplay:none}\n.dealImage-2{\n  margin:0px!important;\n  border-top-left-radius: 24px!important;\n  border-top-right-radius: 24px!important;\n   border-bottom-left-radius: 0px!important;\n  border-bottom-right-radius: 0px!important;\n}\n/*CK tile */\n/*\n#ccl-mainContainer > div.js-home-promo.js-hero-banners-personalizer-target > div:nth-child(1) {\n\tdisplay: none!important;\n}*/\n\n\n.hero-header-mobile {\n  background-position: center!important;\n  background-size: cover!important;\n  height:609px!important;\n  \n}\n.cyber-lockup{\nmargin-top:21%;}\n\n.hero-mobile-content-wrapper {\n  height: 88%;\n  display: flex;\n  flex-direction: column;\n}\n\ndel {\n  position: relative;\n  text-decoration: none;\n  opacity: .7;\n  margin-right: 10px;\n}\n\ndel::after {\n\tcontent: \"\";\n  position: absolute;\n  top: 0.4em;\n  left: 0.07em;\n  width: 1.65em;\n  height: 0.075em;\n  background: #c03;\n  transform: rotate(24deg);\n}\n\n  /*button*/\n#optimizely-extension-4214BFA8-AD11-4312-8689-0BBBE96FA51F > div.hero-mobile-content-wrapper > div > button{\n  transform: scale(0.8)!important;\n}\n\n.price-attributes {\n  display: flex;\n  font-size: 55px;\n  text-transform: uppercase;\n  font-family: 'Open Sans', sans-serif;\n  justify-content: center;\n  margin:0;\n  align-items: center;\n  line-height: normal;\n}\n\n.attrContainer {\n  display: flex;\n  flex-direction: row;\n  text-align: center;\n  align-items: center;\n  font-family:'tempostd';\n}\n\n\n.leadingText-attr {\n  font-size: .19em;\n  font-family: 'Open Sans';\n  line-height: 1;\n  font-weight: 600!important;\n}\n\n.salePrice-attr {\n  display: flex;\n  flex-direction: row;\n  justify-content: center;\n  font-family:'tempostd';\n  align-items: flex-start;\n}\n\n.prePrice-attr {\n  font-size: 0.5em;\n  padding-top: 0.3em;\n}\n\n.midPrice-attr {\n  font-size: 0.5em;\n  display: flex;\n  align-items: center;\n  margin: 0 0.2em 0.2em 0.2em;\n}\n\n.plusone {\n  display: flex;\n  align-items: center;\n  align-self: flex-start;\n  padding-top: 20px;\n}\n\n.plusone::after {\n  content: '+';\n  font-size: 0.6em;\n  margin-left: 0em;\n  margin-right: 0.6em;\n  padding-bottom: 0;\n  padding-top: 0;\n}\n\n\n.attrPlus {\n  display: flex;\n  align-items: center;\n  align-self: center;\n}\n\n.attrPlus::after {\n  content: '+';\n  font-weight: 600;\n  font-size: 0.5em;\n  margin-left: 0.4em;\n  margin-right: 0.4em;\n  padding-top: 0.4em;\n}\n\n\n\n.leadingTextRight{\n  text-align: right;\n  padding-right: 5px;\n}\n\n.leadingTextLeft{\n  text-align: left;\n  padding-left: 5px;\n}\n\n#optimizely-extension-4214BFA8-AD11-4312-8689-0BBBE96FA51F > div.hero-mobile-content-wrapper > div > div.attrContainer.hp-flex-col > span.salePrice-attr{    \n  font-size: 3.2em!important;\n}\n\n.hero-mobile-sticky {\n  display:none!important;\n}\n\n\n  \n@media(min-width: 390px){\n}\n\n@media(min-width: 400px){\n\t.hero-header-mobile {\n \t  height:657px!important;\n\t}\n  \n  #optimizely-extension-1A8AA476-78F9-466A-9930-BDD472802DAD > div > div {\n  \tmargin-top: 161px!important;\n  }\n \n}\n\n@media(min-width: 410px){\n  .hero-header-mobile {\n  \theight:691px!important;\n  }\n  #optimizely-extension-1A8AA476-78F9-466A-9930-BDD472802DAD > div > div {\n  \tmargin-top: 171px!important;\n  }\n  \n\n}\n\n@media(min-width: 420px){\n\t.hero-header-mobile {\n  \theight:695px!important;\n\t}\n   #optimizely-extension-1A8AA476-78F9-466A-9930-BDD472802DAD > div > div {\n  \tmargin-top: 175px!important;\n  }\n\n}\n\n@media(min-width: 430px){\n\t.hero-header-mobile {\n\t  height:700px!important;\n\t}\n\n}\n\n@media (orientation: landscape) {\n \t#optimizely-extension-55536AAF-F1DB-4DD8-A395-AFF628BDF871l > div.hero-mobile-content-wrapper {\n    color: rgba(2, 35, 69, 1);\n    text-shadow: 2px 2px 6px rgb(26 26 26 / 13%);\n    margin-top: 39px!important;\n    margin-left: auto!important;\n    margin-right: auto!important;\n  }\n}</style>", "dependencies": []}, {"id": "1A8AA476-78F9-466A-9930-BDD472802DAD", "type": "widget", "dependencies": [], "name": "Hero | Mobile (with onclick update)", "widget_id": "30314080267", "config": {"imgPortrait": "/~/media/Images/hp-merch/2024/mobile/heros/thanksgiving1.jpg", "imgLandscape": "/~/media/Images/hp-merch/2024/mobile/heros/thanksgiving-lnds.jpg", "ctaURL": "/cruise-search?cruisedeals=earlysaversale&icid=crm_ccl_earlysaversale_112424_mbl_hero_h1_publicv2_1&ratecodes=OCS", "contentAlignment": "align-self:center", "contentExtraStyles": "", "priceAttributes": "<div class=\"hp-text-blue-dark hp-flex hp-center responsive-hero hp-text-shadow-none\" style=\"flex-direction:column;margin-top: 141px;align-items: center;\">\n<div class=\"hp-font-tempo hp-text-center clock-header\" style=\"font-size: 33px;line-height: .9;\">BIG SAVINGS WORTH SHARING</div>\n  \n     \n<div class=\"price-attributes  hp-items-start clock-hero-attributes\" style=\"\n    align-items: flex-end;\n    font-size: 55px;\n    display: flex;\n    margin-top: 7px;\n    line-height: .9;\n    \" aria-hidden=\"true\">\n    \n   \n        \n  <div class=\"attrContainer hp-flex-col attr-2\" aria-hidden=\"true\">\n     <span class=\"leadingText-attr\" style=\"font-weight: 650;\">UP TO</span>\n<span class=\"salePrice-attr\" style=\"\">40<span class=\"prePrice-attr hp-flex hp-flex-col\" style=\"font-size: .45em;padding-top: 4px;\"><span style=\"line-height:.8;align-self: start;\">%<sup style=\"font-size: .55em;top: -10px;position: relative;\">*</sup>\n</span><span style=\"line-height:.9\">OFF</span></span>\n</span><span class=\"leadingText-attr\" style=\"font-weight: 650;\">CRUISE RATES</span>\n      </div><div class=\"attrPlus plus1\" style=\"margin-left: 6px;margin-right: 2px;margin-top: -4px;\" aria-hidden=\"true\"></div><div class=\"attrContainer hp-flex-col attr-2\" aria-hidden=\"true\">\n        \n<span class=\"salePrice-attr\" style=\"\">FREE<sup style=\"font-size: .35em;top: 12px;position: relative;display: none;\">*</sup>\n</span><span class=\"leadingText-attr\" style=\"font-weight: 650;\">ROOM UPGRADE</span>\n      </div><div class=\"attrPlus plus1\" style=\"margin-left: 5px;margin-right: -6px;margin-top: -4px;\" aria-hidden=\"true\"></div>\n    \n \n\n           <div class=\"attrContainer hp-flex-col attr-2\" aria-hidden=\"true\">\n        \n<span class=\"leadingText-attr\" style=\" font-weight: 650;\">REDUCED<br>DEPOSITS FROM</span><span class=\"salePrice-attr\" style=\"\"><span style=\"font-size: .4em;margin-top: 3px;\">$</span>50<sup style=\"font-size: .35em;top: 12px;position: relative;display: none;\">*</sup>\n</span><span class=\"leadingText-attr\" style=\"font-weight: 650;\">PER PERSON</span>\n      </div></div> \n  \n<a aria-label=\"Search cruises, up to 40% off cruise rates, plus reduced deposits from $50 per person, plus free room upgrade.\"  tabindex=\"0\" class=\"tile-cta\" style=\"color: white;font-size: 16px!important;padding: 10px 16px!important;margin-top: 13px;\" href=\"/cruise-search?cruisedeals=earlysaversale&icid=crm_ccl_earlysaversale_112424_mbl_hero_h1_publicv2_1&ratecodes=OCS\">SEARCH CRUISES</a>\n\n</div>", "landscapeMargins": "margin-top: 0vh;\n\nmargin-bottom: 0vh;\n\nmargin-left: 0vh;\n\nmargin-right:0vh;", "imageAlt": ""}}, {"id": "7187C471-C1E7-40BE-A4AA-7885B444BE3E", "type": "widget", "dependencies": [], "name": "B Tile | Mobile (with onclick update)", "widget_id": "30333950668", "config": {"order": "0", "bTileBG": "/~/media/Images/hp-merch/2024/mobile/tiles/thanksgiving.jpg", "clickThrough": "/cruise-search?cruisedeals=earlysaversale&icid=crm_ccl_earlysaversale_112424_mbl_btile_b1_publicv2_1&ratecodes=OCS", "b1Copy": "<div class=\"hp-text-blue-dark hp-flex hp-center responsive-hero hp-text-shadow-none\" style=\"flex-direction:column;margin-top: -70%;align-items: center;\">\n<div class=\"hp-font-tempo hp-text-center clock-header\" style=\"font-size: 37px;line-height: 1;\">THANKFUL FOR<br>BONUS ONBOARD CREDIT</div>\n  \n     \n<div class=\"price-attributes  hp-items-start clock-hero-attributes\" style=\"\n    align-items: flex-end;\n    font-size: 76px;\n    display: flex;\n    margin-top: 8px;\n    line-height: .9;\n    \" aria-hidden=\"true\">\n    \n   \n        \n  <div class=\"attrContainer hp-flex-row attr-2\" aria-hidden=\"true\">\n        \n<span class=\"leadingText-attr\" style=\"font-weight: 650;text-align: right;margin-right: 7px;\">UP<br>TO</span><span class=\"salePrice-attr\" style=\"\"><span style=\"font-size: .4em;margin-top: 3px;\">$</span>50<sup style=\"font-size: .35em;top: 14px;position: relative;\">*</sup>\n</span><span class=\"leadingText-attr\" style=\"font-weight: 650;text-align: left;margin-left: 3px;\">ONBOARD<br>CREDIT</span>\n      </div>\n    \n\n  \n\n           </div>\n<a aria-label=\"shop this deal, Up to $50* onboard credit.\" tabindex=\"0\" class=\"tile-cta\" style=\"\ncolor: white;    font-size: 16px!important;\n    padding: 10px 16px!important;\n    margin-top: 12px;\n    \" href=\"/cruise-search?cruisedeals=earlysaversale&icid=crm_ccl_earlysaversale_112424_mbl_btile_b1_publicv2_1&ratecodes=OCS\">SHOP THIS DEAL</a>\n\n</div>", "copyMargin": "", "contentPosition": "center", "altText": ""}}]}]}], "weightDistributions": [{"entityId": "6317163846303744", "endOfRange": 5000}, {"entityId": "5281394096603136", "endOfRange": 10000}], "name": "1124-1126 Early Saver Bonus - Thanksgiving | Mobile", "bucketingStrategy": null, "experimentMetadata": {"allocationPolicy": "manual", "layerId": "30033850921"}}], "policy": "equal_priority", "viewIds": ["9414621687"], "weightDistributions": null, "decisionMetadata": {"experimentPriorities": [[{"entityId": "6712000189825024", "endOfRange": null}, {"entityId": "5911504185196544", "endOfRange": null}, {"entityId": "6750394110443520", "endOfRange": null}, {"entityId": "5027287591026688", "endOfRange": null}]], "experimentWeights": null, "offerConsistency": null}}, {"changes": null, "id": "30321250155", "name": "Personalization| Bucket 3", "commitId": "5712937109684224", "groupId": null, "holdback": 0, "activation": {}, "integrationSettings": {"contentsquare": {}, "google_analytics_4": {}}, "integrationStringVersion": 2, "experiments": [{"audienceIds": ["and", "14246380333"], "audienceName": "Non-Booked Guest - AND - Not CH session", "changes": null, "id": "6318105148784640", "integrationSettings": null, "variations": [{"id": "5048295114932224", "name": "Variation #1", "actions": [{"viewId": "9414621687", "changes": [{"id": "9431A1A1-DA57-43FC-BCF8-355290011AE3", "type": "custom_code", "value": function($){var utils = window.optimizely.get('utils');
var dcp = window.optimizely.get("dcp");

 if ($(window).width() < 960) {
utils.waitForElement('#optimizely-extension-1F27654C-72A9-4A71-A8E7-FFF74BB32488 > span').then(function(elem) {
$("#optimizely-extension-1F27654C-72A9-4A71-A8E7-FFF74BB32488 > span").empty();
$("#optimizely-extension-1F27654C-72A9-4A71-A8E7-FFF74BB32488 > span").append('<span class="copy-pack-title" style="color: white; display: flex;align-items: center;justify-content: center; white-space: nowrap;line-height: 1;"><span style="color: rgb(16, 85, 154)!important;font-size: 36px;margin-left: 5px;margin-right: 5px;text-align: center;">GET TOGETHER ON<br>OUR NEWEST SHIPS</span></span>');
});
 }
}, "dependencies": []}, {"id": "B16F3571-612F-4E67-B0B7-339AC5FF04CB", "type": "append", "selector": "head", "value": "<style>.pack-3>.pack-item{\n  border-radius:24px;\n}\n.pack-3>.pack-item>.pack-copy{    \n  text-shadow: 2px 2px 4px rgba(0, 0, 0, .5);\n}\n.bucket-3>.guide-pack>.guide-pack-title{    \n  display: flex;\n  align-items: center;\n  justify-content: center;\n  white-space: nowrap;\n  color: #10559a;\n}\n\n#optimizely-extension-7F4F6C46-140E-498C-8E79-731FFA4EF3B6 {\n\tmargin-top: 0px!important;\n}</style>", "dependencies": []}, {"id": "1F27654C-72A9-4A71-A8E7-FFF74BB32488", "type": "widget", "dependencies": [], "name": "3/4 Tiles Guide Carousel | Desktop  (with onclick update) Caryn", "widget_id": "30453410332", "config": {"ThreeTilesCheck": "false", "TilesCheck": "3-tiles", "dskheight": "550px", "tile1": "<span class=\"responsive-pack-title-1\" aria-hidden=\"true\">CARNIVAL</span>\n  <span class=\"responsive-pack-title-2\" aria-hidden=\"true\">CELEBRATION<sup class=\"tm\">\u00ae</sup></span>", "color": "hp-text-white", "p5price": "", "tile2": "<span class=\"responsive-pack-title-1\" aria-hidden=\"true\">&nbsp;</span>\n  <span class=\"responsive-pack-title-2\"aria-hidden=\"true\">MARDI GRAS<sup class=\"tm\">\u00ae</sup></span>", "p4price": "", "tile3": "<span class=\"responsive-pack-title-1\"aria-hidden=\"true\">CARNIVAL</span>\n  <span class=\"responsive-pack-title-2\" aria-hidden=\"true\">JUBILEE<sup class=\"tm\">\u00ae</sup></span>", "p3price": "numadults=2&shipcode=jb", "tile4": "<span class=\"responsive-pack-title-1\" aria-hidden=\"true\">CARNIVAL</span>\n  <span class=\"responsive-pack-title-2\" aria-hidden=\"true\">CELEBRATION<sup class=\"tm\">\u00ae</sup></span>", "p2price": "numadults=2&shipcode=md", "height": "", "tile5": "<span class=\"responsive-pack-title-1\" aria-hidden=\"true\">CARNIVAL</span>\n  <span class=\"responsive-pack-title-2\" aria-hidden=\"true\">CELEBRATION<sup class=\"tm\">\u00ae</sup></span>", "p1price": "numadults=2&shipcode=cb", "tile5Url": "/cruise-search?icid=crm_ccl_ships_111224_resp_pack_p5_tgo_3&ship=cb", "tile4Url": "/cruise-search?icid=crm_ccl_ships_111224_resp_pack_p4_tgo_3&ship=cb", "p1aria": "carnival celebration sailings", "tile3Url": "/cruise-search?icid=crm_ccl_ships-jubilee_112424_resp_pack_p3_nonbooked_3&shipcode=jb", "titleCSS": "    padding-top: 0px !important;", "p2aria": "mardi gras sailings", "tile2Url": "/cruise-search?icid=crm_ccl_ships-mardigras_112424_resp_pack_p2_nonbooked_3&shipcode=md", "showprice": "true", "p3aria": "carnival jubilee sailings", "tile1Url": "/cruise-search?icid=crm_ccl_ships-celebration_112424_resp_pack_p1_nonbooked_3&shipcode=cb", "p4aria": "", "p5aria": "", "cta": "SEARCH CRUISES", "tile5Image": "/~/media/Images/hp-merch/2023/Desktop/tiles/journeys-tile.jpg", "tile4Image": "/~/media/Images/hp-merch/2023/Desktop/tiles/journeys-tile.jpg", "backgroundColor": "background-color: white;", "appendTo": ".bucket-3", "pNum": "3", "tile3Image": "/~/media/Images/hp-merch/2024/extras/carousel/ship-ocean.jpg", "tile2Image": "/~/media/Images/hp-merch/2024/extras/carousel/roller-coaster.jpg", "title": "<span style=\"width: 100%;display: block;margin: 0 25px 0 0;flex: 1;height: 2.5px; background-color: #10559a !important;\" aria-hidden=\"true\"></span> GET TOGETHER ON OUR NEWEST SHIPS <span style=\" width: 100%;   display: block; margin: 0 0 0 25px; flex: 1; height: 2.5px; background-color: #10559a !important;\" aria-hidden=\"true\"></span>", "tile1Image": "/~/media/Images/hp-merch/2024/extras/carousel/emilios-bistro.jpg", "mblheight": "420px", "packtitle": "title-bottom"}}, {"id": "99DC7030-C91E-471E-AFBD-93F644483A0E", "type": "widget", "dependencies": [], "name": "Utility Classes", "widget_id": "20108015752", "config": {}}, {"css": {}, "dependencies": [], "attributes": {}, "type": "attribute", "id": "B6B3CFD9-805C-492E-9F67-FF3BA6BFDE37", "selector": ".pack-item"}]}]}], "weightDistributions": null, "name": "1112 New Ships  - Nonbooked (Cyber) | Responsive", "bucketingStrategy": null, "experimentMetadata": {"allocationPolicy": "manual", "layerId": "30321250155"}}], "policy": "equal_priority", "viewIds": ["9414621687"], "weightDistributions": null, "decisionMetadata": {"experimentPriorities": [[{"entityId": "6318105148784640", "endOfRange": null}]], "experimentWeights": null, "offerConsistency": null}}, {"changes": null, "id": "20056241528", "name": "Temp Payment Edits - Footer styles", "commitId": "23091310704", "groupId": null, "holdback": 0, "activation": {}, "integrationSettings": {}, "integrationStringVersion": 2, "experiments": [{"audienceIds": ["and", "10261134200", "19994727757"], "audienceName": "All | Exclude Synthetic Script \"KTNX\",Exclusion | Canary", "changes": null, "id": "20596220204", "integrationSettings": null, "variations": [{"id": "20594860121", "name": "edits for BG page and footer", "actions": [{"viewId": "9840251783", "changes": [{"dependencies": [], "type": "custom_code", "id": "456700FD-C9F5-4BF1-809C-A8EA50DB8818", "value": function($){var $ = window.jQuery || window.optimizely.get('jquery');
var utils = window.optimizely.get('utils');

//EDITING DEPOSIT ONLY OPTION
utils.waitForElement('#payment-decision > div > ul > li:nth-child(2) > div').then(function () {
    //add price after deposit
    var totalpay = $('#toggle-header > ccl-currency > div > span.currency-value.ng-binding').text().replace(',', "");
    var datepay = $('div > div > span:contains(remainder)').text().match(/(?=due)(.*)/)[0];
    var totaldep = $('#des-option-content-0 > div > span.des-option-amount.ng-binding').text();
    var remainderpay = (totalpay - totaldep);
    var comma = (remainderpay).toLocaleString();
    var final = "$" + comma;
    if ($('#des-option-content-1 > div > div:contains(remainder)').length) {
        //Change Deposit sub copy 
        $('#des-option-content-1 > div > div').html("Remaining " + final + " " + datepay);
    }
    else {
        $('#des-option-content-0 > div > div').html("Remaining " + final + " " + datepay);
    }
});

//EDITING UPLIFT OPTION - change Select to 
utils.waitForElement("#des-option-content-2").then(function () {
    var changeApply = setInterval(function () {
        if ($("#des-opt-btn-finance[ng-disabled='$ctrl.disableFinance(opt)']").length) {
            $("#des-opt-btn-finance[ng-disabled='$ctrl.disableFinance(opt)']").html("Apply&nbsp;");

        }
    }, 100);
});

//EDITING IF EASYPAY SELECTED HIDE PAYPAL OPTION 
utils.waitForElement('#des-opt-btn-installments').then(function () {
    $('#des-opt-btn-installments').on('click', function () {
        utils.waitForElement('#cpy-tab-dw').then(function () {
            $('#cpy-tab-dw').parent().attr('style', 'display: none;');
        });
    });
});

utils.waitForElement('#des-opt-btn-deposit').then(function () {
    $('#des-opt-btn-deposit').on('click', function () {
        utils.waitForElement('#cpy-tab-dw').then(function () {
            $('#cpy-tab-dw').parent().attr('style', 'display: block;');
        });
    });
});
}}, {"value": "<style>/*footer edits*/\n#ccl-refresh-footer {\nmargin-top:0!important;\n}</style>", "selector": "head", "dependencies": [], "type": "append", "id": "6000B367-FB51-4E22-A8B8-DB68B8847E9E"}]}]}], "weightDistributions": null, "name": "All | Exclude Synthetic Script \"KTNX\" and Exclusion | Canary", "bucketingStrategy": null, "experimentMetadata": {"allocationPolicy": "manual", "layerId": "20056241528"}}], "policy": "equal_priority", "viewIds": ["9435920943", "9840251783"], "weightDistributions": null, "decisionMetadata": {"experimentPriorities": [[{"entityId": "20596220204", "endOfRange": null}]], "experimentWeights": null, "offerConsistency": null}}, {"changes": [{"id": "9134316A-4D01-44BE-A7DE-9E949AD24431", "type": "custom_code", "value": function($){var utils = optimizely.get('utils');
var $ = window.jQuery;

utils.waitForElement(".profile").then(function() {
  $('<div class="carousels"></div>').insertBefore('.profile');
});
}, "dependencies": []}], "id": "21920421817", "name": "Personalization | HP | Hero & Btiles (Aug- ) DEV 4", "commitId": "6685955155820544", "groupId": null, "holdback": 0, "activation": {}, "integrationSettings": {"contentsquare": {}, "google_universal_analytics": {"universal_analytics_tracker": "t55", "universal_analytics_slot": "136"}, "17904671154": {}}, "integrationStringVersion": 2, "experiments": [{"audienceIds": ["and", "4783120075", "14246380333", "10261134200", "6146101774909440"], "audienceName": "Desktop & Tablet ,Non-Booked Guest - AND - Not CH session,All | Exclude Synthetic Script \"KTNX\",Casino| Nov FXS '24| HP", "changes": null, "id": "4669509936611328", "integrationSettings": null, "variations": [{"id": "4803777274839040", "name": "Variation #1", "actions": [{"viewId": "9414621687", "changes": [{"dependencies": [], "type": "custom_code", "id": "D7DD6AE5-DC56-4BFC-8BC2-DFC43C776C77", "value": function($){var $ = window.jQuery;
var utils = window.optimizely.get('utils');
var dcp = window.optimizely.get("dcp");
localStorage.removeItem('caroTrue');
dcp.waitForAttributeValue({
    datasourceId: 5282846651187200,
    attributeName: "vifp_num"
  }).then(function(vifp) {
    if (vifp)
    {$('.countdown-container').hide();
      $('.sec-banner').hide();
			$('.upliftBanner').show();
      $('.grid>.upliftBanner').hide();
      var tempLink1 ='&vifp='+vifp;
     

            utils.waitForElement('.hero-header').then(function(){
      var tempLink = $('.hero-header').attr('href');
      tempLink = tempLink.substring() + '?icid=crm_ccl_fxs_110424_hm_hero_h1_casino_1&cruisedeals=FXS'+tempLink1;
      $('.hero-header').attr('href', tempLink);
    }); 
//window.hpHeroUrl = '/cruise-search?icid=crm_ccl_fxs_091024_hm_h1_casino&cruisedeals=FXS'+tempLink1;
        utils.waitForElement('.cardSeeMore').then(function(){
      var tempLink = $('.cardSeeMore').attr('href');
      tempLink = tempLink.substring() + '?icid=crm_ccl_fxs_110424_hm_carousel_c1_casino_1&cruisedeals=FXS'+tempLink1;
      $('.cardSeeMore').attr('href', tempLink);
    }); 
    }
});

dcp.waitForAttributeValue({
    datasourceId: 5282846651187200,
    attributeName: "first_name"
  }).then(function(name) {
    if(name)
    {utils.waitForElement('.sub-head').then(function(elem) {$(".sub-head").html(name+", THIS CASINO OFFER IS EXCLUSIVELY FOR YOU!");  });
    }
    });
}}, {"value": "<style>.hero-header{\n    border-bottom-left-radius: 24px;\n      border-bottom-right-radius: 24px;\n}\n.itinImage-2,.itinCard-2,.dealsSeeMore{\n  border-radius:24px!important;\n}\n.dealImage-2{\n  margin:0px!important;\n  border-top-left-radius: 24px!important;\n  border-top-right-radius: 24px!important;\n   border-bottom-left-radius: 0px!important;\n  border-bottom-right-radius: 0px!important;\n}\n\n.hero-header > .heroContainer{\n    display: inline-flex;\n    flex-direction: row;\n    align-items: center;\n    max-width: none!important;\n    box-sizing: border-box;\n    width: 100%;\n\n}\n\n.itinImage{\n    background-size: cover!important;}\n.row-2-wrap{\n    display: none;}\n\n.hero-banner-left {\n  padding: 0 9% 0 0;\n}\n\n#toutsContainer2013 {\n    display: none !important;\n}\n\n.attrBTile{\n  position: relative;\n  padding-left: 15px;\n}\n\n.attrBTile::before{\n  content: 'UP';\n  position: absolute;\n  top: 5px;\n  left: 0;\n  font-size: 0.4em;\n}\n\n.attrBTile::after{\n  content: 'TO';\n  position: absolute;\n  bottom: 5px;\n  left: 0;\n  font-size: 0.4em;\n}\n\n\n.open-html-hero{\n  position: relative;\n}\n\n\n.faq-bar, .hero-headline{\n  display: none !important;\n}\n\n\n.price-attributes {\n  display: flex;\n  font-size: 75px;\n  text-transform: uppercase;\n  font-family: 'Open Sans', sans-serif;\n  justify-content: center;\n  color: #051F49;\n  align-items: flex-end;\n  text-shadow: none;\n}\n\n.attrContainer {\n  display: flex;\n  flex-direction: column;\n  text-align: center;\n  align-items: center;\n}\n\n.leadingText-attr {\nfont-size: .22em!important;\n  line-height: 1;\n  font-family:'Open sans';\n\n}\n\n.salePrice-attr {\n  display: flex;\n  flex-direction: row;\n  justify-content: center;\n  font-family: tempo;\n  margin-bottom: -0.15em;\n  margin-top: -0.15em;\n  font-size:45px!important;\n}\n\n.prePrice-attr {\n  font-size: 0.5em;\n  padding-top: 0.3em;\n}\n\n.midPrice-attr {\n  font-size: 0.5em;\n  display: flex;\n  align-items: center;\n  margin: 0 0.2em 0.2em 0.2em;\n}\n\n.attrPlus {\n  display: flex;\n  align-items: center;\n     align-self: center;\n     margin-left: -10px;\n  margin-top: -3%;\n  margin-right:-2px;\n}\n\n.attrPlus::after {\n  content: '+';\n  font-size: 0.5em;\n  margin-left: 0.4em;\n  margin-right: 0.4em;\n  padding-bottom: 0;\n      margin-top: -5%;\n  font-weight: 600;\n}\n\n\ndel {\n  position: relative;\n  text-decoration: none;\n  opacity: .7;\n  margin-right: 10px;\n}\n\ndel::after {\n    content: \"\";\n    position: absolute;\n    top: 0.7em;\n    left: .3px;\n    width: 2.1em;\n    height: 0.1em;\n    background: #c03;\n    transform: rotate(20deg);\n}\n\n.leadingTextRight{\n  text-align: center;\n\n}\n.leadingTextLeft{\n  text-align: center;\n\n}\n\n.lpgg-container{\n  display: none;\n}\n\n/*Uplift*/\n.sec-banner {\n    margin: auto;\n    max-width: 1400px;\n}\n\n\n@media screen and (max-width: 1400px){\n  .upliftToutLogo{\n    width: 75%;\n    padding: 5px 0 5px;\n  }\n}\n \n@media screen and (max-width: 1200px){\n  .upliftToutLogo{\n    width: 75%;\n    padding: 10px 0 10px;\n  }\n}\n \n@media screen and (max-width: 1000px){\n  .upliftToutLogo{\n    width: 80%;\n    padding: 10px 0 10px;\n  }\n}\n \n@media screen and (max-width: 950px){\n  .upliftToutLogo{\n    padding-bottom: 10px;\n  }\n}\n\n@media screen and (max-width: 768px){\n  .butter-bar{\n    display: none;\n  }\n}\n\n\n@media (max-width: 768px) {\n  #CountdownBar{\n    display: none !important;\n  }\n}\n\n@media (max-width: 1350px) {\n  .responsive{\n    margin-left:51%!important;\n  }\n  .hero-header {\n  background-position: top 0 left -94px!important;}\n}\n\n\n@media (max-width: 1200px) {\n  .hero-header > .center {\n    margin:0 auto 0 90px;\n  }\n\n}\n\n@media (min-width: 1300px) {\n  #optimizely-extension-9220AA96-571A-4A0C-A33B-79828E4DD63A > div > div > div{\n        margin-left: 45%!important;\n}\n  }}\n\n@media (max-width: 1100px) {\n  .sec-banner{\n    font-size: 0.8rem;\n  }\n\n\n\n\n  .hero-header > .center {\n    margin: 0 auto 0;\n  }\n\n}\n\n@media (max-width: 1599px) {\n\n    .hero-header > .heroContainer {\n    display: inline-flex;\n    flex-direction: row;\n    align-items: center;\n  \n    box-sizing: border-box;\n  \n    width: 100%;\n\n  }\n}</style>", "selector": "head", "dependencies": [], "type": "append", "id": "71A76166-DB26-42BB-9570-434EF475CA22"}, {"name": "Utility Classes", "config": {}, "id": "5B6A3970-3AC3-4F8D-8E6C-68EF02BF417F", "dependencies": [], "type": "widget", "widget_id": "20108015752"}, {"name": "Dynamic CTA Button", "config": {"additionalProps": "display:none", "posSelector": ".heroContainer", "link": "", "ctaHoverClass": "ctaHover", "insertPos": "beforeend", "txt": "Hurry! Ends<span id=\"urgencyMsg\"> soon</span>"}, "id": "53579724-0B5D-40BC-BBB4-09D5B0E55CDF", "dependencies": [], "type": "widget", "widget_id": "15955670599"}, {"id": "717244E1-75E2-4306-A09A-63E1FF9CF280", "type": "widget", "dependencies": [], "name": "Carousel | Deals w/Cover Image ADA", "widget_id": "30388620086", "config": {"carNumber": "1", "insertAfterDesktop": ".carousels", "insertAfterMobile": ".carouselsMobile", "headline": "", "numResults": "4", "carCoverImg": "/~/media/Images/hp-merch/2024/extras/carousel/casino-win.jpg", "htmlOverlayCopy": "<span class=\"hp-font-tempo hp-text-white\" style=\" font-size: 2.5em;\n    text-align: center;\n    display: flex;\n    flex-direction: column;\n    line-height: 1;\n   \"> CHECK OUT THESE <br> EXCLUSIVE DEALS<br> JUST FOR YOU</span>", "icid": "crm_ccl_fxs_092424_hp_carousel_c1_casino_1"}}, {"id": "6675B284-F990-413A-8F08-3610A128E67C", "type": "widget", "dependencies": [], "name": "Hero | Desktop (with onclick update)", "widget_id": "30291230470", "config": {"img": "/~/media/Images/hp-merch/2024/desktop/heros/echo-high-five.jpg", "waterMark": "", "left": "", "lnk": "/cruise-search?icid=crm_ccl_fxs_110424_hm_hero_h1_casino_1&cruisedeals=FXS", "bottom": "110px", "waterShadowColor": "rgba(0, 0, 0, 1)", "openhtml": "<div class=\"heroAttributes\" style=\"width: 100%;margin-top: 10px;\">\n     <div class=\"attrContainer hp-flex-col responsive\" style=\"margin-left: 46%;\">\n         \n      \n           <span class=\"hp-text-white hp-font-tempo\" style=\"font-size: 4.2em;\n    display: flex;\n    flex-direction: column;    margin-top: 1%;\n    align-items: center;\"><span style=\"    \">IT'S ALL ABOUT YOU!</span></span>\n      \n       <div style=\"display: flex; flex-direction: column; align-items: center;\">\n   <span class=\"sub-head hp-font-open-sans  hp-text-white hp-my-2\" style=\"  font-size: 1.2em;text-transform:uppercase;\">HEY, THIS CASINO OFFER IS EXCLUSIVELY FOR YOU!</span>\n    </div>\n  <div class=\"hp-mt-2 price-attributes hp-text-white hp-text-shadow-none\">\n    <span class=\"sr-only\">get a free suite $2,500 Funplay Credit and Drinks on us with this echo offer</span>\n    <div class=\"price-attributes hp-text-shadow-none hp-text-white hp-items-start\" aria-hidden=\"true\" style=\"font-size: 40px;\">\n      <!-- ATTRIBUTE -->\n      <div class=\"attrContainer hp-flex-col\">\n       <span class=\"leadingText-attr  hp-font-semibold \" style=\" font-weight: 600;margin-left:-9px\">GET A</span><span class=\"salePrice-attr\" style=\"font-size:65px;\">FREE<span style=\"font-size:.3em;margin-top:6px;margin-left:3px;\">*</span></span><span class=\"leadingText-attr hp-font-semibold\" style=\"font-weight: 600;margin-left:-8px\">SUITE</span><span class=\"leadingText-attr hp-font-semibold\" style=\"font-weight: 700;padding-top: 1px;text-transform:none;margin-left:-8px\">Free offer applies to cruise<br> fare only. Guest is responsible<br> for taxes, fees, and deposit.</span>\n      </div>\n      <!--PLUS-->\n       <div class=\"attrPlus\" style=\"position: relative;\"></div>\n        <!--PLUS-->\n       <!-- ATTRIBUTE -->\n      <div class=\"attrContainer hp-flex-col\">\n       <span class=\"leadingText-attr  hp-font-semibold \" style=\" font-weight: 600;\">&nbsp;</span> <span class=\"salePrice-attr\" style=\"font-size:65px;\"> <span style=\"font-size:.4em;margin-top: 10px;text-align:left;line-height:1;\">$</span> 2<span style=\"font-family:Open sans;margin-left: -2px;margin-right: -3px;font-size: 45px;\n    margin-top: -6px;\n\">,</span>500</span><span class=\"leadingText-attr  hp-font-semibold \" style=\"font-weight: 600;margin-left:10px;\"> FUNPLAY<sup style=\"font-size:.5em\">\u00ae</sup> CREDIT</span>\n      </div>\n      <!--PLUS-->\n        <div class=\"attrPlus\" style=\"position: relative;margin-left:-2px;\"></div>\n        <!--PLUS-->\n      <!-- ATTRIBUTE -->\n       <div class=\"attrContainer hp-flex-col\">\n        <span class=\"leadingText-attr  hp-font-semibold \" style=\"text-align:right;font-size:.165em; font-weight: 650;\">&nbsp;</span>\n        <span class=\"salePrice-attr\" style=\"font-size:65px;\">\nDRINKS<span style=\"font-size:.4em;margin-top:12px;text-align:left;margin-left:3%;line-height:1;\">ON<br>US!</span><span style=\"font-family: 'Open sans';font-size: .14em;margin-top: 31px;\">\u2020</span></span>  \n <span class=\"leadingText-attr  hp-font-semibold \" style=\"font-weight: 600;\">EVERYWHERE ON BOARD FOR<br>YOU AND 1 TRAVEL COMPANION</span>    \n        \n      </div>\n\n      </div>\n   \n    </div>\n         <span class=\"plusmore hp-text-white hp-font-tempo\" style=\"font-size: 1.8em;margin-top:5px;\">\u2013 PLUS MORE EXCLUSIVE PERKS \u2013</span>\n      <a aria-label=\"Shop this deal.Carnival PLayers Club ECHO, Executive Casino Host on Call. All For you. Get a free suite, 2500 funplay  credit and drinks on us\" \tclass=\"heroCTA ctaHover hp-text-shadow-none\" \n\tstyle=\"font-size: 170%;color:white;margin-top:2%\" tabindex=\"0\" href=\"/cruise-search?icid=crm_ccl_fxs_110424_hm_hero_h1_casino_1&cruisedeals=FXS\">SHOP THIS DEAL</a>\n \n    </div>\n    \n  </div>", "top": "", "backgroundColor": "rgba", "altText": "carnival players club, Echo - executive casino host on host on call", "right": "220px", "waterTextColor": "rgba(16, 85, 154, 1)"}}]}]}], "weightDistributions": null, "name": " 110424 Casino Echo: FXS | Desktop & Tablet", "bucketingStrategy": null, "experimentMetadata": {"allocationPolicy": "manual", "layerId": "21920421817"}}, {"audienceIds": ["and", "5283750624", "14246380333", "10261134200", "6146101774909440"], "audienceName": "Mobile Phones Only,Non-Booked Guest - AND - Not CH session,All | Exclude Synthetic Script \"KTNX\",Casino| Nov FXS '24| HP", "changes": null, "id": "5508036400250880", "integrationSettings": null, "variations": [{"id": "5046380113166336", "name": "Variation #1", "actions": [{"viewId": "9414621687", "changes": [{"dependencies": [], "type": "custom_code", "id": "5B375790-54D1-4A2C-BE16-28833C9876C5", "value": function($){var $ = window.jQuery;
var utils = window.optimizely.get('utils');
var dcp = window.optimizely.get("dcp");
dcp.waitForAttributeValue({
  datasourceId: 5282846651187200,
  attributeName: "vifp_num"
}).then(function(vifp) {
  if(vifp)
  {
    utils.waitForElement('.hero-header-mobile').then(function(){
      var tempLink = $('.hero-header-mobile').attr('onclick');
      tempLink = tempLink.substring(tempLink.indexOf('\';'),0) + '&vifp='+vifp+'\'';
      $('.hero-header-mobile').attr('onclick', tempLink);
    });

    utils.waitForElement('.hero-header-mobile-landscape').then(function(){
      var tempLink = $('.hero-header-mobile-landscape').attr('onclick');
      tempLink = tempLink.substring(tempLink.indexOf('\';'),0) + '&vifp='+vifp+'\'';
      $('.hero-header-mobile-landscape').attr('onclick', tempLink);
    });

    utils.waitForElement('.hero-mobile-button').then(function(){
      var tempLink = $('.hero-mobile-button').attr('onclick');
      tempLink = tempLink.substring(tempLink.indexOf('\';'),0) + '&vifp='+vifp+'\'';
      $('.hero-mobile-button').attr('onclick', tempLink);
    });
    utils.waitForElement('.cardSeeMore').then(function(){
      var tempLink = $('.cardSeeMore').attr('href');
      tempLink = tempLink.substring() + '?icid=crm_ccl_fxs_110424_mbl_carousel_c1_casino_1&cruisedeals=FXS&vifp='+vifp+'\'';
      $('.cardSeeMore').attr('href', tempLink);
    });    
  }
});



dcp.waitForAttributeValue({
    datasourceId: 5282846651187200,
    attributeName: "first_name"
  }).then(function(name) {
    if(name)
    {utils.waitForElement('.sub-head').then(function(elem) {$(".sub-head").html(name+",<br> THIS CASINO OFFER IS EXCLUSIVELY FOR YOU!");  });
    }
    });
}}, {"value": "<style>.hero-header-mobile{\n      background-position: top!important;\n    background-size: cover!important;\n    border-bottom-left-radius: 24px;\n      border-bottom-right-radius: 24px;\n}\n.itinImage-2,.itinCard-2,.dealsSeeMore{\n  border-radius:24px!important;\n}\n.tile-cta{\nfont-family: \"TempoStd\", \"Tempo\", \"Tempo-Local\", Arial Narrow, Arial, sans-serif!important;\n      font-size: 16px !important;\n    padding: 10px 16px !important;\n    margin-top: 12px;\n    color: white;\n    background: #dc1125 !important;\n    background: #dc1125 !important;\n    clear: both;\n    color: #fff;\n    border: none;\n    display: inline-block;\n    margin: 10px 0 0 0;\n    line-height: 1;\n    text-transform: uppercase;\n    transition: all 0.23s ease-in-out;\n    cursor: pointer;\n    font-weight: normal;\n    border-radius: 4px !important;\n    font-size: 16px !important;\n    padding: 10px 16px !important;\n    margin-top: 17px;\n\n}\n.dealImage-2{\n  margin:0px!important;\n  border-top-left-radius: 24px!important;\n  border-top-right-radius: 24px!important;\n   border-bottom-left-radius: 0px!important;\n  border-bottom-right-radius: 0px!important;\n}\n\n  .sub-head {\n      margin-top: -1%!Important;\n    margin-bottom: 3%!important;\n  }\n.itinImage{\n    background-size: cover!important;}\n#adTile0{\ndisplay:none}\n#adTile1{\ndisplay:none}\n#adTile2{\ndisplay:none}\n#adTile3{\ndisplay:none}\n.hero-mobile-content-wrapper {\nmargin-top: 97%;\n  display: flex;\n  flex-direction: column;\n  justify-content: space-between;\n}\n\n.backToFunContainer{\n    display: flex;\n    flex-direction: column;\n    justify-content: center;\n    align-items: center;\n    font-size: 3.6em;\n    font-family: 'Tempo', sans-serif;\n}\n.attrContainer {\n  display: flex;\n  flex-direction: column;\n  text-align: center;\n  align-items: center;\n}\n\n.leadingText-attr {\nfont-size:.3em;\n  font-family: 'Open Sans';\n  font-weight: 600;\n  line-height: 1;\n}\n\n.salePrice-attr {\n  display: flex;\n  flex-direction: row;\n  justify-content: center;\n  margin-bottom: -0.25em;\n  margin-top: -0.25em;\n}\n\n.prePrice-attr {\n  font-size: 0.5em;\n  padding-top: 0.3em;\n}\n\n.midPrice-attr {\n  font-size: 0.5em;\n  display: flex;\n  align-items: center;\n  margin: 0 0.2em 0.2em 0.2em;\n}\n\n\n.attrPlus2 {\n  display: flex;\n  align-items: center;\n  align-self: flex-start;\n  padding-top: 20px;\n}\n\n.attrPlus2::after {\n  content: '+';\n  font-size: 0.6em;\n  margin-left: 0.1em;\n  margin-right: 0.1em;\n  padding-bottom: 0;\n  padding-top: 0;\n}\n\n\n.attrContainer {\n  display: flex;\n  flex-direction: column;\n  text-align: center;\n  align-items: center;\n}\n\n\n\n.plusone {\n  display: flex;\n  align-items: center;\n  align-self: flex-start;\n  padding-top: 20px;\n}\n\n.plusone::after {\n  content: '+';\n  font-size: 0.6em;\n  margin-left: 0em;\n  margin-right: 0.6em;\n  padding-bottom: 0;\n  padding-top: 0;\n}\n\n\n.attrPlus {\n  display: flex;\n  align-items: center;\n  align-self: flex-start;\n  padding-top: 13px;\n  margin-left:-8px;\n}\n\n.attrPlus::after {\n  content: '+';\n  font-size: 0.6em;\n  margin-left: 0.6em;\n  margin-right: 0.4em;\n  padding-bottom: 0;\n  padding-top: 0;\n}\n\n\n.leadingTextRight{\n  text-align: right;\n      font-weight: 600;\n  padding-right: 5px;\n  font-size:.35em;\n  font-family:'Open Sans', sans-serif;\n}\n\n.leadingTextLeft{\n  text-align: left;\n  padding-left: 5px;\n      font-weight: 600;\n   font-size:.35em;\n    font-family:'Open Sans';\n}\n\n/*UPLIFT*/\n.upliftLogo{\n  width: 70%;\n  border-bottom: solid 1px;\n  margin-bottom: 10px;\n}\n \n.upLiftAttributes {\n  color: white;\n  font-size: 2.4rem !important;\n  text-shadow: none;\n  font-family: 'Tempo' !important;\n}\n \n.btile-2 .btile-2-clickThrough div{background:#2462bc; color: white;}\n#adTile2 > div { height:365px;}\n/*END UPLIFT*/\n\n\n\n@media screen and (orientation: portrait){\n.hero-header-mobile {\n    height:708px!important;\n    box-sizing: border-box;\n    display: flex;\n    flex-direction: column;\n  }}\n  \n/*Iphone 12 */\n@media only screen and (max-device-width: 375px){\n.hero-mobile-content-wrapper {\n    margin-top: 87%!Important;\n}\n.hero-header-mobile {\n    height: 655px!important;\n\n  }\n}\n@media only screen and (min-device-width: 395px){\n.hero-mobile-content-wrapper {\n    margin-top: 86%!Important;\n}\n  .backToFunContainer{ \n    margin-top: 4%;}\n\n}\n@media only screen and (min-width: 389px) and (max-width: 395px){\n  \n/*#optimizely-extension-9D1852F6-B123-405F-8820-868C6FD0C62D > div.hero-mobile-content-wrapper > div > div:nth-child(1){\n      margin-top: -3%!important;}*/\n  .price-attributes{\n      margin-bottom: .5%;}\n.hero-mobile-content-wrapper {\n    margin-top: 86%!Important;\n}}\n@media only screen and (min-device-width: 411px) and (max-device-width: 896px){\n  .price-attributes{\n        font-size: 35px!important;\n  }\n  \n\n  .hero-mobile-content-wrapper {\nmargin-top:79%!Important;\n  display: flex;\n  flex-direction: column;\n  justify-content: space-between;\n}\n}\n@media only screen \n    and (width: 414px) \n    and (-webkit-device-pixel-ratio: 2) {\n}\n\n@media screen and (orientation: landscape){\n  #optimizely-extension-A8AF83E9-8EA3-4A9A-AA6E-DFF8DEF141B4 > div > div:nth-child(6){\n  display:none}\n.hero-mobile-content-wrapper {\n    width: 45%;\n    height: 100%;\n    display: flex;\n    flex-direction: column;\n    margin-left: 88vh!important;\n    margin-top: 11%!important;\n    align-items: center;\n    justify-content: center;\n}\n  #optimizely-extension-A8AF83E9-8EA3-4A9A-AA6E-DFF8DEF141B4l > div > div:nth-child(6){display:none;}\n #optimizely-extension-19169C0B-DD23-423B-A1BD-EFAFE12B04A7l > div.hero-mobile-content-wrapper > button {\n   margin-top:10px!important;}\n}\n.upliftEligibility {\n    padding-top: 16px;\n    font-size: 12px;\n    font-family: 'Open Sans',Helvetica;\n    color: #fff;\n}\n\n.eligibilityMicroCopy {\n    font-size: 14px;\n    font-family: \"Open Sans\", helvetica;\n    color: #fff;\n    text-transform: none !important;\n    display: flex;\n    justify-content: center;\n    line-height: 18px;\n    text-shadow: none !important;\n}</style>", "selector": "head", "dependencies": [], "type": "append", "id": "5769CBDA-0FDD-4AC1-B77F-CD810F8A116D"}, {"name": "Utility Classes", "config": {}, "id": "5990AAAF-326F-4405-9239-6C3F2A44F08E", "dependencies": [], "type": "widget", "widget_id": "20108015752"}, {"name": "Dynamic CTA Button", "config": {"additionalProps": "display:none", "posSelector": ".heroContainer", "link": "", "ctaHoverClass": "ctaHover", "insertPos": "beforeend", "txt": "Hurry! Ends<span id=\"urgencyMsg\"> soon</span>"}, "id": "4A524F1B-AF11-43E7-8B64-CD7CB4000061", "dependencies": [], "type": "widget", "widget_id": "15955670599"}, {"id": "EB5C81F3-F396-464B-929C-3D2418812869", "type": "widget", "dependencies": [], "name": "Carousel | Deals w/Cover Image ADA", "widget_id": "30388620086", "config": {"carNumber": "1", "insertAfterDesktop": ".carousels", "insertAfterMobile": ".carouselsMobile", "headline": "", "numResults": "4", "carCoverImg": "/~/media/Images/hp-merch/2024/extras/carousel/casino-win.jpg", "htmlOverlayCopy": "<span class=\"hp-font-tempo hp-text-white\" style=\" font-size: 2.5em;\n    text-align: center;\n    display: flex;\n    flex-direction: column;\n    line-height: 1;\n   \"> CHECK OUT THESE <br> EXCLUSIVE DEALS<br> JUST FOR YOU</span>", "icid": "crm_ccl_fxs_110424_mbl_carousel_c1_casino_1"}}, {"id": "3DFC0725-BEEC-4F59-B848-59250B78DBA3", "type": "widget", "dependencies": [], "name": "Hero | Mobile (with onclick update)", "widget_id": "30314080267", "config": {"imgPortrait": "/~/media/Images/hp-merch/2024/mobile/echo-high-five-prt.jpg", "imgLandscape": "/~/media/Images/hp-merch/2024/mobile/echo-high-five-lnds.jpg", "ctaURL": "/cruise-search?icid=crm_ccl_fxs_110424_mbl_hero_h1_casino_1&cruisedeals=FXS", "contentAlignment": "align-self:center", "contentExtraStyles": "", "priceAttributes": "<div class=\"backToFunContainer\" style=\"\">\n\n \n  <div class=\"hp-font-tempo hp-text-white\"style=\"    display: flex;\n    align-items: center;\n    font-size:.7em;\n    flex-direction: column;\n   \"><span style=\"    text-align: center;\n\">IT'S ALL ABOUT YOU!</span>\n</div>\n \n  <span class=\"sub-head hp-text-white hp-font-open-sans hp-my-3 \" style=\"font-size: 0.24em;line-height: 1.1;text-align: center;\">HEY, <br> THIS CASINO OFFER IS EXCLUSIVELY FOR YOU!</span>\n       <span class=\"sr-only\">get a free suite $2,500 Funplay Credit and Drinks on us with this echo offer</span>\n  <div class=\"price-attributes hp-text-shadow-none hp-text-white hp-items-start \" style=\"font-size: 32px;display:flex;\" aria-hidden=\"true\">\n      <!-- ATTRIBUTE -->\n    \n     <div class=\"attrContainer hp-flex-col attr-1\"><span class=\"leadingText-attr\" style=\"font-size:.25em; font-weight: 600;margin-left:-3px\">GET A</span><span class=\"salePrice-attr\" style=\"font-size:43px;\">FREE<span style=\"font-size:.3em;margin-top: 12px;margin-left: 2px;\">*</span></span><span class=\"leadingText-attr\" style=\"font-size:.25em;font-weight: 600;margin-left: -6px;\">SUITE</span><span class=\"leadingText-attr hp-font-semibold\" style=\"font-size: 0.135em;font-weight: 700;padding-top: 1px;width: 76px;margin-left: -7px;\">Free offer applies to cruise<br> fare only. Guest is responsible<br> for taxes, fees, and deposit.</span>\n      </div>\n   <!--PLUS-->\n        <div class=\"attrPlus plus1\" style=\"position: relative;\"></div>\n        <!--PLUS-->   \n     <!-- ATTRIBUTE -->\n     <div class=\"attrContainer hp-flex-col attr-2\">\n       <span class=\"leadingText-attr\" style=\"font-size:.25em; font-weight: 600;\">&nbsp;</span><span class=\"salePrice-attr\" style=\"font-size:43px;\"><span style=\"font-size:.4em;margin-top:15px;text-align:left;line-height:1;\">$</span>2<span style=\"font-family: Open sans;margin-left: -2px;margin-right: -2px;margin-top: -1px;\">,</span>500</span><span class=\"leadingText-attr\" style=\"font-size:.25em;font-weight: 600;margin-left: 10px;\">FUNPLAY<sup style=\"font-size:.5em; top:-4px;\">\u00ae</sup> CREDIT</span>\n      </div>\n      <!--PLUS-->\n        <div class=\"attrPlus plus2\" style=\"position: relative;margin-left: -5px;\"></div>\n        <!--PLUS-->\n      <!-- ATTRIBUTE -->\n       <div class=\"attrContainer hp-flex-col attr-3\"><span class=\"leadingText-attr\" style=\"text-align:right;font-size:.25em; font-weight: 650;\">&nbsp;</span><span class=\"salePrice-attr\" style=\"font-size:43px;\">DRINKS<span style=\"font-size:.4em;margin-top:15px;text-align:left;margin-left:3%;line-height:1;\">ON<br>US!</span><span style=\"font-family Open sans;font-size: .14em;margin-top: 30px;\">\u2020</span></span><span class=\"leadingText-attr\" style=\"font-size:.25em;font-weight: 600;width: 146px;\">EVERYWHERE ON BOARD FOR<br>YOU AND 1 TRAVEL COMPANION</span>\n      </div>\n    \n     </div>\n <span class=\"plus-copy hp-text-white hp-my-2\" style=\"font-size: 24px;\">\u2013 PLUS MORE EXCLUSIVE PERKS \u2013</span> \n        <!-- ATTRIBUTE -->\n <a aria-label=\"Shop this deal.Carnival PLayers Club ECHO, Executive Casino Host on Call. All For you. Get a free suite, 2500 funplay  credit and drinks on us\" class=\"tile-cta ctaHover hp-text-shadow-none\" style=\"font-size: 170%;margin-top: 12px; color:white;\" tabindex=\"0\" href=\"/cruise-search?icid=crm_ccl_fxs_110424_mbl_hero_h1_casino_1&cruisedeals=FXS\">SHOP THIS DEAL</a> \n</div>", "landscapeMargins": "margin-top: 0vh;\n\nmargin-bottom: 0vh;\n\nmargin-left: 0vh;\n\nmargin-right:0vh;", "imageAlt": ""}}]}]}], "weightDistributions": null, "name": " 110424 Echo: FXS |Mobile", "bucketingStrategy": null, "experimentMetadata": {"allocationPolicy": "manual", "layerId": "21920421817"}}, {"audienceIds": ["and", "4783120075", "14246380333", "10261134200", "4651256124276736"], "audienceName": "Desktop & Tablet ,Non-Booked Guest - AND - Not CH session,All | Exclude Synthetic Script \"KTNX\",Casino| Nov HSB '24| HP", "changes": null, "id": "6061838291435520", "integrationSettings": null, "variations": [{"id": "5654630747602944", "name": "Variation #1", "actions": [{"viewId": "9414621687", "changes": [{"dependencies": [], "type": "custom_code", "id": "23E573ED-49B0-4820-A1A8-41E4B856E31B", "value": function($){var $ = window.jQuery;
var utils = window.optimizely.get('utils');
var dcp = window.optimizely.get("dcp");


dcp.waitForAttributeValue({
    datasourceId: 5282846651187200,
    attributeName: "vifp_num"
  }).then(function(vifp) {
   if (vifp)
    {$('.countdown-container').hide();
      $('.sec-banner').hide();
			$('.upliftBanner').show();
      $('.grid>.upliftBanner').hide();
      var tempLink1 ='&vifp='+vifp;
     

            utils.waitForElement('.hero-header').then(function(){
      var tempLink = $('.hero-header').attr('href');
  tempLink = tempLink.substring(tempLink.indexOf('\';'),0) + '&vifp='+vifp+'\'';
              $('.hero-header').attr('href', tempLink);
    }); 
        utils.waitForElement('.cardSeeMore').then(function(){
      var tempLink = $('.cardSeeMore').attr('href');
      tempLink = tempLink.substring() + '/cruise-deals?icid=crm_ccl_hsb_110424_hm_carousel_c1_casino_1&cruisedeals=hsb&vifp='+vifp+'\'';
      $('.cardSeeMore').attr('href', tempLink);
    }); 
    }
});
dcp.waitForAttributeValue({
    datasourceId: 5282846651187200,
    attributeName: "first_name"
  }).then(function(name) {
    if(name)
    {utils.waitForElement('.sub-head').then(function(elem) {$(".sub-head").html(name+",<br>THIS CASINO OFFER IS EXCLUSIVELY FOR YOU!");  });
    }
    });
}}, {"value": "<style>.hero-header{\n    border-bottom-left-radius: 24px;\n      border-bottom-right-radius: 24px;\n}\n.itinImage-2,.itinCard-2,.dealsSeeMore{\n  border-radius:24px!important;\n}\n.dealImage-2{\n  margin:0px!important;\n  border-top-left-radius: 24px!important;\n  border-top-right-radius: 24px!important;\n   border-bottom-left-radius: 0px!important;\n  border-bottom-right-radius: 0px!important;\n}\n\n.hero-header > .heroContainer{\n    display: inline-flex;\n    flex-direction: row;\n    align-items: center;\n    max-width: none!important;\n    box-sizing: border-box;\n    width: 100%;\n\t\tmargin:0px!important;\n}\n  \n.open-html-hero{\n  position: relative;\n}\n#toutsContainer2013 {\n    display: none !important;\n}\n.hero-banner-left {\n  padding: 0 9% 0 0;\n}\n\n\n.faq-bar, #toutsContainer2013, .fifty-term{\n  display:none;\n}\n.coverImage{\n\tbackground-size:cover!important;\n  color: #10559a;  \n  font-family: 'tempo';\n}\n\n.coverHeading{\n  line-height: 1;\n  font-size: 3rem;\n  color: #FFF;\n  text-align: center;\n  margin-top:5px;\n}\n\n.coverCopy{\n  font-family: 'Open Sans', sans-serif;\n  color: #FFF;\n  font-size: 1.5rem;\n  text-align: center;\n  font-weight: 600;\n  line-height: 1;\n  margin-top: 10px !important;\n}\n\n/*Uplift*/\n.sec-banner {\n    margin: auto;\n    max-width: 1400px;\n}\n\n@media only screen  and (min-width: 1301px) and (max-width: 1350px) {\n  .heroAttributes-1{\n        margin-left: 46%!important;}\n\n}\n\n@media only screen and (min-width: 1200px) and (max-width: 1300px) {\n  .heroAttributes-1{\n  \n        margin-left: 49%!important;}\n  #optimizely-extension-9220AA96-571A-4A0C-A33B-79828E4DD63A{\n background-position: top 0 left -55px;}\n}</style>", "selector": "head", "dependencies": [], "type": "append", "id": "4E153C9E-8CD8-443E-8DE1-0C9580FBC687"}, {"name": "Utility Classes", "config": {}, "id": "812CCEBC-46A9-4741-85A7-E3F8B07563FE", "dependencies": [], "type": "widget", "widget_id": "20108015752"}, {"name": "Dynamic CTA Button", "config": {"additionalProps": "display:none", "posSelector": ".heroContainer", "link": "", "ctaHoverClass": "ctaHover", "insertPos": "beforeend", "txt": "Hurry! Ends<span id=\"urgencyMsg\"> soon</span>"}, "id": "D408FBD9-EAB9-4DB6-A879-108912EBF17C", "dependencies": [], "type": "widget", "widget_id": "15955670599"}, {"id": "2A9250C5-240C-4654-B1EC-F8C7F3ADB08F", "type": "widget", "dependencies": [], "name": "Carousel | Deals w/Cover Image ADA", "widget_id": "30388620086", "config": {"carNumber": "1", "insertAfterDesktop": ".carousels", "insertAfterMobile": ".carouselsMobile", "headline": "", "numResults": "4", "carCoverImg": "/~/media/Images/hp-merch/2024/extras/carousel/casino-win.jpg", "htmlOverlayCopy": "<span class=\"hp-font-tempo hp-text-white\" style=\" font-size: 2.5em;\n    text-align: center;\n    display: flex;\n    flex-direction: column;\n    line-height: 1;\n   \"> CHECK OUT THESE <br> EXCLUSIVE DEALS<br> JUST FOR YOU</span>", "icid": "crm_ccl_hsb_110424_hm_carousel_c1_casino_1"}}, {"id": "914B1E25-4262-4D70-91D2-EAF34201B748", "type": "widget", "dependencies": [], "name": "Hero | Desktop (with onclick update)", "widget_id": "30291230470", "config": {"img": "/~/media/Images/hp-merch/2024/desktop/heros/casino-win-hs-dsk.jpg", "waterMark": "", "left": "", "lnk": "/cruise-deals?icid=crm_ccl_hsb_110424_hm_hero_h1_casino_1&cruisedeals=hsb", "bottom": "110px", "waterShadowColor": "rgba(0, 0, 0, 1)", "openhtml": "<div class=\"heroAttributes-1 hp-my-4 hp-font-tempo hp-text-white hp-flex-col\" style=\"width: 100%;align-items:center;display:flex;margin-left: 44%;margin-top: 32px!important;\">\n \n      <div class=\"attrContainer-1 hp-flex-col hp-flex\" style=\"font-size: 55px;line-height: 1;align-items: center;\">MAKE YOUR<BR>GAME PLAN!</div>\n\n<span class=\"sub-head hp-font-open-sans hp-my-4\" style=\"text-transform:uppercase;font-size: 15.5px;;\">HEY,<br>THIS CASINO OFFER IS EXCLUSIVELY FOR YOU!</span>\n\n<a\taria-label=\"Shop this deal.Carnival Players Club. Make your Game Plan\"\n\tclass=\"heroCTA ctaHover hp-text-shadow-none\" \n\tstyle=\"font-size: 170%;color:white\" tabindex=\"0\" href=\"/cruise-deals?icid=crm_ccl_hsb_110424_hm_hero_h1_casino_1&cruisedeals=hsb\">SHOP THIS DEAL</a>\n\n \n    </div>", "top": "", "backgroundColor": "rgba", "altText": "Players Club Logo", "right": "220px", "waterTextColor": "rgba(16, 85, 154, 1)"}}]}]}], "weightDistributions": null, "name": " 110424 Casino Hot Streak| Desktop & Tablet", "bucketingStrategy": null, "experimentMetadata": {"allocationPolicy": "manual", "layerId": "21920421817"}}, {"audienceIds": ["and", "5283750624", "14246380333", "10261134200", "4651256124276736"], "audienceName": "Mobile Phones Only,Non-Booked Guest - AND - Not CH session,All | Exclude Synthetic Script \"KTNX\",Casino| Nov HSB '24| HP", "changes": null, "id": "5524554240491520", "integrationSettings": null, "variations": [{"id": "6036417168539648", "name": "Variation #1", "actions": [{"viewId": "9414621687", "changes": [{"dependencies": [], "type": "custom_code", "id": "C1926D81-AA03-469A-95CC-5FBDDE89DABF", "value": function($){var $ = window.jQuery;
var utils = window.optimizely.get('utils');
var dcp = window.optimizely.get("dcp");
dcp.waitForAttributeValue({
  datasourceId: 5282846651187200,
  attributeName: "vifp_num"
}).then(function(vifp) {
  if(vifp)
  {
        utils.waitForElement('.hero-header-mobile').then(function(){
      var tempLink = $('.hero-header-mobile').attr('onclick');
      tempLink = tempLink.substring(tempLink.indexOf('\';'),0) + 'cruise-deals?icid=crm_ccl_hsb_110424_mbl_hero_h1_casino_1&cruisedeals=hsb&vifp='+vifp+'\'';
      $('.hero-header-mobile').attr('onclick', tempLink);
    });

    utils.waitForElement('.hero-header-mobile-landscape').then(function(){
      var tempLink = $('.hero-header-mobile-landscape').attr('onclick');
      tempLink = tempLink.substring(tempLink.indexOf('\';'),0) + 'cruise-deals?icid=crm_ccl_hsb_110424_mbl_hero_h1_casino_1&cruisedeals=hsb&vifp='+vifp+'\'';
      $('.hero-header-mobile-landscape').attr('onclick', tempLink);
    });

    utils.waitForElement('.hero-mobile-button').then(function(){
      var tempLink = $('.hero-mobile-button').attr('onclick');
      tempLink = tempLink.substring(tempLink.indexOf('\';'),0) + '/cruise-deals?icid=crm_ccl_hsb_110424_mbl_hero_h1_casino_1&cruisedeals=hsb'+vifp+'\'';
      $('.hero-mobile-button').attr('onclick', tempLink);
    });
    utils.waitForElement('.cardSeeMore').then(function(){
      var tempLink = $('.cardSeeMore').attr('href');
      tempLink = tempLink.substring() + '?icid=crm_ccl_hsb_110424_mbl_carousel_c1_casino_1&cruisedeals=hsb&vifp='+vifp+'\'';
      $('.cardSeeMore').attr('href', tempLink);
    });    
  }
});


dcp.waitForAttributeValue({
    datasourceId: 5282846651187200,
    attributeName: "first_name"
  }).then(function(name) {
    if(name)
    {utils.waitForElement('.sub-head').then(function(elem) {$(".sub-head").html(name+",<br>THIS CASINO OFFER IS EXCLUSIVELY FOR YOU!");  });
    }
    });
}}, {"value": "<style>.hero-header-mobile{\n    border-bottom-left-radius: 24px;\n      border-bottom-right-radius: 24px;\n}\n.tile-cta{\nfont-family: \"TempoStd\", \"Tempo\", \"Tempo-Local\", Arial Narrow, Arial, sans-serif!important;\n      font-size: 16px !important;\n    padding: 10px 16px !important;\n    color: white;\n    background: #dc1125 !important;\n    background: #dc1125 !important;\n    clear: both;\n    color: #fff;\n    border: none;\n    display: inline-block;\n    margin: 10px 0 0 0;\n    line-height: 1;\n    text-transform: uppercase;\n    transition: all 0.23s ease-in-out;\n    cursor: pointer;\n    font-weight: normal;\n    border-radius: 4px !important;\n    font-size: 16px !important;\n    padding: 10px 16px !important;\n    margin-top: 17px;\n\n}\n\n.itinImage-2,.itinCard-2,.dealsSeeMore{\n  border-radius:24px!important;\n}\n.dealImage-2{\n  margin:0px!important;\n  border-top-left-radius: 24px!important;\n  border-top-right-radius: 24px!important;\n   border-bottom-left-radius: 0px!important;\n  border-bottom-right-radius: 0px!important;\n}\n\n#adTile0,#adTile1,#adTile2,#adTile3,.fifty-term\t{\n  display:none;\n}\n.shell-10 {\n\n    margin-top: 8px;\n}\n\n.hero-mobile-button {\n    background-color: #DC1125;\n    color: white;\n    border: none;\n    border-radius: 4px;\n    padding: 10px 16px;\n    display: flex;\n    justify-content: center;\n    align-items: center;\n    font-family: \"tempo\";\n    text-transform: uppercase;\n    letter-spacing: 0.5px;\n    font-size: 1rem;\n    width: max-content;\n    margin: 0 auto;\n}\n#lcb-vifp-mbl {\n    background-color: #c9e0ff;\n    padding: 1% 3%;\n    height: 110px;\n    margin-bottom: 9%!important;\n}\n.hero-header-mobile {\n    background-position: top!important;\n    background-size: cover!important;\n}\n\n.hero-mobile-content-wrapper {\n  margin-top: 319px;\n  display: flex;\n  flex-direction: column;\n  justify-content: space-between;\n  height:auto;\n}\n\n.backToFunContainer\t{\n    display: flex;\n    flex-direction: column;\n    justify-content: center;\n    align-items: center;\n    font-size: 3.6em;\n    font-family: 'Tempo', sans-serif;\n}\n\n.carouselItin {\n    margin-top: -35px!important;\n}\n.coverImage\t{\n\tbackground-size:cover!important;\n  color: #10559a;  \n  font-family: 'tempo';\n}\n\n.check {\n    padding-top: 2px!important;\n    width: 30px!important;\n}\n\n.coverHeading\t{\n  line-height: 1;\n  font-size: 3rem;\n  /*color: #FFF;*/\n  text-align: center;\n  margin-top:5px;\n}\n\n.coverCopy\t{\n  font-family: 'Open Sans', sans-serif;\n  color: #FFF;\n  font-size: 1.5rem;\n  text-align: center;\n  font-weight: 600;\n  line-height: 1;\n  margin-top: 10px !important;\n}\n\n\n@media only screen and (min-device-width: 320px) and (max-device-width: 736px) and (-webkit-min-device-pixel-ratio: 2){\n  .coverImage {\n    font-size: 1.8rem;\n  }\n\n  .coverHeading{\n    line-height: 1;\n    font-size: 2rem;\n    color: #FFF;\n    text-align: center;\n  }\n\n  .coverCopy{\n    font-family: 'Open Sans', sans-serif;\n    color: #FFF;\n    font-size: 1rem;\n    text-align: center;\n    font-weight: 600;\n    line-height: 1;\n    margin-top: 9px;\n  }\n}\n@media only screen and (min-width: 375px) and (max-width: 980px) and (-webkit-min-device-pixel-ratio: 2.8) and (orientation: landscape), only screen and (min-width: 375px) and (max-width: 980px) and (-webkit-device-pixel-ratio: 3.5) and (orientation: landscape), only screen and (min-width: 375px) and (max-width: 980px) and (-webkit-device-pixel-ratio: 2.625) and (orientation: landscape){\n  .coverImage {\n    font-size: 1.8rem;\n  }\n  \n  .coverHeading{\n    line-height: 1;\n    font-size: 2rem;\n    color: #FFF;\n    text-align: center;\n  }\n\n  .coverCopy{\n    font-family: 'Open Sans', sans-serif;\n    color: #FFF;\n    font-size: 1rem;\n    text-align: center;\n    font-weight: 600;\n    line-height: 1;\n    margin-top: 9px;\n  }\n}\n\n\n@media screen and (orientation: portrait){\n.hero-header-mobile {\n    height: 590px!important;\n    box-sizing: border-box;\n    display: flex;\n    flex-direction: column;\n  }\n  \n}\n  \n\n@media only screen and (max-device-width: 380px){\n.head {\n}\n.sub-head {\n  font-size:.75rem!important;\n}\n  .hero-mobile-content-wrapper {\n  margin-top:85%!important}\n}\n/*Iphone 12 */\n@media only screen and (min-device-width: 390px) and (max-device-width: 410px){\n\n  \n  .hero-mobile-content-wrapper {\n  margin-top: 84%;}\n\n}\n@media only screen and (min-device-width:410px) and (max-device-width: 896px){\n  .hero-mobile-content-wrapper {\n       margin-top: 69%!Important;\n\n  }\n  \n  .backToFunContainer{\n  margin-top: 0.9em!important;\n\n  }\n  \n  .coverHeading{\n    font-size: 2rem!important;\n  }\n\n}\n  \n\n@media screen and (orientation: landscape){\n  \n\t#optimizely-extension-9D1852F6-B123-405F-8820-868C6FD0C62Dl > div.hero-mobile-content-wrapper > div > span.head.hp-text-white.hp-font-tempo.hp-text-3xl.hp-text-center {    \n  \tfont-size: .5em;\n  }\n  \n  .hero-mobile-content-wrapper {\n    width: 35%;\n    height: 100%;\n    display: flex;\n    flex-direction: column;\n    text-shadow: 2px 2px 6px rgba(26, 26, 26, 0);\n    margin-top: -22vh;\n    align-items: center;\n    justify-content: center;\n  }\n  \n  #optimizely-extension-9D1852F6-B123-405F-8820-868C6FD0C62Dl > div.hero-mobile-content-wrapper > div > span.head.hp-text-white.hp-font-tempo.hp-text-center {\n      font-size: 0.5em!important;\n  }\n  \n  #optimizely-extension-9D1852F6-B123-405F-8820-868C6FD0C62Dl > div.hero-mobile-content-wrapper > div > span.head.hp-text-white.hp-font-tempo.hp-text-center > img\t{\n      width: 155px;\n  }\n  \n.backToFunContainer {\n   display: flex;\n   flex-direction: column;\n   align-items: center;\n   justify-content: flex-start;\n   margin-top: 0em;\n}\n  .coverHeading{\n    font-size:2rem!important;\n  }\n}</style>", "selector": "head", "dependencies": [], "type": "append", "id": "963A8B14-6A08-4B53-ACE2-260DD9997C70"}, {"name": "Utility Classes", "config": {}, "id": "EEFD1054-046F-421B-8D46-96DFC0959957", "dependencies": [], "type": "widget", "widget_id": "20108015752"}, {"name": "Dynamic CTA Button", "config": {"additionalProps": "display:none", "posSelector": ".heroContainer", "link": "", "ctaHoverClass": "ctaHover", "insertPos": "beforeend", "txt": "Hurry! Ends<span id=\"urgencyMsg\"> soon</span>"}, "id": "43981DBB-B20E-4A04-BA84-96D0890C9F56", "dependencies": [], "type": "widget", "widget_id": "15955670599"}, {"id": "9EE5502A-55EF-4036-A876-C7B9EFFA7029", "type": "widget", "dependencies": [], "name": "Carousel | Deals w/Cover Image ADA", "widget_id": "30388620086", "config": {"carNumber": "1", "insertAfterDesktop": ".carousels", "insertAfterMobile": ".carouselsMobile", "headline": "", "numResults": "4", "carCoverImg": "/~/media/Images/hp-merch/2024/extras/carousel/casino-win.jpg", "htmlOverlayCopy": "<span class=\"hp-font-tempo hp-text-white\" style=\" font-size: 2.5em;\n    text-align: center;\n    display: flex;\n    flex-direction: column;\n    line-height: 1;\n   \"> CHECK OUT THESE <br> EXCLUSIVE DEALS<br> JUST FOR YOU</span>", "icid": "crm_ccl_111024_hp_carousel_c1_casino_1"}}, {"id": "21F2E5CB-B05A-48F6-BAE0-D427D0A16FB6", "type": "widget", "dependencies": [], "name": "Hero | Mobile (with onclick update)", "widget_id": "30314080267", "config": {"imgPortrait": "/~/media/Images/hp-merch/2024/mobile/casino-win-hs-prt.jpg", "imgLandscape": "/~/media/Images/hp-merch/2024/mobile/casino-win-hs-lnds.jpg", "ctaURL": "/cruise-deals?icid=crm_ccl_hsb_110424_mbl_hero_h1_casino_1&cruisedeals=hsb", "contentAlignment": "align-self:center", "contentExtraStyles": "", "priceAttributes": "<div class=\"backToFunContainer\" style=\"\">\n\n  <span class=\"head hp-text-white hp-font-tempohp-text-center\" style=\"\n    /* margin-bottom: 2%; */\n    line-height: 1;\n    display: flex;\n    font-size: 47px;\n    flex-direction: column;\n    align-items: center;\n    text-align:center\n    \">MAKE YOUR<BR> GAME PLAN!</span>\n  <span class=\"sub-head hp-text-white hp-font-open-sans hp-text-sm hp-text-center hp-my-2\" style=\"\n    text-transform: uppercase;\n    font-size: 15px!Important;\n    line-height: 1.2rem;\n    \">HEY,<br>THIS CASINO OFFER IS EXCLUSIVELY FOR YOU!</span>\n   \n\n <a \naria-label=\"SHOP THIS DEAL.Carnival Players Club. MAKE YOUR GAME DAY PLAN\"\n\tclass=\"tile-cta ctaHover hp-text-shadow-none\" \n\tstyle=\"font-size: 170%;\" \n\ttabindex=\"0\" \n\thref=\"/cruise-deals?icid=crm_ccl_hsb_110424_mbl_hero_h1_casino_1&cruisedeals=hsb\" >SHOP THIS DEAL\n   </a>\n</div>", "landscapeMargins": "margin-top: 0vh;\n\nmargin-bottom: 0vh;\n\nmargin-left: 0vh;\n\nmargin-right:0vh;", "imageAlt": "Players Club Logo"}}]}]}], "weightDistributions": null, "name": " 110424 Casino Hot Streak | Mobile", "bucketingStrategy": null, "experimentMetadata": {"allocationPolicy": "manual", "layerId": "21920421817"}}, {"audienceIds": ["and", "4783120075", "14246380333", "10261134200", "4645538197405696"], "audienceName": "Desktop & Tablet ,Non-Booked Guest - AND - Not CH session,All | Exclude Synthetic Script \"KTNX\",Casino| Nov PMW '24| HP", "changes": null, "id": "6391817944432640", "integrationSettings": null, "variations": [{"id": "5162091145854976", "name": "Variation #1", "actions": [{"viewId": "9414621687", "changes": [{"dependencies": [], "type": "custom_code", "id": "C8BF728D-29CA-4008-8EA2-D9405A788439", "value": function($){var $ = window.jQuery;
var utils = window.optimizely.get('utils');
var dcp = window.optimizely.get("dcp");

dcp.waitForAttributeValue({
    datasourceId: 5282846651187200,
    attributeName: "vifp_num"
  }).then(function(vifp) {
      if (vifp)
    {$('.countdown-container').hide();
      $('.sec-banner').hide();
			$('.upliftBanner').show();
      $('.grid>.upliftBanner').hide();
      var tempLink1 ='&vifp='+vifp;
     

            utils.waitForElement('.hero-header').then(function(){
      var tempLink = $('.hero-header').attr('href');
  tempLink = tempLink.substring(tempLink.indexOf('\';'),0) + '&vifp='+vifp+'\'';
              $('.hero-header').attr('href', tempLink);
    }); 
//window.hpHeroUrl = '/cruise-search?icid=crm_ccl_fxs_091024_hm_h1_casino&cruisedeals=FXS'+tempLink1;
        utils.waitForElement('.cardSeeMore').then(function(){
      var tempLink = $('.cardSeeMore').attr('href');
      tempLink = tempLink.substring() + '?icid=crm_ccl_fxs_110424_hm_carousel_c1_casino_1&cruisedeals=FXS'+tempLink1;
      $('.cardSeeMore').attr('href', tempLink);
    }); 
    }
});
  /*  if (vifp)
    {$('.countdown-container').hide();
      $('.sec-banner').hide();
			$('.upliftBanner').show();
      $('.grid>.upliftBanner').hide();
     
      var tempLink1 ='&vifp='+vifp;

         utils.waitForElement('.hero-header').then(function(){
      var tempLink = $('.hero-header').attr('onclick');
      tempLink = tempLink.substring(tempLink.indexOf('\';'),0) + '/cruise-deals?icid=crm_ccl_pmw_091024_hm_hero_h1_casino_1&cruisedeals=pmw&vifp='+vifp+'\'';
      $('.hero-header').attr('onclick', tempLink);
    });
        utils.waitForElement('.cardSeeMore').then(function(){
      var tempLink = $('.cardSeeMore').attr('href');
      tempLink = tempLink.substring() + '?icid=crm_ccl_pmw_091024_hm_carousel_c1_casino_1&cruisedeals=pmw&vifp='+vifp+'\'';
      $('.cardSeeMore').attr('href', tempLink);
    }); 
    }
}); */

dcp.waitForAttributeValue({
    datasourceId: 5282846651187200,
    attributeName: "first_name"
  }).then(function(name) {
    if(name)
    {utils.waitForElement('.sub-head').then(function(elem) {$(".sub-head").html(name+",<br>THIS CASINO OFFER IS EXCLUSIVELY FOR YOU!");  });
    }
    });  

$(document).ready(function() {
	$('.itinImage-2').css('background-image', 'url(/~/media/Images/hp-merch/2024/extras/carousel/casino-win.jpg)');
});
}}, {"value": "<style>.hero-header{\n    border-bottom-left-radius: 24px;\n      border-bottom-right-radius: 24px;\n}\n.itinImage-2,.itinCard-2,.dealsSeeMore{\n  border-radius:24px!important;\n}\n.dealImage-2{\n  margin:0px!important;\n  border-top-left-radius: 24px!important;\n  border-top-right-radius: 24px!important;\n   border-bottom-left-radius: 0px!important;\n  border-bottom-right-radius: 0px!important;\n}\n\n.hero-header > .heroContainer {\n  display: inline-flex;\n  flex-direction: row;\n  align-items: center;\n  max-width: none!important;\n  box-sizing: border-box;\n  width: 100%;\n\tmargin:0px!important;\n}\n\n.open-html-hero {\n  position: relative;\n}\n\n.hero-banner-left {\n  padding: 0 9% 0 0;\n}\n\n\n.faq-bar, #toutsContainer2013, .fifty-term {\n  display:none;\n}\n#toutsContainer2013 {\n    display: none !important;\n}\n.coverImage {\n\tbackground-size:cover!important;\n  color: #10559a;  \n  font-family: 'tempo';\n}\n\n#optimizely-extension-9220AA96-571A-4A0C-A33B-79828E4DD63A {\n  background-position: bottom right;\n}\n\n.coverHeading {\n  line-height: 1;\n  font-size: 3rem;\n  color: #FFF;\n  text-align: center;\n  margin-top:5px;\n}\n\n.coverCopy {\n  font-family: 'Open Sans', sans-serif;\n  color: #FFF;\n  font-size: 1.5rem;\n  text-align: center;\n  font-weight: 600;\n  line-height: 1;\n  margin-top: 10px !important;\n}\n\n@media only screen  and (max-width: 1350px) {\n\n  .heroAttributes-1 {\n    margin-left:46%!important;\n  }\n  #optimizely-extension-9220AA96-571A-4A0C-A33B-79828E4DD63A {\n    background-position: top 0 left -71px;\n  }\n}\n\n@media only screen  and (max-width: 1285px) {\n\n  .heroAttributes-1 {\n    margin-left:47%!important;\n  }\n  #optimizely-extension-9220AA96-571A-4A0C-A33B-79828E4DD63A {\n    background-position: top 0 left -31px;\n  }\n}\n\n@media only screen  and (max-width: 1250px) {\n\n  .heroAttributes-1 {\n    margin-left:48%!important;\n  }\n  #optimizely-extension-9220AA96-571A-4A0C-A33B-79828E4DD63A {\n    background-position: top 0 left -96px;\n  }\n}\n\n@media only screen  and (max-width: 1150px) {\n\n  .heroAttributes-1 {\n    margin-left:50%!important;\n  }\n  #optimizely-extension-9220AA96-571A-4A0C-A33B-79828E4DD63A {\n    background-position: top 0 left -176px;\n  }\n}</style>", "selector": "head", "dependencies": [], "type": "append", "id": "80E838B4-01D2-4795-ACD5-D6D9DB0786EA"}, {"name": "Utility Classes", "config": {}, "id": "657E7E53-2371-4ACF-8E2C-91FCF8AF9E95", "dependencies": [], "type": "widget", "widget_id": "20108015752"}, {"id": "F9AA36BD-01AF-44BE-8D93-BDB1570A0D66", "type": "widget", "dependencies": [], "name": "Carousel | Deals w/Cover Image ADA", "widget_id": "30388620086", "config": {"carNumber": "1", "insertAfterDesktop": ".carousels", "insertAfterMobile": ".carouselsMobile", "headline": "", "numResults": "4", "carCoverImg": "/~/media/Images/hp-merch/2024/extras/carousel/casino-win.jpg", "htmlOverlayCopy": "<span class=\"hp-font-tempo hp-text-white\" style=\" font-size: 2.5em;\n    text-align: center;\n    display: flex;\n    flex-direction: column;\n    line-height: 1;\n   \"> CHECK OUT THESE <br> EXCLUSIVE DEALS<br> JUST FOR YOU</span>", "icid": "crm_ccl_091024_hp_carousel_c1_casino_1"}}, {"id": "984215EF-C8B4-4401-A795-69829707795D", "type": "widget", "dependencies": [], "name": "Hero | Desktop (with onclick update)", "widget_id": "30291230470", "config": {"img": "/~/media/Images/hp-merch/2024/desktop/heros/casino-win-pmw.jpg", "waterMark": "", "left": "", "lnk": "/cruise-deals?icid=crm_ccl_pmw_110424_hm_hero_h1_casino_1&cruisedeals=pmw", "bottom": "110px", "waterShadowColor": "rgba(0, 0, 0, 1)", "openhtml": "<div class=\"heroAttributes-1 hp-my-4 hp-font-tempo hp-text-white hp-flex-col\" style=\"width: 100%;align-items:center;display:flex;margin-left: 44%;margin-top: 32px!important;\">\n \n      <div class=\"attrContainer-1 hp-flex-col hp-flex\" style=\"font-size: 55px;line-height: 1;align-items: center;\">MAKE YOUR<br> GAME PLAN!</div>\n\n<span class=\"sub-head hp-font-open-sans hp-my-4\" style=\"text-transform:uppercase;font-size: 15.5px;;\">HEY,<br>THIS CASINO OFFER IS EXCLUSIVELY FOR YOU!</span>\n\n<a aria-label=\"SHOP THIS DEAL. Play my Way. MAKE YOUR GAME DAY PLAN\"\n\tclass=\"heroCTA ctaHover hp-text-shadow-none\" \n\tstyle=\"font-size: 170%;color:white\" tabindex=\"0\" href=\"/cruise-deals?icid=crm_ccl_pmw_110424_hm_hero_h1_casino_1&cruisedeals=pmw\">SHOP THIS DEAL</a>\n\n\n\n    \n \n    </div>\n    \n \n     \n", "top": "", "backgroundColor": "rgba", "altText": "Play My Way Logo", "right": "220px", "waterTextColor": "rgba(16, 85, 154, 1)"}}, {"id": "769C43E0-0AE4-48BF-9302-58A895B2506F", "type": "widget", "dependencies": [], "name": "Dynamic CTA Button", "widget_id": "15955670599", "config": {"txt": "Hurry! Ends<span id=\"urgencyMsg\"> soon</span>", "ctaHoverClass": "ctaHover", "link": "", "additionalProps": "display: none;", "posSelector": ".heroContainer", "insertPos": "beforeend"}}]}]}], "weightDistributions": null, "name": " 110424 PMW | Desktop & Tablet", "bucketingStrategy": null, "experimentMetadata": {"allocationPolicy": "manual", "layerId": "21920421817"}}, {"audienceIds": ["and", "5283750624", "14246380333", "10261134200", "4645538197405696"], "audienceName": "Mobile Phones Only,Non-Booked Guest - AND - Not CH session,All | Exclude Synthetic Script \"KTNX\",Casino| Nov PMW '24| HP", "changes": null, "id": "6633577761210368", "integrationSettings": null, "variations": [{"id": "6395055997452288", "name": "Variation #1", "actions": [{"viewId": "9414621687", "changes": [{"dependencies": [], "type": "custom_code", "id": "06C63A78-CC26-4182-BCD1-2C18FA788238", "value": function($){var $ = window.jQuery;
var utils = window.optimizely.get('utils');
var dcp = window.optimizely.get("dcp");


dcp.waitForAttributeValue({
  datasourceId:  5282846651187200,
  attributeName: "vifp_num"
}).then(function(vifp) {
  if(vifp)
  {
      
    utils.waitForElement('.hero-header-mobile').then(function(){
      var tempLink = $('.hero-header-mobile').attr('onclick');
      tempLink = tempLink.substring(tempLink.indexOf('\';'),0) + '/cruise-deals?icid=crm_ccl_pmw_110424_mbl_hero_h1_casino_1&cruisedeals=pmw&vifp='+vifp+'\'';
      $('.hero-header-mobile').attr('onclick', tempLink);
    });

    utils.waitForElement('.hero-header-mobile-landscape').then(function(){
      var tempLink = $('.hero-header-mobile-landscape').attr('onclick');
      tempLink = tempLink.substring(tempLink.indexOf('\';'),0) + '&vifp='+vifp+'\'';
      $('.hero-header-mobile-landscape').attr('onclick', tempLink);
    });

    utils.waitForElement('.hero-mobile-button').then(function(){
      var tempLink = $('.hero-mobile-button').attr('onclick');
      tempLink = tempLink.substring(tempLink.indexOf('\';'),0) + '/cruise-deals?icid=crm_ccl_pmw_110424_mbl_hero_h1_casino_1&cruisedeals=pmw&vifp='+vifp+'\'';
      $('.hero-mobile-button').attr('onclick', tempLink);
    });
    utils.waitForElement('.cardSeeMore').then(function(){
      var tempLink = $('.cardSeeMore').attr('href');
      tempLink = tempLink.substring() + '?icid=crm_ccl_pmw_110424_mbl_carousel_c1_casino_1&cruisedeals=pmw&vifp='+vifp+'\'';
      $('.cardSeeMore').attr('href', tempLink);
    });    
  }
});


dcp.waitForAttributeValue({
    datasourceId: 5282846651187200,
    attributeName: "first_name"
  }).then(function(name) {
    if(name)
    {utils.waitForElement('.sub-head').then(function(elem) {$(".sub-head").html(name+",<br>THIS CASINO OFFER IS EXCLUSIVELY FOR YOU!");  });
    }
    });
}}, {"value": "<style>#adTile0,#adTile1,#adTile2,#adTile3{\n  display:none;\n}\n.tile-cta{\nfont-family: \"TempoStd\", \"Tempo\", \"Tempo-Local\", Arial Narrow, Arial, sans-serif!important;\n      font-size: 16px !important;\n    padding: 10px 16px !important;\n    margin-top: 12px;\n    color: white;\n    background: #dc1125 !important;\n    background: #dc1125 !important;\n    clear: both;\n    color: #fff;\n    border: none;\n    display: inline-block;\n    margin: 10px 0 0 0;\n    line-height: 1;\n    text-transform: uppercase;\n    transition: all 0.23s ease-in-out;\n    cursor: pointer;\n    font-weight: normal;\n    border-radius: 4px !important;\n    font-size: 16px !important;\n    padding: 10px 16px !important;\n    margin-top: 17px;\n\n}\n\n.hero-header-mobile{\n    border-bottom-left-radius: 24px;\n      border-bottom-right-radius: 24px;\n}\n.itinImage-2,.itinCard-2,.dealsSeeMore{\n  border-radius:24px!important;\n}\n.dealImage-2{\n  margin:0px!important;\n  border-top-left-radius: 24px!important;\n  border-top-right-radius: 24px!important;\n   border-bottom-left-radius: 0px!important;\n  border-bottom-right-radius: 0px!important;\n}\n\n.shell-10 {\n\n    margin-top: 8px;\n}\n  .carouselsMobile{\n      padding-top: 16px;\n    padding-bottom: 16px;}\n\n.upliftEligibility {\n    padding-top: 16px;\n    font-size: 12px;\n    font-family: 'Open Sans',Helvetica;\n    color: #fff;\n}\n.eligibilityMicroCopy {\n    font-size: 14px;\n    font-family: \"Open Sans\", helvetica;\n    color: #fff;\n    text-transform: none !important;\n    display: flex;\n    justify-content: center;\n    line-height: 18px;\n    text-shadow: none !important;\n}\n.hero-header-mobile {\n      background-position: top!important;\n    background-size: cover!important;\n}\n\n.hero-mobile-content-wrapper {\n  margin-top: 25px;\n  display: flex;\n  flex-direction: column;\n  justify-content: space-between;\n  height:auto;\n      margin-top: 79%;\n}\n\n.backToFunContainer{\n    display: flex;\n    flex-direction: column;\n    justify-content: center;\n    align-items: center;\n    font-size: 3.6em;\n    font-family: 'Tempo', sans-serif;\n}\n\n.carouselItin {\n    margin-top: -35px!important;\n}\n.coverImage{\n\tbackground-size:cover!important;\n  color: #10559a;  \n  font-family: 'tempo';\n}\n\n.check {\n    padding-top: 2px!important;\n    width: 30px!important;\n}\n\n.coverHeading{\n  line-height: 1;\n  font-size: 3rem;\n  /*color: #FFF;*/\n  text-align: center;\n  margin-top:5px;\n}\n\n.coverCopy{\n  font-family: 'Open Sans', sans-serif;\n  color: #FFF;\n  font-size: 1.5rem;\n  text-align: center;\n  font-weight: 600;\n  line-height: 1;\n  margin-top: 10px !important;\n}\n/*UPLIFT*/\n#adTile-2 > div > a > div > div > div > div > span{\n    display: flex!important;\n    flex-direction: column;\n    align-items: center;\n}\n.upLiftAttributes {\n  color: white;\n  font-size: 2.4rem !important;\n  text-shadow: none;\n  font-family: 'Tempo' !important;\n}\n.btile-0 .btile-0-clickThrough div{background:#2462bc; color: white;}\n#adTile0 > div { height:365px;}\n/*END UPLIFT*/\n@media only screen and (min-device-width: 320px) and (max-device-width: 736px) and (-webkit-min-device-pixel-ratio: 2){\n \n\n  .coverHeading{\n    line-height: 1;\n    font-size: 2rem;\n    color: #FFF;\n    text-align: center;\n  }\n\n  .coverCopy{\n    font-family: 'Open Sans', sans-serif;\n    color: #FFF;\n    font-size: 1rem;\n    text-align: center;\n    font-weight: 600;\n    line-height: 1;\n    margin-top: 9px;\n  }\n}\n@media only screen and (min-width: 375px) and (max-width: 980px) and (-webkit-min-device-pixel-ratio: 2.8) and (orientation: landscape), only screen and (min-width: 375px) and (max-width: 980px) and (-webkit-device-pixel-ratio: 3.5) and (orientation: landscape), only screen and (min-width: 375px) and (max-width: 980px) and (-webkit-device-pixel-ratio: 2.625) and (orientation: landscape){\n  .coverImage {\n    font-size: 1.8rem;\n  }\n  \n  .coverHeading{\n    line-height: 1;\n    font-size: 2rem;\n    color: #FFF;\n    text-align: center;\n  }\n\n  .coverCopy{\n    font-family: 'Open Sans', sans-serif;\n    color: #FFF;\n    font-size: 1rem;\n    text-align: center;\n    font-weight: 600;\n    line-height: 1;\n    margin-top: 9px;\n  }\n}\n@media screen and (orientation: landscape){\n #optimizely-extension-9D1852F6-B123-405F-8820-868C6FD0C62Dl > div.hero-mobile-content-wrapper{\n    margin-top: 8%!Important;\n    margin-left: 53%!Important;\n  }}\n@media screen and (orientation: portrait){\n.hero-header-mobile {\n    height: 594px!important;\n    box-sizing: border-box;\n    display: flex;\n    flex-direction: column;\n  }\n}\n  \n\n@media only screen and (max-device-width: 380px){\n.head {\n}\n.sub-head {\n  font-size:.75rem!important;\n}\n  .hero-mobile-content-wrapper {\n  margin-top:86%!important}\n}\n/*Iphone 12 */\n@media only screen and (min-device-width: 390px) and (max-device-width: 410px){\n\n  \n  .hero-mobile-content-wrapper {\n  margin-top: 84%;}\n\n}\n@media only screen and (min-device-width:410px) and (max-device-width: 896px){\n  .hero-mobile-content-wrapper {\n       margin-top: 70%!Important;\n\n  }\n  \n  .backToFunContainer{\n  margin-top: 0.9em!important;\n\n  }\n  \n  .coverHeading{\n    font-size: 2rem!important;\n  }\n  \n  .hero-header-mobile{\n    height:609px!important;\n  }\n}</style>", "selector": "head", "dependencies": [], "type": "append", "id": "06A1ED9B-858C-4188-9C87-E1D6A11858BE"}, {"name": "Utility Classes", "config": {}, "id": "E41B5D0C-8FDC-4A47-A44A-496586D9CC10", "dependencies": [], "type": "widget", "widget_id": "20108015752"}, {"name": "Dynamic CTA Button", "config": {"additionalProps": "display:none", "posSelector": ".heroContainer", "link": "", "ctaHoverClass": "ctaHover", "insertPos": "beforeend", "txt": "Hurry! Ends<span id=\"urgencyMsg\"> soon</span>"}, "id": "2C171063-8279-4DC3-B760-972B4A100339", "dependencies": [], "type": "widget", "widget_id": "15955670599"}, {"id": "6C8128EC-9055-4BB6-BE03-97CC0D11B572", "type": "widget", "dependencies": [], "name": "Carousel | Deals w/Cover Image ADA", "widget_id": "30388620086", "config": {"carNumber": "1", "insertAfterDesktop": ".carousels", "insertAfterMobile": ".carouselsMobile", "headline": "", "numResults": "4", "carCoverImg": "/~/media/Images/hp-merch/2024/extras/carousel/casino-win.jpg", "htmlOverlayCopy": "<span class=\"hp-font-tempo hp-text-white\" style=\" font-size: 2.5em;\n    text-align: center;\n    display: flex;\n    flex-direction: column;\n    line-height: 1;\n   \"> CHECK OUT THESE <br> EXCLUSIVE DEALS<br> JUST FOR YOU</span>", "icid": "crm_ccl_pmw_110424_mbl_carousel_c1_casino_1"}}, {"id": "8B4DD1D3-3989-4EC6-8142-040C380D0EE1", "type": "widget", "dependencies": [], "name": "Hero | Mobile (with onclick update)", "widget_id": "30314080267", "config": {"imgPortrait": "/~/media/Images/hp-merch/2024/mobile/casino-win-pmw-prt.jpg", "imgLandscape": "/~/media/Images/hp-merch/2024/mobile/casino-win-pmw-lnds.jpg", "ctaURL": "/cruise-deals?icid=crm_ccl_pmw_110424_mbl_hero_h1_casino_1&cruisedeals=pmw", "contentAlignment": "align-self:center", "contentExtraStyles": "", "priceAttributes": "<div class=\"backToFunContainer\" style=\"\">\n\n  <span class=\"head hp-text-white hp-font-tempohp-text-center\" style=\"\n    /* margin-bottom: 2%; */\n    line-height: 1;\n    display: flex;\n    font-size: 47px;\n    flex-direction: column;\n    align-items: center;\n    text-align:center\n    \">MAKE YOUR<br> GAME PLAN!</span>\n  <span class=\"sub-head hp-text-white hp-font-open-sans hp-text-sm hp-text-center hp-my-4\" style=\"\n    text-transform: uppercase;\n    font-size: 15px!Important;\n    line-height: 1.2rem;\n    \">HEY,<br>THIS CASINO OFFER IS EXCLUSIVELY FOR YOU!</span>\n   \n <a  aria-label=\"SHOP THIS DEAL. Play my Way. MAKE YOUR GAME DAY PLAN\" class=\"tile-cta ctaHover hp-text-shadow-none\" style=\"font-size: 170%;margin-top: 12px; color:white;\" tabindex=\"0\" href=\"/cruise-deals?icid=crm_ccl_pmw_110424_mbl_hero_h1_casino_1&cruisedeals=pmw\">SHOP THIS DEAL</a> \n</div>", "landscapeMargins": "margin-top: 0vh;\n\nmargin-bottom: 0vh;\n\nmargin-left: 0vh;\n\nmargin-right:0vh;", "imageAlt": ""}}]}]}], "weightDistributions": null, "name": " 110424 PMW |Mobile", "bucketingStrategy": null, "experimentMetadata": {"allocationPolicy": "manual", "layerId": "21920421817"}}], "policy": "equal_priority", "viewIds": ["9414621687"], "weightDistributions": null, "decisionMetadata": {"experimentPriorities": [[{"entityId": "4669509936611328", "endOfRange": null}, {"entityId": "5508036400250880", "endOfRange": null}, {"entityId": "6061838291435520", "endOfRange": null}, {"entityId": "5524554240491520", "endOfRange": null}, {"entityId": "6391817944432640", "endOfRange": null}, {"entityId": "6633577761210368", "endOfRange": null}]], "experimentWeights": null, "offerConsistency": null}}, {"changes": null, "id": "30276091450", "name": "Personalization| Bucket 4", "commitId": "6537875001442304", "groupId": null, "holdback": 0, "activation": {}, "integrationSettings": {"contentsquare": {}, "google_analytics_4": {}}, "integrationStringVersion": 2, "experiments": [{"audienceIds": ["and", "14246380333", "4783120075", "4527279611576320", "6631919954165760"], "audienceName": "Non-Booked Guest - AND - Not CH session,Desktop & Tablet ,Exclusion|Nov. Broadbase '24 | Casino,Exclusion |Nov. Core '24 | TGO", "changes": null, "id": "4505971876167680", "integrationSettings": null, "variations": [{"id": "5041483900780544", "name": "Variation #1", "actions": [{"viewId": "9414621687", "changes": [{"id": "B8938CD1-9656-4300-89BD-A09F6D8A95CF", "type": "append", "selector": "head", "value": "<style>@media(max-width: 1285px){\n\t#optimizely-extension-625B5A4F-C68F-490E-ADD7-35DA51FD4E58 {\n\t\theight: 287px!important;\n\t}\n\t\n  #optimizely-extension-625B5A4F-C68F-490E-ADD7-35DA51FD4E58 > div {\n  \twidth: 510px!important;\n  }\n\t\n  #optimizely-extension-625B5A4F-C68F-490E-ADD7-35DA51FD4E58 > div {\n  \tmargin-left: 73px!important;\n    margin-top: -18px!important;\n  }\n  \n  #optimizely-extension-625B5A4F-C68F-490E-ADD7-35DA51FD4E58 > div > span.hp-font-helvetica.subcopy-ofs {\n  \tfont-size: 14px!important;\n    margin-top: -2px!important;\n  }\n  \n  #optimizely-extension-625B5A4F-C68F-490E-ADD7-35DA51FD4E58 > div > a {\n  \tmargin-top: 18px!important;\n  }\n\n}</style>", "dependencies": []}, {"id": "7147F475-EB49-49FF-9EBF-D8197CA2AC5E", "type": "widget", "dependencies": [], "name": "Utility Classes", "widget_id": "20108015752", "config": {}}, {"id": "625B5A4F-C68F-490E-ADD7-35DA51FD4E58", "type": "widget", "dependencies": [], "name": "C Tile (with onclick update) Bucket", "widget_id": "4634262784180224", "config": {"inserAfterDesktop": ".bucket-4", "additionalStyles": "    background-image: url(/~/media/Images/hp-merch/2024/extras/content/americas-bday.jpg);\n    background-size: cover;\n    background-position: left;\n    background-size: cover;\n    background-repeat: no-repeat;\n    color: white;\n    margin-top: 15px;\n    height: 320px;\n    position: relative;\n    z-index: 1;\n    display: flex\n;\n    /* justify-content: center; */\n    overflow: hidden;\n    border-radius: 24px;", "innerHTML": "<div class=\"hp-text-blue-dark\" style=\"\n        font-family: tempo;\n        line-height: 1.15;\n        display: flex;\n        flex-direction: column;\n        justify-content: center;\n        align-items: center;\n        width: 521px;\n        margin-left: 104px;\n        margin-top: -15px;\n    \"><span class=\"\" style=\"\n    text-align:center;\n    font-size: 36px;\n    position: relative;\n    line-height: .9;\n    \"> <img src=\"/~/media/Images/hp-merch/2024/extras/content/americas-bday-graphic.jpg\" style=\"max-width: 100%;\" alt=\"\">     </span>\n   \n  <span class=\"hp-font-helvetica subcopy-ofs\" style=\"\n    text-align:center;\n    font-size: 14.4px;\n    line-height: 1.1;\n    margin-top: 7px;\n    display: block;\n    font-weight: 650;\n    text-transform:none;\n    \" aria-hidden=\"true\">America\u2019s cruise line will be celebrating the big 250 on a series of unique cruises featuring ship meetups, plus special entertainment, food and more.</span>\n     \n  \n    <a aria-label=\"Find out more.America's 250, America\u2019s cruise line will be celebrating the big 250 on a series of unique cruises featuring ship meetups, plus special entertainment, food and more.\" class=\"CTileCTA ctaHover hp-text-shadow-none\" style=\"font-size: 170%;margin-top: 25px;color: white;\" tabindex=\"0\" href=\"/americas-250th-birthday?icid=crm_ccl_ofs-americabday_112124_hm_ctile_ct1_public_4\">FIND OUT MORE</a>\n        </div>", "link": "/americas-250th-birthday?icid=crm_ccl_ofs-americabday_112124_hm_ctile_ct1_public_4", "location": "afterend", "btiletoggle": "sec-banner", "altText": ""}}]}]}], "weightDistributions": null, "name": "1121: America's Birthday OFS C tile | Desktop", "bucketingStrategy": null, "experimentMetadata": {"allocationPolicy": "manual", "layerId": "30276091450"}}, {"audienceIds": ["and", "14246380333", "5283750624", "4527279611576320", "6631919954165760"], "audienceName": "Non-Booked Guest - AND - Not CH session,Mobile Phones Only,Exclusion|Nov. Broadbase '24 | Casino,Exclusion |Nov. Core '24 | TGO", "changes": null, "id": "6358077704765440", "integrationSettings": null, "variations": [{"id": "6404948716421120", "name": "Variation #1", "actions": [{"viewId": "9414621687", "changes": [{"id": "44A5646B-CF21-48A6-B7DD-5047DFBAA00B", "type": "custom_code", "value": function($){var $ = window.jQuery;
var utils = window.optimizely.get('utils');
/*
 if ($(window).width() < 960) {
utils.waitForElement('#optimizely-extension-D2995957-1D55-496D-8B63-26693BD02BF6').then(function(elem) {
$("#optimizely-extension-D2995957-1D55-496D-8B63-26693BD02BF6").empty();
$(".copy-pack-title").append('<img src="/~/media/Images/hp-merch/2024/extras/graphics/ofs-mbl.png" alt="new sailings unlocked" style="max-width: 280px;">');});
 }
*/
}, "dependencies": []}, {"id": "FEF05621-0AB9-4293-A4AD-348F77BE26EE", "type": "append", "selector": "head", "value": "<style>.c-hero__image {\n\tborder-radius: 24px!important;\n}\n\n\n@media(max-width: 1285px){\n\t#optimizely-extension-D2995957-1D55-496D-8B63-26693BD02BF6 {\n\t\theight: 287px!important;\n\t}\n\t\n  #optimizely-extension-D2995957-1D55-496D-8B63-26693BD02BF6 > div {\n  \twidth: 510px!important;\n  }\n\t\n  #optimizely-extension-D2995957-1D55-496D-8B63-26693BD02BF6 > div {\n  \tmargin-left: 73px!important;\n    margin-top: -18px!important;\n  }\n  \n  #optimizely-extension-D2995957-1D55-496D-8B63-26693BD02BF6 > div > span.hp-font-helvetica.subcopy-ofs {\n  \tfont-size: 14px!important;\n    margin-top: -2px!important;\n  }\n  \n  #optimizely-extension-D2995957-1D55-496D-8B63-26693BD02BF6 > div > a {\n  \tmargin-top: 18px!important;\n  }\n\n}\n\n@media(max-width: 960px){\n  #optimizely-extension-D2995957-1D55-496D-8B63-26693BD02BF6 {\n  \tbackground-image:url(/~/media/Images/hp-merch/2024/extras/content/americas-bday-mbl.jpg)!important;\n  }\n\n}\n\n@media(max-width: 380px){\n  .america-box{\n      margin-top: -28px!important;}\n  .subcopy-ofs{    margin-top: 200px!important;}\n}\n@media (min-width: 381px) and (max-width: 395px){\n  .america-box{\n      margin-top: -33px!important;}\n  .subcopy-ofs{    margin-top: 206px!important;}\n}\n@media (min-width: 396px) and (max-width: 412px){\n  .america-box{\n      margin-top: -46px!important;}\n}\n@media (min-width: 413px) and (max-width: 424px){\n  .america-box{\n      margin-top: -46px!important;}\n  .subcopy-ofs{    margin-top: 216px!important;}\n}\n@media (min-width: 425px) {\n  .america-box{\n      margin-top: -73px!important;}\n\n}</style>", "dependencies": []}, {"id": "D294A642-A985-4905-94B9-755B589C10BC", "type": "widget", "dependencies": [], "name": "Utility Classes", "widget_id": "20108015752", "config": {}}, {"id": "415AD567-ADB3-453D-A625-7911D26DED7F", "type": "widget", "dependencies": [], "name": "B Tile | Mobile (with onclick update) Buckets", "widget_id": "4651804370141184", "config": {"appendMbl": ".bucket-4", "bTileBG": "/~/media/Images/hp-merch/2024/extras/content/americas-bday-mbl.jpg", "clickThrough": "/americas-250th-birthday?icid=crm_ccl_ofs-americabday_112124_mbl_btile_b1_public_4", "b1Copy": "<div class=\"hp-text-blue-dark hp-text-shadow-none america-box\" style=\"display: flex;flex-direction: column;align-items: center;width: 354px;margin-top: 19px;\">\n<span class=\"\" style=\"\n    text-align:center;\n    font-size: 36px;\n    position: relative;\n    line-height: .9;\n    width: 277px;\n    \"> <img src=\"/~/media/Images/hp-merch/2024/extras/content/americas-bday-graphic.jpg\" style=\"max-width: 100%;\" alt=\"\">     </span>\n  <span class=\"hp-font-helvetica subcopy-ofs\" style=\"\n    text-align:center;\n    font-size: 16px;\n    line-height: 1.1;\n    margin-top: 226px;\n    display: block;\n    font-weight: 650;\n    text-transform:none;\n    \" aria-hidden=\"true\">America\u2019s cruise line will be celebrating the big 250 on a series of unique cruises featuring ship meetups, plus special entertainment, food and more.</span>\n<a aria-label=\"Find out more about America's 250th birthday celebration at sea. America\u2019s cruise line will be celebrating the big 250 on a series of unique cruises featuring ship meetups, plus special entertainment, food, and more\" class=\"tile-cta\" style=\"    font-size: 16px!important;\n    padding: 10px 16px!important;\n    margin-top: 10px;\" href=\"/americas-250th-birthday?icid=crm_ccl_ofs-americabday_112124_mbl_btile_b1_public_4\">FIND OUT MORE</a>\n\n</div>", "copyMargin": "", "contentPosition": "center", "altText": ""}}]}]}], "weightDistributions": null, "name": "1121: America's Birthday OFS C tile | Mobile", "bucketingStrategy": null, "experimentMetadata": {"allocationPolicy": "manual", "layerId": "30276091450"}}, {"audienceIds": ["and", "14246380333", "6065805817806848", "6226637042221056"], "audienceName": "Non-Booked Guest - AND - Not CH session,Nov. Core '24 | TGO,November Casino '24", "changes": null, "id": "6515444266303488", "integrationSettings": null, "variations": [{"id": "4939111409123328", "name": "Variation #1", "actions": [{"viewId": "9414621687", "changes": [{"id": "531250FC-D548-4563-BC29-7C4C9CE32634", "type": "custom_code", "value": function($){var $ = window.jQuery;
var utils = window.optimizely.get('utils');

 if ($(window).width() < 960) {
utils.waitForElement('#optimizely-extension-D4454D98-1C39-4B09-914F-3048F1BD08A3 > span').then(function(elem) {
$("#optimizely-extension-D4454D98-1C39-4B09-914F-3048F1BD08A3 > span").empty();
$("#optimizely-extension-D4454D98-1C39-4B09-914F-3048F1BD08A3 > span").append('<span class="copy-pack-title" style="color: white; display: flex;align-items: center;justify-content: center; white-space: nowrap;line-height: 1;"><span style="color: rgb(16, 85, 154)!important;font-size: 0.72em;margin-left: 4px;margin-right: 5px;">SO MUCH TO BE THANKFUL<br>FOR ON A CARNIVAL CRUISE</span></span>');
});
 }
}, "dependencies": []}, {"id": "E071AB41-AE52-48CC-A151-590EE1D9CC49", "type": "append", "selector": "head", "value": "<style>#optimizely-extension-254FC88C-E7E8-45E7-AC17-98EE15B3F994 > div > div.pack-item.p2 {\n\tdisplay: none!important;\n}\n\n.title-text {\n\tline-height: 1;\n  font-size: 39px;\n  text-shadow:none!important;\n}\n\n.guide-pack,.pack-item {\n  border-radius:24px;\n}\n\n.pcopy-4 > .pack-title > .copy-pack-title-2 {\n  text-shadow: 1px 2px 3px rgba(0,0,0,.5);\n}\n\n.p2 > div > div > .packCta-4 {\n\tfont-size:18px;\n}\n\n.pack-copy-cta {\n\tmargin-bottom: 41px!important;\n}\n\n.subcopy-ofs {\n\tmargin: 0 -7px!important;\n}\n\n.copy-pack-copy {\n\tmargin-right: auto!important;\n  margin-left: auto!important;\n}\n\n@media(max-width: 960px){\n .title-text\t{\n \t font-size:35px!important;\n   display: flex;\n   flex-direction: column;\n   align-items: center;\n  }\n  \n  .pack-4 > .subcopy-ofs {\n   font-size:14px!important;\n  }\n  .guide-pack-container  {\n  \theight: 100%!important;\n  }\n  \n  .guide-pack-container {\n  \toverflow-y: unset!important;\n  }\n  \n}\n\n@media (max-width: 880px) {\n  .copy-pack-copy {\n    width: 307px!important;\n  }\n  .pack-copy-cta {\n\t\tmargin-bottom: 20px!important;\n\t}\n}\n\n@media(max-width: 500px){\n #optimizely-extension-254FC88C-E7E8-45E7-AC17-98EE15B3F994 > div > div.pack-item.p1 > div > div > a {\n  \tmargin-bottom: -109px;\n  }\n}\n\n@media(max-width: 475px){\n #optimizely-extension-254FC88C-E7E8-45E7-AC17-98EE15B3F994 > div > div.pack-item.p1 > div > div > a {\n  \tmargin-bottom: -76px;\n  }\n}\n\n@media(max-width: 450px){\n #optimizely-extension-254FC88C-E7E8-45E7-AC17-98EE15B3F994 > div > div.pack-item.p1 > div > div > a {\n  \tmargin-bottom: -52px;\n  }\n}\n\n@media(max-width: 435px){\n #optimizely-extension-254FC88C-E7E8-45E7-AC17-98EE15B3F994 > div > div.pack-item.p1 > div > div > a {\n  \tmargin-bottom: -30px;\n  }\n}\n\n@media(max-width: 420px){\n #optimizely-extension-254FC88C-E7E8-45E7-AC17-98EE15B3F994 > div > div.pack-item.p1 > div > div > a {\n  \tmargin-bottom: -30px;\n  }\n}\n\n@media(max-width: 410px){\n #optimizely-extension-254FC88C-E7E8-45E7-AC17-98EE15B3F994 > div > div.pack-item.p1 > div > div > a {\n  \tmargin-bottom: -3px;\n  }\n}\n\n@media(max-width: 395px){\n #optimizely-extension-254FC88C-E7E8-45E7-AC17-98EE15B3F994 > div > div.pack-item.p1 > div > div > a {\n  \tmargin-bottom: 19px;\n  }\n}\n\n@media(max-width: 375px){\n #optimizely-extension-254FC88C-E7E8-45E7-AC17-98EE15B3F994 > div > div.pack-item.p1 > div > div > a {\n  \tmargin-bottom: 38px;\n  }\n}</style>", "dependencies": []}, {"id": "54623CF0-EB2C-451E-84BA-3F0D7B6C03E6", "type": "widget", "dependencies": [], "name": "Utility Classes", "widget_id": "20108015752", "config": {}}, {"id": "D4454D98-1C39-4B09-914F-3048F1BD08A3", "type": "widget", "dependencies": [], "name": "2/3/4/5 Tiles Pack Carousel w/copy | Responsive  (with onclick update)", "widget_id": "30451680475", "config": {"TilesCheck": "4-tiles", "dskheight": "441px", "tile1": "\n  \n<span class=\"title-text\" style=\"\" aria-hidden=\"true\" >COASTERS<br>AT SEA</span>\n\n     \n\n      \n   \n", "color": "hp-text-blue-dark", "p5price": "numadults=2", "tile2": "\n  \n  <span class=\"title-text\" style=\"\" aria-hidden=\"true\" >DELICIOUS<br>DINING</span>\n \n      \n\n\n", "p4price": "numadults=2", "tile3": "\n  <span class=\"title-text\" style=\"\" aria-hidden=\"true\" >FAMILY-FUN<BR>MOMENTS</span>\n", "p3price": "numadults=2", "tile4": "\n  <span class=\"title-text\" style=\"\" aria-hidden=\"true\" >EXCURSION<BR>ADVENTURES</span>\n", "p2price": "numadults=2", "tile5": "<span class=\"copy-pack-title-1\" aria-hidden=\"true\"></span>\n  <span class=\"copy-pack-title-2\" aria-hidden=\"true\">CARNIVAL LUMINOSA<br>SAILINGS</span>\n", "p1price": "numadults=2", "tile5Url": "/cruise-search?icid=crm_ccl_ships_091224_resp_pack_p5_nonbooked_3&ship=cb", "tile4Url": "/shore-excursions?icid=crm_ccl_thankful-excursion_112124_resp_pack_p4_tgo-casino_4", "p1aria": "Learn More, Coasters at Sea", "tile3Url": "/family-kids-cruises?icid=crm_ccl_thankful-family_112124_resp_pack_p3_tgo-casino_4", "titleCSS": "  color: white; \n  display: flex;\n  align-items: center;\n  justify-content: center;\n  white-space: nowrap;\n", "p2aria": "Learn More, Delicious Dining", "tile2Url": "/dining?icid=crm_ccl_thankful-dining_112124_resp_pack_p2_tgo-casino_4", "showprice": "false", "p3aria": "Learn More, Family Fun Moments", "tile1Url": "/onboard/bolt-ultimate-sea-coaster?icid=crm_ccl_thankful-coaster_112124_resp_pack_p1_tgo-casino_4", "p4aria": "Learn More, Excursion Adventures", "p5aria": "", "cta": "LEARN MORE", "tile5Image": "/~/media/Images/hp-merch/2023/Desktop/tiles/journeys-tile.jpg", "tile4Image": "/~/media/Images/hp-merch/2024/extras/carousel/couple-horses.jpg", "backgroundColor": "    background-color: white!important;\n  margin-top: 15px!important;\npadding-left: 10px;\npadding-right: 10px;", "appendTo": ".bucket-4", "pNum": "4", "tile3Image": "/~/media/Images/hp-merch/2024/extras/carousel/friends-foosball.jpg", "tile2Image": "/~/media/Images/hp-merch/2024/extras/carousel/family.jpg", "title": "<span style=\"width: 100%;display: block;margin: 0 25px 0 0;flex: 1;height: 2.5px;background-color: rgb(16, 85, 154)!important;position: relative;bottom: 0px;\"></span><span style=\"color: rgb(16, 85, 154)!important;\">SO MUCH TO BE THANKFUL FOR ON A CARNIVAL CRUISE</span><span style=\"width: 100%;display: block;margin: 0 0 0 25px;flex: 1;height: 2.9px;background-color: rgb(16, 85, 154)!important;position: relative;bottom: 0px;\"></span>", "tile1Image": "/~/media/Images/hp-merch/2024/extras/carousel/bolt.jpg", "mblheight": "420px", "packtitle": "title-top"}}, {"css": {}, "dependencies": [], "attributes": {}, "type": "attribute", "id": "967CB024-8343-454D-96F1-6391E11ECD36", "selector": ".pack-item"}]}]}], "weightDistributions": null, "name": "1112 Thankful For Pack - Nonbooked (Cyber) | Responsive", "bucketingStrategy": null, "experimentMetadata": {"allocationPolicy": "manual", "layerId": "30276091450"}}], "policy": "equal_priority", "viewIds": ["9414621687"], "weightDistributions": null, "decisionMetadata": {"experimentPriorities": [[{"entityId": "4505971876167680", "endOfRange": null}, {"entityId": "6358077704765440", "endOfRange": null}, {"entityId": "6515444266303488", "endOfRange": null}]], "experimentWeights": null, "offerConsistency": null}}, {"changes": [{"id": "37D5BE4C-6AFD-4657-BF3B-E1F59DD68C59", "type": "append", "selector": "head", "value": "<style>.itinImage {\n    border-top-left-radius: 24px!important;\n    border-top-right-radius: 24px!important;\n}\n\n.coverImage, .itinCard, .cardSeeMore, .dealsSeeMore {\n    border-radius: 24px!important;\n}</style>", "dependencies": []}, {"id": "C76E327E-BAE0-4DBA-9031-37D9E4E564AA", "type": "custom_code", "value": function($){var $ = window.jQuery || window.optimizely.get('jquery');
var utils = window.optimizely.get('utils');

if (!Array.prototype.findIndex) {
  Object.defineProperty(Array.prototype, 'findIndex', {
    value: function(predicate) {
      if (this == null) {
        throw new TypeError('"this" is null or not defined');
      }
      var o = Object(this);
      var len = o.length >>> 0;
      if (typeof predicate !== 'function') {
        throw new TypeError('predicate must be a function');
      }
      var thisArg = arguments[1];
      var k = 0;
      while (k < len) {
        var kValue = o[k];
        if (predicate.call(thisArg, kValue, k, o)) {
          return k;
        }
        k++;
      }
      return -1;
    },
    configurable: true,
    writable: true
  });
}

if (!String.prototype.includes) {
  String.prototype.includes = function(search, start) {
    'use strict';

    if (search instanceof RegExp) {
      throw TypeError('first argument must not be a RegExp');
    } 
    if (start === undefined) { start = 0; }
    return this.indexOf(search, start) !== -1;
  };
}

function loadScript(url, callback) {
  jQuery.ajax({
    url: url,
    dataType: 'script',
    success: callback,
    async: true,
    cache: true
  });
}

function isSlickAvailable() {
  return typeof $.fn.slick === "function";
}

    var attemps = 0;
		var slickPoll = setInterval(function() {
			if (isSlickAvailable()) {
				clearInterval(slickPoll);
			} else if (attemps > 3) {
				loadScript('/assets/scripts/vendor/slick/slick.js', function() {
				});
			}
			attemps++;
    }, 250);
}, "dependencies": []}], "id": "30375870012", "name": "Personalization| Bucket 5", "commitId": "6045750635790336", "groupId": null, "holdback": 0, "activation": {}, "integrationSettings": {"contentsquare": {}, "google_analytics_4": {}}, "integrationStringVersion": 2, "experiments": [{"audienceIds": ["and", "16118570782", "14246380333"], "audienceName": "NEW RMKT | Stateroom Abandoner,Non-Booked Guest - AND - Not CH session", "changes": null, "id": "30289401046", "integrationSettings": null, "variations": [{"id": "30351220396", "name": "Variation #1", "actions": [{"viewId": "9414621687", "changes": [{"id": "FD5272A6-8D89-4231-AC41-EEB5709A4EB5", "type": "custom_code", "value": function($){var $ = window.jQuery;
var utils = window.optimizely.get('utils');

//Hides c tile if theres one and its not being used as a btile
/*utils.waitForElement('.fifty-term').then(function(){
  $('.fifty-term').addClass('rmktg__hideCTile');
});
utils.waitForElement('.sec-banner').then(function(){
  $('.sec-banner').addClass('rmktg__hideCTile');
});
utils.waitForElement('.sec-banner.rmktg__hideCTile').then(function(){
  
  $('.sec-banner').not('.sec-banner.rmktg__hideCTile').addClass('rmktg__hideCTile');
});
utils.waitForElement('#optimizely-extension-EEA7A782-EFB1-4C17-A054-3E9253DA3192').then(function(){
  $('#optimizely-extension-EEA7A782-EFB1-4C17-A054-3E9253DA3192').addClass('rmktg__hideCTile');
}); */

//formats date to format API uses
function dateFormat(date){
  var formatted = "";
  date.split('').map(function(d, i){
    i === 1 || i === 3 ? formatted += d+"/" :  formatted+= d;
  });
  return formatted;
}

//Get data from optimizely local storage
var behavior = optimizely.get('behavior');
var res =  behavior.query({
  "version": "0.2",
  "filter" : [
    {
      "field":["type"],
      "value":"pageview"
    },
    {
      "field":["name"],
      "value":"1912722625_shopping_funnel"
    }
  ]
});

var data = res[res.length -1].tags;

//build query param to call API
var queryParams = getUrlParams(data.url);
var apiParams = {
  'isMilitary' : queryParams.isMilitary === "N" ? false : true,
  'isOver55' : queryParams.isOver55 === "N" ? false : true,
  'isPastGuest' : queryParams.isPastGuest === "N" ? false : true,
  'durationDays' : queryParams.durDays,
  'embarkPortCode' : queryParams.embkCode,
  'itineraryCode' : queryParams.itinCode,
  'numberOfGuests' : queryParams.numGuests,
  'shipCode' : queryParams.shipCode,
  'dayOfWeek' : getDay(queryParams.sailDate),
  'sailingID' : queryParams.sailingID,
  'subRegionCode' :queryParams.subRegionCode
};
var urlData = {roomType: queryParams.roomType || queryParams.qbMetaCode || 'UL', sailDate: queryParams.sailDate};

var queryString = Object.keys(apiParams).map(function(key) {
    return key + '=' + apiParams[key];
}).join('&');

function getDay(dateString){
  var year = dateString.substring(4);
  var month = parseInt(dateString.substring(0,2));
  var day = dateString.substring(2,4);
  month = month > 0 ? month -1 : month;
	var date = new Date(year,month,day);
  return date.toString().substring(0,3);
}

function getUrlParams(search) {
  var hashes = search.substring((search.indexOf('?') + 1)).split('&');
  var params = {};
  hashes.map(function(hash) {
    var key = hash.split('=')[0];
    var val = hash.split('=')[1];
    params[key] = decodeURIComponent(val);
  });
  return params;
}


function getItin(params, callback){
  $.ajax({
    type: "GET",
    cache: true,
    url: '/cruisesearch/api/search/itinerary?'+params,
    fail:function(){console.log('fail');},
    success: callback
  });
}

getItin(queryString, function(resp){
  utils.waitForElement('.rmktg').then(function(){
      $('<div class="stateroom"></div>').appendTo('.rmktg');
  });
    //utils.waitForElement('.shell-10').then(function(){
    //  $('<div class="stateroom"></div>').insertBefore('.shell-10');
//  });
  utils.waitForElement('.stateroom').then(function(selector){insertHtml(selector, resp, urlData);});
 });

function insertHtml(selector,resp,urlData){
  var roomTypeMap = {
  SU: "Suite",
  IS:'Interior',
  UL:'Interior',
  OB:'Balcony',
  OS: 'Ocean View'
};
  var itinData = resp.itineraries[0];
  
  //Get sailing user was trying to book with date
  var departDate = new Date(dateFormat(urlData.sailDate));
  var sailing = resp.itineraries[0].sailings.filter(function(s) {
    return new Date(s.departureDate).getTime() == departDate.getTime();
  })[0];
  
  //request resized image from sitecore
  var imageUrl = itinData.ports[0].image.url;
  imageUrl = imageUrl.substring(0, imageUrl.indexOf("?"));
  imageUrl += "?useCustomFunctions=1&centerCrop=1&w=445&h=250";
  
  var container = $('<div>').addClass('stateroom_rmktg');
  var rmktgHeadline = $('<h2>').addClass('rmktg__headline').append('FINISH BOOKING YOUR CRUISE');

  /*LEFT SIDE*/
  var leftcontainer = $('<div>').addClass('rmktg__leftSide');
  var itinImage = $('<div>').addClass('rmktg__itinImage').css('background','url('+imageUrl+')');
  
  /*RIGHT SIDE*/
  var rightcontainer = $('<div>').addClass('rmktg__rightSide');
  
  /*ITIN INFO*/
  var itinInfo = $('<div>').addClass('rmktg__itinInfo');
  var shipName = $('<p>').addClass('rmktg__shipName').append(itinData.shipName);
  var itinName = $('<p>').addClass('rmktg__itinName').html(itinData.dur + ' Day '+ itinData.regionName+'<br>From '+ itinData.departurePortName);
  
  var departD = new Date(sailing.departureDate);
  var arrivalD = new Date(sailing.arrivalDate);

  var dates = $('<p>').addClass('rmktg__dates').append(months[departD.getMonth()] +' '+departD.getDate()+', '+departD.getFullYear() +' - '+months[arrivalD.getMonth()] +' '+arrivalD.getDate()+', '+arrivalD.getFullYear());
  var itinDescTitle = $('<p>').addClass('rmktg__itinDescTitle').append('Itinerary:');

  var ports = itinData.portsToDisplay.join(' >  ');
  var itinPoc = $('<p>').addClass('rmktg__itinPoc').append(ports);
  var roomType = $('<p>').addClass('rmktg__itinDescTitle').html('Room Type: <span>'+roomTypeMap[urlData.roomType]+'</span>');
  itinInfo.append(shipName,itinName,dates,itinDescTitle,itinPoc,roomType);

  /*PRICING AND CTA*/
	var pricingCta = $('<div>').addClass('rmktg__pricingCta');
	var attrPre = $('<p>').addClass('rmktg__attrPrePost').append('FROM');
  var priceNum = sailing.rooms[roomTypeMap[urlData.roomType].replace(" ", "").toLowerCase()].price;
  
  var price = $('<p>').addClass('rmktg__attrPrice').html('<sup>$</sup>'+priceNum+'<sup>*</sup>');
  var attrPost = $('<p>').addClass('rmktg__attrPrePost').append('PER PERSON').css('margin-bottom','10px');
  var cta = $('<a>').addClass('rmktg__cta').append('COMPLETE BOOKING').attr('href',sailing.sailingURL);

  pricingCta.append(attrPre,price,attrPost,cta);
  
  rightcontainer.append(itinInfo);
  rightcontainer.append(pricingCta);

  /*CLOSE BUTTON*/
  var rmktgInner = $('<div>').addClass('rmktg__inner');
 var rmktclose = $('<a>').addClass('rmktg__close').attr({'id':'closeRmkt','href':'#', 'aria-label':'close, finish booking your cruise'});
  
  leftcontainer.append(itinImage);
  rmktgInner.append(leftcontainer);
  rmktgInner.append(rightcontainer);
  rmktgInner.append(rmktclose);
  container.append(rmktgHeadline);
  container.append(rmktgInner);
  container.insertBefore(selector);
}

//on close remote remarketing banner and show c tile if theres one 
$(document).on('click','.rmktg__close',function(e){
  e.preventDefault();
  $('.rmktg').empty();
});


var months = ['Jan','Feb','Mar','Apr','May','June','July','Aug','Sept','Oct','Nov','Dec'];
}, "dependencies": []}, {"id": "2482D297-0A16-4241-88B7-6D2C1109E1B8", "type": "append", "selector": "head", "value": "<style>.stateroom_rmktg{\n  max-width: 1400px;\n  margin:20px auto;\n}\n\n.rmktg__hideCTile{\n  display: none !important;\n}\n\n/*.sec-banner{\n  opacity: 0;\n  height: 0px!important;\n}\n\n.rmktg__hideCTileAni{\n  animation-name: cTileAni;\n  animation-delay: 1s;\n  animation-duration: 1s;\n  animation-fill-mode: forwards;\n}\n\n@keyframes cTileAni{\n  from { opacity: 0;}\n  to { opacity: 1;}\n}*/\n\n.rmktg__inner{\n  box-shadow: 0px 0px 6px rgb(24 24 24 / 18%);\n  min-height: 250px;\n  max-height: 250px;\n  box-sizing: border-box;\n  display: flex;\n  align-items: center;\n  margin-top: 5px;\n  position: relative;\n  border-radius:24px;\n}\n\n.rmktg__headline{\n  font-family: tempo;\n  font-size: 3.5rem;\n  color: #10559a;\n  padding-top: 25px;\n}\n\n.rmktg__leftSide{\n  width: 33%;\n}\n\n.rmktg__rightSide{\n  width: calc(70% - 20px);\n  padding: 20px 30px 20px 40px;\n  display: flex;\n  justify-content: space-between;\n  box-sizing: border-box;\n}\n\n.rmktg__shipName{\n  font-size: 1.5rem;\n  color: #333;\n  font-weight: 600;\n}\n\n.rmktg__itinName{\n  color: #10559a;\n  font-weight: 600;\n  font-size: 1.8rem;\n  line-height: 1.2;\n  padding: 5px 0;\n}\n\n.rmktg__dates{\n  font-size: 1.2rem;\n  line-height: 1.5;\n}\n\n.rmktg__itinDescTitle{\n  font-size: 1.4rem;\n  line-height: 1.5;\n  font-weight: 600;\n  color: #333;\n  padding-top: 10px;\n}\n\n.rmktg__itinDescTitle > span{\n  font-weight: 400;\n  font-size: 1.2rem;\n}\n\n.rmktg__itinPoc{\n  font-size: 1.2rem;\n  line-height: 1.5;\n  /*max-width: 95%;*/\n}\n\n\n.rmktg__pricingCta{\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n  align-items: center;\n  min-width: 20%;\n}\n\n.rmktg__attrPrice{\n  color: #333;\n  font-size: 4rem;\n  font-weight: 700;\n}\n\n.rmktg__attrPrice > sup{\n  font-size: 2rem;\n}\n\n\n.rmktg__cta{\n  background: #dc1125;\n  color: #fff !important;\n  font-family: tempo;\n  border-radius: 4px;\n  padding: 16px 32px;\n  font-size: 1.3rem;\n}\n\n\n.rmktg__itinImage{\n  width: 100%;\n  height: 250px;\n  background-size: cover !important;\n  border-bottom-left-radius: 24px;\n  border-top-left-radius: 24px;\n}\n\n.rmktg__itinInfo{\n  max-width: 70%;\n}\n\n/*CLOSE BUTTON*/\n.rmktg__close {\n  width: 25px;\n  height: 25px;\n  cursor: pointer;\n  position: absolute;\n  top: 12px;\n  right: 12px;\n  z-index: 1;\n  color:#595959;\n}\n\n.rmktg__close:before, .rmktg__close:after {\n  position: absolute;\n  left: 12px;\n  content: ' ';\n  height: 17px;\n  width: 2px;\n  background-color: #000;\n}\n.rmktg__close:before {\n  transform: rotate(45deg);\n}\n.rmktg__close:after {\n  transform: rotate(-45deg);\n}\n/*CLOSE BUTTON*/\n\n@media screen and (max-width: 768px){\n  .chSummary{ \n    flex-direction: column;\n    margin-left: 20px;\n    max-width: 90vw;\n  }\n  .depositsArea {\n    padding: 20px 0 0;\n    border-left: none;\n    border-top: solid 1px #0000004d;\n    margin-top: 20px;\n    width: 100%;\n  }\n  .leftSide{\n    max-width: 100%;\n  }\t\n}\n\n@media screen and (max-width: 1400px){\n  .stateroom_rmktg{\n    max-width: 95vw;\n    margin-left: 15px;\n  }\n\n  .rmktg__pricingCta {\n    min-width: 24%;\n  }\n}\n\n@media screen and (min-width: 768px) and (max-width: 1000px) {\n  .rmktg__itinInfo {\n    max-width: 60%;\n  }\n  \n  .rmktg__rightSide {\n    padding: 20px 15px 20px 15px;\n  }\n}\n\n@media screen and (max-width: 768px){\n  .stateroom_rmktg{\n    max-width: 90vw;\n    margin-left: 15px;\n  }\n  .rmktg__inner{\n    flex-direction: column;\n    max-height: initial;\n  }\n\n  .rmktg__leftSide{\n    width: 100%;\n  }\n\n  .rmktg__rightSide{\n    width: 100%;\n    flex-direction: column;\n    padding: 20px;\n  }\n  \n  .rmktg__itinInfo {\n    max-width: 100%;\n  }\n\n  .rmktg__shipName {\n    font-size: 2rem;\n  }\n  \n  .rmktg__itinName {\n    font-size: 2.4rem;\n    line-height: 1;\n  }\n  .rmktg__dates {\n    font-size: 1.4rem;\n  }\n  .rmktg__itinDescTitle {\n    font-size: 1.6rem;\n  }\n  .rmktg__itinPoc {\n    font-size: 1.3rem;\n  }\n    \n}\n\n\n\n@media screen and (max-width: 768px) and (-webkit-min-device-pixel-ratio: 2) {\n .stateroom_rmktg{\n    max-width: 90vw;\n    margin: auto;\n  }\n  .rmktg__rightSide{ \n    padding: 10px 15px;\n  }\n  .rmktg__headline {\n    font-family: tempo;\n    font-size: 1.8rem;\n  }\n  .rmktg__shipName {\n    font-size: 1.2rem;\n  }\n  .rmktg__itinName {\n    line-height: 1.3;\n    font-size: 1rem;\n  }\n  .rmktg__dates {\n    font-size: .8rem;\n  }\n  .rmktg__itinDescTitle {\n    font-size: .9rem;\n    padding-top: 0;\n  }\n  .rmktg__itinPoc {\n    font-size: 1rem;\n  }\n  \n  .rmktg__itinInfo > p {\n    margin: 0;\n  }\n\n  .rmktg__pricingCta > p {\n    margin: 0;  \n    line-height: 1;\n  }\n  .rmktg__attrPrice {\n    font-size: 2.5rem;\n  }\n\n  .rmktg__pricingCta{\n    margin-top: 10px;\n  }\n  \n  .rmktg__itinDescTitle > span{\n    font-size: 1rem;\n  }\n\n  .rmktg__cta{\n    font-size: 12px;\n    padding: 10px 24px;\n  }\n\n}\n\n@media screen and (max-width: 900px) and (-webkit-min-device-pixel-ratio: 2) and (orientation: landscape){\n  .primaryHeading {\n    font-size: 1.4rem;\n  }\n  .secondaryHeading {\n    font-size: 1.4rem;\n  }\n  .depositOnly {\n    font-size: 2rem;\n  }\n  .chLink {\n    font-size: 1.3rem;\n  }\n  \n  /**/\n  .stateroom_rmktg{\n    max-width: 98vw;\n    margin: auto;\n  }\n  .rmktg__rightSide{ \n    padding: 10px 15px;\n  }\n  .rmktg__headline {\n    font-family: tempo;\n    font-size: 1.8rem;\n  }\n  .rmktg__shipName {\n    font-size: 1.2rem;\n  }\n  .rmktg__itinName {\n    line-height: 1.3;\n    font-size: 1rem;\n  }\n  .rmktg__dates {\n    font-size: .8rem;\n  }\n  .rmktg__itinDescTitle {\n    font-size: .9rem;\n    padding-top: 0;\n  }\n  .rmktg__itinPoc {\n    font-size: 1rem;\n  }\n  \n  .rmktg__itinInfo > p {\n    margin: 0;\n  }\n\n  .rmktg__pricingCta > p {\n    margin: 0;  \n    line-height: 1;\n  }\n  .rmktg__attrPrice {\n    font-size: 2.5rem;\n  }\n\n  .rmktg__pricingCta{\n    margin-top: 10px;\n  }\n  \n  .rmktg__itinDescTitle > span{\n    font-size: 1rem;\n  }\n\n  .rmktg__cta{\n    font-size: 12px;\n    padding: 10px 24px;\n  }\n}</style>", "dependencies": []}]}]}], "weightDistributions": null, "name": "Stateroom Abandoner - Finish your booking", "bucketingStrategy": null, "experimentMetadata": {"allocationPolicy": "manual", "layerId": "30375870012"}}, {"audienceIds": ["and", "16910890434", "14246380333", "17702130275"], "audienceName": "Logged in,Non-Booked Guest - AND - Not CH session,VIFP Tiers Red, Gold or Platinum", "changes": null, "id": "30365690170", "integrationSettings": null, "variations": [{"id": "30292510627", "name": "Variation #1", "actions": [{"viewId": "9414621687", "changes": [{"id": "3AEE189A-3FC1-4F60-9F39-FEDBA1A62A28", "type": "custom_code", "value": function($){var $ = window.jQuery;
var utils = window.optimizely.get('utils');

function getCruises(dur,vifp, callback){
  $.ajax({
    type: "GET",
    cache: true,
    url: '/cruisesearch/api/search/?numAdults=2&pageNumber=1&pageSize=8&pastGuest=true&showBest=true&sort=fromprice&useSuggestions=true&vifp='+vifp+'&dur='+dur,
    fail:function(){console.log('fail');},
    complete: callback
  });
}


function getDays(callback) {
  $.ajax({
    cache: true,
    url:"https://www.carnival.com/ProfileManagement/api/v1.0/Profiles",
    fail: function() {
      console.log("fail");
    },
    complete: callback
  });
}

getDays(function(resp){
  var cruisesTillNextTier  = resp.responseJSON.tier.cruiseDaysToNextTier;
  var totalCruises = resp.responseJSON.tier.totalVifpPoints;
  var name = resp.responseJSON.firstName;
  var next = resp.responseJSON.nextTier.tierName;
	var loyaltyNumber = resp.responseJSON.loyaltyNumber;
  var tier = resp.responseJSON.tier.tierTitle;

  var percent = (totalCruises / (cruisesTillNextTier + totalCruises)) * 100;
  var durDays = cruisesTillNextTier > 15 ? 15: cruisesTillNextTier;

  searchCruises(name, next, durDays, percent, totalCruises, cruisesTillNextTier, loyaltyNumber, tier);
});

function searchCruises(name, next, durDays, percent, totalCruises, cruisesTillNextTier,loyaltyNumber,tier){
  var dur;
  if(durDays > 1 && durDays < 5){
    dur = 'd1';
  }
  else if(durDays > 5 && durDays < 9){
    dur = 'd1,d2';
  }
  else{
    dur = '';
  }

  var vifpAssets = {
    GOLD : {color:'#C50F14', logo:'https://www.carnival.com/vifp/~/media/cclus/images/loyalty/icons/vifpredgif.jpg'},
    PLATINUM :{color:'#E9BE2F', logo:'https://www.carnival.com/vifp/~/media/cclus/images/loyalty/icons/vifpgoldgif.jpg'},
    DIAMOND: {color:'#B2B4B7', logo:'https://www.carnival.com/vifp/~/media/cclus/images/loyalty/icons/vifpplatinumgif.jpg'}
  };
  
  var currentTierColor = vifpAssets[next].color; 
  var curentTierLogo = vifpAssets[next].logo;
  var currentTier = tier.toLowerCase().charAt(0).toUpperCase() + tier.toLowerCase().slice(1);

  $(document).ready(function() {
    utils.waitForElement('.rmktg').then(start);
    //utils.waitForElement('.carouselsMobile-2').then(start);
			
    function start(){
   
        $('.rmktg').empty();
      
         var cont = $('<div>').addClass('carouselItin');
      cont.css('padding-top','40px');
      cont.append('<div class="infoCard"><div class="nameLogo"><a class="vifpTierLogo mobileOnly" href="https://www.carnival.com/profilemanagement/profiles/benefits"><img src="'+curentTierLogo+'"></a><h3 class="carouselHeading" style="padding-bottom: 20px;">WELCOME BACK <br class="mobileOnly" data-pii> '+name+'!</h3></div><div class="meterOffersCont"><div class="vifpCarLeftSide"><a class="vifpTierLogo desktopOnly" href="https://www.carnival.com/profilemanagement/profiles/benefits?icid=crm_ccl_vifp-profile_092424_resp_ctile_ct1_rmktg_5"><img src="'+curentTierLogo+'"></a><div style="width: 100%;"><h6 class="" style="font-size: 2rem;" data-pii>VIFP Club # : '+loyaltyNumber+'</h6><h6 class="" style="font-size: 1.7rem;line-height: 1.5;">Tier: '+currentTier+'</h6><div class="progressBar"><div class="actualBar"><div class="meter" style="border: solid 1px '+currentTierColor+';"><span style="width: '+percent+'%; background:'+currentTierColor+';"><span class="youAreHere"> <i class="fa fa-caret-up" style="color:#666;font-size: 24px;"></i></span></span></div></div><h3 class="totalPoints" style="">'+totalCruises+'/'+(totalCruises+cruisesTillNextTier)+'<span class="points"> pts</span></h3></div></div></div><div class="vifpCarRightSide"><h6 class="offerCountMessage">Save Big With Today\'s Deals</h6><a href="/cruise-deals?icid=crm_ccl_vifp-deals_092424_resp_ctile_ct1_rmktg_5" class="viewOffersCta">View Offers<i class="fa fa-caret-right"></i></a></div></div></div><h3 class="carouselHeading" style="padding-top: 30px;">these cruises will help you get to '+next+'</h3>');
      var recently = $('<div>').addClass('vifpItinCarousel');
      cont.append(recently);
      var disclaimer = $('<p>').addClass('itinCarDisclaimer');
      disclaimer.append('*All taxes & fees included');
      cont.append(disclaimer);
      $(arguments[0]).prepend(cont);

      $(".vifpItinCarousel").slick({
        slidesToShow: 4,
        slidesToScroll: 2,
        infinite: false,
        variableWidth: true,
        prevArrow: '<button class="vifpItinControl slick-prev" aria-label="Previous items in the Carousel" tabindex="1" type="button">Previous</button>',
        nextArrow: '<button class="vifpItinControl slick-next" aria-label="Next items in the Carousel" tabindex="1" type="button">Next</button>',
        responsive: [
          {
            breakpoint: 1150,
            settings: {
              slidesToShow: 2,
              slidesToScroll: 2,
            }
          },
          {
            breakpoint: 568,
            settings: {
              slidesToShow: 1,
              slidesToScroll: 1,
            }
          },
        ]
      });

      getCruises(dur,loyaltyNumber, function(resp){
        if(resp.responseJSON.results.itineraries.length ){
          var offers = resp.responseJSON.filters.tgo.length;
					if(offers > 0)
          {
            $('.offerCountMessage').text('You Have '+offers+' Exclusive Offer(s) Available');
          }
          var results = resp.responseJSON.results.itineraries;
          results.forEach(function(each){
            var portCode = each.id.substring(4,7);
            var card = $('<a>').addClass('itinCard');
            card.attr('href','https://www.carnival.com/cruise-search?dest='+each.regionCode+'&durDays='+each.dur+'&port='+portCode+'&icid=crm_ccl_vifp_092424_resp_carousel_c1_rmktg_5');
            card.attr('tabindex','-1');
          card.attr('aria-label',each.dur +' day cruise to ' + each.regionName+  ' from ' + each.departurePortName +' from $'+each.leadSailing.fromPrice +'* Average per person for 2 person room');
          var image = $('<div>').addClass('itinImage');
          var imageUlr = each.image;
          imageUlr = imageUlr.substring(0,imageUlr.indexOf('?'));
          imageUlr = imageUlr+'?useCustomFunctions=1&centerCrop=1&w=300&h=200';
          image.css('background','url(https://www.carnival.com'+imageUlr+')');
          var copy = $('<div>').addClass('itinCopy');
         // var days = $('<p>').addClass('days');
          //days.append(each.dur +' DAY');

          var destAndPort = $('<h2>').append(each.dur +'-Day '+ each.regionName+ ' from '+ each.departurePortName);

          var pricing = $('<div>').addClass('pricing');
          var cruises = $('<p>').addClass('from').append('From');
              var price = $('<div>').addClass('itinPrice').append('<sup class="itinDollar">$</sup>'+each.leadSailing.fromPrice+'<sup class="itinasterisk">*</sup>');
          var pp = $('<p>').addClass('avgperson').append('Average Per Person<br>2 Person Room');
          var cta = $('<span>').addClass('shopnow').append('Shop Now');

          pricing.append(cruises);
          pricing.append(price);
          pricing.append(pp);

          //copy.append(days);
          copy.append(destAndPort);
          copy.append(pricing);
          copy.append(cta);

          card.append(image);
          card.append(copy);

            $('.vifpItinCarousel').slick('slickAdd',card);
            $('.itinCard.slick-slide.slick-active').attr('tabindex','0');

          });//ends for each
          
          var card = $('<a>').addClass('cardSeeMore');
       
          card.attr('href','https://www.carnival.com/cruise-search?numAdults=2&pageNumber=1&showBest=true&sort=fromprice&useSuggestions=true&pageSize=8&dur='+dur+'&icid=crm_ccl_vifp_092424_resp_carousel_c1_rmktg_5');
         card.attr('aria-label','See more');
          card.attr('tabindex','-1');
          var price = $('<div>').append('See More');
          price.css({'font-family': '"Open Sans", sans-serif'});
          //var caret = '<i class="fa fa-caret-right" style="margin-left: 5px;"></i>';
          //price.append(caret);
          $(price).css({ 'color': 'white', 'display': 'flex', 'justify-content': 'center', 'align-items': 'center', 'height': '100%'});
          card.append(price);
          $('.vifpItinCarousel').slick('slickAdd',card);
        }//ends If statement
      });//Ends Get Iting

 //ADA Fix for focusing on the right thing when the next and prev buttons are pressed.
        $(document).on('click','.slick-next',function(){
        setTimeout(function () {
          $('div.carouselItin > div.vifpItinCarousel > div > div > a.itinCard.slick-slide.slick-active').attr('tabindex','0');
  			 $('div.carouselItin > div.vifpItinCarousel > div > div > a.itinCard.slick-slide.slick-current.slick-active')[0].focus();
          $('div.carouselItin > div.vifpItinCarousel > div > div > a.cardSeeMore.slick-slide.slick-active').attr("tabindex", "0");
           $('div.carouselItin > div.vifpItinCarousel > div > div > a.cardSeeMore.slick-slide.slick-current.slick-active').attr("tabindex", "0");
        }, 500);
      });
           $(document).on('click','.slick-prev',function(){
        setTimeout(function () {
          $('div.carouselItin > div.vifpItinCarousel > div > div > a.itinCard.slick-slide.slick-active').attr('tabindex','0');
  			 $('div.carouselItin > div.vifpItinCarousel > div > div >a.slick-active:last').focus();
           $('div.carouselItin > div.vifpItinCarousel > div > div > a.cardSeeMore.slick-slide.slick-active').attr("tabindex", "0");
        }, 500);
      });

    }//ends start function
  });//ends document ready
}
}, "dependencies": []}, {"id": "07CF9971-0C8C-417B-AC4C-CABAEFCBC339", "type": "append", "selector": "head", "value": "<style>.meter {\n  height: 15px; \n  position: relative;\n  background: #fff;\n  -moz-border-radius: 25px;\n  -webkit-border-radius: 25px;\n  border-radius: 25px;\n  border: solid 1px #0d69aa;\n  width: 100%;\n}\n.meter > span {\n  display: block;\n  height: 100%;\n  -webkit-border-top-right-radius: 8px;\n  -webkit-border-bottom-right-radius: 8px;\n  -moz-border-radius-top-right: 8px;\n  -moz-border-radius-bottom-right: 8px;\n  border-top-right-radius: 8px;\n  border-bottom-right-radius: 8px;\n  -webkit-border-top-left-radius: 20px;\n  -webkit-border-bottom-left-radius: 20px;\n  -moz-border-radius-top-left: 20px;\n  -moz-border-radius-bottom-left: 20px;\n  border-top-left-radius: 20px;\n  border-bottom-left-radius: 20px;\n  background-color: #0d69aa;\n  position: relative;\n}\n\n.progressBar{\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  height: 60px;\n  margin-left: 20px;\n}\n\n.points{\n  color: #10559a;\n  font-size: 50%;\n  font-family: \"Open sans\", sans-serif;\n  font-weight: 700;\n}\n\n.totalPoints{\n  font-size: 3.5rem;\n  font-family: tempo;\n  color: #10559a;\n}\n\n.actualBar{\n  width: 70%;\n}\n\n\n.slick-track {\n    left: 5px!important;\n}\n.geo{\n  display:none;\n}\n.itin-carousel {\n  background-color: #fff575;\n  border-bottom: 1px solid #e0d769;\n  color: #555;\n  padding: 10px;\n  font-weight: bold;\n  text-align: center;\n  font-size: 20px;\n}\n.itinCopy h2 {\n    height: 44px;}\n\n.coverImage{\n    height: 381px;\n    border-radius: 8px;\n    background-size: cover!important;\n}\n\n.coverHeading{\n  color:#fff;\n  font-family: \"TempoStd\", \"Tempo\", \"Tempo-Local\", Arial Narrow, Arial, sans-serif;\n  font-size:24px;\n  text-align: center;\n  padding: 8px;\n}\n  \n.loading{\n  background: #FFF;\n  height: 430px !important;\n  width: 300px;\n  border-radius: 4px;\n  margin: 8px;\n  border: solid 1px rgba(0,0,0,.1);\n  display: flex !important;\n  flex-direction: column;\n  align-items: center;\n  padding: 10px 0;\n  box-sizing: border-box;\n}\n\n.slick-slide {\n    display: block!important;\n}\n\n.itinCard {\n    justify-content: space-between;\n    font-family: \"Open Sans\", sans-serif;\n    margin: 1px 10px;\n    flex-direction: column;\n    align-items: flex-start;\n    padding: 0px;\n    border-radius: 8px;\n    width: 312px;\n    box-shadow: 0px 0px 6px rgb(24 24 24 / 18%);\n}\n\n.itinCarousel1,\n.itinCarousel2,.itinCarousel3,\n.itinCarouselRecently,.vifpItinCarousel  {\n  max-width: 1400px;\n  margin: auto;\n}\n\n.carouselHeading {\n    font-family: \"TempoStd\", \"Tempo\", \"Tempo-Local\", Arial Narrow, Arial, sans-serif;\n    font-size: 36px;\n    line-height: 1;\n    text-transform: uppercase;\n    color: #10559A;\n    padding-left: 30px;\n  padding-bottom:8px;\n}\n\n.carouselItin {\n  max-width: 1400px;\n  margin: 20px auto;\n}\n\n.cardSeeMore {\n    background: #10559a;\n    color: white!important;\n    width: 200px;\n    height: 381px !important;\n    font-size: 18px;\n    font-weight:200;\n    text-decoration: underline!important;\n    border-radius: 8px;\n    font-family: \"Open Sans\", sans-serif;\n    margin: 1px 10px;\n}\n\n/*.itinCard:nth-child(1),\n.actCard:nth-child(1) {\n  margin-left: 0;\n}*/\n\n.itinImage {\n  /*width: 100%;\n  height: 175px;*/\n  background-position: center !important;\n  background-size: cover !important;\n  border-top-left-radius: 8px;\n  border-top-right-radius: 8px;\n  aspect-ratio: 16/9;\n}\n\n.itinCopy {\n    height: 158px;\n    border-bottom-left-radius: 8px;\n    border-bottom-right-radius: 8px;\n    padding: 24px;\n    display: flex;\n    flex-direction: column;\n    align-items: flex-start;\n    gap: 16px;\n    flex: none;\n    order: 1;\n    align-self: stretch;\n    flex-grow: 0;\n}\n\n.itinCopy h2 {\n  font-family: \"Open Sans\", sans-serif!important;\n  font-size: 16px;\n  text-decoration: none;\n  color: #464646;\n  font-weight: 700;\n  line-height: 20px;\n}\n\n.itinCopy .days {\n  color: #000;\n  font-weight: 700;\n  font-size: 1.3rem;\n}\n\n.pricing {\n    color: #464646;\n    font-family: \"Open Sans\", sans-serif!important;\n    font-style: normal;\n    display: flex;\n    flex-direction: row;\n    align-items: flex-start;\n    padding: 0px;\n    gap: 4px;\n    flex: none;\n    order: 0;\n    align-self: stretch;\n    flex-grow: 0;\n}\n\n.pricing .from {\n  font-weight: 400;\nfont-size: 12px;\nline-height: 14px;\n  margin-top:5px;\n}\n\n.pricing .avgperson{\n  font-weight: 400;\nfont-size: 12px;\nline-height: 14px;\n  margin-top:5px;\n}\n\n.pricing .itinPrice {\n    display: flex;\n    align-items: flex-start;\n    padding: 0px;\n    font-weight: 700;\n    font-size: 32px;\n    line-height: 38px;\n}\n.itinDollar {\nfont-weight: 700;\nfont-size: 16px;\nline-height: 28px;\n} \n.itinasterisk {\nfont-weight: 700;\nfont-size: 12px;\nline-height: 25px;\n} \n\n.shopnow {\n    background: #10559a;\n    color: white;\n    text-transform: uppercase;\n    border: none;\n    font-size: 18px;\n    border-radius: 4px;\n    text-align: center;\n    padding: 16px 24px 10px;\n    gap: 8px;\n    line-height: 22px;\n    font-family: 'Tempo Std', \"tempo\";\n    font-style: normal;\n    font-weight: 850;\n    flex: none;\n    order: 2;\n    align-self: stretch;\n    flex-grow: 0;\n}\n\n.itinCarousel1 .slick-prev,\n.itinCarouselRecently .slick-prev,\n.obaDinCarousel .slick-prev,\n.itinCarousel2 .slick-prev,\n.itinCarousel1 .slick-next,\n.itinCarouselRecently .slick-next,\n.obaDinCarousel .slick-next,\n.itinCarousel2 .slick-next, \n.vifpItinCarousel .slick-next, \n.vifpItinCarousel .slick-prev {\n  position: absolute;\n  z-index: 100;\n  top: 185px;\n  left: -20px;\n  width: 40px;\n  height: 40px;\n  background-color: #ffffff;\n  border-radius: 50%;\n  border: none;\n  text-indent: -9999px;\n  cursor: pointer;\n  background-image: url(\" //cdn.optimizely.com/img/752671897/aa51e36df7f24356aa087d95789fa5ca.png\");\n  background-position: center center;\n  background-repeat: no-repeat;\n  overflow: hidden;\n}\n\n.itinCarousel1 .slick-next,\n.itinCarouselRecently .slick-next,\n.obaDinCarousel .slick-next,\n.itinCarousel2 .slick-next,\n .vifpItinCarousel .slick-next{\n  left: 97%;\n  transform: rotate(-180deg);\n}\n\n.title {\n  font-family: \"Open Sans\", sans-serif;\n  font-weight: bold;\n  line-height: 0.5;\n  perspective: 1000px;\n}\n\ndiv.carouselItin > div > button.slick-arrow.slick-disabled {\n  display: none !important;\n}\n\n.slick-prev .hidden,\n.slick-next .hidden {\n  opacity: 0;\n  pointer-events: none;\n}\n\n.cont {\n  width: 1400px;\n  margin: auto;\n  margin-top: 10px;\n}\n\n.cont h1 {\n  font-family: tempo;\n  font-size: 34px;\n  color: #105595;\n}\n\n.actCard:not(.slick-active),\n.itinCard:not(.slick-active) {\n  opacity: 0.5;\n  cursor: default;\n}\n\n.itinCarDisclaimer {\n    text-align: center;\n    color: #464646;\n    font-family: 'Open Sans';\n    font-style: normal;\n    font-weight: 400;\n    font-size: 16px;\n    line-height: 20px;\n    padding-top: 5px;\n}\n\n\n@media (max-width: 768px) {\n  .meterOffersCont{\n    flex-direction: column;\n  }\n  .vifpCarRightSide{\n    width: 100%;\n    border: 0;\n  }\n}\n\n\n.youAreHere{\n  width: max-content;\n  position: absolute;\n  right: 0;\n  transform: translateX(6px);\n  margin-top: 10px;\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  text-transform: uppercase;\n  line-height: .8;\n}\n\n.meterOffersCont{\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n}\n\n.vifpCarLeftSide{\n  display: flex;\n  align-items: center;\n  width: 54%;\n  padding-left:20px;\n}\n\n.vifpCarLeftSide > div > h6{\n  padding-left: 20px;\n}\n\n.vifpCarRightSide{\n  width: 42%;\n  border-left: solid 2px #10559a;\n  height: 150px;\n  padding: 10px;\n  box-sizing: border-box;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  flex-direction: column;\n}\n\n.vifpCarRightSide h6{\n  font-size: 2rem;\n}\n\n.viewOffersCta{\n  color: white !important;\n  background: #10559a;\n  font-family: tempo;\n  text-transform: uppercase;\n  padding: 8px 25px;\n  border-radius: 4px;\n  font-size: 1.2rem;\n  margin-top: 10px;\n}\n\n.viewOffersCta i{\n  padding-left: 5px;\n}\n\n.mobileOnly{\n  display: none;\n}\n\n.desktopOnly{\n  display: block;\n}\n\n.nameLogo{\n  display: flex; \n  height: 50px;\n}\n\n@media (min-width: 1024px) {\n  .itinCarousel1 .slick-next,\n  .itinCarouselRecently .slick-next,\n  .obaDinCarousel .slick-next,\n  .itinCarousel2 .slick-next,\n   .vifpItinCarousel .slick-next{\n    left: 96%;\n    top: 185px;\n  }\n  .itinCarousel1 .slick-prev,\n  .itinCarouselRecently .slick-prev,\n  .obaDinCarousel .slick-prev,\n  .itinCarousel2 .slick-prev,\n  .vifpItinCarousel .slick-prev{\n    left: 10px;\n    top: 185px;\n  }\n  .carouselHeading {\n    padding-left: 30px;\n  }\n  .itinCarousel1,\n  .itinCarousel2,\n  .itinCarouselRecently,\n  .obaDinCarousel,\n  .vifpItinCarousel {\n    padding: 16px 24px 0px 24px;\n  }\n}\n\n@media (min-width: 1400px) {\n  .itinCarousel1 .slick-next,\n  .itinCarouselRecently .slick-next,\n  .obaDinCarousel .slick-next,\n  .itinCarousel2 .slick-next,\n   .vifpItinCarousel .slick-next{\n    left: 97%;\n    top: 185px;\n  }\n  .itinCarousel1 .slick-prev,\n  .itinCarouselRecently .slick-prev,\n  .obaDinCarousel .slick-prev,\n  .itinCarousel2 .slick-prev,\n  .vifpItinCarousel .slick-prev{\n    left: 0;\n    top: 185px;\n  }\n}\n\n@media (max-width: 768px) {\n  .meterOffersCont{\n    flex-direction: column;\n    width: 100vw;\n  }\n  .vifpCarLeftSide{\n    width: 92%;\n    flex-direction: column;\n    padding-left: 0;\n  }\n  .vifpCarLeftSide > div > h6{\n    padding-left: 0;\n  }\n  .progressBar{\n    margin-left: 0;\n  }\n \n  .totalPoints{\n    padding-right: 10px;\n  }\n  .vifpCarRightSide{\n    width: 100%;\n    border: 0;\n  }\n  .mobileOnly{\n    display: block;\n  }\n  .desktopOnly{\n    display: none;\n  }\n  .nameLogo{\n    height: auto;\n    padding: 0px 0 10px 10px;\n    align-items: center;\n  }\n\n}\n\n\n/* Portrait */\n@media only screen and (min-device-width: 320px) and (max-device-width: 736px) and (-webkit-min-device-pixel-ratio: 2) {\n  .totalPoints{\n    display: none;\n  }\n\n  .progressBar{\t\n    margin-top: 10px;\n    margin-left: 5px;\n    height: 20px;\n  }\n\n  .youAreHere{\n    margin-top: 8px;\n    right: 0;\n  }\n\n  .actualBar{\n    width: 95%;\n  }\n\n  .meterOffersCont{\n    flex-direction: column;\n    width: auto;\n  }\n  .vifpCarLeftSide > div > h6, .offerCountMessage{\n    font-family: \"Open Sans\", sans-serif;\n    font-weight: 400;\n    color: #595959;\n    font-size: 1.3em !important;\n  }\n\n  .vifpCarRightSide{\n    height: 75px;\n    padding: 0;\n    margin-top: 20px;\n  }\n\n  .viewOffersCta{\n    font-size: .9rem;\n  }\n  \n  .infoCard{\n    border: 1px solid rgba(0,0,0,.25);\n    width: 95%;\n    margin: auto;\n    border-radius: 4px;\n    padding: 10px;\n    margin-bottom: 15px;\n}\n   .itinCarousel1 .slick-prev,\n  .itinCarouselRecently .slick-prev,\n  .obaDinCarousel .slick-prev,\n  .itinCarousel2 .slick-prev,\n  .vifpItinCarousel .slick-prev{\n    left: -7px;\n      top: 175px;\n  }\n\n  .itinCarousel1 .slick-next,\n  .itinCarouselRecently .slick-next,\n  .obaDinCarousel .slick-next,\n  .itinCarousel2 .slick-next,\n   .vifpItinCarousel .slick-next{\n    left: 90%;\n       top: 175px;\n  }\n\n  .itinCarousel1,\n  .itinCarousel2,\n  .itinCarouselRecently,\n  .vifpItinCarousel{\n    max-width: 100%;\n    margin: 16px 16px 0 16px;\n  }\n\n  .carouselHeading {\n    font-size: 24px;\n    line-height:28px;\n  }\n\n  .itinCopy {\n    height: 206px;\n  }\n  .itinDollar{\n    top:0px!important;\n  }\n  .itinCard {\n    width: 320px;\n  }\n  .cardSeeMore {\n    height: 386px !important;\n     }\n  .coverImage{\n    height: 386px;\n  }  \n   .itinCarDisclaimer {\n   font-size: 16px;\n    line-height: 20px;\n}\n}\n\n@media only screen and (min-width: 375px) and (max-width: 980px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape),\n  only screen and (min-width: 375px) and (max-width: 980px) and (-webkit-device-pixel-ratio: 3.5) and (orientation: landscape),\n  only screen and (min-width: 375px) and (max-width: 980px) and (-webkit-device-pixel-ratio: 2.625) and (orientation: landscape)\n{\n  .vifpTierLogo{\n    margin-left: 5px;\n    width: auto;\n  }\n  .totalPoints{\n    display: none;\n  }\n\n  .progressBar{\t\n    margin-bottom: 20px;\n    margin-left: 10px;\n    height: 20px;\n    width: 90%;\n  }\n\n  .youAreHere{\n    margin-top: 8px;\n    right: 0;\n  }\n\n  .actualBar{\n    width: 95%;\n  }\n\n\n  .vifpCarLeftSide > div > h6, .offerCountMessage {\n    font-family: \"Open Sans\", sans-serif;\n    font-weight: 400;\n    color: #595959;\n    font-size: 1.3em !important;\n  }\n    .itinDollar {\n    font-weight: 700;\n    font-size: 16px;\n    line-height: 32px;\n}\n  .itinCopy {\n    height: 206px;\n  }\n  .itinCarousel1,\n  .itinCarousel2,\n  .itinCarouselRecently,\n  .vifpItinCarousel{\n    max-width: 100%;\n    margin: 16px 16px 0 16px;\n  }\n  .itinCarousel1 .slick-prev,\n  .itinCarouselRecently .slick-prev,\n  .obaDinCarousel .slick-prev,\n  .itinCarousel2 .slick-prev,\n  .vifpItinCarousel .slick-prev{\n    left: -2px!important;\n    top:165px;\n  }\n\n  .itinCarousel1 .slick-next,\n  .itinCarouselRecently .slick-next,\n  .obaDinCarousel .slick-next,\n  .itinCarousel2 .slick-next,\n  .vifpItinCarousel .slick-next{\n    left: 97%;\n      top:165px;\n  }\n  .cardSeeMore {\n    height: 382px !important;\n     }\n  .coverImage{\n    height: 382px;\n}\n}</style>", "dependencies": []}]}]}], "weightDistributions": null, "name": "VIFP Tier Carousel", "bucketingStrategy": null, "experimentMetadata": {"allocationPolicy": "manual", "layerId": "30375870012"}}, {"audienceIds": ["and", "16147010856", "14246380333"], "audienceName": "NEW RMKT | Search Abandoner,Non-Booked Guest - AND - Not CH session", "changes": null, "id": "30359980143", "integrationSettings": null, "variations": [{"id": "30376000035", "name": "Variation #1", "actions": [{"viewId": "9414621687", "changes": [{"id": "A1126B40-672C-49A2-9ACD-F143B5FF8D81", "type": "widget", "dependencies": [], "name": "Carousel | Itineraries + Rmktg", "widget_id": "20982870686", "config": {"carCoverImg": "/~/media/Images/hp-merch/2021/extras/carouselCover/shaq-cover-image.ahsx", "geoTarget": "false", "ItinRemarketing": "false", "insertAfterMobile": "", "params": "", "numResults": "16", "destPage": "false", "cruiseDeals": "", "remarketing": "true", "headline": "LAST-MINUTE CRUISE DEALS", "icid": "crm_ccl_searchrmktg_092424_resp_carousel_c1_rmktg_5", "cover": "n", "insertAfterDesktop": ".rmktg", "htmlOverlayCopy": "<div class=\"coverHeading\">CHECK OUT THESE EXCLUSIVE DEALS JUST FOR YOU</div>\n\n", "carNumber": "2"}}, {"id": "B8397BE9-504D-4C1A-A8B3-0C63C869A8E8", "type": "widget", "dependencies": [], "name": "Utility Classes", "widget_id": "20108015752", "config": {}}]}]}], "weightDistributions": null, "name": "Search Remarketing Carousel", "bucketingStrategy": null, "experimentMetadata": {"allocationPolicy": "manual", "layerId": "30375870012"}}, {"audienceIds": ["and", "14246380333"], "audienceName": "Non-Booked Guest - AND - Not CH session", "changes": null, "id": "5425610340696064", "integrationSettings": null, "variations": [{"id": "4767220778139648", "name": "Variation #1", "actions": [{"viewId": "9414621687", "changes": [{"id": "6889B40B-690E-4D71-808F-8FFA55B0ED27", "type": "custom_code", "value": function($){var utils = window.optimizely.get('utils');
var dcp = window.optimizely.get("dcp");

utils.waitForElement(".coverImage").then(function() {
$('.coverImage').css('cursor', 'pointer').click(function() {
  window.location.href = "/cruise-search?crm_ccl_geotargeted_111224_resp_carousel_c1_tgo_5"});
});
}, "dependencies": []}, {"id": "AF7349FF-2BD1-4E15-A145-78A3DF9883AB", "type": "widget", "dependencies": [], "name": "Carousel | Itineraries + Rmktg", "widget_id": "20982870686", "config": {"carCoverImg": "/~/media/Images/hp-merch/2022/extras/carousel/girlfriends-on-ship.jpg", "geoTarget": "true", "ItinRemarketing": "false", "insertAfterMobile": "", "params": "", "numResults": "16", "destPage": "false", "cruiseDeals": "", "remarketing": "false", "headline": "", "icid": "crm_ccl_geotargeted_112424_resp_carousel_c1_nonbooked_5", "cover": "y", "insertAfterDesktop": ".bucket-5", "htmlOverlayCopy": "<div class=\"coverHeading hp-text-white\" style=\"\n    padding-top: 30px;\n\"><span style=\"\n    display: block;\n    font-size: 39px;\n    line-height: 1;\n\"><div class=\"default\" style=\"padding-top: 15px;\">CELEBRATE WITH<br> SAILINGS NEAR YOU</div>\n<div class=\"geo\">CELEBRATE WITH<br> SAILINGS FROM <br>A PORT NEAR YOU</div></span></div>", "carNumber": "2"}}, {"css": {}, "dependencies": [], "attributes": {}, "type": "attribute", "id": "481AC95F-C998-426F-BFD8-0C3061B19EFD", "selector": ".itinCard"}]}]}], "weightDistributions": null, "name": "1112 Carousel - Nonbooked (Cyber) | Responsive", "bucketingStrategy": null, "experimentMetadata": {"allocationPolicy": "manual", "layerId": "30375870012"}}], "policy": "equal_priority", "viewIds": ["9414621687"], "weightDistributions": null, "decisionMetadata": {"experimentPriorities": [[{"entityId": "30289401046", "endOfRange": null}], [{"entityId": "30365690170", "endOfRange": null}], [{"entityId": "30359980143", "endOfRange": null}], [{"entityId": "5425610340696064", "endOfRange": null}]], "experimentWeights": null, "offerConsistency": null}}, {"changes": null, "id": "30264701055", "name": "Personalization| Bucket 6", "commitId": "5744604708864000", "groupId": null, "holdback": 0, "activation": {}, "integrationSettings": {"contentsquare": {}, "google_analytics_4": {}}, "integrationStringVersion": 2, "experiments": [{"audienceIds": ["or", "14246380333", "13142870528"], "audienceName": "Non-Booked Guest - AND - Not CH session,BG | Courtesy Hold Session", "changes": null, "id": "5809328899751936", "integrationSettings": null, "variations": [{"id": "4881168213475328", "name": "Variation #1", "actions": [{"viewId": "9414621687", "changes": [{"id": "C6553EB5-25EC-48D4-8ADA-CA8FDADFFB37", "type": "append", "selector": "head", "value": "<style>.link-touts ul a {\n  background-color:white!important;\n  border-radius:24px;\n  box-shadow: 0px 0px 6px rgb(24 24 24 / 18%);\n}\n.upLiftShell, .upliftBanner {\n   border-radius:24px!important;\n}\n.shell-10,.upLiftShell,.upliftBanner {\n    max-width: 1400px;\n    margin: 25px auto;\n}</style>", "dependencies": []}, {"id": "BE26DAB0-43C1-4F38-A9AA-EC8C0F3E714B", "type": "widget", "dependencies": [], "name": "Uplift Tile - Responsive ADA", "widget_id": "30018260781", "config": {"inserAfterDesktop": ".bucket-6", "additionalStyles": "", "location": "beforebegin", "btiletoggle": "sec-banner", "subHeadline": "BOOK TODAY. PAY OVER TIME.", "upliftButton": "<span>GET ESTIMATE<sup style=\"margin-left: 1px;\">\u2020</sup></span>"}}]}]}], "weightDistributions": null, "name": "Flex Pay", "bucketingStrategy": null, "experimentMetadata": {"allocationPolicy": "manual", "layerId": "30264701055"}}], "policy": "equal_priority", "viewIds": ["9414621687"], "weightDistributions": null, "decisionMetadata": {"experimentPriorities": [[{"entityId": "5809328899751936", "endOfRange": null}]], "experimentWeights": null, "offerConsistency": null}}], "groups": [], "audiences": [{"id": "4783120075", "name": "Desktop & Tablet ", "conditions": ["and", ["or", ["or", {"match": null, "name": null, "type": "device", "value": "desktop"}, {"match": null, "name": null, "type": "device", "value": "tablet"}, {"match": null, "name": null, "type": "device", "value": "ipad"}]], ["or", ["not", ["or", {"match": "exists", "name": "KTNX", "type": "cookies", "value": ""}]]]]}, {"id": "5283750624", "name": "Mobile Phones Only", "conditions": ["and", ["or", ["or", {"match": null, "name": null, "type": "device", "value": "mobile"}, {"match": null, "name": null, "type": "device", "value": "iphone"}]]]}, {"id": "9413671777", "name": "KTNX Cookie | DO NOT USE ", "conditions": ["and", ["or", ["or", {"match": "exact", "name": "KTNX", "type": "query", "value": "true"}]]]}, {"id": "10261134200", "name": "All | Exclude Synthetic Script \"KTNX\"", "conditions": ["and", ["or", ["not", ["or", {"match": "exact", "name": "KTNX", "type": "query", "value": "true"}]]], ["or", ["not", ["or", {"match": "exists", "name": "KTNX", "type": "cookies", "value": ""}]]], ["or", ["not", ["or", {"match": "exact", "name": "test", "type": "query", "value": "caryn"}]]]]}, {"id": "13142870528", "name": "BG | Courtesy Hold Session", "conditions": ["and", ["or", ["or", {"match": "exists", "name": "cclCHSession", "type": "cookies", "value": null}]]]}, {"id": "13231000241", "name": "Desktop Only", "conditions": ["and", ["or", ["or", {"match": null, "name": null, "type": "device", "value": "desktop"}]]]}, {"id": "14246380333", "name": "Non-Booked Guest - AND - Not CH session", "conditions": ["and", ["or", ["or", {"match": null, "name": null, "type": "code", "value": "localStorage.getItem(\"CCL_BkXp\") === null"}]], ["or", ["not", ["or", {"match": "exists", "name": "cclCH", "type": "cookies", "value": ""}, {"match": "exists", "name": "cclCHSession", "type": "cookies", "value": ""}]]], ["or", ["or", {"match": null, "name": null, "type": "code", "value": "localStorage.getItem(\"booked\") === null "}]]]}, {"id": "16118570782", "name": "NEW RMKT | Stateroom Abandoner", "conditions": ["and", ["or", ["or", {"match": null, "name": "event", "type": "behavior", "value": "{\"version\":\"0.1\",\"source\":\"events\",\"action\":{\"type\":\"pageview\",\"value\":\"1912722625_shopping_funnel\"},\"time\":{\"type\":\"last_days\",\"days\":30},\"count\":{\"comparator\":\"gte\",\"value\":1},\"filters\":[{\"name\":\"url\",\"comparator\":\"contains\",\"value\":\"www.carnival.com/booking/\",\"modifier\":\"most_recent\",\"datatype\":\"string\"}]}"}]], ["or", ["or", {"match": null, "name": null, "type": "code", "value": "function dateFormat(date){var formatted = \"\";date.split('').map(function(d, i){ i === 1 || i === 3 ? formatted += d+\"/\" :  formatted+= d;}); return formatted;}\n(function(){\nvar behavior = optimizely.get('behavior');\nvar res =  behavior.query({\"version\": \"0.2\", \"filter\" : [{ \"field\":[\"type\"], \"value\":\"pageview\"},{ \"field\":[\"name\"], \"value\":\"1912722625_shopping_funnel\"}]});\nvar data = res[res.length -1].tags;\nvar params = JSON.parse('{\"' + decodeURI(data.url.substring(data.url.indexOf('?')+1)).replace(/\"/g, '\\\\\"').replace(/&/g, '\",\"').replace(/=/g,'\":\"') + '\"}')\nif(new Date(dateFormat(params.sailDate)).getFullYear() < 2022)\nreturn params.durDays < 8;\nelse\nreturn true\n})()"}]]]}, {"id": "16147010856", "name": "NEW RMKT | Search Abandoner", "conditions": ["and", ["or", ["or", {"match": null, "name": "event", "type": "behavior", "value": "{\"version\":\"0.1\",\"source\":\"events\",\"action\":{\"type\":\"pageview\",\"value\":\"1912722625_shopping_funnel\"},\"time\":{\"type\":\"last_days\",\"days\":30},\"count\":{\"comparator\":\"gte\",\"value\":1},\"filters\":[{\"name\":\"page_name\",\"comparator\":\"eq\",\"value\":\"carnival.com:search_results:search_results1\",\"modifier\":\"most_recent\",\"datatype\":\"string\"}]}"}]], ["or", ["or", {"match": null, "name": "event", "type": "behavior", "value": "{\"version\":\"0.1\",\"source\":\"events\",\"action\":{\"type\":\"custom\",\"value\":\"Search Filters\"},\"time\":{\"type\":\"last_days\",\"days\":30},\"count\":{\"comparator\":\"gte\",\"value\":1},\"filters\":[{\"name\":\"url\",\"comparator\":\"contains\",\"value\":\"dest=\",\"modifier\":\"most_recent\",\"datatype\":\"custom\"}]}"}], ["or", {"match": null, "name": "event", "type": "behavior", "value": "{\"version\":\"0.1\",\"source\":\"events\",\"action\":{\"type\":\"custom\",\"value\":\"Search Filters\"},\"time\":{\"type\":\"last_days\",\"days\":30},\"count\":{\"comparator\":\"gte\",\"value\":1},\"filters\":[{\"name\":\"url\",\"comparator\":\"contains\",\"value\":\"port=\",\"modifier\":\"most_recent\",\"datatype\":\"custom\"}]}"}]]]}, {"id": "16910890434", "name": "Logged in", "conditions": ["and", ["or", ["or", {"match": "substring", "name": "cclSession", "type": "cookies", "value": "IsAuthenticated"}]]]}, {"id": "17702130275", "name": "VIFP Tiers Red, Gold or Platinum", "conditions": ["and", ["or", ["or", {"match": null, "name": null, "type": "code", "value": "vifpTier == 01 || vifpTier == 02 || vifpTier == 03"}]]]}, {"id": "17778270566", "name": "Tablet", "conditions": ["and", ["or", ["or", {"match": null, "name": null, "type": "device", "value": "ipad"}, {"match": null, "name": null, "type": "device", "value": "tablet"}]]]}, {"id": "19057934687", "name": "Roy's Test Cookie", "conditions": ["and", ["or", ["or", {"match": "exact", "name": "royroy", "type": "cookies", "value": "test"}], ["or", {"match": "exact", "name": "royroy", "type": "query", "value": "test"}]]]}, {"id": "19886510107", "name": "RMKTG Itinerary Abandoner FAC ", "conditions": ["and", ["or", ["or", {"match": null, "name": "event", "type": "behavior", "value": "{\"version\":\"0.1\",\"source\":\"events\",\"action\":{\"type\":\"pageview\",\"value\":\"1912722625_shopping_funnel\"},\"time\":{\"type\":\"last_days\",\"days\":30},\"count\":{\"comparator\":\"gte\",\"value\":1},\"filters\":[{\"name\":\"page_name\",\"comparator\":\"contains\",\"value\":\"carnival.com:itinerary\",\"modifier\":\"most_recent\",\"datatype\":\"string\"}]}"}]], ["or", ["or", {"match": null, "name": null, "type": "code", "value": "(function(){\nvar behavior = optimizely.get('behavior');\nvar res =  behavior.query({\n  \"version\": \"0.2\",\n  \"filter\" : [\n    {\n      \"field\":[\"type\"],\n      \"value\":\"pageview\"\n    },\n    {\n      \"field\":[\"name\"],\n      \"value\":\"1912722625_shopping_funnel\"\n    }\n  ]\n});\n\nvar data = res[res.length -1].tags\nreturn data.duration_days < 8 ? true : false;\n\n}())"}]]]}, {"id": "19994727757", "name": "Exclusion | Canary", "conditions": ["and", ["or", ["not", ["or", {"match": "exact", "name": "ccluscanary", "type": "cookies", "value": "true"}, {"match": "exact", "name": "ccl_origin", "type": "cookies", "value": "canary"}]]]]}, {"id": "20140060743", "name": "Roy's Backup Cookie", "conditions": ["and", ["or", ["or", {"match": "exact", "name": "roy2", "type": "cookies", "value": "test2"}], ["or", {"match": "exact", "name": "roy2", "type": "query", "value": "test2"}]]]}, {"id": "20221400120", "name": "roy test cookie exclusion", "conditions": ["and", ["or", ["not", ["or", {"match": "exact", "name": "royroy", "type": "cookies", "value": "test"}]]], ["or", ["not", ["or", {"match": "exact", "name": "royroy", "type": "query", "value": "test"}]]]]}, {"id": "28377410507", "name": "Casino Media Initiative", "conditions": ["and", ["or", ["or", {"match": "exact", "name": "utm_source", "type": "query", "value": "casino"}]], ["or", ["or", {"match": "exact", "name": "utm_medium", "type": "query", "value": "paid_media"}]], ["or", ["or", {"match": "substring", "name": "utm_campaign", "type": "query", "value": "broadbase_"}]]]}, {"id": "29240640094", "name": "CRM Media Initiative", "conditions": ["and", ["or", ["or", {"match": "exact", "name": "utm_source", "type": "query", "value": "crm_ooa"}], ["or", {"match": "exact", "name": "utm_source", "type": "query", "value": "crm_prq"}]], ["or", ["or", {"match": "exact", "name": "utm_medium", "type": "query", "value": "paid_media"}]]]}, {"id": "30450710279", "name": "Un-Recognized User", "conditions": ["and", ["or", ["or", {"match": null, "name": null, "type": "code", "value": "typeof pastGuestNum == \"undefined\" || pastGuestNum == null "}]], ["or", ["not", ["or", {"match": "exists", "name": "vifp", "type": "query", "value": ""}]]], ["or", ["not", ["or", {"match": "exists", "name": "vifpnum", "type": "query", "value": ""}]]], ["or", ["not", ["or", {"match": "exists", "name": "cclSession", "type": "cookies", "value": ""}]]], ["or", ["not", ["or", {"match": "exists", "name": "cclUser", "type": "cookies", "value": null}]]]]}, {"id": "4527279611576320", "name": "Exclusion|Nov. Broadbase '24 | Casino", "conditions": ["and", ["or", ["not", ["or", {"match": null, "name": null, "type": "dynamic_customer_profile", "value": "{\"dcpServiceId\":11191843588,\"rule\":{\"where\":[\"and\",[\"or\",{\"op\":\"eq\",\"args\":[{\"field\":[\"5282846651187200\",\"4965647730343936\"]},{\"value\":\"PMW\"}]}]]}}"}]]], ["or", ["not", ["or", {"match": null, "name": null, "type": "dynamic_customer_profile", "value": "{\"dcpServiceId\":11191843588,\"rule\":{\"where\":[\"and\",[\"or\",{\"op\":\"eq\",\"args\":[{\"field\":[\"5282846651187200\",\"4965647730343936\"]},{\"value\":\"FXS\"}]}]]}}"}]]], ["or", ["not", ["or", {"match": null, "name": null, "type": "dynamic_customer_profile", "value": "{\"dcpServiceId\":11191843588,\"rule\":{\"where\":[\"and\",[\"or\",{\"op\":\"eq\",\"args\":[{\"field\":[\"5282846651187200\",\"4965647730343936\"]},{\"value\":\"HSB\"}]}]]}}"}]]]]}, {"id": "4645538197405696", "name": "Casino| Nov PMW '24| HP", "conditions": ["and", ["or", ["or", {"match": null, "name": null, "type": "dynamic_customer_profile", "value": "{\"dcpServiceId\":11191843588,\"rule\":{\"where\":[\"and\",[\"or\",{\"op\":\"eq\",\"args\":[{\"field\":[\"5282846651187200\",\"4965647730343936\"]},{\"value\":\"PMW\"}]}]]}}"}]]]}, {"id": "4651256124276736", "name": "Casino| Nov HSB '24| HP", "conditions": ["and", ["or", ["or", {"match": null, "name": null, "type": "dynamic_customer_profile", "value": "{\"dcpServiceId\":11191843588,\"rule\":{\"where\":[\"and\",[\"or\",{\"op\":\"eq\",\"args\":[{\"field\":[\"5282846651187200\",\"4965647730343936\"]},{\"value\":\"HSB\"}]}]]}}"}]]]}, {"id": "6065805817806848", "name": "Nov. Core '24 | TGO", "conditions": ["and", ["or", ["or", {"match": null, "name": null, "type": "dynamic_customer_profile", "value": "{\"dcpServiceId\":11191843588,\"rule\":{\"where\":[\"and\",[\"or\",{\"op\":\"eq\",\"args\":[{\"field\":[\"5271970099494912\",\"6504060052832256\"]},{\"value\":11122024}]}]]}}"}]]]}, {"id": "6146101774909440", "name": "Casino| Nov FXS '24| HP", "conditions": ["and", ["or", ["or", {"match": null, "name": null, "type": "dynamic_customer_profile", "value": "{\"dcpServiceId\":11191843588,\"rule\":{\"where\":[\"and\",[\"or\",{\"op\":\"eq\",\"args\":[{\"field\":[\"5282846651187200\",\"4965647730343936\"]},{\"value\":\"FXS\"}]}]]}}"}]]]}, {"id": "6226637042221056", "name": "November Casino '24", "conditions": ["and", ["or", ["or", {"match": null, "name": null, "type": "dynamic_customer_profile", "value": "{\"dcpServiceId\":11191843588,\"rule\":{\"where\":[\"and\",[\"or\",{\"op\":\"eq\",\"args\":[{\"field\":[\"5282846651187200\",\"4816592232513536\"]},{\"value\":11042024}]}]]}}"}]]]}, {"id": "6631919954165760", "name": "Exclusion |Nov. Core '24 | TGO", "conditions": ["and", ["or", ["not", ["or", {"match": null, "name": null, "type": "dynamic_customer_profile", "value": "{\"dcpServiceId\":11191843588,\"rule\":{\"where\":[\"and\",[\"or\",{\"op\":\"eq\",\"args\":[{\"field\":[\"5271970099494912\",\"6504060052832256\"]},{\"value\":11122024}]}]]}}"}]]]]}], "listTargetingKeys": [], "visitorAttributes": [{"id": "16925776425", "datatype": "long", "name": "es_offer", "dcp_datasource_id": "16900364797"}, {"id": "17258616475", "datatype": "long", "name": "vifp_num", "dcp_datasource_id": "16900364797"}, {"id": "17470282174", "datatype": "long", "name": "vifp_num", "dcp_datasource_id": "17493491148"}, {"id": "24166670545", "datatype": "long", "name": "vifp", "dcp_datasource_id": "24226660038"}, {"id": "24170890873", "datatype": "string", "name": "part_2", "dcp_datasource_id": "24187670707"}, {"id": "24177860554", "datatype": "datetime", "name": "preference_update_date", "dcp_datasource_id": "24187670707"}, {"id": "24193370619", "datatype": "long", "name": "vifp", "dcp_datasource_id": "24187670707"}, {"id": "24194070845", "datatype": "string", "name": "part_1", "dcp_datasource_id": "24187670707"}, {"id": "24194330763", "datatype": "datetime", "name": "ccl_registration_date", "dcp_datasource_id": "24226660038"}, {"id": "24198990811", "datatype": "string", "name": "profile_flag", "dcp_datasource_id": "24226660038"}, {"id": "24200680590", "datatype": "string", "name": "preference_flag", "dcp_datasource_id": "24187670707"}, {"id": "24777870305", "datatype": "string", "name": "bookingNum", "dcp_datasource_id": "23792960066"}, {"id": "29208100290", "datatype": "string", "name": "name", "dcp_datasource_id": "29283640074"}, {"id": "29233380337", "datatype": "long", "name": "vifp_num", "dcp_datasource_id": "29283640074"}, {"id": "29289250059", "datatype": "long", "name": "date", "dcp_datasource_id": "29283640074"}, {"id": "29732850442", "datatype": "string", "name": "offer_type", "dcp_datasource_id": "29740530223"}, {"id": "29740210425", "datatype": "string", "name": "first_name", "dcp_datasource_id": "29740530223"}, {"id": "29744780308", "datatype": "long", "name": "date", "dcp_datasource_id": "29740530223"}, {"id": "29758000515", "datatype": "long", "name": "vifp_num", "dcp_datasource_id": "29740530223"}, {"id": "30146720782", "datatype": "string", "name": "homeport", "dcp_datasource_id": "30245100297"}, {"id": "30193601064", "datatype": "long", "name": "vifp_num", "dcp_datasource_id": "30245100297"}, {"id": "30212330701", "datatype": "long", "name": "date", "dcp_datasource_id": "30245100297"}, {"id": "30243280704", "datatype": "string", "name": "name", "dcp_datasource_id": "30245100297"}, {"id": "30338030630", "datatype": "string", "name": "first_name", "dcp_datasource_id": "30270321457"}, {"id": "30342880192", "datatype": "long", "name": "date", "dcp_datasource_id": "30270321457"}, {"id": "30364990403", "datatype": "string", "name": "offer_type", "dcp_datasource_id": "30270321457"}, {"id": "30368540037", "datatype": "long", "name": "vifp_num", "dcp_datasource_id": "30270321457"}, {"id": "4569671710539776", "datatype": "long", "name": "vifp_num", "dcp_datasource_id": "6594260909162496"}, {"id": "4816592232513536", "datatype": "long", "name": "date", "dcp_datasource_id": "5282846651187200"}, {"id": "4817487934521344", "datatype": "string", "name": "first_name", "dcp_datasource_id": "5282846651187200"}, {"id": "4835127298097152", "datatype": "string", "name": "name", "dcp_datasource_id": "5271970099494912"}, {"id": "4954754183331840", "datatype": "long", "name": "date", "dcp_datasource_id": "5824700077572096"}, {"id": "4965647730343936", "datatype": "string", "name": "offer_type", "dcp_datasource_id": "5282846651187200"}, {"id": "4985849075466240", "datatype": "long", "name": "date", "dcp_datasource_id": "6594260909162496"}, {"id": "5145142433153024", "datatype": "string", "name": "first_name", "dcp_datasource_id": "6594260909162496"}, {"id": "5246737384734720", "datatype": "long", "name": "vifp_num", "dcp_datasource_id": "5282846651187200"}, {"id": "5375111222525952", "datatype": "long", "name": "vifp_num", "dcp_datasource_id": "5824700077572096"}, {"id": "5932213611528192", "datatype": "string", "name": "name", "dcp_datasource_id": "5824700077572096"}, {"id": "6298143231311872", "datatype": "string", "name": "homeport", "dcp_datasource_id": "5271970099494912"}, {"id": "6504060052832256", "datatype": "long", "name": "date", "dcp_datasource_id": "5271970099494912"}, {"id": "6519590654574592", "datatype": "long", "name": "vifp_num", "dcp_datasource_id": "5271970099494912"}], "visitorIdLocator": null, "dcpServiceId": "11191843588", "dcpKeyfieldLocators": [{"dcp_datasource_id": "11204333917", "is_optimizely": true, "type": "uid", "name": ""}, {"dcp_datasource_id": "15620200354", "is_optimizely": true, "type": "uid", "name": ""}, {"dcp_datasource_id": "16900364797", "is_optimizely": false, "type": "js_variable", "name": "pastGuestNum"}, {"dcp_datasource_id": "17493491148", "is_optimizely": false, "type": "js_variable", "name": "pastGuestNum"}, {"dcp_datasource_id": "18406642650", "is_optimizely": false, "type": "js_variable", "name": "bookingNum"}, {"dcp_datasource_id": "18576342814", "is_optimizely": false, "type": "js_variable", "name": "bookingID"}, {"dcp_datasource_id": "23792960066", "is_optimizely": false, "type": "js_variable", "name": "bookingNum"}, {"dcp_datasource_id": "24187670707", "is_optimizely": false, "type": "js_variable", "name": "pastGuestNum"}, {"dcp_datasource_id": "24226660038", "is_optimizely": false, "type": "js_variable", "name": "pastGuestNum"}, {"dcp_datasource_id": "29283640074", "is_optimizely": false, "type": "js_variable", "name": "pastGuestNum"}, {"dcp_datasource_id": "29740530223", "is_optimizely": false, "type": "js_variable", "name": "pastGuestNum"}, {"dcp_datasource_id": "30245100297", "is_optimizely": false, "type": "js_variable", "name": "pastGuestNum"}, {"dcp_datasource_id": "30270321457", "is_optimizely": false, "type": "js_variable", "name": "pastGuestNum"}, {"dcp_datasource_id": "5271970099494912", "is_optimizely": false, "type": "js_variable", "name": "pastGuestNum"}, {"dcp_datasource_id": "5282846651187200", "is_optimizely": false, "type": "js_variable", "name": "pastGuestNum"}, {"dcp_datasource_id": "5824700077572096", "is_optimizely": false, "type": "js_variable", "name": "pastGuestNum"}, {"dcp_datasource_id": "6594260909162496", "is_optimizely": false, "type": "js_variable", "name": "pastGuestNum"}], "recommenderServices": [{"id": 18792543301, "idTagName": "rec__itinerary_id", "serviceVersion": 2, "recommenders": [{"id": 18823302027, "servingUrl": "https://tapi.optimizely.com/api/public_profile_attributes/18815304431/18807595109"}], "catalogUrl": "https://tapi.optimizely.com/api/public_profile_attributes/18815304431/18788804136"}], "integrationSettings": [], "views": [{"id": "9414621687", "category": "other", "apiName": "1912722625_ccl_home", "name": "Homepage", "staticConditions": ["and", ["or", {"match": "simple", "type": "url", "value": "carnival.com"}, {"match": "simple", "type": "url", "value": "https://prodpreview.carnival.com/"}]], "deactivationEnabled": false, "undoOnDeactivation": false, "tags": []}, {"id": "9431051150", "category": "other", "apiName": "1912722625_global_ccl", "name": "CCL Legacy Global Header | Exclude itinerary, search, booking & booked", "staticConditions": ["and", ["or", {"match": "substring", "type": "url", "value": "https://www.carnival.com"}, {"match": "substring", "type": "url", "value": "https://prodpreview.carnival.com/"}, {"match": "substring", "type": "url", "value": "https://www4.nonprod.carnivalcloud.net/"}], ["not", ["or", {"match": "substring", "type": "url", "value": "/booking/"}, {"match": "substring", "type": "url", "value": "/cruise-search/"}, {"match": "substring", "type": "url", "value": "/itinerary/"}, {"match": "substring", "type": "url", "value": "/booked/"}, {"match": "substring", "type": "url", "value": "https://www.carnival.com.au"}, {"match": "simple", "type": "url", "value": "https://prodpreview.carnival.com.au"}, {"match": "substring", "type": "url", "value": "/cruise-deals-2022"}]]], "deactivationEnabled": false, "undoOnDeactivation": false, "tags": []}, {"id": "9727881444", "category": "other", "apiName": "1912722625_checkout_booking_confirmation", "name": "BE | Gross Booking Confirmation Page", "staticConditions": ["and", ["or", {"match": "substring", "type": "url", "value": "/payment/bookings/confirmation"}]], "deactivationEnabled": false, "undoOnDeactivation": false, "tags": []}, {"id": "9840251783", "category": "other", "apiName": "1912722625_booked_payment_page", "name": "BG | Checkout Payment Page", "staticConditions": ["and", ["or", {"match": "substring", "type": "url", "value": "/payment/booked/checkout"}]], "deactivationEnabled": false, "undoOnDeactivation": false, "tags": [], "activationType": "dom_changed"}, {"id": "10759601551", "category": "other", "apiName": "1912722625_bg_ch__payment_confirmation_page", "name": "BG | Confirmation Page | Booked & Courtesy Hold Payment", "staticConditions": ["or", ["or", {"match": "substring", "type": "url", "value": "/payment/booked/confirmation"}]], "deactivationEnabled": false, "undoOnDeactivation": false, "tags": []}, {"id": "11408924095", "category": "other", "apiName": "1912722625_be__ch_confirmation_page", "name": "BE | CH Booking Confirmation Page", "staticConditions": ["or", ["or", {"match": "substring", "type": "url", "value": "https://www.carnival.com/payment/bookings/confirmation?t=ch"}]], "deactivationEnabled": false, "undoOnDeactivation": false, "tags": []}, {"id": "11414832791", "category": "other", "apiName": "1912722625_be__paid_booking_confirmation_page", "name": "BE | Paid Booking Confirmation Page", "staticConditions": ["or", ["or", {"match": "substring", "type": "url", "value": "https://www.carnival.com/payment/bookings/confirmation?t=bk"}, {"match": "substring", "type": "url", "value": "https://www4.nonprod.carnivalcloud.net/payment/bookings/confirmation?t=bk"}]], "deactivationEnabled": false, "undoOnDeactivation": false, "tags": [{"category": "other", "apiName": "rate_code", "locator": function($){window['optimizely'] = window['optimizely'] || [];
window['optimizely'].push({
  type: "event",
  eventName: "bookingRateCode",
  tags: {
rate_code: utag_data['qp.0rc']
  }
});
}, "locatorType": "javascript", "valueType": "string"}]}, {"id": "12339271579", "category": "other", "apiName": "1912722625_bg_bk__booked_payment_confirmation_page_non_courtesy_", "name": "BG | Confirmation Page | Paid Booking Payment", "staticConditions": ["or", ["or", {"match": "regex", "type": "url", "value": "/payment/booked/confirmation.*?t=bk"}]], "deactivationEnabled": false, "undoOnDeactivation": false, "tags": []}, {"id": "12350262730", "category": "other", "apiName": "1912722625_bg_ch__booked_courtesy_hold_payment_confirmation", "name": "BG | Confirmation Page | CH Booking Payment", "staticConditions": ["or", ["or", {"match": "regex", "type": "url", "value": "/payment/booked/confirmation.*t=ch"}]], "deactivationEnabled": false, "undoOnDeactivation": false, "tags": []}, {"id": "15110660698", "category": "other", "apiName": "14505440004_my_cruise_manager_mcm", "name": "My Cruise Manager (Prod)", "staticConditions": ["or", ["or", {"match": "simple", "type": "url", "value": "https://www.carnival.com/booked/home"}]], "deactivationEnabled": false, "undoOnDeactivation": false, "tags": [{"category": "other", "apiName": "spa_treatments__vibes", "locator": "#dropdownVal-CCLSpaSalonCMComponent", "locatorType": "css_selector", "valueType": "string"}, {"category": "other", "apiName": "shore_excursion__vibe", "locator": "#dropdownVal-CCLShoreExCMComponent", "locatorType": "css_selector", "valueType": "string"}, {"category": "other", "apiName": "gifts__vibes", "locator": "#dropdownVal-CCLSpecialOccasionCMComponent", "locatorType": "css_selector", "valueType": "string"}, {"category": "other", "apiName": "bookingnum", "locator": function($){var tagValue = window.bookingNum; 
return tagValue;
}, "locatorType": "javascript", "valueType": "string"}]}, {"id": "15112920151", "category": "other", "apiName": "14505440004_booked_payment_confirmation_page_includes_booked__co", "name": "Booked | Payment Confirmation Page (Booked & CH payments)", "staticConditions": ["or", ["or", {"match": "substring", "type": "url", "value": "/payment/booked/confirmation"}]], "deactivationEnabled": false, "undoOnDeactivation": false, "tags": []}, {"id": "15132450194", "category": "other", "apiName": "14505440004_booked_confirmation_page__ch_booking_payment_ch_paym", "name": "Booked | Payment Confirmation Page (CH payment only)", "staticConditions": ["or", ["or", {"match": "regex", "type": "url", "value": "/payment/booked/confirmation.*t=ch"}]], "deactivationEnabled": false, "undoOnDeactivation": false, "tags": []}, {"id": "15150930300", "category": "other", "apiName": "14505440004_booked_confirmation_page__paid_booking_payment", "name": "Booked | Payment Confirmation Page (Non-CH payments)", "staticConditions": ["or", ["or", {"match": "regex", "type": "url", "value": "/payment/booked/confirmation.*?t=bk"}]], "deactivationEnabled": false, "undoOnDeactivation": false, "tags": []}, {"id": "15607700392", "category": "other", "apiName": "14505440004_url_targeting_for_mcmpbsupdates", "name": "(Prod) Booking & Order Details Page", "staticConditions": ["and", ["or", {"match": "simple", "type": "url", "value": "https://www.carnival.com/booked/details"}]], "deactivationEnabled": false, "undoOnDeactivation": false, "tags": [{"category": "other", "apiName": "ship", "locator": "div:nth-of-type(2) > .h-cruise-summary-card__link", "locatorType": "css_selector", "valueType": "string"}, {"category": "other", "apiName": "cabin_type", "locator": ".h-bk-dtl-card__meta", "locatorType": "css_selector", "valueType": "string"}]}, {"id": "15789310654", "category": "other", "apiName": "1912722625_shopping_funnel", "name": "Shopping Funnel - RMKTG", "staticConditions": ["or", ["or", {"match": "substring", "type": "url", "value": "https://www.carnival.com/itinerary/"}, {"match": "substring", "type": "url", "value": "https://www.carnival.com/cruise-search"}, {"match": "substring", "type": "url", "value": "https://www.carnival.com/booking/review"}, {"match": "substring", "type": "url", "value": "https://www.carnival.com/booking/"}, {"match": "regex", "type": "url", "value": "https://www.carnival.com/#\\?"}, {"match": "substring", "type": "url", "value": "https://www.carnival.com/cruise-to"}, {"match": "substring", "type": "url", "value": "https://www.carnival.com/cruise-from"}, {"match": "simple", "type": "url", "value": "https://www.carnival.com/booking/rooms-and-guests"}, {"match": "simple", "type": "url", "value": "https://www.carnival.com/booking/qualifiers"}, {"match": "simple", "type": "url", "value": "https://www.carnival.com/booking/room-type"}]], "deactivationEnabled": false, "undoOnDeactivation": false, "tags": [{"category": "other", "apiName": "page_name", "locator": function($){var tagValue = utag_data.page_name; 
return tagValue;
}, "locatorType": "javascript", "valueType": "string"}, {"category": "other", "apiName": "stateroom_type", "locator": function($){var tagValue = utag_data.stateroom_type; 
return tagValue;
}, "locatorType": "javascript", "valueType": "string"}, {"category": "other", "apiName": "sail_date", "locator": function($){var tagValue = utag_data.sail_date; 
return tagValue;
}, "locatorType": "javascript", "valueType": "string"}, {"category": "other", "apiName": "embark_port_code", "locator": function($){var tagValue = utag_data.embk_port_code; 
return tagValue;
}, "locatorType": "javascript", "valueType": "string"}, {"category": "other", "apiName": "api_params", "locator": function($){var tagValue = utag_data.api_params; 
return tagValue;
}, "locatorType": "javascript", "valueType": "string"}, {"category": "other", "apiName": "embark_port_name", "locator": function($){var tagValue = utag_data.embk_port_name; 
return tagValue;
}, "locatorType": "javascript", "valueType": "string"}, {"category": "other", "apiName": "destination", "locator": function($){var tagValue = utag_data.dest_name; 
return tagValue;
}, "locatorType": "javascript", "valueType": "string"}, {"category": "other", "apiName": "_ship_name", "locator": function($){var tagValue = utag_data.ship_name; 
return tagValue;
}, "locatorType": "javascript", "valueType": "string"}, {"category": "other", "apiName": "itinerary_name", "locator": function($){var tagValue = utag_data.itinerary_name; 
return tagValue;
}, "locatorType": "javascript", "valueType": "string"}, {"category": "other", "apiName": "duration_days", "locator": function($){var tagValue = utag_data.dur_days; 
return tagValue;
}, "locatorType": "javascript", "valueType": "string"}, {"category": "other", "apiName": "url", "locator": function($){var tagValue = document.URL; 
return tagValue;
}, "locatorType": "javascript", "valueType": "string"}, {"category": "other", "apiName": "itin_code", "locator": function($){var tagValue = utag_data.itin_code;
return tagValue;
}, "locatorType": "javascript", "valueType": "string"}, {"category": "other", "apiName": "ship_code", "locator": function($){var tagValue = utag_data.ship_code; 
return tagValue;
}, "locatorType": "javascript", "valueType": "string"}, {"category": "other", "apiName": "num_guest", "locator": function($){var tagValue = utag_data.num_guests;
return tagValue;
}, "locatorType": "javascript", "valueType": "string"}, {"category": "other", "apiName": "destination_code", "locator": function($){var tagValue = utag_data.dest_code.trim(); 
return tagValue;
}, "locatorType": "javascript", "valueType": "string"}, {"category": "other", "apiName": "itinerary_api", "locator": function($){var _scope = angular.element(document.querySelector('[ng-controller="ItineraryController"]')).scope();
var pricing_params = _scope.itinerary.pricingSearchRequest;
var api_params = Object.keys(pricing_params).map(function(key) {return key + '=' + (pricing_params[key] === null ? '' : pricing_params[key]);}).join('&');
return api_params;
}, "locatorType": "javascript", "valueType": "string"}, {"category": "other", "apiName": "military", "locator": function($){var tagValue = document.URL.match(/Military=([^&]*)/)[1]; 
return tagValue;
}, "locatorType": "javascript", "valueType": "string"}, {"category": "other", "apiName": "senior", "locator": function($){var tagValue = document.URL.match(/Senior=([^&]*)/)[1]; 
return tagValue;
}, "locatorType": "javascript", "valueType": "string"}, {"category": "other", "apiName": "rate_code", "locator": function($){var tagValue = utag_data.rate_code; 
return tagValue;
}, "locatorType": "javascript", "valueType": "string"}, {"category": "other", "apiName": "past_guest", "locator": function($){var tagValue = document.URL.match(/PastGuest=([^&]*)/)[1];
return tagValue;
}, "locatorType": "javascript", "valueType": "string"}, {"category": "other", "apiName": "state_code", "locator": function($){var tagValue = document.URL.match(/StateCode=([^&]*)/)[1]; 
return tagValue;
}, "locatorType": "javascript", "valueType": "string"}, {"category": "other", "apiName": "sailingid", "locator": function($){var tagValue = utag.data.sailing_id; 
return tagValue;
}, "locatorType": "javascript", "valueType": "string"}, {"category": "other", "apiName": "price", "locator": "booking-button.ng-scope .number.ng-binding", "locatorType": "css_selector", "valueType": "string"}, {"category": "other", "apiName": "itin_id", "locator": function($){var tagValue = utag.data.itin_id; 
return tagValue;
}, "locatorType": "javascript", "valueType": "string"}, {"category": "other", "apiName": "stateroom_meta", "locator": function($){var tagValue = utag_data.stateroom_meta;
return tagValue;
}, "locatorType": "javascript", "valueType": "string"}, {"category": "other", "apiName": "destination_name__be", "locator": function($){var tagValue = $(".be-itin__itin").text().match(/[^(Days )$](\w+)(?= from)/)[0];
return tagValue;
}, "locatorType": "javascript", "valueType": "string"}, {"category": "other", "apiName": "port_code__dest_page", "locator": function($){if (document.querySelector("#cdc-ports .cdc-filters-tab-link-subtitle").innerHTML.match(/\w/).length>0){var tagValue = $('#ship-page-menu > div > div > a').attr("href").match(/\?ptPort=(.*)/)[1]; 
return tagValue;}
}, "locatorType": "javascript", "valueType": "string"}, {"category": "other", "apiName": "dest_code__dest_page", "locator": function($){var tagValue = $('#ship-page-menu > div > div > a').attr("href").match(/\?dest=(.*)/)[1];
return tagValue;
}, "locatorType": "javascript", "valueType": "string"}, {"category": "other", "apiName": "sailing_event_code", "locator": function($){var tagValue = utag_data.sailing_event_code; 
return tagValue;
}, "locatorType": "javascript", "valueType": "string"}, {"category": "other", "apiName": "search__dates_list", "locator": function($){var tagValue = utag_data.date_list; 
return tagValue;
}, "locatorType": "javascript", "valueType": "string"}, {"category": "other", "apiName": "specials", "locator": function($){var tagValue = "TAG_VALUE"; 
return tagValue;
}, "locatorType": "javascript", "valueType": "string"}], "activationType": "url_changed"}, {"id": "17912291569", "category": "other", "apiName": "1912722625_funnel_step__search", "name": "Funnel Step | Search", "staticConditions": ["or", ["or", {"match": "substring", "type": "url", "value": "https://www.carnival.com/cruise-search"}], ["or", {"type": "element_present", "value": ".cdc-mobile-header__show-filters .ng-binding"}], ["not", ["or", {"match": "simple", "type": "url", "value": "https://www.carnival.com/cruise-search/saved"}]]], "deactivationEnabled": true, "undoOnDeactivation": true, "tags": [], "activationType": "dom_changed"}, {"id": "17916132700", "category": "other", "apiName": "1912722625_funnel_step__booking_review_all", "name": "Funnel Step | Booking -  Review (all)", "staticConditions": ["or", ["or", {"match": "simple", "type": "url", "value": "https://www.carnival.com/booking/review"}, {"match": "regex", "type": "url", "value": "BookingEngine\\/Booking\\/Book.+#\\/room-selection\\/review"}, {"match": "regex", "type": "url", "value": "BookingEngine\\/Booking\\/Book.+#\\/recipe\\/review"}]], "deactivationEnabled": true, "undoOnDeactivation": true, "tags": [], "activationType": "url_changed"}, {"id": "17923383190", "category": "other", "apiName": "1912722625_funnel_step__deals", "name": "Funnel Step | Deals", "staticConditions": ["or", ["or", {"match": "simple", "type": "url", "value": "https://www.carnival.com/cruise-deals"}]], "deactivationEnabled": false, "undoOnDeactivation": false, "tags": []}, {"id": "17936281372", "category": "other", "apiName": "1912722625_funnel_step__booking", "name": "Funnel Step | Booking (excludes review)", "staticConditions": ["and", ["or", {"match": "substring", "type": "url", "value": "https://www.carnival.com/booking/"}, {"match": "simple", "type": "url", "value": "https://www.carnival.com/BookingEngine/Booking/Book"}], ["not", ["or", {"match": "simple", "type": "url", "value": "https://www.carnival.com/booking/review"}, {"match": "regex", "type": "url", "value": "ookingEngine\\/Booking\\/Book.+#\\/recipe\\/review"}, {"match": "regex", "type": "url", "value": "BookingEngine\\/Booking\\/Book.+#\\/room-selection\\/review"}]]], "deactivationEnabled": true, "undoOnDeactivation": true, "tags": [], "activationType": "dom_changed"}, {"id": "17938250293", "category": "other", "apiName": "1912722625_funnel_step__itinerary", "name": "Funnel Step | Itinerary", "staticConditions": ["or", ["or", {"match": "substring", "type": "url", "value": "https://www.carnival.com/itinerary"}]], "deactivationEnabled": false, "undoOnDeactivation": false, "tags": []}, {"id": "17947540598", "category": "other", "apiName": "1912722625_funnel_step__booking_all_inclusive", "name": "Funnel Step | Booking (all inclusive)", "staticConditions": ["or", ["or", {"match": "substring", "type": "url", "value": "https://www.carnival.com/booking/"}, {"match": "simple", "type": "url", "value": "https://www.carnival.com/BookingEngine/Booking/Book"}]], "deactivationEnabled": true, "undoOnDeactivation": false, "tags": [], "activationType": "url_changed"}, {"id": "17951051318", "category": "other", "apiName": "1912722625_funnel_step__booking_review__quick_book_only", "name": "Funnel Step | Booking - Quick Book Review ", "staticConditions": ["or", ["or", {"match": "regex", "type": "url", "value": "https://www.carnival.com/booking/review.+qbPrice.+"}]], "deactivationEnabled": true, "undoOnDeactivation": true, "tags": [], "activationType": "url_changed"}, {"id": "17953090324", "category": "other", "apiName": "1912722625_funnel_step__checkout_guest__payment_info", "name": "Funnel Step | Checkout (guest & payment info)", "staticConditions": ["or", ["or", {"match": "substring", "type": "url", "value": "/payment/bookings/checkout/"}]], "deactivationEnabled": true, "undoOnDeactivation": true, "tags": [], "activationType": "url_changed"}, {"id": "18293125642", "category": "other", "apiName": "14505440004_prod_planner_page", "name": "(Prod) Planner Page", "staticConditions": ["or", ["or", {"match": "simple", "type": "url", "value": "https://www.carnival.com/booked/planner"}]], "deactivationEnabled": false, "undoOnDeactivation": false, "tags": []}, {"id": "19573957180", "category": "other", "apiName": "1912722625_non_prod_homepage", "name": "TST4 Homepage", "staticConditions": ["or", ["or", {"match": "simple", "type": "url", "value": "https://www4.nonprod.carnivalcloud.net/"}]], "deactivationEnabled": false, "undoOnDeactivation": false, "tags": []}, {"id": "20742590357", "category": "other", "apiName": "1912722625_log_in_modal", "name": "Log in Modal", "staticConditions": ["and", ["or", {"type": "element_present", "value": ".ReactModal__Content--after-open .lr-account-exists, .ReactModal__Content--after-open .lr-view.lr-login, .ReactModal__Content--after-open .lr-view.lr-register, .ReactModal__Content--after-open .lr-view.lr-forgot-password, .ReactModal__Content--after-open .lr-view.lr-forgot-username, .ReactModal__Content--after-open .lr-view.lr-complete-profile, .ReactModal__Content--after-open .lr-view.lr-next-steps, .ReactModal__Content--after-open .lr-add-booking"}], ["or", {"match": "substring", "type": "url", "value": "carnival.com"}, {"match": "substring", "type": "url", "value": "www4.nonprod.carnivalcloud.net"}], ["not", ["or", {"match": "substring", "type": "url", "value": "https://www.carnival.com/profilemanagement/accounts/"}]]], "deactivationEnabled": true, "undoOnDeactivation": true, "tags": [], "activationType": "dom_changed"}, {"id": "20809380273", "category": "other", "apiName": "1912722625_mobile_hamburger_menu", "name": "Mobile hamburger menu", "staticConditions": ["and", ["or", {"match": "substring", "type": "url", "value": "www.carnival.com"}], ["or", {"type": "element_present", "value": ".cgh-header__main-menu.cgh-visible"}]], "deactivationEnabled": true, "undoOnDeactivation": false, "tags": [], "activationType": "dom_changed"}, {"id": "21470231932", "category": "other", "apiName": "1912722625_all_carnival_pages", "name": "All Carnival Pages", "staticConditions": ["and", ["or", {"match": "substring", "type": "url", "value": "www.carnival.com"}, {"match": "substring", "type": "url", "value": "https://www.carnival.com"}]], "deactivationEnabled": false, "undoOnDeactivation": false, "tags": []}, {"id": "21525550068", "category": "other", "apiName": "1912722625_funnel_step__booking__review_exclude_quick_book", "name": "Funnel Step | Booking - Review (exclude quick book)", "staticConditions": ["and", ["or", {"match": "simple", "type": "url", "value": "https://www.carnival.com/booking/review"}], ["not", ["or", {"match": "regex", "type": "url", "value": "qbPrice.+"}]]], "deactivationEnabled": true, "undoOnDeactivation": true, "tags": [], "activationType": "url_changed"}], "events": [{"id": "9866542270", "viewId": "9431051150", "name": "Click | Mobile Login link", "category": "other", "apiName": "1912722625_click__mobile_login_link", "eventType": "click", "eventFilter": {"filterType": "target_selector", "selector": "#login_281"}}, {"id": "9994059473", "viewId": "9414621687", "name": "Click | H1 Hero Mobile (incl exts - updated 2.5.20)", "category": "other", "apiName": "1912722625_click__h1_hero_mobile", "eventType": "click", "eventFilter": {"filterType": "target_selector", "selector": ".hero-header-mobile"}}, {"id": "10087413450", "viewId": "9431051150", "name": "Click | Global Nav - Search icon", "category": "other", "apiName": "1912722625_click__global_nav__search_icon", "eventType": "click", "eventFilter": {"filterType": "target_selector", "selector": ".header-nav li.search"}}, {"id": "10315197162", "viewId": "9431051150", "name": "Click | Desktop | Sign up Banner", "category": "other", "apiName": "1912722625_click__desktop__lcb_tgo_banner", "eventType": "click", "eventFilter": {"filterType": "target_selector", "selector": "#LCB_TGO"}}, {"id": "10315486053", "viewId": "9414621687", "name": "Click | Desktop VIFP LCB Bar", "category": "other", "apiName": "1912722625_click__lcb_tgo_banner", "eventType": "click", "eventFilter": {"filterType": "target_selector", "selector": "#LCB_TGO a:not(.close)"}}, {"id": "10427782522", "viewId": "9431051150", "name": "Click | Search - Booking Module | Book Now", "category": "other", "apiName": "1912722625_click__search__booking_module__book_now", "eventType": "click", "eventFilter": {"filterType": "target_selector", "selector": ".mrd-quick-book__quick-book-button"}}, {"id": "10467777364", "viewId": "9431051150", "name": "Click | Mobile | Engaged Shopper", "category": "other", "apiName": "1912722625_click__mobile__engaged_shopper", "eventType": "click", "eventFilter": {"filterType": "target_selector", "selector": "#mbl_es"}}, {"id": "10491491011", "viewId": "9431051150", "name": "Click | Desktop | Engaged Shopper", "category": "other", "apiName": "1912722625_click__desktop__engaged_shopper", "eventType": "click", "eventFilter": {"filterType": "target_selector", "selector": "#LCB_ES"}}, {"id": "11085685676", "viewId": null, "name": "[AA] Tealium Audience Load Time", "category": "other", "apiName": "carvAA_tealium_audience_load", "eventType": "custom", "eventFilter": null}, {"id": "11359284380", "viewId": "9414621687", "name": "Clicks | B1 Tile", "category": "other", "apiName": "1912722625_clicks__hp_b1_tile", "eventType": "click", "eventFilter": {"filterType": "target_selector", "selector": "#adTile1"}}, {"id": "11786070154", "viewId": "9414621687", "name": "Click | Red Search Button | Mobile", "category": "other", "apiName": "1912722625_click__mobile_red_search_button_", "eventType": "click", "eventFilter": {"filterType": "target_selector", "selector": "button#search"}}, {"id": "11799210631", "viewId": "9414621687", "name": "Clicks | B2 Tile", "category": "other", "apiName": "1912722625_clicks__adtile_2", "eventType": "click", "eventFilter": {"filterType": "target_selector", "selector": "#adTile2"}}, {"id": "12839820275", "viewId": "9414621687", "name": "Click | B-tile group", "category": "other", "apiName": "1912722625_click__btile_group", "eventType": "click", "eventFilter": {"filterType": "target_selector", "selector": "#toutsContainer2013"}}, {"id": "14156880156", "viewId": "9414621687", "name": "Mobile | Butter Bar with extension", "category": "other", "apiName": "1912722625_mobile__butter_bar_with_extension", "eventType": "click", "eventFilter": {"filterType": "target_selector", "selector": "#ccl-mainContainer > div.bannerMobOpt > div"}}, {"id": "15060270230", "viewId": "9414621687", "name": "Click | Mobile VIFP LCB Bar", "category": "other", "apiName": "1912722625_click__mobile_vifp_sign_up_1", "eventType": "click", "eventFilter": {"filterType": "target_selector", "selector": "#lcb-vifp-mbl a"}}, {"id": "15277030506", "viewId": "9431051150", "name": "Global RMKTG BB", "category": "other", "apiName": "1912722625_rmktg_bb", "eventType": "click", "eventFilter": {"filterType": "target_selector", "selector": ".rmktBB"}}, {"id": "15691170310", "viewId": "9414621687", "name": "Click | Close TGO popup", "category": "other", "apiName": "1912722625_close_tgo_popup", "eventType": "click", "eventFilter": {"filterType": "target_selector", "selector": "#closeTgo"}}, {"id": "16147960210", "viewId": "9414621687", "name": "Click | Desktop - Extensions Butter Bar", "category": "other", "apiName": "1912722625_extensions_butter_bar", "eventType": "click", "eventFilter": {"filterType": "target_selector", "selector": ".butter-bar"}}, {"id": "16248820706", "viewId": "9414621687", "name": "Click | claim offer btn", "category": "other", "apiName": "1912722625_click__popup_sign_up_1_1", "eventType": "click", "eventFilter": {"filterType": "target_selector", "selector": ".vifp-sweeps-modal-button"}}, {"id": "16673740057", "viewId": "9414621687", "name": "Click | B3 Tile", "category": "other", "apiName": "1912722625_click__b3_tile", "eventType": "click", "eventFilter": {"filterType": "target_selector", "selector": "#adTile3"}}, {"id": "16745080504", "viewId": "9414621687", "name": "Click | H1 Hero Desktop (incl exts - updated 2.5.20)", "category": "other", "apiName": "1912722625_click__h1_desktop", "eventType": "click", "eventFilter": {"filterType": "target_selector", "selector": ".hero-header"}}, {"id": "17264120455", "viewId": "9414621687", "name": "Click | View RMKT Pop-up", "category": "other", "apiName": "1912722625_click__view_itin_popup", "eventType": "click", "eventFilter": {"filterType": "target_selector", "selector": ".popUpRmktBB"}}, {"id": "17265940252", "viewId": "9414621687", "name": "RMKT Pop-up Close", "category": "other", "apiName": "1912722625_itin_popup_close", "eventType": "click", "eventFilter": {"filterType": "target_selector", "selector": "#closeRmkt"}}, {"id": "17468130118", "viewId": "9414621687", "name": "Click | HP Itinerary Carousel", "category": "other", "apiName": "1912722625_click__hp_itinerary_carousel", "eventType": "click", "eventFilter": {"filterType": "target_selector", "selector": ".hch-component"}}, {"id": "17836090367", "viewId": "9414621687", "name": "Click | Itinerary Carousel (Optimizely Carousel)", "category": "other", "apiName": "1912722625_click__itinerary_carousel_optimizely_carousel", "eventType": "click", "eventFilter": {"filterType": "target_selector", "selector": ".itinCard"}}, {"id": "17950950731", "viewId": "9414621687", "name": "Click | HP | Mobile B Tiles", "category": "other", "apiName": "1912722625_click__hp__mobile_b_tiles", "eventType": "click", "eventFilter": {"filterType": "target_selector", "selector": "#ccl-mainContainer > div.js-home-promo.js-hero-banners-personalizer-target"}}, {"id": "17982131038", "viewId": "9414621687", "name": "Click | OBA Carousel 1", "category": "other", "apiName": "1912722625_click__oba_carousel_1", "eventType": "click", "eventFilter": {"filterType": "target_selector", "selector": ".carouselItin .obaDinCarousel1"}}, {"id": "17989680270", "viewId": "9414621687", "name": "Click | Din Carousel 2", "category": "other", "apiName": "1912722625_click__din_carousel_2", "eventType": "click", "eventFilter": {"filterType": "target_selector", "selector": ".carouselItin .obaDinCarousel2"}}, {"id": "18049821531", "viewId": "9414621687", "name": "Click | CH Hero (desktop + mobile)", "category": "other", "apiName": "1912722625_click__ch_hero_desktop__mobile", "eventType": "click", "eventFilter": {"filterType": "target_selector", "selector": "[data-rulelist-title=\"courtesy-hold\"]"}}, {"id": "18057730693", "viewId": "9414621687", "name": "Click | CH Hero desktop", "category": "other", "apiName": "1912722625_click__ch_hero_desktop", "eventType": "click", "eventFilter": {"filterType": "target_selector", "selector": "li[data-rulelist-title=\"courtesy-hold\"]"}}, {"id": "18059261800", "viewId": "9414621687", "name": "Click | CH hero mobile", "category": "other", "apiName": "1912722625_click__ch_hero_mobile", "eventType": "click", "eventFilter": {"filterType": "target_selector", "selector": "div[data-rulelist-title=\"courtesy-hold\"]"}}, {"id": "18117120373", "viewId": "9414621687", "name": "Click | What's Included Categories", "category": "other", "apiName": "1912722625_click__whats_included_categories", "eventType": "click", "eventFilter": {"filterType": "target_selector", "selector": ".wi-categories"}}, {"id": "18134392218", "viewId": "9414621687", "name": "C-Tile", "category": "other", "apiName": "1912722625_ctile", "eventType": "click", "eventFilter": {"filterType": "target_selector", "selector": ".sec-banner"}}, {"id": "18145950794", "viewId": "9414621687", "name": "Click | TGO Pop-Up Destop", "category": "other", "apiName": "1912722625_click__tgo_popup_all", "eventType": "click", "eventFilter": {"filterType": "target_selector", "selector": ".popUpTgoBB"}}, {"id": "18153241723", "viewId": "9414621687", "name": "Click | TGO PopUp Mobile", "category": "other", "apiName": "1912722625_click__tgo_popup_mobile", "eventType": "click", "eventFilter": {"filterType": "target_selector", "selector": ".popUpTgo"}}, {"id": "18209672635", "viewId": "9414621687", "name": "Click | Recently viewed w/pricedrop", "category": "other", "apiName": "1912722625_click__recently_viewed_wpricedrop", "eventType": "click", "eventFilter": {"filterType": "target_selector", "selector": ".pricedrop"}}, {"id": "19320350413", "viewId": "9414621687", "name": "Click | RMKT Ctile", "category": "other", "apiName": "1912722625_click__rmkt_ctile", "eventType": "click", "eventFilter": {"filterType": "target_selector", "selector": ".rmktg__cta"}}, {"id": "19321880385", "viewId": "9414621687", "name": "Click | Close RMKT Ctile", "category": "other", "apiName": "1912722625_click__close_rmkt_ctile", "eventType": "click", "eventFilter": {"filterType": "target_selector", "selector": ".rmktg__close"}}, {"id": "19946670103", "viewId": "9414621687", "name": "Click | Uplift Prequal CTA (homepage)", "category": "other", "apiName": "1912722625_click__uplift_prequal_module", "eventType": "click", "eventFilter": {"filterType": "target_selector", "selector": "[data-up-prequal]"}}, {"id": "19974960773", "viewId": "17912291569", "name": "Click | Uplift Prequal CTA (search)", "category": "other", "apiName": "1912722625_click__uplift_prequal_module_search", "eventType": "click", "eventFilter": {"filterType": "target_selector", "selector": "[data-up-prequal]"}}, {"id": "20011497725", "viewId": "9414621687", "name": "Click | Search Cruises FAC", "category": "other", "apiName": "1912722625_click__search_cruises_fac", "eventType": "click", "eventFilter": {"filterType": "target_selector", "selector": "li.ng-scope > .cdc-filters-search-cta"}}, {"id": "20033560056", "viewId": "9414621687", "name": "Click | Mobile FAC Search Cruises CTA", "category": "other", "apiName": "1912722625_click__mobile_fac_search_cruises_cta", "eventType": "click", "eventFilter": {"filterType": "target_selector", "selector": ".cdc-filters-search-cta.ng-scope"}}, {"id": "20098340214", "viewId": "9840251783", "name": "Click | Booked | Select Easy Pay", "category": "other", "apiName": "1912722625_click__easy_pay", "eventType": "click", "eventFilter": {"filterType": "target_selector", "selector": "#des-opt-btn-installments"}}, {"id": "20135700667", "viewId": "9414621687", "name": "Click | Mobile b1 tile", "category": "other", "apiName": "1912722625_click__mobile_b1_tile", "eventType": "click", "eventFilter": {"filterType": "target_selector", "selector": "#ccl-mainContainer > div.js-home-promo.js-hero-banners-personalizer-target > div:nth-child(1)"}}, {"id": "20157050200", "viewId": "9414621687", "name": "Click | Mobile H2", "category": "other", "apiName": "1912722625_click__mobile_h2", "eventType": "click", "eventFilter": {"filterType": "target_selector", "selector": "#hero2"}}, {"id": "20252900123", "viewId": "9414621687", "name": "Click | No Thank You", "category": "other", "apiName": "1912722625_click__no_thank_you", "eventType": "click", "eventFilter": {"filterType": "target_selector", "selector": ".vifp-no-thankyou"}}, {"id": "20438579820", "viewId": "9414621687", "name": "Click | Shaq Close", "category": "other", "apiName": "1912722625_click__shaq_close", "eventType": "click", "eventFilter": {"filterType": "target_selector", "selector": "#closeshaq"}}, {"id": "21355830274", "viewId": "9414621687", "name": "Click | TGO Close 2", "category": "other", "apiName": "1912722625_click__tgo_close_2", "eventType": "click", "eventFilter": {"filterType": "target_selector", "selector": "#tgo-close-e"}}, {"id": "22853850282", "viewId": null, "name": "Search Filters", "category": "other", "apiName": "Search Filters", "eventType": "custom", "eventFilter": null}, {"id": "22996030010", "viewId": "9414621687", "name": "Click | Desktop C-Tile C1", "category": "other", "apiName": "1912722625_click__desktop_ctile_c1", "eventType": "click", "eventFilter": {"filterType": "target_selector", "selector": ".sec-banner:nth-of-type(1)"}}, {"id": "24380790888", "viewId": "9414621687", "name": "G2| click tracks", "category": "other", "apiName": "1912722625_g2_click_tracks", "eventType": "click", "eventFilter": {"filterType": "target_selector", "selector": ".g2"}}, {"id": "24384600414", "viewId": "9414621687", "name": "G3| click tracks", "category": "other", "apiName": "1912722625_g3_click_tracks", "eventType": "click", "eventFilter": {"filterType": "target_selector", "selector": ".g3"}}, {"id": "24399300230", "viewId": "9414621687", "name": "G5| click tracks", "category": "other", "apiName": "1912722625_g5_click_tracks_1", "eventType": "click", "eventFilter": {"filterType": "target_selector", "selector": ".g5"}}, {"id": "24406500299", "viewId": "9414621687", "name": "G1| click tracks", "category": "other", "apiName": "1912722625_g1_click_tracks", "eventType": "click", "eventFilter": {"filterType": "target_selector", "selector": ".g1"}}, {"id": "24428210019", "viewId": "9414621687", "name": "G4| click tracks", "category": "other", "apiName": "1912722625_g5_click_tracks", "eventType": "click", "eventFilter": {"filterType": "target_selector", "selector": ".g4"}}, {"id": "24926540307", "viewId": "15110660698", "name": "MCM - Spa Reserve Now Button", "category": "other", "apiName": "14505440004_mcm__spa_reserve_now_button", "eventType": "click", "eventFilter": {"filterType": "target_selector", "selector": ".promo-banner-link"}}, {"id": "24932660440", "viewId": "15110660698", "name": "MCM - Spa Image", "category": "other", "apiName": "14505440004_mcm__spa_image", "eventType": "click", "eventFilter": {"filterType": "target_selector", "selector": ".image-full-width"}}, {"id": "24943370358", "viewId": "15110660698", "name": "MCM - Spa Total Category Element", "category": "other", "apiName": "14505440004_mcm__spa_total_category_element", "eventType": "click", "eventFilter": {"filterType": "target_selector", "selector": "#section-CCLSpaSalonCMComponent"}}, {"id": "24945530229", "viewId": "15110660698", "name": "MCM - Spa More Details Button", "category": "other", "apiName": "14505440004_mcm__spa_more_details", "eventType": "click", "eventFilter": {"filterType": "target_selector", "selector": ".single-carousel-type .general-more-details-btn"}}, {"id": "24953260506", "viewId": "15110660698", "name": "MCM - Spa View All Link", "category": "other", "apiName": "14505440004_mcm__view_all_spa__salon", "eventType": "click", "eventFilter": {"filterType": "target_selector", "selector": ".link-CCLSpaSalonCMComponent"}}, {"id": "24956960360", "viewId": "15110660698", "name": "MCM - Spa Dropdown Link", "category": "other", "apiName": "14505440004_mcm__spa_dropdown", "eventType": "click", "eventFilter": {"filterType": "target_selector", "selector": "#dropdownBtn-CCLSpaSalonCMComponent"}}, {"id": "24958010109", "viewId": "15110660698", "name": "MCM - Spa ATC Button", "category": "other", "apiName": "14505440004_mcm__spa_atc", "eventType": "click", "eventFilter": {"filterType": "target_selector", "selector": ".CCLSpaSalonCMComponent_cartBtn1"}}, {"id": "24965270013", "viewId": "15110660698", "name": "MCM - Spa Banner Total Element", "category": "other", "apiName": "14505440004_mcm__spa_banner_total_element", "eventType": "click", "eventFilter": {"filterType": "target_selector", "selector": ".container > div:nth-of-type(1) > div:nth-of-type(7)"}}, {"id": "25211510147", "viewId": null, "name": "G4| click tracks", "category": "other", "apiName": "g4clicktracks", "eventType": "custom", "eventFilter": null}, {"id": "25418240145", "viewId": null, "name": "Votes Tile Mobile Track", "category": "other", "apiName": "track votes tile mobile", "eventType": "custom", "eventFilter": null}, {"id": "25418690043", "viewId": "9414621687", "name": "points guy c tile mobile clicks", "category": "other", "apiName": "1912722625_points_guy_c_tile_mobile_clicks", "eventType": "click", "eventFilter": {"filterType": "target_selector", "selector": "#optimizely-extension-35917EA5-8D86-4811-B19D-9B49D54D9CFE"}}, {"id": "25419800079", "viewId": "9414621687", "name": "Points guy c tile clicks desktop", "category": "other", "apiName": "1912722625_points_guy_c_tile_clicks", "eventType": "click", "eventFilter": {"filterType": "target_selector", "selector": "#optimizely-extension-5F35F8C5-74F3-49B2-9AF4-03BA1DB180FE"}}, {"id": "26661360508", "viewId": "9414621687", "name": "Click | TGO Close MC", "category": "other", "apiName": "1912722625_click__tgo_close_mc", "eventType": "click", "eventFilter": {"filterType": "target_selector", "selector": "#tgo-close-mc"}}, {"id": "27274460660", "viewId": "9431051150", "name": "Legacy Mitigation Modal Close CTA", "category": "other", "apiName": "1912722625_legacy_mitigation_modal_close_cta", "eventType": "click", "eventFilter": {"filterType": "target_selector", "selector": ".migitation-close-cta"}}, {"id": "27276410373", "viewId": "9414621687", "name": "Click | butter bar  RWv5PkGmyorX2qyfW6uAo", "category": "other", "apiName": "1912722625_click__butter_bar__RWv5PkGmyorX2qyfW6uAo", "eventType": "click", "eventFilter": {"filterType": "target_selector", "selector": ".butterBar"}}, {"id": "27295560686", "viewId": "9431051150", "name": "Mitigation Modal Manage My Booking CTA", "category": "other", "apiName": "1912722625_mitigation_modal_manage_my_booking_cta_2", "eventType": "click", "eventFilter": {"filterType": "target_selector", "selector": ".migitation-mmb-cta"}}, {"id": "27296180640", "viewId": "9431051150", "name": "Legacy Mitigation Modal Continue CTA", "category": "other", "apiName": "1912722625_mitigation_modal_continue_cta", "eventType": "click", "eventFilter": {"filterType": "target_selector", "selector": ".migitation-continue-cta"}}, {"id": "27297670396", "viewId": "9414621687", "name": "Casino: Click on BB UgSvzcSYecJXLqJnbszWM", "category": "other", "apiName": "1912722625_casino_click_on_bb_UgSvzcSYecJXLqJnbszWM", "eventType": "click", "eventFilter": {"filterType": "target_selector", "selector": "#LCB_TGO"}}, {"id": "27301410445", "viewId": "9414621687", "name": "Click: Deal BB Card CTA  Abve3C2CfCUBWXVoaYTSp", "category": "other", "apiName": "1912722625_click_deal_bb_card_cta__Abve3C2CfCUBWXVoaYTSp", "eventType": "click", "eventFilter": {"filterType": "target_selector", "selector": ".dealCardCta"}}, {"id": "27353140487", "viewId": "9431051150", "name": "Legacy Mitigation Modal Manage My Booking CTA", "category": "other", "apiName": "1912722625_mitigation_modal_manage_my_booking_cta", "eventType": "click", "eventFilter": {"filterType": "target_selector", "selector": ".migitation-mmb-cta"}}, {"id": "27363510062", "viewId": "9414621687", "name": "Click | BB - See More Deals  6noYcAdGc9GxE1ZucrCsg", "category": "other", "apiName": "1912722625_see_more_deals__6noYcAdGc9GxE1ZucrCsg", "eventType": "click", "eventFilter": {"filterType": "target_selector", "selector": ".seeMoreDeals"}}, {"id": "27676630654", "viewId": "17912291569", "name": "Click | Military Filter", "category": "other", "apiName": "1912722625_click__military_filter", "eventType": "click", "eventFilter": {"filterType": "target_selector", "selector": "div:nth-of-type(3) .kvaffO"}}, {"id": "28246880018", "viewId": "9414621687", "name": "Tile 1", "category": "other", "apiName": "1912722625_tile_1", "eventType": "click", "eventFilter": {"filterType": "target_selector", "selector": ".tile1"}}, {"id": "28289060015", "viewId": "9414621687", "name": "Tile 2", "category": "other", "apiName": "1912722625_tile_2", "eventType": "click", "eventFilter": {"filterType": "target_selector", "selector": ".tile2"}}, {"id": "28732760106", "viewId": "20742590357", "name": "Click - Login Submit", "category": "other", "apiName": "1912722625_click__login_submit", "eventType": "click", "eventFilter": {"filterType": "target_selector", "selector": ".lr-login .lrc-submit-button"}}, {"id": "29219610205", "viewId": "9431051150", "name": "Original Header Deals Click", "category": "other", "apiName": "1912722625_original_header_deals_click", "eventType": "click", "eventFilter": {"filterType": "target_selector", "selector": ".cgh-menu-item-list [href=\"/cruise-deals.aspx\"]"}}, {"id": "29223950098", "viewId": "9414621687", "name": "Close Registration Pop Up", "category": "other", "apiName": "1912722625_close_registration_pop_up", "eventType": "click", "eventFilter": {"filterType": "target_selector", "selector": ".lrh-close"}}, {"id": "29246220249", "viewId": "9431051150", "name": "Old Header Login Btn Click", "category": "other", "apiName": "1912722625_old_header_login_btn_click", "eventType": "click", "eventFilter": {"filterType": "target_selector", "selector": "[data-testid=\"login\"], .navLoginContainerMobile, [data-tealium-value=\"Login\"]"}}, {"id": "29255470473", "viewId": "9431051150", "name": "Deals Dropdown Click (HP, Deals, Content)", "category": "other", "apiName": "1912722625_deals_dropdown_click_hp_deals_content", "eventType": "click", "eventFilter": {"filterType": "target_selector", "selector": ".globalNavSecondaryDeals a, .navSecondaryMainContainer [href=\"/cruise-deals\"]"}}, {"id": "29262510035", "viewId": "9431051150", "name": "Click | Create Account Old Nav", "category": "other", "apiName": "1912722625_click__create_account_old_nav", "eventType": "click", "eventFilter": {"filterType": "target_selector", "selector": ".cgh-profile-menu-left [data-testid=\"create-account\"]"}}, {"id": "29269330241", "viewId": "21470231932", "name": "Click Login Button Universal", "category": "other", "apiName": "1912722625_click_login_button_universal", "eventType": "click", "eventFilter": {"filterType": "target_selector", "selector": "header [href=\"/profilemanagement/accounts/login\"], header [data-testid=\"login\"]"}}, {"id": "4897580283330560", "viewId": "9414621687", "name": "Click | Create Account Banner", "category": "other", "apiName": "1912722625_click__create_account_banner", "eventType": "click", "eventFilter": {"filterType": "target_selector", "selector": ".logInLinkCopy"}}, {"id": "5937276143271936", "viewId": "9414621687", "name": "Click | HP Pack Tile", "category": "other", "apiName": "1912722625_click__hp_pack_tile", "eventType": "click", "eventFilter": {"filterType": "target_selector", "selector": ".pack-1"}}, {"id": "6131895070097408", "viewId": "9414621687", "name": "Click | HP Grid Item", "category": "other", "apiName": "1912722625_click__hp_grid_item", "eventType": "click", "eventFilter": {"filterType": "target_selector", "selector": ".grid-item"}}, {"id": "6251604425310208", "viewId": "9414621687", "name": "Click | Resub Banner", "category": "other", "apiName": "1912722625_click__resub_banner", "eventType": "click", "eventFilter": {"filterType": "target_selector", "selector": ".logInLink"}}], "dimensions": [{"id": "12368100870", "name": "Non-Booked Guest Visit", "apiName": "bookedGuest-attribute", "segmentId": null}, {"id": "16869831238", "name": "Logged in: Authenticated ", "apiName": "authenticated_visitor", "segmentId": null}, {"id": "16887012037", "name": "Not logged in: Anonymous", "apiName": "anonymous_visitor", "segmentId": null}, {"id": "16933350133", "name": "Booked RateCode", "apiName": "bookedRatecode", "segmentId": null}, {"id": "17922651415", "name": "itineraryCode", "apiName": "itineraryCode", "segmentId": null}, {"id": "17947380521", "name": "Embarkation Port Code", "apiName": "embkPortCode", "segmentId": null}, {"id": "18261759995", "name": "Duration", "apiName": "duration", "segmentId": null}, {"id": "25037120198", "name": "Booking Num", "apiName": "bookingNum", "segmentId": null}], "projectJS": function(){/* global window, document, console */
window.optimizely = window.optimizely || [];

var PJS = {};
PJS.isDev = /cro(metrics)?-debug|optimizely_local/.test(window.location.search) || localStorage && localStorage.getItem("cro-debug");
PJS.log = PJS.isDev && console && console.info && console.info.bind(console, '[PJS]') || function () { };

try {
    (function () {
        /**
         * Local Storage Required
         * @author Eric Newland <eric@crometrics.com>
         * @author Andrew Wessels <andrew.wessels@crometrics.com>
         * Date: 2/1/18
         *
         * Disable Optimizely if localStorage isn't available.
         */
        try {
            var key = 'optimizely-store-required';
            window.localStorage.setItem(key, true);
            window.localStorage.removeItem(key);
        } catch (e) {
            //Disable Optimizely if localStorage fails.
            window.optimizely.push({
                "type": "disable"
            });
        }
    })();
} catch (e) {
    console.error('x/local-storage-required', e);
}

try {
    (function () {
        /**
         * Extend Optimizely's utils singleton with the additional methods above
         */
        var extend = function extend() {
            var utils = window.optimizely.get('utils');

            //Add the generic PJS utils to the Optimizely utils:
            for (var fnName in PJS.utils) {
                utils[fnName] = PJS.utils[fnName];
            }

            /**
             * @desc waitForjQuery() waits for window.jQuery to become available
             * @return {utils.Promise} resolves when jQuery becomes available, returns a reference
             */
            utils.waitForjQuery = function () {
                var jQueryPromise = void 0;
                return function () {
                    //lazy load the polling since it may not always be necessary
                    if (!jQueryPromise) jQueryPromise = utils.waitUntil(function () {
                        return typeof window.jQuery === 'function';
                    }).then(function () {
                        return window.jQuery;
                    });
                    return jQueryPromise;
                };
            }();
        };

        if (window.optimizely.initialized) {
            extend(); //This only happens in preview mode via Optimizely UI
        } else {
            window.optimizely.push({
                'type': 'addListener',
                'filter': {
                    'type': 'lifecycle',
                    'name': 'initialized'
                },
                'handler': extend
            });
        }
    })();
} catch (e) {
    console.error('x/pjs-utilities', e);
}

//get Query String Parameter
var getQueryParam = function (name) {
    var param = window.location.href;
    var l_param = param.toLowerCase();
    var match = l_param.match(name + '=([^&]*)');
    return match ? match[1] : undefined;
};

//get Cookie
var getCookie = function (name) {
    var match = document.cookie.match(name + '=([^;]*)');
    return match ? match[1] : undefined;
};

//Assign booking number to variable
try {
    var cookie = getCookie('cclSession');
    if (cookie) {
        window.bookingNum = JSON.parse(decodeURIComponent(cookie)).BookingNumber;
    }
}
catch (e) {
    console.log(e);
}

//Assign past guest number to variable
try {
    var cookie = getCookie('cclUser');
    var cookie2 = getCookie('TargetedOffersCookie');
    var qp = getQueryParam('vifp') || getQueryParam('vifpnum');
    if (cookie) {
        window.pastGuestNum = JSON.parse(decodeURIComponent(cookie)).PastGuestNumber;
    }
    else if (cookie2){
        window.pastGuestNum =  cookie2.match('(?<=PastGuestNumber=).*')[0];
    }
    else if (qp) {
        window.pastGuestNum = qp;
    }
}
catch (e) {
    console.log(e);
}

//Assign vifp tier to variable
try {
    var cookie = getCookie('cclUser');
    if (cookie) {
        window.vifpTier = JSON.parse(decodeURIComponent(cookie)).TierCode;
    }
}
catch (e) {
    console.log(e);
}

//6.02.2021 Assign CH values to variable for audince conditions 
try {
    var cookie = getCookie('cclCH');
    if (cookie) {
        window.itinCode = JSON.parse(decodeURIComponent(cookie)).ItineraryCode;
        window.portCode = JSON.parse(decodeURIComponent(cookie)).EmbarkationPortCode;
        window.shipCode = JSON.parse(decodeURIComponent(cookie)).ShipCode;
        window.sailingStart = JSON.parse(decodeURIComponent(cookie)).StartDate;
    }
}
catch (e) {
    console.log(e);
}


//added 10.25.19 JD custom segment for authenticated visitor
var SessionCookieExists = !!getCookie('cclSession');

//Custom Attribute for segmenting results
window.optimizely.push({
    type: "user",
    attributes: {
        "bookedGuest-attribute": localStorage.getItem("CCL_BkXp") === null && (typeof window.bookingNum == "undefined" || window.bookingNum == null),
      	"authenticated_visitor": (SessionCookieExists),
      	"anonymous_visitor":(!SessionCookieExists)
    }
});

//added 8/12/22 JD - updated protocol messagign in BE based on date
try {
  var params = window.location.search;
  var sailParams = params.match('sailDate' + '=([^&]*)');
  window.sailDate = sailParams[1];
  var input = sailDate;
}
catch (e) {
    console.log(e);
}


//added 10/19 for itin rollout canary
//try {
//     var $ = jQuery;
//     $.get( "/app-status", function( data ) {
//       if (data.version) {
//          window.canary = data.version;
//       }
//     });  
//     }
//     catch (e) {
//         console.log(e);
//     }
}, "plugins": [function(PluginManager) {
  var Hogan=function(t){function r(e){if(n[e])return n[e].exports;var i=n[e]={exports:{},id:e,loaded:!1};return t[e].call(i.exports,i,i.exports,r),i.loaded=!0,i.exports}var n={};return r.m=t,r.c=n,r.p="",r(0)}([function(t,r){function n(t){this.r=t,this.buf=""}function e(t,r){var n;if(r&&"object"==typeof r)if(void 0!==r[t])n=r[t];return n}function i(t){return String(null===t||void 0===t?"":t)}function o(t){return t=i(t),p.test(t)?t.replace(u,"&amp;").replace(f,"&lt;").replace(c,"&gt;").replace(l,"&#39;").replace(a,"&quot;"):t}t.exports=n,n.prototype={r:function(t,r,n){return""},v:o,t:i,render:function(t,r,n){return this.ri([t],r||{},n)},ri:function(t,r,n){return this.r(t,r,n)},rs:function(t,r,n){var e=t[t.length-1];if(!s(e))return void n(t,r,this);for(var i=0;i<e.length;i++)t.push(e[i]),n(t,r,this),t.pop()},s:function(t,r,n,e,i,o,u){var f;if(s(t)&&0===t.length)return!1;if(f=!!t,!e&&f&&r)r.push("object"==typeof t?t:r[r.length-1]);return f},d:function(t,r,n,i){var o,u=t.split("."),f=this.f(u[0],r,n,i),c=null;if("."===t&&s(r[r.length-2]))f=r[r.length-1];else for(var l=1;l<u.length;l++)if(o=e(u[l],f),void 0!==o)c=f,f=o;else f="";if(i&&!f)return!1;if(!i&&"function"==typeof f)r.push(c),f=this.mv(f,r,n),r.pop();return f},f:function(t,r,n,i){for(var o=!1,u=null,f=!1,c=r.length-1;c>=0;c--)if(u=r[c],o=e(t,u),void 0!==o){f=!0;break}if(!f)return i?!1:"";if(!i&&"function"==typeof o)o=this.mv(o,r,n);return o},b:function(t){this.buf+=t},fl:function(){var t=this.buf;return this.buf="",t},mv:function(t,r,n){var e=r[r.length-1],o=t.call(e);if("function"==typeof o)return this.ct(i(o.call(e)),e,n);else return o}};var u=/&/g,f=/</g,c=/>/g,l=/'/g,a=/"/g,p=/[&<>"']/,s=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)}}]);
  
PluginManager.registerWidget({
      widgetId: '15955670599',
      showFn: function(event) {
        var $ = window.optimizely.get('jquery');
        var widget = event.data.config;
        var _template = new Hogan(function(c,p,i) {var t=this;t.b(i=i||"");t.b("<button type=\"button\" class=\"cta-button ");t.b(t.v(t.d("extension.ctaHoverClass",c,p,0)));t.b("\" style=\"");t.b(t.v(t.d("extension.additionalProps",c,p,0)));t.b("\" onclick=\"location.href = '");t.b(t.v(t.d("extension.link",c,p,0)));t.b("';\">");t.b("\n" + i);t.b("  ");t.b(t.t(t.d("extension.txt",c,p,0)));t.b("\n" + i);t.b("</button>");t.b("\n");return t.fl(); })
        widget.$id = "15955670599";
        widget.$instance = event.data.id;
        widget.$render = _template.render.bind(_template)
        widget.$fieldDefaults = [{"name":"txt","default_value":"Hurry! Ends<span id=\"urgencyMsg\"> soon</span>"},{"name":"ctaHoverClass","default_value":"ctaHover"},{"name":"link","default_value":""},{"name":"additionalProps","default_value":""},{"name":"posSelector","default_value":".heroContainer"},{"name":"insertPos","default_value":"beforeend"}];
        (function(widg) {
  var i = 0;
  var field;
  for (; i < widg.$fieldDefaults.length; ++i) {
    field = widg.$fieldDefaults[i];
    if (!widg.hasOwnProperty(field.name)) {
      widg[field.name] = field.default_value;
    }
  }
  })(widget);
        widget.$html = _template.render({ widget: widget, extension: widget })
        var extension = widget;
        widget._styleTag = document.createElement('style');
widget._styleTag.id = 'widget-css-15955670599';
widget._styleTag.innerHTML = '.cta-button {  clear: both;  border-radius: 0;  font-size: 170%;  font-family: "tempo", sans-serif;  border: none;  display: inline-block;  margin: 20px 0 0 0;  padding: 16px 32px;  line-height: 1;  text-transform: uppercase;  cursor: pointer;  color: #FFF;  background: #DC1125;  border-radius: 4px;}@media only screen and (max-width: 480px) {.cta-button {	font-size: 100%;  margin: 0;	padding: 8px 24px;	}}.ctaHover:hover{  background: #BB0E1F;}';
document.getElementsByTagName('head')[0].appendChild(widget._styleTag);
        var utils = optimizely.get('utils');

utils.waitForElement(extension.posSelector)
  .then(function(elem) {
    // Prepend the extension html to the body
    elem.insertAdjacentHTML(extension.insertPos, extension.$html);
  });

utils.waitForElement('#hours, #urgencyMsg').then(function() {

  setInterval(function(){
    var hours  = $('#hours').text();
    if(hours && hours < 24){
      $('#urgencyMsg').text(' today');   
    }else if(hours && hours >= 24 && hours < 48){
      $('#urgencyMsg').text(' tomorrow'); 
    }else if(hours && hours > 48){
      $('#urgencyMsg').text(' soon'); 
    }
  },1000);
});

      },
      hideFn: function(event) {
        var $ = window.optimizely.get('jquery');
        var widget = event.data.config;
        widget.$id = "15955670599";
        widget.$instance = event.data.id;
        widget.$fieldDefaults = [{"name":"txt","default_value":"Hurry! Ends<span id=\"urgencyMsg\"> soon</span>"},{"name":"ctaHoverClass","default_value":"ctaHover"},{"name":"link","default_value":""},{"name":"additionalProps","default_value":""},{"name":"posSelector","default_value":".heroContainer"},{"name":"insertPos","default_value":"beforeend"}];
        (function(widg) {
  var i = 0;
  var field;
  for (; i < widg.$fieldDefaults.length; ++i) {
    field = widg.$fieldDefaults[i];
    if (!widg.hasOwnProperty(field.name)) {
      widg[field.name] = field.default_value;
    }
  }
  })(widget);
        var extension = widget;
        widget._styleTag = document.getElementById('widget-css-15955670599');
if (widget._styleTag) widget._styleTag.parentNode.removeChild(widget._styleTag);
        
      },
    });

PluginManager.registerWidget({
      widgetId: '20108015752',
      showFn: function(event) {
        var $ = window.optimizely.get('jquery');
        var widget = event.data.config;
        var _template = new Hogan(function(c,p,i) {var t=this;t.b(i=i||"");return t.fl(); })
        widget.$id = "20108015752";
        widget.$instance = event.data.id;
        widget.$render = _template.render.bind(_template)
        widget.$fieldDefaults = [];
        (function(widg) {
  var i = 0;
  var field;
  for (; i < widg.$fieldDefaults.length; ++i) {
    field = widg.$fieldDefaults[i];
    if (!widg.hasOwnProperty(field.name)) {
      widg[field.name] = field.default_value;
    }
  }
  })(widget);
        widget.$html = _template.render({ widget: widget, extension: widget })
        var extension = widget;
        widget._styleTag = document.createElement('style');
widget._styleTag.id = 'widget-css-20108015752';
widget._styleTag.innerHTML = '.hp-flex{display:flex!important}.hp-justify-end{justify-content:flex-end!important}.hp-justify-center{justify-content:center!important}.hp-justify-between{justify-content:space-between!important}.hp-justify-around{justify-content:space-around!important}.hp-justify-evenly{justify-content:space-evenly!important}.hp-flex-row{flex-direction:row!important}.hp-flex-row-reverse{flex-direction:row-reverse!important}.hp-flex-col{flex-direction:column!important}.hp-flex-col-reverse{flex-direction:column-reverse!important}.hp-font-tempo{font-family:tempostd,tempo,sans-serif}.hp-font-open-sans{font-family:open-sans,sans-serif!important}.hp-text-blue{color:#10559a!important}.hp-text-red{color:#DC1125!important}.hp-text-red-dark{color:#9b242f!important}.hp-text-blue-dark{color:#052049!important}.hp-text-blue-medium{color:#001260!important}.hp-text-white{color:#fff!important}.hp-text-black{color:#000!important}.hp-bg-red{background:#DC1125!important}.hp-bg-blue{background:#10559a!important}.hp-bg-blue-dark{background:#052049!important}.hp-text-left{text-align:left}.hp-text-center{text-align:center}.hp-text-right{text-align:right}.hp-items-start{align-items:flex-start}.hp-items-end{align-items:flex-end}.hp-items-center{align-items:center}.hp-items-baseline{align-items:baseline}.hp-items-stretch{align-items:stretch}.hp-content-center{align-content:center}.hp-content-start{align-content:flex-start}.hp-content-end{align-content:flex-end}.hp-content-between{align-content:space-between}.hp-content-around{align-content:space-around}.hp-content-evenly{align-content:space-evenly}.hp-m-0{margin:0 !important}.hp-m-1{margin:.25rem!important}.hp-m-2{margin:.5rem!important}.hp-m-3{margin:.75rem!important}.hp-m-4{margin:1rem!important}.hp-m-5{margin:1.25rem!important}.hp-m-6{margin:1.5rem!important}.hp-m-8{margin:2rem!important}.hp-m-10{margin:2.5rem!important}.hp-m-12{margin:3rem!important}.hp-m-16{margin:4rem!important}.hp-m-20{margin:5rem!important}.hp-m-24{margin:6rem!important}.hp-m-32{margin:8rem!important}.hp-m-40{margin:10rem!important}.hp-m-48{margin:12rem!important}.hp-m-56{margin:14rem!important}.hp-m-64{margin:16rem!important}.hp-m-auto{margin:auto!important}.hp-my-0{margin-top:0!important;margin-bottom:0!important}.hp-mx-0{margin-left:0!important;margin-right:0!important}.hp-my-1{margin-top:.25rem!important;margin-bottom:.25rem!important}.hp-mx-1{margin-left:.25rem!important;margin-right:.25rem!important}.hp-my-2{margin-top:.5rem!important;margin-bottom:.5rem!important}.hp-mx-2{margin-left:.5rem!important;margin-right:.5rem!important}.hp-my-3{margin-top:.75rem!important;margin-bottom:.75rem!important}.hp-mx-3{margin-left:.75rem!important;margin-right:.75rem!important}.hp-my-4{margin-top:1rem!important;margin-bottom:1rem!important}.hp-mx-4{margin-left:1rem!important;margin-right:1rem!important}.hp-my-5{margin-top:1.25rem!important;margin-bottom:1.25rem!important}.hp-mx-5{margin-left:1.25rem!important;margin-right:1.25rem!important}.hp-my-6{margin-top:1.5rem!important;margin-bottom:1.5rem!important}.hp-mx-6{margin-left:1.5rem!important;margin-right:1.5rem!important}.hp-my-8{margin-top:2rem!important;margin-bottom:2rem!important}.hp-mx-8{margin-left:2rem!important;margin-right:2rem!important}.hp-my-10{margin-top:2.5rem!important;margin-bottom:2.5rem!important}.hp-mx-10{margin-left:2.5rem!important;margin-right:2.5rem!important}.hp-my-12{margin-top:3rem!important;margin-bottom:3rem!important}.hp-mx-12{margin-left:3rem!important;margin-right:3rem!important}.hp-my-16{margin-top:4rem!important;margin-bottom:4rem!important}.hp-mx-16{margin-left:4rem!important;margin-right:4rem!important}.hp-my-20{margin-top:5rem!important;margin-bottom:5rem!important}.hp-mx-20{margin-left:5rem!important;margin-right:5rem!important}.hp-my-24{margin-top:6rem!important;margin-bottom:6rem!important}.hp-mx-24{margin-left:6rem!important;margin-right:6rem!important}.hp-my-32{margin-top:8rem!important;margin-bottom:8rem!important}.hp-mx-32{margin-left:8rem!important;margin-right:8rem!important}.hp-my-40{margin-top:10rem!important;margin-bottom:10rem!important}.hp-mx-40{margin-left:10rem!important;margin-right:10rem!important}.hp-my-48{margin-top:12rem!important;margin-bottom:12rem!important}.hp-mx-48{margin-left:12rem!important;margin-right:12rem!important}.hp-my-56{margin-top:14rem!important;margin-bottom:14rem!important}.hp-mx-56{margin-left:14rem!important;margin-right:14rem!important}.hp-my-64{margin-top:16rem!important;margin-bottom:16rem!important}.hp-mx-64{margin-left:16rem!important;margin-right:16rem!important}.hp-my-auto{margin-top:auto!important;margin-bottom:auto!important}.hp-mx-auto{margin-left:auto!important;margin-right:auto!important}.hp-mt-0{margin-top:0!important}.hp-mr-0{margin-right:0!important}.hp-mb-0{margin-bottom:0!important}.hp-ml-0{margin-left:0!important}.hp-mt-1{margin-top:.25rem!important}.hp-mr-1{margin-right:.25rem!important}.hp-mb-1{margin-bottom:.25rem!important}.hp-ml-1{margin-left:.25rem!important}.hp-mt-2{margin-top:.5rem!important}.hp-mr-2{margin-right:.5rem!important}.hp-mb-2{margin-bottom:.5rem!important}.hp-ml-2{margin-left:.5rem!important}.hp-mt-3{margin-top:.75rem!important}.hp-mr-3{margin-right:.75rem!important}.hp-mb-3{margin-bottom:.75rem!important}.hp-ml-3{margin-left:.75rem!important}.hp-mt-4{margin-top:1rem!important}.hp-mr-4{margin-right:1rem!important}.hp-mb-4{margin-bottom:1rem!important}.hp-ml-4{margin-left:1rem!important}.hp-mt-5{margin-top:1.25rem!important}.hp-mr-5{margin-right:1.25rem!important}.hp-mb-5{margin-bottom:1.25rem!important}.hp-ml-5{margin-left:1.25rem!important}.hp-mt-6{margin-top:1.5rem!important}.hp-mr-6{margin-right:1.5rem!important}.hp-mb-6{margin-bottom:1.5rem!important}.hp-ml-6{margin-left:1.5rem!important}.hp-mt-7{margin-top:1.75rem!important}.hp-mr-7{margin-right:1.75rem!important}.hp-mb-7{margin-bottom:1.75rem!important}.hp-ml-7{margin-left:1.75rem!important}.hp-mt-8{margin-top:2rem!important}.hp-mr-8{margin-right:2rem!important}.hp-mb-8{margin-bottom:2rem!important}.hp-ml-8{margin-left:2rem!important}.hp-mt-9{margin-top:2.25rem!important}.hp-mr-9{margin-right:2.25rem!important}.hp-mb-9{margin-bottom:2.25rem!important}.hp-ml-9{margin-left:2.25rem!important}.hp-mt-10{margin-top:2.5rem!important}.hp-mr-10{margin-right:2.5rem!important}.hp-mb-10{margin-bottom:2.5rem!important}.hp-ml-10{margin-left:2.5rem!important}.hp-mt-11{margin-top:2.75rem!important}.hp-mr-11{margin-right:2.75rem!important}.hp-mb-11{margin-bottom:2.75rem!important}.hp-ml-11{margin-left:2.75rem!important}.hp-mt-12{margin-top:3rem!important}.hp-mr-12{margin-right:3rem!important}.hp-mb-12{margin-bottom:3rem!important}.hp-ml-12{margin-left:3rem!important}.hp-mt-14{margin-top:3.5rem!important}.hp-mr-14{margin-right:3.5rem!important}.hp-mb-14{margin-bottom:3.5rem!important}.hp-ml-14{margin-left:3.5rem!important}.hp-mt-16{margin-top:4rem!important}.hp-mr-16{margin-right:4rem!important}.hp-mb-16{margin-bottom:4rem!important}.hp-ml-16{margin-left:4rem!important}.hp-mt-20{margin-top:5rem!important}.hp-mr-20{margin-right:5rem!important}.hp-mb-20{margin-bottom:5rem!important}.hp-ml-20{margin-left:5rem!important}.hp-mt-24{margin-top:6rem!important}.hp-mr-24{margin-right:6rem!important}.hp-mb-24{margin-bottom:6rem!important}.hp-ml-24{margin-left:6rem!important}.hp-mt-28{margin-top:7rem!important}.hp-mr-28{margin-right:7rem!important}.hp-mb-28{margin-bottom:7rem!important}.hp-ml-28{margin-left:7rem!important}.hp-mt-32{margin-top:8rem!important}.hp-mr-32{margin-right:8rem!important}.hp-mb-32{margin-bottom:8rem!important}.hp-ml-32{margin-left:8rem!important}.hp-mt-36{margin-top:9rem!important}.hp-mr-36{margin-right:9rem!important}.hp-mb-36{margin-bottom:9rem!important}.hp-ml-36{margin-left:9rem!important}.hp-mt-40{margin-top:10rem!important}.hp-mr-40{margin-right:10rem!important}.hp-mb-40{margin-bottom:10rem!important}.hp-ml-40{margin-left:10rem!important}.hp-mt-44{margin-top:11rem!important}.hp-mr-44{margin-right:11rem!important}.hp-mb-44{margin-bottom:11rem!important}.hp-ml-44{margin-left:11rem!important}.hp-mt-48{margin-top:12rem!important}.hp-mr-48{margin-right:12rem!important}.hp-mb-48{margin-bottom:12rem!important}.hp-ml-48{margin-left:12rem!important}.hp-mt-52{margin-top:13rem!important}.hp-mr-52{margin-right:13rem!important}.hp-mb-52{margin-bottom:13rem!important}.hp-ml-52{margin-left:13rem!important}.hp-mt-56{margin-top:14rem!important}.hp-mr-56{margin-right:14rem!important}.hp-mb-56{margin-bottom:14rem!important}.hp-ml-56{margin-left:14rem!important}.hp-mt-60{margin-top:15rem!important}.hp-mr-60{margin-right:15rem!important}.hp-mb-60{margin-bottom:15rem!important}.hp-ml-60{margin-left:15rem!important}.hp-mt-64{margin-top:16rem!important}.hp-mr-64{margin-right:16rem!important}.hp-mb-64{margin-bottom:16rem!important}.hp-ml-64{margin-left:16rem!important}.hp-mt-72{margin-top:18rem!important}.hp-mr-72{margin-right:18rem!important}.hp-mb-72{margin-bottom:18rem!important}.hp-ml-72{margin-left:18rem!important}.hp-mt-80{margin-top:20rem!important}.hp-mr-80{margin-right:20rem!important}.hp-mb-80{margin-bottom:20rem!important}.hp-ml-80{margin-left:20rem!important}.hp-mt-96{margin-top:24rem!important}.hp-mr-96{margin-right:24rem!important}.hp-mb-96{margin-bottom:24rem!important}.hp-ml-96{margin-left:24rem!important}.hp-mt-auto{margin-top:auto!important}.hp-mr-auto{margin-right:auto!important}.hp-mb-auto{margin-bottom:auto!important}.hp-ml-auto{margin-left:auto!important}.hp-mt-0\.5{margin-top:.125rem!important}.hp-mr-0\.5{margin-right:.125rem!important}.hp-mb-0\.5{margin-bottom:.125rem!important}.hp-ml-0\.5{margin-left:.125rem!important}.hp-mt-1\.5{margin-top:.375rem!important}.hp-mr-1\.5{margin-right:.375rem!important}.hp-mb-1\.5{margin-bottom:.375rem!important}.hp-ml-1\.5{margin-left:.375rem!important}.hp-mt-2\.5{margin-top:.625rem!important}.hp-mr-2\.5{margin-right:.625rem!important}.hp-mb-2\.5{margin-bottom:.625rem!important}.hp-ml-2\.5{margin-left:.625rem!important}.hp-mt-3\.5{margin-top:.875rem!important}.hp-mr-3\.5{margin-right:.875rem!important}.hp-mb-3\.5{margin-bottom:.875rem!important}.hp-ml-3\.5{margin-left:.875rem!important}.hp-text-xs{font-size:.75rem;line-height:1rem}.hp-text-sm{font-size:.875rem;line-height:1.25rem}.hp-text-base{font-size:1rem;line-height:1.5rem}.hp-text-lg{font-size:1.125rem;line-height:1.75rem}.hp-text-xl{font-size:1.25rem;line-height:1.75rem}.hp-text-2xl{font-size:1.5rem;line-height:2rem}.hp-text-3xl{font-size:1.875rem;line-height:2.25rem}.hp-text-4xl{font-size:2.25rem;line-height:2.5rem}.hp-text-5xl{font-size:3rem;line-height:1}.hp-text-6xl{font-size:3.75rem;line-height:1}.hp-text-7xl{font-size:4.5rem;line-height:1}.hp-text-8xl{font-size:6rem;line-height:1}.hp-text-9xl{font-size:8rem;line-height:1}.hp-text-shadow-xs{text-shadow: 2px 2px 2px rgba(0,0,0,.1)}.hp-text-shadow-sm{text-shadow: 2px 2px 4px rgba(0,0,0,.2)}.hp-text-shadow-md{text-shadow: 2px 2px 4px rgba(0,0,0,.35)}.hp-text-shadow-lg{text-shadow: 2px 2px 4px rgba(0,0,0,.5)}.hp-text-shadow-none{text-shadow: none !important}.hp-font-thin{font-weight:100}.hp-font-extralight{font-weight:200}.hp-font-light{font-weight:300}.hp-font-normal{font-weight:400}.hp-font-medium{font-weight:500}.hp-font-semibold{font-weight:600}.hp-font-bold{font-weight:700}.hp-font-extrabold{font-weight:800}.hp-font-black{font-weight:900}.hp-font-helvetica{font-family:open-sans,sans-serif!important}.';
document.getElementsByTagName('head')[0].appendChild(widget._styleTag);
        
      },
      hideFn: function(event) {
        var $ = window.optimizely.get('jquery');
        var widget = event.data.config;
        widget.$id = "20108015752";
        widget.$instance = event.data.id;
        widget.$fieldDefaults = [];
        (function(widg) {
  var i = 0;
  var field;
  for (; i < widg.$fieldDefaults.length; ++i) {
    field = widg.$fieldDefaults[i];
    if (!widg.hasOwnProperty(field.name)) {
      widg[field.name] = field.default_value;
    }
  }
  })(widget);
        var extension = widget;
        widget._styleTag = document.getElementById('widget-css-20108015752');
if (widget._styleTag) widget._styleTag.parentNode.removeChild(widget._styleTag);
        
      },
    });

PluginManager.registerWidget({
      widgetId: '20976822118',
      showFn: function(event) {
        var $ = window.optimizely.get('jquery');
        var widget = event.data.config;
        var _template = new Hogan(function(c,p,i) {var t=this;t.b(i=i||"");t.b("<div id=\"optimizely-extension-");t.b(t.v(t.d("extension.$instance",c,p,0)));t.b("\" class=\"login-widget-on-hp\">");t.b("\n" + i);t.b("  ");t.b(t.v(t.d("extension.text",c,p,0)));t.b("\n" + i);t.b("</div>");return t.fl(); })
        widget.$id = "20976822118";
        widget.$instance = event.data.id;
        widget.$render = _template.render.bind(_template)
        widget.$fieldDefaults = [{"name":"logInLink","default_value":"javascript:window.Carnival.SSO.openLoginRegisterComponent('/login')\""},{"name":"logInCopy","default_value":"Log in to shop your best cruise deal"},{"name":"loginCopyCta","default_value":"Log In"},{"name":"loginCtaBackgroundColor","default_value":"#FFFFFF"},{"name":"loginCtaCopyColor","default_value":"#10559a"},{"name":"waitForElement","default_value":".profile"},{"name":"insertBeforeClassDesktop","default_value":".profile"},{"name":"insertBeforeClassMobile","default_value":".profile"}];
        (function(widg) {
  var i = 0;
  var field;
  for (; i < widg.$fieldDefaults.length; ++i) {
    field = widg.$fieldDefaults[i];
    if (!widg.hasOwnProperty(field.name)) {
      widg[field.name] = field.default_value;
    }
  }
  })(widget);
        widget.$html = _template.render({ widget: widget, extension: widget })
        var extension = widget;
        widget._styleTag = document.createElement('style');
widget._styleTag.id = 'widget-css-20976822118';
widget._styleTag.innerHTML = '.loginExtension {    width: 100%;    max-width: 1400px;    height: 144px;    background: #FFFFFF;    box-shadow: 0px 0px 6px rgba(24, 24, 24, 0.18);    margin: 24px auto;    display: flex;    align-items: center;    justify-content: center;}.loginCopy {    color: #464646;    font-size: 20px;    line-height: 24px;    font-family: "Open Sans";    padding-right: 16px;    font-weight: 700;}.logInLinkCopy {    font-size: 18px;    font-weight: 700;    text-transform: uppercase;    font-family: Tempo, TempoStd, Helvetica, Arial, sans-serif;    line-height: 20px;    width: 130px;    text-align: center;    height: 16px;  color: #fff;}.logInLink {    color: #fff;    border-radius: 4px;    text-decoration: none;    display: flex;    padding: 16px 32px;    justify-content: center;  background-color: #0E4883 !important;}@media (max-width: 767px) {    .loginExtension {        width: auto;        margin: 24px 16px 2px;        flex-direction: column;        text-align: center;        height: 156px;        padding: 24px;    }    .loginCopy {        padding-right: 0;        padding-bottom: 12px;    }    .logInLink {        width: 100%;    }}';
document.getElementsByTagName('head')[0].appendChild(widget._styleTag);
        var $ = jQuery;
var utils = window.optimizely.get('utils');

utils.waitForElement(extension.waitForElement).then(function () {
    setTimeout(function () {
        loginWidget();
    }, 50);
});

function loginWidget() {
     if ($(window).width() < 960) {
       // $('<div class="loginExtension"></div>').insertBefore($('' + extension.insertBeforeClassMobile + ''));
       ($('' + extension.insertBeforeClassMobile + '')).append('<div class="loginExtension"></div>');
    }
    else {
       // $('<div class="loginExtension"></div>').insertBefore($('' + extension.insertBeforeClassDesktop + ''));
       ($('' + extension.insertBeforeClassDesktop + '')).append('<div class="loginExtension"></div>');
    }
    $('.loginExtension').append('<span class ="loginCopy">' + extension.logInCopy + '</span');
    $('.loginExtension').append('<a style= "background-color:' + extension.loginCtaBackgroundColor + '; color: ' + extension.loginCtaCopyColor + ';" class= "logInLink" href="' + extension.logInLink + '"><span class="logInLinkCopy">' + extension.loginCopyCta + '</span></a>');

    var input = document.getElementsByClassName("logInLink");
    input.addEventListener("keyup", function (event) {
        if (event.keyCode === 13) {
            event.preventDefault();
            document.getElementsByClassName("logInLink").click();
        }
    });
}
      },
      hideFn: function(event) {
        var $ = window.optimizely.get('jquery');
        var widget = event.data.config;
        widget.$id = "20976822118";
        widget.$instance = event.data.id;
        widget.$fieldDefaults = [{"name":"logInLink","default_value":"javascript:window.Carnival.SSO.openLoginRegisterComponent('/login')\""},{"name":"logInCopy","default_value":"Log in to shop your best cruise deal"},{"name":"loginCopyCta","default_value":"Log In"},{"name":"loginCtaBackgroundColor","default_value":"#FFFFFF"},{"name":"loginCtaCopyColor","default_value":"#10559a"},{"name":"waitForElement","default_value":".profile"},{"name":"insertBeforeClassDesktop","default_value":".profile"},{"name":"insertBeforeClassMobile","default_value":".profile"}];
        (function(widg) {
  var i = 0;
  var field;
  for (; i < widg.$fieldDefaults.length; ++i) {
    field = widg.$fieldDefaults[i];
    if (!widg.hasOwnProperty(field.name)) {
      widg[field.name] = field.default_value;
    }
  }
  })(widget);
        var extension = widget;
        widget._styleTag = document.getElementById('widget-css-20976822118');
if (widget._styleTag) widget._styleTag.parentNode.removeChild(widget._styleTag);
        /*
 * Editor now supports ES6 compliant code. Note that adding ES6
 * specific code to an experiment will break for users running
 * ES5-only browsers as code entered is not transpiled down to ES5.
 */
 
  const extensionElement = document.getElementById('optimizely-extension-' + extension.$instance);
  if (extensionElement) {
    extensionElement.parentElement.removeChild(extensionElement);
  }

      },
    });

PluginManager.registerWidget({
      widgetId: '20982870686',
      showFn: function(event) {
        var $ = window.optimizely.get('jquery');
        var widget = event.data.config;
        var _template = new Hogan(function(c,p,i) {var t=this;t.b(i=i||"");t.b("<div id=\"optimizely-extension-");t.b(t.v(t.d("extension.$instance",c,p,0)));t.b("\" class=\"carouselItin\">");t.b("\n" + i);t.b("  <span class=\"carouselHeading itinCarouselHeading");t.b(t.v(t.d("extension.carNumber",c,p,0)));t.b("\">");t.b(t.v(t.d("extension.headline",c,p,0)));t.b("</span>");t.b("\n" + i);t.b("  <div class=\"itinCarousel");t.b(t.v(t.d("extension.carNumber",c,p,0)));t.b("\"></div>");t.b("\n" + i);t.b("  <p class=\"itinCarDisclaimer\">*Taxes, fees and port expenses are additional per person.</p>");t.b("\n" + i);t.b("</div>");return t.fl(); })
        widget.$id = "20982870686";
        widget.$instance = event.data.id;
        widget.$render = _template.render.bind(_template)
        widget.$fieldDefaults = [{"name":"carNumber","default_value":"1"},{"name":"remarketing","default_value":"false"},{"name":"destPage","default_value":"false"},{"name":"ItinRemarketing","default_value":"false"},{"name":"geoTarget","default_value":"true"},{"name":"insertAfterDesktop","default_value":".bucket-2"},{"name":"insertAfterMobile","default_value":".carouselsMobile"},{"name":"headline","default_value":"LAST-MINUTE CRUISE DEALS"},{"name":"icid","default_value":"icp_ccl_XXXXXX_itinCarousel"},{"name":"params","default_value":""},{"name":"numResults","default_value":"8"},{"name":"cruiseDeals","default_value":""},{"name":"cover","default_value":"n"},{"name":"carCoverImg","default_value":"/~/media/Images/hp-merch/2021/extras/carouselCover/shaq-cover-image.ahsx"},{"name":"htmlOverlayCopy","default_value":"<div class=\"coverHeading\">CHECK OUT THESE EXCLUSIVE DEALS JUST FOR YOU</div>"}];
        (function(widg) {
  var i = 0;
  var field;
  for (; i < widg.$fieldDefaults.length; ++i) {
    field = widg.$fieldDefaults[i];
    if (!widg.hasOwnProperty(field.name)) {
      widg[field.name] = field.default_value;
    }
  }
  })(widget);
        widget.$html = _template.render({ widget: widget, extension: widget })
        var extension = widget;
        widget._styleTag = document.createElement('style');
widget._styleTag.id = 'widget-css-20982870686';
widget._styleTag.innerHTML = '.itinHead {    font-family: "Open Sans", sans-serif !important;    font-size: 16px;    text-decoration: none;    color: #464646;    font-weight: 700;    line-height: 20px;}/*dots*/.slick-dots {position: unset!important;    display: block;    width: 100%;    padding: 0;    margin: 0;    list-style: none;    text-align: center;}.slick-dots li {    position: relative;    display: inline-block;    width: 20px;    height: 20px;    margin: 0 5px;    padding: 0;    cursor: pointer;}.slick-dots li button {    font-size: 0;    line-height: 0;    display: block;    width: 20px;    height: 20px;    padding: 5px;    cursor: pointer;    color: transparent;    border: 0;    outline: none;    background: transparent;}.slick-dots li.slick-active button:before {    opacity: .75;    color: black;}.slick-dots li.slick-active button:before {    opacity: .75;    color: black;    font-size: 35px !important;}.slick-dots li button:before {    font-family: "slick";    font-size: 25px;    line-height: 20px;    position: absolute;    top: 0;    left: 0;    width: 20px;    height: 20px;    content: "";    text-align: center;    opacity: .25;    color: black;    -webkit-font-smoothing: antialiased;    -moz-osx-font-smoothing: grayscale;}/*dots end*/.slick-track {    left: 5px!important;}.geo{  display:none;}.itin-carousel {  background-color: #fff575;  border-bottom: 1px solid #e0d769;  color: #555;  padding: 10px;  font-weight: bold;  text-align: center;  font-size: 20px;}.itinCopy h2 {    height: 44px;}.coverImage{    height: 381px;    border-radius: 8px;    background-size: cover!important;}.coverHeading{  color:#fff;  font-family: "TempoStd", "Tempo", "Tempo-Local", Arial Narrow, Arial, sans-serif;  font-size:24px;  text-align: center;  padding: 8px;}  .loading{  background: #FFF;  height: 430px !important;  width: 300px;  border-radius: 4px;  margin: 8px;  border: solid 1px rgba(0,0,0,.1);  display: flex !important;  flex-direction: column;  align-items: center;  padding: 10px 0;  box-sizing: border-box;}.slick-slide {    display: block!important;}.carousels, .carouselsMobile, .carousels-2, .carouselsMobile-2{margin-top:24px; margin-bottom:24px; }.itinCard {    justify-content: space-between;    font-family: "Open Sans", sans-serif;    margin: 1px 10px;    flex-direction: column;    align-items: flex-start;    padding: 0px;    border-radius: 8px;    width: 312px;    box-shadow: 0px 0px 6px rgb(24 24 24 / 18%);}.itinCarousel1,.itinCarousel2,.itinCarousel3,.itinCarouselRecently {  max-width: 1400px;  margin: auto;}.carouselHeading {    font-family: "TempoStd", "Tempo", "Tempo-Local", Arial Narrow, Arial, sans-serif;    font-size: 36px;    line-height: 1;    text-transform: uppercase;    color: #10559A;    padding-left: 30px;  padding-bottom:8px;}.carouselItin {  max-width: 1400px;  margin: 25px auto;}.cardSeeMore {    background: #10559a;    color: white!important;    width: 200px;    height: 381px !important;    font-size: 18px;    font-weight:200;    text-decoration: underline!important;    border-radius: 8px;    font-family: "Open Sans", sans-serif;    margin: 1px 10px;}/*.itinCard:nth-child(1),.actCard:nth-child(1) {  margin-left: 0;}*/.itinImage {  /*width: 100%;  height: 175px;*/  background-position: center !important;  background-size: cover !important;  border-top-left-radius: 8px;  border-top-right-radius: 8px;  aspect-ratio: 16/9;}.itinCopy {    height: 158px;    border-bottom-left-radius: 8px;    border-bottom-right-radius: 8px;    padding: 24px;    display: flex;    flex-direction: column;    align-items: flex-start;    gap: 16px;    flex: none;    order: 1;    align-self: stretch;    flex-grow: 0;}.itinCopy h2 {  font-family: "Open Sans", sans-serif!important;  font-size: 16px;  text-decoration: none;  color: #464646;  font-weight: 700;  line-height: 20px;}.itinCopy .days {  color: #000;  font-weight: 700;  font-size: 1.3rem;}.pricing {    color: #464646;    font-family: "Open Sans", sans-serif!important;    font-style: normal;    display: flex;    flex-direction: row;    align-items: flex-start;    padding: 0px;    gap: 4px;    flex: none;    order: 0;    align-self: stretch;    flex-grow: 0;}.pricing .from {  font-weight: 400;font-size: 12px;line-height: 14px;  margin-top:5px;}.pricing .avgperson{  font-weight: 400;font-size: 12px;line-height: 14px;  margin-top:5px;}.pricing .itinPrice {    display: flex;    align-items: flex-start;    padding: 0px;    font-weight: 700;    font-size: 32px;    line-height: 38px;}.itinDollar {font-weight: 700;font-size: 16px;line-height: 28px;} .itinasterisk {font-weight: 700;font-size: 12px;line-height: 25px;} .shopnow {    background: #10559a;    color: white;    text-transform: uppercase;    border: none;    font-size: 18px;    border-radius: 4px;    text-align: center;    padding: 16px 24px 10px;    gap: 8px;    line-height: 22px;    font-family: "Tempo Std", "tempo";    font-style: normal;    font-weight: 850;    flex: none;    order: 2;    align-self: stretch;    flex-grow: 0;}.itinCarousel1 .slick-prev,.itinCarouselRecently .slick-prev,.obaDinCarousel .slick-prev,.itinCarousel2 .slick-prev,.itinCarousel1 .slick-next,.itinCarouselRecently .slick-next,.obaDinCarousel .slick-next,.itinCarousel2 .slick-next, .vifpItinCarousel .slick-next, .vifpItinCarousel .slick-prev {  position: absolute;  z-index: 100;  top: 185px;  left: -20px;  width: 40px;  height: 40px;  background-color: #ffffff;  border-radius: 50%;  border: none;  text-indent: -9999px;  cursor: pointer;  background-image: url(" //cdn.optimizely.com/img/752671897/aa51e36df7f24356aa087d95789fa5ca.png");  background-position: center center;  background-repeat: no-repeat;  overflow: hidden;}.itinCarousel1 .slick-next,.itinCarouselRecently .slick-next,.obaDinCarousel .slick-next,.itinCarousel2 .slick-next, .vifpItinCarousel .slick-next{  left: 97%;  transform: rotate(-180deg);}.title {  font-family: "Open Sans", sans-serif;  font-weight: bold;  line-height: 0.5;  perspective: 1000px;}div.carouselItin > div > button.slick-arrow.slick-disabled {  display: none !important;}.slick-prev .hidden,.slick-next .hidden {  opacity: 0;  pointer-events: none;}.cont {  width: 1400px;  margin: auto;  margin-top: 10px;}.cont h1 {  font-family: tempo;  font-size: 34px;  color: #105595;}.actCard:not(.slick-active),.itinCard:not(.slick-active) {  opacity: 0.5;  cursor: default;}.itinCarDisclaimer {    text-align: center;    color: #464646;    padding-top:5px;    font-family: "Open Sans";    font-style: normal;    font-weight: 400;    font-size: 16px;    line-height: 20px;}@media (min-width: 1024px) {  .itinCarousel1 .slick-next,  .itinCarouselRecently .slick-next,  .obaDinCarousel .slick-next,  .itinCarousel2 .slick-next,   .vifpItinCarousel .slick-next{    left: 96%;    top: 185px;  }  .itinCarousel1 .slick-prev,  .itinCarouselRecently .slick-prev,  .obaDinCarousel .slick-prev,  .itinCarousel2 .slick-prev,  .vifpItinCarousel .slick-prev{    left: 10px;    top: 185px;  }  .carouselHeading {    padding-left: 30px;  }  .itinCarousel1,  .itinCarousel2,  .itinCarouselRecently,  .obaDinCarousel,  .vifpItinCarousel {    padding: 16px 24px 0px 24px;  }}@media (min-width: 1400px) {  .itinCarousel1 .slick-next,  .itinCarouselRecently .slick-next,  .obaDinCarousel .slick-next,  .itinCarousel2 .slick-next,   .vifpItinCarousel .slick-next{    left: 97%;    top: 185px;  }  .itinCarousel1 .slick-prev,  .itinCarouselRecently .slick-prev,  .obaDinCarousel .slick-prev,  .itinCarousel2 .slick-prev,  .vifpItinCarousel .slick-prev{    left: 0;    top: 185px;  }}/* Portrait */@media only screen and (min-device-width: 320px) and (max-device-width: 736px) and (-webkit-min-device-pixel-ratio: 2) {  .itinCarousel1 .slick-prev,  .itinCarouselRecently .slick-prev,  .obaDinCarousel .slick-prev,  .itinCarousel2 .slick-prev,  .vifpItinCarousel .slick-prev{    left: -7px;      top: 175px;  }  .itinCarousel1 .slick-next,  .itinCarouselRecently .slick-next,  .obaDinCarousel .slick-next,  .itinCarousel2 .slick-next,   .vifpItinCarousel .slick-next{    left: 90%;       top: 175px;  }  .itinCarousel1,  .itinCarousel2,  .itinCarouselRecently,  .vifpItinCarousel{    max-width: 100%;    margin: 16px 16px 0 16px;  }  .carouselHeading {    font-size: 24px;    line-height:28px;  }  .itinCopy {    height: 206px;  }  .itinDollar{    top:0px!important;  }  .itinCard {    width: 320px;  }  .cardSeeMore {    height: 386px !important;     }  .coverImage{    height: 386px;  }     .itinCarDisclaimer {   font-size: 16px;    line-height: 20px;}}@media only screen and (min-width: 375px) and (max-width: 980px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape),  only screen and (min-width: 375px) and (max-width: 980px) and (-webkit-device-pixel-ratio: 3.5) and (orientation: landscape),  only screen and (min-width: 375px) and (max-width: 980px) and (-webkit-device-pixel-ratio: 2.625) and (orientation: landscape),only screen and (min-width: 375px) and (max-width: 980px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape){  /*.itinCopy h2 {    font-size: 1.2rem;  }  .itinCopy .days {    font-size: 0.8rem;    margin: 0;  }  .pricing p {    font-size: 0.7rem;    margin: 0;  }  .itinPrice {    margin: 1%;  }  .pricing {    margin-top: 10px;  }  .pricing .itinPrice {    font-size: 1.5rem;    padding: 0;    margin: 0;  }  .shopnow {    font-size: 13px;    padding: 9px 0px;    margin-top: 6px;  }*/  .itinDollar {    font-weight: 700;    font-size: 16px;    line-height: 32px;}  .itinCopy {    height: 206px;  }  .itinCarousel1,  .itinCarousel2,  .itinCarouselRecently,  .vifpItinCarousel{    max-width: 100%;    margin: 16px 16px 0 16px;  }  .itinCarousel1 .slick-prev,  .itinCarouselRecently .slick-prev,  .obaDinCarousel .slick-prev,  .itinCarousel2 .slick-prev,  .vifpItinCarousel .slick-prev{    left: -2px!important;    top:165px;  }  .itinCarousel1 .slick-next,  .itinCarouselRecently .slick-next,  .obaDinCarousel .slick-next,  .itinCarousel2 .slick-next,  .vifpItinCarousel .slick-next{    left: 97%;      top:165px;  }  .cardSeeMore {    height: 382px !important;     }  .coverImage{    height: 382px;}  /*.itinCarousel1,  .itinCarousel2,  .itinCarouselRecently {    max-width: 100%;    margin-left: 24px;  }  .carouselHeading {    font-size: 28px;    margin: 20px 10px 10px 10px;    text-transform: uppercase;  }  .itinCard {    width: 285px;  }  .cardSeeMore {    height: 375px !important;    font-size: 1.3rem;  }  .itinImage {    height: 175px;  }*/}';
document.getElementsByTagName('head')[0].appendChild(widget._styleTag);
        var utils = optimizely.get('utils');
var $ = window.jQuery;
function getCookie(name) {
  var value = "; ".concat(document.cookie);
  var parts = value.split("; ".concat(name, "="));
  if (parts.length === 2) return parts.pop().split(';').shift();
}

//Gets TGO Cookie to be used on api call
/*var tgoCookie = getCookie('TargetedOffersCookie');
var tgoParam = "tgo=";
if(tgoCookie != undefined){
  tgoCookie = decodeURIComponent(tgoCookie);
  var offers = tgoCookie.substring(0,tgoCookie.indexOf('|')).split('=');
  offers = offers[1];
  tgoParam = 'tgo='+offers;
}*/
//LIVE PRICING//
// Main entry point
$(document).ready(function() {
    // Start the process
    initialize();
});

function initialize() {
    var vifp = window.pastGuestNum;
   if (vifp) {fetchTargetedOffers(vifp);
    } else {var tgoParam="tgo=";
    }
}



// Function to fetch targeted offers
function fetchTargetedOffers(vifp) {
 var offers;

 $.ajax({
        type: "GET",
        cache: true,
        url: "https://www.carnival.com/cruisesearch/api/TargetedOffers/GetTargetedOffers?pastGuestNumber="+vifp,
        error: function(error) {
            console.log('Param error', error);
        },
        success: function(response) {
            var offers = encodeURIComponent(response.tgos);
            var tier = encodeURIComponent(response.tierCode);
            var tgoParam= 'tgo='+offers+'&tierCode='+tier+'&vifp='+vifp;
        }
    });
   
}

//Ports by state for Geo Locations
var states={AL:{state:"Alabama",ports:"jax,mob,msy"},AK:{state:"Alaska",ports:"lax,sfo,sea"},AZ:{state:"Arizona",ports:"lax,gal"},AR:{state:"Arkansas",ports:"mob,msy,gal"},CA:{state:"California",ports:"lax,sfo"},CO:{state:"Colorado",ports:""},CT:{state:"Connecticut",ports:"nyc,bwi"},DE:{state:"Delaware",ports:"nyc,bwi"},DC:{state:"Washington, DC",ports:"nyc,bwi"},FM:{state:"Federated States Of Micronesia",ports:""},FL:{state:"Florida",ports:"jax,mia,pcv,tpa"},GA:{state:"Georgia",ports:"jax,mia,pcv,tpa,mob,chs"},GU:{state:"Guam",ports:""},HI:{state:"Hawaii",ports:"lax,sfo"},ID:{state:"Idaho",ports:""},IL:{state:"Illinois",ports:""},IN:{state:"Indiana",ports:""},IA:{state:"Iowa",ports:""},KS:{state:"Kansas",ports:""},KY:{state:"Kentucky",ports:""},LA:{state:"Louisiana",ports:"mob,msy,gal"},ME:{state:"Maine",ports:"nyc"},MH:{state:"Marshall Islands",ports:""},MD:{state:"Maryland",ports:"nyc,bwi"},MA:{state:"Massachusetts",ports:"nyc,bwi"},MI:{state:"Michigan",ports:""},MN:{state:"Minnesota",ports:""},MS:{state:"Mississippi",ports:"mob,msy"},MO:{state:"Missouri",ports:""},MT:{state:"Montana",ports:""},NE:{state:"Nebraska",ports:""},NV:{state:"Nevada",ports:"lax,sfo"},NH:{state:"New Hampshire",ports:"nyc,bwi"},NJ:{state:"New Jersey",ports:"nyc,bwi"},NM:{state:"New Mexico",ports:"lax,gal"},NY:{state:"New York",ports:"nyc,bwi"},NC:{state:"North Carolina",ports:"chs,orf"},ND:{state:"North Dakota",ports:""},OH:{state:"Ohio",ports:""},OK:{state:"Oklahoma",ports:""},OR:{state:"Oregon",ports:"lax,sfo,sea"},PW:{state:"Palau",ports:""},PA:{state:"Pennsylvania",ports:"nyc,bwi"},PR:{state:"Puerto Rico",ports:""},RI:{state:"Rhode Island",ports:"nyc,bwi"},SC:{state:"South Carolina",ports:"chs,jax"},SD:{state:"South Dakota",ports:""},TN:{state:"Tennessee",ports:""},TX:{state:"Texas",ports:"gal"},UT:{state:"Utah",ports:""},VT:{state:"Vermont",ports:"nyc,bwi"},VI:{state:"Virgin Islands",ports:""},VA:{state:"Virginia",ports:"bwi,orf"},WA:{state:"Washington",ports:"sfo,sea"},WV:{state:"West Virginia",ports:""},WI:{state:"Wisconsin",ports:""},WY:{state:"Wyoming",ports:""}};

if(extension.geoTarget === 'true'){
  var stateAbb = '';
  try{
    stateAbb = optimizely.get("visitor").location.region;
  }
  catch(e){
  }

    utils.waitForElement("#hero-sub").then(function(elem) {
 
    var ports = stateAbb.length ? states[stateAbb].ports : 'gal,jax,lax,mia,pcv,sfo,tpa';
    start(ports);
     if (states[stateAbb].ports!==""){
       utils.waitForElement('.coverHeading').then(function(elem) {
       $('.default').attr("style", "display:none!important");
       $('.geo').attr("style", "display:block!important");});}
  })
}else if (extension.remarketing === "true") {
    /*var searches = JSON.parse(localStorage.getItem("searches"));
    var searchesArr = Object.keys(searches).map(function (search) { return searches[search]; });
    var filtered = searchesArr.filter(function (search) { return (search.destinations.length || search.ports.length); });
    var lastFilter = filtered.filter(function (s) {
        if (s.ports.length && s.ports[0] != '') {
            return true;
        } else if (s.destinations.length && s.destinations[0] != '') {
            return true;
        }
    });*/
    var portCodes = { 'bcn': 'Barcelona', 'bds': 'Barbados', 'bwi': 'Baltimore', 'chs': 'Charleston', 'cph': 'Copenhagen', 'fll': 'Fort Lauderdale', 'gal': 'Galveston', 'hnl': 'Honolulu', 'jax': 'Jacksonville', 'lax': 'Long Beach', 'lon': 'London', 'mia': 'Miami', 'mob': 'Mobile', 'msy': 'New Orleans', 'nyc': 'New York', 'orf': 'Norfolk', 'pcv': 'Port Canaveral', 'sdg': 'San Diego', 'sea': 'Seattle', 'sfo': 'San Francisco', 'sju': 'San Juan', 'tpa': 'Tampa', 'vce': 'Venice', 'yvr': 'Vancouver', 'bne': 'Brisbane' };
    var locationCodes = { "A": "Alaska", "BH": "The Bahamas", "BM": "Bermuda", "NN": "Canada & New England", "C": "Caribbean", "E": "Europe", "H": "Hawaii", "M": "Mexico", "T": "Panama Canal", "ET": "Transatlantic", "GE": "Getaway", "NZ": 'New Zealand', 'NG': 'Papua New Guinea', 'X': 'Asia', 'U': 'Australia', 'P': 'Transpacific', 'O': 'South Pacific', 'CE': 'Eastern Caribbean', 'CW': 'Western Caribbean' };

   /* var latest = Math.max.apply(null, lastFilter.map(function (search) { return search._id; }));

    var latestSearchKey = Object.keys(searches).filter(function (time) {
        return searches[time]._id === latest;
    });

    var latestSearch = searches[latestSearchKey];
    var portCode = latestSearch.ports.length > 1 ? latestSearch.ports.join(',') : latestSearch.ports.length < 1 ? '' : latestSearch.ports[0];
    var destCode = latestSearch.destinations.length > 1 ? latestSearch.destinations.join(',') : latestSearch.destinations.length < 1 ? '' : latestSearch.destinations[0];
    var dateTo = latestSearch.dateTo != null ? latestSearch.dateTo : '';
    var dateFrom = latestSearch.dateFrom != null ? latestSearch.dateFrom : '';
    var locationName = locationCodes[destCode.toUpperCase()] || '';
    var portName = portCodes[portCode.toLowerCase()] || '';
    var numAdults = latestSearch.adults;*/
      var behavior2 = optimizely.get('behavior');
    var res2 = behavior2.query({
        "version": "0.2",
        "filter": [
            {
                "field": ["type"],
                "value": "custom"
            },
            {
                "field": ["name"],
                "value": "Search Filters"
            }
        ]
    });

    if (res2.length && res2[res2.length - 1].hasOwnProperty('tags')) {
        var data = res2[res2.length - 1].tags;
        if (data.url != undefined) {
		var parts={};
		var url = data.url.toLowerCase().replace(/[?&]+([^=&]+)=([^&]*)/gi, function (m, key, value) {
        parts[key] = value.toLowerCase();});
		if (parts.dest!= null){ 
     var dest = parts.dest.replace('%2C',',').split(',');
     var destCode = dest.length > 1 ? dest.join(',') : dest.length < 1 ? '' : dest[0];
     var locationName = locationCodes[destCode.toUpperCase()] || '';
    };
		if (parts.port!= null){ 
      var ports = parts.port.replace('%2C',',').split(',');
      var portCode = ports.length > 1 ? ports.join(',') : ports.length < 1 ? '' : ports[0];
      var portName = portCodes[portCode.toLowerCase()] || '';
    };
		//var date = parts.dates.replace('%2C',',').split(',');
    //var date2 = date.length > 1 ? date.join(',') : date.length < 1 ? '' : date[0];
    var numAdults = parts.numadults;
  }
}
    if (portCode == null) {
        if (destCode != null) {
            //check length of dest to make sure its only one 
            if (destCode.length <= 2) {
                extension.headline = locationName + ' CRUISES';
                extension.params = "&dest=" + destCode;
                start('', numAdults);
            } else {
                extension.headline = 'RECOMMENDED FOR YOU';
                extension.params = "&dest=" + destCode;
                start('', numAdults);
            }
        }
    } else if (destCode == null) {
        if (portCode != null) {
            //check length of ports to make sure its only one 
            if (portCode.length <= 3) {
                extension.headline = 'CRUISE FROM ' + portName;
              extension.params = "&port=" + portCode;
                start(portCode, numAdults);
            } else {
                extension.headline = 'RECOMMENDED FOR YOU';
              extension.params = "&port=" + portCode;
                start(portCode, numAdults);
            }
        }
    } else if (destCode != null && portCode != null) {
        extension.headline = 'RECOMMENDED FOR YOU';
        extension.params = "&dest=" + destCode + "&port=" + portCode;
        start(portCode, numAdults);
    }
} else if(extension.destPage === "true"){
  //START dest Page RMKTG
  var behavior = optimizely.get('behavior');
  var res =  behavior.query({
    "version": "0.2",
    "filter" : [
      {
        "field":["type"],
        "value":"pageview"
      },
      {
        "field":["name"],
        "value":"1912722625_shopping_funnel"
      }
    ]
  });
  var itinNumAdults = 2;

  if(res.length && res[res.length-1].hasOwnProperty('tags')){
    var data = res[res.length -1].tags;
    if(data.embark_port_code != undefined){
    var depPort = data.embark_port_code;
      extension.params = "&port="+data.embark_port_code;
      extension.headline = 'CRUISES FROM '+data.embark_port_name.toUpperCase();
    }else if(data.destination_code != undefined){
      var itinDest = data.destination_code;
      extension.params = "&dest="+itinDest;
      var dpdest = data.destination;
      dpdest = dpdest === 'canada/new england'? dpdest.replace('/', ' & ') : dpdest;
      extension.headline = dpdest.toUpperCase()+' CRUISE DEALS';
    }
  }

    start('', itinNumAdults);
  //END dest Page RMKTG
}
else if(extension.ItinRemarketing === 'true'){
//Itin carousel gather data from optimizely on past site behavior (Last Itin seen) then we override the extenion variable values
  var behavior = optimizely.get('behavior');
  var res =  behavior.query({
    "version": "0.2",
    "filter" : [
      {
        "field":["type"],
        "value":"pageview"
      },
      {
        "field":["name"],
        "value":"1912722625_shopping_funnel"
      }
    ]
  });

  var data = res[res.length -1].tags;
	
	
  var itinPort = data.embark_port_code;
  var itinDest = data.destination_code;
  var itinNumAdults = data.num_guest;
	//Override headline
  extension.headline = 'RECOMMENDED FOR YOU';
	//Override Params
  extension.params = "&dest="+itinDest+"&port="+itinPort;
  //start passing the port and num of adults from last itin seen.
  start(itinPort, itinNumAdults);
}else{
  //Just a regular carousel, non remarketing, will use whatever params are on the extension variables
  start();
}

//functions thata takes in port, numadults and a callback to call api. if ports and numadults inst passed, it will just be empty. Being passed to start where it checks if it got values for those if not sets them no empty strings(line 178 and 179) 
function getCruises(port,numAdults, callback,tgoParam){
  $.ajax({
    type: "GET",
    cache: true,
    url: '/cruisesearch/api/search/?numAdults='+numAdults+'&port='+port+'&pageNumber=1&pageSize='+extension.numResults+'&showBest=true&sort=fromprice&useSuggestions=true&'+tgoParam+extension.params,
    fail:function(){console.log('fail');},
    success: callback
  });
}


function start(ports, numAdults){
  ports = ports || '';
  numAdults = numAdults || '2';
  //Ensures that slick is on the page already 
  $(document).ready(function() {
    var html = '<div id="optimizely-extension-'+extension.$instance+'" class="carouselItin"><span class="carouselHeading itinCarouselHeading'+extension.carNumber+'">'+extension.headline+'</span><div class="itinCarousel'+extension.carNumber+'"></div><p class="itinCarDisclaimer">*All taxes and fees are included.</p></div>'
    //wait for element to insert html for desktop
    utils.waitForElement(extension.insertAfterDesktop).then(function(elem) {
      elem.insertAdjacentHTML('beforeend',html);
      init();
    });
		  //wait for element to insert html for Mobile
    utils.waitForElement(extension.insertAfterMobile).then(function(elem) {
      elem.insertAdjacentHTML('beforeend', html);
      init();
    });
    
    //SLick Dots ADA
utils.waitForElement(".slick-dots").then(function() {
      $(".slick-dots").attr("aria-hidden","true");
$(".slick-dots li").attr("aria-hidden","true");
    $(".slick-dots").attr("tabindex","-1");
  $(".slick-dots li").attr("tabindex","-1");
    $(".slick-dots button").attr("tabindex","-1");
});


    function init(){
      //initialize Slick Carousel
      $(".itinCarousel"+extension.carNumber).slick({
        slidesToShow: 4,
        slidesToScroll: 2,
        infinite: false,
             dots: true,
        variableWidth: true,
        prevArrow: '<button class="itinControl'+extension.carNumber+' slick-prev" aria-label="Previous items in the Carousel" tabindex="1" type="button"">Previous</button>',
        nextArrow: '<button class="itinControl'+extension.carNumber+' slick-next" aria-label="Next items in the Carousel" tabindex="1" type="button">Next</button>',
        responsive: [
          {
            breakpoint: 1150,
            settings: {
              slidesToShow: 2,
              slidesToScroll: 2,
            }
          },
          {
            breakpoint: 568,
            settings: {
              slidesToShow: 1,
              slidesToScroll: 1,
            }
          },
        ]
      });

      //Insert 4 loading cards (Skeleton Cards)
      var loading = '<div class="loading"><i class="fa fa-picture-o" style="font-size: 200px;color:#ddd;"></i><div class="ad-tile-loading" style=" display: flex; flex-direction: column; "><div class="ad-tile-loading-line" style="width: 200px; "></div><div class="ad-tile-loading-line" style=" width: 200px; "></div><div class="ad-tile-loading-line" style=" width: 200px;  "></div></div><div class="ad-tile-loading" style=" margin-top: 17px;  display: flex; flex-direction: column;"><div class="ad-tile-loading-line" style="width: 200px; "></div><div class="ad-tile-loading-line" style=" width: 200px; "></div><div class="ad-tile-loading-line" style=" width: 200px;  "></div></div></div>'
      $('.itinCarousel'+extension.carNumber).slick('slickAdd',loading);
      $('.itinCarousel'+extension.carNumber).slick('slickAdd',loading);
      $('.itinCarousel'+extension.carNumber).slick('slickAdd',loading);
      $('.itinCarousel'+extension.carNumber).slick('slickAdd',loading);

      getCruises(ports,numAdults, function(resp){
        if(resp.results.itineraries.length ){
          //Once theres a response from the API remote the loading cards.
          $('.loading').remove()
          var results = resp.results.itineraries;
          var items = [];
          //double checks that theres no duplicates with different ships
          results.forEach(function(each) {
            var index = items.findIndex(function(e) {
              return e.regionName === each.regionName && e.dur === each.dur && e.departurePortName === each.departurePortName;
            });
            if (index === -1) {
              each.count = 1;
              items.push(each);
            } else {
              items[index].count++;
            }
          });
          
          if (extension.cover === 'y'){
          var card1 = $('<div>').addClass('itinCard');
          var image1 = $('<div>').addClass('coverImage');
          var imageUrl = ''+extension.carCoverImg+'';
          image1.css('background','url(https://www.carnival.com'+imageUrl+')');
          image1.append(''+extension.htmlOverlayCopy+'');
          card1.append(image1);
            $('.loading').remove();
          $('.itinCarousel'+extension.carNumber).slick('slickAdd',card1);
          }
          items.forEach(function(each){
            var portCode = each.id.substring(4,7);
            var card = $('<a>').addClass('itinCard');
            card.attr('href','https://www.carnival.com/cruise-search?cruisedeals='+extension.cruiseDeals+'&dest='+each.regionCode+'&durDays='+each.dur+'&port='+portCode+extension.params+'&icid='+extension.icid);
            card.attr('tabindex','-1');
          card.attr('aria-label',each.dur +' day cruise to ' + each.regionName+  ' from ' + each.departurePortName +' from $'+each.leadSailing.fromPrice +'* Average per person for 2 person room');
          var image = $('<div>').addClass('itinImage');
          var imageUlr = each.image;
          imageUlr = imageUlr.substring(0,imageUlr.indexOf('?'));
          imageUlr = imageUlr+'?useCustomFunctions=1&centerCrop=1&w=300&h=200';
          image.css('background','url(https://www.carnival.com'+imageUlr+')');
          var copy = $('<div>').addClass('itinCopy');
         // var days = $('<p>').addClass('days');
          //days.append(each.dur +' DAY');

          var destAndPort = $('<span>').addClass('itinHead').append(each.dur +'-Day '+ each.regionName+ ' from '+ each.departurePortName);

          var pricing = $('<div>').addClass('pricing');
          var cruises = $('<p>').addClass('from').append('From');
           var price = $('<div>').addClass('itinPrice').append('<sup class="itinDollar">$</sup>'+each.leadSailing.fromPrice+'<sup class="itinasterisk">*</sup>');
          var pp = $('<p>').addClass('avgperson').append('Average Per Person<br>2 Person Room');

   var cta = $('<a>').addClass('shopnow').attr({ 'aria-label': 'SHOP NOW'  , 'z-index': '1', 'role': 'button' }).append('Shop Now');

          pricing.append(cruises);
          pricing.append(price);
          pricing.append(pp);

          //copy.append(days);
          copy.append(destAndPort);
          copy.append(pricing);
          copy.append(cta);

          card.append(image);
          card.append(copy);

            $('.itinCarousel'+extension.carNumber).slick('slickAdd',card);
            $('.itinCard.slick-slide.slick-active').attr('tabindex','0');

          });//ends for each

          var card = $('<a>').addClass('cardSeeMore');
          var extraParams = extension.geoTarget === 'true' || extension.remarketing === 'true' ? extension.params +'&port=' + ports : extension.params; 
          card.attr('href','https://www.carnival.com/cruise-search?cruisedeals='+extension.cruiseDeals+'&numAdults=2&pageNumber=1&showBest=true&sort=fromprice&useSuggestions=true&pageSize=8'+extraParams);
          card.attr('aria-label','See more');
          card.attr('tabindex','-1');
          var price = $('<div>').append('See More');
          price.css({'font-family': '"Open Sans", sans-serif'});
          //var caret = '<i class="fa fa-caret-right" style="margin-left: 5px;"></i>';
          //price.append(caret);
          $(price).css({ 'color': 'white', 'display': 'flex', 'justify-content': 'center', 'align-items': 'center', 'height': '100%'});
          card.append(price);
          $('.itinCarousel'+extension.carNumber).slick('slickAdd',card);

        }else{
          //if there are no results load the default
          extension.params = "&dur=d1";
          $('.itinCarouselHeading'+extension.carNumber).text('2-5 DAY CRUISE DEALS');
          getCruises("",'2',function(resp){
            loadResultCards(resp);
          });

        }//ends If statement
      });//Ends Get Itin

      //Used to build cards and append them to carousel
      function loadResultCards(resp){
        var results = resp.results.itineraries;
        var items = [];
        $('.loading').remove();
        //this is used to filter out itins so there arent repeated cards (if duration, dest and port are the same) usually only difference is ship but since we dont show ship on the card, the look the same.
        results.forEach(function(each) {
          var index = items.findIndex(function(e) {
            return e.regionName === each.regionName && e.dur === each.dur && e.departurePortName === each.departurePortName;
          });
          if (index === -1) {
            each.count = 1;
            items.push(each);
          } else {
            items[index].count++;
          }
        });
  if (extension.cover === 'y'){
          var card1 = $('<div>').addClass('itinCard');
          var image1 = $('<div>').addClass('coverImage');
          var imageUrl = ''+extension.carCoverImg+'';
          image1.css('background','url(https://www.carnival.com'+imageUrl+')');
          image1.append(''+extension.htmlOverlayCopy+'');
          card1.append(image1);
            $('.loading').remove();
          $('.itinCarousel'+extension.carNumber).slick('slickAdd',card1);
          }
        items.forEach(function(each){
          var portCode = each.id.substring(4,7);
          var card = $('<a>').addClass('itinCard');
          card.attr('href','https://www.carnival.com/cruise-search?cruisedeals='+extension.cruiseDeals+'&dest='+each.regionCode+'&durDays='+each.dur+'&port='+portCode+extension.params+'&icid='+extension.icid);
          card.attr('tabindex','-1');
          card.attr('aria-label',each.dur +' day cruise to ' + each.regionName+  ' from ' + each.departurePortName +' from $'+each.leadSailing.fromPrice +'* Average per person for 2 person room');
          var image = $('<div>').addClass('itinImage');
          var imageUlr = each.image;
          imageUlr = imageUlr.substring(0,imageUlr.indexOf('?'));
          imageUlr = imageUlr+'?useCustomFunctions=1&centerCrop=1&w=300&h=200';
          image.css('background','url(https://www.carnival.com'+imageUlr+')');
          var copy = $('<div>').addClass('itinCopy');
         // var days = $('<p>').addClass('days');
          //days.append(each.dur +' DAY');

          var destAndPort = $('<h2>').append(each.dur +'-Day '+ each.regionName+ ' from '+ each.departurePortName);

          var pricing = $('<div>').addClass('pricing');
          var cruises = $('<p>').addClass('from').append('From');
          var price = $('<div>').addClass('itinPrice').append('<sup class="itinDollar">$</sup>'+each.leadSailing.fromPrice+'<sup class="itinasterisk">*</sup>');
          var pp = $('<p>').addClass('avgperson').append('Average Per Person<br>2 Person Room');
   var cta = $('<a>').addClass('shopnow').attr({ 'aria-label': 'SHOP NOW', 'z-index': '1', 'role': 'button' }).append('Shop Now');
          
          pricing.append(cruises);
          pricing.append(price);
          pricing.append(pp);

          //copy.append(days);
          copy.append(destAndPort);
          copy.append(pricing);
          copy.append(cta);

          card.append(image);
          card.append(copy);
					//adds card to carousel and sets tab index to 0 if its visible. 
          $('.itinCarousel'+extension.carNumber).slick('slickAdd',card);
          $('.itinCard.slick-slide.slick-active').attr('tabindex','0');

        });//ends for each
				
        //build see more card
        var card = $('<a>').addClass('cardSeeMore');
        var extraParams = extension.geoTarget === 'true' || extension.remarketing === 'true' ? extension.params +'&port=' + ports : extension.params; 
        card.attr('href','https://www.carnival.com/cruise-search?cruisedeals='+extension.cruiseDeals+'&numAdults=2&pageNumber=1&showBest=true&sort=fromprice&useSuggestions=true&pageSize=8'+extraParams);
        card.attr('aria-label','See more');
        card.attr('tabindex','-1');
        var price = $('<div>').append('See More');
        price.css({'font-family': '"Open Sans", sans-serif'});
        //var caret = '<i class="fa fa-caret-right" style="margin-left: 5px;"></i>';
        //price.append(caret);
        $(price).css({ 'color': 'white', 'display': 'flex', 'justify-content': 'center', 'align-items': 'center', 'height': '100%'});
        card.append(price);
        $('.itinCarousel'+extension.carNumber).slick('slickAdd',card);
      }
			
      //ADA Fix for focusing on the right thing when the next and prev buttons are pressed.
        $(document).on('click','.slick-next',function(){
        setTimeout(function () {
          $('div.carouselItin > div.itinCarousel'+extension.carNumber+' > div > div > a.itinCard.slick-slide.slick-active').attr('tabindex','0');
  			 $('div.carouselItin > div.itinCarousel'+extension.carNumber+' > div > div > a.itinCard.slick-slide.slick-current.slick-active')[0].focus();
          $('div.carouselItin > div.itinCarousel'+extension.carNumber+' > div > div > a.cardSeeMore.slick-slide.slick-active').attr("tabindex", "0");
           $('div.carouselItin > div.itinCarousel'+extension.carNumber+' > div > div > a.cardSeeMore.slick-slide.slick-current.slick-active').attr("tabindex", "0");
        }, 500);
      });
           $(document).on('click','.slick-prev',function(){
        setTimeout(function () {
          $('div.carouselItin > div.itinCarousel'+extension.carNumber+' > div > div > a.itinCard.slick-slide.slick-active').attr('tabindex','0');
  			 $('div.carouselItin > div.itinCarousel'+extension.carNumber+' > div > div >a.slick-active:last').focus();
           $('div.carouselItin > div.itinCarousel'+extension.carNumber+' > div > div > a.cardSeeMore.slick-slide.slick-active').attr("tabindex", "0");
        }, 500);
      });
    }//ends init function
  });//ends document ready
}//ends start function
      },
      hideFn: function(event) {
        var $ = window.optimizely.get('jquery');
        var widget = event.data.config;
        widget.$id = "20982870686";
        widget.$instance = event.data.id;
        widget.$fieldDefaults = [{"name":"carNumber","default_value":"1"},{"name":"remarketing","default_value":"false"},{"name":"destPage","default_value":"false"},{"name":"ItinRemarketing","default_value":"false"},{"name":"geoTarget","default_value":"true"},{"name":"insertAfterDesktop","default_value":".bucket-2"},{"name":"insertAfterMobile","default_value":".carouselsMobile"},{"name":"headline","default_value":"LAST-MINUTE CRUISE DEALS"},{"name":"icid","default_value":"icp_ccl_XXXXXX_itinCarousel"},{"name":"params","default_value":""},{"name":"numResults","default_value":"8"},{"name":"cruiseDeals","default_value":""},{"name":"cover","default_value":"n"},{"name":"carCoverImg","default_value":"/~/media/Images/hp-merch/2021/extras/carouselCover/shaq-cover-image.ahsx"},{"name":"htmlOverlayCopy","default_value":"<div class=\"coverHeading\">CHECK OUT THESE EXCLUSIVE DEALS JUST FOR YOU</div>"}];
        (function(widg) {
  var i = 0;
  var field;
  for (; i < widg.$fieldDefaults.length; ++i) {
    field = widg.$fieldDefaults[i];
    if (!widg.hasOwnProperty(field.name)) {
      widg[field.name] = field.default_value;
    }
  }
  })(widget);
        var extension = widget;
        widget._styleTag = document.getElementById('widget-css-20982870686');
if (widget._styleTag) widget._styleTag.parentNode.removeChild(widget._styleTag);
        var extensionElement = document.getElementById('optimizely-extension-' + extension.$instance);
if (extensionElement) {
  extensionElement.parentElement.removeChild(extensionElement);
}

      },
    });

PluginManager.registerWidget({
      widgetId: '30018260781',
      showFn: function(event) {
        var $ = window.optimizely.get('jquery');
        var widget = event.data.config;
        var _template = new Hogan(function(c,p,i) {var t=this;t.b(i=i||"");t.b("   <div class=\"upLiftShell\" tabindex=\"-1\"> ");t.b("\n" + i);t.b("  <div class=\"upLiftLeftSide\" tabindex=\"-1\">");t.b("\n" + i);t.b("    <img class=\"upLiftLogo\" tabindex=\"-1\" alt=\"Financing powered by Flex Pay logo\" src=\"/~/media/Images/hp-merch/2024/extras/graphics/flex-pay-stacked-svg.svg\"> ");t.b("\n" + i);t.b("        <img class=\"upLiftLogoMbl\" alt=\"Financing powered by Flex Pay logo\" src=\"/~/media/Images/hp-merch/2024/extras/graphics/flex-pay-long-svg.svg\">");t.b("\n" + i);t.b(" ");t.b("\n" + i);t.b("     </div>");t.b("\n" + i);t.b("   <div class=\"upLifRightSide\" tabindex=\"-1\">");t.b("\n" + i);t.b("    <span class=\"upLiftRightHead\" aria-label=\"");t.b(t.v(t.d("extension.subHeadline",c,p,0)));t.b("\" tabindex=\"-1\">");t.b(t.v(t.d("extension.subHeadline",c,p,0)));t.b("</span>");t.b("\n" + i);t.b("<div style=\"display: flex;\" class=\"zerodown\" tabindex=\"-1\" aria-label=\"$0 DOWN + INTEREST-FREE\">");t.b("\n" + i);t.b("      <span class=\"upLiftAttribtutes\" tabindex=\"-1\"><sup class=\"upliftDollarPercent\">$</sup>0 DOWN</span>");t.b("\n" + i);t.b("      <span class=\"upLiftPlusSign\" tabindex=\"-1\">+</span><span class=\"upLiftAttribtutes interest-free\">INTEREST-FREE</span>");t.b("\n" + i);t.b("    </div>");t.b("\n" + i);t.b("    <span class=\"eligibilityMicroCopy\" aria-label=\"Get Estimate\" >Estimate how much you can spend with low monthly payments.</span>");t.b("\n" + i);t.b("      <span class=\"terms upliftTC\" style=\"     text-decoration: underline; cursor:pointer \"aria-label=\"Link to terms and conditions\" aria-haspopup=\"dialog\" >Terms and conditions apply</span>");t.b("\n" + i);t.b("   ");t.b("\n");t.b("\n" + i);t.b("     </div>");t.b("\n" + i);t.b("      <div class=\"upliftButton\" >");t.b("\n" + i);t.b("    <button tabindex=\"0\" role=\"link\" class=\"cta-button ctaHover upliftLearnMore upliftButton\" data-up-prequal=\"\" id=\"upliftLearnMore\" aria-label=\"Get Estimate\" haspopup=\"dialog\"  style=\"    margin-bottom: -1%;border-radius:4px\">");t.b("\n" + i);t.b(t.t(t.d("extension.upliftButton",c,p,0)));t.b("\n" + i);t.b("  </button>");t.b("\n" + i);t.b("          <span class=\"upliftEligibility\"><sup  aria-hidden=\"true\"></sup>Not everyone is eligible.</span>");t.b("\n" + i);t.b("  </div>");t.b("\n" + i);t.b("</div>");return t.fl(); })
        widget.$id = "30018260781";
        widget.$instance = event.data.id;
        widget.$render = _template.render.bind(_template)
        widget.$fieldDefaults = [{"name":"inserAfterDesktop","default_value":".row-2-wrap"},{"name":"additionalStyles","default_value":""},{"name":"location","default_value":"beforebegin"},{"name":"btiletoggle","default_value":"sec-banner"},{"name":"subHeadline","default_value":"BOOK TODAY. PAY OVER TIME."},{"name":"upliftButton","default_value":"<span>GET ESTIMATE<sup style=\"margin-left: 1px;\"></sup></span>"}];
        (function(widg) {
  var i = 0;
  var field;
  for (; i < widg.$fieldDefaults.length; ++i) {
    field = widg.$fieldDefaults[i];
    if (!widg.hasOwnProperty(field.name)) {
      widg[field.name] = field.default_value;
    }
  }
  })(widget);
        widget.$html = _template.render({ widget: widget, extension: widget })
        var extension = widget;
        widget._styleTag = document.createElement('style');
widget._styleTag.id = 'widget-css-30018260781';
widget._styleTag.innerHTML = '/*UPLIFT CSS*/.terms-link{text-decoration:underline}.terms{  font-family: "Open Sans", helvetica;  text-transform: none !important;  display: flex;  color: #1d4f91;    border: none;    background: none;}  .upliftDollarPercent{    font-size: .5em !important;    line-height: 1.45 !important;  }  .upLiftLogoMbl {display:none;}.upliftEligibility{  color: #1d4f91;}.cta-button  {background: #dc1125!important;}.shell-10{background-color:white}.shell-9{margin-top:16px}.upliftBanner, #upliftLearnMore {  box-shadow: 0px 0px 6px rgb(24 24 24 / 18%);}.eligibilityMicroCopy {  font-size: 12px;  font-family: "Open Sans", helvetica;  text-transform: none !important;  display: flex;    color: #1d4f91;  justify-content: center;  line-height: 18px;}.lpgg-container{display: none;}.upliftBbanner h2{font-size:2rem;font-family: tempo;text-transform: uppercase;}.upliftLearnMore:hover{cursor: pointer;}.upLifRightSide{display: flex;    color: #1d4f91;flex-direction: column;align-items: center;}.upLiftRightHead{font-size: 2.5em;letter-spacing: 2px;}.upliftWellQualifiedGuest{color: #fff;font-size: 1.8em;letter-spacing: 2px;margin-top: 5px;}.upLiftPlusSignHead{font-size: 3em;font-weight: 700;  margin: 1px 17px;    color: #1d4f91;}.upLiftAttribtutesHead{    font-family: tempo;    color: #1d4f91;  font-size: 2.5em;  line-height: 1;  display: flex;  margin-top: 2%;}.upliftSixMonths{font-family: sans-serif;font-size: 0.36em;font-weight: 700;position: relative;margin-top: -5px;margin-left: 10px;}.upliftBannerDagger{font-family: sans-serif;font-size: 0.5em !important;font-weight: 700;}.upliftModal{background: #fff;width: 95vw;max-width: 830px;height: 90vh;max-height: 330px;display: none;justify-content: space-evenly;align-items: center;position: absolute;top: 50%;left: 50%;transform: translate(-50%,-50%);z-index: 10001;flex-direction: column;}.upliftContainer{width: 100%;display: flex;flex-direction: column;justify-content: center;align-items: center;}.upliftIcons{display: flex;width: 100%; justify-content: center;justify-content: space-evenly;}.upliftIcon{width: 30%;display: flex;align-items: flex-start;}.upLiftIconCopyHeading{font-family: tempo;font-size: 2.7em;    color: #1d4f91;  line-height: 0.9;}.upLiftIconCopyBody{font-size: 1.3em;    color: #1d4f91;margin-top: 5px;}.upliftIcon img{height: 65px;margin-right: 5px;}.upLiftLogo{width: 27em;background-image:url("")}.upLiftLogoMbl {display:none;}@media screen and (max-width: 1400px){.upliftToutLogo{  width: 75%;  padding: 5px 0 5px;}}@media screen and (min-width: 1200px) and (max-width: 1300px){.upLiftLogo {  width: 25em!important;} .upLiftRightHead {  font-size: 2em!important;} .upLiftAttribtutes {        font-size: 4.5em !important;} .upLiftPlusSign {  margin: 3px 17px!important;} .eligibilityMicroCopy {}}@media screen and (max-width: 1200px){.upliftToutLogo{  width: 75%;  padding: 10px 0 10px;}}@media screen and (max-width: 1000px){.upliftToutLogo{  width: 80%;  padding: 10px 0 10px;}}@media screen and (max-width: 950px){.upliftToutLogo{  padding-bottom: 10px;}}.cta-button {  clear: both;  border-radius: 0;  font-size: 170%;  font-family: "tempo", sans-serif;  border: none;  display: inline-block;  margin: 20px 0 0 0;  padding: 16px 32px;  line-height: 1;  text-transform: uppercase;  cursor: pointer;  color: #FFF;  background: #DC1125;  border-radius: 4px;}@media only screen and (max-device-width: 400px) {.eligibilityMicroCopy{  text-align: center;      font-size: 11px!important;}}@media only screen and (min-device-width: 412px) {}@media only screen and (min-device-width: 320px) and (max-device-width: 850px)  {.upLiftLogoMbl{width: 75%;margin-bottom: 10px;  display:block!important;      border-bottom: 2px #1d4f91 solid;          padding-bottom: 10px;  margin-bottom: 2%;}.upLiftRightHead {  font-size: .45em;  letter-spacing: 2px;}  .upLiftShell{max-width: 1400px;margin: auto;background: white;display: flex;justify-content: center;align-items: center;position: relative;        line-height: .9;  font-size: 2.4rem!Important;  padding: 24px;  flex-direction: column;  color:#1d4f91;     box-shadow: 0px 0px 6px rgb(24 24 24 / 18%);}  .upliftLearnMore{font-size: 1rem;color: #fff;border-bottom: solid 1px #fff;}.shell-8{    display: flex;  flex-direction: column;      padding: 24px;  align-items: center;  justify-content: center;}.upLifRightSide{min-width: 47%;display: flex;   font-family: "Open-sans", sans-serif;    color:#1d4f91;    margin-top: 1.5%;flex-direction: column;align-items: center;}  .upLiftLeftSide {     padding-right: 0PX;  margin-left: 0PX;  font-size: 22px;  margin-bottom: 10px;  display: flex;  flex-direction: column;  align-items: center;}.upLiftPlusSign {  font-size: 1.2em!important;  font-weight: 700;  color: #1d4f91;  margin: -4px 0 10px 0!important;}.zerodown{    display: flex;  flex-direction: column;      font-family: tempo;  align-items: center;margin-top: 16px;  margin-bottom: 8px;}.upLiftAttribtutesHead{  font-size: .8em!important;  text-shadow: none;    font-family: "tempo"!important;display: flex;}  .upLiftAttribtutes {        font-size: 2.4rem !important;        display: flex;        align-items: center;        flex-direction: row;  }.upliftDollarPercent{    margin-top: 9px;}.upLiftPlusSignHead {    font-size: .8em;}.upliftButton{display: flex;  flex-direction: column;  align-items: center;  justify-content: center;}.upLiftLogo {display:none;}.upliftEligibility { margin-bottom: 8px;  font-size: 12px;  font-family: "Open Sans",Helvetica;  position: relative;}.eligibilityMicroCopy {  font-size: 11.7px;  font-family: "Open Sans", helvetica;  text-transform: none !important;  display: flex;  justify-content: center;    text-align: center;  line-height: 18px;}.cta-button  {  background: #dc1125;  clear: both;  color: #fff;  border-radius: 0;  font-size: 14px!important;  font-family: "tempo", sans-serif;  border: none;  display: inline-block;  margin-top: 12px!important;  margin-bottom: 10px!important;    padding: 10px 20px 10px 20px;  line-height: 1;  text-transform: uppercase;  transition: all 0.23s ease-in-out;  cursor: pointer;  font-weight: normal;}.terms{    position: absolute;  bottom: 5px;    font-size: .3em;}}@media only screen and (min-device-width: 960px) {.eligibilityMicroCopy {        font-size: 16px !important;        margin-bottom: 8px;}.upliftDollarPercent {    font-size: .5em !important;    line-height: 1.8 !important;}.upLiftLeftSide{  border-right: solid 2px #1d4f91;  display: flex;  flex-direction: column;  align-items: center;  padding-right: 55px;  margin-right: 65px;}.upliftButton{        display: flex;  flex-direction: column;  align-items: center;}.terms{         margin-bottom: -7%;        padding-top: 3%;        align-self: center;}/*UPLIFT CSS*/.upLiftShell{max-width: 1400px;margin: auto;   box-shadow: 0px 0px 6px rgb(24 24 24 / 18%);  padding: 40px;  margin-top: 15px;background: white;display: flex;justify-content: center;align-items: center;position: relative;}.upliftEligibility {display:flex;  font-size: 12px;  line-height: 20px;    display: flex;margin-top:5px;  align-items: center;}.lpgg-container{display: none;}.upliftBbanner h2{font-size:2rem;font-family: tempo;text-transform: uppercase;}/*.upLiftLeftSide{    border-right: solid 2px #1d4f91;  display: flex;  flex-direction: column;  align-items: center;  padding-right: 55px;  margin-right: 50px;  margin-right: 55px;}*/.upliftLearnMore{font-size: 1.6rem;margin-top: 5px;padding-bottom: 3px;position: relative;border-bottom: solid 1px #1d4f91;}.upliftLearnMore:hover{cursor: pointer;}.upLifRightSide{display: flex;  margin-right: 5%;  margin-left: 0%;flex-direction: column;align-items: center;}.upLiftRightHead{font-size: 2em;letter-spacing: 2px;    margin-top: -10px;}.upliftWellQualifiedGuest{font-size: 1.8em;letter-spacing: 2px;margin-top: 5px;}.upLiftAttribtutes{font-family: tempo;  font-size: 4.8em;  display: flex;}    .upLiftPlusSign {        font-size: 4.5em;        font-weight: 700;        color:  #1d4f91;        margin: 3px 17px !important;    }.zerodown{        margin-top: 5px;        margin-bottom: 3px;}}.upLiftPlusSign{font-size: 4.5em;font-weight: 700;color:   #1d4f91;margin: -6px 17px;}.upliftSixMonths{font-family: sans-serif;font-size: 0.36em;font-weight: 700;position: relative;margin-top: -5px;margin-left: 10px;}.upliftBannerDagger{font-family: sans-serif;font-size: 0.5em !important;font-weight: 700;}.upliftModal{background: #fff;width: 95vw;max-width: 830px;height: 90vh;max-height: 330px;display: none;justify-content: space-evenly;align-items: center;position: absolute;top: 50%;left: 50%;transform: translate(-50%,-50%);z-index: 10001;flex-direction: column;}.upliftContainer{width: 100%;display: flex;flex-direction: column;justify-content: center;align-items: center;}.upliftIcons{display: flex;width: 100%; justify-content: center;justify-content: space-evenly;}.upliftIcon{width: 30%;display: flex;align-items: flex-start;}.upLiftIconCopyHeading{font-family: tempo;font-size: 2.7em;color:   #1d4f91;line-height: 0.9;}.upLiftIconCopyBody{font-size: 1.3em;color:  #1d4f91;margin-top: 5px;}.upliftIcon img{height: 65px;margin-right: 5px;}.upLiftLogo{width: 27em;background-image:url("")}.upLiftLogoMbl {display:none;}@media screen and (max-width: 1400px){.upliftToutLogo{  width: 75%;  padding: 5px 0 5px;}}@media screen and (max-width: 1200px){.upliftToutLogo{  width: 75%;  padding: 10px 0 10px;}}@media screen and (max-width: 1000px){.upliftToutLogo{  width: 80%;  padding: 10px 0 10px;}}@media screen and (max-width: 950px){.upliftToutLogo{  padding-bottom: 10px;}}.cta-button {  clear: both;  border-radius: 0;  font-size: 170%;  font-family: "tempo", sans-serif;  border: none;  display: inline-block;  margin: 20px 0 0 0;  padding: 16px 32px;  line-height: 1;  text-transform: uppercase;  cursor: pointer;  color: #FFF;  background: #DC1125;  border-radius: 4px;}@media only screen and (-webkit-min-device-pixel-ratio: 1.25),only screen and (-webkit-min-device-pixel-ratio: 1.5),only screen and (-webkit-min-device-pixel-ratio: 1.75),only screen and (-webkit-min-device-pixel-ratio: 2),only screen and (-webkit-min-device-pixel-ratio: 2.5),only screen and (-webkit-min-device-pixel-ratio: 3),only screen and (-webkit-min-device-pixel-ratio: 4) {  .bannerMOBHPMG-content .headline {      display: flex !important;      flex-direction: column;      align-items: center;  }  .bannerMOBHPMG-content p {      display: flex !important;      justify-content: center;  }}/*Uplift Terms Modal*/.upliftTC { }.upliftModalBackground {  background: #000000;  mix-blend-mode: normal;  opacity: 0.4;  height: 100%;  z-index: 10000;  position: fixed;  top: 0;  width: 100vw;  display: none;}.upliftModal {  background: #FFFFFF;  box-shadow: 0px 0px 6px rgb(0 0 0 / 18%);  position: fixed;  right: 8px;  padding: 24px 16px;  width: 98%;  top: 50%;  left: 50%;  display: none;  max-width: 952px;  height: 90vh;  max-height: 90vh;  transform: translate(-50%,-50%);  z-index: 10001;  overflow: scroll;  border-radius: 8px;}.closeUpliftModal {  position: absolute;  right: 24px;  top: 24px;  width: 16px;          background: none;        border: none;  cursor: pointer;}.upLiftTopSideModal {  width: 75%;  border-bottom: solid 1px #1d4f91;  display: flex;  flex-direction: column;  margin: 0 auto;}.upliftBookNowModalHeader {  text-align: center;  margin: 16px 0;  font-family: "tempo";  color: #1d4f91;  font-size: 32px;}.upLiftLogoModal {  width: 100%;  margin-bottom: 16px;}.upliftOfferContainer {  display: flex;  flex-direction: column;  color: #1d4f91;  font-family: "tempo";  justify-content: space-evenly;}.upliftMessageHeader {  display: flex;  flex-direction: column;  font-size: 32px;}.upliftMessageSubHeader {  font-family: "Open Sans";  font-size: 12px;  line-height: 16px;}.zeroDownUpliftContainer,.upliftPercentOfferContainer,.easyAppContainer {  display: flex;  flex-direction: column;  align-items: center;  text-align: center;  padding-bottom: 8px;}.upliftModalZeroHeading,.upliftPercentHeader {  font-size: 40px;  height: 48px;}.upliftModalZeroHeading sup {  font-size: 24px;  position: relative;  top: -0.5em;}.upliftPercentHeading {  display: flex;  flex-direction: row;}.upliftModalDisclaimer {  padding-top: 16px;  border-top: 1px solid #cbc9c9;  font-family: "open sans";  font-size: 16px;  line-height: 20px;  color: #464646;}.upliftModalDisclaimer a {  color: #10559a;}.upliftCheckMark {  width: 40px;  padding-bottom: 8px;}.zeroPercentSubheading {  font-size: 16px;  padding-top: 4px;}#upliftLearnMore .headline>p {  border-bottom: 1px solid #ffffff;  width: 70%;  margin: 0 auto 16px;  padding-bottom: 16px;}#upliftLearnMore .headline>img {  border: none !important;}.upLiftAttributes {  font-weight: normal !important;}@media (min-width: 767px) {  .upliftModal {      max-height: auto;      overflow: hidden;      padding: 48px;      max-width: 872px;      height: auto;  }  .upliftOfferContainer {      flex-direction: row;  }  .upLiftTopSideModal {      width: 50%;  }  .upliftModalZeroHeading sup {      top: 4px;  }  .closeUpliftModal {      top: 48px;      right: 48px;          width: 24px;  }  .upliftEligibility {      padding-top: 8px;  }}';
document.getElementsByTagName('head')[0].appendChild(widget._styleTag);
        var $ = jQuery;
var utils = window.optimizely.get('utils');

var utils = optimizely.get('utils');


utils.waitForElement('.upLiftShell').then(function(elem){
  
   if($(window).width() > 960) {
$('.upLiftShell').wrap('<div class="upliftBanner'+' ' + extension.btiletoggle+'"tabindex="-1" aria-label="uplift banner container" style=" '+extension.additionalStyles+'"></div>');
}  if($(window).width() < 960) {
$('.upLiftShell').wrap('<div class="c-hero shell-10" ></div>');  
}
  
});



utils.waitForElement(extension.inserAfterDesktop)
    .then(function() {
    // append the extension html to the body
   $(extension.inserAfterDesktop).append(extension.$html);
 
  
  
  //execute uplift 
  (function(u,p,l,i,f,t,b,j){u['UpLiftPlatformObject']=f;u[f]=u[f]||function() {(u[f].q=u[f].q||[]).push(arguments)},u[f].l=1*new Date();b=p.createElement(l),j=p.getElementsByTagName(l)[0];b.async=1;b.src=i+'?id='+t;j.parentNode.insertBefore(b,j);var o=window.location.host.match(/[w-]+.w{2,3}(:d+)?$/);if(o)o=o[0];u[f]('create',t,o)})(window,document,'script','//cdn.uplift-platform.com/a/up.js','up','UP-20956569-1')
 
utils.observeSelector(".upLiftShell", function(element) {
  utils.waitUntil(function() {
    return window.Uplift != undefined
  }).then(function() {
    if(!$('.upLiftShell').length){
  
 
      //This is the part where the  data-up-prequal needs to already be on the page for it to work.
      window.Uplift.Payments.init({
        apiKey: "Lou3hjx2b66WvIeiQFfEOM6efiYwlF29U1NpGnt1", 
        locale: "en-US",
        currency: "USD"
      });
      window.Uplift.Payments.load(); 
    }
  });
}, {
  "timeout": 20000,
  "once": false,
  "onTimeout": function() {
    console.log("Stopped observing");
  }
});
  });




//Mobile
(function(u,p,l,i,f,t,b,j){u['UpLiftPlatformObject']=f;u[f]=u[f]||function() {(u[f].q=u[f].q||[]).push(arguments)},u[f].l=1*new Date();b=p.createElement(l),j=p.getElementsByTagName(l)[0];b.async=1;b.src=i+'?id='+t;j.parentNode.insertBefore(b,j);var o=window.location.host.match(/[w-]+.w{2,3}(:d+)?$/);if(o)o=o[0];u[f]('create',t,o)})(window,document,'script','//cdn.uplift-platform.com/a/up.js','up','UP-20956569-1')
 
utils.waitForElement('.upLiftShell').then(function(elem) {
  document.querySelector('.upLiftShell');
 
  utils.waitUntil(function() {
    return window.Uplift != undefined;
  }).then(function() {
    console.log((extension.order))
    //This is the part where the  data-up-prequal needs to already be on the page for it to work.
    window.Uplift.Payments.init({
      apiKey: "Lou3hjx2b66WvIeiQFfEOM6efiYwlF29U1NpGnt1", 
      locale: "en-US",
      currency: "USD"
    });
 
    window.Uplift.Payments.load(); 
  });
});

$('.upliftTC').click(function(e){
    e.preventDefault()
})

$(document).on('keydown', function(e) {
              if (e.keyCode === 9) 	{ // Tab key
            var first = document.querySelector('.open-faq');
            var second = document.querySelector('.modal-close"') ;
            var third =document.querySelector('.edit-icon') ;
			 var fourth =document.querySelector('.row col-xs-12 offer-selector') ;
                 var fifth =document.querySelector('btn btn-lg btn-primary btn-block page-btn') ;
                 var last =document.querySelector('#lender') ;
                          if (e.target === first) {
                    second.focus();
                    e.preventDefault();
                } else if (e.target === second) {
                     third.focus();
                    e.preventDefault();
                } 
      else if (e.target === third) {
                     fourth.focus();
                    e.preventDefault();
                }
                      else if (e.target === fourth) {
                     fifth.focus();
                    e.preventDefault();
                }
                   else if (e.target === last) {
                     first.focus();
                    e.preventDefault();
                }
        }
        });
utils.waitForElement('body').then(function () {
    $(document).ready(function () {
        var $ = jQuery;
        $('body').append('<div class="upliftModal" tabindex="-1"></div>');
        $('body').append('<div class="upliftModalBackground">');
        $('.upliftModal').prepend('<div class="upLiftTopSideModal" tabindex="-1"><img class="upLiftLogoModal" aria-label="Flex Pay Terms and conditions" src="https://www.carnival.com/~/media/Images/hp-merch/2024/extras/graphics/flex-pay-long-svg.svg"  role="dialog"><button class="closeUpliftModal" aria-label="Close Flex Pay Terms and conditions"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"  aria-hidden="true" ><path d="M14.1216 12.0003L20.5318 5.59011L21.8537 4.2682C22.0487 4.07319 22.0487 3.75631 21.8537 3.5613L20.4393 2.14688C20.2443 1.95187 19.9274 1.95187 19.7324 2.14688L12.0003 9.879L4.2682 2.14625C4.07319 1.95125 3.7563 1.95125 3.5613 2.14625L2.14625 3.56067C1.95125 3.75568 1.95125 4.07256 2.14625 4.26757L9.879 12.0003L2.14625 19.7324C1.95125 19.9274 1.95125 20.2443 2.14625 20.4393L3.56067 21.8537C3.75568 22.0487 4.07256 22.0487 4.26757 21.8537L12.0003 14.1216L18.4105 20.5318L19.7324 21.8537C19.9274 22.0487 20.2443 22.0487 20.4393 21.8537L21.8537 20.4393C22.0487 20.2443 22.0487 19.9274 21.8537 19.7324L14.1216 12.0003Z" fill="#10559A"/></svg></button></div>');
        $('<div class="upliftBookNowModalHeader" tabindex="-1">BOOK NOW. PAY OVER TIME.</div><div class="upliftOfferContainer"><div class="zeroDownUpliftContainer"><span class="upliftModalZeroHeading"><sup>$</sup>0<sup></sup></span><div><span class="upliftMessageHeader">ZERO DOWN</span><span class="upliftMessageSubHeader">BOOK TODAY TO LOCK IN YOUR <br />CRUISE WITH ZERO DOWN.</span></div></div><div class="upliftPercentOfferContainer"><span class="upliftPercentHeading"><span class="upliftPercentHeader">0</span><span class="zeroPercentSubheading">%<br/>APR</span></span><span class="upliftMessageHeader"><span class="upliftMessageHeader">INTEREST-FREE</span><span class="upliftMessageSubHeader">AVAILABLE ON ALL SAILINGS</span></div><div class="easyAppContainer"><img class="upliftCheckMark" src="//cdn.optimizely.com/img/752671897/26459627c8f6490ba4a7ebcc32c48d61.svg" alt=""><span class="upliftMessageHeader">EASY APPLICATION</span><span class="upliftMessageSubHeader">RECEIVE A QUICK DECISION</span></div></div><div class="upliftModalDisclaimer">Based on a purchase price of $1,122.00 you could pay $0 today, followed by 18 monthly payments of $70.00 at 15% APR.  APRs range from 0%-36%; 0% APR available to all approved applicants on select terms.  Actual terms are based on your credit score and other factors and may vary.  Not everyone is eligible.  Loans made through Flex Pay by Upgrade are offered by <a aria-label="Flex Pay&#39;s Lending Partners. External site which may or may not meet accessibility guidelines." href="https://www.upgrade.com/flex-pay/lenders/">Flex Pay&#39;s Lending Partners</a>. <a aria-label="Privacy Policy. External site which may or may not meet accessibility guidelines." href="Hyperlink for Privacy Policy: https://www.upgrade.com/flex-pay/privacy/">Privacy Policy</a>. <a aria-label="Terms of Use. External site which may or may not meet accessibility guidelines." href="https://www.upgrade.com/flex-pay/terms/">Terms of Use</a>. Flex Pays address: 275 Battery St 23rd Floor, San Francisco, CA 94111</div>').insertAfter('.upLiftTopSideModal');
       
        $(document).on('click', '.upliftTC', function () {
            $('.upliftModal').attr('style', 'display: block;');
            $('.upliftModalBackground').attr('style', 'display: block;');
            $('.upliftModal').focus();
            $('body').attr('style', 'overflow: hidden;');
            // $('[src="//cdn.optimizely.com/img/752671897/7fb2547a1ef24dad9317cd430d4cc464.svg"]').attr({
            //     tabindex: "0",
            //     'aria-label': "close terms and conditions button",
            //     role: 'button'
            // });
        });
   
        $(document).on('click', '.upliftModalBackground, .closeUpliftModal', function () {
            if($('.upliftModal:visible')) {
                $('.upliftModal').attr('style', 'display: none;');
                $('.upliftModalBackground').attr('style', 'display: none;');
                $('body').attr('style', 'overflow: scroll;');
            }
        });
 
        $(document).on('keypress','.closeUpliftModal', function (e) {
            if (e.key == 13) { // keyCode 13 should be 'enter' button
                if($('.upliftModal:visible')) {
                    $('.upliftModal').attr('style', 'display: none;');
                    $('.upliftModalBackground').attr('style', 'display: none;');
                    $('body').attr('style', 'overflow: scroll;');
                }
            }
            });

 $(document).keydown(function(e) {
    // ESCAPE key pressed
    if (e.keyCode == 27) {
     if($('.upliftModal:visible')) {
        $('.upliftModal').attr('style', 'display: none;');
               $('.upliftModal').attr('aria-hidden', 'true');
        $('.upliftModalBackground').attr('style', 'display: none;');
        $('body').attr('style', 'overflow: scroll;');
                }
    }
});
});
});
function handleTabUplift (e) {
    //check for tab
    if (e.keyCode === 9) {
        var modal = $('.upliftModal');
        if($('.upliftModal:visible')) {
            if(e.target === modal) {
                $('.upliftModal img').focus();
                e.preventDefault();
            }
            else if(e.target === $('.upliftModal img')) {
                $('.upliftModalDisclaimer a')[0].focus();
                e.preventDefault();
            }
            else if(e.target === $('.upliftModalDisclaimer a')[0]) {
                $('.upliftModalDisclaimer a')[1].focus();
                e.preventDefault();
            }
            else if(e.target === $('.upliftModalDisclaimer a')[1]) {
                $('.upliftModalDisclaimer a')[2].focus();
                e.preventDefault();
            }
            else if(e.target === $('.upliftModalDisclaimer a')[2]) {
                $(modal).focus();
                e.preventDefault();
            }
        } else {
            window.removeEventListener('keydown', handleTabUplift);
        }
    }
}
 
window.addEventListener('keydown', handleTabUplift);
      },
      hideFn: function(event) {
        var $ = window.optimizely.get('jquery');
        var widget = event.data.config;
        widget.$id = "30018260781";
        widget.$instance = event.data.id;
        widget.$fieldDefaults = [{"name":"inserAfterDesktop","default_value":".row-2-wrap"},{"name":"additionalStyles","default_value":""},{"name":"location","default_value":"beforebegin"},{"name":"btiletoggle","default_value":"sec-banner"},{"name":"subHeadline","default_value":"BOOK TODAY. PAY OVER TIME."},{"name":"upliftButton","default_value":"<span>GET ESTIMATE<sup style=\"margin-left: 1px;\"></sup></span>"}];
        (function(widg) {
  var i = 0;
  var field;
  for (; i < widg.$fieldDefaults.length; ++i) {
    field = widg.$fieldDefaults[i];
    if (!widg.hasOwnProperty(field.name)) {
      widg[field.name] = field.default_value;
    }
  }
  })(widget);
        var extension = widget;
        widget._styleTag = document.getElementById('widget-css-30018260781');
if (widget._styleTag) widget._styleTag.parentNode.removeChild(widget._styleTag);
        var extensionElement = document.getElementById('optimizely-extension-' + extension.$instance);
if (extensionElement) {
  extensionElement.parentElement.removeChild(extensionElement);
}

      },
    });

PluginManager.registerWidget({
      widgetId: '30286280430',
      showFn: function(event) {
        var $ = window.optimizely.get('jquery');
        var widget = event.data.config;
        var _template = new Hogan(function(c,p,i) {var t=this;t.b(i=i||"");t.b("<div onclick=\"window.location.href='");t.b(t.v(t.d("extension.link",c,p,0)));t.b("'\" id=\"optimizely-extension-");t.b(t.v(t.d("extension.$instance",c,p,0)));t.b("\" style=\"");t.b(t.v(t.d("extension.additionalStyles",c,p,0)));t.b("\" class=\"");t.b(t.v(t.d("extension.btiletoggle",c,p,0)));t.b(" ctile\" tabindex=\"-1\" >");t.b("\n" + i);t.b("  ");t.b(t.t(t.d("extension.innerHTML",c,p,0)));t.b("\n" + i);t.b("</div>");return t.fl(); })
        widget.$id = "30286280430";
        widget.$instance = event.data.id;
        widget.$render = _template.render.bind(_template)
        widget.$fieldDefaults = [{"name":"inserAfterDesktop","default_value":".row-2-wrap"},{"name":"additionalStyles","default_value":"background-image: url(/~/media/Images/hp-merch/2024/desktop/ctiles/sunglass-friends-ocean.jpg);\n    background-size: cover;\n    background-position: center;\n    background-size: cover;\n    background-repeat: no-repeat;\n    color: white;\n    margin-top: 15px;\n    height: 320px;\n    position: relative;\n    z-index: 1;\n    display: flex;\n    justify-content: center;\n    overflow: hidden;\n    align-items: center;"},{"name":"innerHTML","default_value":"   <span \n\trole=\"link\" \n\taria-label=\"shop this deal,three days only! extra bonus savings\" \n\tclass=\"CTileCTA ctaHover hp-text-shadow-none\" \n\tstyle=\"font-size: 170%;\" \n\ttabindex=\"0\" \n\tonkeypress=\"if (event.key === 'Enter') {window.location.href = '/cruise-search?cruisedeals=earlysaversale&icid=icp_ccl_earlysaversale_082224_hm_h1&rateCodes='; }\" >SHOP THIS DEAL\n   </span>"},{"name":"link","default_value":"/cruise-search?cruisedeals=earlysaversale&icid=icp_ccl_earlysaversale_082224_ctile&rateCodes="},{"name":"location","default_value":"afterend"},{"name":"btiletoggle","default_value":"sec-banner"},{"name":"altText","default_value":""}];
        (function(widg) {
  var i = 0;
  var field;
  for (; i < widg.$fieldDefaults.length; ++i) {
    field = widg.$fieldDefaults[i];
    if (!widg.hasOwnProperty(field.name)) {
      widg[field.name] = field.default_value;
    }
  }
  })(widget);
        widget.$html = _template.render({ widget: widget, extension: widget })
        var extension = widget;
        widget._styleTag = document.createElement('style');
widget._styleTag.id = 'widget-css-30286280430';
widget._styleTag.innerHTML = '.CTileCTA {    clear: both;    font-family: "tempo", sans-serif;    line-height: 1;    text-transform: uppercase;    cursor: pointer;    color: #FFF;    background: #DC1125;    border-radius: 4px;    text-shadow: none;    border: none;    display: inline-block;    padding: 16px 32px;    font-size: 18.7px;    border-radius: 4px;}.sec-banner{  margin:auto;  max-width: 1400px;}.sec-banner:hover{  cursor:pointer;}.sec-banner-b-tile{  margin:auto;  max-width: 1400px;}.sec-banner-b-tile:hover{  cursor:pointer;}';
document.getElementsByTagName('head')[0].appendChild(widget._styleTag);
        var utils = optimizely.get('utils');

utils.waitForElement(extension.inserAfterDesktop)
  .then(function(elem) {
    // Prepend the extension html to the body
    elem.insertAdjacentHTML(extension.location, extension.$html);
  $('.cTileCta').attr('tabindex', '0');
  $('.ctile').removeAttribute("role");
  });

      },
      hideFn: function(event) {
        var $ = window.optimizely.get('jquery');
        var widget = event.data.config;
        widget.$id = "30286280430";
        widget.$instance = event.data.id;
        widget.$fieldDefaults = [{"name":"inserAfterDesktop","default_value":".row-2-wrap"},{"name":"additionalStyles","default_value":"background-image: url(/~/media/Images/hp-merch/2024/desktop/ctiles/sunglass-friends-ocean.jpg);\n    background-size: cover;\n    background-position: center;\n    background-size: cover;\n    background-repeat: no-repeat;\n    color: white;\n    margin-top: 15px;\n    height: 320px;\n    position: relative;\n    z-index: 1;\n    display: flex;\n    justify-content: center;\n    overflow: hidden;\n    align-items: center;"},{"name":"innerHTML","default_value":"   <span \n\trole=\"link\" \n\taria-label=\"shop this deal,three days only! extra bonus savings\" \n\tclass=\"CTileCTA ctaHover hp-text-shadow-none\" \n\tstyle=\"font-size: 170%;\" \n\ttabindex=\"0\" \n\tonkeypress=\"if (event.key === 'Enter') {window.location.href = '/cruise-search?cruisedeals=earlysaversale&icid=icp_ccl_earlysaversale_082224_hm_h1&rateCodes='; }\" >SHOP THIS DEAL\n   </span>"},{"name":"link","default_value":"/cruise-search?cruisedeals=earlysaversale&icid=icp_ccl_earlysaversale_082224_ctile&rateCodes="},{"name":"location","default_value":"afterend"},{"name":"btiletoggle","default_value":"sec-banner"},{"name":"altText","default_value":""}];
        (function(widg) {
  var i = 0;
  var field;
  for (; i < widg.$fieldDefaults.length; ++i) {
    field = widg.$fieldDefaults[i];
    if (!widg.hasOwnProperty(field.name)) {
      widg[field.name] = field.default_value;
    }
  }
  })(widget);
        var extension = widget;
        widget._styleTag = document.getElementById('widget-css-30286280430');
if (widget._styleTag) widget._styleTag.parentNode.removeChild(widget._styleTag);
        var extensionElement = document.getElementById('optimizely-extension-' + extension.$instance);
if (extensionElement) {
  extensionElement.parentElement.removeChild(extensionElement);
}

      },
    });

PluginManager.registerWidget({
      widgetId: '30291230470',
      showFn: function(event) {
        var $ = window.optimizely.get('jquery');
        var widget = event.data.config;
        var _template = new Hogan(function(c,p,i) {var t=this;t.b(i=i||"");t.b("<div onclick=\"window.location.href='");t.b(t.v(t.d("extension.lnk",c,p,0)));t.b("'\" id=\"optimizely-extension-");t.b(t.v(t.d("extension.$instance",c,p,0)));t.b("\" class=\"hero-header hero1\" style=\"background-color: ");t.b(t.v(t.d("extension.backgroundColor",c,p,0)));t.b("; background-image: url(");t.b(t.v(t.d("extension.img",c,p,0)));t.b(");\">");t.b("\n" + i);t.b("  	<div class=\"heroContainer\">");t.b("\n" + i);t.b("			");t.b(t.t(t.d("extension.openhtml",c,p,0)));t.b("\n" + i);if(t.s(t.d("extension.waterMark",c,p,1),c,p,0,325,605,"{{ }}")){t.rs(c,p,function(c,p,t){t.b("  <p class=\"waterMark\" style=\"text-shadow:2px 2px 2px ");t.b(t.v(t.d("extension.waterShadowColor",c,p,0)));t.b("; position:absolute; top:");t.b(t.v(t.d("extension.top",c,p,0)));t.b("; right:");t.b(t.v(t.d("extension.right",c,p,0)));t.b("; bottom:");t.b(t.v(t.d("extension.bottom",c,p,0)));t.b("; left:");t.b(t.v(t.d("extension.left",c,p,0)));t.b("; color:");t.b(t.v(t.d("extension.waterTextColor",c,p,0)));t.b("\">");t.b(t.v(t.d("extension.waterMark",c,p,0)));t.b("</p>");t.b("\n" + i);});c.pop();}t.b("  </div>");t.b("\n" + i);t.b("</div>");return t.fl(); })
        widget.$id = "30291230470";
        widget.$instance = event.data.id;
        widget.$render = _template.render.bind(_template)
        widget.$fieldDefaults = [{"name":"img","default_value":"/~/media/Images/hp-merch/2019/desktop/heros/0306_Emeril_H2.jpg"},{"name":"altText","default_value":""},{"name":"lnk","default_value":"/cruise-search?cruisedeals=earlysaversale&icid=icp_ccl_earlysaversale_102423_hm_h1&rateCodes="},{"name":"openhtml","default_value":"  \n\n<div style=\"\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n    margin-top: 2%;\n    margin-left: 30%;\n    \" class=\"hp-text-blue-dark hp-text-shadow-none\">\n    \n \n     \n\n \n\n <a \n\taria-label=\"shop this deal,three days only! extra bonus savings\" \n\tclass=\"heroCTA ctaHover hp-text-shadow-none\" \n\tstyle=\"font-size: 170%;\" \n\ttabindex=\"0\" \n\tonkeypress=\"if (event.key === 'Enter') {window.location.href = '/cruise-search?cruisedeals=earlysaversale&icid=icp_ccl_earlysaversale_082224_hm_h1&rateCodes='; }\" >SHOP THIS DEAL\n   </a>\n  \n</div>"},{"name":"waterMark","default_value":""},{"name":"waterTextColor","default_value":"rgba(16, 85, 154, 1)"},{"name":"waterShadowColor","default_value":"rgba(0, 0, 0, 1)"},{"name":"top","default_value":""},{"name":"right","default_value":"220px"},{"name":"bottom","default_value":"110px"},{"name":"left","default_value":""},{"name":"backgroundColor","default_value":"rgba"}];
        (function(widg) {
  var i = 0;
  var field;
  for (; i < widg.$fieldDefaults.length; ++i) {
    field = widg.$fieldDefaults[i];
    if (!widg.hasOwnProperty(field.name)) {
      widg[field.name] = field.default_value;
    }
  }
  })(widget);
        widget.$html = _template.render({ widget: widget, extension: widget })
        var extension = widget;
        widget._styleTag = document.createElement('style');
widget._styleTag.id = 'widget-css-30291230470';
widget._styleTag.innerHTML = '.heroCTA {    clear: both;    font-family: "tempo", sans-serif;    line-height: 1;    text-transform: uppercase;    cursor: pointer;    color: #FFF;    background: #DC1125;    border-radius: 4px;    text-shadow: none;    border: none;    display: inline-block;    padding: 16px 32px;    font-size: 18.7px;    border-radius: 4px;}.hero-header{	width: 100%;	max-width: 1450px;	height: 435px;	display: block;	visibility: visible;	background-repeat: no-repeat;	background-position: center 0;	background-size: cover;	cursor: pointer;  background-repeat: no-repeat;  background-position: center 0; background-size: cover;}.hero-header .heroContainer{	width: 100%;	max-width: 840px;  text-align: center;}.hero-header .waterMark{	position: absolute;  text-transform: uppercase;}.leadingText-attr{  font-family:"Open Sans";  font-weight:600;}.hp-flex{display:flex!important}.hp-justify-end{justify-content:flex-end!important}.hp-justify-center{justify-content:center!important}.hp-justify-between{justify-content:space-between!important}.hp-justify-around{justify-content:space-around!important}.hp-justify-evenly{justify-content:space-evenly!important}.hp-flex-row{flex-direction:row!important}.hp-flex-row-reverse{flex-direction:row-reverse!important}.hp-flex-col{flex-direction:column!important}.hp-flex-col-reverse{flex-direction:column-reverse!important}.hp-font-tempo{font-family:tempostd,tempo,sans-serif;text-transform: uppercase;}.hp-font-open-sans{font-family:open-sans,sans-serif!important}.hp-font-helvetica{font-family:Helvetica Neue,Helvetica Neue LT Std,Helvetica,Arial,sans-serif;}.hp-text-uppercase{text-transform: uppercase}.hp-text-blue{color:#10559a!important}.hp-text-red{color:#DC1125!important}.hp-text-blue-dark{color:#052049!important}.hp-text-blue-medium{color:#001260!important}.hp-text-white{color:#fff!important}.hp-text-black{color:#000!important}.hp-bg-red{background:#DC1125!important}.hp-bg-blue{background:#10559a!important}.hp-bg-blue-dark{background:#052049!important}.hp-text-left{text-align:left}.hp-text-center{text-align:center}.hp-text-right{text-align:right}.hp-items-start{align-items:flex-start}.hp-items-end{align-items:flex-end}.hp-items-center{align-items:center}.hp-items-baseline{align-items:baseline}.hp-items-stretch{align-items:stretch}.hp-content-center{align-content:center}.hp-content-start{align-content:flex-start}.hp-content-end{align-content:flex-end}.hp-content-between{align-content:space-between}.hp-content-around{align-content:space-around}.hp-content-evenly{align-content:space-evenly}.hp-m-0{margin:0 !important}.hp-m-1{margin:.25rem!important}.hp-m-2{margin:.5rem!important}.hp-m-3{margin:.75rem!important}.hp-m-4{margin:1rem!important}.hp-m-5{margin:1.25rem!important}.hp-m-6{margin:1.5rem!important}.hp-m-8{margin:2rem!important}.hp-m-10{margin:2.5rem!important}.hp-m-12{margin:3rem!important}.hp-m-16{margin:4rem!important}.hp-m-20{margin:5rem!important}.hp-m-24{margin:6rem!important}.hp-m-32{margin:8rem!important}.hp-m-40{margin:10rem!important}.hp-m-48{margin:12rem!important}.hp-m-56{margin:14rem!important}.hp-m-64{margin:16rem!important}.hp-m-auto{margin:auto!important}.hp-my-0{margin-top:0!important;margin-bottom:0!important}.hp-mx-0{margin-left:0!important;margin-right:0!important}.hp-my-1{margin-top:.25rem!important;margin-bottom:.25rem!important}.hp-mx-1{margin-left:.25rem!important;margin-right:.25rem!important}.hp-my-2{margin-top:.5rem!important;margin-bottom:.5rem!important}.hp-mx-2{margin-left:.5rem!important;margin-right:.5rem!important}.hp-my-3{margin-top:.75rem!important;margin-bottom:.75rem!important}.hp-mx-3{margin-left:.75rem!important;margin-right:.75rem!important}.hp-my-4{margin-top:1rem!important;margin-bottom:1rem!important}.hp-mx-4{margin-left:1rem!important;margin-right:1rem!important}.hp-my-5{margin-top:1.25rem!important;margin-bottom:1.25rem!important}.hp-mx-5{margin-left:1.25rem!important;margin-right:1.25rem!important}.hp-my-6{margin-top:1.5rem!important;margin-bottom:1.5rem!important}.hp-mx-6{margin-left:1.5rem!important;margin-right:1.5rem!important}.hp-my-8{margin-top:2rem!important;margin-bottom:2rem!important}.hp-mx-8{margin-left:2rem!important;margin-right:2rem!important}.hp-my-10{margin-top:2.5rem!important;margin-bottom:2.5rem!important}.hp-mx-10{margin-left:2.5rem!important;margin-right:2.5rem!important}.hp-my-12{margin-top:3rem!important;margin-bottom:3rem!important}.hp-mx-12{margin-left:3rem!important;margin-right:3rem!important}.hp-my-16{margin-top:4rem!important;margin-bottom:4rem!important}.hp-mx-16{margin-left:4rem!important;margin-right:4rem!important}.hp-my-20{margin-top:5rem!important;margin-bottom:5rem!important}.hp-mx-20{margin-left:5rem!important;margin-right:5rem!important}.hp-my-24{margin-top:6rem!important;margin-bottom:6rem!important}.hp-mx-24{margin-left:6rem!important;margin-right:6rem!important}.hp-my-32{margin-top:8rem!important;margin-bottom:8rem!important}.hp-mx-32{margin-left:8rem!important;margin-right:8rem!important}.hp-my-40{margin-top:10rem!important;margin-bottom:10rem!important}.hp-mx-40{margin-left:10rem!important;margin-right:10rem!important}.hp-my-48{margin-top:12rem!important;margin-bottom:12rem!important}.hp-mx-48{margin-left:12rem!important;margin-right:12rem!important}.hp-my-56{margin-top:14rem!important;margin-bottom:14rem!important}.hp-mx-56{margin-left:14rem!important;margin-right:14rem!important}.hp-my-64{margin-top:16rem!important;margin-bottom:16rem!important}.hp-mx-64{margin-left:16rem!important;margin-right:16rem!important}.hp-my-auto{margin-top:auto!important;margin-bottom:auto!important}.hp-mx-auto{margin-left:auto!important;margin-right:auto!important}.hp-mt-0{margin-top:0!important}.hp-mr-0{margin-right:0!important}.hp-mb-0{margin-bottom:0!important}.hp-ml-0{margin-left:0!important}.hp-mt-1{margin-top:.25rem!important}.hp-mr-1{margin-right:.25rem!important}.hp-mb-1{margin-bottom:.25rem!important}.hp-ml-1{margin-left:.25rem!important}.hp-mt-2{margin-top:.5rem!important}.hp-mr-2{margin-right:.5rem!important}.hp-mb-2{margin-bottom:.5rem!important}.hp-ml-2{margin-left:.5rem!important}.hp-mt-3{margin-top:.75rem!important}.hp-mr-3{margin-right:.75rem!important}.hp-mb-3{margin-bottom:.75rem!important}.hp-ml-3{margin-left:.75rem!important}.hp-mt-4{margin-top:1rem!important}.hp-mr-4{margin-right:1rem!important}.hp-mb-4{margin-bottom:1rem!important}.hp-ml-4{margin-left:1rem!important}.hp-mt-5{margin-top:1.25rem!important}.hp-mr-5{margin-right:1.25rem!important}.hp-mb-5{margin-bottom:1.25rem!important}.hp-ml-5{margin-left:1.25rem!important}.hp-mt-6{margin-top:1.5rem!important}.hp-mr-6{margin-right:1.5rem!important}.hp-mb-6{margin-bottom:1.5rem!important}.hp-ml-6{margin-left:1.5rem!important}.hp-mt-7{margin-top:1.75rem!important}.hp-mr-7{margin-right:1.75rem!important}.hp-mb-7{margin-bottom:1.75rem!important}.hp-ml-7{margin-left:1.75rem!important}.hp-mt-8{margin-top:2rem!important}.hp-mr-8{margin-right:2rem!important}.hp-mb-8{margin-bottom:2rem!important}.hp-ml-8{margin-left:2rem!important}.hp-mt-9{margin-top:2.25rem!important}.hp-mr-9{margin-right:2.25rem!important}.hp-mb-9{margin-bottom:2.25rem!important}.hp-ml-9{margin-left:2.25rem!important}.hp-mt-10{margin-top:2.5rem!important}.hp-mr-10{margin-right:2.5rem!important}.hp-mb-10{margin-bottom:2.5rem!important}.hp-ml-10{margin-left:2.5rem!important}.hp-mt-11{margin-top:2.75rem!important}.hp-mr-11{margin-right:2.75rem!important}.hp-mb-11{margin-bottom:2.75rem!important}.hp-ml-11{margin-left:2.75rem!important}.hp-mt-12{margin-top:3rem!important}.hp-mr-12{margin-right:3rem!important}.hp-mb-12{margin-bottom:3rem!important}.hp-ml-12{margin-left:3rem!important}.hp-mt-14{margin-top:3.5rem!important}.hp-mr-14{margin-right:3.5rem!important}.hp-mb-14{margin-bottom:3.5rem!important}.hp-ml-14{margin-left:3.5rem!important}.hp-mt-16{margin-top:4rem!important}.hp-mr-16{margin-right:4rem!important}.hp-mb-16{margin-bottom:4rem!important}.hp-ml-16{margin-left:4rem!important}.hp-mt-20{margin-top:5rem!important}.hp-mr-20{margin-right:5rem!important}.hp-mb-20{margin-bottom:5rem!important}.hp-ml-20{margin-left:5rem!important}.hp-mt-24{margin-top:6rem!important}.hp-mr-24{margin-right:6rem!important}.hp-mb-24{margin-bottom:6rem!important}.hp-ml-24{margin-left:6rem!important}.hp-mt-28{margin-top:7rem!important}.hp-mr-28{margin-right:7rem!important}.hp-mb-28{margin-bottom:7rem!important}.hp-ml-28{margin-left:7rem!important}.hp-mt-32{margin-top:8rem!important}.hp-mr-32{margin-right:8rem!important}.hp-mb-32{margin-bottom:8rem!important}.hp-ml-32{margin-left:8rem!important}.hp-mt-36{margin-top:9rem!important}.hp-mr-36{margin-right:9rem!important}.hp-mb-36{margin-bottom:9rem!important}.hp-ml-36{margin-left:9rem!important}.hp-mt-40{margin-top:10rem!important}.hp-mr-40{margin-right:10rem!important}.hp-mb-40{margin-bottom:10rem!important}.hp-ml-40{margin-left:10rem!important}.hp-mt-44{margin-top:11rem!important}.hp-mr-44{margin-right:11rem!important}.hp-mb-44{margin-bottom:11rem!important}.hp-ml-44{margin-left:11rem!important}.hp-mt-48{margin-top:12rem!important}.hp-mr-48{margin-right:12rem!important}.hp-mb-48{margin-bottom:12rem!important}.hp-ml-48{margin-left:12rem!important}.hp-mt-52{margin-top:13rem!important}.hp-mr-52{margin-right:13rem!important}.hp-mb-52{margin-bottom:13rem!important}.hp-ml-52{margin-left:13rem!important}.hp-mt-56{margin-top:14rem!important}.hp-mr-56{margin-right:14rem!important}.hp-mb-56{margin-bottom:14rem!important}.hp-ml-56{margin-left:14rem!important}.hp-mt-60{margin-top:15rem!important}.hp-mr-60{margin-right:15rem!important}.hp-mb-60{margin-bottom:15rem!important}.hp-ml-60{margin-left:15rem!important}.hp-mt-64{margin-top:16rem!important}.hp-mr-64{margin-right:16rem!important}.hp-mb-64{margin-bottom:16rem!important}.hp-ml-64{margin-left:16rem!important}.hp-mt-72{margin-top:18rem!important}.hp-mr-72{margin-right:18rem!important}.hp-mb-72{margin-bottom:18rem!important}.hp-ml-72{margin-left:18rem!important}.hp-mt-80{margin-top:20rem!important}.hp-mr-80{margin-right:20rem!important}.hp-mb-80{margin-bottom:20rem!important}.hp-ml-80{margin-left:20rem!important}.hp-mt-96{margin-top:24rem!important}.hp-mr-96{margin-right:24rem!important}.hp-mb-96{margin-bottom:24rem!important}.hp-ml-96{margin-left:24rem!important}.hp-mt-auto{margin-top:auto!important}.hp-mr-auto{margin-right:auto!important}.hp-mb-auto{margin-bottom:auto!important}.hp-ml-auto{margin-left:auto!important}.hp-mt-0\.5{margin-top:.125rem!important}.hp-mr-0\.5{margin-right:.125rem!important}.hp-mb-0\.5{margin-bottom:.125rem!important}.hp-ml-0\.5{margin-left:.125rem!important}.hp-mt-1\.5{margin-top:.375rem!important}.hp-mr-1\.5{margin-right:.375rem!important}.hp-mb-1\.5{margin-bottom:.375rem!important}.hp-ml-1\.5{margin-left:.375rem!important}.hp-mt-2\.5{margin-top:.625rem!important}.hp-mr-2\.5{margin-right:.625rem!important}.hp-mb-2\.5{margin-bottom:.625rem!important}.hp-ml-2\.5{margin-left:.625rem!important}.hp-mt-3\.5{margin-top:.875rem!important}.hp-mr-3\.5{margin-right:.875rem!important}.hp-mb-3\.5{margin-bottom:.875rem!important}.hp-ml-3\.5{margin-left:.875rem!important}.hp-text-xs{font-size:.75rem;line-height:1rem}.hp-text-sm{font-size:.875rem;line-height:1.25rem}.hp-text-base{font-size:1rem;line-height:1.5rem}.hp-text-lg{font-size:1.125rem;line-height:1.75rem}.hp-text-xl{font-size:1.25rem;line-height:1.75rem}.hp-text-2xl{font-size:1.5rem;line-height:2rem}.hp-text-3xl{font-size:1.875rem;line-height:2.25rem}.hp-text-4xl{font-size:2.25rem;line-height:2.5rem}.hp-text-5xl{font-size:3rem;line-height:1}.hp-text-6xl{font-size:3.75rem;line-height:1}.hp-text-7xl{font-size:4.5rem;line-height:1}.hp-text-8xl{font-size:6rem;line-height:1}.hp-text-9xl{font-size:8rem;line-height:1}.hp-text-shadow-xs{text-shadow: 2px 2px 2px rgba(0,0,0,.1)}.hp-text-shadow-sm{text-shadow: 2px 2px 4px rgba(0,0,0,.2)}.hp-text-shadow-md{text-shadow: 2px 2px 4px rgba(0,0,0,.35)}.hp-text-shadow-lg{text-shadow: 2px 2px 4px rgba(0,0,0,.5)}.hp-text-shadow-none{text-shadow: none !important}.hp-font-thin{font-weight:100}.hp-font-extralight{font-weight:200}.hp-font-light{font-weight:300}.hp-font-normal{font-weight:400}.hp-font-medium{font-weight:500}.hp-font-semibold{font-weight:600}.hp-font-bold{font-weight:700}.hp-font-extrabold{font-weight:800}.hp-font-black{font-weight:900}';
document.getElementsByTagName('head')[0].appendChild(widget._styleTag);
        var utils = optimizely.get('utils');

utils.waitForElement('#hero-section')
  .then(function(elem) {
  elem.innerHTML = extension.$html;
  utils.waitUntil(function() {
    return window.hpHeroUrl != undefined;
  }).then(function() {
	$('.hero1').removeAttribute("role");
    $('.hero1').attr('href', window.hpHeroUrl);
    $('.cTileCta').attr('tabindex', '0');
  });
});


      },
      hideFn: function(event) {
        var $ = window.optimizely.get('jquery');
        var widget = event.data.config;
        widget.$id = "30291230470";
        widget.$instance = event.data.id;
        widget.$fieldDefaults = [{"name":"img","default_value":"/~/media/Images/hp-merch/2019/desktop/heros/0306_Emeril_H2.jpg"},{"name":"altText","default_value":""},{"name":"lnk","default_value":"/cruise-search?cruisedeals=earlysaversale&icid=icp_ccl_earlysaversale_102423_hm_h1&rateCodes="},{"name":"openhtml","default_value":"  \n\n<div style=\"\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n    margin-top: 2%;\n    margin-left: 30%;\n    \" class=\"hp-text-blue-dark hp-text-shadow-none\">\n    \n \n     \n\n \n\n <a \n\taria-label=\"shop this deal,three days only! extra bonus savings\" \n\tclass=\"heroCTA ctaHover hp-text-shadow-none\" \n\tstyle=\"font-size: 170%;\" \n\ttabindex=\"0\" \n\tonkeypress=\"if (event.key === 'Enter') {window.location.href = '/cruise-search?cruisedeals=earlysaversale&icid=icp_ccl_earlysaversale_082224_hm_h1&rateCodes='; }\" >SHOP THIS DEAL\n   </a>\n  \n</div>"},{"name":"waterMark","default_value":""},{"name":"waterTextColor","default_value":"rgba(16, 85, 154, 1)"},{"name":"waterShadowColor","default_value":"rgba(0, 0, 0, 1)"},{"name":"top","default_value":""},{"name":"right","default_value":"220px"},{"name":"bottom","default_value":"110px"},{"name":"left","default_value":""},{"name":"backgroundColor","default_value":"rgba"}];
        (function(widg) {
  var i = 0;
  var field;
  for (; i < widg.$fieldDefaults.length; ++i) {
    field = widg.$fieldDefaults[i];
    if (!widg.hasOwnProperty(field.name)) {
      widg[field.name] = field.default_value;
    }
  }
  })(widget);
        var extension = widget;
        widget._styleTag = document.getElementById('widget-css-30291230470');
if (widget._styleTag) widget._styleTag.parentNode.removeChild(widget._styleTag);
        var extensionElement = document.getElementById('optimizely-extension-' + extension.$instance);
if (extensionElement) {
  extensionElement.parentElement.removeChild(extensionElement);
}

      },
    });

PluginManager.registerWidget({
      widgetId: '30314080267',
      showFn: function(event) {
        var $ = window.optimizely.get('jquery');
        var widget = event.data.config;
        var _template = new Hogan(function(c,p,i) {var t=this;t.b(i=i||"");t.b("<!-- // PORTRAIT VERSION // -->");t.b("\n" + i);t.b("<div");t.b("\n" + i);t.b("     id=\"optimizely-extension-");t.b(t.v(t.d("extension.$instance",c,p,0)));t.b("\"");t.b("\n" + i);t.b("     class=\"hero-header-mobile\"");t.b("\n" + i);t.b("     style=\"background: url(");t.b(t.v(t.d("extension.imgPortrait",c,p,0)));t.b(") no-repeat 0 0;background-size: 100% 100%\"");t.b("\n" + i);t.b("     onclick=\"window.location='");t.b(t.v(t.d("extension.ctaURL",c,p,0)));t.b("';\"");t.b("\n" + i);t.b("     >");t.b("\n" + i);t.b("  <div class=\"hero-mobile-content-wrapper\" style=\"");t.b(t.v(t.d("extension.contentAlignment",c,p,0)));t.b("; ");t.b(t.v(t.d("extension.contentExtraStyles",c,p,0)));t.b(";\">  ");t.b("\n" + i);t.b("    ");t.b(t.t(t.d("extension.priceAttributes",c,p,0)));t.b("\n" + i);t.b("  </div>");t.b("\n" + i);t.b("</div>");t.b("\n" + i);t.b("<!--------------------------------------------------------------------------------------------------------------------------------------------------->");t.b("\n");t.b("\n" + i);t.b("<!-- // LANDSCAPE VERSION // -->");t.b("\n" + i);t.b("<div");t.b("\n" + i);t.b("     id=\"optimizely-extension-");t.b(t.v(t.d("extension.$instance",c,p,0)));t.b("l\"");t.b("\n" + i);t.b("     class=\"hero-header-mobile-landscape\"");t.b("\n" + i);t.b("     style=\"background: url(");t.b(t.v(t.d("extension.imgLandscape",c,p,0)));t.b(") no-repeat 0 0;background-size: cover;background-position: center top\"");t.b("\n" + i);t.b("     onclick=\"window.location='");t.b(t.v(t.d("extension.ctaURL",c,p,0)));t.b("';\"");t.b("\n" + i);t.b("     >");t.b("\n" + i);t.b("  <div class=\"hero-mobile-content-wrapper\" style=\"");t.b(t.v(t.d("extension.landscapeMargins",c,p,0)));t.b("\">");t.b("\n" + i);t.b("    ");t.b(t.t(t.d("extension.priceAttributes",c,p,0)));t.b("\n" + i);t.b("  </div>");t.b("\n" + i);t.b("</div>");t.b("\n");t.b("\n" + i);t.b("<!---------------------------------------------------------------------------------------------------------------------------------------------------->");return t.fl(); })
        widget.$id = "30314080267";
        widget.$instance = event.data.id;
        widget.$render = _template.render.bind(_template)
        widget.$fieldDefaults = [{"name":"imgPortrait","default_value":"/~/media/Images/hp-merch/2020/mobile/heros/how-to-chill-portrait.jpg"},{"name":"imgLandscape","default_value":"/~/media/Images/hp-merch/2020/mobile/heros/how-to-chill-landscape.ashx"},{"name":"ctaURL","default_value":"/cruise-search?cruisedeals=earlysaversale&icid=icp_ccl_earlysaversale_052223_mbl_h1&rateCodes="},{"name":"contentAlignment","default_value":"align-self:center"},{"name":"contentExtraStyles","default_value":""},{"name":"priceAttributes","default_value":"<div class=\"backToFunContainer hp-text-blue-dark hp-text-shadow-npne\" style=\"margin-top: 10%;\">\n        <div style=\"\nline-height:1;\ndisplay: flex;\nflex-direction: column;\nalign-content: center;\njustify-content: center;\nalign-items:center\n    \"><span class=\"hero-headline\" style=\"font-family:tempo;text-align: center;font-size: 39px;line-height: .9;\">KICK THINGS OFF RIGHT<br>WITH SITEWIDE SAVINGS</span>\n         \n        </div>\n  \n\n<div class=\"price-attributes hp-items-start\" style=\"\n    display: flex;\n    font-size: 56px;\n    align-items: flex-end;\n    line-height: .9!important;\n    margin-top: 7px;\n    margin-bottom: 5px;\n    \" aria-hidden=\"true\">\n      <!-- ATTRIBUTE -->\n      \n      <!--PLUS-->\n       \n        <!--PLUS-->\n       <!-- ATTRIBUTE -->\n     \n      <!--PLUS-->\n         <div class=\"attrContainer hp-flex-col\">\n       <span class=\"leadingText-attr \" style=\"\">UP TO</span><span class=\"salePrice-attr\" style=\"\n    line-height: .9!important;\n\">40<span class=\"prePrice-attr hp-flex hp-flex-col\" style=\"font-size: .45em;padding-top: 5px;line-height: .9;\"><span style=\"line-height:.8;align-self: start;\">%<sup style=\"font-size: .55em;top: -9px;position: relative;\">*</sup></span><span style=\"line-height:.9\">OFF</span></span>\n</span><span class=\"leadingText-attr\" style=\"\">CRUISE RATES</span>\n      </div>\n      \n        <div class=\"attrPlus\" style=\"margin-top: -12px;margin-right: 3px;margin-left: 8px;\"></div><div class=\"attrContainer hp-flex-col\">\n       <span class=\"leadingText-attr\" style=\"\"></span><span class=\"salePrice-attr\" style=\"line-height: .9!important;\">FREE</span><span class=\"leadingText-attr\" style=\"\">ROOM UPGRADE</span>\n      </div><div class=\"attrPlus\" style=\"margin-top: -12px;margin-right: -10px;margin-left: 9px;\"></div><div class=\"attrContainer hp-flex-col\">\n       <span class=\"leadingText-attr\" style=\"\">UP TO</span><span class=\"salePrice-attr\" style=\"line-height: .9!important;\"> <span style=\"font-size: .4em;margin-top: 2px;text-align:left;line-height:1;\">$</span>50<sup style=\"font-size: .28em;top: 11px;position: relative;display: none;\">*</sup></span><span class=\"leadingText-attr\" style=\"\">ONBOARD CREDIT</span>\n      </div><!--PLUS-->\n      \n      <!-- ATTRIBUTE -->\n       \n\n      </div><span style=\"\n    font-size: 24px;\n    text-align: center;\n    line-height: 1;\n    margin-top: 9px;\n    align-self: center;\n\" class=\"hp-font-tempo responsive-subcopy\" aria-hidden=\"true\">   ON ALL SAILINGS   </span>\n  \n<a aria-label=\"shop this deal, select sailings through December 2024, are from  $309* per person\" role=\"link\" class=\"hero-mobile-button\" tabindex=\"0\" style=\"margin-top: 15px;text-shadow:none\" onclick=\"/cruise-search?cruisedeals=sitewidesale&amp;icid=crm_ccl_sitewidesale_090524_mbl_hero_h1&amp;rateCodes=OCS,OTR\">SHOP THIS DEAL</a>\n</div>"},{"name":"landscapeMargins","default_value":"margin-top: 0vh;\n\nmargin-bottom: 0vh;\n\nmargin-left: 0vh;\n\nmargin-right:0vh;"},{"name":"imageAlt","default_value":""}];
        (function(widg) {
  var i = 0;
  var field;
  for (; i < widg.$fieldDefaults.length; ++i) {
    field = widg.$fieldDefaults[i];
    if (!widg.hasOwnProperty(field.name)) {
      widg[field.name] = field.default_value;
    }
  }
  })(widget);
        widget.$html = _template.render({ widget: widget, extension: widget })
        var extension = widget;
        widget._styleTag = document.createElement('style');
widget._styleTag.id = 'widget-css-30314080267';
widget._styleTag.innerHTML = '@media screen and (orientation: portrait) {  .hero-header-mobile-landscape{display:none}  .hero-header-mobile{    height: 380px;    box-sizing:border-box;    display: flex;    flex-direction: column;  }  /*ALL CONTENT*/  .hero-mobile-content-wrapper{    padding: 5px;  }  .hero-mobile-button{    background-color:#DC1125;    color: white;    border: none;    border-radius: 4px;    padding: 10px 16px;    display: flex;    justify-content: center;    align-items: center;    font-family: "tempo";    text-transform: uppercase;    letter-spacing: 0.5px;    font-size: 1rem;    width: max-content;    margin: 0 auto;  }  .hero-mobile-button i {    margin-left: 5px;  }  .hero-mobile-sticky-outside{    height: 80px;    width: 100%;    color: black;  }  }@media screen and (orientation: landscape) {  .hero-header-mobile{    display:none  }  .hero-header-mobile-landscape{    height: 411px;    box-sizing:border-box;    display: flex;    flex-direction: column;  }  /*ALL CONTENT*/  .hero-mobile-content-wrapper{    padding: 5px;  }  /*HEADLINES*/  .hero-mobile-headline,  .hero-mobile-subHeadline{    line-height: 1;  }  .hero-mobile-sticky{    height: 80px;    position: absolute;    bottom: 0;    width: 100%;  }  .hero-mobile-button{    background-color: #DC1125;    color: white;    border: none;    border-radius: 4px;    padding: 0px 16px;    display: flex;    justify-content: center;    align-items: center;    font-family: "tempo";    text-transform: uppercase;    letter-spacing: 0.5px;    font-size: 1rem;    height: 40px;    width: max-content;    margin: 0 auto;  }  .hero-mobile-button i {    margin-left: 5px;  }  .hero-mobile-sticky-outside{    height: 80px;    width: 100%;    color: black;  }}/*HIDE STICKY*/.bannerMobOpt{display:none;}.hp-flex{display:flex!important}.hp-justify-end{justify-content:flex-end!important}.hp-justify-center{justify-content:center!important}.hp-justify-between{justify-content:space-between!important}.hp-justify-around{justify-content:space-around!important}.hp-justify-evenly{justify-content:space-evenly!important}.hp-flex-row{flex-direction:row!important}.hp-flex-row-reverse{flex-direction:row-reverse!important}.hp-flex-col{flex-direction:column!important}.hp-flex-col-reverse{flex-direction:column-reverse!important}.hp-font-tempo{font-family:tempostd,tempo,sans-serif;text-transform:uppercase;}.hp-font-open-sans{font-family:open-sans,sans-serif!important}.hp-text-blue{color:#10559a!important}.hp-text-red{color:#dc1125!important}.hp-text-blue-dark{color:#052049!important}.hp-text-blue-medium{color:#001260!important}.hp-text-white{color:#fff!important}.hp-text-black{color:#000!important}.hp-bg-red{background:#dc1125!important}.hp-bg-blue{background:#10559a!important}.hp-bg-blue-dark{background:#052049!important}.hp-text-left{text-align:left}.hp-text-center{text-align:center}.hp-text-right{text-align:right}.hp-items-start{align-items:flex-start}.hp-items-end{align-items:flex-end}.hp-items-center{align-items:center}.hp-items-baseline{align-items:baseline}.hp-items-stretch{align-items:stretch}.hp-content-center{align-content:center}.hp-content-start{align-content:flex-start}.hp-content-end{align-content:flex-end}.hp-content-between{align-content:space-between}.hp-content-around{align-content:space-around}.hp-content-evenly{align-content:space-evenly}.hp-m-0{margin:0}.hp-m-1{margin:.25rem!important}.hp-m-2{margin:.5rem!important}.hp-m-3{margin:.75rem!important}.hp-m-4{margin:1rem!important}.hp-m-5{margin:1.25rem!important}.hp-m-6{margin:1.5rem!important}.hp-m-8{margin:2rem!important}.hp-m-10{margin:2.5rem!important}.hp-m-12{margin:3rem!important}.hp-m-16{margin:4rem!important}.hp-m-20{margin:5rem!important}.hp-m-24{margin:6rem!important}.hp-m-32{margin:8rem!important}.hp-m-40{margin:10rem!important}.hp-m-48{margin:12rem!important}.hp-m-56{margin:14rem!important}.hp-m-64{margin:16rem!important}.hp-m-auto{margin:auto!important}.hp-my-0{margin-top:0!important;margin-bottom:0!important}.hp-mx-0{margin-left:0!important;margin-right:0!important}.hp-my-1{margin-top:.25rem!important;margin-bottom:.25rem!important}.hp-mx-1{margin-left:.25rem!important;margin-right:.25rem!important}.hp-my-2{margin-top:.5rem!important;margin-bottom:.5rem!important}.hp-mx-2{margin-left:.5rem!important;margin-right:.5rem!important}.hp-my-3{margin-top:.75rem!important;margin-bottom:.75rem!important}.hp-mx-3{margin-left:.75rem!important;margin-right:.75rem!important}.hp-my-4{margin-top:1rem!important;margin-bottom:1rem!important}.hp-mx-4{margin-left:1rem!important;margin-right:1rem!important}.hp-my-5{margin-top:1.25rem!important;margin-bottom:1.25rem!important}.hp-mx-5{margin-left:1.25rem!important;margin-right:1.25rem!important}.hp-my-6{margin-top:1.5rem!important;margin-bottom:1.5rem!important}.hp-mx-6{margin-left:1.5rem!important;margin-right:1.5rem!important}.hp-my-8{margin-top:2rem!important;margin-bottom:2rem!important}.hp-mx-8{margin-left:2rem!important;margin-right:2rem!important}.hp-my-10{margin-top:2.5rem!important;margin-bottom:2.5rem!important}.hp-mx-10{margin-left:2.5rem!important;margin-right:2.5rem!important}.hp-my-12{margin-top:3rem!important;margin-bottom:3rem!important}.hp-mx-12{margin-left:3rem!important;margin-right:3rem!important}.hp-my-16{margin-top:4rem!important;margin-bottom:4rem!important}.hp-mx-16{margin-left:4rem!important;margin-right:4rem!important}.hp-my-20{margin-top:5rem!important;margin-bottom:5rem!important}.hp-mx-20{margin-left:5rem!important;margin-right:5rem!important}.hp-my-24{margin-top:6rem!important;margin-bottom:6rem!important}.hp-mx-24{margin-left:6rem!important;margin-right:6rem!important}.hp-my-32{margin-top:8rem!important;margin-bottom:8rem!important}.hp-mx-32{margin-left:8rem!important;margin-right:8rem!important}.hp-my-40{margin-top:10rem!important;margin-bottom:10rem!important}.hp-mx-40{margin-left:10rem!important;margin-right:10rem!important}.hp-my-48{margin-top:12rem!important;margin-bottom:12rem!important}.hp-mx-48{margin-left:12rem!important;margin-right:12rem!important}.hp-my-56{margin-top:14rem!important;margin-bottom:14rem!important}.hp-mx-56{margin-left:14rem!important;margin-right:14rem!important}.hp-my-64{margin-top:16rem!important;margin-bottom:16rem!important}.hp-mx-64{margin-left:16rem!important;margin-right:16rem!important}.hp-my-auto{margin-top:auto!important;margin-bottom:auto!important}.hp-mx-auto{margin-left:auto!important;margin-right:auto!important}.hp-mt-0{margin-top:0!important}.hp-mr-0{margin-right:0!important}.hp-mb-0{margin-bottom:0!important}.hp-ml-0{margin-left:0!important}.hp-mt-1{margin-top:.25rem!important}.hp-mr-1{margin-right:.25rem!important}.hp-mb-1{margin-bottom:.25rem!important}.hp-ml-1{margin-left:.25rem!important}.hp-mt-2{margin-top:.5rem!important}.hp-mr-2{margin-right:.5rem!important}.hp-mb-2{margin-bottom:.5rem!important}.hp-ml-2{margin-left:.5rem!important}.hp-mt-3{margin-top:.75rem!important}.hp-mr-3{margin-right:.75rem!important}.hp-mb-3{margin-bottom:.75rem!important}.hp-ml-3{margin-left:.75rem!important}.hp-mt-4{margin-top:1rem!important}.hp-mr-4{margin-right:1rem!important}.hp-mb-4{margin-bottom:1rem!important}.hp-ml-4{margin-left:1rem!important}.hp-mt-5{margin-top:1.25rem!important}.hp-mr-5{margin-right:1.25rem!important}.hp-mb-5{margin-bottom:1.25rem!important}.hp-ml-5{margin-left:1.25rem!important}.hp-mt-6{margin-top:1.5rem!important}.hp-mr-6{margin-right:1.5rem!important}.hp-mb-6{margin-bottom:1.5rem!important}.hp-ml-6{margin-left:1.5rem!important}.hp-mt-7{margin-top:1.75rem!important}.hp-mr-7{margin-right:1.75rem!important}.hp-mb-7{margin-bottom:1.75rem!important}.hp-ml-7{margin-left:1.75rem!important}.hp-mt-8{margin-top:2rem!important}.hp-mr-8{margin-right:2rem!important}.hp-mb-8{margin-bottom:2rem!important}.hp-ml-8{margin-left:2rem!important}.hp-mt-9{margin-top:2.25rem!important}.hp-mr-9{margin-right:2.25rem!important}.hp-mb-9{margin-bottom:2.25rem!important}.hp-ml-9{margin-left:2.25rem!important}.hp-mt-10{margin-top:2.5rem!important}.hp-mr-10{margin-right:2.5rem!important}.hp-mb-10{margin-bottom:2.5rem!important}.hp-ml-10{margin-left:2.5rem!important}.hp-mt-11{margin-top:2.75rem!important}.hp-mr-11{margin-right:2.75rem!important}.hp-mb-11{margin-bottom:2.75rem!important}.hp-ml-11{margin-left:2.75rem!important}.hp-mt-12{margin-top:3rem!important}.hp-mr-12{margin-right:3rem!important}.hp-mb-12{margin-bottom:3rem!important}.hp-ml-12{margin-left:3rem!important}.hp-mt-14{margin-top:3.5rem!important}.hp-mr-14{margin-right:3.5rem!important}.hp-mb-14{margin-bottom:3.5rem!important}.hp-ml-14{margin-left:3.5rem!important}.hp-mt-16{margin-top:4rem!important}.hp-mr-16{margin-right:4rem!important}.hp-mb-16{margin-bottom:4rem!important}.hp-ml-16{margin-left:4rem!important}.hp-mt-20{margin-top:5rem!important}.hp-mr-20{margin-right:5rem!important}.hp-mb-20{margin-bottom:5rem!important}.hp-ml-20{margin-left:5rem!important}.hp-mt-24{margin-top:6rem!important}.hp-mr-24{margin-right:6rem!important}.hp-mb-24{margin-bottom:6rem!important}.hp-ml-24{margin-left:6rem!important}.hp-mt-28{margin-top:7rem!important}.hp-mr-28{margin-right:7rem!important}.hp-mb-28{margin-bottom:7rem!important}.hp-ml-28{margin-left:7rem!important}.hp-mt-32{margin-top:8rem!important}.hp-mr-32{margin-right:8rem!important}.hp-mb-32{margin-bottom:8rem!important}.hp-ml-32{margin-left:8rem!important}.hp-mt-36{margin-top:9rem!important}.hp-mr-36{margin-right:9rem!important}.hp-mb-36{margin-bottom:9rem!important}.hp-ml-36{margin-left:9rem!important}.hp-mt-40{margin-top:10rem!important}.hp-mr-40{margin-right:10rem!important}.hp-mb-40{margin-bottom:10rem!important}.hp-ml-40{margin-left:10rem!important}.hp-mt-44{margin-top:11rem!important}.hp-mr-44{margin-right:11rem!important}.hp-mb-44{margin-bottom:11rem!important}.hp-ml-44{margin-left:11rem!important}.hp-mt-48{margin-top:12rem!important}.hp-mr-48{margin-right:12rem!important}.hp-mb-48{margin-bottom:12rem!important}.hp-ml-48{margin-left:12rem!important}.hp-mt-52{margin-top:13rem!important}.hp-mr-52{margin-right:13rem!important}.hp-mb-52{margin-bottom:13rem!important}.hp-ml-52{margin-left:13rem!important}.hp-mt-56{margin-top:14rem!important}.hp-mr-56{margin-right:14rem!important}.hp-mb-56{margin-bottom:14rem!important}.hp-ml-56{margin-left:14rem!important}.hp-mt-60{margin-top:15rem!important}.hp-mr-60{margin-right:15rem!important}.hp-mb-60{margin-bottom:15rem!important}.hp-ml-60{margin-left:15rem!important}.hp-mt-64{margin-top:16rem!important}.hp-mr-64{margin-right:16rem!important}.hp-mb-64{margin-bottom:16rem!important}.hp-ml-64{margin-left:16rem!important}.hp-mt-72{margin-top:18rem!important}.hp-mr-72{margin-right:18rem!important}.hp-mb-72{margin-bottom:18rem!important}.hp-ml-72{margin-left:18rem!important}.hp-mt-80{margin-top:20rem!important}.hp-mr-80{margin-right:20rem!important}.hp-mb-80{margin-bottom:20rem!important}.hp-ml-80{margin-left:20rem!important}.hp-mt-96{margin-top:24rem!important}.hp-mr-96{margin-right:24rem!important}.hp-mb-96{margin-bottom:24rem!important}.hp-ml-96{margin-left:24rem!important}.hp-mt-auto{margin-top:auto!important}.hp-mr-auto{margin-right:auto!important}.hp-mb-auto{margin-bottom:auto!important}.hp-ml-auto{margin-left:auto!important}.hp-mt-0\.5{margin-top:.125rem!important}.hp-mr-0\.5{margin-right:.125rem!important}.hp-mb-0\.5{margin-bottom:.125rem!important}.hp-ml-0\.5{margin-left:.125rem!important}.hp-mt-1\.5{margin-top:.375rem!important}.hp-mr-1\.5{margin-right:.375rem!important}.hp-mb-1\.5{margin-bottom:.375rem!important}.hp-ml-1\.5{margin-left:.375rem!important}.hp-mt-2\.5{margin-top:.625rem!important}.hp-mr-2\.5{margin-right:.625rem!important}.hp-mb-2\.5{margin-bottom:.625rem!important}.hp-ml-2\.5{margin-left:.625rem!important}.hp-mt-3\.5{margin-top:.875rem!important}.hp-mr-3\.5{margin-right:.875rem!important}.hp-mb-3\.5{margin-bottom:.875rem!important}.hp-ml-3\.5{margin-left:.875rem!important}.hp-text-xs{font-size:.75rem;line-height:1rem}.hp-text-sm{font-size:.875rem;line-height:1.25rem}.hp-text-base{font-size:1rem;line-height:1.5rem}.hp-text-lg{font-size:1.125rem;line-height:1.75rem}.hp-text-xl{font-size:1.25rem;line-height:1.75rem}.hp-text-2xl{font-size:1.5rem;line-height:2rem}.hp-text-3xl{font-size:1.875rem;line-height:2.25rem}.hp-text-4xl{font-size:2.25rem;line-height:2.5rem}.hp-text-5xl{font-size:3rem;line-height:1}.hp-text-6xl{font-size:3.75rem;line-height:1}.hp-text-7xl{font-size:4.5rem;line-height:1}.hp-text-8xl{font-size:6rem;line-height:1}.hp-text-9xl{font-size:8rem;line-height:1}.hp-text-shadow-xs{text-shadow: 2px 2px 2px rgba(0,0,0,.1)}.hp-text-shadow-sm{text-shadow: 2px 2px 4px rgba(0,0,0,.2)}.hp-text-shadow-md{text-shadow: 2px 2px 4px rgba(0,0,0,.35)}.hp-text-shadow-lg{text-shadow: 2px 2px 4px rgba(0,0,0,.5)}.hp-text-shadow-none{text-shadow: none !important}.hp-font-thin{font-weight:100}.hp-font-extralight{font-weight:200}.hp-font-light{font-weight:300}.hp-font-normal{font-weight:400}.hp-font-medium{font-weight:500}.hp-font-semibold{font-weight:600}.hp-font-bold{font-weight:700}.hp-font-extrabold{font-weight:800}.hp-font-black{font-weight:900}';
document.getElementsByTagName('head')[0].appendChild(widget._styleTag);
        var utils = optimizely.get('utils');

utils.waitForElement('.bannerMobOpt')  
.then(function(elem) {
    $('.bannerMobOpt').parent().remove();
  });

utils.waitForElement('#m-hero-section .banner')
  .then(function(elem) {
  // Prepend the extension html to the body
  elem.innerHTML= extension.$html;
  utils.waitUntil(function() {
    return window.hpHUrl != undefined;
  }).then(function() {
    $('.hero-header-mobile').attr('href',window.hpHUrl)
  });
});

utils.waitForElement('#hours, #urgencyMsg').then(function() {

  setInterval(function(){
    var hours  = $('#hours').text();

    if(hours && hours < 24){
      $('#urgencyMsg').text(' today');   
    }else if(hours && hours >= 24 && hours < 48){
      $('#urgencyMsg').text(' tomorrow'); 
    }else if(hours && hours > 48){
      $('#urgencyMsg').text(' soon'); 
    }
  },1000);
});

      },
      hideFn: function(event) {
        var $ = window.optimizely.get('jquery');
        var widget = event.data.config;
        widget.$id = "30314080267";
        widget.$instance = event.data.id;
        widget.$fieldDefaults = [{"name":"imgPortrait","default_value":"/~/media/Images/hp-merch/2020/mobile/heros/how-to-chill-portrait.jpg"},{"name":"imgLandscape","default_value":"/~/media/Images/hp-merch/2020/mobile/heros/how-to-chill-landscape.ashx"},{"name":"ctaURL","default_value":"/cruise-search?cruisedeals=earlysaversale&icid=icp_ccl_earlysaversale_052223_mbl_h1&rateCodes="},{"name":"contentAlignment","default_value":"align-self:center"},{"name":"contentExtraStyles","default_value":""},{"name":"priceAttributes","default_value":"<div class=\"backToFunContainer hp-text-blue-dark hp-text-shadow-npne\" style=\"margin-top: 10%;\">\n        <div style=\"\nline-height:1;\ndisplay: flex;\nflex-direction: column;\nalign-content: center;\njustify-content: center;\nalign-items:center\n    \"><span class=\"hero-headline\" style=\"font-family:tempo;text-align: center;font-size: 39px;line-height: .9;\">KICK THINGS OFF RIGHT<br>WITH SITEWIDE SAVINGS</span>\n         \n        </div>\n  \n\n<div class=\"price-attributes hp-items-start\" style=\"\n    display: flex;\n    font-size: 56px;\n    align-items: flex-end;\n    line-height: .9!important;\n    margin-top: 7px;\n    margin-bottom: 5px;\n    \" aria-hidden=\"true\">\n      <!-- ATTRIBUTE -->\n      \n      <!--PLUS-->\n       \n        <!--PLUS-->\n       <!-- ATTRIBUTE -->\n     \n      <!--PLUS-->\n         <div class=\"attrContainer hp-flex-col\">\n       <span class=\"leadingText-attr \" style=\"\">UP TO</span><span class=\"salePrice-attr\" style=\"\n    line-height: .9!important;\n\">40<span class=\"prePrice-attr hp-flex hp-flex-col\" style=\"font-size: .45em;padding-top: 5px;line-height: .9;\"><span style=\"line-height:.8;align-self: start;\">%<sup style=\"font-size: .55em;top: -9px;position: relative;\">*</sup></span><span style=\"line-height:.9\">OFF</span></span>\n</span><span class=\"leadingText-attr\" style=\"\">CRUISE RATES</span>\n      </div>\n      \n        <div class=\"attrPlus\" style=\"margin-top: -12px;margin-right: 3px;margin-left: 8px;\"></div><div class=\"attrContainer hp-flex-col\">\n       <span class=\"leadingText-attr\" style=\"\"></span><span class=\"salePrice-attr\" style=\"line-height: .9!important;\">FREE</span><span class=\"leadingText-attr\" style=\"\">ROOM UPGRADE</span>\n      </div><div class=\"attrPlus\" style=\"margin-top: -12px;margin-right: -10px;margin-left: 9px;\"></div><div class=\"attrContainer hp-flex-col\">\n       <span class=\"leadingText-attr\" style=\"\">UP TO</span><span class=\"salePrice-attr\" style=\"line-height: .9!important;\"> <span style=\"font-size: .4em;margin-top: 2px;text-align:left;line-height:1;\">$</span>50<sup style=\"font-size: .28em;top: 11px;position: relative;display: none;\">*</sup></span><span class=\"leadingText-attr\" style=\"\">ONBOARD CREDIT</span>\n      </div><!--PLUS-->\n      \n      <!-- ATTRIBUTE -->\n       \n\n      </div><span style=\"\n    font-size: 24px;\n    text-align: center;\n    line-height: 1;\n    margin-top: 9px;\n    align-self: center;\n\" class=\"hp-font-tempo responsive-subcopy\" aria-hidden=\"true\">   ON ALL SAILINGS   </span>\n  \n<a aria-label=\"shop this deal, select sailings through December 2024, are from  $309* per person\" role=\"link\" class=\"hero-mobile-button\" tabindex=\"0\" style=\"margin-top: 15px;text-shadow:none\" onclick=\"/cruise-search?cruisedeals=sitewidesale&amp;icid=crm_ccl_sitewidesale_090524_mbl_hero_h1&amp;rateCodes=OCS,OTR\">SHOP THIS DEAL</a>\n</div>"},{"name":"landscapeMargins","default_value":"margin-top: 0vh;\n\nmargin-bottom: 0vh;\n\nmargin-left: 0vh;\n\nmargin-right:0vh;"},{"name":"imageAlt","default_value":""}];
        (function(widg) {
  var i = 0;
  var field;
  for (; i < widg.$fieldDefaults.length; ++i) {
    field = widg.$fieldDefaults[i];
    if (!widg.hasOwnProperty(field.name)) {
      widg[field.name] = field.default_value;
    }
  }
  })(widget);
        var extension = widget;
        widget._styleTag = document.getElementById('widget-css-30314080267');
if (widget._styleTag) widget._styleTag.parentNode.removeChild(widget._styleTag);
        var extensionElement = document.getElementById('optimizely-extension-' + extension.$instance);
if (extensionElement) {
  extensionElement.parentElement.removeChild(extensionElement);
}

      },
    });

PluginManager.registerWidget({
      widgetId: '30333950668',
      showFn: function(event) {
        var $ = window.optimizely.get('jquery');
        var widget = event.data.config;
        var _template = new Hogan(function(c,p,i) {var t=this;t.b(i=i||"");t.b("<div class=\"c-hero btile-");t.b(t.v(t.d("extension.order",c,p,0)));t.b("\" id=\"optimizely-extension-");t.b(t.v(t.d("extension.$instance",c,p,0)));t.b("\">");t.b("\n" + i);t.b("  <img class=\"c-hero__image\" src=\"");t.b(t.v(t.d("extension.bTileBG",c,p,0)));t.b("\" alt=\"");t.b(t.v(t.d("extension.altText",c,p,0)));t.b("\"> ");t.b("\n" + i);t.b("  <div class=\"b");t.b(t.v(t.d("extension.order",c,p,0)));t.b(" overlay c-hero__overlay\" onclick=\"window.location='");t.b(t.v(t.d("extension.clickThrough",c,p,0)));t.b("';\" style=\"justify-content: ");t.b(t.v(t.d("extension.contentPosition",c,p,0)));t.b("\">");t.b("\n" + i);t.b("              ");t.b(t.t(t.d("extension.b1Copy",c,p,0)));t.b("\n" + i);t.b("       ");t.b("\n" + i);t.b("  </div>");t.b("\n" + i);t.b("</div>");t.b("\n");t.b("\n");return t.fl(); })
        widget.$id = "30333950668";
        widget.$instance = event.data.id;
        widget.$render = _template.render.bind(_template)
        widget.$fieldDefaults = [{"name":"order","default_value":"0"},{"name":"bTileBG","default_value":"/~/media/Images/hp-merch/2023/Mobile/tiles/blue-wave-lines2-b1.jpg"},{"name":"clickThrough","default_value":"/cruise-search?cruisedeals=earlysaversale&icid=crm_ccl_earlysaversale_090524_mbl_btile_b1&rateCodes=OCS"},{"name":"b1Copy","default_value":"<div class=\"hp-text-white hp-text-shadow-none\" style=\"display: flex;flex-direction: column;align-items: center;\">\n  <span class=\"hp-font-tempo\" style=\"line-height: 1;font-size: 42px;\">BOOK EARLY</span>\n  \n  <span class=\"\" style=\"line-height: 1;font-size: 16px;font-family: helvetica;margin-top: 4px;/* font-weight: bold; */\">SAILINGS THROUGH APRIL 2027</span>\n  <span class=\"sr-only\">50% off deposits + more</span>\n  <div class=\"price-attributes \" style=\"\n    font-size: 59px;\n    margin-top: 6px;\n    line-height: 1;\n\" aria-hidden=\"true\">\n    \n    <div class=\"attrContainer\" style=\" display: flex;\n    align-items: center;\n    flex-direction: row;\"><span class=\"leadingText-attr  hp-font-semibold \" style=\"text-align: right;margin-right: 5px;display: none;\">REDUCED<br>DEPOSITS<br>FROM</span> <span class=\"salePrice-attr\" style=\"\">50%<sup style=\"display:none;font-size: 0.35em;top: 14px;position: relative;\">*</sup></span><span class=\"leadingText-attr  hp-font-semibold \" style=\"text-align: left;margin-left: 5px;\">OFF<br>DEPOSITS</span>\n      </div><div class=\"attrPlus\" style=\"\n    margin-right: 0px;\n    margin-left: 0px;\n    margin-bottom: 12px;\n    \"></div><div class=\"attrContainer\" style=\"\n    display: flex;\n    align-items: center;\n    flex-direction: row;\n\">\n      <span class=\"leadingText-attr\" style=\"\n    text-align: right;\n    margin-right: 5px;\n    /* font-weight: bold; */\n\"></span>\n<span class=\"salePrice-attr\" style=\"/* font-size: 1.3em; */\">MORE\n</span>\n    \n    </div>\n\n    \n  </div>\n<a aria-label=\"shop this deal, select sailings through December 2024, are from  $309* per person\" class=\"tile-cta\" style=\"    font-size: 16px!important;\n    padding: 10px 16px!important;\n    margin-top: 10px;\"  onclick=\"/cruise-search?cruisedeals=sitewidesale&amp;icid=crm_ccl_sitewidesale_090524_mbl_btile_b1&amp;rateCodes=OCS,OTR\" >BOOK NOW</a>\n\n</div>"},{"name":"copyMargin","default_value":""},{"name":"contentPosition","default_value":"center"},{"name":"altText","default_value":""}];
        (function(widg) {
  var i = 0;
  var field;
  for (; i < widg.$fieldDefaults.length; ++i) {
    field = widg.$fieldDefaults[i];
    if (!widg.hasOwnProperty(field.name)) {
      widg[field.name] = field.default_value;
    }
  }
  })(widget);
        widget.$html = _template.render({ widget: widget, extension: widget })
        var extension = widget;
        widget._styleTag = document.createElement('style');
widget._styleTag.id = 'widget-css-30333950668';
widget._styleTag.innerHTML = '.tile-cta{ background: #dc1125!important; font-size: 12px!important;  padding:10px 24px!important;  border-radius: 4px!important;    clear: both;    color: #fff;    font-family: "tempo", sans-serif;    border: none;    display: inline-block;    margin: 10px 0 0 0;    line-height: 1;    text-transform: uppercase;    transition: all 0.23s ease-in-out;    cursor: pointer;    font-weight: normal;}.c-hero{  font-family: "tempo", sans-serif;}';
document.getElementsByTagName('head')[0].appendChild(widget._styleTag);
        var utils = optimizely.get('utils');
var $ = window.jQuery;


utils.waitForElement('.js-hero-banners-personalizer-target')
  .then(function(elem) {
  if((extension.order) > 2 ) {
    if($('.js-hero-banners-personalizer-target').children('div').length == 3)
      $(extension.$html).insertAfter($('.js-hero-banners-personalizer-target').children('div')[2]);
    // 4 or more elements, extension order 4
    else if($('.js-hero-banners-personalizer-target').children('div').length == 4)
    {
      var element = $('.js-hero-banners-personalizer-target').children('div').eq(3);
			var className = element.attr('class').split(' ');
      var btileOrder = className[1].charAt(className[1].length - 1);
      if(extension.order > btileOrder)
        $(extension.$html).insertAfter($('.js-hero-banners-personalizer-target').children('div')[$('.js-hero-banners-personalizer-target').children('div').length - 1]);
      else
        $(extension.$html).insertBefore($('.js-hero-banners-personalizer-target').children('div')[$('.js-hero-banners-personalizer-target').children('div').length - 1]);
    }
    else
    {
      var i = 3;
      for(i = 3; i < $('.js-hero-banners-personalizer-target').children('div').length; i++)
      {
        var element = $('.js-hero-banners-personalizer-target').children('div').eq(i);
			var className = element.attr('class').split(' ');
      var btileOrder = className[1].charAt(className[1].length - 1);
        if(extension.order < btileOrder)
        {
          $(extension.$html).insertBefore($('.js-hero-banners-personalizer-target').children('div').eq(i));
          break;
        }
      }
      if (i ==  $('.js-hero-banners-personalizer-target').children('div').length)
      	$(extension.$html).insertAfter($('.js-hero-banners-personalizer-target').children('div').eq($('.js-hero-banners-personalizer-target').children('div').length - 1));
        
    }
  } else {
    // Prepend the extension html to the body
    $('.js-hero-banners-personalizer-target').children('div')[extension.order].innerHTML='';
    $('.js-hero-banners-personalizer-target').children('div')[extension.order].innerHTML= extension.$html;
  }
   utils.waitUntil(function() {
    return window["hpB"+ extension.order+"Url"] != undefined;
  }).then(function() {
      $('.b'+extension.order).attr('href', window["hpB"+extension.order+"Url"]);
  });  
});


      },
      hideFn: function(event) {
        var $ = window.optimizely.get('jquery');
        var widget = event.data.config;
        widget.$id = "30333950668";
        widget.$instance = event.data.id;
        widget.$fieldDefaults = [{"name":"order","default_value":"0"},{"name":"bTileBG","default_value":"/~/media/Images/hp-merch/2023/Mobile/tiles/blue-wave-lines2-b1.jpg"},{"name":"clickThrough","default_value":"/cruise-search?cruisedeals=earlysaversale&icid=crm_ccl_earlysaversale_090524_mbl_btile_b1&rateCodes=OCS"},{"name":"b1Copy","default_value":"<div class=\"hp-text-white hp-text-shadow-none\" style=\"display: flex;flex-direction: column;align-items: center;\">\n  <span class=\"hp-font-tempo\" style=\"line-height: 1;font-size: 42px;\">BOOK EARLY</span>\n  \n  <span class=\"\" style=\"line-height: 1;font-size: 16px;font-family: helvetica;margin-top: 4px;/* font-weight: bold; */\">SAILINGS THROUGH APRIL 2027</span>\n  <span class=\"sr-only\">50% off deposits + more</span>\n  <div class=\"price-attributes \" style=\"\n    font-size: 59px;\n    margin-top: 6px;\n    line-height: 1;\n\" aria-hidden=\"true\">\n    \n    <div class=\"attrContainer\" style=\" display: flex;\n    align-items: center;\n    flex-direction: row;\"><span class=\"leadingText-attr  hp-font-semibold \" style=\"text-align: right;margin-right: 5px;display: none;\">REDUCED<br>DEPOSITS<br>FROM</span> <span class=\"salePrice-attr\" style=\"\">50%<sup style=\"display:none;font-size: 0.35em;top: 14px;position: relative;\">*</sup></span><span class=\"leadingText-attr  hp-font-semibold \" style=\"text-align: left;margin-left: 5px;\">OFF<br>DEPOSITS</span>\n      </div><div class=\"attrPlus\" style=\"\n    margin-right: 0px;\n    margin-left: 0px;\n    margin-bottom: 12px;\n    \"></div><div class=\"attrContainer\" style=\"\n    display: flex;\n    align-items: center;\n    flex-direction: row;\n\">\n      <span class=\"leadingText-attr\" style=\"\n    text-align: right;\n    margin-right: 5px;\n    /* font-weight: bold; */\n\"></span>\n<span class=\"salePrice-attr\" style=\"/* font-size: 1.3em; */\">MORE\n</span>\n    \n    </div>\n\n    \n  </div>\n<a aria-label=\"shop this deal, select sailings through December 2024, are from  $309* per person\" class=\"tile-cta\" style=\"    font-size: 16px!important;\n    padding: 10px 16px!important;\n    margin-top: 10px;\"  onclick=\"/cruise-search?cruisedeals=sitewidesale&amp;icid=crm_ccl_sitewidesale_090524_mbl_btile_b1&amp;rateCodes=OCS,OTR\" >BOOK NOW</a>\n\n</div>"},{"name":"copyMargin","default_value":""},{"name":"contentPosition","default_value":"center"},{"name":"altText","default_value":""}];
        (function(widg) {
  var i = 0;
  var field;
  for (; i < widg.$fieldDefaults.length; ++i) {
    field = widg.$fieldDefaults[i];
    if (!widg.hasOwnProperty(field.name)) {
      widg[field.name] = field.default_value;
    }
  }
  })(widget);
        var extension = widget;
        widget._styleTag = document.getElementById('widget-css-30333950668');
if (widget._styleTag) widget._styleTag.parentNode.removeChild(widget._styleTag);
        var extensionElement = document.getElementById('optimizely-extension-' + extension.$instance);
if (extensionElement) {
  extensionElement.parentElement.removeChild(extensionElement);
}

      },
    });

PluginManager.registerWidget({
      widgetId: '30388620086',
      showFn: function(event) {
        var $ = window.optimizely.get('jquery');
        var widget = event.data.config;
        var _template = new Hogan(function(c,p,i) {var t=this;t.b(i=i||"");t.b("<div id=\"optimizely-extension-");t.b(t.v(t.d("extension.$instance",c,p,0)));t.b("\" class=\"carouselItin\">");t.b("\n" + i);t.b("  <div class=\"carouselHeading-2\">");t.b(t.v(t.d("extension.headline",c,p,0)));t.b("</div>");t.b("\n" + i);t.b("  <div class=\"itinCarousel");t.b(t.v(t.d("extension.carNumber",c,p,0)));t.b("\">");t.b("\n" + i);t.b("	</div>");t.b("\n" + i);t.b("  <p class=\"itinCarDisclaimer\">*All taxes and fees are included</p>");t.b("\n" + i);t.b("</div>");return t.fl(); })
        widget.$id = "30388620086";
        widget.$instance = event.data.id;
        widget.$render = _template.render.bind(_template)
        widget.$fieldDefaults = [{"name":"carNumber","default_value":"1"},{"name":"insertAfterDesktop","default_value":".carousels"},{"name":"insertAfterMobile","default_value":".carouselsMobile"},{"name":"headline","default_value":""},{"name":"numResults","default_value":"4"},{"name":"carCoverImg","default_value":"/~/media/Images/hp-merch/2024/extras/carousel/casino-tbl-2.jpg"},{"name":"htmlOverlayCopy","default_value":"<span class=\"hp-font-tempo hp-text-white\" style=\" font-size: 2.5em;\n    text-align: center;\n    display: flex;\n    flex-direction: column;\n    line-height: 1;\n   \"> CHECK OUT THESE <br> EXCLUSIVE DEALS<br> JUST FOR YOU</span>"},{"name":"icid","default_value":"crm_ccl_fxs_092424_hp_carousel_c1_casino_1"}];
        (function(widg) {
  var i = 0;
  var field;
  for (; i < widg.$fieldDefaults.length; ++i) {
    field = widg.$fieldDefaults[i];
    if (!widg.hasOwnProperty(field.name)) {
      widg[field.name] = field.default_value;
    }
  }
  })(widget);
        widget.$html = _template.render({ widget: widget, extension: widget })
        var extension = widget;
        widget._styleTag = document.createElement('style');
widget._styleTag.id = 'widget-css-30388620086';
widget._styleTag.innerHTML = '/*dots*/.slick-dots {position: unset!important;    display: block;    width: 100%;    padding: 0;    margin: 0;    list-style: none;    text-align: center;}.slick-dots li {    position: relative;    display: inline-block;    width: 20px;    height: 20px;    margin: 0 5px;    padding: 0;    cursor: pointer;}.slick-dots li button {    font-size: 0;    line-height: 0;    display: block;    width: 20px;    height: 20px;    padding: 5px;    cursor: pointer;    color: transparent;    border: 0;    outline: none;    background: transparent;}.slick-dots li.slick-active button:before {    opacity: .75;    color: black;}.slick-dots li.slick-active button:before {    opacity: .75;    color: black;    font-size: 35px !important;}.slick-dots li button:before {    font-family: "slick";    font-size: 25px;    line-height: 20px;    position: absolute;    top: 0;    left: 0;    width: 20px;    height: 20px;    content: "";    text-align: center;    opacity: .25;    color: black;    -webkit-font-smoothing: antialiased;    -moz-osx-font-smoothing: grayscale;}/*dots end*/.itin-carousel {  background-color: #fff575;  border-bottom: 1px solid #e0d769;  color: #555;  padding: 10px;  font-weight: bold;  text-align: center;  font-size: 20px;}.coverImage-2{  height: 398px !important;      background-size: cover!important;  border-radius: 4px;  padding: 15px;  box-sizing: border-box;}.loading{  background: #FFF;  height: 430px !important;  width: 300px;  border-radius: 4px;  margin: 8px;  border: solid 1px rgba(0,0,0,.1);  display: flex !important;  flex-direction: column;  align-items: center;  padding: 10px 0;  box-sizing: border-box;}@media only screen and (min-device-width: 320px) and (max-device-width: 736px) and (-webkit-min-device-pixel-ratio: 2){  .coverImage-2 {    height: 400px !important;  }}@media only screen and (min-width: 375px) and (max-width: 980px) and (-webkit-min-device-pixel-ratio: 2.8) and (orientation: landscape), only screen and (min-width: 375px) and (max-width: 980px) and (-webkit-device-pixel-ratio: 3.5) and (orientation: landscape), only screen and (min-width: 375px) and (max-width: 980px) and (-webkit-device-pixel-ratio: 2.625) and (orientation: landscape){  .coverImage-2 {    height: 375px !important;  }}.slick-slide {    display: block!important;}.carousels{margin-top:40px;}.itinCard-2 {  width: 300px;  display: flex;  flex-direction: column;  justify-content: space-between;  text-decoration: none;  font-family: "Open Sans", sans-serif;  background: #fff;  border: 1px solid rgba(0, 0, 0, 0.1);  border-radius: 4px;  margin: 8px;}.itinCarousel1,.itinCarousel2,.itinCarouselRecently {  max-width: 1400px;  margin: auto;}.carouselHeading-2 {  font-family: tempo;  font-size: 34px;  color: #10559a;  text-transform: uppercase;}.carouselItin {  max-width: 1400px;  margin: auto;}.cardSeeMore {  background: #10559a;  color: white;  width: 200px;  height: 398px !important;  font-size: 2rem;  border-radius: 4px;  font-family: "Open Sans", sans-serif;  margin: 8px;}.itinCard:nth-child(1),.actCard:nth-child(1) {  margin-left: 0;}.dealImage-2 {  height: 118px;  background-position: center !important;  background-size: cover !important;  border-radius: 4px;  margin: 16px;}.dealattr-2{  height:120px;}.description-2{    color: #464646;    text-transform: capitalize;    font-size: 1.25em; display:flex;  height:25px;}.itinCopy-2 {  height: 250px;  border-bottom-left-radius: 4px;  border-bottom-right-radius: 4px;  padding: 15px;  display: flex;  flex-direction: column;  justify-content: space-between;}.title2-2{  display:block;}.dealTitle-2 {  font-family: "Open Sans", sans-serif;  font-size: 16px;  text-decoration: none;  color: #464646;  font-weight: 700;  line-height: 1.05;  height:55px;  display: flex;}.tag{  padding-right:5px;}.tag2{  max-width: none;}.check{  padding-right:5px;  padding-top: 7px;}.pricing-2 {    color: #464646;    margin-top: 43px;  margin-bottom:5px;    display: flex;  justify-content:center;  align-items: center;  height: 250px;}.pricing-2 p {    font-size: 12px;    line-height: 14px;    font-weight: 400;  	margin:0;}.itinDollar-2 {    font-size: 16px;}.pricing-2 .itinPrice-2 {    color: #464646;    font-size: 32px;    line-height: 32px;    font-weight: 700;    font-family: "Open-sans", sans-serif;    margin-right: 8px;    margin-left: 8px;}.itinPriceSubCopy {    font-size: 12px;    line-height: 16px;    font-weight: 700 !important;    top: 0;}.shopnow-2 {    background: #10559A;    color: #FFFFFF;    font-family: "tempo";    text-transform: uppercase;    border: none;    font-size: 18px;    line-height: 22px;    font-weight: 700;    border-radius: 4px;    margin-top: 16px;   padding: 12px 10px;    text-align: center;    height: 48px;    display: flex;    align-items: center;    justify-content: center;}.itinCarousel1 .slick-prev,.itinCarouselRecently .slick-prev,.obaDinCarousel .slick-prev,.itinCarousel2 .slick-prev,.itinCarousel1 .slick-next,.itinCarouselRecently .slick-next,.obaDinCarousel .slick-next,.itinCarousel2 .slick-next {  position: absolute;  z-index: 100;  top: 185px;  left: -20px;  width: 42px;  height: 42px;  background-color: #ffffff;  border-radius: 50%;  border: solid 1px rgba(15, 85, 154, 0.19);  text-indent: -9999px;  cursor: pointer;  background-image: url("data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB3aWR0aD0iMTIwMCIgaGVpZ2h0PSIxMjAwIiB2aWV3Qm94PSIwIDAgMTIwMCAxMjAwIj48Zz48ZyB0cmFuc2Zvcm09InRyYW5zbGF0ZSg2MDAgNjAwKSBzY2FsZSgwLjY5IDAuNjkpIHJvdGF0ZSgwKSB0cmFuc2xhdGUoLTYwMCAtNjAwKSIgc3R5bGU9ImZpbGw6IzBmNTU5YSI+PHN2ZyBmaWxsPSIjMGY1NTlhIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB2ZXJzaW9uPSIxLjEiIHg9IjBweCIgeT0iMHB4IiB2aWV3Qm94PSIxIC0xIDEwMCAxMDAiIHN0eWxlPSJlbmFibGUtYmFja2dyb3VuZDpuZXcgMSAtMSAxMDAgMTAwOyIgeG1sOnNwYWNlPSJwcmVzZXJ2ZSI+PHBvbHlnb24gcG9pbnRzPSIzMC44LDUyLjQgNjcuNiw4OS4zIDc0LjUsODIuNSA0MS4xLDQ5IDc0LjUsMTUuNSA2Ny42LDguNyAzMC44LDQ1LjYgMjcuNSw0OSAiPjwvcG9seWdvbj48L3N2Zz48L2c+PC9nPjwvc3ZnPg==");  background-position: center center;  background-repeat: no-repeat;  background-size: auto 50%;  overflow: hidden;}.itinCarousel1 .slick-next,.itinCarouselRecently .slick-next,.obaDinCarousel .slick-next,.itinCarousel2 .slick-next {  left: 97%;  transform: rotate(-180deg);}.title {  font-family: "Open Sans", sans-serif;  font-weight: bold;  line-height: 0.5;  perspective: 1000px;}div.carouselItin > div > button.slick-arrow.slick-disabled {  display: none !important;}.slick-prev .hidden,.slick-next .hidden {  opacity: 0;  pointer-events: none;}.actCard:not(.slick-active),.itinCard:not(.slick-active) {  opacity: 0.5;  cursor: default;}.itinDollar-2 {  font-size: 55% !important;  margin-right: 0 !important;  margin-left: 0 !important;}.itinCarDisclaimer {  text-align: center;  font-size: 20px;  font-family: "Open sans", sans-serif;}@media (min-width: 1024px) {  .itinCarousel1 .slick-next,  .itinCarouselRecently .slick-next,  .obaDinCarousel .slick-next,  .itinCarousel2 .slick-next {    left: 96%;    top: 185px;  }  .itinCarousel1 .slick-prev,  .itinCarouselRecently .slick-prev,  .obaDinCarousel .slick-prev,  .itinCarousel2 .slick-prev {    left: 5px;    top: 185px;  }  .carouselHeading {    padding-left: 20px;  }  .itinCarousel1,  .itinCarousel2,  .itinCarouselRecently,  .obaDinCarousel {    padding: 0 20px;  }}@media (min-width: 1400px) {  .itinCarousel1 .slick-next,  .itinCarouselRecently .slick-next,  .obaDinCarousel .slick-next,  .itinCarousel2 .slick-next {    left: 97%;    top: 185px;  }  .itinCarousel1 .slick-prev,  .itinCarouselRecently .slick-prev,  .obaDinCarousel .slick-prev,  .itinCarousel2 .slick-prev {    left: 0;    top: 185px;  }}/* Portrait */@media only screen and (min-device-width: 320px) and (max-device-width: 736px) and (-webkit-min-device-pixel-ratio: 2) {    .pricing-2 p {    font-size: 0.7rem;    margin: 0;  }  .itinPrice-2 {    margin: 1%;  }  .description-2{  font-size:14px;  height:45px;    }.dealTitle-2{  height:60px;    }      .pricing-2 {    margin-top: 15px;  }  .pricing-2 .itinPrice-2 {        padding: 0;    line-height: 30px;      }  .shopnow-2 {    font-size: 13px;    padding: 9px 0px;    margin-top: 6px;  }  .itinCarousel1 .slick-prev,  .itinCarouselRecently .slick-prev,  .obaDinCarousel .slick-prev,  .itinCarousel2 .slick-prev {    left: -22px;  }  .itinCarousel1 .slick-next,  .itinCarouselRecently .slick-next,  .obaDinCarousel .slick-next,  .itinCarousel2 .slick-next {    left: 87%;  }  .itinCarousel1,  .itinCarousel2,  .itinCarouselRecently {    max-width: 100%;    margin-left: 24px;  }  .carouselHeading {    font-size: 28px;    margin: 20px 10px 10px 20px;    text-transform: uppercase;  }  .itinCard {    width: 285px;  }  .cardSeeMore {    height: 400px !important;    font-size: 1.5rem;    font-family: "Open Sans", sans-serif;  }      .itinCarDisclaimer {  padding: 0 10px;  font-size: 13px;  }}@media only screen and (min-width: 375px) and (max-width: 980px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape),  only screen and (min-width: 375px) and (max-width: 980px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape),  only screen and (min-width: 375px) and (max-width: 980px) and (-webkit-device-pixel-ratio: 3.5) and (orientation: landscape),  only screen and (min-width: 375px) and (max-width: 980px) and (-webkit-device-pixel-ratio: 2.625) and (orientation: landscape) {  .itinCopy-2 h2 {    font-size: 1.2rem;    height:70px;  }  .itinCopy-2 .days {    font-size: 0.8rem;    margin: 0;  }.description-2{  font-size:1em;    }      .pricing-2 p {    font-size: 0.7rem;    margin: 0;  }  .itinPrice-2 {    margin: 1%;  }  .pricing-2 {    margin-top: 10px;  }  .pricing-2 .itinPrice-2 {    padding: 0;    line-height: 30px;    }  .shopnow-2 {    font-size: 13px;    padding: 9px 0px;    margin-top: 6px;  }  .itinCarousel1 .slick-prev,  .itinCarouselRecently .slick-prev,  .obaDinCarousel .slick-prev,  .itinCarousel2 .slick-prev {    left: -22px;    top: 160px;  }  .itinCarousel1 .slick-next,  .itinCarouselRecently .slick-next,  .obaDinCarousel .slick-next,  .itinCarousel2 .slick-next {    left: 87%;    top: 160px;  }  .itinCarousel1,  .itinCarousel2,  .itinCarouselRecently {    max-width: 100%;    margin-left: 24px;  }  .carouselHeading {    font-size: 28px;    margin: 20px 10px 10px 10px;    text-transform: uppercase;  }  .itinCard {    width: 285px;  }  .cardSeeMore {    height: 375px !important;    font-size: 1.3rem;  }  .itinImage {    height: 175px;  }    .itinCarDisclaimer {  padding: 0 10px;  font-size: 16px;  }}';
document.getElementsByTagName('head')[0].appendChild(widget._styleTag);
        var utils = optimizely.get('utils');
var $ = window.jQuery;
var cookies = document.cookie.split(';');
var opened = false;
var clockImage = "//cdn.optimizely.com/img/752671897/f16c2ba1f8b64a5e8a411bc6a000e26c.svg";
clockImage = "//cdn.optimizely.com/img/752671897/2d69ace94e0b48f7a79b0505b6a173e6.svg";
var dnow = new Date().getTime();
countdowns = [];


utils.waitForElement(".slick-list").then(function() {
//  $(".slick-track").removeAttr('role');
$(".slick-track").attr("role","region");
});
$(".itinControl1").click(function(){
$(".slick-track").attr("role","region");
});
/*
$(".itinControl1").addEventListener('click', function() {
$(".slick-track").attr("role","region");
}, false);*/

utils.waitForElement(".slick-dots").then(function() {
      $(".slick-dots").attr("aria-hidden","true");
$(".slick-dots li").attr("aria-hidden","true");
    $(".slick-dots").attr("tabindex","-1");
  $(".slick-dots li").attr("tabindex","-1");
    $(".slick-dots button").attr("tabindex","-1");
});


//Get current time 
getcurrentTime(function(req){
  var date = req.getResponseHeader("Date");
  dnow = Date.parse(date);
});

//Get current time 
function getcurrentTime(callback){
$.ajax({
		type: "GET",
		cache: false,
		url: 'https://www.carnival.com/pix/1px.gif',
  	fail:function(){console.log('fail');},
		complete: callback
		});
}
start();

function start(){
   $(document).ready(function() {

    var html = '<div id="optimizely-extension-'+extension.$instance+'" class="carouselItin"><span class="carouselHeading-2">'+extension.headline+'</span><div class="itinCarousel'+extension.carNumber+'"></div><p class="itinCarDisclaimer">*All taxes and fees are included.</p></div>';
    utils.waitForElement(extension.insertAfterDesktop).then(function(elem) {
      elem.insertAdjacentHTML('beforeend',html);
      init();
    });

    utils.waitForElement(extension.insertAfterMobile).then(function(elem) {
      elem.insertAdjacentHTML('beforeend', html);
      init();
    });

    function init(){
      

      $(".itinCarousel"+extension.carNumber).slick({
        slidesToShow: 4,
        slidesToScroll: 2,
        infinite: false,
        variableWidth: true,
          dots: true,
        prevArrow: '<button class="itinControl'+extension.carNumber+' slick-prev" aria-label="Previous items in the Carousel" tabindex="1" type="button"">Previous</button>',
        nextArrow: '<button class="itinControl'+extension.carNumber+' slick-next" aria-label="Next items in the Carousel" tabindex="1" type="button">Next</button>',
        responsive: [
          {
            breakpoint: 1150,
            settings: {
              slidesToShow: 2,
              slidesToScroll: 2,
            }
          },
          {
            breakpoint: 568,
            settings: {
              slidesToShow: 1,
              slidesToScroll: 1,
            }
          },
        ]
      });



		
    /*  //Show full name if not on a small screen 
    if(user.length && window.innerWidth > 375 ){
      decodedUser = decodeURIComponent(user[0]);
      decodedUser = decodedUser.slice(9);
      decodedUser = JSON.parse(decodedUser);
      decodedUser = decodedUser.FirstName;
      if(decodedUser.length < 12){ $('.saleTitle').text('Hi '+capitalize(decodedUser.toLowerCase())+'! ' + extension.heading);}
    } 
    
  
  
	//set interval for any clock set
setInterval(function(){
    countdowns.forEach(function(c,i){
      if(c != ''){
      var distance = c - dnow;

      if (distance < 0) {
        $('.h'+i).parent().parent().css('display','none');
      }
      
      
      var dhours = Math.floor(distance / (1000 * 60 * 60));
      dhours = (dhours.toString().length < 2 ? "0" + dhours : dhours);
      var dminutes = Math.floor((distance % (1000 * 60 * 60)) / (1000 * 60));
      dminutes = (dminutes.toString().length < 2 ? "0" + dminutes : dminutes);			
      var dseconds = Math.floor((distance % (1000 * 60)) / 1000);
      dseconds = (dseconds.toString().length < 2 ? "0" + dseconds : dseconds);

        //adds 1 second to server time to minimize the amount of requests needed to be made to server for time

        if (dhours > 48) {
          $('.h'+i).parent().parent().css('display','none')
        }else{
          //Update the values in html 
          $('.h'+i).html(dhours);
          $('.m'+i).html(dminutes);
          $('.s'+i).html(dseconds);
        }
      }
    })
    dnow = dnow + 1000;
  
},1000);*/
      



      var loading = '<div class="loading"><i class="fa fa-picture-o" style="font-size: 200px;color:#ddd;"></i><div class="ad-tile-loading" style=" display: flex; flex-direction: column; "><div class="ad-tile-loading-line" style="width: 200px; "></div><div class="ad-tile-loading-line" style=" width: 200px; "></div><div class="ad-tile-loading-line" style=" width: 200px;  "></div></div><div class="ad-tile-loading" style=" margin-top: 17px;  display: flex; flex-direction: column;"><div class="ad-tile-loading-line" style="width: 200px; "></div><div class="ad-tile-loading-line" style=" width: 200px; "></div><div class="ad-tile-loading-line" style=" width: 200px;  "></div></div></div>';
      $('.itinCarousel'+extension.carNumber).slick('slickAdd',loading);
      $('.itinCarousel'+extension.carNumber).slick('slickAdd',loading);
      $('.itinCarousel'+extension.carNumber).slick('slickAdd',loading);
      $('.itinCarousel'+extension.carNumber).slick('slickAdd',loading);

function getOffers(decoded, callback){
  $.ajax({
    type: "GET",
    cache: true,
    url: 'https://www.carnival.com/api/cruisedeals/'+decoded,
    error: function(error){console.log('error',error);},
    success: callback
  }); 
}

 

//get user cookie to get VIFP Num
var user =  cookies.filter(function(each){return each.startsWith(' cclUser=');});
var vifp;
var vifpnum = window.pastGuestNum;
var decoded = "";

 

//Makes request to api, to get TGO cookie conetents. 
if(user.length != 0){
  vifp = decodeURIComponent(user[0]);
  vifp = vifp.slice(9);
  vifp = JSON.parse(vifp);
  vifp = vifp.PastGuestNumber;
  $.get( "https://www.carnival.com/cruisesearch/api/targetedOffers/get?PastGuestNumber="+vifp+"&TimeStamp="+Date.now(), function( data ) {
    decoded = getTgoCookie();
    getOffers(decoded,getOffersCb); 
  });
}

else if(user.length === 0 && vifpnum !=null){
    vifp = vifpnum;
   $.get( "https://www.carnival.com/cruisesearch/api/targetedOffers/get?PastGuestNumber="+vifp+"&TimeStamp="+Date.now(), function( data ) {
    decoded = getTgoCookie();
    getOffers(decoded,getOffersCb); 
  });
}      
else{
  decoded = getTgoCookie();
  getOffers(decoded,getOffersCb); 
}

 

//functions to get cookie
function getCookie(name) {
  var value = "; ".concat(document.cookie);
  var parts = value.split("; ".concat(name, "="));
  if (parts.length === 2) return parts.pop().split(';').shift();
}

 

//function that parses tgo Cookie contents
function getTgoCookie(){
  var tgoCookie = getCookie('TargetedOffersCookie');
  var decoded = "";
  if(tgoCookie){
   var tierCode = document.cookie.match('(^|;)\\s*TierCodeCookieSessionOnly\\s*=\\s*([^;]+)')[2];
    decoded = decodeURIComponent(tgoCookie);
        decoded = decoded.substring(0,(decoded.indexOf('|')));
    decoded = decoded.replace('=','?tgos=');
    decoded = decoded+'&tierCode='+tierCode+'&locality=1&currency=USD&pastGuestNumber='+ vifp;

 

  }
  return decoded;
}

      /*
//function that parses tgo Cookie contents
function getTgoCookie(){
  var tgoCookie = getCookie('TargetedOffersCookie');
  var decoded = "";
  if(tgoCookie){
    decoded = decodeURIComponent(tgoCookie);
    decoded = decoded.slice(6);
    decoded = decoded.substring(0,(decoded.indexOf('|')));
    decoded = decoded.replace('=','offers?tgos=');
  }
  return decoded;
}

      */
//callback for api call 
function getOffersCb (data){
  var results;

  
  //if there are tgo offers
  if(decoded != ""){
    results = data.Items;
    results = results.filter(function(each){
      return each.Title;
    });
		
    //if they have less than 4 offers fetch public offers to fill in spaces
    if(results.length < 4){
      var decodedTemp = "";
      getOffers(decodedTemp ,function(data){
        try{results = results.concat(data[1].Items);}catch(e){}
        try{results = results.concat(data[2].Items);}catch(e){}
        loadResults(results);
      });
    }//User has 4 or more TGOs
    else{
      loadResults(results);
    }
    //NO tgo since there wasnt a cookie or a logged in user. Just show public offers
  }else{
    //starts at 1 since 0 is sweeps to join VIFP
    results = data[0].Items;
    results = results.concat(data[1].Items);
    loadResults(results);
  }
}
        
          var card = $('<div>').addClass('itinCard-2');
                card.attr(  { 'aria-label':'All Deals', 'role': 'link' });
          var image = $('<div>').addClass('itinImage-2 coverImage-2');
          var imageUlr = ''+extension.carCoverImg+'';
     			var tag =  $('<div>').addClass('tag').append('<img src="//cdn.optimizely.com/img/752671897/b7b3f11e7e074d0c81e1dbe83fe37449.png">');
      		var check =  $('<div>').addClass('check').append('<img src="//cdn.optimizely.com/img/752671897/a29dcd7599c1438690cb46f3b6f4c110.png">');
          image.css('background','url(https://www.carnival.com'+imageUlr+')');
          image.append(''+extension.htmlOverlayCopy+'');

          card.append(image);

					$('.loading').remove();
          $('.itinCarousel'+extension.carNumber).slick('slickAdd',card);
 function loadResults(results) {
    // If there are more than 4 results, trim it to 4
    $(".slick-track").removeAttr('role');
    $(".slick-track").attr("role", "region");

    results = results.length > 4 ? results.slice(0, 4) : results;
    results.forEach(function(each, i) {
        if (each.Title != 'VIFP Club Members Get Bigger Savings!' && each.Title != '<style>\n.SmileIconBullet {\nmax-width: 36px;\n    max-height: 21px;\n}\n</style><span  >HALF M<img src=\"~/media/Images/explore/half-moon-cay-smiley-1.png\" class=\"SmileIconBullet\"><img src=\"~/media/Images/explore/half-moon-cay-smiley-2.png\" class=\"SmileIconBullet\">N CAY - A Private Island Paradise</span>\n\n' && each.Price != null) {
            var card = $('<a>').addClass('itinCard-2');
            card.attr({ 'role': 'group', 'aria-roledescription': 'slide' });
              card.attr('href',each.CtaUrl.split("icid")[0]+'&icid='+extension.icid);
            card.attr('tabindex', '1');

            var plain = each.Title.replace(/<[^>]+>/g, '');

            // Add the card number to the aria-label
            card.attr('aria-label', 'Card ' + (i + 1) + ': ' + plain + ' cruises from ' + each.Price + ' per Person');
            
            var image = $('<div>').css({ 'background': "url(" + encodeURI(each.ImageUrl) + ") no-repeat" });
            image.css('background-size', 'cover');
            $(image).addClass('dealImage-2');
            
            var tag = $('<div>').addClass('tag').append('<img class="tag2" alt="" src="//cdn.optimizely.com/img/752671897/b7b3f11e7e074d0c81e1dbe83fe37449.png">');
            var check = $('<div>').addClass('check').append('<img alt="" src="//cdn.optimizely.com/img/752671897/a29dcd7599c1438690cb46f3b6f4c110.png">');
            var copy = $('<div>').addClass('itinCopy-2');
            var deal = $('<div>').addClass('dealattr-2');
            var pricing = $('<div>').addClass('pricing-2');
            var cruises = $('<p>').append('Cruises<br>From');
            cruises.css('text-align', 'right');
            var maintitle = $('<div>').addClass('dealTitle-2');
            var title = $('<div>').addClass('title2-2').append(each.Title);
            
            var html;
            if (each.Description !== null) {
                html = each.Description;
            } else {
                html = each.Subtitle;
            }

            var parser = new DOMParser();
            var doc = parser.parseFromString(html, "text/html");
            var doc2 = doc.querySelectorAll("li:nth-child(1)");
            var newHtml = doc2[0].innerHTML;
            var description = $('<div>').addClass('description-2').attr('aria-hidden', 'true').append(newHtml + ' + more!');
            var description2 = $('<span>').addClass('sr-only').append(' cruises from $' + each.Price + ' per person');
            var price = $('<div>').addClass('itinPrice-2').append('<sup class="itinDollar-2">$</sup>' + each.Price + '<sup class="itinDollar-2">*</sup>');
            var pp = $('<p>').append('Per<br>Person');
            pp.css('text-align', 'left');
            var cta = $('<a>').addClass('shopnow-2').attr({ 'aria-label': 'SHOP NOW  ' + each.Title, 'z-index': '1', 'role': 'button' }).append('Shop Now');

            if (each.Title.length <= 60) {
                pricing.append(cruises);
                pricing.append(price);
                pricing.append(pp);
                copy.append(deal);
                maintitle.append(tag);
                maintitle.append(title);
                deal.append(maintitle);
                description.prepend(check);
                deal.append(description2);
                deal.append(description);
                copy.append(pricing);
                copy.append(cta);
                card.append(image);
                card.append(copy);
                $('.itinCarousel' + extension.carNumber).slick('slickAdd', card);
                $('.itinCard-2.slick-slide.slick-active').attr('tabindex', '0');
            } else {
                pricing.append(cruises);
                pricing.append(price);
                pricing.append(pp);
                copy.append(deal);
                maintitle.append(tag);
                maintitle.append(title);
                deal.append(maintitle);
                copy.append(pricing);
                copy.append(cta);
                card.append(image);
                card.append(copy);
                $('.itinCarousel' + extension.carNumber).slick('slickAdd', card);
                $('.itinCard-2.slick-slide.slick-active').attr('tabindex', '0');
            }
        }
    });

    var card = $('<a>').addClass('cardSeeMore');
    card.attr('href', 'https://www.carnival.com/cruise-deals?icid=' + extension.icid);
    card.attr('aria-label', 'All Deals');
    card.attr('tabindex', '-1');
    var price = $('<div>').append('All Deals');
    price.css({ 'font-family': '"Open Sans", sans-serif', 'font-weight': '100' });
    $(price).css({ 'color': 'white', 'display': 'flex', 'justify-content': 'center', 'align-items': 'center', 'height': '100%', 'text-decoration': 'underline' });
    card.append(price);

    $('.itinCarousel' + extension.carNumber).slick('slickAdd', card);
}

    $(document).on('click','.slick-next',function(){
        setTimeout(function () {
          $('div.carouselItin > div.itinCarousel'+extension.carNumber+' > div > div > a.itinCard-2.slick-slide.slick-active').attr('tabindex','0');
  			 $('div.carouselItin > div.itinCarousel'+extension.carNumber+' > div > div > a.itinCard-2.slick-slide.slick-current.slick-active')[0].focus();
          $('div.carouselItin > div.itinCarousel'+extension.carNumber+' > div > div > a.cardSeeMore.slick-slide.slick-active').attr("tabindex", "0");
            $('div.carouselItin > div.itinCarousel'+extension.carNumber+' > div > div > a.cardSeeMore.slick-slide.slick-current.slick-active').attr("tabindex", "0");
        }, 500);
      });
           $(document).on('click','.slick-prev',function(){
        setTimeout(function () {
          $('div.carouselItin > div.itinCarousel'+extension.carNumber+' > div > div > a.itinCard-2.slick-slide.slick-active').attr('tabindex','0');
	 $('div.carouselItin > div.itinCarousel'+extension.carNumber+' > div > div >a.slick-active:last').focus();
          
           $('div.carouselItin > div.itinCarousel'+extension.carNumber+' > div > div > a.cardSeeMore.slick-slide.slick-active').attr("tabindex", "0");
        }, 500);
      });
    }//ends init function
  });//ends document ready
}//ends start function
if (!String.prototype.includes) {
  String.prototype.includes = function(search, start) {
    'use strict';

    if (search instanceof RegExp) {
      throw TypeError('first argument must not be a RegExp');
    } 
    if (start === undefined) { start = 0; }
    return this.indexOf(search, start) !== -1;
  };
}

function loadScript(url, callback) {
  jQuery.ajax({
    url: url,
    dataType: 'script',
    success: callback,
    async: true,
    cache: true
  });
}

function isSlickAvailable() {
  return typeof $.fn.slick === "function";
}

    var attemps = 0;
		var slickPoll = setInterval(function() {
			if (isSlickAvailable()) {
				clearInterval(slickPoll);
			} else if (attemps > 3) {
				loadScript('/assets/scripts/vendor/slick/slick.js', function() {
				});
			}
			attemps++;
    }, 250);
      },
      hideFn: function(event) {
        var $ = window.optimizely.get('jquery');
        var widget = event.data.config;
        widget.$id = "30388620086";
        widget.$instance = event.data.id;
        widget.$fieldDefaults = [{"name":"carNumber","default_value":"1"},{"name":"insertAfterDesktop","default_value":".carousels"},{"name":"insertAfterMobile","default_value":".carouselsMobile"},{"name":"headline","default_value":""},{"name":"numResults","default_value":"4"},{"name":"carCoverImg","default_value":"/~/media/Images/hp-merch/2024/extras/carousel/casino-tbl-2.jpg"},{"name":"htmlOverlayCopy","default_value":"<span class=\"hp-font-tempo hp-text-white\" style=\" font-size: 2.5em;\n    text-align: center;\n    display: flex;\n    flex-direction: column;\n    line-height: 1;\n   \"> CHECK OUT THESE <br> EXCLUSIVE DEALS<br> JUST FOR YOU</span>"},{"name":"icid","default_value":"crm_ccl_fxs_092424_hp_carousel_c1_casino_1"}];
        (function(widg) {
  var i = 0;
  var field;
  for (; i < widg.$fieldDefaults.length; ++i) {
    field = widg.$fieldDefaults[i];
    if (!widg.hasOwnProperty(field.name)) {
      widg[field.name] = field.default_value;
    }
  }
  })(widget);
        var extension = widget;
        widget._styleTag = document.getElementById('widget-css-30388620086');
if (widget._styleTag) widget._styleTag.parentNode.removeChild(widget._styleTag);
        var extensionElement = document.getElementById('optimizely-extension-' + extension.$instance);
if (extensionElement) {
  extensionElement.parentElement.removeChild(extensionElement);
}

      },
    });

PluginManager.registerWidget({
      widgetId: '30451680475',
      showFn: function(event) {
        var $ = window.optimizely.get('jquery');
        var widget = event.data.config;
        var _template = new Hogan(function(c,p,i) {var t=this;t.b(i=i||"");t.b("<div id=\"optimizely-extension-");t.b(t.v(t.d("extension.$instance",c,p,0)));t.b("\" style=\"");t.b(t.v(t.d("extension.backgroundColor",c,p,0)));t.b("\" class=\"guide-pack\">");t.b("\n" + i);t.b("  <span class=\"copy-pack-title\" style=\"");t.b(t.v(t.d("extension.titleCSS",c,p,0)));t.b("\">");t.b(t.t(t.d("extension.title",c,p,0)));t.b("</span>");t.b("\n" + i);t.b("  <div class=\"guide-pack-container pack-");t.b(t.v(t.d("extension.pNum",c,p,0)));t.b("\" >");t.b("\n" + i);t.b("    <div class=\"pack-item p1\" alt style=\"background-image:url(");t.b(t.v(t.d("extension.tile1Image",c,p,0)));t.b(")\" onclick=\"window.location.href='");t.b(t.v(t.d("extension.tile1Url",c,p,0)));t.b("'\" >");t.b("\n" + i);t.b("      ");t.b("\n" + i);t.b("        <div class=\"copy-pack-copy pcopy-");t.b(t.v(t.d("extension.pNum",c,p,0)));t.b(" ");t.b(t.v(t.d("extension.packtitle",c,p,0)));t.b(" ");t.b(t.v(t.d("extension.color",c,p,0)));t.b(" hp-font-tempo\">");t.b("\n" + i);t.b("     <span class=\"pack-title ptitle-");t.b(t.v(t.d("extension.pNum",c,p,0)));t.b("\" >");t.b(t.t(t.d("extension.tile1",c,p,0)));t.b("</span>");t.b("\n" + i);t.b("    <div class=\"pack-price-attributes p1-price");t.b(t.v(t.d("extension.pNum",c,p,0)));t.b("\" aria-hidden=\"true\"></div>");t.b("\n" + i);t.b("    <a  tabindex=\"0\" aria-label=\"");t.b(t.v(t.d("extension.p1aria",c,p,0)));t.b("\" class=\"pack-copy-cta packCta-");t.b(t.v(t.d("extension.pNum",c,p,0)));t.b(" ctaHover\" href=\"");t.b(t.v(t.d("extension.tile1Url",c,p,0)));t.b("\">");t.b(t.v(t.d("extension.cta",c,p,0)));t.b("</a>");t.b("\n" + i);t.b(" ");t.b("\n" + i);t.b("         ");t.b("\n" + i);t.b("</div>");t.b("\n" + i);t.b("    </div>");t.b("\n" + i);t.b("        <div class=\"pack-item p2\" alt style=\"background-image:url(");t.b(t.v(t.d("extension.tile2Image",c,p,0)));t.b(")\" onclick=\"window.location.href='");t.b(t.v(t.d("extension.tile2Url",c,p,0)));t.b("'\">");t.b("\n" + i);t.b("      ");t.b("\n" + i);t.b("          <div class=\"copy-pack-copy pcopy-");t.b(t.v(t.d("extension.pNum",c,p,0)));t.b(" ");t.b(t.v(t.d("extension.packtitle",c,p,0)));t.b(" ");t.b(t.v(t.d("extension.color",c,p,0)));t.b(" hp-font-tempo\">");t.b("\n" + i);t.b("     <span class=\"pack-title ptitle-");t.b(t.v(t.d("extension.pNum",c,p,0)));t.b("\">");t.b(t.t(t.d("extension.tile2",c,p,0)));t.b("</span>");t.b("\n" + i);t.b("    <div class=\"pack-price-attributes p2-price");t.b(t.v(t.d("extension.pNum",c,p,0)));t.b("\" aria-hidden=\"true\"></div>");t.b("\n" + i);t.b("   <a  tabindex=\"0\"  aria-label=\"");t.b(t.v(t.d("extension.p2aria",c,p,0)));t.b("\" class=\"pack-copy-cta packCta-");t.b(t.v(t.d("extension.pNum",c,p,0)));t.b(" ctaHover\" href=\"");t.b(t.v(t.d("extension.tile2Url",c,p,0)));t.b("\">");t.b(t.v(t.d("extension.cta",c,p,0)));t.b("</a>");t.b("\n" + i);t.b("         </div>");t.b("\n" + i);t.b("    ");t.b("\n" + i);t.b("    </div>");t.b("\n" + i);t.b("      <div class=\"pack-item p3 show-");t.b(t.v(t.d("extension.TilesCheck",c,p,0)));t.b("\" alt style=\"background-image:url(");t.b(t.v(t.d("extension.tile3Image",c,p,0)));t.b(")\" onclick=\"window.location.href='");t.b(t.v(t.d("extension.tile3Url",c,p,0)));t.b("'\">");t.b("\n" + i);t.b("       ");t.b("\n" + i);t.b("        <div class=\"copy-pack-copy pcopy-");t.b(t.v(t.d("extension.pNum",c,p,0)));t.b(" ");t.b(t.v(t.d("extension.packtitle",c,p,0)));t.b(" ");t.b(t.v(t.d("extension.color",c,p,0)));t.b(" hp-font-tempo\">");t.b("\n" + i);t.b("     <span class=\"pack-title ptitle-");t.b(t.v(t.d("extension.pNum",c,p,0)));t.b("\">");t.b(t.t(t.d("extension.tile3",c,p,0)));t.b("</span>");t.b("\n" + i);t.b("   <div class=\"pack-price-attributes p3-price");t.b(t.v(t.d("extension.pNum",c,p,0)));t.b("\" aria-hidden=\"true\"></div>");t.b("\n" + i);t.b("   <a tabindex=\"0\"  aria-label=\"");t.b(t.v(t.d("extension.p3aria",c,p,0)));t.b("\" class=\"pack-copy-cta packCta-");t.b(t.v(t.d("extension.pNum",c,p,0)));t.b(" ctaHover\" href=\"");t.b(t.v(t.d("extension.tile3Url",c,p,0)));t.b("\">");t.b(t.v(t.d("extension.cta",c,p,0)));t.b("</a>");t.b("\n" + i);t.b("          </div>");t.b("\n" + i);t.b("             ");t.b("\n" + i);t.b("    </div>");t.b("\n" + i);t.b("       <div class=\"pack-item p4 show-");t.b(t.v(t.d("extension.TilesCheck",c,p,0)));t.b("\" alt style=\"background-image:url(");t.b(t.v(t.d("extension.tile4Image",c,p,0)));t.b(")\" onclick=\"window.location.href='");t.b(t.v(t.d("extension.tile4Url",c,p,0)));t.b("'\">");t.b("\n" + i);t.b("     ");t.b("\n" + i);t.b("         <div class=\"copy-pack-copy pcopy-");t.b(t.v(t.d("extension.pNum",c,p,0)));t.b(" ");t.b(t.v(t.d("extension.packtitle",c,p,0)));t.b(" ");t.b(t.v(t.d("extension.color",c,p,0)));t.b(" hp-font-tempo\">");t.b("\n" + i);t.b("     <span class=\"pack-title ptitle-");t.b(t.v(t.d("extension.pNum",c,p,0)));t.b("\">");t.b(t.t(t.d("extension.tile4",c,p,0)));t.b("</span>");t.b("\n" + i);t.b("   <div class=\"pack-price-attributes p4-price");t.b(t.v(t.d("extension.pNum",c,p,0)));t.b("\" aria-hidden=\"true\"></div>");t.b("\n" + i);t.b("   <a tabindex=\"0\"  aria-label=\"");t.b(t.v(t.d("extension.p4aria",c,p,0)));t.b("\" class=\"pack-copy-cta packCta-");t.b(t.v(t.d("extension.pNum",c,p,0)));t.b(" ctaHover\" href=\"");t.b(t.v(t.d("extension.tile4Url",c,p,0)));t.b("\">");t.b(t.v(t.d("extension.cta",c,p,0)));t.b("</a>");t.b("\n" + i);t.b("</div> ");t.b("\n" + i);t.b("  ");t.b("\n" + i);t.b("    </div>");t.b("\n" + i);t.b("          <div class=\"pack-item p5 show-");t.b(t.v(t.d("extension.TilesCheck",c,p,0)));t.b("\" alt style=\"background-image:url(");t.b(t.v(t.d("extension.tile5Image",c,p,0)));t.b(")\" onclick=\"window.location.href='");t.b(t.v(t.d("extension.tile5Url",c,p,0)));t.b("'\">");t.b("\n" + i);t.b("      ");t.b("\n" + i);t.b("            <div class=\"copy-pack-copy pcopy-");t.b(t.v(t.d("extension.pNum",c,p,0)));t.b(" ");t.b(t.v(t.d("extension.packtitle",c,p,0)));t.b(" ");t.b(t.v(t.d("extension.color",c,p,0)));t.b(" hp-font-tempo\">");t.b("\n" + i);t.b("     <span class=\"pack-title ptitle-");t.b(t.v(t.d("extension.pNum",c,p,0)));t.b("\">");t.b(t.t(t.d("extension.tile5",c,p,0)));t.b("</span>");t.b("\n" + i);t.b("   <div class=\"pack-price-attributes p5-price");t.b(t.v(t.d("extension.pNum",c,p,0)));t.b("\" aria-hidden=\"true\"></div>");t.b("\n" + i);t.b("   <a tabindex=\"0\"  aria-label=\"");t.b(t.v(t.d("extension.p5aria",c,p,0)));t.b("\" class=\"pack-copy-cta packCta-");t.b(t.v(t.d("extension.pNum",c,p,0)));t.b(" ctaHover\" href=\"");t.b(t.v(t.d("extension.tile5Url",c,p,0)));t.b("\">");t.b(t.v(t.d("extension.cta",c,p,0)));t.b("</a>");t.b("\n" + i);t.b("</div>        ");t.b("\n" + i);t.b("            </div>");t.b("\n" + i);t.b("    ");t.b("\n" + i);t.b("      </div>");t.b("\n" + i);t.b(" </div>");t.b("\n" + i);t.b(" ");return t.fl(); })
        widget.$id = "30451680475";
        widget.$instance = event.data.id;
        widget.$render = _template.render.bind(_template)
        widget.$fieldDefaults = [{"name":"pNum","default_value":"1"},{"name":"TilesCheck","default_value":"4-tiles"},{"name":"backgroundColor","default_value":"background-color: #c3d4e6;\n    padding-left: 5px;\n    padding-right: 5px;"},{"name":"appendTo","default_value":".bucket-4"},{"name":"title","default_value":"<span style=\"width: 100%;display: block;margin: 0 25px 0 0;flex: 1;height: 2.5px;background-color: #10559a !important;position: relative;bottom: 16px;\"></span>  <img src=\"/~/media/Images/hp-merch/2024/extras/graphics/ofs.png\" alt=\"new sailings unlocked\" style=\"max-width: 500px;padding-top: 37px;\"> <span style=\"width: 100%;display: block;margin: 0 0 0 25px;flex: 1;height: 2.9px;background-color: #10559a !important;position: relative;bottom: 16px;\"></span>"},{"name":"titleCSS","default_value":"  color: #10559a; \n  display: flex;\n  align-items: center;\n  justify-content: center;\n  white-space: nowrap;"},{"name":"tile1Image","default_value":"/~/media/Images/hp-merch/2023/Desktop/tiles/caribbean-tile.jpg"},{"name":"tile2Image","default_value":"/~/media/Images/hp-merch/2023/Desktop/tiles/bahamas-tile.jpg"},{"name":"tile3Image","default_value":"/~/media/Images/hp-merch/2023/Desktop/tiles/mexico-tile.jpg"},{"name":"tile4Image","default_value":"/~/media/Images/hp-merch/2023/Desktop/tiles/journeys-tile.jpg"},{"name":"tile5Image","default_value":"/~/media/Images/hp-merch/2023/Desktop/tiles/journeys-tile.jpg"},{"name":"color","default_value":"hp-text-white"},{"name":"packtitle","default_value":"title-top"},{"name":"dskheight","default_value":"440px"},{"name":"mblheight","default_value":"400px"},{"name":"tile1","default_value":"<span class=\"copy-pack-title-1\"></span>\n  <span class=\"copy-pack-title-2\" aria-hidden=\"true\">NORFOLK SAILINGS</span>\n<span class=\"subcopy-ofs\">Cruise to the Caribbean and The Bahamas from Norfolk on Carnival Sunshine<sup class=\"tm\"></sup></span>"},{"name":"tile2","default_value":"<span class=\"copy-pack-title-1\"></span>\n  <span class=\"copy-pack-title-2\" aria-hidden=\"true\">CARNIVAL HORIZON<br>SAILINGS</span>\n<span class=\"subcopy-ofs\">Explore vibrant destinations across the Caribbean with new Carnival Horizon<sup class=\"tm\"></sup>sailings through spring 2027</span>"},{"name":"tile3","default_value":"<span class=\"copy-pack-title-1\"></span>\n  <span class=\"copy-pack-title-2\" aria-hidden=\"true\">PORT CANAVERAL<br>SAILINGS</span>\n<span class=\"subcopy-ofs\">Carnival Vista<sup class=\"tm\"></sup> will be sailing from Port Canaveral including 6 and 8-day voyages to the Eastern and Southern Caribbean</span>"},{"name":"tile4","default_value":"<span class=\"copy-pack-title-1\"></span>\n  <span class=\"copy-pack-title-2\" aria-hidden=\"true\">CARNIVAL LUMINOSA<br>SAILINGS</span>\n<span class=\"subcopy-ofs\">Carnival Luminosa<sup class=\"tm\"></sup> will sail from San Fransisco starting in April cruising to Alaska, Baja Mexico and Ensenda</span>"},{"name":"tile5","default_value":"<span class=\"copy-pack-title-1\"></span>\n  <span class=\"copy-pack-title-2\" aria-hidden=\"true\">CARNIVAL LUMINOSA<br>SAILINGS</span>\n<span class=\"subcopy-ofs\">Carnival Luminosa<sup class=\"tm\"></sup> will sail from San Fransisco starting in April cruising to Alaska, Baja Mexico and Ensenda</span>"},{"name":"cta","default_value":"SEARCH CRUISES"},{"name":"tile1Url","default_value":"/cruise-search?icid=crm_ccl_ships_091224_resp_pack_p1_nonbooked_3&ship=cb"},{"name":"tile2Url","default_value":"/cruise-search?icid=crm_ccl_ships_091224_resp_pack_p2_nonbooked_3&ship=cb"},{"name":"tile3Url","default_value":"/cruise-search?icid=crm_ccl_ships_091224_resp_pack_p3_nonbooked_3&ship=cb"},{"name":"tile4Url","default_value":"/cruise-search?icid=crm_ccl_ships_091224_resp_pack_p4_nonbooked_3&ship=cb"},{"name":"tile5Url","default_value":"/cruise-search?icid=crm_ccl_ships_091224_resp_pack_p5_nonbooked_3&ship=cb"},{"name":"p1aria","default_value":"Carnival celebration"},{"name":"p2aria","default_value":"mardi gras"},{"name":"p3aria","default_value":"carnival celebration"},{"name":"p4aria","default_value":""},{"name":"p5aria","default_value":""},{"name":"showprice","default_value":"false"},{"name":"p1price","default_value":"numadults=2"},{"name":"p2price","default_value":"numadults=2"},{"name":"p3price","default_value":"numadults=2"},{"name":"p4price","default_value":"numadults=2"},{"name":"p5price","default_value":"numadults=2"}];
        (function(widg) {
  var i = 0;
  var field;
  for (; i < widg.$fieldDefaults.length; ++i) {
    field = widg.$fieldDefaults[i];
    if (!widg.hasOwnProperty(field.name)) {
      widg[field.name] = field.default_value;
    }
  }
  })(widget);
        widget.$html = _template.render({ widget: widget, extension: widget })
        var extension = widget;
        widget._styleTag = document.createElement('style');
widget._styleTag.id = 'widget-css-30451680475';
widget._styleTag.innerHTML = '.p5.show-4-tiles{  display:none;}.p4.show-3-tiles,.p5.show-3-tiles{  display:none;}.p3.show-2-tiles,.p4.show-2-tiles,.p5.show-2-tiles {  display:none;}/*.gradient{  height: 300px;  width: 100%; background-image: linear-gradient(to bottom, #10559a,#1570CB, transparent);    }*/.guide-pack{  display:flex;  flex-direction:column;  max-width:1400px;  margin:auto;  margin-top:25px;  padding-bottom: 25px;}.guide-pack>.fees-disclaimer{  font-family: "Open Sans";   font-size: 16px;   text-align: center;  margin-top:-8px;}.copy-pack-title{  font-family: tempo;  font-size: 46px;  text-align:center;  padding:8px;}.pack-title{  font-family: tempo;    text-align:center;  display: flex;  flex-direction:column;    justify-content: center;    align-items: center;  text-transform: uppercase;}.guide-pack-container{    display: flex;  	cursor: pointer;  }.pack-dollar-sign{ font-size: 0.4em;    top: -7%;    position: relative;}.pack-asterisk{ font-size: 0.3em;    top: -10%;    position: relative;}.subcopy-ofs>.tm{   font-size: 8px;    top: -5px;    position: relative;  vertical-align:initial;}.pack-item{  background-size: cover;  background-position: center center;  width: 100%;  aspect-ratio: .812;  margin: 10px;  margin-top: 0;  display:flex;  justify-content: center;}	.copy-pack-copy{	display: flex;	flex-direction: column;	align-items: center;  text-shadow: 1px 2px 3px rgba(0,0,0,.5);    flex-wrap: wrap;    justify-content: space-between;    margin:0 12px;	}  .copy-pack-title-1{    line-height: 1;    font-size: 24px;  }  .copy-pack-title-2{    line-height: 1;    font-size: 35px;  }.subcopy-ofs {    font-family: "open sans";    text-align: center;    font-size: 14px;    line-height: 1.1;    margin-top: 8px;    display: block;    font-weight: 500;    text-transform: none;}	.pack-price-attributes{	font-size: 64px;    margin-top: 10px;    margin-bottom:-20px;    	display: flex;    flex-direction:row;	}	.pack-leading-text-attr{    font-size: .19em;    line-height: 1;    font-family: "Open Sans";    font-weight: 700;    display: flex;    align-items: center;	}	.pack-attr-container{	display: flex;	align-items: center;	}	.pack-copy-cta{     clear: both;  border-radius: 0;  font-size: 170%;  font-family: "tempo", sans-serif;  border: none;  display: flex;    align-content: flex-end;    flex-wrap: wrap;    align-items: flex-end;  padding: 16px 32px;  line-height: 1;  text-transform: uppercase;  cursor: pointer;  color: #FFF!important;  background: #DC1125;  border-radius: 4px;  text-shadow: none;   margin-bottom:36px;}	.title-top{  margin-top: 16px;}.title-bottom{  justify-content: flex-end;  margin-bottom:16px;}.title-middle{ justify-content: center; }@media (max-width: 1240px) {  .responsive-grid-title {  	font-size: 29px!important;  }}@media (max-width: 1070px) {  .responsive-grid-title {  	font-size: 25px!important;  }}@media (max-width: 880px) { .guide-pack-container{ overflow-x: scroll;max-width: 1400px; /* overflow-x: auto;*/  scroll-behavior: smooth;  position:relative;} .copy-pack-copy{    width:310px;  } .pack-copy-cta{  font-size: 16px!important;  padding: 12px 16px!important;   margin-bottom:56px;}   .pack-price-attributes{	font-size: 60px!important;	}.tm,.pack-asterisk,.pack-dollar-sign{  vertical-align: super!important;}  .guide-pack>.fees-disclaimer{   font-size: 16px;    margin-top:-5px;}  .guide-pack-title{  font-size: 32px;    line-height:1;  }}';
document.getElementsByTagName('head')[0].appendChild(widget._styleTag);
        var utils = optimizely.get('utils');
var $ = window.jQuery;

//ADD HTML//

utils.waitForElement(extension.appendTo)
  .then(function() {
    // append the extension html to the body
   $(extension.appendTo).append(extension.$html);
   });

//END ADD HTML//
utils.waitForElement(('.pack-'+ extension.pNum+''))
  .then(function() { 
  if ($(window).width() < 960) {
     ($('.pack-'+ extension.pNum+'')).css('height',extension.mblheight);
      ($('.pcopy-'+ extension.pNum+'')).css('height',extension.mblheight);
    }
    else {
     ($('.pack-'+ extension.pNum +'')).css('height',extension.dskheight);
       ($('.pcopy-'+ extension.pNum +'')).css('height',extension.dskheight);
    }
});
if (extension.showprice === "false"){
utils.waitForElement('.packCta-'+extension.pNum).then(function() {

($('.p1>div>div>.packCta-'+extension.pNum+'')).attr('aria-label', extension.p1aria);  
($('.p2>div>div>.packCta-'+extension.pNum+'')).attr('aria-label', extension.p2aria);  
($('.p3>div>.packCta-'+extension.pNum+'')).attr('aria-label', extension.p3aria);  
($('.p4>div>.packCta-'+extension.pNum+'')).attr('aria-label', extension.p4aria);    
($('.p5>div>.packCta-'+extension.pNum+'')).attr('aria-label', extension.p5aria);  
  });
}

if (extension.showprice === "true"){
// Main entry point
$(document).ready(function() {
    // Start the process
    initialize();
});
 utils.waitForElement(extension.appendTo)
  .then(function() { 
$('<p class="fees-disclaimer">*All taxes and fees are included.</p>').insertAfter(('.pack-'+ extension.pNum+''));
   $('.pack-price-attributes').attr('style','margin-top:-5px!important');
  });
  
        }


function initialize() {
    var vifp = window.pastGuestNum;
   if (vifp) {
     utils.waitForElement('.pack-price-attributes')
  .then(function() {fetchTargetedOffers(vifp);
$('.pack-price-attributes').css('margin-top','-10px!important');
});
    } else {
       utils.waitForElement('.pack-price-attributes')
  .then(function() {var decoded="";
 $('.pack-price-attributes').css('margin-top','-10px!important');
         search_p1(decoded);
         search_p2(decoded);
if(extension.TilesCheck === '3-tiles'){
         search_p3(decoded);
}
if(extension.TilesCheck === '4-tiles'){
         search_p3(decoded);
         search_p4(decoded); 
}
if(extension.TilesCheck === '5-tiles'){
         search_p3(decoded);
         search_p4(decoded); 
         search_p5(decoded); 
}   
                    });
    }
}
// Function to fetch targeted offers
function fetchTargetedOffers(vifp) {
 $.ajax({
        type: "GET",
        cache: true,
        url: "https://www.carnival.com/cruisesearch/api/TargetedOffers/GetTargetedOffers?pastGuestNumber="+vifp,
        error: function(error) {
            console.log('Param error', error);
        },
        success: function(response) {
            var offers = encodeURIComponent(response.tgos);
            var tier = encodeURIComponent(response.tierCode);
            var decoded= '&tgo='+offers+'&tierCode='+tier+'&vifp='+vifp;
          search_p1(decoded);
          search_p2(decoded);
if(extension.TilesCheck === '3-tiles'){
         search_p3(decoded);
}
if(extension.TilesCheck === '4-tiles'){
         search_p3(decoded);
         search_p4(decoded); 
}
if(extension.TilesCheck === '5-tiles'){
         search_p3(decoded);
         search_p4(decoded); 
         search_p5(decoded); 
}
        }
    });
   
}

// Function to search for cruises
function search_p1(decoded,callback) {
    $.ajax({
        type: "GET",
        cache: true,
        url: "/cruisesearch/api/search?"+extension.p1price+"&pageNumber=1&pageSize=8&showBest=true&sort=fromprice&useSuggestions=true"+decoded,
        error: function(error) {
            console.log('Param error', error);
        },
      success: function(response2) {
           var pricep1 = response2.results.itineraries[0].leadSailing.fromPrice;
      if (pricep1 > 0) {
        var pricePoint_p1 = pricep1.toString();
        if (pricePoint_p1.length > 3) {
          pricePoint_p1 = pricePoint_p1.slice(0, -3) + ',' + pricePoint_p1.slice(-3);}
  ($('.p1-price'+extension.pNum+'')).append('<span class="pack-leading-text-attr" style="text-align: right;margin-right: 5px;" aria-hidden="true">STARTING<br>FROM</span><span class="pack-sale-price-attr" aria-hidden="true"><sup class="pack-dollar-sign">$</sup>'+pricePoint_p1+'<sup class="pack-asterisk">*</sup></span><span class="pack-leading-text-attr" style="text-align: left; margin-left: 8px;" aria-hidden="true">PER<br>PERSON</span>');
      ($('.p1>div>.packCta-'+extension.pNum+'')).attr('aria-label', extension.cta+", "+extension.p1aria+' from $' + pricePoint_p1 + ' per person'); 
  var vifp = window.pastGuestNum;
   if (vifp) {
       } else {
      vifp=""}
        var tempLink =   ($('.pack-'+ extension.pNum +'>.p1')).attr('onclick');
      tempLink = tempLink.substring(0, tempLink.length- 1) + '&vifp='+vifp+'\'';
      ($('.pack-'+ extension.pNum +'>.p1')).attr('onclick', tempLink);
         var tempLink2 =  ($('.p1>div>.packCta-'+extension.pNum+'')).attr('href');
    tempLink2 = tempLink2.substring(0, tempLink2.length) + '&vifp='+vifp;
      ($('.p1>div>.packCta-'+extension.pNum+'')).attr('href', tempLink2);
        }}
    });
}

function search_p2(decoded,callback) {
    $.ajax({
        type: "GET",
        cache: true,
        url: "/cruisesearch/api/search?"+extension.p2price+"&pageNumber=1&pageSize=8&showBest=true&sort=fromprice&useSuggestions=true"+decoded,
        error: function(error) {
            console.log('Param error', error);
        },
      success: function(response2) {
           var pricep2 = response2.results.itineraries[0].leadSailing.fromPrice;
      if (pricep2 > 0) {
        var pricePoint_p2 = pricep2.toString();
        if (pricePoint_p2.length > 3) {
          pricePoint_p2 = pricePoint_p2.slice(0, -3) + ',' + pricePoint_p2.slice(-3);}
  ($('.p2-price'+extension.pNum+'')).append('<span class="pack-leading-text-attr" style="text-align: right;margin-right: 5px;" aria-hidden="true">STARTING<br>FROM</span><span class="pack-sale-price-attr" aria-hidden="true"><sup class="pack-dollar-sign">$</sup>'+pricePoint_p2+'<sup class="pack-asterisk">*</sup></span><span class="pack-leading-text-attr" style="text-align: left; margin-left: 8px;" aria-hidden="true">PER<br>PERSON</span>');
        if( extension.showprice=== true){
      ($('.p2>div>.packCta-'+extension.pNum+'')).attr('aria-label', extension.cta+", "+extension.p2aria+' from $' + pricePoint_p2 + ' per person'); }
                if( extension.showprice=== false){
      ($('.p2>div>.packCta-'+extension.pNum+'')).attr('aria-label', extension.cta+", "+extension.p2aria); }
        
  var vifp = window.pastGuestNum;
   if (vifp) {
       } else {
      vifp=""}
        var tempLink =   ($('.pack-'+ extension.pNum +'>.p2')).attr('onclick');
      tempLink = tempLink.substring(0, tempLink.length- 1) + '&vifp='+vifp+'\'';
      ($('.pack-'+ extension.pNum +'>.p2')).attr('onclick', tempLink);
         var tempLink2 =  ($('.p2>div>.packCta-'+extension.pNum+'')).attr('href');
     tempLink2 = tempLink2.substring(0, tempLink2.length) + '&vifp='+vifp;
      ($('.p2>div>.packCta-'+extension.pNum+'')).attr('href', tempLink2);
        }}
    });
}    
    
function search_p3(decoded,callback) {
    $.ajax({
        type: "GET",
        cache: true,
        url: "/cruisesearch/api/search?"+extension.p3price+"&pageNumber=1&pageSize=8&showBest=true&sort=fromprice&useSuggestions=true"+decoded,
        error: function(error) {
            console.log('Param error', error);
        },
      success: function(response2) {
           var pricep3 = response2.results.itineraries[0].leadSailing.fromPrice;
      if (pricep3 > 0) {
        var pricePoint_p3 = pricep3.toString();
        if (pricePoint_p3.length > 3) {
          pricePoint_p3 = pricePoint_p3.slice(0, -3) + ',' + pricePoint_p3.slice(-3);}
  ($('.p3-price'+extension.pNum+'')).append('<span class="pack-leading-text-attr" style="text-align: right;margin-right: 5px;" aria-hidden="true">STARTING<br>FROM</span><span class="pack-sale-price-attr" aria-hidden="true"><sup class="pack-dollar-sign">$</sup>'+pricePoint_p3+'<sup class="pack-asterisk">*</sup></span><span class="pack-leading-text-attr" style="text-align: left; margin-left: 8px;" aria-hidden="true">PER<br>PERSON</span>');
      ($('.p3>div>.packCta-'+extension.pNum+'')).attr('aria-label', extension.cta+", "+extension.p3aria+' from $' + pricePoint_p3 + ' per person'); 
  var vifp = window.pastGuestNum;
   if (vifp) {
       } else {
      vifp=""}
        var tempLink =   ($('.pack-'+ extension.pNum +'>.p3')).attr('onclick');
      tempLink = tempLink.substring(0, tempLink.length- 1) + '&vifp='+vifp+'\'';
      ($('.pack-'+ extension.pNum +'>.p3')).attr('onclick', tempLink);
         var tempLink2 =  ($('.p3>div>.packCta-'+extension.pNum+'')).attr('href');
      tempLink2 = tempLink2.substring(0, tempLink2.length) + '&vifp='+vifp;
      ($('.p3>div>.packCta-'+extension.pNum+'')).attr('href', tempLink2);
        }}
    });
}  

function search_p4(decoded,callback) {
    $.ajax({
        type: "GET",
        cache: true,
        url: "/cruisesearch/api/search?"+extension.p4price+"&pageNumber=1&pageSize=8&showBest=true&sort=fromprice&useSuggestions=true"+decoded,
        error: function(error) {
            console.log('Param error', error);
        },
      success: function(response2) {
           var pricep4 = response2.results.itineraries[0].leadSailing.fromPrice;
      if (pricep4 > 0) {
        var pricePoint_p4 = pricep4.toString();
        if (pricePoint_p4.length > 3) {
          pricePoint_p4 = pricePoint_p4.slice(0, -3) + ',' + pricePoint_p4.slice(-3);}
  ($('.p4-price'+extension.pNum+'')).append('<span class="pack-leading-text-attr" style="text-align: right;margin-right: 5px;" aria-hidden="true">STARTING<br>FROM</span><span class="pack-sale-price-attr" aria-hidden="true"><sup class="pack-dollar-sign">$</sup>'+pricePoint_p4+'<sup class="pack-asterisk">*</sup></span><span class="pack-leading-text-attr" style="text-align: left; margin-left: 8px;" aria-hidden="true">PER<br>PERSON</span>');
      ($('.p4>div>.packCta-'+extension.pNum+'')).attr('aria-label', extension.cta+", "+extension.p4aria+' from $' + pricePoint_p4 + ' per person'); 
  var vifp = window.pastGuestNum;
   if (vifp) {
       } else {
      vifp=""}
        var tempLink =   ($('.pack-'+ extension.pNum +'>.p4')).attr('onclick');
      tempLink = tempLink.substring(0, tempLink.length- 1) + '&vifp='+vifp+'\'';
      ($('.pack-'+ extension.pNum +'>.p4')).attr('onclick', tempLink);
         var tempLink2 =  ($('.p4>div>.packCta-'+extension.pNum+'')).attr('href');
      tempLink2 = tempLink2.substring(0, tempLink2.length) + '&vifp='+vifp;
      ($('.p4>div>.packCta-'+extension.pNum+'')).attr('href', tempLink2);
        }}
    });
}  

function search_p5(decoded,callback) {
    $.ajax({
        type: "GET",
        cache: true,
        url: "/cruisesearch/api/search?"+extension.p5price+"&pageNumber=1&pageSize=8&showBest=true&sort=fromprice&useSuggestions=true"+decoded,
        error: function(error) {
            console.log('Param error', error);
        },
      success: function(response2) {
           var pricep5 = response2.results.itineraries[0].leadSailing.fromPrice;
      if (pricep5 > 0) {
        var pricePoint_p5 = pricep5.toString();
        if (pricePoint_p5.length > 3) {
          pricePoint_p5 = pricePoint_p5.slice(0, -3) + ',' + pricePoint_p5.slice(-3);}
  ($('.p5-price'+extension.pNum+'')).append('<span class="pack-leading-text-attr" style="text-align: right;margin-right: 5px;" aria-hidden="true">STARTING<br>FROM</span><span class="pack-sale-price-attr" aria-hidden="true"><sup class="pack-dollar-sign">$</sup>'+pricePoint_p5+'<sup class="pack-asterisk">*</sup></span><span class="pack-leading-text-attr" style="text-align: left; margin-left: 8px;" aria-hidden="true">PER<br>PERSON</span>');
      ($('.p5>div>.packCta-'+extension.pNum+'')).attr('aria-label', extension.cta+", "+extension.p5aria+' from $' + pricePoint_p5 + ' per person'); 
  var vifp = window.pastGuestNum;
   if (vifp) {
       } else {
      vifp=""}
        var tempLink =   ($('.pack-'+ extension.pNum +'>.p5')).attr('onclick');
      tempLink = tempLink.substring(0, tempLink.length- 1) + '&vifp='+vifp+'\'';
      ($('.pack-'+ extension.pNum +'>.p5')).attr('onclick', tempLink);
         var tempLink2 =  ($('.p5>div>.packCta-'+extension.pNum+'')).attr('href');
    tempLink2 = tempLink2.substring(0, tempLink2.length) + '&vifp='+vifp;
      ($('.p5>div>.packCta-'+extension.pNum+'')).attr('href', tempLink2);
        }}
    });
}  


      },
      hideFn: function(event) {
        var $ = window.optimizely.get('jquery');
        var widget = event.data.config;
        widget.$id = "30451680475";
        widget.$instance = event.data.id;
        widget.$fieldDefaults = [{"name":"pNum","default_value":"1"},{"name":"TilesCheck","default_value":"4-tiles"},{"name":"backgroundColor","default_value":"background-color: #c3d4e6;\n    padding-left: 5px;\n    padding-right: 5px;"},{"name":"appendTo","default_value":".bucket-4"},{"name":"title","default_value":"<span style=\"width: 100%;display: block;margin: 0 25px 0 0;flex: 1;height: 2.5px;background-color: #10559a !important;position: relative;bottom: 16px;\"></span>  <img src=\"/~/media/Images/hp-merch/2024/extras/graphics/ofs.png\" alt=\"new sailings unlocked\" style=\"max-width: 500px;padding-top: 37px;\"> <span style=\"width: 100%;display: block;margin: 0 0 0 25px;flex: 1;height: 2.9px;background-color: #10559a !important;position: relative;bottom: 16px;\"></span>"},{"name":"titleCSS","default_value":"  color: #10559a; \n  display: flex;\n  align-items: center;\n  justify-content: center;\n  white-space: nowrap;"},{"name":"tile1Image","default_value":"/~/media/Images/hp-merch/2023/Desktop/tiles/caribbean-tile.jpg"},{"name":"tile2Image","default_value":"/~/media/Images/hp-merch/2023/Desktop/tiles/bahamas-tile.jpg"},{"name":"tile3Image","default_value":"/~/media/Images/hp-merch/2023/Desktop/tiles/mexico-tile.jpg"},{"name":"tile4Image","default_value":"/~/media/Images/hp-merch/2023/Desktop/tiles/journeys-tile.jpg"},{"name":"tile5Image","default_value":"/~/media/Images/hp-merch/2023/Desktop/tiles/journeys-tile.jpg"},{"name":"color","default_value":"hp-text-white"},{"name":"packtitle","default_value":"title-top"},{"name":"dskheight","default_value":"440px"},{"name":"mblheight","default_value":"400px"},{"name":"tile1","default_value":"<span class=\"copy-pack-title-1\"></span>\n  <span class=\"copy-pack-title-2\" aria-hidden=\"true\">NORFOLK SAILINGS</span>\n<span class=\"subcopy-ofs\">Cruise to the Caribbean and The Bahamas from Norfolk on Carnival Sunshine<sup class=\"tm\"></sup></span>"},{"name":"tile2","default_value":"<span class=\"copy-pack-title-1\"></span>\n  <span class=\"copy-pack-title-2\" aria-hidden=\"true\">CARNIVAL HORIZON<br>SAILINGS</span>\n<span class=\"subcopy-ofs\">Explore vibrant destinations across the Caribbean with new Carnival Horizon<sup class=\"tm\"></sup>sailings through spring 2027</span>"},{"name":"tile3","default_value":"<span class=\"copy-pack-title-1\"></span>\n  <span class=\"copy-pack-title-2\" aria-hidden=\"true\">PORT CANAVERAL<br>SAILINGS</span>\n<span class=\"subcopy-ofs\">Carnival Vista<sup class=\"tm\"></sup> will be sailing from Port Canaveral including 6 and 8-day voyages to the Eastern and Southern Caribbean</span>"},{"name":"tile4","default_value":"<span class=\"copy-pack-title-1\"></span>\n  <span class=\"copy-pack-title-2\" aria-hidden=\"true\">CARNIVAL LUMINOSA<br>SAILINGS</span>\n<span class=\"subcopy-ofs\">Carnival Luminosa<sup class=\"tm\"></sup> will sail from San Fransisco starting in April cruising to Alaska, Baja Mexico and Ensenda</span>"},{"name":"tile5","default_value":"<span class=\"copy-pack-title-1\"></span>\n  <span class=\"copy-pack-title-2\" aria-hidden=\"true\">CARNIVAL LUMINOSA<br>SAILINGS</span>\n<span class=\"subcopy-ofs\">Carnival Luminosa<sup class=\"tm\"></sup> will sail from San Fransisco starting in April cruising to Alaska, Baja Mexico and Ensenda</span>"},{"name":"cta","default_value":"SEARCH CRUISES"},{"name":"tile1Url","default_value":"/cruise-search?icid=crm_ccl_ships_091224_resp_pack_p1_nonbooked_3&ship=cb"},{"name":"tile2Url","default_value":"/cruise-search?icid=crm_ccl_ships_091224_resp_pack_p2_nonbooked_3&ship=cb"},{"name":"tile3Url","default_value":"/cruise-search?icid=crm_ccl_ships_091224_resp_pack_p3_nonbooked_3&ship=cb"},{"name":"tile4Url","default_value":"/cruise-search?icid=crm_ccl_ships_091224_resp_pack_p4_nonbooked_3&ship=cb"},{"name":"tile5Url","default_value":"/cruise-search?icid=crm_ccl_ships_091224_resp_pack_p5_nonbooked_3&ship=cb"},{"name":"p1aria","default_value":"Carnival celebration"},{"name":"p2aria","default_value":"mardi gras"},{"name":"p3aria","default_value":"carnival celebration"},{"name":"p4aria","default_value":""},{"name":"p5aria","default_value":""},{"name":"showprice","default_value":"false"},{"name":"p1price","default_value":"numadults=2"},{"name":"p2price","default_value":"numadults=2"},{"name":"p3price","default_value":"numadults=2"},{"name":"p4price","default_value":"numadults=2"},{"name":"p5price","default_value":"numadults=2"}];
        (function(widg) {
  var i = 0;
  var field;
  for (; i < widg.$fieldDefaults.length; ++i) {
    field = widg.$fieldDefaults[i];
    if (!widg.hasOwnProperty(field.name)) {
      widg[field.name] = field.default_value;
    }
  }
  })(widget);
        var extension = widget;
        widget._styleTag = document.getElementById('widget-css-30451680475');
if (widget._styleTag) widget._styleTag.parentNode.removeChild(widget._styleTag);
        var extensionElement = document.getElementById('optimizely-extension-' + extension.$instance);
if (extensionElement) {
  extensionElement.parentElement.removeChild(extensionElement);
}

      },
    });

PluginManager.registerWidget({
      widgetId: '30453410332',
      showFn: function(event) {
        var $ = window.optimizely.get('jquery');
        var widget = event.data.config;
        var _template = new Hogan(function(c,p,i) {var t=this;t.b(i=i||"");t.b("<div id=\"optimizely-extension-");t.b(t.v(t.d("extension.$instance",c,p,0)));t.b("\" style=\"");t.b(t.v(t.d("extension.backgroundColor",c,p,0)));t.b("\" class=\"guide-pack\">");t.b("\n" + i);t.b("  <span class=\"guide-pack-title\" style=\"");t.b(t.v(t.d("extension.titleCSS",c,p,0)));t.b("\">");t.b(t.t(t.d("extension.title",c,p,0)));t.b("</span>");t.b("\n" + i);t.b("  <div class=\"guide-pack-container pack-");t.b(t.v(t.d("extension.pNum",c,p,0)));t.b("\" >");t.b("\n" + i);t.b("    <div class=\"pack-item p1\" alt style=\"background-image:url(");t.b(t.v(t.d("extension.tile1Image",c,p,0)));t.b(")\" onclick=\"window.location.href='");t.b(t.v(t.d("extension.tile1Url",c,p,0)));t.b("'\" >");t.b("\n" + i);t.b("      <div class=\"pack-copy pcopy-");t.b(t.v(t.d("extension.pNum",c,p,0)));t.b(" ");t.b(t.v(t.d("extension.packtitle",c,p,0)));t.b(" ");t.b(t.v(t.d("extension.color",c,p,0)));t.b(" hp-font-tempo\">");t.b("\n" + i);t.b("     <span class=\"pack-title ptitle-");t.b(t.v(t.d("extension.pNum",c,p,0)));t.b("\">");t.b(t.t(t.d("extension.tile1",c,p,0)));t.b("</span>");t.b("\n" + i);t.b("    <div class=\"pack-price-attributes p1-price");t.b(t.v(t.d("extension.pNum",c,p,0)));t.b("\" aria-hidden=\"true\"></div>");t.b("\n" + i);t.b("   <a  tabindex=\"0\" class=\"pack-cta packCta-");t.b(t.v(t.d("extension.pNum",c,p,0)));t.b(" ctaHover\" href=\"");t.b(t.v(t.d("extension.tile1Url",c,p,0)));t.b("\">");t.b(t.v(t.d("extension.cta",c,p,0)));t.b("</a>");t.b("\n" + i);t.b("</div>");t.b("\n" + i);t.b("    </div>");t.b("\n" + i);t.b("        <div class=\"pack-item p2\" alt style=\"background-image:url(");t.b(t.v(t.d("extension.tile2Image",c,p,0)));t.b(")\" onclick=\"window.location.href='");t.b(t.v(t.d("extension.tile2Url",c,p,0)));t.b("'\">");t.b("\n" + i);t.b("      <div class=\"pack-copy pcopy-");t.b(t.v(t.d("extension.pNum",c,p,0)));t.b(" ");t.b(t.v(t.d("extension.packtitle",c,p,0)));t.b(" ");t.b(t.v(t.d("extension.color",c,p,0)));t.b(" hp-font-tempo\">");t.b("\n" + i);t.b("     <span class=\"pack-title ptitle-");t.b(t.v(t.d("extension.pNum",c,p,0)));t.b("\">");t.b(t.t(t.d("extension.tile2",c,p,0)));t.b("</span>");t.b("\n" + i);t.b("    <div class=\"pack-price-attributes p2-price");t.b(t.v(t.d("extension.pNum",c,p,0)));t.b("\" aria-hidden=\"true\"></div>");t.b("\n" + i);t.b("   <a  tabindex=\"0\" class=\"pack-cta packCta-");t.b(t.v(t.d("extension.pNum",c,p,0)));t.b(" ctaHover\" href=\"");t.b(t.v(t.d("extension.tile2Url",c,p,0)));t.b("\">");t.b(t.v(t.d("extension.cta",c,p,0)));t.b("</a>");t.b("\n" + i);t.b("</div>");t.b("\n" + i);t.b("    </div>");t.b("\n" + i);t.b("      <div class=\"pack-item p3 show-");t.b(t.v(t.d("extension.TilesCheck",c,p,0)));t.b("\" alt style=\"background-image:url(");t.b(t.v(t.d("extension.tile3Image",c,p,0)));t.b(")\" onclick=\"window.location.href='");t.b(t.v(t.d("extension.tile3Url",c,p,0)));t.b("'\">");t.b("\n" + i);t.b("      <div class=\"pack-copy pcopy-");t.b(t.v(t.d("extension.pNum",c,p,0)));t.b(" ");t.b(t.v(t.d("extension.packtitle",c,p,0)));t.b(" ");t.b(t.v(t.d("extension.color",c,p,0)));t.b(" hp-font-tempo\">");t.b("\n" + i);t.b("     <span class=\"pack-title ptitle-");t.b(t.v(t.d("extension.pNum",c,p,0)));t.b("\">");t.b(t.t(t.d("extension.tile3",c,p,0)));t.b("</span>");t.b("\n" + i);t.b("   <div class=\"pack-price-attributes p3-price");t.b(t.v(t.d("extension.pNum",c,p,0)));t.b("\" aria-hidden=\"true\"></div>");t.b("\n" + i);t.b("   <a tabindex=\"0\" class=\"pack-cta packCta-");t.b(t.v(t.d("extension.pNum",c,p,0)));t.b(" ctaHover\" href=\"");t.b(t.v(t.d("extension.tile3Url",c,p,0)));t.b("\">");t.b(t.v(t.d("extension.cta",c,p,0)));t.b("</a>");t.b("\n" + i);t.b("</div>        ");t.b("\n" + i);t.b("    </div>");t.b("\n" + i);t.b("       <div class=\"pack-item p4 show-");t.b(t.v(t.d("extension.TilesCheck",c,p,0)));t.b("\" alt style=\"background-image:url(");t.b(t.v(t.d("extension.tile4Image",c,p,0)));t.b(")\" onclick=\"window.location.href='");t.b(t.v(t.d("extension.tile4Url",c,p,0)));t.b("'\">");t.b("\n" + i);t.b("     <div class=\"pack-copy pcopy-");t.b(t.v(t.d("extension.pNum",c,p,0)));t.b(" ");t.b(t.v(t.d("extension.packtitle",c,p,0)));t.b(" ");t.b(t.v(t.d("extension.color",c,p,0)));t.b(" hp-font-tempo\">");t.b("\n" + i);t.b("     <span class=\"pack-title ptitle-");t.b(t.v(t.d("extension.pNum",c,p,0)));t.b("\">");t.b(t.t(t.d("extension.tile4",c,p,0)));t.b("</span>");t.b("\n" + i);t.b("   <div class=\"pack-price-attributes p4-price");t.b(t.v(t.d("extension.pNum",c,p,0)));t.b("\" aria-hidden=\"true\"></div>");t.b("\n" + i);t.b("   <a tabindex=\"0\" class=\"pack-cta packCta-");t.b(t.v(t.d("extension.pNum",c,p,0)));t.b(" ctaHover\" href=\"");t.b(t.v(t.d("extension.tile4Url",c,p,0)));t.b("\">");t.b(t.v(t.d("extension.cta",c,p,0)));t.b("</a>");t.b("\n" + i);t.b("</div>        ");t.b("\n" + i);t.b("    </div>");t.b("\n" + i);t.b("          <div class=\"pack-item p5 show-");t.b(t.v(t.d("extension.TilesCheck",c,p,0)));t.b("\" alt style=\"background-image:url(");t.b(t.v(t.d("extension.tile5Image",c,p,0)));t.b(")\" onclick=\"window.location.href='");t.b(t.v(t.d("extension.tile5Url",c,p,0)));t.b("'\">");t.b("\n" + i);t.b("       <div class=\"pack-copy pcopy-");t.b(t.v(t.d("extension.pNum",c,p,0)));t.b(" ");t.b(t.v(t.d("extension.packtitle",c,p,0)));t.b(" ");t.b(t.v(t.d("extension.color",c,p,0)));t.b(" hp-font-tempo\">");t.b("\n" + i);t.b("     <span class=\"pack-title ptitle-");t.b(t.v(t.d("extension.pNum",c,p,0)));t.b("\">");t.b(t.t(t.d("extension.tile5",c,p,0)));t.b("</span>");t.b("\n" + i);t.b("   <div class=\"pack-price-attributes p5-price");t.b(t.v(t.d("extension.pNum",c,p,0)));t.b("\" aria-hidden=\"true\"></div>");t.b("\n" + i);t.b("   <a tabindex=\"0\" class=\"pack-cta packCta-");t.b(t.v(t.d("extension.pNum",c,p,0)));t.b(" ctaHover\" href=\"");t.b(t.v(t.d("extension.tile5Url",c,p,0)));t.b("\">");t.b(t.v(t.d("extension.cta",c,p,0)));t.b("</a>");t.b("\n" + i);t.b("</div>        ");t.b("\n" + i);t.b("    </div>");t.b("\n" + i);t.b("      </div>");t.b("\n" + i);t.b(" </div>");t.b("\n" + i);t.b(" ");return t.fl(); })
        widget.$id = "30453410332";
        widget.$instance = event.data.id;
        widget.$render = _template.render.bind(_template)
        widget.$fieldDefaults = [{"name":"pNum","default_value":"1"},{"name":"TilesCheck","default_value":"4-tiles"},{"name":"backgroundColor","default_value":"background-color: white;"},{"name":"appendTo","default_value":".bucket-3"},{"name":"title","default_value":"<span style=\"width: 100%;display: block;margin: 0 25px 0 0;flex: 1;height: 2.5px; background-color: #10559a !important;\" aria-hidden=\"true\"></span> CHECK OUT OUR NEWEST SHIPS <span style=\" width: 100%;   display: block; margin: 0 0 0 25px; flex: 1; height: 2.5px; background-color: #10559a !important;\" aria-hidden=\"true\"></span>"},{"name":"titleCSS","default_value":"  color: #10559a; \n  display: flex;\n  align-items: center;\n  justify-content: center;\n  white-space: nowrap;"},{"name":"tile1Image","default_value":"/~/media/Images/hp-merch/2023/Desktop/tiles/caribbean-tile.jpg"},{"name":"tile2Image","default_value":"/~/media/Images/hp-merch/2023/Desktop/tiles/bahamas-tile.jpg"},{"name":"tile3Image","default_value":"/~/media/Images/hp-merch/2023/Desktop/tiles/mexico-tile.jpg"},{"name":"tile4Image","default_value":"/~/media/Images/hp-merch/2023/Desktop/tiles/journeys-tile.jpg"},{"name":"tile5Image","default_value":"/~/media/Images/hp-merch/2023/Desktop/tiles/journeys-tile.jpg"},{"name":"color","default_value":"hp-text-white"},{"name":"packtitle","default_value":"title-top"},{"name":"dskheight","default_value":"450px"},{"name":"mblheight","default_value":"400px"},{"name":"tile1","default_value":"<span class=\"responsive-pack-title-1\" aria-hidden=\"true\">CARNIVAL</span>\n  <span class=\"responsive-pack-title-2\" aria-hidden=\"true\">CELEBRATION<sup class=\"tm\"></sup></span>"},{"name":"tile2","default_value":"<span class=\"responsive-pack-title-1\" aria-hidden=\"true\">CARNIVAL</span>\n  <span class=\"responsive-pack-title-2\" aria-hidden=\"true\">CELEBRATION<sup class=\"tm\"></sup></span>"},{"name":"tile3","default_value":"<span class=\"responsive-pack-title-1\" aria-hidden=\"true\">CARNIVAL</span>\n  <span class=\"responsive-pack-title-2\" aria-hidden=\"true\">CELEBRATION<sup class=\"tm\"></sup></span>"},{"name":"tile4","default_value":"<span class=\"responsive-pack-title-1\" aria-hidden=\"true\">CARNIVAL</span>\n  <span class=\"responsive-pack-title-2\" aria-hidden=\"true\">CELEBRATION<sup class=\"tm\"></sup></span>"},{"name":"tile5","default_value":"<span class=\"responsive-pack-title-1\" aria-hidden=\"true\">CARNIVAL</span>\n  <span class=\"responsive-pack-title-2\" aria-hidden=\"true\">CELEBRATION<sup class=\"tm\"></sup></span>"},{"name":"cta","default_value":"SEARCH CRUISES"},{"name":"tile1Url","default_value":"/cruise-search?icid=crm_ccl_ships_091224_resp_pack_p1_nonbooked_3&ship=cb"},{"name":"tile2Url","default_value":"/cruise-search?icid=crm_ccl_ships_091224_resp_pack_p2_nonbooked_3&ship=cb"},{"name":"tile3Url","default_value":"/cruise-search?icid=crm_ccl_ships_091224_resp_pack_p3_nonbooked_3&ship=cb"},{"name":"tile4Url","default_value":"/cruise-search?icid=crm_ccl_ships_091224_resp_pack_p4_nonbooked_3&ship=cb"},{"name":"tile5Url","default_value":"/cruise-search?icid=crm_ccl_ships_091224_resp_pack_p5_nonbooked_3&ship=cb"},{"name":"p1aria","default_value":"Carnival celebration"},{"name":"p2aria","default_value":"mardi gras"},{"name":"p3aria","default_value":"carnival celebration"},{"name":"p4aria","default_value":""},{"name":"p5aria","default_value":""},{"name":"showprice","default_value":"true"},{"name":"p1price","default_value":"numadults=2"},{"name":"p2price","default_value":"numadults=2"},{"name":"p3price","default_value":"numadults=2"},{"name":"p4price","default_value":"numadults=2"},{"name":"p5price","default_value":"numadults=2"}];
        (function(widg) {
  var i = 0;
  var field;
  for (; i < widg.$fieldDefaults.length; ++i) {
    field = widg.$fieldDefaults[i];
    if (!widg.hasOwnProperty(field.name)) {
      widg[field.name] = field.default_value;
    }
  }
  })(widget);
        widget.$html = _template.render({ widget: widget, extension: widget })
        var extension = widget;
        widget._styleTag = document.createElement('style');
widget._styleTag.id = 'widget-css-30453410332';
widget._styleTag.innerHTML = '.p5.show-4-tiles{  display:none;}.p4.show-3-tiles,.p5.show-3-tiles{  display:none;}.p3.show-2-tiles,.p4.show-2-tiles,.p5.show-2-tiles {  display:none;}.guide-pack{  display:flex;  flex-direction:column;  max-width:1400px;  margin:auto;  margin-top:25px;  padding-bottom: 25px;}.guide-pack>.fees-disclaimer{  font-family: "Open Sans";   font-size: 16px;   text-align: center;  margin-top:-8px;}.guide-pack-title{  font-family: tempo;  font-size: 46px;  text-align:center;  padding:8px;}.pack-title{  font-family: tempo;    text-align:center;  display: flex;  flex-direction:column;    justify-content: center;    align-items: center;  text-transform: uppercase;}.guide-pack-container{    display: flex;  	cursor: pointer;  }.pack-dollar-sign{ font-size: 0.4em;    top: -7%;    position: relative;}.pack-asterisk{ font-size: 0.3em;    top: -10%;    position: relative;}.tm{   font-size: .2em;    top: -12px;    position: relative;}.pack-item{  background-size: cover;  background-position: center center;  background-repeat: no-repeat;  width: 100%;  aspect-ratio: .812;  margin: 10px;  margin-top: 0;  display:flex;  justify-content: center;}	.pack-copy{	display: flex;	flex-direction: column;	align-items: center;	}  .responsive-pack-title-1{    line-height: 1;    font-size: 24px;  }  .responsive-pack-title-2{    line-height: 1;    font-size: 48px;  }	.pack-price-attributes{	font-size: 64px;    margin-top: 10px;    margin-bottom:-20px;    	display: flex;    flex-direction:row;	}	.pack-leading-text-attr{    font-size: .19em;    line-height: 1;    font-family: "Open Sans";    font-weight: 700;    display: flex;    align-items: center;	}	.pack-attr-container{	display: flex;	align-items: center;	}	.pack-cta{     clear: both;  border-radius: 0;  font-size: 170%;  font-family: "tempo", sans-serif;  border: none;  display: inline-block;  margin: 16px 0 0 0;  padding: 16px 32px;  line-height: 1;  text-transform: uppercase;  cursor: pointer;  color: #FFF!important;  background: #DC1125;  border-radius: 4px;  text-shadow: none;}	.title-top{  margin-top: 16px;}.title-bottom{  justify-content: flex-end;  margin-bottom:16px;}.title-middle{ justify-content: center; }@media (max-width: 1240px) {  .responsive-grid-title {  	font-size: 29px!important;  }}@media (max-width: 1070px) {  .responsive-grid-title {  	font-size: 25px!important;  }}@media (max-width: 880px) { .guide-pack-container{  -webkit-overflow-scrolling: touch;  overflow-x: auto;  scroll-behavior: smooth;  position:relative;} .pack-copy{    width:325px;  } .pack-cta{  font-size: 16px!important;  padding: 10px 16px!important;}   .pack-price-attributes{	font-size: 60px!important;	}.tm,.pack-asterisk,.pack-dollar-sign{  vertical-align: super!important;}  .guide-pack>.fees-disclaimer{   font-size: 16px;    margin-top:-5px;}  .guide-pack-title{  font-size: 32px;    line-height:1;  }}';
document.getElementsByTagName('head')[0].appendChild(widget._styleTag);
        var utils = optimizely.get('utils');
var $ = window.jQuery;

//ADD HTML//

utils.waitForElement(extension.appendTo)
  .then(function() {
    // append the extension html to the body
   $(extension.appendTo).append(extension.$html);
   });

//END ADD HTML//
// utils.waitForElement(('.pack-'+ extension.pNum+''))
 // .then(function() { 
  if ($(window).width() < 960) {
     ($('.pack-'+ extension.pNum+'')).css('height',extension.mblheight);
    }
    else {
     ($('.pack-'+ extension.pNum +'')).css('height',extension.dskheight);
    }
// });
if (extension.showprice === "true"){
// Main entry point
$(document).ready(function() {
    // Start the process
    initialize();
});
 utils.waitForElement(extension.appendTo)
  .then(function() { 
$('<p class="fees-disclaimer">*All taxes and fees are included.</p>').insertAfter(('.pack-'+ extension.pNum+''));
   $('.pack-price-attributes').attr('style','margin-top:-5px!important');
  });
  
        }

function initialize() {
    var vifp = window.pastGuestNum;
   if (vifp) {
     utils.waitForElement('.pack-price-attributes')
  .then(function() {fetchTargetedOffers(vifp);
$('.pack-price-attributes').css('margin-top','-10px!important')
});
    } else {
       utils.waitForElement('.pack-price-attributes')
  .then(function() {var decoded="";
 $('.pack-price-attributes').css('margin-top','-10px!important')
         search_p1(decoded);
         search_p2(decoded);
if(extension.TilesCheck === '3-tiles'){
         search_p3(decoded);
}
if(extension.TilesCheck === '4-tiles'){
         search_p3(decoded);
         search_p4(decoded); 
}
if(extension.TilesCheck === '5-tiles'){
         search_p3(decoded);
         search_p4(decoded); 
         search_p5(decoded); 
}   
                    });
    }
}
// Function to fetch targeted offers
function fetchTargetedOffers(vifp) {
 $.ajax({
        type: "GET",
        cache: true,
        url: "https://www.carnival.com/cruisesearch/api/TargetedOffers/GetTargetedOffers?pastGuestNumber="+vifp,
        error: function(error) {
            console.log('Param error', error);
        },
        success: function(response) {
            var offers = encodeURIComponent(response.tgos);
            var tier = encodeURIComponent(response.tierCode);
            var decoded= '&tgo='+offers+'&tierCode='+tier+'&vifp='+vifp;
          search_p1(decoded);
          search_p2(decoded);
if(extension.TilesCheck === '3-tiles'){
         search_p3(decoded);
}
if(extension.TilesCheck === '4-tiles'){
         search_p3(decoded);
         search_p4(decoded); 
}
if(extension.TilesCheck === '5-tiles'){
         search_p3(decoded);
         search_p4(decoded); 
         search_p5(decoded); 
}
        }
    });
   
}

// Function to search for cruises
function search_p1(decoded,callback) {
    $.ajax({
        type: "GET",
        cache: true,
        url: "/cruisesearch/api/search?"+extension.p1price+"&pageNumber=1&pageSize=8&showBest=true&sort=fromprice&useSuggestions=true"+decoded,
        error: function(error) {
            console.log('Param error', error);
        },
      success: function(response2) {
           var pricep1 = response2.results.itineraries[0].leadSailing.fromPrice;
      if (pricep1 > 0) {
        var pricePoint_p1 = pricep1.toString();
        if (pricePoint_p1.length > 3) {
          pricePoint_p1 = pricePoint_p1.slice(0, -3) + ',' + pricePoint_p1.slice(-3);}
  ($('.p1-price'+extension.pNum+'')).append('<span class="pack-leading-text-attr" style="text-align: right;margin-right: 5px;" aria-hidden="true">STARTING<br>FROM</span><span class="pack-sale-price-attr" aria-hidden="true"><sup class="pack-dollar-sign">$</sup>'+pricePoint_p1+'<sup class="pack-asterisk">*</sup></span><span class="pack-leading-text-attr" style="text-align: left; margin-left: 8px;" aria-hidden="true">PER<br>PERSON</span>');
      ($('.p1>div>.packCta-'+extension.pNum+'')).attr('aria-label', extension.cta+", "+extension.p1aria+' from $' + pricePoint_p1 + ' per person'); 
  var vifp = window.pastGuestNum;
   if (vifp) {
       } else {
      vifp=""}
        var tempLink =   ($('.pack-'+ extension.pNum +'>.p1')).attr('onclick');
      tempLink = tempLink.substring(0, tempLink.length- 1) + '&vifp='+vifp+'\'';
      ($('.pack-'+ extension.pNum +'>.p1')).attr('onclick', tempLink);
         var tempLink2 =  ($('.p1>div>.packCta-'+extension.pNum+'')).attr('href');
    tempLink2 = tempLink2.substring(0, tempLink2.length) + '&vifp='+vifp;
      ($('.p1>div>.packCta-'+extension.pNum+'')).attr('href', tempLink2);
        }}
    });
}

function search_p2(decoded,callback) {
    $.ajax({
        type: "GET",
        cache: true,
        url: "/cruisesearch/api/search?"+extension.p2price+"&pageNumber=1&pageSize=8&showBest=true&sort=fromprice&useSuggestions=true"+decoded,
        error: function(error) {
            console.log('Param error', error);
        },
      success: function(response2) {
           var pricep2 = response2.results.itineraries[0].leadSailing.fromPrice;
      if (pricep2 > 0) {
        var pricePoint_p2 = pricep2.toString();
        if (pricePoint_p2.length > 3) {
          pricePoint_p2 = pricePoint_p2.slice(0, -3) + ',' + pricePoint_p2.slice(-3);}
  ($('.p2-price'+extension.pNum+'')).append('<span class="pack-leading-text-attr" style="text-align: right;margin-right: 5px;" aria-hidden="true">STARTING<br>FROM</span><span class="pack-sale-price-attr" aria-hidden="true"><sup class="pack-dollar-sign">$</sup>'+pricePoint_p2+'<sup class="pack-asterisk">*</sup></span><span class="pack-leading-text-attr" style="text-align: left; margin-left: 8px;" aria-hidden="true">PER<br>PERSON</span>');
      ($('.p2>div>.packCta-'+extension.pNum+'')).attr('aria-label', extension.cta+", "+extension.p2aria+' from $' + pricePoint_p2 + ' per person'); 
  var vifp = window.pastGuestNum;
   if (vifp) {
       } else {
      vifp=""}
        var tempLink =   ($('.pack-'+ extension.pNum +'>.p2')).attr('onclick');
      tempLink = tempLink.substring(0, tempLink.length- 1) + '&vifp='+vifp+'\'';
      ($('.pack-'+ extension.pNum +'>.p2')).attr('onclick', tempLink);
         var tempLink2 =  ($('.p2>div>.packCta-'+extension.pNum+'')).attr('href');
     tempLink2 = tempLink2.substring(0, tempLink2.length) + '&vifp='+vifp;
      ($('.p2>div>.packCta-'+extension.pNum+'')).attr('href', tempLink2);
        }}
    });
}    
    
function search_p3(decoded,callback) {
    $.ajax({
        type: "GET",
        cache: true,
        url: "/cruisesearch/api/search?"+extension.p3price+"&pageNumber=1&pageSize=8&showBest=true&sort=fromprice&useSuggestions=true"+decoded,
        error: function(error) {
            console.log('Param error', error);
        },
      success: function(response2) {
           var pricep3 = response2.results.itineraries[0].leadSailing.fromPrice;
      if (pricep3 > 0) {
        var pricePoint_p3 = pricep3.toString();
        if (pricePoint_p3.length > 3) {
          pricePoint_p3 = pricePoint_p3.slice(0, -3) + ',' + pricePoint_p3.slice(-3);}
  ($('.p3-price'+extension.pNum+'')).append('<span class="pack-leading-text-attr" style="text-align: right;margin-right: 5px;" aria-hidden="true">STARTING<br>FROM</span><span class="pack-sale-price-attr" aria-hidden="true"><sup class="pack-dollar-sign">$</sup>'+pricePoint_p3+'<sup class="pack-asterisk">*</sup></span><span class="pack-leading-text-attr" style="text-align: left; margin-left: 8px;" aria-hidden="true">PER<br>PERSON</span>');
      ($('.p3>div>.packCta-'+extension.pNum+'')).attr('aria-label', extension.cta+", "+extension.p3aria+' from $' + pricePoint_p3 + ' per person'); 
  var vifp = window.pastGuestNum;
   if (vifp) {
       } else {
      vifp=""}
        var tempLink =   ($('.pack-'+ extension.pNum +'>.p3')).attr('onclick');
      tempLink = tempLink.substring(0, tempLink.length- 1) + '&vifp='+vifp+'\'';
      ($('.pack-'+ extension.pNum +'>.p3')).attr('onclick', tempLink);
         var tempLink2 =  ($('.p3>div>.packCta-'+extension.pNum+'')).attr('href');
      tempLink2 = tempLink2.substring(0, tempLink2.length) + '&vifp='+vifp;
      ($('.p3>div>.packCta-'+extension.pNum+'')).attr('href', tempLink2);
        }}
    });
}  

function search_p4(decoded,callback) {
    $.ajax({
        type: "GET",
        cache: true,
        url: "/cruisesearch/api/search?"+extension.p4price+"&pageNumber=1&pageSize=8&showBest=true&sort=fromprice&useSuggestions=true"+decoded,
        error: function(error) {
            console.log('Param error', error);
        },
      success: function(response2) {
           var pricep4 = response2.results.itineraries[0].leadSailing.fromPrice;
      if (pricep4 > 0) {
        var pricePoint_p4 = pricep4.toString();
        if (pricePoint_p4.length > 3) {
          pricePoint_p4 = pricePoint_p4.slice(0, -3) + ',' + pricePoint_p4.slice(-3);}
  ($('.p4-price'+extension.pNum+'')).append('<span class="pack-leading-text-attr" style="text-align: right;margin-right: 5px;" aria-hidden="true">STARTING<br>FROM</span><span class="pack-sale-price-attr" aria-hidden="true"><sup class="pack-dollar-sign">$</sup>'+pricePoint_p4+'<sup class="pack-asterisk">*</sup></span><span class="pack-leading-text-attr" style="text-align: left; margin-left: 8px;" aria-hidden="true">PER<br>PERSON</span>');
      ($('.p4>div>.packCta-'+extension.pNum+'')).attr('aria-label', extension.cta+", "+extension.p4aria+' from $' + pricePoint_p4 + ' per person'); 
  var vifp = window.pastGuestNum;
   if (vifp) {
       } else {
      vifp=""}
        var tempLink =   ($('.pack-'+ extension.pNum +'>.p4')).attr('onclick');
      tempLink = tempLink.substring(0, tempLink.length- 1) + '&vifp='+vifp+'\'';
      ($('.pack-'+ extension.pNum +'>.p4')).attr('onclick', tempLink);
         var tempLink2 =  ($('.p4>div>.packCta-'+extension.pNum+'')).attr('href');
      tempLink2 = tempLink2.substring(0, tempLink2.length) + '&vifp='+vifp;
      ($('.p4>div>.packCta-'+extension.pNum+'')).attr('href', tempLink2);
        }}
    });
}  

function search_p5(decoded,callback) {
    $.ajax({
        type: "GET",
        cache: true,
        url: "/cruisesearch/api/search?"+extension.p5price+"&pageNumber=1&pageSize=8&showBest=true&sort=fromprice&useSuggestions=true"+decoded,
        error: function(error) {
            console.log('Param error', error);
        },
      success: function(response2) {
           var pricep5 = response2.results.itineraries[0].leadSailing.fromPrice;
      if (pricep5 > 0) {
        var pricePoint_p5 = pricep5.toString();
        if (pricePoint_p5.length > 3) {
          pricePoint_p5 = pricePoint_p5.slice(0, -3) + ',' + pricePoint_p5.slice(-3);}
  ($('.p5-price'+extension.pNum+'')).append('<span class="pack-leading-text-attr" style="text-align: right;margin-right: 5px;" aria-hidden="true">STARTING<br>FROM</span><span class="pack-sale-price-attr" aria-hidden="true"><sup class="pack-dollar-sign">$</sup>'+pricePoint_p5+'<sup class="pack-asterisk">*</sup></span><span class="pack-leading-text-attr" style="text-align: left; margin-left: 8px;" aria-hidden="true">PER<br>PERSON</span>');
      ($('.p5>div>.packCta-'+extension.pNum+'')).attr('aria-label', extension.cta+", "+extension.p5aria+' from $' + pricePoint_p5 + ' per person'); 
  var vifp = window.pastGuestNum;
   if (vifp) {
       } else {
      vifp=""}
        var tempLink =   ($('.pack-'+ extension.pNum +'>.p5')).attr('onclick');
      tempLink = tempLink.substring(0, tempLink.length- 1) + '&vifp='+vifp+'\'';
      ($('.pack-'+ extension.pNum +'>.p5')).attr('onclick', tempLink);
         var tempLink2 =  ($('.p5>div>.packCta-'+extension.pNum+'')).attr('href');
    tempLink2 = tempLink2.substring(0, tempLink2.length) + '&vifp='+vifp;
      ($('.p5>div>.packCta-'+extension.pNum+'')).attr('href', tempLink2);
        }}
    });
}  

if (extension.showprice === "false"){
($('.p1>div>.packCta-'+extension.pNum+'')).attr('aria-label', extension.p1aria+", "+extension.cta);  
($('.p2>div>.packCta-'+extension.pNum+'')).attr('aria-label', extension.p2aria+", "+extension.cta);  
($('.p3>div>.packCta-'+extension.pNum+'')).attr('aria-label', extension.p3aria+", "+extension.cta);  
($('.p4>div>.packCta-'+extension.pNum+'')).attr('aria-label', extension.p4aria+", "+extension.cta);    
($('.p5>div>.packCta-'+extension.pNum+'')).attr('aria-label', extension.p5aria+", "+extension.cta);  
}
      },
      hideFn: function(event) {
        var $ = window.optimizely.get('jquery');
        var widget = event.data.config;
        widget.$id = "30453410332";
        widget.$instance = event.data.id;
        widget.$fieldDefaults = [{"name":"pNum","default_value":"1"},{"name":"TilesCheck","default_value":"4-tiles"},{"name":"backgroundColor","default_value":"background-color: white;"},{"name":"appendTo","default_value":".bucket-3"},{"name":"title","default_value":"<span style=\"width: 100%;display: block;margin: 0 25px 0 0;flex: 1;height: 2.5px; background-color: #10559a !important;\" aria-hidden=\"true\"></span> CHECK OUT OUR NEWEST SHIPS <span style=\" width: 100%;   display: block; margin: 0 0 0 25px; flex: 1; height: 2.5px; background-color: #10559a !important;\" aria-hidden=\"true\"></span>"},{"name":"titleCSS","default_value":"  color: #10559a; \n  display: flex;\n  align-items: center;\n  justify-content: center;\n  white-space: nowrap;"},{"name":"tile1Image","default_value":"/~/media/Images/hp-merch/2023/Desktop/tiles/caribbean-tile.jpg"},{"name":"tile2Image","default_value":"/~/media/Images/hp-merch/2023/Desktop/tiles/bahamas-tile.jpg"},{"name":"tile3Image","default_value":"/~/media/Images/hp-merch/2023/Desktop/tiles/mexico-tile.jpg"},{"name":"tile4Image","default_value":"/~/media/Images/hp-merch/2023/Desktop/tiles/journeys-tile.jpg"},{"name":"tile5Image","default_value":"/~/media/Images/hp-merch/2023/Desktop/tiles/journeys-tile.jpg"},{"name":"color","default_value":"hp-text-white"},{"name":"packtitle","default_value":"title-top"},{"name":"dskheight","default_value":"450px"},{"name":"mblheight","default_value":"400px"},{"name":"tile1","default_value":"<span class=\"responsive-pack-title-1\" aria-hidden=\"true\">CARNIVAL</span>\n  <span class=\"responsive-pack-title-2\" aria-hidden=\"true\">CELEBRATION<sup class=\"tm\"></sup></span>"},{"name":"tile2","default_value":"<span class=\"responsive-pack-title-1\" aria-hidden=\"true\">CARNIVAL</span>\n  <span class=\"responsive-pack-title-2\" aria-hidden=\"true\">CELEBRATION<sup class=\"tm\"></sup></span>"},{"name":"tile3","default_value":"<span class=\"responsive-pack-title-1\" aria-hidden=\"true\">CARNIVAL</span>\n  <span class=\"responsive-pack-title-2\" aria-hidden=\"true\">CELEBRATION<sup class=\"tm\"></sup></span>"},{"name":"tile4","default_value":"<span class=\"responsive-pack-title-1\" aria-hidden=\"true\">CARNIVAL</span>\n  <span class=\"responsive-pack-title-2\" aria-hidden=\"true\">CELEBRATION<sup class=\"tm\"></sup></span>"},{"name":"tile5","default_value":"<span class=\"responsive-pack-title-1\" aria-hidden=\"true\">CARNIVAL</span>\n  <span class=\"responsive-pack-title-2\" aria-hidden=\"true\">CELEBRATION<sup class=\"tm\"></sup></span>"},{"name":"cta","default_value":"SEARCH CRUISES"},{"name":"tile1Url","default_value":"/cruise-search?icid=crm_ccl_ships_091224_resp_pack_p1_nonbooked_3&ship=cb"},{"name":"tile2Url","default_value":"/cruise-search?icid=crm_ccl_ships_091224_resp_pack_p2_nonbooked_3&ship=cb"},{"name":"tile3Url","default_value":"/cruise-search?icid=crm_ccl_ships_091224_resp_pack_p3_nonbooked_3&ship=cb"},{"name":"tile4Url","default_value":"/cruise-search?icid=crm_ccl_ships_091224_resp_pack_p4_nonbooked_3&ship=cb"},{"name":"tile5Url","default_value":"/cruise-search?icid=crm_ccl_ships_091224_resp_pack_p5_nonbooked_3&ship=cb"},{"name":"p1aria","default_value":"Carnival celebration"},{"name":"p2aria","default_value":"mardi gras"},{"name":"p3aria","default_value":"carnival celebration"},{"name":"p4aria","default_value":""},{"name":"p5aria","default_value":""},{"name":"showprice","default_value":"true"},{"name":"p1price","default_value":"numadults=2"},{"name":"p2price","default_value":"numadults=2"},{"name":"p3price","default_value":"numadults=2"},{"name":"p4price","default_value":"numadults=2"},{"name":"p5price","default_value":"numadults=2"}];
        (function(widg) {
  var i = 0;
  var field;
  for (; i < widg.$fieldDefaults.length; ++i) {
    field = widg.$fieldDefaults[i];
    if (!widg.hasOwnProperty(field.name)) {
      widg[field.name] = field.default_value;
    }
  }
  })(widget);
        var extension = widget;
        widget._styleTag = document.getElementById('widget-css-30453410332');
if (widget._styleTag) widget._styleTag.parentNode.removeChild(widget._styleTag);
        var extensionElement = document.getElementById('optimizely-extension-' + extension.$instance);
if (extensionElement) {
  extensionElement.parentElement.removeChild(extensionElement);
}

      },
    });

PluginManager.registerWidget({
      widgetId: '30531620018',
      showFn: function(event) {
        var $ = window.optimizely.get('jquery');
        var widget = event.data.config;
        var _template = new Hogan(function(c,p,i) {var t=this;t.b(i=i||"");t.b("<div id=\"optimizely-extension-");t.b(t.v(t.d("extension.$instance",c,p,0)));t.b("\" class=\"tetris-tile\">");t.b("\n" + i);t.b("  <span class=\"grid-main-title\">");t.b(t.t(t.d("extension.title",c,p,0)));t.b("</span>");t.b("\n" + i);t.b("  <div class=\"tetris-grid\"> ");t.b("\n" + i);t.b("  <div class=\"grid-item g1\" style=\"background-image:url(");t.b(t.v(t.d("extension.g1Image",c,p,0)));t.b(")\" onclick=\"window.location.href='");t.b(t.v(t.d("extension.g1Url",c,p,0)));t.b("'\">");t.b("\n" + i);t.b("  <div class=\"grid-copy ");t.b(t.v(t.d("extension.color",c,p,0)));t.b("\">");t.b("\n" + i);t.b("  <span class=\"grid-title\" aria-hidden=\"true\">");t.b(t.v(t.d("extension.g1",c,p,0)));t.b("</span>");t.b("\n" + i);t.b("  <div class=\"g1-price grid-price-attributes\"  aria-hidden=\"true\"></div>");t.b("\n" + i);t.b("  <a  tabindex=\"0\"  class=\"grid-cta ctaHover\" href=\"");t.b(t.v(t.d("extension.g1Url",c,p,0)));t.b("\" >");t.b(t.v(t.d("extension.ariatext",c,p,0)));t.b("</a>");t.b("\n" + i);t.b("  </div>");t.b("\n" + i);t.b("  </div>");t.b("\n" + i);t.b("    ");t.b("\n" + i);t.b("  <div class=\"grid-item g2\" style=\"background-image:url(");t.b(t.v(t.d("extension.g2Image",c,p,0)));t.b(")\" onclick=\"window.location.href='");t.b(t.v(t.d("extension.g2Url",c,p,0)));t.b("'\">");t.b("\n" + i);t.b("  <div class=\"grid-copy ");t.b(t.v(t.d("extension.color",c,p,0)));t.b("\">");t.b("\n" + i);t.b("  <span class=\"grid-title\" aria-hidden=\"true\">");t.b(t.v(t.d("extension.g2",c,p,0)));t.b("</span>");t.b("\n" + i);t.b(" <div class=\"g2-price grid-price-attributes\"  aria-hidden=\"true\"></div>");t.b("\n" + i);t.b("  <a  tabindex=\"0\"  class=\"grid-cta ctaHover\" href=\"");t.b(t.v(t.d("extension.g2Url",c,p,0)));t.b("\"  >");t.b(t.v(t.d("extension.ariatext",c,p,0)));t.b("</a>");t.b("\n" + i);t.b("  </div>");t.b("\n" + i);t.b("  </div>");t.b("\n" + i);t.b("    ");t.b("\n" + i);t.b("  <div class=\"grid-item g3\" style=\"background-image:url(");t.b(t.v(t.d("extension.g3Image",c,p,0)));t.b(")\" onclick=\"window.location.href='");t.b(t.v(t.d("extension.g3Url",c,p,0)));t.b("'\">");t.b("\n" + i);t.b("  <div class=\"grid-copy ");t.b(t.v(t.d("extension.color",c,p,0)));t.b("\" style=\"display: flex;flex-direction: column;margin-top: 20px;align-items: center;\">");t.b("\n" + i);t.b("  <span class=\"grid-title\" aria-hidden=\"true\">");t.b(t.v(t.d("extension.g3",c,p,0)));t.b("</span>");t.b("\n" + i);t.b("   <div class=\"g3-price grid-price-attributes\"  aria-hidden=\"true\"></div>");t.b("\n" + i);t.b("  <a  tabindex=\"0\"  class=\"grid-cta ctaHover\" href=\"");t.b(t.v(t.d("extension.g3Url",c,p,0)));t.b("\"  >");t.b(t.v(t.d("extension.ariatext",c,p,0)));t.b("</a>");t.b("\n" + i);t.b("  </div>");t.b("\n" + i);t.b("  </div>");t.b("\n" + i);t.b("    ");t.b("\n" + i);t.b("  <div class=\"grid-item g4\" style=\"background-image:url(");t.b(t.v(t.d("extension.g4Image",c,p,0)));t.b(")\" onclick=\"window.location.href='");t.b(t.v(t.d("extension.g4Url",c,p,0)));t.b("'\">");t.b("\n" + i);t.b("  <div class=\"grid-copy ");t.b(t.v(t.d("extension.color",c,p,0)));t.b("\">");t.b("\n" + i);t.b("  <span class=\"grid-title\" aria-hidden=\"true\">");t.b(t.v(t.d("extension.g4",c,p,0)));t.b("</span>");t.b("\n" + i);t.b("    <div class=\"g4-price grid-price-attributes\"  aria-hidden=\"true\"></div>");t.b("\n" + i);t.b("   <a  tabindex=\"0\"  class=\"grid-cta ctaHover\" href=\"");t.b(t.v(t.d("extension.g4Url",c,p,0)));t.b("\"  >");t.b(t.v(t.d("extension.ariatext",c,p,0)));t.b("</a>");t.b("\n" + i);t.b("  </div>");t.b("\n" + i);t.b("  </div>");t.b("\n" + i);t.b("    ");t.b("\n" + i);t.b("  <div class=\"grid-item g5\" style=\"background-image:url(");t.b(t.v(t.d("extension.g5Image",c,p,0)));t.b(")\" onclick=\"window.location.href='");t.b(t.v(t.d("extension.g5Url",c,p,0)));t.b("'\">");t.b("\n" + i);t.b("  <div class=\"grid-copy ");t.b(t.v(t.d("extension.color",c,p,0)));t.b("\">");t.b("\n" + i);t.b("  <span class=\"grid-title\" aria-hidden=\"true\">");t.b(t.v(t.d("extension.g5",c,p,0)));t.b("</span>");t.b("\n" + i);t.b("  <div class=\"g5-price grid-price-attributes\"  aria-hidden=\"true\"></div>");t.b("\n" + i);t.b(" <a  tabindex=\"0\"  class=\"grid-cta ctaHover\" href=\"");t.b(t.v(t.d("extension.g5Url",c,p,0)));t.b("\" >");t.b(t.v(t.d("extension.ariatext",c,p,0)));t.b("</a>");t.b("\n" + i);t.b("  </div>");t.b("\n" + i);t.b("  </div>");t.b("\n" + i);t.b("    ");t.b("\n" + i);t.b("  </div>");t.b("\n");t.b("\n" + i);t.b("</div>");return t.fl(); })
        widget.$id = "30531620018";
        widget.$instance = event.data.id;
        widget.$render = _template.render.bind(_template)
        widget.$fieldDefaults = [{"name":"appendTo","default_value":".bucket-5"},{"name":"title","default_value":"fghfghdfg"},{"name":"g1Image","default_value":"/~/media/Images/hp-merch/2024/desktop/ctiles/bahamas-sailings.jpg"},{"name":"g2Image","default_value":"/~/media/Images/hp-merch/2024/desktop/ctiles/mexico-sailings.jpg"},{"name":"g3Image","default_value":"/~/media/Images/hp-merch/2024/desktop/ctiles/caribbean-sailings.jpg"},{"name":"g4Image","default_value":"/~/media/Images/hp-merch/2024/desktop/btiles/journeys-7-30-g4.jpg"},{"name":"g5Image","default_value":"/~/media/Images/hp-merch/2024/desktop/ctiles/alaska-sailings.jpg"},{"name":"g1","default_value":"THE BAHAMAS"},{"name":"g2","default_value":"MEXICO"},{"name":"g3","default_value":"CARIBBEAN"},{"name":"g4","default_value":"EUROPE"},{"name":"g5","default_value":"ALASKA"},{"name":"g1Url","default_value":"/cruise-search?icid=crm_ccl_destinations_091024_hm_grid_g2_noncore_5&dest=M"},{"name":"g2Url","default_value":"/cruise-search?icid=crm_ccl_destinations_091024_hm_grid_g2_noncore_5&dest=M"},{"name":"g3Url","default_value":"/cruise-search?icid=crm_ccl_destinations_091024_hm_grid_g3_noncore_5&dest=C"},{"name":"g4Url","default_value":"/cruise-search?icid=crm_ccl_destinations_091024_hm_grid_g4_noncore_5&dest=E"},{"name":"g5Url","default_value":"/cruise-search?icid=crm_ccl_destinations_091024_hm_grid_g5_noncore_5&dest=A"},{"name":"showprice","default_value":"true"},{"name":"g1Price","default_value":"numadults=2&dest=bh"},{"name":"g2Price","default_value":"numadults=2&dest=m"},{"name":"g3Price","default_value":"numadults=2&dest=c"},{"name":"g4Price","default_value":"numadults=2&dest=e"},{"name":"g5Price","default_value":"numadults=2&dest=a"},{"name":"ariatext","default_value":"SEARCH CRUISES"},{"name":"color","default_value":"hp-text-white"}];
        (function(widg) {
  var i = 0;
  var field;
  for (; i < widg.$fieldDefaults.length; ++i) {
    field = widg.$fieldDefaults[i];
    if (!widg.hasOwnProperty(field.name)) {
      widg[field.name] = field.default_value;
    }
  }
  })(widget);
        widget.$html = _template.render({ widget: widget, extension: widget })
        var extension = widget;
        widget._styleTag = document.createElement('style');
widget._styleTag.id = 'widget-css-30531620018';
widget._styleTag.innerHTML = '.tetris-tile{  display:flex;  flex-direction:column;  max-width:1400px;  margin:auto;  margin-top:25px;  padding-bottom: 25px;}.grid-main-title{  font-family: tempo;  font-size: 34px;  text-transform: uppercase;  line-height: 1;  padding:8px;}.grid-title{   font-family: tempo;  font-size: 34px;  text-transform: uppercase;  line-height: 1;}.grid-copy{  display: flex;  font-family: tempo;  flex-direction: column;  margin-top: 20px;  align-items: center;}.tetris-grid{    display: grid;    grid-template-columns: repeat(4, minmax(0, 1fr));     grid-template-rows: repeat(2, 300px);	grid-gap: 10px 10px;}.grid-item{  background-size: cover;  }.grid-price-attributes{ font-size: 64px;  display:flex;  justify-content: center;  line-height: 1;  }  .grid-copy{ display: flex; flex-direction:column; margin-top: 20px; align-items: center;  } .grid-leading-text-attr{   font-size: .16em;  line-height: 1;  font-family:"Open Sans";  font-weight:700;	display: flex;  align-items: center;	}	.grid-attr-container{	   display: flex;    align-items: center;	}.grid-cta{    clear: both;    font-size: 18px;    font-family: "tempo", sans-serif;    border: none;    display: inline-block;    margin: 5px 0 0 0;    padding: 14px 28px;    text-transform: uppercase;    cursor: pointer;color: #FFF !important;    background: #DC1125;    border-radius: 4px;}	.grid-asterisk{ font-size: 0.3em;    top: -10%;    position: relative;}.grid-dollar-sign{ font-size: 0.4em;    top: -7%;    position: relative;}.tetris-tile>.fees-disclaimer {    font-family: "Open Sans";    font-size: 16px;    text-align: center;    color: #595959;}  .g1{    grid-column: 1;    grid-row: 1;}.g2{    grid-column: 2 / 4;    grid-row: 1;}.g3{    grid-column: 4;    grid-row: 1 / 3;}.g4{    grid-column: 1/ 3;    grid-row: 2;}.g5{    grid-column: 3;    grid-row: 2;}@media (max-width: 1240px) {  .grid-title {  	font-size: 30px!important;  }}@media (max-width: 1070px) {  .grid-title {  	font-size: 30px!important;  }}@media (max-width: 880px) {  .g4 {    grid-column: 1;    grid-row: 2;}  .g2 {    grid-column: 2;    grid-row: 1;}  .g3 {    grid-column: 3;    grid-row: 1 / 3;}  .g5 {    grid-column: 2 / 3;    grid-row: 2;} .tetris-grid{  -webkit-overflow-scrolling: touch;  overflow-x: auto;  scroll-behavior: smooth;  position:relative;  grid-template-columns: unset;} .grid-cta{  font-size: 16px!important;  padding: 12px 16px!important;}   .grid-price-attributes{	font-size: 55px!important;	}.tm,.grid-asterisk,.grid-dollar-sign{  vertical-align: super!important;} .fees-disclaimer{   font-size: 16px;    margin-top:-5px;}  .grid-main-title{  font-size: 32px;    line-height:1;  }.grid-item{width:300px;  }  .tetris-tile>.fees-disclaimer {    font-size: 16px;  }}';
document.getElementsByTagName('head')[0].appendChild(widget._styleTag);
        var utils = optimizely.get('utils');
var $ = window.jQuery;


//ADD HTML//

utils.waitForElement(extension.appendTo)
  .then(function() {
    // append the extension html to the body
   $(extension.appendTo).append(extension.$html);
  });

//END ADD HTML//
//LIVE PRICING//
if (extension.showprice === "true"){
// Main entry point
$(document).ready(function() {
    // Start the process
    initialize();
});
utils.waitForElement(extension.appendTo)
  .then(function() { 
$('<p class="fees-disclaimer">*All taxes and fees are included.</p>').insertAfter('.tetris-grid');
    });
}
function initialize() {
    var vifp = window.pastGuestNum;
   if (vifp) {
     utils.waitForElement('.grid-price-attributes')
  .then(function() {fetchTargetedOffers(vifp);});
    } else {
       utils.waitForElement('.grid-price-attributes')
  .then(function() {var decoded="";
         search_g1(decoded);
         search_g2(decoded);
         search_g3(decoded);
         search_g4(decoded);
         search_g5(decoded);     
                    });
    }
}

// Function to fetch targeted offers
function fetchTargetedOffers(vifp) {
 $.ajax({
        type: "GET",
        cache: true,
        url: "https://www.carnival.com/cruisesearch/api/TargetedOffers/GetTargetedOffers?pastGuestNumber="+vifp,
        error: function(error) {
            console.log('Param error', error);
        },
        success: function(response) {
            var offers = encodeURIComponent(response.tgos);
            var tier = encodeURIComponent(response.tierCode);
            var decoded= '&tgo='+offers+'&tierCode='+tier+'&vifp='+vifp;
          search_g1(decoded);
          search_g2(decoded);
          search_g3(decoded);
          search_g4(decoded);
          search_g5(decoded); 
        }
    });
   
}
// Function to search for cruises
function search_g1(decoded,callback) {
    $.ajax({
        type: "GET",
        cache: true,
        url: "/cruisesearch/api/search/?"+extension.g1Price+"&pageNumber=1&pageSize=8&showBest=true&sort=fromprice&useSuggestions=true"+decoded,
        error: function(error) {
            console.log('Param error', error);
        },
      success: function(response2) {
           var priceg1 = response2.results.itineraries[0].leadSailing.fromPrice;
      if (priceg1 > 0) {
        var pricePoint_g1 = priceg1.toString();
        if (pricePoint_g1.length > 3) {
          pricePoint_g1 = pricePoint_g1.slice(0, -3) + ',' + pricePoint_g1.slice(-3);}
   $('.g1-price').append('<span class="grid-leading-text-attr" style="text-align: right; margin-right: 5px;" aria-hidden="true">CRUISES<br>FROM</span><span class="grid-sale-price-attr" aria-hidden="true"><sup class="grid-dollar-sign">$</sup>'+pricePoint_g1+'<sup class="grid-asterisk">*</sup></span><span class="grid-leading-text-attr" style="text-align: left; margin-left: 8px;"aria-hidden="true">PER<br>PERSON</span>');
     $('.g1>div>.grid-cta').attr('aria-label',  extension.ariatext + extension.g1+' from $' + pricePoint_g1 + ' per person'); 
  var vifp = window.pastGuestNum;
   if (vifp) {
       } else {
      vifp=""}
        var tempLink = $('.g1').attr('onclick');
      tempLink = tempLink.substring(0, tempLink.length- 1)+ '&vifp='+vifp+'\'';
      $('.g1').attr('onclick', tempLink);
         var tempLink2 = $('.g1>div>a').attr('href');
    tempLink2 = tempLink2.substring(0, tempLink2.length) + '&vifp='+vifp;
      $('.g1>div>a').attr('href', tempLink2);
        }
}
    });
}
function search_g2(decoded,callback) {
    $.ajax({
        type: "GET",
        cache: true,
        url: "/cruisesearch/api/search/?"+extension.g2Price+"&pageNumber=1&pageSize=8&showBest=true&sort=fromprice&useSuggestions=true"+decoded,
        error: function(error) {
            console.log('Param error', error);
        },
        success: function(response2) {
           var priceg2 = response2.results.itineraries[0].leadSailing.fromPrice;
      if (priceg2 > 0) {
        var pricePoint_g2 = priceg2.toString();
        if (pricePoint_g2.length > 3) {
          pricePoint_g2 = pricePoint_g2.slice(0, -3) + ',' + pricePoint_g2.slice(-3);}
    $('.g2-price').append('<span class="grid-leading-text-attr" style="text-align: right; margin-right: 5px;" aria-hidden="true">CRUISES<br>FROM</span><span class="grid-sale-price-attr" aria-hidden="true"><sup class="grid-dollar-sign">$</sup>'+pricePoint_g2+'<sup class="grid-asterisk">*</sup></span><span class="grid-leading-text-attr" style="text-align: left; margin-left: 8px;"aria-hidden="true">PER<br>PERSON</span>');
     $('.g2>div>.grid-cta').attr('aria-label',  extension.ariatext+ extension.g2+' from $' + pricePoint_g2 + ' per person'); 
          var vifp = window.pastGuestNum;
   if (vifp) {
       } else {
      vifp=""}
  var tempLink = $('.g2').attr('onclick');
     tempLink = tempLink.substring(0, tempLink.length- 1) + '&vifp='+vifp+'\'';
      $('.g2').attr('onclick', tempLink);
         var tempLink2 = $('.g2>div>a').attr('href');
    tempLink2 = tempLink2.substring(0, tempLink2.length) + '&vifp='+vifp;
      $('.g2>div>a').attr('href', tempLink2);
        }
}
    });
}
    
function search_g3(decoded,callback) {
    $.ajax({
        type: "GET",
        cache: true,
        url: "/cruisesearch/api/search/?"+extension.g3Price+"&pageNumber=1&pageSize=8&showBest=true&sort=fromprice&useSuggestions=true"+decoded,
        error: function(error) {
            console.log('Param error', error);
        },
      success: function(response2) {
           var priceg3 = response2.results.itineraries[0].leadSailing.fromPrice;
      if (priceg3 > 0) {
        var pricePoint_g3 = priceg3.toString();
        if (pricePoint_g3.length > 3) {
          pricePoint_g3 = pricePoint_g3.slice(0, -3) + ',' + pricePoint_g3.slice(-3);}
   $('.g3-price').append('<span class="grid-leading-text-attr" style="text-align: right; margin-right: 5px;" aria-hidden="true">CRUISES<br>FROM</span><span class="grid-sale-price-attr" aria-hidden="true"><sup class="grid-dollar-sign">$</sup>'+pricePoint_g3+'<sup class="grid-asterisk">*</sup></span><span class="grid-leading-text-attr" style="text-align: left; margin-left: 8px;"aria-hidden="true">PER<br>PERSON</span>');
     $('.g3>div>.grid-cta').attr('aria-label', extension.ariatext+ extension.g3+' from $' + pricePoint_g3 + ' per person'); 
          var vifp = window.pastGuestNum;
   if (vifp) {
       } else {
      vifp=""}
  var tempLink = $('.g3').attr('onclick');
     tempLink = tempLink.substring(0, tempLink.length- 1) + '&vifp='+vifp+'\'';
      $('.g3').attr('onclick', tempLink);
         var tempLink2 = $('.g3>div>a').attr('href');
    tempLink2 = tempLink2.substring(0, tempLink2.length) + '&vifp='+vifp;
      $('.g3>div>a').attr('href', tempLink2);
        }
}
    });
}

function search_g4(decoded,callback) {
    $.ajax({
        type: "GET",
        cache: true,
        url: "/cruisesearch/api/search/?"+extension.g4Price+"&pageNumber=1&pageSize=8&showBest=true&sort=fromprice&useSuggestions=true"+decoded,
        error: function(error) {
            console.log('Param error', error);
        },
       success: function(response2) {
           var priceg4 = response2.results.itineraries[0].leadSailing.fromPrice;
      if (priceg4 > 0) {
        var pricePoint_g4 = priceg4.toString();
        if (pricePoint_g4.length > 3) {
          pricePoint_g4 = pricePoint_g4.slice(0, -3) + ',' + pricePoint_g4.slice(-3);}
    $('.g4-price.grid-price-attributes').append('<span class="grid-leading-text-attr" style="text-align: right; margin-right: 5px;" aria-hidden="true">CRUISES<br>FROM</span><span class="grid-sale-price-attr" aria-hidden="true"><sup class="grid-dollar-sign">$</sup>'+pricePoint_g4+'<sup class="grid-asterisk">*</sup></span><span class="grid-leading-text-attr" style="text-align: left; margin-left: 8px;"aria-hidden="true">PER<br>PERSON</span>');
     $('.g4>div>.grid-cta').attr('aria-label',  extension.ariatext+ extension.g4+' from $' + pricePoint_g4 + ' per person'); 
          var vifp = window.pastGuestNum;
   if (vifp) {
       } else {
      vifp=""}
  var tempLink = $('.g4').attr('onclick');
     tempLink = tempLink.substring(0, tempLink.length- 1) + '&vifp='+vifp+'\'';
      $('.g4').attr('onclick', tempLink);
         var tempLink2 = $('.g4>div>a').attr('href');
    tempLink2 = tempLink2.substring(0, tempLink2.length) + '&vifp='+vifp;
      $('.g4>div>a').attr('href', tempLink2);
    }
}
    });
}

function search_g5(decoded,callback) {
    $.ajax({
        type: "GET",
        cache: true,
        url: "/cruisesearch/api/search/?"+extension.g5Price+"&pageNumber=1&pageSize=8&showBest=true&sort=fromprice&useSuggestions=true"+decoded,
        error: function(error) {
            console.log('Param error', error);
        },
        success: function(response2) {
           var priceg5 = response2.results.itineraries[0].leadSailing.fromPrice;
      if (priceg5 > 0) {
        var pricePoint_g5 = priceg5.toString();
        if (pricePoint_g5.length > 3) {
          pricePoint_g5 = pricePoint_g5.slice(0, -3) + ',' + pricePoint_g5.slice(-3);  }
    $('.g5-price').append('<span class="grid-leading-text-attr" style="text-align: right; margin-right: 5px;" aria-hidden="true">CRUISES<br>FROM</span><span class="grid-sale-price-attr" aria-hidden="true"><sup class="grid-dollar-sign">$</sup>'+pricePoint_g5+'<sup class="grid-asterisk">*</sup></span><span class="grid-leading-text-attr" style="text-align: left; margin-left: 8px;"aria-hidden="true">PER<br>PERSON</span>');
     $('.g5>div>.grid-cta').attr('aria-label', extension.ariatext+ extension.g5+' from $' + pricePoint_g5 + ' per person'); 
          var vifp = window.pastGuestNum;
   if (vifp) {
       } else {
      vifp=""}
  var tempLink = $('.g5').attr('onclick');
    tempLink = tempLink.substring(0, tempLink.length- 1) + '&vifp='+vifp+'\'';
      $('.g5').attr('onclick', tempLink);
       var tempLink2 = $('.g5>div>a').attr('href');
    tempLink2 = tempLink2.substring(0, tempLink2.length) + '&vifp='+vifp;
      $('.g5>div>a').attr('href', tempLink2);
        }
    }
    });
}


      },
      hideFn: function(event) {
        var $ = window.optimizely.get('jquery');
        var widget = event.data.config;
        widget.$id = "30531620018";
        widget.$instance = event.data.id;
        widget.$fieldDefaults = [{"name":"appendTo","default_value":".bucket-5"},{"name":"title","default_value":"fghfghdfg"},{"name":"g1Image","default_value":"/~/media/Images/hp-merch/2024/desktop/ctiles/bahamas-sailings.jpg"},{"name":"g2Image","default_value":"/~/media/Images/hp-merch/2024/desktop/ctiles/mexico-sailings.jpg"},{"name":"g3Image","default_value":"/~/media/Images/hp-merch/2024/desktop/ctiles/caribbean-sailings.jpg"},{"name":"g4Image","default_value":"/~/media/Images/hp-merch/2024/desktop/btiles/journeys-7-30-g4.jpg"},{"name":"g5Image","default_value":"/~/media/Images/hp-merch/2024/desktop/ctiles/alaska-sailings.jpg"},{"name":"g1","default_value":"THE BAHAMAS"},{"name":"g2","default_value":"MEXICO"},{"name":"g3","default_value":"CARIBBEAN"},{"name":"g4","default_value":"EUROPE"},{"name":"g5","default_value":"ALASKA"},{"name":"g1Url","default_value":"/cruise-search?icid=crm_ccl_destinations_091024_hm_grid_g2_noncore_5&dest=M"},{"name":"g2Url","default_value":"/cruise-search?icid=crm_ccl_destinations_091024_hm_grid_g2_noncore_5&dest=M"},{"name":"g3Url","default_value":"/cruise-search?icid=crm_ccl_destinations_091024_hm_grid_g3_noncore_5&dest=C"},{"name":"g4Url","default_value":"/cruise-search?icid=crm_ccl_destinations_091024_hm_grid_g4_noncore_5&dest=E"},{"name":"g5Url","default_value":"/cruise-search?icid=crm_ccl_destinations_091024_hm_grid_g5_noncore_5&dest=A"},{"name":"showprice","default_value":"true"},{"name":"g1Price","default_value":"numadults=2&dest=bh"},{"name":"g2Price","default_value":"numadults=2&dest=m"},{"name":"g3Price","default_value":"numadults=2&dest=c"},{"name":"g4Price","default_value":"numadults=2&dest=e"},{"name":"g5Price","default_value":"numadults=2&dest=a"},{"name":"ariatext","default_value":"SEARCH CRUISES"},{"name":"color","default_value":"hp-text-white"}];
        (function(widg) {
  var i = 0;
  var field;
  for (; i < widg.$fieldDefaults.length; ++i) {
    field = widg.$fieldDefaults[i];
    if (!widg.hasOwnProperty(field.name)) {
      widg[field.name] = field.default_value;
    }
  }
  })(widget);
        var extension = widget;
        widget._styleTag = document.getElementById('widget-css-30531620018');
if (widget._styleTag) widget._styleTag.parentNode.removeChild(widget._styleTag);
        var extensionElement = document.getElementById('optimizely-extension-' + extension.$instance);
if (extensionElement) {
  extensionElement.parentElement.removeChild(extensionElement);
}

      },
    });

PluginManager.registerWidget({
      widgetId: '4634262784180224',
      showFn: function(event) {
        var $ = window.optimizely.get('jquery');
        var widget = event.data.config;
        var _template = new Hogan(function(c,p,i) {var t=this;t.b(i=i||"");t.b("<div onclick=\"window.location.href='");t.b(t.v(t.d("extension.link",c,p,0)));t.b("'\" id=\"optimizely-extension-");t.b(t.v(t.d("extension.$instance",c,p,0)));t.b("\" style=\"");t.b(t.v(t.d("extension.additionalStyles",c,p,0)));t.b("\" class=\"");t.b(t.v(t.d("extension.btiletoggle",c,p,0)));t.b(" ctile\" tabindex=\"-1\" >");t.b("\n" + i);t.b("  ");t.b(t.t(t.d("extension.innerHTML",c,p,0)));t.b("\n" + i);t.b("</div>");return t.fl(); })
        widget.$id = "4634262784180224";
        widget.$instance = event.data.id;
        widget.$render = _template.render.bind(_template)
        widget.$fieldDefaults = [{"name":"inserAfterDesktop","default_value":".row-2-wrap"},{"name":"additionalStyles","default_value":"background-image: url(/~/media/Images/hp-merch/2024/desktop/ctiles/sunglass-friends-ocean.jpg);\n    background-size: cover;\n    background-position: center;\n    background-size: cover;\n    background-repeat: no-repeat;\n    color: white;\n    margin-top: 15px;\n    height: 320px;\n    position: relative;\n    z-index: 1;\n    display: flex;\n    justify-content: center;\n    overflow: hidden;\n    align-items: center;"},{"name":"innerHTML","default_value":"   <span \n\trole=\"link\" \n\taria-label=\"shop this deal,three days only! extra bonus savings\" \n\tclass=\"CTileCTA ctaHover hp-text-shadow-none\" \n\tstyle=\"font-size: 170%;\" \n\ttabindex=\"0\" \n\tonkeypress=\"if (event.key === 'Enter') {window.location.href = '/cruise-search?cruisedeals=earlysaversale&icid=icp_ccl_earlysaversale_082224_hm_h1&rateCodes='; }\" >SHOP THIS DEAL\n   </span>"},{"name":"link","default_value":"/cruise-search?cruisedeals=earlysaversale&icid=icp_ccl_earlysaversale_082224_ctile&rateCodes="},{"name":"location","default_value":"afterend"},{"name":"btiletoggle","default_value":"sec-banner"},{"name":"altText","default_value":""}];
        (function(widg) {
  var i = 0;
  var field;
  for (; i < widg.$fieldDefaults.length; ++i) {
    field = widg.$fieldDefaults[i];
    if (!widg.hasOwnProperty(field.name)) {
      widg[field.name] = field.default_value;
    }
  }
  })(widget);
        widget.$html = _template.render({ widget: widget, extension: widget })
        var extension = widget;
        widget._styleTag = document.createElement('style');
widget._styleTag.id = 'widget-css-4634262784180224';
widget._styleTag.innerHTML = '.CTileCTA {    clear: both;    font-family: "tempo", sans-serif;    line-height: 1;    text-transform: uppercase;    cursor: pointer;    color: #FFF;    background: #DC1125;    border-radius: 4px;    text-shadow: none;    border: none;    display: inline-block;    padding: 16px 32px;    font-size: 18.7px;    border-radius: 4px;}.sec-banner{  margin:auto;  max-width: 1400px;}.sec-banner:hover{  cursor:pointer;}.sec-banner-b-tile{  margin:auto;  max-width: 1400px;}.sec-banner-b-tile:hover{  cursor:pointer;}';
document.getElementsByTagName('head')[0].appendChild(widget._styleTag);
        var utils = optimizely.get('utils');
   utils.waitForElement(extension.inserAfterDesktop).then(function(elem) {
      elem.insertAdjacentHTML('beforeend',extension.$html);
       $('.cTileCta').attr('tabindex', '0');
  $('.ctile').removeAttribute("role");
    });
/*
utils.waitForElement(extension.inserAfterDesktop)
  .then(function(elem) {
    // Prepend the extension html to the body
    elem.insertAdjacentHTML(extension.location, extension.$html);
  $('.cTileCta').attr('tabindex', '0');
  $('.ctile').removeAttribute("role");
  });
*/
      },
      hideFn: function(event) {
        var $ = window.optimizely.get('jquery');
        var widget = event.data.config;
        widget.$id = "4634262784180224";
        widget.$instance = event.data.id;
        widget.$fieldDefaults = [{"name":"inserAfterDesktop","default_value":".row-2-wrap"},{"name":"additionalStyles","default_value":"background-image: url(/~/media/Images/hp-merch/2024/desktop/ctiles/sunglass-friends-ocean.jpg);\n    background-size: cover;\n    background-position: center;\n    background-size: cover;\n    background-repeat: no-repeat;\n    color: white;\n    margin-top: 15px;\n    height: 320px;\n    position: relative;\n    z-index: 1;\n    display: flex;\n    justify-content: center;\n    overflow: hidden;\n    align-items: center;"},{"name":"innerHTML","default_value":"   <span \n\trole=\"link\" \n\taria-label=\"shop this deal,three days only! extra bonus savings\" \n\tclass=\"CTileCTA ctaHover hp-text-shadow-none\" \n\tstyle=\"font-size: 170%;\" \n\ttabindex=\"0\" \n\tonkeypress=\"if (event.key === 'Enter') {window.location.href = '/cruise-search?cruisedeals=earlysaversale&icid=icp_ccl_earlysaversale_082224_hm_h1&rateCodes='; }\" >SHOP THIS DEAL\n   </span>"},{"name":"link","default_value":"/cruise-search?cruisedeals=earlysaversale&icid=icp_ccl_earlysaversale_082224_ctile&rateCodes="},{"name":"location","default_value":"afterend"},{"name":"btiletoggle","default_value":"sec-banner"},{"name":"altText","default_value":""}];
        (function(widg) {
  var i = 0;
  var field;
  for (; i < widg.$fieldDefaults.length; ++i) {
    field = widg.$fieldDefaults[i];
    if (!widg.hasOwnProperty(field.name)) {
      widg[field.name] = field.default_value;
    }
  }
  })(widget);
        var extension = widget;
        widget._styleTag = document.getElementById('widget-css-4634262784180224');
if (widget._styleTag) widget._styleTag.parentNode.removeChild(widget._styleTag);
        var extensionElement = document.getElementById('optimizely-extension-' + extension.$instance);
if (extensionElement) {
  extensionElement.parentElement.removeChild(extensionElement);
}

      },
    });

PluginManager.registerWidget({
      widgetId: '4651804370141184',
      showFn: function(event) {
        var $ = window.optimizely.get('jquery');
        var widget = event.data.config;
        var _template = new Hogan(function(c,p,i) {var t=this;t.b(i=i||"");t.b("<div class=\"c-hero btile-");t.b(t.v(t.d("extension.order",c,p,0)));t.b("\" id=\"optimizely-extension-");t.b(t.v(t.d("extension.$instance",c,p,0)));t.b("\">");t.b("\n" + i);t.b("  <img class=\"c-hero__image\" src=\"");t.b(t.v(t.d("extension.bTileBG",c,p,0)));t.b("\" alt=\"");t.b(t.v(t.d("extension.altText",c,p,0)));t.b("\"> ");t.b("\n" + i);t.b("  <div class=\"b");t.b(t.v(t.d("extension.order",c,p,0)));t.b(" overlay c-hero__overlay\" onclick=\"window.location='");t.b(t.v(t.d("extension.clickThrough",c,p,0)));t.b("';\" style=\"justify-content: ");t.b(t.v(t.d("extension.contentPosition",c,p,0)));t.b("\">");t.b("\n" + i);t.b("              ");t.b(t.t(t.d("extension.b1Copy",c,p,0)));t.b("\n" + i);t.b("       ");t.b("\n" + i);t.b("  </div>");t.b("\n" + i);t.b("</div>");t.b("\n");t.b("\n");return t.fl(); })
        widget.$id = "4651804370141184";
        widget.$instance = event.data.id;
        widget.$render = _template.render.bind(_template)
        widget.$fieldDefaults = [{"name":"appendMbl","default_value":""},{"name":"bTileBG","default_value":"/~/media/Images/hp-merch/2023/Mobile/tiles/blue-wave-lines2-b1.jpg"},{"name":"clickThrough","default_value":"/cruise-search?cruisedeals=earlysaversale&icid=crm_ccl_earlysaversale_090524_mbl_btile_b1&rateCodes=OCS"},{"name":"b1Copy","default_value":"<div class=\"hp-text-white hp-text-shadow-none\" style=\"display: flex;flex-direction: column;align-items: center;\">\n  <span class=\"hp-font-tempo\" style=\"line-height: 1;font-size: 42px;\">BOOK EARLY</span>\n  \n  <span class=\"\" style=\"line-height: 1;font-size: 16px;font-family: helvetica;margin-top: 4px;/* font-weight: bold; */\">SAILINGS THROUGH APRIL 2027</span>\n  <span class=\"sr-only\">50% off deposits + more</span>\n  <div class=\"price-attributes \" style=\"\n    font-size: 59px;\n    margin-top: 6px;\n    line-height: 1;\n\" aria-hidden=\"true\">\n    \n    <div class=\"attrContainer\" style=\" display: flex;\n    align-items: center;\n    flex-direction: row;\"><span class=\"leadingText-attr  hp-font-semibold \" style=\"text-align: right;margin-right: 5px;display: none;\">REDUCED<br>DEPOSITS<br>FROM</span> <span class=\"salePrice-attr\" style=\"\">50%<sup style=\"display:none;font-size: 0.35em;top: 14px;position: relative;\">*</sup></span><span class=\"leadingText-attr  hp-font-semibold \" style=\"text-align: left;margin-left: 5px;\">OFF<br>DEPOSITS</span>\n      </div><div class=\"attrPlus\" style=\"\n    margin-right: 0px;\n    margin-left: 0px;\n    margin-bottom: 12px;\n    \"></div><div class=\"attrContainer\" style=\"\n    display: flex;\n    align-items: center;\n    flex-direction: row;\n\">\n      <span class=\"leadingText-attr\" style=\"\n    text-align: right;\n    margin-right: 5px;\n    /* font-weight: bold; */\n\"></span>\n<span class=\"salePrice-attr\" style=\"/* font-size: 1.3em; */\">MORE\n</span>\n    \n    </div>\n\n    \n  </div>\n<a aria-label=\"shop this deal, select sailings through December 2024, are from  $309* per person\" class=\"tile-cta\" style=\"    font-size: 16px!important;\n    padding: 10px 16px!important;\n    margin-top: 10px;\"  onclick=\"/cruise-search?cruisedeals=sitewidesale&amp;icid=crm_ccl_sitewidesale_090524_mbl_btile_b1&amp;rateCodes=OCS,OTR\" >BOOK NOW</a>\n\n</div>"},{"name":"copyMargin","default_value":""},{"name":"contentPosition","default_value":"center"},{"name":"altText","default_value":""}];
        (function(widg) {
  var i = 0;
  var field;
  for (; i < widg.$fieldDefaults.length; ++i) {
    field = widg.$fieldDefaults[i];
    if (!widg.hasOwnProperty(field.name)) {
      widg[field.name] = field.default_value;
    }
  }
  })(widget);
        widget.$html = _template.render({ widget: widget, extension: widget })
        var extension = widget;
        widget._styleTag = document.createElement('style');
widget._styleTag.id = 'widget-css-4651804370141184';
widget._styleTag.innerHTML = '.tile-cta{ background: #dc1125!important; font-size: 12px!important;  padding:10px 24px!important;  border-radius: 4px!important;    clear: both;    color: #fff;    font-family: "tempo", sans-serif;    border: none;    display: inline-block;    margin: 10px 0 0 0;    line-height: 1;    text-transform: uppercase;    transition: all 0.23s ease-in-out;    cursor: pointer;    font-weight: normal;}.c-hero{  font-family: "tempo", sans-serif;}';
document.getElementsByTagName('head')[0].appendChild(widget._styleTag);
        var utils = optimizely.get('utils');
var $ = window.jQuery;

   utils.waitForElement(extension.appendMbl).then(function(elem) {
      elem.insertAdjacentHTML('beforeend',extension.$html);
    });
/*
utils.waitForElement('.js-hero-banners-personalizer-target')
  .then(function(elem) {
  if((extension.order) > 2 ) {
    if($('.js-hero-banners-personalizer-target').children('div').length == 3)
      $(extension.$html).insertAfter($('.js-hero-banners-personalizer-target').children('div')[2]);
    // 4 or more elements, extension order 4
    else if($('.js-hero-banners-personalizer-target').children('div').length == 4)
    {
      var element = $('.js-hero-banners-personalizer-target').children('div').eq(3);
			var className = element.attr('class').split(' ');
      var btileOrder = className[1].charAt(className[1].length - 1);
      if(extension.order > btileOrder)
        $(extension.$html).insertAfter($('.js-hero-banners-personalizer-target').children('div')[$('.js-hero-banners-personalizer-target').children('div').length - 1]);
      else
        $(extension.$html).insertBefore($('.js-hero-banners-personalizer-target').children('div')[$('.js-hero-banners-personalizer-target').children('div').length - 1]);
    }
    else
    {
      var i = 3;
      for(i = 3; i < $('.js-hero-banners-personalizer-target').children('div').length; i++)
      {
        var element = $('.js-hero-banners-personalizer-target').children('div').eq(i);
			var className = element.attr('class').split(' ');
      var btileOrder = className[1].charAt(className[1].length - 1);
        if(extension.order < btileOrder)
        {
          $(extension.$html).insertBefore($('.js-hero-banners-personalizer-target').children('div').eq(i));
          break;
        }
      }
      if (i ==  $('.js-hero-banners-personalizer-target').children('div').length)
      	$(extension.$html).insertAfter($('.js-hero-banners-personalizer-target').children('div').eq($('.js-hero-banners-personalizer-target').children('div').length - 1));
        
    }
  } else {
    // Prepend the extension html to the body
    $('.js-hero-banners-personalizer-target').children('div')[extension.order].innerHTML='';
    $('.js-hero-banners-personalizer-target').children('div')[extension.order].innerHTML= extension.$html;
  }
   utils.waitUntil(function() {
    return window["hpB"+ extension.order+"Url"] != undefined;
  }).then(function() {
      $('.b'+extension.order).attr('href', window["hpB"+extension.order+"Url"]);
  });  
});

*/

      },
      hideFn: function(event) {
        var $ = window.optimizely.get('jquery');
        var widget = event.data.config;
        widget.$id = "4651804370141184";
        widget.$instance = event.data.id;
        widget.$fieldDefaults = [{"name":"appendMbl","default_value":""},{"name":"bTileBG","default_value":"/~/media/Images/hp-merch/2023/Mobile/tiles/blue-wave-lines2-b1.jpg"},{"name":"clickThrough","default_value":"/cruise-search?cruisedeals=earlysaversale&icid=crm_ccl_earlysaversale_090524_mbl_btile_b1&rateCodes=OCS"},{"name":"b1Copy","default_value":"<div class=\"hp-text-white hp-text-shadow-none\" style=\"display: flex;flex-direction: column;align-items: center;\">\n  <span class=\"hp-font-tempo\" style=\"line-height: 1;font-size: 42px;\">BOOK EARLY</span>\n  \n  <span class=\"\" style=\"line-height: 1;font-size: 16px;font-family: helvetica;margin-top: 4px;/* font-weight: bold; */\">SAILINGS THROUGH APRIL 2027</span>\n  <span class=\"sr-only\">50% off deposits + more</span>\n  <div class=\"price-attributes \" style=\"\n    font-size: 59px;\n    margin-top: 6px;\n    line-height: 1;\n\" aria-hidden=\"true\">\n    \n    <div class=\"attrContainer\" style=\" display: flex;\n    align-items: center;\n    flex-direction: row;\"><span class=\"leadingText-attr  hp-font-semibold \" style=\"text-align: right;margin-right: 5px;display: none;\">REDUCED<br>DEPOSITS<br>FROM</span> <span class=\"salePrice-attr\" style=\"\">50%<sup style=\"display:none;font-size: 0.35em;top: 14px;position: relative;\">*</sup></span><span class=\"leadingText-attr  hp-font-semibold \" style=\"text-align: left;margin-left: 5px;\">OFF<br>DEPOSITS</span>\n      </div><div class=\"attrPlus\" style=\"\n    margin-right: 0px;\n    margin-left: 0px;\n    margin-bottom: 12px;\n    \"></div><div class=\"attrContainer\" style=\"\n    display: flex;\n    align-items: center;\n    flex-direction: row;\n\">\n      <span class=\"leadingText-attr\" style=\"\n    text-align: right;\n    margin-right: 5px;\n    /* font-weight: bold; */\n\"></span>\n<span class=\"salePrice-attr\" style=\"/* font-size: 1.3em; */\">MORE\n</span>\n    \n    </div>\n\n    \n  </div>\n<a aria-label=\"shop this deal, select sailings through December 2024, are from  $309* per person\" class=\"tile-cta\" style=\"    font-size: 16px!important;\n    padding: 10px 16px!important;\n    margin-top: 10px;\"  onclick=\"/cruise-search?cruisedeals=sitewidesale&amp;icid=crm_ccl_sitewidesale_090524_mbl_btile_b1&amp;rateCodes=OCS,OTR\" >BOOK NOW</a>\n\n</div>"},{"name":"copyMargin","default_value":""},{"name":"contentPosition","default_value":"center"},{"name":"altText","default_value":""}];
        (function(widg) {
  var i = 0;
  var field;
  for (; i < widg.$fieldDefaults.length; ++i) {
    field = widg.$fieldDefaults[i];
    if (!widg.hasOwnProperty(field.name)) {
      widg[field.name] = field.default_value;
    }
  }
  })(widget);
        var extension = widget;
        widget._styleTag = document.getElementById('widget-css-4651804370141184');
if (widget._styleTag) widget._styleTag.parentNode.removeChild(widget._styleTag);
        var extensionElement = document.getElementById('optimizely-extension-' + extension.$instance);
if (extensionElement) {
  extensionElement.parentElement.removeChild(extensionElement);
}

      },
    });

PluginManager.registerWidget({
      widgetId: '5685106466619392',
      showFn: function(event) {
        var $ = window.optimizely.get('jquery');
        var widget = event.data.config;
        var _template = new Hogan(function(c,p,i) {var t=this;t.b(i=i||"");t.b("<button  id=\"optimizely-extension-");t.b(t.v(t.d("extension.$instance",c,p,0)));t.b("\"  class=\"button-box\" aria-live=\"polite\" aria-hidden=\"true\"  tabindex=\"0\">");t.b("\n" + i);t.b("  <img src=\"/~/media/Images/hp-merch/2024/extras/graphics/play-button.png\" tabindex=\"-1\" class=\"control-bttn play\" alt=\"play button\"style=\"display:none;  z-index: 999;\" >");t.b("\n" + i);t.b("  <img src=\"/~/media/Images/hp-merch/2024/extras/graphics/pause-button.png\" tabindex=\"-1\"  class=\"control-bttn pause\" alt=\"pause button\"style=\"  z-index: 999;\"  >");t.b("\n" + i);t.b("</button>");return t.fl(); })
        widget.$id = "5685106466619392";
        widget.$instance = event.data.id;
        widget.$render = _template.render.bind(_template)
        widget.$fieldDefaults = [{"name":"images","default_value":"/~/media/Images/hp-merch/2023/Extras/ctile/jubilee.jpg,/~/media/Images/hp-merch/2023/Extras/ctile/celebration.jpg,/~/media/Images/hp-merch/2023/Extras/ctile/venezia.jpg,/~/media/Images/hp-merch/2023/Extras/ctile/mardi-gras.jpg"},{"name":"speed","default_value":"1500"},{"name":"selector","default_value":".hero-header"},{"name":"location","default_value":"beforebegin"},{"name":"buttonPlacement","default_value":""}];
        (function(widg) {
  var i = 0;
  var field;
  for (; i < widg.$fieldDefaults.length; ++i) {
    field = widg.$fieldDefaults[i];
    if (!widg.hasOwnProperty(field.name)) {
      widg[field.name] = field.default_value;
    }
  }
  })(widget);
        widget.$html = _template.render({ widget: widget, extension: widget })
        var extension = widget;
        widget._styleTag = document.createElement('style');
widget._styleTag.id = 'widget-css-5685106466619392';
widget._styleTag.innerHTML = '.control-bttn {z-index:999!important;height:2em;width:2em;}.button-box{    bottom: 0px;    z-index: 999;    height: 4em;    width: 4em;    right: 0px;  cursor: pointer;    display: flex;    position: absolute;    justify-content: center;    align-items: center;background:transparent;  border:none;}@media (min-width: 900px) {  .button-box{    bottom: 15%!important;    z-index: 999;    height: 5em!important;    width: 5em!important;    right: 10px!important;    display: flex;    position: absolute;    justify-content: center;    align-items: flex-start;}  #ccl-cruise-search{  z-index:0!important}}';
document.getElementsByTagName('head')[0].appendChild(widget._styleTag);
        var utils = optimizely.get('utils');
var $ = window.jQuery || window.optimizely.get('jquery');

utils.waitForElement(extension.selector).then(function(elem) {
  var isPlaying = true;  // Start as playing
  var index = 0;         // Track the current image index
  var timerId;           // To hold the reference to the setTimeout
  
  // Preload images
  var images = extension.images.split(',');
  var preloadedImages = [];
  for (var i = 0; i < images.length; i++) {
    preloadedImages[i] = new Image();
    preloadedImages[i].src = images[i];
  }
  
  // Function to display the next image
  function showNextImage() {
    if (isPlaying) {  // Only show the next image if it's playing
      $(extension.selector).css('background-image', 'url(' + preloadedImages[index].src + ')');
      index = index === images.length - 1 ? 0 : index + 1; // Cycle through images
      timerId = setTimeout(showNextImage, extension.speed); // Call recursively
    }
  }

  // Function to pause the slideshow
  function pauseSlideshow() {
    isPlaying = false;
    clearTimeout(timerId);  // Clear the current timeout to pause
  }

  // Function to resume the slideshow
  function resumeSlideshow() {
    if (!isPlaying) {
      isPlaying = true;
      showNextImage();  // Start the slideshow again
    }
  }

  // Toggle Play/Pause Icons
  function togglePlayPause() {
    if (isPlaying) {
      $(".pause").attr("style", "display:none");
      $(".play").attr("style", "display:flex");
      $(".play").attr("attr", "Animation is playing");
      pauseSlideshow();  // Pause the slideshow
    } else {
      $(".play").attr("style", "display:none");
      $(".pause").attr("style", "display:flex");
           $(".play").attr("attr", "Animation is paused");

      resumeSlideshow();  // Resume the slideshow
    }
  }

  // Wait for the button-box element to set up the play/pause functionality
  utils.waitForElement(".button-box").then(function(){
    // Mouse click event for play/pause
    $(".button-box").click(function(e) {
      e.preventDefault(); 
      e.stopImmediatePropagation();
      togglePlayPause();  // Toggle play/pause when button is clicked
    });

    // Keyboard event for play/pause (for ADA compliance)
    $(".button-box").keydown(function(e) {
      if (e.key === "Enter" || e.key === " ") {  // Check for Enter or Space key press
        e.preventDefault();  // Prevent default action
        togglePlayPause();   // Toggle play/pause when Enter or Space is pressed
      }
    });

    // Ensure the button is focusable via keyboard (if not a native button element)
    //$(".button-box").attr('tabindex', '0');  // Make it focusable
    $(".button-box").attr('role', 'button'); // Assign an ARIA role to improve screen reader accessibility
  });

  // Start the slideshow when the element is available
  showNextImage();

  // Prepend the extension HTML to the body
  utils.waitForElement(extension.buttonPlacement).then(function(elem) {
    elem.insertAdjacentHTML(extension.location, extension.$html);
  });
});

      },
      hideFn: function(event) {
        var $ = window.optimizely.get('jquery');
        var widget = event.data.config;
        widget.$id = "5685106466619392";
        widget.$instance = event.data.id;
        widget.$fieldDefaults = [{"name":"images","default_value":"/~/media/Images/hp-merch/2023/Extras/ctile/jubilee.jpg,/~/media/Images/hp-merch/2023/Extras/ctile/celebration.jpg,/~/media/Images/hp-merch/2023/Extras/ctile/venezia.jpg,/~/media/Images/hp-merch/2023/Extras/ctile/mardi-gras.jpg"},{"name":"speed","default_value":"1500"},{"name":"selector","default_value":".hero-header"},{"name":"location","default_value":"beforebegin"},{"name":"buttonPlacement","default_value":""}];
        (function(widg) {
  var i = 0;
  var field;
  for (; i < widg.$fieldDefaults.length; ++i) {
    field = widg.$fieldDefaults[i];
    if (!widg.hasOwnProperty(field.name)) {
      widg[field.name] = field.default_value;
    }
  }
  })(widget);
        var extension = widget;
        widget._styleTag = document.getElementById('widget-css-5685106466619392');
if (widget._styleTag) widget._styleTag.parentNode.removeChild(widget._styleTag);
        var extensionElement = document.getElementById('optimizely-extension-' + extension.$instance);
if (extensionElement) {
  extensionElement.parentElement.removeChild(extensionElement);
}

      },
    });
}
], "interestGroups": [{"id": "364", "keywords": ["couple", "romantic"], "tagGroupId": "202", "available": true}, {"id": "469", "keywords": ["aquaventure", "dolphin", "dolphins", "lion", "scuba", "snorkel", "snorkeling", "snuba", "stingray", "swim", "turtle", "turtles"], "tagGroupId": "202", "available": true}, {"id": "470", "keywords": ["cash"], "tagGroupId": "202", "available": true}, {"id": "642", "keywords": ["birthday"], "tagGroupId": "202", "available": true}], "tagGroups": [{"id": "202", "tags": [{"viewId": "15110660698", "tagApiName": "shore_excursion__vibe"}]}]},f=__webpack_require__(1327),l="initializeOptimizelyPreview";if(f.initGlobalStore(s),u.populateDirectiveData(),r.clientHasAlreadyInitialized())e.warn("Main / Disabling because Optimizely has already initialized on this page load. Are there multiple snippets on the page?");else if(r.shouldBailForDesktopApp())e.log("Main / Disabling because of desktop app.");else if(r.conflictInObservingChanges())e.log("Main / Disabling: Observe Changes Indefinitely is on, but browser does not support it.");else{if(r.shouldLoadInnie())a.registerFunction("getProjectId",(function(){return s.projectId})),a.registerFunction("getAccountId",(function(){return s.accountId})),c.addScriptAsync("https://app.optimizely.com/js/innie.js"),e.log("Main / Disabling in favor of the editor client.");else if(r.shouldLoadPreview())(r.isSlave()?window.optimizely:window.optimizely=window.optimizely||[]).push({type:"load",data:s}),e.log("Main / Disabling in favor of the preview client."),__webpack_require__(3154).setupPreviewGlobal(),__webpack_require__(3154).pushToPreviewGlobal({type:"pushPreviewData",name:"liveCommitData",data:s}),r.isSlave()||(a.registerFunction("getProjectId",(function(){return s.projectId})),c.addScriptSync("https://cdn-assets-prod.s3.amazonaws.com/public/752671897/s/homepage_nbg_bg/preview.js"));else if(r.shouldBootstrapDataForPreview()){a.registerFunction(l,(function(n){t(),a.unregisterFunction(l)}));var d=r.isSlave()?PROJECT_ID_FOR_SLAVE_PREVIEW:a.getFunction("getProjectId")();v=r.getProjectToken(),h=d,p=r.getPreviewLayerIds(),o="/dist/preview_data.js?token=__TOKEN__&preview_layer_ids=__PREVIEW_LAYER_IDS__".replace("__TOKEN__",v).replace("__PROJECT_ID__",h).replace("__PREVIEW_LAYER_IDS__",p.join(",")).replace("__GET_ONLY_PREVIEW_LAYERS__",!0),c.addScriptSync(o),__webpack_require__(3154).setupPreviewGlobal(),c.addScriptAsync("/dist/js/preview_ui.js")}else r.shouldBootstrapDataForEditor()?(a.registerFunction(l,(function(n){t(),a.unregisterFunction(l)})),c.addScriptAsync(window.optimizely_editor_data_endpoint)):r.shouldInitialize()&&t();var v,h,p;n.timeEnd("block");var g=n.now();n.setMark("optimizelyFinished",g,g)}}()}catch(t){try{__webpack_require__(371).handleError(t)}catch(n){console.log(n)}}}()})();
</script>

</body>
</html>
