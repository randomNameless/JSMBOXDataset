<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>9800.d752b49f53e52267fd30.html</title>
</head>
<body>

<script>
(self.webpackChunk_cleverpush_cleverpush_js_sdk=self.webpackChunk_cleverpush_cleverpush_js_sdk||[]).push([[9800],{9800:function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{autoAssignTagMatches:function(){return autoAssignTagMatches},checkTags:function(){return checkTags},initTags:function(){return initTags},tagSubscription:function(){return tagSubscription},untagSubscription:function(){return untagSubscription}});var _babel_runtime_helpers_toConsumableArray__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(8927),_babel_runtime_helpers_typeof__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(484),_const_event__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(2034),_debug__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(1078),autoAssignTagMatches=function autoAssignTagMatches(tag,pathname,callback){if(tag.autoAssignPath){var path=tag.autoAssignPath;if("[EMPTY]"===path&&(path=""),!new RegExp(path).test(pathname))return;if(!tag.autoAssignFunction&&!tag.autoAssignSelector)return callback(!0)}if(tag.autoAssignFunction)try{if(tag.autoAssignCheckInterval&&!isNaN(tag.autoAssignCheckInterval)){var interval=setInterval((function(){try{var _matches=eval(tag.autoAssignFunction);if("object"===(0,_babel_runtime_helpers_typeof__WEBPACK_IMPORTED_MODULE_2__.Z)(_matches)&&_matches.then)try{_matches.then((function(){clearInterval(interval),callback(!0)}))}catch(t){}else _matches&&(clearInterval(interval),callback(!0))}catch(t){_debug__WEBPACK_IMPORTED_MODULE_1__.cM.debug(t)}}),tag.autoAssignCheckInterval);return null}var matches=eval(tag.autoAssignFunction);if("object"===(0,_babel_runtime_helpers_typeof__WEBPACK_IMPORTED_MODULE_2__.Z)(matches)&&matches.then){try{matches.then((function(){callback(!0)}))}catch(t){}return}return callback(!!matches)}catch(t){_debug__WEBPACK_IMPORTED_MODULE_1__.cM.debug(t)}if(tag.autoAssignSelector)try{for(var triggerElems=document.querySelectorAll(tag.autoAssignSelector),triggerElemIndex=0;triggerElemIndex<triggerElems.length;triggerElemIndex+=1){var triggerElem=triggerElems[triggerElemIndex];triggerElem&&triggerElem.addEventListener("click",(function(){callback(!0)}))}return null}catch(t){_debug__WEBPACK_IMPORTED_MODULE_1__.cM.debug(t)}return callback(!1)},checkTags=function(t,e,n,a,_){(0,_debug__WEBPACK_IMPORTED_MODULE_1__.tI)("checkTags"),t&&t.length&&"undefined"!=typeof localStorage&&t.forEach((function(t){try{autoAssignTagMatches(t,_,(function(e){if(e){var _,s=isNaN(t.autoAssignVisits)?0:t.autoAssignVisits,i="cleverpush-tag-autoAssignVisits-".concat(t._id),r=t.autoAssignSessionVisits?sessionStorage:localStorage,c=(new Date).toISOString().substr(0,10);t.autoAssignDays&&(_=new Date).setDate(_.getDate()-t.autoAssignDays);var o=r.getItem(i),g=0,u={};if(t.autoAssignDays)try{u=JSON.parse(o)||{},"object"!==(0,_babel_runtime_helpers_typeof__WEBPACK_IMPORTED_MODULE_2__.Z)(u)&&(u={}),Object.keys(u||{}).forEach((function(t){new Date(t)>=_?g+=u[t]||0:delete u[t]}))}catch(t){u={}}else"string"!=typeof o||isNaN(o)||(g=parseInt(o,10));var l=isNaN(t.autoAssignSessions)?0:t.autoAssignSessions,h="cleverpush-tag-autoAssignSessions-".concat(t._id),b="cleverpush-tag-autoAssignSessionsCounted-".concat(t._id),E=localStorage.getItem(h),p=0,f={};if(t.autoAssignDays)try{f=JSON.parse(E)||{},"object"!==(0,_babel_runtime_helpers_typeof__WEBPACK_IMPORTED_MODULE_2__.Z)(f)&&(f={}),Object.keys(f||{}).forEach((function(t){new Date(t)>=_?p+=f[t]||0:delete f[t]}))}catch(t){f={}}else"string"!=typeof E||isNaN(E)||(p=parseInt(E,10));p>=l?g>=s?!isNaN(t.autoAssignSeconds)&&t.autoAssignSeconds?setTimeout((function(){n(t._id)}),1e3*t.autoAssignSeconds):n(t._id):t.autoAssignDays?(u[c]||(u[c]=0),u[c]+=1,a().then((function(){localStorage.setItem(i,JSON.stringify(u))}))):(g+=1,a().then((function(){r.setItem(i,g.toString())}))):t.autoAssignDays?(u[c]||(u[c]=0),u[c]+=1,a().then((function(){localStorage.setItem(i,JSON.stringify(u))})),"true"!==sessionStorage.getItem(b)&&(f[c]||(f[c]=0),f[c]+=1,a().then((function(){sessionStorage.setItem(b,"true"),localStorage.setItem(h,JSON.stringify(f))})))):(g+=1,a().then((function(){r.setItem(i,g.toString())})),"true"!==sessionStorage.getItem(b)&&(p+=1,a().then((function(){sessionStorage.setItem(b,"true"),localStorage.setItem(h,p.toString())}))))}}))}catch(t){_debug__WEBPACK_IMPORTED_MODULE_1__.cM.debug("checkTags",null==t?void 0:t.message)}}))};function initTags(t){var e=function(){t.subscriptionManager.storageManager.getTags().then((function(e){var n=t.config.channelTags;checkTags(n,e,t.tagSubscription.bind(t),t.waitForSubscription.bind(t),location.pathname)}))};t.config.trackTagsOnlyWhenTopicEnabled&&t.config.trackTagsOnlyWhenTopicEnabledIds.length?t.subscriptionManager.storageManager.getTopics().then((function(n){t.config.trackTagsOnlyWhenTopicEnabledIds.every((function(t){return n.includes(t)}))?e():t.once(_const_event__WEBPACK_IMPORTED_MODULE_0__.Z.TOPICS_SET,(function(){return initTags(t)}))})):e()}function tagSubscription(t,e,n){(0,_debug__WEBPACK_IMPORTED_MODULE_1__.tI)("tagSubscription",e);var a="function"==typeof n?n:function(){};t.waitForInit().then((function(){t.subscriptionManager&&t.subscriptionManager.initialTags.push(e),t.waitForSubscription().then((function(n){e?t.subscriptionManager.storageManager.getTags().then((function(_){var s=t.subscriptionManager.storageManager.getTagDate(e);_.indexOf(e)<0||!s||s.getTime()<Date.now()-432e5?(t.subscriptionManager.storageManager.setTags([].concat((0,_babel_runtime_helpers_toConsumableArray__WEBPACK_IMPORTED_MODULE_3__.Z)(_),[e])),t.api.tagSubscription(n,e).then((function(e){t.trigger(_const_event__WEBPACK_IMPORTED_MODULE_0__.Z.TAGS_SET),a(e)})).catch(a)):_debug__WEBPACK_IMPORTED_MODULE_1__.cM.debug("tag is already in stored tags")})):_debug__WEBPACK_IMPORTED_MODULE_1__.cM.error("tag id not specified")}))}))}function untagSubscription(t,e,n){(0,_debug__WEBPACK_IMPORTED_MODULE_1__.tI)("untagSubscription",e);var a="function"==typeof n?n:function(){};t.waitForInit().then((function(){t.waitForSubscription().then((function(n){e?(t.subscriptionManager.storageManager.getTags().then((function(n){n.splice(n.indexOf(e),1),t.subscriptionManager.storageManager.setTags(n)})),t.api.untagSubscription(n,e).then((function(e){t.trigger(_const_event__WEBPACK_IMPORTED_MODULE_0__.Z.TAGS_SET),a(e)})).catch(a)):_debug__WEBPACK_IMPORTED_MODULE_1__.cM.error("tag id not specified")}))}))}}}]);
//# sourceMappingURL=9800.d752b49f53e52267fd30.js.map
</script>

</body>
</html>
