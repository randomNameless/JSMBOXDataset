<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>_app-f109592cf515eca7.html</title>
</head>
<body>

<script>
(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[888],{6840:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/_app",function(){return n(9212)}])},5176:function(e,t,n){"use strict";let r;n.d(t,{Z:function(){return g},u:function(){return d}});var a=n(5893),s=n(278),o=n(7294),l=n(1163);let i=new AbortController,u={messages:[],addMessage:()=>{},clearConversation:()=>{},loadConversation:()=>{},toggleMessageRole:e=>{},loading:!0,error:"",controller:new AbortController,website_lang:"en"},c=o.createContext(u);function g(e){let{children:t,referrerWebsite:n}=e,u=()=>new Date().toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}),g="أهلاً بكم في الموقع الرسمي لوزارة التربية والتعليم والتعليم العالي. اسمي طالب اعمل بتقنية الذكاء الاصطناعي وانا هنا للرد على أية استفسارات. ما هو سؤالك؟",d="Welcome to the official website of the Ministry of Education and Higher Education. My name is Talib, I am powered by artificial intelligence technology, and I am here to answer any questions you may have. How can I help you today?",f=(0,l.useRouter)(),[h,m]=o.useState("en");(0,o.useEffect)(()=>{let e=Array.isArray(f.query.lang)?f.query.lang[0]:f.query.lang||"en";m(e)},[f.isReady]);let[p,y]=o.useState(!1),[w,_]=o.useState([{id:0,role:"assistant",content:"ar"==h?g:d,references:[],adaptive_cards:[],timestamp:"00:00",lang:h}]),b=(0,o.useCallback)(()=>{1!==w.length&&((0,s.ll)({name:"conversation",messages:w}),"/"===f.pathname&&f.push("/chat/CurrentChat"))},[w]);(0,o.useEffect)(()=>{b()},[w]),(0,o.useEffect)(()=>{_([{id:0,role:"assistant",content:"ar"==h?g:d,references:[],adaptive_cards:[],timestamp:"00:00",lang:h}])},[h]);let v=e=>{let{messages:t}=e;_(t)},C=()=>{p||(r="",_([{id:0,role:"assistant",content:"ar"==h?g:d,references:[],adaptive_cards:[],timestamp:"00:00",lang:h}]))},S=async(e,t,n,r)=>{let a=[];n&&(a=Object.entries(n).map(e=>{let[t,n]=e;return{label:t,url:n}})),r&&(r=Object.values(r)),console.log(r);for(let n=0;n<e.length;n++){if(i.signal.aborted){y(!1);return}await new Promise(e=>setTimeout(e,4)),_(s=>{let o=[...s];return o[s.length-1].content=e.substring(0,n+1),o[s.length-1].references=a,o[s.length-1].adaptive_cards=r||[],o[s.length-1].timestamp=u(),o[s.length-1].lang=t,o})}y(!1)},E=(0,o.useCallback)(async e=>{if(p)return;y(!0),_(e=>(t.id=e.length,[...e,t]));let t={id:w.length,role:"assistant",content:""};try{i=new AbortController;let t=await fetch("https://moehe-apim-hub.edu.gov.qa/prodapi/BotQnAHTTPFunc",{signal:i.signal,method:"POST",body:JSON.stringify({query:e,...r&&{session_id:r},website:n})}),a=JSON.parse(await t.text());a.answer=a.answer.replace(/\n\n/g,"\n"),r=a.session_id,console.log("RESPONSE IS:",a),S(a.answer,a.lang,a.links,a.adaptive_cards)}catch(e){void 0===e.name?_(e=>{let t=[...e];return t[e.length-1].content="ar"==h?"يبدو أنك غيرت رأيك ... ما الذي يمكنني مساعدتك به أيضا؟":"It seems like you have changed your mind... What else may I help you with?",t}):_(e=>{let t=[...e];return t[e.length-1].content="ar"==h?"عذرا، حدث خطأ. يرجى إعادة المحاولة لاحقا...":"Sorry, an error occured. Please try again later...",t}),console.log(e.message),y(!1)}},[w,p,i,n]),N=(0,o.useCallback)(function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";_(t=>{let n=[...t,{id:t.length,role:"user",content:e,timestamp:u(),lang:"en"}];return n}),E(e)},[E]),O=o.useMemo(()=>({messages:w,loading:p,addMessage:N,loadConversation:v,clearConversation:C,submit:E,controller:i,website_lang:h}),[w,p,N,E,C,i,h]);return(0,a.jsx)(c.Provider,{value:O,children:t})}let d=()=>o.useContext(c)},9212:function(e,t,n){"use strict";n.r(t);var r=n(5893);n(7952),n(860);var a=n(5176),s=n(7294);t.default=function(e){let{Component:t,pageProps:n}=e,[o,l]=(0,s.useState)("");return(0,s.useEffect)(()=>{let e=document.referrer,t=e.replace(/^(https?:\/\/)?/,"").replace(/\./g,"").replace(/\/.*/,"");l(t)},[]),(0,r.jsx)(a.Z,{referrerWebsite:o,children:(0,r.jsx)(t,{...n})})}},278:function(e,t,n){"use strict";n.d(t,{cc:function(){return s},ll:function(){return a}});let r="pg-history",a=e=>{localStorage.setItem(r,JSON.stringify({CurrentChat:e}))},s=e=>{let t=o();return t[e]},o=()=>{let e=localStorage.getItem(r);return e?JSON.parse(e):{}}},860:function(){},7952:function(){},1163:function(e,t,n){e.exports=n(6885)}},function(e){var t=function(t){return e(e.s=t)};e.O(0,[774,179],function(){return t(6840),t(6885)}),_N_E=e.O()}]);
</script>

</body>
</html>
