<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>atjs-integration.min.html</title>
</head>
<body>

<script>
window.CQ_Analytics||(window.CQ_Analytics={});
(function(y,n){n.mboxes=n.mboxes||[];var m=function(p,g){function l(a){z&&console.log(a)}function A(a){try{var c=p.ajax;try{0===a.indexOf("/")&&r&&0!==a.indexOf(r+"/")&&(a=r+a)}catch(d){}var b=c.call(p,{type:"GET",url:a,async:!1,externalize:!1,encodePath:!1,hook:!1});return b?b:null}catch(d){return null}}function t(){var a=CQ.shared.HTTP.getPath(top.document.location.href),c=navigator?navigator.userAgent.toLowerCase():"other";if(0<c.indexOf("trident/")){var b=c.indexOf("rv:");if("11"==parseInt(c.substring(b+
3,c.indexOf(".",b)),10))return-1<a.indexOf("/editor.html/")}return a.includes("/editor.html/")}function B(a){var c=CQ.shared.HTTP.getParameter(document.location.href,"wcmmode");t()&&(c="disabled");c&&0<c.length&&(a=CQ.shared.HTTP.addParameter(a,"wcmmode",c));return a}function u(a,c){a=B(a);var b=(a=A(window.targetGlobalSettings.currentPagePath+".targetoffer.html"+a))&&a.responseText&&0<a.responseText.length;if(a&&a.status&&200===a.status&&b){b=document.getElementById(c);var d=!1;if(b){for(;b.firstChild;)b.removeChild(b.firstChild);
d=b.getElementsByTagName("div");1===d.length&&(b=d[0]);d=document.createElement("div");d.innerHTML=a.responseText;b.appendChild(d);d=b.getElementsByTagName("script");for(var f=0;f<d.length;f++)eval(d[f].text);d=!0;if(b=b.parentElement)f=document.createEvent("CustomEvent"),f.initEvent("target-dom-loaded",!0,!1),f.mboxName=c,b.dispatchEvent(f)}d||document.write(a.responseText)}}function q(){for(var a=0;a<g.mboxes.length;a++){var c={};Array.isArray(g.mboxes[a].staticParameters)&&g.mboxes[a].staticParameters.map(function(h,
v){h=h.split("\x3d");2===h.length&&(c[h[0]]=h[1])});for(var b=0;b<CQ_Analytics.mboxes[a].mappings.length;b++){var d="",f=CQ_Analytics.mboxes[a].mappings[b].param,k="/"+g.mboxes[a].mappings[b].ccKey.replace(".","/");-1<g.mboxes[a].isProfile.indexOf(f)&&(d="profile.");k=g.DataProvider.replaceVariables(C(k));c[d+f]="undefined"!==typeof k?k:""}g.mboxes[a].includeResolvedSegments&&g.SegmentMgr&&0<g.SegmentMgr.getResolved().length&&(c["profile._cq_.resolvedSegments"]="|"+g.SegmentMgr.getResolved().join("|")+
"|");(function(h,v){setTimeout(function(){CQ_Analytics.TestTarget.updateMboxContent(h,v)},0<a?100:0)})(g.mboxes[a].name,c)}}function C(a){var c=void 0;(a=window.ContextHub?ContextHub.get(a):g.ClientContext.get(a))&&(Array.isArray(a)?c=a.join(","):"object"!==typeof a&&(c=a));return c}function w(){var a=[];if(window.CQ_Analytics&&window.CQ_Analytics.TestTarget&&window.CQ_Analytics.TestTarget.mappings)for(var c in window.CQ_Analytics.TestTarget.mappings)a.push(c);return a}function D(){if("undefined"!==
typeof CQ&&CQ.WCM&&CQ.utils&&CQ.utils.WCM)return CQ.WCM.isPreviewMode()||CQ.utils.WCM.isEditMode();var a=(document.cookie||"").split(/;\s*/).reduce(function(c,b){(b=b.match(/([^=]+)=(.*)/))&&(c[b[1]]=unescape(b[2]));return c},{});return"undefined"===typeof a.wcmmode||"preview"===a.wcmmode||"edit"===a.wcmmode}function x(){var a=document.querySelector('[class*\x3d"aem-AuthorLayer"]');return a?a.className.match("aem-AuthorLayer-[^ ]+")[0]:null}var E=/^(?:http|https):\/\/[^/]+(\/.*)\/(?:etc\.clientlibs|etc(\/.*)*\/clientlibs|libs(\/.*)*\/clientlibs|apps(\/.*)*\/clientlibs|etc\/designs).*\.js(\?.*)?$/,
e={};if(this.constructor===m.prototype)throw"This is a singleton!";if(m.instance)return m.instance;m.instance=e;var z=-1!==window.location.href.indexOf("debug-mbox-calls\x3d1"),r=function(){try{if(window.CQURLInfo)return CQURLInfo.contextPath||"";for(var a=document.getElementsByTagName("script"),c=0;c<a.length;c++){var b=E.exec(a[c].src);if(b)return b[1]}}catch(d){}return""}();e.registeredCHListeners={};e.usedStoresLoaded=!1;e.defaults={};e.mappings=[];e.maxProfileParams=200;e.pull=function(a,c,b){"undefined"===
typeof b&&(a=a.replace(/(\/content\/campaigns\/.*?)\/(.*)/,"$1/master/$2"));u(a,c)};e.displayOffer=function(a,c){adobe.target.getOffer({mbox:a,params:c,success:function(b){adobe.target.applyOffer({mbox:a,selector:"#"+a,offer:b})},error:function(b,d){console.error(b,d);p("#"+a).css("visibility","visible")}})};e.updateMboxContent=function(a,c){l("Updating content for mbox "+a);if(t()){var b=x();b?"aem-AuthorLayer-Edit"===b?e.signalDefaultOffer(a):e.displayOffer(a,c):setTimeout(function(){e.updateMboxContent(a,
c)},100)}else e.displayOffer(a,c)};e.registerMboxUpdateCalls=function(){"undefined"!==typeof window.CQ_Analytics&&window.CQ_Analytics.TestTarget.mappings&&(l("[Target][init] Registering Mbox update calls"),0<w().length?e.registerContextHubListeners():q())};e.registerContextHubListeners=function(){if(window.ContextHub){for(var a=w(),c=[],b=0;b<a.length;b++){var d=a[b],f=d.split(".")[0];d="/"+d.replace(".","/");ContextHub.get(f)&&!e.registeredCHListeners[f]&&(e.registeredCHListeners[f]=!0,c.push(d),
l("[Target][CH] - Listening for updates on "+d+" CH"))}0<c.length&&ContextHub.bind(c,function(k){l("[Target][CH][registerContextHubListeners] All properties available, triggering update!");q();e.usedStoresLoaded=!0},function(k){l("[Target][CH][registerContextHubListeners] Not all properties available, triggering update!");e.usedStoresLoaded||q()},500)}};e.addMbox=function(a){var c=!1,b=!1;CQ_Analytics.mboxes||(CQ_Analytics.mboxes=[]);for(var d=0;d<CQ_Analytics.mboxes.length;d++){var f=CQ_Analytics.mboxes[d];
if(f.id===a.id){CQ_Analytics.mboxes.splice(d,1);c=!0;b=f.defined;break}}a.defined=b;g.mboxes.push(a);a=a.mappings;for(b=0;b<a.length;b++)d=a[b].ccKey,e.mappings[d]||(e.mappings[d]={});return c};e.triggerUpdate=function(a){"undefined"===typeof a&&(a=500);e.reloadRequested||(e.reloadRequested=!0,setTimeout(function(){var c=x();("aem-AuthorLayer-Edit"===c||"aem-AuthorLayer-Preview"===c||D())&&q();e.reloadRequested=!1},a))};e.signalDefaultOffer=function(a){"undefined"===typeof e.defaults[a]?console&&
console.log("The default offer path was not found in the internal map for mbox "+a):(u(e.defaults[a],a),p("#"+a).css("visibility","visible"))};return e};n.TestTarget=m(y,n);top.$(top.document).on("editor-frame-mode-changed",function(){CQ_Analytics&&CQ_Analytics.TestTarget&&CQ_Analytics.TestTarget.triggerUpdate()})})($,window.CQ_Analytics);
</script>

</body>
</html>
