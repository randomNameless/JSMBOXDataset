<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ot2.min.html</title>
</head>
<body>

<script>
var $ci360;
(function(m){var q=function(){function f(){}f._keyStr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789.-=";f.encode=function(a){for(var c="",b,d,g,e,h,k=0,l=f._utf8_encode(a);k<l.length;)b=l.charCodeAt(k++),a=l.charCodeAt(k++),d=l.charCodeAt(k++),g=b>>2,b=(b&3)<<4|a>>4,e=(a&15)<<2|d>>6,h=d&63,isNaN(a)?e=h=64:isNaN(d)&&(h=64),c=c+f._keyStr.charAt(g)+f._keyStr.charAt(b)+f._keyStr.charAt(e)+f._keyStr.charAt(h);return c};f._utf8_encode=function(a){a=a.replace(/\r\n/g,"\n");for(var c="",
b=0;b<a.length;b++){var d=a.charCodeAt(b);128>d?c+=String.fromCharCode(d):(127<d&&2048>d?c+=String.fromCharCode(d>>6|192):(c+=String.fromCharCode(d>>12|224),c+=String.fromCharCode(d>>6&63|128)),c+=String.fromCharCode(d&63|128))}return c};return f}();m.Base64=q})($ci360||($ci360={}));
(function(m){var q=function(){function f(a,c,b,d,g,e){this.configService=a;this.persistenceService=c;this.networkService=b;this.paramService=d;this.spotService=g;this.util=e}f.prototype.send=function(a,c){var b=this;void 0===c&&(c=!0);this.persistenceService.registerActivity();var d;a.hasOwnProperty("eventName")&&(d=a.eventName);var g=new m.CI360EventObj(d);this.addFieldsToEvent(g,a);this.decorateEvent(g);if(a=this.paramService.validateEvent(g))this.paramService.obfuscateFields(g),g.paramMap.delete("obfuscateFields"),
this.paramService.mapTransportNames(g),this.sendEvent(g,c),"identity"==d&&setTimeout(function(){return b.configService.retrieveDid()},f.RT_DID_TO);return a};f.prototype.addFieldsToEvent=function(a,c){"submit"===a.paramMap.get("eventName")&&this.paramService.submitEventHandling(a,c);"change"===a.paramMap.get("eventName")&&this.paramService.changeEventHandling(a,c);"cart"===a.paramMap.get("eventName")&&this.paramService.cartEventHandling(a,c);"load"===a.paramMap.get("eventName")&&this.networkService.setCachedLoadEvent(a);
for(var b in c)c.hasOwnProperty(b)&&"items"!==b&&a.paramMap.set(b,c[b])};f.prototype.sendEvent=function(a,c){c&&a.paramMap.set("initiator","api");a.paramMap.set("event_guid",this.networkService.getRandomGuid());"impression_viewable"===a.paramMap.get("eventName")?a.paramMap.set("event","spot_viewable"):a.paramMap.set("event",a.paramMap.get("eventName"));a.paramMap.set("eventname",a.paramMap.get("eventName"));this.networkService.pushEvent(a)};f.prototype.decorateEvent=function(a){var c=this.configService.getConfig();
a.paramMap.set("tab_id",this.persistenceService.getTabId());a.paramMap.set("hb",this.persistenceService.getSidArray()[2]);var b={ccs:"ccs",csu:"csu",datahubId:"datahub_id",vid:"visitor",sid:"session"},d;for(d in b)a.paramMap.set(b[d],c[d]);"load"!=a.paramMap.get("eventName")&&a.paramMap.set("load_id",this.networkService.getLoadId());this.spotService.decorateEvent(a);this.paramService.addDefaultFields(a)};f.RT_DID_TO=1500;return f}();m.EventService=q})($ci360||($ci360={}));
(function(m){var q=function(){function f(){this.readyCallbacks=[];this.isReady=!1;this.initError=null;this.initStarted=!1;this.services=[];this.efname="ci360";this.lazyInit=!1}f.prototype.updateExposedFunction=function(){var a=this,c=this.ef&&this.ef.q,b=window[this.efname]=function(){for(var b=[],c=0;c<arguments.length;c++)b[c]=arguments[c];return a.api[b[0]]?a.api[b[0]](b[1],b[2]):"Not able to perform "+b[0]+" on ci360()"};if(c){for(var d=0;d<c.length;d++)b.apply(void 0,c[d]);c.length=0}};f.prototype.notifyReady=
function(){this.isReady=!0;for(var a=0,c=this.readyCallbacks;a<c.length;a++)(0,c[a])(this.initError);this.readyCallbacks.length=0};f.prototype.notifyError=function(a){this.initError=a;this.notifyReady()};f.prototype.addReadyCallback=function(a){this.isReady?a(this.initError):this.readyCallbacks.push(a)};f.prototype.done=function(a){var c=this;null==a?0<this.services.length?this.services.shift().init(function(a){return c.done(a)}):this.notifyReady():this.notifyError(a)};f.prototype.require=function(){for(var a=
[],c=0;c<arguments.length;c++)a[c]=arguments[c];if(!this.initStarted&&a)for(c=0;c<a.length;c++)this.services.push(a[c])};f.prototype.initialize=function(){this.initStarted||this.lazyInit||(this.initStarted=!0,this.done())};f.prototype.createApi=function(a,c,b,d){var g=this;this.api={ready:function(a){g.addReadyCallback(a)},send:function(a){return b.send(a)},detachIdentity:function(){return a.detachIdentity()},detachIdentityCrossChannel:function(){return a.detachIdentity(!0)},attachIdentity:function(b){return a.attachIdentity(b)},
attachIdentityBlocking:function(b){return a.attachIdentityBlocking(b)},trace:function(b){return a.trace(b)},info:function(){var b={},d=a.getConfig();b.datahubId=a.getDatahubId();b.vid=d.vid;b.sid=d.sid;b.loadId=a.getLoadId();m.exposeParamsMetadata=!0;m.exposeParamsMetadata&&(b.params_metadata=c.getParamsMetadata());return b},getCreatives:function(a,b){return d.getCreatives(a,!0,b)},getPersonalizedCreative:function(a,b){return d.getPersonalizedCreative(a,b)},getSpotDefinitions:function(a,b){return d.getSpotDefinitions(a,
b)},init:function(){g.initialize()}}};f.prototype.getEnvironmentAttributes=function(){var a=this;if(null==this.envAttrs){this.envAttrs={};var c=document.getElementById("ob-script-async");if(null!=c){this.efname=c.dataset.efname||this.efname;var b=(this.ef=window[this.efname])&&this.ef.a&&JSON.parse(JSON.stringify(this.ef.a))||{},d=c.getAttribute("src"),g=document.createElement("a");g.href=d;this.envAttrs.protocol=g.protocol;this.envAttrs.hostname=g.hostname;this.envAttrs.port=g.port;this.envAttrs.extTenantId=
b.tenantId&&b.tenantId.trim()||c.getAttribute("a")&&c.getAttribute("a").trim()||c.getAttribute("data-a")&&c.getAttribute("data-a").trim();this.envAttrs.extTenantId||(c=this.ef&&this.ef.q)&&0<c.length&&"settings"===c[0][0]&&(b=c.shift()[1],this.envAttrs.extTenantId=b.tenantId&&b.tenantId.trim());if(this.envAttrs.extTenantId)this.envAttrs.hiddenClass=b.hiddenClass,this.envAttrs.sendMode=b.sendMode,this.envAttrs.overrideDomain=b.overrideDomain,b.identity&&(this.envAttrs.identityType=b.identity.type,
this.envAttrs.identitySource=b.identity.source||"cookie",this.envAttrs.identityName=b.identity.name,this.envAttrs.identityObscure=b.identity.obscure||!1),b.trace&&(this.envAttrs.traceDoamins=b.trace.domains);else throw Error("TenantId missing.");this.readyCallbacks.push(function(){return a.updateExposedFunction()})}}return this.envAttrs};f.prototype.setLazyInit=function(a){void 0===a&&(a=!1);if(this.lazyInit=a){var c=this;this.ef&&this.ef.q&&Object.defineProperty(this.ef.q,"push",{enumerable:!1,configurable:!1,
writable:!1,value:function(a){0<a.length&&"init"===a[0]?(c.lazyInit=!1,c.initialize()):this[this.length]=a;return this.length}})}};return f}();m.Bootstrap=q})($ci360||($ci360={}));
(function(m){var q=function(){function f(a){this.paramMap=new Map;this.obscureCount=0;null!=a&&this.paramMap.set("eventName",a)}f.prototype.populate=function(a){a=JSON.parse(a);for(var c in a)this.paramMap.set(c,a[c])};f.prototype.toJSONString=function(){return JSON.stringify(this)};f.prototype.toJSON=function(){var a={};this.paramMap.forEach(function(c,b){a[b]=c});return a};f.prototype.toURLEncoded=function(){var a="";this.paramMap.forEach(function(c,b){a+=encodeURIComponent(b)+"="+encodeURIComponent(c)+
"&"});return a.slice(0,a.length-1)};return f}();m.CI360EventObj=q})($ci360||($ci360={}));
(function(m){var q=function(){function f(a,c,b,d,g){var e=this;this.serverInfo={protocol:"",hostname:"",port:""};this.identityAtLoad=!1;this.traceDomains=[];this.config={vid:"",sid:"",timestamp:"",isNewVid:!1,isNewSid:!1,datahubId:"",uis:!1,loadId:"",ccs:"",csu:"",sdu:"",sld:"",e:void 0,f:void 0,s:void 0,c:void 0,t:{},l:void 0,ff:void 0};this.hiddenClass="sas-ci360-hidden";this.ciParam="_ci_";this.inDesignCenter=!1;this.identityLockTimeout=1E3;this.urlMaxSize=600;this.paramsMaxSize=850;this.traceForm=
function(a){try{if(a&&"FORM"==a.tagName.toUpperCase()&&a.action){var b=window.location,c=b.hostname||b.host,d=e.util.extractDomain(a.action);if(d&&-1<e.traceDomains.indexOf(d)&&c!=d){b=!1;c=0;for(var g=a.elements;c<g.length;c++)g[c].name==e.ciParam&&(b=!0);if(a.method)if("GET"!=a.method.toUpperCase()||b)"POST"==a.method.toUpperCase()&&(a.action=e.trace(a.action));else{var h=document.createElement("input");h.setAttribute("type","hidden");h.setAttribute("name",e.ciParam);h.setAttribute("value",e.cdtToken());
a.appendChild(h)}}}}catch(u){}};this.traceAnchor=function(a){try{var b=void 0;a:{for(var c=100;a&&0<c;){if(a.href&&a.nodeName.match(/^a(?:rea)?$/i)){b=a;break a}a=a.parentNode;c--}b=null}if(b){var d=window.location,g=d.hostname||d.host,h=b.host||b.hostname;if(h&&-1<e.traceDomains.indexOf(h)&&g!=h){var f=b.protocol,y=b.href;("http:"==f||"https:"==f)&&0>y.indexOf(e.ciParam)&&(b.href=e.trace(y))}}}catch(t){}};this.trace=function(a){return e.insertQueryParam(a,e.ciParam+"="+e.cdtToken())};this.insertQueryParam=
function(a,b){a=a.split("#");var c=a[0];a=a.slice(1);var d=c.split("?");c=d[0];d=d[1];b=(d=void 0===d?"":d)?"".concat(d,"&").concat(b):b;return"".concat(c,"?").concat(b).concat(0<a.length?"#".concat(a.join("#")):"")};this.cdtToken=function(){var a=e.persistenceService,b=a.getSidArray();return a.getVid()+"*"+b[0]+"*"+b[2]+"*"+e.paramService.getUsrAgent()+"*"+(new Date).getTime()+"*"+(screen.height||"1")+(screen.width||"1")};this.cdtInfo=function(a){try{var b=decodeURIComponent(a).split("*")||"";return(6==
b.length&&b[3]==e.paramService.getUsrAgent()&&parseInt(b[4])+15E4>(new Date).getTime()&&(screen.height||"1")+""+(screen.width||"1")==b[5]&&b[0]&&b[1]||4==b.length&&parseInt(b[3])+3E5>(new Date).getTime())&&{vid:b[0],sid:b[1],hb:b[2],ref:4==b.length?"1":"0"}||null}catch(l){return null}};this.cdtInfoPage=function(){var a=e.util.getUriInfo().cdt;return a&&e.cdtInfo(a)};this.updateNetworkService=!1;this.getExtTenantId=function(){return e.extTenantId};this.networkServiceObserver=function(){e.updateNetworkService=
!0};this.refreshConfig=function(a,b){e.networkService.setFirstLoad(!0);e.networkService.call(e.buildConfigURL(!0),function(c){e.configLoadCallback(c);b();a()})};this.getAttributeStore=function(a){if(a||void 0===e.cachedAttributeStore){a={};a.browser_language=navigator.language;var b=!1;if(navigator.plugins&&navigator.plugins.length){var c=navigator.plugins["Shockwave Flash"];c||(c=navigator.plugins["Shockwave Flash 2.0"]);c&&(b=!0)}a.flash_enabled=b.toString();a.character_set=document.characterSet;
a.event_channel="web";a.java_enabled=navigator.javaEnabled().toString();a.javascript_enabled="true";a.platform=navigator.platform;a.protocol=location.protocol.substr(0,location.protocol.length-1);return e.cachedAttributeStore=a}return e.cachedAttributeStore};this.handleConfig=function(a){var b=e.networkService;e.config.sid=a.sid||"";e.config.vid=a.vid||"";e.config.timestamp=a.timestamp||"";e.config.isNewSid=a.isNewSid||!1;e.config.isNewVid=a.isNewVid||!1;e.config.datahubId=a.datahubId||"";e.config.uis=
a.uis||!1;e.config.loadId=a.loadId||"";b.setFeatureFlags(e.config.ff);b.setLoadId(e.config.loadId);e.config.csu=a.csu||"";e.config.sld=a.sld||"";e.config.e=a.e;e.config.f=a.f;e.persistenceService.setSld(e.config.sld);b.setSessionId(e.config.sid);b.setClientBaseTimestamp((new Date).getTime());b.setServerTimestamp(parseInt(e.config.timestamp,10));e.config.s=a.s;e.config.c=a.c;e.config.t=a.t;e.config.l=a.l};this.getLoadId=function(){return e.networkService.getLoadId()};this.setCookies=function(a){var b=
e.persistenceService;b.setVid(a.vid);b.setSid(a.sid);b.setDid(a.datahubId)};this.configLoadCallback=function(a){a=JSON.parse(a);e.handleConfig(a);e.setCookies(a);e.traceDomains=(e.traceDomains||[]).concat(e.config.t&&e.config.t.d||[]);0<e.traceDomains.length&&(document.addEventListener("mousedown",function(a){e.traceAnchor(a.target||a.target||{})}),document.addEventListener("keyup",function(a){e.traceAnchor(a.target||a.target||{})}),document.addEventListener("submit",function(a){e.traceForm(a.target||
a.target||{})}));e.updateNetworkService?(e.updateNetworkService=!1,e.networkService.synthLoaded(!0),e.networkService.processEvents(!1)):e.networkService.processEvents();e.identityAtLoad?e.persistenceService.removeIdentityEvent():e.networkService.processIdentity(e.buildDatahubURL(),e.updateDid)};this.buildIdentity=function(a){var b=e.persistenceService,c=e.paramService,d=e.networkService,g=new m.CI360EventObj("identity"),h=e.getConfig(),f="Unable to populate loginId.",y=e.getConfig().timestamp||(new Date).getTime();
d.getLoadId()&&g.paramMap.set("load_id",d.getLoadId());g.paramMap.set("domain",d.getDomain());g.paramMap.set("timestamp",y.toString());g.paramMap.set("tab_id",b.getTabId());g.paramMap.set("hb",b.getSidArray()[2]);d={sid:"session",vid:"visitor"};for(var t in d)h[t]&&g.paramMap.set(d[t],h[t]);!a&&e.identityType&&e.identityName&&(a={url:function(){return e.util.extractParam(e.identityName,window.location.href)},jsvar:function(){return e.util.getJsVarValueSafe(e.identityName)},direct:function(){return e.identityName},
"default":function(){return b.getCookie(e.identityName)}},a={loginEventType:e.identityType,loginId:(a[e.identitySource]||a["default"])(),obfuscateFields:"["+(e.identityObscure&&'"loginId"'||'""')+"]"});return a&&a.loginId&&(c.addFieldsToEvent(g,a),c.validateEvent(g))?(f="success",c.obfuscateFields(g),c.mapTransportNames(g),g.paramMap.delete("eventName"),[g.toURLEncoded(),g.paramMap.get("login_event")+g.paramMap.get("login_event_type"),f]):[null,null,f]};this.retrieveDid=function(){e.networkService.call(e.buildDatahubURL(),
e.updateDid)};this.updateDid=function(a){null!=a&&/^([0-9]|[a-z]|[A-Z]|-){24,256}$/.test(a)&&(e.persistenceService.setDid(a),e.config.datahubId=a);e.unlockIdentity()};this.lockIdentity=function(){return e.networkService.setIdentityLock()};this.unlockIdentity=function(a){void 0===a&&(a=!0);var b=e.networkService;b.identityLock&&(a&&b.resolveBlockingIdentity(),b.setIdentityLock(!1),b.processEvents())};this.getDatahubId=function(){return e.persistenceService.getDid()||e.config.datahubId};this.persistenceService=
a;this.networkService=c;this.paramService=b;this.util=d;this.isOt2=g;this.networkService.addObserver(this.networkServiceObserver)}f.prototype.getHiddenClass=function(){return this.hiddenClass};f.prototype.getSendMode=function(){return this.sendMode};f.prototype.getThresholds=function(){return this.config.s?this.config.s:[]};f.prototype.checkForDesignCenter=function(){var a=this;if(0==window.frames.name.indexOf("inlineBrowserIFrame-")){this.inDesignCenter=!0;var c=this.serverInfo,b=c.protocol,d=c.hostname,
g=c.port;g=g?":"+g:"";this.addScript(b+"//"+d+g+"/js/jquery.min.js","uisupport_jquery");setTimeout(function(){a.addScript(b+"//"+d+g+"/js/content.js","uisupport_content")},500)}};f.prototype.addScript=function(a,c){var b=document;if(!b.getElementById(c)){var d=b.getElementsByTagName("script")[0];b=b.createElement("script");b.async=!0;b.src=a;c&&(b.id=c);d.parentNode.insertBefore(b,d)}};f.prototype.getFormConfig=function(){this.config&&this.config.f&&(this.config.f.ign&&this.config.f.ign.n&&"ign"===
this.config.f.ign.n?this.config.f.n="ign":this.config.f.inc&&this.config.f.inc.n&&"inc"===this.config.f.inc.n&&(this.config.f.n="inc"));return this.config.f};f.prototype.setEnvironmentAttributes=function(a){void 0===a&&(a={});var c=this.networkService;this.serverInfo.protocol=a.protocol||"";this.serverInfo.hostname=a.hostname||"";this.serverInfo.port=a.port||"";this.extTenantId=a.extTenantId||"";c.setExtTenantId(this.extTenantId);this.paramService.setExtTenantId(this.extTenantId);this.persistenceService.setExtTenantId(this.extTenantId);
this.identityType=a.identityType||"";this.identityName=a.identityName||"";this.identitySource=a.identitySource||"";this.identityObscure=a.identityObscure||!1;this.traceDomains=a.traceDoamins||[];c.setOverrideDomain(a.overrideDomain);this.config.ccs=this.serverInfo.protocol+"//"+this.serverInfo.hostname+":"+this.serverInfo.port+"/t/e/"+this.extTenantId;c.setCcs(this.config.ccs);this.config.sdu=this.serverInfo.protocol+"//"+this.serverInfo.hostname+":"+this.serverInfo.port+"/t/s/p/"+this.extTenantId;
a.hiddenClass&&(this.hiddenClass=a.hiddenClass);a.sendMode&&c.setSendMode(a.sendMode)};f.prototype.buildConfigURL=function(a){void 0===a&&(a=!1);var c=this.getAttributeStore(),b=this.persistenceService,d="".concat(this.serverInfo.protocol,"//").concat(this.serverInfo.hostname,":").concat(this.serverInfo.port,"/t/s/c/").concat(this.extTenantId),g="domain=".concat(this.networkService.getDomain()),e=this.cdtInfoPage(),h="";if(e&&e.vid&&e.sid){var k=e.vid;var l=e.sid;var v=e.hb||0;h="&cdt=o&cdtref="+
e.ref}else k=b.getVid(),v=b.getSidArray(),l=v[0],v=v[2];k=k?"&vid=".concat(k):"";l=l?"&sid=".concat(l,"&hb=").concat(v):"";v="";a||(v=(v=(v=window.com_sas_ci_acs)&&v.ob_configure&&v.ob_configure.getLoadId())?"&loadId=".concat(v):"");var p=this.util.getUriInfo();a="&p=".concat(encodeURIComponent(p.path));e="&params=".concat(encodeURIComponent(p.search?p.search.substring(0,this.paramsMaxSize):""));var f="&page_title=".concat(encodeURIComponent(document.title)),u="&referrer=".concat(encodeURIComponent(document.referrer?
document.referrer.substring(0,this.urlMaxSize):"")),y="&uri=".concat(encodeURIComponent(document.URL?document.URL.substring(0,this.urlMaxSize):"")),t=new Date,r="&cts=".concat(t.getTime());t="&tzo=".concat(t.getTimezoneOffset());var w="&platform=".concat(navigator.platform),A="&port=".concat(location.port);p="&protocol=".concat(p.protocol);var D="&screen_info=".concat(screen.width,"x").concat(screen.height,"@").concat(screen.colorDepth),m="&browser_language=".concat(c.browser_language),x="&character_set=".concat(c.character_set),
q="&csz=".concat(document.documentElement.outerHTML.length),C="&bsz=".concat(window.innerWidth,"x").concat(window.innerHeight);b="&tab_id=".concat(b.getTabId());var E="&java_enabled=".concat(c.java_enabled);c="&flash_enabled=".concat(c.flash_enabled);var B="";this.isOt2&&(B="&init=ot2&version=2.1");var J=this.inDesignCenter?"&swm=1":"";return"".concat(d,"?").concat(g).concat(h).concat(k).concat(l).concat(v).concat(a).concat(e).concat(f).concat(u).concat(y).concat(r).concat(t).concat(w).concat(A).concat(p).concat(D).concat(m).concat(x).concat(q).concat(C).concat(b).concat(E).concat(c).concat(B).concat(J)};
f.prototype.init=function(a){if(!this.persistenceService.hasDNT()){var c=this.buildIdentity()[0];this.identityAtLoad=!!c;this.checkForDesignCenter();window.ci360_config_called||(window.ci360_config_called=!0,this.networkService.call(this.buildConfigURL(),this.configLoadCallback,a,c&&"POST"||"GET",c))}};f.prototype.getContentChangeInfo=function(){var a=[];if(this.config&&this.config.e&&this.config.e.cc)for(var c=0;c<this.config.e.cc.length;c++){var b=this.config.e.cc[c],d={};d.eventuid=b[0];d.selector=
b[1];a.push(d)}return a};f.prototype.getJsVarsToObserve=function(){var a=[];if(this.config&&this.config.e)var c=this.config.e.jsc;if(c)for(var b=0;b<c.length;b++)a.push(c[b][0]);return a};f.prototype.getCartConfiguration=function(){var a={cart:"cartview"},c=[],b=this.config&&this.config.e&&this.config.e.cart;if(b)for(var d=0;d<b.length;d++){var g=b[d];c.push({rowSelector:g.s,action:a[g.t]||g.t,details:g.d,productAttributes:g.i,internalCartId:g.id,name:g.n,removeRules:g.r})}return c};f.prototype.attachIdentityBlocking=
function(a){return this.attachIdentity(a,!0)};f.prototype.attachIdentity=function(a,c){var b=this;void 0===c&&(c=!1);c&&this.lockIdentity()&&setTimeout(function(){b.unlockIdentity(!1)},this.identityLockTimeout);a=this.buildIdentity(a);a[0]&&a[1]&&this.networkService.processIdentity(this.buildDatahubURL(),this.updateDid,a[0],a[1]);return a[2]};f.prototype.detachIdentity=function(a){void 0===a&&(a=!1);a=this.buildDatahubURL()+(a?"?crossChannel=true":"");this.networkService.processIdentity(a,this.updateDid,
"D","D")};f.prototype.buildDatahubURL=function(){return"".concat(this.serverInfo.protocol,"//").concat(this.serverInfo.hostname,":").concat(this.serverInfo.port,"/t/s/d/").concat(this.extTenantId,"/").concat(this.getConfig().vid)};f.prototype.getConfig=function(){this.config.datahubId=this.persistenceService.getDid()||this.config.datahubId;return this.config};f.prototype.isInDesignCenter=function(){return this.inDesignCenter};f.prototype.getPageElements=function(){return this.config&&this.config.e&&
this.config.e.term?this.config.e.term:[]};f.prototype.getJsVars=function(){return this.config&&this.config.e&&this.config.e.jsv?this.config.e.jsv:[]};f.prototype.getCollectRules=function(){if(this.config.c)return this.config.c};f.prototype.getIdentityEventConfigs=function(){if(this.config&&this.config.e&&this.config.e.id){for(var a={pageView:[],click:[],formSubmit:[]},c=0;c<this.config.e.id.length;c++){var b=this.config.e.id[c];"pageView"===b.t?a.pageView.push(b):"click"===b.t?a.click.push(b):"formSubmit"===
b.t&&a.formSubmit.push(b)}return a}};f.prototype.getLoadRules=function(){if(this.config.l)return this.config.l};return f}();m.ConfigService=q})($ci360||($ci360={}));
(function(m){var q=function(){function f(){this.forge=this.initForge()}f.prototype.sha384=function(a){var c=this.forge.md.sha384.create();c.update(a);return c.digest().toHex()};f.prototype.initForge=function(){function a(b){this.data="";this.read=0;if("string"===typeof b)this.data=b;else if(b instanceof a||"object"===typeof b&&"string"===typeof b.data&&"number"===typeof b.read)this.data=b.data,this.read=b.read;this._constructedStringLength=0}function c(a,b,c){for(var d,e,g,l,h,v,p,f,n,m,q,E,B,J,O,
P,F,G,M,N,K,L,Q,R,z,S=c.length();128<=S;){for(z=0;16>z;++z)b[z][0]=c.getInt32()>>>0,b[z][1]=c.getInt32()>>>0;for(;80>z;++z)h=b[z-2],n=h[0],h=h[1],d=((n>>>19|h<<13)^(h>>>29|n<<3)^n>>>6)>>>0,e=((n<<13|h>>>19)^(h<<3|n>>>29)^(n<<26|h>>>6))>>>0,h=b[z-15],n=h[0],h=h[1],g=((n>>>1|h<<31)^(n>>>8|h<<24)^n>>>7)>>>0,l=((n<<31|h>>>1)^(n<<24|h>>>8)^(n<<25|h>>>7))>>>0,n=b[z-7],m=b[z-16],h=e+n[1]+l+m[1],b[z][0]=d+n[0]+g+m[0]+(h/4294967296>>>0)>>>0,b[z][1]=h>>>0;n=a[0][0];m=a[0][1];q=a[1][0];E=a[1][1];B=a[2][0];J=
a[2][1];O=a[3][0];P=a[3][1];F=a[4][0];G=a[4][1];M=a[5][0];N=a[5][1];K=a[6][0];L=a[6][1];Q=a[7][0];R=a[7][1];for(z=0;80>z;++z)d=((F>>>14|G<<18)^(F>>>18|G<<14)^(G>>>9|F<<23))>>>0,h=((F<<18|G>>>14)^(F<<14|G>>>18)^(G<<23|F>>>9))>>>0,e=(K^F&(M^K))>>>0,v=(L^G&(N^L))>>>0,g=((n>>>28|m<<4)^(m>>>2|n<<30)^(m>>>7|n<<25))>>>0,l=((n<<4|m>>>28)^(m<<30|n>>>2)^(m<<25|n>>>7))>>>0,p=(n&q|B&(n^q))>>>0,f=(m&E|J&(m^E))>>>0,h=R+h+v+k[z][1]+b[z][1],d=Q+d+e+k[z][0]+b[z][0]+(h/4294967296>>>0)>>>0,e=h>>>0,h=l+f,g=g+p+(h/4294967296>>>
0)>>>0,l=h>>>0,Q=K,R=L,K=M,L=N,M=F,N=G,h=P+e,F=O+d+(h/4294967296>>>0)>>>0,G=h>>>0,O=B,P=J,B=q,J=E,q=n,E=m,h=e+l,n=d+g+(h/4294967296>>>0)>>>0,m=h>>>0;h=a[0][1]+m;a[0][0]=a[0][0]+n+(h/4294967296>>>0)>>>0;a[0][1]=h>>>0;h=a[1][1]+E;a[1][0]=a[1][0]+q+(h/4294967296>>>0)>>>0;a[1][1]=h>>>0;h=a[2][1]+J;a[2][0]=a[2][0]+B+(h/4294967296>>>0)>>>0;a[2][1]=h>>>0;h=a[3][1]+P;a[3][0]=a[3][0]+O+(h/4294967296>>>0)>>>0;a[3][1]=h>>>0;h=a[4][1]+G;a[4][0]=a[4][0]+F+(h/4294967296>>>0)>>>0;a[4][1]=h>>>0;h=a[5][1]+N;a[5][0]=
a[5][0]+M+(h/4294967296>>>0)>>>0;a[5][1]=h>>>0;h=a[6][1]+L;a[6][0]=a[6][0]+K+(h/4294967296>>>0)>>>0;a[6][1]=h>>>0;h=a[7][1]+R;a[7][0]=a[7][0]+Q+(h/4294967296>>>0)>>>0;a[7][1]=h>>>0;S-=128}}var b=b||{};b.md=b.md||{};b.md.algorithms=b.md.algorithms||{};var d=b.sha512=b.sha512||{};b.util=b.util||{};b.util.fillString=function(a,b){for(var c="";0<b;)b&1&&(c+=a),b>>>=1,0<b&&(a+=a);return c};b.util.createBuffer=function(a,c){void 0!==a&&"utf8"===(c||"raw")&&(a=b.util.encodeUtf8(a));return new b.util.ByteBuffer(a)};
b.util.encodeUtf8=function(a){return unescape(encodeURIComponent(a))};b.util.ByteBuffer=a;b.util.isArrayBuffer=function(a){return"undefined"!==typeof ArrayBuffer&&a instanceof ArrayBuffer};b.util.isArrayBufferView=function(a){return a&&b.util.isArrayBuffer(a.buffer)&&void 0!==a.byteLength};b.util.ByteStringBuffer=a;b.util.ByteStringBuffer.prototype._optimizeConstructedString=function(a){this._constructedStringLength+=a;4096<this._constructedStringLength&&(this.data.substr(0,1),this._constructedStringLength=
0)};b.util.ByteStringBuffer.prototype.length=function(){return this.data.length-this.read};b.util.ByteStringBuffer.prototype.isEmpty=function(){return 0>=this.length()};b.util.ByteStringBuffer.prototype.putBytes=function(a){this.data+=a;this._optimizeConstructedString(a.length);return this};b.util.ByteStringBuffer.prototype.putInt32=function(a){return this.putBytes(String.fromCharCode(a>>24&255)+String.fromCharCode(a>>16&255)+String.fromCharCode(a>>8&255)+String.fromCharCode(a&255))};b.util.ByteStringBuffer.prototype.putInt=
function(a,b){if(8!==b&&16!==b&&24!==b&&32!==b)throw Error("Only 8, 16, 24, or 32 bits supported: "+b);var c="";do b-=8,c+=String.fromCharCode(a>>b&255);while(0<b);return this.putBytes(c)};b.util.ByteStringBuffer.prototype.getInt16=function(){var a=this.data.charCodeAt(this.read)<<8^this.data.charCodeAt(this.read+1);this.read+=2;return a};b.util.ByteStringBuffer.prototype.getInt32=function(){var a=this.data.charCodeAt(this.read)<<24^this.data.charCodeAt(this.read+1)<<16^this.data.charCodeAt(this.read+
2)<<8^this.data.charCodeAt(this.read+3);this.read+=4;return a};b.util.ByteStringBuffer.prototype.bytes=function(a){return"undefined"===typeof a?this.data.slice(this.read):this.data.slice(this.read,this.read+a)};b.util.ByteStringBuffer.prototype.at=function(a){return this.data.charCodeAt(this.read+a)};b.util.ByteStringBuffer.prototype.setAt=function(a,b){this.data=this.data.substr(0,this.read+a)+String.fromCharCode(b)+this.data.substr(this.read+a+1);return this};b.util.ByteStringBuffer.prototype.last=
function(){return this.data.charCodeAt(this.data.length-1)};b.util.ByteStringBuffer.prototype.copy=function(){var a=b.util.createBuffer(this.data);a.read=this.read;return a};b.util.ByteStringBuffer.prototype.compact=function(){0<this.read&&(this.data=this.data.slice(this.read),this.read=0);return this};b.util.ByteStringBuffer.prototype.clear=function(){this.data="";this.read=0;return this};b.util.ByteStringBuffer.prototype.toHex=function(){for(var a="",b=this.read;b<this.data.length;++b){var c=this.data.charCodeAt(b);
16>c&&(a+="0");a+=c.toString(16)}return a};b.util.ByteStringBuffer.prototype.toString=function(){return b.util.decodeUtf8(this.bytes())};b.md.sha512=b.md.algorithms.sha512=d;var g=b.sha384=b.sha512.sha384=b.sha512.sha384||{};g.create=function(){return d.create("SHA-384")};b.md.sha384=b.md.algorithms.sha384=g;b.sha512.sha256=b.sha512.sha256||{create:function(){return d.create("SHA-512/256")}};b.md["sha512/256"]=b.md.algorithms["sha512/256"]=b.sha512.sha256;b.sha512.sha224=b.sha512.sha224||{create:function(){return d.create("SHA-512/224")}};
b.md["sha512/224"]=b.md.algorithms["sha512/224"]=b.sha512.sha224;d.create=function(a){h||(e=String.fromCharCode(128),e+=b.util.fillString(String.fromCharCode(0),128),k=[[1116352408,3609767458],[1899447441,602891725],[3049323471,3964484399],[3921009573,2173295548],[961987163,4081628472],[1508970993,3053834265],[2453635748,2937671579],[2870763221,3664609560],[3624381080,2734883394],[310598401,1164996542],[607225278,1323610764],[1426881987,3590304994],[1925078388,4068182383],[2162078206,991336113],[2614888103,
633803317],[3248222580,3479774868],[3835390401,2666613458],[4022224774,944711139],[264347078,2341262773],[604807628,2007800933],[770255983,1495990901],[1249150122,1856431235],[1555081692,3175218132],[1996064986,2198950837],[2554220882,3999719339],[2821834349,766784016],[2952996808,2566594879],[3210313671,3203337956],[3336571891,1034457026],[3584528711,2466948901],[113926993,3758326383],[338241895,168717936],[666307205,1188179964],[773529912,1546045734],[1294757372,1522805485],[1396182291,2643833823],
[1695183700,2343527390],[1986661051,1014477480],[2177026350,1206759142],[2456956037,344077627],[2730485921,1290863460],[2820302411,3158454273],[3259730800,3505952657],[3345764771,106217008],[3516065817,3606008344],[3600352804,1432725776],[4094571909,1467031594],[275423344,851169720],[430227734,3100823752],[506948616,1363258195],[659060556,3750685593],[883997877,3785050280],[958139571,3318307427],[1322822218,3812723403],[1537002063,2003034995],[1747873779,3602036899],[1955562222,1575990012],[2024104815,
1125592928],[2227730452,2716904306],[2361852424,442776044],[2428436474,593698344],[2756734187,3733110249],[3204031479,2999351573],[3329325298,3815920427],[3391569614,3928383900],[3515267271,566280711],[3940187606,3454069534],[4118630271,4000239992],[116418474,1914138554],[174292421,2731055270],[289380356,3203993006],[460393269,320620315],[685471733,587496836],[852142971,1086792851],[1017036298,365543100],[1126000580,2618297676],[1288033470,3409855158],[1501505948,4234509866],[1607167915,987167468],
[1816402316,1246189591]],l={"SHA-512":[[1779033703,4089235720],[3144134277,2227873595],[1013904242,4271175723],[2773480762,1595750129],[1359893119,2917565137],[2600822924,725511199],[528734635,4215389547],[1541459225,327033209]],"SHA-384":[[3418070365,3238371032],[1654270250,914150663],[2438529370,812702999],[355462360,4144912697],[1731405415,4290775857],[2394180231,1750603025],[3675008525,1694076839],[1203062813,3204075428]],"SHA-512/256":[[573645204,4230739756],[2673172387,3360449730],[596883563,
1867755857],[2520282905,1497426621],[2519219938,2827943907],[3193839141,1401305490],[721525244,746961066],[246885852,2177182882]],"SHA-512/224":[[2352822216,424955298],[1944164710,2312950998],[502970286,855612546],[1738396948,1479516111],[258812777,2077511080],[2011393907,79989058],[1067287976,1780299464],[286451373,2446758561]]},h=!0);"undefined"===typeof a&&(a="SHA-512");if(!(a in l))throw Error("Invalid SHA-512 algorithm: "+a);for(var d=l[a],g=null,f=b.util.createBuffer(),v=Array(80),m=0;80>m;++m)v[m]=
Array(2);m=64;switch(a){case "SHA-384":m=48;break;case "SHA-512/256":m=32;break;case "SHA-512/224":m=28}var r={algorithm:a.replace("-","").toLowerCase(),blockLength:128,digestLength:m,messageLength:0,fullMessageLength:null,messageLengthSize:16,messageLength128:null,update:null,digest:null,start:function(){r.messageLength=0;r.fullMessageLength=r.messageLength128=[];for(var a=r.messageLengthSize/4,c=0;c<a;++c)r.fullMessageLength.push(0);f=b.util.createBuffer();g=Array(d.length);for(c=0;c<d.length;++c)g[c]=
d[c].slice(0);return r}};r.start();r.update=function(a,d){"utf8"===d&&(a=b.util.encodeUtf8(a));d=a.length;r.messageLength+=d;d=[d/4294967296>>>0,d>>>0];for(var e=r.fullMessageLength.length-1;0<=e;--e)r.fullMessageLength[e]+=d[1],d[1]=d[0]+(r.fullMessageLength[e]/4294967296>>>0),r.fullMessageLength[e]>>>=0,d[0]=d[1]/4294967296>>>0;f.putBytes(a);c(g,v,f);(2048<f.read||0===f.length())&&f.compact();return r};r.digest=function(){var d=b.util.createBuffer();d.putBytes(f.bytes());d.putBytes(e.substr(0,r.blockLength-
(r.fullMessageLength[r.fullMessageLength.length-1]+r.messageLengthSize&r.blockLength-1)));for(var l,h,k=8*r.fullMessageLength[0],n=0;n<r.fullMessageLength.length-1;++n)l=8*r.fullMessageLength[n+1],h=l/4294967296>>>0,k+=h,d.putInt32(k>>>0),k=l>>>0;d.putInt32(k);l=Array(g.length);for(n=0;n<g.length;++n)l[n]=g[n].slice(0);c(l,v,d);d=b.util.createBuffer();h="SHA-512"===a?l.length:"SHA-384"===a?l.length-2:l.length-4;for(n=0;n<h;++n)d.putInt32(l[n][0]),n===h-1&&"SHA-512/224"===a||d.putInt32(l[n][1]);return d};
return r};var e=null,h=!1,k=null,l=null;return b};return f}();m.EncodingService=q})($ci360||($ci360={}));
(function(m){var q=function(){function f(a,c){var b=this;this.setExtTenantId=function(a){b.key+=a};this.DELIMITER=String.fromCharCode(127);this.size=0;this.getUnsentEvents=function(){for(var a=[],c=0;c<b.storage().length;c++)try{var e=b.storage().key(c);if(e&&e.startsWith(b.getPrefix())){var h=b.retrieveEvent(e,!1);null!==h&&a.push(h)}}catch(k){}return a};this.key=a;this.storageType=c}f.prototype.storage=function(){return m[this.storageType]};f.prototype.getEventKey=function(a){return this.getPrefix()+
a};f.prototype.getPrefix=function(){return this.key+"_"};f.prototype.setEvent=function(a){try{var c=a.toJSONString();this.storage().setItem(this.getEventKey(a.paramMap.get("event_guid")),c)}catch(b){return!1}return!0};f.prototype.removeEvent=function(a){try{this.storage().removeItem(this.getEventKey(a))}catch(c){return!1}return!0};f.prototype.retrieveEvent=function(a,c){void 0===c&&(c=!0);try{var b=this.storage().getItem(c?this.getEventKey(a):a);if(b){var d=new m.CI360EventObj;d.populate(b);return d}}catch(g){}return null};
f.prototype.retrieveItem=function(a){a=a?a:this.key;var c=this.storage().getItem(a);return c?c:(this.storage().setItem(a,""),"")};f.prototype.push=function(a){try{var c=a.toJSONString(),b=this.retrieveItem(this.key);b+=""==b?c:this.DELIMITER+c;this.storage().setItem(this.key,b);this.size++}catch(d){return!1}return!0};f.prototype.pop=function(a){void 0===a&&(a=!1);try{var c=this.retrieveItem(this.key),b=c.indexOf(this.DELIMITER);if(-1<b){var d=c.substr(0,b);c=c.substr(b+1);this.storage().setItem(this.key,
c);this.size--;if(a){var g=new m.CI360EventObj;g.populate(d);return g}}else if(0<c.length&&(this.storage().setItem(this.key,""),this.size=0,a))return g=new m.CI360EventObj,g.populate(c),g;return null}catch(e){return null}};f.prototype.getFront=function(){try{var a=this.retrieveItem(this.key),c=a.indexOf(this.DELIMITER);if(-1<c){var b=a.substr(0,c),d=new m.CI360EventObj;d.populate(b);return d}return 0<a.length?(d=new m.CI360EventObj,d.populate(a),d):null}catch(g){return null}};return f}();m.LocalQueue=
q})($ci360||($ci360={}));
(function(m){var q=function(){function f(a,c){var b=this;this.maxResendCount=3;this.resendCount=0;this.loadLock=this.identityLock=this.sendLock=!1;this.loadLockTimeout=3E3;this.initialTimeout=1500;this.bodyInHeaderLoad=this.bodyInHeaderAll=!1;this.latestIdentity=null;this.blockingIdentityResolved=this.synthLoad=!1;this.com_sas_ci_acs=window.com_sas_ci_acs;this.legacyTagLoaded=!1;this.firstLoad=!0;this.loadIdChanging=!1;this.getLoadId=function(){return b.loadId};this.setLoadId=function(a){b.loadId=
a;b.legacyTagLoaded&&(b.com_sas_ci_acs.ob_configure.getLoadId=function(){return a})};this.setFeatureFlags=function(a){b.featureFlags=a};this.setSendMode=function(a){b.sendMode=a};this.getSendMode=function(){var a;return b.sendMode||(null===(a=b.featureFlags)||void 0===a?void 0:a.Send_Mode)};this.isSendSimultaneous=function(){return"sim"===b.getSendMode()};this.isSendBeacon=function(){return"beacon"===b.getSendMode()};this.setOverrideDomain=function(a){b.overrideDomain=a};this.getDomain=function(){return"undefined"!==
typeof com_sas_ci_acs&&com_sas_ci_acs.overrideDomain||b.overrideDomain||document.domain||""};this.getRandomGuid=function(){return b.loadId+Math.floor(1E12*Math.random()+1)};this.setSessionId=function(a){b.sessionId=a};this.observers=[];this.setExtTenantId=function(a){b.q.setExtTenantId(a)};this.setCcs=function(a){b.ccs=a};this.unlocked=function(){return!1===b.sendLock&&!1===b.identityLock};this.call=function(a,b,c,h,k){void 0===b&&(b=function(){});void 0===c&&(c=function(){});void 0===h&&(h="GET");
var d=new XMLHttpRequest;d.onreadystatechange=function(){d.readyState===XMLHttpRequest.DONE&&200<=d.status&&300>d.status?d.responseText?(b(d.responseText),c()):c(Error("Response is Empty.")):d.readyState===XMLHttpRequest.DONE&&503===d.status&&c(Error("(503) Service is not available."))};d.withCredentials=!0;d.open(h,a);k&&d.setRequestHeader("Content-Type","application/x-www-form-urlencoded;");d.send(k||null)};this.resendEvent=function(){setTimeout(function(){b.resendCount<b.maxResendCount?b.resendCount++:
(b.q.pop(!1),b.resendCount=0);b.processEvents(!1)},1E3*(b.resendCount+1))};this.sendEvent=function(a){b.ccs&&b.send(b.ccs,a.toURLEncoded(),"POST",b.eventResponseHandler,null)};this.synthLoaded=function(a){b.synthLoad=a};this.isBlockingIdentityResolved=function(){return b.blockingIdentityResolved};this.resolveBlockingIdentity=function(a){void 0===a&&(a=!0);b.blockingIdentityResolved=a};this.setIdentityLock=function(a){void 0===a&&(a=!0);return b.identityLock=a};this.processEvents=function(a){b.isReal(a)&&
(b.sendLock=a);a=null;if(b.unlocked()&&(a=b.q.getFront())){b.sendLock=!0;var c=Date.now();a.paramMap.set("cts",c);a.paramMap.set("timestamp",b.serverTimestamp+c-b.clientBaseTimestamp);b.sendEvent(a)}if(b.isSendSimultaneous()||b.isSendBeacon())for(a=0,c=b.q.getUnsentEvents();a<c.length;a++)b.simultaneousSend(c[a],1)};this.pushEvent=function(a){b.isSendSimultaneous()||b.isSendBeacon()?b.simultaneousSend(a):(b.q.push(a),b.unlocked()&&b.processEvents())};this.unlockLoad=function(){b.loadLock&&(b.loadLock=
!1,b.processEvents())};this.simultaneousSend=function(a,c){void 0===c&&(c=0);a&&(b.isSendSimultaneous()&&0===c&&b.q.setEvent(a),b.ccs&&(!b.simLock()||b.isSendBeacon())&&b.xhrBeaconSend(b.ccs,a.toURLEncoded(),"POST",b.simultaneousSendEventResponseHandler,{guid:a.paramMap.get("event_guid"),resendCount:c,event:a.paramMap.get("eventName")}))};this.simultaneousSendEventResponseHandler=function(a,c){if(b.isReal(a.readyState)&&a.readyState==XMLHttpRequest.DONE)if(b.cancelTimer(a),200<=a.status&&300>a.status){b.q.removeEvent(c.guid);
if(-1<a.responseText.indexOf("load_id")){var d=void 0;try{d=JSON.parse(a.responseText),d.load_id&&b.setLoadId(d.load_id),b.unlockLoad()}catch(h){}}-1<a.responseText.indexOf("sid")&&b.notifyObservers()}else a.abort(),setTimeout(function(){c.resendCount<b.maxResendCount?b.simultaneousSend(b.q.retrieveEvent(c.guid),c.resendCount+1):(b.q.removeEvent(c.guid),"load"==c.event&&b.unlockLoad())},1E3*(c.resendCount+1))};this.processIdentity=function(a,c,e,h){void 0===c&&(c=function(){});var d=b.persistenceService;
e?(d.setIdentityEvent(e),b.latestIdentity=h):e=d.getIdentityEvent();if(e){var g="D"===e;b.call(a,function(a){c(a);if(b.latestIdentity===h||null==b.latestIdentity)d.removeIdentityEvent(),b.latestIdentity=null},void 0,g&&"DELETE"||"POST",g?null:e)}};this.send=function(a,c,e,h,k){var d=void 0;try{var g=b.initialTimeout*(b.resendCount+1);d=new XMLHttpRequest;d.onreadystatechange=function(){h(d,k)};"function"===typeof d.onloadend&&(d.onloadend=function(){b.cancelTimer(d)});if("POST"==e)d.open(e,a,!0),
d.timeout=g,d.setRequestHeader("Content-Type","application/x-www-form-urlencoded;charset=UTF-8"),(b.bodyInHeaderAll||b.bodyInHeaderLoad&&c&&-1<c.indexOf("event=load"))&&d.setRequestHeader("X-SI-EventBody",c),d.onloadstart=function(){d.ontimeout=function(){b.timeout(d)}};else{var f=null!=c?a.indexOf("?")?"&"+c:"?"+c:"";d.open(e,a+f,!0)}d.withCredentials=!0;c+="&sndcts="+Date.now();var n=-1<c.indexOf("eventName=load");b.synthLoad&&(c=b.replaceParam(c,"session",b.sessionId),c=b.replaceParam(c,"hb",b.persistenceService.getSidArray()[2]),
!n&&(c=b.replaceParam(c,"load_id",b.loadId)));b.isBlockingIdentityResolved()&&(c=b.replaceParam(c,"datahub_id",b.persistenceService.getDid()));(b.firstLoad||!n&&b.loadIdChanging)&&(c=b.replaceParam(c,"load_id",b.loadId));b.firstLoad&&n&&(b.firstLoad=!1);n&&-1==c.indexOf("load_id=")&&(b.loadIdChanging=!0);c+="&domain=".concat(b.getDomain());d.send(c)}catch(u){d&&d.abort(),b.resendEvent()}};this.xhrBeaconSend=function(a,c,e,h,k){var d=void 0;try{var g=-1<c.indexOf("eventName=load");c+="&sndcts="+Date.now();
b.isBlockingIdentityResolved()&&(c=b.replaceParam(c,"datahub_id",b.persistenceService.getDid()));(b.firstLoad||!g&&b.loadIdChanging)&&(c=b.replaceParam(c,"load_id",b.loadId));g&&-1==c.indexOf("load_id=")&&(b.loadIdChanging=!0,b.loadLock=!0,setTimeout(function(){b.unlockLoad()},b.loadLockTimeout));b.firstLoad&&g&&(b.firstLoad=!1);if(!g&&b.isSendBeacon())navigator.sendBeacon(a,c);else{var f=b.initialTimeout;d=new XMLHttpRequest;d.onreadystatechange=function(){h(d,k)};"function"===typeof d.onloadend&&
(d.onloadend=function(){b.cancelTimer(d)});d.open(e,a,!0);d.timeout=f;d.setRequestHeader("Content-Type","application/x-www-form-urlencoded;charset=UTF-8");d.onloadstart=function(){d.ontimeout=function(){b.timeout(d)}};d.withCredentials=!0;c+="&domain=".concat(b.getDomain());d.send(c)}}catch(n){d&&d.abort()}};this.replaceParam=function(a,b,c){null==c&&(c="");var d=new RegExp("\\b("+b+"=).*?(&|#|$)");if(0<=a.search(d))return a.replace(d,"$1"+c+"$2");a=a.replace(/[?#]$/,"");return a+"&"+b+"="+c};this.cancelTimer=
function(a){a.timeout&&clearTimeout(a.timeout);a.ontimeout=null};this.eventResponseHandler=function(a){if(b.isReal(a.readyState)&&a.readyState==XMLHttpRequest.DONE)if(b.cancelTimer(a),200<=a.status&&300>a.status){if(-1<a.responseText.indexOf("load_id")){var c=void 0;try{c=JSON.parse(a.responseText),c.load_id&&b.setLoadId(c.load_id)}catch(e){}}else if(-1<a.responseText.indexOf("sid")){b.notifyObservers();return}b.q.pop(!1);b.resendCount=0;b.processEvents(!1)}else a.abort(),b.resendEvent()};this.timeout=
function(a,c){void 0===c&&(c=!0);a&&a.abort();c&&b.resendEvent()};this.q=a;this.persistenceService=c;(this.legacyTagLoaded=this.com_sas_ci_acs&&this.com_sas_ci_acs.ob_configure)&&this.com_sas_ci_acs.ob_configure.getLoadId()&&(this.firstLoad=!1)}f.prototype.setServerTimestamp=function(a){this.serverTimestamp=a};f.prototype.setClientBaseTimestamp=function(a){this.clientBaseTimestamp=a};f.prototype.setFirstLoad=function(a){this.firstLoad=a};f.prototype.addObserver=function(a){this.observers.push(a)};
f.prototype.setCachedLoadEvent=function(a){this.cachedLoadEvent=a};f.prototype.notifyObservers=function(){for(var a=0,c=this.observers;a<c.length;a++)(0,c[a])()};f.prototype.simLock=function(){return this.loadLock||this.identityLock};f.prototype.isReal=function(a){return"undefined"!=typeof a||null!=a};return f}();m.NetworkService=q})($ci360||($ci360={}));
(function(m){var q=function(){function f(a,c){var b=this;this.setExtTenantId=function(a){b.extTenantId=a};this.getUsrAgent=function(){return b.usrAgSh384||b.setUsrAgent(b.encodingService.sha384(navigator.userAgent||"").substring(0,30))};this.setUsrAgent=function(a){return b.usrAgSh384=a};this.REGULAR_EXPRESSIONS={INTEGER:"^[\\-]?\\d+$",DECIMAL:"^[0-9]+(.[0-9]{1,2})?$"};this.SPOT_DEP_EVENTS={clickthrough:"1",impression:"1",impressionViewable:"1"};this.SPOT_DEP_EVENT_KEYS={creativeId:"1",spotId:"1",
taskId:"1"};this.PARAMS_METADATA={cart:{action:{required:!0,regex:"^cartview$|^checkout$|^purchase$",internal_name:"cart_type"},uri:{required:!0,default_value:function(){return document.URL}},referrer:{required:!0,default_value:function(){return encodeURI(document.referrer?document.referrer.substring(0,this.urlMaxSize):"")}},pageTitle:{required:!0,default_value:function(){return document.title},internal_name:"page_title"},id:{types:["string","number"],regex:"^.{0,42}$",internal_name:"cart_id"},orderId:{types:["string",
"number"],internal_name:"order_id"},name:{internal_name:"cart_name"},billingCity:{regex:"^.{0,390}$",internal_name:"billing_city"},billingCountry:{regex:"^.{0,85}$",internal_name:"billing_country"},billingPostcode:{regex:"^.{0,10}$",internal_name:"billing_postcode"},billingRegion:{regex:"^.{0,256}$",internal_name:"billing_region"},deliveryType:{regex:"^.{0,42}$",internal_name:"delivery_type"},paymentType:{regex:"^.{0,42}$",internal_name:"payment_type"},shippingCity:{regex:"^.{0,390}$",internal_name:"shipping_city"},
shippingCost:{types:["string","number"],regex:this.REGULAR_EXPRESSIONS.DECIMAL,internal_name:"shipping_cost"},shippingCountry:{regex:"^.{0,85}$",internal_name:"shipping_country"},shippingPostcode:{regex:"^.{0,10}$",internal_name:"shipping_postcode"},shippingRegion:{regex:"^.{0,256}$",internal_name:"shipping_region"},tax:{types:["string","number"],regex:this.REGULAR_EXPRESSIONS.DECIMAL},totalCartValue:{types:["string","number"],regex:this.REGULAR_EXPRESSIONS.DECIMAL,internal_name:"total_cart_value"},
apiEventKey:{},cart_id_internal:{}},cartaction:{action:{required:!0,regex:"^add$|^addFailed$|^update$|^remove$"},availabilityMessage:{regex:"^.{0,650}$",internal_name:"availability_message"},cartId:{types:["string","number"],internal_name:"cart_id"},cartName:{internal_name:"cart_name"},cartType:{regex:"^cartview$|^checkout$",internal_name:"cart_type"},group:{regex:"^.{0,130}$",internal_name:"product_group"},productId:{types:["string","number"],group:"identificationGroup",regex:"^.{0,130}$",group_min:1,
internal_name:"product_id"},productName:{group:"identificationGroup",regex:"^.{0,130}$",group_min:1,internal_name:"product_name"},productSku:{types:["string","number"],group:"identificationGroup",regex:"^.{0,100}$",group_min:1,internal_name:"product_sku"},savingsMessage:{regex:"^.{0,650}$",internal_name:"savings_message"},shippingMessage:{regex:"^.{0,650}$",internal_name:"shipping_message"},quantity:{types:["string","number"],regex:this.REGULAR_EXPRESSIONS.DECIMAL,internal_name:"product_quantity"},
unitPrice:{types:["string","number"],regex:this.REGULAR_EXPRESSIONS.DECIMAL,internal_name:"product_unit_price"},uri:{required:!0,default_value:function(){return document.URL}},apiEventKey:{}},cartitem:{id:{types:["string","number"],group:"cartItemGroup",regex:"^.{0,130}$",group_min:1,internal_name:"product_id"},name:{group:"cartItemGroup",regex:"^.{0,130}$",group_min:1,internal_name:"product_name"},sku:{types:["string","number"],group:"cartItemGroup",regex:"^.{0,100}$",group_min:1,internal_name:"product_sku"},
quantity:{types:["string","number"],regex:this.REGULAR_EXPRESSIONS.INTEGER,internal_name:"product_quantity"},unitPrice:{types:["string","number"],regex:this.REGULAR_EXPRESSIONS.DECIMAL,internal_name:"product_unit_price"},group:{regex:"^.{0,130}$",internal_name:"product_group"},availabilityMessage:{regex:"^.{0,650}$",internal_name:"availability_message"},shippingMessage:{regex:"^.{0,650}$",internal_name:"shipping_message"},savingsMessage:{regex:"^.{0,650}$",internal_name:"savings_message"}},change:{pageTitle:{required:!0,
default_value:function(){return document.title},internal_name:"page_title"},referrer:{required:!0,default_value:function(){return encodeURI(document.referrer?document.referrer.substring(0,this.urlMaxSize):"")}},location:{},attempts:{required:!0,default_value:function(){return"1"},internal_name:"form._o.attempts"},uri:{required:!0,default_value:function(){return document.URL}},id:{required:!0,internal_name:"form._o.id"},name:{internal_name:"form._h.name"}},click:{uri:{},anchorId:{types:["string","number"],
internal_name:"anchor_id"},pageTitle:{required:!0,default_value:function(){return document.title},internal_name:"page_title"},title:{required:!1},referrer:{required:!0,default_value:function(){return encodeURI(document.referrer?document.referrer.substring(0,this.urlMaxSize):"")}},anchorHref:{internal_name:"anchor_href"},anchorName:{internal_name:"anchor_name"},elementTagName:{},location:{},onClick:{internal_name:"onclick"},targetInnerText:{},targetSelectorPath:{},targetAlt:{}},clickthrough:{uri:{required:!0,
default_value:function(){return document.URL}},spotName:{required:!0},spotId:{required:!0,internal_name:"spot_id"},variantId:{internal_name:"variant_id"},creativeId:{required:!0,internal_name:"creative_id"},taskId:{required:!0,internal_name:"task_id"}},contentchange:{uri:{required:!0,default_value:function(){return document.URL}},attributeName:{required:!1,internal_name:"attributename"},newValue:{required:!1,internal_name:"newvalue"},oldValue:{required:!1,internal_name:"oldvalue"},pageTitle:{required:!0,
default_value:function(){return document.title},internal_name:"page_title"},id:{types:["string","number"],internal_name:"targetid"},name:{internal_name:"targetname"},selector:{required:!0,internal_name:"targetselector"},type:{required:!0,regex:"^attribute$|^childremove$|^childadd$",internal_name:"targettype"}},custom:{uri:{required:!0,default_value:function(){return document.URL}},apiEventKey:{}},document:{altText:{internal_name:"targetInnerText"},id:{internal_name:"anchor_id"},url:{required:!0,internal_name:"anchor_href"},
name:{internal_name:"anchor_name"},selectorPath:{internal_name:"targetSelectorPath"}},identity:{loginId:{required:!0,internal_name:"login_event",regex:".+"},loginEventType:{required:!0,regex:"^email_id$|^login_id$|^customer_id$|^subject_id$|^account_id$|^household_id$",internal_name:"login_event_type"},eventSource:{required:!1,default_value:"webmarketing"}},impression:{eventSource:{required:!1,default_value:"webmarketing"},uri:{required:!0,default_value:function(){return document.URL}},spotName:{required:!0},
creativeId:{required:!0,internal_name:"creative_id"},spotId:{required:!0,internal_name:"spot_id"},taskId:{required:!0,internal_name:"task_id"},variantId:{internal_name:"variant_id"},eventtype:{required:!0,default_value:"spot_change"}},impressionViewable:{uri:{required:!0,default_value:function(){return document.URL}},spotName:{required:!0},spotId:{required:!0,internal_name:"spot_id"},variantId:{internal_name:"variant_id"},creativeId:{required:!0,internal_name:"creative_id"},taskId:{required:!0,internal_name:"task_id"}},
internalSearch:{searchName:{required:!0},term:{required:!0,internal_name:"searchTerm"},resultsDisplayed:{regex:this.REGULAR_EXPRESSIONS.INTEGER},resultsDisplayFlag:{required:!0,regex:"^true$|^false$"},fieldId:{internal_name:"searchFieldId"},fieldName:{internal_name:"searchFieldName"},apiEventKey:{}},jsvarchange:{uri:{required:!0,default_value:function(){return document.URL}},name:{required:!0},action:{default_value:"update",regex:"^add$|^update$"},oldValue:{required:!0,internal_name:"oldvalue"},newValue:{required:!0,
internal_name:"newvalue"}},load:{uri:{required:!0,default_value:function(){return document.URL}},pageTitle:{required:!0,default_value:function(){return document.title},internal_name:"page_title"},referrer:{required:!0,default_value:function(){return encodeURI(document.referrer?document.referrer.substring(0,this.urlMaxSize):"")}}},media:{uri:{required:!0,default_value:function(){return document.URL}},id:{required:!0,internal_name:"player_id"},url:{required:!0,regex:"^.{0,260}$",internal_name:"media"},
player:{required:!0,regex:"^.{0,30}$",internal_name:"media_player"},position:{required:!0,types:["string","number"],regex:this.REGULAR_EXPRESSIONS.INTEGER,internal_name:"media_position"},duration:{required:!0,types:["string","number"],regex:this.REGULAR_EXPRESSIONS.DECIMAL,internal_name:"media_duration"},action:{required:!0,regex:"^start$|^stop$|^end$",internal_name:"media_action"}},productView:{id:{group:"identificationGroup",group_min:1,internal_name:"product_id"},name:{group:"identificationGroup",
group_min:1,internal_name:"product_name"},sku:{group:"identificationGroup",group_min:1,internal_name:"product_sku"},quantity:{internal_name:"product_quantity",regex:this.REGULAR_EXPRESSIONS.INTEGER},unitPrice:{internal_name:"product_unit_price",regex:this.REGULAR_EXPRESSIONS.DECIMAL},group:{internal_name:"product_group",regex:"^.{0,130}$"},availabilityMessage:{internal_name:"availability_message",regex:"^.{0,650}$"},shippingMessage:{internal_name:"shipping_message",regex:"^.{0,650}$"},savingsMessage:{internal_name:"savings_message",
regex:"^.{0,650}$"},apiEventKey:{}},promotion:{trackingCode:{},creativeName:{internal_name:"creative"},placementId:{},name:{required:!0,internal_name:"promotionName"},recordType:{required:!0,regex:"display|use"},type:{required:!0,internal_name:"promotionType"},apiEventKey:{}},submit:{attempts:{required:!0,default_value:function(){return"1"},internal_name:"form._o.attempts"},uri:{required:!0,default_value:function(){return document.URL}},referrer:{required:!0,default_value:function(){return encodeURI(document.referrer?
document.referrer.substring(0,this.urlMaxSize):"")}},id:{required:!0,internal_name:"form._o.id",default_value:function(){return""}},location:{},name:{types:["number","string"],internal_name:"form._h.name"}},visibilityChange:{uri:{required:!0,default_value:function(){return document.URL}},hidden:{required:!0,regex:"^true$|^false$",default_value:function(){return document.hidden}}}};this.commonFieldHandling=function(a,c,e){if("password"!==e.type){var d=e.id||e.name,g=e.value,l="form.f."+d;if("true"===
e.obscure){var f="ffobscure.".concat(++a.obscureCount);c[f]=l;g=b.encodingService.sha384(g+b.extTenantId)}a.paramMap.set(l,g);null!=e.type&&a.paramMap.set("form.f."+d+"._h.type",e.type);null!=e.alt&&a.paramMap.set("form.f."+d+"._h.alt",e.alt);null!=e.id&&a.paramMap.set("form.f."+d+"._h.id",e.id);null!=e.name&&a.paramMap.set("form.f."+d+"._h.name",e.name);null!=e.changes&&a.paramMap.set("form.f."+d+"._o.changes",e.changes)}};this.obfuscateFields=function(a){var c=a.paramMap.get("obfuscateFields"),
d=[];if(null!=c)try{d=JSON.parse(c)}catch(p){}for(c=0;c<d.length;c++){var h=d[c],k=a.paramMap.get(h);if(null!=k){b.util.isString(k)&&(k=k.toLowerCase().trim());a.paramMap.set(h,b.encodingService.sha384(k+b.extTenantId));k="ffobscure.".concat(++a.obscureCount);var l=a.paramMap.get("eventName");l=b.PARAMS_METADATA[l];var f=void 0;null!=l[h]&&(f=l[h].internal_name);a.paramMap.set(k,null!=f?f:h)}}a.paramMap.delete("obfuscateFields")};this.encodingService=a;this.util=c}f.prototype.mapTransportNames=function(a){var c=
a.paramMap.get("eventName"),b=this.PARAMS_METADATA[c],d={impressionViewable:"impression_viewable",clickthrough:"spot_clicked",identity:"IdentityEvent",visibilityChange:"visibilitychange"},g;for(g in d)c===g&&a.paramMap.set("eventName",d[g]);for(var e in b)(c=b[e].internal_name)&&a.paramMap.has(e)&&(a.paramMap.set(c,a.paramMap.get(e)),a.paramMap.delete(e))};f.prototype.getParamsMetadata=function(){return this.PARAMS_METADATA};f.prototype.cartEventHandling=function(a,c){c=c.items;if(null!=c){var b;
for(b=0;b<c.length;b++){var d=c[b],g=new m.CI360EventObj("cartitem"),e;for(e in d)d.hasOwnProperty(e)&&g.paramMap.set(e,d[e]);if(this.validateEvent(g)){d=this.PARAMS_METADATA.cartitem;for(var h in d){var k=d[h].internal_name;k&&g.paramMap.has(h)&&(g.paramMap.set(k,g.paramMap.get(h)),g.paramMap.delete(h))}a.paramMap.set("cartitem."+(b+1),g.toURLEncoded())}}a.paramMap.set("cartitem_count",b)}};f.prototype.changeEventHandling=function(a,c){var b=c.field;null!=b&&(this.commonFieldHandling(a,c,b),delete c.field)};
f.prototype.addFieldsToEvent=function(a,c){for(var b in c)c.hasOwnProperty(b)&&a.paramMap.set(b,c[b])};f.prototype.submitEventHandling=function(a,c){var b=c.fields;if(null!=b){for(var d=0;d<b.length;d++)this.commonFieldHandling(a,c,b[d]);delete c.fields}};f.prototype.resolveDefaultVal=function(a,c){var b={types:["string"],regex:".*",required:!1};return void 0!==a?a:b[c]};f.prototype.addDefaultFields=function(a){var c=this.PARAMS_METADATA[a.paramMap.get("eventName")],b;for(b in c){var d=c[b];null!=
d.default_value&&null==a.paramMap.get(b)&&("function"===typeof d.default_value&&(d.default_value=d.default_value()),a.paramMap.set(b,d.default_value))}};f.prototype.validateEvent=function(a){if(""!==a.paramMap.get("datahub_id")){var c=a.paramMap.get("eventName");if(c){var b=this.PARAMS_METADATA[c];if(null!=b){var d=new Map;for(l in b){var g=b[l];if(this.resolveDefaultVal(g.required,"required")&&"spotName"!==l&&null==a.paramMap.get(l))return this.SPOT_DEP_EVENTS[c]&&this.SPOT_DEP_EVENT_KEYS[l]&&a.paramMap.get("spotName"),
!1;var e=g.group;if(null!=e){var h=d.get(e);null==h&&d.set(e,{count:0,min:g.group_min})}}var k=[];a.paramMap.forEach(function(a,c){k.push(c)});for(c=0;c<k.length;c++){var l=k[c];e=a.paramMap.get(l);l=b[l];if(null!=l){if(!(new RegExp(this.resolveDefaultVal(l.regex,"regex"))).test(e)&&l.required)return!1;null!=l.group&&(e=l.group,h=d.get(e),h.count++)}}var f=!0,p="";d.forEach(function(a,c){a.count<a.min&&(p+=c+", ",f=!1)});return f?!0:(p=p.slice(0,p.length-2),!1)}}}return!1};return f}();m.ParamService=
q})($ci360||($ci360={}));
(function(m){var q=function(){function f(){var a=this;this.VID_PREF="_SI_VID_1.";this.SID_PREF="_SI_SID_1.";this.DID_PREF="_SI_DID_1.";this.TAB_PREF="_ciutbid_";this.DNT="_SI_DNT";this.ID_PREF="_ciaid_";this.storage="sessionStorage";this.setExtTenantId=function(c){a.extTenantId=c};this.setSld=function(c){a.sld=c};this.vidName=function(){return a.VID_PREF+a.extTenantId};this.sidName=function(){return a.SID_PREF+a.extTenantId};this.didName=function(){return a.DID_PREF+a.extTenantId};this.setCookieOnSLDs=
function(c,b,d){if(null!=b&&b!=a.getCookie(c)){var g=a.sld||window.location.hostname;if("localhost"===g||g.match(/^(?:[0-9]{1,3}\.){3}[0-9]{1,3}$/))a.setCookie(c,b,d,g);else if(g){var e=0;for(g=g.split(",");e<g.length;e++)for(var h=g[e].split(".").reverse(),k=1;k<h.length;k++){var l="."+h.slice(0,k+1).reverse().join(".");a.setCookie(c,b,d,l);if(a.getCookie(c)==b)return}}else a.setCookie(c,b,d)}};this.setCookie=function(a,b,d,g){var c=";";if(null!=d){var h=new Date;h.setTime(h.getTime()+(0<d?864E5*
d:31536E6));c+="expires="+h.toUTCString()}document.cookie=a+"="+b+c+";path=/"+(null==g?"":"; domain="+g)};this.getCookie=function(a){return(a=document.cookie.match("(^|;)\\s*"+a+"\\s*=\\s*([^;]+)"))?a.pop():""};this.setVid=function(c){a.setCookieOnSLDs(a.vidName(),c,0)};this.getVid=function(){return a.getCookie(a.vidName())};this.hasDNT=function(){return a.getCookie(a.DNT)?!0:!1};this.setSid=function(c){if(c){var b=(new Date).getTime(),d=a.getSidArray();d=d[0]==c?Math.max(b-Number(d[1]),Number(d[2])):
null;a.setCookieOnSLDs(a.sidName(),c+"."+b+"."+(d||0),null)}};this.getSidArray=function(){var c=a.getCookie(a.sidName());return c&&(c=c.split("."),2<c.length)?c:["","0","0"]};this.setDid=function(c){a.setCookieOnSLDs(a.didName(),c,null)};this.getDid=function(){return a.getCookie(a.didName())};this.registerActivity=function(){a.setSid(a.getSidArray()[0])};this.getTabId=function(){var c=m[a.storage].getItem(a.TAB_PREF);c||(c=Math.floor(1E12*Math.random()+1).toString(),m[a.storage].setItem(a.TAB_PREF,
c));return c};this.getIdentityEvent=function(){return m[a.storage].getItem(a.ID_PREF+a.extTenantId)};this.setIdentityEvent=function(c){c&&m[a.storage].setItem(a.ID_PREF+a.extTenantId,c)};this.removeIdentityEvent=function(){m[a.storage].removeItem(a.ID_PREF+a.extTenantId)}}f.prototype.getCookies=function(){for(var a=document.cookie.split(";"),c={},b=0;b<a.length;b++){var d=a[b].split("="),g=(d[0]+"").trim();c[g]=unescape(d[1])}return c};return f}();m.PersistenceService=q})($ci360||($ci360={}));
(function(m){(function(){var q={sessionStorage:"sessionStorage",localStorage:"localStorage"},f;for(f in q)(function(a){try{var c=window[a];c.setItem("a","b");c.getItem("a");c.removeItem("a");return!1}catch(b){return!0}})(f)?m[q[f]]={_data:{},setItem:function(a,c){return this._data[a]=String(c)},getItem:function(a){return this._data.hasOwnProperty(a)?this._data[a]:void 0},removeItem:function(a){return delete this._data[a]},clear:function(){return this._data={}}}:m[q[f]]=window[f]})()})($ci360||($ci360=
{}));
(function(m){var q=function(){function f(a,c,b){var d=this;this.spotNamesToIdsMap=new Map;this.buildSpotDefUrl=function(a){var c=a.domain||d.networkService.getDomain()||window.location.hostname,b=a.path||window.location.pathname;if(a.params){var g=[],l;for(l in a.params)g.push(encodeURIComponent(l)+"="+encodeURIComponent(a.params[l]));a=g.join("&");a=encodeURIComponent(a.replace(/[!'()*]/g,function(a){return"%"+a.charCodeAt(0).toString(16).toUpperCase()}))}else a=window.location.search;return d.isConfigValid()?"".concat(d.config.sdu,
"?domain=").concat(c,"&p=").concat(b,"&params=").concat(a):""};this.cachedSpotDefinitions={};this.getSpotDefsInternal=function(a,c,b){if(d.isConfigValid())if(c){var e=new XMLHttpRequest;e.onreadystatechange=function(){if(e.readyState===XMLHttpRequest.DONE&&200===e.status){var a=[];e.responseText&&(a=JSON.parse(e.responseText));d.cachedSpotDefinitions=a;b(null,a)}else e.readyState===XMLHttpRequest.DONE&&b(Error("Spot definitions could not be retrieved: ".concat(e.statusText)),null)};e.open("GET",d.buildSpotDefUrl(a));
e.send()}else b(null,d.cachedSpotDefinitions)};this.getSpotDefinitions=function(a,c){d.getSpotDefsInternal(a,!0,function(b,d){var e=new Map;if(!b){for(var g=[],h=0;h<d.length;h++){var k=d[h];if("spotSet"===k.spotType&&(!a.names||a.names&&-1<a.names.indexOf(k.spotName))){var f=0;for(k=k.spotList;f<k.length;f++)g.push(k[f])}}for(h=0;h<d.length;h++)k=d[h],(("spot"===k.spotType||"jsSpot"===k.spotType)&&(!a.names||a.names&&-1<a.names.indexOf(k.spotName))||-1<g.indexOf(k.spotId))&&e.set(k.spotName,{id:k.spotId,
selector:"spot"===k.spotType?k.selector:null,attributes:k.spotAttributes,elementSelectors:k.elementSelectors})}c(b,e)})};this.getCreativesUrls=function(a,c,b,k){var e=a.domain||d.networkService.getDomain()||window.location.hostname;d.getSpotDefsInternal(a,c,function(c,g){if(!c&&d.isConfigValid()){c=d.config.csu.replace("hserver","bserverj");c=c+"/ball/domain="+e;c+="/customerid="+d.configService.getDatahubId();c+="/sessionid="+(a.sid||d.config.sid);c+="/hint=x";for(var h=0,l=[],p=new Map,v=[],r=c,
q=[],A=d.getViewId(),D=new Map,H=0;H<g.length;H++){var x=g[H];if("spotSet"===x.spotType&&(!a.names||a.names&&-1<a.names.indexOf(x.spotName))){var I=d.getViewId(),C=0;for(x=x.spotList;C<x.length;C++){var E=x[C];v.push(E);D.set(E,I)}}else if(x.spotList&&0<x.spotList.length){b.set(x.spotName,{spotId:x.spotId});I=void 0;for(C=x.spotList;0<C.length;){I=d.util.hashCodeEncode(C[0]+A);break}D.set(x.spotId,I)}else b.set(x.spotName,{spotId:x.spotId}),D.set(x.spotId,A)}for(H=0;H<g.length;H++)if(x=g[H],("spot"===
x.spotType||"jsSpot"===x.spotType)&&(!a.names||a.names&&-1<a.names.indexOf(x.spotName))||-1<v.indexOf(x.spotId)){r.length>f.MAX_URL_SIZE&&(p.set(r,l),q.push(r),h=0,l=[],r=c);l.push("".concat(x.spotName));I="";A=void 0;a.attributes&&(A=a.attributes[x.spotName]);if(A)for(var B in A)"product_id"===B||"product_sku"===B?(C=A[B],null!=C&&C.trim&&C.trim(),B+="_key",I+="".concat(B,"=").concat(C,"/")):null!=A[B]&&d.containsAttribute(x.spotAttributes,B)&&(C=A[B],C.toString&&(I+="".concat(B,"=").concat(m.Base64.encode(C.toString().trim()).replace(/=/g,
""),"/")));r+="/b".concat(++h,"/spot_id=").concat(x.spotId,"/").concat(I,"viewid=").concat(D.get(x.spotId))}l.length&&(p.set(r,l),q.push(r));k(null,q,p,b)}else k(c,null,null,null)})};this.configService=a;this.networkService=c;this.util=b}f.prototype.init=function(a){this.config=this.configService.getConfig();a()};f.prototype.isConfigValid=function(){return!(!this.config||!this.config.sdu)};f.prototype.handleCreativesUrlResponse=function(a,c,b){return function(){if(a.readyState===XMLHttpRequest.DONE&&
200===a.status){var d=[];if(a.responseText)try{d=JSON.parse(a.responseText)}catch(g){b(Error("Creatives response could not be parsed: ".concat(g)),c,null)}b(null,c,d)}else a.readyState===XMLHttpRequest.DONE&&b(Error("Creatives could not be retrieved: ".concat(a.statusText)),c,null)}};f.prototype.getCreatives=function(a,c,b){var d=this,g=new Map;this.getCreativesUrls(a,c,g,function(c,h,k){if(c)b(c,null,null);else{var e=new Map,f=0,p=!0;c=function(c,h,l){if(!c&&p){f++;var n=c=0;h=k.get(h);for(var v=
0;v<l.length;v++){var r=l[v],u=h[c++],m=d.parseCreative(r);e.set(u,m);n+=d.addSpotNameToIds(u,r,g)}f===k.size&&(d.deleteSpotNamesToIds(n,g),b(null,e,a.attributes))}else p&&(p=!1,b(c,null,null))};if(k.size)for(var n=0;n<h.length;n++){var u=h[n],m=new XMLHttpRequest;m.onreadystatechange=d.handleCreativesUrlResponse(m,u,c);m.open("GET",u);m.send()}else b(null,new Map,a.attributes)}})};f.prototype.getPersonalizedCreative=function(a,c){var b=this;a.delay=a.delay||f.DELAY;a.retries=null!=a.retries?a.retries:
f.RETRIES;this.getCreatives(a,!0,function(d,g){d?c(d,null):1===g.size?g.forEach(function(d){d.creativeId?c(null,d):1>--a.retries?c(null,null):setTimeout(function(a,c){b.getPersonalizedCreative(a,c)},a.delay,a,c)}):0===g.size?c(Error("No creative found"),null):1<g.size&&c(Error("More than one creative found"),null)})};f.prototype.addSpotNameToIds=function(a,c,b){var d=0;(c=this.parseCreative(c))&&c.creativeId&&c.taskId&&(d++,a=b.get(a))&&(a.creativeId=c.creativeId,a.taskId=c.taskId,a.variantId=c.variantId,
a.isControlGroup=c.isCountrolGroup);return d};f.prototype.parseCreative=function(a){var c={content:-1<a.indexOf('data-recommender="Y"')||-1<a.indexOf("data-context-url")?a:a.replace(/<data .*<\/data>/,"").replace(/<data .*?\/>/,"")},b=a.match(/data-creativeID="([A-Za-z0-9-]+)"/i);if(b)b[1]&&(c.creativeId=b[1]);else if(b=a.indexOf('data-creativeID="'),-1<b){b+=17;var d=a.substring(b).indexOf('"')+b;(b=a.slice(b,d))&&0<b.length&&(c.creativeId=b)}c.creativeId&&((b=a.match(/data-taskID="([A-Za-z0-9-]+)"/i))&&
b[1]&&(c.taskId=b[1],(b=a.match(/data-variant_id="([A-Za-z0-9-]+)"/i))&&b[1]&&(c.variantId=b[1])),(a=a.match(/data-control="([A-Za-z0-9-]+)"/i))&&a[1]&&(c.isCountrolGroup=a[1]));return c};f.prototype.deleteSpotNamesToIds=function(a,c){var b=this,d=this.spotNamesToIdsMap.size-f.MAX_SPOT_NAMES_TO_CACHE+a;if(0<d){var g=0;this.spotNamesToIdsMap.forEach(function(a,c,b){g++<d&&b.delete(c)})}c.forEach(function(a,c){a.creativeId&&b.spotNamesToIdsMap.set(c,a)});c.clear()};f.prototype.decorateEvent=function(a){var c=
a.paramMap.get("eventName");if("clickthrough"===c||"impression"===c||"impressionViewable"===c)if(c=this.spotNamesToIdsMap.get(a.paramMap.get("spotName")))a.paramMap.set("spotId",c.spotId),a.paramMap.set("taskId",c.taskId),a.paramMap.set("creativeId",c.creativeId),c.variantId&&a.paramMap.set("variantId",c.variantId),c.isControlGroup&&("Y"===c.isControlGroup?a.paramMap.set("is_control_group","true"):"N"===c.isControlGroup&&a.paramMap.set("is_control_group","false")),a.paramMap.delete("spotName")};f.prototype.getViewId=
function(){return Math.floor(1E12*Math.random()+1).toString()};f.prototype.containsAttribute=function(a,c){for(var b=0;b<a.length;b++)if(a[b].name===c)return!0};f.MAX_URL_SIZE=1800;f.MAX_SPOT_NAMES_TO_CACHE=1E4;f.DELAY=1E3;f.RETRIES=30;return f}();m.SpotService=q})($ci360||($ci360={}));
(function(m){var q=function(){function f(){var a=this;this.extractParam=function(c,b){return b&&c&&(c=a.getUriInfoGeneric(b).searchObj[c])?c.replace(/\+/g," "):null};this.getJsVarValueSafe=function(c){c=a.tokenizeObjectString(c);return a.getVariableFromObjectString(c)};this.polyfill()}f.prototype.polyfill=function(){Element.prototype.matches||(Element.prototype.matches=Element.prototype.msMatchesSelector||Element.prototype.webkitMatchesSelector)};f.prototype.isSelectorValid=function(a){var c=document.createElement("br");
a:{try{c.querySelector(a)}catch(b){a=!1;break a}a=!0}return a};f.prototype.loadDoc=function(a,c){try{var b=new XMLHttpRequest;b.onreadystatechange=function(){4==b.readyState&&200==b.status&&(c.innerHTML=b.responseText)};b.open("GET",a,!0);b.send()}catch(d){}};f.prototype.getElementsBySelector=function(a,c){var b=[],d=c;try{var g=a.indexOf(":contains("),e=void 0;-1!==g&&(e=a.substring(g,a.length),a=a.substring(0,g));0===a.indexOf(">")&&(a=a.slice(1).trim());if(!this.isSelectorValid(a))return b;null!=
c&&(d=document);null!=d.matches&&d.matches(a)&&(b=b.concat(d));var h=d.querySelectorAll(a);if(null!=h&&0<h.length)for(a=0;a<h.length;a++){var k=h[a];c=!0;if(-1!==g){var l=e.substring(10,e.length-1);if(-1===k.innerText.indexOf(l)||-1===k.innerHTML.indexOf(l))c=!1}c&&(b=b.concat(k))}}catch(v){}return b};f.prototype.getElementAncestor=function(a,c,b){null==b&&(b=!1);if(b&&a.matches(c))return a;for(;a.parentElement;){b=a.parentElement;if(b.matches(c))return b;a=a.parentElement}return null};f.prototype.hashCodeEncode=
function(a){var c=0;if(0===a.length)return c;for(var b=0;b<a.length;b++){var d=a.charCodeAt(b);c=(c<<5)-c+d;c|=0}return Math.abs(c)};f.prototype.querySelectorShadow=function(a,c){try{var b=null===c||void 0===c?void 0:c.split("&&");for(c=0;c<b.length;c++)a=a!==document.body&&a.shadowRoot?a.shadowRoot.querySelector(b[c]):a.querySelector(b[c])}catch(d){}return a};f.prototype.extractDomain=function(a){try{var c=a.match(/^\s*\S+?:\/\/([^\/:?#]+)(?:[\/:?#]|$)/i);return c&&c[1]}catch(b){return null}};f.prototype.remove=
function(a,c){for(var b=0;b<c.length;b++)a=a.replace(new RegExp("(&?)"+c[b]+"=.*?(&|$)","g"),function(a,c,b){return c&&b});return a};f.prototype.getUriInfoGeneric=function(a){var c=document.createElement("a");c.href=a;a="";for(var b=this.remove(c.search.substring(1),["_ga","adobe_mc"]),d=b.split("&"),g={},e=0;e<d.length;e++){var h=d[e].split("=");"_ci_"===h[0]?a=h[1]:g[decodeURIComponent(h[0])]=decodeURIComponent(h[1]||"")}b=this.remove(b,["_ci_"]);return{protocol:c.protocol.replace(":",""),host:c.hostname,
port:c.port,path:("/"!==c.pathname.charAt(0)?"/":"")+c.pathname,search:b,searchObj:g,cdt:a}};f.prototype.getUriInfo=function(){return this.getUriInfoGeneric(document.URL)};f.prototype.getMeta=function(a){for(var c=document.getElementsByTagName("meta"),b=c.length,d=0;d<b;d++)if(c[d].getAttribute("name")===a)return c[d].getAttribute("content");return""};f.prototype.getMetas=function(){for(var a=document.getElementsByTagName("meta"),c={},b=a.length,d=["name","property","itemprop","http-equiv"],g=0;g<
b;g++)for(var e=a[g],h=!1,k=0;k<d.length&&!h;k++){var l=e.getAttribute(d[k]);l&&(h=!0,c[l]=e.getAttribute("content"))}return c};f.prototype.getDataAttributes=function(a){var c={};if(!(a&&a instanceof HTMLElement))return c;var b=function(a){if(null===a||void 0===a?0:a.dataset){a=null===a||void 0===a?void 0:a.dataset;for(var b in a)a.hasOwnProperty(b)&&(c[b]=a[b])}};b(a);a=a.querySelectorAll("*");null===a||void 0===a?void 0:a.forEach(function(a){a&&a instanceof HTMLElement&&b(a)});return c};f.prototype.isString=
function(a){return a&&"string"===typeof a};f.prototype.nextChar=function(a,c,b){var d=a.indexOf(c);a=a.indexOf(b);return-1===d&&-1==a?"":-1===d?b:-1===a?c:d<a?c:b};f.prototype.tokenizeObjectString=function(a){for(var c=[];0<a.length;){var b=a.indexOf("."),d=a.indexOf("[");if(0!==b&&0!==d){var g=this.nextChar(a,".","[");"."===g?(c.push(a.substring(0,b)),a=a.slice(b)):"["===g?(c.push(a.substring(0,d)),a=a.slice(d)):(c.push(a),a="")}else 0===b?(a=a.slice(1),g=this.nextChar(a,".","["),""!==g?(d=a.indexOf(g),
c.push(a.substring(0,d)),a=a.slice(d)):(c.push(a),a="")):0===d?(b=a.charAt(1),"'"===b||'"'===b?(d+=1,b=a.charAt(d),b=a.slice(d+1).indexOf(b)+d+1,g=b+1,c.push(a.substring(d+1,b))):(g=a.indexOf("]"),c.push(a.substring(1,g))),a=a.slice(g+1)):a=""}return c};f.prototype.getVariableFromObjectString=function(a){for(var c=a.length,b=0,d=window;null!=d&&b<c;)d=d[a[b++]];return b&&b===c?d:void 0};f.prototype.debounce=function(a,c,b){function d(c){var b=l,d=f;l=f=void 0;m=c;return p=a.apply(d,b)}function g(a){var b=
a-u;a-=m;return void 0===u||b>=c||0>b||r&&a>=A}function e(){var a=Date.now();if(g(a))return h(a);var b=a-m;a=c-(a-u);n=setTimeout(e,r?Math.min(a,A-b):a)}function h(a){n=void 0;if(q&&l)return d(a);l=f=void 0;return p}function k(){for(var a=[],b=0;b<arguments.length;b++)a[b]=arguments[b];b=Date.now();var h=g(b);l=a;f=this;u=b;if(h){if(void 0===n)return m=a=u,n=setTimeout(e,c),t?d(a):p;if(r)return n=setTimeout(e,c),d(u)}void 0===n&&(n=setTimeout(e,c));return p}void 0===c&&(c=0);var l,f,p,n,u,m=0,t=!1,
r=!1,q=!0;if("function"!==typeof a)throw new TypeError("Expected a function");if(b){t=!!b.leading;var A=(r="maxWait"in b)?Math.max(+b.maxWait||0,c):A;q="trailing"in b?!!b.trailing:q}k.flush=function(){return void 0===n?p:h(Date.now())};k.pending=function(){return void 0!==n};return k};f.prototype.throttle=function(a,c,b){var d=!0,g=!0;if("function"!==typeof a)throw new TypeError("Expected a function");b&&(d="leading"in b?!!b.leading:d,g="trailing"in b?!!b.trailing:g);return this.debounce(a,c,{leading:d,
trailing:g,maxWait:c})};f.prototype.filterElemsBySelector=function(a,c){for(var b=[],d=0;d<c.length;d++){a instanceof HTMLElement&&a.matches(c[d])&&b.concat(a);for(var g=a.querySelectorAll(c[d]),e=g.length,h=0;h<e;h++)b=b.concat(g[h])}return b};return f}();m.Util=q})($ci360||($ci360={}));
(function(m){var q=function(){function f(a,c,b,d,g,e,h){var k=this;this.mutationObserverTopLevel=this.listenerTopLevel=document;this.clickEventSelectors=["button","a",'input[type="button"]','input[type="radio"]','input[type="checkbox"]'];this.formSubmitSelectors=['form input[type="submit"]','form input[type="button"]','form button[type="submit"]','form button[type="button"]'];this.formFieldSelectors=["input","select"];this.formFieldChangeMap={};this.anonymousFormFieldCount=0;this.CI360_ID_KEY="ci360Id";
this.CI360_SPOT_NAME="ci360_spotName";this.CI360_SPOT_ATTRIBUTES="ci360_spotAttributes";this.CI360_SPOT_DATA_TAGS="ci360_spotDataTags";this.SCROLL_PERIOD_MS=50;this.VERSION="2.1";this.DATA_TAG_TO_EVENT_MAP={taskid:"task_id",creativeid:"creative_id",productid:"product_id",productsku:"product_sku",control:"is_control_group","context-url":"context_url",recgroup:"rec_group"};this.spotCount=0;this.spotIds=[];this.spotsToWatchOnScroll=[];this.eventCount=this.mediaEventCount=this.jsVarChangeCount=this.contentChangeCount=
0;this.opMapping={STARTS_WITH:"startsWith",REGEX:"regex",CONTAINS:"contains",EQUAL:"equals",ENDS_WITH:"endsWith",after_last:"afterLast",before_last:"beforeLast",regex:"regularExpression",regularExpression:"regularExpression",everything:"everything",before:"before",after:"after",between:"between",afterLast:"afterLast",beforeLast:"beforeLast",none:"none"};this.newSpotsWaiting=this.injectResponseLock=this.shadowMutationObservers=!1;this.shadowRoots=[];this.onLoad=function(){k.shadowMutationObservers&&
(k.shadowRoots=k.getShadowRoots());k.handleSpots();k.initFormFieldChangeCollection();k.initMutationObserver();k.initJsvarchangeWatchers();k.loadEventHandler();k.initMedia();k.initScrollListener();k.initCart();k.initUrlWatchers();k.initVisibilityChange()};this.propertyMap={product_id:"id",product_name:"name",product_sku:"sku",product_group:"group",product_unit_price_num:"unitPrice",availability_message:"availabilityMessage",shipping_message:"shippingMessage",savings_message:"savingsMessage",product_quantity_num:"quantity"};
this.scrollHandler=function(){if(0<k.spotsToWatchOnScroll.length)for(var a=0;a<k.spotsToWatchOnScroll.length;a++){var c=k.spotsToWatchOnScroll[a];if(k.isElementInViewport(c)){var b={eventName:"impressionViewable",spotName:c[k.CI360_SPOT_NAME]},d=c[k.CI360_SPOT_ATTRIBUTES];c=c[k.CI360_SPOT_DATA_TAGS];for(var e in d){var g=!0,h=d[e];!c.recommender||"Y"!==c.recommender||"product_id"!==e&&"product_sku"!==e||(g=!1);g&&(b[e]=h)}for(var f in c)h=c[f],b[f]=h;k.decorateEventAndSend(b);k.spotsToWatchOnScroll.splice(a,
1)}}};this.handleHTML5callback=function(a){var c;"play"===a.type?c="start":"pause"===a.type?c="stop":"ended"===a.type&&(c="end");null!=c&&(a=a.target,c={eventName:"media",id:a.id,url:a.currentSrc,player:"Html5",position:Math.floor(a.currentTime),duration:Math.floor(a.duration),action:c},a=k.configService.getThresholds().mxMd,a&&k.mediaEventCount>=a||(k.mediaEventCount++,k.decorateEventAndSend(c)))};this.changeEventListenerHandler=function(a){a=a.target;var c="";null!=a.id?c=a.id:null!=a[k.CI360_ID_KEY]&&
(c=a[k.CI360_ID_KEY]);var b=k.formFieldChangeMap[c];null!=b&&(k.formFieldChangeMap[c]=++b);k.changeEventHandler(a)};this.spotsOnPageMap=new Map;this.getSpotDefinitionsCallback=function(a,c){null==a&&(k.spotDefinitionSelectors=c,k.addFoundSelectorsToPageMap(c,document))};this.getCreativesCallback=function(a,c,b){null==a&&(c.forEach(function(a,b){if(a=this.spotsOnPageMap.get(b))a.creative=c.get(b),a.isCreativeRequested=!0},k),k.injectResponse(b))};this.doesPageRuleMatch=function(a){if(!a)return!1;var c=
a.cookieList;if(c)for(var b=0;b<c.length;b++){var d=c[b],e=d[1],g=d[2];d=k.persistenceService.getCookie(d[0]);if(!k.comparisonHelper(e,d,g))return!1}if(a=a.s)for(b=0;b<a.length;b++){c=a[b];e=void 0;try{e=document.querySelector(c)}catch(t){return!1}if(!e)return!1}return!0};this.topLevelListenerHandler=function(a){var c=a.target;a.composedPath&&(c=a.composedPath()[0]);for(a=0;a<k.clickEventSelectors.length;a++){var b=k.clickEventSelectors[a];if(c.matches(b)){k.clickEventHandler(c);break}else if(b=k.util.getElementAncestor(c,
b)){k.clickEventHandler(c,b);break}}for(a=0;a<k.formSubmitSelectors.length;a++)if(c.matches(k.formSubmitSelectors[a])){k.submitEventHandler(c);break}"BUTTON"===c.tagName&&"submit"===c.type&&null!=c.form&&k.submitEventHandler(c);var d=k.configService.getIdentityEventConfigs(),e;d&&(e=k.configService.getIdentityEventConfigs().click);if(e)for(a=0;a<e.length;a++)if(b=e[a],c.matches(b.ct)){var g=b.uid;if(g){g=g[0];var h=k.identityHelper(g,k.opMapping);h&&(g={loginId:h,loginEventType:b.let,obfuscateFields:"["+
(g.o&&'"loginId"'||'""')+"]"},(!b.pr||b.pr&&k.doesPageRuleMatch(b.pr))&&k.configService.attachIdentity(g))}}var f;d&&(f=k.configService.getIdentityEventConfigs().formSubmit);if(f)for(a=0;a<f.length;a++)if(b=f[a],(e=b.uidf)&&(d=document.querySelector(e.s))&&c.form===d&&(d=e.e&&e.e[0])){h=d.i;var l=d.n;e=d.o;g=void 0;h?g="#"+h:l&&(g='[name="'+l+'"]');g&&(h={},k.addAttributeToObj(g,"value",k.opMapping[d.f],d.p,"value",h),d=h.value,k.util.isString(d)&&(d=d.toLowerCase().trim(),g={loginId:d,loginEventType:b.let,
obfuscateFields:"["+(e&&'"loginId"'||'""')+"]"},(!b.pr||b.pr&&k.doesPageRuleMatch(b.pr))&&k.configService.attachIdentity(g)))}for(a=0;a<k.spotIds.length;a++){f=k.spotIds[a];b=c;e=!1;if(b.getAttribute("id")!==f||e)for(;!e&&(b=b.parentElement);)b.getAttribute("id")===f&&(e=!0);else e=!0;if(e){f={eventName:"clickthrough",spotName:b[k.CI360_SPOT_NAME]};e=b[k.CI360_SPOT_ATTRIBUTES];d=b[k.CI360_SPOT_DATA_TAGS];for(var m in e)g=!0,b=e[m],!d.recommender||"Y"!==d.recommender||"product_id"!==m&&"product_sku"!==
m||(g=!1),g&&(f[m]=b);for(var q in d)b=d[q],f[q]=b;null!=window.event&&(b=k.util.getElementAncestor(window.event.target,"a",!0),null!=b&&null!=b.href&&(f.uri=b.href,f.referrer=document.URL));k.decorateEventAndSend(f)}}if(k.cartActionConfigs)for(a=0;a<k.cartActionConfigs.length;a++)m=k.cartActionConfigs[a],c.matches(m.clickTargetSelector)&&(f={eventName:"cartaction",action:m.action},m.itemInfo.name&&(q=document.querySelector(m.itemInfo.name.selector),b=void 0,"innerText"===m.itemInfo.name.attribute&&
(b=q.innerHTML),b&&(f.productName=b)),k.decorateEventAndSend(f));c.ci360_cartRemoveObject&&(f=c.ci360_cartRemoveObject,k.decorateEventAndSend(f))};this.eventService=a;this.spotService=c;this.persistenceService=b;this.util=d;this.configService=g;this.encodingService=e;this.networkService=h}f.prototype.init=function(a){if(!window.ci360_initialized){window.ci360_initialized=!0;"1"===this.configService.getThresholds().smo&&(this.shadowMutationObservers=!0);var c=this.configService.getHiddenClass(),b=
"function"===typeof document.querySelectorAll;if(b)for(var d=document.querySelectorAll("."+c),g=d.length,e=0;e<g;e++){var h=d[e];h&&h.style&&(h.style.visibility="hidden")}b&&setTimeout(function(){for(var a=document.querySelectorAll("."+c),b=a.length,d=0;d<b;d++){var e=a[d];e&&e.style&&(e.style.visibility="visible")}},2E3);this.establishTopLevelListener();if("complete"===document.readyState||"interactive"===document.readyState)this.onLoad();else window.addEventListener("load",this.onLoad);a()}};f.prototype.initVisibilityChange=
function(){var a=this.configService.getCollectRules();if(a&&(!0===a.contentevents||"true"===a.contentevents)&&"undefined"!==typeof document.hidden){var c=this;document.addEventListener("visibilitychange",function(){c.decorateEventAndSend({eventName:"visibilityChange",uri:document.URL,hidden:document.hidden})})}};f.prototype.addAttributeToObj=function(a,c,b,d,g,e,h){h||(h=document);var k;this.util.isSelectorValid(a)&&(k=h.querySelector(a));k&&(a=void 0,c&&"innerText"===c?a=k.innerText:c&&"innerHTML"===
c?a=k.innerHTML:c&&"outerHTML"===c?a=k.outerHTML:c&&"value"===c?a=k.value?k.value:k.getAttribute("value"):c&&(a=k.getAttribute(c)),a&&(c=this.filterValue(a,b,d),""!==c&&(e[g]=c)))};f.prototype.filterValue=function(a,c,b){var d=a;c&&b&&("before"===c?(c=a.indexOf(b),d=-1===c?"":a.slice(0,c)):"after"===c?(c=a.indexOf(b),d=-1===c?"":a.slice(c+b.length)):"beforeLast"===c?(c=a.lastIndexOf(b),d=-1===c?"":a.slice(0,c)):"afterLast"===c?(c=a.lastIndexOf(b),d=-1===c?"":a.slice(c+b.length)):"between"===c?(b=
b.split("__&&__"),c=a.indexOf(b[0]),d=a.indexOf(b[1]),d=0<=c&&0<=d?a.substring(c+b[0].length,d):0<=c?a.substring(c+b[0].length):0<=d?a.substring(0,d):a):"regularExpression"===c&&(d=(a=(new RegExp(b)).exec(a))?a[0]:""));return d};f.prototype.initCart=function(){var a=this.configService.getCartConfiguration();if(a)for(var c=0;c<a.length;c++){var b=a[c],d={eventName:"cart",action:b.action,name:b.name,cart_id_internal:b.internalCartId};if(b.productAttributes){for(var g=[],e=b.productAttributes,h=document.querySelectorAll(b.rowSelector),
k=0;k<h.length;k++){var f=h[k],m={},p;for(p in e){var n=e[p];this.addAttributeToObj(n[0],n[1],this.opMapping[n[2]],n[3],this.propertyMap[p],m,f)}g.push(m);b.removeRules&&this.handleCartRemoveRules(f,b.removeRules,m,d)}d.items=g}this.decorateEventAndSend(d)}};f.prototype.handleCartRemoveRules=function(a,c,b,d){for(var g=[],e="",h=0;h<c.length;h++){var k=c[h],f=k[1];if("regex"===f)g.push(k);else{var m=k[0];k=k[2];var p="";switch(f){case "equals":p="=";break;case "contains":p="*=";break;case "startsWith":p=
"^=";break;case "endsWith":p="$="}e+="["+m+p+'"'+k+'"]'}}a=0<e.length?a.querySelectorAll(e):[];c=[];for(e=0;e<a.length;e++){h=a[e];f=!0;for(m=0;m<g.length;m++){var n=g[m];k=n[1];p=n[2];n=this.targetAttributeHelper(n[0],h);if(!this.comparisonHelper(k,n,p)){f=!1;break}}f&&c.push(h)}(g=c[0])&&(g.ci360_cartRemoveObject={eventName:"cartaction",action:"remove",cartId:d.id,cartName:d.name,cartType:d.action,productId:b.id,productName:b.name,productSku:b.sku,quantity:b.quantity,unitPrice:b.unitPrice})};f.prototype.targetAttributeHelper=
function(a,c){return"tagName"===a?c.tagName.toLowerCase():c.getAttribute(a)};f.prototype.initScrollListener=function(){var a=this.util.throttle(this.scrollHandler,this.SCROLL_PERIOD_MS,{trailing:!0});window.addEventListener("scroll",a,!1)};f.prototype.initMedia=function(){var a=this.configService.getCollectRules();!a||!0!==a.media&&"true"!==a.media||this.handleMedia(document);for(a=0;a<this.shadowRoots.length;a++)this.handleMedia(this.shadowRoots[a].shadowRoot)};f.prototype.handleMedia=function(a){var c=
this.testYoutube(a);c&&c.length&&this.handleYouTube(c);(a=this.testHTML5(a))&&a.length&&this.handleHTML5(a)};f.prototype.handleHTML5=function(a){for(var c=0;c<a.length;c++){var b=a[c];b.addEventListener("play",this.handleHTML5callback);b.addEventListener("pause",this.handleHTML5callback);b.addEventListener("ended",this.handleHTML5callback)}};f.prototype.testHTML5=function(a){return this.util.filterElemsBySelector(a,["video","audio","embed[html5='true'"])};f.prototype.handleYouTube=function(a){var c=
this;if("undefined"!==typeof window.YT)this.handleYouTubeIframes(a);else{var b=document.createElement("script"),d=document.getElementsByTagName("script")[0];b.src="//www.youtube.com/iframe_api";d.parentNode.insertBefore(b,d)}var g;null!=window.onYouTubeIframeAPIReady&&(g=window.onYouTubeIframeAPIReady);window.onYouTubeIframeAPIReady=function(){null!=g&&(g(),g=null);c.handleYouTubeIframes(a)}};f.prototype.testYoutube=function(a){var c=[],b=[];a instanceof HTMLIFrameElement&&"IFRAME"===a.tagName?c.push(a):
c=Array.prototype.slice.call(a.querySelectorAll("iframe"));for(a=0;a<c.length;a++)/youtube.com\/embed/.test(c[a].src)&&b.push(c[a]);return b};f.prototype.handleYouTubeIframes=function(a){var c=this;this.enableYouTubeAPI(a);for(var b=function(b){var d=a[b];if(!d.ci360_media&&(b=window.YT,null!=b)){var g=b.get(d.id);null==g&&(g=new b.Player(d));d.ci360_media=!0;g.addEventListener("onStateChange",function(a){var b;1===a.data?b="start":2===a.data?b="stop":0===a.data&&(b="end");null!=b&&(a={eventName:"media",
id:d.id,url:g.getIframe().src,player:"YouTube",position:parseInt(g.getCurrentTime()),duration:parseInt(g.getDuration()),action:b},b=c.configService.getThresholds().mxMd,b&&c.mediaEventCount>=b||(c.mediaEventCount++,c.decorateEventAndSend(a)))})}},d=0;d<a.length;d++)b(d)};f.prototype.enableYouTubeAPI=function(a){for(var c=0;c<a.length;c++)-1===a[c].src.indexOf("enablejsapi=")&&(a[c].src+=(-1===a[c].src.indexOf("?")?"?":"&")+"enablejsapi=1")};f.prototype.genericFormFieldChangeCollection=function(a){for(var c=
[],b=0,d=this.formFieldSelectors;b<d.length;b++)for(var g=a.querySelectorAll(d[b]),e=g.length,h=0;h<e;h++){var k=g[h];null!=k.form&&c.push(k)}for(a=0;a<c.length;a++)b=c[a],null==b.id||""===b.id?(d="ci360Id_"+ ++this.anonymousFormFieldCount,b[this.CI360_ID_KEY]=d):d=b.id,this.formFieldChangeMap[d]=0,b.addEventListener("change",this.changeEventListenerHandler)};f.prototype.initFormFieldChangeCollection=function(){this.genericFormFieldChangeCollection(document);if(this.shadowMutationObservers)for(var a=
0;a<this.shadowRoots.length;a++)this.genericFormFieldChangeCollection(this.shadowRoots[a].shadowRoot)};f.prototype.handleSpots=function(){var a=this.util.getUriInfo(),c={};c.domain=this.networkService.getDomain();c.path=a.path;c.params=a.searchObj;this.spotService.getSpotDefinitions(c,this.getSpotDefinitionsCallback)};f.prototype.addFoundSelectorsToPageMap=function(a,c){a.forEach(function(b,d){b=a.get(d).selector;var g=a.get(d).attributes;var e=a.get(d).elementSelectors;var h=!0;if(e&&0<e.length)for(var k=
0;k<e.length&&h;k++)document.querySelector(e[k])||(h=!1);if(h)if(b){if(e=null!=c.parentElement?null!=this.util.querySelectorShadow(c.parentElement,b):null!=this.util.querySelectorShadow(c,b))this.spotsOnPageMap.set(d,{selector:b,attributes:g,isJsSpot:!1,isCreativeRequested:!1}),this.spotDefinitionSelectors.delete(d)}else this.spotsOnPageMap.set(d,{attributes:g,isJsSpot:!0}),this.spotDefinitionSelectors.delete(d)},this);this.injectResponseLock?this.newSpotsWaiting=!0:this.requestCreatives(!1)};f.prototype.getShadowRoots=
function(){for(var a=[],c="article aside blockquote body div footer h1 h2 h3 h4 h5 h6 header main nav p section span".split(" "),b="",d=0;d<c.length;d++)b+=c[d]+",";b=b.slice(0,-1);c=document.querySelectorAll(b);for(d=0;d<c.length;d++)b=c[d],b.shadowRoot&&a.push(b);return a};f.prototype.initMutationObserver=function(){var a=this,c=this.mutationObserverTopLevel,b={attributes:!0,childList:!0,subtree:!0,attributeOldValue:!0},d=function(b){for(var c=0;c<b.length;c++){var d=b[c];if("childList"===d.type){var g=
!0,f=d.addedNodes&&d.addedNodes[0];f&&f.nodeType===Node.ELEMENT_NODE?"SCRIPT"===f.tagName&&(g=!1):f&&f.nodeType===Node.TEXT_NODE&&(g=!1);g&&(g=d.target,null!=a.spotDefinitionSelectors&&a.addFoundSelectorsToPageMap(a.spotDefinitionSelectors,g),a.genericFormFieldChangeCollection(g),a.handleMedia(g))}a.contentChangeEventHandler(d)}};(new MutationObserver(d)).observe(c,b);if(this.shadowMutationObservers)for(c=0;c<this.shadowRoots.length;c++)(new MutationObserver(d)).observe(this.shadowRoots[c].shadowRoot,
b)};f.prototype.contentChangeEventHandler=function(a){var c=this.configService.getCollectRules();if(!(!c||!0!==c.contentevents&&"true"!==c.contentevents||(c=this.configService.getThresholds().mxCC,c&&this.contentChangeCount>=c))){c=a.target;var b=this.configService.getContentChangeInfo();if(null!=b)for(var d=0;d<b.length;d++){var g=b[d],e=g.selector;try{if(c.matches(e)){var h=void 0,f=void 0,l=void 0,m=void 0;if("childList"===a.type)if(0<a.addedNodes.length){var p=void 0;if(1===a.addedNodes.length){var n=
a.addedNodes[0];n.nodeType===Node.TEXT_NODE&&(p=n.nodeValue)}var u=void 0;if(1===a.removedNodes.length){var q=a.removedNodes[0];null!=q&&q.nodeType===Node.TEXT_NODE&&(u=q.nodeValue)}null!=p?(h="attribute",f="innerText",l=u,m=p):h="childadd"}else 0<a.removedNodes.length&&(h="childremove");else"attributes"===a.type?(h="attribute",f=a.attributeName,l=a.oldValue,m=c.getAttribute(a.attributeName)):"characterData"===a.type&&c.nodeType===Node.TEXT_NODE&&(h="attribute",f="innerText",l=a.oldValue,m=c.nodeValue);
p=void 0;var t=c.getAttribute("name");null!=t&&""!==t&&(p=t);var r={eventName:"contentchange",id:null!=c.id?c.id:"",selector:e,eventuid:g.eventuid};null!=h&&(r.type=h);null!=p&&(r.name=p);null!=f&&(r.attributeName=f);null!=m&&(r.newValue=m);null!=l&&(r.oldValue=l);this.contentChangeCount++;this.decorateEventAndSend(r)}}catch(w){}}}};f.prototype.requestCreatives=function(a){if(0<this.spotsOnPageMap.size&&!this.configService.getConfig().uis){this.injectResponseLock=!0;var c={},b=this.util.getUriInfo(),
d={},g=[];this.spotsOnPageMap.forEach(function(a,b){g.push(b);a=this.getSpotAttributes(b,this.spotsOnPageMap.get(b).attributes);d[b]=a},this);c.domain=this.networkService.getDomain();c.path=b.path;c.params=b.searchObj;c.names=g;c.attributes=d;this.spotService.getCreatives(c,a,this.getCreativesCallback)}};f.prototype.getSpotAttributes=function(a,c){a={};if(c)for(var b=0;b<c.length;b++){var d=c[b],g=d.name,e=void 0,h=this.util.getUriInfo(),f=this.util.getUriInfoGeneric(document.referrer);switch(d.type){case "pageElement":h=
d.value;null!=h&&(h=document.querySelector(h),null!=h&&(e=d.attribute,e=null!=e?h[e]:h instanceof HTMLInputElement?h.value:h.innerHTML));break;case "urlDomain":e=this.networkService.getDomain();break;case "urlPath":e=h.path;break;case "urlPathLevel":f=d.value;null!=f&&(e=h.path.split("/")[parseInt(f)]);break;case "urlQueryParameter":f=d.value;null!=f&&(h=h.searchObj[f],null!=h&&(e=h));break;case "urlQueryString":e=h.search;break;case "cookie":e=this.persistenceService.getCookie(d.value);break;case "pageTitle":e=
document.title;break;case "pageId":e=h.searchObj.page_id;e=null!=e?e:void 0;break;case "metaTag":e=this.util.getMeta(d.value);break;case "jsVariable":e=this.util.tokenizeObjectString(d.value);e=this.util.getVariableFromObjectString(e);break;case "referrerUrlDomain":e=f.host;break;case "referrerUrlPath":e=f.path;break;case "referrerUrlQueryParameter":e=this.util.extractParam(d.value,document.referrer)}null!=e&&(d.filter&&"none"!==d.filter&&(e=this.filterValue(e,this.opMapping[d.filter],d.pattern)),
a[g]=e)}return a};f.prototype.injectResponse=function(a){this.spotsOnPageMap.forEach(function(c,b){if((c=this.spotsOnPageMap.get(b))&&c.creative&&null!=c.creative.creativeId){if(c.isJsSpot){this.decorateEventAndSend({eventName:"impression",spotName:b});try{var d=document.createElement("script");d.type="text/javascript";var g="try { "+c.creative.content+";if (typeof ci360 !== 'undefined') {ci360('send', {'eventName': 'impressionViewable','spotName':\""+b+'",});}}catch(e) {console.log("error in jsCreative");console.log(e);}';
try{d.appendChild(document.createTextNode(g));for(var e=document.querySelectorAll("script"),h=!1,f=void 0,l=0;l<e.length&&!h;l++){var m=e[l];m.nonce&&(h=!0,f=m.nonce)}d.nonce=f;document.head.appendChild(d)}catch(w){d.text=g,document.head.appendChild(d)}}catch(w){}}else if(e=this.util.querySelectorShadow(document,c.selector),null!=e){g=document.createElement("div");d="ci360Spot_"+ ++this.spotCount;g.setAttribute("id",d);m=c.creative.content;var p=void 0;c={};try{p=(new DOMParser).parseFromString(m,
"text/html");var n=p.getElementsByTagName("data");if(n)for(l=0;l<n.length;l++){var u=n[l].attributes;if(0<u.length){var q=u[0].name.toLowerCase(),t=u[0].value;0===q.indexOf("data-")&&(q=q.slice(5,q.length));this.DATA_TAG_TO_EVENT_MAP[q]?c[this.DATA_TAG_TO_EVENT_MAP[q]]=t:c[q]=t}}}catch(w){}-1<m.indexOf("data-context-url")?(l="",(n=m.match(/<data data-context-url="(.*?)"/i))&&n[1]?l=n[1]:(n=m.match(/<data data-context-url ?=(.*)><\/data>/))&&n[1]&&(l=n[1]),this.util.loadDoc(l,g)):g.innerHTML=m;null!=
e.parentNode&&("DIV"!==e.tagName?e.parentNode.replaceChild(g,e):(e.innerHTML="",e.appendChild(g)));g.style&&(g.style.width="100%",g.style.height="100%",g.style.visibility="visible");g.spotPlaced=!0;l=a[b];q={eventName:"impression",spotName:b};for(h in l)n=!0,u=l[h],!c.recommender||"Y"!==c.recommender||"product_id"!==h&&"product_sku"!==h||(n=!1),n&&(q[h]=u);for(var r in c)u=c[r],q[r]=u;this.decorateEventAndSend(q);g[this.CI360_SPOT_NAME]=b;g[this.CI360_SPOT_ATTRIBUTES]=l;g[this.CI360_SPOT_DATA_TAGS]=
c;if(this.isElementInViewport(g)){r={eventName:"impressionViewable",spotName:b};for(h in l)n=!0,u=l[h],!c.recommender||"Y"!==c.recommender||"product_id"!==h&&"product_sku"!==h||(n=!1),n&&(r[h]=u);for(f in c)u=c[f],r[f]=u;this.decorateEventAndSend(r)}else this.spotsToWatchOnScroll.push(g);this.spotIds.push(d)}this.spotsOnPageMap.delete(b)}else c&&c.isCreativeRequested&&((h=this.util.querySelectorShadow(document,c.selector))&&h.style&&(h.style.visibility="visible"),this.spotsOnPageMap.delete(b))},this);
this.injectResponseLock=!1;this.newSpotsWaiting&&(this.newSpotsWaiting=!1,this.requestCreatives(!1))};f.prototype.isElementInViewport=function(a){if("undefined"!==typeof a.getBoundingClientRect())a=a.getBoundingClientRect();else if("undefined"!==typeof(a.parentElement&&a.parentElement.getBoundingClientRect()))a=a.parentElement.getBoundingClientRect();else return!1;var c=a.height*a.width,b=0,d=0,g=0,e=0;0>a.top&&(b=-1*a.top);0>a.left&&(g=-1*a.left);0>window.innerWidth-a.right&&(e=-1*(window.innerWidth-
a.right));0>window.innerHeight-a.bottom&&(d=-1*(window.innerHeight-a.bottom));b+=d;b>a.height&&(b=a.height);g+=e;g>a.width&&(g=a.width);return.5<=(c-(b*a.width+g*a.height))/c?!0:!1};f.prototype.establishTopLevelListener=function(){this.listenerTopLevel.addEventListener("click",this.topLevelListenerHandler,!0)};f.prototype.identityHelper=function(a,c){var b=a.p,d=a.f,g=a.ds;if("pageElement"===g){g=a.a;var e={};this.addAttributeToObj(a.s,g,c[d],b,g,e);e=e[g]}else"jsVariable"===g?(a=a.dsv,a=this.util.tokenizeObjectString(a),
a=this.util.getVariableFromObjectString(a),e=this.filterValue(a,c[d],b)):"urlQueryParameter"===g?(a=a.dsv,a=this.util.extractParam(a,window.location.href),e=this.filterValue(a,c[d],b)):"cookie"===g&&(a=a.dsv,a=this.persistenceService.getCookie(a),e=this.filterValue(a,c[d],b));this.util.isString(e)&&(e=e.toLowerCase().trim());return e};f.prototype.getElementPath=function(a){var c=[];c.unshift(null!=a.id&&null!=a.id&&""!=a.id?a.id:a.nodeName);if(a=a.parentElement)for(;null!=(a=a.parentElement);)null!=
a.id&&""!=a.id?c.unshift(a.id):c.unshift(a.nodeName);return"//#document/"+c.join("/")};f.prototype.getElementFullSelector=function(a){for(var c=this.getElementSelector(a);null!=(a=a.parentElement);)c=this.getElementSelector(a)+" > "+c;return c};f.prototype.getElementSelector=function(a){if(null==a)return"";var c=a.tagName.toLowerCase();if("body"!=c&&"html"!=c){var b=a.getAttribute("id"),d=a.getAttribute("class");a=a.getAttribute("name");if(b)c=0<=b.indexOf(".")?c+("[id='"+b+"']"):c+("#"+b);else{if(d)for(b=
d.split(/\s+/),d=0;d<b.length;d++)c+="."+b[d].trim();a&&(c+="[name='"+a+"']")}}return c};f.prototype.clickEventHandler=function(a,c){var b=this.configService.getCollectRules();if(b&&(!0===b.clicks||"true"===b.clicks)){b=[];if(this.configService.getConfig().e&&this.configService.getConfig().e.term)for(var d=this.configService.getConfig().e.term,g=0;g<d.length;g++){var e=d[g];"t"===e[0]&&b.push(e[2])}g=void 0;a=c||a;a.hasAttribute("href")?(g=a.getAttribute("href"),c=g.lastIndexOf("/"),d=g.lastIndexOf("\\"),
g=g.substr((c>d?c:d)+1)):"BUTTON"===a.nodeName&&(g=a.innerHTML);c="BUTTON"===a.nodeName?document.URL:encodeURI(document.referrer);d=a.innerText;c={eventName:"click",referrer:c,elementTagName:a.tagName,anchorId:a.id,anchorHref:g,anchorName:a.name,location:this.getElementPath(a),targetSelectorPath:this.getElementFullSelector(a),targetInnerText:null!=a.textContent?a.textContent:a.innerText,targetAlt:a.hasAttribute("alt")?a.getAttribute("alt"):"",onClick:a.hasAttribute("onclick")?a.getAttribute("onclick"):
"",uri:a.hasAttribute("href")?a.href:document.URL,title:d};if(0<b.length)for(d=1,g=0;g<b.length;g++)e=b[g],a.matches&&a.matches(e)&&(c["_tsp"+d++]=e);b=this.util.getDataAttributes(a);for(var h in b)c["data-"+h]=b[h];this.decorateEventAndSend(c)}};f.prototype.decorateEventAndSend=function(a){if(!this.configService.isInDesignCenter()){var c=this.configService.getThresholds().mxTtlEv;if(!(c&&this.eventCount>=c)){var b=this.persistenceService.getCookies(),d=this.configService.getJsVars(),g=d.length;for(c=
0;c<g;c++){var e=d[c];if(0<e.length){var h=e[0],f=this.util.tokenizeObjectString(h);(f=this.util.getVariableFromObjectString(f))?a["jsvar."+h]=f:1<e.length&&"string"===typeof e[0]&&"page_id"===e[0]&&(e=this.util.tokenizeObjectString(e[1]),(e=this.util.getVariableFromObjectString(e))&&(a["jsvar."+h]=e))}}d=[];window.ci360Whitelist&&(d=[/^_SI_SID_1.*$/,/^_SI_VID_1.*$/]);g=[];window.ci360Blacklist&&(g=[/PHP/]);h=0<d.length;e=0<g.length;f=!1;for(var l in b){if(h){var m=!1;for(c=0;c<d.length&&!m;c++)d[c].test(l)&&
(m=!0);m&&(f=!0)}else if(e){m=!1;for(c=0;c<g.length&&!m;c++)g[c].test(l)&&(m=!0);m||(f=!0)}else f=!0;f&&(a["cookie."+l]=b[l])}c=this.util.getMetas();for(var p in c)a["meta."+p]=c[p];if(p=this.configService.getPageElements())for(c=0;c<p.length;c++)try{var n=p[c],q=n[0];if("l"===q){var y=n[1],t=n[2],r=n[3],w=n[4],A=n[5];this.addAttributeToObj(t,r,this.opMapping[w],A,y,a)}"ct"===q&&["click","load","cart"].includes(a.eventName)?(y=n[1],t=n[2],r=n[3],w=n[4],A=n[5],this.addAttributeToObj(t,r,this.opMapping[w],
A,y,a)):"f"===q&&(y=n[1],t=n[2],-1<t.indexOf(":contains(")?0<this.util.getElementsBySelector(t,document).length&&(a[y]="true"):document.querySelector(t)&&(a[y]="true"))}catch(H){}a.initiator="ot2";a.version=this.VERSION;this.eventCount++;n=this.configService.getAttributeStore();for(var D in n)q=n[D],a[D]=q;a["html.lang"]=document.documentElement.getAttribute("lang");for(D in a)(q=a[D])&&q.trim&&(a[D]=q.trim()),null!==q&&void 0!==q&&""!==q||delete a[D];this.eventService.send(a,!1)}}};f.prototype.changeEventHandler=
function(a){var c=this.configService.getCollectRules();if(c&&(!0===c.fieldinteractions||"true"===c.fieldinteractions)&&null!=a&&"password"!==a.getAttribute("type")){c=this.populateFieldObject(a);var b=void 0,d=void 0;null!=a.form&&(b=a.form.id,d=a.form.name);if(null==b||""==b)b=d;a={eventName:"change",id:null!=b?b:"",name:null!=d?d:"",field:c};a["form._h.id"]=a.id;this.decorateEventAndSend(a)}};f.prototype.comparisonHelper=function(a,c,b){if(null==c)return!1;a=a.toLowerCase();switch(a){case "equal":case "equals":return c===
b;case "contains":return-1<c.indexOf(b);case "startswith":return 0===c.indexOf(b);case "endswith":return c.indexOf(b)===c.length-b.length;case "regex":try{return(new RegExp(b)).test(c)}catch(d){}}};f.prototype.doesUrlMatch=function(a,c,b,d){var g=0<d.length?!1:!0;var e=0<c.length?!1:!0;var h=0<b.length?!1:!0;for(var f=0;f<d.length;f++){var l=d[f],m=l[1];l=l[2];for(var p=0;p<l.length;p++)if(this.comparisonHelper(m,a.protocol,l[p])){g=!0;break}}for(f=0;f<c.length;f++)if(l=c[f],m=l[1],l=l[2],"all"===
m){e=!0;break}else for(p=0;p<l.length;p++)if(this.comparisonHelper(m,a.host,l[p])){e=!0;break}for(f=0;f<b.length;f++)for(l=b[f],m=l[1],l=l[2],p=0;p<l.length;p++)if(this.comparisonHelper(m,decodeURIComponent(a.path),l[p])){h=!0;break}return 0<d.length||0<c.length||0<b.length?g&&e&&h:!1};f.prototype.formRuleListHelper=function(a){for(var c={},b=[],d=[],g=[],e=[],f=[],k=0;k<a.length;k++){var l=a[k];switch(l[0]){case "domain":b.push(l);break;case "uri":d.push(l);break;case "protocol":g.push(l);break;
case "form":e.push(l);break;case "field":f.push(l)}}c.domainList=b;c.uriList=d;c.protocolList=g;c.formList=e;c.fieldList=f;return c};f.prototype.populateFieldObject=function(a){var c={},b=!1,d=this.configService.getFormConfig();if(d){var g=this.util.getUriInfo(),e=d.n;if("ign"===e){var f=!0;if(d.ign){var k=d.ign.r;if(k)for(e=0;e<k.length;e++){var l=this.formRuleListHelper(k[e]),m=l.domainList,p=l.uriList,n=l.protocolList,q=l.formList;l=l.fieldList;if(this.doesUrlMatch(g,m,p,n)){if(0<q.length)for(var y=
0;y<q.length;y++){n=q[y];m=n[1];p=n[2];for(var t=n[3],r=0;r<t.length&&1==f;r++){n=t[r];var w=a.form;if(w)switch(m){case "name":this.comparisonHelper(p,w.getAttribute("name"),n)&&(f=!1);break;case "id":this.comparisonHelper(p,w.getAttribute("id"),n)&&(f=!1)}}}if(0<l.length)for(w=0;w<l.length;w++)for(q=l[w],m=q[1],p=q[2],t=q[3],r=0;r<t.length&&1==f;r++)switch(n=t[r],m){case "name":this.comparisonHelper(p,a.getAttribute("name"),n)&&(f=!1);break;case "id":this.comparisonHelper(p,a.getAttribute("id"),
n)&&(f=!1)}}}}}else if("inc"===e&&(f=!1,d.inc&&(k=d.inc.r)))for(e=0;e<k.length;e++)if(l=this.formRuleListHelper(k[e]),m=l.domainList,p=l.uriList,n=l.protocolList,q=l.formList,l=l.fieldList,this.doesUrlMatch(g,m,p,n)){if(0<q.length)for(y=0;y<q.length;y++)for(n=q[y],m=n[1],p=n[2],t=n[3],r=0;r<t.length&&0==f;r++)if(n=t[r],w=a.form)switch(m){case "name":this.comparisonHelper(p,w.getAttribute("name"),n)&&(f=!0);break;case "id":this.comparisonHelper(p,w.getAttribute("id"),n)&&(f=!0)}if(0<l.length)for(w=
0;w<l.length;w++)for(q=l[w],m=q[1],p=q[2],t=q[3],r=0;r<t.length&&0==f;r++)switch(n=t[r],m){case "name":this.comparisonHelper(p,a.getAttribute("name"),n)&&(f=!0);break;case "id":this.comparisonHelper(p,a.getAttribute("id"),n)&&(f=!0)}}if(d.obs&&(d=d.obs.r))for(e=0;e<d.length;e++)if(l=this.formRuleListHelper(d[e]),m=l.domainList,p=l.uriList,n=l.protocolList,q=l.formList,l=l.fieldList,this.doesUrlMatch(g,m,p,n)){if(0<q.length)for(k=0;k<q.length;k++)if(n=q[k],m=n[1],p=n[2],n=n[3][0],w=a.form)switch(m){case "name":if(this.comparisonHelper(p,
w.getAttribute("name"),n)){b=!0;break}case "id":this.comparisonHelper(p,w.getAttribute("id"),n)&&(b=!0)}if(0<l.length)for(k=0;k<l.length;k++)switch(q=l[k],m=q[1],p=q[2],n=q[3][0],m){case "name":if(this.comparisonHelper(p,a.getAttribute("name"),n)){b=!0;break}case "id":this.comparisonHelper(p,a.getAttribute("id"),n)&&(b=!0)}}}f&&(n=a.value,null!=n&&(c.value=n),f=a.getAttribute("type"),null!=f&&(c.type=f),f=a.getAttribute("name"),null!=f&&(c.name=f),f=a.getAttribute("alt"),null!=f&&(c.alt=f),f=0,g=
null==a.id||""===a.id?a[this.CI360_ID_KEY]:a.id,null!=g&&""!==g&&(f=this.formFieldChangeMap[g]),null!=f&&(c.changes=f.toString()),a=a.getAttribute("id"),null!=a&&(c.id=a),b&&(c.obscure="true"));return c};f.prototype.initJsvarchangeWatchers=function(){var a=this;(function(){var c=a.configService.getJsVarsToObserve();if(null!=c)for(var b=function(b){var c=a.util.tokenizeObjectString(b),d=void 0,g=void 0;if(null!=c&&(g=c.pop(),d=a.util.getVariableFromObjectString(c),null!=d)){var f=d[g];c=function(c){var d=
f;f=c;if(d!==c){var e=a.configService.getCollectRules();!e||!0!==e.jsvars&&"true"!==e.jsvars||(e=a.configService.getThresholds().mxJsc,e&&a.jsVarChangeCount>=e||(c={eventName:"jsvarchange",name:b,action:"update",oldValue:d,newValue:c},a.jsVarChangeCount++,a.decorateEventAndSend(c)))}};try{null!=Object.defineProperty&&Object.defineProperty(d,g,{set:c,get:function(){return f},enumerable:!0,configurable:!0})}catch(v){}}},d=0;d<c.length;d++)b(c[d])})()};f.prototype.initUrlWatchers=function(){var a=this,
c=this.configService.getCollectRules();if(c&&(!0===c.urlchange||"true"===c.urlchange)){c=["push","pop","replace"];-1<c.indexOf("hash")&&window.addEventListener("hashchange",function(b){a.urlChangeHandler()});-1<c.indexOf("pop")&&window.addEventListener("popstate",function(b){a.urlChangeHandler()});if(-1<c.indexOf("push")&&history.pushState){var b=history.pushState;history.pushState=function(){for(var c=[],d=0;d<arguments.length;d++)c[d]=arguments[d];c=b.apply(window.history,c);setTimeout(a.urlChangeHandler.bind(a),
0);return c}}if(-1<c.indexOf("replace")&&history.replaceState){var d=history.replaceState;history.replaceState=function(){for(var b=[],c=0;c<arguments.length;c++)b[c]=arguments[c];b=d.apply(window.history,b);setTimeout(a.urlChangeHandler.bind(a),0);return b}}}};f.prototype.urlChangeHandler=function(){this.configService.refreshConfig(this.loadEventHandler.bind(this),this.handleSpots.bind(this))};f.prototype.loadEventHandler=function(){var a=this.opMapping,c={eventName:"load",uri:document.URL,pageTitle:document.title,
referrer:encodeURI(document.referrer),fl:1};this.decorateEventAndSend(c);var b;this.configService.getIdentityEventConfigs()&&(b=this.configService.getIdentityEventConfigs().pageView);if(b)for(c=0;c<b.length;c++){var d=b[c],f=d.pr,e=!0;if(f){var h=f.cookieList;if(h)for(var k=0;k<h.length&&e;k++){var l=h[k],m=l[1],p=l[2];l=this.persistenceService.getCookie(l[0]);if(!this.comparisonHelper(a[m],l,p)){e=!1;break}}if(m=f.s)for(k=0;k<m.length&&e;k++)if(!document.querySelector(m[k])){e=!1;break}if(h=f.jsVariableList)for(k=
0;k<h.length&&e;k++)if(p=h[k],l=p[0],m=p[1],p=p[2],l=this.util.tokenizeObjectString(l),l=this.util.getVariableFromObjectString(l),!this.comparisonHelper(a[m],l,p)){e=!1;break}if(h=f.pageTitleList)for(k=0;k<h.length&&e;k++)if(p=h[k],m=p[0],p=p[1],l=document.title,!this.comparisonHelper(a[m],l,p)){e=!1;break}if(h=f.referrerUrlPathList)for(k=0;k<h.length&&e;k++)if(p=h[k],m=p[0],p=p[1],l=this.util.getUriInfoGeneric(document.referrer),l=l.path,!this.comparisonHelper(a[m],l,p)){e=!1;break}if(h=f.referrerUrlDomainList)for(k=
0;k<h.length&&e;k++)if(p=h[k],m=p[0],p=p[1],l=this.util.getUriInfoGeneric(document.referrer),l=l.host,!this.comparisonHelper(a[m],l,p)){e=!1;break}if(f=f.referrerUrlQueryParameterList)for(k=0;k<f.length&&e;k++)if(p=f[k],h=p[0],m=p[1],p=p[2],l=this.util.getUriInfoGeneric(document.referrer),l=l.searchObj[h],!this.comparisonHelper(a[m],l,p)){e=!1;break}}e&&(e=d.uid)&&(e=e[0],k=this.identityHelper(e,a))&&(e={loginId:k,loginEventType:d.let,obfuscateFields:"["+(e.o&&'"loginId"'||'""')+"]"},(!d.pr||d.pr&&
this.doesPageRuleMatch(d.pr))&&this.configService.attachIdentity(e))}};f.prototype.submitEventHandler=function(a){var c=this.configService.getCollectRules();if(c&&(!0===c.formsubmits||"true"===c.formsubmits)){var b=[];c=void 0;if(null!=a.form){c=a.form;var d=c.elements;if(null!=d)for(var f=d.length,e=0;e<f;e++){var h=this.populateFieldObject(d[e]);b.push(h)}}b={eventName:"submit",location:this.getElementPath(a),referrer:encodeURI(document.referrer),fields:b};a.hasAttribute("href")&&(b.uri=a.getAttribute("href"));
a=!1;d="";c.hasAttribute("id")&&(d=c.getAttribute("id"),a=!0);c.hasAttribute("name")&&(b.name=c.getAttribute("name"),a||(d=c.getAttribute("name")));b.id=d;b["form._h.id"]=d;this.decorateEventAndSend(b)}};return f}();m.ListeningService=q})($ci360||($ci360={}));
(function(m){var q=new m.Util,f=new m.Bootstrap,a=new m.PersistenceService,c=new m.LocalQueue("ciq2_","sessionStorage"),b=new m.NetworkService(c,a),d=new m.EncodingService;c=new m.ParamService(d,q);var g=new m.ConfigService(a,b,c,q,!0),e=new m.SpotService(g,b,q),h=new m.EventService(g,a,b,c,e,q);q=new m.ListeningService(h,e,a,q,g,d,b);f.require(g,e,q);f.createApi(g,c,h,e);g.setEnvironmentAttributes(f.getEnvironmentAttributes());f.setLazyInit(m.lazyInit);f.initialize()})($ci360||($ci360={}));

</script>

</body>
</html>
