<!DOCTYPE html>

<html lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>Variation.s44fb9oC.html</title>
</head>
<body>
<script>class I{constructor(){this.events={}}subscribe(e,n){this.events[e]||(this.events[e]=[]),this.events[e].push(n)}publish(e,n){this.events[e]&&this.events[e].forEach(c=>c(n))}checkChannel(e){return!!this.events[e]}}function A(i,e){const{linkedOn:n,variants:c}=e;let d=c.find(a=>a.sku==i);d||(d=c.find(a=>a.inStock)||c?.[0]);let o=[];return e?.options?.map(a=>{d.choices.some(r=>r.optionKey===a.key)&&o?.push({key:a?.key,localised:a?.localizedKey})}),{activeVariant:d,activeChoices:o,linkedOn:n||null}}function P(i,e,n){let c=[];return n.filter(o=>{o.key===i&&o.choices.forEach(a=>c.push(a.key))}),e.sort((o,a)=>{const r=o.choices.find(l=>l.optionKey===i).key,t=a.choices.find(l=>l.optionKey===i).key;return c.indexOf(r)-c.indexOf(t)})}function O(i,e,n){const c=new Set,d=[];return e.forEach(o=>{const a=o.choices.find(r=>r.optionKey===i);if(a){const{key:r}=a;c.has(r)||(c.add(r),d.push(o))}}),P(i,d,n)}function D(i,e,n){const c=e.choices.filter(o=>o.optionKey!==i);return n.filter(o=>c.every(a=>{const r=o.choices.find(t=>t.optionKey===a.optionKey);return r&&r.key===a.key}))}function H(i,e,n,c,d,o){const a=e.choices.map(l=>l).length,r=e.choices.filter(l=>l.optionKey!==i),t=e.choices.map(l=>l.optionKey);if(c===i){const l=n.filter(h=>r.every(b=>{const V=h.choices.map(g=>g.optionKey);if((t?.filter(g=>!V.includes(g)&&g!==i)).includes(b.optionKey))return!0;const v=h.choices.find(g=>g.optionKey===b.optionKey);return v&&v.key===b.key}));return O(i,l,o)}if(r.some(l=>l.optionKey===c))if(r.length>=1&&d!==0||r.length===1&&d===0&&a===o.length){const l=r.find(b=>b.optionKey===c);let h=n.filter(b=>b.choices.some(V=>V.optionKey===c&&V.key===l.key));return d!==0&&a===o.length&&(h=D(i,e,n)),P(i,h,o)}else return O(i,n,o);if(a<=1)return O(i,n,o);if(d===0)return O(i,n,o);{const l=D(i,e,n);return P(i,l,o)}}async function M(i,e,n){try{let b=function(m){const v=A(m,t.fullProduct);t.activeChoices=v.activeChoices,t.linkedOn=v.linkedOn,t.activeVariant=v.activeVariant,h=t.activeVariant,V()},V=function(){t.activeChoices&&(r.innerHTML=`
        <div class="elements-variations-wrapper">
          ${t.activeChoices.map((s,y)=>`
                <div data-key="${s?.key}">
                  <label class="elements-variations-option-label">${s?.localised??s?.key}:</label>
                    ${d.defaultLayout==="button"||d.alternativeLayouts.some(f=>Object.keys(f)[0]==="button"&&Object.values(f)?.[0].includes(s?.key))?`
                        <ul class="elements-variations-buttons-wrapper">
                          ${H(s?.key,h,t.fullProduct.variants,t.linkedOn,y,t.fullProduct.options).map(f=>{const u=f.choices.find(k=>k.optionKey===s?.key),p=h.choices.length>1&&y!==0||t.activeChoices.length===1;return`
                            <li class="elements-variations-buttons-list-item">
                              <button ${s?.key===t.linkedOn?'data-linked="true"':""} class="elements-variations-button ${p?f.sku===h.sku?"elements-variant-button-selected":"":u.key===h.choices.find(k=>k.optionKey===s?.key).key?"elements-variant-button-selected":""} ${u.colour?"elements-variations-button-colour":""} ${f.inStock?"":"elements-variations-button-oos"}" data-sku="${p?f.sku:""}" data-stock="${p?f.inStock:""}" data-option="${u.optionKey}" data-key="${u.key}" style="${u.colour?`background-color:${u.colour}`:null}">
                            ${u.colour?"":`<span class="elements-variations-button-content">${u.title}</span>`}
                              </button>
                            </li>`}).join("")}
                        </ul>
                      `:`
                          <select class="elements-variations-dropdown">
                            ${H(s?.key,h,t.fullProduct.variants,t.linkedOn,y,t.fullProduct.options,t.activeChoicesTranslated)?.map(f=>{const u=f.choices.find(k=>k.optionKey===s?.key),p=h.choices.length>1&&y!==0||t.activeChoices.length===1;return`
                                  <option ${s?.key===t.linkedOn?'data-linked="true"':""} data-sku="${p?f.sku:""}" data-stock="${p?f.inStock:""}" data-key="${u.key}" data-option="${u.optionKey}"  ${p?f.sku===h.sku?"selected":"":u.key===h.choices.find(k=>k.optionKey===s?.key).key?"selected":""}>${u.title}</option>
                                `}).join("")}
                          </select>
                        `}
                </div>
              `).join("")}
        </div>
      `);const m=r.querySelectorAll(".elements-variations-button"),v=r.querySelectorAll(".elements-variations-dropdown");m.length>=1&&m.forEach(s=>{s.addEventListener("click",()=>w(s))}),v.length>=1&&v.forEach(s=>{s.addEventListener("change",y=>g(y))});function g(s){const y=s.target.options[s.target.selectedIndex],f=y.dataset.stock,u=y.dataset.sku,p=y.dataset.linked,k=y.dataset.option,S=y.dataset.key;L(f,u,p,k,S)}function w(s){const y=s.dataset.stock,f=s.dataset.sku,u=s.dataset.linked,p=s.dataset.option,k=s.dataset.key;L(y,f,u,p,k)}function L(s,y,f=!1,u="",p=""){let k=y,S=s;if((!k||!S)&&u&&p){let C=[];if(t.activeChoices.length>1){const E=h.choices.filter($=>$.optionKey!==u);Array.from(E).map($=>{C.push($.key)})}const K=t.fullProduct.variants.filter(E=>E.choices.some($=>$.optionKey===u&&$.key===p)),j=K.find(E=>E.choices.some($=>C.includes($.key)))||K.find(E=>E.inStock)||K?.[0];k=j?.sku,S=j?.inStock}k!=h.sku&&(f?o.publish("linked_variation_updated",{sku:Number(k),stock:S.toString()}):o.publish("variation_updated",{sku:Number(k),stock:S.toString()}),m.length>=1&&m.forEach(C=>{C.removeEventListener("click",()=>w(C))}),v.length>=1&&v.forEach(C=>{C.removeEventListener("change",K=>g(K))}),b(k))}};if(!e.config.payload)throw new Error("No payload supplied to variations. Please check your application setup.");const c=e.config.payload,d={};d.defaultLayout="dropdown",d.alternativeLayouts=[],e.config?.layout&&Object.keys(e.config.layout).length>=1&&Object.keys(e.config.layout).forEach(v=>{v==="button"&&d.alternativeLayouts.push({[v]:e.config.layout[v]})});let o=n;const a=i,r=document.getElementById(a),t={},l=A(e?.config?.activeVariant||e.config.payload?.defaultVariant?.sku,e.config.payload);t.activeChoices=l.activeChoices,t.linkedOn=l.linkedOn,t.activeVariant=l.activeVariant,t.fullProduct=e.config.payload;let h=t.activeVariant;V()}catch(c){console.error(c)}}class N{constructor(e,n){this.id=e,this.config=n,this.observer=new I,M(this.id,this.config,this.observer)}subscribe(e,n){this.observer.checkChannel(e)?this.observer.subscribe(e,n):this.observer.subscribe(e,n)}publish(e,n){this.observer.publish(e,n)}}export{N as V};</script>
</body>
</html>
