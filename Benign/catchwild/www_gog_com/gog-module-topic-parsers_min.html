<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>gog-module-topic-parsers_min.html</title>
</head>
<body>

<script>
!function(modules){var installedModules={};function __webpack_require__(moduleId){if(installedModules[moduleId])return installedModules[moduleId].exports;var module=installedModules[moduleId]={i:moduleId,l:!1,exports:{}};return modules[moduleId].call(module.exports,module,module.exports,__webpack_require__),module.l=!0,module.exports}__webpack_require__.m=modules,__webpack_require__.c=installedModules,__webpack_require__.d=function(exports,name,getter){__webpack_require__.o(exports,name)||Object.defineProperty(exports,name,{configurable:!1,enumerable:!0,get:getter})},__webpack_require__.n=function(module){var getter=module&&module.__esModule?function(){return module.default}:function(){return module};return __webpack_require__.d(getter,"a",getter),getter},__webpack_require__.o=function(object,property){return Object.prototype.hasOwnProperty.call(object,property)},__webpack_require__.p="/assets/",__webpack_require__(__webpack_require__.s=167)}({0:function(module,exports){module.exports=angular},167:function(module,exports,__webpack_require__){var t;t=function(n,r){return function(n){var r={};function i(e){if(r[e])return r[e].exports;var t=r[e]={i:e,l:!1,exports:{}};return n[e].call(t.exports,t,t.exports,i),t.l=!0,t.exports}return i.m=n,i.c=r,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)i.d(n,r,function(e){return t[e]}.bind(null,r));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i(i.s=0)}([function(e,t,n){e.exports=n(1)},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var i=r(n(2));n(3);var s=n(4);t.ActivityFeedTopicParser=s.ActivityFeedTopicParser;var a=n(5);t.ChatRemovedTopicParser=a.ChatRemovedTopicParser;var o=n(6);t.ChatTopicParser=o.ChatTopicParser,t.ChatTopicKey=o.ChatTopicKey;var c=n(7);t.pusherGameInvitationMapper=c.pusherGameInvitationMapper;var d=n(8);t.ExternalAccountsTopicParser=d.ExternalAccountsTopicParser,t.ExternalAccountsKey=d.ExternalAccountsKey;var u=n(9);t.ExternalUsersTopicParser=u.ExternalUsersTopicParser,t.ExternalUsersKey=u.ExternalUsersKey;var p=n(10);t.FriendsTopicParser=p.FriendsTopicParser,t.FriendsTopicKey=p.FriendsTopicKey;var _=n(11);t.MenuCustomTopicParser=_.MenuCustomTopicParser,t.MenuCustomTopicKey=_.MenuCustomTopicKey;var g=n(12);t.PresenceTopicParser=g.PresenceTopicParser,t.PresenceTopicKey=g.PresenceTopicKey;var T=n(13);t.AnnouncementTopicParser=T.AnnouncementTopicParser,t.AnnouncementTopicKey=T.AnnouncementTopicKey;var E=n(14);t.PusherTopic=E.PusherTopic;var l=n(15);t.TopicParserEnums=l.TopicParserEnums,t.gogModuleTopicParsers=i.default.module("gogModuleTopicParsers",["gogModuleListenersManager"]).constant("topicParserEnums",new l.TopicParserEnums).service("activityFeedTopicParser",s.ActivityFeedTopicParser).service("chatRemovedTopicParser",a.ChatRemovedTopicParser).service("chatTopicParser",o.ChatTopicParser).service("externalAccountsTopicParser",d.ExternalAccountsTopicParser).service("externalUsersTopicParser",u.ExternalUsersTopicParser).service("friendsTopicParser",p.FriendsTopicParser).service("menuCustomTopicParser",_.MenuCustomTopicParser).service("announcementTopicParser",T.AnnouncementTopicParser).service("presenceTopicParser",g.PresenceTopicParser)},function(e,t){e.exports=n},function(e,t){e.exports=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e){this.newNotificationListenersManager=e.getManager(),this.notificationRemovedListenersManager=e.getManager(),this.notificationConsumedListenersManager=e.getManager()}return e.prototype.registerNewNotificationListener=function(e){return this.newNotificationListenersManager.addListener(e)},e.prototype.registerNotificationRemovedListener=function(e){return this.notificationRemovedListenersManager.addListener(e)},e.prototype.registerNotificationConsumedListener=function(e){return this.notificationConsumedListenersManager.addListener(e)},e.prototype.parseTopicMessage=function(e){var t=JSON.parse(e.content);this.newNotificationListenersManager.callListeners(e.id,t)},e.prototype.parseRemovedTopicMessage=function(e){var t=JSON.parse(e.content);this.notificationRemovedListenersManager.callListeners(t.removed_by,t[t.removed_by])},e.prototype.parseConsumedTopicMessage=function(e){var t=JSON.parse(e.content);this.notificationConsumedListenersManager.callListeners(t.id)},e.$inject=["listenersManager"],e}();t.ActivityFeedTopicParser=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function n(e){this.chatRemovedListenersManager=e.getManager()}return n.prototype.parseTopicMessage=function(e){var t=JSON.parse(e.content);t.removed_by?this.onPusherChatRemoved(t):console.error("Missing removed_by property in message content, received "+e.content)},n.prototype.onPusherChatRemoved=function(e){switch(e.removed_by){case n.REMOVED_BY.UNIQUE_KEY:this.onRemovedByUniqueKey(e);break;case n.REMOVED_BY.ID:break;default:return void console.error("Received chat:remove notification with unsupported structure, instead it was: "+e.removed_by)}},n.prototype.onRemovedByUniqueKey=function(e){if(0===e.unique_key.indexOf(n.MESSAGE_KEY_PREFIX)){var t=e.unique_key.split(n.MESSAGE_KEY_PREFIX)[1];this.onChatRemoved(t)}else 0===e.unique_key.indexOf(n.INVITE_KEY_PREFIX)?(t=e.unique_key.split(n.INVITE_KEY_PREFIX)[1],this.onChatRemoved(t)):0!==e.unique_key.indexOf(n.MESSAGE_KEY_PREFIX_V1)&&0!==e.unique_key.indexOf(n.INVITE_KEY_PREFIX_V1)&&console.error("Unhandled unique key: "+e.unique_key+". ChatRemovedTopicParser could not extract real key from it.")},n.prototype.registerChatRemovedListener=function(e){return this.chatRemovedListenersManager.addListener(e)},n.prototype.onChatRemoved=function(e){this.chatRemovedListenersManager.callListeners({roomId:e})},n.$inject=["listenersManager"],n.REMOVED_BY={UNIQUE_KEY:"unique_key",ID:"id"},n.MESSAGE_KEY_PREFIX="chat_message_v2-",n.MESSAGE_KEY_PREFIX_V1="chat_message-",n.INVITE_KEY_PREFIX="game_invite_v2-",n.INVITE_KEY_PREFIX_V1="game_invite-",n}();t.ChatRemovedTopicParser=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i,s=n(7);(i=r=t.ChatTopicKey||(t.ChatTopicKey={})).NEW_CHAT_MESSAGE="newChatMessageV2",i.NEW_CHAT_MESSAGE_V1="newChatMessage",i.NEW_CHAT_MESSAGE_FOR_SENDER="newChatMessageForSenderV2",i.NEW_CHAT_MESSAGE_FOR_SENDER_V1="newChatMessageForSender",i.GAME_INVITATION="gameInvitation",i.GAME_INVITE_ACCEPTED="gameInvitationAccepted",i.GAME_INVITE_DECLINED="gameInvitationDeclined",i.PLATFORM_DISCONNECTED="platformDisconnected";var a=function(){function e(e){this.newMessageListenersManager=e.getManager(),this.newMessageForSenderListenersManager=e.getManager(),this.gameInviteReceivedListenersManager=e.getManager(),this.gameInviteAcceptedListenersManager=e.getManager(),this.gameInviteDeclinedListenersManager=e.getManager(),this.platformDisconnectedListenersManager=e.getManager()}return e.prototype.parseTopicMessage=function(e){var t=JSON.parse(e.content);t.key?this.onPusherChat(t):console.error("Missing removed_by property in message content, received "+e.content)},e.prototype.onPusherChat=function(e){switch(e.key){case r.NEW_CHAT_MESSAGE_V1:break;case r.NEW_CHAT_MESSAGE:this.onMessageReceived(e.data);break;case r.NEW_CHAT_MESSAGE_FOR_SENDER_V1:break;case r.NEW_CHAT_MESSAGE_FOR_SENDER:this.onMessageForSenderReceived(e.data);break;case r.GAME_INVITATION:this.onGameInviteReceived(e.data);break;case r.GAME_INVITE_ACCEPTED:this.onGameInviteAccepted(e.data);break;case r.GAME_INVITE_DECLINED:this.onGameInviteDeclined(e.data);break;case r.PLATFORM_DISCONNECTED:this.onPlatformDisconnected(e.data);break;default:console.warn("Uhandled chat topic key: "+e.key)}},e.prototype.registerNewMessageListener=function(e){return this.newMessageListenersManager.addListener(e)},e.prototype.onMessageReceived=function(e){this.newMessageListenersManager.callListeners({messageContent:e.message_content,messageDate:e.publish_date,messageId:e.id,roomId:e.room_id,senderId:e.sender.id,senderPlatform:e.sender.platform,senderUsername:e.sender.username})},e.prototype.registerNewMessageForSenderListener=function(e){return this.newMessageForSenderListenersManager.addListener(e)},e.prototype.onMessageForSenderReceived=function(e){this.newMessageForSenderListenersManager.callListeners({messageContent:e.message_content,messageDate:e.publish_date,messageId:e.id,roomId:e.room_id,senderId:e.sender.id,senderPlatform:e.sender.platform,senderUsername:e.sender.username})},e.prototype.registerGameInviteReceivedListener=function(e){return this.gameInviteReceivedListenersManager.addListener(e)},e.prototype.onGameInviteReceived=function(e){this.gameInviteReceivedListenersManager.callListeners(s.pusherGameInvitationMapper(e))},e.prototype.registerGameInviteAcceptedListener=function(e){return this.gameInviteAcceptedListenersManager.addListener(e)},e.prototype.onGameInviteAccepted=function(e){this.gameInviteAcceptedListenersManager.callListeners({senderId:e.sender_id,senderUsername:e.sender_username,roomId:e.room_id,publish_date:e.publish_date,gameInviteId:e.game_invitation_id})},e.prototype.registerGameInviteDeclinedListener=function(e){return this.gameInviteDeclinedListenersManager.addListener(e)},e.prototype.onGameInviteDeclined=function(e){this.gameInviteDeclinedListenersManager.callListeners({senderId:e.sender_id,senderUsername:e.sender_username,roomId:e.room_id,publish_date:e.publish_date,clientId:e.client_id,gameInviteId:e.game_invitation_id})},e.prototype.registerPlatformDisconnectedListener=function(e){return this.platformDisconnectedListenersManager.addListener(e)},e.prototype.onPlatformDisconnected=function(e){var t=e.platform,n=e.room_ids;this.platformDisconnectedListenersManager.callListeners({platform:t,rooms:n})},e.$inject=["listenersManager"],e}();t.ChatTopicParser=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.pusherGameInvitationMapper=function(e){return{id:e.id,userId:e.sender_id,userName:e.sender_username,roomId:e.room_id,messageDate:e.publish_date,clientId:e.client_id,connectionString:e.connection_string,productId:e.product_id,productName:e.product_name,productImages:{menuNotificationAv:e.product_images.menu_notification_av,menuNotificationAv2:e.product_images.menu_notification_av2}}}},function(e,t,n){"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),(r=t.ExternalAccountsKey||(t.ExternalAccountsKey={})).ACCOUNT_LINKED="account_linked";var i=function(){function e(e){this.accountLinkedListenersManager=e.getManager()}return e.prototype.registerAccountLinkedListener=function(e){return this.accountLinkedListenersManager.addListener(e)},e.prototype.parseTopicMessage=function(e){var t=JSON.parse(e.content);switch(t.key){case r.ACCOUNT_LINKED:this.onAccountLinked(t.data);break;default:console.warn("External accounts topic key not recognized: "+t.key)}},e.prototype.onAccountLinked=function(e){this.accountLinkedListenersManager.callListeners(e.user.user_id,e.provider.slug)},e.$inject=["listenersManager"],e}();t.ExternalAccountsTopicParser=i},function(e,t,n){"use strict";var r,i;Object.defineProperty(t,"__esModule",{value:!0}),(i=r=t.ExternalUsersKey||(t.ExternalUsersKey={})).LIST_UPDATED="list_updated",i.EXTERNAL_USER_UPDATED="external_user_updated";var s=function(){function e(e){this.listUpdatedListenersManager=e.getManager(),this.externalUserUpdatedListenersManager=e.getManager()}return e.prototype.parseTopicMessage=function(e){var t=JSON.parse(e.content);switch(t.key){case r.LIST_UPDATED:this.onListUpdated(t.data);break;case r.EXTERNAL_USER_UPDATED:this.onExternalUserUpdated(t.data);break;default:console.warn("Unknown external users topic key: "+t.key)}},e.prototype.registerListUpdatedListener=function(e){return this.listUpdatedListenersManager.addListener(e)},e.prototype.onListUpdated=function(e){this.listUpdatedListenersManager.callListeners({sendTime:e.send_time})},e.prototype.registerExternalUserUpdatedListener=function(e){return this.externalUserUpdatedListenersManager.addListener(e)},e.prototype.onExternalUserUpdated=function(e){this.externalUserUpdatedListenersManager.callListeners({userId:e.external_id,platform:e.platform,sendTime:e.send_time})},e.$inject=["listenersManager"],e}();t.ExternalUsersTopicParser=s},function(e,t,n){"use strict";var r,i;Object.defineProperty(t,"__esModule",{value:!0}),(i=r=t.FriendsTopicKey||(t.FriendsTopicKey={})).NEW_INVITE="new_invite",i.INVITE_REMOVED="invite_removed",i.NEW_FRIEND="new_friend",i.FRIEND_REMOVED="friend_removed",i.SUGGESTIONS_UPDATED="proposed_friends_updated";var s=function(){function t(e){this.friendInviteReceivedListenersManager=e.getManager(),this.friendInviteRemovedListenersManager=e.getManager(),this.newFriendListenersManager=e.getManager(),this.friendRemovedListenersManager=e.getManager(),this.suggestionsUpdatedListenersManager=e.getManager()}return t.prototype.parseTopicMessage=function(e){var t=JSON.parse(e.content);switch(t.key){case r.NEW_INVITE:this.onFriendInviteReceived(t.data);break;case r.INVITE_REMOVED:this.onFriendInviteRemoved(t.data);break;case r.NEW_FRIEND:this.onNewFriend(t.data);break;case r.FRIEND_REMOVED:this.onFriendRemoved(t.data);break;case r.SUGGESTIONS_UPDATED:this.onSuggestionsUpdated();break;default:console.warn("Unknown friends topic key: "+t.key)}},t.prototype.registerFriendInviteReceivedListener=function(e){return this.friendInviteReceivedListenersManager.addListener(e)},t.prototype.onFriendInviteReceived=function(e){e.status===t.NEW_INVITE_RECEIVED_STATUS&&this.friendInviteReceivedListenersManager.callListeners({userName:e.user.username,userId:e.user_id,avatarUrls:e.user.avatar})},t.prototype.registerFriendInviteRemovedListener=function(e){return this.friendInviteRemovedListenersManager.addListener(e)},t.prototype.onFriendInviteRemoved=function(e){this.friendInviteRemovedListenersManager.callListeners({userId:e.user_id})},t.prototype.registerNewFriendListener=function(e){return this.newFriendListenersManager.addListener(e)},t.prototype.onNewFriend=function(e){this.newFriendListenersManager.callListeners({userName:e.user.username,userId:e.user_id,avatarUrls:e.user.avatar,isEmployee:e.user.is_employee})},t.prototype.registerFriendRemovedListener=function(e){return this.friendRemovedListenersManager.addListener(e)},t.prototype.onFriendRemoved=function(e){this.friendRemovedListenersManager.callListeners({userName:e.user.username,userId:e.user_id,avatarUrls:e.user.avatar})},t.prototype.registerSuggestionsUpdatedListener=function(e){return this.suggestionsUpdatedListenersManager.addListener(e)},t.prototype.onSuggestionsUpdated=function(){this.suggestionsUpdatedListenersManager.callListeners()},t.$inject=["listenersManager"],t.NEW_INVITE_RECEIVED_STATUS="invited",t}();t.FriendsTopicParser=s},function(e,t,n){"use strict";var c,r;Object.defineProperty(t,"__esModule",{value:!0}),(r=c=t.MenuCustomTopicKey||(t.MenuCustomTopicKey={})).WISHLIST_DISCOUNT="wishlisted_products_discounted",r.FORUM_REPLY="new_forum_reply",r.GOG_ANNOUNCEMENT="gog_announces",r.PRODUCT_RELEASE="product_release_notify";var i=function(){function e(e){this.newWishlistNotificationListenersManager=e.getManager(),this.newForumNotificationListenersManager=e.getManager(),this.newGogAnnouncementListenersManager=e.getManager(),this.productReleaseNotificationListenersManager=e.getManager(),this.notificationRemovedListenersManager=e.getManager(),this.notificationConsumedListenersManager=e.getManager()}return e.prototype.parseTopicMessage=function(e,t){void 0===t&&(t=!1);var n=JSON.parse(e.content),r=!1;e.hasOwnProperty("consumed")&&(r=e.consumed);var i=null;void 0!==e.date_updated&&(i=Math.floor(this.dateIsoStringToTimestamp(e.date_updated)/1e3));var s=null;void 0!==e.date_expiration&&(s=this.dateIsoStringToTimestamp(e.date_expiration));var a;switch(a=void 0!==e.date_created?Math.floor(this.dateIsoStringToTimestamp(e.date_created)/1e3):Math.floor(Date.now()/1e3),n.key){case c.WISHLIST_DISCOUNT:this.newWishlistNotificationListenersManager.callListeners(e.id,n.discountedProducts,r,a,s,i,t);break;case c.FORUM_REPLY:var o=0;e.hasOwnProperty("counter")&&(o=e.counter),this.newForumNotificationListenersManager.callListeners(e.id,this.formatForumNotification(n),r,o,a,s,i,t);break;case c.GOG_ANNOUNCEMENT:this.newGogAnnouncementListenersManager.callListeners(e.id,this.formatGogAnnouncementNotification(n),r,a,s,i,t);break;case c.PRODUCT_RELEASE:this.productReleaseNotificationListenersManager.callListeners(e.id,this.formatProductReleaseNotification(n),r,a,s,i,t);break;default:console.warn("Messages topic key not supported: "+n.key)}},e.prototype.parseRemovedTopicMessage=function(e){var t=JSON.parse(e.content);this.notificationRemovedListenersManager.callListeners(t.removed_by,t[t.removed_by])},e.prototype.parseConsumedTopicMessage=function(e){var t=JSON.parse(e.content);this.notificationConsumedListenersManager.callListeners(t.id)},e.prototype.registerNewWishlistNotificationListener=function(e){return this.newWishlistNotificationListenersManager.addListener(e)},e.prototype.registerNewForumNotificationListener=function(e){return this.newForumNotificationListenersManager.addListener(e)},e.prototype.registerNewGogAnnouncementNotificationListener=function(e){return this.newGogAnnouncementListenersManager.addListener(e)},e.prototype.registerProductReleaseNotificationListener=function(e){return this.productReleaseNotificationListenersManager.addListener(e)},e.prototype.registerNotificationRemovedListener=function(e){return this.notificationRemovedListenersManager.addListener(e)},e.prototype.registerNotificationConsumedListener=function(e){return this.notificationConsumedListenersManager.addListener(e)},e.prototype.formatGogAnnouncementNotification=function(e){return{announcement:e.announcement,background:e.background}},e.prototype.formatProductReleaseNotification=function(e){return{link:e.product.link,productTitle:e.product.title,productPrice:e.product.price,productId:e.product.productId,productIcon:{full:e.product.gameIcon.full}}},e.prototype.formatForumNotification=function(e){return{userName:e.sender_username,userAvatarUrls:{medium:e.avatars.medium,medium_2x:e.avatars.medium_2x},userId:e.from_user_id,forumSlug:e.forum_slug,topicSlug:e.topic_slug,threadTitle:e.thread_title,threadLink:e.link,forumPostCreationTimestamp:this.dateIsoStringToTimestamp(e.publish_date)/1e3}},e.prototype.dateIsoStringToTimestamp=function(e){var t=e.match(/^(\d{4})-(\d{2})-(\d{2})T(\d{2}):(\d{2}):(\d{2})/)||[];return Date.UTC(parseInt(t[1],10),parseInt(t[2],10)-1,parseInt(t[3],10),parseInt(t[4],10),parseInt(t[5],10),parseInt(t[6],10))},e.$inject=["listenersManager"],e}();t.MenuCustomTopicParser=i},function(e,t,n){"use strict";var r,i;Object.defineProperty(t,"__esModule",{value:!0}),(i=r=t.PresenceTopicKey||(t.PresenceTopicKey={})).NEW_STATUS="new_presence_status",i.DELETED_STATUS="delete_presence_status",i.NEW_OWN_STATUS="new_own_presence_status",i.DELETED_OWN_STATUS="delete_own_presence_status";var s=function(){function e(e){this.newStatusListenersManager=e.getManager(),this.deletedStatusListenersManager=e.getManager(),this.newOwnStatusListenersManager=e.getManager(),this.deletedOwnStatusListenersManager=e.getManager()}return e.prototype.parseTopicMessage=function(e){var t=JSON.parse(e.content);switch(t.key){case r.NEW_STATUS:this.onNewStatus(t.data);break;case r.DELETED_STATUS:this.onDeletedStatus(t.data);break;case r.NEW_OWN_STATUS:this.onNewOwnStatus(t.data);break;case r.DELETED_OWN_STATUS:this.onDeletedOwnStatus(t.data);break;default:console.warn("Unknown presence topic key: "+t.key)}},e.prototype.registerNewStatusListener=function(e){return this.newStatusListenersManager.addListener(e)},e.prototype.registerNewOwnStatusListener=function(e){return this.newOwnStatusListenersManager.addListener(e)},e.prototype.onNewStatus=function(e){this.newStatusListenersManager.callListeners(e)},e.prototype.onNewOwnStatus=function(e){this.newOwnStatusListenersManager.callListeners(e)},e.prototype.registerDeletedStatusListener=function(e){return this.deletedStatusListenersManager.addListener(e)},e.prototype.registerDeletedOwnStatusListener=function(e){return this.deletedOwnStatusListenersManager.addListener(e)},e.prototype.onDeletedStatus=function(e){this.deletedStatusListenersManager.callListeners({userId:e.user_id})},e.prototype.onDeletedOwnStatus=function(e){this.deletedOwnStatusListenersManager.callListeners({userId:e.user_id})},e.$inject=["listenersManager"],e}();t.PresenceTopicParser=s},function(e,t,n){"use strict";var o;Object.defineProperty(t,"__esModule",{value:!0}),(o=t.AnnouncementTopicKey||(t.AnnouncementTopicKey={})).Store="store";var r=function(){function e(e){this.newNotificationListenersManager=e.getManager(),this.notificationRemovedListenersManager=e.getManager(),this.notificationConsumedListenersManager=e.getManager()}return e.prototype.registerNewNotificationListener=function(e){return this.newNotificationListenersManager.addListener(e)},e.prototype.registerNotificationRemovedListener=function(e){return this.notificationRemovedListenersManager.addListener(e)},e.prototype.registerNotificationConsumedListener=function(e){return this.notificationConsumedListenersManager.addListener(e)},e.prototype.parseTopicMessage=function(e){var t=JSON.parse(e.content),n="",r=!1;e.hasOwnProperty("consumed")&&(r=e.consumed),e.hasOwnProperty("lang_code")&&(n=e.lang_code);var i=null;void 0!==e.date_updated&&(i=Math.floor(this.dateIsoStringToTimestamp(e.date_updated)/1e3));var s=null;void 0!==e.date_expiration&&(s=this.dateIsoStringToTimestamp(e.date_expiration));var a;switch(a=void 0!==e.date_created?Math.floor(this.dateIsoStringToTimestamp(e.date_created)/1e3):Math.floor(Date.now()/1e3),t.key){case o.Store:this.newNotificationListenersManager.callListeners(e.id,t.key,t.data,r,n,a,s,i);break;default:console.warn("Unknown presence topic key: "+t.key+" for topic: "+e.topic)}},e.prototype.parseRemovedTopicMessage=function(e){var t=JSON.parse(e.content);this.notificationRemovedListenersManager.callListeners(t.removed_by,t[t.removed_by])},e.prototype.parseConsumedTopicMessage=function(e){var t=JSON.parse(e.content);this.notificationConsumedListenersManager.callListeners(t.id)},e.prototype.dateIsoStringToTimestamp=function(e){var t=e.match(/^(\d{4})-(\d{2})-(\d{2})T(\d{2}):(\d{2}):(\d{2})/)||[];return Date.UTC(parseInt(t[1],10),parseInt(t[2],10)-1,parseInt(t[3],10),parseInt(t[4],10),parseInt(t[5],10),parseInt(t[6],10))},e.$inject=["listenersManager"],e}();t.AnnouncementTopicParser=r},function(e,t,n){"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),(r=t.PusherTopic||(t.PusherTopic={})).CHAT_TOPIC="chat",r.CHAT_REMOVED_TOPIC="chat:removed",r.CHAT_CONSUMED_TOPIC="chat:consumed",r.FRIENDS_TOPIC="friends",r.FRIENDS_REMOVED_TOPIC="friends:removed",r.FRIENDS_CONSUMED_TOPIC="friends:consumed",r.MENU_CUSTOM_TOPIC="user_notification",r.MENU_CUSTOM_TOPIC_CONSUMED="user_notification:consumed",r.MENU_CUSTOM_TOPIC_REMOVED="user_notification:removed",r.ACTIVITY_TOPIC="activity_feed",r.ACTIVITY_REMOVED_TOPIC="activity_feed:removed",r.ACTIVITY_CONSUMED_TOPIC="activity_feed:consumed",r.EXTERNAL_ACCOUNTS="external_accounts",r.EXTERNAL_USERS="external_users",r.PRESENCE_TOPIC="presence",r.OWN_PRESENCE_TOPIC="own_presence",r.ANNOUNCEMENT="announcement"},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(6),i=n(14);t.TopicParserEnums=function(){this.CHAT_TOPIC_KEYS={NEW_CHAT_MESSAGE:r.ChatTopicKey.NEW_CHAT_MESSAGE,NEW_CHAT_MESSAGE_FOR_SENDER:r.ChatTopicKey.NEW_CHAT_MESSAGE_FOR_SENDER,GAME_INVITATION:r.ChatTopicKey.GAME_INVITATION,GAME_INVITE_ACCEPTED:r.ChatTopicKey.GAME_INVITE_ACCEPTED,GAME_INVITE_DECLINED:r.ChatTopicKey.GAME_INVITE_DECLINED},this.PUSHER_TOPICS={CHAT_TOPIC:i.PusherTopic.CHAT_TOPIC,CHAT_REMOVED_TOPIC:i.PusherTopic.CHAT_REMOVED_TOPIC,CHAT_CONSUMED_TOPIC:i.PusherTopic.CHAT_CONSUMED_TOPIC,FRIENDS_TOPIC:i.PusherTopic.FRIENDS_TOPIC,FRIENDS_REMOVED_TOPIC:i.PusherTopic.FRIENDS_REMOVED_TOPIC,FRIENDS_CONSUMED_TOPIC:i.PusherTopic.FRIENDS_CONSUMED_TOPIC,MENU_CUSTOM_TOPIC:i.PusherTopic.MENU_CUSTOM_TOPIC,MENU_CUSTOM_TOPIC_CONSUMED:i.PusherTopic.MENU_CUSTOM_TOPIC_CONSUMED,MENU_CUSTOM_TOPIC_REMOVED:i.PusherTopic.MENU_CUSTOM_TOPIC_REMOVED,ACTIVITY_TOPIC:i.PusherTopic.ACTIVITY_TOPIC,ACTIVITY_REMOVED_TOPIC:i.PusherTopic.ACTIVITY_REMOVED_TOPIC,ACTIVITY_CONSUMED_TOPIC:i.PusherTopic.ACTIVITY_CONSUMED_TOPIC,EXTERNAL_ACCOUNTS:i.PusherTopic.EXTERNAL_ACCOUNTS,EXTERNAL_USERS:i.PusherTopic.EXTERNAL_USERS,PRESENCE_TOPIC:i.PusherTopic.PRESENCE_TOPIC,OWN_PRESENCE_TOPIC:i.PusherTopic.OWN_PRESENCE_TOPIC,ANNOUNCEMENT_TOPIC:i.PusherTopic.ANNOUNCEMENT}}}])},module.exports=t(__webpack_require__(0),__webpack_require__(168))},168:function(module,exports){!function(e,a){for(var i in a)e[i]=a[i]}(exports,function(modules){var installedModules={};function __webpack_require__(moduleId){if(installedModules[moduleId])return installedModules[moduleId].exports;var module=installedModules[moduleId]={i:moduleId,l:!1,exports:{}};return modules[moduleId].call(module.exports,module,module.exports,__webpack_require__),module.l=!0,module.exports}return __webpack_require__.m=modules,__webpack_require__.c=installedModules,__webpack_require__.d=function(exports,name,getter){__webpack_require__.o(exports,name)||Object.defineProperty(exports,name,{configurable:!1,enumerable:!0,get:getter})},__webpack_require__.n=function(module){var getter=module&&module.__esModule?function(){return module.default}:function(){return module};return __webpack_require__.d(getter,"a",getter),getter},__webpack_require__.o=function(object,property){return Object.prototype.hasOwnProperty.call(object,property)},__webpack_require__.p="",__webpack_require__(__webpack_require__.s=0)}([function(module,exports,__webpack_require__){module.exports=__webpack_require__(1)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var listenersManager_1=__webpack_require__(2);exports.listenersManagerFactory={getManager:function(){return new listenersManager_1.ListenersManager}}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var ListenersManager=function(){function ListenersManager(){this.numberOfListeners=0,this.listeners=[],this.isSingleShot=[],this.stateListeners=[],this.isActive=!1}return ListenersManager.prototype.addListener=function(newListener){return this.numberOfListeners=this.listeners.push(newListener),this.isSingleShot.push(!1),this.updateState(!0),this.createCancelFunction(newListener)},ListenersManager.prototype.addSingleShotListener=function(newListener){return this.numberOfListeners=this.listeners.push(newListener),this.isSingleShot.push(!0),this.updateState(!0),this.createCancelFunction(newListener)},ListenersManager.prototype.callListeners=function(){for(var args=[],_i=0;_i<arguments.length;_i++)args[_i]=arguments[_i];if(this.isActive){var i,listenersToLoop=this.listeners.slice(),isSingleShotInTheLoop=this.isSingleShot.slice(),numberOfListenersToLoop=this.numberOfListeners,singleShotListenersToRemove=[],listenersToRemoveCount=0;for(i=0;i<numberOfListenersToLoop;i++)listenersToLoop[i].apply(null,args),isSingleShotInTheLoop[i]&&(listenersToRemoveCount=singleShotListenersToRemove.push(listenersToLoop[i]));if(listenersToRemoveCount>0){for(i=0;i<listenersToRemoveCount;i++){var listenerIndex=this.listeners.indexOf(singleShotListenersToRemove[i]);-1!==listenerIndex&&(this.isSingleShot.splice(listenerIndex,1),this.listeners.splice(listenerIndex,1))}this.numberOfListeners=this.listeners.length,this.updateState(this.numberOfListeners>0)}}},ListenersManager.prototype.onStateChange=function(stateListener){this.stateListeners.push(stateListener)},ListenersManager.prototype.createCancelFunction=function(listenerToCancel){var _this=this;return function(){_this.afterCancel(listenerToCancel),listenerToCancel=null}},ListenersManager.prototype.afterCancel=function(listenerToRemove){var listenerIndex=this.listeners.indexOf(listenerToRemove);-1!==listenerIndex&&(this.listeners.splice(listenerIndex,1),this.isSingleShot.splice(listenerIndex,1),this.numberOfListeners=this.listeners.length,this.updateState(this.numberOfListeners>0))},ListenersManager.prototype.updateState=function(newActiveState){if(this.isActive!==newActiveState){this.isActive=newActiveState;for(var i=0,len=this.stateListeners.length;i<len;i++)this.stateListeners[i](this.isActive)}},ListenersManager}();exports.ListenersManager=ListenersManager}]))}});
</script>

</body>
</html>
