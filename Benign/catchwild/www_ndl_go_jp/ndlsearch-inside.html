<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ndlsearch-inside.html</title>
</head>
<body>

<script>
var input_ID;
window.addEventListener('DOMContentLoaded', function() {
	var listArray = document.querySelectorAll('.submit_top');
	for (i=0; i< listArray.length; i++) {
		listArray[i].onclick = function() {
			input_ID = this.parentNode.parentNode.querySelector(".ndlsearchbox_top").id;
		}
	}
});

function checkFrmSpace(formElement) { var str = formElement; if (str.length == 0) { return false; } if (str.match(/^(\s|　)+$/)) { return false; } return true; }

function getNdlsearch(lang,sys){
	var str = '';
	var search_word = '';
	if ( lang == 'ja' ) {
		key = 'キーワード';
		lang = 'jp';
	} else {
		key = 'keywords';
		lang = 'en';
	}
	if ( document.getElementById(input_ID) ) {
		search_word = document.getElementById(input_ID).value;
		str = " " + search_word + " ";
		if (str.indexOf(" " + key + " ") !== -1) { search_word=""; }
	}
	if ( lang == 'jp' ) {
		action="https://ndlsearch.ndl.go.jp/search?cs=bib&display=panel&f-ht=ndl&keyword="+encodeURI(search_word);
	} else {
		action="https://ndlsearch.ndl.go.jp/en/search?cs=bib&display=panel&f-ht=ndl&keyword="+encodeURI(search_word);
	}
	if(sys=="hp") { if (checkFrmSpace(search_word)) { document.location=action; }
	} else { if (checkFrmSpace(search_word)) { window.open(action,'ndlsearchwindow'); } }
}

function getNdlsearch_top(lang,sys) { getNdlsearch(lang,sys); }
function getNdlsearch_top_sp(lang,sys) { getNdlsearch(lang,sys); }

function getNdlsearch_kokkai(lang,sys){
	var str = '';
	var search_word = '';
	if ( lang == 'ja' ) {
		key = 'キーワード';
	} else {
		key = 'keywords';
	}
	if ( document.getElementById(input_ID) ) {
		search_word = document.getElementById(input_ID).value;
		str = " " + search_word + " ";
		if (str.indexOf(" " + key + " ") !== -1) { search_word=""; }
	}

	quey="&legislation=true&do_remote_search=true&mediatype=9&any=";
	action="https://iss.ndl.go.jp/books?locale="+lang+quey+encodeURI(search_word);
	if(sys=="hp") { if (checkFrmSpace(search_word)) { document.location=action; }
	} else { if (checkFrmSpace(search_word)) { window.open(action,'ndlsearchwindow'); } }
}

//NDLサーチ
function getNdlsearch_old(lang,sys){
	var str = '';
	var search_word = '';
	if ( lang == 'ja' ) {
		key = 'キーワード';
	} else {
		key = 'keywords';
	}
	if ( document.getElementById(input_ID) ) {
		search_word = document.getElementById(input_ID).value;
		str = " " + search_word + " ";
		if (str.indexOf(" " + key + " ") !== -1) { search_word=""; }
	}
	action="https://iss.ndl.go.jp/books?locale="+lang+"&any="+encodeURI(search_word);
	if(sys=="hp") { if (checkFrmSpace(search_word)) { document.location=action; }
	} else { if (checkFrmSpace(search_word)) { window.open(action,'ndlsearchwindow'); } }
}

function getNdlsearch_top_old(lang,sys) { getNdlsearch_old(lang,sys); }
function getNdlsearch_top_sp_old(lang,sys) { getNdlsearch_old(lang,sys); }
</script>

</body>
</html>
