<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>0064255e-f0d2e9f7336aa90e.html</title>
</head>
<body>

<script>
"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[732],{9044:(e,t,a)=>{a.d(t,{Mr:()=>rG,OX:()=>rL});var r=a(71285),n=a(6973),s=a(72367),l=a(42302),o=a(85273),i=a(31635),c=a(95293),u=a(96540),d=a(28715),m=a(41162),p=a(49038),h=a(72191),g=a(88392),v=a(39079),f=a(36019),b=a(21855),_=a(52717),y=a(76370),E=a(56453),P=a(92914),O=a(53564),C=a(74353),w=a.n(C),k=a(88569),x=a.n(k),A=a(83826),I=a.n(A),N=a(62796),$=a.n(N),S=a(90445),j=a.n(S),z=a(63491),D=a(12069),T=a(34164),M=a(79775),F=a(66716),H=a(40255),V=a(59035),B=a(67212),q=a(3190),R=a(7886),L=a(65244),G=a(54389),W=a(40463),Y=a(67665),X=a(64746),K=a(77693),Q=a(95828),U=a(26488),J=a(51935),Z=a(88620),ee=a(43680),et=a(55698),ea=a(50277),er=a(74145),en=a(30961);a(20707);var es=a(44629),el=a(32238),eo=a(68852),ei=a(8172),ec=a(85140);let eu=e=>{let t=e.startsWith("http")||e.startsWith("/")||""===e?"":"https://",a=e.endsWith("/")?e.slice(0,-1):e;return`${t}${a}`},ed=e=>{let t=e.replace("https://","").replace("www.","");return t=t.endsWith("/")?t.slice(0,-1):t,`https://www.${t}`},em=e=>e.replace("www.","avia."),ep=e=>e.replace("www.","bus."),eh=e=>`${e}/prigorod/`,eg=e=>e.replace("www.","tours."),ev=e=>e.replace("www.","go."),ef=e=>e.replace("www.","aeroexpress."),eb=e=>e.replace("www.","hotel."),e_=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"www.";return e.replace(t,"hotels-geo-suggest.")},ey=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"www.";return e.replace(t,"vid-api.")},eE=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"www.";return e.replace(t,"calendar.")};class eP{constructor(){this.getCookie=s.Ri,this.setCookie=s.TV}setLastSearch(e){let t=this.searchParamsToCookieValue(e);this.setCookie(this.cookieName,t,{expires:604800})}getLastSearch(){let e=this.getCookie(this.cookieName);return e?this.cookieValueToSearchParams(e):null}}function eO(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[{id:1,age:null}];try{let a=JSON.parse(e);if(!Array.isArray(a)||0===a.length)return t;let r=[];for(let e=0;e<a.length;e++){let n=a[e];if(("number"!=typeof n||Number.isNaN(n))&&("object"!=typeof n||n))return t;r.push({id:e+1,age:n})}return r}catch(e){return t}}class eC{constructor(e){this.add=e=>{this.state.list.push({id:this.getNewId(),age:e})},this.remove=e=>{let t=this.state.list.findIndex(t=>t.id===e);this.state.list.splice(t,1)},this.state=(0,r.BX)({list:e&&0!==e.length?e:[{id:1,age:null}]})}get list(){return this.state.list}getNewId(){return Math.max(...this.state.list.map(e=>e.id))+1}getCountsByType(){let e=0,t=0,a=0;return this.state.list.forEach(r=>{null===r.age?e++:null!==this.infantMaxAge&&r.age<=this.infantMaxAge?a++:null===this.childMaxAge||r.age<=this.childMaxAge?t++:e++}),{adult:e,child:t,infant:a}}splitAdults(){return this.state.list.reduce((e,t)=>null===t.age?Object.assign(Object.assign({},e),{adults:[...e.adults,t]}):null===this.childMaxAge||t.age<=this.childMaxAge?Object.assign(Object.assign({},e),{children:[...e.children,t]}):Object.assign(Object.assign({},e),{adults:[...e.adults,t]}),{adults:[],children:[]})}}class ew extends eC{get infantMaxAge(){return 1}get childMaxAge(){return 11}}class ek{getInitialSearchParams(e){var t,a,r;let n=ex();if(!e)return n;let s=this.convertOuterSearchParams(e);return{routes:null!==(t=s.routes)&&void 0!==t?t:n.routes,passengers:null!==(a=s.passengers)&&void 0!==a?a:n.passengers,serviceClass:null!==(r=s.serviceClass)&&void 0!==r?r:n.serviceClass}}convertOuterSearchParams(e){var t,a,r;let n=null==e?void 0:e.routes[0],s=null===(t=null==e?void 0:e.routes)||void 0===t?void 0:t[1];return Object.assign(Object.assign({routes:[{from:n.from?{type:"aviaCity",name:n.from.value,aviaId:n.from.id,translitName:n.from.translitName}:{type:"unknown",name:""},to:n.to?{type:"aviaCity",name:n.to.value,aviaId:n.to.id,translitName:n.to.translitName}:{type:"unknown",name:""},date:null!==(a=n.date)&&void 0!==a?a:void 0,secondDate:null!==(r=null==s?void 0:s.date)&&void 0!==r?r:void 0}]},e.serviceClass?{serviceClass:e.serviceClass}:{}),e.passengers?{passengers:new ew(e.passengers)}:{})}}function ex(){return{routes:[{from:{type:"unknown",name:""},to:{type:"unknown",name:""},date:void 0,secondDate:void 0}],passengers:new ew,serviceClass:"Y"}}class eA{constructor({searchParams:e,validator:t,searchParamsInitializer:a,submitter:n,lastSearch:s,renderEmptyFieldsOnSsr:l=!0}){this.init=()=>{if(this.state.initiated)return;let e=this.lastSearch.getLastSearch();e&&(this.state.searchParams=e),this.state.initiated=!0},this.state=(0,r.BX)({validationEnabled:!1,initiated:!!e,searchParams:(0,r.BX)(a.getInitialSearchParams(e)),submitted:!1}),this.validator=t,this.submitter=n,this.lastSearch=s,l||this.init()}get searchParams(){return this.state.searchParams}submit(){this.state.validationEnabled=!0,this.validator.validate(this.searchParams).isValid&&(this.state.submitted=!0,this.lastSearch.setLastSearch(this.searchParams),this.submitter.gotoOffers(this.searchParams))}get submitted(){return this.state.submitted}get validationResult(){return this.validator.validate(this.searchParams)}}function eI(e){return!!("string"==typeof e&&/^(0[1-9]|[12][0-9]|3[01])\.(0[1-9]|1[0-2])\.\d{4}$/.test(e))}function eN(e){return!!e&&"string"==typeof e}function e$(e){return eI(e)?e:void 0}function eS(e){return!!e&&void 0!==e.aviaId}function ej(e){return!!e&&void 0!==e.translitName}function ez(e){return!!e&&"object"==typeof e&&!!("aviaId"in e&&"name"in e&&"translitName"in e&&eN(e.aviaId)&&eN(e.name)&&eN(e.translitName))}let eD=(e,t)=>{let{date:a,secondDate:r}=e,n=ez(e.from)?e.from:t.from,s=ez(e.to)?e.to:t.to,l=eS(n)?`faid::${n.aviaId};`:"",o=eS(s)?`taid::${s.aviaId};`:"",i=ej(s)?`tt::${s.translitName};`:"",c=ej(n)?`ft::${n.translitName};`:"",u=eN(n.name)?`f::${n.name};`:"",d=eN(s.name)?`t::${s.name};`:"",m=eI(a)?`d::${a};`:"",p=eI(r)?`d2::${r};`:"";return`${u}${l}${c}${d}${o}${i}${m}${p}`},eT=(e,t)=>{let{routes:a,passengers:r,serviceClass:n}=e,s=eD(a[0],t.routes[0]),l=r.list.map(e=>{let{age:t}=e;return t}),o=r?`p::${JSON.stringify(l)};`:"",i=n?`s::${n};`:"";return`${o}${i}${s}`},eM=(e,t)=>{let a=null==e?void 0:e.split(";"),r={p:"[null]",s:"Y",f:"",faid:"",ft:"",t:"",taid:"",tt:"",d:void 0,d2:void 0};null==a||a.forEach(e=>{let[t,a]=e.split("::");t&&a&&(r[t]=a)});let n={type:"aviaCity",name:r.f,aviaId:r.faid,translitName:r.ft},s={type:"aviaCity",name:r.t,aviaId:r.taid,translitName:r.tt},l=ez(n)?n:t.routes[0].from,o=ez(s)?s:t.routes[0].to,i=eO(r.p);return{routes:[{from:l,to:o,date:e$(r.d),secondDate:e$(r.d2)}],passengers:new ew(i),serviceClass:function(e){if("string"!=typeof e)return"Y";switch(e){case"Y":case"F":case"C":return e;default:return"Y"}}(r.s)}};class eF extends eP{constructor(){super(...arguments),this.initialSearchParams=ex(),this.aviaCookieName="sf_avia"}searchParamsToCookieValue(e){return eT(e,this.initialSearchParams)}cookieValueToSearchParams(e){return eM(e,this.initialSearchParams)}get cookieName(){return this.aviaCookieName}}class eH{constructor(e){this.params=e}gotoOffers(e){this.aviaSearchId=(0,l.A)(),this.openOffersPage((0,o.gz)(Object.assign({mainDomain:this.params.aviaHost.replace("https://","").replace("http://",""),searchId:this.searchId},this.getExternalSearchParams(e))))}openOffersPage(e){location.href=e}getExternalSearchParams(e){let t=e.routes.map(e=>({date:e.date,from:{id:e.from.aviaId,value:e.from.name,translitName:e.from.translitName},to:{id:e.to.aviaId,value:e.to.name,translitName:e.to.translitName}}));if(1===e.routes.length&&e.routes[0].secondDate){let a=e.routes[0];t.push({date:a.secondDate,from:{id:a.to.aviaId,value:a.to.name},to:{id:a.from.aviaId,value:a.from.name}})}return{passengers:e.passengers.getCountsByType(),serviceClass:e.serviceClass,flights:t}}get searchId(){return this.aviaSearchId}}class eV{get fetch(){return function(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];return fetch(...t)}}constructor(e){this.aviaApiHost=eu(e)}getSuggestItems(e){return(0,i.sH)(this,arguments,void 0,function*(e){let{request:{fieldName:t,value:a,relatedField:r},abortController:n}=e,s=new URLSearchParams(Object.assign({name:a,direction:t},r&&"aviaId"in r?{location_id:r.aviaId}:{}));return function(e){if(Array.isArray(e))return e.map(e=>{var t,a,r;return{type:"geoPoint",geoPoint:{name:e.value,type:"aviaCity",aviaId:e.id,translitName:e.city_translit},aviaCode:null!==(t=e.code)&&void 0!==t?t:void 0,country:e.country_name?{name:e.country_name}:void 0,hasNoAirport:!!(null===(a=e.closest_cities)||void 0===a?void 0:a.length),closestCities:(null===(r=e.closest_cities)||void 0===r?void 0:r.length)?e.closest_cities.map(e=>{var t;return{type:"geoPoint",geoPoint:{name:e.value,type:"aviaCity",aviaId:e.id,translitName:e.city_translit},aviaCode:null!==(t=e.code)&&void 0!==t?t:void 0,country:e.country_name?{name:e.country_name}:void 0,distance:e.distance,isNearest:!0}}):void 0,isNearest:!1}});throw Error(`Unknown response format (type '${typeof e}')`)}((yield this.fetch(`${this.aviaApiHost}/suggest/city/v5/?${s}`,{method:"GET",redirect:"follow",signal:n.signal}).then(e=>e.json())))})}}class eB extends eA{constructor(){var e;super(...arguments),e=this,this.swapGeoPoints=function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,{from:a,to:r}=e.searchParams.routes[t];e.searchParams.routes[t].from=r,e.searchParams.routes[t].to=a}}}class eq extends eB{constructor(e){var{suggest:t,calendarApiHost:a,holidaysApiHost:r}=e;super((0,i.Tt)(e,["suggest","calendarApiHost","holidaysApiHost"])),this.suggest=t,this.calendarApiHost=a,this.holidaysApiHost=r}}function eR(e){switch(null==e?void 0:e.type){case"aviaCity":return e.aviaId;case"trainStation":return e.rzdNumber;case"busStop":return e.busId;case"hotelDestination":return e.id;default:return}}class eL{constructor(e){this.logError=e,this.currentItems=(0,r.BX)({from:[{items:[],prevRequest:null,abortController:null,isError:!1,isDefaultItems:!1}],to:[{items:[],prevRequest:null,abortController:null,isError:!1,isDefaultItems:!1}]}),this.loadItems=e=>(0,i.sH)(this,[e],void 0,function*(e){var t,a,n,s;let{fieldName:l,routeIndex:o=0,value:i,relatedField:c}=e;try{let e={fieldName:l,value:i,relatedField:"unknown"!==c.type?c:void 0},u=null===(t=this.currentItems[l][o])||void 0===t?void 0:t.prevRequest;if(!u||u.value!==e.value||eR(u.relatedField)!==eR(e.relatedField)){null===(s=null===(n=null===(a=this.currentItems[l][o])||void 0===a?void 0:a.abortController)||void 0===n?void 0:n.abort)||void 0===s||s.call(n);let t=new AbortController;this.currentItems[l][o]?(this.currentItems[l][o].abortController=(0,r.KR)(t),this.currentItems[l][o].prevRequest=e):this.currentItems[l][o]={items:[],abortController:(0,r.KR)(t),prevRequest:e,isError:!1,isDefaultItems:!1};let i=yield this.getSuggestItems({request:e,abortController:t});if(i.length>0)this.currentItems[l][o].items=i,this.currentItems[l][o].isDefaultItems=!1;else{let e=new AbortController;this.currentItems[l][o].abortController=(0,r.KR)(e),this.currentItems[l][o].items=yield this.getSuggestItems({request:{fieldName:l,value:"",relatedField:"unknown"!==c.type?c:void 0},abortController:e}),this.currentItems[l][o].isDefaultItems=!0}this.currentItems[l][o].isError=!1}}catch(e){if("name"in e&&("AbortError"===e.name||"CancelError"===e.name))return;if(this.currentItems[l][o].isError=!0,this.currentItems[l][o].items=[],this.logError)this.logError(e);else throw e}finally{this.currentItems[l][o].abortController=null}})}getItems(e){var t,a,r,n,s,l;let{fieldName:o,routeIndex:i=0}=e;return{items:null!==(a=null===(t=this.currentItems[o][i])||void 0===t?void 0:t.items)&&void 0!==a?a:[],isError:null!==(n=null===(r=this.currentItems[o][i])||void 0===r?void 0:r.isError)&&void 0!==n&&n,isDefaultItems:null!==(l=null===(s=this.currentItems[o][i])||void 0===s?void 0:s.isDefaultItems)&&void 0!==l&&l}}}class eG extends eL{constructor(e,t){super(t),this.loader=e}getSuggestItems(e){return this.loader.getSuggestItems(e)}}let eW=(0,c.Ts)().rules({routes:(0,c.p_)((0,c.Ts)().rules({from:{requiredFrom:e=>!e||"unknown"===e.type,pointsAreEqual:(e,t)=>{let{data:{to:a}}=t;return"unknown"!==e.type&&"unknown"!==a.type&&e.aviaId===a.aviaId}},to:{requiredTo:e=>!e||"unknown"===e.type,pointsAreEqual:(e,t)=>{let{data:{from:a}}=t;return"unknown"!==a.type&&"unknown"!==e.type&&a.aviaId===e.aviaId}},date:{requiredDate:e=>!e,dateFormat:e=>{if(8!==e.length&&10!==e.length)return!0;let[t,a,r]=e.split(".");return(null==t?void 0:t.length)!==2||2!==a.length||(null==r?void 0:r.length)!==2&&(null==r?void 0:r.length)!==4||isNaN(Number.parseInt(t,10))||isNaN(Number.parseInt(a,10))||isNaN(Number.parseInt(r,10))},inPast:e=>{let[t,a,r]=e.split(".");return new Date(Number(r),Number(a)-1,Number(t),23,59,59).getTime()<new Date().getTime()}}}))});class eY{validate(e){let t=eW.validate(e);return{result:t,isValid:null===t}}}w().extend(I()),w().extend(x());let eX=e=>{let[t,a,r]=e.split(".");return w().utc(`${r}-${a}-${t}`,"YYYY-MM-DD").tz("Europe/Moscow").valueOf()},eK={hotel:"hotels",avia:"avia",train:"train",bus:"bus",etrain:"etrain",go:"trip",tours:"tour",aeroexpress:"aeroexpress",multi:"all"},eQ=e=>{let t={};return e&&(t.departure_date=eX(e)),t},eU=e=>{let t={};return e&&(t.return_date=eX(e)),t};function eJ(e){return{block:"to"===e?"arrival":"departure"}}let eZ=e=>{let{adult:t,child:a,infant:r}=e.getCountsByType();return{adult_count:t,child_count:a,infant_count:r,child_age:e.splitAdults().children.map(e=>e.age)}};function e0(e,t){let a=null;return(null==t?void 0:t.type)==="aviaCity"&&(a=t.aviaId),(null==t?void 0:t.type)==="trainStation"&&(a=t.rzdNumber),(null==t?void 0:t.type)==="busStop"&&(a=t.busId),(null==t?void 0:t.type)==="hotelDestination"&&(a=t.id),(null==t?void 0:t.type)==="unknown"&&(a=t.name),a?{["to"===e?"arrival_geo_id":"departure_geo_id"]:a}:{}}let e1={departure_city_error:"departure_city_error",arrival_city_error:"arrival_city_error",same_cities:"same_cities",wrong_date:"wrong_date"},e2=e=>{var t,a,r;let n=null===(a=null===(t=e.result)||void 0===t?void 0:t.routes)||void 0===a?void 0:a[0],s=[];return(null==n?void 0:n.from)&&(n.from.requiredFrom&&s.push(e1.departure_city_error),n.from.pointsAreEqual&&s.push(e1.same_cities)),(null==n?void 0:n.to)&&(null===(r=n.to)||void 0===r?void 0:r.requiredTo)&&s.push(e1.arrival_city_error),(null==n?void 0:n.date)&&s.push(e1.wrong_date),s};function e3(e){let{enabled:t,callback:a}=e;(0,u.useEffect)(()=>{if(t){let e=setTimeout(a,1e4);return()=>{clearTimeout(e)}}},[t])}let e5=Object.assign(Object.assign({},$()),{monthsShort:["янв","фев","мар","апр","мая","июня","июля","авг","сен","окт","ноя","дек"]});function e9(e,t){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"ru";return w()(e).locale(a,"ru"===a?e5:void 0).format(t).replace(".","")}let e4="D MMM, dd",e6="D MMMM, dd",e7="D MMM",e8=e=>{let{dateFrom:t,dateTo:a,locale:r="ru"}=e;if(t&&a){let e=e9(t,e4,r),n=e9(a,e4,r),s=e9(a,e6,r),l=w()(t).date();return e===n?`${l}\u2009–\u2009${s}`:`${e}\u2009–\u2009${n}`}return t?e9(t,e6,r):""},te=e=>{let{dateFrom:t,dateTo:a,locale:r="ru"}=e,n=w()(t).date();if(w()(t).month()===w()(a).month()){let e=e9(a,e7,r);return`${n}\u00A0–\u00A0${e}`}return`${e9(t,e7,r)}\u00A0–\u00A0${e9(a,e7,r)}`},tt=e=>w()(e).format("DD.MM.YYYY");w().extend(j());let ta=e=>w()(e,"DD.MM.YYYY").toDate();function tr(e){return e?(0,z.ms)(e):{}}let tn=e=>{let{age:t,className:r,infantMaxAge:n,onDeleteClick:s}=e,l=(0,E.OB)(e=>a(29440)(`./${e}/index.json`));return u.createElement(M.fh,Object.assign({addonSize:"small",className:r},(0,d.Ay)("child_passenger")),u.createElement(H.Im,{sizeContrast:"medium-plain"},u.createElement(F.PM,{label:l("title"),value:l("age",{found:0!==t,n:t}),emphasized:!0}),"number"==typeof n&&u.createElement(F.PM,{label:l(t>n?"with_place":"without_place")})),u.createElement(M.$J,null,u.createElement(m.$n,Object.assign({className:r,leftAddon:u.createElement(v.a,{icon:"cross_outline",shape:"noShape",size:100}),size:200,color:"secondary-neutral",onClick:s},(0,d.Ay)("child_passenger_delete_button")))))},ts=(e,t)=>{let a;return function(){for(var r=arguments.length,n=Array(r),s=0;s<r;s++)n[s]=arguments[s];return new Promise(r=>{a&&clearTimeout(a),a=setTimeout(()=>r(e(...n)),t)})}},tl=(e,t)=>{let a=u.useRef();return u.useMemo(()=>function(){for(var r=arguments.length,n=Array(r),s=0;s<r;s++)n[s]=arguments[s];return new Promise(r=>{a.current&&clearTimeout(a.current),a.current=setTimeout(()=>{r(e(...n))},t)})},[e,t])},to=e=>{let{value:t,onPlusClick:r,onMinusClick:n,plusTooltipContent:s,minusTooltipContent:l,isMinusDisabled:o=!1,isPlusDisabled:i=!1,openPlusTooltipOnClick:c=!1,openMinusTooltipOnClick:h=!1,onTooltipOpen:g,autoClosePlusTooltip:f=!1,autoCloseMinusTooltip:y=!1}=e,P=(0,E.OB)(e=>a(65444)(`./${e}/index.json`)),O=tc(y),C=tc(f);return u.createElement("div",{className:(0,T.$)(B.A.wrapper,(0,p.V)("flex"))},u.createElement(_.m,{state:O.state,content:ti(l),position:"end",openOnClick:h,closeOnTooltipClick:!0,stopMouseDownPropagation:!0,onOpen:()=>{null==g||g("minus"),O.handleAutoClose()}},e=>{let{ref:t}=e;return u.createElement("div",{ref:t},u.createElement(m.$n,Object.assign({size:500,color:"secondary-neutral",disabled:o,onClick:n,type:"button","aria-label":P("removePassenger"),className:(0,b.Ms)(200),leftAddon:u.createElement(v.a,{icon:"minus_outline",shape:"noShape",size:200})},(0,d.Ay)("minus_button"))))}),u.createElement("div",Object.assign({className:B.A.count},(0,d.Ay)("count")),t),u.createElement(_.m,{state:C.state,content:ti(s),position:"end",openOnClick:c,closeOnTooltipClick:!0,stopMouseDownPropagation:!0,onOpen:()=>{null==g||g("plus"),C.handleAutoClose()}},e=>{let{ref:t}=e;return u.createElement("div",{ref:t},u.createElement(m.$n,Object.assign({size:500,color:"secondary-neutral",disabled:i,onClick:r,type:"button","aria-label":P("addPassenger"),className:(0,b.Ms)(200),leftAddon:u.createElement(v.a,{icon:"plus_outline",shape:"noShape",size:200})},(0,d.Ay)("plus_button"))))}))};function ti(e){return Array.isArray(e)?u.createElement(H.Im,{sizeContrast:"small-small"},e.map(e=>u.createElement(F.PM,{key:e,label:e,labelColor:"primary"}))):e?u.createElement(H.Im,{sizeContrast:"small-small"},u.createElement(F.PM,{label:e,labelColor:"primary"})):null}function tc(e){let t=(0,V.z)(),a=tl(()=>{t.setOpen(!1)},5e3);return{state:t,handleAutoClose:()=>{e&&a()}}}let tu=e=>{let{value:t,onMinusClick:a,onPlusClick:r,title:n,subtitle:s,isMinusDisabled:l,isPlusDisabled:o,openPlusTooltipOnClick:i,openMinusTooltipOnClick:c,plusTooltipContent:m,minusTooltipContent:p,autoClosePlusTooltip:h,autoCloseMinusTooltip:g,className:v,onTooltipOpen:f}=e;return u.createElement(M.fh,Object.assign({addonSize:"small",contrast:"small",size:"medium",className:(0,T.A)(q.A.cell,v)},(0,d.Ay)("passengers_counter")),u.createElement(H.Im,null,u.createElement(F.PM,Object.assign({isLabelAccent:!0,label:n,emphasized:!0},(0,d.Ay)("passengers_counter_title"))),u.createElement(F.PM,Object.assign({label:s},(0,d.Ay)("passengers_counter_subtitle")))),u.createElement(M.$J,null,u.createElement(to,{value:t,isMinusDisabled:l,isPlusDisabled:o,openPlusTooltipOnClick:i,openMinusTooltipOnClick:c,plusTooltipContent:m,minusTooltipContent:p,autoClosePlusTooltip:h,autoCloseMinusTooltip:g,onMinusClick:a,onPlusClick:r,onTooltipOpen:f})))},td=e=>{let{currentValue:t,items:a,onChange:r,className:n}=e,s=e=>{r(e)};return u.createElement(R.Z,{className:(0,T.$)((0,p.V)("flex"),n),backgroundColor:"secondary",topLeftRound:300,topRightRound:300,bottomLeftRound:300,bottomRightRound:300,paddingLeft:100,paddingRight:100,paddingBottom:100,paddingTop:100},a.map(e=>{let a=t===e.value;return u.createElement("button",Object.assign({key:e.value,type:"button",className:(0,T.$)(L.A.button,(0,b.dG)(200),(0,b.wv)(400),(0,b.Th)(200),(0,b.zG)(400),{[L.A.selected]:a}),onClick:()=>s(e.value)},(0,d.Ay)("segment_control_button")),e.label)}))},tm=e=>{let{text:t,"data-ti":a}=e;return u.createElement(f.P,{className:(0,T.A)(Y.A.text,(0,b.Ms)(350)),size:"paragraph-medium","data-ti":a},t)},tp=()=>{let e=(0,E.OB)(e=>a(12059)(`./${e}/index.json`));return u.createElement(u.Fragment,null,u.createElement("div",{className:(0,b.cV)(350)},u.createElement(f.P,{size:"paragraph-medium",hasExtraPaddingTop:!0},e("age_group_general_paragraph_1")),u.createElement(f.P,{size:"paragraph-medium"},e("age_group_general_paragraph_2"))),u.createElement("div",{className:(0,b.cV)(200)},u.createElement(M.fh,{addonSize:"small",size:"medium",contrast:"plain"},u.createElement(M.KX,{icon:"person-child-stroller"}),u.createElement(F.PM,{label:e("age_group_title_type_1"),emphasized:!0})),u.createElement(f.P,{size:"paragraph-medium"},e("age_group_paragraph_1_type_1")),u.createElement(f.P,{size:"paragraph-medium"},e("age_group_paragraph_2_type_1")),u.createElement(f.P,{size:"paragraph-medium"},e("age_group_paragraph_3_type_1"))),u.createElement("div",{className:(0,b.cV)(200)},u.createElement(M.fh,{addonSize:"small",size:"medium",contrast:"plain"},u.createElement(M.KX,{icon:"person-child"}),u.createElement(F.PM,{label:e("age_group_title_type_2"),emphasized:!0})),u.createElement(f.P,{size:"paragraph-medium",hasExtraPaddingTop:!0},e("age_group_paragraph_type_2"))),u.createElement(M.fh,{addonSize:"small",size:"medium",contrast:"plain"},u.createElement(M.KX,{icon:"person-child"}),u.createElement(F.PM,{label:e("age_group_title_type_3"),emphasized:!0})),u.createElement(f.P,{size:"paragraph-medium",hasExtraPaddingTop:!0},e("age_group_paragraph_type_3")))},th=e=>{let{withoutPlaceAvailable:t=!0}=e,{isOpen:r,setOpen:n}=(0,V.z)({initialIsOpen:!1}),s=(0,E.OB)(e=>a(12059)(`./${e}/index.json`)),l=Array.from({length:12},(e,t)=>t),o=l.slice(0,2),i=l.slice(2,l.length),{userway:c}=(0,y.te)();return u.createElement(u.Fragment,null,u.createElement(H.Im,{sizeContrast:"medium-small",className:(0,T.A)((0,b.cV)(200),X.A.titleChildrenModal)},u.createElement(F.PM,{emphasized:!0,isLabelAccent:!0,label:s("title-childrenModal")}),u.createElement(F.PM,{label:s("subtitle-childrenModal")})),u.createElement("div",{className:(0,b.cV)(200)},u.createElement(M.fh,{addonSize:"small",size:"medium",contrast:"small",hasSeparator:!0},u.createElement(M.KX,{iconStyle:"secondary",icon:"person-child-stroller"}),u.createElement(F.PM,{labelColor:"secondary",emphasized:!0,label:s("without_place")})),o.map(e=>u.createElement(G.t,{value:e,key:e,disabled:!t},u.createElement(M.fh,{addonSize:"none",size:"medium",contrast:"small"},u.createElement(F.PM,{labelColor:t?"primary":"secondary",label:s("age",{found:0!==e,n:e}),expanded:!0,emphasized:!0})))),!t&&u.createElement(tm,Object.assign({text:s("infants_age_alert")},(0,d.Ay)("infants_age_alert")))),u.createElement("div",{className:(0,b.cV)(200)},u.createElement(M.fh,{addonSize:"small",size:"medium",contrast:"small",hasSeparator:!0},u.createElement(M.KX,{iconStyle:"secondary",icon:"person-child"}),u.createElement(F.PM,{labelColor:"secondary",emphasized:!0,label:s("with_place")})),i.map(e=>u.createElement(G.t,{value:e,key:e},u.createElement(M.fh,{addonSize:"none",size:"medium",contrast:"small"},u.createElement(F.PM,{label:s("age",{found:0!==e,n:e}),emphasized:!0,expanded:!0}))))),u.createElement(m.$n,{className:(0,b.cV)(300),color:"secondary",size:400,firstLabel:s("age_informer_button"),fullWidth:!0,leftAddon:u.createElement(v.a,{icon:"info-circle"}),onClick:()=>{n(!r),null==c||c({title:"search_form_info_children_age_click",product:"avia"})}}),u.createElement(W.aF,{isOpen:r,setOpen:n,title:s("why_choose_age"),hasBackButton:!1,size:"small"},u.createElement(tp,null)))},tg=e=>{let{maxPassengers:t,onServiceClassChange:r,currentServiceClass:s,passengers:l,onClose:o}=e,[i,c]=u.useState(!1),p=(0,n.s)(l),{adults:h,children:g}=p.splitAdults(),f=p.getCountsByType(),{userway:_}=(0,y.te)(),P=f.adult,O=(0,E.OB)(e=>a(12059)(`./${e}/index.json`)),C=P-f.infant>0,w=P===f.infant||1===P,k=t===p.list.length,x=P>1&&P<=f.infant,A=[O("max_infant_passengers_part_1"),O("max_infant_passengers_part_2")],I=[{label:O("economy"),value:"Y"},{label:O("business"),value:"C"}],N=e=>{l.remove(e)},$=()=>{c(!i),null==_||_({title:"search_form_add_child_click",product:"avia"})};return u.createElement(u.Fragment,null,u.createElement(tu,{isMinusDisabled:w,isPlusDisabled:k,value:P,openPlusTooltipOnClick:k,openMinusTooltipOnClick:x,plusTooltipContent:O("max_passengers",{count:t}),minusTooltipContent:A,autoClosePlusTooltip:!0,autoCloseMinusTooltip:!0,title:O("adults"),subtitle:O("initial_adult_age"),className:(0,b.S3)(100),onMinusClick:()=>{null==_||_({title:"search_form_change_adults_click",product:"avia",element_name:"minus",adult_count:P-1}),1!==P&&l.remove(h[h.length-1].id)},onPlusClick:()=>{null==_||_({title:"search_form_change_adults_click",product:"avia",element_name:"plus",adult_count:P+1}),l.add(null)},onTooltipOpen:e=>{"plus"===e?null==_||_({title:"search_form_max_passengers_tooltip_shown",product:"avia"}):"minus"===e&&(null==_||_({title:"search_form_children_tooltip_shown",product:"avia"}))}}),g.map(e=>{let{id:t,age:a}=e;return u.createElement(tn,{key:t,age:a,infantMaxAge:1,onDeleteClick:()=>{N(t),null==_||_({title:"search_form_remove_child_click",product:"avia"})}})}),u.createElement(D.y,{containerStyle:{xs:"modal",lg:"dropdown"},size:700,onChange:e=>{l.add(e),c(!1)},isOpen:i,renderContent:()=>u.createElement(th,{withoutPlaceAvailable:C}),setOpen:c,modalProps:{title:O("title-childrenModal"),subtitle:O("subtitle-childrenModal"),closeOnClickOutside:!0,closeOnCloseButtonClick:!0},dropdownProps:{closeOnClickOutside:!0,stopMouseDownPropagation:!0,useAvailableScreenHeight:!0,minHeight:"300px",minWidth:"330px"}},e=>{let{ref:t}=e;return u.createElement(m.$n,Object.assign({ref:t,className:(0,b.S3)(200),disabled:k,leftAddon:u.createElement(v.a,{icon:"person-child"}),size:400,color:"secondary",firstLabel:O("add_child_button"),onClick:$,fullWidth:!0},(0,d.Ay)("add_child_button")))}),u.createElement(td,{className:(0,T.$)((0,b.S3)(350),(0,b.cV)({xs:0,lg:300})),currentValue:s,onChange:r,items:I}),u.createElement(m.$n,{className:(0,T.$)(X.A.passengersReadyButton,(0,b.S3)(350)),size:500,fullWidth:!0,color:"primary",type:"button",firstLabel:O("ready"),onClick:o}))},tv=e=>{let{searchParams:t,initiated:r,theme:s}=e,[l,o]=u.useState(!1),{userway:i}=(0,y.te)(),c=(0,E.OB)(e=>a(12059)(`./${e}/index.json`)),d=(0,n.s)(t),m=e=>{t.serviceClass=e,null==i||i({title:"search_form_change_service_class_click",product:"avia",service_class:e})},p=c("input_value",{count:d.passengers.list.length,serviceClass:d.serviceClass}),v=()=>{o(!l),null==i||i({title:"search_form_change_passengers_click",product:"avia",passenger_count:t.passengers.list.length,service_class:t.serviceClass})},f=()=>{null==i||i(Object.assign({title:"search_form_close_passengers_click",product:"avia",passenger_count:t.passengers.list.length,service_class:t.serviceClass,element_state:"other"},eZ(t.passengers)))},b=()=>{null==i||i(Object.assign({title:"search_form_close_passengers_click",product:"avia",passenger_count:t.passengers.list.length,service_class:t.serviceClass,element_state:"button"},eZ(t.passengers)))};return u.createElement(D.y,{size:700,containerStyle:{xs:"modal",lg:"dropdown"},isOpen:l,renderContent:()=>u.createElement(tg,{maxPassengers:9,onServiceClassChange:m,currentServiceClass:d.serviceClass,passengers:t.passengers,onClose:()=>{o(!1),b()}}),setOpen:o,modalProps:{title:c("mobile_title"),closeOnClickOutside:!0,closeOnCloseButtonClick:!0,onClickOutside:f,minHeight:"auto",stopMouseDownPropagation:!1},dropdownProps:{closeOnClickOutside:!0,onClickOutside:f,position:"end",minWidth:"370px"}},e=>{let{ref:t}=e;return u.createElement(g.p,{wrapperClassName:`${X.A.passengers} ${(0,h.tG)({xs:["top","bottom"],lg:["none"]})}`,containerRef:t,position:{lg:"middle-horizontal",xl:"middle-horizontal"},"data-ti":"passengers_input",type:"text",label:c("input_label"),value:r?p:"",onClick:v,readOnly:!0,clearButtonType:"hidden",wrapperProps:tr(s)})})},tf=(0,u.createContext)(400);function tb(e){let{isDefaultItems:t,loadItems:a,point:r,setPoint:n,product:s,fieldName:l,label:o,hasError:i,errorMessage:c,onBlur:d,onFocus:m,inputRef:p,tabIndex:h,renderContent:g,items:v=[],selectOnClose:b,position:E,wrapperClassName:P,onErrorMessageClose:O,theme:C}=e,{userway:w}=(0,y.te)(),k=null!=b?b:!t,x=(0,K.a8)({value:{xs:"modal",lg:"dropdown"}}),A=(0,V.z)(),[I,N]=u.useState(""),$=()=>{null==w||w(Object.assign({title:"search_form_close_city_suggest_click",product:eK[s]},eJ(l)))},S=()=>{null==w||w(Object.assign({title:"search_form_clean_city_field_click",product:eK[s]},eJ(l)))},j=e=>{var t,a;n(e.hiddenValue.geoPoint),null==w||w(Object.assign(Object.assign(Object.assign({title:"search_form_select_city_click",product:eK[s]},eJ(l)),e0(l,null===(t=e.hiddenValue)||void 0===t?void 0:t.geoPoint)),{total_number_of_suggests:v.length,number_of_typed_symbols:("modal"===x?I:r.name).length,position_click:null===(a=e.hiddenValue)||void 0===a?void 0:a.index,hint_type_click:t_(e),hint_types_available:v.map(t_).filter((e,t,a)=>a.indexOf(e)===t)}))},z=()=>{null==w||w(Object.assign({title:"search_form_city_field_click",product:eK[s]},e0(l,r)))},D=()=>{null==w||w(Object.assign(Object.assign({title:"search_form_city_suggest_shown",product:eK[s]},eJ(l)),{total_number_of_suggests:v.length,element_state:"click"}))},T=(0,u.useContext)(tf),M=(0,u.useMemo)(()=>ts(e=>{a(e)},T),[a,T]);return u.useEffect(()=>{"dropdown"===x&&M(r.name),"modal"===x&&M(A.isOpen?I:"")},[x,A,I,r.name,M]),e3({enabled:!!c,callback:O}),u.createElement(_.$,{open:!!c,content:u.createElement(f.L9,{color:"primary"},c),side:"modal"===x?"bottom":"top",maxWidth:"targetWidth",onClick:O,onClickOutside:O,position:"start"},e=>{let{ref:t}=e;return u.createElement(Q.Ps,Object.assign({},A,{wrapperClassName:P,position:E,tabIndex:h,onFocus:m,onBlur:d,ref:p,containerRef:t,containerStyle:null!=x?x:"modal",value:r.name,items:v,label:o,modalProps:{title:o,minHeight:"99%"},hasError:i,modalInputProps:{placeholder:r.name,value:I,onChange:e=>{N(e.currentTarget.value)}},dropdownProps:{maxHeight:450,minWidth:"300px",flip:!1},onChange:e=>{r.name!==e.currentTarget.value&&n({type:"unknown",name:e.currentTarget.value})},onValueSelect:j,renderContent:g,onClose:e=>{e.items&&e.items.length>0&&"dropdown"===e.style&&"select"!==e.reason&&""!==r.name&&"unknown"===r.type&&k&&n(e.items[0].hiddenValue.geoPoint),N(""),"modal"===e.style&&"closeButton"===e.reason&&$()},onMouseDown:z,onClear:S,selectFirstItemOnEnterKeyPress:"modal"===x?""!==I:""!==r.name,onOpen:D,wrapperProps:tr(C)}))})}function t_(e){var t;return(null===(t=e.hiddenValue)||void 0===t?void 0:t.isNearest)?"nearest":"popular"}let ty=(0,u.memo)(e=>{let{fieldName:t,suggest:r}=e,s=(0,E.OB)(e=>a(53189)(`./${e}/index.json`)),{items:l,isError:o}=(0,n.s)(r).getItems({fieldName:t});if(o&&0===l.length)return u.createElement(Q.FC,null,s("error"));let i=0;return l.map((e,t)=>{var a;let r=l.length-1===t;return e.hasNoAirport?u.createElement(u.Fragment,{key:e.geoPoint.aviaId},u.createElement(M.fh,Object.assign({addonSize:"none",size:"medium",contrast:"plain"},(0,d.th)("no-airport-item")),u.createElement(H.Im,null,u.createElement(F.PM,{label:e.geoPoint.name,isLabelAccent:!0,labelColor:"secondary",value:s("no_airport"),isValueNumeric:!0,isValueAccent:!0,emphasized:!0}),e.country&&u.createElement(F.PM,{label:e.country.name}))),(null!==(a=e.closestCities)&&void 0!==a?a:[]).length>0&&u.createElement(u.Fragment,null,u.createElement(Q.Rq,null,u.createElement(F.PM,{label:s("nearest_cities"),isLabelAccent:!0,labelColor:"secondary"})),e.closestCities.map((t,a)=>{var n;return u.createElement(Q.y$,{value:`${i++}_${t.geoPoint.aviaId}`,key:t.aviaCode,className:r||a!==e.closestCities.length-1?void 0:X.A.lastCity,addonSize:"none",hasSeparator:!r&&a===e.closestCities.length-1},u.createElement(H.Im,null,u.createElement(F.PM,{label:t.geoPoint.name,value:t.aviaCode,isLabelAccent:!0,emphasized:!0}),(t.distance||t.country)&&u.createElement(F.PM,{label:t.distance?`${t.distance}${s("distance_unit")}`:null===(n=t.country)||void 0===n?void 0:n.name})))}))):u.createElement(Q.y$,{value:`${i++}_${e.geoPoint.aviaId}`,key:e.aviaCode},u.createElement(H.Im,null,u.createElement(F.PM,{label:e.geoPoint.name,isLabelAccent:!0,value:e.aviaCode,emphasized:!0}),e.country&&u.createElement(F.PM,{label:e.country.name})))})});function tE(e){var t;let{fieldName:a,suggest:r,routeIndex:s=0,searchParams:l}=e,o=(0,i.Tt)(e,["fieldName","suggest","routeIndex","searchParams"]),c=(0,n.s)(r),{items:d,isDefaultItems:m}=c.getItems({fieldName:a}),p=(0,n.s)(l,{sync:!0}).routes[s],h=p["from"===a?"to":"from"],g=d.flatMap(e=>e.hasNoAirport?e.closestCities:[e]).map((e,t)=>({value:`${t}_${e.geoPoint.aviaId}`,hiddenValue:Object.assign(Object.assign({},e),{index:t})})),v=(0,u.useCallback)(e=>{c.loadItems({value:e,fieldName:a,relatedField:h,routeIndex:s})},[a,h,s,c]);return u.createElement(tb,Object.assign({},o,{fieldName:a,point:p[a],setPoint:e=>{l.routes[s][a]=e},isDefaultItems:m,items:g,selectOnClose:!(null===(t=d[0])||void 0===t?void 0:t.hasNoAirport),loadItems:v,renderContent:()=>u.createElement(ty,{suggest:r,fieldName:a})}))}let tP={requiredFrom:"Выберите город вылета",requiredTo:"Выберите город прилёта",pointsAreEqual:"Места отправления и\xa0назначения не\xa0должны совпадать",requiredDate:"Выберите дату вылета",dateFormat:"Неправильный формат даты",inPast:"Выберите не\xa0прошедшую дату"},tO=!1,tC=["from","to","date"],tw={aviaId:"491",name:"Москва",type:"aviaCity",translitName:"Moskva"},tk={aviaId:"75",name:"Санкт-Петербург",type:"aviaCity",translitName:"Sankt-peterburg"},tx=[tw,tk],tA=[tk,tw],tI=new Date,tN=new Date(tI.getFullYear(),tI.getMonth(),tI.getDate()+1),t$=[{name:"Сегодня",date:tt(tI)},{name:"Завтра",date:tt(tN)}],tS=e=>{var t,r,s,l,o,i,c;let{model:C,inputsTheme:w}=e,k=(0,P.Y)({min:"lg"}),x=(0,E.OB)(e=>a(78158)(`./${e}/index.json`)),[A,I]=u.useState(!1),N=(0,n.s)(C),{chosenDates:$,setStateChosenDates:S,setInputFocus:j}=(0,O.x)({dateFrom:N.searchParams.routes[0].date?ta(N.searchParams.routes[0].date):null,dateTo:N.searchParams.routes[0].secondDate?ta(N.searchParams.routes[0].secondDate):null}),z=$.dateFrom?tt($.dateFrom):void 0,D=$.dateTo?tt($.dateTo):void 0;(N.searchParams.routes[0].date!==z||N.searchParams.routes[0].secondDate!==D)&&S(e=>Object.assign(Object.assign({},e),{dateFrom:N.searchParams.routes[0].date?ta(N.searchParams.routes[0].date):null,dateTo:N.searchParams.routes[0].secondDate?ta(N.searchParams.routes[0].secondDate):null}));let T={from:N.searchParams.routes[0].from.aviaId,to:N.searchParams.routes[0].to.aviaId},M=e=>{C.searchParams.routes[0].date=e.dateFrom?tt(e.dateFrom):void 0,C.searchParams.routes[0].secondDate=e.dateTo?tt(e.dateTo):void 0},F=()=>{M({dateFrom:null,dateTo:null})},{validationEnabled:H}=N.state,{result:V}=H?N.validationResult:{result:null},[B,q]=(0,u.useState)(null),R=null===(t=null==V?void 0:V.routes)||void 0===t?void 0:t[0],L=(()=>{var e,t;if(!R)return null;if(B)for(let e=0;e<tC.length;e++){let t=tC[e];if(R[t]&&B===t)return t}if((null===(e=R.from)||void 0===e?void 0:e.errors[0].type)==="pointsAreEqual"&&(null===(t=R.to)||void 0===t?void 0:t.errors[0].type)==="pointsAreEqual")return"to";for(let e=0;e<tC.length;e++){let t=tC[e];if(R[t])return t}return null})(),{userway:G}=(0,y.te)(),W=()=>{C.swapGeoPoints(),null==G||G({title:"search_form_change_destination_click",product:"avia"})},[Y,K]=(0,u.useState)({from:!1,to:!1,date:!1}),Q=()=>{var e;(null===(e=C.validationResult)||void 0===e?void 0:e.isValid)||null==G||G({title:"search_form_error_shown",product:"avia",validation_errors:e2(N.validationResult)}),C.submit(),q(null),K({from:!1,to:!1,date:!1});let{from:t,to:a,date:r,secondDate:n}=C.searchParams.routes[0],s="aviaCity"===t.type?{departure_geo_id:t.aviaId}:{},l="aviaCity"===a.type?{arrival_geo_id:a.aviaId}:{},{searchId:o}=C.submitter;null==G||G(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({title:"search_form_search_click",product:"avia",search_id:o},s),l),eQ(r)),eU(n)),{route_type:n?"roundtrip":"oneway",passenger_count:C.searchParams.passengers.list.length,service_class:C.searchParams.serviceClass}),eZ(C.searchParams.passengers)))},U="date"===L&&!Y.date,J=(0,u.useCallback)(()=>{K(e=>Object.assign(Object.assign({},e),{date:!0}))},[]);return e3({enabled:U,callback:J}),(0,u.useEffect)(()=>{if(C.init(),!tO){let{from:e,to:t,date:a,secondDate:r}=C.searchParams.routes[0],n="aviaCity"===e.type?{departure_geo_id:e.aviaId}:{},s="aviaCity"===t.type?{arrival_geo_id:t.aviaId}:{};null==G||G(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({title:"search_form_first_shown",product:"avia"},n),s),eQ(a)),eU(r)),{route_type:r?"roundtrip":"oneway",passenger_count:C.searchParams.passengers.list.length,service_class:C.searchParams.serviceClass}),eZ(C.searchParams.passengers))),tO=!0}},[C,G]),u.createElement(h.gE,Object.assign({size:{xs:500,sm:700},layout:{xs:"vertical",xl:"horizontal"}},(0,d.th)("avia-search-form")),u.createElement("div",{className:X.A.searchForm},u.createElement("div",{className:`${X.A.firstSubGroup} ${(0,h.tG)({lg:["bottom"],xl:["none"]})}`},u.createElement("div",{className:X.A.departure},u.createElement(tE,{product:"avia",position:{xs:"top",lg:"left"},label:"Откуда",fieldName:"from",searchParams:C.searchParams,suggest:C.suggest,hasError:!!(null==R?void 0:R.from),errorMessage:"from"!==L||Y.from?void 0:tP[null===(l=null===(s=null===(r=null==R?void 0:R.from)||void 0===r?void 0:r.errors)||void 0===s?void 0:s[0])||void 0===l?void 0:l.type],onFocus:()=>{H&&q("from")},tabIndex:0,onErrorMessageClose:()=>{K(e=>Object.assign(Object.assign({},e),{from:!0}))},theme:w}),u.createElement("div",{className:`${(0,p.V)({xs:"none",xl:"inline-flex"})} ${(0,b.S3)(200)} ${(0,b.rQ)(100)}`},tx.map(e=>u.createElement(m.$n,Object.assign({color:"secondary-neutral",size:300,key:e.name,onClick:()=>{C.searchParams.routes[0].from=e,null==G||G({title:"search_form_city_hint_click",product:"avia",geo_id:e.aviaId,block:"departure"})}},(0,d.th)("fromHint")),e.name)))),u.createElement(m.$n,Object.assign({"aria-label":x("swapGeoPoints"),className:`${X.A.switcher} ${(0,p.V)({xs:"inline-flex",lg:"none"})}`,accent:"default",color:"outline-form",leftAddon:u.createElement(v.a,{icon:"arrow-2-up-down_outline"}),size:{xs:300,sm:400},onClick:W,tabIndex:0},(0,d.th)("swapButton"),tr(w))),u.createElement(m.$n,Object.assign({"aria-label":x("swapGeoPoints"),position:{lg:"middle-horizontal"},className:`${X.A.switcher} ${(0,p.V)({xs:"none",lg:"inline-flex"})}`,accent:"default",color:"outline-form",leftAddon:u.createElement(v.a,{icon:"arrow-2-left-right_outline"}),size:700,onClick:W,tabIndex:0},(0,d.th)("swapButton"),tr(w))),u.createElement("div",{className:X.A.arrival},u.createElement(tE,{product:"avia",position:{xs:"middle-vertical",lg:"right",xl:"middle-horizontal"},label:"Куда",fieldName:"to",searchParams:C.searchParams,suggest:C.suggest,hasError:!!(null==R?void 0:R.to),errorMessage:"to"!==L||Y.to?void 0:tP[null===(c=null===(i=null===(o=null==R?void 0:R.to)||void 0===o?void 0:o.errors)||void 0===i?void 0:i[0])||void 0===c?void 0:c.type],onFocus:()=>{H&&q("to")},tabIndex:0,onErrorMessageClose:()=>{K(e=>Object.assign(Object.assign({},e),{to:!0}))},theme:w}),u.createElement("div",{className:`${(0,p.V)({xs:"none",xl:"inline-flex"})} ${(0,b.S3)(200)} ${(0,b.rQ)(100)}`},tA.map(e=>u.createElement(m.$n,Object.assign({color:"secondary-neutral",size:300,key:e.name,onClick:()=>{C.searchParams.routes[0].to=e,null==G||G({title:"search_form_city_hint_click",product:"avia",geo_id:e.aviaId,block:"arrival"})}},(0,d.th)("toHint")),e.name))))),u.createElement(O.C,{withAnimation:!1,product:"avia",block:"search_form",apiHost:N.calendarApiHost,calendarHost:N.holidaysApiHost,isDesktop:null==k||k,cityIds:T,disabledOnTargetClick:A,chosenDates:$,setStateChosenDates:S,onChangeDates:M,onOpen:()=>{I(!0)},onClose:()=>{I(!1)},popupContentClassName:X.A.calendarPopup,serviceClass:N.searchParams.serviceClass,passengers:N.searchParams.passengers.getCountsByType(),target:e=>{var t,a,r;let{onClick:n,ref:s}=e,l=e=>{j($.dateFrom&&$.dateTo?"to":"from"),null==n||n(e)};return u.createElement("div",{className:`${X.A.secondSubGroup}`},u.createElement("div",{className:X.A.targetDate},u.createElement(_.$,{open:U,content:u.createElement(f.L9,{color:"primary"},tP[null===(r=null===(a=null===(t=null==R?void 0:R.date)||void 0===t?void 0:t.errors)||void 0===a?void 0:a[0])||void 0===r?void 0:r.type]),side:"top",onClick:J,onClickOutside:J,position:"start"},e=>{var t,a;let{ref:r}=e;return u.createElement("div",{ref:s},u.createElement(g.p,{wrapperClassName:`${X.A.date} ${(0,h.tG)({xs:["bottom"],lg:["none"]})}`,wrapperProps:tr(w),position:{xs:"bottom",lg:"left",xl:"middle-horizontal"},containerRef:r,"data-ti":"trip-dates",type:"text",label:"Когда",value:e8({dateFrom:$.dateFrom,dateTo:$.dateTo}),onChange:()=>{},hasError:H&&!!(null===(a=null===(t=null==V?void 0:V.routes)||void 0===t?void 0:t[0])||void 0===a?void 0:a.date),onClick:l,onClear:F,onFocus:()=>{H&&q("date")},onBlur:()=>{j("from")},tabIndex:0,readOnly:!0}))}),u.createElement("div",{className:`${(0,p.V)({xs:"none",xl:"inline-flex"})} ${(0,b.S3)(200)} ${(0,b.rQ)(100)}`},t$.map(e=>u.createElement(m.$n,{color:"secondary-neutral",size:300,key:e.name,onClick:()=>{C.searchParams.routes[0].date=e.date,null==G||G({title:"search_form_date_hint_click",product:"avia",departure_date:eX(e.date)})}},e.name)))),u.createElement(tv,{searchParams:C.searchParams,initiated:N.state.initiated,theme:w}),u.createElement("div",{className:X.A.submitButton},u.createElement(m.$n,Object.assign({isLoading:N.submitted,className:`${(0,h.tG)({xs:["top"],lg:["none"]})}`,position:{lg:"right"},fullWidth:!0,color:"primary",type:"button","data-ti":"submit-button",onClick:Q},tr(w)),x("find_tickets"))))}})))};class tj extends eC{get infantMaxAge(){return null}get childMaxAge(){return 11}}class tz{getInitialSearchParams(e){var t,a;let r=tD();if(!e)return r;let n=this.convertOuterSearchParams(e);return{routes:null!==(t=n.routes)&&void 0!==t?t:r.routes,passengers:null!==(a=n.passengers)&&void 0!==a?a:r.passengers}}convertOuterSearchParams(e){var t;let a=null==e?void 0:e.routes[0];return Object.assign({routes:[{from:a.from?{type:"busStop",name:a.from.value,busId:a.from.id,translitName:a.from.translitName,popular:a.from.popular}:{type:"unknown",name:""},to:a.to?{type:"busStop",name:a.to.value,busId:a.to.id,translitName:a.to.translitName,popular:a.to.popular}:{type:"unknown",name:""},date:null!==(t=a.date)&&void 0!==t?t:void 0}]},e.passengers?{passengers:new tj(e.passengers)}:{})}}function tD(){return{routes:[{from:{type:"unknown",name:""},to:{type:"unknown",name:""},date:void 0}],passengers:new tj}}function tT(e){return!!e&&"busStop"===e.type}function tM(e){return!!e&&void 0!==e.translitName}function tF(e){return!!e&&void 0!==e.popular}function tH(e){return!!e&&"object"==typeof e&&!!("busId"in e&&"name"in e&&"translitName"in e&&"popular"in e&&eN(e.busId)&&eN(e.name)&&eN(e.translitName))&&"boolean"==typeof e.popular}let tV=(e,t)=>{let{date:a}=e,r=tH(e.from)?e.from:t.from,n=tH(e.to)?e.to:t.to,s=tT(r)?`fbid::${r.busId};`:"",l=tT(n)?`tbid::${n.busId};`:"",o=tM(n)?`tt::${n.translitName};`:"",i=tM(r)?`ft::${r.translitName};`:"",c=tF(r)?`fp::${r.popular};`:"",u=tF(n)?`tp::${n.popular};`:"",d=eN(r.name)?`f::${r.name};`:"",m=eN(n.name)?`t::${n.name};`:"",p=eI(a)?`d::${a};`:"";return`${d}${s}${i}${m}${l}${o}${c}${u}${p}`},tB=(e,t)=>{let{routes:a,passengers:r}=e,n=tV(a[0],t.routes[0]),s=r.list.map(e=>{let{age:t}=e;return t}),l=r?`p::${JSON.stringify(s)};`:"";return`${l}${n}`},tq=(e,t)=>{let a=null==e?void 0:e.split(";"),r={p:"[null]",f:"",fbid:"",ft:"",t:"",tbid:"",tt:"",d:void 0,fp:"",tp:""};null==a||a.forEach(e=>{let[t,a]=e.split("::");t&&a&&(r[t]=a)});let n={type:"busStop",name:r.f,busId:r.fbid,translitName:r.ft,popular:"true"===r.fp},s={type:"busStop",name:r.t,busId:r.tbid,translitName:r.tt,popular:"true"===r.tp},l=tH(n)?n:t.routes[0].from,o=tH(s)?s:t.routes[0].to,i=eO(r.p);return{routes:[{from:l,to:o,date:e$(r.d)}],passengers:new tj(i)}};class tR extends eP{constructor(){super(...arguments),this.initialSearchParams=tD(),this.busCookieName="sf_bus"}searchParamsToCookieValue(e){return tB(e,this.initialSearchParams)}cookieValueToSearchParams(e){return tq(e,this.initialSearchParams)}get cookieName(){return this.busCookieName}}class tL{constructor(e){this.params=e}gotoOffers(e){this.busSearchId=(0,l.A)();let t=e.routes[0];this.openOffersPage((0,o.EB)(Object.assign(Object.assign({mainDomain:this.params.busHost.replace("https://","").replace("http://","")},(null==t?void 0:t.date)?{searchId:this.searchId}:{}),this.getExternalSearchParams(e))))}openOffersPage(e){location.href=e}getExternalSearchParams(e){return{trips:e.routes.map(e=>{let{date:t,from:a,to:r}=e;if("busStop"!==a.type)throw Error("route.from is not correct bus stop");return{date:t,from:this.getBusCity(a),to:"busStop"===r.type?this.getBusCity(r):null}}),passengers:e.passengers.list.length}}getBusCity(e){return{id:e.busId,value:e.name,translitName:e.translitName,popular:e.popular}}get searchId(){return this.busSearchId}}class tG{static getSuggestItems(e){var t;return(null!==(t=null==e?void 0:e.client)&&void 0!==t?t:J.Sn).get(Object.assign(Object.assign({},e),{url:"/geo/suggest"}))}}class tW{constructor(e,t){this.service=(0,U.r)({service:tG,baseUrl:`${eu(e)}/api/v1`,client:t})}getSuggestItems(e){return(0,i.sH)(this,arguments,void 0,function*(e){let{request:{value:t,fieldName:a,relatedField:r},abortController:n}=e,s="to"===a&&(null==r?void 0:r.type)==="busStop"?Number(r.busId):void 0,l=yield this.service.getSuggestItems({query:{name:t,departure_id:s},signal:n.signal});if(l.error){if(l.error instanceof Error)throw l.error;throw Error("Error during response to bus suggest")}return function(e){var t,a,r,n,s,l,o,i,c;if(!e)throw Error("response is empty");if((null!==(t=e.errors)&&void 0!==t?t:[]).length>0){let{code:t,message:a}=e.errors[0];throw Error(`Code: ${t}. Message: ${a}`)}let u=Object.fromEntries(null!==(r=null===(a=e.data)||void 0===a?void 0:a.countries.map(e=>[e.id,e]))&&void 0!==r?r:[]),d=Object.fromEntries(null!==(s=null===(n=e.data)||void 0===n?void 0:n.districts.map(e=>[e.id,e]))&&void 0!==s?s:[]),m=Object.fromEntries(null!==(o=null===(l=e.data)||void 0===l?void 0:l.regions.map(e=>[e.id,e]))&&void 0!==o?o:[]);return null!==(c=null===(i=e.data)||void 0===i?void 0:i.geopoints.map(e=>{var t,a,r,n,s,l,o,i,c;return{type:"geoPoint",geoPoint:{type:"busStop",busId:String(e.id),name:e.name,popular:e.popular,translitName:null===(a=null===(t=e.names)||void 0===t?void 0:t.find(e=>"ru@translit"===e.langCode))||void 0===a?void 0:a.name},country:(null===(r=u[e.countryId])||void 0===r?void 0:r.name)?{name:u[e.countryId].name}:void 0,district:(null===(s=d[null!==(n=e.districtId)&&void 0!==n?n:""])||void 0===s?void 0:s.name)?{name:d[null!==(l=e.districtId)&&void 0!==l?l:""].name}:void 0,region:(null===(i=m[null!==(o=e.regionId)&&void 0!==o?o:""])||void 0===i?void 0:i.name)?{name:m[null!==(c=e.regionId)&&void 0!==c?c:""].name}:void 0}}))&&void 0!==c?c:[]}(l.data)})}}class tY extends eB{constructor(e){var{suggest:t,calendarApiHost:a,holidaysApiHost:r}=e;super((0,i.Tt)(e,["suggest","calendarApiHost","holidaysApiHost"])),this.suggest=t,this.calendarApiHost=a,this.holidaysApiHost=r}}class tX extends eL{constructor(e,t){super(t),this.loader=e}getSuggestItems(e){return this.loader.getSuggestItems(e)}}let tK=(0,c.Ts)().rules({routes:(0,c.p_)((0,c.Ts)().rules({from:{requiredFrom:e=>!e||"unknown"===e.type,pointsAreEqual:(e,t)=>{let{data:{to:a}}=t;return"unknown"!==e.type&&"unknown"!==a.type&&e.busId===a.busId}},to:{pointsAreEqual:(e,t)=>{let{data:{from:a}}=t;return"unknown"!==a.type&&"unknown"!==e.type&&a.busId===e.busId}},date:{inPast:e=>{if(!e)return!1;let[t,a,r]=e.split(".");return new Date(Number(r),Number(a)-1,Number(t),23,59,59).getTime()<new Date().getTime()}}}))});class tQ{validate(e){let t=tK.validate(e);return{result:t,isValid:null===t}}}let tU=()=>{let e=(0,E.OB)(e=>a(80400)(`./${e}/index.json`));return u.createElement(u.Fragment,null,u.createElement("div",{className:(0,b.cV)(350)},u.createElement(f.P,{size:"paragraph-medium",hasExtraPaddingTop:!0},e("age_group_general_paragraph_1")),u.createElement(f.P,{size:"paragraph-medium"},e("age_group_general_paragraph_2"))),u.createElement("div",{className:(0,b.cV)(200)},u.createElement(M.fh,{addonSize:"small",size:"medium",contrast:"plain"},u.createElement(M.KX,{icon:"person-child-stroller"}),u.createElement(F.PM,{label:e("age_group_title_type_1"),emphasized:!0})),u.createElement(f.P,{size:"paragraph-medium"},e("age_group_paragraph_1_type_1")),u.createElement(f.P,{size:"paragraph-medium"},e("age_group_paragraph_2_type_1")),u.createElement(f.P,{size:"paragraph-medium"},e("age_group_paragraph_3_type_1"))),u.createElement("div",{className:(0,b.cV)(200)},u.createElement(M.fh,{addonSize:"small",size:"medium",contrast:"plain"},u.createElement(M.KX,{icon:"person-child"}),u.createElement(F.PM,{label:e("age_group_title_type_2"),emphasized:!0})),u.createElement(f.P,{size:"paragraph-medium",hasExtraPaddingTop:!0},e("age_group_paragraph_type_2"))))},tJ=()=>{let{isOpen:e,setOpen:t}=(0,V.z)({initialIsOpen:!1}),r=(0,E.OB)(e=>a(80400)(`./${e}/index.json`)),n=Array.from({length:12},(e,t)=>t),{userway:s}=(0,y.te)();return u.createElement(u.Fragment,null,u.createElement(H.Im,{sizeContrast:"medium-small",className:(0,T.A)((0,b.cV)(200),(0,p.V)({xs:"none",lg:"flex"}))},u.createElement(F.PM,{emphasized:!0,isLabelAccent:!0,label:r("title-childrenModal")}),u.createElement(F.PM,{label:r("subtitle-childrenModal")})),u.createElement("div",{className:(0,b.cV)(200)},n.map(e=>u.createElement(G.t,{value:e,key:e},u.createElement(M.fh,{addonSize:"none",size:"medium",contrast:"small"},u.createElement(F.PM,{label:r("age",{found:0!==e,n:e}),emphasized:!0,expanded:!0}))))),u.createElement(m.$n,{className:(0,b.cV)(300),color:"secondary",size:400,firstLabel:r("age_informer_button"),fullWidth:!0,leftAddon:u.createElement(v.a,{icon:"info-circle"}),onClick:()=>{t(!e),null==s||s({title:"search_form_info_children_age_click",product:"bus"})}}),u.createElement(W.aF,{isOpen:e,setOpen:t,title:r("why_choose_age"),hasBackButton:!1,size:"small"},u.createElement(tU,null)))},tZ=e=>{let{maxPassengers:t,passengers:r,onClose:s}=e,[l,o]=u.useState(!1),i=(0,n.s)(r),{adults:c,children:h}=i.splitAdults(),{userway:g}=(0,y.te)(),f=c.length,_=(0,E.OB)(e=>a(80400)(`./${e}/index.json`)),P=1===c.length,O=t===i.list.length,C=e=>{r.remove(e)},w=()=>{o(!l),null==g||g({title:"search_form_add_child_click",product:"bus"})};return u.createElement(u.Fragment,null,u.createElement(tu,{isMinusDisabled:P,isPlusDisabled:O,value:c.length,openPlusTooltipOnClick:O,plusTooltipContent:_("max_passengers",{count:t}),autoClosePlusTooltip:!0,autoCloseMinusTooltip:!0,title:_("adults"),subtitle:_("initial_adult_age"),className:(0,b.S3)(100),onMinusClick:()=>{null==g||g({title:"search_form_change_adults_click",product:"bus",element_name:"minus",adult_count:f-1}),1!==f&&r.remove(c[c.length-1].id)},onPlusClick:()=>{null==g||g({title:"search_form_change_adults_click",product:"bus",element_name:"plus",adult_count:f+1}),r.add(null)},onTooltipOpen:e=>{"plus"===e?null==g||g({title:"search_form_max_passengers_tooltip_shown",product:"bus"}):"minus"===e&&(null==g||g({title:"search_form_children_tooltip_shown",product:"bus"}))}}),h.map((e,t)=>{let{id:a,age:r}=e;return u.createElement(tn,{key:a,age:r,className:0!==t?(0,b.S3)(200):void 0,onDeleteClick:()=>{C(a),null==g||g({title:"search_form_remove_child_click",product:"bus"})}})}),u.createElement(D.y,{containerStyle:{xs:"modal",lg:"dropdown"},size:700,onChange:e=>{r.add(e),o(!1)},isOpen:l,renderContent:()=>u.createElement(tJ,null),setOpen:o,modalProps:{title:_("title-childrenModal"),subtitle:_("subtitle-childrenModal"),closeOnClickOutside:!0,closeOnCloseButtonClick:!0},dropdownProps:{closeOnClickOutside:!0,stopMouseDownPropagation:!0,useAvailableScreenHeight:!0,minHeight:"300px",minWidth:"330px"}},e=>{let{ref:t}=e;return u.createElement(m.$n,Object.assign({ref:t,className:(0,T.A)((0,b.S3)(200),(0,b.cV)({xs:0,lg:300})),disabled:O,leftAddon:u.createElement(v.a,{icon:"person-child"}),size:400,color:"secondary",firstLabel:_("add_child_button"),onClick:w,fullWidth:!0},(0,d.Ay)("add_child_button")))}),u.createElement(m.$n,{className:(0,T.A)((0,b.S3)(350),(0,p.V)({lg:"none"})),size:500,fullWidth:!0,color:"primary",type:"button",firstLabel:_("ready"),onClick:s}))},t0=e=>{let{searchParams:t,initiated:r,theme:s}=e,[l,o]=u.useState(!1),{userway:i}=(0,y.te)(),c=(0,E.OB)(e=>a(80400)(`./${e}/index.json`)),d=(0,n.s)(t),m=c("input_value",{count:d.passengers.list.length}),p=()=>{o(!l),null==i||i({title:"search_form_change_passengers_click",product:"bus",passenger_count:t.passengers.list.length})},v=()=>{null==i||i(Object.assign({title:"search_form_close_passengers_click",product:"bus",passenger_count:t.passengers.list.length,element_state:"other"},eZ(t.passengers)))},f=()=>{null==i||i(Object.assign({title:"search_form_close_passengers_click",product:"bus",passenger_count:d.passengers.list.length,element_state:"button"},eZ(t.passengers)))};return u.createElement(D.y,{size:700,containerStyle:{xs:"modal",lg:"dropdown"},isOpen:l,renderContent:()=>u.createElement(tZ,{maxPassengers:10,passengers:t.passengers,onClose:()=>{o(!1),f()}}),setOpen:o,modalProps:{title:c("mobile_title"),closeOnClickOutside:!0,closeOnCloseButtonClick:!0,onClickOutside:v,minHeight:"auto",stopMouseDownPropagation:!1},dropdownProps:{closeOnClickOutside:!0,onClickOutside:v,position:"end",minWidth:"370px"}},e=>{let{ref:t}=e;return u.createElement(g.p,{wrapperClassName:`${ee.A.passengers} ${(0,h.tG)({xs:["top","bottom"],lg:["none"]})}`,containerRef:t,position:{lg:"middle-horizontal",xl:"middle-horizontal"},"data-ti":"passengers_input",type:"text",label:c("input_label"),value:r?m:"",onClick:p,readOnly:!0,clearButtonType:"hidden",wrapperProps:tr(s)})})},t1=(0,u.memo)(e=>{let{fieldName:t,suggest:r}=e,s=(0,E.OB)(e=>a(52962)(`./${e}/index.json`)),{items:l,isError:o}=(0,n.s)(r).getItems({fieldName:t});return o&&0===l.length?u.createElement(Q.FC,null,s("error")):l.map(e=>{var t,a,r;let n=[null===(t=e.country)||void 0===t?void 0:t.name,null===(a=e.region)||void 0===a?void 0:a.name,null===(r=e.district)||void 0===r?void 0:r.name].filter(Boolean).join(", ");return u.createElement(Q.y$,{value:e.geoPoint.busId,key:e.geoPoint.busId},u.createElement(H.Im,null,u.createElement(F.PM,{label:e.geoPoint.name,isLabelAccent:!0,emphasized:!0}),n&&u.createElement(F.PM,{label:n})))})});function t2(e){let{fieldName:t,searchParams:a,suggest:r,routeIndex:s=0}=e,l=(0,i.Tt)(e,["fieldName","searchParams","suggest","routeIndex"]),o=(0,n.s)(r),{items:c,isDefaultItems:d}=o.getItems({fieldName:t}),m=(0,n.s)(a,{sync:!0}).routes[s],p=m["from"===t?"to":"from"],h=c.map((e,t)=>({value:e.geoPoint.busId,hiddenValue:Object.assign(Object.assign({},e),{index:t})})),g=(0,u.useCallback)(e=>{o.loadItems({value:e,fieldName:t,relatedField:p,routeIndex:s})},[t,p,s,o]);return u.createElement(tb,Object.assign({},l,{fieldName:t,point:m[t],setPoint:e=>{a.routes[s][t]=e},isDefaultItems:d,items:h,loadItems:g,renderContent:()=>u.createElement(t1,{suggest:r,fieldName:t})}))}let t3={find_tickets:"Найти билеты",today:"Сегодня",tomorrow:"Завтра",from:"Откуда",to:"Куда",when:"Когда",who:"Кто едет",requiredFrom:"Выберите место отправления",pointsAreEqual:"Места отправления и\xa0назначения не\xa0должны совпадать",inPast:"Выберите не\xa0прошедшую дату",swapGeoPoints:"Поменять местами отправление и прибытие"},t5=!1,t9=["from","to","date"],t4={busId:"1447874",name:"Москва",type:"busStop",translitName:"Moskva",popular:!0},t6={busId:"1447624",name:"Санкт-Петербург",type:"busStop",translitName:"Sankt-Peterburg",popular:!0},t7=[t4,t6],t8=[t6,t4],ae=new Date,at=new Date(ae.getFullYear(),ae.getMonth(),ae.getDate()+1),aa=[{name:(0,Z.Ay)(t3,"today"),date:tt(ae)},{name:(0,Z.Ay)(t3,"tomorrow"),date:tt(at)}],ar=e=>{var t,r,s,l,o,i,c;let{model:C,inputsTheme:w}=e,k=(0,P.Y)({min:"lg"}),x=(0,E.OB)(e=>a(40378)(`./${e}/index.json`)),[A,I]=u.useState(!1),N=(0,n.s)(C),{chosenDates:$,setStateChosenDates:S,setInputFocus:j}=(0,O.x)({dateFrom:N.searchParams.routes[0].date?ta(N.searchParams.routes[0].date):null}),z=$.dateFrom?tt($.dateFrom):void 0;N.searchParams.routes[0].date!==z&&S(e=>Object.assign(Object.assign({},e),{dateFrom:N.searchParams.routes[0].date?ta(N.searchParams.routes[0].date):null}));let D={from:N.searchParams.routes[0].from.busId,to:N.searchParams.routes[0].to.busId},T=e=>{C.searchParams.routes[0].date=e.dateFrom?tt(e.dateFrom):void 0},M=()=>{T({dateFrom:null})},{validationEnabled:F}=N.state,{result:H}=F?N.validationResult:{result:null},[V,B]=(0,u.useState)(null),q=null===(t=null==H?void 0:H.routes)||void 0===t?void 0:t[0],R=(()=>{var e,t;if(!q)return null;if(V)for(let e=0;e<t9.length;e++){let t=t9[e];if(q[t]&&V===t)return t}if((null===(e=q.from)||void 0===e?void 0:e.errors[0].type)==="pointsAreEqual"&&(null===(t=q.to)||void 0===t?void 0:t.errors[0].type)==="pointsAreEqual")return"to";for(let e=0;e<t9.length;e++){let t=t9[e];if(q[t])return t}return null})(),{userway:L}=(0,y.te)(),G=()=>{C.swapGeoPoints(),null==L||L({title:"search_form_change_destination_click",product:"bus"})},[W,Y]=(0,u.useState)({from:!1,to:!1,date:!1}),X=()=>{var e;(null===(e=C.validationResult)||void 0===e?void 0:e.isValid)||null==L||L({title:"search_form_error_shown",product:"bus",validation_errors:e2(N.validationResult)}),C.submit(),B(null),Y({from:!1,to:!1,date:!1});let{from:t,to:a,date:r}=C.searchParams.routes[0],n="busStop"===t.type?{departure_geo_id:t.busId}:{},s="busStop"===a.type?{arrival_geo_id:a.busId}:{},{searchId:l}=C.submitter;null==L||L(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({title:"search_form_search_click",product:"bus",search_id:l},n),s),eQ(r)),{route_type:"oneway",passenger_count:C.searchParams.passengers.list.length}),eZ(C.searchParams.passengers)))},K="date"===R&&!W.date,Q=(0,u.useCallback)(()=>{Y(e=>Object.assign(Object.assign({},e),{date:!0}))},[]);return e3({enabled:K,callback:Q}),(0,u.useEffect)(()=>{if(C.init(),!t5){let{from:e,to:t,date:a}=C.searchParams.routes[0],r="busStop"===e.type?{departure_geo_id:e.busId}:{},n="busStop"===t.type?{arrival_geo_id:t.busId}:{};null==L||L(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({title:"search_form_first_shown",product:"bus"},r),n),eQ(a)),{route_type:"oneway",passenger_count:C.searchParams.passengers.list.length}),eZ(C.searchParams.passengers))),t5=!0}},[C,L]),u.createElement(h.gE,Object.assign({size:{xs:500,sm:700},layout:{xs:"vertical",xl:"horizontal"}},(0,d.Ay)("bus-search-form")),u.createElement("div",{className:ee.A.searchForm},u.createElement("div",{className:`${ee.A.firstSubGroup} ${(0,h.tG)({lg:["bottom"],xl:["none"]})}`},u.createElement("div",{className:ee.A.departure},u.createElement(t2,{product:"bus",position:{xs:"top",lg:"left"},label:x("from"),fieldName:"from",searchParams:C.searchParams,suggest:C.suggest,hasError:!!(null==q?void 0:q.from),errorMessage:"from"!==R||W.from?void 0:x(null===(l=null===(s=null===(r=null==q?void 0:q.from)||void 0===r?void 0:r.errors)||void 0===s?void 0:s[0])||void 0===l?void 0:l.type),onFocus:()=>{F&&B("from")},tabIndex:0,onErrorMessageClose:()=>{Y(e=>Object.assign(Object.assign({},e),{from:!0}))},theme:w}),u.createElement("div",{className:`${(0,p.V)({xs:"none",xl:"inline-flex"})} ${(0,b.S3)(200)} ${(0,b.rQ)(100)}`},t7.map(e=>u.createElement(m.$n,Object.assign({color:"secondary-neutral",size:300,key:e.name,onClick:()=>{C.searchParams.routes[0].from=e,null==L||L({title:"search_form_city_hint_click",product:"bus",geo_id:e.busId,block:"departure"})}},(0,d.Ay)("fromHint")),e.name)))),u.createElement(m.$n,Object.assign({"aria-label":x("swapGeoPoints"),className:`${ee.A.switcher} ${(0,p.V)({xs:"inline-flex",lg:"none"})}`,accent:"default",color:"outline-form",leftAddon:u.createElement(v.a,{icon:"arrow-2-up-down_outline"}),size:{xs:300,sm:400},onClick:G,tabIndex:0},(0,d.Ay)("swapButton"),tr(w))),u.createElement(m.$n,Object.assign({"aria-label":x("swapGeoPoints"),position:{lg:"middle-horizontal"},className:`${ee.A.switcher} ${(0,p.V)({xs:"none",lg:"inline-flex"})}`,accent:"default",color:"outline-form",leftAddon:u.createElement(v.a,{icon:"arrow-2-left-right_outline"}),size:700,onClick:G,tabIndex:0},(0,d.Ay)("swapButton"),tr(w))),u.createElement("div",{className:ee.A.arrival},u.createElement(t2,{product:"bus",position:{xs:"middle-vertical",lg:"right",xl:"middle-horizontal"},label:x("to"),fieldName:"to",searchParams:C.searchParams,suggest:C.suggest,hasError:!!(null==q?void 0:q.to),errorMessage:"to"!==R||W.to?void 0:x(null===(c=null===(i=null===(o=null==q?void 0:q.to)||void 0===o?void 0:o.errors)||void 0===i?void 0:i[0])||void 0===c?void 0:c.type),onFocus:()=>{F&&B("to")},tabIndex:0,onErrorMessageClose:()=>{Y(e=>Object.assign(Object.assign({},e),{to:!0}))},theme:w}),u.createElement("div",{className:`${(0,p.V)({xs:"none",xl:"inline-flex"})} ${(0,b.S3)(200)} ${(0,b.rQ)(100)}`},t8.map(e=>u.createElement(m.$n,Object.assign({color:"secondary-neutral",size:300,key:e.name,onClick:()=>{C.searchParams.routes[0].to=e,null==L||L({title:"search_form_city_hint_click",product:"bus",geo_id:e.busId,block:"arrival"})}},(0,d.Ay)("toHint")),e.name))))),u.createElement(O.C,{withAnimation:!1,isOneway:!0,product:"bus",block:"search_form",apiHost:N.calendarApiHost,calendarHost:N.holidaysApiHost,isDesktop:null==k||k,cityIds:D,disabledOnTargetClick:A,chosenDates:$,setStateChosenDates:S,onChangeDates:T,onOpen:()=>{I(!0)},onClose:()=>{I(!1)},popupContentClassName:ee.A.calendarPopup,passengers:N.searchParams.passengers.getCountsByType(),target:e=>{var t,a,r,n,s,l;let{onClick:o,ref:i}=e,c=e=>{j("from"),null==o||o(e)};return u.createElement("div",{className:`${ee.A.secondSubGroup}`},u.createElement("div",{className:`${ee.A.targetDate}`},u.createElement(_.$,{open:K,content:(null===(r=null===(a=null===(t=null==q?void 0:q.date)||void 0===t?void 0:t.errors)||void 0===a?void 0:a[0])||void 0===r?void 0:r.type)?u.createElement(f.L9,{color:"primary"},x(null===(l=null===(s=null===(n=null==q?void 0:q.date)||void 0===n?void 0:n.errors)||void 0===s?void 0:s[0])||void 0===l?void 0:l.type)):null,side:"top",onClick:Q,onClickOutside:Q,position:"start"},e=>{var t,a;let{ref:r}=e;return u.createElement("div",{ref:i},u.createElement(g.p,{wrapperClassName:`${ee.A.date} ${(0,h.tG)({xs:["bottom"],lg:["none"]})}`,wrapperProps:tr(w),position:{xs:"bottom",lg:"left",xl:"middle-horizontal"},containerRef:r,"data-ti":"trip-dates",type:"text",label:x("when"),value:e8({dateFrom:$.dateFrom,dateTo:$.dateTo}),onChange:()=>{},hasError:F&&!!(null===(a=null===(t=null==H?void 0:H.routes)||void 0===t?void 0:t[0])||void 0===a?void 0:a.date),onClick:c,onClear:M,onFocus:()=>{F&&B("date")},tabIndex:0,readOnly:!0}))}),u.createElement("div",{className:`${(0,p.V)({xs:"none",xl:"inline-flex"})} ${(0,b.S3)(200)} ${(0,b.rQ)(100)}`},aa.map(e=>u.createElement(m.$n,{color:"secondary-neutral",size:300,key:e.name,onClick:()=>{C.searchParams.routes[0].date=e.date,null==L||L({title:"search_form_date_hint_click",product:"bus",departure_date:eX(e.date)})}},e.name)))),u.createElement(t0,{searchParams:C.searchParams,initiated:N.state.initiated,theme:w}),u.createElement("div",{className:ee.A.submitButton},u.createElement(m.$n,Object.assign({isLoading:N.submitted,className:`${(0,h.tG)({xs:["top"],lg:["none"]})}`,position:{lg:"right"},fullWidth:!0,color:"primary",type:"button","data-ti":"submit-button",onClick:X},tr(w)),x("find_tickets"))))}})))};class an extends eC{constructor(e){super(e&&e.length?e:[{id:1,age:null},{id:2,age:null}])}get infantMaxAge(){return null}get childMaxAge(){return 17}}class as{getInitialSearchParams(e){var t,a,r,n;let s=al();if(!e)return s;let l=this.convertOuterSearchParams(e);return{point:null!==(t=l.point)&&void 0!==t?t:s.point,guests:null!==(a=l.guests)&&void 0!==a?a:s.guests,date:null!==(r=l.date)&&void 0!==r?r:s.date,secondDate:null!==(n=l.secondDate)&&void 0!==n?n:s.secondDate}}convertOuterSearchParams(e){let t;let{geoId:a,geoName:r,geoType:n,guests:s}=null!=e?e:{};return a&&"string"==typeof a&&r&&"string"==typeof r&&(t={id:a,name:r,geoType:n&&"string"==typeof n?n:null,type:"hotelDestination"}),Object.assign(Object.assign(Object.assign({},t?{point:t}:{}),{date:e.date,secondDate:e.secondDate}),s?{guests:new an(s)}:{})}}function al(){return{point:{type:"unknown",name:""},guests:new an}}function ao(e){return!!e&&"object"==typeof e&&"type"in e&&"id"in e&&"name"in e&&"hotelDestination"===e.type&&eN(e.id)&&eN(e.name)}let ai=e=>{let{point:t,date:a,secondDate:r,guests:n}=e,s=ao(t)?`fid::${t.id};f::${t.name};ft::${t.geoType};`:"",l=eI(a)&&eI(r)?`d::${a};d2::${r};`:"",o=n.list.map(e=>{let{age:t}=e;return t}),i=n?`g::${JSON.stringify(o)};`:"";return`${s}${l}${i}`},ac=(e,t)=>{let a=null==e?void 0:e.split(";"),r={g:"[null]",f:"",fid:"",ft:"",d:void 0,d2:void 0};null==a||a.forEach(e=>{let[t,a]=e.split("::");t&&a&&(r[t]=a)});let n={type:"hotelDestination",name:r.f,id:r.fid,geoType:r.ft},s=ao(n)?n:t.point,l=eO(r.g,[{id:1,age:null},{id:2,age:null}]),o=e$(r.d),i=e$(r.d2);return Object.assign({point:s,guests:new an(l)},o&&i?{date:o,secondDate:i}:{})};class au extends eP{constructor(){super(...arguments),this.initialSearchParams=al(),this.hotelCookieName="sf_hotel"}searchParamsToCookieValue(e){return ai(e)}cookieValueToSearchParams(e){return ac(e,this.initialSearchParams)}get cookieName(){return this.hotelCookieName}}class ad{constructor(e){this.params=e}gotoOffers(e){this.hotelSearchId=(0,l.A)(),this.openOffersPage(`${this.params.hotelDomain?this.params.hotelDomain:""}/${(0,et.K8)(Object.assign({searchId:this.searchId},this.getExternalSearchParams(e)))}`)}openOffersPage(e){location.href=e}getExternalSearchParams(e){var t;let{adults:a,children:r}=e.guests.splitAdults(),n=r.map(e=>{let{age:t}=e;return t});return{geoId:Number(e.point.id),geoName:e.point.name,geoType:null!==(t=e.point.geoType)&&void 0!==t?t:null,checkInDate:ta(e.date),checkOutDate:ta(e.secondDate),guestsList:[{adultCount:a.length,childrenAgeList:n}]}}get searchId(){return this.hotelSearchId}}class am{get fetch(){return function(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];return fetch(...t)}}constructor(e){this.hotelApiHost=eu(e)}getSuggestItems(e){return(0,i.sH)(this,arguments,void 0,function*(e){let{request:{value:t},abortController:a}=e,r=new URLSearchParams({query:t,limit:"8"});return function(e){if("object"!=typeof e||null===e)throw Error(`Unknown response format (type '${typeof e}')`);if(null===e.items)return[];if(Array.isArray(e.items))return e.items.map(e=>{var t,a;return{type:"geoPoint",geoPoint:{id:String(e.geoID),type:"hotelDestination",name:null!==(t=e.name)&&void 0!==t?t:"",geoType:null!==(a=e.geoType)&&void 0!==a?a:null},description:ap(e.parents),location:e.geoLocation,hotelsCount:e.hotelsCount}});throw Error(`Unknown response format (type '${typeof e.items}')`)}((yield this.fetch(`${this.hotelApiHost}/api/v1/suggest?${r}`,{method:"GET",redirect:"follow",signal:a.signal}).then(e=>e.json())))})}}let ap=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return e.filter(e=>!!e.name).map(e=>e.name).join(", ")};class ah extends eA{constructor(e){var{suggest:t,calendarApiHost:a,holidaysApiHost:r}=e;super((0,i.Tt)(e,["suggest","calendarApiHost","holidaysApiHost"])),this.suggest=t,this.calendarApiHost=a,this.holidaysApiHost=r}}let ag=[{id:"2657260",name:"Москва",type:"locality",description:"Москва, Россия",location:{lat:55.755786,lon:37.617633}},{id:"2656915",name:"Санкт-Петербург",type:"locality",description:"Санкт-Петербург, Россия",location:{lat:59.939039,lon:30.315785}},{id:"2656918",name:"Сочи",type:"locality",description:"Краснодарский край, Россия",location:{lat:43.611599,lon:39.722489}},{id:"2656869",name:"Екатеринбург",type:"locality",description:"Свердловская область, Россия",location:{lat:56.837814,lon:60.596842}},{id:"2656912",name:"Ростов-на-Дону",type:"locality",description:"Ростовская область, Россия",location:{lat:47.233189,lon:39.715}},{id:"2656895",name:"Нижний Новгород",type:"locality",description:"Нижегородская область, Россия",location:{lat:56.329917,lon:44.009192}},{id:"2656873",name:"Казань",type:"locality",description:"Республика Татарстан, Россия",location:{lat:55.796538,lon:49.1082}},{id:"2656850",name:"Анапа",type:"locality",description:"Краснодарский край, Россия",location:{lat:44.89502,lon:37.331039}},{id:"2657201",name:"Симферополь",type:"locality",description:"Республика Крым, Крым",location:{lat:44.961818,lon:34.106572}},{id:"2656879",name:"Краснодар",type:"locality",description:"Краснодарский край, Россия",location:{lat:45.042149,lon:38.98064}},{id:"2665770",name:"Адлер",type:"locality",description:"Краснодарский край, Россия",location:{lat:43.4261,lon:39.9242}},{id:"2657137",name:"Минск",type:"locality",description:"Белоруссия",location:{lat:53.89994,lon:27.575569}},{id:"2656874",name:"Калининград",type:"locality",description:"Калининградская область, Россия",location:{lat:54.711595,lon:20.509972}},{id:"2686619",name:"Феодосия",type:"locality",description:"Республика Крым, Крым",location:{lat:45.0333,lon:35.3833}}];class av{constructor(e,t){this.loader=e,this.logError=t,this.currentItems=(0,r.BX)({items:[],prevRequest:null,abortController:null,isError:!1,isDefaultItems:!1}),this.loadItems=e=>(0,i.sH)(this,[e],void 0,function*(e){var t,a,n,s;let{value:l}=e;try{let e={value:l},o=null===(t=this.currentItems)||void 0===t?void 0:t.prevRequest;if(!o||o.value!==e.value){null===(s=null===(n=null===(a=this.currentItems)||void 0===a?void 0:a.abortController)||void 0===n?void 0:n.abort)||void 0===s||s.call(n);let t=new AbortController;this.currentItems?(this.currentItems.abortController=(0,r.KR)(t),this.currentItems.prevRequest=e):this.currentItems={items:[],abortController:(0,r.KR)(t),prevRequest:e,isError:!1,isDefaultItems:!1};let l=yield this.getSuggestItems({request:e,abortController:t});if(l.length>0)this.currentItems.items=l,this.currentItems.isDefaultItems=!1;else{let e=new AbortController;this.currentItems.abortController=(0,r.KR)(e),this.currentItems.items=yield this.getSuggestItems({request:{value:""},abortController:e}),this.currentItems.isDefaultItems=!0}this.currentItems.isError=!1}}catch(e){if("name"in e&&("AbortError"===e.name||"CancelError"===e.name))return;if(this.currentItems.isError=!0,this.currentItems.items=[],this.logError)this.logError(e);else throw e}finally{this.currentItems.abortController=null}})}getSuggestItems(e){return e.request.value?this.loader.getSuggestItems(e):ag.map(e=>{let{id:t,type:a,name:r,description:n,location:s}=e;return{type:"geoPoint",geoPoint:{id:t,type:"hotelDestination",name:r,geoType:a},description:n,location:s}})}getItems(){var e,t,a,r,n,s;return{items:null!==(t=null===(e=this.currentItems)||void 0===e?void 0:e.items)&&void 0!==t?t:[],isError:null!==(r=null===(a=this.currentItems)||void 0===a?void 0:a.isError)&&void 0!==r&&r,isDefaultItems:null!==(s=null===(n=this.currentItems)||void 0===n?void 0:n.isDefaultItems)&&void 0!==s&&s}}}function af(e){let t={};return e.forEach(e=>{let a=function(e){switch(e){case"country":return"country";case"airport":return"airport";case"hotel":return"hotel";case"sight":return"sight";default:return"region"}}(e.geoPoint.geoType);Array.isArray(t[a])?t[a].push(e):t[a]=[e]}),Object.entries(t)}let ab=(0,c.Ts)().rules({point:{requiredPoint:e=>!e||"unknown"===e.type},date:{requiredDate:e=>!e,dateFormat:e=>{if(8!==e.length&&10!==e.length)return!0;let[t,a,r]=e.split(".");return(null==t?void 0:t.length)!==2||2!==a.length||(null==r?void 0:r.length)!==2&&(null==r?void 0:r.length)!==4||isNaN(Number.parseInt(t,10))||isNaN(Number.parseInt(a,10))||isNaN(Number.parseInt(r,10))},datesAreEqual:(e,t)=>{let{data:{secondDate:a}}=t;return e&&a&&e===a},inPast:e=>{let[t,a,r]=e.split(".");return new Date(Number(r),Number(a)-1,Number(t),23,59,59).getTime()<new Date().getTime()}},secondDate:{requiredDate:e=>!e,dateFormat:e=>{if(8!==e.length&&10!==e.length)return!0;let[t,a,r]=e.split(".");return(null==t?void 0:t.length)!==2||2!==a.length||(null==r?void 0:r.length)!==2&&(null==r?void 0:r.length)!==4||isNaN(Number.parseInt(t,10))||isNaN(Number.parseInt(a,10))||isNaN(Number.parseInt(r,10))},datesAreEqual:(e,t)=>{let{data:{date:a}}=t;return a&&e&&a===e},inPast:e=>{let[t,a,r]=e.split(".");return new Date(Number(r),Number(a)-1,Number(t),23,59,59).getTime()<new Date().getTime()}}});class a_{validate(e){let t=ab.validate(e);return{result:t,isValid:null===t}}}let ay={arrival_city_error:"arrival_city_error",wrong_date:"wrong_date"},aE=e=>{var t;let a=e.result,r=[];return(null===(t=null==a?void 0:a.point)||void 0===t?void 0:t.requiredPoint)&&r.push(ay.arrival_city_error),((null==a?void 0:a.date)||(null==a?void 0:a.secondDate))&&r.push(ay.wrong_date),r},aP=()=>{let e=(0,E.OB)(e=>a(80813)(`./${e}/index.json`));return u.createElement(u.Fragment,null,u.createElement("div",{className:(0,b.cV)(350)},u.createElement(f.P,{size:"paragraph-medium",hasExtraPaddingTop:!0},e("age_group_general_paragraph_1"))),u.createElement("div",{className:(0,b.cV)(200)},u.createElement(M.fh,{addonSize:"small",size:"medium",contrast:"plain"},u.createElement(M.KX,{icon:"person-child"}),u.createElement(F.PM,{label:e("age_group_title_type_1"),emphasized:!0})),u.createElement(f.P,{size:"paragraph-medium"},e("age_group_paragraph_1_type_1"))))},aO=()=>{let{isOpen:e,setOpen:t}=(0,V.z)({initialIsOpen:!1}),r=(0,E.OB)(e=>a(80813)(`./${e}/index.json`)),n=Array.from({length:18},(e,t)=>t),{userway:s}=(0,y.te)();return u.createElement(u.Fragment,null,u.createElement(H.Im,{sizeContrast:"medium-small",className:(0,T.A)((0,b.cV)(200),(0,p.V)({xs:"none",lg:"flex"}))},u.createElement(F.PM,{emphasized:!0,isLabelAccent:!0,label:r("title-childrenModal")}),u.createElement(F.PM,{label:r("subtitle-childrenModal")})),u.createElement("div",{className:(0,b.cV)(200)},n.map(e=>u.createElement(G.t,{value:e,key:e},u.createElement(M.fh,{addonSize:"none",size:"medium",contrast:"small"},u.createElement(F.PM,{label:r("age",{found:0!==e,n:e}),emphasized:!0,expanded:!0}))))),u.createElement(m.$n,{className:(0,b.cV)(300),color:"secondary",size:400,firstLabel:r("age_informer_button"),fullWidth:!0,leftAddon:u.createElement(v.a,{icon:"info-circle"}),onClick:()=>{t(!e),null==s||s({title:"search_form_info_children_age_click",product:"hotels"})}}),u.createElement(W.aF,{isOpen:e,setOpen:t,title:r("why_choose_age"),hasBackButton:!1,size:"small"},u.createElement(aP,null)))},aC=e=>{let{maxAdultGuests:t,maxChildrenGuests:r,guests:s,onClose:l}=e,[o,i]=u.useState(!1),{adults:c,children:h}=(0,n.s)(s).splitAdults(),{userway:g}=(0,y.te)(),f=c.length,_=(0,E.OB)(e=>a(80813)(`./${e}/index.json`)),P=1===c.length,O=s.getCountsByType(),C=t===O.adult,w=r===O.child,k=e=>{s.remove(e)},x=()=>{i(!o),null==g||g({title:"search_form_add_child_click",product:"hotels"})};return u.createElement(u.Fragment,null,u.createElement(tu,{isMinusDisabled:P,isPlusDisabled:C,value:c.length,openPlusTooltipOnClick:C,plusTooltipContent:_("max_passengers",{count:t}),autoClosePlusTooltip:!0,autoCloseMinusTooltip:!0,title:_("adults"),subtitle:_("initial_adult_age"),className:(0,b.S3)(100),onMinusClick:()=>{null==g||g({title:"search_form_change_adults_click",product:"hotels",element_name:"minus",adult_count:f-1}),1!==f&&s.remove(c[c.length-1].id)},onPlusClick:()=>{null==g||g({title:"search_form_change_adults_click",product:"hotels",element_name:"plus",adult_count:f+1}),s.add(null)},onTooltipOpen:e=>{"plus"===e?null==g||g({title:"search_form_max_passengers_tooltip_shown",product:"hotels"}):"minus"===e&&(null==g||g({title:"search_form_children_tooltip_shown",product:"hotels"}))}}),h.map((e,t)=>{let{id:a,age:r}=e;return u.createElement(tn,{key:a,age:r,className:0!==t?(0,b.S3)(200):void 0,onDeleteClick:()=>{k(a),null==g||g({title:"search_form_remove_child_click",product:"hotels"})}})}),u.createElement(D.y,{containerStyle:{xs:"modal",lg:"dropdown"},size:700,onChange:e=>{s.add(e),i(!1)},isOpen:o,renderContent:()=>u.createElement(aO,null),setOpen:i,modalProps:{title:_("title-childrenModal"),subtitle:_("subtitle-childrenModal"),closeOnClickOutside:!0,closeOnCloseButtonClick:!0},dropdownProps:{closeOnClickOutside:!0,stopMouseDownPropagation:!0,useAvailableScreenHeight:!0,minHeight:"300px",minWidth:"330px"}},e=>{let{ref:t}=e;return u.createElement(m.$n,Object.assign({ref:t,className:(0,T.A)((0,b.S3)(200),(0,b.cV)({xs:0,lg:300})),disabled:w,leftAddon:u.createElement(v.a,{icon:"person-child"}),size:400,color:"secondary",firstLabel:_("add_child_button"),onClick:x,fullWidth:!0},(0,d.Ay)("add_child_button")))}),u.createElement(m.$n,{className:(0,T.A)((0,b.S3)(350),(0,p.V)({lg:"none"})),size:500,fullWidth:!0,color:"primary",type:"button",firstLabel:_("ready"),onClick:l}))},aw=e=>{let{searchParams:t,initiated:r,theme:s}=e,[l,o]=u.useState(!1),{userway:i}=(0,y.te)(),c=(0,E.OB)(e=>a(80813)(`./${e}/index.json`)),d=c("input_value",{count:(0,n.s)(t).guests.list.length}),m=()=>{o(!l),null==i||i({title:"search_form_change_passengers_click",product:"hotels",passenger_count:t.guests.list.length})},p=()=>{null==i||i(Object.assign({title:"search_form_close_passengers_click",product:"hotels",passenger_count:t.guests.list.length,element_state:"other"},eZ(t.guests)))},v=()=>{null==i||i(Object.assign({title:"search_form_close_passengers_click",product:"hotels",passenger_count:t.guests.list.length,element_state:"button"},eZ(t.guests)))};return u.createElement(D.y,{size:700,containerStyle:{xs:"modal",lg:"dropdown"},isOpen:l,renderContent:()=>u.createElement(aC,{maxAdultGuests:6,maxChildrenGuests:4,guests:t.guests,onClose:()=>{o(!1),v()}}),setOpen:o,modalProps:{title:c("mobile_title"),closeOnClickOutside:!0,closeOnCloseButtonClick:!0,onClickOutside:p,minHeight:"auto",stopMouseDownPropagation:!1},dropdownProps:{closeOnClickOutside:!0,onClickOutside:p,position:"end",minWidth:"370px"}},e=>{let{ref:t}=e;return u.createElement(g.p,{wrapperClassName:`${ea.A.passengers} ${(0,h.tG)({xs:["top","bottom"],lg:["none"]})}`,containerRef:t,position:{lg:"middle-horizontal",xl:"middle-horizontal"},"data-ti":"guests_input",type:"text",label:c("input_label"),value:r?d:"",onClick:m,readOnly:!0,clearButtonType:"hidden",wrapperProps:tr(s)})})},ak=(0,u.memo)(e=>{let{suggest:t}=e,r=(0,E.OB)(e=>a(90815)(`./${e}/index.json`)),{items:s,isError:l}=(0,n.s)(t).getItems();return l&&0===s.length?u.createElement(Q.FC,null,r("error")):af(s).map(e=>{let[t,a]=e;return u.createElement(u.Fragment,{key:t},t&&u.createElement(Q.Rq,null,u.createElement(f.L9,{size:"header-xx-small"},r(t))),a.map(e=>u.createElement(Q.y$,{value:e.geoPoint.id,key:e.geoPoint.id},u.createElement(H.Im,null,u.createElement(F.PM,{label:e.geoPoint.name,value:"region"===t&&e.hotelsCount?e.hotelsCount:void 0,isLabelAccent:!0,emphasized:!0}),e.description&&u.createElement(F.PM,{label:e.description})))))})});function ax(e){let{suggest:t,searchParams:a}=e,r=(0,i.Tt)(e,["suggest","searchParams"]),{items:s,isDefaultItems:l}=(0,n.s)(t).getItems(),{point:o}=(0,n.s)(a,{sync:!0}),c=af(s).reduce((e,t)=>[...e,...t[1]],[]).map((e,t)=>({value:e.geoPoint.id,hiddenValue:Object.assign(Object.assign({},e),{index:t})})),d=(0,u.useCallback)(e=>{t.loadItems({value:e})},[t]);return u.createElement(tb,Object.assign({},r,{point:o,setPoint:e=>{a.point=e},items:c,isDefaultItems:l,loadItems:d,renderContent:()=>u.createElement(ak,{suggest:t})}))}let aA={findHotels:"Найти отели",where:"Куда хотите поехать?",when:"Заезд\xa0—\xa0Выезд",requiredPoint:"Выберете место прибытия",requiredDate:"Выберите дату заезда и\xa0выезда",dateFormat:"Неправильный формат даты",datesAreEqual:"Даты заезда и\xa0выезда не\xa0должны совпадать",inPast:"Выберите не\xa0прошедшую дату"},aI=!1,aN=e=>e?(0,Z.Ay)(aA,e):void 0,a$=["point","date","secondDate"],aS=[{id:"2657260",type:"hotelDestination",name:"Москва",geoType:"locality"},{id:"2656915",type:"hotelDestination",name:"Санкт-Петербург",geoType:"locality"},{id:"2656918",type:"hotelDestination",name:"Сочи",geoType:"locality"}];function aj(){let e=w()().add(1,"day").toDate(),t=w()().add(2,"day").toDate(),a=w()().add(3,"day").toDate();return[{name:te({dateFrom:e,dateTo:t}),date:tt(e),secondDate:tt(t)},{name:te({dateFrom:t,dateTo:a}),date:tt(t),secondDate:tt(a)}]}let az=e=>{let{model:t,inputsTheme:r}=e,s=(0,E.OB)(e=>a(40225)(`./${e}/index.json`)),l=(0,P.Y)({min:"md"}),[o,i]=u.useState(!1),c=(0,n.s)(t),{chosenDates:v,setStateChosenDates:C,setInputFocus:w}=(0,O.x)({dateFrom:c.searchParams.date?ta(c.searchParams.date):null,dateTo:c.searchParams.secondDate?ta(c.searchParams.secondDate):null}),k=v.dateFrom?tt(v.dateFrom):void 0,x=v.dateTo?tt(v.dateTo):void 0;(c.searchParams.date!==k||c.searchParams.secondDate!==x)&&C(e=>Object.assign(Object.assign({},e),{dateFrom:c.searchParams.date?ta(c.searchParams.date):null,dateTo:c.searchParams.secondDate?ta(c.searchParams.secondDate):null}));let A=e=>{t.searchParams.date=e.dateFrom?tt(e.dateFrom):void 0,t.searchParams.secondDate=e.dateTo?tt(e.dateTo):void 0},I=()=>{A({dateFrom:null,dateTo:null})},{validationEnabled:N}=c.state,{result:$}=N?c.validationResult:{result:null},[S,j]=(0,u.useState)(null),z=(()=>{if(!$)return null;if(S)for(let e=0;e<a$.length;e++){let t=a$[e];if($[t]&&S===t)return t}for(let e=0;e<a$.length;e++){let t=a$[e];if($[t])return t}return null})(),{userway:D}=(0,y.te)(),[T,M]=(0,u.useState)({point:!1,date:!1}),F=()=>{var e;(null===(e=t.validationResult)||void 0===e?void 0:e.isValid)||null==D||D({title:"search_form_error_shown",product:"hotels",validation_errors:aE(c.validationResult)}),t.submit(),j(null),M({point:!1,date:!1});let{date:a,secondDate:r,point:n}=t.searchParams,s="hotelDestination"===n.type?{arrival_geo_id:n.id}:{},{searchId:l}=t.submitter;null==D||D(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({title:"search_form_search_click",product:"hotels",search_id:l},s),eQ(a)),eU(r)),{route_type:"roundtrip",passenger_count:t.searchParams.guests.list.length}),eZ(t.searchParams.guests)))},H=("date"===z||"secondDate"===z)&&!T.date,V=(0,u.useCallback)(()=>{M(e=>Object.assign(Object.assign({},e),{date:!0}))},[]);e3({enabled:H,callback:V}),(0,u.useEffect)(()=>{if(t.init(),!aI){let{date:e,secondDate:a,point:r}=t.searchParams;null==D||D(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({title:"search_form_first_shown",product:"hotels"},(null==r?void 0:r.type)==="hotelDestination"?{arrival_geo_id:r.id}:{}),eQ(e)),eU(a)),{route_type:"roundtrip",passenger_count:t.searchParams.guests.list.length}),eZ(t.searchParams.guests))),aI=!0}},[]);let B=(0,u.useMemo)(aj,[]);return u.createElement(h.gE,Object.assign({size:{xs:500,sm:700},layout:{xs:"vertical",md:"vertical",lg:"vertical",xl:"horizontal"}},(0,d.Ay)("hotel-search-form")),u.createElement("div",{className:ea.A.searchForm},u.createElement(O.C,{disableSameDates:!0,withAnimation:!1,product:"hotel",block:"search_form",hideTripTypeText:!0,onlyRoundtrip:!0,maximumRangeLength:30,maximumRangeLengthBefore:30,apiHost:c.calendarApiHost,calendarHost:c.holidaysApiHost,isDesktop:null==l||l,disabledOnTargetClick:o,chosenDates:v,setStateChosenDates:C,onChangeDates:A,onOpen:()=>{i(!0)},onClose:()=>{i(!1)},popupContentClassName:ea.A.calendarPopup,target:e=>{var a,n,l,o,i,y,E,P,O;let{onClick:C,ref:k}=e;return u.createElement(u.Fragment,null,u.createElement("div",{className:`${ea.A.firstSubGroup} ${(0,h.tG)({lg:["bottom"],xl:["none"]})}`},u.createElement("div",{className:ea.A.departure},u.createElement(ax,{product:"hotel",fieldName:"to",position:{xs:"top",lg:"single",xl:"left"},label:s("where"),searchParams:t.searchParams,suggest:t.suggest,hasError:!!(null==$?void 0:$.point),errorMessage:"point"!==z||T.point?void 0:aN(null===(l=null===(n=null===(a=null==$?void 0:$.point)||void 0===a?void 0:a.errors)||void 0===n?void 0:n[0])||void 0===l?void 0:l.type),onFocus:()=>{N&&j("from")},tabIndex:0,onErrorMessageClose:()=>{M(e=>Object.assign(Object.assign({},e),{point:!0}))},theme:r}),u.createElement("div",{className:`${(0,p.V)({xs:"none",xl:"inline-flex"})} ${(0,b.S3)(200)} ${(0,b.rQ)(100)}`},aS.map(e=>u.createElement(m.$n,Object.assign({color:"secondary-neutral",size:300,key:e.name,onClick:()=>{t.searchParams.point=e,null==D||D({title:"search_form_city_hint_click",product:"hotels",geo_id:e.id,block:"arrival"})}},(0,d.Ay)("toHint")),e.name))))),u.createElement("div",{className:ea.A.secondSubGroup},u.createElement("div",{className:`${ea.A.targetDate}`},u.createElement(_.$,{open:H,content:u.createElement(f.L9,{color:"primary"},aN(null===(y=null===(i=null===(o=null==$?void 0:$.date)||void 0===o?void 0:o.errors)||void 0===i?void 0:i[0])||void 0===y?void 0:y.type)||aN(null===(O=null===(P=null===(E=null==$?void 0:$.secondDate)||void 0===E?void 0:E.errors)||void 0===P?void 0:P[0])||void 0===O?void 0:O.type)),side:"top",onClick:V,onClickOutside:V,position:"start"},e=>{let{ref:t}=e;return u.createElement("div",{ref:k},u.createElement(g.p,{wrapperClassName:`${ea.A.date} ${(0,h.tG)({xs:["bottom"],lg:["none"]})}`,wrapperProps:tr(r),position:{xs:"bottom",lg:"left",xl:"middle-horizontal"},containerRef:t,"data-ti":"trip-dates",type:"text",label:s("when"),value:e8({dateFrom:v.dateFrom,dateTo:v.dateTo}),onChange:()=>{},hasError:N&&(!!(null==$?void 0:$.date)||!!(null==$?void 0:$.secondDate)),onClick:e=>{w("from"),null==C||C(e)},onClear:I,onFocus:()=>{N&&j("date")},onBlur:()=>{w("from")},tabIndex:0,readOnly:!0}))}),u.createElement("div",{className:`${(0,p.V)({xs:"none",xl:"inline-flex"})} ${(0,b.S3)(200)} ${(0,b.rQ)(100)}`},B.map(e=>u.createElement(m.$n,Object.assign({color:"secondary-neutral",size:300,key:e.name},(0,d.Ay)("dateHint"),{onClick:a=>{a.stopPropagation(),t.searchParams.date=e.date,t.searchParams.secondDate=e.secondDate,null==D||D({title:"search_form_date_hint_click",product:"hotels",departure_date:eX(e.date),arrival_date:eX(e.secondDate)})}}),e.name)))),u.createElement(aw,{searchParams:t.searchParams,initiated:c.state.initiated,theme:r}),u.createElement("div",{className:ea.A.submitButton},u.createElement(m.$n,{isLoading:c.submitted,className:`${(0,h.tG)({xs:["top"],lg:["none"]})}`,position:{lg:"right"},fullWidth:!0,color:"primary",type:"button","data-ti":"submit-button",onClick:F},s("findHotels")))))}})))};class aD{getInitialSearchParams(e){let t=aT();if(e){let a=this.convertOuterSearchParams(e);return Object.assign(Object.assign({},t),a)}return t}convertOuterSearchParams(e){let t=null==e?void 0:e.routes[0];return{routes:[{from:t.from?{type:"trainStation",name:t.from.value,rzdNumber:t.from.id}:{type:"unknown",name:""},to:t.to?{type:"trainStation",name:t.to.value,rzdNumber:t.to.id}:{type:"unknown",name:""},date:null==t?void 0:t.date}]}}}function aT(){return{routes:[{from:{type:"unknown",name:""},to:{type:"unknown",name:""},date:void 0}]}}function aM(e){return!!e&&void 0!==e.rzdNumber}function aF(e){return!!e&&"object"==typeof e&&!!("rzdNumber"in e&&"name"in e&&eN(e.rzdNumber)&&eN(e.name))}let aH=(e,t)=>{let{date:a}=e,r=aF(e.from)?e.from:t.from,n=aF(e.to)?e.to:t.to,s=aM(r)?`ftid::${r.rzdNumber};`:"",l=aM(n)?`ttid::${n.rzdNumber};`:"",o=eN(r.name)?`f::${r.name};`:"",i=eN(n.name)?`t::${n.name};`:"",c=eI(a)?`d::${a};`:"";return`${o}${s}${i}${l}${c}`},aV=(e,t)=>{let{routes:a}=e;return aH(a[0],t.routes[0])},aB=(e,t)=>{let a=null==e?void 0:e.split(";"),r={f:"",ftid:"",ft:"",t:"",ttid:"",tt:"",d:void 0};null==a||a.forEach(e=>{let[t,a]=e.split("::");t&&a&&(r[t]=a)});let n={type:"trainStation",name:r.f,rzdNumber:r.ftid},s={type:"trainStation",name:r.t,rzdNumber:r.ttid};return{routes:[{from:aF(n)?n:t.routes[0].from,to:aF(s)?s:t.routes[0].to,date:e$(r.d)}]}};class aq extends eP{constructor(){super(...arguments),this.initialSearchParams=aT(),this.trainCookieName="sf_train"}searchParamsToCookieValue(e){return aV(e,this.initialSearchParams)}cookieValueToSearchParams(e){return aB(e,this.initialSearchParams)}get cookieName(){return this.trainCookieName}}class aR{constructor(e,t="ru"){this.trainApiHost=e,this.locale=t,this.trainApiHost=eu(e)}get fetch(){return function(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];return fetch(...t)}}getSuggestItems(e){return(0,i.sH)(this,arguments,void 0,function*(e){let{request:{relatedField:t},abortController:a}=e,r=(null==t?void 0:t.type)==="trainStation"?new URLSearchParams({id:t.rzdNumber}).toString():"";return function(e,t){if(Array.isArray(e))return e.sort((e,t)=>t.weight-e.weight).map(e=>({type:"geoPoint",geoPoint:{name:e.names[aL[t]],type:"trainStation",rzdNumber:e.code}}));throw Error(`Unknown response format (type '${typeof e}')`)}((yield this.fetch(`${this.trainApiHost}/train/ajax/relevant_suggest/?${r}`,{method:"GET",redirect:"follow",signal:a.signal}).then(e=>e.json())),this.locale)})}}let aL={ru:"RUS",en:"ENG"};class aG{constructor(e){this.salePeriodHost=e,this.cacheMap=new Map,this.salePeriodHost=eu(e)}get fetch(){return function(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];return fetch(...t)}}getData(e){return(0,i.sH)(this,arguments,void 0,function*(e){let{from:t,to:a}=e,r=new URLSearchParams({departure_station_number:t,arrival_station_number:a}),n=r.toString();if(this.cacheMap.has(n))return this.cacheMap.get(n);let s=yield this.fetch(`${this.salePeriodHost}/ajax/poezda/sale_period/?${r}`,{method:"GET"}).then(e=>e.json());return this.cacheMap.set(n,s),s})}}class aW{constructor(e){this.params=e}gotoOffers(e){this.trainSearchId=(0,l.A)();let t=e.routes[0];this.openOffersPage((0,o.oh)(Object.assign(Object.assign({mainDomain:this.params.mainDomain.replace("https://","").replace("http://","")},(null==t?void 0:t.date)?{searchId:this.searchId}:{}),this.getExternalSearchParams(e))))}openOffersPage(e){location.href=e}getExternalSearchParams(e){return{trips:e.routes.map(e=>({date:e.date,from:{id:e.from.rzdNumber,value:e.from.name},to:{id:e.to.rzdNumber,value:e.to.name}}))}}get searchId(){return this.trainSearchId}}class aY{get fetch(){return function(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];return fetch(...t)}}constructor(e){this.trainApiHost=eu(e)}getSuggestItems(e){return(0,i.sH)(this,arguments,void 0,function*(e){let{request:{value:t},abortController:a}=e,r=new URLSearchParams({name:t});return function(e){if(Array.isArray(e))return e.map(e=>({type:"geoPoint",geoPoint:{name:e.value,type:"trainStation",rzdNumber:e.id}}));throw Error(`Unknown response format (type '${typeof e}')`)}((yield this.fetch(`${this.trainApiHost}/suggest/railway_simple/?${r}`,{method:"GET",redirect:"follow",signal:a.signal}).then(e=>e.json())))})}}class aX extends eB{constructor(e){var{suggest:t,salePeriod:a,calendarApiHost:n,holidaysApiHost:s}=e;super((0,i.Tt)(e,["suggest","salePeriod","calendarApiHost","holidaysApiHost"])),this.suggest=t,this.calendarApiHost=n,this.holidaysApiHost=s,this.salePeriod=(0,r.BX)(a),(0,r.B1)(this.searchParams,()=>{this.loadSalePeriodData()})}loadSalePeriodData(){if(!this.salePeriod)return;let e=this.searchParams.routes[0];if("trainStation"===e.from.type&&"trainStation"===e.to.type){let t={from:e.from.rzdNumber,to:e.to.rzdNumber};this.salePeriod.loadData(t)}}}class aK{constructor(e,t){this.loader=e,this.logError=t,this.data={period:void 0}}loadData(e){return(0,i.sH)(this,void 0,void 0,function*(){try{this.data=yield this.loader.getData(e)}catch(e){if(this.logError)this.logError(e);else throw e}})}getData(){return this.data}}class aQ extends eL{constructor(e,t,a){super(a),this.loader=e,this.relevantLoader=t}getSuggestItems(e){return""===e.request.value?this.relevantLoader.getSuggestItems(e):this.loader.getSuggestItems(e)}}let aU=(0,c.Ts)().rules({routes:(0,c.p_)((0,c.Ts)().rules({from:{requiredFrom:e=>!e||"unknown"===e.type},to:{requiredTo:e=>!e||"unknown"===e.type}}))});class aJ{validate(e){let t=aU.validate(e);return{result:t,isValid:null===t}}}let aZ=(0,u.memo)(e=>{let{fieldName:t,suggest:r}=e,s=(0,E.OB)(e=>a(72641)(`./${e}/index.json`)),{items:l,isError:o}=(0,n.s)(r).getItems({fieldName:t});return o&&0===l.length?u.createElement(Q.FC,null,s("error")):l.map(e=>u.createElement(Q.y$,{value:e.geoPoint.rzdNumber,key:e.geoPoint.rzdNumber},u.createElement(M.fh,{addonSize:"none"},u.createElement(F.PM,Object.assign({label:e.geoPoint.name,isLabelAccent:!0,emphasized:!0},(0,d.Ay)("suggest-item-name"))))))});function a0(e){let{fieldName:t,searchParams:a,suggest:r,routeIndex:s=0}=e,l=(0,i.Tt)(e,["fieldName","searchParams","suggest","routeIndex"]),o=(0,n.s)(r),{items:c,isDefaultItems:d}=o.getItems({fieldName:t}),m=(0,n.s)(a,{sync:!0}).routes[s],p=m["from"===t?"to":"from"],h=c.map((e,t)=>({value:e.geoPoint.rzdNumber,hiddenValue:Object.assign(Object.assign({},e),{index:t})})),g=(0,u.useCallback)(e=>{o.loadItems({value:e,fieldName:t,relatedField:p,routeIndex:s})},[t,p,s,o]);return u.createElement(tb,Object.assign({},l,{fieldName:t,point:m[t],setPoint:e=>{a.routes[s][t]=e},isDefaultItems:d,items:h,loadItems:g,renderContent:()=>u.createElement(aZ,{fieldName:t,suggest:r})}))}let a1={find_tickets:"Найти билеты",today:"Сегодня",tomorrow:"Завтра",from:"Откуда",to:"Куда",when:"Когда",select_departure_location:"Выберите место отправления",select_arrival_location:"Выберите место прибытия",swapGeoPoints:"Поменять местами отправление и прибытие"},a2={requiredFrom:(0,Z.Ay)(a1,"select_departure_location"),requiredTo:(0,Z.Ay)(a1,"select_arrival_location")},a3=["from","to"],a5={rzdNumber:"2000000",name:"Москва",type:"trainStation",translitName:"Moskva"},a9={rzdNumber:"2004000",name:"Санкт-Петербург",type:"trainStation",translitName:"Sankt-peterburg"},a4=!1,a6=[a5,a9],a7=[a9,a5],a8=new Date,re=new Date(a8.getFullYear(),a8.getMonth(),a8.getDate()+1),rt=[{name:(0,Z.Ay)(a1,"today"),date:tt(a8)},{name:(0,Z.Ay)(a1,"tomorrow"),date:tt(re)}],ra=e=>{var t,r,s,l,o,i,c,f,_;let{model:C,inputsTheme:w}=e,k=(0,P.Y)({min:"md"}),x=(0,E.OB)(e=>a(23375)(`./${e}/index.json`)),A=(0,n.s)(C),{userway:I}=(0,y.te)(),[N,$]=(0,u.useState)({from:!1,to:!1}),[S,j]=u.useState(!1),{chosenDates:z,setStateChosenDates:D,setInputFocus:M}=(0,O.x)({dateFrom:A.searchParams.routes[0].date?ta(A.searchParams.routes[0].date):null}),F=z.dateFrom?tt(z.dateFrom):void 0;A.searchParams.routes[0].date!==F&&D(e=>Object.assign(Object.assign({},e),{dateFrom:A.searchParams.routes[0].date?ta(A.searchParams.routes[0].date):null}));let H={from:A.searchParams.routes[0].from.rzdNumber,to:A.searchParams.routes[0].to.rzdNumber},{validationEnabled:V}=A.state,B=V?A.validationResult.result:null,[q,R]=(0,u.useState)(null),L=null===(t=null==B?void 0:B.routes)||void 0===t?void 0:t[0],G=null===(s=null===(r=A.salePeriod)||void 0===r?void 0:r.getData())||void 0===s?void 0:s.period,W=(()=>{if(!L)return null;if(q)for(let e=0;e<a3.length;e++){let t=a3[e];if(L[t]&&q===t)return t}for(let e=0;e<a3.length;e++){let t=a3[e];if(L[t])return t}return null})(),Y=null===(i=null===(o=null===(l=null==L?void 0:L.from)||void 0===l?void 0:l.errors)||void 0===o?void 0:o[0])||void 0===i?void 0:i.type,X="from"!==W||N.from?void 0:a2[Y],K=null===(_=null===(f=null===(c=null==L?void 0:L.to)||void 0===c?void 0:c.errors)||void 0===f?void 0:f[0])||void 0===_?void 0:_.type,Q="to"!==W||N.to?void 0:a2[K],U=()=>{C.swapGeoPoints(),null==I||I({title:"search_form_change_destination_click",product:"train"})},J=e=>{C.searchParams.routes[0].date=e.dateFrom?tt(e.dateFrom):void 0},Z=()=>{J({dateFrom:null,dateTo:null})},ee=()=>{var e;(null===(e=C.validationResult)||void 0===e?void 0:e.isValid)||null==I||I({title:"search_form_error_shown	",product:"train",validation_errors:e2(A.validationResult)}),C.submit(),R(null),$({from:!1,to:!1});let{from:t,to:a,date:r}=C.searchParams.routes[0],n="trainStation"===t.type?{departure_geo_id:t.rzdNumber}:{},s="trainStation"===a.type?{arrival_geo_id:a.rzdNumber}:{},{searchId:l}=C.submitter;null==I||I(Object.assign(Object.assign(Object.assign(Object.assign({title:"search_form_search_click",product:"train",search_id:l},n),s),eQ(r)),{route_type:"oneway"}))},et=(e,t)=>{C.searchParams.routes[0][e]=t,null==I||I(Object.assign({title:"search_form_city_hint_click",product:"train",geo_id:t.rzdNumber},eJ(e)))},ea=e=>{C.searchParams.routes[0].date=e,D(t=>Object.assign(Object.assign({},t),{dateFrom:ta(e)})),null==I||I({title:"search_form_date_hint_click	",product:"train",departure_date:eX(e)})};return(0,u.useEffect)(()=>{if(C.init(),C.loadSalePeriodData(),!a4){let{from:e,to:t,date:a}=C.searchParams.routes[0],r="trainStation"===e.type?{departure_geo_id:e.rzdNumber}:{},n="trainStation"===t.type?{arrival_geo_id:t.rzdNumber}:{};null==I||I(Object.assign(Object.assign(Object.assign(Object.assign({title:"search_form_first_shown",product:"train"},r),n),eQ(a)),{route_type:"oneway"})),a4=!0}},[C,I]),u.createElement(h.gE,Object.assign({size:{xs:500,sm:700},layout:{xs:"vertical",xl:"horizontal"}},(0,d.Ay)("train-search-form")),u.createElement("div",{className:er.A.searchForm},u.createElement(O.C,{withAnimation:!1,isOneway:!0,highlightFutureDates:!0,highlightPastDates:!0,showPastDatesMobile:!0,salePeriod:G,disabledPastDays:!1,product:"train",block:"search_form",apiHost:A.calendarApiHost,calendarHost:A.holidaysApiHost,isDesktop:null==k||k,cityIds:H,disabledOnTargetClick:S,chosenDates:z,setStateChosenDates:D,onChangeDates:J,onOpen:()=>{j(!0)},onClose:()=>{j(!1)},popupContentClassName:er.A.calendarPopup,target:e=>{let{onClick:t,ref:a}=e;return u.createElement("div",{className:er.A.firstSubGroup},u.createElement("div",{className:er.A.departure},u.createElement(a0,{product:"train",position:{xs:"top",lg:"left"},label:x("from"),fieldName:"from",searchParams:C.searchParams,suggest:C.suggest,hasError:!!(null==L?void 0:L.from),errorMessage:X,onFocus:()=>{V&&R("from")},tabIndex:0,onErrorMessageClose:()=>{$(e=>Object.assign(Object.assign({},e),{from:!0}))},theme:w}),u.createElement("div",{className:`${(0,p.V)({xs:"none",xl:"inline-flex"})} ${(0,b.S3)(200)} ${(0,b.rQ)(100)}`},a6.map(e=>u.createElement(m.$n,{color:"secondary-neutral",size:300,key:e.name,onClick:()=>et("from",e)},e.name)))),u.createElement(m.$n,Object.assign({"aria-label":x("swapGeoPoints"),className:`${er.A.switcher} ${(0,p.V)({xs:"inline-flex",lg:"none"})}`,accent:"default",color:"outline-form",leftAddon:u.createElement(v.a,{icon:"arrow-2-up-down_outline"}),size:{xs:300,sm:400},onClick:U,tabIndex:0},(0,d.Ay)("swapButton"),tr(w))),u.createElement(m.$n,Object.assign({"aria-label":x("swapGeoPoints"),position:{lg:"middle-horizontal"},className:`${er.A.switcher} ${(0,p.V)({xs:"none",lg:"inline-flex"})}`,accent:"default",color:"outline-form",leftAddon:u.createElement(v.a,{icon:"arrow-2-left-right_outline"}),size:700,onClick:U,tabIndex:0},(0,d.Ay)("swapButton"),tr(w))),u.createElement("div",{className:er.A.arrival},u.createElement(a0,{product:"train",position:{xs:"middle-vertical",lg:"right",xl:"middle-horizontal"},label:x("to"),fieldName:"to",searchParams:C.searchParams,suggest:C.suggest,hasError:!!(null==L?void 0:L.to),errorMessage:Q,onFocus:()=>{V&&R("to")},tabIndex:0,onErrorMessageClose:()=>{$(e=>Object.assign(Object.assign({},e),{to:!0}))},theme:w}),u.createElement("div",{className:`${(0,p.V)({xs:"none",xl:"inline-flex"})} ${(0,b.S3)(200)} ${(0,b.rQ)(100)}`},a7.map(e=>u.createElement(m.$n,{color:"secondary-neutral",size:300,key:e.name,onClick:()=>et("to",e)},e.name)))),u.createElement("div",{className:(0,T.A)(er.A.targetDate,(0,p.V)({lg:"flex",xl:"block"}),(0,h.tG)({lg:["top"],xl:["none"]}))},u.createElement("div",{ref:a,className:er.A.dateWrapper},u.createElement(g.p,{wrapperClassName:`${er.A.date} ${(0,h.tG)({xs:["bottom"],lg:["none"]})}`,wrapperProps:tr(w),position:{xs:"bottom",lg:"left",xl:"middle-horizontal"},"data-ti":"trip-dates",type:"text",label:x("when"),value:e8({dateFrom:null==z?void 0:z.dateFrom,dateTo:null==z?void 0:z.dateTo}),onChange:()=>{},onClick:e=>{M("from"),null==t||t(e)},onClear:Z,tabIndex:0,readOnly:!0})),u.createElement("div",{className:`${(0,p.V)({xs:"none",xl:"inline-flex"})} ${(0,b.S3)(200)} ${(0,b.rQ)(100)}`},rt.map(e=>u.createElement(m.$n,{color:"secondary-neutral",size:300,key:e.name,onClick:()=>ea(e.date)},e.name))),u.createElement("div",{className:(0,T.A)(er.A.submitButton,(0,p.V)({xs:"none",lg:"block",xl:"none"}))},u.createElement(m.$n,Object.assign({className:`${(0,h.tG)({xs:["top"],lg:["none"]})}`,isLoading:A.submitted,position:{lg:"right"},fullWidth:!0,type:"button","data-ti":"submit-button",onClick:ee},tr(w)),x("find_tickets")))),u.createElement("div",{className:(0,T.A)(er.A.submitButton,(0,p.V)({lg:"none",xl:"block"}))},u.createElement(m.$n,Object.assign({className:`${(0,h.tG)({xs:["top"],lg:["none"]})}`,isLoading:A.submitted,position:{lg:"right"},fullWidth:!0,type:"button","data-ti":"submit-button",onClick:ee},tr(w)),x("find_tickets"))))}})))};class rr{getInitialSearchParams(e){let t=rn();if(e){let a=this.convertOuterSearchParams(e);return Object.assign(Object.assign({},t),a)}return t}convertOuterSearchParams(e){let t=null==e?void 0:e.routes[0];return{routes:[{from:t.from?{type:"etrainStation",name:t.from.value,stationId:t.from.id}:{type:"unknown",name:""},to:t.to?{type:"etrainStation",name:t.to.value,stationId:t.to.id}:{type:"unknown",name:""},date:null==t?void 0:t.date}]}}}function rn(){return{routes:[{from:{type:"unknown",name:""},to:{type:"unknown",name:""},date:void 0}]}}function rs(e){return!!e&&void 0!==e.stationId}function rl(e){return!!e&&"object"==typeof e&&!!("stationId"in e&&"name"in e&&eN(e.stationId)&&eN(e.name))}let ro=(e,t)=>{let{date:a}=e,r=rl(e.from)?e.from:t.from,n=rl(e.to)?e.to:t.to,s=rs(r)?`feid::${r.stationId};`:"",l=rs(n)?`teid::${n.stationId};`:"",o=eN(r.name)?`f::${r.name};`:"",i=eN(n.name)?`t::${n.name};`:"",c=eI(a)?`d::${a};`:"";return`${o}${s}${i}${l}${c}`},ri=(e,t)=>{let{routes:a}=e;return ro(a[0],t.routes[0])},rc=(e,t)=>{let a=null==e?void 0:e.split(";"),r={f:"",feid:"",t:"",teid:"",d:void 0};null==a||a.forEach(e=>{let[t,a]=e.split("::");t&&a&&(r[t]=a)});let n={type:"etrainStation",name:r.f,stationId:r.feid},s={type:"etrainStation",name:r.t,stationId:r.teid};return{routes:[{from:rl(n)?n:t.routes[0].from,to:rl(s)?s:t.routes[0].to,date:e$(r.d)}]}};class ru extends eP{constructor(){super(...arguments),this.initialSearchParams=rn(),this.trainCookieName="sf_etrain"}searchParamsToCookieValue(e){return ri(e,this.initialSearchParams)}cookieValueToSearchParams(e){return rc(e,this.initialSearchParams)}get cookieName(){return this.trainCookieName}}class rd{constructor(e){this.params=e}gotoOffers(e){this.etrainSearchId=(0,l.A)();let[t]=e.routes;this.openPage((0,o.Hv)(Object.assign(Object.assign({mainDomain:this.params.mainDomain.replace("https://","").replace("http://","")},(null==t?void 0:t.date)?{searchId:this.searchId}:{}),this.getExternalSearchParams(e))))}openPage(e){location.href=e}getExternalSearchParams(e){return{trips:e.routes.map(e=>({date:e.date,from:{id:e.from.stationId,value:e.from.name},to:"route"===this.params.mode?{id:e.to.stationId,value:e.to.name}:void 0}))}}get searchId(){return this.etrainSearchId}}class rm{get fetch(){return function(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];return fetch(...t)}}constructor(e){this.etrainApiHost=eu(e)}getSuggestItems(e){return(0,i.sH)(this,arguments,void 0,function*(e){let{request:{value:t},abortController:a}=e,r=new URLSearchParams({name:t});return function(e){if(Array.isArray(e))return e.map(e=>({type:"geoPoint",geoPoint:{name:e.label,type:"etrainStation",stationId:e.value}}));throw Error(`Unknown response format (type '${typeof e}')`)}((yield this.fetch(`${this.etrainApiHost}/station/suggest.php?${r}`,{method:"GET",redirect:"follow",signal:a.signal}).then(e=>e.json())))})}}class rp extends eB{constructor(e){var{suggest:t,calendarApiHost:a}=e;super((0,i.Tt)(e,["suggest","calendarApiHost"])),this.suggest=t}}class rh extends eL{constructor(e,t){super(t),this.loader=e}getSuggestItems(e){return(0,i.sH)(this,void 0,void 0,function*(){return""===e.request.value?this.loader.getSuggestItems(Object.assign(Object.assign({},e),{request:Object.assign(Object.assign({},e.request),{value:"Москва"})})):this.loader.getSuggestItems(e)})}}let rg=(0,c.Ts)().rules({routes:(0,c.p_)((0,c.Ts)().rules({from:{requiredFrom:e=>!e||"unknown"===e.type},to:{requiredTo:e=>!e||"unknown"===e.type}}))}),rv=(0,c.Ts)().rules({routes:(0,c.p_)((0,c.Ts)().rules({from:{requiredFrom:e=>!e||"unknown"===e.type}}))});class rf{constructor(e){this.mode=e}validate(e){switch(this.mode){case"route":{let t=rg.validate(e);return{result:t,isValid:null===t}}case"station":{let t=rv.validate(e);return{result:t,isValid:null===t}}default:return{result:null,isValid:!1}}}}let rb=(0,u.memo)(e=>{let{fieldName:t,suggest:r}=e,s=(0,E.OB)(e=>a(68920)(`./${e}/index.json`)),{items:l,isError:o}=(0,n.s)(r).getItems({fieldName:t});return o&&0===l.length?u.createElement(Q.FC,null,s("error")):l.map(e=>u.createElement(Q.y$,{value:e.geoPoint.stationId,key:e.geoPoint.stationId},u.createElement(M.fh,{addonSize:"none"},u.createElement(F.PM,Object.assign({label:e.geoPoint.name,isLabelAccent:!0,emphasized:!0},(0,d.Ay)("suggest-item-name"))))))});function r_(e){let{fieldName:t,searchParams:a,suggest:r,routeIndex:s=0}=e,l=(0,i.Tt)(e,["fieldName","searchParams","suggest","routeIndex"]),{items:o,isDefaultItems:c}=(0,n.s)(r).getItems({fieldName:t}),d=(0,n.s)(a,{sync:!0}).routes[s],m=d["from"===t?"to":"from"],p=o.map((e,t)=>({value:e.geoPoint.stationId,hiddenValue:Object.assign(Object.assign({},e),{index:t})})),h=(0,u.useCallback)(e=>{r.loadItems({value:e,fieldName:t,relatedField:m,routeIndex:s})},[t,m,s,r]);return u.createElement(tb,Object.assign({},l,{fieldName:t,point:d[t],setPoint:e=>{a.routes[s][t]=e},isDefaultItems:c,items:p,loadItems:h,renderContent:()=>u.createElement(rb,{fieldName:t,suggest:r})}))}let ry={show_schedule:"Показать",today:"Сегодня",tomorrow:"Завтра",from:"Откуда",to:"Куда",when:"Когда",select_departure_location:"Выберите станцию отправления",select_arrival_location:"Выберите станцию прибытия",swap_geo_points:"Поменять местами отправление и прибытие",station_name:"Название станции"},rE={requiredFrom:(0,Z.Ay)(ry,"select_departure_location"),requiredTo:(0,Z.Ay)(ry,"select_arrival_location")},rP=["from","to"],rO={stationId:"20000",name:"Москва",type:"etrainStation"},rC={stationId:"46707",name:"Мытищи",type:"etrainStation"},rw=!1,rk=[rO,rC],rx=[rC,rO],rA=new Date,rI=new Date(rA.getFullYear(),rA.getMonth(),rA.getDate()+1),rN=[{name:(0,Z.Ay)(ry,"today"),date:tt(rA)},{name:(0,Z.Ay)(ry,"tomorrow"),date:tt(rI)}],r$=e=>{var t,r,s,l,o,i,c;let{model:f,inputsTheme:_}=e,C=(0,P.Y)({min:"md"}),w=(0,E.OB)(e=>a(45556)(`./${e}/index.json`)),k=(0,n.s)(f),{userway:x}=(0,y.te)(),[A,I]=(0,u.useState)({from:!1,to:!1}),[N,$]=u.useState(!1),{chosenDates:S,setStateChosenDates:j,setInputFocus:z}=(0,O.x)({dateFrom:k.searchParams.routes[0].date?ta(k.searchParams.routes[0].date):null}),D=S.dateFrom?tt(S.dateFrom):void 0;k.searchParams.routes[0].date!==D&&j(e=>Object.assign(Object.assign({},e),{dateFrom:k.searchParams.routes[0].date?ta(k.searchParams.routes[0].date):null}));let{validationEnabled:M}=k.state,F=M?k.validationResult.result:null,[H,V]=(0,u.useState)(null),B=null===(t=null==F?void 0:F.routes)||void 0===t?void 0:t[0],q=(()=>{if(!B)return null;if(H)for(let e=0;e<rP.length;e++){let t=rP[e];if(B[t]&&H===t)return t}for(let e=0;e<rP.length;e++){let t=rP[e];if(B[t])return t}return null})(),R=null===(l=null===(s=null===(r=null==B?void 0:B.from)||void 0===r?void 0:r.errors)||void 0===s?void 0:s[0])||void 0===l?void 0:l.type,L="from"!==q||A.from?void 0:rE[R],G=null===(c=null===(i=null===(o=null==B?void 0:B.to)||void 0===o?void 0:o.errors)||void 0===i?void 0:i[0])||void 0===c?void 0:c.type,W="to"!==q||A.to?void 0:rE[G],Y=()=>{f.swapGeoPoints(),null==x||x({title:"search_form_change_destination_click",product:"etrain"})},X=e=>{f.searchParams.routes[0].date=e.dateFrom?tt(e.dateFrom):void 0},K=()=>{X({dateFrom:null,dateTo:null})},Q=()=>{var e;(null===(e=f.validationResult)||void 0===e?void 0:e.isValid)||null==x||x({title:"search_form_error_shown	",product:"etrain",validation_errors:e2(k.validationResult)}),f.submit(),V(null),I({from:!1,to:!1});let{from:t,to:a,date:r}=f.searchParams.routes[0],n="etrainStation"===t.type?{departure_geo_id:t.stationId}:{},s="etrainStation"===a.type?{arrival_geo_id:a.stationId}:{},{searchId:l}=f.submitter;null==x||x(Object.assign(Object.assign(Object.assign(Object.assign({title:"search_form_search_click",product:"etrain",search_id:l},n),s),eQ(r)),{route_type:"oneway"}))},U=(e,t)=>{f.searchParams.routes[0][e]=t,null==x||x(Object.assign({title:"search_form_city_hint_click",product:"etrain",geo_id:t.stationId},eJ(e)))},J=e=>{f.searchParams.routes[0].date=e,j(t=>Object.assign(Object.assign({},t),{dateFrom:ta(e)})),null==x||x({title:"search_form_date_hint_click	",product:"etrain",departure_date:eX(e)})};return(0,u.useEffect)(()=>{if(f.init(),!rw){let{from:e,to:t,date:a}=f.searchParams.routes[0],r="etrainStation"===e.type?{departure_geo_id:e.stationId}:{},n="etrainStation"===t.type?{arrival_geo_id:t.stationId}:{};null==x||x(Object.assign(Object.assign(Object.assign(Object.assign({title:"search_form_first_shown",product:"etrain"},r),n),eQ(a)),{route_type:"oneway"})),rw=!0}},[f,x]),u.createElement(h.gE,Object.assign({size:{xs:500,sm:700},layout:{xs:"vertical",xl:"horizontal"}},(0,d.Ay)("etrain-search-form")),u.createElement("div",{className:en.A.searchForm},u.createElement(O.C,{withAnimation:!1,isOneway:!0,highlightFutureDates:!0,highlightPastDates:!0,showPastDatesMobile:!0,disabledPastDays:!1,product:"etrain",block:"search_form",isDesktop:null==C||C,disabledOnTargetClick:N,chosenDates:S,setStateChosenDates:j,onChangeDates:X,onOpen:()=>{$(!0)},onClose:()=>{$(!1)},hidePriceBlock:!0,calendarHost:null,popupContentClassName:en.A.calendarPopup,target:e=>{let{onClick:t,ref:a}=e;return u.createElement("div",{className:en.A.firstSubGroup},u.createElement("div",{className:en.A.departure},u.createElement(r_,{product:"etrain",position:{xs:"top",lg:"left"},label:w("from"),fieldName:"from",searchParams:f.searchParams,suggest:f.suggest,hasError:!!(null==B?void 0:B.from),errorMessage:L,onFocus:()=>{M&&V("from")},tabIndex:0,onErrorMessageClose:()=>{I(e=>Object.assign(Object.assign({},e),{from:!0}))},theme:_}),u.createElement("div",{className:(0,T.A)((0,p.V)({xs:"none",xl:"inline-flex"}),(0,b.S3)(200),(0,b.rQ)(100))},rk.map(e=>u.createElement(m.$n,{color:"secondary-neutral",size:300,key:e.name,onClick:()=>U("from",e)},e.name)))),u.createElement(m.$n,Object.assign({"aria-label":w("swap_geo_points"),className:`${en.A.switcher} ${(0,p.V)({xs:"inline-flex",lg:"none"})}`,accent:"default",color:"outline-form",leftAddon:u.createElement(v.a,{icon:"arrow-2-up-down_outline"}),size:{xs:300,sm:400},onClick:Y,tabIndex:0},(0,d.Ay)("swapButton"),tr(_))),u.createElement(m.$n,Object.assign({"aria-label":w("swap_geo_points"),position:{lg:"middle-horizontal"},className:`${en.A.switcher} ${(0,p.V)({xs:"none",lg:"inline-flex"})}`,accent:"default",color:"outline-form",leftAddon:u.createElement(v.a,{icon:"arrow-2-left-right_outline"}),size:700,onClick:Y,tabIndex:0},(0,d.Ay)("swapButton"),tr(_))),u.createElement("div",{className:en.A.arrival},u.createElement(r_,{product:"etrain",position:{xs:"middle-vertical",lg:"right",xl:"middle-horizontal"},label:w("to"),fieldName:"to",searchParams:f.searchParams,suggest:f.suggest,hasError:!!(null==B?void 0:B.to),errorMessage:W,onFocus:()=>{M&&V("to")},tabIndex:0,onErrorMessageClose:()=>{I(e=>Object.assign(Object.assign({},e),{to:!0}))},theme:_}),u.createElement("div",{className:(0,T.A)((0,p.V)({xs:"none",xl:"inline-flex"}),(0,b.S3)(200),(0,b.rQ)(100))},rx.map(e=>u.createElement(m.$n,{color:"secondary-neutral",size:300,key:e.name,onClick:()=>U("to",e)},e.name)))),u.createElement("div",{className:(0,T.A)(en.A.targetDate,(0,p.V)({lg:"flex",xl:"block"}),(0,h.tG)({lg:["top"],xl:["none"]}))},u.createElement("div",{ref:a,className:en.A.dateWrapper},u.createElement(g.p,{wrapperClassName:`${en.A.date} ${(0,h.tG)({xs:["bottom"],lg:["none"]})}`,wrapperProps:tr(_),position:{xs:"bottom",lg:"left",xl:"middle-horizontal"},"data-ti":"trip-dates",type:"text",label:w("when"),value:e8({dateFrom:null==S?void 0:S.dateFrom,dateTo:null==S?void 0:S.dateTo}),onChange:()=>{},onClick:e=>{z("from"),null==t||t(e)},onClear:K,tabIndex:0,readOnly:!0})),u.createElement("div",{className:`${(0,p.V)({xs:"none",xl:"inline-flex"})} ${(0,b.S3)(200)} ${(0,b.rQ)(100)}`},rN.map(e=>u.createElement(m.$n,{color:"secondary-neutral",size:300,key:e.name,onClick:()=>J(e.date)},e.name))),u.createElement("div",{className:(0,T.A)(en.A.submitButton,(0,p.V)({xs:"none",lg:"block",xl:"none"}))},u.createElement(m.$n,Object.assign({className:`${(0,h.tG)({xs:["top"],lg:["none"]})}`,isLoading:k.submitted,position:{lg:"right"},fullWidth:!0,type:"button","data-ti":"submit-button",onClick:Q},tr(_)),w("show_schedule")))),u.createElement("div",{className:(0,T.A)(en.A.submitButton,(0,p.V)({lg:"none",xl:"block"}))},u.createElement(m.$n,Object.assign({className:`${(0,h.tG)({xs:["top"],lg:["none"]})}`,isLoading:k.submitted,position:{lg:"right"},fullWidth:!0,type:"button","data-ti":"submit-button",onClick:Q},tr(_)),w("show_schedule"))))}})))};(0,Z.Ay)(ry,"select_departure_location"),(0,Z.Ay)(ry,"select_arrival_location");let rS=new Date,rj=new Date(rS.getFullYear(),rS.getMonth(),rS.getDate()+1);(0,Z.Ay)(ry,"today"),tt(rS),(0,Z.Ay)(ry,"tomorrow"),tt(rj);let rz="search-form-active-tab";class rD{constructor(){this.getCookie=s.Ri,this.setCookie=s.TV}setItem(e){this.setCookie(rz,e,{expires:604800})}getItem(){return this.getCookie(rz)||"avia"}}let rT={multi:"Все",avia:"Авиабилеты",train:"Ж/д билеты",bus:"Автобусы",etrain:"Электрички",hotel:"Отели",tours:"Туры",go:"Приключения",aeroexpress:"Аэроэкспрессы"},rM=[{product:"hotel",icon:"bed-double",label:(0,Z.Ay)(rT,"hotel")},{product:"avia",icon:"plane",label:(0,Z.Ay)(rT,"avia")},{product:"train",icon:"train",label:(0,Z.Ay)(rT,"train")},{product:"bus",icon:"bus",label:(0,Z.Ay)(rT,"bus")},{product:"etrain",icon:"etrain",label:(0,Z.Ay)(rT,"etrain")},{product:"go",icon:"aerostat",label:(0,Z.Ay)(rT,"go")},{product:"tours",icon:"island-palms",label:(0,Z.Ay)(rT,"tours")},{product:"aeroexpress",icon:"logo-aeroexpress",label:(0,Z.Ay)(rT,"aeroexpress")}],rF=["autoNoSsr","avia","train","bus","hotel","etrain"];class rH{constructor({referencedDomains:e,aviaForm:t,trainForm:a,busForm:n,hotelForm:s,etrainForm:l,activeTabStorage:o,initialTab:i,onTabChanged:c,tabHotelEnabled:u,tabEtrainEnabled:d,showTrainBadge:m=!1}){let p;this.changeTab=e=>{var t;this.referencedDomains[e]||(this.state.activeTab=e,this.activeTabStorage.setItem(e),null===(t=this.onTabChanged)||void 0===t||t.call(this,e))},this.referencedDomains=e,this.activeTabStorage=o,this.aviaForm=t,this.trainForm=a,this.busForm=n,this.hotelForm=s,this.etrainForm=l,this.onTabChanged=c,p=i&&rF.includes(i)?"autoNoSsr"===i?this.activeTabStorage.getItem():i:"avia",u||"hotel"!==p||(p="avia"),d||"etrain"!==p||(p="avia"),this.state=(0,r.BX)({activeTab:p,tabs:rM.map(e=>{let t=Object.assign({},e);m&&"train"===t.product&&(t.showBadge=!0);let a=this.referencedDomains[t.product];return a?Object.assign(Object.assign({},t),{url:a}):t}),initiated:!1})}init(){this.aviaForm.init(),this.busForm.init(),this.trainForm.init(),this.hotelForm.init(),this.etrainForm.init()}}let rV=()=>u.createElement(v.a,{image:eo,size:100}),rB=()=>u.createElement(es.E,Object.assign({color:"static-light",contentColor:"brand-primary",size:200,isValueAccent:!1,isValueNumeric:!0,leftIcon:u.createElement(rV,null),value:"10%",className:ei.A.badge,colorStyle:"background"},(0,el.A6)()));function rq(e){let{activeTab:t,className:a,items:r,tabStyle:n,onClick:s}=e;return u.createElement("div",{className:(0,T.$)(ec.A.tabRow,a)},r.map(e=>u.createElement(rR,{activeTab:t,item:e,onClick:s,key:e.product,tabStyle:n})))}function rR(e){let{activeTab:t,onClick:a,item:r,tabStyle:n}=e,{icon:s,label:l,url:o,product:i,showBadge:c}=r,d=t===i,m=()=>a(i),p=()=>u.createElement(u.Fragment,null,c&&"train"===i&&u.createElement(rB,null),u.createElement(v.a,{icon:s,className:ec.A.tabItemIcon,shape:"circle",size:{xs:500,sm:700}}),u.createElement("span",{className:(0,T.$)(ec.A.tabItemLabel,{[ec.A.selected]:d})},l));return o?u.createElement("a",{key:i,type:"link",className:(0,T.$)(ec.A.tabLink,ec.A.tabItem,ec.A[`style-${n}`],{[ec.A.selected]:d}),href:o,onClick:m},p()):u.createElement("button",{key:i,type:"button",className:(0,T.$)(ec.A.tabButton,ec.A.tabItem,ec.A[`style-${n}`],{[ec.A.selected]:d}),onClick:m},p())}let rL=e=>{let{model:t,inputsTheme:a,containerClassName:r}=e,s=(0,n.s)(t),{userway:l}=(0,y.te)();return(0,u.useEffect)(()=>{t.init()},[t]),u.createElement("div",Object.assign({className:r},(0,d.th)("search-form")),u.createElement(rq,{tabStyle:"on-contrast",className:(0,b.cV)(350),activeTab:s.state.activeTab,items:s.state.tabs,onClick:e=>{t.changeTab(e),null==l||l({title:"search_form_product_tab_click",product:eK[e],element_state:e===s.state.activeTab?"selected":"active"})}}),"avia"===s.state.activeTab&&u.createElement(tS,{model:t.aviaForm,inputsTheme:a}),"train"===s.state.activeTab&&u.createElement(ra,{model:t.trainForm,inputsTheme:a}),"bus"===s.state.activeTab&&u.createElement(ar,{model:t.busForm,inputsTheme:a}),"hotel"===s.state.activeTab&&u.createElement(az,{model:t.hotelForm,inputsTheme:a}),"etrain"===s.state.activeTab&&u.createElement(r$,{model:t.etrainForm,inputsTheme:a}))};function rG(e){let{mainHost:t,aviaHost:a,trainSuggestHost:n,aviaSuggestHost:s,salePeriodHost:l,toursHost:o,goHost:i,aeroexpressHost:c,hotelHost:u,hotelSuggestHost:d,busHost:m,busSuggestHost:p,calendarApiHost:h,holidaysApiHost:g,initialTab:v,tabHotelEnabled:f,tabEtrainEnabled:b,showTrainBadge:_,onTabChanged:y}=e,E=ed(t);return(0,r.BX)(new rH({initialTab:v,onTabChanged:y,tabHotelEnabled:f,tabEtrainEnabled:b,activeTabStorage:new rD,referencedDomains:Object.assign(Object.assign({tours:null!=o?o:eg(E),go:null!=i?i:ev(E),aeroexpress:null!=c?c:ef(E)},f?{}:{hotel:eb(E)}),b?{}:{etrain:eh(E)}),showTrainBadge:_,aviaForm:function(e){let{searchParams:t,aviaSuggestHost:a,aviaHost:n,calendarApiHost:s,lastSearch:l,aviaSubmitter:o,suggestLoader:i,logError:c,renderEmptyFieldsOnSsr:u,holidaysApiHost:d}=e,m=null!=l?l:new eF,p=eu(n);return(0,r.BX)(new eq({searchParams:t,suggest:new eG(null!=i?i:new eV(null!=a?a:p),c),validator:new eY,lastSearch:m,searchParamsInitializer:new ek,submitter:o||new eH({aviaHost:p}),calendarApiHost:null!=s?s:ey(p,"avia."),holidaysApiHost:void 0===d?eE(p,"avia."):d,renderEmptyFieldsOnSsr:u}))}({aviaHost:null!=a?a:em(E),aviaSuggestHost:null!=s?s:em(E),calendarApiHost:null!=h?h:ey(E),holidaysApiHost:g}),trainForm:function(e){let{searchParams:t,trainSuggestHost:a,mainDomain:n,calendarApiHost:s,holidaysApiHost:l,salePeriodHost:o,lastSearch:i,trainSubmitter:c,suggestLoader:u,salePeriodLoader:d,relevantSuggestLoader:m,renderEmptyFieldsOnSsr:p,logError:h}=e,g=null!=i?i:new aq,v=eu(n);return(0,r.BX)(new aX({searchParams:t,salePeriod:new aK(null!=d?d:new aG(null!=o?o:v)),suggest:new aQ(null!=u?u:new aY(null!=a?a:v),null!=m?m:new aR(null!=a?a:v),h),validator:new aJ,lastSearch:g,searchParamsInitializer:new aD,submitter:c||new aW({mainDomain:n}),calendarApiHost:null!=s?s:ey(v),holidaysApiHost:void 0===l?eE(v):l,renderEmptyFieldsOnSsr:p}))}({mainDomain:E,trainSuggestHost:null!=n?n:E,calendarApiHost:null!=h?h:ey(E),salePeriodHost:null!=l?l:E,holidaysApiHost:g}),busForm:function(e){let{searchParams:t,busHost:a,busSuggestHost:n,calendarApiHost:s,holidaysApiHost:l,lastSearch:o,busSubmitter:i,suggestLoader:c,logError:u,renderEmptyFieldsOnSsr:d}=e,m=null!=o?o:new tR,p=eu(a);return(0,r.BX)(new tY({searchParams:t,suggest:new tX(null!=c?c:new tW(null!=n?n:p),u),validator:new tQ,lastSearch:m,searchParamsInitializer:new tz,submitter:i||new tL({busHost:p}),calendarApiHost:null!=s?s:ey(p,"bus."),holidaysApiHost:void 0===l?eE(p,"bus."):l,renderEmptyFieldsOnSsr:d}))}({busHost:null!=m?m:ep(E),busSuggestHost:null!=p?p:ep(E),calendarApiHost:null!=h?h:ey(E),holidaysApiHost:g}),hotelForm:function(e){let{searchParams:t,hotelSuggestHost:a,hotelHost:n,lastSearch:s,hotelSubmitter:l,suggestLoader:o,logError:i,renderEmptyFieldsOnSsr:c,holidaysApiHost:u}=e,d=null!=s?s:new au,m=eu(n);return(0,r.BX)(new ah({searchParams:t,suggest:new av(null!=o?o:new am(null!=a?a:e_(m,"hotel.")),i),validator:new a_,lastSearch:d,searchParamsInitializer:new as,submitter:l||new ad({hotelDomain:m}),holidaysApiHost:void 0===u?eE(m,"hotel."):u,renderEmptyFieldsOnSsr:c}))}({hotelHost:null!=u?u:eb(E),hotelSuggestHost:null!=d?d:eb(E),calendarApiHost:null!=h?h:ey(E),holidaysApiHost:g}),etrainForm:function(e){let{mode:t,searchParams:a,etrainSuggestHost:n,mainDomain:s,lastSearch:l,ETrainSubmitter:o,suggestLoader:i,renderEmptyFieldsOnSsr:c,logError:u}=e,d=null!=l?l:new ru,m=eu(s);return(0,r.BX)(new rp({searchParams:a,suggest:new rh(null!=i?i:new rm(null!=n?n:m),u),validator:new rf(t),lastSearch:d,searchParamsInitializer:new rr,submitter:o||new rd({mainDomain:s,mode:t}),renderEmptyFieldsOnSsr:c}))}({mainDomain:E,mode:"route"})}))}}}]);
</script>

</body>
</html>
