<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>bmwusa-dealer-map.html</title>
</head>
<body>

<script>
/*! BMWUSA Vite Build 1731603678170 */
import{C as c}from"/etc.clientlibs/bmwusa/clientlibs/clientlib-site/bmwusa-clientlibs/bmwusa-chunks/resources/component.js";import{s as d}from"/etc.clientlibs/bmwusa/clientlibs/clientlib-site/bmwusa-clientlibs/bmwusa-chunks/resources/index.esm.js";import{B as l}from"/etc.clientlibs/bmwusa/clientlibs/clientlib-site/bmwusa-clientlibs/bmwusa-chunks/resources/index.js";import{$ as r,h as a}from"/etc.clientlibs/bmwusa/clientlibs/clientlib-site/bmwusa-clientlibs/bmwusa-measurement-data.js";import"/etc.clientlibs/bmwusa/clientlibs/clientlib-site/bmwusa-clientlibs/bmwusa-chunks/resources/is-author.js";import"/etc.clientlibs/bmwusa/clientlibs/clientlib-site/bmwusa-clientlibs/bmwusa-chunks/resources/baseDomain.js";import"/etc.clientlibs/bmwusa/clientlibs/clientlib-site/bmwusa-clientlibs/bmwusa-chunks/resources/getbyourl.js";import"/etc.clientlibs/bmwusa/clientlibs/clientlib-site/bmwusa-clientlibs/bmwusa-chunks/resources/scroll-to.js";import"/etc.clientlibs/bmwusa/clientlibs/clientlib-site/bmwusa-clientlibs/bmwusa-chunks/resources/uid.js";import"/etc.clientlibs/bmwusa/clientlibs/clientlib-site/bmwusa-clientlibs/bmwusa-chunks/resources/zipcode.js";class o{constructor(e){o.prototype.__init.call(this),this.config=e,this.BPs=e.map(s=>s.width)}__init(){this.getCount=()=>{const e=window.innerWidth;for(let s=0;s<this.BPs.length;s++){const i=this.BPs[s];if(i!=="max"&&e<i)return s;if(i==="max")return s;if(s===this.BPs.length)return this.BPs.length}}}ellipse(e){const s=this.getCount(),i=this.config[s].count;return e.length>i?`${e.substring(0,i)}...`:e}}var h;new c({el:".dealer-map",name:"dealer-map Component",baseStr:"dealer-map",subscriptions:{"dealer.detail-new-search":"displayNewSearch","dealer.detail-veiw-mobile":"toggleDealerDetailMobile","dealer.detail-veiw":"changeBackBtn","dealer.toggleListView":"toggleListView","dealermap.component-embedded":"embeddedComponent","dealermap.dealer-view":"displayDetailedView","dealermap.list-update":"displayResults","dealermap.no-results":"noResults","dealermap.search-results":"displayResults","dealermap.search-view":"hideResults","filterlist.clear-filter":"filterClear","window.resizeEnd":"resizeEvt","globalnav.embedded.dealerInfo":"updateFromCookie",dealerUpdate:"dealerUpdateHandler","dealermap.dealer-primary-toggle":"primaryToggleEvt","dealermap.search":"dealerBarClick"},maxSize:l.getValue("sm","max"),isPhone:((h=l.current())==null?void 0:h.breakpoint)==="sm",currentFilter:0,searchTermVal:"",paginationH:0,isIPHONE:/(iPhone)/g.test(navigator.userAgent),dealerData:{},beforeInit(){this.ellipse=new o([{count:28,width:768},{count:18,width:960},{count:16,width:1280},{count:25,width:"max"}]),this.dealerData=null,this.dealerBarClick=this.dealerBarClick.bind(this),this.updateFromCookie=this.updateFromCookie.bind(this),this.trapFocus,this.dealerMapLocationSearch=r.qs(".dealer-map-location-search--active"),this.dealerContent=r.qs("[data-button-id=dealerLocator]"),this.outterShell=r.qs(`${this.el}__outter-shell`,this.element),this.innerFill=this.element.querySelectorAll(`${this.el}__inner-fill`),this.backSearchBtn=this.element.querySelector(`${this.el}__top-nav-back-search`),this.filterBtn=this.element.querySelector(`${this.el}__filter`),this.searchTerm=this.backSearchBtn.querySelector("span"),this.backResultsBtn=this.element.querySelector(`${this.el}__top-nav-back-results`),this.newSearchBtn=this.element.querySelector(`${this.el}__top-nav-new-search`),this.mapHolder=this.element.querySelector(".google-map"),this.content=this.element.querySelector(`${this.el}__content-holder`),this.closeBtn=this.element.querySelector(".globalnav-map-popup__close-btn"),this.closeMap=this.closeMap.bind(this),this.hideResults=this.hideResults.bind(this),this.backToResults=this.backToResults.bind(this),this.filterDropDownToggle=this.filterDropDownToggle.bind(this),this.resetEllipse=this.resetEllipse.bind(this),this.closeFilterDropDown=this.closeFilterDropDown.bind(this),this.isEmbedded=this.element.parentNode.classList.contains("standalone-dealer-map"),this.subscriptionTokens=[],this.subscriptionTokens.push(PubSub.subscribe("map.close-modal",this.filterActiveState.bind(this))),this.subscriptionTokens.push(PubSub.subscribe("filterview.filter",this.filterActiveState.bind(this))),this.subscriptionTokens.push(PubSub.subscribe("dealermap.search-view",this.hideResults.bind(this)))},init(){window.addEventListener("globalnav.embedded.dealerInfo",this.updateFromCookie),this.updateFromCookie(),this.pageLoad=!0,this.element.addEventListener("click",this.checkClick),this.newSearchBtn.addEventListener("click",()=>{PubSub.publish("dealermap.search-view",!0)}),this.backSearchBtn.addEventListener("click",()=>{PubSub.publish("dealermap.search-view",!0),PubSub.publish("filter.reset-list-view"),PubSub.publish("map.set-trap-focus")}),this.backResultsBtn.addEventListener("click",this.backToResults),this.filterBtn.addEventListener("click",this.filterDropDownToggle),this.getViewportHeightMobile();for(let t=0;t<this.innerFill.length;t++)this.innerFill[t].addEventListener("click",this.closeFilterDropDown);this.isEmbedded&&PubSub.publish("dealermap.component-embedded")},updateFromCookie(){document.querySelector(".cmp-globalnavigation")&&a.updateFromCookie().then(()=>{this.processDealerInfo()})},processDealerInfo(){this.dealerData=a.getDealerInfo(),this.payload=a.getDealerList(),this.dealerData.dealer&&this.dealerData.maco&&this.pageLoad&&(this.dealerData.pageLoad=!0),!this.payload&&this.dealerData&&(this.payload=this.dealerData.dealer)},primaryToggleEvt(t,e){document.querySelector(".cmp-globalnavigation")&&(this.isPrimarySet=e.primary,this.isPrimarySet?this.newPrimaryData=e:this.newPrimaryData=!1)},dealerUpdateHandler(t,e){document.querySelector(".cmp-globalnavigation")&&(this.newPrimaryData?(this.dealerData=this.newPrimaryData,this.payload=this.dealerData.payload):(!this.isPrimarySet||this.isPrimarySet&&e.primaryToggle)&&(this.dealerData=e,this.payload=this.dealerData.payload))},dealerBarClick(t){this.payload||(this.payload=a.getDealerList()),this.dealerData.dealer?PubSub.publish("dealermap.dealer-view",{dealer:[this.dealerData.dealer],payload:this.payload,newSearch:!0,Maco:this.dealerData.maco}):PubSub.publish("dealermap.search-view")},getViewportHeightMobile(){l.isMobile()&&d(this.isIPHONE)},checkClick(t){PubSub.publish("dealer.outside.click",t)},embeddedComponent(t){this.isEmbedded?PubSub.publish("dealermap.search-view",!0):this.element.parentNode.removeChild(this.element),PubSub.publish("bmw-grid.recalculate")},closeMap(t){PubSub.publish("map.close-map"),this.innerFill&&this.toggleInnerFill()},closeFilterDropDown(t){PubSub.publish("filter.toggleDisplay",!1),this.toggleInnerFill()},toggleInnerFill(t=!1){const e=`${this.baseStr}__inner-fill--active`;for(let s=0;s<this.innerFill.length;s++)t?this.innerFill[s].classList.add(e):this.innerFill[s].classList.remove(e)},backToResults(t){PubSub.publish("dealer.search-results-list",t),this.toggleResultsBtn(),this.toggleFilterBtn(!0),this.toggleSearchBtn(!0),PubSub.publish("map.remove-trap-focus","detail")},resetEllipse(){this.searchTermVal&&this.searchTermVal.length>0&&(this.searchTerm.innerHTML=this.setDisplayString(this.searchTermVal))},setDisplayString(t){return`&ldquo;${this.ellipse.ellipse(t)}&rdquo;`},displayResults(t,e){this.searchTermVal=e.Term,this.currentSearch=e.currentSearch,this.searchTerm.innerHTML=this.searchTermVal&&e.currentSearch!="latLonSearch"?this.setDisplayString(this.searchTermVal):"",this.currentSearch=="singleDealer"?this.toggleResultsView(!0,!0):(this.toggleResultsView(!0,e.newSearch),this.toggleFilterBtn(!0),this.toggleActiveBorder(!0),this.toggleSearchView())},displayDetailedView(t,e){this.toggleSearchView(),this.toggleActiveBorder(!0),this.toggleResultsView(!0,e.newSearch)},displayNewSearch(t){this.toggleSearchBtn(),this.toggleNewSearchBtn(!0)},filterDropDownToggle(t){const e=t.currentTarget,s=`${this.baseStr}__filter--active`;e.classList.contains(s)&&this.currentFilter==0?(this.filterActiveState(null),PubSub.publish("filter.toggleDisplay",!1)):(this.filterActiveState(null,!0),PubSub.publish("filter.toggleDisplay",!0))},filterActiveState(t,e=!1){const s=`${this.baseStr}__filter--active`;typeof e=="object"&&(this.currentFilter=e.filterId,e=e.open),e||this.currentFilter>0?this.filterBtn.classList.add(s):this.filterBtn.classList.remove(s),this.toggleInnerFill(e)},filterClear(t,e){const s=`${this.baseStr}__filter--active`;this.filterBtn.classList.remove(s),this.currentFilter=0,this.toggleInnerFill()},toggleResultsView(t=!1,e=!1){const s=`${this.baseStr}-results--active`;this.resultsHolder||(this.resultsHolder=this.element.querySelector(`${this.el}-results`)),t?(this.currentView="results",this.resultsHolder.classList.add(s),e?(this.toggleNewSearchBtn(!0),this.toggleSearchBtn()):(this.toggleSearchBtn(!0),this.toggleNewSearchBtn()),this.toggleActiveBorder(!0),this.toggleFilterBtn(),this.toggleResultsBtn()):(this.resultsHolder.classList.remove(s),this.toggleSearchBtn(),this.toggleNewSearchBtn())},toggleSearchView(t=!1){const e=`${this.baseStr}-location-search--active`;this.searchHolder||(this.searchHolder=this.element.querySelector(`${this.el}-location-search`)),t?(this.currentView="search",this.content.style.top="",this.content.style.overflow="",this.searchHolder.classList.add(e),this.toggleActiveBorder(),this.toggleFilterBtn(),this.toggleInnerFill(),PubSub.publish("dealer.dealer-list-clear-toogle")):this.searchHolder.classList.remove(e)},toggleListView(t,e){const{top:s,overflow:i,paginationH:n}=e;this.content.style.top=s,this.content.style.overflow=i,this.paginationH=n},toggleResultsBtn(t=!1){const e=`${this.baseStr}__top-nav-back-results--active`;t?this.backResultsBtn.classList.add(e):this.backResultsBtn.classList.remove(e)},toggleSearchBtn(t=!1){const e=`${this.baseStr}__top-nav-back-search--active`;t?this.backSearchBtn.classList.add(e):this.backSearchBtn.classList.remove(e)},toggleFilterBtn(t=!1){const e=`${this.baseStr}__filter--show`;t?this.filterBtn.classList.add(e):this.filterBtn.classList.remove(e)},toggleNewSearchBtn(t=!1){const e=`${this.baseStr}__top-nav-new-search--active`;t?this.newSearchBtn.classList.add(e):this.newSearchBtn.classList.remove(e)},toggleDealerDetailMobile(t,e=!1){const s=`${this.baseStr}__content-holder--detail-mobile`,i="google-map--detail-mobile";e?(this.currentView="dealer-detail-mobile",this.content.classList.add(s),this.mapHolder.classList.add(i)):(this.content.classList.remove(s),this.mapHolder.classList.remove(i))},toggleActiveBorder(t=!1){const e=`${this.baseStr}__top-nav--active-border`,s="globalnav-map-popup__close-btn-holder--active";this.topNav||(this.topNav=this.element.querySelector(`${this.el}__top-nav`)),t?(this.topNav.classList.add(e),this.closeBtn.parentNode.classList.add(s)):(this.topNav.classList.remove(e),this.closeBtn.parentNode.classList.remove(s))},hideResults(t,e){!(e!=null&&e!=!0)&&(this.toggleResultsView(),this.toggleFilterBtn(),this.toggleDealerDetailMobile(null),this.toggleSearchView(!0),PubSub.publish("dealermap.map-reset"),PubSub.publish("dealer.pagination-hide"),PubSub.publish("map.remove-trap-focus","result"),PubSub.publish("map.remove-trap-focus","detail"),PubSub.publish("map.set-trap-focus","search"))},changeBackBtn(t){this.currentSearch!="singleDealer"&&(this.toggleFilterBtn(),this.toggleSearchBtn(),this.toggleNewSearchBtn(),this.toggleResultsBtn(!0))},noResults(t,e){const s="google-map--no-results";e&&this.isPhone?this.mapHolder.classList.add(s):this.mapHolder.classList.remove(s)},resizeEvt(t,e){this.isPhone&&(e==null?void 0:e.width)>this.maxSize?(this.isPhone=!1,this.toggleDealerDetailMobile(null,!1)):!this.isPhone&&(e==null?void 0:e.width)<=this.maxSize&&(this.isPhone=!0,this.currentView==="dealer-detail-mobile"&&this.toggleDealerDetailMobile(null,!0)),this.getViewportHeightMobile(),this.getResizeTop(),this.resetEllipse()},getResizeTop(){if(l.isMobile()&&this.isIPHONE){const t=getComputedStyle(document.documentElement).getPropertyValue("--viewportHeight")||"100vh";this.content.style.top=`calc(${t} - ${this.paginationH}px)`}}});

</script>

</body>
</html>
