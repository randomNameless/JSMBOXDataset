<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>snippet.html</title>
</head>
<body>

<script>
if (typeof widget === 'undefined' || widget !== true) {

    /*  
        SORTEO DE NAVIDAD
        =================
        Si el WIDGET está habilitado la variable "widget", dentro del propio Widget, está como "true".
        Cookiebot NO SE VA A ACTIVAR en el WIDGET de LNAC de Navidad
    */

    // EAM: Cookiebot (23/11/2021)
    //
    function getLanguage () {
        var URL = window.location.href;
        var pattern = /\/(es|ca|en|eu|gl|va|ES|CA|EN|EU|GL|VA)/g;
        language = "ES"
        
        // Si la pagina no contiene el IDIOMA, por defecto se pone "ES"
        result = pattern.exec(URL);
        if (result !== null) {
            language = result[0].substr(1).toUpperCase();
           
            // Como el VALENCIANO NO está soportado por ahora, cargamos el CATAlÁN
            if (language == "VA")
                language = "CA"
        } 
        return language;
    }
    
    function getId(){
        if (document.domain == 'www.loteriasyapuestas.es')
            id = 'c29213e8-5313-45a6-a390-9f67e0f3eb45'
        else 
            id = '082d5a8c-9aaa-4c50-a808-3704ff207450'
      return id
    }
    if (document.domain != 'preview.loteriasyapuestas.es') {  
      window.onload = function() {
          var lang = getLanguage();
          var cbid = getId();
          var blockingmode = "auto";
          
          // Se crea un nuevo "style" para desactivar el "Powered by"
          var styles = '#CybotCookiebotDialogPoweredbyCybot { visibility: hidden; }';
          styles += ' #CybotCookiebotDialogDetailFooter { visibility: hidden; }';
          styles += ' #CybotCookiebotDialogPoweredByText { visibility: hidden; }';
          styles += ' #CookieDeclarationLastUpdated { visibility: hidden; }';
          styles += ' #CybotCookiebotDialog input[type="checkbox"] {display: inherit;}';
          
          // Llamada al SCRIPT de CookieBot
          var head = document.head;
          var scriptCookiBoot = document.createElement('script');
             
          scriptCookiBoot.type = 'text/javascript';
          scriptCookiBoot.src = 'https://consent.cookiebot.com/uc.js';
          scriptCookiBoot.dataset.cbid = cbid;
          scriptCookiBoot.dataset.culture=lang;
          scriptCookiBoot.dataset.blockingmode = blockingmode;
          head.insertBefore(scriptCookiBoot, head.childNodes[0]);
      
          var s = document.createElement('style');
          s.setAttribute('type', 'text/css');
          if (s.styleSheet) { // IE
              s.styleSheet.cssText = styles;
          } else { // the world
              s.appendChild(document.createTextNode(styles));
          }
          head.insertBefore(s, head.childNodes[0]);
      };
    }
}

/* Google Tag Manager */
(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-5P7N9T');
/* End Google Tag Manager */

/* Indigitall EAM: 14/07/22 */
/* Servicio PUSH */
if( typeof setUpPush !== 'undefined' ) {
    setUpPush({
      appKey: '3cab24a5-e649-497d-8a56-aa1a0ae2dafd',
      workerPath: 'https://www.loteriasyapuestas.es/push/worker.min.js',
      urlDeviceApi: 'https://eu2.device-api.indigitall.com/v1',
      cliente:'CMS',
      serviceUsuarioPath:'https://juegos.loteriasyapuestas.es/jugar/servicios-rest/participante/sesion',
      serviceInteresesPath:'https://juegos.loteriasyapuestas.es/jugar/servicios-rest/serviciosAdicionales/participante',
      servicioDispositivos:'https://juegos.loteriasyapuestas.es/jugar/cas/servicios-rest/participante',
      cache: 540000
    });
}
/* NOTA: en caso de querer deshabilitar PUSH, comentar la línea del 'initPush()' */

/* Indigitall AMY: 19/07/22 se reemplaza el cambio incluido el 15/07/2022 */
try{
    var cacheUser = localStorage.getItem('cachedJSONp');
    if(cacheUser != null && cacheUser != ''){
        var urlPage = window.location.href;
        var dataCache = JSON.parse(cacheUser);
        if (dataCache.estadoPlataforma == 'ABIERTA') {
            if (dataCache.participanteID != '' && dataCache.loginPrevio != '-' && dataCache.participanteID != 'ERROR' && dataCache.loginPrevio != 'ERROR' && urlPage.indexOf("hasta-pronto")<0) {
                //usuario autenticado
                initPush();
            }
        }
    }
}catch(error){
}
/*Fin servicio PUSH */


</script>

</body>
</html>
