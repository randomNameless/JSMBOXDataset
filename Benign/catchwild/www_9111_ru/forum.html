<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>forum.html</title>
</head>
<body>

<script>
function removeHash(){history.pushState("",document.title,window.location.pathname+window.location.search)}function replaceSelectedText(obj,cbFunc,tag){if(obj.focus(),document.selection){var s=document.selection.createRange();return eval("s.text="+cbFunc+"(s.text,'"+tag+"');"),s.select(),!0}if("number"==typeof obj.selectionStart){var start=obj.selectionStart,end=obj.selectionEnd;return eval("var rs = "+cbFunc+"(obj.value.substr(start,end-start),'"+tag+"');"),obj.value=obj.value.substr(0,start)+rs+obj.value.substr(end),obj.setSelectionRange(end,end),!0}return!1}function insert(t){var e,n,i,a,o,s;if(window.getSelection&&(e=window.getSelection()).rangeCount){for(console.log(e.rangeCount),(n=e.getRangeAt(0)).deleteContents(),(i=document.createElement("span")).innerHTML=t,a=document.createDocumentFragment();o=i.firstChild;)s=a.appendChild(o);a.firstChild,n.insertNode(a),(n=n.cloneRange()).setStartAfter(s),e.removeAllRanges(),e.addRange(n)}}function addSmile(t,e){replaceSelectedText(document.getElementById(e),addSmileCode,t)}function addSmileCode(t,e){return":"+e+":"+t}function forum_subscribe(t,e,n){void 0===n&&(n=""),$.ajax({type:"POST",url:"/ajax_server/forum/ajax_forum_subscribe.php",data:{id:t,on_off:e,mode:n},success:function(t){1===parseInt(t)?($(".title_subscribe").addClass("dn"),$(".title_unsubscribe").removeClass("dn")):0===parseInt(t)?($(".title_subscribe").removeClass("dn"),$(".title_unsubscribe").addClass("dn")):alert(t)}})}var textAreaSelectionObjects=[];function getTextAreaSelection(t){return void 0===textAreaSelectionObjects[t]&&(textAreaSelectionObjects[t]=new textAreaSelectionHelper(t)),textAreaSelectionObjects[t]}function textAreaSelectionHelper(t){var e=document.getElementById(t);null!==e&&(this.target=e,this.target.carretHandler=this,this.target.onchange=_textareaSaver,this.target.onclick=_textareaSaver,this.target.onkeyup=_textareaSaver,this.target.onfocus=_textareaSaver,document.selection||(this.target.onSelect=_textareaSaver),this.start=-1,this.end=-1,this.scroll=-1,this.iesel=null)}function _textareaSaver(){document.selection?this.carretHandler.iesel=document.selection.createRange().duplicate():void 0!==this.selectionStart?(this.carretHandler.start=this.selectionStart,this.carretHandler.end=this.selectionEnd,this.carretHandler.scroll=this.scrollTop):this.carretHandler.start=this.carretHandler.end=-1}function setBB(t,e){$("#"+t).wrapSelected("["+e+"]","[/"+e+"]").focus()}function show_smile_row(t,e,n){if($("#"+t).html().length>0&&!n)$("#"+t).html(""),$("#"+t).hide();else{for(n||(n=1,$("#"+t).show()),smiles="",i=site_vars.smiles_icons[n].length-1;i>=0;i--)sm=site_vars.smiles_icons[n][i],smiles+='<img class="cur-p" src="https://s.9111s.ru/img/smiles/'+sm+'.gif" alt="" title="'+sm+'"\tonclick="addSmile(\''+sm+"','"+e+"');\">";n<Object.keys(site_vars.smiles_icons).length&&(smiles+='<span class="cur-p" onclick="show_smile_row(\''+t+"','"+e+"',"+(n+1)+'); this.remove();">еще</span>'),$("#"+t).append(smiles)}}function new_show_smile_row(t,e,n){if($("#"+t).html().length>0&&!n);else{for(n||(n=1,$("#"+t).show()),smiles="",i=site_vars.smiles_icons[n].length-1;i>=0;i--)sm=site_vars.smiles_icons[n][i],smiles+='<img class="more_smiles" src="https://s.9111s.ru/img/smiles/'+sm+'.gif" alt="" title="'+sm+'"\tonclick="addSmile(\''+sm+"','"+e+"');\">";$("#"+t).append(smiles)}}function deleteForumMessage(t,e,n,i){if(void 0===e&&(e="Удалить сообщение?"),void 0===i&&(i=0),void 0===n&&(n="comment"),"title"===n)var a=prompt(e,"");else a=confirm(e);var o=parseInt($("#s_delete_comment_admin_"+t).val());isNaN(o)&&(o=0),void 0===t||!a&&""!==a||($("#m_text"+t).html("Удалено!!!"),$.ajax({type:"post",url:"/ajax_server/forum/ajax_delete_message.php",data:{msg_id:t,type:n,user_id:i,onoff_status:o,reason:!0!==a?a:""},success:function(t){"comment"!==n&&document.location.reload(!0)}})),$("#submenu_mm_comments"+t).removeClass("subactive")}textAreaSelectionHelper.prototype={getSelectedText:function(){return this.iesel?this.iesel.text:this.start>=0&&this.end>this.start?this.target.value.substring(this.start,this.end):""},setSelectedText:function(t,e){if(this.iesel){if("string"==typeof e){var n=this.iesel.text.length;this.iesel.text=t+this.iesel.text+e,this.iesel.moveEnd("character",-e.length),this.iesel.moveStart("character",-n)}else this.iesel.text=t;this.iesel.select()}else if(this.start>=0&&this.end>=this.start){var i=this.target.value.substring(0,this.start),a=this.target.value.substr(this.end),o=this.target.value.substring(this.start,this.end);"string"==typeof e?(this.target.value=i+t+o+e+a,this.end=this.target.selectionEnd=this.start+t.length+o.length,this.start=this.target.selectionStart=this.start+t.length):(this.target.value=i+t+a,this.end=this.target.selectionEnd=this.start+t.length,this.start=this.target.selectionStart=this.start+t.length),this.target.scrollTop=this.scroll,this.target.focus()}else this.target.value+=t+("string"==typeof e?e:""),this.scroll>=0&&(this.target.scrollTop=this.scroll)}};let to_blacklist_works=!1;function forumToBlacklist(t,e,n){void 0===e&&(e="w"),void 0===n&&(n="w"===e?"Запретить пользователю писать?":"Запретить пользователю читать и писать?"),void 0!==t&&confirm(n)&&!1===to_blacklist_works&&(to_blacklist_works=!0,$.ajax({type:"post",url:"/ajax_server/forum/ajax_add_blacklist.php",data:{msg_id:t,type:e},success:function(e){"1"===e&&(to_blacklist_works=!1,$("#m"+t+" .forumThemeText").before('<div class="cr"><b>Операция выполнена успешно!</b></div>'))}}))}function forumMsgComplaint(t=0,e="comment",n=""){if(t>0){var i=!1;"comment"===e&&""===n?i=prompt("Причина жалобы на комментарий",""):""===n?("title2"===e?(i="Текст сгенерирован нейросетью",e="title"):i=$("#complaintReason option:selected").html(),""===i||void 0===i?i=!0:""!==$("#rejectNote").val()&&void 0!==$("#rejectNote").val()&&(i=i+". "+$("#rejectNote").val())):i=!0,i&&$.ajax({method:"POST",cache:!1,url:"/ajax_server/forum/complaint.php",data:{msg_id:t,type:e,cause:i,admin:n,token:ru9111.token},success:function(e){$("#forum_complaint"+t).fadeOut(100,(function(){$("#forum_complaint"+t).attr("onclick",""),$("#forum_complaint"+t).html("Отправлено").fadeIn(200)})),""!==n&&$("#admin_forum_message_item"+t).fadeOut(200)}})}}function pubComplaint(t){if(!t)t=$("#tuktuk")[0];$("#complaintReasonCont").scrollView(),0==$("#complaintReason").length||0==$("#complaintReason").val()?0==$("#complaintReason").length?($("#complaintReasonCont").html('<div id="complaintReasonCont" style="border: 1px solid #ccc; width:320px;margin: 5px auto;padding: 5px;"><h3>Жалоба на публикацию:</h3><select id="complaintReason" class="mb20"></select>Примечание:<textarea name="note" id="rejectNote" style="width:90%; height:75px;"></textarea></div>'),t.innerHTML="Пожаловаться",$.ajax({type:"POST",url:"/ajax_server/forum/complaint.php",data:{msg_id:document.querySelector("[data-forum-id]").dataset.forumId,type:"reasons_list",token:ru9111.token},success:function(t){$("#complaintReason").html(t)}})):alert("Выберите причину жалобы"):new PopUper({body:"Отправить жалобу на публикацию?",title:"Жалоба",style:"notify",controls:[{title:"Отправить",action:()=>{forumMsgComplaint(document.querySelector("[data-forum-id]").dataset.forumId,"title"),t&&(t.innerHTML="Ваша жалоба отправлена",t.classList.remove("btn--coral"),t.classList.add("btn_yellow"),t.onclick="",t.removeAttribute("onclick"),$("#complaintReasonCont").remove())},enter:!0},{title:"Отмена"}]})}function pubComplaint_send(t){if(!t)t=$("neyroset")[0];forumMsgComplaint(document.querySelector("[data-forum-id]").dataset.forumId,"title2"),t&&(t.innerHTML="Ваша жалоба отправлена",t.classList.remove("btn_red"),t.classList.add("btn_yellow"),t.onclick="",t.removeAttribute("onclick"),$("#complaintReasonCont").remove(),new PopUper({title:"Внимание!",body:"В случае не обоснованных жалоб возможна блокировка аккаунта",style:"notify",controls:[{title:"OK",enter:!0}]}))}function addTagToList(){if($("#tags_list li").length-1<=10&&$("#tag_list_input").val().length>3){var t=$("#tag_list_input").val();t=t.substring(0,t.length-1),$("#tags_list").append('<li class="item_tag">'+t+'<span onclick="delTagFromList($(this));">x</span></li>'),$("#title_tags").val($("#title_tags").val()+","+t),$("#tag_list_input").val("")}}function delTagFromList(t){$(t).parent(".item_tag").remove()}let forum_status_save=!1;function saveAddTitleForm(){if(!1===forum_status_save){var t=4;void 0!==$('input[name="articles_type"]:checked').val()&&(t=parseInt($('input[name="articles_type"]:checked').val()));var e=$("#topic_name").text();if(2!==t&&e.length<5)return new PopUper({title:"Минимальная длина заголовка",body:"Заголовок должен быть не менее 5 символов",style:"notify",controls:[{title:"OK",enter:!0}]}),forum_status_save=!1,!1;var n=parseInt($('select[name="rubric_id"]').val());if(2!==t&&0===n)return alert("Необходимо выбрать тематику"),forum_status_save=!1,!1;var i="";4===t&&$('textarea[name="title_description"]').length>0&&(i=$('textarea[name="title_description"]').val());var a=$('textarea[name="komm"]').val();if(2!==t&&0===a.length)return alert("Текст не должен быть пустым"),forum_status_save=!1,!1;var o=$('input[name="title_tags"]').val();""===o&&(o=$('input[name="tag_list_input"]').val());var s=!1;!0===$('input[name="topic_on_off"]').prop("checked")&&(s=!0);var r=!1;!0===$('input[name="advert_title"]').prop("checked")&&(r=!0);let h=!1;$('input[name="advert_enable"]').length>0&&!0===$('input[name="advert_enable"]').prop("checked")&&(h=!0);var l="";!0===$("#title_private").prop("checked")&&(l=$("#date_title_time").val());var c="",_="",d="";if($('[name="voting_question_name"]').length>0&&""!==$('[name="voting_question_name"]').val()){c=$('[name="voting_question_name"]').val(),_=$('input[name="voting_answer[]"]').map((function(){if($(this).val().length>0)return $(this).val()})).toArray(),d=$('input[name="voting_type"]:checked').val();var m=[];if(_.forEach((function(t,e){-1==m.indexOf(t.toLowerCase().trim())&&m.push(t.toLowerCase().trim())})),m.length!=_.length)return alert("Варианты ответов должны различаться"),forum_status_save=!1,!1}var u=0;$('input[name="editor_greeting"]').length>0&&(u=$('input[name="editor_greeting"]').prop("checked"));var p=0;$("#voting_file_preview").length>0&&(p=parseInt($("#voting_file_preview").val()));var v=0;if($('select[name="group_id"]').length>0&&(v=parseInt($('select[name="group_id"]').val())),""===$("#g-recaptcha-response").val())return void alert("Укажите что Вы не робот. Роботы нам здесь не нужны.");var g=$("#g-recaptcha-response").val();$("#title_status_save").html('Проверяется уникальность публикации, пожалуйста, подождите... <img src="https://s.9111s.ru/img/preloader_rolling_32px.gif">'),$("#button_topic_group_create").fadeOut(200),$.ajax({type:"POST",dataType:"json",url:"/ajax_server/forum/add_titles.php",cache:!1,data:{articles_type:t,title_name:e,komm:a,tags:o,only_urist:s,voting:c,voitng_answers:_,voting_type:d,greeting:u,voting_foto:p,rubric_id:n,advert_title:r,group_id:v,date_title_time:l,advert_enable:h,description:i,token:ru9111.token,recaptcha:g},success:function(e){1===e.param?(localStorage.removeItem("lite_editor_tmp"),4===t?($(".add_form_header").remove(),$("#title_status_save").html(""),$("h1").html("Публикация успешно создана"),$("#form_create_topic_group").html('<div style="padding:15px 0" id="voting_content'+e.title_id+'"></div>'),voting_show_form(e.title_id,2),$("#voting_content"+e.title_id).after('<a class="btn btn_blue-grd" href="'+e.msg+'">Пропустить</a>')):window.location.replace(e.msg)):0===e.param&&(forum_status_save=!1,alert(e.msg),$("#title_status_save").html(""),$("#button_topic_group_create").fadeIn(200))}})}}function addVotingOption(t){t.before('<div class="df ai-c mb10"><input autocomplete="off" type="text" name="voting_answer[]" class="p10 brs4 votingInput flex-pusher"><span class="btn btn_grey btn_xs ml10" onclick="delVotingOption($(this));">X</span></div>')}function delVotingOption(t){$('[name="voting_answer[]"]').length>2&&t.parent("div").remove()}function savePubs(t){if("title"!==t&&"voting"!==t)return;myLiteEditor.submitEditor();let e=$("#topic_name").text();if(e.length<5)return void new PopUper({title:"Минимальная длина заголовка",body:"Заголовок должен быть не менее 5 символов",style:"notify",controls:[{title:"OK",enter:!0}]});if(-1!==e.toLowerCase().indexOf("http"))return void new PopUper({title:"Ссылки запрещены",body:"Запрещено вставлять ссылки в заголовок",style:"notify",controls:[{title:"OK",enter:!0}]});if(!1===cntUpChars(e))return!1;let n=0;if("title"===t){if(n=parseInt($('select[name="rubric_id"]').val()),isNaN(n)&&(n=parseInt($("#rubric_id").val())),0===n)return void new PopUper({title:"Рубрика",body:"Необходимо выбрать рубрику",style:"notify",controls:[{title:"OK",enter:!0}]})}else"voting"===t&&(n=7975778);let i="";"title"===t&&$('textarea[name="title_description"]').length>0&&(i=$('textarea[name="title_description"]').val());let a=$('textarea[name="komm"]').val();if("title"===t&&0===a.length)return void new PopUper({title:"Текст публикации",body:"Текст не должен быть пустым",style:"notify",controls:[{title:"OK",enter:!0}]});let o="";"title"===t&&$('input[name="tag_list_input"]').length>0&&(o=$('input[name="tag_list_input"]').val());let s=!1;!0===$('input[name="topic_on_off"]').prop("checked")&&(s=!0);let r=!1;!0===$('input[name="advert_title"]').prop("checked")&&(r=!0);let l=!1;$('input[name="advert_enable"]').length>0&&!0===$('input[name="advert_enable"]').prop("checked")&&(l=!0);let c="";!0===$("#title_private").prop("checked")&&(c=$("#date_title_time").val());let _="";"voting"===t?_=e:$('input[name="voting_question_name"]').length>0&&(_=$('input[name="voting_question_name"]').val());let d="",m="",u=0;if("title"===t&&$('select[name="group_id"]').length>0&&(u=$('select[name="group_id"]').val()),""!==_){d=$('input[name="voting_answer[]"]').map((function(){if(""!==$(this).val())return $(this).val()})).get(),m=$('input[name="voting_type"]:checked').val();var p=[];if(d.forEach((function(t,e){-1==p.indexOf(t.toLowerCase().trim())&&p.push(t.toLowerCase().trim())})),p.length!=d.length)return void alert("Варианты ответов должны различаться");if(d.length<2)return void alert("Текст не должен быть пустым");if("title"===t&&0==$('input[name="voting_question_name"]').length)return void alert("Заголовок опроса не должен быть пустым")}$("#title_status_save").html('Сохраняем, пожалуйста, подождите... <img src="https://s.9111s.ru/img/preloader_rolling_32px.gif">'),$("#button_create_pubs").prop("disabled",!0),$.ajax({type:"POST",dataType:"json",url:"/ajax_server/forum/added/pubs.php",cache:!1,data:{mode:t,title_name:e,title_description:i,komm:a,rubric_id:n,group_id:u,voting_question:_,voting_answers:d,voting_type:m,tags:o,only_urist:s,advert_enable:l,advert_title:r,date_title_time:c,token:ru9111.token},success:function(t){!0===t.success?(localStorage.removeItem("lite_editor_tmp"),void 0!==t.url&&""!==t.url&&window.location.replace(t.url)):!1===t.success&&(alert(t.msg),$("#title_status_save").html(""),$("#button_create_pubs").prop("disabled",!1))},error:function(t){alert("Ошибка!"+t),$("#button_create_pubs").prop("disabled",!1)}})}function alertAdd(t,e){e.after('<div class="form_error_add">'+t+"</div>");var n=$(".form_error_add");setTimeout((function(){n.remove()}),1e3)}function wsForumNewMsg(t){if("to_right_col"===t.type){if(1===$("#right_sitenews_u").length){var e=$("#right_sitenews_u .rightcol_news_list_item").last();$("#right_sitenews_u .rightcol_news_list_item").last().remove();var n=new Date,i=n.getHours();i<10&&(i="0"+i);var a=n.getMinutes();a<10&&(a="0"+a),e.find(".rightcol_news_list_item__date").html(i+":"+a),e.find(".rightcol_news_list_item__title").html(t.title),e.find(".rightcol_news_list_item__cnt").html(`<a href="${t.url}" class="btn btn_xs btn_yellowLight" onclick="statClicks('RIGHTCOL_COMMENTS_BTN');"><svg class="icon--12 mr5 fill--grey"><use href="#message"></use></svg>${t.msg_cnt} комментариев</a>`),e.find("a").attr("href",t.url),$("#right_sitenews_u").prepend(e)}}else"to_title"===t.type&&1===$("#comments").length&&$("#forum_content").data("forumId")===t.title_id&&$("#comments").prepend(t.text)}function titleRatingGetListVote(t){void 0!==t&&t>0&&$.ajax({dataType:"json",type:"GET",url:"/ajax_server/forum/title_rating.php",cache:!1,data:{mode:"get_rating_list",title_id:t},success:function(t){}})}function changeCnt(t,e,n){count=parseInt(e);var i=$("#cnt"+n).data().notvoted;if(i){if($("#cnt"+n).data().notvoted=!1,i=!1,t)var a=count+1;else a=count-1;$("#cnt"+n).text(a)}}let get_more_comments_loaded=!1;function getMoreComments(t=0){if(t>0&&!1===get_more_comments_loaded){$("#m"+t).children(".comment__children").append('<div id="preloader_comments'+t+'">Загрузка...</div>'),get_more_comments_loaded=!0;let e=$("#m"+t),n=e.data("cid")||0,i=e.data("level")||0,a=e.find(".comment__children").find(`.comment_item[data-level="${i+1}"]`).length||0;$("#show_hidden_btn"+t).remove(),$.ajax({type:"get",url:"/ajax_server/forum/get_more_comments.php",data:{mode:"load_answers",msg_id:t,last_id:n,level:i,offset:a},success:function(e){$("#preloader_comments"+t).remove(),$("#m"+t).children(".comment__children").append(e),$("#m"+t).children(".comment__children").hasClass("empty")&&$("#m"+t).children(".comment__children").removeClass("empty"),get_more_comments_loaded=!1}})}}let comments_loaded=!1;function getTopicComments(t=0,e,n){if(!0===n&&(comments_loaded=!1),t>0&&!1===comments_loaded){$("#topic_comments_load_more_button").fadeIn(100),$("#get_topic_comments_button").fadeIn(100),comments_loaded=!0,void 0===e&&(e=0);var i={only_subscribe:0,only_urists:0,only_my:0,sort_type:0};!0===$("#only_my").prop("checked")&&(i.only_my=1,i.only_subscribe=0,i.only_urists=0),!0===$("#only_subscribe").prop("checked")&&(i.only_subscribe=1,i.only_urists=0,i.only_my=0),!0===$("#only_urists").prop("checked")&&(i.only_urists=1,i.only_subscribe=0,i.only_my=0),i.sort_type=2,$(".msg_sort_button.is-selected").length>0&&(i.sort_type=parseInt($(".msg_sort_button.is-selected").data("msgSortType"))),e>0&&(i.sort_type=0);var a=$(".comment_item__root").length||0;void 0===n?(n=!1,$("#comments").append('<div class="p20 tac fs18" id="forum_comments_loaded">Комментарии загружаются, ждите...</div>')):(a=0,n=!0,$("#comments").html('<div class="p20 tac fs18" id="forum_comments_loaded">Комментарии загружаются, ждите...</div>')),0===e&&!0===n&&""!==getHash()&&removeHash(),$.ajax({type:"get",url:"/ajax_server/forum/get_more_comments.php",data:{mode:"load_comments",topic_id:t,find_post_id:e,count_elem:a,params:i},success:function(t){""!==t?(!0===n||e>0?$("#comments").html(t):$("#comments").append(t),comments_loaded=!1):($("#topic_comments_load_more_button").fadeOut(100),$("#bottom_editor_cont").show()),$("#forum_comments_loaded").remove()},complete:function(){if(!1===comments_loaded){let t=parseInt($("#forum_content .comment_item").length),e=parseInt($("#forum_content").data("forumMsgCntTotal"));e-t>0?$("#topic_comments_load_more_button span").html(e-t):$("#topic_comments_load_more_button").fadeOut(100)}e>0&&$("#m"+e).length>0&&$("html, body").animate({scrollTop:$("#m"+e).offset().top},300),replaceYouTubeImage()}})}}let title_view_anal_insert_status=!1;function titleViewAnalInsert(t=0){return t>0&&!1===title_view_anal_insert_status&&(title_view_anal_insert_status=!0,$.ajax({cache:!1,type:"POST",url:"/api/analytics/view.php",dataType:"json",data:{content_type:1,obj_id:t,referrer:document.referrer,url:window.location.href},success:function(e){""!==e.mng_id&&(title_view_anal.title_id=t,title_view_anal.mng_id=e.mng_id)}})),""}window.addEventListener("pagehide",titleViewAnalUpdate,!1);let title_view_anal={title_id:0,mng_id:""},counterView=0;function titleViewAnalUpdate(){if(""!==title_view_anal.mng_id&&title_view_anal.title_id>0&&counterView>=20){let t=new FormData;t.append("mng_id",title_view_anal.mng_id),t.append("obj_id",title_view_anal.title_id);let e=0;$("div[id^='adfox']").each((function(t,n){$(n).is(":visible")||$(n).parent().hasClass("yac")&&e++})),t.append("has_adblock",e),t.append("counter_view",counterView),navigator.sendBeacon("/api/analytics/view.php",t)}}function voting_forum(t,e){if($("#voting_ajax_status"+t).hide(),void 0===e)var n=$("#voting_container"+t+" #voting_forum_list"+t+" input:checked").map((function(){return $(this).val()})).toArray();else n=[e];n.length>0?($("#voting_ajax_status"+t).html("Обрабатываем ваш голос...").fadeIn(200),$.ajax({dataType:"json",type:"POST",url:"/ajax_server/forum/ajax_voting_forum.php",cache:!1,data:{id:"voting",id_vote:t,votes:n},success:function(e){1===e.param?$("#voting_container"+t).fadeOut(250,(function(){$("#voting_container"+t).html(e.message).fadeIn(250,(function(){add_coin1(100),socialShare.init()}))})):0===e.param?$("#voting_ajax_status"+t).html(e.message).fadeIn(200):2===e.param&&($("#voting_container"+t).fadeOut(250,(function(){$("#voting_container"+t).html(e.message).fadeIn(250),add_coin1(100),socialShare.init()})),"survey_day"===site_vars.catalogs[2]&&0===$("#forum_content").length&&void 0!==e.url&&(e.url,window.location.href))}})):$("#voting_ajax_status"+t).html("Не выбран вариант ответа!").fadeIn(200)}function voting_show_form(t,e){if(void 0===e)e=2;""!==$("#voting_content"+t).html()?$("#voting_content"+t).fadeOut(250,(function(){$("#voting_content"+t).html("")})):($("#voting_button_create"+t).fadeOut(100),$.ajax({dataType:"json",type:"GET",url:"/ajax_server/forum/ajax_voting_forum.php",cache:!1,data:{id:"show_form",page_id:t,type:e},success:function(e){1===e.param?$("#voting_content"+t).fadeOut(250,(function(){$("#voting_content"+t).html(e.message).fadeIn(250)})):0===e.param&&alert(e.message)}}))}function forumTitleUp(t=0){new PopUper({title:"Поднять публикацию",body:"Поднять публикацию в лентах?<br> \nС Вашего баланса публикаций будет списано 50 рублей",style:"notify",controls:[{title:"Оплатить размещение",action:()=>{$.ajax({type:"POST",url:"/ajax_server/post_json.php",cache:!1,dataType:"json",data:{mode:"forum_title_up",title_id:t},success:function(t){t.success,alert(t.message)}})},enter:!0}]})}function forumMessageUp(t=0){new PopUper({title:"Оплата комментария",body:"Поднять комментарий на первое место? С ВАШЕГО БАЛАНСА БУДЕТ СПИСАНО 30 рублей.",style:"notify",controls:[{title:"Поднять комментарий",action:()=>{$.ajax({type:"POST",url:"/ajax_server/post_json.php",cache:!1,dataType:"json",data:{mode:"forum_comment_up",msg_id:t},success:function(t){!0===t.success?(alert(t.message),document.location.reload()):alert(t.message)}})},enter:!0}]})}function show_voting_list(t){$("#voting_container"+t+" #voting_result_container").html("Результаты загружаются. Ждите..."),statClicks("article_voting_result"),$.ajax({type:"GET",url:"/ajax_server/forum/ajax_voting_forum.php",cache:!1,data:{id:"show_voting_list",page_id:t},success:function(e){var n=$("#voting_container"+t+" #voting_result_container");n.html(e),$.fancybox.open(n,{touch:!1})}})}function saveBlockEditorPubs(t,e=""){if("title"!==e&&"voting"!==e&&"group"!==e)return;if(void 0!==convert_timers&&convert_timers.length>0)return void alert("Видео обрабатывается, дождитесь завершения");let n=t.getContent(),i=$("#topic_name").text();if(i.length<5)return void new PopUper({title:"Минимальная длина заголовка",body:"Заголовок должен быть не менее 5 символов",style:"notify",controls:[{title:"OK",enter:!0}]});if(-1!==i.toLowerCase().indexOf("http"))return void new PopUper({title:"Ссылки запрещены",body:"Запрещено вставлять ссылки в заголовок",style:"notify",controls:[{title:"OK",enter:!0}]});if(!1===cntUpChars(i))return!1;let a=0;if("title"===e){if(a=parseInt($('select[name="rubric_id"]').val()),isNaN(a)&&(a=parseInt($("#rubric_id").val())),0===a)return void new PopUper({title:"Рубрика",body:"Необходимо выбрать рубрику",style:"notify",controls:[{title:"OK",enter:!0}]})}else"voting"===e&&(a=7975778);let o="";if("title"===e&&$('textarea[name="title_description"]').length>0&&(o=$('textarea[name="title_description"]').val()),("title"===e||"group"===e)&&0===n.length)return void new PopUper({title:"Минимальная длина текста",body:"Текст не должен быть пустым",style:"notify",controls:[{title:"OK",enter:!0}]});let s="";"title"===e&&$('input[name="tag_list_input"]').length>0&&(s=$('input[name="tag_list_input"]').val());let r=!1;!0===$('input[name="topic_on_off"]').prop("checked")&&(r=!0);let l=!1;!0===$('input[name="advert_title"]').prop("checked")&&(l=!0);let c=!1;$('input[name="advert_enable"]').length>0&&!0===$('input[name="advert_enable"]').prop("checked")&&(c=!0);let _="";!0===$("#title_private").prop("checked")&&(_=$("#date_title_time").val());let d="";"voting"===e?d=i:$('input[name="voting_question_name"]').length>0&&(d=$('input[name="voting_question_name"]').val());let m="",u="",p=0;if("title"===e&&$('select[name="group_id"]').length>0?p=$('select[name="group_id"]').val():"group"===e&&$("#group_discussions").length>0&&(p=$("#group_discussions").val()),""!==d){m=$('input[name="voting_answer[]"]').map((function(){if(""!==$(this).val())return $(this).val()})).get(),u=$('input[name="voting_type"]:checked').val();let t=[];if(m.forEach((function(e,n){-1===t.indexOf(e.toLowerCase().trim())&&t.push(e.toLowerCase().trim())})),t.length!==m.length)return void alert("Варианты ответов должны различаться");if(m.length<2)return void alert("Текст не должен быть пустым")}$("#title_status_save").html('Сохраняем, пожалуйста, подождите... <img src="https://s.9111s.ru/img/preloader_rolling_32px.gif">'),$("#button_create_pubs").prop("disabled",!0),$.ajax({type:"POST",dataType:"json",url:"/ajax_server/forum/added/pubs.php",cache:!1,data:{mode:e,title_name:i,title_description:o,content:n,rubric_id:a,group_id:p,voting_question:d,voting_answers:m,voting_type:u,tags:s,only_urist:r,advert_enable:c,advert_title:l,date_title_time:_,token:ru9111.token},success:function(t){!0===t.success?(localStorage.removeItem("lite_editor_tmp"),void 0!==t.url&&""!==t.url&&window.location.replace(t.url)):!1===t.success&&(alert(t.msg),$("#title_status_save").html(""),$("#button_create_pubs").prop("disabled",!1))},error:function(t,e){alert("Ошибка: "+t.status+"["+e+"]"),$("#button_create_pubs").prop("disabled",!1)}})}function cntUpChars(t){var e=!0;if(null!==t&&""!==t){var n=0,i=t.match(/[A-ZА-ЯЁ]/g);null!==i&&(n=i.length),n/t.length>=.5&&t.length>=10&&(new PopUper({title:"Оформление заголовка",body:"НЕ ПИШИТЕ КАПСОМ",style:"notify",controls:[{title:"OK",enter:!0}]}),e=!1)}return e}function showVotingForm(){$("#voting_create").is(":visible")?($("#voting_create").hide(100),text="Добавить опрос / голосование"):($("#voting_create").show(100),text="Отменить опрос / голосование"),$("#make_voting").text(text)}$(document).ready((function(){setInterval((()=>{"visible"===document.visibilityState&&counterView++}),1e3)})),document.addEventListener("DOMContentLoaded",(()=>{let t;if(symbolsCounter(".commentQuanity",".addComment textarea"),t=$("#rubric_id2").length>0?document.querySelector("#rubric_id2"):document.querySelector("#rubric_id"),t){let e=document.querySelector("#rubric_id"),n=document.querySelector(".underRubricsBlock");e&&t.addEventListener("change",(()=>{let i=`<option value="${t.value}">Выбрать</option>`,a=!1;rubricsArray.forEach((e=>{e[2]===t.value&&t.value>0&&(i+=`<option value="${e[0]}">${e[1]}</option>`,a=!0)})),a?n.classList.remove("dn"):n.classList.add("dn"),e.innerHTML=i}))}document.addEventListener("click",(t=>{if(t.target.closest(".editor__button_send")){let e=t.target.closest(".editor__button_send");e.closest(".pageBlock--RoboChat")&&statClicks("editor__send_top"),e.closest("#bottom_editor")&&statClicks("editor__send_bottom")}t.target.closest(".btn--home")&&(document.referrer.indexOf("pubs")>-1?window.location.href=document.referrer:window.location.href="/")}))})),$(document).on("click",".comment_fast_anwswer__btn",(t=>{let e=t.target.closest(".comment_fast_anwswer");if(e){let t=parseInt($(e).data("forumId")),n=$(e).find("textarea").val();t>0&&""!=n&&$.ajax({dataType:"json",type:"POST",url:"/ajax_server/forum/save_message_forum.php",cache:!1,data:{id_page:t,message:n,type:"ajax"},success:function(t){5===t.param&&($(e).replaceWith(t.content),statClicks("forum_fast_answer"))}})}})),$(document).on("click",".forum_complaint",(function(){let t=$(this).closest(".comment_item").data("cid");ru9111.id>0&&t>0?forumMsgComplaint(t):confirm("Чтобы пожаловаться на комментарий необходимо зарегистрироваться или залогиниться")&&loginedForm("in")})),$(document).on("click",".comment__children__expand",(function(){let t=$(this).prev(".comment__children");t&&$(this).fadeOut(100,(function(){$(t).slideDown(150)}))})),$(document).on("click",".comment__children__collapse",(function(){let t=$(this).closest(".comment__children"),e=$(t).next(".comment__children__expand");t&&e&&$(t).slideToggle(250,(function(){e&&$(e).fadeIn(100);let n=$(t).closest(".comment_item").data("cid");n&&$("html, body").animate({scrollTop:$("#m"+n).offset().top-50},500)}))}));
</script>

</body>
</html>
