<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>mce_cart_cn-47c545db78d191183609983decfc3c8e.html</title>
</head>
<body>

<script>
var priceType = "￥";
var cartFreeSampleNumber =0;
var userOrderFreeSampleNumber =0;

function jsSelectItemByValue(objSelect, objItemText) {
    var isExit = false;
    if (objSelect && objSelect.options && objSelect.options.length) {
        for (var i = 0; i < objSelect.options.length; i++) {
            if (objSelect.options[i].text == objItemText) {
                objSelect.options[i].selected = true;
                isExit = true;
                break;
            }
        }
    }
}



function addToCartSrc(srcCart, chooserNumber){
    var mce_cart_cn_str = "";
    if(typeof($.cookie("mce_cart_cn"))=="undefined"){
        $.cookie("mce_cart_cn", "", {expires: 7, path: "/"});
    }else{
        mce_cart_cn_str = $.cookie("mce_cart_cn");
    }
    if(typeof($.cookie("mce_cart_cn_price_type"))=="undefined"){
        $.cookie("mce_cart_cn_price_type", "￥", {expires: 7, path: "/"});
    }

    if(typeof($.cookie("mce_country_name"))=="undefined"){
        $.cookie("mce_country_name", "United States", {expires: 7, path: "/"});
    }else if($.trim($.cookie("mce_country_name"))==""){
        $.cookie("mce_country_name", "United States", {expires: 7, path: "/"});
    }

    if(chooserNumber > 0 ){
        if (srcCart != '') {
            var cart_str_1 = "";
            cart_str_1 = srcCart.replace(/[\n]/ig,'').replace(/[\t]/ig,'');
            if(mce_cart_cn_str==""){
                mce_cart_cn_str = cart_str_1 +";" + chooserNumber;
            }else{
                var carPro = cart_str_1.split(";");
                mce_cart_cn_str.indexOf(carPro[1]+";"+carPro[2]+";")>-1?mce_cart_cn_str=mce_cart_cn_Verification(mce_cart_cn_str,carPro[1]+";"+carPro[2]+";",chooserNumber, carPro[6], carPro[7]):mce_cart_cn_str = mce_cart_cn_str +"|"+ cart_str_1 +";" + chooserNumber;
            }
        }


        if(mce_cart_cn_str!=""){
            $.cookie('mce_cart_cn',mce_cart_cn_str.replace("test",""), {expires: 7, path: "/"});
        }
        mce_cart_cn_update();
        document.getElementById('cp_div').style.display="block";
        window.updateCnUserCart();
        mask_cart = 1;
    } else{
        //showDiv("proMaskCon-cart-message");
    }
}


function add_free_cart() {
    var cart_str = "";

    cart_str = document.getElementById("pro_cart_mg_free").value.replace(/[\n]/ig,'').replace(/[\t]/ig,'');
    var mce_cart_cn_str = "";
    if(typeof($.cookie("mce_cart_cn"))=="undefined"){
        $.cookie("mce_cart_cn", "", {expires: 7, path: "/"});
    }else{
        mce_cart_cn_str = $.cookie("mce_cart_cn");
    }
    if(cart_str.indexOf("Free Sample")>-1){
        if(mce_cart_cn_str.indexOf(cart_str)==-1){
            if(mce_cart_cn_str==""){
                mce_cart_cn_str = cart_str +";" + 1;
            }else{
                var carPro = cart_str.split(";");
                mce_cart_cn_str.indexOf(carPro[1]+";"+carPro[2]+";")>-1?mce_cart_cn_str=mce_cart_cn_Verification(mce_cart_cn_str,carPro[1]+";"+carPro[2]+";",1, carPro[6], carPro[7]):mce_cart_cn_str = mce_cart_cn_str +"|"+ cart_str +";" +1;
            }
        }
    }

    if(mce_cart_cn_str!=""){
        //alert($.cookie('mce_cart_cn'));
        $.cookie('mce_cart_cn',mce_cart_cn_str.replace("test",""), {expires: 7, path: "/"});
    }

    mce_cart_cn_update();
    //document.getElementById('cp_div').style.display="block";
    mask_cart = 1;

    location.href = getProjectUrl()+"/cartList.html?id="+new Date().getTime();
}

function add_to_cart(){
    var mce_cart_cn_str = "";
    if(typeof($.cookie("mce_cart_cn"))=="undefined"){
        $.cookie("mce_cart_cn", "", {expires: 7, path: "/"});
    }else{
        mce_cart_cn_str = $.cookie("mce_cart_cn");
    }
    if(typeof($.cookie("mce_cart_cn_price_type"))=="undefined"){
        $.cookie("mce_cart_cn_price_type", "￥", {expires: 7, path: "/"});
    }

    if(typeof($.cookie("mce_country_name"))=="undefined"){
        $.cookie("mce_country_name", "United States", {expires: 7, path: "/"});
    }else if($.trim($.cookie("mce_country_name"))==""){
        $.cookie("mce_country_name", "United States", {expires: 7, path: "/"});
    }

    var cart_1 = null;
    var cart_2 = null;

    cart_1 = document.getElementsByName("pro_cart_dw_num");
    cart_2 = document.getElementsByName("pro_cart_mg_num");
    let isCheckCCki8 = false;

    var cart_check = mce_cart_cn_add_check(cart_1,cart_2);
    if(cart_check>0){
        if(cart_1!=null){
            for(i=0;i<cart_1.length;i++){
                if(cart_1[i].value>0){
                    var cart_str_1 = "";
                    cart_str_1 = document.getElementById("pro_cart_dw_"+i).value.replace(/[\n]/ig,'').replace(/[\t]/ig,'');
                    if(mce_cart_cn_str==""){
                        mce_cart_cn_str = cart_str_1 +";" + cart_1[i].value;
                    }else{
                        var carPro = cart_str_1.split(";");
                        mce_cart_cn_str.indexOf(carPro[1]+";"+carPro[2]+";")>-1?mce_cart_cn_str=mce_cart_cn_Verification(mce_cart_cn_str,carPro[1]+";"+carPro[2]+";",cart_1[i].value, carPro[6], carPro[7]):mce_cart_cn_str = mce_cart_cn_str +"|"+ cart_str_1 +";" +cart_1[i].value;
                    }
                }
            }
        }

        if(cart_2!=null){
            for(var i=0;i<cart_2.length;i++){
                if(cart_2[i].value>0){
                    var cart_str_2 = "";
                    cart_str_2 = document.getElementById("pro_cart_mg_"+i).value.replace(/[\n]/ig,'').replace(/[\t]/ig,'');
                    if (cart_str_2.indexOf('5 mL x 24;HY-K0301') > -1) {
                        isCheckCCki8 = true;
                    }
                    if(cart_str_2.indexOf("Free Sample")>-1){
                        if(mce_cart_cn_str.indexOf(cart_str_2)==-1){
                            if(mce_cart_cn_str==""){
                                mce_cart_cn_str = cart_str_2 +";" + cart_2[i].value;
                            }else{
                                var carPro = cart_str_2.split(";");
                                mce_cart_cn_str.indexOf(carPro[1]+";"+carPro[2]+";")>-1?mce_cart_cn_str=mce_cart_cn_Verification(mce_cart_cn_str,carPro[1]+";"+carPro[2]+";",cart_2[i].value, carPro[6], carPro[7]):mce_cart_cn_str = mce_cart_cn_str +"|"+ cart_str_2 +";" +cart_2[i].value;
                            }
                        }
                    }else{
                        if(mce_cart_cn_str==""){
                            mce_cart_cn_str = cart_str_2 +";" + cart_2[i].value;
                        }else{
                            var carPro = cart_str_2.split(";");
                            mce_cart_cn_str.indexOf(carPro[1]+";"+carPro[2]+";")>-1?mce_cart_cn_str=mce_cart_cn_Verification(mce_cart_cn_str,carPro[1]+";"+carPro[2]+";",cart_2[i].value, carPro[6], carPro[7]):mce_cart_cn_str = mce_cart_cn_str +"|"+ cart_str_2 +";" +cart_2[i].value;
                        }
                    }
                }

            }
        }

        if(mce_cart_cn_str!=""){
            $.cookie('mce_cart_cn',mce_cart_cn_str.replace("test",""), {expires: 7, path: "/"});
        }
        if (isCheckCCki8) {
            checkCCK85ml24();
        }
        mce_cart_cn_update();
        window.updateCnUserCart();
        document.getElementById('cp_div').style.display="block";
        mask_cart = 1;
    }else{
        //showDiv("proMaskCon-cart-message");
    }
    var cart_num=$(".cart-quSel");
    for ( var i = 0; i < cart_num.length; i++) {
        if(cart_num[i].value>0){
            for(j=0;j<cart_num[i].length;j++){
                if(cart_num[i][j].value==0){
                    cart_num[i][j].selected = true;
                }
            }
        }
    }

}


function mce_cart_cn_add_check(cart_1,cart_2){
    var check_num = 0;

    var cart_check_1 = cart_1;
    var cart_check_2 = cart_2;

    if(cart_check_1!=null){
        for(var i=0;i<cart_check_1.length;i++){
            if(cart_check_1[i].value>0){
                //alert(cart_check_1[i].value);
                check_num = 1;
                break;
            }
        }
    }

    if(cart_check_2!=null){
        for(var i=0;i<cart_check_2.length;i++){
            if(cart_check_2[i].value>0){
                check_num = 1;
                break;
            }
        }
    }

    return check_num;
}

function mce_cart_cn_Verification(mce_cart_cn_str,cart_str,pro_num, sh_stocK, us_stock){
   // alert(cart_str);
    var cart_size = cart_str.substring(0,cart_str.indexOf(";"));
    if(mce_cart_cn_str.indexOf(cart_str)>-1){
        var carts = mce_cart_cn_str.split("|");
        var mce_cart_cn_str_1 = "";
        if(carts.length>0){
            for(var i=0;i<carts.length;i++){
                if(carts[i].indexOf(cart_str)>-1){
                    var cart_pro = carts[i].split(";");
                    if(parseInt(cart_size)/parseInt(cart_pro[1])==1){
                        cart_pro[8] = parseInt(cart_pro[8]) + parseInt(pro_num);
                        cart_pro[6] = sh_stocK;
                        cart_pro[7] = us_stock;
                        carts[i] = cart_pro.join(";");
                    }
                }
            }
            mce_cart_cn_str_1 = carts.join("|");
        }
    }
    return mce_cart_cn_str_1;
}

function mce_cart_cn_update(){
    //alert($.cookie("mce_country_name"));
    var mce_cart_cn_proList = $.cookie("mce_cart_cn").split("|");
    var mce_cart_cn_proList_num = 0;
    $.cookie("mce_cart_cn")!=""?mce_cart_cn_proList_num = mce_cart_cn_proList.length:mce_cart_cn_proList_num=0;
    var mce_cart_cn_priceSum = 0;
    var mce_cart_cn_priceType = "￥";
    var mce_cart_cn_pro_str = "";

    if(mce_cart_cn_proList_num>0){
        var mce_cart_cn_pro_str = "<div class='pgt_cart_arrow'><span></span></div><div class='pgt_cart_hd'><table><tr><th class='pgt_cart_list_1'>Product Name</th><th class='pgt_cart_list_2'>Size / Unit Price</th><th class='pgt_cart_list_3'>Qty</th></tr></table></div>";
        mce_cart_cn_pro_str += "</table></div>";

        mce_cart_cn_pro_str += "<div class='pgt_cart_list'><table>";
        for(var i=0;i<mce_cart_cn_proList_num;i++){
            if(mce_cart_cn_proList[i]!=null && mce_cart_cn_proList[i]!=""){
                var cart_pro_list = mce_cart_cn_proList[i].split(";");
                var pro_price;
                if($.trim($.cookie("mce_country_name"))=="Japan"){
                    pro_price ='￥'+ (parseInt(cart_pro_list[3].replace("￥", ""))*1.3).toFixed();
                }else{
                    pro_price =  cart_pro_list[3];
                }

                mce_cart_cn_pro_str = mce_cart_cn_pro_str + "<tr>"
                    + "<td class='pgt_cart_list_1'><a href='"+getProjectUrl()+"/"+getTableCartProUrl(cart_pro_list[2],cart_pro_list[4])+".html'>" + cart_pro_list[0].replace('_l_alpha_r_','α').replace('_l_beta_r_','β').replace('_l_gamma_r_','γ')
                        .replace('_l_delta_r_','δ').replace('_l_epsilon_r_','ε').replace('_l_zeta_r_','ζ')
                        .replace('_l_eta_r_','η').replace('_l_theta_r_','θ').replace('_l_iota_r_','ι')
                        .replace('_l_kappa_r_','κ').replace('_l_lambda_r_','λ').replace('_l_mu_r_','μ')
                        .replace('_l_nu_r_','ν').replace('_l_xi_r_','ξ').replace('_l_omicron_r_','ο')
                        .replace('_l_pi_r_','π').replace('_l_rho_r_','ρ').replace('_l_sigma_r_','σ')
                        .replace("_l_tau_r_", "τ")
                        .replace("_l_upsilon_r_", "υ")
                        .replace("_l_phi_r_", "φ")
                        .replace("_l_chi_r_", "χ")
                        .replace("_l_psi_r_", "ψ")
                        .replace("_l_omega_r_", "ω")
                        .replace("_l_plusmn_r_", "±")
                        .replace("_l_addition_r_", "+")
                        .replace("_l_acute_r_", "'")
                        .replace('_l_','(').replace('_r_',')')
                    +"</a></td>";

                    if (cart_pro_list[1].indexOf("Free Sample")==-1) {
                        mce_cart_cn_pro_str = mce_cart_cn_pro_str + "<td class='pgt_cart_list_2'>"+cart_pro_list[1]+" / "+pro_price+"</td>"
                    }  else {
                        mce_cart_cn_pro_str = mce_cart_cn_pro_str + "<td class='pgt_cart_list_2'>Free Sample</td>"
                    }
                    mce_cart_cn_pro_str = mce_cart_cn_pro_str + "<td class='pgt_cart_list_3'>"+cart_pro_list[8]+"</td>"
                    + "</tr>";
            }
        }

        mce_cart_cn_pro_str += "</table></div><div class='pgt_cart_ftr'><table>";

        if(mce_cart_cn_proList_num>0){
            var curWwwPath=window.document.location.href;
            var pathName=window.document.location.pathname;
            var pos=curWwwPath.indexOf(pathName);
            var localhostPath=curWwwPath.substring(0,pos);
            var projectName=pathName.substring(0,pathName.substr(1).indexOf('/')+1);
            mce_cart_cn_pro_str += "<tr><th>"
                + "Total:  <span> "+getCartPriceSumCart()+"</span></th>"
                + "<td style='font-family:Arial, Helvetica, sans-serif; font-size:14px; font-weight:bold;'><a href='"+getProjectUrl()+"/cartList.html?id="+new Date().getTime()+"'>Checkout</a></td></tr>"
                + "</table></div>";
        }
    }

    //document.getElementById('cp_div').innerHTML = mce_cart_cn_pro_str;
    //document.getElementById('mceCartProNum').innerHTML = "("+mce_cart_cn_proList_num+")";

    $('#cp_div').html(mce_cart_cn_pro_str);
    $('#mceCartProNum').html("("+mce_cart_cn_proList_num+")");

    cartFreeSampleNumber = patch("Free Sample",$.cookie("mce_cart_cn"));
    //carProNumber  = mce_cart_cn_proList_num;
    //alert(carProNumber);
    if(typeof($("#emailCart"))!="undefined"){
        if($("#emailCart").val()==""){
            userOrderFreeSampleNumber = 0;
        }
    }

    if(parseInt(cartFreeSampleNumber)>3 && !isAgencyType){
        $("#freeMsg").html("同一机构（单位）同一产品试用装仅限申领一次，同一机构（单位）一年内可免费申领<b>三个不同产品</b>试用装。");
        $("#freeMsg").addClass("cart_fs_tips");
    }else{
        $("#freeMsg").html("");
        $("#freeMsg").removeClass("cart_fs_tips");

    }
    // if( (parseInt(cartFreeSampleNumber) +  parseInt(userOrderFreeSampleNumber) <= 3) || cartFreeSampleNumber==0){
    //     $("#cus_info_free_notice").html("");
    // }

    if(typeof($("#billTitle"))!="undefined"){
        if (cartFreeSampleNumber == mce_cart_cn_proList_num) {
            // $("#billTitle").hide();
            // $("#billType").hide();
            $("#billInformation").hide();
        } else {
            // $("#billTitle").show();
            // $("#billType").show();
            $("#billInformation").show();
        }
    }
}
window.mce_cart_cn_update = mce_cart_cn_update;

function deleteCartPro(cartProId){
    //var str_id = cartProId.replace(";","").replace(";","");
    var str_id = cartProId.replace(/;/g,"_");
    //replace(/\s+/g,"")
 	//	alert(str_id);
    var cart_tbody = document.getElementById('tbodyCartList');
    var cart_tr = document.getElementById('cartProInfoList_' + str_id);
    var cartProListPriceSum = "";
    var mce_cart_cn_str_1 = "";
    var delete_num = -1;
    let size = '';
    let catNo = '';
    var mce_cart_cn_str = $.cookie("mce_cart_cn");
    if(mce_cart_cn_str.indexOf(cartProId)>-1){
        var carts = mce_cart_cn_str.split("|");

        if(carts.length>0){
            for(var i=0;i<carts.length;i++){
                if(carts[i].indexOf(cartProId)>-1){
                    delete_num = i;
                    //alert(delete_num);
                    let cartPros = carts[i].split(";");
                    size = cartPros[1];
                    catNo = cartPros[2];
                }
            }
            if(delete_num>-1){
                carts.splice(delete_num, 1);
            }
            mce_cart_cn_str_1 = carts.join("|");
        }
    }

    cart_tbody.deleteRow(cart_tr.rowIndex);

    if($("#tbodyCartList tr").size()==0){
        $("#cart_list_tbl").hide();
    }

    $.cookie('mce_cart_cn',mce_cart_cn_str_1 ,{expires: 7, path: "/"});
    window.updateCartCheckProsDelete(size, catNo);
    cartProListPriceSum = getCartPriceSum();
    $('#cartProListPriceSum').html(cartProListPriceSum);
    mce_cart_cn_update();
    checkFreeSampleNumber();
    checkPromoCode();
    //getComplimentaryOffers();

    if (getCartPriceSum().replace("￥", "") == '0') {
        $("#mce_promocode_tr").hide();
        $("#mce_promocode").val("");
    }else{
        $("#mce_promocode_tr").show();
    }
    if(parseInt(cartProListPriceSum.replace("￥", "")) == 0){
        $("#cus_info_pay").hide();
        $("#cus_info_pay_dt").hide();
        $("#cus_info_bill").hide();
        $("#cus_info_bill_dt").hide();
    }else{
        $("#cus_info_pay").show();
        $("#cus_info_pay_dt").show();
        $("#cus_info_bill").show();
        $("#cus_info_bill_dt").show();
    }
    window.updateCnUserCart();
    window.marketCnActivity();
/*    window.getActivity11CartPros();
    window.getProteinExchange();*/
}

function changeProNum(cart_id,chang_Type){
    var pro_id = cart_id.replace(/;/g,"_");
    //alert(pro_id);
    var pro_num = parseInt(document.getElementById('cartProNum_' + pro_id).value);
    var pro_num_1 = pro_num;
    //alert(pro_num);
    var pro_price = document.getElementById('cartProPrice_' + pro_id).value;
    var mceCartPriceType = "￥";
    //alert(pro_id);
    //alert(chang_Type);
    mce_cart_cn_str_c = "";

    if(chang_Type=="-"){
        if(pro_num>1){
            pro_num = pro_num - 1;
        }else if(pro_num == 1){
            //showDiv("proMaskCon-cart-message-change");
        }
    }else if(chang_Type=="+"){
        pro_num = pro_num + 1;
        //alert(pro_num);
    }else if(chang_Type=="input"){
        pro_num = pro_num_1;
    }

    if (pro_num > 0) {
        let priceSum = 0;
        /*let strArr = cart_id.split(";");
        if ($.trim(strArr[2]) == 'HY-K0301' && $.trim(strArr[1]) == '5 mL x 24') {
            priceSum = getCCK85ml24(cart_id, pro_num);
        } else {
            priceSum = (parseFloat(pro_price.replace("￥",""))*pro_num).toFixed(2);
        }*/
        priceSum = (parseFloat(pro_price.replace("￥",""))*pro_num).toFixed(2);

        document.getElementById('cartProNum_' + pro_id).value = pro_num;
        document.getElementById('cartProInfoPriceSum_' + pro_id).innerHTML = "<strong>"+ mceCartPriceType + priceSum+"</strong>";
        $('#cartProInfoPriceSum_' + pro_id).html("<strong>"+ mceCartPriceType + priceSum+"</strong>");
        mce_cart_cn_str_c = getChangeProNuMCookieStr(cart_id,pro_num);

        if(mce_cart_cn_str_c!=""){
            $.cookie('mce_cart_cn',mce_cart_cn_str_c,{expires: 7, path: "/"});
            $('#cartProListPriceSum').html(getCartPriceSum());
            mce_cart_cn_update();
            //product_cart_list_update();
        }
    }
    checkPromoCode();
    updateCnUserCart();
    //getComplimentaryOffers();
    window.marketCnActivity();
    /*window.getActivity11CartPros();
    window.getProteinExchange();*/
}

function getCCK85ml24(cart_id, pro_num) {
    let cck8ItemPriceSum = ''
    if (cart_id != null && $.trim(cart_id) !== '') {
        let strArr = cart_id.split(";");
        if ($.trim(strArr[2]) == 'HY-K0301' && $.trim(strArr[1]) == '5 mL x 24') {
            let mce_cart_cn_str = $.cookie("mce_cart_cn");
            if (mce_cart_cn_str.indexOf(cart_id) > -1) {
                let carts = mce_cart_cn_str.split("|");
                let mce_cart_cn_str_1 = "";
                if (carts.length > 0) {
                    for (let i=0; i<carts.length; i++) {
                        if(carts[i].indexOf(cart_id)>-1){
                            let cart_pro = carts[i].split(";");
                            let dis = getUserCCK8Dis(pro_num);
                            cart_pro[3] = '￥' + parseFloat(cart_pro[5] * dis).toFixed(2);
                            cck8ItemPriceSum = parseFloat(cart_pro[5] * dis * pro_num).toFixed(2);
                            carts[i] = cart_pro.join(";");
                            let temp_cart_id = cart_id.replace(/;/g,"_");
                            let proPriceObj = document.getElementById('cartProPrice_' + temp_cart_id);
                            $(proPriceObj).val(cart_pro[3]);
                            let proPriceTempObj = $(document.getElementById('cartProInfoList_' + temp_cart_id)).find('.c_price').children('.tempPrice');
                            $(proPriceTempObj).html(cart_pro[3]);
                        }
                    }
                    mce_cart_cn_str_1 = carts.join("|");
                }
                if ($.trim(mce_cart_cn_str_1) !== '') {
                    $.cookie('mce_cart_cn',mce_cart_cn_str_1,{expires: 7, path: "/"});
                }
            }
        }
    }
    return cck8ItemPriceSum;
}


function checkCCK85ml24() {
    if (typeof($.cookie("mce_cart_cn"))!="undefined") {
        let mce_cart_cn_str = $.cookie("mce_cart_cn");
        if ($.trim(mce_cart_cn_str) !== '') {
            let carts = mce_cart_cn_str.split("|");
            let mce_cart_cn_str_1 = "";
            if (carts.length > 0) {
                for (let i=0; i<carts.length; i++) {
                    let cart_pro = carts[i].split(";");
                    if ($.trim(cart_pro[2]) == 'HY-K0301' && $.trim(cart_pro[1]) == '5 mL x 24') {
                        let dis = getUserCCK8Dis(cart_pro[8]);
                        cart_pro[3] = '￥' + parseFloat(cart_pro[5] * dis).toFixed(2);
                        carts[i] = cart_pro.join(";");
                    }
                }
                mce_cart_cn_str_1 = carts.join("|");
            }
            if ($.trim(mce_cart_cn_str_1) !== '') {
                $.cookie('mce_cart_cn',mce_cart_cn_str_1,{expires: 7, path: "/"});
            }
        }
    }
}


function changeProNum2(cart_id,chang_Type){
    var pro_id = cart_id.replace(/;/g,"_");
    //alert(pro_id);
    var pro_num = parseInt(document.getElementById('cartProNum_' + pro_id).value);
    var pro_num_1 = pro_num;
    //alert(pro_num);
    var pro_price = document.getElementById('cartProPrice_' + pro_id).value;
    var mceCartPriceType = "￥";
    //alert(pro_id);
    //alert(chang_Type);
    mce_cart_cn_str_c = "";

    if(chang_Type=="-"){
        if(pro_num>1){
            pro_num = pro_num - 1;
        }else if(pro_num == 1){
            //showDiv("proMaskCon-cart-message-change");
        }
    }else if(chang_Type=="+"){
        pro_num = pro_num + 1;
        //alert(pro_num);
    }else if(chang_Type=="input"){
        pro_num = pro_num_1;
    }
    //alert(pro_id);
    //alert(pro_num);
    if(pro_num > 0){
        var priceSum = parseInt(pro_price.replace("￥",""));
        document.getElementById('cartProNum_' + pro_id).value = pro_num;
        //document.getElementById('cartProInfoPriceSum_' + pro_id).innerHTML = mceCartPriceType + priceSum;
        $('#cartProInfoPriceSum_' + pro_id).html(mceCartPriceType + priceSum);
        mce_cart_cn_str_c = getChangeProNuMCookieStr(cart_id,pro_num);


        if(mce_cart_cn_str_c!=""){
            $.cookie('mce_cart_cn',mce_cart_cn_str_c,{expires: 7, path: "/"});
            $('#cartProListPriceSum').html(getCartPriceSum_update());
            product_cart_list_update_change();
        }

    }
    checkPromoCode_update();

}


function changeProCart(cart_id,chang_Type){
    var pro_id = cart_id.replace(/;/g,"_");
    //alert(pro_id);
    var pro_num = parseInt(document.getElementById('cartProNum_' + pro_id).value);
    var pro_num_1 = pro_num;
    //alert(pro_num);
    var pro_price = document.getElementById('cartProPrice_' + pro_id).value;
    var mceCartPriceType = "￥";
    //alert(pro_id);
    //alert(chang_Type);
    mce_cart_cn_str_c = "";

    if(chang_Type=="-"){
        if(pro_num>1){
            pro_num = pro_num - 1;
        }else if(pro_num == 1){
            //showDiv("proMaskCon-cart-message-change");
        }
    }else if(chang_Type=="+"){
        pro_num = pro_num + 1;
        //alert(pro_num);
    }else if(chang_Type=="input"){
        pro_num = pro_num_1;
    }
    //alert(pro_id);
    //alert(pro_num);
    if(pro_num > 0){
        var priceSum = parseInt(pro_price.replace("￥",""))*pro_num;
        document.getElementById('cartProNum_' + pro_id).value = pro_num;
        //document.getElementById('cartProInfoPriceSum_' + pro_id).innerHTML = mceCartPriceType + priceSum;
        $('#cartProInfoPriceSum_'+pro_id).html(mceCartPriceType + priceSum);
        mce_cart_cn_str_c = getChangeProNuMCookieStr2(cart_id,document.getElementById('updateSize_' + pro_id).value,document.getElementById('updatePrice_' + pro_id).value);


        if(mce_cart_cn_str_c!=""){
            $.cookie('mce_cart_cn',mce_cart_cn_str_c,{expires: 7, path: "/"});
            $('#cartProListPriceSum').html(getCartPriceSum_update());
            //mce_cart_cn_update();
            product_cart_list_update_change();
        }

    }
    checkPromoCode_update();

}

function getChangeProNuMCookieStr2(cart_id,size,price){
    //alert(cart_id+"---1-----"+size+"---2---"+price);
    var mce_cart_cn_str = $.cookie("mce_cart_cn");
    //alert(mce_cart_cn_str);
    if(mce_cart_cn_str.indexOf(cart_id)>-1){
        var carts = mce_cart_cn_str.split("|");
        var mce_cart_cn_str_1 = "";
        if(carts.length>0){
            for(var i=0;i<carts.length;i++){
                if(carts[i].indexOf(cart_id)>-1){
                    var cart_pro = carts[i].split(";");
                    cart_pro[3] = price;
                    cart_pro[1] = size;
                    //cart_pro[8] = parseInt(num);
                    carts[i] = cart_pro.join(";");
                }
            }
            mce_cart_cn_str_1 = carts.join("|");
        }
    }
    //alert(mce_cart_cn_str_1);
    return mce_cart_cn_str_1;

}


function getChangeProNuMCookieStr(cart_id,num){
    //alert(cart_id+"--------"+num);
    var mce_cart_cn_str = $.cookie("mce_cart_cn");
    //alert(mce_cart_cn_str);
    if(mce_cart_cn_str.indexOf(cart_id)>-1){
        var carts = mce_cart_cn_str.split("|");
        var mce_cart_cn_str_1 = "";
        if(carts.length>0){
            for(var i=0;i<carts.length;i++){
                if(carts[i].indexOf(cart_id)>-1){
                    var cart_pro = carts[i].split(";");
                    cart_pro[8] = parseInt(num);
                    carts[i] = cart_pro.join(";");
                }
            }
            mce_cart_cn_str_1 = carts.join("|");
        }
    }
    //alert(mce_cart_cn_str_1);
    return mce_cart_cn_str_1;

}

function getCartPriceSumCart(){
    var mceCartProListNum = 0;
    var mceCartPriceSum = "";
    var mceCartPriceSumUSD = 0;
    var mceCartPriceTypeUSD = "￥";

    if(typeof($.cookie("mce_cart_cn"))!="undefined") {
        var mceCartProList = $.cookie("mce_cart_cn").split("|");
        $.cookie("mce_cart_cn") != "" ? mceCartProListNum = mceCartProList.length : mceCartProListNum = 0;
        if (mceCartProListNum > 0) {
            for (var i = 0; i < mceCartProListNum; i++) {
                if (mceCartProList[i] != null && mceCartProList[i] != "") {
                    var cartProList = mceCartProList[i].split(";");
                    if (cartProList[3].indexOf("￥") > -1) {
                        var pro_price;
                        if ($.trim($.cookie("mce_country_name")) == "Japan") {
                            pro_price = '￥' + (parseFloat(cartProList[3].replace("￥", "")) * 1.3).toFixed();
                        } else {
                            pro_price = cartProList[3];
                        }
                        mceCartPriceSumUSD = mceCartPriceSumUSD + (parseFloat(pro_price.replace("￥", "")) * cartProList[8]);
                    }
                }
            }
        }

        if (mceCartPriceSumUSD > 0) {
            //let creditAmount = $('#mce_complimentary_offers').val();
            mceCartPriceSum = mceCartPriceSum + mceCartPriceTypeUSD + parseFloat(mceCartPriceSumUSD).toFixed(2);
        }

        if (mceCartPriceSum == "") {
            mceCartPriceSum = priceType + "0";
        }
    }
    return mceCartPriceSum;
}

function getCartPriceSum(){
    var mceCartProListNum = 0;
    var mceCartPriceSum = "";
    var mceCartPriceSumUSD = 0;
    var mceCartPriceTypeUSD = "￥";

    if(typeof($.cookie("mce_cart_cn"))!="undefined") {
        var mceCartProList = $.cookie("mce_cart_cn").split("|");
        $.cookie("mce_cart_cn") != "" ? mceCartProListNum = mceCartProList.length : mceCartProListNum = 0;
        if (mceCartProListNum > 0) {
            for (var i = 0; i < mceCartProListNum; i++) {
                if (mceCartProList[i] != null && mceCartProList[i] != "") {
                    var cartProList = mceCartProList[i].split(";");
                    let proP = cartProList[0] + ';' + cartProList[1] + ';' + cartProList[2];
                    if (isCheckPro(proP)) {
                        if (cartProList[3].indexOf("￥") > -1) {
                            var pro_price;
                            if ($.trim($.cookie("mce_country_name")) == "Japan") {
                                pro_price = '￥' + (parseFloat(cartProList[3].replace("￥", "")) * 1.3).toFixed();
                            } else {
                                pro_price = cartProList[3];
                            }
                            mceCartPriceSumUSD = mceCartPriceSumUSD + (parseFloat(pro_price.replace("￥", "")) * cartProList[8]);
                        }
                    }
                }
            }
        }

        if (mceCartPriceSumUSD > 0) {
            //let creditAmount = $('#mce_complimentary_offers').val();
            mceCartPriceSum = mceCartPriceSum + mceCartPriceTypeUSD + parseFloat(mceCartPriceSumUSD).toFixed(2);
        }

        if (mceCartPriceSum == "") {
            mceCartPriceSum = priceType + "0";
        }
    }
    return mceCartPriceSum;
}

function isCheckPro(proP) {
    let isCheck = false;
    let cartCheckPros = '';
    let pros;
    if (typeof($.cookie("cart_check_pros")) == "undefined") {
        $.cookie("cart_check_pros", "", {expires: 7, path: "/"});
    } else {
        cartCheckPros = $.cookie("cart_check_pros");
    }
    pros = cartCheckPros != '' ? cartCheckPros.split("|") : [];
    $.each(pros, function (index, doc) {
        if (proP == doc) {
            isCheck = true;
            return;
        }
    });
    return isCheck;
}

function checkIncludeSelected() {
    let isInclude = true;
    let selectProList = $.cookie("cart_check_pros");
    if (selectProList != "undefined" && selectProList.trim() != '') {
        isInclude = false;
    }
    return isInclude;
}


function getCartPriceSum_update(){
    var mceCartProList = $.cookie("mce_cart_cn").split("|");
    var mceCartProListNum = 0;
    var mceCartPriceSum = "";
    var mceCartPriceSumUSD = 0;
    var mceCartPriceTypeUSD = "￥";

    $.cookie("mce_cart_cn")!=""?mceCartProListNum = mceCartProList.length:mceCartProListNum=0;
    if(mceCartProListNum>0){
        for(var i=0;i<mceCartProListNum;i++){
            if(mceCartProList[i]!=null && mceCartProList[i]!=""){
                var cartProList = mceCartProList[i].split(";");
                if(cartProList[3].indexOf("￥")>-1){
                    mceCartPriceSumUSD = mceCartPriceSumUSD + parseInt(cartProList[3].replace("￥",""));
                }
            }
        }
    }

    if(mceCartPriceSumUSD > 0){
        mceCartPriceSum = mceCartPriceSum + mceCartPriceTypeUSD + mceCartPriceSumUSD;
    }
    return mceCartPriceSum;
}

function closeCountryType(){
    for(var i=1;i<4;i++){
        document.getElementById("cou-dd-"+i).style.display="none";
    }
}

function cart_sart(){
    if($.cookie("mce_cart_cn")!=null && $.cookie("mce_cart_cn")!=""){
        mce_cart_cn_update();
    }

}

function cart_sart_2(){
   // alert($.cookie("mce_cart_cn"));
    // chooseOrderCountry();

    product_cart_list_update();
    if($.cookie("mce_cart_cn")!=null && $.cookie("mce_cart_cn")!=""){
        //alert($.cookie("mce_cart_cn"));
        mce_cart_cn_update();
    }
    else{
        document.getElementById("cart_list_tbl").style.display = "none";
    }

    //getActivityCartPros();
}

function clearCart()
{
    $.cookie('mce_cart_cn',"", {expires: 7, path: "/"});
    //document.getElementById('tbodyCartList').innerHTML = "";
    $('#tbodyCartList').html("");
    mce_cart_cn_update();
}


function CartShow(){
    if(typeof($.cookie("mce_cart_cn"))!=="undefined" && $.cookie("mce_cart_cn")!=""){
        $('#cp-div').show();
    }else{
        $('#cp-div').hidden();
    }
}

function checkCustomerMessage(){
    var CustomerName = document.getElementById('customerName').value;
    var CompanyName = document.getElementById('companyName').value;
    var CountryName = document.getElementById('countryName').value;
    var EmailCart = document.getElementById('emailCart').value;
    var TelephoneNo = document.getElementById('telephoneNo').value;
    var streetCart = document.getElementById('streetCart').value;
    var cityCart = document.getElementById('cityCart').value;
    var stateCart = document.getElementById('stateCart').value;
    var zipCodeCart = document.getElementById('zipCodeCart').value;
    var selectFreight = document.getElementById("selectFreight").value;
    var FedEx = document.getElementById("FedEx").value;
    var billingAddress = "";

    var submitState = 1;
    //ci-error
    //ci-ok
    //Please fill in your name

    if(CustomerName==""){
        document.getElementById('customerNameMs').className="ci-error";
        //document.getElementById('customerNameMs').innerHTML = "Please fill in your name";
        $('#customerNameMs').html("Please fill in your name");
        submitState = 0;
    }else{
        document.getElementById('customerNameMs').className="ci-ok";
        //document.getElementById('customerNameMs').innerHTML = " ";
        $('#customerNameMs').html(" ");
    }

    if(CompanyName==""){
        document.getElementById('companyNameMs').className="ci-error";
        //document.getElementById('companyNameMs').innerHTML = "Please fill in company name";
        $('#companyNameMs').html("Please fill in company name");
        submitState = 0;
    }else{
        document.getElementById('companyNameMs').className="ci-ok";
        //document.getElementById('companyNameMs').innerHTML = " ";
        $('#companyNameMs').html(" ");
    }

    if(CountryName==""){
        document.getElementById('countryNameMs').className="ci-error";
        //document.getElementById('countryNameMs').innerHTML = "Please fill in country name";
        $('#countryNameMs').html("Please fill in country name");
        submitState = 0;
    }else{
        document.getElementById('countryNameMs').className="ci-ok";
        //document.getElementById('countryNameMs').innerHTML = " ";
        $('#countryNameMs').html(" ");
    }

    if(EmailCart==""){
        document.getElementById('emailCartMs').className="ci-error";
        //document.getElementById('emailCartMs').innerHTML = "Please fill in email";
        $('#emailCartMs').html("Please fill in email");
        submitState = 0;
    }else{
        if(!emailCheck("emailCart")){
            document.getElementById('emailCartMs').className="ci-error";
            //document.getElementById('emailCartMs').innerHTML = "Please fill in email";
            $('#emailCartMs').html("Please fill in email");
            submitState = 0;
        }else{
            document.getElementById('emailCartMs').className="ci-ok";
            //document.getElementById('emailCartMs').innerHTML = " ";
            $('#emailCartMs').html(" ");
        }
    }

    if(TelephoneNo==""){
        document.getElementById('telephoneNoMs').className="ci-error";
        //document.getElementById('telephoneNoMs').innerHTML = "Please fill in telephone No";
        $('#telephoneNoMs').html("Please fill in telephone No");
        submitState = 0;
    }else{
        document.getElementById('telephoneNoMs').className="ci-ok";
        //document.getElementById('telephoneNoMs').innerHTML = " ";
        $('#telephoneNoMs').html(" ");
    }

    if(streetCart==""){
        document.getElementById('addressCartMs').className="ci-error";
        //document.getElementById('addressCartMs').innerHTML = "Please fill in street";
        $('#addressCartMs').html("Please fill in street");
        submitState = 0;
    }else if(cityCart==""){
        document.getElementById('addressCartMs').className="ci-error";
        //document.getElementById('addressCartMs').innerHTML = "Please fill in city";
        $('#addressCartMs').html("Please fill in city");
        submitState = 0;
    }else if(stateCart==""){
        document.getElementById('addressCartMs').className="ci-error";
        //document.getElementById('addressCartMs').innerHTML = "Please fill in state";
        $('#addressCartMs').html("Please fill in state");
        submitState = 0;
    }else if(zipCodeCart==""){
        document.getElementById('addressCartMs').className="ci-error";
        //document.getElementById('addressCartMs').innerHTML = "Please fill in zip code";
        $('#addressCartMs').html("Please fill in zip code");
        submitState = 0;
    }else{
        document.getElementById('addressCartMs').className="ci-ok";
        //document.getElementById('addressCartMs').innerHTML = " ";
        $('#addressCartMs').html(" ");
        document.getElementById('addressCart').value = streetCart+","+cityCart+","+stateCart+","+zipCodeCart;
    }

    $('#addressType').val($("input[name='radio_Address']:checked").val());
    if($.trim($('#addressType').val())=="new_address"){
        billingAddress = $('#new_billingAddress').val();
        $('#billingAddressCart').val($("#new_billingAddress").val());
        if($.trim(billingAddress)==""){
            document.getElementById('addressBilling').className="ci-error";
            //document.getElementById('addressBilling').innerHTML = "Please fill in billing address";
            $('#addressBilling').html("Please fill in billing address");
            submitState = 0;
        }else{
            document.getElementById('addressBilling').className="ci-ok";
            //document.getElementById('addressBilling').innerHTML = " ";
            $('#addressBilling').html(" ");
        }
    }else{
        $('#billingAddressCart').val($("#addressCart").val());
        document.getElementById('addressBilling').className="";
        //document.getElementById('addressBilling').innerHTML = " ";
        $('#addressBilling').html(" ");
    }

    if(selectFreight==0){
        if(FedEx==""){
            document.getElementById('FedExMs').className="shjci-error";
            //document.getElementById('FedExMs').innerHTML = "Please fill in FedEx";
            //document.getElementById('FedExMs2').innerHTML = "* Please fill in FedEx";
            $('#FedExMs').html("Please fill in FedEx");
            $('#FedExMs2').html("* Please fill in FedEx");
            submitState = 0;
        }else{
            document.getElementById('FedExMs').className="shjci-ok";
            //document.getElementById('FedExMs').innerHTML = " ";
            //document.getElementById('FedExMs2').innerHTML = " ";
            $('#FedExMs').html(" ");
            $('#FedExMs2').html(" ");
        }
    }

    return submitState;
}


/**
 * Check email format
 */
function emailCheck(obj) {
    var objName = eval("document.all."+obj);
    var pattern = /^([\.a-zA-Z0-9_-])+@([a-zA-Z0-9_-])+(\.[a-zA-Z0-9_-])+/;
    if (!pattern.test(objName.value)) {
        //alert("Please fill in address");
        objName.focus();
        return false;
    }
    return true;
}


function add_Quotation(){
    var quotation_cart="";

    if(typeof($.cookie("quotation_cart"))=="undefined"){
        $.cookie("quotation_cart", "quotationCart", {expires: 1, path: "/"});
    }else{
        var quotation_cart = $.cookie("quotation_cart");
    }

    var quotation_cart = "";

    var cart_1 = null;
    var cart_2 = null;

    cart_1 = document.getElementsByName("pro_cart_dw_num");
    cart_2 = document.getElementsByName("pro_cart_mg_num");

    var cart_check = mce_cart_cn_add_check(cart_1,cart_2);
    var cart_str_1 = "";
    var cart_str_2 = "";
    if(cart_check>0){
        if(cart_1!=null){
            for(i=0;i<cart_1.length;i++){
                if(cart_1[i].value>0){

                    cart_str_1 = document.getElementById("pro_cart_dw_"+i).value.replace(/[\n]/ig,'').replace(/[\t]/ig,'');
                    //alert(cart_str_1);
                    if(quotation_cart==""){
                        quotation_cart = cart_str_1 +";" + cart_1[i].value;

                    }else{
                        quotation_cart = quotation_cart +"|"+ cart_str_1 +";" +cart_1[i].value;
                    }
                }
            }
        }

        if(cart_2!=null){
            for(var i=0;i<cart_2.length;i++){
                if(cart_2[i].value>0){
                    cart_str_2 = document.getElementById("pro_cart_mg_"+i).value.replace(/[\n]/ig,'').replace(/[\t]/ig,'');
                    //alert(cart_str_2);
                    if(quotation_cart==""){
                        quotation_cart = cart_str_2 +";" + cart_2[i].value;
                    }else{
                        quotation_cart = quotation_cart +"|"+ cart_str_2 +";" +cart_2[i].value;
                    }
                }
            }
        }

        var cart_num=$(".cart-quSel");
        for ( var i = 0; i < cart_num.length; i++) {
            if(cart_num[i].value>0){
                for(j=0;j<cart_num[i].length;j++){
                    if(cart_num[i][j].value==0){
                        cart_num[i][j].selected = true;
                    }
                }
            }
        }

        re=new RegExp("€","g");
        quotation_cart = quotation_cart.replace(re,"E");
//			 alert(quotation_cart);
        $.ajax({
            url: "mce_cart_cn!getQuotation_session.shtml",
            data:"quotationCart="+quotation_cart,
            cache:false,
            dataType:'json',
            success:function(data){
                //alert(data);
                $.each(data, function(i, item) {
                    if(i.trim()=="quotationMessage"){
                        //customerCountry = i.trim();
                        //alert(item);
                        if($.trim(item)=="success"){
                            location.href = "getQuotation.html";
                        }
                    }
                });
            },
            error:function(XMLResponse){
                //alert(XMLResponse.responseText)
            }
        });

    }else{
        //	showDiv("proMaskCon-cart-message");
    }

}


function add_Quotation_inhibitor(){
    var quotation_cart="";

    if(typeof($.cookie("quotation_cart"))=="undefined"){
        $.cookie("quotation_cart", "quotationCart", {expires: 1, path: "/"});
    }else{
        var quotation_cart = $.cookie("quotation_cart");
    }

    var quotation_cart = "";

    var cart_1 = null;
    var cart_2 = null;

    cart_1 = document.getElementsByName("pro_cart_dw_num");
    cart_2 = document.getElementsByName("pro_cart_mg_num");

    var cart_check = mce_cart_cn_add_check(cart_1,cart_2);
    var cart_str_1 = "";
    var cart_str_2 = "";
    if(cart_check>0){
        if(cart_1!=null){
            for(i=0;i<cart_1.length;i++){
                if(cart_1[i].value>0){
                    cart_str_1 = document.getElementById("pro_cart_dw_"+i).value.replace(/[\n]/ig,'').replace(/[\t]/ig,'');
                    //alert(cart_str_1);
                    if(quotation_cart==""){
                        quotation_cart = cart_str_1 +";" + cart_1[i].value;

                    }else{
                        quotation_cart = quotation_cart +"|"+ cart_str_1 +";" +cart_1[i].value;
                    }
                }
            }
        }

        if(cart_2!=null){
            for(var i=0;i<cart_2.length;i++){
                if(cart_2[i].value>0){
                    cart_str_2 = document.getElementById("pro_cart_mg_"+i).value.replace(/[\n]/ig,'').replace(/[\t]/ig,'');
                    //alert(cart_str_2);
                    if(quotation_cart==""){
                        quotation_cart = cart_str_2 +";" + cart_2[i].value;
                    }else{
                        quotation_cart = quotation_cart +"|"+ cart_str_2 +";" +cart_2[i].value;
                    }
                }
            }
        }

        var cart_num=$(".cart-quSel");
        for ( var i = 0; i < cart_num.length; i++) {
            if(cart_num[i].value>0){
                for(j=0;j<cart_num[i].length;j++){
                    if(cart_num[i][j].value==0){
                        cart_num[i][j].selected = true;
                    }
                }
            }
        }

        re=new RegExp("€","g");
        quotation_cart = quotation_cart.replace(re,"E");
//			 alert(quotation_cart);
        $.ajax({
            url: "mce_cart_cn!getQuotation_session.shtml",
            data:"quotationCart="+quotation_cart,
            cache:false,
            dataType:'json',
            success:function(data){
                //alert(data);
                $.each(data, function(i, item) {
                    if(i.trim()=="quotationMessage"){
                        //customerCountry = i.trim();
                        //alert(item);
                        if($.trim(item)=="success"){
                            location.href = "../getQuotation.html";
                        }
                    }
                });
            },
            error:function(XMLResponse){alert(XMLResponse.responseText)}
        });

    }else{
        //	showDiv("proMaskCon-cart-message");
    }

}


function add_Quotation2(id){
    //var quotation_cart= document.getElementById("pro_cart_mg_"+id).value
    var quotation_cart=$("#pro_cart_mg_"+id).val().replace(/[\n]/ig,'').replace(/[\t]/ig,'');
    //re=new RegExp("€","g");
    //quotation_cart = quotation_cart.replace(re,"E");
    // alert(quotation_cart);
    $.ajax({
        url: "mce_cart_cn!getQuotation_session.shtml",
        data:"quotationCart="+quotation_cart,
        cache:false,
        dataType:'json',
        success:function(data){
            //alert(data);
            $.each(data, function(i, item) {
                if(i.trim()=="quotationMessage"){
                    //customerCountry = i.trim();
                    //alert(item);
                    if($.trim(item)=="success"){
                        location.href = "getQuotation.html";
                    }
                }
            });
        },
        error:function(XMLResponse){alert(XMLResponse.responseText)}
    });


}

function changeProNumList(cart_id,chang_Type){
    var pro_id = cart_id.replace(/;/g,"_");
    //alert(pro_id);
    var pro_num = parseInt(document.getElementById('cartProNum_' + pro_id).value);
    var pro_num_1 = pro_num;

    //alert(pro_num);
    var pro_price = document.getElementById('quotationProPrice_' + pro_id).value;
    var mceCartPriceType = "￥";

    //alert(pro_num);
    if(chang_Type=="-"){
        if(pro_num>1){
            pro_num = pro_num - 1;
        }else if(pro_num == 1){
            //showDiv("proMaskCon-cart-message-change");
        }
    }else if(chang_Type=="+"){
        pro_num = pro_num + 1;
        //alert(pro_num);
    }else if(chang_Type=="input"){
        pro_num = pro_num_1;
    }
    //alert(cart_id);
    //alert(pro_num);
    if(pro_num > 0){
        $.ajax({
            url: "mce_cart_cn!getQuotation_session_update.shtml",
            data:{"proCartId":cart_id,"proCartNum":pro_num},
            cache:false,
            dataType:'json',
            success:function(data){
                //alert(data);
                //$('#cartProNum_'+pro_id).val(pro_num);
                //alert($('#cartProNum_'+pro_id).val());
                document.getElementById('cartProNum_' + pro_id).value = pro_num;
                $.each(data, function(i, item) {
//			        	if(i.trim()=="quotationMessage"){
//			        		if($.trim(item)=="success"){
//			        			location.href = "getQuotation.html";
//			        		}
//			        	}

                    if(i.trim()=="cartProListPriceSum"){
                        //alert($.trim(item));
                        //document.getElementById('cartProListPriceSum').innerHTML = $.trim(item);
                        $('#cartProListPriceSum').html($.trim(item));
                        var priceSum = parseFloat(pro_price.replace("￥",""))*pro_num;
                        //document.getElementById('quotationProInfoPriceSum_' + pro_id).innerHTML = "<strong>"+mceCartPriceType + priceSum.toFixed()+"</strong>";
                        $('#quotationProInfoPriceSum_'+pro_id).html("<strong>"+mceCartPriceType + priceSum.toFixed()+"</strong>");
                        //getQuotationBySession();
                    }
                });
            },
            error:function(XMLResponse){alert(XMLResponse.responseText)}
        });

    }
}


function deleteCartProList(cart_id){

    $.ajax({
        url: "mce_cart_cn!getQuotation_session_delete.shtml",
        data:{"proCartId":cart_id},
        cache:false,
        dataType:'json',
        success:function(data){
            //alert(data);
            $.each(data, function(i, item) {
                if(i.trim()=="quotationMessage"){
                    //customerCountry = i.trim();
                    //alert(item);
                    if($.trim(item)=="success"){
                        //location.href = "getQuotation.html";
                        var cart_tbody = document.getElementById('tbodyCartList');
                        var str_id = cart_id.replace(/;/g,"_");
                        //alert(str_id);
                        var cart_tr = document.getElementById('cartProList_' + str_id);
                        cart_tbody.deleteRow(cart_tr.rowIndex);
                        if($("#tbodyCartList tr").size()==0){
                            $("#cart_list_tbl").hide();
                        }
                    }
                };
                if(i.trim()=="cartProListPriceSum"){
                    //document.getElementById('cartProListPriceSum').innerHTML = $.trim(item);
                    $('#cartProListPriceSum').html($.trim(item));
                }
            });
        },
        error:function(XMLResponse){
            alert(XMLResponse.responseText)
        }
    });

}

function changTblName(cartName) {
    var table_pro_cart_name = cartName.replace('_l_alpha_r_', 'α').replace('_l_beta_r_', 'β').replace('_l_gamma_r_', 'γ')
        .replace('_l_delta_r_', 'δ').replace('_l_epsilon_r_', 'ε').replace('_l_zeta_r_', 'ζ')
        .replace('_l_eta_r_', 'η').replace('_l_theta_r_', 'θ').replace('_l_iota_r_', 'ι')
        .replace('_l_kappa_r_', 'κ').replace('_l_lambda_r_', 'λ').replace('_l_mu_r_', 'μ')
        .replace('_l_nu_r_', 'ν').replace('_l_xi_r_', 'ξ').replace('_l_omicron_r_', 'ο')
        .replace('_l_pi_r_', 'π').replace('_l_rho_r_', 'ρ').replace('_l_sigma_r_', 'σ')
        .replace("_l_tau_r_", "τ")
        .replace("_l_upsilon_r_", "υ")
        .replace("_l_phi_r_", "φ")
        .replace("_l_chi_r_", "χ")
        .replace("_l_psi_r_", "ψ")
        .replace("_l_omega_r_", "ω")
        .replace("_l_plusmn_r_", "±")
        .replace("_l_addition_r_", "+")
        .replace("_l_acute_r_", "'");
    return table_pro_cart_name;
}

function product_cart_list_update(){
    if(typeof($.cookie("mce_cart_cn"))!="undefined") {
        var mce_cart_cn_proList = $.cookie("mce_cart_cn").split("|");
        var mce_cart_cn_proList_num = 0;
        $.cookie("mce_cart_cn") != "" ? mce_cart_cn_proList_num = mce_cart_cn_proList.length : mce_cart_cn_proList_num = 0;
        var mce_cart_cn_priceSum = 0;
        var mce_cart_cn_priceType = "￥";
        var mce_cart_cn_pro_str = "";
        // var mce_cart_cn_eta = new Array();

        if (mce_cart_cn_proList_num > 0) {
            var mce_cart_cn_pro_str = "";
// 			alert($.cookie("mce_cart_cn"));
            for (var i = 0; i < mce_cart_cn_proList_num; i++) {
                if (mce_cart_cn_proList[i] != null && mce_cart_cn_proList[i] != "") {
                   // alert(mce_cart_cn_proList[i]);
                    var cart_pro_list = mce_cart_cn_proList[i].split(";");
                    // mce_cart_cn_eta[i] = checkStockCn(cart_pro_list[6], cart_pro_list[8]);
                    var table_pro_cart_name = cart_pro_list[0];

                    var pro_price;
                    if ($.trim($.cookie("mce_country_name")) == "Japan") {
                        pro_price = (parseInt(cart_pro_list[3].replace("￥", "")) * 1.3).toFixed();
                    } else {
                        pro_price = (cart_pro_list[3].replace("￥", "") * 1).toFixed(2);//parseInt(cart_pro_list[3].replace("￥", ""));
                    }
                    mce_cart_cn_priceSum = (parseFloat(pro_price) * cart_pro_list[8]).toFixed(2);
                    mce_cart_cn_pro_str = mce_cart_cn_pro_str + "<tr id='cartProInfoList_" + table_pro_cart_name + "_" + cart_pro_list[1] + "_" + cart_pro_list[2] +"'>"
                        + "<th class=\"c_check\">"+"<input type='checkbox'"
                        + " cnCartP='" + table_pro_cart_name + ";" + cart_pro_list[1] + ";" + cart_pro_list[2] + "' "
                        + " class='checkbox cartProCheckIndex' >"+"</th>"
                        + "<th class=\"c_cat\">" + cart_pro_list[2] + "</th>"
                        + "<td class=\"c_name\">"
                        + checkStockCn(cart_pro_list[6], cart_pro_list[8], cart_pro_list[7], cart_pro_list[2])
                        + "<a class='spCart_proName' href='" + getProjectUrl() + "/" + getTableCartProUrl(cart_pro_list[2], cart_pro_list[4]) + ".html'>"
                        + changTblName(table_pro_cart_name).replace('_l_', '(').replace('_r_', ')')
                        + "</a>"
                        + "</td>";
                    if (cart_pro_list[1].trim().indexOf("Free Sample")==-1) {
                        mce_cart_cn_pro_str = mce_cart_cn_pro_str + "<td class=\"c_size\">" + cart_pro_list[1] + "</td>";
                    } else {
                        mce_cart_cn_pro_str = mce_cart_cn_pro_str + "<td class=\"c_size\">"+cart_pro_list[1]+"</td>";
                    }
                    var originalPrice = '';
                    if (parseFloat(pro_price) < parseFloat(cart_pro_list[5])) {
                        originalPrice = "<p style=\"color: #9f9f9f;\"><s>" + priceType + parseFloat(cart_pro_list[5]).toFixed(2) + "</s></p>";
                    }
                    mce_cart_cn_pro_str = mce_cart_cn_pro_str + "<td class=\"c_price\"><p name='cartPriceP' id='cartProTextPrice_" + cart_pro_list[1].replace(" ", "") + "_" + cart_pro_list[2] + "' class='tempPrice'>" + priceType + pro_price + "</p>"
                        + originalPrice
                        + "<input name='cartProInfoPriceSum_hidden' type='hidden' id='cartProPrice_" + table_pro_cart_name + "_" + cart_pro_list[1] + "_" + cart_pro_list[2] + "' value='" + priceType + pro_price + "'/>"
                        + "</td>";

                    if (cart_pro_list[1].trim().indexOf("Free Sample")==-1) {
                        mce_cart_cn_pro_str = mce_cart_cn_pro_str + "<td class=\"c_qty\">"
                            + "<span class='cart_list_add' onclick=\"changeProNum(\'" + table_pro_cart_name + "\;" + cart_pro_list[1] + "\;" + cart_pro_list[2] + "\',\'+\');\">+</span>"
                            + "<input name='cartProNumber' type='text' onchange=\"changeProNum(\'" + table_pro_cart_name + "\;" + cart_pro_list[1] + "\;" + cart_pro_list[2] + "\',\'input\');\""
                            + " id='cartProNum_" + table_pro_cart_name + "_" + cart_pro_list[1] + "_" + cart_pro_list[2] + "' "
                            + " value='" + cart_pro_list[8] + "' />"
                            + "<span class='cart_list_les' onclick=\"changeProNum(\'" + table_pro_cart_name + "\;" + cart_pro_list[1] + "\;" + cart_pro_list[2] + "\',\'-\');\">-</span>"
                            + "</td>";
                    } else {
                        mce_cart_cn_pro_str = mce_cart_cn_pro_str + "<td class=\"c_qty c_qty_frees\" >1</td>";
                    }
                    mce_cart_cn_pro_str = mce_cart_cn_pro_str + "<td class=\"c_amount\">"
                        + "<p name='cartProInfoPriceSum' id='cartProInfoPriceSum_" + table_pro_cart_name + "_" + cart_pro_list[1] + "_" + cart_pro_list[2] + "\'><strong>"
                        + priceType + mce_cart_cn_priceSum
                        + "</strong></p>"
                        + "</td>"
                        + "<td class=\"c_remove\">"
                        + "<span class='cart_list_del' onclick=\"deleteCartPro(\'" + table_pro_cart_name + "\;" + cart_pro_list[1]+ "\;" + cart_pro_list[2] + "\');\"></span>"
                        + "</td>"
                        + "</tr>";
                }
            }

            // if (mce_cart_cn_eta.length > 0) {
            //     $.cookie('mce_cart_cn_eta', mce_cart_cn_eta.join('|'), {expires: 7, path: "/"});
            // }

            if (mce_cart_cn_proList_num > 0) {
                $('#tbodyCartList').html(mce_cart_cn_pro_str);
                $('#cartProListPriceSum').html(getCartPriceSum());

                if (getCartPriceSum().replace("￥", "") == '0') {
                    $("#mce_promocode_tr").hide();
                    $("#mce_promocode").val("");
                }else{
                    $("#mce_promocode_tr").show();
                }

                cartFreeSampleNumber = patch("Free Sample", $.cookie("mce_cart_cn"));
                //carProNumber  = mce_cart_cn_proList_num;
                //alert(carProNumber);
                if (cartFreeSampleNumber > 3 && !isAgencyType) {
                    $("#freeMsg").html("同一机构（单位）同一产品试用装仅限申领一次，同一机构（单位）一年内可免费申领<b>三个不同产品</b>试用装。");
                    $("#freeMsg").addClass("cart_fs_tips");
                } else {
                    $("#freeMsg").html("");
                    $("#freeMsg").removeClass("cart_fs_tips");
                }
                cartProCheckFunctionInit();
            }
            else {
                document.getElementById("cart_list_tbl").style.display = "none";
            }
        }
        else {
            document.getElementById("cart_list_tbl").style.display = "none";
        }
    }
}


function product_cart_list_update_change(){
    var mce_cart_cn_proList = $.cookie("mce_cart_cn").split("|");
    var mce_cart_cn_proList_num = 0;
    $.cookie("mce_cart_cn")!=""?mce_cart_cn_proList_num = mce_cart_cn_proList.length:mce_cart_cn_proList_num=0;
    var mce_cart_cn_priceSum = 0;
    var mce_cart_cn_priceType = "￥";
    var mce_cart_cn_pro_str = "";
    // var mce_cart_cn_eta = new Array();

    if(mce_cart_cn_proList_num>0){
        var mce_cart_cn_pro_str = "";
// 			alert($.cookie("mce_cart_cn"));
        for(var i=0;i<mce_cart_cn_proList_num;i++){
            if(mce_cart_cn_proList[i]!=null && mce_cart_cn_proList[i]!=""){
                var cart_pro_list = mce_cart_cn_proList[i].split(";");
                // mce_cart_cn_eta[i] = checkStockCn(cart_pro_list[6], cart_pro_list[8]);
                var table_pro_cart_name = cart_pro_list[0].replace('_l_alpha_r_','α').replace('_l_beta_r_','β').replace('_l_gamma_r_','γ')
                    .replace('_l_delta_r_','δ').replace('_l_epsilon_r_','ε').replace('_l_zeta_r_','ζ')
                    .replace('_l_eta_r_','η').replace('_l_theta_r_','θ').replace('_l_iota_r_','ι')
                    .replace('_l_kappa_r_','κ').replace('_l_lambda_r_','λ').replace('_l_mu_r_','μ')
                    .replace('_l_nu_r_','ν').replace('_l_xi_r_','ξ').replace('_l_omicron_r_','ο')
                    .replace('_l_pi_r_','π').replace('_l_rho_r_','ρ').replace('_l_sigma_r_','σ')
                    .replace("_l_tau_r_", "τ")
                    .replace("_l_upsilon_r_", "υ")
                    .replace("_l_phi_r_", "φ")
                    .replace("_l_chi_r_", "χ")
                    .replace("_l_psi_r_", "ψ")
                    .replace("_l_omega_r_", "ω")
                    .replace("_l_plusmn_r_", "±")
                    .replace("_l_addition_r_", "+")
                    .replace("_l_acute_r_", "'");
//	 				mce_cart_cn_priceSum = parseInt(cart_pro_list[3].replace("￥",""))*cart_pro_list[8];
                mce_cart_cn_priceSum = parseInt(cart_pro_list[3].replace("￥",""));
                mce_cart_cn_pro_str = mce_cart_cn_pro_str + "<tr id='cartProInfoList_"+table_pro_cart_name+"_"+cart_pro_list[1]+"_"+cart_pro_list[2]+"'>"
                    + "<th class=\"c_check\">"+"<input type='checkbox' class='checkbox'>"+"</th>"
                    + "<th class=\"c_cat\">"+cart_pro_list[2]+"</th>"
                    + "<td class=\"c_name\">"
                    + checkStockCn(cart_pro_list[6], cart_pro_list[8], cart_pro_list[7], cart_pro_list[2])
                    + "<a class='spCart_proName' href='"+getProjectUrl()+"/"+getTableCartProUrl(cart_pro_list[2],cart_pro_list[4])+".html'>"
                    + table_pro_cart_name.replace('_l_','(').replace('_r_',')')
                    + "</a>"
                    + "</td>"
                    + "<td class=\"c_size\"><input type='text' style='width:80px;' id='updateSize_"+table_pro_cart_name+"_"+cart_pro_list[1]+"_"+cart_pro_list[2]+"' value=\""+cart_pro_list[1].trim().replace(/[ ]/g,"")+"\" "
                    +" onblur=\"changeProCart(\'"+table_pro_cart_name+"\;"+cart_pro_list[1]+"\;"+cart_pro_list[2]+"\',\'"+cart_pro_list[8]+"\');\"/></td>"
                    + "<td class=\"c_price\"><input type='text' style='width:80px;' id='updatePrice_"+table_pro_cart_name+"_"+cart_pro_list[1]+"_"+cart_pro_list[2]+"' value=\""+cart_pro_list[3].trim().replace(/[ ]/g,"")+"\" "
                    +" onblur=\"changeProCart(\'"+table_pro_cart_name+"\;"+cart_pro_list[1]+"\;"+cart_pro_list[2]+"\',\'"+cart_pro_list[8]+"\');\"/>"
                    + "<input name='cartProInfoPriceSum_hidden' type='hidden' id='cartProPrice_"+table_pro_cart_name+"_"+cart_pro_list[1]+"_"+cart_pro_list[2]+"' value='"+cart_pro_list[3]+"'/>"
                    + "</td>"
                    + "<td class=\"c_qty\">"
                    + "<span class='cart_list_add' onclick=\"changeProNum2(\'"+table_pro_cart_name+"\;"+cart_pro_list[1]+"\;"+cart_pro_list[2]+"\',\'+\');\">+</span>"
                    + "<input name='cartProNumber' type='text' onchange=\"changeProNum2(\'"+table_pro_cart_name+"\;"+cart_pro_list[1]+"\;"+cart_pro_list[2]+"\',\'input\');\""
                    + " id='cartProNum_"+table_pro_cart_name+"_"+cart_pro_list[1]+"_"+cart_pro_list[2]+"' "
                    + " value='"+cart_pro_list[8]+"' />"
                    + "<span class='cart_list_les' onclick=\"changeProNum2(\'"+table_pro_cart_name+"\;"+cart_pro_list[1]+"\;"+cart_pro_list[2]+"\',\'-\');\">-</span>"
                    + "</td>"
                    + "<td class=\"c_amount\">"
                    + "<p name='cartProInfoPriceSum' id='cartProInfoPriceSum_"+table_pro_cart_name+"_"+cart_pro_list[1]+"_"+cart_pro_list[2]+"\'><strong>"
                    + priceType+mce_cart_cn_priceSum
                    + "</strong></p>"
                    + "</td>"
                    + "<td class=\"c_remove\">"
                    + "<span class='cart_list_del' onclick=\"deleteCartPro(\'"+table_pro_cart_name+"\;"+cart_pro_list[1]+"\;"+cart_pro_list[2]+"\');\"></span>"
                    + "</td>"
                    + "</tr>";
            }
        }
        //alert(mce_cart_cn_pro_str);
        //alert(mce_cart_cn_proList_num);
        // if (mce_cart_cn_eta.length > 0) {
        //     $.cookie('mce_cart_cn_eta', mce_cart_cn_eta.join('|'), {expires: 7, path: "/"});
        // }

        if(mce_cart_cn_proList_num>0){

            $('#tbodyCartList').html("");
            $('#td_Freight').html("");
            $('#cartProListPriceSum').html("");
            $('#UnitPrice').html("update Price");
            $('#tbodyCartList').html(mce_cart_cn_pro_str);
            $('#cartProListPriceSum').html(getCartPriceSum_update());
        }
        else{
            document.getElementById("cart_list_tbl").style.display = "none";
        }
    }
    else{
        document.getElementById("cart_list_tbl").style.display = "none";
    }
}

function getTableCartProUrl(proCatelogNo,proUrl){
    // var tableCartProUrl;
    // if(proCatelogNo.indexOf('HY-K')>-1){
    //     tableCartProUrl = "inhibitor-kit/" + proUrl;
    // }else{
    //     tableCartProUrl = proUrl;
    // }
    // return tableCartProUrl;
    return proUrl;
}

function getMessageStr(freeMessage_arr_list){
    var messageStr;
    if(freeMessage_arr_list.length<=2){
        messageStr = freeMessage_arr_list.join("和");
    }else{
        for(var i=0;i<freeMessage_arr_list.length;i++){
            if(i==0){
                messageStr = freeMessage_arr_list[i]
            }else if(i>0 && i<(freeMessage_arr_list.length-1)){
                messageStr = messageStr + "，" + freeMessage_arr_list[i];
            }else{
                messageStr = messageStr + "和" + freeMessage_arr_list[i];
            }
        }
    }
    return messageStr;
}


</script>

</body>
</html>
