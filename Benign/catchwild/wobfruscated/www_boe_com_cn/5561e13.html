<!DOCTYPE html>

<html lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>5561e13.html</title>
</head>
<body>
<script>(window.webpackJsonp=window.webpackJsonp||[]).push([[198],{3518:function(n,t,e){(function(n){!function(){"use strict";var t=function(){},e=function(n,t){return function(){for(var e=[],o=0;o<arguments.length;o++)e[o]=arguments[o];return n(t.apply(null,e))}},o=function(n){return function(){return n}},r=function(n){return n};function c(n){for(var t=[],e=1;e<arguments.length;e++)t[e-1]=arguments[e];return function(){for(var e=[],o=0;o<arguments.length;o++)e[o]=arguments[o];var r=t.concat(e);return n.apply(null,r)}}var f=function(n){return function(t){return!n(t)}},l=function(n){return function(){throw new Error(n)}},d=o(!1),m=o(!0),h=tinymce.util.Tools.resolve("tinymce.ThemeManager"),v=function(){return(v=Object.assign||function(n){for(var s,i=1,t=arguments.length;i<t;i++)for(var p in s=arguments[i])Object.prototype.hasOwnProperty.call(s,p)&&(n[p]=s[p]);return n}).apply(this,arguments)};function y(s,n){var t={};for(var p in s)Object.prototype.hasOwnProperty.call(s,p)&&n.indexOf(p)<0&&(t[p]=s[p]);if(null!=s&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(p=Object.getOwnPropertySymbols(s);i<p.length;i++)n.indexOf(p[i])<0&&Object.prototype.propertyIsEnumerable.call(s,p[i])&&(t[p[i]]=s[p[i]])}return t}function x(){for(var s=0,i=0,n=arguments.length;i<n;i++)s+=arguments[i].length;var t=Array(s),e=0;for(i=0;i<n;i++)for(var a=arguments[i],o=0,r=a.length;o<r;o++,e++)t[e]=a[o];return t}var w,S=function(){return k},k=function(){var n=function(n){return n.isNone()},e=function(n){return n()},r=function(n){return n};return{fold:function(n,t){return n()},is:d,isSome:d,isNone:m,getOr:r,getOrThunk:e,getOrDie:function(n){throw new Error(n||"error: getOrDie called on none.")},getOrNull:o(null),getOrUndefined:o(void 0),or:r,orThunk:e,map:S,each:t,bind:S,exists:d,forall:m,filter:S,equals:n,equals_:n,toArray:function(){return[]},toString:o("none()")}}(),C=function(a){var n=o(a),t=function(){return r},e=function(n){return n(a)},r={fold:function(n,s){return s(a)},is:function(n){return a===n},isSome:m,isNone:d,getOr:n,getOrThunk:n,getOrDie:n,getOrNull:n,getOrUndefined:n,or:t,orThunk:t,map:function(n){return C(n(a))},each:function(n){n(a)},bind:e,exists:e,forall:e,filter:function(n){return n(a)?r:k},toArray:function(){return[a]},toString:function(){return"some("+a+")"},equals:function(n){return n.is(a)},equals_:function(n,t){return n.fold(d,(function(b){return t(a,b)}))}};return r},O={some:C,none:S,from:function(n){return null==n?k:C(n)}},_=function(n){return function(t){return function(n){var t=typeof n;return null===n?"null":"object"===t&&(Array.prototype.isPrototypeOf(n)||n.constructor&&"Array"===n.constructor.name)?"array":"object"===t&&(String.prototype.isPrototypeOf(n)||n.constructor&&"String"===n.constructor.name)?"string":t}(t)===n}},T=function(n){return function(t){return typeof t===n}},E=_("string"),D=_("object"),B=_("array"),A=T("boolean"),M=function(n){return function(a){return n===a}}(void 0),F=function(a){return!function(a){return null==a}(a)},I=T("function"),R=T("number"),V=function(n,t){if(B(n)){for(var i=0,e=n.length;i<e;++i)if(!t(n[i]))return!1;return!0}return!1},P=Array.prototype.slice,H=Array.prototype.indexOf,z=Array.prototype.push,N=function(n,t){return H.call(n,t)},L=function(n,t){return N(n,t)>-1},j=function(n,t){for(var i=0,e=n.length;i<e;i++){if(t(n[i],i))return!0}return!1},U=function(n,t){for(var e=[],i=0;i<n;i++)e.push(t(i));return e},W=function(n,t){for(var e=[],i=0;i<n.length;i+=t){var s=P.call(n,i,i+t);e.push(s)}return e},map=function(n,t){for(var e=n.length,o=new Array(e),i=0;i<e;i++){var r=n[i];o[i]=t(r,i)}return o},G=function(n,t){for(var i=0,e=n.length;i<e;i++){t(n[i],i)}},X=function(n,t){for(var e=[],o=[],i=0,r=n.length;i<r;i++){var c=n[i];(t(c,i)?e:o).push(c)}return{pass:e,fail:o}},filter=function(n,t){for(var e=[],i=0,o=n.length;i<o;i++){var r=n[i];t(r,i)&&e.push(r)}return e},Y=function(n,t,e){return function(n,t){for(var i=n.length-1;i>=0;i--){t(n[i],i)}}(n,(function(n){e=t(e,n)})),e},J=function(n,t,e){return G(n,(function(n){e=t(e,n)})),e},K=function(n,t){return function(n,t,e){for(var i=0,o=n.length;i<o;i++){var r=n[i];if(t(r,i))return O.some(r);if(e(r,i))break}return O.none()}(n,t,d)},$=function(n,t){for(var i=0,e=n.length;i<e;i++){if(t(n[i],i))return O.some(i)}return O.none()},Q=function(n){for(var t=[],i=0,e=n.length;i<e;++i){if(!B(n[i]))throw new Error("Arr.flatten item "+i+" was not an array, input: "+n);z.apply(t,n[i])}return t},Z=function(n,t){return Q(map(n,t))},nn=function(n,t){for(var i=0,e=n.length;i<e;++i){if(!0!==t(n[i],i))return!1}return!0},tn=function(n){var t=P.call(n,0);return t.reverse(),t},en=function(n,t){return filter(n,(function(n){return!L(t,n)}))},on=function(n,t){var e=P.call(n,0);return e.sort(t),e},rn=function(n,i){return i>=0&&i<n.length?O.some(n[i]):O.none()},head=function(n){return rn(n,0)},un=function(n){return rn(n,n.length-1)},an=I(Array.from)?Array.from:function(n){return P.call(n)},cn=function(n,t){for(var i=0;i<n.length;i++){var e=t(n[i],i);if(e.isSome())return e}return O.none()},sn=function(n){return{is:function(t){return n===t},isValue:m,isError:d,getOr:o(n),getOrThunk:o(n),getOrDie:o(n),or:function(t){return sn(n)},orThunk:function(t){return sn(n)},fold:function(t,e){return e(n)},map:function(t){return sn(t(n))},mapError:function(t){return sn(n)},each:function(t){t(n)},bind:function(t){return t(n)},exists:function(t){return t(n)},forall:function(t){return t(n)},toOptional:function(){return O.some(n)}}},fn=function(n){return{is:d,isValue:d,isError:m,getOr:r,getOrThunk:function(n){return n()},getOrDie:function(){return l(String(n))()},or:function(n){return n},orThunk:function(n){return n()},fold:function(t,e){return t(n)},map:function(t){return fn(n)},mapError:function(t){return fn(t(n))},each:t,bind:function(t){return fn(n)},exists:d,forall:m,toOptional:O.none}},ln={value:sn,error:fn,fromOption:function(n,t){return n.fold((function(){return fn(t)}),sn)}};!function(n){n[n.Error=0]="Error",n[n.Value=1]="Value"}(w||(w={}));var dn=function(n,t,e){return n.stype===w.Error?t(n.serror):e(n.svalue)},mn=function(n){return{stype:w.Value,svalue:n}},gn=function(n){return{stype:w.Error,serror:n}},pn=function(n){return n.fold(gn,mn)},hn=function(n){return dn(n,ln.error,ln.value)},vn=mn,bn=function(n){var t=[],e=[];return G(n,(function(n){dn(n,(function(n){return e.push(n)}),(function(n){return t.push(n)}))})),{values:t,errors:e}},yn=gn,xn=function(n,t){return n.stype===w.Value?t(n.svalue):n},wn=function(n,t){return n.stype===w.Error?t(n.serror):n},Sn=function(n,t){return n.stype===w.Value?{stype:w.Value,svalue:t(n.svalue)}:n},kn=function(n,t){return n.stype===w.Error?{stype:w.Error,serror:t(n.serror)}:n},Cn=Object.keys,On=Object.hasOwnProperty,_n=function(n,t){for(var e=Cn(n),o=0,r=e.length;o<r;o++){var i=e[o];t(n[i],i)}},Tn=function(n,t){return En(n,(function(n,i){return{k:i,v:t(n,i)}}))},En=function(n,t){var e={};return _n(n,(function(n,i){var o=t(n,i);e[o.k]=o.v})),e},Dn=function(n,e){var o={};return function(n,t,e,o){_n(n,(function(n,i){(t(n,i)?e:o)(n,i)}))}(n,e,function(n){return function(t,i){n[i]=t}}(o),t),o},Bn=function(n,t){var e=[];return _n(n,(function(n,o){e.push(t(n,o))})),e},An=function(n,t){for(var e=Cn(n),o=0,r=e.length;o<r;o++){var i=e[o],c=n[i];if(t(c,i,n))return O.some(c)}return O.none()},Mn=function(n){return Bn(n,(function(n){return n}))},Fn=function(n,t){return In(n,t)?O.from(n[t]):O.none()},In=function(n,t){return On.call(n,t)},Rn=function(n,t){return In(n,t)&&void 0!==n[t]&&null!==n[t]},Vn=function(n){if(!B(n))throw new Error("cases must be an array");if(0===n.length)throw new Error("there must be at least one case");var t=[],e={};return G(n,(function(o,r){var c=Cn(o);if(1!==c.length)throw new Error("one and only one name per case");var f=c[0],l=o[f];if(void 0!==e[f])throw new Error("duplicate key detected:"+f);if("cata"===f)throw new Error("cannot have a case named cata (sorry)");if(!B(l))throw new Error("case arguments must be an array");t.push(f),e[f]=function(){var e=arguments.length;if(e!==l.length)throw new Error("Wrong number of arguments to case "+f+". Expected "+l.length+" ("+l+"), got "+e);for(var o=new Array(e),i=0;i<o.length;i++)o[i]=arguments[i];var c=function(n){var e=Cn(n);if(t.length!==e.length)throw new Error("Wrong number of arguments to match. Expected: "+t.join(",")+"\nActual: "+e.join(","));if(!nn(t,(function(n){return L(e,n)})))throw new Error("Not all branches were specified when using match. Specified: "+e.join(", ")+"\nRequired: "+t.join(", "));return n[f].apply(null,o)};return{fold:function(){if(arguments.length!==n.length)throw new Error("Wrong number of arguments to fold. Expected "+n.length+", got "+arguments.length);var t=arguments[r];return t.apply(null,o)},match:c,log:function(label){console.log(label,{constructors:t,constructor:f,params:o})}}}})),e},Pn=Object.prototype.hasOwnProperty,Hn=function(n){return function(){for(var t=new Array(arguments.length),i=0;i<t.length;i++)t[i]=arguments[i];if(0===t.length)throw new Error("Can't merge zero objects");for(var e={},o=0;o<t.length;o++){var r=t[o];for(var c in r)Pn.call(r,c)&&(e[c]=n(e[c],r[c]))}return e}},zn=Hn((function(n,t){return D(n)&&D(t)?zn(n,t):t})),Nn=Hn((function(n,t){return t})),Ln=function(n){var t,e=!1;return function(){for(var o=[],r=0;r<arguments.length;r++)o[r]=arguments[r];return e||(e=!0,t=n.apply(null,o)),t}},jn=Vn([{strict:[]},{defaultedThunk:["fallbackThunk"]},{asOption:[]},{asDefaultedOptionThunk:["fallbackThunk"]},{mergeWithThunk:["baseThunk"]}]),Un=function(n){return jn.defaultedThunk(o(n))},Wn=function(base){return jn.mergeWithThunk(o(base))},Gn=jn.strict,Xn=jn.asOption,Yn=jn.defaultedThunk,qn=(jn.asDefaultedOptionThunk,jn.mergeWithThunk),Jn=(Vn([{bothErrors:["error1","error2"]},{firstError:["error1","value2"]},{secondError:["value1","error2"]},{bothValues:["value1","value2"]}]),function(n,t){var e;return(e={})[n]=t,e}),Kn=function(n,t){return function(n,t){var e={};return _n(n,(function(n,o){L(t,o)||(e[o]=n)})),e}(n,t)},$n=function(n,t){return Jn(n,t)},Qn=function(n){return function(n){var t={};return G(n,(function(n){t[n.key]=n.value})),t}(n)},Zn=function(n,base){var t,e=function(n){var t=[],e=[];return G(n,(function(n){n.fold((function(n){t.push(n)}),(function(n){e.push(n)}))})),{errors:t,values:e}}(n);return e.errors.length>0?(t=e.errors,ln.error(Q(t))):function(n,base){return 0===n.length?ln.value(base):ln.value(zn(base,Nn.apply(void 0,n)))}(e.values,base)},nt=function(n){return e(yn,Q)(n)},tt=function(n,base){var t=bn(n);return t.errors.length>0?nt(t.errors):function(n,base){return n.length>0?vn(zn(base,Nn.apply(void 0,n))):vn(base)}(t.values,base)},et=function(n){var t=bn(n);return t.errors.length>0?nt(t.errors):vn(t.values)},ot=function(input){return D(input)&&Cn(input).length>100?" removed due to size":JSON.stringify(input,null,2)},it=function(path,n){return yn([{path:path,getErrorInfo:n}])},ut=Vn([{field:["key","okey","presence","prop"]},{state:["okey","instantiator"]}]),at=function(path,n,t){return Fn(n,t).fold((function(){return function(path,n,t){return it(path,(function(){return'Could not find valid *strict* value for "'+n+'" in '+ot(t)}))}(path,t,n)}),vn)},ct=function(n,t,e){var o=Fn(n,t).fold((function(){return e(n)}),r);return vn(o)},st=function(path,n,t,e){return t.fold((function(t,r,c,f){var l=function(n){var o=f.extract(path.concat([t]),e,n);return Sn(o,(function(n){return Jn(r,e(n))}))},d=function(n){return n.fold((function(){var n=Jn(r,e(O.none()));return vn(n)}),(function(n){var o=f.extract(path.concat([t]),e,n);return Sn(o,(function(n){return Jn(r,e(O.some(n)))}))}))};return c.fold((function(){return xn(at(path,n,t),l)}),(function(e){return xn(ct(n,t,e),l)}),(function(){return xn(function(n,t){return vn(Fn(n,t))}(n,t),d)}),(function(e){return xn(function(n,t,e){var o=Fn(n,t).map((function(t){return!0===t?e(n):t}));return vn(o)}(n,t,e),d)}),(function(e){var base=e(n),r=Sn(ct(n,t,o({})),(function(n){return zn(base,n)}));return xn(r,l)}))}),(function(t,o){var r=o(n);return vn(Jn(t,e(r)))}))},ft=function(n){return{extract:function(path,t,e){return wn(n(e,t),(function(n){return function(path,n){return it(path,(function(){return n}))}(path,n)}))},toString:function(){return"val"}}},lt=function(n){return Cn(Dn(n,(function(n){return null!=n})))},mt=function(n){var t=gt(n),e=Y(n,(function(n,t){return t.fold((function(t){return zn(n,$n(t,!0))}),o(n))}),{});return{extract:function(path,n,o){var r=A(o)?[]:lt(o),c=filter(r,(function(n){return!Rn(e,n)}));return 0===c.length?t.extract(path,n,o):function(path,n){return it(path,(function(){return"There are unsupported fields: ["+n.join(", ")+"] specified"}))}(path,c)},toString:t.toString}},gt=function(n){return{extract:function(path,t,e){return function(path,n,t,e){var o=map(t,(function(t){return st(path,n,t,e)}));return tt(o,{})}(path,e,n,t)},toString:function(){return"obj{\n"+map(n,(function(n){return n.fold((function(n,t,e,o){return n+" -> "+o.toString()}),(function(n,t){return"state("+n+")"}))})).join("\n")+"}"}}},pt=function(n){return{extract:function(path,t,e){var o=map(e,(function(a,i){return n.extract(path.concat(["["+i+"]"]),t,a)}));return et(o)},toString:function(){return"array("+n.toString()+")"}}},ht=function(n){return{extract:function(path,t,e){for(var o=[],r=0,c=n;r<c.length;r++){var f=c[r].extract(path,t,e);if(f.stype===w.Value)return f;o.push(f)}return et(o)},toString:function(){return"oneOf("+map(n,(function(n){return n.toString()})).join(", ")+")"}}},vt=function(n,t){return{extract:function(path,e,o){var c=Cn(o),f=function(path,t){return pt(ft(n)).extract(path,r,t)}(path,c);return xn(f,(function(n){var r=map(n,(function(n){return ut.field(n,n,Gn(),t)}));return gt(r).extract(path,e,o)}))},toString:function(){return"setOf("+t.toString()+")"}}},bt=o(ft(vn)),yt=e(pt,gt),xt=ut.state,wt=ut.field,St=function(path,n,input,t,e){return Fn(t,e).fold((function(){return function(path,n,t){return it(path,(function(){return'The chosen schema: "'+t+'" did not exist in branches: '+ot(n)}))}(path,t,e)}),(function(t){return t.extract(path.concat(["branch: "+e]),n,input)}))},kt=function(n,t){return{extract:function(path,e,input){return Fn(input,n).fold((function(){return function(path,n){return it(path,(function(){return'Choice schema did not contain choice key: "'+n+'"'}))}(path,n)}),(function(n){return St(path,e,input,t,n)}))},toString:function(){return"chooseOn("+n+"). Possible values: "+Cn(t)}}},Ct=ft(vn),Ot=function(n){return yt(n)},_t=function(n){return{extract:function(path,t,e){return n().extract(path,t,e)},toString:function(){return n().toString()}}},Tt=function(n){return ft((function(t){return n(t).fold(yn,vn)}))},Et=function(n,t){return vt((function(t){return pn(n(t))}),t)},Dt=function(label,n,t){return hn(function(label,n,t,e){var o=n.extract([label],t,e);return kn(o,(function(n){return{input:e,errors:n}}))}(label,n,r,t))},Bt=function(n){return n.fold((function(n){throw new Error(Mt(n))}),r)},At=function(label,n,t){return Bt(Dt(label,n,t))},Mt=function(n){return"Errors: \n"+(t=n.errors,e=t.length>10?t.slice(0,10).concat([{path:[],getErrorInfo:function(){return"... (only showing first ten failures)"}}]):t,map(e,(function(n){return"Failed path: ("+n.path.join(" > ")+")\n"+n.getErrorInfo()}))).join("\n")+"\n\nInput object: "+ot(n.input);var t,e},Ft=function(n,t){return kt(n,t)},It=function(n,t){return kt(n,Tn(t,gt))},Rt=o(Ct),Vt=function(n,t){return ft((function(a){var e=typeof a;return n(a)?vn(a):yn("Expected type: "+t+" but got: "+e)}))},Pt=Vt(R,"number"),Ht=Vt(E,"string"),zt=Vt(A,"boolean"),Nt=Vt(I,"function"),Lt=function(n){var t=function(n,t){for(var e=n.next();!e.done;){if(!t(e.value))return!1;e=n.next()}return!0};if(Object(n)!==n)return!0;switch({}.toString.call(n).slice(8,-1)){case"Boolean":case"Number":case"String":case"Date":case"RegExp":case"Blob":case"FileList":case"ImageData":case"ImageBitmap":case"ArrayBuffer":return!0;case"Array":case"Object":return Object.keys(n).every((function(t){return Lt(n[t])}));case"Map":return t(n.keys(),Lt)&&t(n.values(),Lt);case"Set":return t(n.keys(),Lt);default:return!1}},jt=ft((function(a){return Lt(a)?vn(a):yn("Expected value to be acceptable for sending via postMessage")})),Ut=function(n){return Tt((function(t){return L(n,t)?ln.value(t):ln.error('Unsupported value: "'+t+'", choose one of "'+n.join(", ")+'".')}))},Wt=function(n){return wt(n,n,Gn(),bt())},Gt=function(n,t){return wt(n,n,Gn(),t)},Xt=function(n){return Gt(n,Pt)},Yt=function(n){return Gt(n,Ht)},qt=function(n,t){return wt(n,n,Gn(),Ut(t))},Jt=function(n){return Gt(n,Nt)},Kt=function(n,t){return wt(n,n,Gn(),gt(t))},$t=function(n,t){return wt(n,n,Gn(),yt(t))},Qt=function(n,t){return wt(n,n,Gn(),pt(t))},option=function(n){return wt(n,n,Xn(),bt())},Zt=function(n,t){return wt(n,n,Xn(),t)},ne=function(n){return Zt(n,Pt)},te=function(n){return Zt(n,Ht)},ee=function(n){return Zt(n,Nt)},oe=function(n,t){return Zt(n,gt(t))},re=function(n,t){return wt(n,n,Un(t),bt())},ie=function(n,t,e){return wt(n,n,Un(t),e)},ue=function(n,t){return ie(n,t,Pt)},ae=function(n,t){return ie(n,t,Ht)},ce=function(n,t,e){return ie(n,t,Ut(e))},se=function(n,t){return ie(n,t,zt)},fe=function(n,t){return ie(n,t,Nt)},le=function(n,t,e){return ie(n,t,pt(e))},de=function(n,t,e){return ie(n,t,gt(e))},me=function(n,t){return xt(n,t)},ge=function(n){var t=n;return{get:function(){return t},set:function(n){t=n}}},pe=function(n){if(null==n)throw new Error("Node cannot be null or undefined");return{dom:n}},he={fromHtml:function(html,n){var div=(n||document).createElement("div");if(div.innerHTML=html,!div.hasChildNodes()||div.childNodes.length>1)throw console.error("HTML does not have a single root node",html),new Error("HTML must have a single root node");return pe(div.childNodes[0])},fromTag:function(n,t){var e=(t||document).createElement(n);return pe(e)},fromText:function(text,n){var t=(n||document).createTextNode(text);return pe(t)},fromDom:pe,fromPoint:function(n,t,e){return O.from(n.dom.elementFromPoint(t,e)).map(pe)}},ve=function(){return be(0,0)},be=function(n,t){return{major:n,minor:t}},ye={nu:be,detect:function(n,t){var e=String(t).toLowerCase();return 0===n.length?ve():function(n,t){var e=function(n,s){for(var i=0;i<n.length;i++){var t=n[i];if(t.test(s))return t}}(n,t);if(!e)return{major:0,minor:0};var o=function(i){return Number(t.replace(e,"$"+i))};return be(o(1),o(2))}(n,e)},unknown:ve},xe=function(n,t){var e=String(t).toLowerCase();return K(n,(function(n){return n.search(e)}))},we=function(n,t){return xe(n,t).map((function(n){var e=ye.detect(n.versionRegexes,t);return{current:n.name,version:e}}))},Se=function(n,t){return xe(n,t).map((function(n){var e=ye.detect(n.versionRegexes,t);return{current:n.name,version:e}}))},ke=function(n,t){return-1!==n.indexOf(t)},Ce=function(n,t){return function(n,t,e){return""===t||n.length>=t.length&&n.substr(e,e+t.length)===t}(n,t,n.length-t.length)},Oe=function(n){return function(s){return s.replace(n,"")}}(/^\s+|\s+$/g),_e=/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,Te=function(n){return function(t){return ke(t,n)}},Ee=[{name:"Edge",versionRegexes:[/.*?edge\/ ?([0-9]+)\.([0-9]+)$/],search:function(n){return ke(n,"edge/")&&ke(n,"chrome")&&ke(n,"safari")&&ke(n,"applewebkit")}},{name:"Chrome",versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/,_e],search:function(n){return ke(n,"chrome")&&!ke(n,"chromeframe")}},{name:"IE",versionRegexes:[/.*?msie\ ?([0-9]+)\.([0-9]+).*/,/.*?rv:([0-9]+)\.([0-9]+).*/],search:function(n){return ke(n,"msie")||ke(n,"trident")}},{name:"Opera",versionRegexes:[_e,/.*?opera\/([0-9]+)\.([0-9]+).*/],search:Te("opera")},{name:"Firefox",versionRegexes:[/.*?firefox\/\ ?([0-9]+)\.([0-9]+).*/],search:Te("firefox")},{name:"Safari",versionRegexes:[_e,/.*?cpu os ([0-9]+)_([0-9]+).*/],search:function(n){return(ke(n,"safari")||ke(n,"mobile/"))&&ke(n,"applewebkit")}}],De=[{name:"Windows",search:Te("win"),versionRegexes:[/.*?windows\ nt\ ?([0-9]+)\.([0-9]+).*/]},{name:"iOS",search:function(n){return ke(n,"iphone")||ke(n,"ipad")},versionRegexes:[/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,/.*cpu os ([0-9]+)_([0-9]+).*/,/.*cpu iphone os ([0-9]+)_([0-9]+).*/]},{name:"Android",search:Te("android"),versionRegexes:[/.*?android\ ?([0-9]+)\.([0-9]+).*/]},{name:"OSX",search:Te("mac os x"),versionRegexes:[/.*?mac\ os\ x\ ?([0-9]+)_([0-9]+).*/]},{name:"Linux",search:Te("linux"),versionRegexes:[]},{name:"Solaris",search:Te("sunos"),versionRegexes:[]},{name:"FreeBSD",search:Te("freebsd"),versionRegexes:[]},{name:"ChromeOS",search:Te("cros"),versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/]}],Be={browsers:o(Ee),oses:o(De)},Ae=function(n){var t=n.current,e=n.version,o=function(n){return function(){return t===n}};return{current:t,version:e,isEdge:o("Edge"),isChrome:o("Chrome"),isIE:o("IE"),isOpera:o("Opera"),isFirefox:o("Firefox"),isSafari:o("Safari")}},Me={unknown:function(){return Ae({current:void 0,version:ye.unknown()})},nu:Ae,edge:o("Edge"),chrome:o("Chrome"),ie:o("IE"),opera:o("Opera"),firefox:o("Firefox"),safari:o("Safari")},Fe=function(n){var t=n.current,e=n.version,o=function(n){return function(){return t===n}};return{current:t,version:e,isWindows:o("Windows"),isiOS:o("iOS"),isAndroid:o("Android"),isOSX:o("OSX"),isLinux:o("Linux"),isSolaris:o("Solaris"),isFreeBSD:o("FreeBSD"),isChromeOS:o("ChromeOS")}},Ie={unknown:function(){return Fe({current:void 0,version:ye.unknown()})},nu:Fe,windows:o("Windows"),ios:o("iOS"),android:o("Android"),linux:o("Linux"),osx:o("OSX"),solaris:o("Solaris"),freebsd:o("FreeBSD"),chromeos:o("ChromeOS")},Re=function(n,t){var e=Be.browsers(),r=Be.oses(),c=we(e,n).fold(Me.unknown,Me.nu),f=Se(r,n).fold(Ie.unknown,Ie.nu),l=function(n,t,e,r){var c=n.isiOS()&&!0===/ipad/i.test(e),f=n.isiOS()&&!c,l=n.isiOS()||n.isAndroid(),d=l||r("(pointer:coarse)"),m=c||!f&&l&&r("(min-device-width:768px)"),h=f||l&&!m,v=t.isSafari()&&n.isiOS()&&!1===/safari/i.test(e),y=!h&&!m&&!v;return{isiPad:o(c),isiPhone:o(f),isTablet:o(m),isPhone:o(h),isTouch:o(d),isAndroid:n.isAndroid,isiOS:n.isiOS,isWebView:o(v),isDesktop:o(y)}}(f,c,n,t);return{browser:c,os:f,deviceType:l}},Ve=function(n){return window.matchMedia(n).matches},Pe=Ln((function(){return Re(navigator.userAgent,Ve)})),He=function(){return Pe()},ze=function(element,n){var t=element.dom;if(1!==t.nodeType)return!1;var e=t;if(void 0!==e.matches)return e.matches(n);if(void 0!==e.msMatchesSelector)return e.msMatchesSelector(n);if(void 0!==e.webkitMatchesSelector)return e.webkitMatchesSelector(n);if(void 0!==e.mozMatchesSelector)return e.mozMatchesSelector(n);throw new Error("Browser lacks native selectors")},Ne=function(n){return 1!==n.nodeType&&9!==n.nodeType&&11!==n.nodeType||0===n.childElementCount},Le=function(n,t){return n.dom===t.dom},je=function(n,t){return function(a,b){return function(a,b,n){return 0!=(a.compareDocumentPosition(b)&n)}(a,b,Node.DOCUMENT_POSITION_CONTAINED_BY)}(n.dom,t.dom)},Ue=function(n,t){return He().browser.isIE()?je(n,t):function(n,t){var e=n.dom,o=t.dom;return e!==o&&e.contains(o)}(n,t)},We=function(n){return I(n)?n:d},Ge=function(n,t,e){for(var element=n.dom,o=We(e);element.parentNode;){element=element.parentNode;var r=he.fromDom(element),c=t(r);if(c.isSome())return c;if(o(r))break}return O.none()},Xe=function(n,t,e){var o=t(n),r=We(e);return o.orThunk((function(){return r(n)?O.none():Ge(n,t,r)}))},Ye=function(component,n){return Le(component.element,n.event.target)},qe=function(n){if(!Rn(n,"can")&&!Rn(n,"abort")&&!Rn(n,"run"))throw new Error("EventHandler defined by: "+JSON.stringify(n,null,2)+" does not have can, abort, or run!");return At("Extracting event.handler",mt([re("can",m),re("abort",d),re("run",t)]),n)},Je=function(n){var t=function(n,t){return function(){for(var e=[],o=0;o<arguments.length;o++)e[o]=arguments[o];return J(n,(function(n,o){return n&&t(o).apply(void 0,e)}),!0)}}(n,(function(n){return n.can})),e=function(n,t){return function(){for(var e=[],o=0;o<arguments.length;o++)e[o]=arguments[o];return J(n,(function(n,o){return n||t(o).apply(void 0,e)}),!1)}}(n,(function(n){return n.abort}));return qe({can:t,abort:e,run:function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];G(n,(function(n){n.run.apply(void 0,t)}))}})},Ke=o,$e=Ke("touchstart"),Qe=Ke("touchmove"),Ze=Ke("touchend"),no=Ke("touchcancel"),to=Ke("mousedown"),eo=Ke("mousemove"),oo=Ke("mouseout"),ro=Ke("mouseup"),io=Ke("mouseover"),uo=Ke("focusin"),ao=Ke("focusout"),co=Ke("keydown"),so=Ke("keyup"),input=Ke("input"),fo=Ke("change"),lo=Ke("click"),mo=Ke("transitionend"),go=Ke("selectstart"),po=function(n){return o("alloy."+n)},ho={tap:po("tap")},vo=po("focus"),bo=po("blur.post"),yo=po("paste.post"),xo=po("receive"),wo=po("execute"),So=po("focus.item"),ko=ho.tap,Co=po("longpress"),Oo=po("sandbox.close"),_o=po("typeahead.cancel"),To=po("system.init"),Eo=po("system.touchmove"),Do=po("system.touchend"),Bo=po("system.scroll"),Ao=po("system.resize"),Mo=po("system.attached"),Fo=po("system.detached"),Io=po("system.dismissRequested"),Ro=po("system.repositionRequested"),Vo=po("focusmanager.shifted"),Po=po("slotcontainer.visibility"),Ho=po("change.tab"),zo=po("dismiss.tab"),No=po("highlight"),Lo=po("dehighlight"),jo=function(component,n){Xo(component,component.element,n,{})},Uo=function(component,n,t){Xo(component,component.element,n,t)},Wo=function(component){jo(component,wo())},Go=function(component,n,t){Xo(component,n,t,{})},Xo=function(component,n,t,e){var data=v({target:n},e);component.getSystem().triggerEvent(t,n,data)},Yo=function(component,n,t,e){component.getSystem().triggerEvent(t,n,e.event)},qo=function(n){return Qn(n)},Jo=function(n,t){return{key:n,value:qe({abort:t})}},Ko=function(n){return{key:n,value:qe({run:function(component,n){n.event.prevent()}})}},$o=function(n,t){return{key:n,value:qe({run:t})}},Qo=function(n,t,e){return{key:n,value:qe({run:function(component,n){t.apply(void 0,[component,n].concat(e))}})}},Zo=function(n){return function(t){return{key:n,value:qe({run:function(component,n){Ye(component,n)&&t(component,n)}})}}},nr=function(n,t,e){return function(n,t){return $o(n,(function(component,e){component.getSystem().getByUid(t).each((function(t){Yo(t,t.element,n,e)}))}))}(n,t.partUids[e])},er=function(n,t){return $o(n,(function(component,n){var e=n.event,o=component.getSystem().getByDom(e.target).fold((function(){return Xe(e.target,(function(n){return component.getSystem().getByDom(n).toOptional()}),d).getOr(component)}),(function(n){return n}));t(component,o,n)}))},or=function(n){return $o(n,(function(component,n){n.cut()}))},rr=function(n){return $o(n,(function(component,n){n.stop()}))},ir=function(n,t){return Zo(n)(t)},ur=Zo(Mo()),ar=Zo(Fo()),cr=Zo(To()),sr=function(n){return function(t){return $o(n,t)}}(wo()),fr=("undefined"!=typeof window?window:Function("return this;")(),function(element){return element.dom.nodeName.toLowerCase()}),lr=function(n){return function(element){return function(element){return element.dom.nodeType}(element)===n}},dr=lr(1),mr=lr(3),gr=lr(9),pr=lr(11),vr=function(element){return he.fromDom(element.dom.ownerDocument)},yr=function(n){return gr(n)?n:vr(n)},xr=function(element){return he.fromDom(yr(element).dom.documentElement)},wr=function(element){return he.fromDom(yr(element).dom.defaultView)},Sr=function(element){return O.from(element.dom.parentNode).map(he.fromDom)},kr=function(element){return O.from(element.dom.offsetParent).map(he.fromDom)},Cr=function(element){return map(element.dom.childNodes,he.fromDom)},Or=function(element,n){var t=element.dom.childNodes;return O.from(t[n]).map(he.fromDom)},_r=function(marker,element){Sr(marker).each((function(n){n.dom.insertBefore(element.dom,marker.dom)}))},Tr=function(marker,element){(function(element){return O.from(element.dom.nextSibling).map(he.fromDom)})(marker).fold((function(){Sr(marker).each((function(n){Dr(n,element)}))}),(function(n){_r(n,element)}))},Er=function(n,element){(function(element){return Or(element,0)})(n).fold((function(){Dr(n,element)}),(function(t){n.dom.insertBefore(element.dom,t.dom)}))},Dr=function(n,element){n.dom.appendChild(element.dom)},Br=function(n,t){G(t,(function(t){Dr(n,t)}))},Ar=function(element){element.dom.textContent="",G(Cr(element),(function(n){Mr(n)}))},Mr=function(element){var n=element.dom;null!==n.parentNode&&n.parentNode.removeChild(n)},Fr=function(n){var marker,t=Cr(n);t.length>0&&(marker=n,G(t,(function(n){_r(marker,n)}))),Mr(n)},Ir=function(element){return element.dom.innerHTML},Rr=function(element,content){var html,div,n=vr(element).dom,t=he.fromDom(n.createDocumentFragment()),e=(html=content,(div=(n||document).createElement("div")).innerHTML=html,Cr(he.fromDom(div)));Br(t,e),Ar(element),Dr(element,t)},Vr=function(n,t,e){if(!(E(e)||A(e)||R(e)))throw console.error("Invalid call to Attribute.set. Key ",t,":: Value ",e,":: Element ",n),new Error("Attribute value was not simple");n.setAttribute(t,e+"")},Pr=function(element,n,t){Vr(element.dom,n,t)},Hr=function(element,n){var t=element.dom.getAttribute(n);return null===t?void 0:t},zr=function(element,n){return O.from(Hr(element,n))},Nr=function(element,n){var t=element.dom;return!(!t||!t.hasAttribute)&&t.hasAttribute(n)},Lr=function(element,n){element.dom.removeAttribute(n)},jr=function(n){return function(n,t){return he.fromDom(n.dom.cloneNode(t))}(n,!1)},Ur=function(element){return function(element){var n=he.fromTag("div"),t=he.fromDom(element.dom.cloneNode(!0));return Dr(n,t),Ir(n)}(jr(element))},element=function(n){return Ur(n)},Wr=qo([function(n,t){return{key:n,value:qe({can:t})}}(vo(),(function(component,n){var t=n.event,e=t.originator,o=t.target;return!function(component,n,t){return Le(n,component.element)&&!Le(n,t)}(component,e,o)||(console.warn(vo()+" did not get interpreted by the desired target. \nOriginator: "+element(e)+"\nTarget: "+element(o)+"\nCheck the "+vo()+" event handlers"),!1)}))]),Gr=Object.freeze({__proto__:null,events:Wr}),Xr=0,Yr=function(n){var time=(new Date).getTime();return n+"_"+Math.floor(1e9*Math.random())+ ++Xr+String(time)},qr=o("alloy-id-"),Jr=o("data-alloy-id"),Kr=qr(),$r=Jr(),Qr=function(n,t){Object.defineProperty(n.dom,$r,{value:t,writable:!0})},Zr=function(n){var t=dr(n)?n.dom[$r]:null;return O.from(t)},ni=function(n){return Yr(n)},ti=r,ei=function(n){var t=function(t){return function(){throw new Error("The component must be in a context to send: "+t+(n?"\n"+element(n().element)+" is not in context.":""))}};return{debugInfo:o("fake"),triggerEvent:t("triggerEvent"),triggerFocus:t("triggerFocus"),triggerEscape:t("triggerEscape"),build:t("build"),addToWorld:t("addToWorld"),removeFromWorld:t("removeFromWorld"),addToGui:t("addToGui"),removeFromGui:t("removeFromGui"),getByUid:t("getByUid"),getByDom:t("getByDom"),broadcast:t("broadcast"),broadcastOn:t("broadcastOn"),broadcastEvent:t("broadcastEvent"),isConnected:d}},oi=ei(),ri=function(n){return map(n,(function(p){return Ce(p,"/*")?p.substring(0,p.length-"/*".length):p}))},ii=function(n,t){var e=n.toString(),o=e.indexOf(")")+1,r=e.indexOf("("),c=e.substring(r+1,o-1).split(/,\s*/);return n.toFunctionAnnotation=function(){return{name:t,parameters:ri(c)}},n},ui=Yr("alloy-premade"),ai=function(n){return $n(ui,n)},ci=function(n){return function(n,t){var e=t.toString(),o=e.indexOf(")")+1,r=e.indexOf("("),c=e.substring(r+1,o-1).split(/,\s*/);return n.toFunctionAnnotation=function(){return{name:"OVERRIDE",parameters:ri(c.slice(1))}},n}((function(component){for(var t=[],e=1;e<arguments.length;e++)t[e-1]=arguments[e];return n.apply(void 0,x([component.getApis(),component],t))}),n)},si={init:function(){return fi({readState:function(){return"No State required"}})}},fi=function(n){return n},di=function(data,n){var t={};return _n(data,(function(e,o){_n(e,(function(e,r){var c=Fn(t,r).getOr([]);t[r]=c.concat([n(o,e)])}))})),t},mi=function(s){return{classes:void 0!==s.classes?s.classes:[],attributes:void 0!==s.attributes?s.attributes:{},styles:void 0!==s.styles?s.styles:{}}},gi=function(n){return n.cHandler},pi=function(n,t){return{name:n,handler:t}},hi=function(n,t,base){var e=v(v({},base),function(n,t){var e={};return G(n,(function(n){e[n.name()]=n.handlers(t)})),e}(t,n));return di(e,pi)},vi=function(n){var t=function(n){return I(n)?{can:o(!0),abort:o(!1),run:n}:n}(n);return function(component,n){for(var e=[],o=2;o<arguments.length;o++)e[o-2]=arguments[o];var r=[component,n].concat(e);t.abort.apply(void 0,r)?n.stop():t.can.apply(void 0,r)&&t.run.apply(void 0,r)}},bi=function(n,t,e){var o=t[e];return o?function(label,n,t,e){try{var o=on(t,(function(a,b){var t=a[n],o=b[n],r=e.indexOf(t),c=e.indexOf(o);if(-1===r)throw new Error("The ordering for "+label+" does not have an entry for "+t+".\nOrder specified: "+JSON.stringify(e,null,2));if(-1===c)throw new Error("The ordering for "+label+" does not have an entry for "+o+".\nOrder specified: "+JSON.stringify(e,null,2));return r<c?-1:c<r?1:0}));return ln.value(o)}catch(n){return ln.error([n])}}("Event: "+e,"name",n,o).map((function(n){var t=map(n,(function(n){return n.handler}));return Je(t)})):function(n,t){return ln.error(["The event ("+n+') has more than one behaviour that listens to it.\nWhen this occurs, you must specify an event ordering for the behaviours in your spec (e.g. [ "listing", "toggling" ]).\nThe behaviours that can trigger it are: '+JSON.stringify(map(t,(function(n){return n.name})),null,2)])}(e,n)},yi=function(n,t){var e=Bn(n,(function(n,e){return(1===n.length?ln.value(n[0].handler):bi(n,t,e)).map((function(o){var r=vi(o),c=n.length>1?filter(t[e],(function(t){return j(n,(function(n){return n.name===t}))})).join(" > "):n[0].name;return $n(e,function(n,t){return{handler:n,purpose:t}}(r,c))}))}));return Zn(e,{})},xi="alloy.base.behaviour",wi=function(n){return n.events},Si=function(element,n){var t=Hr(element,n);return void 0===t||""===t?[]:t.split(" ")},ki=function(element){return void 0!==element.dom.classList},Ci=function(element,n){return function(element,n,t){var e=Si(element,n).concat([t]);return Pr(element,n,e.join(" ")),!0}(element,"class",n)},Oi=function(element,n){return function(element,n,t){var e=filter(Si(element,n),(function(n){return n!==t}));return e.length>0?Pr(element,n,e.join(" ")):Lr(element,n),!1}(element,"class",n)},_i=function(element,n){ki(element)?element.dom.classList.add(n):Ci(element,n)},Ti=function(element){0===(ki(element)?element.dom.classList:function(element){return Si(element,"class")}(element)).length&&Lr(element,"class")},Ei=function(element,n){ki(element)?element.dom.classList.remove(n):Oi(element,n);Ti(element)},Di=function(element,n){return ki(element)&&element.dom.classList.contains(n)},Bi=function(element,n){G(n,(function(n){_i(element,n)}))},Ai=function(element,n){G(n,(function(n){Ei(element,n)}))},Mi=function(n){return void 0!==n.style&&I(n.style.getPropertyValue)},Fi=function(n){return pr(n)},Ii=I(Element.prototype.attachShadow)&&I(Node.prototype.getRootNode),Ri=o(Ii),Vi=Ii?function(n){return he.fromDom(n.dom.getRootNode())}:yr,Pi=function(n){return Fi(n)?n:he.fromDom(yr(n).dom.body)},Hi=function(n){var t=Vi(n);return Fi(t)?O.some(t):O.none()},zi=function(n){return he.fromDom(n.dom.host)},Ni=function(element){return F(element.dom.shadowRoot)},Li=function(element){var n=mr(element)?element.dom.parentNode:element.dom;if(null==n||null===n.ownerDocument)return!1;var t,e,o=n.ownerDocument;return Hi(he.fromDom(n)).fold((function(){return o.body.contains(n)}),(t=Li,e=zi,function(a){return t(e(a))}))},body=function(){return ji(he.fromDom(document))},ji=function(n){var b=n.dom.body;if(null==b)throw new Error("Body is not available yet");return he.fromDom(b)},Ui=function(n,t,e){if(!E(e))throw console.error("Invalid call to CSS.set. Property ",t,":: Value ",e,":: Element ",n),new Error("CSS value must be a string: "+e);Mi(n)&&n.style.setProperty(t,e)},Wi=function(n,t){Mi(n)&&n.style.removeProperty(t)},Gi=function(element,n,t){var e=element.dom;Ui(e,n,t)},Xi=function(element,n){var t=element.dom;_n(n,(function(n,e){Ui(t,e,n)}))},Yi=function(element,n){var t=element.dom;_n(n,(function(n,e){n.fold((function(){Wi(t,e)}),(function(n){Ui(t,e,n)}))}))},qi=function(element,n){var t=element.dom,e=window.getComputedStyle(t).getPropertyValue(n);return""!==e||Li(element)?e:Ji(t,n)},Ji=function(n,t){return Mi(n)?n.style.getPropertyValue(t):""},Ki=function(element,n){var t=element.dom,e=Ji(t,n);return O.from(e).filter((function(n){return n.length>0}))},$i=function(element){var n={},t=element.dom;if(Mi(t))for(var i=0;i<t.style.length;i++){var e=t.style.item(i);n[e]=t.style[e]}return n},Qi=function(n,t,e){var element=he.fromTag(n);return Gi(element,t,e),Ki(element,t).isSome()},Zi=function(element,n){var t=element.dom;Wi(t,n),zr(element,"style").map(Oe).is("")&&Lr(element,"style")},nu=function(n){return n.dom.offsetWidth},tu=function(element){return element.dom.value},eu=function(element,n){if(void 0===n)throw new Error("Value.set was undefined");element.dom.value=n},ou=function(n){var t=he.fromTag(n.tag);!function(element,n){var t=element.dom;_n(n,(function(n,e){Vr(t,e,n)}))}(t,n.attributes),Bi(t,n.classes),Xi(t,n.styles),n.innerHtml.each((function(html){return Rr(t,html)}));var e=n.domChildren;return Br(t,e),n.value.each((function(n){eu(t,n)})),n.uid,Qr(t,n.uid),t},ru=function(n,t){return function(n,t){var e=map(t,(function(a){return oe(a.name(),[Wt("config"),re("state",si)])})),o=Dt("component.behaviours",gt(e),n.behaviours).fold((function(t){throw new Error(Mt(t)+"\nComplete spec:\n"+JSON.stringify(n,null,2))}),(function(n){return n}));return{list:t,data:Tn(o,(function(n){var output=n.map((function(n){return{config:n.config,state:n.state.init(n.config)}}));return function(){return output}}))}}(n,t)},iu=function(n){var t=function(n){var t=Fn(n,"behaviours").getOr({}),e=filter(Cn(t),(function(n){return void 0!==t[n]}));return map(e,(function(n){return t[n].me}))}(n);return ru(n,t)},uu=function(n,t,e){var o,r,c,f=v(v({},(o=n).dom),{uid:o.uid,domChildren:map(o.components,(function(n){return n.element}))}),l=function(n){return n.domModification.fold((function(){return mi({})}),mi)}(n),d={"alloy.base.modification":l},m=t.length>0?function(n,t,e,base){var o=v({},t);G(e,(function(t){o[t.name()]=t.exhibit(n,base)}));var r=di(o,(function(n,t){return{name:n,modification:t}})),c=function(n){return Y(n,(function(b,a){return v(v({},a.modification),b)}),{})},f=Y(r.classes,(function(b,a){return a.modification.concat(b)}),[]),l=c(r.attributes),d=c(r.styles);return mi({classes:f,attributes:l,styles:d})}(e,d,t,f):l;return c=m,v(v({},r=f),{attributes:v(v({},r.attributes),c.attributes),styles:v(v({},r.styles),c.styles),classes:r.classes.concat(c.classes)})},au=function(n,t,e){var o={"alloy.base.behaviour":wi(n)};return function(n,t,e,base){var o=hi(n,e,base);return yi(o,t)}(e,n.eventOrder,t,o).getOrDie()},cu=function(n){var t=function(){return v},e=ge(oi),o=Bt(function(n){var t;return Dt("custom.definition",gt([wt("dom","dom",Gn(),gt([Wt("tag"),re("styles",{}),re("classes",[]),re("attributes",{}),option("value"),option("innerHtml")])),Wt("components"),Wt("uid"),re("events",{}),re("apis",{}),wt("eventOrder","eventOrder",Wn((t={},t[wo()]=["disabling",xi,"toggling","typeaheadevents"],t[vo()]=[xi,"focusing","keying"],t[To()]=[xi,"disabling","toggling","representing"],t[input()]=[xi,"representing","streaming","invalidating"],t[Fo()]=[xi,"representing","item-events","tooltipping"],t[to()]=["focusing",xi,"item-type-events"],t[$e()]=["focusing",xi,"item-type-events"],t[io()]=["item-type-events","tooltipping"],t[xo()]=["receiving","reflecting","tooltipping"],t)),Rt()),option("domModification")]),n)}(n)),r=iu(n),c=function(n){return n.list}(r),f=function(n){return n.data}(r),l=uu(o,c,f),d=ou(l),m=au(o,c,f),h=ge(o.components),v={getSystem:e.get,config:function(t){var b=f;return(I(b[t.name()])?b[t.name()]:function(){throw new Error("Could not find "+t.name()+" in "+JSON.stringify(n,null,2))})()},hasConfigured:function(n){return I(f[n.name()])},spec:n,readState:function(n){return f[n]().map((function(b){return b.state.readState()})).getOr("not enabled")},getApis:function(){return o.apis},connect:function(n){e.set(n)},disconnect:function(){e.set(ei(t))},element:d,syncComponents:function(){var n=Cr(d),t=Z(n,(function(n){return e.get().getByDom(n).fold((function(){return[]}),(function(n){return[n]}))}));h.set(t)},components:h.get,events:m};return v},su=function(n){var t=ti(n),e=t.events,o=y(t,["events"]),r=function(n){var t=Fn(n,"components").getOr([]);return map(t,du)}(o),c=v(v({},o),{events:v(v({},Gr),e),components:r});return ln.value(cu(c))},text=function(n){var element=he.fromText(n);return fu({element:element})},fu=function(n){var e=At("external.component",mt([Wt("element"),option("uid")]),n),r=ge(ei());e.uid.each((function(n){Qr(e.element,n)}));var c={getSystem:r.get,config:O.none,hasConfigured:d,connect:function(n){r.set(n)},disconnect:function(){r.set(ei((function(){return c})))},getApis:function(){return{}},element:e.element,spec:n,readState:o("No state"),syncComponents:t,components:o([]),events:{}};return ai(c)},lu=ni,du=function(n){return function(n){return Fn(n,ui)}(n).fold((function(){var t=n.hasOwnProperty("uid")?n:v({uid:lu("")},n);return su(t).getOrDie()}),(function(n){return n}))},mu=ai;function gu(n,t){var e=function(element){var e=t(element);if(e<=0||null===e){var o=qi(element,n);return parseFloat(o)||0}return e},o=function(element,n){return J(n,(function(n,t){var e=qi(element,t),o=void 0===e?0:parseInt(e,10);return isNaN(o)?n:n+o}),0)};return{set:function(element,t){if(!R(t)&&!t.match(/^[0-9]+$/))throw new Error(n+".set accepts only positive integer values. Value was "+t);var e=element.dom;Mi(e)&&(e.style[n]=t+"px")},get:e,getOuter:e,aggregate:o,max:function(element,n,t){var e=o(element,t);return n>e?n-e:0}}}var pu=gu("height",(function(element){var n=element.dom;return Li(element)?n.getBoundingClientRect().height:n.offsetHeight})),hu=function(element){return pu.get(element)},vu=function(element){return pu.getOuter(element)},bu=function(n,t){return{left:n,top:t,translate:function(e,o){return bu(n+e,t+o)}}},yu=bu,xu=function(a,b){return void 0!==a?a:void 0!==b?b:0},wu=function(element){var n=element.dom.ownerDocument,body=n.body,t=n.defaultView,html=n.documentElement;if(body===element.dom)return yu(body.offsetLeft,body.offsetTop);var e=xu(null==t?void 0:t.pageYOffset,html.scrollTop),o=xu(null==t?void 0:t.pageXOffset,html.scrollLeft),r=xu(html.clientTop,body.clientTop),c=xu(html.clientLeft,body.clientLeft);return Su(element).translate(o-c,e-r)},Su=function(element){var n=element.dom,body=n.ownerDocument.body;return body===n?yu(body.offsetLeft,body.offsetTop):Li(element)?function(n){var t=n.getBoundingClientRect();return yu(t.left,t.top)}(n):yu(0,0)},ku=gu("width",(function(element){return element.dom.offsetWidth})),Cu=function(element){return ku.get(element)},Ou=function(element){return ku.getOuter(element)},_u=function(n){var t=he.fromDom(function(n){if(Ri()&&F(n.target)){var t=he.fromDom(n.target);if(dr(t)&&Ni(t)&&n.composed&&n.composedPath){var e=n.composedPath();if(e)return head(e)}}return O.from(n.target)}(n).getOr(n.target)),o=function(){return n.stopPropagation()},r=function(){return n.preventDefault()},c=e(r,o);return function(n,t,e,o,r,c,f){return{target:n,x:t,y:e,stop:o,prevent:r,kill:c,raw:f}}(t,n.clientX,n.clientY,o,r,c,n)},Tu=function(element,n,filter,t,e){var o=function(filter,n){return function(t){filter(t)&&n(_u(t))}}(filter,t);return element.dom.addEventListener(n,o,e),{unbind:c(Eu,element,n,o,e)}},Eu=function(element,n,t,e){element.dom.removeEventListener(n,t,e)},Du=function(n){var t=void 0!==n?n.dom:document,e=t.body.scrollLeft||t.documentElement.scrollLeft,o=t.body.scrollTop||t.documentElement.scrollTop;return yu(e,o)},Bu=function(n,t,e){var o=(void 0!==e?e.dom:document).defaultView;o&&o.scrollTo(n,t)},Au=function(n,t,e,o){return{x:n,y:t,width:e,height:o,right:n+e,bottom:t+o}},Mu=function(n){var t=void 0===n?window:n,e=t.document,o=Du(he.fromDom(e));return function(n){var t=void 0===n?window:n;return O.from(t.visualViewport)}(t).fold((function(){var html=t.document.documentElement,n=html.clientWidth,e=html.clientHeight;return Au(o.left,o.top,n,e)}),(function(n){return Au(Math.max(n.pageLeft,o.left),Math.max(n.pageTop,o.top),n.width,n.height)}))},Fu=function(n,t){return n.view(t).fold(o([]),(function(t){var e=n.owner(t),o=Fu(n,e);return[t].concat(o)}))},Iu=Object.freeze({__proto__:null,view:function(n){var t;return(n.dom===document?O.none():O.from(null===(t=n.dom.defaultView)||void 0===t?void 0:t.frameElement)).map(he.fromDom)},owner:function(element){return vr(element)}}),Ru=function(element){var n=he.fromDom(document),t=Du(n);return function(element,n){var t=n.owner(element),e=Fu(n,t);return O.some(e)}(element,Iu).fold(c(wu,element),(function(n){var e=Su(element),o=Y(n,(function(b,a){var n=Su(a);return{left:b.left+n.left,top:b.top+n.top}}),{left:0,top:0});return yu(o.left+e.left+t.left,o.top+e.top+t.top)}))},Vu=function(n,t,e,o){return{x:n,y:t,width:e,height:o,right:n+e,bottom:t+o}},Pu=function(element){var n=wu(element),t=Ou(element),e=vu(element);return Vu(n.left,n.top,t,e)},Hu=function(element){var n=Ru(element),t=Ou(element),e=vu(element);return Vu(n.left,n.top,t,e)},zu=function(){return Mu(window)};function Nu(n,t,e,a,o){return n(e,a)?O.some(e):I(o)&&o(e)?O.none():t(e,a,o)}var Lu,ju=function(n,t,e){for(var element=n.dom,o=I(e)?e:d;element.parentNode;){element=element.parentNode;var r=he.fromDom(element);if(t(r))return O.some(r);if(o(r))break}return O.none()},Uu=function(n,t,e){return Nu((function(s,n){return n(s)}),ju,n,t,e)},Wu=function(n,t,e){return Uu(n,t,e).isSome()},Gu=function(n,t,e){return ju(n,(function(n){return ze(n,t)}),e)},Xu=function(n,t){return function(n,t){var base=void 0===t?document:t.dom;return Ne(base)?O.none():O.from(base.querySelector(n)).map(he.fromDom)}(t,n)},Yu=function(n,t,e){return Nu((function(element,n){return ze(element,n)}),Gu,n,t,e)},qu=function(){var n=Yr("aria-owns");return{id:n,link:function(t){Pr(t,"aria-owns",n)},unlink:function(n){Lr(n,"aria-owns")}}},Ju=function(component,n){return function(n){return Uu(n,(function(n){if(!dr(n))return!1;var t=Hr(n,"id");return void 0!==t&&t.indexOf("aria-owns")>-1})).bind((function(n){var t=Hr(n,"id"),e=Vi(n);return Xu(e,'[aria-owns="'+t+'"]')}))}(n).exists((function(n){return Ku(component,n)}))},Ku=function(component,n){return Wu(n,(function(n){return Le(n,component.element)}),d)||Ju(component,n)};!function(n){n[n.STOP=0]="STOP",n[n.NORMAL=1]="NORMAL",n[n.LOGGING=2]="LOGGING"}(Lu||(Lu={}));var $u,Qu=ge({}),Zu=function(n,t,e){switch(Fn(Qu.get(),n).orThunk((function(){var t=Cn(Qu.get());return cn(t,(function(p){return n.indexOf(p)>-1?O.some(Qu.get()[p]):O.none()}))})).getOr(Lu.NORMAL)){case Lu.NORMAL:return e(ta());case Lu.LOGGING:var o=function(n,t){var e=[],o=(new Date).getTime();return{logEventCut:function(n,t,o){e.push({outcome:"cut",target:t,purpose:o})},logEventStopped:function(n,t,o){e.push({outcome:"stopped",target:t,purpose:o})},logNoParent:function(n,t,o){e.push({outcome:"no-parent",target:t,purpose:o})},logEventNoHandlers:function(n,t){e.push({outcome:"no-handlers-left",target:t})},logEventResponse:function(n,t,o){e.push({outcome:"response",purpose:o,target:t})},write:function(){var r=(new Date).getTime();L(["mousemove","mouseover","mouseout",To()],n)||console.log(n,{event:n,time:r-o,target:t.dom,sequence:map(e,(function(s){return L(["cut","stopped","response"],s.outcome)?"{"+s.purpose+"} "+s.outcome+" at ("+element(s.target)+")":s.outcome}))})}}}(n,t),output=e(o);return o.write(),output;case Lu.STOP:return!0}},path=["alloy/data/Fields","alloy/debugging/Debugging"],na=function(n,t,e){return Zu(n,t,e)},ta=o({logEventCut:t,logEventStopped:t,logNoParent:t,logEventNoHandlers:t,logEventResponse:t,write:t}),ea=o([Wt("menu"),Wt("selectedMenu")]),oa=o([Wt("item"),Wt("selectedItem")]),ra=(o(gt(oa().concat(ea()))),o(gt(oa()))),ia=Kt("initSize",[Wt("numColumns"),Wt("numRows")]),ua=function(){return Kt("markers",[Wt("backgroundMenu")].concat(ea()).concat(oa()))},aa=function(n){return Kt("markers",map(n,Wt))},ca=function(label,n,t){!function(){var n=new Error;if(void 0!==n.stack){var t=n.stack.split("\n");return K(t,(function(line){return line.indexOf("alloy")>0&&!j(path,(function(p){return line.indexOf(p)>-1}))})).getOr("unknown")}}();return wt(n,n,t,Tt((function(n){return ln.value((function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return n.apply(void 0,t)}))})))},sa=function(n){return ca(0,n,Un(t))},fa=function(n){return ca(0,n,Un(O.none))},la=function(n){return ca(0,n,Gn())},da=function(n){return ca(0,n,Gn())},output=function(n,t){return me(n,o(t))},ma=function(n){return me(n,r)},ga=o(ia),pa=function(n,t,e,o,r,label){return{x:n,y:t,bubble:e,direction:o,boundsRestriction:r,label:label}},ha=Vn([{southeast:[]},{southwest:[]},{northeast:[]},{northwest:[]},{south:[]},{north:[]},{east:[]},{west:[]}]),va=ha.southeast,ba=ha.southwest,ya=ha.northeast,xa=ha.northwest,wa=ha.south,Sa=ha.north,ka=ha.east,Ca=ha.west,Oa=function(n,t){return function(n,t){for(var e={},i=0,o=n.length;i<o;i++){var r=n[i];e[String(r)]=t(r,i)}return e}(["left","right","top","bottom"],(function(e){return Fn(t,e).map((function(t){return function(n,t){switch(t){case 1:return n.x;case 0:return n.x+n.width;case 2:return n.y;case 3:return n.y+n.height}}(n,t)}))}))},_a=function(n){return n.x},Ta=function(n,element){return n.x+n.width/2-element.width/2},Ea=function(n,element){return n.x+n.width-element.width},Da=function(n,element){return n.y-element.height},Ba=function(n){return n.y+n.height},Aa=function(n,element){return n.y+n.height/2-element.height/2},Ma=function(n,element,t){return pa(_a(n),Ba(n),t.southeast(),va(),Oa(n,{left:1,top:3}),"layout-se")},Fa=function(n,element,t){return pa(Ea(n,element),Ba(n),t.southwest(),ba(),Oa(n,{right:0,top:3}),"layout-sw")},Ia=function(n,element,t){return pa(_a(n),Da(n,element),t.northeast(),ya(),Oa(n,{left:1,bottom:2}),"layout-ne")},Ra=function(n,element,t){return pa(Ea(n,element),Da(n,element),t.northwest(),xa(),Oa(n,{right:0,bottom:2}),"layout-nw")},Va=function(n,element,t){return pa(Ta(n,element),Da(n,element),t.north(),Sa(),Oa(n,{bottom:2}),"layout-n")},Pa=function(n,element,t){return pa(Ta(n,element),Ba(n),t.south(),wa(),Oa(n,{top:3}),"layout-s")},Ha=function(n,element,t){return pa(function(n){return n.x+n.width}(n),Aa(n,element),t.east(),ka(),Oa(n,{left:0}),"layout-e")},za=function(n,element,t){return pa(function(n,element){return n.x-element.width}(n,element),Aa(n,element),t.west(),Ca(),Oa(n,{right:1}),"layout-w")},Na=function(){return[Ma,Fa,Ia,Ra,Pa,Va,Ha,za]},La=function(){return[Fa,Ma,Ra,Ia,Pa,Va,Ha,za]},ja=function(){return[Ia,Ra,Ma,Fa,Va,Pa]},Ua=function(){return[Ra,Ia,Fa,Ma,Va,Pa]},Wa=function(){return[Ma,Fa,Ia,Ra,Pa,Va]},Ga=function(){return[Fa,Ma,Ra,Ia,Pa,Va]},Xa=Object.freeze({__proto__:null,events:function(n){return qo([$o(xo(),(function(component,t){var e=n.channels,o=Cn(e),r=t,c=function(n,t){return t.universal?n:filter(n,(function(n){return L(t.channels,n)}))}(o,r);G(c,(function(n){var t=e[n],o=t.schema,data=At("channel["+n+"] data\nReceiver: "+element(component.element),o,r.data);t.onReceive(component,data)}))}))])}}),Ya=[Gt("channels",Et(ln.value,mt([la("onReceive"),re("schema",Rt())])))],qa=function(n,t,e){return cr((function(component,o){e(component,n,t)}))},Ja=function(n,t,e){return function(n,t,e){var o=e.toString(),r=o.indexOf(")")+1,c=o.indexOf("("),f=o.substring(c+1,r-1).split(/,\s*/);return n.toFunctionAnnotation=function(){return{name:t,parameters:ri(f.slice(0,1).concat(f.slice(3)))}},n}((function(component){for(var r=[],c=1;c<arguments.length;c++)r[c-1]=arguments[c];var f=[component].concat(r);return component.config({name:o(n)}).fold((function(){throw new Error("We could not find any behaviour configuration for: "+n+". Using API: "+e)}),(function(n){var e=Array.prototype.slice.call(f,1);return t.apply(void 0,[component,n.config,n.state].concat(e))}))}),e,t)},Ka=function(n){return{key:n,value:void 0}},$a=function(n,t,e,o,r,f,l){var d=function(n){return Rn(n,e)?n[e]():O.none()},m=Tn(r,(function(n,t){return Ja(e,n,t)})),h=Tn(f,(function(n,t){return ii(n,t)})),y=v(v(v({},h),m),{revoke:c(Ka,e),config:function(t){var o=At(e+"-config",n,t);return{key:e,value:{config:o,me:y,configAsRaw:Ln((function(){return At(e+"-config",n,t)})),initialConfig:t,state:l}}},schema:function(){return t},exhibit:function(n,base){return d(n).bind((function(n){return Fn(o,"exhibit").map((function(t){return t(base,n.config,n.state)}))})).getOr(mi({}))},name:function(){return e},handlers:function(n){return d(n).map((function(n){return Fn(o,"events").getOr((function(){return{}}))(n.config,n.state)})).getOr({})}});return y},Qa=function(n){return Qn(n)},Za=mt([Wt("fields"),Wt("name"),re("active",{}),re("apis",{}),re("state",si),re("extra",{})]),nc=function(data){var n=At("Creating behaviour: "+data.name,Za,data);return function(n,t,e,o,r,c){var f,l,d=mt(n),m=oe(t,[(f="config",l=n,Zt(f,mt(l)))]);return $a(d,m,t,e,o,r,c)}(n.fields,n.name,n.active,n.apis,n.extra,n.state)},tc=mt([Wt("branchKey"),Wt("branches"),Wt("name"),re("active",{}),re("apis",{}),re("state",si),re("extra",{})]),ec=function(data){var n=At("Creating behaviour: "+data.name,tc,data);return function(n,t,e,o,r,c){var f=n,l=oe(t,[Zt("config",n)]);return $a(f,l,t,e,o,r,c)}(It(n.branchKey,n.branches),n.name,n.active,n.apis,n.extra,n.state)},oc=o(void 0),rc=nc({fields:Ya,name:"receiving",active:Xa}),ic=Object.freeze({__proto__:null,exhibit:function(base,n){return mi({classes:[],styles:n.useFixed()?{}:{position:"relative"}})}}),uc=function(element){return element.dom.focus()},ac=function(n){return void 0===n&&(n=he.fromDom(document)),O.from(n.dom.activeElement).map(he.fromDom)},cc=function(element){return ac(Vi(element)).filter((function(n){return element.dom.contains(n.dom)}))},sc=function(n,e){var o=Vi(e),r=ac(o).bind((function(n){var t,o,r=function(t){return Le(n,t)};return r(e)?O.some(e):(t=r,(o=function(n){for(var i=0;i<n.childNodes.length;i++){var e=he.fromDom(n.childNodes[i]);if(t(e))return O.some(e);var r=o(n.childNodes[i]);if(r.isSome())return r}return O.none()})(e.dom))})),c=n(e);return r.each((function(n){ac(o).filter((function(t){return Le(t,n)})).fold((function(){uc(n)}),t)})),c},fc=function(n,t,e,o,r){return{position:n,left:t,top:e,right:o,bottom:r}},lc=function(element,n){var t=function(n){return n+"px"};Yi(element,{position:O.some(n.position),left:n.left.map(t),top:n.top.map(t),right:n.right.map(t),bottom:n.bottom.map(t)})},dc=Vn([{none:[]},{relative:["x","y","width","height"]},{fixed:["x","y","width","height"]}]),mc=function(n,t,e,o,r,c){var f=t.x-e,l=t.y-o,d=r-(f+t.width),m=c-(l+t.height),h=O.some(f),v=O.some(l),y=O.some(d),x=O.some(m),w=O.none();return function(n,t,e,o,r,c,f,l,d){return n.fold(t,e,o,r,c,f,l,d)}(t.direction,(function(){return fc(n,h,v,w,w)}),(function(){return fc(n,w,v,y,w)}),(function(){return fc(n,h,w,w,x)}),(function(){return fc(n,w,w,y,x)}),(function(){return fc(n,h,v,w,w)}),(function(){return fc(n,h,w,w,x)}),(function(){return fc(n,h,v,w,w)}),(function(){return fc(n,w,v,y,w)}))},gc=function(n,element){var t=c(Ru,element),e=n.fold(t,t,(function(){var n=Du();return Ru(element).translate(-n.left,-n.top)})),o=Ou(element),r=vu(element);return Vu(e.left,e.top,o,r)},pc=function(n,t){return t.fold((function(){return n.fold(zu,zu,Vu)}),(function(b){return n.fold(b,b,(function(){var t=b(),e=hc(n,t.x,t.y);return Vu(e.left,e.top,t.width,t.height)}))}))},hc=function(n,t,e){var r=yu(t,e);return n.fold(o(r),o(r),(function(){var n=Du();return r.translate(-n.left,-n.top)}))},vc=(dc.none,dc.relative),bc=dc.fixed,yc=function(n,t){return function(n,t){return{anchorBox:n,origin:t}}(n,t)},xc=function(n,t,e,o){var r=n+t;return r>o?e:r<e?o:r},wc=function(n,t,e){return Math.min(Math.max(n,t),e)},Sc=Vn([{fit:["reposition"]},{nofit:["reposition","deltaW","deltaH"]}]),kc=function(n,t,e,c){var f=n.x,l=n.y,d=n.bubble.offset,m=d.left,h=d.top,v=function(n,t,e){var o=function(n,o){var c="top"===n||"bottom"===n?e.top:e.left;return Fn(t,n).bind(r).bind((function(t){return"left"===n||"top"===n?t>=o?O.some(t):O.none():t<=o?O.some(t):O.none()})).map((function(n){return n+c})).getOr(o)},c=o("left",n.x),f=o("top",n.y),l=o("right",n.right),d=o("bottom",n.bottom);return Vu(c,f,l-c,d-f)}(c,n.boundsRestriction,d),y=v.y,x=v.bottom,w=v.x,S=v.right,k=l+h,C=function(n,t,e,o,r){var c=r.x,f=r.y,l=r.width,d=r.height,m=n>=c,h=t>=f,v=m&&h,y=n+e<=c+l&&t+o<=f+d,x=Math.abs(Math.min(e,m?c+l-n:c-(n+e))),w=Math.abs(Math.min(o,h?f+d-t:f-(t+o))),S=Math.max(r.x,r.right-e),k=Math.max(r.y,r.bottom-o);return{originInBounds:v,sizeInBounds:y,limitX:wc(n,r.x,S),limitY:wc(t,r.y,k),deltaW:x,deltaH:w}}(f+m,k,t,e,v),_=C.originInBounds,T=C.sizeInBounds,E=C.limitX,D=C.limitY,B=C.deltaW,A=C.deltaH,M=o(D+A-y),F=o(x-D),I=function(n,t,e,o){return n.fold(t,t,o,o,t,o,e,e)}(n.direction,F,F,M),R=o(E+B-w),V=o(S-E),P={x:E,y:D,width:B,height:A,maxHeight:I,maxWidth:function(n,t,e,o){return n.fold(t,o,t,o,e,e,t,o)}(n.direction,V,V,R),direction:n.direction,classes:{on:n.bubble.classesOn,off:n.bubble.classesOff},label:n.label,candidateYforTest:k};return _&&T?Sc.fit(P):Sc.nofit(P,B,A)},Cc=function(n,element,t,e){Zi(element,"max-height"),Zi(element,"max-width");var p,o={width:Ou(p=element),height:vu(p)};return function(n,t,e,o,f){var l=e.width,d=e.height,m=function(n,r,c,m){var h=n(t,e,o);return kc(h,l,d,f).fold(Sc.fit,(function(n,t,e){return e>m||t>c?Sc.nofit(n,t,e):Sc.nofit(r,c,m)}))};return J(n,(function(b,a){var n=c(m,a);return b.fold(Sc.fit,n)}),Sc.nofit({x:t.x,y:t.y,width:e.width,height:e.height,maxHeight:e.height,maxWidth:e.width,direction:va(),classes:{on:[],off:[]},label:"none",candidateYforTest:t.y},-1,-1)).fold(r,r)}(e.preference,n,o,t,e.bounds)},Oc=function(element,n,t){lc(element,function(n,t){return n.fold((function(){return fc("absolute",O.some(t.x),O.some(t.y),O.none(),O.none())}),(function(n,e,o,r){return mc("absolute",t,n,e,o,r)}),(function(n,e,o,r){return mc("fixed",t,n,e,o,r)}))}(t.origin,n))},_c=function(element,n){!function(element,n){var t=pu.max(element,n,["margin-top","border-top-width","padding-top","padding-bottom","border-bottom-width","margin-bottom"]);Gi(element,"max-height",t+"px")}(element,Math.floor(n))},Tc=o((function(element,n){_c(element,n),Xi(element,{"overflow-x":"hidden","overflow-y":"auto"})})),Ec=o((function(element,n){_c(element,n)})),Dc=function(n,t,e){return void 0===n[t]?e:n[t]},Bc=function(n,element,t,e){var o=Cc(n,element,t,e);Oc(element,o,e),function(element,n){var t=n.classes;Ai(element,t.off),Bi(element,t.on)}(element,o),function(element,n,t){(0,t.maxHeightFunction)(element,n.maxHeight)}(element,o,e),function(element,n,t){(0,t.maxWidthFunction)(element,n.maxWidth)}(element,o,e)},Ac=["valignCentre","alignLeft","alignRight","alignCentre","top","bottom","left","right"],Mc=function(n,t,e){var o=function(n){return Fn(e,n).getOr([])},r=function(n,t,e){var r=en(Ac,e);return{offset:yu(n,t),classesOn:Z(e,o),classesOff:Z(r,o)}};return{southeast:function(){return r(-n,t,["top","alignLeft"])},southwest:function(){return r(n,t,["top","alignRight"])},south:function(){return r(-n/2,t,["top","alignCentre"])},northeast:function(){return r(-n,-t,["bottom","alignLeft"])},northwest:function(){return r(n,-t,["bottom","alignRight"])},north:function(){return r(-n/2,-t,["bottom","alignCentre"])},east:function(){return r(n,-t/2,["valignCentre","left"])},west:function(){return r(-n,-t/2,["valignCentre","right"])},innerNorthwest:function(){return r(-n,t,["top","alignRight"])},innerNortheast:function(){return r(n,t,["top","alignLeft"])},innerNorth:function(){return r(-n/2,t,["top","alignCentre"])},innerSouthwest:function(){return r(-n,-t,["bottom","alignRight"])},innerSoutheast:function(){return r(n,-t,["bottom","alignLeft"])},innerSouth:function(){return r(-n/2,-t,["bottom","alignCentre"])},innerWest:function(){return r(n,-t/2,["valignCentre","right"])},innerEast:function(){return r(-n,-t/2,["valignCentre","left"])}}},Fc=function(){return Mc(0,0,{})},Ic=function(n,t){return function(element){return"rtl"===Rc(element)?t:n}},Rc=function(element){return"rtl"===qi(element,"direction")?"rtl":"ltr"};!function(n){n.TopToBottom="toptobottom",n.BottomToTop="bottomtotop"}($u||($u={}));var Vc="data-alloy-vertical-dir",Pc=function(n){return Wu(n,(function(n){return dr(n)&&Hr(n,"data-alloy-vertical-dir")===$u.BottomToTop}))},Hc=function(){return oe("layouts",[Wt("onLtr"),Wt("onRtl"),option("onBottomLtr"),option("onBottomRtl")])},zc=function(n,t,e,o,r,c,f){var l=f.map(Pc).getOr(!1),d=t.layouts.map((function(t){return t.onLtr(n)})),m=t.layouts.map((function(t){return t.onRtl(n)})),h=l?t.layouts.bind((function(t){return t.onBottomLtr.map((function(t){return t(n)}))})).or(d).getOr(r):d.getOr(e),v=l?t.layouts.bind((function(t){return t.onBottomRtl.map((function(t){return t(n)}))})).or(m).getOr(c):m.getOr(o);return Ic(h,v)(n)},Nc=[Wt("hotspot"),option("bubble"),re("overrides",{}),Hc(),output("placement",(function(component,n,t){var e=n.hotspot,o=gc(t,e.element),r=zc(component.element,n,Wa(),Ga(),ja(),Ua(),O.some(n.hotspot.element));return O.some({anchorBox:o,bubble:n.bubble.getOr(Fc()),overrides:n.overrides,layouts:r,placer:O.none()})}))],Lc=[Wt("x"),Wt("y"),re("height",0),re("width",0),re("bubble",Fc()),re("overrides",{}),Hc(),output("placement",(function(component,n,t){var e=hc(t,n.x,n.y),o=Vu(e.left,e.top,n.width,n.height),r=zc(component.element,n,Na(),La(),Na(),La(),O.none());return O.some({anchorBox:o,bubble:n.bubble,overrides:n.overrides,layouts:r,placer:O.none()})}))],jc=function(n,t,e,o){return{start:n,soffset:t,finish:e,foffset:o}},Uc=Vn([{before:["element"]},{on:["element","offset"]},{after:["element"]}]),Wc=(Uc.before,Uc.on,Uc.after,function(n){return n.fold(r,r,r)}),Gc=Vn([{domRange:["rng"]},{relative:["startSitu","finishSitu"]},{exact:["start","soffset","finish","foffset"]}]),Xc={domRange:Gc.domRange,relative:Gc.relative,exact:Gc.exact,exactFromRange:function(n){return Gc.exact(n.start,n.soffset,n.finish,n.foffset)},getWin:function(n){var t=function(n){return n.match({domRange:function(n){return he.fromDom(n.startContainer)},relative:function(n,t){return Wc(n)},exact:function(n,t,e,o){return n}})}(n);return wr(t)},range:jc},Yc=function(n,t,e){var o,r=n.document.createRange();return o=r,t.fold((function(n){o.setStartBefore(n.dom)}),(function(n,t){o.setStart(n.dom,t)}),(function(n){o.setStartAfter(n.dom)})),function(n,t){t.fold((function(t){n.setEndBefore(t.dom)}),(function(t,e){n.setEnd(t.dom,e)}),(function(t){n.setEndAfter(t.dom)}))}(r,e),r},qc=function(n,t,e,o,r){var c=n.document.createRange();return c.setStart(t.dom,e),c.setEnd(o.dom,r),c},Jc=function(rect){return{left:rect.left,top:rect.top,right:rect.right,bottom:rect.bottom,width:rect.width,height:rect.height}},Kc=Vn([{ltr:["start","soffset","finish","foffset"]},{rtl:["start","soffset","finish","foffset"]}]),$c=function(n,t,e){return t(he.fromDom(e.startContainer),e.startOffset,he.fromDom(e.endContainer),e.endOffset)},Qc=function(n,t){return function(n,t){var e=t.ltr();return e.collapsed?t.rtl().filter((function(n){return!1===n.collapsed})).map((function(n){return Kc.rtl(he.fromDom(n.endContainer),n.endOffset,he.fromDom(n.startContainer),n.startOffset)})).getOrThunk((function(){return $c(0,Kc.ltr,e)})):$c(0,Kc.ltr,e)}(0,function(n,t){return t.match({domRange:function(n){return{ltr:o(n),rtl:O.none}},relative:function(t,e){return{ltr:Ln((function(){return Yc(n,t,e)})),rtl:Ln((function(){return O.some(Yc(n,e,t))}))}},exact:function(t,e,o,r){return{ltr:Ln((function(){return qc(n,t,e,o,r)})),rtl:Ln((function(){return O.some(qc(n,o,r,t,e))}))}}})}(n,t))};Kc.ltr,Kc.rtl;var Zc=function(n,t){var e=function(element){return n(element)?O.from(element.dom.nodeValue):O.none()};return{get:function(element){if(!n(element))throw new Error("Can only get "+t+" value of a "+t+" node");return e(element).getOr("")},getOption:e,set:function(element,e){if(!n(element))throw new Error("Can only set raw "+t+" value of a "+t+" node");element.dom.nodeValue=e}}}(mr,"text"),ns=function(element){return Zc.getOption(element)},ts=["img","br"],es=function(n){return ns(n).filter((function(text){return 0!==text.trim().length||text.indexOf("")>-1})).isSome()||L(ts,fr(n))},os=function(n,t){var e=function(element){for(var n=Cr(element),i=n.length-1;i>=0;i--){var o=n[i];if(t(o))return O.some(o);var r=e(o);if(r.isSome())return r}return O.none()};return e(n)},rs=function(n,t){return function(n,t){var base=void 0===t?document:t.dom;return Ne(base)?[]:map(base.querySelectorAll(n),he.fromDom)}(t,n)},is=function(n,t,e,o){var r=function(n,t,e,o){var r=vr(n).dom.createRange();return r.setStart(n.dom,t),r.setEnd(e.dom,o),r}(n,t,e,o),c=Le(n,e)&&t===o;return r.collapsed&&!c},us=function(n){if(n.rangeCount>0){var t=n.getRangeAt(0),e=n.getRangeAt(n.rangeCount-1);return O.some(jc(he.fromDom(t.startContainer),t.startOffset,he.fromDom(e.endContainer),e.endOffset))}return O.none()},as=function(n){if(null===n.anchorNode||null===n.focusNode)return us(n);var t=he.fromDom(n.anchorNode),e=he.fromDom(n.focusNode);return is(t,n.anchorOffset,e,n.focusOffset)?O.some(jc(t,n.anchorOffset,e,n.focusOffset)):us(n)},cs=function(n){return function(n){return O.from(n.getSelection())}(n).filter((function(n){return n.rangeCount>0})).bind(as)},ss=function(n,t){return function(n){var t=n.getClientRects(),rect=t.length>0?t[0]:n.getBoundingClientRect();return rect.width>0||rect.height>0?O.some(rect).map(Jc):O.none()}(function(n,t){return Qc(n,t).match({ltr:function(t,e,o,r){var c=n.document.createRange();return c.setStart(t.dom,e),c.setEnd(o.dom,r),c},rtl:function(t,e,o,r){var c=n.document.createRange();return c.setStart(o.dom,r),c.setEnd(t.dom,e),c}})}(n,t))},fs=function(element,n){return{element:element,offset:n}},ls=function(element,n){var t=Cr(element);if(0===t.length)return fs(element,n);if(n<t.length)return fs(t[n],0);var e=t[t.length-1],o=mr(e)?function(element){return Zc.get(element)}(e).length:Cr(e).length;return fs(e,o)},ds=Vn([{screen:["point"]},{absolute:["point","scrollLeft","scrollTop"]}]),ms=function(n){return n.fold(r,(function(n,t,e){return n.translate(-t,-e)}))},gs=function(n){return n.fold(r,r)},ps=function(n){return J(n,(function(b,a){return b.translate(a.left,a.top)}),yu(0,0))},hs=function(n){var t=map(n,gs);return ps(t)},vs=ds.screen,bs=ds.absolute,ys=function(component,n,t){var e=vr(component.element),o=Du(e),r=function(component,n,t){var e=wr(t.root).dom;return O.from(e.frameElement).map(he.fromDom).filter((function(n){var t=vr(n),e=vr(component.element);return Le(t,e)})).map(wu)}(component,0,t).getOr(o);return bs(r,o.left,o.top)},xs=function(n,t,e,o){var r=n,c=t,f=e,l=o;n<0&&(r=0,f=e+n),t<0&&(c=0,l=o+t);var d=vs(yu(r,c));return O.some(function(n,t,e){return{point:n,width:t,height:e}}(d,f,l))},ws=function(n,t,e,o,r){return n.map((function(n){var c,f,l,d=[t,n.point],m=(c=function(){return hs(d)},f=function(){return hs(d)},l=function(){return function(n){var t=map(n,ms);return ps(t)}(d)},o.fold(c,f,l)),h=function(n,t,e,o){return{x:n,y:t,width:e,height:o}}(m.left,m.top,n.width,n.height),v=e.showAbove?ja():Wa(),y=e.showAbove?Ua():Ga(),x=zc(r,e,v,y,v,y,O.none());return{anchorBox:h,bubble:e.bubble.getOr(Fc()),overrides:e.overrides,layouts:x,placer:O.none()}}))},Ss=function(element,n){return mr(element)?fs(element,n):ls(element,n)},ks=function(n,t){return t.getSelection.getOrThunk((function(){return function(){return cs(n)}}))().map((function(n){var t=Ss(n.start,n.soffset),e=Ss(n.finish,n.foffset);return Xc.range(t.element,t.offset,e.element,e.offset)}))},Cs=[option("getSelection"),Wt("root"),option("bubble"),Hc(),re("overrides",{}),re("showAbove",!1),output("placement",(function(component,n,t){var e=wr(n.root).dom,o=ys(component,0,n),r=ks(e,n).bind((function(n){return ss(e,Xc.exactFromRange(n)).orThunk((function(){var t=he.fromText("\ufeff");return _r(n.start,t),ss(e,Xc.exact(t,0,t,1)).map((function(rect){return Mr(t),rect}))})).bind((function(n){return xs(n.left,n.top,n.width,n.height)}))})),c=ks(e,n).bind((function(n){return dr(n.start)?O.some(n.start):function(element){return Sr(element)}(n.start)})).getOr(component.element);return ws(r,o,n,t,c)}))],Os=[Wt("node"),Wt("root"),option("bubble"),Hc(),re("overrides",{}),re("showAbove",!1),output("placement",(function(component,n,t){var e=ys(component,0,n);return n.node.bind((function(o){var rect=o.dom.getBoundingClientRect(),r=xs(rect.left,rect.top,rect.width,rect.height),c=n.node.getOr(component.element);return ws(r,e,n,t,c)}))}))],_s=function(n){return n.x+n.width},Ts=function(n,element){return n.x-element.width},Es=function(n,element){return n.y-element.height+n.height},Ds=function(n){return n.y},Bs=function(n,element,t){return pa(_s(n),Ds(n),t.southeast(),va(),Oa(n,{left:0,top:2}),"link-layout-se")},As=function(n,element,t){return pa(Ts(n,element),Ds(n),t.southwest(),ba(),Oa(n,{right:1,top:2}),"link-layout-sw")},Ms=function(n,element,t){return pa(_s(n),Es(n,element),t.northeast(),ya(),Oa(n,{left:0,bottom:3}),"link-layout-ne")},Fs=function(n,element,t){return pa(Ts(n,element),Es(n,element),t.northwest(),xa(),Oa(n,{right:1,bottom:3}),"link-layout-nw")},Is=function(){return[Bs,As,Ms,Fs]},Rs=function(){return[As,Bs,Fs,Ms]},Vs=[Wt("item"),Hc(),re("overrides",{}),output("placement",(function(component,n,t){var e=gc(t,n.item.element),o=zc(component.element,n,Is(),Rs(),Is(),Rs(),O.none());return O.some({anchorBox:e,bubble:Fc(),overrides:n.overrides,layouts:o,placer:O.none()})}))],Ps=It("anchor",{selection:Cs,node:Os,hotspot:Nc,submenu:Vs,makeshift:Lc}),Hs=function(component,n,e,o,r){!function(n,element,e,o,r,c){var f=Dc(c,"maxHeightFunction",Tc()),l=Dc(c,"maxWidthFunction",t),d=n.anchorBox,m=n.origin,h={bounds:pc(m,r),origin:m,preference:o,maxHeightFunction:f,maxWidthFunction:l};Bc(d,element,e,h)}(yc(e.anchorBox,n),r.element,e.bubble,e.layouts,o,e.overrides)},zs=function(component,n,t,e,o,r){var c=r.map(Pu);return Ns(component,n,t,e,o,c)},Ns=function(component,n,t,e,r,c){var f=At("positioning anchor.info",Ps,e);sc((function(){Gi(r.element,"position","fixed");var t=Ki(r.element,"visibility");Gi(r.element,"visibility","hidden");var html,e=n.useFixed()?(html=document.documentElement,bc(0,0,html.clientWidth,html.clientHeight)):function(component){var n=wu(component.element),t=component.element.dom.getBoundingClientRect();return vc(n.left,n.top,t.width,t.height)}(component),l=f.placement,d=c.map(o).or(n.getBounds);l(component,f,e).each((function(n){n.placer.getOr(Hs)(component,e,n,d,r)})),t.fold((function(){Zi(r.element,"visibility")}),(function(n){Gi(r.element,"visibility",n)})),Ki(r.element,"left").isNone()&&Ki(r.element,"top").isNone()&&Ki(r.element,"right").isNone()&&Ki(r.element,"bottom").isNone()&&Ki(r.element,"position").is("fixed")&&Zi(r.element,"position")}),r.element)},Ls=Object.freeze({__proto__:null,position:function(component,n,t,e,o){zs(component,n,t,e,o,O.none())},positionWithin:zs,positionWithinBounds:Ns,getMode:function(component,n,t){return n.useFixed()?"fixed":"absolute"}}),js=[re("useFixed",d),option("getBounds")],Us=nc({fields:js,name:"positioning",active:ic,apis:Ls}),Ws=function(component){jo(component,Fo());var n=component.components();G(n,Ws)},Gs=function(component){var n=component.components();G(n,Gs),jo(component,Mo())},Xs=function(n,t){Dr(n.element,t.element)},Ys=function(component,n){var t=component.components();!function(component){G(component.components(),(function(n){return Mr(n.element)})),Ar(component.element),component.syncComponents()}(component);var e=en(t,n);G(e,(function(n){Ws(n),component.getSystem().removeFromWorld(n)})),G(n,(function(n){n.getSystem().isConnected()?Xs(component,n):(component.getSystem().addToWorld(n),Xs(component,n),Li(component.element)&&Gs(n)),component.syncComponents()}))},qs=function(n,t){Js(n,t,Dr)},Js=function(n,t,e){n.getSystem().addToWorld(t),e(n.element,t.element),Li(n.element)&&Gs(t),n.syncComponents()},Ks=function(component){Ws(component),Mr(component.element),component.getSystem().removeFromWorld(component)},$s=function(component){var n=Sr(component.element).bind((function(p){return component.getSystem().getByDom(p).toOptional()}));Ks(component),n.each((function(p){p.syncComponents()}))},Qs=function(component){var n=component.components();G(n,Ks),Ar(component.element),component.syncComponents()},Zs=function(element,n){nf(element,n,Dr)},nf=function(element,n,t){t(element,n.element);var e=Cr(n.element);G(e,(function(t){n.getByDom(t).each(Gs)}))},tf=function(n){var t=Cr(n.element);G(t,(function(t){n.getByDom(t).each(Ws)})),Mr(n.element)},ef=function(n,t,e,data){e.get().each((function(t){Qs(n)}));var o=t.getAttachPoint(n);qs(o,n);var r=n.getSystem().build(data);return qs(n,r),e.set(r),r},of=function(n,t,e,data){var o=ef(n,t,e,data);return t.onOpen(n,o),o},rf=function(n,t,e){e.get().each((function(data){Qs(n),$s(n),t.onClose(n,data),e.clear()}))},uf=function(n,t,e){return e.isOpen()},af=function(n,t,e){var o=t.getAttachPoint(n);Gi(n.element,"position",Us.getMode(o)),function(n,t,e,o){Ki(n.element,t).fold((function(){Lr(n.element,e)}),(function(t){Pr(n.element,e,t)})),Gi(n.element,t,o)}(n,"visibility",t.cloakVisibilityAttr,"hidden")},cf=function(n,t,e){(function(element){return j(["top","left","right","bottom"],(function(n){return Ki(element,n).isSome()}))})(n.element)||Zi(n.element,"position"),function(n,t,e){zr(n.element,e).fold((function(){return Zi(n.element,t)}),(function(e){return Gi(n.element,t,e)}))}(n,"visibility",t.cloakVisibilityAttr)},sf=Object.freeze({__proto__:null,cloak:af,decloak:cf,open:of,openWhileCloaked:function(n,t,e,data,o){af(n,t),of(n,t,e,data),o(),cf(n,t)},close:rf,isOpen:uf,isPartOf:function(n,t,e,o){return uf(0,0,e)&&e.get().exists((function(data){return t.isPartOf(n,data,o)}))},getState:function(n,t,e){return e.get()},setContent:function(n,t,e,data){return e.get().map((function(){return ef(n,t,e,data)}))}}),ff=Object.freeze({__proto__:null,events:function(n,t){return qo([$o(Oo(),(function(e,o){rf(e,n,t)}))])}}),lf=[sa("onOpen"),sa("onClose"),Wt("isPartOf"),Wt("getAttachPoint"),re("cloakVisibilityAttr","data-precloak-visibility")],df=nc({fields:lf,name:"sandboxing",active:ff,apis:sf,state:Object.freeze({__proto__:null,init:function(){var n=ge(O.none()),t=o("not-implemented");return fi({readState:t,isOpen:function(){return n.get().isSome()},clear:function(){n.set(O.none())},set:function(t){n.set(O.some(t))},get:function(){return n.get()}})}})}),mf=o("dismiss.popups"),gf=o("reposition.popups"),pf=o("mouse.released"),hf=mt([re("isExtraPart",d),oe("fireEventInstead",[re("event",Io())])]),vf=function(n){var t,e=At("Dismissal",hf,n);return(t={})[mf()]={schema:mt([Wt("target")]),onReceive:function(n,data){df.isOpen(n)&&(df.isPartOf(n,data.target)||e.isExtraPart(n,data.target)||e.fireEventInstead.fold((function(){return df.close(n)}),(function(t){return jo(n,t.event)})))}},t},bf=mt([oe("fireEventInstead",[re("event",Ro())]),Jt("doReposition")]),yf=function(n){var t,e=At("Reposition",bf,n);return(t={})[gf()]={onReceive:function(n){df.isOpen(n)&&e.fireEventInstead.fold((function(){return e.doReposition(n)}),(function(t){return jo(n,t.event)}))}},t},xf=function(component,n,t){n.store.manager.onLoad(component,n,t)},wf=function(component,n,t){n.store.manager.onUnload(component,n,t)},Sf=Object.freeze({__proto__:null,onLoad:xf,onUnload:wf,setValue:function(component,n,t,data){n.store.manager.setValue(component,n,t,data)},getValue:function(component,n,t){return n.store.manager.getValue(component,n,t)},getState:function(component,n,t){return t}}),kf=Object.freeze({__proto__:null,events:function(n,t){var e=n.resetOnDom?[ur((function(e,o){xf(e,n,t)})),ar((function(e,o){wf(e,n,t)}))]:[qa(n,t,xf)];return qo(e)}}),Cf=function(){var data=ge(null);return fi({set:data.set,get:data.get,isNotSet:function(){return null===data.get()},clear:function(){data.set(null)},readState:function(){return{mode:"memory",value:data.get()}}})},Of=function(){var n=ge({}),t=ge({});return fi({readState:function(){return{mode:"dataset",dataByValue:n.get(),dataByText:t.get()}},lookup:function(e){return Fn(n.get(),e).orThunk((function(){return Fn(t.get(),e)}))},update:function(e){var o=n.get(),r=t.get(),c={},f={};G(e,(function(n){c[n.value]=n,Fn(n,"meta").each((function(meta){Fn(meta,"text").each((function(text){f[text]=n}))}))})),n.set(v(v({},o),c)),t.set(v(v({},r),f))},clear:function(){n.set({}),t.set({})}})},_f=Object.freeze({__proto__:null,memory:Cf,dataset:Of,manual:function(){return fi({readState:function(){}})},init:function(n){return n.store.manager.state(n)}}),Tf=function(component,n,t,data){var e=n.store;t.update([data]),e.setValue(component,data),n.onSetValue(component,data)},Ef=[option("initialValue"),Wt("getFallbackEntry"),Wt("getDataKey"),Wt("setValue"),output("manager",{setValue:Tf,getValue:function(component,n,t){var e=n.store,o=e.getDataKey(component);return t.lookup(o).fold((function(){return e.getFallbackEntry(o)}),(function(data){return data}))},onLoad:function(component,n,t){n.store.initialValue.each((function(data){Tf(component,n,t,data)}))},onUnload:function(component,n,t){t.clear()},state:Of})],Df=[Wt("getValue"),re("setValue",t),option("initialValue"),output("manager",{setValue:function(component,n,t,data){n.store.setValue(component,data),n.onSetValue(component,data)},getValue:function(component,n,t){return n.store.getValue(component)},onLoad:function(component,n,t){n.store.initialValue.each((function(data){n.store.setValue(component,data)}))},onUnload:t,state:si.init})],Bf=[option("initialValue"),output("manager",{setValue:function(component,n,t,data){t.set(data),n.onSetValue(component,data)},getValue:function(component,n,t){return t.get()},onLoad:function(component,n,t){n.store.initialValue.each((function(n){t.isNotSet()&&t.set(n)}))},onUnload:function(component,n,t){t.clear()},state:Cf})],Af=[ie("store",{mode:"memory"},It("mode",{memory:Bf,manual:Df,dataset:Ef})),sa("onSetValue"),re("resetOnDom",!1)],Mf=nc({fields:Af,name:"representing",active:kf,apis:Sf,extra:{setValueFrom:function(component,source){var n=Mf.getValue(source);Mf.setValue(component,n)}},state:_f}),Ff=function(n,t){return de(n,{},map(t,(function(t){return e=t.name(),o="Cannot configure "+t.name()+" for "+n,wt(e,e,Xn(),ft((function(n){return yn("The field: "+e+" is forbidden. "+o)})));var e,o})).concat([me("dump",r)]))},If=function(data){return data.dump},Rf=function(data,n){return v(v({},data.dump),Qa(n))},Vf=Ff,Pf=Rf,Hf=Vn([{single:["required","valueThunk"]},{multiple:["required","valueThunks"]}]),zf=function(n){return In(n,"uiType")},Nf=function(n,t,e,r){return zf(e)&&"placeholder"===e.uiType?function(n,t,e,r){return n.exists((function(n){return n!==e.owner}))?Hf.single(!0,o(e)):Fn(r,e.name).fold((function(){throw new Error("Unknown placeholder component: "+e.name+"\nKnown: ["+Cn(r)+"]\nNamespace: "+n.getOr("none")+"\nSpec: "+JSON.stringify(e,null,2))}),(function(n){return n.replace()}))}(n,0,e,r):Hf.single(!1,o(e))},Lf=function(n,t,e,o){return Nf(n,0,e,o).fold((function(r,c){var f=zf(e)?c(t,e.config,e.validated):c(t),l=Fn(f,"components").getOr([]),d=Z(l,(function(e){return Lf(n,t,e,o)}));return[v(v({},f),{components:d})]}),(function(n,o){if(zf(e)){var c=o(t,e.config,e.validated);return e.validated.preprocess.getOr(r)(c)}return o(t)}))},jf=function(n,t,e,r){var c=Tn(r,(function(n,t){return e=n,r=!1,{name:o(label=t),required:function(){return e.fold((function(n,t){return n}),(function(n,t){return n}))},used:function(){return r},replace:function(){if(r)throw new Error("Trying to use the same placeholder more than once: "+label);return r=!0,e}};var label,e,r})),f=function(n,t,e,o){return Z(e,(function(e){return Lf(n,t,e,o)}))}(n,t,e,c);return _n(c,(function(p){if(!1===p.used()&&p.required())throw new Error("Placeholder: "+p.name()+" was not found in components list\nNamespace: "+n.getOr("none")+"\nComponents: "+JSON.stringify(t.components,null,2))})),f},Uf=Hf.single,Wf=Hf.multiple,Gf=o("placeholder"),Xf=Vn([{required:["data"]},{external:["data"]},{optional:["data"]},{group:["data"]}]),Yf=re("factory",{sketch:r}),qf=re("schema",[]),Jf=Wt("name"),Kf=wt("pname","pname",Yn((function(n){return"<alloy."+Yr(n.name)+">"})),Rt()),$f=me("schema",(function(){return[option("preprocess")]})),Qf=re("defaults",o({})),Zf=re("overrides",o({})),nl=gt([Yf,qf,Jf,Kf,Qf,Zf]),tl=gt([Yf,qf,Jf,Qf,Zf]),el=gt([Yf,qf,Jf,Kf,Qf,Zf]),rl=gt([Yf,$f,Jf,Wt("unit"),Kf,Qf,Zf]),il=function(n){return n.fold(O.some,O.none,O.some,O.some)},al=function(n){var t=function(data){return data.name};return n.fold(t,t,t,t)},cl=function(n,t){return function(e){var data=At("Converting part type",t,e);return n(data)}},sl=cl(Xf.required,nl),fl=cl(Xf.external,tl),ll=cl(Xf.optional,el),ml=cl(Xf.group,rl),gl=o("entirety"),pl=Object.freeze({__proto__:null,required:sl,external:fl,optional:ll,group:ml,asNamedPart:il,name:al,asCommon:function(n){return n.fold(r,r,r,r)},original:gl}),hl=function(n,data,t,e){return zn(data.defaults(n,t,e),t,{uid:n.partUids[data.name]},data.overrides(n,t,e))},vl=function(n,t){var e={};return G(t,(function(t){il(t).each((function(t){var g=bl(n,t.pname);e[t.name]=function(e){var o=At("Part: "+t.name+" in "+n,gt(t.schema),e);return v(v({},g),{config:e,validated:o})}}))})),e},bl=function(n,t){return{uiType:Gf(),owner:n,name:t}},yl=function(n,t,e){return{uiType:Gf(),owner:n,name:t,config:e,validated:{}}},xl=function(n){return Z(n,(function(n){return n.fold(O.none,O.some,O.none,O.none).map((function(data){return Kt(data.name,data.schema.concat([ma(gl())]))})).toArray()}))},wl=function(n){return map(n,al)},Sl=function(n,t,e){return function(n,t,e){var r={},c={};return G(e,(function(n){n.fold((function(data){r[data.pname]=Uf(!0,(function(n,t,e){return data.factory.sketch(hl(n,data,t,e))}))}),(function(data){var n=t.parts[data.name];c[data.name]=o(data.factory.sketch(hl(t,data,n[gl()]),n))}),(function(data){r[data.pname]=Uf(!1,(function(n,t,e){return data.factory.sketch(hl(n,data,t,e))}))}),(function(data){r[data.pname]=Wf(!0,(function(n,t,e){var o=n[data.name];return map(o,(function(u){return data.factory.sketch(zn(data.defaults(n,u,e),u,data.overrides(n,u)))}))}))}))})),{internals:o(r),externals:o(c)}}(0,t,e)},kl=function(n,t,e){return jf(O.some(n),t,t.components,e)},Cl=function(component,n,t){var e=n.partUids[t];return component.getSystem().getByUid(e).toOptional()},Ol=function(component,n,t){return Cl(component,n,t).getOrDie("Could not find part: "+t)},_l=function(component,n,t){var e={},r=n.partUids,c=component.getSystem();return G(t,(function(n){e[n]=o(c.getByUid(r[n]))})),e},Tl=function(component,n){var t=component.getSystem();return Tn(n.partUids,(function(n,e){return o(t.getByUid(n))}))},El=function(n){return Cn(n.partUids)},Dl=function(component,n,t){var e={},r=n.partUids,c=component.getSystem();return G(t,(function(n){e[n]=o(c.getByUid(r[n]).getOrDie())})),e},Bl=function(n,t){var e=wl(t);return Qn(map(e,(function(t){return{key:t,value:n+"-"+t}})))},Al=function(n){return wt("partUids","partUids",qn((function(t){return Bl(t.uid,n)})),Rt())},Ml=Object.freeze({__proto__:null,generate:vl,generateOne:yl,schemas:xl,names:wl,substitutes:Sl,components:kl,defaultUids:Bl,defaultUidsSchema:Al,getAllParts:Tl,getAllPartNames:El,getPart:Cl,getPartOrDie:Ol,getParts:_l,getPartsOrDie:Dl}),Fl=function(label,n,t,e,o){var r=function(n,t){return(n.length>0?[Kt("parts",n)]:[]).concat([Wt("uid"),re("dom",{}),re("components",[]),ma("originalSpec"),re("debug.sketcher",{})]).concat(t)}(e,o);return At(label+" [SpecSchema]",mt(r.concat(n)),t)},Il=function(n,t,e,o,r){var c=Rl(r),f=xl(e),l=Al(e),d=Fl(n,t,c,f,[l]),m=Sl(0,d,e);return o(d,kl(n,d,m.internals()),c,m.externals())},Rl=function(n){return function(n){return In(n,"uid")}(n)?n:v(v({},n),{uid:ni("uid")})};var Vl,Pl=mt([Wt("name"),Wt("factory"),Wt("configFields"),re("apis",{}),re("extraApis",{})]),Hl=mt([Wt("name"),Wt("factory"),Wt("configFields"),Wt("partFields"),re("apis",{}),re("extraApis",{})]),zl=function(n){var t=At("Sketcher for "+n.name,Pl,n),e=Tn(t.apis,ci),o=Tn(t.extraApis,(function(n,t){return ii(n,t)}));return v(v({name:t.name,configFields:t.configFields,sketch:function(n){return function(n,t,e,o){var r=Rl(o);return e(Fl(n,t,r,[],[]),r)}(t.name,t.configFields,t.factory,n)}},e),o)},Nl=function(n){var t=At("Sketcher for "+n.name,Hl,n),e=vl(t.name,t.partFields),o=Tn(t.apis,ci),r=Tn(t.extraApis,(function(n,t){return ii(n,t)}));return v(v({name:t.name,partFields:t.partFields,configFields:t.configFields,sketch:function(n){return Il(t.name,t.configFields,t.partFields,t.factory,n)},parts:e},o),r)},Ll=function(n){for(var t=[],e=function(n){t.push(n)},i=0;i<n.length;i++)n[i].each(e);return t},jl=function(b,a){return b?O.some(a):O.none()},Ul=function(n){return"input"===fr(n)&&"radio"!==Hr(n,"type")||"textarea"===fr(n)},Wl=Object.freeze({__proto__:null,getCurrent:function(component,n,t){return n.find(component)}}),Gl=[Wt("find")],Xl=nc({fields:Gl,name:"composing",apis:Wl}),Yl=function(component,n,t,e){var o=rs(component.element,"."+n.highlightClass);G(o,(function(t){j(e,(function(n){return n.element===t}))||(Ei(t,n.highlightClass),component.getSystem().getByDom(t).each((function(t){n.onDehighlight(component,t),jo(t,Lo())})))}))},ql=function(component,n,t,e){Yl(component,n,0,[e]),Jl(component,n,t,e)||(_i(e.element,n.highlightClass),n.onHighlight(component,e),jo(e,No()))},Jl=function(component,n,t,e){return Di(e.element,n.highlightClass)},Kl=function(component,n,t,e){var o=rs(component.element,"."+n.itemClass);return O.from(o[e]).fold((function(){return ln.error("No element found with index "+e)}),component.getSystem().getByDom)},$l=function(component,n,t){return Xu(component.element,"."+n.itemClass).bind((function(n){return component.getSystem().getByDom(n).toOptional()}))},Ql=function(component,n,t){var e=rs(component.element,"."+n.itemClass);return(e.length>0?O.some(e[e.length-1]):O.none()).bind((function(n){return component.getSystem().getByDom(n).toOptional()}))},Zl=function(component,n,t,e){var o=rs(component.element,"."+n.itemClass);return $(o,(function(t){return Di(t,n.highlightClass)})).bind((function(n){var t=xc(n,e,0,o.length-1);return component.getSystem().getByDom(o[t]).toOptional()}))},nd=function(component,n,t){var e=rs(component.element,"."+n.itemClass);return Ll(map(e,(function(i){return component.getSystem().getByDom(i).toOptional()})))},ed=Object.freeze({__proto__:null,dehighlightAll:function(component,n,t){return Yl(component,n,0,[])},dehighlight:function(component,n,t,e){Jl(component,n,t,e)&&(Ei(e.element,n.highlightClass),n.onDehighlight(component,e),jo(e,Lo()))},highlight:ql,highlightFirst:function(component,n,t){$l(component,n).each((function(e){ql(component,n,t,e)}))},highlightLast:function(component,n,t){Ql(component,n).each((function(e){ql(component,n,t,e)}))},highlightAt:function(component,n,t,e){Kl(component,n,t,e).fold((function(n){throw new Error(n)}),(function(e){ql(component,n,t,e)}))},highlightBy:function(component,n,t,e){var o=nd(component,n);K(o,e).each((function(e){ql(component,n,t,e)}))},isHighlighted:Jl,getHighlighted:function(component,n,t){return Xu(component.element,"."+n.highlightClass).bind((function(n){return component.getSystem().getByDom(n).toOptional()}))},getFirst:$l,getLast:Ql,getPrevious:function(component,n,t){return Zl(component,n,0,-1)},getNext:function(component,n,t){return Zl(component,n,0,1)},getCandidates:nd}),od=[Wt("highlightClass"),Wt("itemClass"),sa("onHighlight"),sa("onDehighlight")],rd=nc({fields:od,name:"highlighting",apis:ed}),id=[8],ud=[9],ad=[13],cd=[27],sd=[32],fd=[37],ld=[38],md=[39],gd=[40],pd=function(n,t,e){var o=tn(n.slice(0,t)),r=tn(n.slice(t+1));return K(o.concat(r),e)},hd=function(n,t,e){var o=tn(n.slice(0,t));return K(o,e)},vd=function(n,t,e){var o=n.slice(0,t),r=n.slice(t+1);return K(r.concat(o),e)},bd=function(n,t,e){var o=n.slice(t+1);return K(o,e)},yd=function(n){return function(t){var e=t.raw;return L(n,e.which)}},xd=function(n){return function(t){return nn(n,(function(n){return n(t)}))}},wd=function(n){return!0===n.raw.shiftKey},Sd=function(n){return!0===n.raw.ctrlKey},kd=f(wd),Cd=function(n,t){return{matches:n,classification:t}},Od=function(component,n,t){n.exists((function(p){return t.exists((function(n){return Le(n,p)}))}))||Uo(component,Vo(),{prevFocus:n,newFocus:t})},_d=function(){var n=function(component){return cc(component.element)};return{get:n,set:function(component,t){var e=n(component);component.getSystem().triggerFocus(t,component.element);var o=n(component);Od(component,e,o)}}},Td=function(){var n=function(component){return rd.getHighlighted(component).map((function(n){return n.element}))};return{get:n,set:function(component,element){var e=n(component);component.getSystem().getByDom(element).fold(t,(function(n){rd.highlight(component,n)}));var o=n(component);Od(component,e,o)}}};!function(n){n.OnFocusMode="onFocus",n.OnEnterOrSpaceMode="onEnterOrSpace",n.OnApiMode="onApi"}(Vl||(Vl={}));var Ed,Dd=function(n,t,e,o,r){var c=function(component,n,t,e,o){var r,c,f=t(component,n,e,o);return(r=f,c=n.event,K(r,(function(n){return n.matches(c)})).map((function(n){return n.classification}))).bind((function(t){return t(component,n,e,o)}))},f={schema:function(){return n.concat([re("focusManager",_d()),ie("focusInside","onFocus",Tt((function(n){return L(["onFocus","onEnterOrSpace","onApi"],n)?ln.value(n):ln.error("Invalid value for focusInside")}))),output("handler",f),output("state",t),output("sendFocusIn",r)])},processKey:c,toEvents:function(n,t){var f=n.focusInside!==Vl.OnFocusMode?O.none():r(n).map((function(e){return $o(vo(),(function(component,o){e(component,n,t),o.stop()}))})),l=[$o(co(),(function(component,o){c(component,o,e,n,t).fold((function(){!function(component,e){var o=yd(sd.concat(ad))(e.event);n.focusInside===Vl.OnEnterOrSpaceMode&&o&&Ye(component,e)&&r(n).each((function(o){o(component,n,t),e.stop()}))}(component,o)}),(function(n){o.stop()}))})),$o(so(),(function(component,e){c(component,e,o,n,t).each((function(n){e.stop()}))}))];return qo(f.toArray().concat(l))}};return f},Bd=function(n){var t=[option("onEscape"),option("onEnter"),re("selector",'[data-alloy-tabstop="true"]:not(:disabled)'),re("firstTabstop",0),re("useTabstopAt",m),option("visibilitySelector")].concat([n]),e=function(n,element){var t=n.visibilitySelector.bind((function(n){return Yu(element,n)})).getOr(element);return hu(t)>0},r=function(component,n,t){(function(component,n){var t=rs(component.element,n.selector),o=filter(t,(function(t){return e(n,t)}));return O.from(o[n.firstTabstop])})(component,n).each((function(t){n.focusManager.set(component,t)}))},f=function(component,n,t,o,r){return r(n,t,(function(n){return function(n,element){return e(n,element)&&n.useTabstopAt(element)}(o,n)})).fold((function(){return o.cyclic?O.some(!0):O.none()}),(function(n){return o.focusManager.set(component,n),O.some(!0)}))},l=function(component,n,t,e){var o=rs(component.element,t.selector);return function(component,n){return n.focusManager.get(component).bind((function(t){return Yu(t,n.selector)}))}(component,t).bind((function(n){return $(o,c(Le,n)).bind((function(n){return f(component,o,n,t,e)}))}))},d=o([Cd(xd([wd,yd(ud)]),(function(component,n,t){var e=t.cyclic?pd:hd;return l(component,0,t,e)})),Cd(yd(ud),(function(component,n,t){var e=t.cyclic?vd:bd;return l(component,0,t,e)})),Cd(yd(cd),(function(component,n,t){return t.onEscape.bind((function(t){return t(component,n)}))})),Cd(xd([kd,yd(ad)]),(function(component,n,t){return t.onEnter.bind((function(t){return t(component,n)}))}))]),h=o([]);return Dd(t,si.init,d,h,(function(){return O.some(r)}))},Ad=Bd(me("cyclic",d)),Md=Bd(me("cyclic",m)),Fd=function(component,n,t){return Ul(t)&&yd(sd)(n.event)?O.none():function(component,n,t){return Go(component,t,wo()),O.some(!0)}(component,0,t)},Id=function(n,t){return O.some(!0)},Rd=[re("execute",Fd),re("useSpace",!1),re("useEnter",!0),re("useControlEnter",!1),re("useDown",!1)],Vd=function(component,n,t){return t.execute(component,n,component.element)},Pd=Dd(Rd,si.init,(function(component,n,t,e){var o=t.useSpace&&!Ul(component.element)?sd:[],r=t.useEnter?ad:[],c=t.useDown?gd:[],f=o.concat(r).concat(c);return[Cd(yd(f),Vd)].concat(t.useControlEnter?[Cd(xd([Sd,yd(ad)]),Vd)]:[])}),(function(component,n,t,e){return t.useSpace&&!Ul(component.element)?[Cd(yd(sd),Id)]:[]}),(function(){return O.none()})),Hd=function(){var n=ge(O.none());return fi({readState:function(){return n.get().map((function(n){return{numRows:String(n.numRows),numColumns:String(n.numColumns)}})).getOr({numRows:"?",numColumns:"?"})},setGridSize:function(t,e){n.set(O.some({numRows:t,numColumns:e}))},getNumRows:function(){return n.get().map((function(n){return n.numRows}))},getNumColumns:function(){return n.get().map((function(n){return n.numColumns}))}})},zd=Object.freeze({__proto__:null,flatgrid:Hd,init:function(n){return n.state(n)}}),Nd=function(n){return function(component,t,e,o){var r=n(component.element);return use(r,component,t,e,o)}},Ld=function(n,t){var e=Ic(n,t);return Nd(e)},jd=function(n,t){var e=Ic(t,n);return Nd(e)},Ud=function(n){return function(component,t,e,o){return use(n,component,t,e,o)}},use=function(n,component,t,e,o){return e.focusManager.get(component).bind((function(t){return n(component.element,t,e,o)})).map((function(n){return e.focusManager.set(component,n),!0}))},Wd=Ud,Gd=Ud,Xd=Ud,Yd=function(element){return!function(n){return n.offsetWidth<=0&&n.offsetHeight<=0}(element.dom)},qd=function(n,t,e){var o=rs(n,e);return function(n,t){return $(n,t).map((function(t){return{index:t,candidates:n}}))}(filter(o,Yd),(function(n){return Le(n,t)}))},Jd=function(n,t){return $(n,(function(n){return Le(t,n)}))},Kd=function(n,t,e,o){return o(Math.floor(t/e),t%e).bind((function(address){var t=address.row*e+address.column;return t>=0&&t<n.length?O.some(n[t]):O.none()}))},$d=function(n,t,e,o,r){return Kd(n,t,o,(function(t,c){var f=t===e-1?n.length-t*o:o,l=xc(c,r,0,f-1);return O.some({row:t,column:l})}))},Qd=function(n,t,e,o,r){return Kd(n,t,o,(function(t,c){var f=xc(t,r,0,e-1),l=f===e-1?n.length-f*o:o,d=wc(c,0,l-1);return O.some({row:f,column:d})}))},Zd=[Wt("selector"),re("execute",Fd),fa("onEscape"),re("captureTab",!1),ga()],nm=function(component,n,t){Xu(component.element,n.selector).each((function(t){n.focusManager.set(component,t)}))},tm=function(n){return function(element,t,e,o){return qd(element,t,e.selector).bind((function(t){return n(t.candidates,t.index,o.getNumRows().getOr(e.initSize.numRows),o.getNumColumns().getOr(e.initSize.numColumns))}))}},om=function(n,t,e){return e.captureTab?O.some(!0):O.none()},rm=tm((function(n,t,e,o){return $d(n,t,e,o,-1)})),im=tm((function(n,t,e,o){return $d(n,t,e,o,1)})),um=tm((function(n,t,e,o){return Qd(n,t,e,o,-1)})),am=tm((function(n,t,e,o){return Qd(n,t,e,o,1)})),cm=o([Cd(yd(fd),Ld(rm,im)),Cd(yd(md),jd(rm,im)),Cd(yd(ld),Wd(um)),Cd(yd(gd),Gd(am)),Cd(xd([wd,yd(ud)]),om),Cd(xd([kd,yd(ud)]),om),Cd(yd(cd),(function(component,n,t){return t.onEscape(component,n)})),Cd(yd(sd.concat(ad)),(function(component,n,t,e){return function(component,n){return n.focusManager.get(component).bind((function(t){return Yu(t,n.selector)}))}(component,t).bind((function(e){return t.execute(component,n,e)}))}))]),sm=o([Cd(yd(sd),Id)]),fm=Dd(Zd,Hd,cm,sm,(function(){return O.some(nm)})),lm=function(n,t,e,o){var r=function(n,t,e){var c,f=xc(t,o,0,e.length-1);return f===n?O.none():(c=e[f],"button"===fr(c)&&"disabled"===Hr(c,"disabled")?r(n,f,e):O.from(e[f]))};return qd(n,e,t).bind((function(n){var t=n.index,e=n.candidates;return r(t,t,e)}))},dm=[Wt("selector"),re("getInitial",O.none),re("execute",Fd),fa("onEscape"),re("executeOnMove",!1),re("allowVertical",!0)],mm=function(component,n,t){return function(component,n){return n.focusManager.get(component).bind((function(t){return Yu(t,n.selector)}))}(component,t).bind((function(e){return t.execute(component,n,e)}))},gm=function(component,n,t){n.getInitial(component).orThunk((function(){return Xu(component.element,n.selector)})).each((function(t){n.focusManager.set(component,t)}))},pm=function(element,n,t){return lm(element,t.selector,n,-1)},hm=function(element,n,t){return lm(element,t.selector,n,1)},vm=function(n){return function(component,t,e,o){return n(component,t,e,o).bind((function(){return e.executeOnMove?mm(component,t,e):O.some(!0)}))}},bm=function(component,n,t){return t.onEscape(component,n)},ym=o([Cd(yd(sd),Id)]),xm=Dd(dm,si.init,(function(n,t,e,o){var r=fd.concat(e.allowVertical?ld:[]),c=md.concat(e.allowVertical?gd:[]);return[Cd(yd(r),vm(Ld(pm,hm))),Cd(yd(c),vm(jd(pm,hm))),Cd(yd(ad),mm),Cd(yd(sd),mm),Cd(yd(cd),bm)]}),ym,(function(){return O.some(gm)})),wm=function(n,t,e){return O.from(n[t]).bind((function(n){return O.from(n[e]).map((function(n){return{rowIndex:t,columnIndex:e,cell:n}}))}))},Sm=function(n,t,e,o){var r=n[t].length,c=xc(e,o,0,r-1);return wm(n,t,c)},km=function(n,t,e,o){var r=xc(e,o,0,n.length-1),c=n[r].length,f=wc(t,0,c-1);return wm(n,r,f)},Cm=function(n,t,e,o){var r=n[t].length,c=wc(e+o,0,r-1);return wm(n,t,c)},Om=function(n,t,e,o){var r=wc(e+o,0,n.length-1),c=n[r].length,f=wc(t,0,c-1);return wm(n,r,f)},_m=[Kt("selectors",[Wt("row"),Wt("cell")]),re("cycles",!0),re("previousSelector",O.none),re("execute",Fd)],Tm=function(component,n,t){n.previousSelector(component).orThunk((function(){var t=n.selectors;return Xu(component.element,t.cell)})).each((function(t){n.focusManager.set(component,t)}))},Em=function(n,t){return function(element,e,o){var r=o.cycles?n:t;return Yu(e,o.selectors.row).bind((function(n){var t=rs(n,o.selectors.cell);return Jd(t,e).bind((function(t){var e=rs(element,o.selectors.row);return Jd(e,n).bind((function(n){var c=function(n,t){return map(n,(function(n){return rs(n,t.selectors.cell)}))}(e,o);return r(c,n,t).map((function(n){return n.cell}))}))}))}))}},Dm=Em((function(n,t,e){return Sm(n,t,e,-1)}),(function(n,t,e){return Cm(n,t,e,-1)})),Bm=Em((function(n,t,e){return Sm(n,t,e,1)}),(function(n,t,e){return Cm(n,t,e,1)})),Am=Em((function(n,t,e){return km(n,e,t,-1)}),(function(n,t,e){return Om(n,e,t,-1)})),Mm=Em((function(n,t,e){return km(n,e,t,1)}),(function(n,t,e){return Om(n,e,t,1)})),Fm=o([Cd(yd(fd),Ld(Dm,Bm)),Cd(yd(md),jd(Dm,Bm)),Cd(yd(ld),Wd(Am)),Cd(yd(gd),Gd(Mm)),Cd(yd(sd.concat(ad)),(function(component,n,t){return cc(component.element).bind((function(e){return t.execute(component,n,e)}))}))]),Im=o([Cd(yd(sd),Id)]),Rm=Dd(_m,si.init,Fm,Im,(function(){return O.some(Tm)})),Vm=[Wt("selector"),re("execute",Fd),re("moveOnTab",!1)],Pm=function(component,n,t){return t.focusManager.get(component).bind((function(e){return t.execute(component,n,e)}))},Hm=function(component,n,t){Xu(component.element,n.selector).each((function(t){n.focusManager.set(component,t)}))},zm=function(element,n,t){return lm(element,t.selector,n,-1)},Nm=function(element,n,t){return lm(element,t.selector,n,1)},Lm=o([Cd(yd(ld),Xd(zm)),Cd(yd(gd),Xd(Nm)),Cd(xd([wd,yd(ud)]),(function(component,n,t,e){return t.moveOnTab?Xd(zm)(component,n,t,e):O.none()})),Cd(xd([kd,yd(ud)]),(function(component,n,t,e){return t.moveOnTab?Xd(Nm)(component,n,t,e):O.none()})),Cd(yd(ad),Pm),Cd(yd(sd),Pm)]),jm=o([Cd(yd(sd),Id)]),Um=Dd(Vm,si.init,Lm,jm,(function(){return O.some(Hm)})),Wm=[fa("onSpace"),fa("onEnter"),fa("onShiftEnter"),fa("onLeft"),fa("onRight"),fa("onTab"),fa("onShiftTab"),fa("onUp"),fa("onDown"),fa("onEscape"),re("stopSpaceKeyup",!1),option("focusIn")],Gm=Dd(Wm,si.init,(function(component,n,t){return[Cd(yd(sd),t.onSpace),Cd(xd([kd,yd(ad)]),t.onEnter),Cd(xd([wd,yd(ad)]),t.onShiftEnter),Cd(xd([wd,yd(ud)]),t.onShiftTab),Cd(xd([kd,yd(ud)]),t.onTab),Cd(yd(ld),t.onUp),Cd(yd(gd),t.onDown),Cd(yd(fd),t.onLeft),Cd(yd(md),t.onRight),Cd(yd(sd),t.onSpace),Cd(yd(cd),t.onEscape)]}),(function(component,n,t){return t.stopSpaceKeyup?[Cd(yd(sd),Id)]:[]}),(function(n){return n.focusIn})),Xm=Ad.schema(),Ym=Md.schema(),qm=xm.schema(),Jm=fm.schema(),Km=Rm.schema(),$m=Pd.schema(),menu=Um.schema(),Qm=Gm.schema(),Zm=ec({branchKey:"mode",branches:Object.freeze({__proto__:null,acyclic:Xm,cyclic:Ym,flow:qm,flatgrid:Jm,matrix:Km,execution:$m,menu:menu,special:Qm}),name:"keying",active:{events:function(n,t){return n.handler.toEvents(n,t)}},apis:{focusIn:function(component,n,t){n.sendFocusIn(n).fold((function(){component.getSystem().triggerFocus(component.element,component.element)}),(function(e){e(component,n,t)}))},setGridSize:function(component,n,t,e,o){!function(n){return Rn(n,"setGridSize")}(t)?console.error("Layout does not support setGridSize"):t.setGridSize(e,o)}},state:zd}),ng=function(component,n,t,e){var o=component.getSystem().build(e);Js(component,o,t)},tg=function(component,n,t,e){var o=eg(component);K(o,(function(n){return Le(e.element,n.element)})).each($s)},eg=function(component,n){return component.components()},og=function(component,n,t,e,o){var r=eg(component);return O.from(r[e]).map((function(n){return tg(component,0,0,n),o.each((function(n){ng(component,0,(function(p,n){!function(n,element,t){Or(n,t).fold((function(){Dr(n,element)}),(function(n){_r(n,element)}))}(p,n,e)}),n)})),n}))},rg=nc({fields:[],name:"replacing",apis:Object.freeze({__proto__:null,append:function(component,n,t,e){ng(component,0,Dr,e)},prepend:function(component,n,t,e){ng(component,0,Er,e)},remove:tg,replaceAt:og,replaceBy:function(component,n,t,e,o){var r=eg(component);return $(r,e).bind((function(n){return og(component,0,0,n,o)}))},set:function(component,n,t,data){sc((function(){var n=map(data,component.getSystem().build);Ys(component,n)}),component.element)},contents:eg})}),ig=function(n,t){return{key:n,value:{config:{},me:function(n,t){var e=qo(t);return nc({fields:[Wt("enabled")],name:n,active:{events:o(e)}})}(n,t),configAsRaw:o({}),initialConfig:{},state:si}}},ug=function(component,n){n.ignore||(uc(component.element),n.onFocus(component))},ag=Object.freeze({__proto__:null,focus:ug,blur:function(component,n){n.ignore||function(element){element.dom.blur()}(component.element)},isFocused:function(component){return function(element){var n=Vi(element).dom;return element.dom===n.activeElement}(component.element)}}),cg=Object.freeze({__proto__:null,exhibit:function(base,n){var t=n.ignore?{}:{attributes:{tabindex:"-1"}};return mi(t)},events:function(n){return qo([$o(vo(),(function(component,t){ug(component,n),t.stop()}))].concat(n.stopMousedown?[$o(to(),(function(n,t){t.event.prevent()}))]:[]))}}),sg=[sa("onFocus"),re("stopMousedown",!1),re("ignore",!1)],fg=nc({fields:sg,name:"focusing",active:cg,apis:ag}),lg=function(component,n,t){var e=n.aria;e.update(component,e,t.get())},dg=function(component,n,t){n.toggleClass.each((function(n){t.get()?_i(component.element,n):Ei(component.element,n)}))},mg=function(component,n,t){hg(component,n,t,!t.get())},gg=function(component,n,t){t.set(!0),dg(component,n,t),lg(component,n,t)},pg=function(component,n,t){t.set(!1),dg(component,n,t),lg(component,n,t)},hg=function(component,n,t,e){(e?gg:pg)(component,n,t)},vg=function(component,n,t){hg(component,n,t,n.selected)},bg=Object.freeze({__proto__:null,onLoad:vg,toggle:mg,isOn:function(component,n,t){return t.get()},on:gg,off:pg,set:hg}),yg=Object.freeze({__proto__:null,exhibit:function(){return mi({})},events:function(n,t){var e,o,r,c=(e=n,o=t,r=mg,sr((function(component){r(component,e,o)}))),f=qa(n,t,vg);return qo(Q([n.toggleOnExecute?[c]:[],[f]]))}}),xg=function(component,n,t){Pr(component.element,"aria-expanded",t)},wg=[re("selected",!1),option("toggleClass"),re("toggleOnExecute",!0),ie("aria",{mode:"none"},It("mode",{pressed:[re("syncWithExpanded",!1),output("update",(function(component,n,t){Pr(component.element,"aria-pressed",t),n.syncWithExpanded&&xg(component,n,t)}))],checked:[output("update",(function(component,n,t){Pr(component.element,"aria-checked",t)}))],expanded:[output("update",xg)],selected:[output("update",(function(component,n,t){Pr(component.element,"aria-selected",t)}))],none:[output("update",t)]}))],Sg=nc({fields:wg,name:"toggling",active:yg,apis:bg,state:(Ed=!1,{init:function(){var n=ge(Ed);return{get:function(){return n.get()},set:function(t){return n.set(t)},clear:function(){return n.set(Ed)},readState:function(){return n.get()}}}})}),kg=function(){var n=function(component,n){n.stop(),Wo(component)};return[$o(lo(),n),$o(ko(),n),or($e()),or(to())]},Cg=function(n){return qo(Q([n.map((function(n){return sr((function(component,t){n(component),t.stop()}))})).toArray(),kg()]))},Og=function(n){(cc(n.element).isNone()||fg.isFocused(n))&&(fg.isFocused(n)||fg.focus(n),Uo(n,"alloy.item-hover",{item:n}))},_g=function(n){Uo(n,"alloy.item-focus",{item:n})},Tg=o("alloy.item-hover"),Eg=o("alloy.item-focus"),Dg=[Wt("data"),Wt("components"),Wt("dom"),re("hasSubmenu",!1),option("toggling"),Vf("itemBehaviours",[Sg,fg,Zm,Mf]),re("ignoreFocus",!1),re("domModification",{}),output("builder",(function(n){return{dom:n.dom,domModification:v(v({},n.domModification),{attributes:v(v(v({role:n.toggling.isSome()?"menuitemcheckbox":"menuitem"},n.domModification.attributes),{"aria-haspopup":n.hasSubmenu}),n.hasSubmenu?{"aria-expanded":!1}:{})}),behaviours:Pf(n.itemBehaviours,[n.toggling.fold(Sg.revoke,(function(n){return Sg.config(v({aria:{mode:"checked"}},n))})),fg.config({ignore:n.ignoreFocus,stopMousedown:n.ignoreFocus,onFocus:function(component){_g(component)}}),Zm.config({mode:"execution"}),Mf.config({store:{mode:"memory",initialValue:n.data}}),ig("item-type-events",x(kg(),[$o(io(),Og),$o(So(),fg.focus)]))]),components:n.components,eventOrder:n.eventOrder}})),re("eventOrder",{})],Bg=[Wt("dom"),Wt("components"),output("builder",(function(n){return{dom:n.dom,components:n.components,events:qo([rr(So())])}}))],Ag=o([sl({name:"widget",overrides:function(n){return{behaviours:Qa([Mf.config({store:{mode:"manual",getValue:function(t){return n.data},setValue:function(){}}})])}}})]),Mg=[Wt("uid"),Wt("data"),Wt("components"),Wt("dom"),re("autofocus",!1),re("ignoreFocus",!1),Vf("widgetBehaviours",[Mf,fg,Zm]),re("domModification",{}),Al(Ag()),output("builder",(function(n){var t=Sl(0,n,Ag()),e=kl("item-widget",n,t.internals()),o=function(component){return Cl(component,n,"widget").map((function(n){return Zm.focusIn(n),n}))},r=function(component,t){return Ul(t.event.target)?O.none():n.autofocus?(t.setSource(component.element),O.none()):O.none()};return{dom:n.dom,components:e,domModification:n.domModification,events:qo([sr((function(component,n){o(component).each((function(t){n.stop()}))})),$o(io(),Og),$o(So(),(function(component,t){n.autofocus?o(component):fg.focus(component)}))]),behaviours:Pf(n.widgetBehaviours,[Mf.config({store:{mode:"memory",initialValue:n.data}}),fg.config({ignore:n.ignoreFocus,onFocus:function(component){_g(component)}}),Zm.config({mode:"special",focusIn:n.autofocus?function(component){o(component)}:oc(),onLeft:r,onRight:r,onEscape:function(component,t){return fg.isFocused(component)||n.autofocus?n.autofocus?(t.setSource(component.element),O.none()):O.none():(fg.focus(component),O.some(!0))}})])}}))],Fg=It("type",{widget:Mg,item:Dg,separator:Bg}),Ig=o([ml({factory:{sketch:function(n){var t=At("menu.spec item",Fg,n);return t.builder(t)}},name:"items",unit:"item",defaults:function(n,u){return u.hasOwnProperty("uid")?u:v(v({},u),{uid:ni("item")})},overrides:function(n,u){return{type:u.type,ignoreFocus:n.fakeFocus,domModification:{classes:[n.markers.item]}}}})]),Rg=o([Wt("value"),Wt("items"),Wt("dom"),Wt("components"),re("eventOrder",{}),Ff("menuBehaviours",[rd,Mf,Xl,Zm]),ie("movement",{mode:"menu",moveOnTab:!0},It("mode",{grid:[ga(),output("config",(function(n,t){return{mode:"flatgrid",selector:"."+n.markers.item,initSize:{numColumns:t.initSize.numColumns,numRows:t.initSize.numRows},focusManager:n.focusManager}}))],matrix:[output("config",(function(n,t){return{mode:"matrix",selectors:{row:t.rowSelector,cell:"."+n.markers.item},focusManager:n.focusManager}})),Wt("rowSelector")],menu:[re("moveOnTab",!0),output("config",(function(n,t){return{mode:"menu",selector:"."+n.markers.item,moveOnTab:t.moveOnTab,focusManager:n.focusManager}}))]})),Gt("markers",ra()),re("fakeFocus",!1),re("focusManager",_d()),sa("onHighlight")]),Vg=o("alloy.menu-focus"),Pg=Nl({name:"Menu",configFields:Rg(),partFields:Ig(),factory:function(n,t,e,o){return{uid:n.uid,dom:n.dom,markers:n.markers,behaviours:Rf(n.menuBehaviours,[rd.config({highlightClass:n.markers.selectedItem,itemClass:n.markers.item,onHighlight:n.onHighlight}),Mf.config({store:{mode:"memory",initialValue:n.value}}),Xl.config({find:O.some}),Zm.config(n.movement.config(n,n.movement))]),events:qo([$o(Eg(),(function(menu,n){var t=n.event;menu.getSystem().getByDom(t.target).each((function(t){rd.highlight(menu,t),n.stop(),Uo(menu,Vg(),{menu:menu,item:t})}))})),$o(Tg(),(function(menu,n){var t=n.event.item;rd.highlight(menu,t)}))]),components:t,eventOrder:n.eventOrder,domModification:{attributes:{role:"menu"}}}}}),Hg=function(n,t,e,o){return Fn(e,o).bind((function(o){return Fn(n,o).bind((function(o){var r=Hg(n,t,e,o);return O.some([o].concat(r))}))})).getOr([])},zg=function(n,t){var e={};_n(n,(function(n,menu){G(n,(function(n){e[n]=menu}))}));var o=t,r=En(t,(function(n,t){return{k:n,v:t}})),c=Tn(r,(function(n,t){return[t].concat(Hg(e,o,r,t))}));return Tn(e,(function(menu){return Fn(c,menu).getOr([menu])}))},Ng=function(n){return"prepared"===n.type?O.some(n.menu):O.none()},Lg={init:function(){var n=ge({}),t=ge({}),e=ge({}),o=ge(O.none()),r=ge({}),c=function(t,e,path){return f(t).bind((function(menu){return function(t){return An(n.get(),(function(n,e){return n===t}))}(t).bind((function(n){return e(n).map((function(n){return{triggeredMenu:menu,triggeringItem:n,triggeringPath:path}}))}))}))},f=function(n){return l(n).bind(Ng)},l=function(n){return Fn(t.get(),n)},d=function(t){return Fn(n.get(),t)};return{setMenuBuilt:function(n,e){var o;t.set(v(v({},t.get()),((o={})[n]={type:"prepared",menu:e},o)))},setContents:function(c,f,l,d){o.set(O.some(c)),n.set(l),t.set(f),r.set(d);var m=zg(d,l);e.set(m)},expand:function(t){return Fn(n.get(),t).map((function(menu){var n=Fn(e.get(),t).getOr([]);return[menu].concat(n)}))},refresh:function(n){return Fn(e.get(),n)},collapse:function(n){return Fn(e.get(),n).bind((function(path){return path.length>1?O.some(path.slice(1)):O.none()}))},lookupMenu:l,lookupItem:d,otherMenus:function(path){var n=r.get();return en(Cn(n),path)},getPrimary:function(){return o.get().bind(f)},getMenus:function(){return t.get()},clear:function(){n.set({}),t.set({}),e.set({}),o.set(O.none())},isClear:function(){return o.get().isNone()},getTriggeringPath:function(n,t){var r=filter(d(n).toArray(),(function(n){return f(n).isSome()}));return Fn(e.get(),n).bind((function(path){var n=tn(r.concat(path));return function(n){for(var t=[],i=0;i<n.length;i++){var e=n[i];if(!e.isSome())return O.none();t.push(e.getOrDie())}return O.some(t)}(Z(n,(function(e,r){return c(e,t,n.slice(0,r+1)).fold((function(){return o.get().is(e)?[]:[O.none()]}),(function(data){return[O.some(data)]}))})))}))}}},extractPreparedMenu:Ng},jg=o("collapse-item"),Ug=zl({name:"TieredMenu",configFields:[da("onExecute"),da("onEscape"),la("onOpenMenu"),la("onOpenSubmenu"),sa("onRepositionMenu"),sa("onCollapseMenu"),re("highlightImmediately",!0),Kt("data",[Wt("primary"),Wt("menus"),Wt("expansions")]),re("fakeFocus",!1),sa("onHighlight"),sa("onHover"),ua(),Wt("dom"),re("navigateOnHover",!0),re("stayInDom",!1),Ff("tmenuBehaviours",[Zm,rd,Xl,rg]),re("eventOrder",{})],apis:{collapseMenu:function(n,t){n.collapseMenu(t)},highlightPrimary:function(n,t){n.highlightPrimary(t)},repositionMenus:function(n,t){n.repositionMenus(t)}},factory:function(n,t){var e,o=ge(O.none()),r=Lg.init(),c=function(t){var e=function(t,e,o){return Tn(o,(function(o,r){var c=function(){return Pg.sketch(v(v({},o),{value:r,markers:n.markers,fakeFocus:n.fakeFocus,onHighlight:n.onHighlight,focusManager:n.fakeFocus?Td():_d()}))};return r===e?{type:"prepared",menu:t.getSystem().build(c())}:{type:"notbuilt",nbMenu:c}}))}(t,n.data.primary,n.data.menus),o=l();return r.setContents(n.data.primary,e,n.data.expansions,o),r.getPrimary()},f=function(n){return Mf.getValue(n).value},l=function(t){return Tn(n.data.menus,(function(data,n){return Z(data.items,(function(n){return"separator"===n.type?[]:[n.data.value]}))}))},d=function(n,menu){rd.highlight(n,menu),rd.getHighlighted(menu).orThunk((function(){return rd.getFirst(menu)})).each((function(t){Go(n,t.element,So())}))},m=function(n,t){return Ll(map(t,(function(t){return n.lookupMenu(t).bind((function(n){return"prepared"===n.type?O.some(n.menu):O.none()}))})))},h=function(t,e,path){var o=m(e,e.otherMenus(path));G(o,(function(e){Ai(e.element,[n.markers.backgroundMenu]),n.stayInDom||rg.remove(t,e)}))},y=function(t,path){var e=function(t){return o.get().getOrThunk((function(){var e={},r=rs(t.element,"."+n.markers.item),c=filter(r,(function(i){return"true"===Hr(i,"aria-haspopup")}));return G(c,(function(i){t.getSystem().getByDom(i).each((function(n){var t=f(n);e[t]=n}))})),o.set(O.some(e)),e}))}(t);_n(e,(function(n,t){var e=L(path,t);Pr(n.element,"aria-expanded",e)}))},x=function(t,e,path){return O.from(path[0]).bind((function(o){return e.lookupMenu(o).bind((function(o){if("notbuilt"===o.type)return O.none();var r=o.menu,c=m(e,path.slice(1));return G(c,(function(t){_i(t.element,n.markers.backgroundMenu)})),Li(r.element)||rg.append(t,mu(r)),Ai(r.element,[n.markers.backgroundMenu]),d(t,r),h(t,e,path),O.some(r)}))}))};!function(n){n[n.HighlightSubmenu=0]="HighlightSubmenu",n[n.HighlightParent=1]="HighlightParent"}(e||(e={}));var w=function(t,o,c){void 0===c&&(c=e.HighlightSubmenu);var l=f(o);return r.expand(l).bind((function(path){return y(t,path),O.from(path[0]).bind((function(f){return r.lookupMenu(f).bind((function(l){var d=function(n,t,e){if("notbuilt"===e.type){var menu=n.getSystem().build(e.nbMenu());return r.setMenuBuilt(t,menu),menu}return e.menu}(t,f,l);return Li(d.element)||rg.append(t,mu(d)),n.onOpenSubmenu(t,o,d,tn(path)),c===e.HighlightSubmenu?(rd.highlightFirst(d),x(t,r,path)):(rd.dehighlightAll(d),O.some(o))}))}))}))},S=function(t,e){var o=f(e);return r.collapse(o).bind((function(path){return y(t,path),x(t,r,path).map((function(o){return n.onCollapseMenu(t,e,o),o}))}))},k=function(t){return function(e,o){return Yu(o.getSource(),"."+n.markers.item).bind((function(n){return e.getSystem().getByDom(n).toOptional().bind((function(n){return t(e,n).map((function(){return!0}))}))}))}},C=qo([$o(Vg(),(function(n,t){var e=t.event.item;r.lookupItem(f(e)).each((function(){var menu=t.event.menu;rd.highlight(n,menu);var e=f(t.event.item);r.refresh(e).each((function(path){return h(n,r,path)}))}))})),sr((function(component,t){var o=t.event.target;component.getSystem().getByDom(o).each((function(t){0===f(t).indexOf("collapse-item")&&S(component,t),w(component,t,e.HighlightSubmenu).fold((function(){n.onExecute(component,t)}),(function(){}))}))})),ur((function(t,e){c(t).each((function(e){rg.append(t,mu(e)),n.onOpenMenu(t,e),n.highlightImmediately&&d(t,e)}))}))].concat(n.navigateOnHover?[$o(Tg(),(function(t,o){var c=o.event.item;!function(n,t){var e=f(t);r.refresh(e).bind((function(path){return y(n,path),x(n,r,path)}))}(t,c),w(t,c,e.HighlightParent),n.onHover(t,c)}))]:[])),_=function(n){return rd.getHighlighted(n).bind(rd.getHighlighted)},T={collapseMenu:function(n){_(n).each((function(t){S(n,t)}))},highlightPrimary:function(n){r.getPrimary().each((function(t){d(n,t)}))},repositionMenus:function(t){r.getPrimary().bind((function(n){return _(t).bind((function(n){var t=f(n),e=Mn(r.getMenus()),o=Ll(map(e,Lg.extractPreparedMenu));return r.getTriggeringPath(t,(function(n){return function(n,t,e){return cn(t,(function(menu){if(!menu.getSystem().isConnected())return O.none();var n=rd.getCandidates(menu);return K(n,(function(n){return f(n)===e}))}))}(0,o,n)}))})).map((function(t){return{primary:n,triggeringPath:t}}))})).fold((function(){(function(n){return O.from(n.components()[0]).filter((function(n){return"menu"===Hr(n.element,"role")}))})(t).each((function(e){n.onRepositionMenu(t,e,[])}))}),(function(e){var o=e.primary,r=e.triggeringPath;n.onRepositionMenu(t,o,r)}))}};return{uid:n.uid,dom:n.dom,markers:n.markers,behaviours:Rf(n.tmenuBehaviours,[Zm.config({mode:"special",onRight:k((function(n,t){return Ul(t.element)?O.none():w(n,t,e.HighlightSubmenu)})),onLeft:k((function(n,t){return Ul(t.element)?O.none():S(n,t)})),onEscape:k((function(t,e){return S(t,e).orThunk((function(){return n.onEscape(t,e).map((function(){return t}))}))})),focusIn:function(n,t){r.getPrimary().each((function(t){Go(n,t.element,So())}))}}),rd.config({highlightClass:n.markers.selectedMenu,itemClass:n.markers.menu}),Xl.config({find:function(n){return rd.getHighlighted(n)}}),rg.config({})]),eventOrder:n.eventOrder,apis:T,events:C}},extraApis:{tieredData:function(n,t,e){return{primary:n,menus:t,expansions:e}},singleData:function(n,menu){return{primary:n,menus:$n(n,menu),expansions:{}}},collapseItem:function(text){return{value:Yr(jg()),meta:{text:text}}}}}),Wg=zl({name:"InlineView",configFields:[Wt("lazySink"),sa("onShow"),sa("onHide"),ee("onEscape"),Ff("inlineBehaviours",[df,Mf,rc]),oe("fireDismissalEventInstead",[re("event",Io())]),oe("fireRepositionEventInstead",[re("event",Ro())]),re("getRelated",O.none),re("isExtraPart",d),re("eventOrder",O.none)],factory:function(n,t){var e=function(n,t,e,r){o(n,t,e,(function(){return r.map((function(n){return Pu(n)}))}))},o=function(t,e,o,r){var c=n.lazySink(t).getOrDie();df.openWhileCloaked(t,o,(function(){return Us.positionWithinBounds(c,e,t,r())})),Mf.setValue(t,O.some({mode:"position",anchor:e,getBounds:r}))},r=function(t,e,o,r){var menu=function(n,t,e,o,r){var c=function(){return n.lazySink(t)},f="horizontal"===o.type?{layouts:{onLtr:function(){return Wa()},onRtl:function(){return Ga()}}}:{},l=function(n){return function(n){return 2===n.length}(n)?f:{}};return Ug.sketch({dom:{tag:"div"},data:o.data,markers:o.menu.markers,highlightImmediately:o.menu.highlightImmediately,onEscape:function(){return df.close(t),n.onEscape.map((function(n){return n(t)})),O.some(!0)},onExecute:function(){return O.some(!0)},onOpenMenu:function(n,menu){Us.positionWithinBounds(c().getOrDie(),e,menu,r())},onOpenSubmenu:function(n,t,e,o){var r=c().getOrDie();Us.position(r,v({anchor:"submenu",item:t},l(o)),e)},onRepositionMenu:function(n,t,o){var f=c().getOrDie();Us.positionWithinBounds(f,e,t,r()),G(o,(function(n){var t=l(n.triggeringPath);Us.position(f,v({anchor:"submenu",item:n.triggeringItem},t),n.triggeredMenu)}))}})}(n,t,e,o,r);df.open(t,menu),Mf.setValue(t,O.some({mode:"menu",menu:menu}))},c=function(t){df.isOpen(t)&&Mf.getValue(t).each((function(e){switch(e.mode){case"menu":df.getState(t).each((function(n){Ug.repositionMenus(n)}));break;case"position":var o=n.lazySink(t).getOrDie();Us.positionWithinBounds(o,e.anchor,t,e.getBounds())}}))},f={setContent:function(n,t){df.setContent(n,t)},showAt:function(n,t,o){e(n,t,o,O.none())},showWithin:e,showWithinBounds:o,showMenuAt:function(n,t,e){r(n,t,e,(function(){return O.none()}))},showMenuWithinBounds:r,hide:function(n){df.isOpen(n)&&(Mf.setValue(n,O.none()),df.close(n))},getContent:function(n){return df.getState(n)},reposition:c,isOpen:df.isOpen};return{uid:n.uid,dom:n.dom,behaviours:Rf(n.inlineBehaviours,[df.config({isPartOf:function(t,data,e){return Ku(data,e)||function(t,e){return n.getRelated(t).exists((function(n){return Ku(n,e)}))}(t,e)},getAttachPoint:function(t){return n.lazySink(t).getOrDie()},onOpen:function(t){n.onShow(t)},onClose:function(t){n.onHide(t)}}),Mf.config({store:{mode:"memory",initialValue:O.none()}}),rc.config({channels:v(v({},vf(v({isExtraPart:t.isExtraPart},n.fireDismissalEventInstead.map((function(n){return{fireEventInstead:{event:n.event}}})).getOr({})))),yf(v(v({},n.fireRepositionEventInstead.map((function(n){return{fireEventInstead:{event:n.event}}})).getOr({})),{doReposition:c})))})]),eventOrder:n.eventOrder,apis:f}},apis:{showAt:function(n,component,t,e){n.showAt(component,t,e)},showWithin:function(n,component,t,e,o){n.showWithin(component,t,e,o)},showWithinBounds:function(n,component,t,e,o){n.showWithinBounds(component,t,e,o)},showMenuAt:function(n,component,t,e){n.showMenuAt(component,t,e)},showMenuWithinBounds:function(n,component,t,e,o){n.showMenuWithinBounds(component,t,e,o)},hide:function(n,component){n.hide(component)},isOpen:function(n,component){return n.isOpen(component)},getContent:function(n,component){return n.getContent(component)},setContent:function(n,component,t){n.setContent(component,t)},reposition:function(n,component){n.reposition(component)}}}),Gg=function(n){return n.x},Xg=function(n,element){return n.x+n.width/2-element.width/2},Yg=function(n,element){return n.x+n.width-element.width},qg=function(n){return n.y},Jg=function(n,element){return n.y+n.height-element.height},Kg=function(n,element,t){return pa(Yg(n,element),Jg(n,element),t.innerSoutheast(),xa(),Oa(n,{right:0,bottom:3}),"layout-inner-se")},$g=function(n,element,t){return pa(Gg(n),Jg(n,element),t.innerSouthwest(),ya(),Oa(n,{left:1,bottom:3}),"layout-inner-sw")},Qg=function(n,element,t){return pa(Yg(n,element),qg(n),t.innerNortheast(),ba(),Oa(n,{right:0,top:2}),"layout-inner-ne")},Zg=function(n,element,t){return pa(Gg(n),qg(n),t.innerNorthwest(),va(),Oa(n,{left:1,top:2}),"layout-inner-nw")},np=function(n,element,t){return pa(Xg(n,element),qg(n),t.innerNorth(),wa(),Oa(n,{top:2}),"layout-inner-n")},tp=function(n,element,t){return pa(Xg(n,element),Jg(n,element),t.innerSouth(),Sa(),Oa(n,{bottom:3}),"layout-inner-s")},ep=tinymce.util.Tools.resolve("tinymce.util.Delay"),op=zl({name:"Button",factory:function(n){var t=Cg(n.action),e=n.dom.tag,o=function(t){return Fn(n.dom,"attributes").bind((function(n){return Fn(n,t)}))};return{uid:n.uid,dom:n.dom,components:n.components,events:t,behaviours:Pf(n.buttonBehaviours,[fg.config({}),Zm.config({mode:"execution",useSpace:!0,useEnter:!0})]),domModification:{attributes:function(){if("button"===e){var n=o("type").getOr("button"),t=o("role").map((function(n){return{role:n}})).getOr({});return v({type:n},t)}return{role:o("role").getOr("button")}}()},eventOrder:n.eventOrder}},configFields:[re("uid",void 0),Wt("dom"),re("components",[]),Vf("buttonBehaviours",[fg,Zm]),option("action"),option("role"),re("eventOrder",{})]}),ip=function(n){var t=function(n){return void 0!==n.uid}(n)&&Rn(n,"uid")?n.uid:ni("memento");return{get:function(n){return n.getSystem().getByUid(t).getOrDie()},getOpt:function(n){return n.getSystem().getByUid(t).toOptional()},asSpec:function(){return v(v({},n),{uid:t})}}},up=function(n){return O.from(n()["temporary-placeholder"]).getOr("!not found!")},ap=function(n,t){return O.from(t()[n.toLowerCase()]).getOrThunk((function(){return up(t)}))},cp=function(n,t){return cn(n,(function(n){return O.from(t()[n.toLowerCase()])})).getOrThunk((function(){return up(t)}))},sp={success:"checkmark",error:"warning",err:"error",warning:"warning",warn:"warning",info:"info"},fp=zl({name:"Notification",factory:function(n){var t=ip({dom:{tag:"p",innerHtml:n.translationProvider(n.text)},behaviours:Qa([rg.config({})])}),e=function(n){return{dom:{tag:"div",classes:["tox-bar"],attributes:{style:"width: "+n+"%"}}}},o=function(n){return{dom:{tag:"div",classes:["tox-text"],innerHtml:n+"%"}}},r=ip({dom:{tag:"div",classes:n.progress?["tox-progress-bar","tox-progress-indicator"]:["tox-progress-bar"]},components:[{dom:{tag:"div",classes:["tox-bar-container"]},components:[e(0)]},o(0)],behaviours:Qa([rg.config({})])}),c={updateProgress:function(n,t){n.getSystem().isConnected()&&r.getOpt(n).each((function(progress){rg.set(progress,[{dom:{tag:"div",classes:["tox-bar-container"]},components:[e(t)]},o(t)])}))},updateText:function(n,e){if(n.getSystem().isConnected()){var o=t.get(n);rg.set(o,[text(e)])}}},f=Q([n.icon.toArray(),n.level.toArray(),n.level.bind((function(n){return O.from(sp[n])})).toArray()]),l=ip(op.sketch({dom:{tag:"button",classes:["tox-notification__dismiss","tox-button","tox-button--naked","tox-button--icon"]},components:[{dom:{tag:"div",classes:["tox-icon"],innerHtml:ap("close",n.iconProvider),attributes:{"aria-label":n.translationProvider("Close")}}}],action:function(t){n.onAction(t)}})),d=[{dom:{tag:"div",classes:["tox-notification__icon"],innerHtml:cp(f,n.iconProvider)}},{dom:{tag:"div",classes:["tox-notification__body"]},components:[t.asSpec()],behaviours:Qa([rg.config({})])}];return{uid:n.uid,dom:{tag:"div",attributes:{role:"alert"},classes:n.level.map((function(n){return["tox-notification","tox-notification--in","tox-notification--"+n]})).getOr(["tox-notification","tox-notification--in"])},behaviours:Qa([fg.config({}),ig("notification-events",[$o(uo(),(function(n){l.getOpt(n).each(fg.focus)}))])]),components:d.concat(n.progress?[r.asSpec()]:[]).concat(n.closeButton?[l.asSpec()]:[]),apis:c}},configFields:[option("level"),Wt("progress"),Wt("icon"),Wt("onAction"),Wt("text"),Wt("iconProvider"),Wt("translationProvider"),se("closeButton",!0)],apis:{updateProgress:function(n,t,e){n.updateProgress(t,e)},updateText:function(n,t,text){n.updateText(t,text)}}});function lp(n,t,e){var o=t.backstage;return{open:function(n,r){var c=!n.closeButton&&n.timeout&&(n.timeout>0||n.timeout<0),f=function(){r(),Wg.hide(d)},l=du(fp.sketch({text:n.text,level:L(["success","error","warning","warn","info"],n.type)?n.type:void 0,progress:!0===n.progressBar,icon:O.from(n.icon),closeButton:!c,onAction:f,iconProvider:o.shared.providers.icons,translationProvider:o.shared.providers.translate})),d=du(Wg.sketch(v({dom:{tag:"div",classes:["tox-notifications-container"]},lazySink:t.backstage.shared.getSink,fireDismissalEventInstead:{}},o.shared.header.isPositionedAtTop()?{}:{fireRepositionEventInstead:{}})));return e.add(d),n.timeout>0&&ep.setTimeout((function(){f()}),n.timeout),{close:f,moveTo:function(n,t){Wg.showAt(d,{anchor:"makeshift",x:n,y:t},mu(l))},moveRel:function(element,n){if("banner"!==n){var e=function(n){switch(n){case"bc-bc":return tp;case"tc-tc":return np;case"tc-bc":return Va;case"bc-tc":default:return Pa}}(n),o={anchor:"node",root:body(),node:O.some(he.fromDom(element)),layouts:{onRtl:function(){return[e]},onLtr:function(){return[e]}}};Wg.showAt(d,o,mu(l))}else Wg.showAt(d,t.backstage.shared.anchors.banner(),mu(l))},text:function(n){fp.updateText(l,n)},settings:n,getEl:function(){return l.element.dom},progressBar:{value:function(n){fp.updateProgress(l,n)}}}},close:function(n){n.close()},reposition:function(n){!function(n){G(n,(function(n){return n.moveTo(0,0)}))}(n),function(n){n.length>0&&(head(n).each((function(n){return n.moveRel(null,"banner")})),G(n,(function(t,e){e>0&&t.moveRel(n[e-1].getEl(),"bc-tc")})))}(n)},getArgs:function(n){return n.settings}}}var dp,mp=function(n,t){var e=null;return{cancel:function(){null!==e&&(clearTimeout(e),e=null)},throttle:function(){for(var o=[],r=0;r<arguments.length;r++)o[r]=arguments[r];null!==e&&clearTimeout(e),e=setTimeout((function(){n.apply(null,o),e=null}),t)}}},gp=tinymce.util.Tools.resolve("tinymce.dom.TextSeeker"),pp=function(n,t,e,o,r){var c=gp(n,(function(t){return function(n,t){return n.isBlock(t)||L(["BR","IMG","HR","INPUT"],t.nodeName)||"false"===n.getContentEditable(t)}(n,t)}));return O.from(c.backwards(t,e,o,r))},hp=function(n,t){return vp(he.fromDom(n.selection.getNode())).getOrThunk((function(){var e=he.fromHtml('<span data-mce-autocompleter="1" data-mce-bogus="1"></span>',n.getDoc());return Dr(e,he.fromDom(t.extractContents())),t.insertNode(e.dom),Sr(e).each((function(n){return n.dom.normalize()})),function(element){return os(element,es)}(e).map((function(t){n.selection.setCursorLocation(t.dom,function(element){return"img"===fr(element)?1:ns(element).fold((function(){return Cr(element).length}),(function(n){return n.length}))}(t))})),e}))},vp=function(n){return Yu(n,"[data-mce-autocompleter]")},bp=function(n){return n.toString().replace(/\u00A0/g," ").replace(/\uFEFF/g,"")},yp=function(n){return""!==n&&-1!==" \f\n\r\t\v".indexOf(n)},xp=function(text,n){return text.substring(n.length)},wp=function(n,t,e,o){if(void 0===o&&(o=0),!(r=t).collapsed||3!==r.startContainer.nodeType)return O.none();var r,c=n.getParent(t.startContainer,n.isBlock)||n.getRoot();return pp(n,t.startContainer,t.startOffset,(function(element,n,text){return function(text,n,t){var i;for(i=n-1;i>=0;i--){var e=text.charAt(i);if(yp(e))return O.none();if(e===t)break}return O.some(i)}(text,n,e).getOr(n)}),c).bind((function(n){var r=t.cloneRange();if(r.setStart(n.container,n.offset),r.setEnd(t.endContainer,t.endOffset),r.collapsed)return O.none();var text=bp(r);return 0!==text.lastIndexOf(e)||xp(text,e).length<o?O.none():O.some({text:xp(text,e),range:r,triggerChar:e})}))},Sp=function(n,t,e,o){return void 0===o&&(o=0),vp(he.fromDom(t.startContainer)).fold((function(){return wp(n,t,e,o)}),(function(t){var o=n.createRng();o.selectNode(t.dom);var text=bp(o);return O.some({range:o,text:xp(text,e),triggerChar:e})}))},kp=function(n,t){t.on("keypress compositionend",n.onKeypress.throttle),t.on("remove",n.onKeypress.cancel);var e=function(n,t){Uo(n,co(),{raw:t})};t.on("keydown",(function(t){var o=function(){return n.getView().bind(rd.getHighlighted)};8===t.which&&n.onKeypress.throttle(t),n.isActive()&&(27===t.which&&n.cancelIfNecessary(),n.isMenuOpen()?13===t.which?(o().each(Wo),t.preventDefault()):40===t.which?(o().fold((function(){n.getView().each(rd.highlightFirst)}),(function(n){e(n,t)})),t.preventDefault(),t.stopImmediatePropagation()):37!==t.which&&38!==t.which&&39!==t.which||o().each((function(n){e(n,t),t.preventDefault(),t.stopImmediatePropagation()})):13!==t.which&&38!==t.which&&40!==t.which||n.cancelIfNecessary())})),t.on("NodeChange",(function(t){n.isActive()&&!n.isProcessingAction()&&vp(he.fromDom(t.element)).isNone()&&n.cancelIfNecessary()}))},Cp=tinymce.util.Tools.resolve("tinymce.util.Promise"),Op=function(n,t){return{container:n,offset:t}},_p=function(n){if(function(n){return 3===n.nodeType}(n))return Op(n,n.data.length);var t=n.childNodes;return t.length>0?_p(t[t.length-1]):Op(n,t.length)},Tp=function(n,t){var e=n.childNodes;return e.length>0&&t<e.length?Tp(e[t],0):e.length>0&&function(n){return 1===n.nodeType}(n)&&e.length===t?_p(e[e.length-1]):Op(n,t)},Ep=function(n){return function(t){var e=Tp(t.startContainer,t.startOffset);return!function(n,t){return pp(n,t.container,t.offset,(function(element,n){return 0===n?-1:n}),n.getRoot()).filter((function(n){var t=n.container.data.charAt(n.offset-1);return!yp(t)})).isSome()}(n,e)}},Dp=function(n,t){var e=t(),o=n.selection.getRng();return function(n,t,e){return cn(e.triggerChars,(function(e){return Sp(n,t,e)}))}(n.dom,o,e).bind((function(e){return Bp(n,t,e)}))},Bp=function(n,t,e,o){void 0===o&&(o={});var r=t(),c=n.selection.getRng().startContainer.nodeValue,f=filter(r.lookupByChar(e.triggerChar),(function(t){return e.text.length>=t.minChars&&t.matches.getOrThunk((function(){return Ep(n.dom)}))(e.range,c,e.text)}));if(0===f.length)return O.none();var l=Cp.all(map(f,(function(n){return n.fetch(e.text,n.maxResults,o).then((function(t){return{matchText:e.text,items:t,columns:n.columns,onAction:n.onAction,highlightOn:n.highlightOn}}))})));return O.some({lookupData:l,context:e})},Ap=gt([Yt("type"),te("text")]),Mp=gt([re("type","autocompleteitem"),re("active",!1),re("disabled",!1),re("meta",{}),Yt("value"),te("text"),te("icon")]),Fp=gt([Yt("type"),Yt("ch"),ue("minChars",1),re("columns",1),ue("maxResults",10),ee("matches"),Jt("fetch"),Jt("onAction"),le("highlightOn",[],Ht)]),Ip=[se("disabled",!1),te("tooltip"),te("icon"),te("text"),fe("onSetup",(function(){return t}))],Rp=gt([Yt("type"),Jt("onAction")].concat(Ip)),Vp=function(n){return Dt("toolbarbutton",Rp,n)},Pp=[se("active",!1)].concat(Ip),Hp=gt(Pp.concat([Yt("type"),Jt("onAction")])),zp=function(n){return Dt("ToggleButton",Hp,n)},Np=[fe("predicate",(function(){return!1})),ce("scope","node",["node","editor"]),ce("position","selection",["node","selection","line"])],Lp=Ip.concat([re("type","contextformbutton"),re("primary",!1),Jt("onAction"),me("original",r)]),jp=Pp.concat([re("type","contextformbutton"),re("primary",!1),Jt("onAction"),me("original",r)]),Up=Ip.concat([re("type","contextformbutton")]),Wp=Pp.concat([re("type","contextformtogglebutton")]),Gp=It("type",{contextformbutton:Lp,contextformtogglebutton:jp}),Xp=gt([re("type","contextform"),fe("initValue",(function(){return""})),te("label"),Qt("commands",Gp),Zt("launch",It("type",{contextformbutton:Up,contextformtogglebutton:Wp}))].concat(Np)),Yp=gt([re("type","contexttoolbar"),Yt("items")].concat(Np)),qp=function(n){var t=n.ui.registry.getAll().popups,e=Tn(t,(function(n){return(t=n,Dt("Autocompleter",Fp,t)).fold((function(n){throw new Error(Mt(n))}),(function(n){return n}));var t})),o=function(a){var n={};return G(a,(function(t){n[t]={}})),Cn(n)}(Bn(e,(function(n){return n.ch}))),r=Mn(e);return{dataset:e,triggerChars:o,lookupByChar:function(n){return filter(r,(function(t){return t.ch===n}))}}};!function(n){n[n.CLOSE_ON_EXECUTE=0]="CLOSE_ON_EXECUTE",n[n.BUBBLE_TO_SANDBOX=1]="BUBBLE_TO_SANDBOX"}(dp||(dp={}));var Jp,Kp=dp,$p="tox-menu-nav__js",Qp="tox-collection__item",Zp={normal:$p,color:"tox-swatch"},nh="tox-collection__item-label",eh="tox-collection__item--active",oh=function(n){return Fn(Zp,n).getOr($p)},rh=function(n){return"color"===n?"tox-swatches":"tox-menu"},ih=function(n){return{backgroundMenu:"tox-background-menu",selectedMenu:"tox-selected-menu",selectedItem:"tox-collection__item--active",hasIcons:"tox-menu--has-icons",menu:rh(n),tieredMenu:"tox-tiered-menu"}},uh=function(n){var t=ih(n);return{backgroundMenu:t.backgroundMenu,selectedMenu:t.selectedMenu,menu:t.menu,selectedItem:t.selectedItem,item:oh(n)}},ah=function(n,t,e){var o=ih(e);return{tag:"div",classes:Q([[o.menu,"tox-menu-"+t+"-column"],n?[o.hasIcons]:[]])}},ch=[Pg.parts.items({})],sh=function(n,t,e){var o=ih(e);return{dom:{tag:"div",classes:Q([[o.tieredMenu]])},markers:uh(e)}},fh=function(n,t){return function(e){var o=W(e,t);return map(o,(function(t){return{dom:n,components:t}}))}},lh=function(n,t){var e=[],o=[];return G(n,(function(n,i){t(n,i)?(o.length>0&&e.push(o),o=[],In(n.dom,"innerHtml")&&o.push(n)):o.push(n)})),o.length>0&&e.push(o),map(e,(function(s){return{dom:{tag:"div",classes:["tox-collection__group"]},components:s}}))},dh=function(n,t,e){return{dom:{tag:"div",classes:["tox-menu","tox-collection"].concat(1===n?["tox-collection--list"]:["tox-collection--grid"])},components:[Pg.parts.items({preprocess:function(e){return"auto"!==n&&n>1?fh({tag:"div",classes:["tox-collection__group"]},n)(e):lh(e,(function(n,i){return"separator"===t[i].type}))}})]}},mh=function(n){return j(n,(function(n){return"icon"in n&&void 0!==n.icon}))},gh=function(n){return console.error(Mt(n)),console.log(n),O.none()},ph=function(n,t,e,o,r){var c,f=(c=e,{dom:{tag:"div",classes:["tox-collection","tox-collection--horizontal"]},components:[Pg.parts.items({preprocess:function(n){return lh(n,(function(n,i){return"separator"===c[i].type}))}})]});return{value:n,dom:f.dom,components:f.components,items:e}},hh=function(n,t,e,o,c){var f;return"color"===c?{value:n,dom:(f=function(n){return{dom:{tag:"div",classes:["tox-menu","tox-swatches-menu"]},components:[{dom:{tag:"div",classes:["tox-swatches"]},components:[Pg.parts.items({preprocess:"auto"!==n?fh({tag:"div",classes:["tox-swatches__row"]},n):r})]}]}}(o)).dom,components:f.components,items:e}:"normal"===c&&"auto"===o?{value:n,dom:(f=dh(o,e)).dom,components:f.components,items:e}:"normal"===c&&1===o?{value:n,dom:(f=dh(1,e)).dom,components:f.components,items:e}:"normal"===c?{value:n,dom:(f=dh(o,e)).dom,components:f.components,items:e}:"listpreview"===c&&"auto"!==o?{value:n,dom:(f=function(n){return{dom:{tag:"div",classes:["tox-menu","tox-collection","tox-collection--toolbar","tox-collection--toolbar-lg"]},components:[Pg.parts.items({preprocess:fh({tag:"div",classes:["tox-collection__group"]},n)})]}}(o)).dom,components:f.components,items:e}:{value:n,dom:ah(t,o,c),components:ch,items:e}},vh=[Yt("type"),Yt("src"),te("alt"),le("classes",[],Ht)],bh=gt(vh),yh=[Yt("type"),Yt("text"),te("name"),le("classes",["tox-collection__item-label"],Ht)],xh=gt(yh),wh=_t((function(){return Ft("type",{cardimage:bh,cardtext:xh,cardcontainer:Sh})})),Sh=gt([Yt("type"),ae("direction","horizontal"),ae("align","left"),ae("valign","middle"),Qt("items",wh)]),kh=[se("disabled",!1),te("text"),te("shortcut"),wt("value","value",Yn((function(){return Yr("menuitem-value")})),Rt()),re("meta",{})],Ch=gt([Yt("type"),te("label"),Qt("items",wh),fe("onSetup",(function(){return t})),fe("onAction",t)].concat(kh)),Oh=gt([Yt("type"),se("active",!1),te("icon")].concat(kh)),_h=gt([Yt("type"),qt("fancytype",["inserttable","colorswatch"]),fe("onAction",t)]),Th=gt([Yt("type"),fe("onSetup",(function(){return t})),fe("onAction",t),te("icon")].concat(kh)),Eh=gt([Yt("type"),Jt("getSubmenuItems"),fe("onSetup",(function(){return t})),te("icon")].concat(kh)),Dh=gt([Yt("type"),te("icon"),se("active",!1),fe("onSetup",(function(){return t})),Jt("onAction")].concat(kh)),Bh=function(n,t,e){var o=rs(n.element,"."+e);if(o.length>0){var r=$(o,(function(n){var e=n.dom.getBoundingClientRect().top,r=o[0].dom.getBoundingClientRect().top;return Math.abs(e-r)>t})).getOr(o.length);return O.some({numColumns:r,numRows:Math.ceil(o.length/r)})}return O.none()},Ah=function(n,t){return Qa([ig(n,t)])},Mh=function(n){return Ah(Yr("unnamed-events"),n)},Fh=[Wt("lazySink"),Wt("tooltipDom"),re("exclusive",!0),re("tooltipComponents",[]),re("delay",300),ce("mode","normal",["normal","follow-highlight"]),re("anchor",(function(n){return{anchor:"hotspot",hotspot:n,layouts:{onLtr:o([Pa,Va,Ma,Ia,Fa,Ra]),onRtl:o([Pa,Va,Ma,Ia,Fa,Ra])}}})),sa("onHide"),sa("onShow")],Ih=Object.freeze({__proto__:null,init:function(){var n=ge(O.none()),t=ge(O.none()),e=function(){n.get().each((function(n){clearTimeout(n)}))},r=o("not-implemented");return fi({getTooltip:function(){return t.get()},isShowing:function(){return t.get().isSome()},setTooltip:function(n){t.set(O.some(n))},clearTooltip:function(){t.set(O.none())},clearTimer:e,resetTimer:function(t,o){e(),n.set(O.some(setTimeout((function(){t()}),o)))},readState:r})}}),Rh=Yr("tooltip.exclusive"),Vh=Yr("tooltip.show"),Ph=Yr("tooltip.hide"),Hh=function(component,n,t){component.getSystem().broadcastOn([Rh],{})},zh=Object.freeze({__proto__:null,hideAllExclusive:Hh,setComponents:function(component,n,t,e){t.getTooltip().each((function(n){n.getSystem().isConnected()&&rg.set(n,e)}))}}),Nh=nc({fields:Fh,name:"tooltipping",active:Object.freeze({__proto__:null,events:function(n,t){var e=function(e){t.getTooltip().each((function(p){$s(p),n.onHide(e,p),t.clearTooltip()})),t.clearTimer()};return qo(Q([[$o(Vh,(function(e){t.resetTimer((function(){!function(e){if(!t.isShowing()){Hh(e);var o=n.lazySink(e).getOrDie(),r=e.getSystem().build({dom:n.tooltipDom,components:n.tooltipComponents,events:qo("normal"===n.mode?[$o(io(),(function(n){jo(e,Vh)})),$o(oo(),(function(n){jo(e,Ph)}))]:[]),behaviours:Qa([rg.config({})])});t.setTooltip(r),qs(o,r),n.onShow(e,r),Us.position(o,n.anchor(e),r)}}(e)}),n.delay)})),$o(Ph,(function(o){t.resetTimer((function(){e(o)}),n.delay)})),$o(xo(),(function(n,t){var o=t;o.universal||L(o.channels,Rh)&&e(n)})),ar((function(n){e(n)}))],"normal"===n.mode?[$o(uo(),(function(n){jo(n,Vh)})),$o(bo(),(function(n){jo(n,Ph)})),$o(io(),(function(n){jo(n,Vh)})),$o(oo(),(function(n){jo(n,Ph)}))]:[$o(No(),(function(n,t){jo(n,Vh)})),$o(Lo(),(function(n){jo(n,Ph)}))]]))}}),state:Ih,apis:zh}),Lh=tinymce.util.Tools.resolve("tinymce.dom.DOMUtils"),jh=tinymce.util.Tools.resolve("tinymce.util.I18n"),Uh=["input","button","textarea","select"],Wh=function(component,n,t){(n.disabled()?Kh:$h)(component,n)},Gh=function(component,n){return!0===n.useNative&&L(Uh,fr(component.element))},Xh=function(component){Pr(component.element,"disabled","disabled")},Yh=function(component){Lr(component.element,"disabled")},qh=function(component){Pr(component.element,"aria-disabled","true")},Jh=function(component){Pr(component.element,"aria-disabled","false")},Kh=function(component,n,t){n.disableClass.each((function(n){_i(component.element,n)})),(Gh(component,n)?Xh:qh)(component),n.onDisabled(component)},$h=function(component,n,t){n.disableClass.each((function(n){Ei(component.element,n)})),(Gh(component,n)?Yh:Jh)(component),n.onEnabled(component)},Qh=function(component,n){return Gh(component,n)?function(component){return Nr(component.element,"disabled")}(component):function(component){return"true"===Hr(component.element,"aria-disabled")}(component)},Zh=Object.freeze({__proto__:null,enable:$h,disable:Kh,isDisabled:Qh,onLoad:Wh,set:function(component,n,t,e){(e?Kh:$h)(component,n)}}),nv=Object.freeze({__proto__:null,exhibit:function(base,n){return mi({classes:n.disabled()?n.disableClass.toArray():[]})},events:function(n,t){return qo([Jo(wo(),(function(component,t){return Qh(component,n)})),qa(n,t,Wh)])}}),tv=[fe("disabled",d),re("useNative",!0),option("disableClass"),sa("onDisabled"),sa("onEnabled")],ev=nc({fields:tv,name:"disabling",active:nv,apis:Zh}),ov=tinymce.util.Tools.resolve("tinymce.EditorManager"),rv=function(n){return n.getParam("height",Math.max(n.getElement().offsetHeight,200))},iv=function(n){return n.getParam("width",Lh.DOM.getStyle(n.getElement(),"width"))},uv=function(n){return O.from(n.getParam("min_width")).filter(R)},av=function(n){return O.from(n.getParam("min_height")).filter(R)},cv=function(n){return O.from(n.getParam("max_width")).filter(R)},sv=function(n){return O.from(n.getParam("max_height")).filter(R)},fv=function(n){return!1!==n.getParam("menubar",!0,"boolean")},lv=function(n){var t=n.getParam("toolbar",!0),e=!0===t,o=E(t),r=B(t)&&t.length>0;return!mv(n)&&(r||o||e)},dv=function(n){var t=U(9,(function(t){return n.getParam("toolbar"+(t+1),!1,"string")})),e=filter(t,(function(n){return"string"==typeof n}));return e.length>0?O.some(e):O.none()},mv=function(n){return dv(n).fold((function(){return n.getParam("toolbar",[],"string[]").length>0}),(function(){return!0}))};!function(n){n.default="wrap",n.floating="floating",n.sliding="sliding",n.scrolling="scrolling"}(Jp||(Jp={}));var gv,pv=function(n){return n.getParam("toolbar_mode","","string")};!function(n){n.auto="auto",n.top="top",n.bottom="bottom"}(gv||(gv={}));var hv,vv,bv=function(n){return n.getParam("toolbar_location",gv.auto,"string")},yv=function(n){return bv(n)===gv.bottom},xv=function(n){var t=function(n){return n.getParam("fixed_toolbar_container","","string")}(n);return t.length>0&&n.inline?Xu(body(),t):O.none()},wv=function(n){return n.inline&&xv(n).isSome()},Sv=function(n){return xv(n).getOrThunk((function(){return Pi(Vi(he.fromDom(n.getElement())))}))},kv=function(n){return n.inline&&!fv(n)&&!lv(n)&&!mv(n)},Cv=function(n){return(n.getParam("toolbar_sticky",!1,"boolean")||n.inline)&&!wv(n)&&!kv(n)},Ov=function(n){var menu=n.getParam("menu");return menu?Tn(menu,(function(menu){return v(v({},menu),{items:menu.items})})):{}},_v=function(n){return n.getParam("menubar")},Tv=function(n){return n.getParam("anchor_top","#top")},Ev=function(n){return n.getParam("anchor_bottom","#bottom")},Dv=gt([(hv="readonly",Gt(hv,zt))]),Bv=function(n,t){var e=n.outerContainer.element;t&&(n.mothership.broadcastOn([mf()],{target:e}),n.uiMothership.broadcastOn([mf()],{target:e})),n.mothership.broadcastOn(["silver.readonly"],{readonly:t}),n.uiMothership.broadcastOn(["silver.readonly"],{readonly:t})},Av=function(n,t){n.on("init",(function(){n.mode.isReadOnly()&&Bv(t,!0)})),n.on("SwitchMode",(function(){return Bv(t,n.mode.isReadOnly())})),function(n){return n.getParam("readonly",!1,"boolean")}(n)&&n.setMode("readonly")},Mv=function(){var n;return rc.config({channels:(n={},n["silver.readonly"]={schema:Dv,onReceive:function(n,data){ev.set(n,data.readonly)}},n)})},Fv=function(n){return ev.config({disabled:n,disableClass:"tox-collection__item--state-disabled"})},Iv=function(n){return ev.config({disabled:n})},Rv=function(n){return ev.config({disabled:n,disableClass:"tox-tbtn--disabled"})},Vv=function(n){return ev.config({disabled:n,disableClass:"tox-tbtn--disabled",useNative:!1})},Pv=function(n,t){var e=n.getApi(t);return function(n){n(e)}},Hv=function(n,t){return ur((function(e){Pv(n,e)((function(e){var o=n.onSetup(e);null!=o&&t.set(o)}))}))},zv=function(n,t){return ar((function(e){return Pv(n,e)(t.get())}))},Nv=function(n,t){return sr((function(e,o){Pv(n,e)(n.onAction),n.triggersSubmenu||t!==Kp.CLOSE_ON_EXECUTE||(jo(e,Oo()),o.stop())}))},Lv=((vv={})[wo()]=["disabling","alloy.base.behaviour","toggling","item-events"],vv),jv=function(n){return Z(n,(function(n){return n.toArray()}))},Uv=function(n,e,o,r){var c=ge(t);return{type:"item",dom:e.dom,components:jv(e.optComponents),data:n.data,eventOrder:Lv,hasSubmenu:n.triggersSubmenu,itemBehaviours:Qa([ig("item-events",[Nv(n,o),Hv(n,c),zv(n,c)]),Fv((function(){return n.disabled||r.isDisabled()})),Mv(),rg.config({})].concat(n.itemBehaviours))}},Wv=function(source){return{value:source.value,meta:v({text:source.text.getOr("")},source.meta)}},Gv=tinymce.util.Tools.resolve("tinymce.Env"),Xv=function(source){var n=Gv.mac?{alt:"&#x2325;",ctrl:"&#x2303;",shift:"&#x21E7;",meta:"&#x2318;",access:"&#x2303;&#x2325;"}:{meta:"Ctrl",access:"Shift+Alt"},t=source.split("+"),e=map(t,(function(t){var e=t.toLowerCase().trim();return In(n,e)?n[e]:t}));return Gv.mac?e.join(""):e.join("+")},Yv=function(n){return{dom:{tag:"div",classes:["tox-collection__item-icon"],innerHtml:n}}},qv=function(n){return{dom:{tag:"div",classes:[nh]},components:[text(jh.translate(n))]}},Jv=function(html,n){return{dom:{tag:"div",classes:n,innerHtml:html}}},Kv=function(style,n){return{dom:{tag:"div",classes:[nh]},components:[{dom:{tag:style.tag,styles:style.styles},components:[text(jh.translate(n))]}]}},$v=function(n){return{dom:{tag:"div",classes:["tox-collection__item-accessory"],innerHtml:Xv(n)}}},Qv=function(n){return{dom:{tag:"div",classes:["tox-collection__item-checkmark"],innerHtml:ap("checkmark",n)}}},Zv=function(n,t){var e=t.map((function(label){return{attributes:{title:jh.translate(label)}}})).getOr({});return v({tag:"div",classes:[$p,Qp].concat(n?["tox-collection__item-icon-rtl"]:[])},e)},nb=["list-num-default","list-num-lower-alpha","list-num-lower-greek","list-num-lower-roman","list-num-upper-alpha","list-num-upper-roman"],tb=["list-bull-circle","list-bull-default","list-bull-square"],eb=function(n,t,e,o){void 0===o&&(o=O.none());var r,f=jh.isRtl()&&n.iconContent.exists((function(n){return L(tb,n)})),l=(r=n.iconContent,r.map((function(n){return jh.isRtl()&&L(nb,n)?n+"-rtl":n}))).map((function(n){return function(n,t,e){return O.from(t()[n.toLowerCase()]).or(e).getOrThunk((function(){return up(t)}))}(n,t.icons,o)})),d=O.from(n.meta).fold((function(){return qv}),(function(meta){return In(meta,"style")?c(Kv,meta.style):qv}));return"color"===n.presets?function(n,t,e,o){var r,c;return{dom:(r=e.getOr(""),c={tag:"div",attributes:n.map((function(text){return{title:o.translate(text)}})).getOr({}),classes:["tox-swatch"]},v(v({},c),"custom"===t?{tag:"button",classes:x(c.classes,["tox-swatches__picker-btn"]),innerHtml:r}:"remove"===t?{classes:x(c.classes,["tox-swatch--remove"]),innerHtml:r}:{attributes:v(v({},c.attributes),{"data-mce-color":t}),styles:{"background-color":t}})),optComponents:[]}}(n.ariaLabel,n.value,l,t):function(n,t,e,o,r){var c=e?t.or(O.some("")).map(Yv):O.none(),f=n.checkMark,content=n.htmlContent.fold((function(){return n.textContent.map(o)}),(function(html){return O.some(Jv(html,[nh]))}));return{dom:Zv(r,n.ariaLabel),optComponents:[c,content,n.shortcutContent.map($v),f,n.caret]}}(n,l,e,d,f)},ob=function(meta,n){return Fn(meta,"tooltipWorker").map((function(t){return[Nh.config({lazySink:n.getSink,tooltipDom:{tag:"div",classes:["tox-tooltip-worker-container"]},tooltipComponents:[],anchor:function(n){return{anchor:"submenu",item:n,overrides:{maxHeightFunction:Ec}}},mode:"follow-highlight",onShow:function(component,n){t((function(n){Nh.setComponents(component,[fu({element:he.fromDom(n)})])}))}})]})).getOr([])},rb=function(text,n){var t=function(text){return Lh.DOM.encode(text)}(jh.translate(text));if(n.length>0){var e=new RegExp(function(text){return text.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}(n),"gi");return t.replace(e,(function(n){return'<span class="tox-autocompleter-highlight">'+n+"</span>"}))}return t},ib=vl("item-widget",Ag()),ub=function(n){return{value:n}},ab=/^#?([a-f\d])([a-f\d])([a-f\d])$/i,cb=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i,sb=function(n){return ab.test(n)||cb.test(n)},fb=function(n){var t=function(n){return{value:n.value.replace(ab,(function(n,t,g,b){return t+t+g+g+b+b}))}}(n),e=cb.exec(t.value);return null===e?["FFFFFF","FF","FF","FF"]:e},lb=function(component){var n=component.toString(16);return 1===n.length?"0"+n:n},db=function(n){var t=lb(n.red)+lb(n.green)+lb(n.blue);return ub(t)},mb=Math.min,gb=Math.max,pb=Math.round,hb=/^rgb\((\d+),\s*(\d+),\s*(\d+)\)/,vb=/^rgba\((\d+),\s*(\d+),\s*(\d+),\s*(\d?(?:\.\d+)?)\)/,bb=function(n,t,e,o){return{red:n,green:t,blue:e,alpha:o}},yb=function(n){var t=parseInt(n,10);return t.toString()===n&&t>=0&&t<=255},xb=function(n){var t,g,b,e=(n.hue||0)%360,o=n.saturation/100,r=n.value/100;if(o=gb(0,mb(o,1)),r=gb(0,mb(r,1)),0===o)return t=g=b=pb(255*r),bb(t,g,b,1);var c=e/60,f=r*o,l=f*(1-Math.abs(c%2-1)),d=r-f;switch(Math.floor(c)){case 0:t=f,g=l,b=0;break;case 1:t=l,g=f,b=0;break;case 2:t=0,g=f,b=l;break;case 3:t=0,g=l,b=f;break;case 4:t=l,g=0,b=f;break;case 5:t=f,g=0,b=l;break;default:t=g=b=0}return t=pb(255*(t+d)),g=pb(255*(g+d)),b=pb(255*(b+d)),bb(t,g,b,1)},wb=function(n){var t=fb(n),e=parseInt(t[1],16),o=parseInt(t[2],16),r=parseInt(t[3],16);return bb(e,o,r,1)},Sb=function(n,t,e,o){var r=parseInt(n,10),g=parseInt(t,10),b=parseInt(e,10),a=parseFloat(o);return bb(r,g,b,a)},kb=function(n){return"rgba("+n.red+","+n.green+","+n.blue+","+n.alpha+")"},Cb=bb(255,0,0,1),Ob=function(n,t){return n.fire("ResizeContent",t)},_b=tinymce.util.Tools.resolve("tinymce.util.LocalStorage");var Tb="choiceitem",Eb=[{type:Tb,text:"Light Green",value:"#BFEDD2"},{type:Tb,text:"Light Yellow",value:"#FBEEB8"},{type:Tb,text:"Light Red",value:"#F8CAC6"},{type:Tb,text:"Light Purple",value:"#ECCAFA"},{type:Tb,text:"Light Blue",value:"#C2E0F4"},{type:Tb,text:"Green",value:"#2DC26B"},{type:Tb,text:"Yellow",value:"#F1C40F"},{type:Tb,text:"Red",value:"#E03E2D"},{type:Tb,text:"Purple",value:"#B96AD9"},{type:Tb,text:"Blue",value:"#3598DB"},{type:Tb,text:"Dark Turquoise",value:"#169179"},{type:Tb,text:"Orange",value:"#E67E23"},{type:Tb,text:"Dark Red",value:"#BA372A"},{type:Tb,text:"Dark Purple",value:"#843FA1"},{type:Tb,text:"Dark Blue",value:"#236FA1"},{type:Tb,text:"Light Gray",value:"#ECF0F1"},{type:Tb,text:"Medium Gray",value:"#CED4D9"},{type:Tb,text:"Gray",value:"#95A5A6"},{type:Tb,text:"Dark Gray",value:"#7E8C8D"},{type:Tb,text:"Navy Blue",value:"#34495E"},{type:Tb,text:"Black",value:"#000000"},{type:Tb,text:"White",value:"#ffffff"}],Db=function(n){void 0===n&&(n=10);var t,e=_b.getItem("tinymce-custom-colors"),o=E(e)?JSON.parse(e):[],r=n-(t=o).length<0?t.slice(0,n):t,c=function(n){r.splice(n,1)};return{add:function(t){(function(n,t){var e=N(n,t);return-1===e?O.none():O.some(e)})(r,t).each(c),r.unshift(t),r.length>n&&r.pop(),_b.setItem("tinymce-custom-colors",JSON.stringify(r))},state:function(){return r.slice(0)}}}(10),Bb=function(n){return!1!==n.getParam("custom_colors")},Ab=function(n){var t=function(n){return n.getParam("color_map")}(n);return void 0!==t?function(n){var t=[],canvas=document.createElement("canvas");canvas.height=1,canvas.width=1;for(var e=canvas.getContext("2d"),o=function(n,t){var e=t/255;return("0"+Math.round(n*e+255*(1-e)).toString(16)).slice(-2).toUpperCase()},r=function(n){if(/^[0-9A-Fa-f]{6}$/.test(n))return"#"+n.toUpperCase();e.clearRect(0,0,canvas.width,canvas.height),e.fillStyle="#FFFFFF",e.fillStyle=n,e.fillRect(0,0,1,1);var t=e.getImageData(0,0,1,1).data,r=t[0],g=t[1],b=t[2],a=t[3];return"#"+o(r,a)+o(g,a)+o(b,a)},i=0;i<n.length;i+=2)t.push({text:n[i+1],value:r(n[i]),type:"choiceitem"});return t}(t):Eb},Mb=function(n){Db.add(n)},Fb=function(n){return function(n,t){return n.getParam("color_cols",t,"number")}(n,function(n){return Math.max(5,Math.ceil(Math.sqrt(n)))}(Ab(n).length))},Ib=function(n,t,e,o){"custom"===e?Nb(n)((function(e){e.each((function(e){Mb(e),n.execCommand("mceApplyTextcolor",t,e),o(e)}))}),"#000000"):"remove"===e?(o(""),n.execCommand("mceRemoveTextcolor",t)):(o(e),n.execCommand("mceApplyTextcolor",t,e))},Rb=function(n,t){return n.concat(map(Db.state(),(function(n){return{type:Tb,text:n,value:n}})).concat(function(n){var t={type:"choiceitem",text:"Remove color",icon:"color-swatch-remove-color",value:"remove"};return n?[t,{type:"choiceitem",text:"Custom color",icon:"color-picker",value:"custom"}]:[t]}(t)))},Vb=function(n,t){return function(e){e(Rb(n,t))}},Pb=function(n,t,e){var o,r;o="forecolor"===t?"tox-icon-text-color__color":"tox-icon-highlight-bg-color__color",r=e,n.setIconFill(o,r),n.setIconStroke(o,r)},Hb=function(n,t,e,o,r){n.ui.registry.addSplitButton(t,{tooltip:o,presets:"color",icon:"forecolor"===t?"text-color":"highlight-bg-color",select:function(t){return O.from(function(n,t){var e;return n.dom.getParents(n.selection.getStart(),(function(n){var o;(o=n.style["forecolor"===t?"color":"background-color"])&&(e=e||o)})),e}(n,e)).bind((function(n){return function(n){if("transparent"===n)return O.some(bb(0,0,0,0));var t=hb.exec(n);if(null!==t)return O.some(Sb(t[1],t[2],t[3],"1"));var e=vb.exec(n);return null!==e?O.some(Sb(e[1],e[2],e[3],e[4])):O.none()}(n).map((function(n){var e=db(n).value;return ke(t.toLowerCase(),e)}))})).getOr(!1)},columns:Fb(n),fetch:Vb(Ab(n),Bb(n)),onAction:function(t){null!==r.get()&&Ib(n,e,r.get(),(function(){}))},onItemAction:function(o,c){Ib(n,e,c,(function(e){r.set(e),function(n,data){n.fire("TextColorChange",data)}(n,{name:t,color:e})}))},onSetup:function(e){null!==r.get()&&Pb(e,t,r.get());var o=function(n){n.name===t&&Pb(e,n.name,n.color)};return n.on("TextColorChange",o),function(){n.off("TextColorChange",o)}}})},zb=function(n,e,o,text){n.ui.registry.addNestedMenuItem(e,{text:text,icon:"forecolor"===e?"text-color":"highlight-bg-color",getSubmenuItems:function(){return[{type:"fancymenuitem",fancytype:"colorswatch",onAction:function(data){Ib(n,o,data.value,t)}}]}})},Nb=function(n){return function(t,e){var o={colorpicker:e},r=function(n){return function(t){var data=t.getData();n(O.from(data.colorpicker)),t.close()}}(t);n.windowManager.open({title:"Color Picker",size:"normal",body:{type:"panel",items:[{type:"colorpicker",name:"colorpicker",label:"Color"}]},buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"save",text:"Save",primary:!0}],initialData:o,onAction:function(n,details){"hex-valid"===details.name&&(details.value?n.enable("ok"):n.disable("ok"))},onSubmit:r,onClose:function(){},onCancel:function(){t(O.none())}})}},Lb=function(n,t,e,o,r,c,select,f){var l=mh(t),d=jb(t,e,o,"color"!==r?"normal":"color",c,select,f);return hh(n,l,d,o,r)},jb=function(n,t,e,o,r,select,c){return Ll(map(n,(function(f){return"choiceitem"===f.type?(l=f,Dt("choicemenuitem",Oh,l)).fold(gh,(function(l){return O.some(function(n,t,e,o,r,c,f,l){void 0===l&&(l=!0);var d=eb({presets:e,textContent:t?n.text:O.none(),htmlContent:O.none(),ariaLabel:n.text,iconContent:n.icon,shortcutContent:t?n.shortcut:O.none(),checkMark:t?O.some(Qv(f.icons)):O.none(),caret:O.none(),value:n.value},f,l);return zn(Uv({data:Wv(n),disabled:n.disabled,getApi:function(component){return{setActive:function(n){Sg.set(component,n)},isActive:function(){return Sg.isOn(component)},isDisabled:function(){return ev.isDisabled(component)},setDisabled:function(n){return ev.set(component,n)}}},onAction:function(t){return o(n.value)},onSetup:function(n){return n.setActive(r),function(){}},triggersSubmenu:!1,itemBehaviours:[]},d,c,f),{toggling:{toggleClass:"tox-collection__item--enabled",toggleOnExecute:!1,selected:n.active}})}(l,1===e,o,t,select(f.value),r,c,mh(n)))})):O.none();var l})))},Ub=function(n,t){var e=uh(t);return 1===n?{mode:"menu",moveOnTab:!0}:"auto"===n?{mode:"grid",selector:"."+e.item,initSize:{numColumns:1,numRows:1}}:{mode:"matrix",rowSelector:"."+("color"===t?"tox-swatches__row":"tox-collection__group")}};var Wb,Gb=Yr("cell-over"),Xb=Yr("cell-execute"),Yb=function(n,col,t){var e,o=function(t){return Uo(t,Xb,{row:n,col:col})},r=function(n,t){t.stop(),o(n)};return du({dom:{tag:"div",attributes:(e={role:"button"},e["aria-labelledby"]=t,e)},behaviours:Qa([ig("insert-table-picker-cell",[$o(io(),fg.focus),$o(wo(),o),$o(lo(),r),$o(ko(),r)]),Sg.config({toggleClass:"tox-insert-table-picker__selected",toggleOnExecute:!1}),fg.config({onFocus:function(t){return Uo(t,Gb,{row:n,col:col})}})])})},qb=function(n){return Z(n,(function(n){return map(n,mu)}))},Jb=function(n,col){return text(col+1+"x"+(n+1))},Kb={inserttable:function(n){var t=Yr("size-label"),e=function(n,t,e){for(var o=[],i=0;i<t;i++){for(var r=[],c=0;c<e;c++)r.push(Yb(i,c,n));o.push(r)}return o}(t,10,10),o=ip({dom:{tag:"span",classes:["tox-insert-table-picker__label"],attributes:{id:t}},components:[text("0x0")],behaviours:Qa([rg.config({})])});return{type:"widget",data:{value:Yr("widget-id")},dom:{tag:"div",classes:["tox-fancymenuitem"]},autofocus:!0,components:[ib.widget({dom:{tag:"div",classes:["tox-insert-table-picker"]},components:qb(e).concat(o.asSpec()),behaviours:Qa([ig("insert-table-picker",[er(Gb,(function(n,t,r){var c=r.event.row,col=r.event.col;!function(n,t,e,o,r){for(var i=0;i<o;i++)for(var c=0;c<r;c++)Sg.set(n[i][c],i<=t&&c<=e)}(e,c,col,10,10),rg.set(o.get(n),[Jb(c,col)])})),er(Xb,(function(t,e,o){n.onAction({numRows:o.event.row+1,numColumns:o.event.col+1}),jo(t,Oo())}))]),Zm.config({initSize:{numRows:10,numColumns:10},mode:"flatgrid",selector:'[role="button"]'})])})]}},colorswatch:function(n,t){var e=Rb(t.colorinput.getColors(),t.colorinput.hasCustomColors()),o=t.colorinput.getColorCols(),r=Lb(Yr("menu-value"),e,(function(t){n.onAction({value:t})}),o,"color",Kp.CLOSE_ON_EXECUTE,(function(){return!1}),t.shared.providers),c=v(v({},r),{markers:uh("color"),movement:Ub(o,"color")});return{type:"widget",data:{value:Yr("widget-id")},dom:{tag:"div",classes:["tox-fancymenuitem"]},autofocus:!0,components:[ib.widget(Pg.sketch(c))]}}},$b=function(n,t){return map(n,(function(n){switch(n.type){case"cardcontainer":return function(n,t){return{dom:{tag:"div",classes:["tox-collection__item-container","vertical"===n.direction?"tox-collection__item-container--column":"tox-collection__item-container--row","left"===n.align?"tox-collection__item-container--align-left":"tox-collection__item-container--align-right",function(){switch(n.valign){case"top":return"tox-collection__item-container--valign-top";case"middle":return"tox-collection__item-container--valign-middle";case"bottom":return"tox-collection__item-container--valign-bottom"}}()]},components:t}}(n,$b(n.items,t));case"cardimage":return function(n,t,e){return{dom:{tag:"img",classes:t,attributes:{src:n,alt:e.getOr("")}}}}(n.src,n.classes,n.alt);case"cardtext":var e=n.name.exists((function(n){return L(t.cardText.highlightOn,n)}))?O.from(t.cardText.matchText).getOr(""):"";return Jv(rb(n.text,e),n.classes)}}))},Qb=function(n,t,e,o,r,c,f,l){void 0===l&&(l=!0);var d=eb({presets:o,textContent:O.none(),htmlContent:e?n.text.map((function(text){return rb(text,t)})):O.none(),ariaLabel:n.text,iconContent:n.icon,shortcutContent:O.none(),checkMark:O.none(),caret:O.none(),value:n.value},f.providers,l,n.icon);return Uv({data:Wv(n),disabled:n.disabled,getApi:function(){return{}},onAction:function(t){return r(n.value,n.meta)},onSetup:function(){return function(){}},triggersSubmenu:!1,itemBehaviours:ob(n.meta,f)},d,c,f.providers)},Zb=function(n){var t=n.text.fold((function(){return{}}),(function(text){return{innerHtml:text}}));return{type:"separator",dom:v({tag:"div",classes:[Qp,"tox-collection__group-heading"]},t),components:[]}},ny=function(n,t,e,o){void 0===o&&(o=!0);var r=eb({presets:"normal",iconContent:n.icon,textContent:n.text,htmlContent:O.none(),ariaLabel:n.text,caret:O.none(),checkMark:O.none(),shortcutContent:n.shortcut},e,o);return Uv({data:Wv(n),getApi:function(component){return{isDisabled:function(){return ev.isDisabled(component)},setDisabled:function(n){return ev.set(component,n)}}},disabled:n.disabled,onAction:n.onAction,onSetup:n.onSetup,triggersSubmenu:!1,itemBehaviours:[]},r,t,e)},ty=function(n,e,o,r,c){void 0===r&&(r=!0),void 0===c&&(c=!1);var f,l=c?(f=o.icons,{dom:{tag:"div",classes:["tox-collection__item-caret"],innerHtml:ap("chevron-down",f)}}):function(n){return{dom:{tag:"div",classes:["tox-collection__item-caret"],innerHtml:ap("chevron-right",n)}}}(o.icons),d=eb({presets:"normal",iconContent:n.icon,textContent:n.text,htmlContent:O.none(),ariaLabel:n.text,caret:O.some(l),checkMark:O.none(),shortcutContent:n.shortcut},o,r);return Uv({data:Wv(n),getApi:function(component){return{isDisabled:function(){return ev.isDisabled(component)},setDisabled:function(n){return ev.set(component,n)}}},disabled:n.disabled,onAction:t,onSetup:n.onSetup,triggersSubmenu:!0,itemBehaviours:[]},d,e,o)},ey=function(n,t,e,o){void 0===o&&(o=!0);var r=eb({iconContent:n.icon,textContent:n.text,htmlContent:O.none(),ariaLabel:n.text,checkMark:O.some(Qv(e.icons)),caret:O.none(),shortcutContent:n.shortcut,presets:"normal",meta:n.meta},e,o);return zn(Uv({data:Wv(n),disabled:n.disabled,getApi:function(component){return{setActive:function(n){Sg.set(component,n)},isActive:function(){return Sg.isOn(component)},isDisabled:function(){return ev.isDisabled(component)},setDisabled:function(n){return ev.set(component,n)}}},onAction:n.onAction,onSetup:n.onSetup,triggersSubmenu:!1,itemBehaviours:[]},r,t,e),{toggling:{toggleClass:"tox-collection__item--enabled",toggleOnExecute:!1,selected:n.active}})},oy=function(n,t){return function(n,t){return Object.prototype.hasOwnProperty.call(n,t)?O.some(n[t]):O.none()}(Kb,n.fancytype).map((function(e){return e(n,t)}))},ry=function(n,t,e,o){var r={dom:Zv(!1,n.label),optComponents:[O.some({dom:{tag:"div",classes:["tox-collection__item-container","tox-collection__item-container--row"]},components:$b(n.items,o)})]};return Uv({data:Wv(v({text:O.none()},n)),disabled:n.disabled,getApi:function(component){return{isDisabled:function(){return ev.isDisabled(component)},setDisabled:function(n){ev.set(component,n),G(rs(component.element,"*"),(function(t){component.getSystem().getByDom(t).each((function(t){t.hasConfigured(ev)&&ev.set(t,n)}))}))}}},onAction:n.onAction,onSetup:n.onSetup,triggersSubmenu:!1,itemBehaviours:O.from(o.itemBehaviours).getOr([])},r,t,e.providers)};!function(n){n[n.ContentFocus=0]="ContentFocus",n[n.UiFocus=1]="UiFocus"}(Wb||(Wb={}));var iy=function(n,t,e,o,r){var c,f=e.shared.providers,l=function(menuitem){return r?v(v({},menuitem),{shortcut:O.none(),icon:menuitem.text.isSome()?O.none():menuitem.icon}):menuitem};switch(n.type){case"menuitem":return(c=n,Dt("menuitem",Th,c)).fold(gh,(function(n){return O.some(ny(l(n),t,f,o))}));case"nestedmenuitem":return function(n){return Dt("nestedmenuitem",Eh,n)}(n).fold(gh,(function(n){return O.some(ty(l(n),t,f,o,r))}));case"togglemenuitem":return function(n){return Dt("togglemenuitem",Dh,n)}(n).fold(gh,(function(n){return O.some(ey(l(n),t,f,o))}));case"separator":return function(n){return Dt("separatormenuitem",Ap,n)}(n).fold(gh,(function(n){return O.some(Zb(n))}));case"fancymenuitem":return function(n){return Dt("fancymenuitem",_h,n)}(n).fold(gh,(function(n){return oy(l(n),e)}));default:return console.error("Unknown item in general menu",n),O.none()}},uy=function(n,t,e,o,r,c,f){var l=1===o,d=!l||mh(n);return Ll(map(n,(function(n){switch(n.type){case"separator":return(o=n,Dt("Autocompleter.Separator",Ap,o)).fold(gh,(function(n){return O.some(Zb(n))}));case"cardmenuitem":return function(n){return Dt("cardmenuitem",Ch,n)}(n).fold(gh,(function(n){return O.some(ry(v(v({},n),{onAction:function(t){n.onAction(t),e(n.value,n.meta)}}),r,c,{itemBehaviours:ob(n.meta,c),cardText:{matchText:t,highlightOn:f}}))}));case"autocompleteitem":default:return function(n){return Dt("Autocompleter.Item",Mp,n)}(n).fold(gh,(function(n){return O.some(Qb(n,t,l,"normal",e,r,c,d))}))}var o})))},ay=function(n,t,e,o,r){var c=mh(t),f=Ll(map(t,(function(n){var t=function(i){return iy(i,e,o,function(i){return r?!i.hasOwnProperty("text"):c}(i),r)};return"nestedmenuitem"===n.type&&n.getSubmenuItems().length<=0?t(v(v({},n),{disabled:!0})):t(n)})));return(r?ph:hh)(n,c,f,1,"normal")},cy=function(n){return Ug.singleData(n.value,n)},sy=function(n,t){var e=ge(O.none()),o=ge(!1),r=du(Wg.sketch({dom:{tag:"div",classes:["tox-autocompleter"]},components:[],fireDismissalEventInstead:{},inlineBehaviours:Qa([ig("dismissAutocompleter",[$o(Io(),(function(){return l()}))])]),lazySink:t.getSink})),c=function(){return e.get().isSome()},f=function(){c()&&Wg.hide(r)},l=function(){if(c()){var t=e.get().map((function(n){return n.element}));vp(t.getOr(he.fromDom(n.selection.getNode()))).each(Fr),f(),e.set(O.none()),o.set(!1)}},d=Ln((function(){return qp(n)})),m=function(t,e,o,c){t.matchLength=e.text.length;var f=cn(o,(function(n){return O.from(n.columns)})).getOr(1);Wg.showAt(r,{anchor:"node",root:he.fromDom(n.getBody()),node:O.from(t.element)},Pg.sketch(function(n,t,e,o){var r=e===Wb.ContentFocus?Td():_d(),c=Ub(t,o),f=uh(o);return{dom:n.dom,components:n.components,items:n.items,value:n.value,markers:{selectedItem:f.selectedItem,item:f.item},movement:c,fakeFocus:e===Wb.ContentFocus,focusManager:r,menuBehaviours:Mh("auto"!==t?[]:[ur((function(n,t){Bh(n,4,f.item).each((function(t){var e=t.numColumns,o=t.numRows;Zm.setGridSize(n,o,e)}))}))])}}(hh("autocompleter-value",!0,c,f,"normal"),f,Wb.ContentFocus,"normal"))),Wg.getContent(r).each(rd.highlightFirst)},h=function(r){(function(t){return e.get().map((function(e){return Sp(n.dom,n.selection.getRng(),e.triggerChar).bind((function(e){return Bp(n,d,e,t)}))})).getOrThunk((function(){return Dp(n,d)}))})(r).fold(l,(function(r){!function(t){if(!c()){var r=hp(n,t.range);e.set(O.some({triggerChar:t.triggerChar,element:r,matchLength:t.text.length})),o.set(!1)}}(r.context),r.lookupData.then((function(c){e.get().map((function(e){var d,v,y,x=r.context;if(e.triggerChar===x.triggerChar){var w=(d=x.triggerChar,y=cn(v=c,(function(n){return O.from(n.columns)})).getOr(1),Z(v,(function(e){var r=e.items;return uy(r,e.matchText,(function(t,r){var c=n.selection.getRng();Sp(n.dom,c,d).fold((function(){return console.error("Lost context. Cursor probably moved")}),(function(n){var c=n.range,d={hide:function(){l()},reload:function(n){f(),h(n)}};o.set(!0),e.onAction(d,c,t,r),o.set(!1)}))}),y,Kp.BUBBLE_TO_SANDBOX,t,e.highlightOn)})));w.length>0?m(e,x,c,w):x.text.length-e.matchLength>=10?l():f()}}))}))}))},v={onKeypress:mp((function(n){27!==n.which&&h()}),50),cancelIfNecessary:l,isMenuOpen:function(){return Wg.isOpen(r)},isActive:c,isProcessingAction:o.get,getView:function(){return Wg.getContent(r)}};!1===n.hasPlugin("rtc")&&kp(v,n)},fy=m,ly=function(element,n,t){return function(element,n,filter,t){return Tu(element,n,filter,t,!1)}(element,n,fy,t)},dy=function(element,n,t){return function(element,n,filter,t){return Tu(element,n,filter,t,!0)}(element,n,fy,t)},my=_u,gy=function(n,t,e){return Yu(n,t,e).isSome()};function py(n,t){var e=null;return{cancel:function(){null!==e&&(clearTimeout(e),e=null)},schedule:function(){for(var o=[],r=0;r<arguments.length;r++)o[r]=arguments[r];e=setTimeout((function(){n.apply(null,o),e=null}),t)}}}var hy=function(n){var t=n.raw;return void 0===t.touches||1!==t.touches.length?O.none():O.some(t.touches[0])},vy=function(n){var t=ge(O.none()),e=ge(!1),o=py((function(t){n.triggerEvent(Co(),t),e.set(!0)}),400),r=Qn([{key:$e(),value:function(n){return hy(n).each((function(r){o.cancel();var data={x:r.clientX,y:r.clientY,target:n.target};o.schedule(n),e.set(!1),t.set(O.some(data))})),O.none()}},{key:Qe(),value:function(n){return o.cancel(),hy(n).each((function(n){t.get().each((function(data){(function(n,data){var t=Math.abs(n.clientX-data.x),e=Math.abs(n.clientY-data.y);return t>5||e>5})(n,data)&&t.set(O.none())}))})),O.none()}},{key:Ze(),value:function(r){o.cancel();return t.get().filter((function(data){return Le(data.target,r.target)})).map((function(t){return e.get()?(r.prevent(),!1):n.triggerEvent(ko(),r)}))}}]);return{fireIfReady:function(n,t){return Fn(r,t).bind((function(t){return t(n)}))}}},by=function(){return He().browser.isFirefox()},yy=mt([Jt("triggerEvent"),re("stopBackspace",!0)]),xy=function(n,t){var e=At("Getting GUI events settings",yy,t),o=vy(e),r=map(["touchstart","touchmove","touchend","touchcancel","gesturestart","mousedown","mouseup","mouseover","mousemove","mouseout","click"].concat(["selectstart","input","contextmenu","change","transitionend","drag","dragstart","dragend","dragenter","dragleave","dragover","drop","keyup"]),(function(t){return ly(n,t,(function(n){o.fireIfReady(n,t).each((function(t){t&&n.kill()})),e.triggerEvent(t,n)&&n.kill()}))})),c=ge(O.none()),f=ly(n,"paste",(function(n){o.fireIfReady(n,"paste").each((function(t){t&&n.kill()})),e.triggerEvent("paste",n)&&n.kill(),c.set(O.some(setTimeout((function(){e.triggerEvent(yo(),n)}),0)))})),l=ly(n,"keydown",(function(n){e.triggerEvent("keydown",n)?n.kill():!0===e.stopBackspace&&function(n){return n.raw.which===id[0]&&!L(["input","textarea"],fr(n.target))&&!gy(n.target,'[contenteditable="true"]')}(n)&&n.prevent()})),d=function(n,t){return by()?dy(n,"focus",t):ly(n,"focusin",t)}(n,(function(n){e.triggerEvent("focusin",n)&&n.kill()})),m=ge(O.none()),h=function(n,t){return by()?dy(n,"blur",t):ly(n,"focusout",t)}(n,(function(n){e.triggerEvent("focusout",n)&&n.kill(),m.set(O.some(setTimeout((function(){e.triggerEvent(bo(),n)}),0)))}));return{unbind:function(){G(r,(function(n){n.unbind()})),l.unbind(),d.unbind(),h.unbind(),f.unbind(),c.get().each(clearTimeout),m.get().each(clearTimeout)}}},wy=function(n,t){var source=Fn(n,"target").getOr(t);return ge(source)},Sy=Vn([{stopped:[]},{resume:["element"]},{complete:[]}]),ky=function(n,t,e,o,source,r){var c=n(t,o),f=function(n,source){var t=ge(!1),e=ge(!1);return{stop:function(){t.set(!0)},cut:function(){e.set(!0)},isStopped:t.get,isCut:e.get,event:n,setSource:source.set,getSource:source.get}}(e,source);return c.fold((function(){return r.logEventNoHandlers(t,o),Sy.complete()}),(function(n){var e=n.descHandler;return gi(e)(f),f.isStopped()?(r.logEventStopped(t,n.element,e.purpose),Sy.stopped()):f.isCut()?(r.logEventCut(t,n.element,e.purpose),Sy.complete()):Sr(n.element).fold((function(){return r.logNoParent(t,n.element,e.purpose),Sy.complete()}),(function(o){return r.logEventResponse(t,n.element,e.purpose),Sy.resume(o)}))}))},Cy=function(n,t,e,o,source,r){return ky(n,t,e,o,source,r).fold((function(){return!0}),(function(o){return Cy(n,t,e,o,source,r)}),(function(){return!1}))},Oy=function(n,e,o){var r=function(n){var e=ge(!1);return{stop:function(){e.set(!0)},cut:t,isStopped:e.get,isCut:d,event:n,setSource:l("Cannot set source of a broadcasted event"),getSource:l("Cannot get source of a broadcasted event")}}(e);return G(n,(function(n){var t=n.descHandler;gi(t)(r)})),r.isStopped()},_y=function(n,t,e,o,r){var source=wy(e,o);return Cy(n,t,e,o,source,r)};function Ty(){var n={};return{registerId:function(t,e,o){_n(o,(function(o,r){var f=void 0!==n[r]?n[r]:{};f[e]=function(n,t){return e=c.apply(void 0,[n.handler].concat(t)),o=n.purpose,{cHandler:e,purpose:o};var e,o}(o,t),n[r]=f}))},unregisterId:function(t){_n(n,(function(n,e){n.hasOwnProperty(t)&&delete n[t]}))},filterByType:function(t){return Fn(n,t).map((function(n){return Bn(n,(function(n,t){return function(n,t){return{id:n,descHandler:t}}(t,n)}))})).getOr([])},find:function(t,e,o){var r=Fn(n,e);return Xe(o,(function(n){return function(n,t){return Zr(t).fold((function(){return O.none()}),(function(e){return n.bind((function(n){return Fn(n,e)})).map((function(n){return function(element,n){return{element:element,descHandler:n}}(t,n)}))}))}(r,n)}),t)}}}function Ey(){var n=Ty(),t={},e=function(component){var n=component.element;return Zr(n).fold((function(){return function(label,n){var t=Yr(Kr+label);return Qr(n,t),t}("uid-",component.element)}),(function(n){return n}))},o=function(component){Zr(component.element).each((function(e){delete t[e],n.unregisterId(e)}))};return{find:function(t,e,o){return n.find(t,e,o)},filter:function(t){return n.filterByType(t)},register:function(component){var r=e(component);Rn(t,r)&&function(component,n){var e=t[n];if(e!==component)throw new Error('The tagId "'+n+'" is already used by: '+element(e.element)+"\nCannot use it for: "+element(component.element)+"\nThe conflicting element is"+(Li(e.element)?" ":" not ")+"already in the DOM");o(component)}(component,r);var c=[component];n.registerId(c,r,component.events),t[r]=component},unregister:o,getById:function(n){return Fn(t,n)}}}var Dy=zl({name:"Container",factory:function(n){var t=n.dom,e=t.attributes,o=y(t,["attributes"]);return{uid:n.uid,dom:v({tag:"div",attributes:v({role:"presentation"},e)},o),components:n.components,behaviours:If(n.containerBehaviours),events:n.events,domModification:n.domModification,eventOrder:n.eventOrder}},configFields:[re("components",[]),Ff("containerBehaviours",[]),re("events",{}),re("domModification",{}),re("eventOrder",{})]}),By=function(n){var e=function(t){return Sr(n.element).fold((function(){return!0}),(function(n){return Le(t,n)}))},r=Ey(),c=function(n,t){return r.find(e,n,t)},f=xy(n.element,{triggerEvent:function(n,t){return na(n,t.target,(function(e){return function(n,t,e,o){return _y(n,t,e,e.target,o)}(c,n,t,e)}))}}),l={debugInfo:o("real"),triggerEvent:function(n,t,data){na(n,t,(function(e){return _y(c,n,data,t,e)}))},triggerFocus:function(n,e){Zr(n).fold((function(){uc(n)}),(function(o){na(vo(),n,(function(o){return function(n,t,e,o,r){var source=wy(e,o);ky(n,t,e,o,source,r)}(c,vo(),{originator:e,kill:t,prevent:t,target:n},n,o),!1}))}))},triggerEscape:function(n,t){l.triggerEvent("keydown",n.element,t.event)},getByUid:function(n){return C(n)},getByDom:function(n){return O(n)},build:du,addToGui:function(n){v(n)},removeFromGui:function(n){y(n)},addToWorld:function(n){d(n)},removeFromWorld:function(n){h(n)},broadcast:function(n){w(n)},broadcastOn:function(n,t){S(n,t)},broadcastEvent:function(n,t){k(n,t)},isConnected:m},d=function(component){component.connect(l),mr(component.element)||(r.register(component),G(component.components(),d),l.triggerEvent(To(),component.element,{target:component.element}))},h=function(component){mr(component.element)||(G(component.components(),h),r.unregister(component)),component.disconnect()},v=function(component){qs(n,component)},y=function(component){$s(component)},x=function(data){var n=r.filter(xo());G(n,(function(n){var t=n.descHandler;gi(t)(data)}))},w=function(n){x({universal:!0,data:n})},S=function(n,t){x({universal:!1,channels:n,data:t})},k=function(n,t){var e=r.filter(n);return Oy(e,t)},C=function(n){return r.getById(n).fold((function(){return ln.error(new Error('Could not find component with uid: "'+n+'" in system.'))}),ln.value)},O=function(n){var t=Zr(n).getOr("not found");return C(t)};return d(n),{root:n,element:n.element,destroy:function(){f.unbind(),Mr(n.element)},add:v,remove:y,getByUid:C,getByDom:O,addToWorld:d,removeFromWorld:h,broadcast:w,broadcastOn:S,broadcastEvent:k}},Ay=o([re("prefix","form-field"),Ff("fieldBehaviours",[Xl,Mf])]),My=o([ll({schema:[Wt("dom")],name:"label"}),ll({factory:{sketch:function(n){return{uid:n.uid,dom:{tag:"span",styles:{display:"none"},attributes:{"aria-hidden":"true"},innerHtml:n.text}}}},schema:[Wt("text")],name:"aria-descriptor"}),sl({factory:{sketch:function(n){var t=Kn(n,["factory"]);return n.factory.sketch(t)}},schema:[Wt("factory")],name:"field"})]),Fy=Nl({name:"FormField",configFields:Ay(),partFields:My(),factory:function(n,t,e,o){var r=Rf(n.fieldBehaviours,[Xl.config({find:function(t){return Cl(t,n,"field")}}),Mf.config({store:{mode:"manual",getValue:function(n){return Xl.getCurrent(n).bind(Mf.getValue)},setValue:function(n,t){Xl.getCurrent(n).each((function(n){Mf.setValue(n,t)}))}}})]),c=qo([ur((function(component,t){var e=_l(component,n,["label","field","aria-descriptor"]);e.field().each((function(t){var o=Yr(n.prefix);e.label().each((function(label){Pr(label.element,"for",o),Pr(t.element,"id",o)})),e["aria-descriptor"]().each((function(e){var o=Yr(n.prefix);Pr(e.element,"id",o),Pr(t.element,"aria-describedby",o)}))}))}))]),f={getField:function(t){return Cl(t,n,"field")},getLabel:function(t){return Cl(t,n,"label")}};return{uid:n.uid,dom:n.dom,components:t,behaviours:r,events:c,apis:f}},apis:{getField:function(n,t){return n.getField(t)},getLabel:function(n,t){return n.getLabel(t)}}}),Iy=Object.freeze({__proto__:null,exhibit:function(base,n){return mi({attributes:Qn([{key:n.tabAttr,value:"true"}])})}}),Ry=[re("tabAttr","data-alloy-tabstop")],Vy=nc({fields:Ry,name:"tabstopping",active:Iy}),Py=tinymce.util.Tools.resolve("tinymce.html.Entities"),Hy=function(n,t,e,o){var r=zy(n,t,e,o);return Fy.sketch(r)},zy=function(n,t,e,o){return{dom:Ny(e),components:n.toArray().concat([t]),fieldBehaviours:Qa(o)}},Ny=function(n){return{tag:"div",classes:["tox-form__group"].concat(n)}},Ly=function(label,n){return Fy.parts.label({dom:{tag:"label",classes:["tox-label"],innerHtml:n.translate(label)}})},jy=Yr("form-component-change"),Uy=Yr("form-close"),Wy=Yr("form-cancel"),Gy=Yr("form-action"),Xy=Yr("form-submit"),Yy=Yr("form-block"),qy=Yr("form-unblock"),Jy=Yr("form-tabchange"),Ky=Yr("form-resize"),$y=function(n,t){var e,o,c,f=n.label.map((function(label){return Ly(label,t)})),l=function(n){return function(t,e){Yu(e.event.target,"[data-collection-item-value]").each((function(o){n(t,e,o,Hr(o,"data-collection-item-value"))}))}},d=l((function(e,o,r,c){o.stop(),t.isDisabled()||Uo(e,Gy,{name:n.name,value:c})})),m=[$o(io(),l((function(n,t,e){uc(e)}))),$o(lo(),d),$o(ko(),d),$o(uo(),l((function(n,t,e){Xu(n.element,"."+eh).each((function(n){Ei(n,eh)})),_i(e,eh)}))),$o(ao(),l((function(n){Xu(n.element,"."+eh).each((function(n){Ei(n,eh)}))}))),sr(l((function(t,e,o,r){Uo(t,Gy,{name:n.name,value:r})})))],h=function(n,t){return map(rs(n.element,".tox-collection__item"),t)},v=Fy.parts.field({dom:{tag:"div",classes:["tox-collection"].concat(1!==n.columns?["tox-collection--grid"]:["tox-collection--list"])},components:[],factory:{sketch:r},behaviours:Qa([ev.config({disabled:t.isDisabled,onDisabled:function(n){h(n,(function(n){_i(n,"tox-collection__item--state-disabled"),Pr(n,"aria-disabled",!0)}))},onEnabled:function(n){h(n,(function(n){Ei(n,"tox-collection__item--state-disabled"),Lr(n,"aria-disabled")}))}}),Mv(),rg.config({}),Mf.config({store:{mode:"memory",initialValue:[]},onSetValue:function(e,o){!function(e,o){var r=map(o,(function(e){var o=jh.translate(e.text),r=1===n.columns?'<div class="tox-collection__item-label">'+o+"</div>":"",c='<div class="tox-collection__item-icon">'+e.icon+"</div>",f={_:" "," - ":" ","-":" "},l=o.replace(/\_| \- |\-/g,(function(n){return f[n]}));return'<div class="tox-collection__item'+(t.isDisabled()?" tox-collection__item--state-disabled":"")+'" tabindex="-1" data-collection-item-value="'+Py.encodeAllRaw(e.value)+'" title="'+l+'" aria-label="'+l+'">'+c+r+"</div>"})),c="auto"!==n.columns&&n.columns>1?W(r,n.columns):[r],html=map(c,(function(n){return'<div class="tox-collection__group">'+n.join("")+"</div>"}));Rr(e.element,html.join(""))}(e,o),"auto"===n.columns&&Bh(e,5,"tox-collection__item").each((function(n){var t=n.numRows,o=n.numColumns;Zm.setGridSize(e,t,o)})),jo(e,Ky)}}),Vy.config({}),Zm.config((o=n.columns,c="normal",1===o?{mode:"menu",moveOnTab:!1,selector:".tox-collection__item"}:"auto"===o?{mode:"flatgrid",selector:".tox-collection__item",initSize:{numColumns:1,numRows:1}}:{mode:"matrix",selectors:{row:"color"===c?".tox-swatches__row":".tox-collection__group",cell:"color"===c?".tox-swatch":"."+Qp}})),ig("collection-events",m)]),eventOrder:(e={},e[wo()]=["disabling","alloy.base.behaviour","collection-events"],e)});return Hy(f,v,["tox-form__group--collection"],[])},Qy=o([option("data"),re("inputAttributes",{}),re("inputStyles",{}),re("tag","input"),re("inputClasses",[]),sa("onSetValue"),re("styles",{}),re("eventOrder",{}),Ff("inputBehaviours",[Mf,fg]),re("selectOnFocus",!0)]),Zy=function(n){return Qa([fg.config({onFocus:n.selectOnFocus?function(component){var input=component.element,n=tu(input);input.dom.setSelectionRange(0,n.length)}:t})])},nx=function(n){return v(v({},Zy(n)),Rf(n.inputBehaviours,[Mf.config({store:v(v({mode:"manual"},n.data.map((function(data){return{initialValue:data}})).getOr({})),{getValue:function(input){return tu(input.element)},setValue:function(input,data){tu(input.element)!==data&&eu(input.element,data)}}),onSetValue:n.onSetValue})]))},tx=function(n){return{tag:n.tag,attributes:v({type:"text"},n.inputAttributes),styles:n.inputStyles,classes:n.inputClasses}},ex=zl({name:"Input",configFields:Qy(),factory:function(n,t){return{uid:n.uid,dom:tx(n),components:[],behaviours:nx(n),eventOrder:n.eventOrder}}}),ox={},rx={exports:ox};!function(t,e,o,r){!function(r){if("object"==typeof e&&void 0!==o)o.exports=r();else if("function"==typeof t&&t.amd)t([],r);else{("undefined"!=typeof window?window:void 0!==n?n:"undefined"!=typeof self?self:this).EphoxContactWrapper=r()}}((function(){return function n(t,e,o){function c(i,f){if(!e[i]){if(!t[i]){var l="function"==typeof r&&r;if(!f&&l)return l(i,!0);if(u)return u(i,!0);var a=new Error("Cannot find module '"+i+"'");throw a.code="MODULE_NOT_FOUND",a}var p=e[i]={exports:{}};t[i][0].call(p.exports,(function(n){return c(t[i][1][n]||n)}),p,p.exports,n,t,e,o)}return e[i].exports}for(var u="function"==typeof r&&r,i=0;i<o.length;i++)c(o[i]);return c}({1:[function(n,t,e){var o,r,c=t.exports={};function f(){throw new Error("setTimeout has not been defined")}function l(){throw new Error("clearTimeout has not been defined")}function d(n){if(o===setTimeout)return setTimeout(n,0);if((o===f||!o)&&setTimeout)return o=setTimeout,setTimeout(n,0);try{return o(n,0)}catch(t){try{return o.call(null,n,0)}catch(t){return o.call(this,n,0)}}}!function(){try{o="function"==typeof setTimeout?setTimeout:f}catch(n){o=f}try{r="function"==typeof clearTimeout?clearTimeout:l}catch(n){r=l}}();var m,h=[],v=!1,y=-1;function x(){v&&m&&(v=!1,m.length?h=m.concat(h):y=-1,h.length&&w())}function w(){if(!v){var n=d(x);v=!0;for(var t=h.length;t;){for(m=h,h=[];++y<t;)m&&m[y].run();y=-1,t=h.length}m=null,v=!1,function(marker){if(r===clearTimeout)return clearTimeout(marker);if((r===l||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(marker);try{r(marker)}catch(n){try{return r.call(null,marker)}catch(n){return r.call(this,marker)}}}(n)}}function S(n,t){this.fun=n,this.array=t}function k(){}c.nextTick=function(n){var t=new Array(arguments.length-1);if(arguments.length>1)for(var i=1;i<arguments.length;i++)t[i-1]=arguments[i];h.push(new S(n,t)),1!==h.length||v||d(w)},S.prototype.run=function(){this.fun.apply(null,this.array)},c.title="browser",c.browser=!0,c.env={},c.argv=[],c.version="",c.versions={},c.on=k,c.addListener=k,c.once=k,c.off=k,c.removeListener=k,c.removeAllListeners=k,c.emit=k,c.prependListener=k,c.prependOnceListener=k,c.listeners=function(n){return[]},c.binding=function(n){throw new Error("process.binding is not supported")},c.cwd=function(){return"/"},c.chdir=function(n){throw new Error("process.chdir is not supported")},c.umask=function(){return 0}},{}],2:[function(n,t,e){(function(n){!function(e){var o=setTimeout;function r(){}function c(n){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");if("function"!=typeof n)throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],v(n,this)}function f(n,t){for(;3===n._state;)n=n._value;0!==n._state?(n._handled=!0,c._immediateFn((function(){var e=1===n._state?t.onFulfilled:t.onRejected;if(null!==e){var o;try{o=e(n._value)}catch(n){return void d(t.promise,n)}l(t.promise,o)}else(1===n._state?l:d)(t.promise,n._value)}))):n._deferreds.push(t)}function l(n,t){try{if(t===n)throw new TypeError("A promise cannot be resolved with itself.");if(t&&("object"==typeof t||"function"==typeof t)){var e=t.then;if(t instanceof c)return n._state=3,n._value=t,void m(n);if("function"==typeof e)return void v((o=e,r=t,function(){o.apply(r,arguments)}),n)}n._state=1,n._value=t,m(n)}catch(t){d(n,t)}var o,r}function d(n,t){n._state=2,n._value=t,m(n)}function m(n){2===n._state&&0===n._deferreds.length&&c._immediateFn((function(){n._handled||c._unhandledRejectionFn(n._value)}));for(var i=0,t=n._deferreds.length;i<t;i++)f(n,n._deferreds[i]);n._deferreds=null}function h(n,t,e){this.onFulfilled="function"==typeof n?n:null,this.onRejected="function"==typeof t?t:null,this.promise=e}function v(n,t){var e=!1;try{n((function(n){e||(e=!0,l(t,n))}),(function(n){e||(e=!0,d(t,n))}))}catch(n){if(e)return;e=!0,d(t,n)}}c.prototype.catch=function(n){return this.then(null,n)},c.prototype.then=function(n,t){var e=new this.constructor(r);return f(this,new h(n,t,e)),e},c.all=function(n){var t=Array.prototype.slice.call(n);return new c((function(n,e){if(0===t.length)return n([]);var o=t.length;function r(i,c){try{if(c&&("object"==typeof c||"function"==typeof c)){var f=c.then;if("function"==typeof f)return void f.call(c,(function(n){r(i,n)}),e)}t[i]=c,0==--o&&n(t)}catch(n){e(n)}}for(var i=0;i<t.length;i++)r(i,t[i])}))},c.resolve=function(n){return n&&"object"==typeof n&&n.constructor===c?n:new c((function(t){t(n)}))},c.reject=function(n){return new c((function(t,e){e(n)}))},c.race=function(n){return new c((function(t,e){for(var i=0,o=n.length;i<o;i++)n[i].then(t,e)}))},c._immediateFn="function"==typeof n?function(t){n(t)}:function(n){o(n,0)},c._unhandledRejectionFn=function(n){"undefined"!=typeof console&&console&&console.warn("Possible Unhandled Promise Rejection:",n)},c._setImmediateFn=function(n){c._immediateFn=n},c._setUnhandledRejectionFn=function(n){c._unhandledRejectionFn=n},void 0!==t&&t.exports?t.exports=c:e.Promise||(e.Promise=c)}(this)}).call(this,n("timers").setImmediate)},{timers:3}],3:[function(n,t,e){(function(t,o){var r=n("process/browser.js").nextTick,c=Function.prototype.apply,f=Array.prototype.slice,l={},d=0;function m(n,t){this._id=n,this._clearFn=t}e.setTimeout=function(){return new m(c.call(setTimeout,window,arguments),clearTimeout)},e.setInterval=function(){return new m(c.call(setInterval,window,arguments),clearInterval)},e.clearTimeout=e.clearInterval=function(n){n.close()},m.prototype.unref=m.prototype.ref=function(){},m.prototype.close=function(){this._clearFn.call(window,this._id)},e.enroll=function(n,t){clearTimeout(n._idleTimeoutId),n._idleTimeout=t},e.unenroll=function(n){clearTimeout(n._idleTimeoutId),n._idleTimeout=-1},e._unrefActive=e.active=function(n){clearTimeout(n._idleTimeoutId);var t=n._idleTimeout;t>=0&&(n._idleTimeoutId=setTimeout((function(){n._onTimeout&&n._onTimeout()}),t))},e.setImmediate="function"==typeof t?t:function(n){var t=d++,o=!(arguments.length<2)&&f.call(arguments,1);return l[t]=!0,r((function(){l[t]&&(o?n.apply(null,o):n.call(null),e.clearImmediate(t))})),t},e.clearImmediate="function"==typeof o?o:function(n){delete l[n]}}).call(this,n("timers").setImmediate,n("timers").clearImmediate)},{"process/browser.js":1,timers:3}],4:[function(n,t,e){var o=n("promise-polyfill"),r="undefined"!=typeof window?window:Function("return this;")();t.exports={boltExport:r.Promise||o}},{"promise-polyfill":2}]},{},[4])(4)}))}(void 0,ox,rx,void 0);var ix,ux=rx.exports.boltExport,ax=function(n){var data=O.none(),t=[],e=function(n){o()?c(n):t.push(n)},o=function(){return data.isSome()},r=function(n){G(n,c)},c=function(n){data.each((function(t){setTimeout((function(){n(t)}),0)}))};return n((function(n){o()||(data=O.some(n),r(t),t=[])})),{get:e,map:function(n){return ax((function(t){e((function(data){t(n(data))}))}))},isReady:o}},cx={nu:ax,pure:function(a){return ax((function(n){n(a)}))}},sx=function(n){setTimeout((function(){throw n}),0)},fx=function(n){var t=function(t){n().then(t,sx)};return{map:function(t){return fx((function(){return n().then(t)}))},bind:function(t){return fx((function(){return n().then((function(n){return t(n).toPromise()}))}))},anonBind:function(t){return fx((function(){return n().then((function(){return t.toPromise()}))}))},toLazy:function(){return cx.nu(t)},toCached:function(){var t=null;return fx((function(){return null===t&&(t=n()),t}))},toPromise:n,get:t}},lx=function(n){return fx((function(){return new ux(n)}))},dx=function(a){return fx((function(){return ux.resolve(a)}))},mx=["input","textarea"],gx=function(n){var t=fr(n);return L(mx,t)},px=function(component,n){var t=n.getRoot(component).getOr(component.element);Ei(t,n.invalidClass),n.notify.each((function(n){gx(component.element)&&Pr(component.element,"aria-invalid",!1),n.getContainer(component).each((function(t){Rr(t,n.validHtml)})),n.onValid(component)}))},hx=function(component,n,t,text){var e=n.getRoot(component).getOr(component.element);_i(e,n.invalidClass),n.notify.each((function(n){gx(component.element)&&Pr(component.element,"aria-invalid",!0),n.getContainer(component).each((function(n){Rr(n,text)})),n.onInvalid(component,text)}))},vx=function(component,n,t){return n.validator.fold((function(){return dx(ln.value(!0))}),(function(n){return n.validate(component)}))},bx=function(component,n,t){return n.notify.each((function(n){n.onValidate(component)})),vx(component,n).map((function(t){return component.getSystem().isConnected()?t.fold((function(t){return hx(component,n,0,t),ln.error(t)}),(function(t){return px(component,n),ln.value(t)})):ln.error("No longer in system")}))},yx=Object.freeze({__proto__:null,markValid:px,markInvalid:hx,query:vx,run:bx,isInvalid:function(component,n){var t=n.getRoot(component).getOr(component.element);return Di(t,n.invalidClass)}}),xx=Object.freeze({__proto__:null,events:function(n,e){return n.validator.map((function(e){return qo([$o(e.onEvent,(function(component){bx(component,n).get(r)}))].concat(e.validateOnLoad?[ur((function(component){bx(component,n).get(t)}))]:[]))})).getOr({})}}),wx=[Wt("invalidClass"),re("getRoot",O.none),oe("notify",[re("aria","alert"),re("getContainer",O.none),re("validHtml",""),sa("onValid"),sa("onInvalid"),sa("onValidate")]),oe("validator",[Wt("validate"),re("onEvent","input"),re("validateOnLoad",!0)])],Sx=nc({fields:wx,name:"invalidating",active:xx,apis:yx,extra:{validation:function(n){return function(component){var t=Mf.getValue(component);return dx(n(t))}}}}),kx=Object.freeze({__proto__:null,getCoupled:function(component,n,t,e){return t.getOrCreate(component,n,e)}}),Cx=[Gt("others",Et(ln.value,Rt()))],Ox=nc({fields:Cx,name:"coupling",apis:kx,state:Object.freeze({__proto__:null,init:function(){var n={},t=o({});return fi({readState:t,getOrCreate:function(component,t,e){var o=Cn(t.others);if(o)return Fn(n,e).getOrThunk((function(){var o=Fn(t.others,e).getOrDie("No information found for coupled component: "+e)(component),r=component.getSystem().build(o);return n[e]=r,r}));throw new Error("Cannot find coupled component: "+e+". Known coupled components: "+JSON.stringify(o,null,2))}})}})}),_x=o("sink"),Tx=o(ll({name:_x(),overrides:o({dom:{tag:"div"},behaviours:Qa([Us.config({useFixed:m})]),events:qo([or(co()),or(to()),or(lo())])})}));!function(n){n[n.HighlightFirst=0]="HighlightFirst",n[n.HighlightNone=1]="HighlightNone"}(ix||(ix={}));var Ex=function(n,component){var t=n.getHotspot(component).getOr(component),e=n.getAnchorOverrides();return n.layouts.fold((function(){return{anchor:"hotspot",hotspot:t,overrides:e}}),(function(n){return{anchor:"hotspot",hotspot:t,overrides:e,layouts:n}}))},Dx=function(n,t,e,o,r,c,f){return function(n,t,e,component,o,r,c){var f=function(n,t,component){return(0,n.fetch)(component).map(t)}(n,t,component),l=Fx(component,n);return f.map((function(n){return n.bind((function(data){return O.from(Ug.sketch(v(v({},r.menu()),{uid:ni(""),data:data,highlightImmediately:c===ix.HighlightFirst,onOpenMenu:function(n,menu){var t=l().getOrDie();Us.position(t,e,menu),df.decloak(o)},onOpenSubmenu:function(n,t,e){var r=l().getOrDie();Us.position(r,{anchor:"submenu",item:t},e),df.decloak(o)},onRepositionMenu:function(n,t,o){var r=l().getOrDie();Us.position(r,e,t),G(o,(function(n){Us.position(r,{anchor:"submenu",item:n.triggeringItem},n.triggeredMenu)}))},onEscape:function(){return fg.focus(component),df.close(o),O.some(!0)}})))}))}))}(n,t,Ex(n,e),e,o,r,f).map((function(n){return n.fold((function(){df.isOpen(o)&&df.close(o)}),(function(data){df.cloak(o),df.open(o,data),c(o)})),o}))},Bx=function(n,t,component,e,o,r,c){return df.close(e),dx(e)},Ax=function(n,t,e,o,r,c){var f=Ox.getCoupled(e,"sandbox");return(df.isOpen(f)?Bx:Dx)(n,t,e,f,o,r,c)},Mx=function(n,t,e){var menu=Xl.getCurrent(t).getOr(t),o=Cu(n.element);e?Gi(menu.element,"min-width",o+"px"):function(element,n){ku.set(element,n)}(menu.element,o)},Fx=function(n,t){return n.getSystem().getByUid(t.uid+"-"+_x()).map((function(n){return function(){return ln.value(n)}})).getOrThunk((function(){return t.lazySink.fold((function(){return function(){return ln.error(new Error("No internal sink is specified, nor could an external sink be found"))}}),(function(t){return function(){return t(n)}}))}))},Ix=function(n){df.getState(n).each((function(n){Ug.repositionMenus(n)}))},Rx=function(n,t,e){var o=qu(),r=Fx(t,n);return{dom:{tag:"div",classes:n.sandboxClasses,attributes:{id:o.id,role:"listbox"}},behaviours:Pf(n.sandboxBehaviours,[Mf.config({store:{mode:"memory",initialValue:t}}),df.config({onOpen:function(component,menu){var r=Ex(n,t);o.link(t.element),n.matchWidth&&Mx(r.hotspot,menu,n.useMinWidth),n.onOpen(r,component,menu),void 0!==e&&void 0!==e.onOpen&&e.onOpen(component,menu)},onClose:function(component,menu){o.unlink(t.element),void 0!==e&&void 0!==e.onClose&&e.onClose(component,menu)},isPartOf:function(n,data,e){return Ku(data,e)||Ku(t,e)},getAttachPoint:function(){return r().getOrDie()}}),Xl.config({find:function(n){return df.getState(n).bind((function(menu){return Xl.getCurrent(menu)}))}}),rc.config({channels:v(v({},vf({isExtraPart:d})),yf({doReposition:Ix}))})])}},Vx=function(n){var t=Ox.getCoupled(n,"sandbox");Ix(t)},Px=function(){return[re("sandboxClasses",[]),Vf("sandboxBehaviours",[Xl,rc,df,Mf])]},Hx=o([Wt("dom"),Wt("fetch"),sa("onOpen"),fa("onExecute"),re("getHotspot",O.some),re("getAnchorOverrides",o({})),Hc(),Ff("dropdownBehaviours",[Sg,Ox,Zm,fg]),Wt("toggleClass"),re("eventOrder",{}),option("lazySink"),re("matchWidth",!1),re("useMinWidth",!1),option("role")].concat(Px())),zx=o([fl({schema:[ua()],name:"menu",defaults:function(n){return{onExecute:n.onExecute}}}),Tx()]),Nx=Nl({name:"Dropdown",configFields:Hx(),partFields:zx(),factory:function(n,e,o,r){var c,f,l=function(n){df.getState(n).each((function(n){Ug.highlightPrimary(n)}))},d={expand:function(e){Sg.isOn(e)||Ax(n,(function(n){return n}),e,r,t,ix.HighlightNone).get(t)},open:function(e){Sg.isOn(e)||Ax(n,(function(n){return n}),e,r,t,ix.HighlightFirst).get(t)},isOpen:Sg.isOn,close:function(e){Sg.isOn(e)&&Ax(n,(function(n){return n}),e,r,t,ix.HighlightFirst).get(t)},repositionMenus:function(n){Sg.isOn(n)&&Vx(n)}},m=function(n,t){return Wo(n),O.some(!0)};return{uid:n.uid,dom:n.dom,components:e,behaviours:Rf(n.dropdownBehaviours,[Sg.config({toggleClass:n.toggleClass,aria:{mode:"expanded"}}),Ox.config({others:{sandbox:function(t){return Rx(n,t,{onOpen:function(){Sg.on(t)},onClose:function(){Sg.off(t)}})}}}),Zm.config({mode:"special",onSpace:m,onEnter:m,onDown:function(n,t){if(Nx.isOpen(n)){var e=Ox.getCoupled(n,"sandbox");l(e)}else Nx.open(n);return O.some(!0)},onEscape:function(n,t){return Nx.isOpen(n)?(Nx.close(n),O.some(!0)):O.none()}}),fg.config({})]),events:Cg(O.some((function(component){Ax(n,(function(n){return n}),component,r,l,ix.HighlightFirst).get(t)}))),eventOrder:v(v({},n.eventOrder),(c={},c[wo()]=["disabling","toggling","alloy.base.behaviour"],c)),apis:d,domModification:{attributes:v(v({"aria-haspopup":"true"},n.role.fold((function(){return{}}),(function(n){return{role:n}}))),"button"===n.dom.tag?{type:(f="type",Fn(n.dom,"attributes").bind((function(n){return Fn(n,f)}))).getOr("button")}:{})}}},apis:{open:function(n,t){return n.open(t)},expand:function(n,t){return n.expand(t)},close:function(n,t){return n.close(t)},isOpen:function(n,t){return n.isOpen(t)},repositionMenus:function(n,t){return n.repositionMenus(t)}}}),Lx=Object.freeze({__proto__:null,events:function(){return qo([Jo(go(),m)])},exhibit:function(){return mi({styles:{"-webkit-user-select":"none","user-select":"none","-ms-user-select":"none","-moz-user-select":"-moz-none"},attributes:{unselectable:"on"}})}}),jx=nc({fields:[],name:"unselecting",active:Lx}),Ux=Yr("color-input-change"),Wx=Yr("color-swatch-change"),Gx=Yr("color-picker-cancel"),Xx=function(n,t,e){var o=Fy.parts.field({factory:ex,inputClasses:["tox-textfield"],onSetValue:function(n){return Sx.run(n).get((function(){}))},inputBehaviours:Qa([ev.config({disabled:t.providers.isDisabled}),Mv(),Vy.config({}),Sx.config({invalidClass:"tox-textbox-field-invalid",getRoot:function(n){return Sr(n.element)},notify:{onValid:function(n){var t=Mf.getValue(n);Uo(n,Ux,{color:t})}},validator:{validateOnLoad:!1,validate:function(input){var n=Mf.getValue(input);if(0===n.length)return dx(ln.value(!0));var span=he.fromTag("span");Gi(span,"background-color",n);var t=Ki(span,"background-color").fold((function(){return ln.error("blah")}),(function(t){return ln.value(n)}));return dx(t)}}})]),selectOnFocus:!1}),r=n.label.map((function(label){return Ly(label,t.providers)})),c=function(n,t){Uo(n,Wx,{value:t})},f=ip(function(n,t){return Nx.sketch({dom:n.dom,components:n.components,toggleClass:"mce-active",dropdownBehaviours:Qa([Iv(t.providers.isDisabled),Mv(),jx.config({}),Vy.config({})]),layouts:n.layouts,sandboxClasses:["tox-dialog__popups"],lazySink:t.getSink,fetch:function(e){return lx((function(t){return n.fetch(t)})).map((function(o){return O.from(cy(zn(Lb(Yr("menu-value"),o,(function(t){n.onItemAction(e,t)}),n.columns,n.presets,Kp.CLOSE_ON_EXECUTE,(function(){return!1}),t.providers),{movement:Ub(n.columns,n.presets)})))}))},parts:{menu:sh(0,0,n.presets)}})}({dom:{tag:"span",attributes:{"aria-label":t.providers.translate("Color swatch")}},layouts:{onRtl:function(){return[Fa,Ma,Pa]},onLtr:function(){return[Ma,Fa,Pa]}},components:[],fetch:Vb(e.getColors(),e.hasCustomColors()),columns:e.getColorCols(),presets:"color",onItemAction:function(n,t){f.getOpt(n).each((function(n){"custom"===t?e.colorPicker((function(t){t.fold((function(){return jo(n,Gx)}),(function(t){c(n,t),Mb(t)}))}),"#ffffff"):c(n,"remove"===t?"":t)}))}},t));return Fy.sketch({dom:{tag:"div",classes:["tox-form__group"]},components:r.toArray().concat([{dom:{tag:"div",classes:["tox-color-input"]},components:[o,f.asSpec()]}]),fieldBehaviours:Qa([ig("form-field-events",[$o(Ux,(function(t,e){f.getOpt(t).each((function(n){Gi(n.element,"background-color",e.event.color)})),Uo(t,jy,{name:n.name})})),$o(Wx,(function(n,t){Fy.getField(n).each((function(e){Mf.setValue(e,t.event.value),Xl.getCurrent(n).each(fg.focus)}))})),$o(Gx,(function(n,t){Fy.getField(n).each((function(t){Xl.getCurrent(n).each(fg.focus)}))}))])])})},Yx=function(n,t,e){return{hue:n,saturation:t,value:e}},qx=Yr("rgb-hex-update"),Jx=Yr("slider-update"),Kx=Yr("palette-update"),$x=ll({schema:[Wt("dom")],name:"label"}),Qx=function(n){return ll({name:n+"-edge",overrides:function(t){return t.model.manager.edgeActions[n].fold((function(){return{}}),(function(a){return{events:qo([Qo($e(),(function(n,t,e){return a(n,e)}),[t]),Qo(to(),(function(n,t,e){return a(n,e)}),[t]),Qo(eo(),(function(n,t,e){e.mouseIsDown.get()&&a(n,e)}),[t])])}}))}})},Zx=Qx("top-left"),nw=Qx("top"),tw=Qx("top-right"),ew=Qx("right"),ow=Qx("bottom-right"),rw=Qx("bottom"),iw=Qx("bottom-left"),uw=[$x,Qx("left"),ew,nw,rw,Zx,tw,iw,ow,sl({name:"thumb",defaults:o({dom:{styles:{position:"absolute"}}}),overrides:function(n){return{events:qo([nr($e(),n,"spectrum"),nr(Qe(),n,"spectrum"),nr(Ze(),n,"spectrum"),nr(to(),n,"spectrum"),nr(eo(),n,"spectrum"),nr(ro(),n,"spectrum")])}}}),sl({schema:[me("mouseIsDown",(function(){return ge(!1)}))],name:"spectrum",overrides:function(n){var t=n.model.manager,e=function(component,e){return t.getValueFromEvent(e).map((function(e){return t.setValueFrom(component,n,e)}))};return{behaviours:Qa([Zm.config({mode:"special",onLeft:function(e){return t.onLeft(e,n)},onRight:function(e){return t.onRight(e,n)},onUp:function(e){return t.onUp(e,n)},onDown:function(e){return t.onDown(e,n)}}),fg.config({})]),events:qo([$o($e(),e),$o(Qe(),e),$o(to(),e),$o(eo(),(function(t,o){n.mouseIsDown.get()&&e(t,o)}))])}}})],aw=o("slider.change.value"),cw=function(n){var t=n.event.raw;if(function(n){return-1!==n.type.indexOf("touch")}(t)){var e=t;return void 0!==e.touches&&1===e.touches.length?O.some(e.touches[0]).map((function(n){return yu(n.clientX,n.clientY)})):O.none()}var o=t;return void 0!==o.clientX?O.some(o).map((function(n){return yu(n.clientX,n.clientY)})):O.none()},sw=function(n){return n.model.minX},fw=function(n){return n.model.minY},lw=function(n){return n.model.minX-1},dw=function(n){return n.model.minY-1},mw=function(n){return n.model.maxX},gw=function(n){return n.model.maxY},pw=function(n){return n.model.maxX+1},hw=function(n){return n.model.maxY+1},vw=function(n,t,e){return t(n)-e(n)},bw=function(n){return vw(n,mw,sw)},yw=function(n){return vw(n,gw,fw)},xw=function(n){return bw(n)/2},ww=function(n){return yw(n)/2},Sw=function(n){return n.stepSize},kw=function(n){return n.snapToGrid},Cw=function(n){return n.snapStart},Ow=function(n){return n.rounded},_w=function(n,t){return void 0!==n[t+"-edge"]},Tw=function(n){return _w(n,"left")},Ew=function(n){return _w(n,"right")},Dw=function(n){return _w(n,"top")},Bw=function(n){return _w(n,"bottom")},Aw=function(n){return n.model.value.get()},Mw=function(n){return{x:n}},Fw=function(n){return{y:n}},Iw=function(n,t){return{x:n,y:t}},Rw=function(component,n){Uo(component,aw(),{value:n})},Vw=function(n,t,e,o){return n<t?n:n>e?e:n===t?t-1:Math.max(t,n-o)},Pw=function(n,t,e,o){return n>e?n:n<t?t:n===e?e+1:Math.min(e,n+o)},Hw=function(n,t,e){return Math.max(t,Math.min(e,n))},zw=function(n){var t=n.min,e=n.max,o=n.range,r=n.value,c=n.step,f=n.snap,l=n.snapStart,d=n.rounded,m=n.hasMinEdge,h=n.hasMaxEdge,v=n.minBound,y=n.maxBound,x=n.screenRange,w=m?t-1:t,S=h?e+1:e;if(r<v)return w;if(r>y)return S;var k=function(n,t,e){return Math.min(e,Math.max(n,t))-t}(r,v,y),C=Hw(k/x*o+t,w,S);return f&&C>=t&&C<=e?function(n,t,e,o,r){return r.fold((function(){var r=n-t,c=Math.round(r/o)*o;return Hw(t+c,t-1,e+1)}),(function(t){var r=(n-t)%o,c=Math.round(r/o),f=Math.floor((n-t)/o),l=Math.floor((e-t)/o),d=t+Math.min(l,f+c)*o;return Math.max(t,d)}))}(C,t,e,c,l):d?Math.round(C):C},Nw=function(n){var t=n.min,e=n.max,o=n.range,r=n.value,c=n.hasMinEdge,f=n.hasMaxEdge,l=n.maxBound,d=n.maxOffset,m=n.centerMinEdge,h=n.centerMaxEdge;return r<t?c?0:m:r>e?f?l:h:(r-t)/o*d},Lw=function(component){return component.element.dom.getBoundingClientRect()},jw=function(n,t){return n[t]},Uw=function(component){var n=Lw(component);return jw(n,"left")},Ww=function(component){var n=Lw(component);return jw(n,"right")},Gw=function(component){var n=Lw(component);return jw(n,"top")},Xw=function(component){var n=Lw(component);return jw(n,"bottom")},Yw=function(component){var n=Lw(component);return jw(n,"width")},qw=function(component){var n=Lw(component);return jw(n,"height")},Jw=function(n,t,e){return(n+t)/2-e},Kw=function(component,n){var t=Lw(component),e=Lw(n),o=jw(t,"left"),r=jw(t,"right"),c=jw(e,"left");return Jw(o,r,c)},$w=function(component,n){var t=Lw(component),e=Lw(n),o=jw(t,"top"),r=jw(t,"bottom"),c=jw(e,"top");return Jw(o,r,c)},Qw=function(n,t){Uo(n,aw(),{value:t})},Zw=function(n){return{x:n}},nS=function(n,t,e){var o={min:sw(t),max:mw(t),range:bw(t),value:e,step:Sw(t),snap:kw(t),snapStart:Cw(t),rounded:Ow(t),hasMinEdge:Tw(t),hasMaxEdge:Ew(t),minBound:Uw(n),maxBound:Ww(n),screenRange:Yw(n)};return zw(o)},tS=function(n){return function(t,e){return function(n,t,e){var o=(n>0?Pw:Vw)(Aw(e).x,sw(e),mw(e),Sw(e));return Qw(t,Zw(o)),O.some(o)}(n,t,e).map((function(){return!0}))}},eS=function(n,t,e,o,r,c){var f=function(n,t,e,o,r){var c=Yw(n),f=o.bind((function(t){return O.some(Kw(t,n))})).getOr(0),l=r.bind((function(t){return O.some(Kw(t,n))})).getOr(c),d={min:sw(t),max:mw(t),range:bw(t),value:e,hasMinEdge:Tw(t),hasMaxEdge:Ew(t),minBound:Uw(n),minOffset:0,maxBound:Ww(n),maxOffset:c,centerMinEdge:f,centerMaxEdge:l};return Nw(d)}(t,c,e,o,r);return Uw(t)-Uw(n)+f},oS=tS(-1),rS=tS(1),iS=O.none,uS=O.none,aS={"top-left":O.none(),top:O.none(),"top-right":O.none(),right:O.some((function(n,t){Rw(n,Mw(pw(t)))})),"bottom-right":O.none(),bottom:O.none(),"bottom-left":O.none(),left:O.some((function(n,t){Rw(n,Mw(lw(t)))}))},cS=Object.freeze({__proto__:null,setValueFrom:function(n,t,e){var o=nS(n,t,e),r=Zw(o);return Qw(n,r),o},setToMin:function(n,t){var e=sw(t);Qw(n,Zw(e))},setToMax:function(n,t){var e=mw(t);Qw(n,Zw(e))},findValueOfOffset:nS,getValueFromEvent:function(n){return cw(n).map((function(p){return p.left}))},findPositionOfValue:eS,setPositionFromValue:function(n,t,e,o){var r=Aw(e),c=eS(n,o.getSpectrum(n),r.x,o.getLeftEdge(n),o.getRightEdge(n),e),f=Cu(t.element)/2;Gi(t.element,"left",c-f+"px")},onLeft:oS,onRight:rS,onUp:iS,onDown:uS,edgeActions:aS}),sS=function(n,t){Uo(n,aw(),{value:t})},fS=function(n){return{y:n}},lS=function(n,t,e){var o={min:fw(t),max:gw(t),range:yw(t),value:e,step:Sw(t),snap:kw(t),snapStart:Cw(t),rounded:Ow(t),hasMinEdge:Dw(t),hasMaxEdge:Bw(t),minBound:Gw(n),maxBound:Xw(n),screenRange:qw(n)};return zw(o)},dS=function(n){return function(t,e){return function(n,t,e){var o=(n>0?Pw:Vw)(Aw(e).y,fw(e),gw(e),Sw(e));return sS(t,fS(o)),O.some(o)}(n,t,e).map((function(){return!0}))}},mS=function(n,t,e,o,r,c){var f=function(n,t,e,o,r){var c=qw(n),f=o.bind((function(t){return O.some($w(t,n))})).getOr(0),l=r.bind((function(t){return O.some($w(t,n))})).getOr(c),d={min:fw(t),max:gw(t),range:yw(t),value:e,hasMinEdge:Dw(t),hasMaxEdge:Bw(t),minBound:Gw(n),minOffset:0,maxBound:Xw(n),maxOffset:c,centerMinEdge:f,centerMaxEdge:l};return Nw(d)}(t,c,e,o,r);return Gw(t)-Gw(n)+f},gS=O.none,pS=O.none,hS=dS(-1),vS=dS(1),bS={"top-left":O.none(),top:O.some((function(n,t){Rw(n,Fw(dw(t)))})),"top-right":O.none(),right:O.none(),"bottom-right":O.none(),bottom:O.some((function(n,t){Rw(n,Fw(hw(t)))})),"bottom-left":O.none(),left:O.none()},yS=Object.freeze({__proto__:null,setValueFrom:function(n,t,e){var o=lS(n,t,e),r=fS(o);return sS(n,r),o},setToMin:function(n,t){var e=fw(t);sS(n,fS(e))},setToMax:function(n,t){var e=gw(t);sS(n,fS(e))},findValueOfOffset:lS,getValueFromEvent:function(n){return cw(n).map((function(p){return p.top}))},findPositionOfValue:mS,setPositionFromValue:function(n,t,e,o){var r=Aw(e),c=mS(n,o.getSpectrum(n),r.y,o.getTopEdge(n),o.getBottomEdge(n),e),f=hu(t.element)/2;Gi(t.element,"top",c-f+"px")},onLeft:gS,onRight:pS,onUp:hS,onDown:vS,edgeActions:bS}),xS=function(n,t){Uo(n,aw(),{value:t})},wS=function(n,t){return{x:n,y:t}},SS=function(n,t){return function(e,o){return function(n,t,e,o){var r=n>0?Pw:Vw,c=t?Aw(o).x:r(Aw(o).x,sw(o),mw(o),Sw(o)),f=t?r(Aw(o).y,fw(o),gw(o),Sw(o)):Aw(o).y;return xS(e,wS(c,f)),O.some(c)}(n,t,e,o).map((function(){return!0}))}},kS=SS(-1,!1),CS=SS(1,!1),OS=SS(-1,!0),_S=SS(1,!0),TS={"top-left":O.some((function(n,t){Rw(n,Iw(lw(t),dw(t)))})),top:O.some((function(n,t){Rw(n,Iw(xw(t),dw(t)))})),"top-right":O.some((function(n,t){Rw(n,Iw(pw(t),dw(t)))})),right:O.some((function(n,t){Rw(n,Iw(pw(t),ww(t)))})),"bottom-right":O.some((function(n,t){Rw(n,Iw(pw(t),hw(t)))})),bottom:O.some((function(n,t){Rw(n,Iw(xw(t),hw(t)))})),"bottom-left":O.some((function(n,t){Rw(n,Iw(lw(t),hw(t)))})),left:O.some((function(n,t){Rw(n,Iw(lw(t),ww(t)))}))},ES=Object.freeze({__proto__:null,setValueFrom:function(n,t,e){var o=nS(n,t,e.left),r=lS(n,t,e.top),c=wS(o,r);return xS(n,c),c},setToMin:function(n,t){var e=sw(t),o=fw(t);xS(n,wS(e,o))},setToMax:function(n,t){var e=mw(t),o=gw(t);xS(n,wS(e,o))},getValueFromEvent:function(n){return cw(n)},setPositionFromValue:function(n,t,e,o){var r=Aw(e),c=eS(n,o.getSpectrum(n),r.x,o.getLeftEdge(n),o.getRightEdge(n),e),f=mS(n,o.getSpectrum(n),r.y,o.getTopEdge(n),o.getBottomEdge(n),e),l=Cu(t.element)/2,d=hu(t.element)/2;Gi(t.element,"left",c-l+"px"),Gi(t.element,"top",f-d+"px")},onLeft:kS,onRight:CS,onUp:OS,onDown:_S,edgeActions:TS}),DS=Nl({name:"Slider",configFields:[re("stepSize",1),re("onChange",t),re("onChoose",t),re("onInit",t),re("onDragStart",t),re("onDragEnd",t),re("snapToGrid",!1),re("rounded",!0),option("snapStart"),Gt("model",It("mode",{x:[re("minX",0),re("maxX",100),me("value",(function(n){return ge(n.mode.minX)})),Wt("getInitialValue"),output("manager",cS)],y:[re("minY",0),re("maxY",100),me("value",(function(n){return ge(n.mode.minY)})),Wt("getInitialValue"),output("manager",yS)],xy:[re("minX",0),re("maxX",100),re("minY",0),re("maxY",100),me("value",(function(n){return ge({x:n.mode.minX,y:n.mode.minY})})),Wt("getInitialValue"),output("manager",ES)]})),Ff("sliderBehaviours",[Zm,Mf]),me("mouseIsDown",(function(){return ge(!1)}))],partFields:uw,factory:function(n,t,e,o){var r,c=function(component){return Ol(component,n,"thumb")},f=function(component){return Ol(component,n,"spectrum")},l=function(component){return Cl(component,n,"left-edge")},d=function(component){return Cl(component,n,"right-edge")},h=function(component){return Cl(component,n,"top-edge")},v=function(component){return Cl(component,n,"bottom-edge")},y=n.model,x=y.manager,w=function(t,e){x.setPositionFromValue(t,e,n,{getLeftEdge:l,getRightEdge:d,getTopEdge:h,getBottomEdge:v,getSpectrum:f})},S=function(t,e){y.value.set(e);var o=c(t);return w(t,o),n.onChange(t,o,e),O.some(!0)},k=function(t){var e=n.mouseIsDown.get();n.mouseIsDown.set(!1),e&&Cl(t,n,"thumb").each((function(e){var o=y.value.get();n.onChoose(t,e,o)}))},C=function(t,e){e.stop(),n.mouseIsDown.set(!0),n.onDragStart(t,c(t))},_=function(t,e){e.stop(),n.onDragEnd(t,c(t)),k(t)};return{uid:n.uid,dom:n.dom,components:t,behaviours:Rf(n.sliderBehaviours,[Zm.config({mode:"special",focusIn:function(t){return Cl(t,n,"spectrum").map(Zm.focusIn).map(m)}}),Mf.config({store:{mode:"manual",getValue:function(n){return y.value.get()}}}),rc.config({channels:(r={},r[pf()]={onReceive:k},r)})]),events:qo([$o(aw(),(function(n,t){S(n,t.event.value)})),ur((function(t,e){var o=y.getInitialValue();y.value.set(o);var r=c(t);w(t,r);var l=f(t);n.onInit(t,r,l,y.value.get())})),$o($e(),C),$o(Ze(),_),$o(to(),C),$o(ro(),_)]),apis:{resetToMin:function(t){x.setToMin(t,n)},resetToMax:function(t){x.setToMax(t,n)},changeValue:S,refresh:w},domModification:{styles:{position:"relative"}}}},apis:{resetToMin:function(n,t){n.resetToMin(t)},resetToMax:function(n,t){n.resetToMax(t)},refresh:function(n,t){n.refresh(t)}}}),BS=function(n,t){var e=DS.parts.spectrum({dom:{tag:"div",classes:[t("hue-slider-spectrum")],attributes:{role:"presentation"}}}),r=DS.parts.thumb({dom:{tag:"div",classes:[t("hue-slider-thumb")],attributes:{role:"presentation"}}});return DS.sketch({dom:{tag:"div",classes:[t("hue-slider")],attributes:{role:"presentation"}},rounded:!1,model:{mode:"y",getInitialValue:o({y:0})},components:[e,r],sliderBehaviours:Qa([fg.config({})]),onChange:function(n,t,e){Uo(n,Jx,{value:e})}})},AS=[Ff("formBehaviours",[Mf])],MS=function(n){return"<alloy.field."+n+">"},FS=function(n,t){return{uid:n.uid,dom:n.dom,components:t,behaviours:Rf(n.formBehaviours,[Mf.config({store:{mode:"manual",getValue:function(form){var t=Tl(form,n);return Tn(t,(function(n,t){return n().bind((function(n){var e,o,r=Xl.getCurrent(n);return e=r,o=new Error("Cannot find a current component to extract the value from for form part '"+t+"': "+element(n.element)),e.fold((function(){return ln.error(o)}),ln.value)})).map(Mf.getValue)}))},setValue:function(form,t){_n(t,(function(t,e){Cl(form,n,e).each((function(n){Xl.getCurrent(n).each((function(n){Mf.setValue(n,t)}))}))}))}}})]),apis:{getField:function(form,t){return Cl(form,n,t).bind(Xl.getCurrent)}}}},IS={getField:ci((function(n,component,t){return n.getField(component,t)})),sketch:function(n){var t=function(){var n=[];return{field:function(t,e){return n.push(t),yl("form",MS(t),e)},record:function(){return n}}}(),e=n(t),o=t.record(),r=map(o,(function(n){return sl({name:n,pname:MS(n)})}));return Il("form",AS,r,FS,e)}},RS=Yr("valid-input"),VS=Yr("invalid-input"),PS=Yr("validating-input"),HS=function(n,e,o,r){var c=function(label,t){return Sx.config({invalidClass:e("invalid"),notify:{onValidate:function(n){Uo(n,PS,{type:label})},onValid:function(n){Uo(n,RS,{type:label,value:Mf.getValue(n)})},onInvalid:function(n){Uo(n,VS,{type:label,value:Mf.getValue(n)})}},validator:{validate:function(e){var o=Mf.getValue(e),r=t(o)?ln.value(!0):ln.error(n("aria.input.invalid"));return dx(r)},validateOnLoad:!1}})},f=function(o,r,label,f,data){var l=n("colorcustom.rgb.range"),d=[Fy.parts.label({dom:{tag:"label",innerHtml:label,attributes:{"aria-label":f}}}),Fy.parts.field({data:data,factory:ex,inputAttributes:v({type:"text"},"hex"===r?{"aria-live":"polite"}:{}),inputClasses:[e("textfield")],inputBehaviours:Qa([c(r,o),Vy.config({})]),onSetValue:function(input){Sx.isInvalid(input)&&Sx.run(input).get(t)}})],m="hex"!==r?[Fy.parts["aria-descriptor"]({text:l})]:[];return{dom:{tag:"div",attributes:{role:"presentation"}},components:d.concat(m)}},l=function(form,n){var t=n.red,e=n.green,o=n.blue;Mf.setValue(form,{red:t,green:e,blue:o})},d=ip({dom:{tag:"div",classes:[e("rgba-preview")],styles:{"background-color":"white"},attributes:{role:"presentation"}}}),m=function(n,t){d.getOpt(n).each((function(n){Gi(n.element,"background-color","#"+t.value)}))};return zl({factory:function(){var t={red:ge(O.some(255)),green:ge(O.some(255)),blue:ge(O.some(255)),hex:ge(O.some("ffffff"))},c=function(n){return t[n].get()},h=function(n,e){t[n].set(e)},v=function(n){var t=n.red,e=n.green,o=n.blue;h("red",O.some(t)),h("green",O.some(e)),h("blue",O.some(o))},y=function(form,n){var data=n.event;"hex"!==data.type?h(data.type,O.none()):r(form)},x=function(form,n,t){var e=parseInt(t,10);h(n,O.some(e)),c("red").bind((function(n){return c("green").bind((function(t){return c("blue").map((function(e){return bb(n,t,e,1)}))}))})).each((function(n){var t=function(form,n){var t=db(n);return IS.getField(form,"hex").each((function(n){fg.isFocused(n)||Mf.setValue(form,{hex:t.value})})),t}(form,n);m(form,t)}))},w=function(form,n){var data=n.event;!function(data){return"hex"===data.type}(data)?x(form,data.type,data.value):function(form,n){o(form);var t=ub(n);h("hex",O.some(n));var e=wb(t);l(form,e),v(e),Uo(form,qx,{hex:t}),m(form,t)}(form,data.value)},S=function(t){return{label:n("colorcustom.rgb."+t+".label"),description:n("colorcustom.rgb."+t+".description")}},k=S("red"),C=S("green"),_=S("blue"),T=S("hex");return zn(IS.sketch((function(t){return{dom:{tag:"form",classes:[e("rgb-form")],attributes:{"aria-label":n("aria.color.picker")}},components:[t.field("red",Fy.sketch(f(yb,"red",k.label,k.description,255))),t.field("green",Fy.sketch(f(yb,"green",C.label,C.description,255))),t.field("blue",Fy.sketch(f(yb,"blue",_.label,_.description,255))),t.field("hex",Fy.sketch(f(sb,"hex",T.label,T.description,"ffffff"))),d.asSpec()],formBehaviours:Qa([Sx.config({invalidClass:e("form-invalid")}),ig("rgb-form-events",[$o(RS,w),$o(VS,y),$o(PS,y)])])}})),{apis:{updateHex:function(form,n){Mf.setValue(form,{hex:n.value}),function(form,n){var t=wb(n);l(form,t),v(t)}(form,n),m(form,n)}}})},name:"RgbForm",configFields:[],apis:{updateHex:function(n,form,t){n.updateHex(form,t)}},extraApis:{}})},zS=function(n,t){var e=DS.parts.spectrum({dom:{tag:"canvas",attributes:{role:"presentation"},classes:[t("sv-palette-spectrum")]}}),r=DS.parts.thumb({dom:{tag:"div",attributes:{role:"presentation"},classes:[t("sv-palette-thumb")],innerHtml:"<div class="+t("sv-palette-inner-thumb")+' role="presentation"></div>'}}),c=function(canvas,n){var t=canvas.width,e=canvas.height,o=canvas.getContext("2d");if(null!==o){o.fillStyle=n,o.fillRect(0,0,t,e);var r=o.createLinearGradient(0,0,t,0);r.addColorStop(0,"rgba(255,255,255,1)"),r.addColorStop(1,"rgba(255,255,255,0)"),o.fillStyle=r,o.fillRect(0,0,t,e);var c=o.createLinearGradient(0,0,0,e);c.addColorStop(0,"rgba(0,0,0,0)"),c.addColorStop(1,"rgba(0,0,0,1)"),o.fillStyle=c,o.fillRect(0,0,t,e)}};return zl({factory:function(n){var f=o({x:0,y:0}),l=Qa([Xl.config({find:O.some}),fg.config({})]);return DS.sketch({dom:{tag:"div",attributes:{role:"presentation"},classes:[t("sv-palette")]},model:{mode:"xy",getInitialValue:f},rounded:!1,components:[e,r],onChange:function(n,t,e){Uo(n,Kx,{value:e})},onInit:function(n,t,e,o){c(e.element.dom,kb(Cb))},sliderBehaviours:l})},name:"SaturationBrightnessPalette",configFields:[],apis:{setRgba:function(n,t,e){!function(n,t){var canvas=n.components()[0].element.dom;c(canvas,kb(t))}(t,e)}},extraApis:{}})},NS=function(n,e){return zl({name:"ColourPicker",configFields:[Wt("dom"),re("onValidHex",t),re("onInvalidHex",t)],factory:function(t){var o,r=HS(n,e,t.onValidHex,t.onInvalidHex),c=zS(0,e),f={paletteRgba:ge(Cb)},l=ip(c.sketch({})),d=ip(r.sketch({})),m=function(n,t){l.getOpt(n).each((function(n){var e=wb(t);f.paletteRgba.set(e),c.setRgba(n,e)}))},h=function(n,t){d.getOpt(n).each((function(form){r.updateHex(form,t)}))},v=function(n,t,e){G(e,(function(e){e(n,t)}))};return{uid:t.uid,dom:t.dom,components:[l.asSpec(),BS(0,e),d.asSpec()],behaviours:Qa([ig("colour-picker-events",[$o(Kx,(o=[h],function(form,n){var t=n.event.value,e=function(n){var s,t=0,e=0,o=n.red/255,g=n.green/255,b=n.blue/255,r=Math.min(o,Math.min(g,b)),c=Math.max(o,Math.max(g,b));return r===c?Yx(0,0,100*(e=r)):(t=60*((t=o===r?3:b===r?1:5)-(o===r?g-b:b===r?o-g:b-o)/(c-r)),s=(c-r)/c,e=c,Yx(Math.round(t),Math.round(100*s),Math.round(100*e)))}(f.paletteRgba.get()),r=Yx(e.hue,t.x,100-t.y),c=xb(r),l=db(c);v(form,l,o)})),$o(Jx,function(){var n=[m,h];return function(form,t){var e=function(n){var t=Yx((100-n)/100*360,100,100),e=xb(t);return db(e)}(t.event.value.y);v(form,e,n)}}())]),Xl.config({find:function(n){return d.getOpt(n)}}),Zm.config({mode:"acyclic"})])}}})},LS=function(){return Xl.config({find:O.some})},jS=function(n){return Xl.config({find:n.getOpt})},US=function(n){return Xl.config({find:function(t){return Or(t.element,n).bind((function(element){return t.getSystem().getByDom(element).toOptional()}))}})},WS={"colorcustom.rgb.red.label":"R","colorcustom.rgb.red.description":"Red component","colorcustom.rgb.green.label":"G","colorcustom.rgb.green.description":"Green component","colorcustom.rgb.blue.label":"B","colorcustom.rgb.blue.description":"Blue component","colorcustom.rgb.hex.label":"#","colorcustom.rgb.hex.description":"Hex color code","colorcustom.rgb.range":"Range 0 to 255","colorcustom.sb.saturation":"Saturation","colorcustom.sb.brightness":"Brightness","colorcustom.sb.picker":"Saturation and Brightness Picker","colorcustom.sb.palette":"Saturation and Brightness Palette","colorcustom.sb.instructions":"Use arrow keys to select saturation and brightness, on x and y axes","colorcustom.hue.hue":"Hue","colorcustom.hue.slider":"Hue Slider","colorcustom.hue.palette":"Hue Palette","colorcustom.hue.instructions":"Use arrow keys to select a hue","aria.color.picker":"Color Picker","aria.input.invalid":"Invalid input"},GS=function(n){return function(n){return WS[n]}(n)},XS=tinymce.util.Tools.resolve("tinymce.Resource"),YS=tinymce.util.Tools.resolve("tinymce.util.Tools"),qS=gt([re("preprocess",r),re("postprocess",r)]),JS=function(n,t,e){return Mf.config(zn({store:{mode:"manual",getValue:t,setValue:e}},n.map((function(n){return{store:{initialValue:n}}})).getOr({})))},KS=function(n,t,e){return JS(n,(function(n){return t(n.element)}),(function(n,t){return e(n.element,t)}))},$S=function(n,t){var e=At("RepresentingConfigs.memento processors",qS,t);return Mf.config({store:{mode:"manual",getValue:function(t){var o=n.get(t),r=Mf.getValue(o);return e.postprocess(r)},setValue:function(t,o){var r=e.preprocess(o),c=n.get(t);Mf.setValue(c,r)}}})},QS=JS,ZS=function(n){return KS(n,Ir,Rr)},nk=function(n){return Mf.config({store:{mode:"memory",initialValue:n}})},tk=function(n,t){var e=function(n,t){t.stop()},o=function(n){return function(t,e){G(n,(function(a){a(t,e)}))}},r=function(n,t){if(!ev.isDisabled(n)){var e=t.event.raw;f(n,e.dataTransfer.files)}},c=function(component,n){var input=n.event.raw.target;f(component,input.files)},f=function(component,e){Mf.setValue(component,function(n,t){var e=YS.explode(t.getSetting("images_file_types","jpeg,jpg,jpe,jfi,jif,jfif,png,gif,bmp,webp","string"));return filter(an(n),(function(n){return j(e,(function(t){return Ce(n.name,"."+t)}))}))}(e,t)),Uo(component,jy,{name:n.name})},l=ip({dom:{tag:"input",attributes:{type:"file",accept:"image/*"},styles:{display:"none"}},behaviours:Qa([ig("input-file-events",[or(lo()),or(ko())])])}),d=n.label.map((function(label){return Ly(label,t)})),m=Fy.parts.field({factory:{sketch:function(s){return{uid:s.uid,dom:{tag:"div",classes:["tox-dropzone-container"]},behaviours:Qa([nk([]),LS(),ev.config({}),Sg.config({toggleClass:"dragenter",toggleOnExecute:!1}),ig("dropzone-events",[$o("dragenter",o([e,Sg.toggle])),$o("dragleave",o([e,Sg.toggle])),$o("dragover",e),$o("drop",o([e,r])),$o(fo(),c)])]),components:[{dom:{tag:"div",classes:["tox-dropzone"],styles:{}},components:[{dom:{tag:"p",innerHtml:t.translate("Drop an image here")}},op.sketch({dom:{tag:"button",innerHtml:t.translate("Browse for an image"),styles:{position:"relative"},classes:["tox-button","tox-button--secondary"]},components:[l.asSpec()],action:function(n){l.get(n).element.dom.click()},buttonBehaviours:Qa([Vy.config({}),Iv(t.isDisabled),Mv()])})]}]}}}});return Hy(d,m,["tox-form__group--stretched"],[])},ek=Yr("alloy-fake-before-tabstop"),ok=Yr("alloy-fake-after-tabstop"),rk=function(n){return{dom:{tag:"div",styles:{width:"1px",height:"1px",outline:"none"},attributes:{tabindex:"0"},classes:n},behaviours:Qa([fg.config({ignore:!0}),Vy.config({})])}},ik=function(n){return{dom:{tag:"div",classes:["tox-navobj"]},components:[rk([ek]),n,rk([ok])],behaviours:Qa([US(1)])}},uk=function(n,t){Uo(n,co(),{raw:{which:9,shiftKey:t}})},ak=function(n,t){var e=t.element;Di(e,ek)?uk(n,!0):Di(e,ok)&&uk(n,!1)},ck=function(element){return gy(element,["."+ek,"."+ok].join(","),d)},sk=!(He().browser.isIE()||He().browser.isEdge()),fk=function(n,t){var e=sk&&n.sandboxed,o=v(v({},n.label.map((function(title){return{title:title}})).getOr({})),e?{sandbox:"allow-scripts allow-same-origin"}:{}),r=function(n){var t=ge("");return{getValue:function(n){return t.get()},setValue:function(e,html){if(n)Pr(e.element,"srcdoc",html);else{Pr(e.element,"src","javascript:''");var o=e.element.dom.contentWindow.document;o.open(),o.write(html),o.close()}t.set(html)}}}(e),c=n.label.map((function(label){return Ly(label,t)})),f=Fy.parts.field({factory:{sketch:function(n){return ik({uid:n.uid,dom:{tag:"iframe",attributes:o},behaviours:Qa([Vy.config({}),fg.config({}),QS(O.none(),r.getValue,r.setValue)])})}}});return Hy(c,f,["tox-form__group--stretched"],[])};function lk(n,t){return gk(document.createElement("canvas"),n,t)}function dk(canvas){var n=lk(canvas.width,canvas.height);return mk(n).drawImage(canvas,0,0),n}function mk(canvas){return canvas.getContext("2d")}function gk(canvas,n,t){return canvas.width=n,canvas.height=t,canvas}function pk(image){return image.naturalWidth||image.width}function hk(image){return image.naturalHeight||image.height}var vk=window.Promise?window.Promise:function(){var n=function(n){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");if("function"!=typeof n)throw new TypeError("not a function");this._state=null,this._value=null,this._deferreds=[],h(n,o(f,this),o(l,this))},t=window,e=n.immediateFn||"function"==typeof t.setImmediate&&t.setImmediate||function(n){setTimeout(n,1)};function o(n,t){return function(){return n.apply(t,arguments)}}var r=Array.isArray||function(n){return"[object Array]"===Object.prototype.toString.call(n)};function c(n){var t=this;null!==this._state?e((function(){var e=t._state?n.onFulfilled:n.onRejected;if(null!==e){var o;try{o=e(t._value)}catch(t){return void n.reject(t)}n.resolve(o)}else(t._state?n.resolve:n.reject)(t._value)})):this._deferreds.push(n)}function f(n){try{if(n===this)throw new TypeError("A promise cannot be resolved with itself.");if(n&&("object"==typeof n||"function"==typeof n)){var t=n.then;if("function"==typeof t)return void h(o(t,n),o(f,this),o(l,this))}this._state=!0,this._value=n,d.call(this)}catch(n){l.call(this,n)}}function l(n){this._state=!1,this._value=n,d.call(this)}function d(){for(var n=0,t=this._deferreds;n<t.length;n++){var e=t[n];c.call(this,e)}this._deferreds=[]}function m(n,t,e,o){this.onFulfilled="function"==typeof n?n:null,this.onRejected="function"==typeof t?t:null,this.resolve=e,this.reject=o}function h(n,t,e){var o=!1;try{n((function(n){o||(o=!0,t(n))}),(function(n){o||(o=!0,e(n))}))}catch(n){if(o)return;o=!0,e(n)}}return n.prototype.catch=function(n){return this.then(null,n)},n.prototype.then=function(t,e){var o=this;return new n((function(n,r){c.call(o,new m(t,e,n,r))}))},n.all=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var o=Array.prototype.slice.call(1===t.length&&r(t[0])?t[0]:t);return new n((function(n,t){if(0===o.length)return n([]);var e=o.length;function r(i,c){try{if(c&&("object"==typeof c||"function"==typeof c)){var f=c.then;if("function"==typeof f)return void f.call(c,(function(n){r(i,n)}),t)}o[i]=c,0==--e&&n(o)}catch(n){t(n)}}for(var i=0;i<o.length;i++)r(i,o[i])}))},n.resolve=function(t){return t&&"object"==typeof t&&t.constructor===n?t:new n((function(n){n(t)}))},n.reject=function(t){return new n((function(n,e){e(t)}))},n.race=function(t){return new n((function(n,e){for(var o=0,r=t;o<r.length;o++){r[o].then(n,e)}}))},n}();function bk(n){return new vk((function(t,e){(function(n){var data=n.split(","),t=/data:([^;]+)/.exec(data[0]);if(!t)return O.none();for(var e=t[1],o=data[1],r=atob(o),c=r.length,f=Math.ceil(c/1024),l=new Array(f),d=0;d<f;++d){for(var m=1024*d,h=Math.min(m+1024,c),v=new Array(h-m),y=m,i=0;y<h;++i,++y)v[i]=r[y].charCodeAt(0);l[d]=new Uint8Array(v)}return O.some(new Blob(l,{type:e}))})(n).fold((function(){e("uri is not base64: "+n)}),t)}))}function yk(canvas,n,t){return n=n||"image/png",I(HTMLCanvasElement.prototype.toBlob)?new vk((function(e,o){canvas.toBlob((function(n){n?e(n):o()}),n,t)})):bk(canvas.toDataURL(n,t))}function xk(n){return function(n){return new vk((function(t,e){var o=URL.createObjectURL(n),image=new Image,r=function(){image.removeEventListener("load",c),image.removeEventListener("error",f)};function c(){r(),t(image)}function f(){r(),e("Unable to load data of type "+n.type+": "+o)}image.addEventListener("load",c),image.addEventListener("error",f),image.src=o,image.complete&&c()}))}(n).then((function(image){!function(image){URL.revokeObjectURL(image.src)}(image);var canvas=lk(pk(image),hk(image));return mk(canvas).drawImage(image,0,0),canvas}))}function wk(n,t,e){var r=t.type;function c(t,e){return n.then((function(canvas){return function(canvas,n,t){return n=n||"image/png",canvas.toDataURL(n,t)}(canvas,t,e)}))}return{getType:o(r),toBlob:function(){return vk.resolve(t)},toDataURL:o(e),toBase64:function(){return e.split(",")[1]},toAdjustedBlob:function(t,e){return n.then((function(canvas){return yk(canvas,t,e)}))},toAdjustedDataURL:c,toAdjustedBase64:function(n,t){return c(n,t).then((function(n){return n.split(",")[1]}))},toCanvas:function(){return n.then(dk)}}}function Sk(n){return function(n){return new vk((function(t){var e=new FileReader;e.onloadend=function(){t(e.result)},e.readAsDataURL(n)}))}(n).then((function(t){return wk(xk(n),n,t)}))}function kk(canvas,n){return yk(canvas,n).then((function(n){return wk(vk.resolve(canvas),n,canvas.toDataURL())}))}function Ck(n,t,e){var o="string"==typeof n?parseFloat(n):n;return o>e?o=e:o<t&&(o=t),o}var Ok=[0,.01,.02,.04,.05,.06,.07,.08,.1,.11,.12,.14,.15,.16,.17,.18,.2,.21,.22,.24,.25,.27,.28,.3,.32,.34,.36,.38,.4,.42,.44,.46,.48,.5,.53,.56,.59,.62,.65,.68,.71,.74,.77,.8,.83,.86,.89,.92,.95,.98,1,1.06,1.12,1.18,1.24,1.3,1.36,1.42,1.48,1.54,1.6,1.66,1.72,1.78,1.84,1.9,1.96,2,2.12,2.25,2.37,2.5,2.62,2.75,2.87,3,3.2,3.4,3.6,3.8,4,4.3,4.7,4.9,5,5.5,6,6.5,6.8,7,7.3,7.5,7.8,8,8.4,8.7,9,9.4,9.6,9.8,10];function _k(n,t){for(var e,col=[],o=new Array(25),i=0;i<5;i++){for(var r=0;r<5;r++)col[r]=t[r+5*i];for(r=0;r<5;r++){e=0;for(var c=0;c<5;c++)e+=n[r+5*c]*col[c];o[r+5*i]=e}}return o}function Tk(n,t){return n.toCanvas().then((function(canvas){return function(canvas,n,t){var e=mk(canvas);var o=function(n,t){for(var e,g,b,a,data=n.data,o=t[0],r=t[1],c=t[2],f=t[3],l=t[4],d=t[5],m=t[6],h=t[7],v=t[8],y=t[9],x=t[10],w=t[11],S=t[12],k=t[13],C=t[14],O=t[15],_=t[16],T=t[17],E=t[18],D=t[19],i=0;i<data.length;i+=4)e=data[i],g=data[i+1],b=data[i+2],a=data[i+3],data[i]=e*o+g*r+b*c+a*f+l,data[i+1]=e*d+g*m+b*h+a*v+y,data[i+2]=e*x+g*w+b*S+a*k+C,data[i+3]=e*O+g*_+b*T+a*E+D;return n}(e.getImageData(0,0,canvas.width,canvas.height),t);return e.putImageData(o,0,0),kk(canvas,n)}(canvas,n.getType(),t)}))}function Ek(n,t){return n.toCanvas().then((function(canvas){return function(canvas,n,t){var e=mk(canvas);var o=e.getImageData(0,0,canvas.width,canvas.height),r=e.getImageData(0,0,canvas.width,canvas.height);return r=function(n,t,e){function o(n,t,e){return n>e?n=e:n<t&&(n=t),n}for(var r=Math.round(Math.sqrt(e.length)),c=Math.floor(r/2),f=n.data,l=t.data,d=n.width,m=n.height,h=0;h<m;h++)for(var v=0;v<d;v++){for(var y=0,g=0,b=0,x=0;x<r;x++)for(var w=0;w<r;w++){var S=o(v+w-c,0,d-1),k=4*(o(h+x-c,0,m-1)*d+S),C=e[x*r+w];y+=f[k]*C,g+=f[k+1]*C,b+=f[k+2]*C}var O=4*(h*d+v);l[O]=o(y,0,255),l[O+1]=o(g,0,255),l[O+2]=o(b,0,255)}return t}(o,r,t),e.putImageData(r,0,0),kk(canvas,n)}(canvas,n.getType(),t)}))}function Dk(n){return function(t,e){return Tk(t,n([1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1],e))}}var Bk,Ak,Mk=function(n){return function(t){return Tk(t,n)}}([-1,0,0,0,255,0,-1,0,0,255,0,0,-1,0,255,0,0,0,1,0,0,0,0,0,1]),Fk=Dk((function(n,t){return _k(n,[1,0,0,0,t=Ck(255*t,-255,255),0,1,0,0,t,0,0,1,0,t,0,0,0,1,0,0,0,0,0,1])})),Ik=Dk((function(n,t){var e;return t=Ck(t,-1,1),_k(n,[(e=(t*=100)<0?127+t/100*127:127*(e=0===(e=t%1)?Ok[t]:Ok[Math.floor(t)]*(1-e)+Ok[Math.floor(t)+1]*e)+127)/127,0,0,0,.5*(127-e),0,e/127,0,0,.5*(127-e),0,0,e/127,0,.5*(127-e),0,0,0,1,0,0,0,0,0,1])})),Rk=function(n,t,e,o){return Tk(n,function(n,t,e,o){return _k(n,[t=Ck(t,0,2),0,0,0,0,0,e=Ck(e,0,2),0,0,0,0,0,o=Ck(o,0,2),0,0,0,0,0,1,0,0,0,0,0,1])}([1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1],t,e,o))},Vk=(Bk=[0,-1,0,-1,5,-1,0,-1,0],function(n){return Ek(n,Bk)}),Pk=(Ak=function(n,t){return 255*Math.pow(n/255,1-t)},function(n,t){return n.toCanvas().then((function(canvas){return function(canvas,n,t){for(var e=mk(canvas),o=new Array(256),i=0;i<o.length;i++)o[i]=Ak(i,t);var r=function(n,t){for(var data=n.data,i=0;i<data.length;i+=4)data[i]=t[data[i]],data[i+1]=t[data[i+1]],data[i+2]=t[data[i+2]];return n}(e.getImageData(0,0,canvas.width,canvas.height),o);return e.putImageData(r,0,0),kk(canvas,n)}(canvas,n.getType(),t)}))});function Hk(image,n,t){var e=pk(image),o=hk(image),r=n/e,c=t/o,f=!1;(r<.5||r>2)&&(r=r<.5?.5:2,f=!0),(c<.5||c>2)&&(c=c<.5?.5:2,f=!0);var l=function(image,n,t){return new vk((function(e){var o=pk(image),r=hk(image),c=Math.floor(o*n),f=Math.floor(r*t),canvas=lk(c,f);mk(canvas).drawImage(image,0,0,o,r,0,0,c,f),e(canvas)}))}(image,r,c);return f?l.then((function(e){return Hk(e,n,t)})):l}function zk(n,t){return n.toCanvas().then((function(canvas){return function(image,n,t){var canvas=lk(image.width,image.height),e=mk(canvas),o=0,r=0;90!==(t=t<0?360+t:t)&&270!==t||gk(canvas,canvas.height,canvas.width);90!==t&&180!==t||(o=canvas.width);270!==t&&180!==t||(r=canvas.height);return e.translate(o,r),e.rotate(t*Math.PI/180),e.drawImage(image,0,0),kk(canvas,n)}(canvas,n.getType(),t)}))}function Nk(n,t){return n.toCanvas().then((function(canvas){return function(image,n,t){var canvas=lk(image.width,image.height),e=mk(canvas);"v"===t?(e.scale(1,-1),e.drawImage(image,0,-canvas.height)):(e.scale(-1,1),e.drawImage(image,-canvas.width,0));return kk(canvas,n)}(canvas,n.getType(),t)}))}function Lk(n,t,e,o,r){return n.toCanvas().then((function(canvas){return function(image,n,t,e,o,r){var canvas=lk(o,r);return mk(canvas).drawImage(image,-t,-e),kk(canvas,n)}(canvas,n.getType(),t,e,o,r)}))}var jk,Uk=function(n){return Mk(n)},Wk=function(n){return Vk(n)},Gk=function(n,t){return Pk(n,t)},Xk=function(n,t){return Fk(n,t)},Yk=function(n,t){return Ik(n,t)},qk=function(n,t){return Nk(n,t)},Jk=function(n,t,e){return function(n,t,e){return n.toCanvas().then((function(canvas){return Hk(canvas,t,e).then((function(t){return kk(t,n.getType())}))}))}(n,t,e)},Kk=function(n,t){return zk(n,t)},$k=function(n,t){return v({dom:{tag:"span",innerHtml:n,classes:["tox-icon","tox-tbtn__icon-wrap"]}},t)},Qk=function(n,t){return $k(ap(n,t),{})},Zk=function(n,t){return $k(ap(n,t),{behaviours:Qa([rg.config({})])})},nC=function(text,n,t){return{dom:{tag:"span",innerHtml:t.translate(text),classes:[n+"__select-label"]},behaviours:Qa([rg.config({})])}},tC=Yr("toolbar.button.execute"),eC=((jk={})[wo()]=["disabling","alloy.base.behaviour","toggling","toolbar-button-events"],jk),oC=Yr("update-menu-text"),rC=Yr("update-menu-icon"),iC=function(n,e,o){var r=ge(t),f=n.text.map((function(text){return ip(nC(text,e,o.providers))})),l=n.icon.map((function(n){return ip(Zk(n,o.providers.icons))})),d=function(n,t){var e=Mf.getValue(n);return fg.focus(e),Uo(e,"keydown",{raw:t.event.raw}),Nx.close(e),O.some(!0)},m=n.role.fold((function(){return{}}),(function(n){return{role:n}})),h=n.tooltip.fold((function(){return{}}),(function(n){var t=o.providers.translate(n);return{title:t,"aria-label":t}}));return ip(Nx.sketch(v(v(v({},n.uid?{uid:n.uid}:{}),m),{dom:{tag:"button",classes:[e,e+"--select"].concat(map(n.classes,(function(n){return e+"--"+n}))),attributes:v({},h)},components:jv([l.map((function(n){return n.asSpec()})),f.map((function(n){return n.asSpec()})),O.some({dom:{tag:"div",classes:[e+"__select-chevron"],innerHtml:ap("chevron-down",o.providers.icons)}})]),matchWidth:!0,useMinWidth:!0,dropdownBehaviours:Qa(x(n.dropdownBehaviours,[Iv((function(){return n.disabled||o.providers.isDisabled()})),Mv(),jx.config({}),rg.config({}),ig("dropdown-events",[Hv(n,r),zv(n,r)]),ig("menubutton-update-display-text",[$o(oC,(function(n,t){f.bind((function(t){return t.getOpt(n)})).each((function(n){rg.set(n,[text(o.providers.translate(t.event.text))])}))})),$o(rC,(function(n,t){l.bind((function(t){return t.getOpt(n)})).each((function(n){rg.set(n,[Zk(t.event.icon,o.providers.icons)])}))}))])])),eventOrder:zn(eC,{mousedown:["focusing","alloy.base.behaviour","item-type-events","normal-dropdown-events"]}),sandboxBehaviours:Qa([Zm.config({mode:"special",onLeft:d,onRight:d})]),lazySink:o.getSink,toggleClass:e+"--active",parts:{menu:sh(0,n.columns,n.presets)},fetch:function(t){return lx(c(n.fetch,t))}}))).asSpec()},uC=function(n){return"separator"===n.type},aC={type:"separator"},cC=function(n,t){var e=J(n,(function(n,e){return function(n){return E(n)}(e)?""===e?n:"|"===e?n.length>0&&!uC(n[n.length-1])?n.concat([aC]):n:In(t,e.toLowerCase())?n.concat([t[e.toLowerCase()]]):n:n.concat([e])}),[]);return e.length>0&&uC(e[e.length-1])&&e.pop(),e},sC=function(n,t){return function(n){return In(n,"getSubmenuItems")}(n)?function(n,t){var e=n.getSubmenuItems(),o=fC(e,t);return{item:n,menus:zn(o.menus,$n(n.value,o.items)),expansions:zn(o.expansions,$n(n.value,n.value))}}(n,t):{item:n,menus:{},expansions:{}}},fC=function(n,t){var e=cC(E(n)?n.split(" "):n,t);return Y(e,(function(n,e){var o=function(n){if(uC(n))return n;var t=Fn(n,"value").getOrThunk((function(){return Yr("generated-menu-item")}));return zn({value:t},n)}(e),r=sC(o,t);return{menus:zn(n.menus,r.menus),items:[r.item].concat(n.items),expansions:zn(n.expansions,r.expansions)}}),{menus:{},expansions:{},items:[]})},lC=function(n,t,e,o){var r=Yr("primary-menu"),data=fC(n,e.shared.providers.menuItems());if(0===data.items.length)return O.none();var c=ay(r,data.items,t,e,o),f=Tn(data.menus,(function(n,o){return ay(o,n,t,e,!1)})),l=zn(f,$n(r,c));return O.from(Ug.tieredData(r,l,data.expansions))},dC=function(component){return{isDisabled:function(){return ev.isDisabled(component)},setDisabled:function(n){return ev.set(component,n)},setActive:function(n){var t=component.element;n?(_i(t,"tox-tbtn--enabled"),Pr(t,"aria-pressed",!0)):(Ei(t,"tox-tbtn--enabled"),Lr(t,"aria-pressed"))},isActive:function(){return Di(component.element,"tox-tbtn--enabled")}}},mC=function(n,t,e,o){return iC({text:n.text,icon:n.icon,tooltip:n.tooltip,role:o,fetch:function(t,o){n.fetch((function(n){o(lC(n,Kp.CLOSE_ON_EXECUTE,e,!1))}))},onSetup:n.onSetup,getApi:dC,columns:1,presets:"normal",classes:[],dropdownBehaviours:[Vy.config({})]},t,e.shared)},gC=function(n,t,e){var o=function(n){return function(o){var r=!o.isActive();o.setActive(r),n.storage.set(r),e.shared.getSink().each((function(e){t().getOpt(e).each((function(t){uc(t.element),Uo(t,Gy,{name:n.name,value:n.storage.get()})}))}))}},r=function(n){return function(t){t.setActive(n.storage.get())}};return function(t){t(map(n,(function(n){var text=n.text.fold((function(){return{}}),(function(text){return{text:text}}));return v(v({type:n.type,active:!1},text),{onAction:o(n),onSetup:r(n)})})))}},pC=function(n,t,e,o,r,c){void 0===e&&(e=[]);var f=t.fold((function(){return{}}),(function(n){return{action:n}})),l=v({buttonBehaviours:Qa([Iv((function(){return n.disabled||c.isDisabled()})),Mv(),Vy.config({}),ig("button press",[Ko("click"),Ko("mousedown")])].concat(e)),eventOrder:{click:["button press","alloy.base.behaviour"],mousedown:["button press","alloy.base.behaviour"]}},f),d=zn(l,{dom:o});return zn(d,{components:r})},hC=function(n,t,e,o){void 0===o&&(o=[]);var r={tag:"button",classes:["tox-tbtn"],attributes:n.tooltip.map((function(n){return{"aria-label":e.translate(n),title:e.translate(n)}})).getOr({})},c=n.icon.map((function(n){return Qk(n,e.icons)})),f=jv([c]);return pC(n,t,o,r,f,e)},vC=function(n,t,e,o){void 0===o&&(o=[]);var r=hC(n,O.some(t),e,o);return op.sketch(r)},bC=function(n,t,e,o,r){void 0===o&&(o=[]),void 0===r&&(r=[]);var c=e.translate(n.text),f=n.icon?n.icon.map((function(n){return Qk(n,e.icons)})):O.none(),l=f.isSome()?jv([f]):[],d=f.isSome()?{}:{innerHtml:c},m=x(n.primary||n.borderless?["tox-button"]:["tox-button","tox-button--secondary"],f.isSome()?["tox-button--icon"]:[],n.borderless?["tox-button--naked"]:[],r),h=v(v({tag:"button",classes:m},d),{attributes:{title:c}});return pC(n,t,o,h,l,e)},yC=function(n,t,e,o,r){void 0===o&&(o=[]),void 0===r&&(r=[]);var c=bC(n,O.some(t),e,o,r);return op.sketch(c)},xC=function(n,t){return function(e){"custom"===t?Uo(e,Gy,{name:n,value:{}}):"submit"===t?jo(e,Xy):"cancel"===t?jo(e,Wy):console.error("Unknown button type: ",t)}},wC=function(n,e,o){if(function(n,t){return"menu"===t}(0,e)){var r=n,c=v(v({},n),{onSetup:function(e){return e.setDisabled(n.disabled),t},fetch:gC(r.items,(function(){return f}),o)}),f=ip(mC(c,"tox-tbtn",o,O.none()));return f.asSpec()}if(function(n,t){return"custom"===t||"cancel"===t||"submit"===t}(0,e)){var l=xC(n.name,e),d=v(v({},n),{borderless:!1});return yC(d,l,o.shared.providers,[])}console.error("Unknown footer button type: ",e)},SC=function(n,t){var e,o,r=xC(n.name,"custom");return e=O.none(),o=Fy.parts.field(v({factory:op},bC(n,O.some(r),t,[nk(""),LS()]))),Hy(e,o,[],[])},kC=o([re("field1Name","field1"),re("field2Name","field2"),la("onLockedChange"),aa(["lockClass"]),re("locked",!1),Vf("coupledFieldBehaviours",[Xl,Mf])]),CC=function(n,t){return sl({factory:Fy,name:n,overrides:function(n){return{fieldBehaviours:Qa([ig("coupled-input-behaviour",[$o(input(),(function(e){(function(n,t,e){return Cl(n,t,e).bind(Xl.getCurrent)})(e,n,t).each((function(t){Cl(e,n,"lock").each((function(o){Sg.isOn(o)&&n.onLockedChange(e,t,o)}))}))}))])])}}})},OC=o([CC("field1","field2"),CC("field2","field1"),sl({factory:op,schema:[Wt("dom")],name:"lock",overrides:function(n){return{buttonBehaviours:Qa([Sg.config({selected:n.locked,toggleClass:n.markers.lockClass,aria:{mode:"pressed"}})])}}})]),_C=Nl({name:"FormCoupledInputs",configFields:kC(),partFields:OC(),factory:function(n,t,e,o){return{uid:n.uid,dom:n.dom,components:t,behaviours:Pf(n.coupledFieldBehaviours,[Xl.config({find:O.some}),Mf.config({store:{mode:"manual",getValue:function(t){var e,o=Dl(t,n,["field1","field2"]);return(e={})[n.field1Name]=Mf.getValue(o.field1()),e[n.field2Name]=Mf.getValue(o.field2()),e},setValue:function(t,e){var o=Dl(t,n,["field1","field2"]);Rn(e,n.field1Name)&&Mf.setValue(o.field1(),e[n.field1Name]),Rn(e,n.field2Name)&&Mf.setValue(o.field2(),e[n.field2Name])}}})]),apis:{getField1:function(component){return Cl(component,n,"field1")},getField2:function(component){return Cl(component,n,"field2")},getLock:function(component){return Cl(component,n,"lock")}}}},apis:{getField1:function(n,component){return n.getField1(component)},getField2:function(n,component){return n.getField2(component)},getLock:function(n,component){return n.getLock(component)}}}),TC=function(n){var t=/^\s*(\d+(?:\.\d+)?)\s*(|cm|mm|in|px|pt|pc|em|ex|ch|rem|vw|vh|vmin|vmax|%)\s*$/.exec(n);if(null!==t){var e=parseFloat(t[1]),o=t[2];return ln.value({value:e,unit:o})}return ln.error(n)},EC=function(n,t){var e={"":96,px:96,pt:72,cm:2.54,pc:12,mm:25.4,in:1},o=function(u){return Object.prototype.hasOwnProperty.call(e,u)};return n.unit===t?O.some(n.value):o(n.unit)&&o(t)?e[n.unit]===e[t]?O.some(n.value):O.some(n.value/e[n.unit]*e[t]):O.none()},DC=function(n){return O.none()},BC=function(n,t){var e,o,r,c=TC(n).toOptional(),f=TC(t).toOptional();return(e=c,o=f,r=function(n,t){return EC(n,t.unit).map((function(n){return t.value/n})).map((function(n){return function(n,t){return function(e){return EC(e,t).map((function(e){return{value:e*n,unit:t}}))}}(n,t.unit)})).getOr(DC)},e.isSome()&&o.isSome()?O.some(r(e.getOrDie(),o.getOrDie())):O.none()).getOr(DC)},AC=function(n,t){var e=DC,o=Yr("ratio-event"),r=_C.parts.lock({dom:{tag:"button",classes:["tox-lock","tox-button","tox-button--naked","tox-button--icon"],attributes:{title:t.translate(n.label.getOr("Constrain proportions"))}},components:[{dom:{tag:"span",classes:["tox-icon","tox-lock-icon__lock"],innerHtml:ap("lock",t.icons)}},{dom:{tag:"span",classes:["tox-icon","tox-lock-icon__unlock"],innerHtml:ap("unlock",t.icons)}}],buttonBehaviours:Qa([ev.config({disabled:function(){return n.disabled||t.isDisabled()}}),Mv(),Vy.config({})])}),c=function(n){return{dom:{tag:"div",classes:["tox-form__group"]},components:n}},f=function(e){return Fy.parts.field({factory:ex,inputClasses:["tox-textfield"],inputBehaviours:Qa([ev.config({disabled:function(){return n.disabled||t.isDisabled()}}),Mv(),Vy.config({}),ig("size-input-events",[$o(uo(),(function(component,n){Uo(component,o,{isField1:e})})),$o(fo(),(function(component,t){Uo(component,jy,{name:n.name})}))])]),selectOnFocus:!1})},l=function(label){return{dom:{tag:"label",classes:["tox-label"],innerHtml:t.translate(label)}}},d=_C.parts.field1(c([Fy.parts.label(l("Width")),f(!0)])),m=_C.parts.field2(c([Fy.parts.label(l("Height")),f(!1)]));return _C.sketch({dom:{tag:"div",classes:["tox-form__group"]},components:[{dom:{tag:"div",classes:["tox-form__controls-h-stack"]},components:[d,m,c([l("&nbsp;"),r])]}],field1Name:"width",field2Name:"height",locked:!0,markers:{lockClass:"tox-locked"},onLockedChange:function(n,t,o){TC(Mf.getValue(n)).each((function(n){e(n).each((function(n){Mf.setValue(t,function(n){var t,e={"":0,px:0,pt:1,mm:1,pc:2,ex:2,em:2,ch:2,rem:2,cm:3,in:4,"%":4},o=n.value.toFixed((t=n.unit)in e?e[t]:1);return-1!==o.indexOf(".")&&(o=o.replace(/\.?0*$/,"")),o+n.unit}(n))}))}))},coupledFieldBehaviours:Qa([ev.config({disabled:function(){return n.disabled||t.isDisabled()},onDisabled:function(n){_C.getField1(n).bind(Fy.getField).each(ev.disable),_C.getField2(n).bind(Fy.getField).each(ev.disable),_C.getLock(n).each(ev.disable)},onEnabled:function(n){_C.getField1(n).bind(Fy.getField).each(ev.enable),_C.getField2(n).bind(Fy.getField).each(ev.enable),_C.getLock(n).each(ev.enable)}}),Mv(),ig("size-input-events2",[$o(o,(function(component,n){var t=n.event.isField1,o=t?_C.getField1(component):_C.getField2(component),r=t?_C.getField2(component):_C.getField1(component),c=o.map(Mf.getValue).getOr(""),f=r.map(Mf.getValue).getOr("");e=BC(c,f)}))])])})},MC={undo:o(Yr("undo")),redo:o(Yr("redo")),zoom:o(Yr("zoom")),back:o(Yr("back")),apply:o(Yr("apply")),swap:o(Yr("swap")),transform:o(Yr("transform")),tempTransform:o(Yr("temp-transform")),transformApply:o(Yr("transform-apply"))},FC=o("save-state"),IC=o("disable"),RC=o("enable"),VC={formActionEvent:Gy,saveState:FC,disable:IC,enable:RC},PC=function(n,e){var r=function(text,n,t,o){return ip(yC({name:text,text:text,disabled:t,primary:o,icon:O.none(),borderless:!1},n,e))},c=function(n,t,o,r){return ip(vC({name:n,icon:O.some(n),tooltip:O.some(t),disabled:r,primary:!1,borderless:!1},o,e))},f=function(n,t){n.map((function(n){var component=n.get(t);component.hasConfigured(ev)&&ev.disable(component)}))},l=function(n,t){n.map((function(n){var component=n.get(t);component.hasConfigured(ev)&&ev.enable(component)}))},d={tag:"div",classes:["tox-image-tools__toolbar","tox-image-tools-edit-panel"]},m=t,h=function(n,t,data){Uo(n,t,data)},v=function(component){return jo(component,VC.disable())},y=function(component){return jo(component,VC.enable())},x=function(n,t){v(n),h(n,MC.transform(),{transform:t}),y(n)},w=function(n){return function(){fn.getOpt(n).each((function(n){rg.set(n,[cn])}))}},S=function(n,t){v(n),h(n,MC.transformApply(),{transform:t,swap:w(n)}),y(n)},k=function(){return r("Back",(function(button){return h(button,MC.back(),{swap:w(button)})}),!1,!1)},C=function(){return ip({dom:{tag:"div",classes:["tox-spacer"]},behaviours:Qa([ev.config({})])})},_=function(){return r("Apply",(function(button){return h(button,MC.apply(),{swap:w(button)})}),!0,!0)},T=function(){return function(t){var rect=n.getRect();return function(n,t,e,o,r){return Lk(n,t,e,o,r)}(t,rect.x,rect.y,rect.w,rect.h)}},E=[k(),C(),r("Apply",(function(button){var t=T();S(button,t),n.hideCrop()}),!1,!0)],D=Dy.sketch({dom:d,components:E.map((function(n){return n.asSpec()})),containerBehaviours:Qa([ig("image-tools-crop-buttons-events",[$o(VC.disable(),(function(n,t){f(E,n)})),$o(VC.enable(),(function(n,t){l(E,n)}))])])}),B=ip(AC({name:"size",label:O.none(),constrain:!0,disabled:!1},e)),A=[k(),C(),B,C(),r("Apply",(function(button){B.getOpt(button).each((function(n){var t=Mf.getValue(n),e=function(n,t){return function(e){return Jk(e,n,t)}}(parseInt(t.width,10),parseInt(t.height,10));S(button,e)}))}),!1,!0)],M=Dy.sketch({dom:d,components:A.map((function(n){return n.asSpec()})),containerBehaviours:Qa([ig("image-tools-resize-buttons-events",[$o(VC.disable(),(function(n,t){f(A,n)})),$o(VC.enable(),(function(n,t){l(A,n)}))])])}),F=function(n,t){return function(e){return n(e,t)}},I=F(qk,"h"),R=F(qk,"v"),V=F(Kk,-90),P=F(Kk,90),H=function(n,t){!function(n,t){v(n),h(n,MC.tempTransform(),{transform:t}),y(n)}(n,t)},z=[k(),C(),c("flip-horizontally","Flip horizontally",(function(button){H(button,I)}),!1),c("flip-vertically","Flip vertically",(function(button){H(button,R)}),!1),c("rotate-left","Rotate counterclockwise",(function(button){H(button,V)}),!1),c("rotate-right","Rotate clockwise",(function(button){H(button,P)}),!1),C(),_()],N=Dy.sketch({dom:d,components:z.map((function(n){return n.asSpec()})),containerBehaviours:Qa([ig("image-tools-fliprotate-buttons-events",[$o(VC.disable(),(function(n,t){f(z,n)})),$o(VC.enable(),(function(n,t){l(z,n)}))])])}),L=function(label,n,t,r,c){var f=DS.parts.label({dom:{tag:"label",classes:["tox-label"],innerHtml:e.translate(label)}}),l=DS.parts.spectrum({dom:{tag:"div",classes:["tox-slider__rail"],attributes:{role:"presentation"}}}),d=DS.parts.thumb({dom:{tag:"div",classes:["tox-slider__handle"],attributes:{role:"presentation"}}});return ip(DS.sketch({dom:{tag:"div",classes:["tox-slider"],attributes:{role:"presentation"}},model:{mode:"x",minX:t,maxX:c,getInitialValue:o({x:r})},components:[f,l,d],sliderBehaviours:Qa([fg.config({})]),onChoose:n}))},j=function(label,n,t,e,o){return L(label,(function(t,e,o){var r=F(n,o.x/100);x(t,r)}),t,e,o)},U=function(label,n,t,e,o){var r=function(label,n,t,e,o){return[k(),j(label,n,t,e,o),_()]}(label,n,t,e,o);return Dy.sketch({dom:d,components:r.map((function(n){return n.asSpec()})),containerBehaviours:Qa([ig("image-tools-filter-panel-buttons-events",[$o(VC.disable(),(function(n,t){f(r,n)})),$o(VC.enable(),(function(n,t){l(r,n)}))])])})},W=[k(),C(),_()],G=Dy.sketch({dom:d,components:W.map((function(n){return n.asSpec()}))}),X=U("Brightness",Xk,-100,0,100),Y=U("Contrast",Yk,-100,0,100),J=U("Gamma",Gk,-100,0,100),K=function(n,t,e){return function(o){return function(n,t,e,o){return Rk(n,t,e,o)}(o,n,t,e)}},$=function(label){return L(label,(function(n,t,e){var o=Q.getOpt(n),r=nn.getOpt(n),c=Z.getOpt(n);o.each((function(t){r.each((function(e){c.each((function(o){var r=Mf.getValue(t).x/100,g=Mf.getValue(o).x/100,b=Mf.getValue(e).x/100,c=K(r,g,b);x(n,c)}))}))}))}),0,100,200)},Q=$("R"),Z=$("G"),nn=$("B"),tn=[k(),Q,Z,nn,_()],en=Dy.sketch({dom:d,components:tn.map((function(n){return n.asSpec()}))}),on=function(n,t,e){return function(button){h(button,MC.swap(),{transform:t,swap:function(){fn.getOpt(button).each((function(t){rg.set(t,[n]),e(t)}))}})}},rn=O.some(Wk),un=O.some(Uk),an=[c("crop","Crop",on(D,O.none(),(function(t){n.showCrop()})),!1),c("resize","Resize",on(M,O.none(),(function(t){B.getOpt(t).each((function(t){var e=n.getMeasurements(),o=e.width,r=e.height;Mf.setValue(t,{width:o,height:r})}))})),!1),c("orientation","Orientation",on(N,O.none(),m),!1),c("brightness","Brightness",on(X,O.none(),m),!1),c("sharpen","Sharpen",on(G,rn,m),!1),c("contrast","Contrast",on(Y,O.none(),m),!1),c("color-levels","Color levels",on(en,O.none(),m),!1),c("gamma","Gamma",on(J,O.none(),m),!1),c("invert","Invert",on(G,un,m),!1)],cn=Dy.sketch({dom:d,components:an.map((function(n){return n.asSpec()}))}),sn=Dy.sketch({dom:{tag:"div"},components:[cn],containerBehaviours:Qa([rg.config({})])}),fn=ip(sn);return{memContainer:fn,getApplyButton:function(n){return fn.getOpt(n).map((function(n){var t=n.components()[0];return t.components()[t.components().length-1]}))}}},HC=tinymce.util.Tools.resolve("tinymce.geom.Rect"),zC=tinymce.util.Tools.resolve("tinymce.dom.DomQuery"),NC=tinymce.util.Tools.resolve("tinymce.util.Observable"),LC=tinymce.util.Tools.resolve("tinymce.util.VK");function jC(n){var t,i;if(n.changedTouches)for(t="screenX screenY pageX pageY clientX clientY".split(" "),i=0;i<t.length;i++)n[t[i]]=n.changedTouches[0][t[i]]}function UC(n,t){var e,o,r,c,f=t.document||document,l=f.getElementById(t.handle||n),d=function(n){if(jC(n),n.button!==o)return m(n);n.deltaX=n.screenX-r,n.deltaY=n.screenY-c,n.preventDefault(),t.drag(n)},m=function(n){jC(n),zC(f).off("mousemove touchmove",d).off("mouseup touchend",m),e.remove(),t.stop&&t.stop(n)};this.destroy=function(){zC(l).off()},zC(l).on("mousedown touchstart",(function(n){var cursor,h=function(n){var t=Math.max,e=n.documentElement,body=n.body,o=t(e.scrollWidth,body.scrollWidth),r=t(e.clientWidth,body.clientWidth),c=t(e.offsetWidth,body.offsetWidth),f=t(e.scrollHeight,body.scrollHeight),l=t(e.clientHeight,body.clientHeight);return{width:o<c?r:o,height:f<t(e.offsetHeight,body.offsetHeight)?l:f}}(f);jC(n),n.preventDefault(),o=n.button;var v=l;r=n.screenX,c=n.screenY,cursor=window.getComputedStyle?window.getComputedStyle(v,null).getPropertyValue("cursor"):v.runtimeStyle.cursor,e=zC("<div></div>").css({position:"absolute",top:0,left:0,width:h.width,height:h.height,zIndex:2147483647,opacity:1e-4,cursor:cursor}).appendTo(f.body),zC(f).on("mousemove touchmove",d).on("mouseup touchend",m),t.start(n)}))}var WC=0,GC=function(n,t,e,o,r){var c,f="tox-crid-"+WC++,l=[{name:"move",xMul:0,yMul:0,deltaX:1,deltaY:1,deltaW:0,deltaH:0,label:"Crop Mask"},{name:"nw",xMul:0,yMul:0,deltaX:1,deltaY:1,deltaW:-1,deltaH:-1,label:"Top Left Crop Handle"},{name:"ne",xMul:1,yMul:0,deltaX:0,deltaY:1,deltaW:1,deltaH:-1,label:"Top Right Crop Handle"},{name:"sw",xMul:0,yMul:1,deltaX:1,deltaY:0,deltaW:-1,deltaH:1,label:"Bottom Left Crop Handle"},{name:"se",xMul:1,yMul:1,deltaX:0,deltaY:0,deltaW:1,deltaH:1,label:"Bottom Right Crop Handle"}],d=["top","right","bottom","left"],m=function(n,t){return{x:t.x-n.x,y:t.y-n.y,w:t.w,h:t.h}};function h(t,o,r,c){var f,l,d,h,rect;f=o.x,l=o.y,d=o.w,h=o.h,f+=r*t.deltaX,l+=c*t.deltaY,(d+=r*t.deltaW)<20&&(d=20),(h+=c*t.deltaH)<20&&(h=20),rect=n=HC.clamp({x:f,y:l,w:d,h:h},e,"move"===t.name),rect=m(e,rect),w.fire("updateRect",{rect:rect}),x(rect)}function v(rect){function n(n,rect){rect.h<0&&(rect.h=0),rect.w<0&&(rect.w=0),zC("#"+f+"-"+n,o).css({left:rect.x,top:rect.y,width:rect.w,height:rect.h})}YS.each(l,(function(n){zC("#"+f+"-"+n.name,o).css({left:rect.w*n.xMul+rect.x,top:rect.h*n.yMul+rect.y})})),n("top",{x:t.x,y:t.y,w:t.w,h:rect.y-t.y}),n("right",{x:rect.x+rect.w,y:rect.y,w:t.w-rect.x-rect.w+t.x,h:rect.h}),n("bottom",{x:t.x,y:rect.y+rect.h,w:t.w,h:t.h-rect.y-rect.h+t.y}),n("left",{x:t.x,y:rect.y,w:rect.x-t.x,h:rect.h}),n("move",rect)}function y(rect){v(n=rect)}function x(rect){var n,t;y((n=e,{x:(t=rect).x+n.x,y:t.y+n.y,w:t.w,h:t.h}))}zC('<div id="'+f+'" class="tox-croprect-container" role="grid" aria-dropeffect="execute">').appendTo(o),YS.each(d,(function(n){zC("#"+f,o).append('<div id="'+f+"-"+n+'"class="tox-croprect-block" style="display: none" data-mce-bogus="all">')})),YS.each(l,(function(n){zC("#"+f,o).append('<div id="'+f+"-"+n.name+'" class="tox-croprect-handle tox-croprect-handle-'+n.name+'"style="display: none" data-mce-bogus="all" role="gridcell" tabindex="-1" aria-label="'+n.label+'" aria-grabbed="false" title="'+n.label+'">')})),c=YS.map(l,(function(t){var e;return new UC(f,{document:o.ownerDocument,handle:f+"-"+t.name,start:function(){e=n},drag:function(n){h(t,e,n.deltaX,n.deltaY)}})})),v(n),zC(o).on("focusin focusout",(function(n){zC(n.target).attr("aria-grabbed","focus"===n.type?"true":"false")})),zC(o).on("keydown",(function(t){var e;function o(n,t,o,r,c){n.stopPropagation(),n.preventDefault(),h(e,o,r,c)}switch(YS.each(l,(function(n){if(t.target.id===f+"-"+n.name)return e=n,!1})),t.keyCode){case LC.LEFT:o(t,0,n,-10,0);break;case LC.RIGHT:o(t,0,n,10,0);break;case LC.UP:o(t,0,n,0,-10);break;case LC.DOWN:o(t,0,n,0,10);break;case LC.ENTER:case LC.SPACEBAR:t.preventDefault(),r()}}));var w=YS.extend({toggleVisibility:function(n){var t=YS.map(l,(function(n){return"#"+f+"-"+n.name})).concat(YS.map(d,(function(n){return"#"+f+"-"+n}))).join(",");n?zC(t,o).show():zC(t,o).hide()},setClampRect:function(rect){e=rect,v(n)},setRect:y,getInnerRect:function(){return m(e,n)},setInnerRect:x,setViewPortRect:function(rect){t=rect,v(n)},destroy:function(){YS.each(c,(function(n){n.destroy()})),c=[]}},NC);return w},XC=function(n){var t=ip({dom:{tag:"div",classes:["tox-image-tools__image-bg"],attributes:{role:"presentation"}}}),e=ge(1),o=ge(O.none()),r=ge({x:0,y:0,w:1,h:1}),c=ge({x:0,y:0,w:1,h:1}),f=function(n,img){m.getOpt(n).each((function(n){var c=e.get(),f=Cu(n.element),l=hu(n.element),d=img.dom.naturalWidth*c,m=img.dom.naturalHeight*c,h=Math.max(0,f/2-d/2),v=Math.max(0,l/2-m/2),y={left:h.toString()+"px",top:v.toString()+"px",width:d.toString()+"px",height:m.toString()+"px",position:"absolute"};Xi(img,y),t.getOpt(n).each((function(n){Xi(n.element,y)})),o.get().each((function(n){var rect=r.get();n.setRect({x:rect.x*c+h,y:rect.y*c+v,w:rect.w*c,h:rect.h*c}),n.setClampRect({x:h,y:v,w:d,h:m}),n.setViewPortRect({x:0,y:0,w:f,h:l})}))}))},l=function(n,t){var image,img=he.fromTag("img");return Pr(img,"src",t),(image=img.dom,new Cp((function(n){var t=function(){image.removeEventListener("load",t),n(image)};image.complete?n(image):image.addEventListener("load",t)}))).then((function(){return m.getOpt(n).map((function(n){var t=fu({element:img});rg.replaceAt(n,1,O.some(t));var o=c.get(),l={x:0,y:0,w:img.dom.naturalWidth,h:img.dom.naturalHeight};c.set(l);var rect=HC.inflate(l,-20,-20);return r.set(rect),o.w===l.w&&o.h===l.h||function(n,img){m.getOpt(n).each((function(n){var t=Cu(n.element),o=hu(n.element),r=img.dom.naturalWidth,c=img.dom.naturalHeight,f=Math.min(t/r,o/c);f>=1?e.set(1):e.set(f)}))}(n,img),f(n,img),img}))}))},d=Dy.sketch({dom:{tag:"div",classes:["tox-image-tools__image"]},components:[t.asSpec(),{dom:{tag:"img",attributes:{src:n}}},{dom:{tag:"div"},behaviours:Qa([ig("image-panel-crop-events",[ur((function(n){m.getOpt(n).each((function(n){var t=n.element.dom,c=GC({x:10,y:10,w:100,h:100},{x:0,y:0,w:200,h:200},{x:0,y:0,w:200,h:200},t,(function(){}));c.toggleVisibility(!1),c.on("updateRect",(function(n){var rect=n.rect,t=e.get(),o={x:Math.round(rect.x/t),y:Math.round(rect.y/t),w:Math.round(rect.w/t),h:Math.round(rect.h/t)};r.set(o)})),o.set(O.some(c))}))}))])])}],containerBehaviours:Qa([rg.config({}),ig("image-panel-events",[ur((function(t){l(t,n)}))])])}),m=ip(d);return{memContainer:m,updateSrc:l,zoom:function(n,t){var o=e.get(),r=t>0?Math.min(2,o+.1):Math.max(.1,o-.1);e.set(r),m.getOpt(n).each((function(n){var img=n.components()[1].element;f(n,img)}))},showCrop:function(){o.get().each((function(n){n.toggleVisibility(!0)}))},hideCrop:function(){o.get().each((function(n){n.toggleVisibility(!1)}))},getRect:function(){return r.get()},getMeasurements:function(){var n=c.get();return{width:n.w,height:n.h}}}},YC=function(n,t,e,o,r){return vC({name:n,icon:O.some(t),disabled:e,tooltip:O.some(n),primary:!1,borderless:!1},o,r)},qC=function(button,n){n?ev.enable(button):ev.disable(button)};var JC,KC=function(n){var t=ge(n),e=ge(O.none()),o=function(){var data=[],n=-1;function t(){return n>0}function e(){return-1!==n&&n<data.length-1}return{data:data,add:function(t){var e=data.splice(++n);return data.push(t),{state:t,removed:e}},undo:function(){if(t())return data[--n]},redo:function(){if(e())return data[++n]},canUndo:t,canRedo:e}}();o.add(n);var r=function(n){t.set(n)},c=function(n){return{blob:n,url:URL.createObjectURL(n)}},f=function(n){URL.revokeObjectURL(n.url)},l=function(){e.get().each(f),e.set(O.none())},d=function(n){var t=c(n);r(t);var e,l=o.add(t).removed;return e=l,YS.each(e,f),t.url};return{getBlobState:function(){return t.get()},setBlobState:r,addBlobState:d,getTempState:function(){return e.get().fold((function(){return t.get()}),(function(n){return n}))},updateTempState:function(n){var t=c(n);return l(),e.set(O.some(t)),t.url},addTempState:function(n){var t=c(n);return e.set(O.some(t)),t.url},applyTempState:function(n){return e.get().fold((function(){}),(function(t){d(t.blob),n()}))},destroyTempState:l,undo:function(){var n=o.undo();return r(n),n.url},redo:function(){var n=o.redo();return r(n),n.url},getHistoryStates:function(){return{undoEnabled:o.canUndo(),redoEnabled:o.canRedo()}}}},$C=function(n,e){var o=KC(n.currentState),r=function(n){var t=o.getHistoryStates();x.updateButtonUndoStates(n,t.undoEnabled,t.redoEnabled),Uo(n,VC.formActionEvent,{name:VC.saveState(),value:t.undoEnabled})},c=function(n){return n.toBlob()},f=function(n){Uo(n,VC.formActionEvent,{name:VC.disable(),value:{}})},l=function(n){w.getApplyButton(n).each((function(n){ev.enable(n)})),Uo(n,VC.formActionEvent,{name:VC.enable(),value:{}})},d=function(n,t){return f(n),y.updateSrc(n,t)},m=function(n,t,filter,e,o){return f(n),function(n){return Sk(n)}(t).then(filter).then(c).then(e).then((function(t){return d(n,t).then((function(t){return r(n),o(),l(n),t}))})).catch((function(t){return console.log(t),l(n),t}))},h=function(n,filter,t){var e=o.getBlobState().blob;m(n,e,filter,(function(n){return o.updateTempState(n)}),t)},v=function(n){var t=o.getBlobState().url;return o.destroyTempState(),r(n),t},y=XC(n.currentState.url),x=function(n){var t=ip(YC("Undo","undo",!0,(function(button){Uo(button,MC.undo(),{direction:1})}),n)),e=ip(YC("Redo","redo",!0,(function(button){Uo(button,MC.redo(),{direction:1})}),n));return{container:Dy.sketch({dom:{tag:"div",classes:["tox-image-tools__toolbar","tox-image-tools__sidebar"]},components:[t.asSpec(),e.asSpec(),YC("Zoom in","zoom-in",!1,(function(button){Uo(button,MC.zoom(),{direction:1})}),n),YC("Zoom out","zoom-out",!1,(function(button){Uo(button,MC.zoom(),{direction:-1})}),n)]}),updateButtonUndoStates:function(n,o,r){t.getOpt(n).each((function(n){qC(n,o)})),e.getOpt(n).each((function(n){qC(n,r)}))}}}(e),w=PC(y,e);return{dom:{tag:"div",attributes:{role:"presentation"}},components:[w.memContainer.asSpec(),y.memContainer.asSpec(),x.container],behaviours:Qa([Mf.config({store:{mode:"manual",getValue:function(){return o.getBlobState()}}}),ig("image-tools-events",[$o(MC.undo(),(function(n,t){var e=o.undo();d(n,e).then((function(t){l(n),r(n)}))})),$o(MC.redo(),(function(n,t){var e=o.redo();d(n,e).then((function(t){l(n),r(n)}))})),$o(MC.zoom(),(function(n,t){var e=t.event.direction;y.zoom(n,e)})),$o(MC.back(),(function(n,t){!function(n){var t=v(n);d(n,t).then((function(t){l(n)}))}(n),(0,t.event.swap)(),y.hideCrop()})),$o(MC.apply(),(function(n,t){o.applyTempState((function(){v(n),(0,t.event.swap)()}))})),$o(MC.transform(),(function(n,e){return h(n,e.event.transform,t)})),$o(MC.tempTransform(),(function(n,e){return function(n,filter){var e=o.getTempState().blob;m(n,e,filter,(function(n){return o.addTempState(n)}),t)}(n,e.event.transform)})),$o(MC.transformApply(),(function(n,t){return function(n,filter,t){var e=o.getBlobState().blob;m(n,e,filter,(function(t){var e=o.addBlobState(t);return v(n),e}),t)}(n,t.event.transform,t.event.swap)})),$o(MC.swap(),(function(n,t){!function(n){x.updateButtonUndoStates(n,!1,!1)}(n);var e=t.event.transform,o=t.event.swap;e.fold((function(){o()}),(function(t){h(n,t,o)}))}))]),LS()])}},QC=function(n){return!In(n,"items")},ZC=function(n,t,e,o){return map(e,(function(e){return QC(e)?{type:"togglemenuitem",text:e.text,value:e.value,active:e.value===o,onAction:function(){Mf.setValue(n,e.value),Uo(n,jy,{name:t}),fg.focus(n)}}:{type:"nestedmenuitem",text:e.text,getSubmenuItems:function(){return ZC(n,t,e.items,o)}}}))},nO=function(n,t){return cn(n,(function(n){return QC(n)?jl(n.value===t,n):nO(n.items,t)}))},tO=zl({name:"HtmlSelect",configFields:[Wt("options"),Ff("selectBehaviours",[fg,Mf]),re("selectClasses",[]),re("selectAttributes",{}),option("data")],factory:function(n,t){var e=map(n.options,(function(option){return{dom:{tag:"option",value:option.value,innerHtml:option.text}}})),o=n.data.map((function(n){return $n("initialValue",n)})).getOr({});return{uid:n.uid,dom:{tag:"select",classes:n.selectClasses,attributes:n.selectAttributes},components:e,behaviours:Rf(n.selectBehaviours,[fg.config({}),Mf.config({store:v({mode:"manual",getValue:function(select){return tu(select.element)},setValue:function(select,t){K(n.options,(function(n){return n.value===t})).isSome()&&eu(select.element,t)}},o)})])}}}),eO=function(n,t){var e=n.label.map((function(label){return Ly(label,t)})),r=[ev.config({disabled:function(){return n.disabled||t.isDisabled()}}),Mv(),Zm.config({mode:"execution",useEnter:!0!==n.multiline,useControlEnter:!0===n.multiline,execute:function(n){return jo(n,Xy),O.some(!0)}}),ig("textfield-change",[$o(input(),(function(component,t){Uo(component,jy,{name:n.name})})),$o(yo(),(function(component,t){Uo(component,jy,{name:n.name})}))]),Vy.config({})],c=n.validation.map((function(n){return Sx.config({getRoot:function(input){return Sr(input.element)},invalidClass:"tox-invalid",validator:{validate:function(input){var t=Mf.getValue(input),e=n.validator(t);return dx(!0===e?ln.value(t):ln.error(e))},validateOnLoad:n.validateOnLoad}})})).toArray(),f=n.placeholder.fold(o({}),(function(p){return{placeholder:t.translate(p)}})),l=n.inputMode.fold(o({}),(function(n){return{inputmode:n}})),d=v(v({},f),l),m=Fy.parts.field({tag:!0===n.multiline?"textarea":"input",inputAttributes:d,inputClasses:[n.classname],inputBehaviours:Qa(Q([r,c])),selectOnFocus:!1,factory:ex}),h=(n.flex?["tox-form__group--stretched"]:[]).concat(n.maximized?["tox-form-group--maximize"]:[]),y=[ev.config({disabled:function(){return n.disabled||t.isDisabled()},onDisabled:function(n){Fy.getField(n).each(ev.disable)},onEnabled:function(n){Fy.getField(n).each(ev.enable)}}),Mv()];return Hy(e,m,h,y)},oO=Object.freeze({__proto__:null,events:function(n,t){var e=n.stream.streams.setup(n,t);return qo([$o(n.event,e),ar((function(){return t.cancel()}))].concat(n.cancelEvent.map((function(n){return[$o(n,(function(){return t.cancel()}))]})).getOr([])))}}),rO=function(n){var t=ge(null);return fi({readState:function(){return{timer:null!==t.get()?"set":"unset"}},setTimer:function(n){t.set(n)},cancel:function(){var n=t.get();null!==n&&n.cancel()}})},iO=Object.freeze({__proto__:null,throttle:rO,init:function(n){return n.stream.streams.state(n)}}),uO=[Gt("stream",It("mode",{throttle:[Wt("delay"),re("stopEvent",!0),output("streams",{setup:function(n,t){var e=n.stream,o=mp(n.onStream,e.delay);return t.setTimer(o),function(component,n){o.throttle(component,n),e.stopEvent&&n.stop()}},state:rO})]})),re("event","input"),option("cancelEvent"),la("onStream")],aO=nc({fields:uO,name:"streaming",active:oO,state:iO}),cO=function(n,input,t){var e=Mf.getValue(t);Mf.setValue(input,e),fO(input)},sO=function(input,n){var t=input.element,e=tu(t),o=t.dom;"number"!==Hr(t,"type")&&n(o,e)},fO=function(input){sO(input,(function(n,t){return n.setSelectionRange(t.length,t.length)}))},lO=function(n,input,t){if(n.selectsOver){var e=Mf.getValue(input),o=n.getDisplayText(e),r=Mf.getValue(t);return 0===n.getDisplayText(r).indexOf(o)?O.some((function(){cO(0,input,t),function(input,n){sO(input,(function(t,e){return t.setSelectionRange(n,e.length)}))}(input,o.length)})):O.none()}return O.none()},dO=o("alloy.typeahead.itemexecute"),mO=o([option("lazySink"),Wt("fetch"),re("minChars",5),re("responseTime",1e3),sa("onOpen"),re("getHotspot",O.some),re("getAnchorOverrides",o({})),re("layouts",O.none()),re("eventOrder",{}),de("model",{},[re("getDisplayText",(function(n){return void 0!==n.meta&&void 0!==n.meta.text?n.meta.text:n.value})),re("selectsOver",!0),re("populateFromBrowse",!0)]),sa("onSetValue"),fa("onExecute"),sa("onItemExecute"),re("inputClasses",[]),re("inputAttributes",{}),re("inputStyles",{}),re("matchWidth",!0),re("useMinWidth",!1),re("dismissOnBlur",!0),aa(["openClass"]),option("initialData"),Ff("typeaheadBehaviours",[fg,Mf,aO,Zm,Sg,Ox]),me("previewing",(function(){return ge(!0)}))].concat(Qy()).concat(Px())),gO=o([fl({schema:[ua()],name:"menu",overrides:function(n){return{fakeFocus:!0,onHighlight:function(menu,t){n.previewing.get()?menu.getSystem().getByUid(n.uid).each((function(input){lO(n.model,input,t).fold((function(){return rd.dehighlight(menu,t)}),(function(n){return n()}))})):menu.getSystem().getByUid(n.uid).each((function(input){n.model.populateFromBrowse&&cO(n.model,input,t)})),n.previewing.set(!1)},onExecute:function(menu,t){return menu.getSystem().getByUid(n.uid).toOptional().map((function(n){return Uo(n,dO(),{item:t}),!0}))},onHover:function(menu,t){n.previewing.set(!1),menu.getSystem().getByUid(n.uid).each((function(input){n.model.populateFromBrowse&&cO(n.model,input,t)}))}}}})]),pO=Nl({name:"Typeahead",configFields:mO(),partFields:gO(),factory:function(n,e,o,r){var c=function(e,o,c){n.previewing.set(!1);var f=Ox.getCoupled(e,"sandbox");if(df.isOpen(f))Xl.getCurrent(f).each((function(menu){rd.getHighlighted(menu).fold((function(){c(menu)}),(function(){Yo(f,menu.element,"keydown",o)}))}));else{Dx(n,l(e),e,f,r,(function(n){Xl.getCurrent(n).each(c)}),ix.HighlightFirst).get(t)}},f=Zy(n),l=function(n){return function(t){return t.map((function(data){var t=Mn(data.menus),e=Z(t,(function(menu){return filter(menu.items,(function(n){return"item"===n.type}))}));return Mf.getState(n).update(map(e,(function(n){return n.data}))),data}))}},d=[fg.config({}),Mf.config({onSetValue:n.onSetValue,store:v({mode:"dataset",getDataKey:function(n){return tu(n.element)},getFallbackEntry:function(n){return{value:n,meta:{}}},setValue:function(t,data){eu(t.element,n.model.getDisplayText(data))}},n.initialData.map((function(n){return $n("initialValue",n)})).getOr({}))}),aO.config({stream:{mode:"throttle",delay:n.responseTime,stopEvent:!1},onStream:function(component,e){var o=Ox.getCoupled(component,"sandbox");if(fg.isFocused(component)&&tu(component.element).length>=n.minChars){var c=Xl.getCurrent(o).bind((function(menu){return rd.getHighlighted(menu).map(Mf.getValue)}));n.previewing.set(!0);Dx(n,l(component),component,o,r,(function(t){Xl.getCurrent(o).each((function(menu){c.fold((function(){n.model.selectsOver&&rd.highlightFirst(menu)}),(function(n){rd.highlightBy(menu,(function(t){return Mf.getValue(t).value===n.value})),rd.getHighlighted(menu).orThunk((function(){return rd.highlightFirst(menu),O.none()}))}))}))}),ix.HighlightFirst).get(t)}},cancelEvent:_o()}),Zm.config({mode:"special",onDown:function(n,t){return c(n,t,rd.highlightFirst),O.some(!0)},onEscape:function(n){var t=Ox.getCoupled(n,"sandbox");return df.isOpen(t)?(df.close(t),O.some(!0)):O.none()},onUp:function(n,t){return c(n,t,rd.highlightLast),O.some(!0)},onEnter:function(t){var e=Ox.getCoupled(t,"sandbox"),o=df.isOpen(e);if(o&&!n.previewing.get())return Xl.getCurrent(e).bind((function(menu){return rd.getHighlighted(menu)})).map((function(n){return Uo(t,dO(),{item:n}),!0}));var r=Mf.getValue(t);return jo(t,_o()),n.onExecute(e,t,r),o&&df.close(e),O.some(!0)}}),Sg.config({toggleClass:n.markers.openClass,aria:{mode:"expanded"}}),Ox.config({others:{sandbox:function(t){return Rx(n,t,{onOpen:function(){return Sg.on(t)},onClose:function(){return Sg.off(t)}})}}}),ig("typeaheadevents",[sr((function(e){var o=t;Ax(n,l(e),e,r,o,ix.HighlightFirst).get(t)})),$o(dO(),(function(t,e){var o=Ox.getCoupled(t,"sandbox");cO(n.model,t,e.event.item),jo(t,_o()),n.onItemExecute(t,o,e.event.item,Mf.getValue(t)),df.close(o),fO(t)}))].concat(n.dismissOnBlur?[$o(bo(),(function(n){var t=Ox.getCoupled(n,"sandbox");cc(t.element).isNone()&&df.close(t)}))]:[]))];return{uid:n.uid,dom:tx(zn(n,{inputAttributes:{role:"combobox","aria-autocomplete":"list","aria-haspopup":"true"}})),behaviours:v(v({},f),Rf(n.typeaheadBehaviours,d)),eventOrder:n.eventOrder}}}),hO=function(n){return v(v({},n),{toCached:function(){return hO(n.toCached())},bindFuture:function(t){return hO(n.bind((function(n){return n.fold((function(n){return dx(ln.error(n))}),(function(a){return t(a)}))})))},bindResult:function(t){return hO(n.map((function(n){return n.bind(t)})))},mapResult:function(t){return hO(n.map((function(n){return n.map(t)})))},mapError:function(t){return hO(n.map((function(n){return n.mapError(t)})))},foldResult:function(t,e){return n.map((function(n){return n.fold(t,e)}))},withTimeout:function(t,e){return hO(lx((function(o){var r=!1,c=setTimeout((function(){r=!0,o(ln.error(e()))}),t);n.get((function(n){r||(clearTimeout(c),o(n))}))})))}})},vO=function(n){return hO(lx(n))},bO=vO,yO={type:"separator"},xO=function(n){return{type:"menuitem",value:n.url,text:n.title,meta:{attach:n.attach},onAction:function(){}}},wO=function(title,n){return{type:"menuitem",value:n,text:title,meta:{attach:void 0},onAction:function(){}}},SO=function(n,t){return function(n){return map(n,xO)}(function(n,t){return filter(t,(function(t){return t.type===n}))}(n,t))},kO=function(n){return SO("header",n.targets)},CO=function(n){return SO("anchor",n.targets)},OO=function(n){return O.from(n.anchorTop).map((function(n){return wO("<top>",n)})).toArray()},_O=function(n){return O.from(n.anchorBottom).map((function(n){return wO("<bottom>",n)})).toArray()},TO=function(n,t){var e=n.toLowerCase();return filter(t,(function(n){var text=void 0!==n.meta&&void 0!==n.meta.text?n.meta.text:n.text;return ke(text.toLowerCase(),e)||ke(n.value.toLowerCase(),e)}))},EO=function(n,input,t){var e=Mf.getValue(input),o=void 0!==e.meta.text?e.meta.text:e.value;return t.getLinkInformation().fold((function(){return[]}),(function(e){var r,c=TO(o,function(n){return map(n,(function(n){return wO(n,n)}))}(t.getHistory(n)));return"file"===n?(r=[c,TO(o,kO(e)),TO(o,Q([OO(e),CO(e),_O(e)]))],J(r,(function(a,b){return 0===a.length||0===b.length?a.concat(b):a.concat(yO,b)}),[])):c}))},DO=Yr("aria-invalid"),BO=function(n){return function(t,e,o){return Fn(e,"name").fold((function(){return n(e,o)}),(function(r){return t.field(r,n(e,o))}))}},AO={bar:BO((function(n,t){return function(n,t){return{dom:{tag:"div",classes:["tox-bar","tox-form__controls-h-stack"]},components:map(n.items,t.interpreter)}}(n,t.shared)})),collection:BO((function(n,t){return $y(n,t.shared.providers)})),alertbanner:BO((function(n,t){return function(n,t){return Dy.sketch({dom:{tag:"div",attributes:{role:"alert"},classes:["tox-notification","tox-notification--in","tox-notification--"+n.level]},components:[{dom:{tag:"div",classes:["tox-notification__icon"]},components:[op.sketch({dom:{tag:"button",classes:["tox-button","tox-button--naked","tox-button--icon"],innerHtml:ap(n.icon,t.icons),attributes:{title:t.translate(n.iconTooltip)}},action:function(t){Uo(t,Gy,{name:"alert-banner",value:n.url})}})]},{dom:{tag:"div",classes:["tox-notification__body"],innerHtml:t.translate(n.text)}}]})}(n,t.shared.providers)})),input:BO((function(n,t){return function(n,t){return eO({name:n.name,multiline:!1,label:n.label,inputMode:n.inputMode,placeholder:n.placeholder,flex:!1,disabled:n.disabled,classname:"tox-textfield",validation:O.none(),maximized:n.maximized},t)}(n,t.shared.providers)})),textarea:BO((function(n,t){return function(n,t){return eO({name:n.name,multiline:!0,label:n.label,inputMode:O.none(),placeholder:n.placeholder,flex:!0,disabled:n.disabled,classname:"tox-textarea",validation:O.none(),maximized:n.maximized},t)}(n,t.shared.providers)})),label:BO((function(n,t){return function(n,t){var label={dom:{tag:"label",innerHtml:t.providers.translate(n.label),classes:["tox-label"]}},e=map(n.items,t.interpreter);return{dom:{tag:"div",classes:["tox-form__group"]},components:[label].concat(e),behaviours:Qa([LS(),rg.config({}),ZS(O.none()),Zm.config({mode:"acyclic"})])}}(n,t.shared)})),iframe:function(n){return function(t,e,o){var r=zn(e,{source:"dynamic"});return BO(n)(t,r,o)}}((function(n,t){return fk(n,t.shared.providers)})),button:BO((function(n,t){return SC(n,t.shared.providers)})),checkbox:BO((function(n,t){return function(n,t){var e=Mf.config({store:{mode:"manual",getValue:function(n){return n.element.dom.checked},setValue:function(n,t){n.element.dom.checked=t}}}),o=function(n){return n.element.dom.click(),O.some(!0)},c=Fy.parts.field({factory:{sketch:r},dom:{tag:"input",classes:["tox-checkbox__input"],attributes:{type:"checkbox"}},behaviours:Qa([LS(),ev.config({disabled:function(){return n.disabled||t.isDisabled()}}),Vy.config({}),fg.config({}),e,Zm.config({mode:"special",onEnter:o,onSpace:o,stopSpaceKeyup:!0}),ig("checkbox-events",[$o(fo(),(function(component,t){Uo(component,jy,{name:n.name})}))])])}),f=Fy.parts.label({dom:{tag:"span",classes:["tox-checkbox__label"],innerHtml:t.translate(n.label)},behaviours:Qa([jx.config({})])}),l=function(n){return{dom:{tag:"span",classes:["tox-icon","tox-checkbox-icon__"+n],innerHtml:ap("checked"===n?"selected":"unselected",t.icons)}}},d=ip({dom:{tag:"div",classes:["tox-checkbox__icons"]},components:[l("checked"),l("unchecked")]});return Fy.sketch({dom:{tag:"label",classes:["tox-checkbox"]},components:[c,d.asSpec(),f],fieldBehaviours:Qa([ev.config({disabled:function(){return n.disabled||t.isDisabled()},disableClass:"tox-checkbox--disabled",onDisabled:function(n){Fy.getField(n).each(ev.disable)},onEnabled:function(n){Fy.getField(n).each(ev.enable)}}),Mv()])})}(n,t.shared.providers)})),colorinput:BO((function(n,t){return Xx(n,t.shared,t.colorinput)})),colorpicker:BO((function(n){var t=function(n){return"tox-"+n},e=NS(GS,t),o=ip(e.sketch({dom:{tag:"div",classes:[t("color-picker-container")],attributes:{role:"presentation"}},onValidHex:function(form){Uo(form,Gy,{name:"hex-valid",value:!0})},onInvalidHex:function(form){Uo(form,Gy,{name:"hex-valid",value:!1})}}));return{dom:{tag:"div"},components:[o.asSpec()],behaviours:Qa([Mf.config({store:{mode:"manual",getValue:function(n){var t=o.get(n);return Xl.getCurrent(t).bind((function(n){return Mf.getValue(n).hex})).map((function(n){return"#"+n})).getOr("")},setValue:function(n,t){var e=/^#([a-fA-F0-9]{3}(?:[a-fA-F0-9]{3})?)/.exec(t),r=o.get(n);Xl.getCurrent(r).fold((function(){console.log("Can not find form")}),(function(n){Mf.setValue(n,{hex:O.from(e[1]).getOr("")}),IS.getField(n,"hex").each((function(n){jo(n,input())}))}))}}}),LS()])}})),dropzone:BO((function(n,t){return tk(n,t.shared.providers)})),grid:BO((function(n,t){return function(n,t){return{dom:{tag:"div",classes:["tox-form__grid","tox-form__grid--"+n.columns+"col"]},components:map(n.items,t.interpreter)}}(n,t.shared)})),listbox:BO((function(n,e){return function(n,e){var r=e.shared.providers,c=head(n.items).filter(QC),f=n.label.map((function(label){return Ly(label,r)})),l={dom:{tag:"div",classes:["tox-listboxfield"]},components:[Fy.parts.field({dom:{},factory:{sketch:function(r){return iC({uid:r.uid,text:c.map((function(n){return n.text})),icon:O.none(),tooltip:n.label,role:O.none(),fetch:function(t,o){var r=ZC(t,n.name,n.items,Mf.getValue(t));o(lC(r,Kp.CLOSE_ON_EXECUTE,e,!1))},onSetup:o(t),getApi:o({}),columns:1,presets:"normal",classes:[],dropdownBehaviours:[Vy.config({}),Mf.config({store:{mode:"manual",initialValue:c.map((function(n){return n.value})).getOr(""),getValue:function(n){return Hr(n.element,"data-value")},setValue:function(t,data){nO(n.items,data).each((function(n){Pr(t.element,"data-value",n.value),Uo(t,oC,{text:n.text})}))}}})]},"tox-listbox",e.shared)}}})]};return Fy.sketch({dom:{tag:"div",classes:["tox-form__group"]},components:Q([f.toArray(),[l]]),fieldBehaviours:Qa([ev.config({disabled:o(n.disabled),onDisabled:function(n){Fy.getField(n).each(ev.disable)},onEnabled:function(n){Fy.getField(n).each(ev.enable)}})])})}(n,e)})),selectbox:BO((function(n,t){return function(n,t){var e=map(n.items,(function(n){return{text:t.translate(n.text),value:n.value}})),o=n.label.map((function(label){return Ly(label,t)})),r=Fy.parts.field({dom:{},selectAttributes:{size:n.size},options:e,factory:tO,selectBehaviours:Qa([ev.config({disabled:function(){return n.disabled||t.isDisabled()}}),Vy.config({}),ig("selectbox-change",[$o(fo(),(function(component,t){Uo(component,jy,{name:n.name})}))])])}),c=n.size>1?O.none():O.some({dom:{tag:"div",classes:["tox-selectfield__icon-js"],innerHtml:ap("chevron-down",t.icons)}}),f={dom:{tag:"div",classes:["tox-selectfield"]},components:Q([[r],c.toArray()])};return Fy.sketch({dom:{tag:"div",classes:["tox-form__group"]},components:Q([o.toArray(),[f]]),fieldBehaviours:Qa([ev.config({disabled:function(){return n.disabled||t.isDisabled()},onDisabled:function(n){Fy.getField(n).each(ev.disable)},onEnabled:function(n){Fy.getField(n).each(ev.enable)}}),Mv()])})}(n,t.shared.providers)})),sizeinput:BO((function(n,t){return AC(n,t.shared.providers)})),urlinput:BO((function(n,e){return function(n,e,o){var r,c=e.shared.providers,f=function(component){var t=Mf.getValue(component);o.addToHistory(t.value,n.filetype)},l=Fy.parts.field({factory:pO,dismissOnBlur:!0,inputClasses:["tox-textfield"],sandboxClasses:["tox-dialog__popups"],inputAttributes:{"aria-errormessage":DO,type:"url"},minChars:0,responseTime:0,fetch:function(input){var t=EO(n.filetype,input,o),r=lC(t,Kp.BUBBLE_TO_SANDBOX,e,!1);return dx(r)},getHotspot:function(n){return w.getOpt(n)},onSetValue:function(n,e){n.hasConfigured(Sx)&&Sx.run(n).get(t)},typeaheadBehaviours:Qa(Q([o.getValidationHandler().map((function(t){return Sx.config({getRoot:function(n){return Sr(n.element)},invalidClass:"tox-control-wrap--status-invalid",notify:{onInvalid:function(n,t){m.getOpt(n).each((function(n){Pr(n.element,"title",c.translate(t))}))}},validator:{validate:function(input){var e=Mf.getValue(input);return bO((function(o){t({type:n.filetype,url:e.value},(function(n){if("invalid"===n.status){var t=ln.error(n.message);o(t)}else{var e=ln.value(n.message);o(e)}}))}))},validateOnLoad:!1}})})).toArray(),[ev.config({disabled:function(){return n.disabled||c.isDisabled()}}),Vy.config({}),ig("urlinput-events",Q(["file"===n.filetype?[$o(input(),(function(t){Uo(t,jy,{name:n.name})}))]:[],[$o(fo(),(function(t){Uo(t,jy,{name:n.name}),f(t)})),$o(yo(),(function(t){Uo(t,jy,{name:n.name}),f(t)}))]]))]])),eventOrder:(r={},r[input()]=["streaming","urlinput-events","invalidating"],r),model:{getDisplayText:function(n){return n.value},selectsOver:!1,populateFromBrowse:!1},markers:{openClass:"tox-textfield--popup-open"},lazySink:e.shared.getSink,parts:{menu:sh(0,0,"normal")},onExecute:function(n,component,t){Uo(component,Xy,{})},onItemExecute:function(t,e,o,r){f(t),Uo(t,jy,{name:n.name})}}),d=n.label.map((function(label){return Ly(label,c)})),m=ip(function(n,t,e,label){return void 0===e&&(e=n),void 0===label&&(label=n),{dom:{tag:"div",classes:["tox-icon","tox-control-wrap__status-icon-"+n],innerHtml:ap(e,c.icons),attributes:v({title:c.translate(label),"aria-live":"polite"},t.fold((function(){return{}}),(function(n){return{id:n}})))}}}("invalid",O.some(DO),"warning")),h=ip({dom:{tag:"div",classes:["tox-control-wrap__status-icon-wrap"]},components:[m.asSpec()]}),y=o.getUrlPicker(n.filetype),x=Yr("browser.url.event"),w=ip({dom:{tag:"div",classes:["tox-control-wrap"]},components:[l,h.asSpec()],behaviours:Qa([ev.config({disabled:function(){return n.disabled||c.isDisabled()}})])}),S=ip(yC({name:n.name,icon:O.some("browse"),text:n.label.getOr(""),disabled:n.disabled,primary:!1,borderless:!0},(function(component){return jo(component,x)}),c,[],["tox-browse-url"]));return Fy.sketch({dom:Ny([]),components:d.toArray().concat([{dom:{tag:"div",classes:["tox-form__controls-h-stack"]},components:Q([[w.asSpec()],y.map((function(){return S.asSpec()})).toArray()])}]),fieldBehaviours:Qa([ev.config({disabled:function(){return n.disabled||c.isDisabled()},onDisabled:function(n){Fy.getField(n).each(ev.disable),S.getOpt(n).each(ev.disable)},onEnabled:function(n){Fy.getField(n).each(ev.enable),S.getOpt(n).each(ev.enable)}}),Mv(),ig("url-input-events",[$o(x,(function(t){Xl.getCurrent(t).each((function(e){var o=Mf.getValue(e),r=v({fieldname:n.name},o);y.each((function(o){o(r).get((function(o){Mf.setValue(e,o),Uo(t,jy,{name:n.name})}))}))}))}))])])})}(n,e,e.urlinput)})),customeditor:BO((function(n){var t=ge(O.none()),e=ip({dom:{tag:n.tag}}),o=ge(O.none());return{dom:{tag:"div",classes:["tox-custom-editor"]},behaviours:Qa([ig("custom-editor-events",[ur((function(component){e.getOpt(component).each((function(e){(!function(n){return Object.prototype.hasOwnProperty.call(n,"init")}(n)?XS.load(n.scriptId,n.scriptUrl).then((function(t){return t(e.element.dom,n.settings)})):n.init(e.element.dom)).then((function(n){o.get().each((function(t){n.setValue(t)})),o.set(O.none()),t.set(O.some(n))}))}))}))]),Mf.config({store:{mode:"manual",getValue:function(){return t.get().fold((function(){return o.get().getOr("")}),(function(n){return n.getValue()}))},setValue:function(component,n){t.get().fold((function(){o.set(O.some(n))}),(function(t){return t.setValue(n)}))}}}),LS()]),components:[e.asSpec()]}})),htmlpanel:BO((function(n){return"presentation"===n.presets?Dy.sketch({dom:{tag:"div",classes:["tox-form__group"],innerHtml:n.html}}):Dy.sketch({dom:{tag:"div",classes:["tox-form__group"],innerHtml:n.html,attributes:{role:"document"}},containerBehaviours:Qa([Vy.config({}),fg.config({})])})})),imagetools:BO((function(n,t){return $C(n,t.shared.providers)})),table:BO((function(n,t){return function(n,t){var e,header,o=function(text){return{dom:{tag:"th",innerHtml:t.translate(text)}}},r=function(text){return{dom:{tag:"td",innerHtml:t.translate(text)}}},c=function(n){return{dom:{tag:"tr"},components:map(n,r)}};return{dom:{tag:"table",classes:["tox-dialog__table"]},components:[(header=n.header,{dom:{tag:"thead"},components:[{dom:{tag:"tr"},components:map(header,o)}]}),(e=n.cells,{dom:{tag:"tbody"},components:map(e,c)})],behaviours:Qa([Vy.config({}),fg.config({})])}}(n,t.shared.providers)})),panel:BO((function(n,t){return function(n,t){return{dom:{tag:"div",classes:n.classes},components:map(n.items,t.shared.interpreter)}}(n,t)}))},MO={field:function(n,t){return t}},FO=function(n,t,e){var o=zn(e,{shared:{interpreter:function(t){return IO(n,t,o)}}});return IO(n,t,o)},IO=function(n,t,e){return Fn(AO,t.type).fold((function(){return console.error('Unknown factory type "'+t.type+'", defaulting to container: ',t),t}),(function(o){return o(n,t,e)}))},RO={valignCentre:[],alignCentre:[],alignLeft:[],alignRight:[],right:[],left:[],bottom:[],top:[]},VO=function(n,t,e){var o=Mc(-12,12,RO),r={maxHeightFunction:Ec()};return function(){return e()?{anchor:"node",root:Pi(n()),node:O.from(n()),bubble:o,layouts:{onRtl:function(){return[Zg]},onLtr:function(){return[Qg]}},overrides:r}:{anchor:"hotspot",hotspot:t(),bubble:o,layouts:{onRtl:function(){return[Ma]},onLtr:function(){return[Fa]}},overrides:r}}},PO=function(n,t,e){return function(){return e()?{anchor:"node",root:Pi(n()),node:O.from(n()),layouts:{onRtl:function(){return[np]},onLtr:function(){return[np]}}}:{anchor:"hotspot",hotspot:t(),layouts:{onRtl:function(){return[Pa]},onLtr:function(){return[Pa]}}}}},HO=function(n,t){return function(){return{anchor:"selection",root:t(),getSelection:function(){var t=n.selection.getRng();return O.some(Xc.range(he.fromDom(t.startContainer),t.startOffset,he.fromDom(t.endContainer),t.endOffset))}}}},zO=function(n){return function(element){return{anchor:"node",root:n(),node:element}}},NO=function(n,t,e){var o=wv(n),r=function(){return he.fromDom(n.getBody())},c=function(){return he.fromDom(n.getContentAreaContainer())},f=function(){return o||!e()};return{inlineDialog:VO(c,t,f),banner:PO(c,t,f),cursor:HO(n,r),node:zO(r)}},LO=function(n){return function(t,e){Nb(n)(t,e)}},jO=function(n){return function(){return Bb(n)}},UO=function(n){return function(){return Ab(n)}},WO=function(n){return function(){return Fb(n)}},GO=function(n){return{colorPicker:LO(n),hasCustomColors:jO(n),getColors:UO(n),getColorCols:WO(n)}},XO=function(n){return function(){return function(n){return n.getParam("draggable_modal",!1,"boolean")}(n)}},YO=function(n){return{isDraggableModal:XO(n)}},qO=[{title:"Headings",items:[{title:"Heading 1",format:"h1"},{title:"Heading 2",format:"h2"},{title:"Heading 3",format:"h3"},{title:"Heading 4",format:"h4"},{title:"Heading 5",format:"h5"},{title:"Heading 6",format:"h6"}]},{title:"Inline",items:[{title:"Bold",format:"bold"},{title:"Italic",format:"italic"},{title:"Underline",format:"underline"},{title:"Strikethrough",format:"strikethrough"},{title:"Superscript",format:"superscript"},{title:"Subscript",format:"subscript"},{title:"Code",format:"code"}]},{title:"Blocks",items:[{title:"Paragraph",format:"p"},{title:"Blockquote",format:"blockquote"},{title:"Div",format:"div"},{title:"Pre",format:"pre"}]},{title:"Align",items:[{title:"Left",format:"alignleft"},{title:"Center",format:"aligncenter"},{title:"Right",format:"alignright"},{title:"Justify",format:"alignjustify"}]}],JO=function(n){return J(n,(function(n,t){if(In(t,"items")){var e=JO(t.items);return{customFormats:n.customFormats.concat(e.customFormats),formats:n.formats.concat([{title:t.title,items:e.formats}])}}if(function(n){return In(n,"inline")}(t)||function(n){return In(n,"block")}(t)||function(n){return In(n,"selector")}(t)){var o="custom-"+(E(t.name)?t.name:t.title.toLowerCase());return{customFormats:n.customFormats.concat([{name:o,format:t}]),formats:n.formats.concat([{title:t.title,format:o,icon:t.icon}])}}return v(v({},n),{formats:n.formats.concat(t)})}),{customFormats:[],formats:[]})},KO=function(n){return function(n){return O.from(n.getParam("style_formats")).filter(B)}(n).map((function(t){var e=function(n,t){var e=JO(t),o=function(t){G(t,(function(t){n.formatter.has(t.name)||n.formatter.register(t.name,t.format)}))};return n.formatter?o(e.customFormats):n.on("init",(function(){o(e.customFormats)})),e.formats}(n,t);return function(n){return n.getParam("style_formats_merge",!1,"boolean")}(n)?qO.concat(e):e})).getOr(qO)},$O=function(n,t,e){var o={type:"formatter",isSelected:t(n.format),getStylePreview:e(n.format)};return zn(n,o)},QO=function(n,t,e,o){var r=function(t){return map(t,(function(t){var c=Cn(t);if(Rn(t,"items")){var f=r(t.items);return zn(function(n){return zn(n,{type:"submenu"})}(t),{getStyleItems:function(){return f}})}return Rn(t,"format")?function(n){return $O(n,e,o)}(t):1===c.length&&L(c,"title")?zn(t,{type:"separator"}):function(t){var r=E(t.name)?t.name:Yr(t.title),c="custom-"+r,f={type:"formatter",format:c,isSelected:e(c),getStylePreview:o(c)},l=zn(t,f);return n.formatter.register(r,l),l}(t)}))};return r(t)},ZO=function(n){var t=function(t){return function(){return n.formatter.match(t)}},e=function(t){return function(){var e=n.formatter.get(t);return void 0!==e?O.some({tag:e.length>0&&(e[0].inline||e[0].block)||"div",styles:n.dom.parseStyle(n.formatter.getCssText(t))}):O.none()}},o=function(n){var t=n.items;return void 0!==t&&t.length>0?Z(t,o):[n.format]},r=ge([]),c=ge([]),f=ge([]),l=ge([]),d=ge(!1);n.on("PreInit",(function(f){var l=KO(n),d=QO(n,l,t,e);r.set(d),c.set(Z(d,o))})),n.on("addStyleModifications",(function(r){var c=QO(n,r.items,t,e);f.set(c),d.set(r.replace),l.set(Z(c,o))}));return{getData:function(){var n=d.get()?[]:r.get(),t=f.get();return n.concat(t)},getFlattenedKeys:function(){var n=d.get()?[]:c.get(),t=l.get();return n.concat(t)}}},n_=YS.trim,t_=function(n){return function(t){if(t&&1===t.nodeType){if(t.contentEditable===n)return!0;if(t.getAttribute("data-mce-contenteditable")===n)return!0}return!1}},e_=t_("true"),o_=t_("false"),r_=function(n,title,t,e,o){return{type:n,title:title,url:t,level:e,attach:o}},i_=function(n){return n.innerText||n.textContent},u_=function(n){return function(n){return n&&"A"===n.nodeName&&void 0!==(n.id||n.name)}(n)&&c_(n)},a_=function(n){return n&&/^(H[1-6])$/.test(n.nodeName)},c_=function(n){return function(n){for(;n=n.parentNode;){var t=n.contentEditable;if(t&&"inherit"!==t)return e_(n)}return!1}(n)&&!o_(n)},s_=function(n){return a_(n)&&c_(n)},f_=function(n){var t=function(n){return n.id?n.id:Yr("h")}(n);return r_("header",i_(n),"#"+t,function(n){return a_(n)?parseInt(n.nodeName.substr(1),10):0}(n),(function(){n.id=t}))},l_=function(n){var e=n.id||n.name,o=i_(n);return r_("anchor",o||"#"+e,"#"+e,0,t)},d_=function(n){var t,e;return t="h1,h2,h3,h4,h5,h6,a:not([href])",e=n,map(rs(he.fromDom(e),t),(function(element){return element.dom}))},m_=function(n){return n_(n.title).length>0},g_=function(n){var t=d_(n);return filter(function(n){return map(filter(n,s_),f_)}(t).concat(function(n){return map(filter(n,u_),l_)}(t)),m_)},p_="tinymce-url-history",h_=function(n){return E(n)&&/^https?/.test(n)},v_=function(n){return D(n)&&An(n,(function(n){return!(B(a=n)&&a.length<=5&&nn(a,h_));var a})).isNone()},b_=function(){var n,t=_b.getItem(p_);if(null===t)return{};try{n=JSON.parse(t)}catch(n){if(n instanceof SyntaxError)return console.log("Local storage "+p_+" was not valid JSON",n),{};throw n}return v_(n)?n:(console.log("Local storage "+p_+" was not valid format",n),{})},y_=function(n){var t=b_();return Object.prototype.hasOwnProperty.call(t,n)?t[n]:[]},x_=function(n,t){if(h_(n)){var e=b_(),o=Object.prototype.hasOwnProperty.call(e,t)?e[t]:[],r=filter(o,(function(t){return t!==n}));e[t]=[n].concat(r).slice(0,5),function(n){if(!v_(n))throw new Error("Bad format for history:\n"+JSON.stringify(n));_b.setItem(p_,JSON.stringify(n))}(e)}},w_=function(n){return!!n},S_=function(n){return Tn(YS.makeMap(n,/[, ]/),w_)},k_=function(n){return O.from(function(n){return n.getParam("file_picker_callback")}(n)).filter(I)},C_=function(n,t){var e=function(n){var t=O.some(function(n){return n.getParam("file_picker_types")}(n)).filter(w_),e=O.some(function(n){return n.getParam("file_browser_callback_types")}(n)).filter(w_),o=t.or(e).map(S_);return k_(n).fold((function(){return!1}),(function(n){return o.fold((function(){return!0}),(function(n){return Cn(n).length>0&&n}))}))}(n);return A(e)?e?k_(n):O.none():e[t]?k_(n):O.none()},O_=function(n){return O.from(n).filter(E).getOrUndefined()},__=function(n){return{getHistory:y_,addToHistory:x_,getLinkInformation:function(){return function(n){return function(n){return!1===n.getParam("typeahead_urls")}(n)?O.none():O.some({targets:g_(n.getBody()),anchorTop:O_(Tv(n)),anchorBottom:O_(Ev(n))})}(n)},getValidationHandler:function(){return function(n){return O.from(function(n){var t=n.getParam("file_picker_validator_handler",void 0,"function");return void 0===t?n.getParam("filepicker_validator_handler",void 0,"function"):t}(n))}(n)},getUrlPicker:function(t){return function(n,t){return C_(n,t).map((function(e){return function(o){return lx((function(r){var meta=v({filetype:t,fieldname:o.fieldname},O.from(o.meta).getOr({}));e.call(n,(function(n,meta){if(!E(n))throw new Error("Expected value to be string");if(void 0!==meta&&!D(meta))throw new Error("Expected meta to be a object");r({value:n,meta:meta})}),o.value,meta)}))}}))}(n,t)}}},T_=function(n,t,e){var o=ge(!1),r=function(n){var t=ge(yv(n)?"bottom":"top");return{isPositionedAtTop:function(){return"top"===t.get()},getDockingMode:t.get,setDockingMode:t.set}}(t),c={shared:{providers:{icons:function(){return t.ui.registry.getAll().icons},menuItems:function(){return t.ui.registry.getAll().menuItems},translate:jh.translate,isDisabled:function(){return t.mode.isReadOnly()||t.ui.isDisabled()},getSetting:t.getParam.bind(t)},interpreter:function(s){return function(n,t){return IO(MO,n,t)}(s,c)},anchors:NO(t,e,r.isPositionedAtTop),header:r,getSink:function(){return ln.value(n)}},urlinput:__(t),styleselect:ZO(t),colorinput:GO(t),dialog:YO(t),isContextMenuOpen:function(){return o.get()},setContextMenuState:function(n){return o.set(n)}};return c},E_=o((function(element,n){!function(element,n){var t=ku.max(element,n,["margin-left","border-left-width","padding-left","padding-right","border-right-width","margin-right"]);Gi(element,"max-width",t+"px")}(element,Math.floor(n))})),D_=o([Wt("dom"),re("shell",!0),Ff("toolbarBehaviours",[rg])]),B_=o([ll({name:"groups",overrides:function(){return{behaviours:Qa([rg.config({})])}}})]),A_=Nl({name:"Toolbar",configFields:D_(),partFields:B_(),factory:function(n,t,e,o){var r=function(component){return n.shell?O.some(component):Cl(component,n,"groups")},c=n.shell?{behaviours:[rg.config({})],components:[]}:{behaviours:[],components:t};return{uid:n.uid,dom:n.dom,components:c.components,behaviours:Rf(n.toolbarBehaviours,c.behaviours),apis:{setGroups:function(n,t){r(n).fold((function(){throw console.error("Toolbar was defined to not be a shell, but no groups container was specified in components"),new Error("Toolbar was defined to not be a shell, but no groups container was specified in components")}),(function(n){rg.set(n,t)}))}},domModification:{attributes:{role:"group"}}}},apis:{setGroups:function(n,t,e){n.setGroups(t,e)}}}),M_=function(n,t,e){return{within:n,extra:t,withinWidth:e}},F_=function(n,t,e){var r,c=(r=function(n,t){var o=e(n);return O.some({element:n,start:t,finish:t+o,width:o})},J(n,(function(b,a){return r(a,b.len).fold(o(b),(function(n){return{len:n.finish,list:b.list.concat([n])}}))}),{len:0,list:[]}).list),f=filter(c,(function(n){return n.finish<=t})),l=Y(f,(function(n,t){return n+t.width}),0);return{within:f,extra:c.slice(f.length),withinWidth:l}},I_=function(n){return map(n,(function(n){return n.element}))},R_=function(n,t,e,o){var r=function(n,t,e){var o=F_(t,n,e);return 0===o.extra.length?O.some(o):O.none()}(n,t,e).getOrThunk((function(){return F_(t,n-e(o),e)})),c=r.within,f=r.extra,l=r.withinWidth;return 1===f.length&&f[0].width<=e(o)?function(n,t,e){var o=I_(n.concat(t));return M_(o,[],e)}(c,f,l):f.length>=1?function(n,t,e,o){var r=I_(n).concat([e]);return M_(r,I_(t),o)}(c,f,o,l):function(n,t,e){return M_(I_(n),[],e)}(c,0,l)},V_=function(n,t){var e=map(t,(function(g){return mu(g)}));A_.setGroups(n,e)},P_=function(n,t,e){var o=Ol(n,t,"primary"),r=Ox.getCoupled(n,"overflowGroup");Gi(o.element,"visibility","hidden");var c=t.builtGroups.get().concat([r]),f=cn(c,(function(n){return cc(n.element).bind((function(t){return n.getSystem().getByDom(t).toOptional()}))}));e([]),V_(o,c);var l=Cu(o.element),d=R_(l,t.builtGroups.get(),(function(n){return Cu(n.element)}),r);0===d.extra.length?(rg.remove(o,r),e([])):(V_(o,d.within),e(d.extra)),Zi(o.element,"visibility"),nu(o.element),f.each(fg.focus)},H_=o([Ff("splitToolbarBehaviours",[Ox]),me("builtGroups",(function(){return ge([])}))]),z_=o([aa(["overflowToggledClass"]),ee("getOverflowBounds"),Wt("lazySink"),me("overflowGroups",(function(){return ge([])}))].concat(H_())),N_=o([sl({factory:A_,schema:D_(),name:"primary"}),fl({schema:D_(),name:"overflow"}),fl({name:"overflow-button"}),fl({name:"overflow-group"})]),L_=o([aa(["toggledClass"]),Wt("lazySink"),Jt("fetch"),ee("getBounds"),oe("fireDismissalEventInstead",[re("event",Io())]),Hc()]),j_=o([fl({name:"button",overrides:function(n){return{dom:{attributes:{"aria-haspopup":"true"}},buttonBehaviours:Qa([Sg.config({toggleClass:n.markers.toggledClass,aria:{mode:"expanded"},toggleOnExecute:!1})])}}}),fl({factory:A_,schema:D_(),name:"toolbar",overrides:function(n){return{toolbarBehaviours:Qa([Zm.config({mode:"cyclic",onEscape:function(t){return Cl(t,n,"button").each(fg.focus),O.none()}})])}}})]),U_=function(button,n){var t=Ox.getCoupled(button,"toolbarSandbox");df.isOpen(t)?df.close(t):df.open(t,n.toolbar())},W_=function(button,n,t,e){var o=t.getBounds.map((function(n){return n()})),r=t.lazySink(button).getOrDie();Us.positionWithinBounds(r,{anchor:"hotspot",hotspot:button,layouts:e,overrides:{maxWidthFunction:E_()}},n,o)},G_=function(button,n,t,e,o){A_.setGroups(n,o),W_(button,n,t,e),Sg.on(button)},X_=Nl({name:"FloatingToolbarButton",factory:function(n,t,e,o){return v(v({},op.sketch(v(v({},o.button()),{action:function(button){U_(button,o)},buttonBehaviours:Pf({dump:o.button().buttonBehaviours},[Ox.config({others:{toolbarSandbox:function(button){return function(button,n,t){var e=qu();return{dom:{tag:"div",attributes:{id:e.id}},behaviours:Qa([Zm.config({mode:"special",onEscape:function(n){return df.close(n),O.some(!0)}}),df.config({onOpen:function(o,r){t.fetch().get((function(o){G_(button,r,t,n.layouts,o),e.link(button.element),Zm.focusIn(r)}))},onClose:function(){Sg.off(button),fg.focus(button),e.unlink(button.element)},isPartOf:function(n,data,t){return Ku(data,t)||Ku(button,t)},getAttachPoint:function(){return t.lazySink(button).getOrDie()}}),rc.config({channels:v(v({},vf(v({isExtraPart:d},t.fireDismissalEventInstead.map((function(n){return{fireEventInstead:{event:n.event}}})).getOr({})))),yf({doReposition:function(){df.getState(Ox.getCoupled(button,"toolbarSandbox")).each((function(e){W_(button,e,t,n.layouts)}))}}))})])}}(button,e,n)}}})])}))),{apis:{setGroups:function(button,t){df.getState(Ox.getCoupled(button,"toolbarSandbox")).each((function(o){G_(button,o,n,e.layouts,t)}))},reposition:function(button){df.getState(Ox.getCoupled(button,"toolbarSandbox")).each((function(t){W_(button,t,n,e.layouts)}))},toggle:function(button){U_(button,o)},getToolbar:function(button){return df.getState(Ox.getCoupled(button,"toolbarSandbox"))},isOpen:function(button){return df.isOpen(Ox.getCoupled(button,"toolbarSandbox"))}}})},configFields:L_(),partFields:j_(),apis:{setGroups:function(n,button,t){n.setGroups(button,t)},reposition:function(n,button){n.reposition(button)},toggle:function(n,button){n.toggle(button)},getToolbar:function(n,button){return n.getToolbar(button)},isOpen:function(n,button){return n.isOpen(button)}}}),Y_=o([Wt("items"),aa(["itemSelector"]),Ff("tgroupBehaviours",[Zm])]),q_=o([ml({name:"items",unit:"item"})]),J_=Nl({name:"ToolbarGroup",configFields:Y_(),partFields:q_(),factory:function(n,t,e,o){return{uid:n.uid,dom:n.dom,components:t,behaviours:Rf(n.tgroupBehaviours,[Zm.config({mode:"flow",selector:n.markers.itemSelector})]),domModification:{attributes:{role:"toolbar"}}}}}),K_=function(n){return map(n,(function(g){return mu(g)}))},$_=function(n,t,e){P_(n,e,(function(o){e.overflowGroups.set(o),t.getOpt(n).each((function(n){X_.setGroups(n,K_(o))}))}))},Q_=Nl({name:"SplitFloatingToolbar",configFields:z_(),partFields:N_(),factory:function(n,t,e,o){var r=ip(X_.sketch({fetch:function(){return lx((function(t){t(K_(n.overflowGroups.get()))}))},layouts:{onLtr:function(){return[Fa,Ma]},onRtl:function(){return[Ma,Fa]},onBottomLtr:function(){return[Ra,Ia]},onBottomRtl:function(){return[Ia,Ra]}},getBounds:e.getOverflowBounds,lazySink:n.lazySink,fireDismissalEventInstead:{},markers:{toggledClass:n.markers.overflowToggledClass},parts:{button:o["overflow-button"](),toolbar:o.overflow()}}));return{uid:n.uid,dom:n.dom,components:t,behaviours:Rf(n.splitToolbarBehaviours,[Ox.config({others:{overflowGroup:function(){return J_.sketch(v(v({},o["overflow-group"]()),{items:[r.asSpec()]}))}}})]),apis:{setGroups:function(t,e){n.builtGroups.set(map(e,t.getSystem().build)),$_(t,r,n)},refresh:function(t){return $_(t,r,n)},toggle:function(n){r.getOpt(n).each((function(n){X_.toggle(n)}))},isOpen:function(n){return r.getOpt(n).map(X_.isOpen).getOr(!1)},reposition:function(n){r.getOpt(n).each((function(n){X_.reposition(n)}))},getOverflow:function(n){return r.getOpt(n).bind(X_.getToolbar)}},domModification:{attributes:{role:"group"}}}},apis:{setGroups:function(n,t,e){n.setGroups(t,e)},refresh:function(n,t){n.refresh(t)},reposition:function(n,t){n.reposition(t)},toggle:function(n,t){n.toggle(t)},isOpen:function(n,t){return n.isOpen(t)},getOverflow:function(n,t){return n.getOverflow(t)}}}),Z_=function(component,n){return n.getAnimationRoot.fold((function(){return component.element}),(function(n){return n(component)}))},nT=function(n){return n.dimension.property},tT=function(n,t){return n.dimension.getDimension(t)},eT=function(component,n){var t=Z_(component,n);Ai(t,[n.shrinkingClass,n.growingClass])},oT=function(component,n){Ei(component.element,n.openClass),_i(component.element,n.closedClass),Gi(component.element,nT(n),"0px"),nu(component.element)},rT=function(component,n){Ei(component.element,n.closedClass),_i(component.element,n.openClass),Zi(component.element,nT(n))},iT=function(component,n,t,e){t.setCollapsed(),Gi(component.element,nT(n),tT(n,component.element)),nu(component.element),eT(component,n),oT(component,n),n.onStartShrink(component),n.onShrunk(component)},uT=function(component,n,t,e){var o=e.getOrThunk((function(){return tT(n,component.element)}));t.setCollapsed(),Gi(component.element,nT(n),o),nu(component.element);var r=Z_(component,n);Ei(r,n.growingClass),_i(r,n.shrinkingClass),oT(component,n),n.onStartShrink(component)},aT=function(component,n,t){var e=tT(n,component.element);("0px"===e?iT:uT)(component,n,t,O.some(e))},cT=function(component,n,t){var e=Z_(component,n),o=Di(e,n.shrinkingClass),r=tT(n,component.element);rT(component,n);var c=tT(n,component.element);(o?function(){Gi(component.element,nT(n),r),nu(component.element)}:function(){oT(component,n)})(),Ei(e,n.shrinkingClass),_i(e,n.growingClass),rT(component,n),Gi(component.element,nT(n),c),t.setExpanded(),n.onStartGrow(component)},sT=function(component,n,t){var e=Z_(component,n);return!0===Di(e,n.growingClass)},fT=function(component,n,t){var e=Z_(component,n);return!0===Di(e,n.shrinkingClass)},lT=Object.freeze({__proto__:null,refresh:function(component,n,t){if(t.isExpanded()){Zi(component.element,nT(n));var e=tT(n,component.element);Gi(component.element,nT(n),e)}},grow:function(component,n,t){t.isExpanded()||cT(component,n,t)},shrink:function(component,n,t){t.isExpanded()&&aT(component,n,t)},immediateShrink:function(component,n,t){t.isExpanded()&&iT(component,n,t,O.none())},hasGrown:function(component,n,t){return t.isExpanded()},hasShrunk:function(component,n,t){return t.isCollapsed()},isGrowing:sT,isShrinking:fT,isTransitioning:function(component,n,t){return!0===sT(component,n)||!0===fT(component,n)},toggleGrow:function(component,n,t){(t.isExpanded()?aT:cT)(component,n,t)},disableTransitions:eT}),dT=Object.freeze({__proto__:null,exhibit:function(base,n,t){var e=n.expanded;return mi(e?{classes:[n.openClass],styles:{}}:{classes:[n.closedClass],styles:$n(n.dimension.property,"0px")})},events:function(n,t){return qo([ir(mo(),(function(component,e){e.event.raw.propertyName===n.dimension.property&&(eT(component,n),t.isExpanded()&&Zi(component.element,n.dimension.property),(t.isExpanded()?n.onGrown:n.onShrunk)(component))}))])}}),mT=[Wt("closedClass"),Wt("openClass"),Wt("shrinkingClass"),Wt("growingClass"),option("getAnimationRoot"),sa("onShrunk"),sa("onStartShrink"),sa("onGrown"),sa("onStartGrow"),re("expanded",!1),Gt("dimension",It("property",{width:[output("property","width"),output("getDimension",(function(n){return Cu(n)+"px"}))],height:[output("property","height"),output("getDimension",(function(n){return hu(n)+"px"}))]}))],gT=nc({fields:mT,name:"sliding",active:dT,apis:lT,state:Object.freeze({__proto__:null,init:function(n){var t=ge(n.expanded);return fi({isExpanded:function(){return!0===t.get()},isCollapsed:function(){return!1===t.get()},setCollapsed:c(t.set,!1),setExpanded:c(t.set,!0),readState:function(){return"expanded: "+t.get()}})}})}),pT=o([aa(["closedClass","openClass","shrinkingClass","growingClass","overflowToggledClass"]),sa("onOpened"),sa("onClosed")].concat(H_())),hT=o([sl({factory:A_,schema:D_(),name:"primary"}),sl({factory:A_,schema:D_(),name:"overflow",overrides:function(n){return{toolbarBehaviours:Qa([gT.config({dimension:{property:"height"},closedClass:n.markers.closedClass,openClass:n.markers.openClass,shrinkingClass:n.markers.shrinkingClass,growingClass:n.markers.growingClass,onShrunk:function(t){Cl(t,n,"overflow-button").each((function(button){Sg.off(button),fg.focus(button)})),n.onClosed(t)},onGrown:function(t){Zm.focusIn(t),n.onOpened(t)},onStartGrow:function(t){Cl(t,n,"overflow-button").each(Sg.on)}}),Zm.config({mode:"acyclic",onEscape:function(t){return Cl(t,n,"overflow-button").each(fg.focus),O.some(!0)}})])}}}),fl({name:"overflow-button",overrides:function(n){return{buttonBehaviours:Qa([Sg.config({toggleClass:n.markers.overflowToggledClass,aria:{mode:"pressed"},toggleOnExecute:!1})])}}}),fl({name:"overflow-group"})]),vT=function(n,t){Cl(n,t,"overflow-button").bind((function(){return Cl(n,t,"overflow")})).each((function(e){bT(n,t),gT.toggleGrow(e)}))},bT=function(n,t){Cl(n,t,"overflow").each((function(e){P_(n,t,(function(n){var t=map(n,(function(g){return mu(g)}));A_.setGroups(e,t)})),Cl(n,t,"overflow-button").each((function(button){gT.hasGrown(e)&&Sg.on(button)})),gT.refresh(e)}))},yT=Nl({name:"SplitSlidingToolbar",configFields:pT(),partFields:hT(),factory:function(n,t,e,o){return{uid:n.uid,dom:n.dom,components:t,behaviours:Rf(n.splitToolbarBehaviours,[Ox.config({others:{overflowGroup:function(n){return J_.sketch(v(v({},o["overflow-group"]()),{items:[op.sketch(v(v({},o["overflow-button"]()),{action:function(t){jo(n,"alloy.toolbar.toggle")}}))]}))}}}),ig("toolbar-toggle-events",[$o("alloy.toolbar.toggle",(function(t){vT(t,n)}))])]),apis:{setGroups:function(t,e){!function(t,e){var o=map(e,t.getSystem().build);n.builtGroups.set(o)}(t,e),bT(t,n)},refresh:function(t){return bT(t,n)},toggle:function(t){return vT(t,n)},isOpen:function(t){return function(n,t){return Cl(n,t,"overflow").map(gT.hasGrown).getOr(!1)}(t,n)}},domModification:{attributes:{role:"group"}}}},apis:{setGroups:function(n,t,e){n.setGroups(t,e)},refresh:function(n,t){n.refresh(t)},toggle:function(n,t){n.toggle(t)},isOpen:function(n,t){return n.isOpen(t)}}}),xT=o(Yr("toolbar-height-change")),wT=function(n){var t=n.title.fold((function(){return{}}),(function(title){return{attributes:{title:title}}}));return{dom:v({tag:"div",classes:["tox-toolbar__group"]},t),components:[J_.parts.items({})],items:n.items,markers:{itemSelector:"*:not(.tox-split-button) > .tox-tbtn:not([disabled]), .tox-split-button:not([disabled]), .tox-toolbar-nav-js:not([disabled])"},tgroupBehaviours:Qa([Vy.config({}),fg.config({})])}},ST=function(n){return J_.sketch(wT(n))},kT=function(n,t){var e=ur((function(component){var t=map(n.initGroups,ST);A_.setGroups(component,t)}));return Qa([Vv(n.providers.isDisabled),Mv(),Zm.config({mode:t,onEscape:n.onEscape,selector:".tox-toolbar__group"}),ig("toolbar-events",[e])])},CT=function(n){var t=n.cyclicKeying?"cyclic":"acyclic";return{uid:n.uid,dom:{tag:"div",classes:["tox-toolbar-overlord"]},parts:{"overflow-group":wT({title:O.none(),items:[]}),"overflow-button":hC({name:"more",icon:O.some("more-drawer"),disabled:!1,tooltip:O.some("More..."),primary:!1,borderless:!1},O.none(),n.providers)},splitToolbarBehaviours:kT(n,t)}},OT=function(n){var t=CT(n),e=Q_.parts.primary({dom:{tag:"div",classes:["tox-toolbar__primary"]}});return Q_.sketch(v(v({},t),{lazySink:n.getSink,getOverflowBounds:function(){var t=n.moreDrawerData.lazyHeader().element,e=Hu(t),o=xr(t),r=Hu(o),c=Math.max(o.dom.scrollHeight,r.height);return Vu(e.x+4,r.y,e.width-8,c)},parts:v(v({},t.parts),{overflow:{dom:{tag:"div",classes:["tox-toolbar__overflow"],attributes:n.attributes}}}),components:[e],markers:{overflowToggledClass:"tox-tbtn--enabled"}}))},_T=function(n){var t=yT.parts.primary({dom:{tag:"div",classes:["tox-toolbar__primary"]}}),e=yT.parts.overflow({dom:{tag:"div",classes:["tox-toolbar__overflow"]}}),o=CT(n);return yT.sketch(v(v({},o),{components:[t,e],markers:{openClass:"tox-toolbar__overflow--open",closedClass:"tox-toolbar__overflow--closed",growingClass:"tox-toolbar__overflow--growing",shrinkingClass:"tox-toolbar__overflow--shrinking",overflowToggledClass:"tox-tbtn--enabled"},onOpened:function(n){n.getSystem().broadcastOn([xT()],{type:"opened"})},onClosed:function(n){n.getSystem().broadcastOn([xT()],{type:"closed"})}}))},TT=function(n){var t=n.cyclicKeying?"cyclic":"acyclic";return A_.sketch({uid:n.uid,dom:{tag:"div",classes:["tox-toolbar"].concat(n.type===Jp.scrolling?["tox-toolbar--scrolling"]:[])},components:[A_.parts.groups({})],toolbarBehaviours:kT(n,t)})},ET=gt([Yt("type"),Gt("items",ht([Ot([Yt("name"),Qt("items",Ht)]),Ht]))].concat(Ip)),DT=[te("text"),te("tooltip"),te("icon"),Jt("fetch"),fe("onSetup",(function(){return t}))],BT=gt(x([Yt("type")],DT)),AT=function(n){return Dt("menubutton",BT,n)},MT=gt([Yt("type"),te("tooltip"),te("icon"),te("text"),ee("select"),Jt("fetch"),fe("onSetup",(function(){return t})),ce("presets","normal",["normal","color","listpreview"]),re("columns",1),Jt("onAction"),Jt("onItemAction")]),FT=Object.freeze({__proto__:null,events:function(n,t){var e=function(component,data){n.updateState.each((function(n){var e=n(component,data);t.set(e)})),n.renderComponents.each((function(n){var e=n(data,t.get()),o=map(e,component.getSystem().build);Ys(component,o)}))};return qo([$o(xo(),(function(component,t){var o=t;if(!o.universal){var r=n.channel;L(o.channels,r)&&e(component,o.data)}})),ur((function(t,o){n.initialData.each((function(n){e(t,n)}))}))])}}),IT=Object.freeze({__proto__:null,getState:function(component,n,t){return t}}),RT=[Wt("channel"),option("renderComponents"),option("updateState"),option("initialData")],VT=nc({fields:RT,name:"reflecting",active:FT,apis:IT,state:Object.freeze({__proto__:null,init:function(){var n=ge(O.none());return{readState:function(){return n.get().fold((function(){return"none"}),(function(n){return n}))},get:function(){return n.get()},set:function(t){return n.set(t)},clear:function(){return n.set(O.none())}}}})}),PT=o([Wt("toggleClass"),Wt("fetch"),la("onExecute"),re("getHotspot",O.some),re("getAnchorOverrides",o({})),Hc(),la("onItemExecute"),option("lazySink"),Wt("dom"),sa("onOpen"),Ff("splitDropdownBehaviours",[Ox,Zm,fg]),re("matchWidth",!1),re("useMinWidth",!1),re("eventOrder",{}),option("role")].concat(Px())),HT=sl({factory:op,schema:[Wt("dom")],name:"arrow",defaults:function(){return{buttonBehaviours:Qa([fg.revoke()])}},overrides:function(n){return{dom:{tag:"span",attributes:{role:"presentation"}},action:function(t){t.getSystem().getByUid(n.uid).each(Wo)},buttonBehaviours:Qa([Sg.config({toggleOnExecute:!1,toggleClass:n.toggleClass})])}}}),zT=sl({factory:op,schema:[Wt("dom")],name:"button",defaults:function(){return{buttonBehaviours:Qa([fg.revoke()])}},overrides:function(n){return{dom:{tag:"span",attributes:{role:"presentation"}},action:function(t){t.getSystem().getByUid(n.uid).each((function(e){n.onExecute(e,t)}))}}}}),NT=o([HT,zT,ll({factory:{sketch:function(n){return{uid:n.uid,dom:{tag:"span",styles:{display:"none"},attributes:{"aria-hidden":"true"},innerHtml:n.text}}}},schema:[Wt("text")],name:"aria-descriptor"}),fl({schema:[ua()],name:"menu",defaults:function(n){return{onExecute:function(t,e){t.getSystem().getByUid(n.uid).each((function(o){n.onItemExecute(o,t,e)}))}}}}),Tx()]),LT=Nl({name:"SplitDropdown",configFields:PT(),partFields:NT(),factory:function(n,e,o,r){var c,f=function(n){Xl.getCurrent(n).each((function(n){rd.highlightFirst(n),Zm.focusIn(n)}))},l=function(component){Ax(n,(function(n){return n}),component,r,f,ix.HighlightFirst).get(t)},d=function(t){var button=Ol(t,n,"button");return Wo(button),O.some(!0)},m=v(v({},qo([ur((function(component,t){Cl(component,n,"aria-descriptor").each((function(n){var t=Yr("aria");Pr(n.element,"id",t),Pr(component.element,"aria-describedby",t)}))}))])),Cg(O.some(l))),h={repositionMenus:function(n){Sg.isOn(n)&&Vx(n)}};return{uid:n.uid,dom:n.dom,components:e,apis:h,eventOrder:v(v({},n.eventOrder),(c={},c[wo()]=["disabling","toggling","alloy.base.behaviour"],c)),events:m,behaviours:Rf(n.splitDropdownBehaviours,[Ox.config({others:{sandbox:function(t){var e=Ol(t,n,"arrow");return Rx(n,t,{onOpen:function(){Sg.on(e),Sg.on(t)},onClose:function(){Sg.off(e),Sg.off(t)}})}}}),Zm.config({mode:"special",onSpace:d,onEnter:d,onDown:function(n){return l(n),O.some(!0)}}),fg.config({}),Sg.config({toggleOnExecute:!1,aria:{mode:"expanded"}})]),domModification:{attributes:{role:n.role.getOr("button"),"aria-haspopup":!0}}}},apis:{repositionMenus:function(n,t){return n.repositionMenus(t)}}}),jT=function(component){return{isDisabled:function(){return ev.isDisabled(component)},setDisabled:function(n){return ev.set(component,n)}}},UT=function(component){return{setActive:function(n){Sg.set(component,n)},isActive:function(){return Sg.isOn(component)},isDisabled:function(){return ev.isDisabled(component)},setDisabled:function(n){return ev.set(component,n)}}},WT=function(n,t){return n.map((function(n){return{"aria-label":t.translate(n),title:t.translate(n)}})).getOr({})},GT=Yr("focus-button"),XT=["checklist","ordered-list"],YT=["indent","outdent","table-insert-column-after","table-insert-column-before","unordered-list"],qT=function(n,text,t,e,o,r){var c,f=function(n){return jh.isRtl()&&L(XT,n)?n+"-rtl":n},l=jh.isRtl()&&n.exists((function(n){return L(YT,n)}));return{dom:{tag:"button",classes:["tox-tbtn"].concat(text.isSome()?["tox-tbtn--select"]:[]).concat(l?["tox-tbtn__icon-rtl"]:[]),attributes:WT(t,r)},components:jv([n.map((function(n){return Qk(f(n),r.icons)})),text.map((function(text){return nC(text,"tox-tbtn",r)}))]),eventOrder:(c={},c[to()]=["focusing","alloy.base.behaviour","common-button-display-events"],c),buttonBehaviours:Qa([Vv(r.isDisabled),Mv(),ig("common-button-display-events",[$o(to(),(function(button,n){n.event.prevent(),jo(button,GT)}))])].concat(e.map((function(t){return VT.config({channel:t,initialData:{icon:n,text:text},renderComponents:function(data,n){return jv([data.icon.map((function(n){return Qk(f(n),r.icons)})),data.text.map((function(text){return nC(text,"tox-tbtn",r)}))])}})})).toArray()).concat(o.getOr([])))}},JT=function(n,e,o){var r,c=ge(t),f=qT(n.icon,n.text,n.tooltip,O.none(),O.none(),o);return op.sketch({dom:f.dom,components:f.components,eventOrder:eC,buttonBehaviours:Qa([ig("toolbar-button-events",[(r={onAction:n.onAction,getApi:e.getApi},sr((function(n,t){Pv(r,n)((function(t){Uo(n,tC,{buttonApi:t}),r.onAction(t)}))}))),Hv(e,c),zv(e,c)]),Vv((function(){return n.disabled||o.isDisabled()})),Mv()].concat(e.toolbarButtonBehaviours))})},KT=function(n,t,e){return JT(n,{toolbarButtonBehaviours:[].concat(e.length>0?[ig("toolbarButtonWith",e)]:[]),getApi:jT,onSetup:n.onSetup},t)},$T=function(n,t,e){return zn(JT(n,{toolbarButtonBehaviours:[rg.config({}),Sg.config({toggleClass:"tox-tbtn--enabled",aria:{mode:"pressed"},toggleOnExecute:!1})].concat(e.length>0?[ig("toolbarToggleButtonWith",e)]:[]),getApi:UT,onSetup:n.onSetup},t))},QT=function(n,t,e){return function(o){return lx((function(n){return t.fetch(n)})).map((function(r){return O.from(cy(zn(Lb(Yr("menu-value"),r,(function(e){t.onItemAction(n(o),e)}),t.columns,t.presets,Kp.CLOSE_ON_EXECUTE,t.select.getOr((function(){return!1})),e),{movement:Ub(t.columns,t.presets),menuBehaviours:Mh("auto"!==t.columns?[]:[ur((function(n,e){Bh(n,4,oh(t.presets)).each((function(t){var e=t.numRows,o=t.numColumns;Zm.setGridSize(n,e,o)}))}))])})))}))}},ZT=function(n,t){return $o(tC,(function(e,o){var r=function(input){return{hide:function(){return jo(input,Oo())},getValue:function(){return Mf.getValue(input)}}}(n.get(e));t.onAction(r,o.event.buttonApi)}))},nE=function(n,button,t){var e={backstage:{shared:{providers:t}}};return"contextformtogglebutton"===button.type?function(n,button,t){var e=button.original,o=(e.primary,y(e,["primary"])),r=Bt(zp(v(v({},o),{type:"togglebutton",onAction:function(){}})));return $T(r,t.backstage.shared.providers,[ZT(n,button)])}(n,button,e):function(n,button,t){var e=button.original,o=(e.primary,y(e,["primary"])),r=Bt(Vp(v(v({},o),{type:"button",onAction:function(){}})));return KT(r,t.backstage.shared.providers,[ZT(n,button)])}(n,button,e)},tE=function(n,t){var e=n.label.fold((function(){return{}}),(function(label){return{"aria-label":label}})),o=ip(ex.sketch({inputClasses:["tox-toolbar-textfield","tox-toolbar-nav-js"],data:n.initValue(),inputAttributes:e,selectOnFocus:!0,inputBehaviours:Qa([Zm.config({mode:"special",onEnter:function(input){return r.findPrimary(input).map((function(n){return Wo(n),!0}))},onLeft:function(n,t){return t.cut(),O.none()},onRight:function(n,t){return t.cut(),O.none()}})])})),r=function(n,t,e){var o=map(t,(function(button){return ip(nE(n,button,e))}));return{asSpecs:function(){return map(o,(function(n){return n.asSpec()}))},findPrimary:function(n){return cn(t,(function(button,i){return button.primary?O.from(o[i]).bind((function(t){return t.getOpt(n)})).filter(f(ev.isDisabled)):O.none()}))}}}(o,n.commands,t);return[{title:O.none(),items:[o.asSpec()]},{title:O.none(),items:r.asSpecs()}]},eE=tE,oE=function(n,t){var e=Mu(window),o=Pu(he.fromDom(n.getContentAreaContainer())),r=fv(n)||lv(n)||mv(n),c=function(n,t){var e=Math.max(t.x,n.x),o=n.right-e,r=t.width-(e-t.x);return{x:e,width:Math.min(o,r)}}(o,e),f=c.x,l=c.width;if(n.inline&&!r)return Vu(f,e.y,l,e.height);var d=function(n,t,e,o){var r=he.fromDom(n.getContainer()),header=Xu(r,".tox-editor-header").getOr(r),c=Pu(header),f=c.y>=t.bottom,l=o&&!f;if(n.inline&&l)return{y:Math.max(c.bottom,e.y),bottom:e.bottom};if(n.inline&&!l)return{y:e.y,bottom:Math.min(c.y,e.bottom)};var d=Pu(r);return l?{y:Math.max(c.bottom,e.y),bottom:Math.min(d.bottom,e.bottom)}:{y:Math.max(d.y,e.y),bottom:Math.min(c.y,e.bottom)}}(n,o,e,t.header.isPositionedAtTop()),m=d.y,h=d.bottom;return Vu(f,m,l,h-m)},rE=function(n,t){var e=filter(t,(function(t){return t.predicate(n.dom)})),o=X(e,(function(n){return"contexttoolbar"===n.type}));return{contextToolbars:o.pass,contextForms:o.fail}},iE=function(n,t,e){var o=rE(n,t);if(o.contextForms.length>0)return O.some({elem:n,toolbars:[o.contextForms[0]]});var r=rE(n,e);if(r.contextForms.length>0)return O.some({elem:n,toolbars:[r.contextForms[0]]});if(o.contextToolbars.length>0||r.contextToolbars.length>0){var c=function(n){if(n.length<=1)return n;var t=function(t){return j(n,(function(n){return n.position===t}))},e=function(t){return filter(n,(function(n){return n.position===t}))},o=t("selection"),r=t("node");if(o||r){if(r&&o){var c=e("node"),f=map(e("selection"),(function(n){return v(v({},n),{position:"node"})}));return c.concat(f)}return e(o?"selection":"node")}return e("line")}(o.contextToolbars.concat(r.contextToolbars));return O.some({elem:n,toolbars:c})}return O.none()},uE=function(n,t,e){return n(t)?O.none():Ge(t,(function(n){var t=rE(n,e.inNodeScope),o=t.contextToolbars,r=t.contextForms,c=r.length>0?r:function(n){if(n.length<=1)return n;var t=function(t){return K(n,(function(n){return n.position===t}))};return t("selection").orThunk((function(){return t("node")})).orThunk((function(){return t("line")})).map((function(n){return n.position})).fold((function(){return[]}),(function(t){return filter(n,(function(n){return n.position===t}))}))}(o);return c.length>0?O.some({elem:n,toolbars:c}):O.none()}),n)},aE=function(n,t){var e={},o=[],r=[],c={},f={},l=function(n,l){var d=Bt(Dt("ContextForm",Xp,l));e[n]=d,d.launch.map((function(e){c["form:"+n]=v(v({},l.launch),{type:"contextformtogglebutton"===e.type?"togglebutton":"button",onAction:function(){t(d)}})})),"editor"===d.scope?r.push(d):o.push(d),f[n]=d},d=function(n,t){var e;(e=t,Dt("ContextToolbar",Yp,e)).each((function(e){"editor"===t.scope?r.push(e):o.push(e),f[n]=e}))},m=Cn(n);return G(m,(function(t){var e=n[t];"contextform"===e.type?l(t,e):"contexttoolbar"===e.type&&d(t,e)})),{forms:e,inNodeScope:o,inEditorScope:r,lookupTable:f,formNavigators:c}},cE=Yr("forward-slide"),sE=Yr("backward-slide"),fE=Yr("change-slide-event"),lE=function(n,t,e){var o=function(n,o,c,f){var l=t.shared.providers.translate(n.title);if("separator"===n.type)return O.some({type:"separator",text:l});if("submenu"===n.type){var d=Z(n.getStyleItems(),(function(n){return r(n,o,f)}));return 0===o&&d.length<=0?O.none():O.some({type:"nestedmenuitem",text:l,disabled:d.length<=0,getSubmenuItems:function(){return Z(n.getStyleItems(),(function(n){return r(n,o,f)}))}})}return O.some(v({type:"togglemenuitem",text:l,icon:n.icon,active:n.isSelected(f),disabled:c,onAction:e.onAction(n)},n.getStylePreview().fold((function(){return{}}),(function(n){return{meta:{style:n}}}))))},r=function(n,t,r){var c="formatter"===n.type&&e.isInvalid(n);return 0===t?c?[]:o(n,t,!1,r).toArray():o(n,t,c,r).toArray()},c=function(n){var t=e.getCurrentValue(),o=e.shouldHide?0:1;return Z(n,(function(n){return r(n,o,t)}))};return{validateItems:c,getFetch:function(n,t){return function(e,o){var r=t(),f=c(r);o(lC(f,Kp.CLOSE_ON_EXECUTE,n,!1))}}}},dE=function(n,t,e){var o=e.dataset,r="basic"===o.type?function(){return map(o.data,(function(n){return $O(n,e.isSelectedFor,e.getPreviewFor)}))}:o.getData;return{items:lE(0,t,e),getStyleItems:r}},mE=function(n,e,o){var r=dE(0,e,o),c=r.items,f=r.getStyleItems;return iC({text:o.icon.isSome()?O.none():O.some(""),icon:o.icon,tooltip:O.from(o.tooltip),role:O.none(),fetch:c.getFetch(e,f),onSetup:function(e){return o.setInitialValue.each((function(n){return n(e.getComponent())})),o.nodeChangeHandler.map((function(t){var o=t(e.getComponent());return n.on("NodeChange",o),function(){n.off("NodeChange",o)}})).getOr(t)},getApi:function(n){return{getComponent:function(){return n}}},columns:1,presets:"normal",classes:o.icon.isSome()?[]:["bespoke"],dropdownBehaviours:[]},"tox-tbtn",e.shared)};!function(n){n[n.SemiColon=0]="SemiColon",n[n.Space=1]="Space"}(JC||(JC={}));var gE,pE,hE,vE=function(n,t,e,o){return{type:"basic",data:function(n){return map(n,(function(n){var title=n,t=n,e=n.split("=");return e.length>1&&(title=e[0],t=e[1]),{title:title,format:t}}))}(function(n,t){return t===JC.SemiColon?n.replace(/;$/,"").split(";"):n.split(" ")}(n.getParam(t,e,"string"),o))}},bE=[{title:"Left",icon:"align-left",format:"alignleft",command:"JustifyLeft"},{title:"Center",icon:"align-center",format:"aligncenter",command:"JustifyCenter"},{title:"Right",icon:"align-right",format:"alignright",command:"JustifyRight"},{title:"Justify",icon:"align-justify",format:"alignjustify",command:"JustifyFull"}],yE=function(n){var t=function(t){var e=K(bE,(function(t){return n.formatter.match(t.format)})).fold((function(){return"left"}),(function(n){return n.title.toLowerCase()}));Uo(t,rC,{icon:"align-"+e})},e=O.some((function(n){return function(){return t(n)}})),o=O.some((function(n){return t(n)})),r={type:"basic",data:bE};return{tooltip:"Align",icon:O.some("align-left"),isSelectedFor:function(t){return function(){return n.formatter.match(t)}},getCurrentValue:O.none,getPreviewFor:function(n){return function(){return O.none()}},onAction:function(t){return function(){return K(bE,(function(n){return n.format===t.format})).each((function(t){return n.execCommand(t.command)}))}},setInitialValue:o,nodeChangeHandler:e,dataset:r,shouldHide:!1,isInvalid:function(t){return!n.formatter.canApply(t.format)}}},xE=["-apple-system","Segoe UI","Roboto","Helvetica Neue","sans-serif"],wE=function(n){var t=n.split(/\s*,\s*/);return map(t,(function(n){return n.replace(/^['"]+|['"]+$/g,"")}))},SE=function(n){var t=function(){var t=function(n){return n?wE(n)[0]:""},e=n.queryCommandValue("FontName"),o=c.data,r=e?e.toLowerCase():"";return{matchOpt:K(o,(function(n){var e=n.format;return e.toLowerCase()===r||t(e).toLowerCase()===t(r).toLowerCase()})).orThunk((function(){return function(n){var t;return 0===n.indexOf("-apple-system")&&(t=wE(n.toLowerCase()),nn(xE,(function(n){return t.indexOf(n.toLowerCase())>-1})))}(r)?O.from({title:"System Font",format:r}):O.none()})),font:e}},e=function(n){var e=t(),o=e.matchOpt,r=e.font,text=o.fold((function(){return r}),(function(n){return n.title}));Uo(n,oC,{text:text})},o=O.some((function(n){return function(){return e(n)}})),r=O.some((function(n){return e(n)})),c=vE(n,"font_formats","Andale Mono=andale mono,monospace;Arial=arial,helvetica,sans-serif;Arial Black=arial black,sans-serif;Book Antiqua=book antiqua,palatino,serif;Comic Sans MS=comic sans ms,sans-serif;Courier New=courier new,courier,monospace;Georgia=georgia,palatino,serif;Helvetica=helvetica,arial,sans-serif;Impact=impact,sans-serif;Symbol=symbol;Tahoma=tahoma,arial,helvetica,sans-serif;Terminal=terminal,monaco,monospace;Times New Roman=times new roman,times,serif;Trebuchet MS=trebuchet ms,geneva,sans-serif;Verdana=verdana,geneva,sans-serif;Webdings=webdings;Wingdings=wingdings,zapf dingbats",JC.SemiColon);return{tooltip:"Fonts",icon:O.none(),isSelectedFor:function(n){return function(t){return t.exists((function(t){return t.format===n}))}},getCurrentValue:function(){return t().matchOpt},getPreviewFor:function(n){return function(){return O.some({tag:"div",styles:-1===n.indexOf("dings")?{"font-family":n}:{}})}},onAction:function(t){return function(){n.undoManager.transact((function(){n.focus(),n.execCommand("FontName",!1,t.format)}))}},setInitialValue:r,nodeChangeHandler:o,dataset:c,shouldHide:!1,isInvalid:function(){return!1}}},kE={"8pt":"1","10pt":"2","12pt":"3","14pt":"4","18pt":"5","24pt":"6","36pt":"7"},CE={"xx-small":"7pt","x-small":"8pt",small:"10pt",medium:"12pt",large:"14pt","x-large":"18pt","xx-large":"24pt"},OE=function(n,t){return/[0-9.]+px$/.test(n)?function(n,t){var e=Math.pow(10,t);return Math.round(n*e)/e}(72*parseInt(n,10)/96,t||0)+"pt":Fn(CE,n).getOr(n)},_E=function(n){var t=function(){var t=O.none(),e=l.data,o=n.queryCommandValue("FontSize");if(o)for(var r=function(n){var r=OE(o,n),c=function(n){return Fn(kE,n).getOr("")}(r);t=K(e,(function(n){return n.format===o||n.format===r||n.format===c}))},c=3;t.isNone()&&c>=0;c--)r(c);return{matchOpt:t,size:o}},e=o(O.none),r=function(n){var e=t(),o=e.matchOpt,r=e.size,text=o.fold((function(){return r}),(function(n){return n.title}));Uo(n,oC,{text:text})},c=O.some((function(n){return function(){return r(n)}})),f=O.some((function(n){return r(n)})),l=vE(n,"fontsize_formats","8pt 10pt 12pt 14pt 18pt 24pt 36pt",JC.Space);return{tooltip:"Font sizes",icon:O.none(),isSelectedFor:function(n){return function(t){return t.exists((function(t){return t.format===n}))}},getPreviewFor:e,getCurrentValue:function(){return t().matchOpt},onAction:function(t){return function(){n.undoManager.transact((function(){n.focus(),n.execCommand("FontSize",!1,t.format)}))}},setInitialValue:f,nodeChangeHandler:c,dataset:l,shouldHide:!1,isInvalid:function(){return!1}}},TE=function(n,t){var e=t(),o=map(e,(function(style){return style.format}));return O.from(n.formatter.closest(o)).bind((function(n){return K(e,(function(data){return data.format===n}))})).orThunk((function(){return jl(n.formatter.match("p"),{title:"Paragraph",format:"p"})}))},EE=function(n){var t=ge(O.none()),e=function(){return t.get().each(n)};return{clear:function(){e(),t.set(O.none())},isSet:function(){return t.get().isSome()},set:function(s){e(),t.set(O.some(s))}}},DE=function(){return EE((function(s){return s.destroy()}))},BE=function(){return EE((function(s){return s.unbind()}))},AE=function(n,t){return function(e){var o=BE(),r=function(){e.setActive(n.formatter.match(t));var r=n.formatter.formatChanged(t,e.setActive);o.set(r)};return n.initialized?r():n.on("init",r),o.clear}},ME=function(n){return function(t){return function(){n.undoManager.transact((function(){n.focus(),n.execCommand("mceToggleFormat",!1,t.format)}))}}},FE=function(n){var t=function(t){var text=TE(n,(function(){return r.data})).fold((function(){return"Paragraph"}),(function(n){return n.title}));Uo(t,oC,{text:text})},e=O.some((function(n){return function(){return t(n)}})),o=O.some((function(n){return t(n)})),r=vE(n,"block_formats","Paragraph=p;Heading 1=h1;Heading 2=h2;Heading 3=h3;Heading 4=h4;Heading 5=h5;Heading 6=h6;Preformatted=pre",JC.SemiColon);return{tooltip:"Blocks",icon:O.none(),isSelectedFor:function(t){return function(){return n.formatter.match(t)}},getCurrentValue:O.none,getPreviewFor:function(t){return function(){var e=n.formatter.get(t);return O.some({tag:e.length>0&&(e[0].inline||e[0].block)||"div",styles:n.dom.parseStyle(n.formatter.getCssText(t))})}},onAction:ME(n),setInitialValue:o,nodeChangeHandler:e,dataset:r,shouldHide:!1,isInvalid:function(t){return!n.formatter.canApply(t.format)}}},IE=function(n,t){var e=function(t){var e=function(n){var t=n.items;return void 0!==t&&t.length>0?Z(t,e):[{title:n.title,format:n.format}]},o=Z(KO(n),e),text=TE(n,(function(){return o})).fold((function(){return"Paragraph"}),(function(n){return n.title}));Uo(t,oC,{text:text})},o=O.some((function(n){return function(){return e(n)}})),r=O.some((function(n){return e(n)}));return{tooltip:"Formats",icon:O.none(),isSelectedFor:function(t){return function(){return n.formatter.match(t)}},getCurrentValue:O.none,getPreviewFor:function(t){return function(){var e=n.formatter.get(t);return void 0!==e?O.some({tag:e.length>0&&(e[0].inline||e[0].block)||"div",styles:n.dom.parseStyle(n.formatter.getCssText(t))}):O.none()}},onAction:ME(n),setInitialValue:r,nodeChangeHandler:o,shouldHide:n.getParam("style_formats_autohide",!1,"boolean"),isInvalid:function(t){return!n.formatter.canApply(t.format)},dataset:t}},RE=[{name:"history",items:["undo","redo"]},{name:"styles",items:["styleselect"]},{name:"formatting",items:["bold","italic"]},{name:"alignment",items:["alignleft","aligncenter","alignright","alignjustify"]},{name:"indentation",items:["outdent","indent"]},{name:"permanent pen",items:["permanentpen"]},{name:"comments",items:["addcomment"]}],VE=function(n,t){return function(e,o,r){var c=n(e).mapError((function(n){return Mt(n)})).getOrDie();return t(c,o,r)}},PE={button:VE(Vp,(function(s,n){return t=s,e=n.backstage.shared.providers,KT(t,e,[]);var t,e})),togglebutton:VE(zp,(function(s,n){return t=s,e=n.backstage.shared.providers,$T(t,e,[]);var t,e})),menubutton:VE(AT,(function(s,n){return mC(s,"tox-tbtn",n.backstage,O.none())})),splitbutton:VE((function(n){return Dt("SplitButton",MT,n)}),(function(s,n){return function(n,e){var o,r=Yr("channel-update-split-dropdown-display"),c=function(n){return{isDisabled:function(){return ev.isDisabled(n)},setDisabled:function(t){return ev.set(n,t)},setIconFill:function(t,e){Xu(n.element,'svg path[id="'+t+'"], rect[id="'+t+'"]').each((function(n){Pr(n,"fill",e)}))},setIconStroke:function(t,e){Xu(n.element,'svg path[id="'+t+'"], rect[id="'+t+'"]').each((function(n){Pr(n,"stroke",e)}))},setActive:function(t){Pr(n.element,"aria-pressed",t),Xu(n.element,"span").each((function(button){n.getSystem().getByDom(button).each((function(n){return Sg.set(n,t)}))}))},isActive:function(){return Xu(n.element,"span").exists((function(button){return n.getSystem().getByDom(button).exists(Sg.isOn)}))}}},f=ge(t),l={getApi:c,onSetup:n.onSetup};return LT.sketch({dom:{tag:"div",classes:["tox-split-button"],attributes:v({"aria-pressed":!1},WT(n.tooltip,e.providers))},onExecute:function(button){n.onAction(c(button))},onItemExecute:function(n,t,e){},splitDropdownBehaviours:Qa([Rv(e.providers.isDisabled),Mv(),ig("split-dropdown-events",[$o(GT,fg.focus),Hv(l,f),zv(l,f)]),jx.config({})]),eventOrder:(o={},o[Mo()]=["alloy.base.behaviour","split-dropdown-events"],o),toggleClass:"tox-tbtn--enabled",lazySink:e.getSink,fetch:QT(c,n,e.providers),parts:{menu:sh(0,n.columns,n.presets)},components:[LT.parts.button(qT(n.icon,n.text,O.none(),O.some(r),O.some([Sg.config({toggleClass:"tox-tbtn--enabled",toggleOnExecute:!1})]),e.providers)),LT.parts.arrow({dom:{tag:"button",classes:["tox-tbtn","tox-split-button__chevron"],innerHtml:ap("chevron-down",e.providers.icons)},buttonBehaviours:Qa([Rv(e.providers.isDisabled),Mv()])}),LT.parts["aria-descriptor"]({text:e.providers.translate("To open the popup, press Shift+Enter")})]})}(s,n.backstage.shared)})),grouptoolbarbutton:VE((function(n){return Dt("GroupToolbarButton",ET,n)}),(function(s,n,t){var e,o=t.ui.registry.getAll().buttons,r=((e={})[Vc]=n.backstage.shared.header.isPositionedAtTop()?$u.TopToBottom:$u.BottomToTop,e);switch(pv(t)){case Jp.floating:return function(n,t,e,o){var r=t.shared;return X_.sketch({lazySink:r.getSink,fetch:function(){return lx((function(t){t(map(e(n.items),ST))}))},markers:{toggledClass:"tox-tbtn--enabled"},parts:{button:qT(n.icon,n.text,n.tooltip,O.none(),O.none(),r.providers),toolbar:{dom:{tag:"div",classes:["tox-toolbar__overflow"],attributes:o}}}})}(s,n.backstage,(function(e){return LE(t,{buttons:o,toolbar:e,allowToolbarGroups:!1},n,O.none())}),r);default:throw new Error("Toolbar groups are only supported when using floating toolbar mode")}})),styleSelectButton:function(n,t){return function(n,t){var e=v({type:"advanced"},t.styleselect);return mE(n,t,IE(n,e))}(n,t.backstage)},fontsizeSelectButton:function(n,t){return function(n,t){return mE(n,t,_E(n))}(n,t.backstage)},fontSelectButton:function(n,t){return function(n,t){return mE(n,t,SE(n))}(n,t.backstage)},formatButton:function(n,t){return function(n,t){return mE(n,t,FE(n))}(n,t.backstage)},alignMenuButton:function(n,t){return function(n,t){return mE(n,t,yE(n))}(n,t.backstage)}},HE={styleselect:PE.styleSelectButton,fontsizeselect:PE.fontsizeSelectButton,fontselect:PE.fontSelectButton,formatselect:PE.formatButton,align:PE.alignMenuButton},zE=function(n){var t,e=n.toolbar,o=n.buttons;return!1===e?[]:void 0===e||!0===e?function(n){var t=map(RE,(function(t){var e=filter(t.items,(function(t){return In(n,t)||In(HE,t)}));return{name:t.name,items:e}}));return filter(t,(function(n){return n.items.length>0}))}(o):E(e)?(t=e.split("|"),map(t,(function(g){return{items:g.trim().split(" ")}}))):function(n){return V(n,(function(n){return In(n,"name")&&In(n,"items")}))}(e)?e:(console.error("Toolbar type should be string, string[], boolean or ToolbarGroup[]"),[])},NE=function(n,t,e,o,r,c){return Fn(t,e.toLowerCase()).orThunk((function(){return c.bind((function(n){return cn(n,(function(n){return Fn(t,n+e.toLowerCase())}))}))})).fold((function(){return Fn(HE,e.toLowerCase()).map((function(t){return t(n,r)})).orThunk((function(){return O.none()}))}),(function(t){return"grouptoolbarbutton"!==t.type||o?function(n,t,e){return Fn(PE,n.type).fold((function(){return console.error("skipping button defined by",n),O.none()}),(function(o){return O.some(o(n,t,e))}))}(t,r,n):(console.warn("Ignoring the '"+e+"' toolbar button. Group toolbar buttons are only supported when using floating toolbar mode and cannot be nested."),O.none())}))},LE=function(n,t,e,o){var r=zE(t),c=map(r,(function(r){var c=Z(r.items,(function(r){return 0===r.trim().length?[]:NE(n,t.buttons,r,t.allowToolbarGroups,e,o).toArray()}));return{title:O.from(n.translate(r.name)),items:c}}));return filter(c,(function(n){return n.items.length>0}))},jE={valignCentre:[],alignCentre:[],alignLeft:["tox-pop--align-left"],alignRight:["tox-pop--align-right"],right:["tox-pop--right"],left:["tox-pop--left"],bottom:["tox-pop--bottom"],top:["tox-pop--top"]},UE={maxHeightFunction:Ec(),maxWidthFunction:E_()},WE={onLtr:function(){return[Va,Pa,Ia,Ma,Ra,Fa,np,tp,Qg,Kg,Zg,$g]},onRtl:function(){return[Va,Pa,Ra,Fa,Ia,Ma,np,tp,Zg,$g,Qg,Kg]}},GE={onLtr:function(){return[Pa,Ma,Fa,Ia,Ra,Va,np,tp,Qg,Kg,Zg,$g]},onRtl:function(){return[Pa,Fa,Ma,Ra,Ia,Va,np,tp,Zg,$g,Qg,Kg]}},XE=function(n,t,e,o){var r,c,f=He().deviceType.isTouch,l=du((r={sink:e,onEscape:function(){return n.focus(),O.some(!0)}},c=ge([]),Wg.sketch({dom:{tag:"div",classes:["tox-pop"]},fireDismissalEventInstead:{event:"doNotDismissYet"},onShow:function(n){c.set([]),Wg.getContent(n).each((function(n){Zi(n.element,"visibility")})),Ei(n.element,"tox-pop--resizing"),Zi(n.element,"width")},inlineBehaviours:Qa([ig("context-toolbar-events",[ir(mo(),(function(n,t){Ei(n.element,"tox-pop--resizing"),Zi(n.element,"width")})),$o(fE,(function(n,t){Zi(n.element,"width");var e=Cu(n.element);Wg.setContent(n,t.event.contents),_i(n.element,"tox-pop--resizing");var o=Cu(n.element);Gi(n.element,"width",e+"px"),Wg.getContent(n).each((function(e){t.event.focus.bind((function(t){return uc(t),cc(n.element)})).orThunk((function(){return Zm.focusIn(e),ac()}))})),ep.setTimeout((function(){Gi(n.element,"width",o+"px")}),0)})),$o(cE,(function(n,t){Wg.getContent(n).each((function(n){c.set(c.get().concat([{bar:n,focus:ac()}]))})),Uo(n,fE,{contents:t.event.forwardContents,focus:O.none()})})),$o(sE,(function(n,t){un(c.get()).each((function(t){c.set(c.get().slice(0,c.get().length-1)),Uo(n,fE,{contents:mu(t.bar),focus:t.focus})}))}))]),Zm.config({mode:"special",onEscape:function(n){return un(c.get()).fold((function(){return r.onEscape()}),(function(t){return jo(n,sE),O.some(!0)}))}})]),lazySink:function(){return ln.value(r.sink)}}))),d=function(){return oE(n,o.backstage.shared)},m=function(){if(f()&&o.backstage.isContextMenuOpen())return!0;var t,e,r,c,l,m,h=(t=w.get().filter((function(n){return Li(he.fromDom(n))})).map((function(n){return n.getBoundingClientRect()})).getOrThunk((function(){return n.selection.getRng().getBoundingClientRect()})),e=n.inline?Du().top:Hu(he.fromDom(n.getBody())).y,{y:t.top+e,bottom:t.bottom+e}),v=d();return r=h.y,c=h.bottom,l=v.y,m=v.bottom,!(Math.max(r,l)<=Math.min(c,m))},h=function(){Wg.hide(l)},y=function(){x.get().each((function(n){var t=l.element;Zi(t,"display"),m()?Gi(t,"display","none"):Us.positionWithinBounds(e,n,l,O.some(d()))}))},x=ge(O.none()),w=ge(O.none()),S=ge(null),k=function(t){return{dom:{tag:"div",classes:["tox-pop__dialog"]},components:[t],behaviours:Qa([Zm.config({mode:"acyclic"}),ig("pop-dialog-wrap-events",[ur((function(t){n.shortcuts.add("ctrl+F9","focus statusbar",(function(){return Zm.focusIn(t)}))})),ar((function(t){n.shortcuts.remove("ctrl+F9")}))])])}},C=Ln((function(){return aE(t,(function(n){var t=_([n]);Uo(l,cE,{forwardContents:k(t)})}))})),_=function(t){var e=n.ui.registry.getAll().buttons,r=C(),c=v(v({},e),r.formNavigators),f=pv(n)===Jp.scrolling?Jp.scrolling:Jp.default,l=Q(map(t,(function(t){return"contexttoolbar"===t.type?function(t,e){return LE(n,{buttons:t,toolbar:e.items,allowToolbarGroups:!1},o,O.some(["form:"]))}(c,t):function(n,t){return eE(n,t)}(t,o.backstage.shared.providers)})));return TT({type:f,uid:Yr("context-toolbar"),initGroups:l,onEscape:O.none,cyclicKeying:!0,providers:o.backstage.shared.providers})};n.on("contexttoolbar-show",(function(t){var e=C();Fn(e.lookupTable,t.toolbarKey).each((function(e){E([e],t.target===n?O.none():O.some(t)),Wg.getContent(l).each(Zm.focusIn)}))}));var T=function(n,element){var t="node"===n?o.backstage.shared.anchors.node(element):o.backstage.shared.anchors.cursor();return zn(t,function(n,t){return"line"===n?{bubble:Mc(12,0,jE),layouts:{onLtr:function(){return[Ha]},onRtl:function(){return[za]}},overrides:UE}:{bubble:Mc(0,12,jE),layouts:t?GE:WE,overrides:UE}}(n,f()))},E=function(n,t){if(B(),!f()||!o.backstage.isContextMenuOpen()){var e=_(n),r=t.map(he.fromDom),c=T(n[0].position,r);x.set(O.some(c)),w.set(t);var h=l.element;Zi(h,"display"),Wg.showWithinBounds(l,c,k(e),(function(){return O.some(d())})),m()&&Gi(h,"display","none")}},D=function(){n.hasFocus()&&function(n,t){var e=he.fromDom(t.getBody()),o=function(n){return Le(n,e)},r=he.fromDom(t.selection.getNode());return function(n){return!o(n)&&!Ue(e,n)}(r)?O.none():iE(r,n.inNodeScope,n.inEditorScope).orThunk((function(){return uE(o,r,n)}))}(C(),n).fold((function(){x.set(O.none()),Wg.hide(l)}),(function(n){E(n.toolbars,O.some(n.elem.dom))}))},B=function(){var n=S.get();null!==n&&(ep.clearTimeout(n),S.set(null))},A=function(n){B(),S.set(n)};n.on("init",(function(){n.on("contexttoolbar-hide",h),n.on("ScrollContent ScrollWindow longpress",y),n.on("click keyup focus SetContent ObjectResized ResizeEditor",(function(){A(ep.setEditorTimeout(n,D,0))})),n.on("focusout",(function(t){ep.setEditorTimeout(n,(function(){cc(e.element).isNone()&&cc(l.element).isNone()&&(x.set(O.none()),Wg.hide(l))}),0)})),n.on("SwitchMode",(function(){n.mode.isReadOnly()&&(x.set(O.none()),Wg.hide(l))})),n.on("NodeChange",(function(t){cc(l.element).fold((function(){A(ep.setEditorTimeout(n,D,0))}),(function(n){}))}))}))},YE=Ml,qE=pl,JE=o([re("shell",!1),Wt("makeItem"),re("setupItem",t),Vf("listBehaviours",[rg])]),KE=ll({name:"items",overrides:function(){return{behaviours:Qa([rg.config({})])}}}),$E=o([KE]),QE=o("CustomList"),ZE=Nl({name:QE(),configFields:JE(),partFields:$E(),factory:function(n,t,e,o){var r=n.shell?{behaviours:[rg.config({})],components:[]}:{behaviours:[],components:t},c=function(component){return n.shell?O.some(component):Cl(component,n,"items")};return{uid:n.uid,dom:n.dom,components:r.components,behaviours:Rf(n.listBehaviours,r.behaviours),apis:{setItems:function(t,e){c(t).fold((function(){throw console.error("Custom List was defined to not be a shell, but no item container was specified in components"),new Error("Custom List was defined to not be a shell, but no item container was specified in components")}),(function(o){var r=rg.contents(o),c=e.length,f=c-r.length,l=f>0?U(f,(function(){return n.makeItem()})):[],d=r.slice(c);G(d,(function(n){return rg.remove(o,n)})),G(l,(function(n){return rg.append(o,n)}));var m=rg.contents(o);G(m,(function(o,i){n.setupItem(t,o,e[i],i)}))}))}}}},apis:{setItems:function(n,t,e){n.setItems(t,e)}}}),nD=t,tD=d,eD=o([]),oD=Object.freeze({__proto__:null,setup:nD,isDocked:tD,getBehaviours:eD}),rD=function(element){return(Ki(element,"position").is("fixed")?O.none():kr(element)).orThunk((function(){var marker=he.fromTag("span");return Sr(element).bind((function(n){Dr(n,marker);var t=kr(marker);return Mr(marker),t}))}))},iD=function(element){return rD(element).map(wu).getOrThunk((function(){return yu(0,0)}))},uD=Vn([{static:[]},{absolute:["positionCss"]},{fixed:["positionCss"]}]),aD=function(component,n){var t=component.element;_i(t,n.transitionClass),Ei(t,n.fadeOutClass),_i(t,n.fadeInClass),n.onShow(component)},cD=function(component,n){var t=component.element;_i(t,n.transitionClass),Ei(t,n.fadeInClass),_i(t,n.fadeOutClass),n.onHide(component)},sD=function(n,t,e){return nn(n,(function(n){switch(n){case"bottom":return function(n,t){return n.bottom<=t.bottom}(t,e);case"top":return function(n,t){return n.y>=t.y}(t,e)}}))},fD=function(n,t){return t.getInitialPosition().map((function(t){return Vu(t.bounds.x,t.bounds.y,Cu(n),hu(n))}))},lD=function(n,t,e){return e.getInitialPosition().bind((function(o){switch(e.setInitialPosition(O.none()),o.position){case"static":return O.some(uD.static());case"absolute":var r=rD(n).map(Pu).getOrThunk((function(){return Pu(body())}));return O.some(uD.absolute(fc("absolute",Fn(o.style,"left").map((function(n){return t.x-r.x})),Fn(o.style,"top").map((function(n){return t.y-r.y})),Fn(o.style,"right").map((function(n){return r.right-t.right})),Fn(o.style,"bottom").map((function(n){return r.bottom-t.bottom})))));default:return O.none()}}))},dD=function(n,t,e){var o=Pu(n);if(sD(e.getModes(),o,t))return O.none();!function(n,t,e){e.setInitialPosition(O.some({style:$i(n),position:qi(n,"position")||"static",bounds:t}))}(n,o,e);var r=zu(),c=o.x-r.x,f=t.y-r.y,l=r.bottom-t.bottom,d=o.y<=t.y;return O.some(uD.fixed(fc("fixed",O.some(c),d?O.some(f):O.none(),O.none(),d?O.none():O.some(l))))},mD=function(component,n,t){var e=component.element;return Ki(e,"position").is("fixed")?function(n,t,e){return fD(n,e).filter((function(n){return sD(e.getModes(),n,t)})).bind((function(t){return lD(n,t,e)}))}(e,n,t):dD(e,n,t)},gD=function(component,n){G(["left","right","top","bottom","position"],(function(n){return Zi(component.element,n)})),n.onUndocked(component)},pD=function(component,n,t){lc(component.element,t),("fixed"===t.position?n.onDocked:n.onUndocked)(component)},hD=function(component,n,t,e,o){void 0===o&&(o=!1),n.contextual.each((function(n){n.lazyContext(component).each((function(r){var c=function(n,t){return n.y<t.bottom&&n.bottom>t.y}(r,e);c!==t.isVisible()&&(t.setVisible(c),o&&!c?(Bi(component.element,[n.fadeOutClass]),n.onHide(component)):(c?aD:cD)(component,n))}))}))},vD=function(component,n,e){var o=component.element;e.setDocked(!1),function(component,n){var t=component.element;return fD(t,n).bind((function(e){return lD(t,e,n)}))}(component,e).each((function(e){e.fold((function(){return gD(component,n)}),(function(t){return pD(component,n,t)}),t)})),e.setVisible(!0),n.contextual.each((function(n){Ai(o,[n.fadeInClass,n.fadeOutClass,n.transitionClass]),n.onShow(component)})),bD(component,n,e)},bD=function(component,n,t){component.getSystem().isConnected()&&function(component,n,t){var e=n.lazyViewport(component),o=t.isDocked();o&&hD(component,n,t,e),mD(component,e,t).each((function(r){t.setDocked(!o),r.fold((function(){return gD(component,n)}),(function(t){return pD(component,n,t)}),(function(o){hD(component,n,t,e,!0),pD(component,n,o)}))}))}(component,n,t)},yD=function(component,n,t){t.isDocked()&&vD(component,n,t)},xD=Object.freeze({__proto__:null,refresh:bD,reset:yD,isDocked:function(component,n,t){return t.isDocked()},getModes:function(component,n,t){return t.getModes()},setModes:function(component,n,t,e){return t.setModes(e)}}),wD=Object.freeze({__proto__:null,events:function(n,t){return qo([ir(mo(),(function(component,e){n.contextual.each((function(n){Di(component.element,n.transitionClass)&&(Ai(component.element,[n.transitionClass,n.fadeInClass]),(t.isVisible()?n.onShown:n.onHidden)(component));e.stop()}))})),$o(Bo(),(function(component,e){bD(component,n,t)})),$o(Ao(),(function(component,e){yD(component,n,t)}))])}}),SD=[oe("contextual",[Yt("fadeInClass"),Yt("fadeOutClass"),Yt("transitionClass"),Jt("lazyContext"),sa("onShow"),sa("onShown"),sa("onHide"),sa("onHidden")]),fe("lazyViewport",zu),le("modes",["top","bottom"],Ht),sa("onDocked"),sa("onUndocked")],kD=Object.freeze({__proto__:null,init:function(n){var t=ge(!1),e=ge(!0),o=ge(O.none()),r=ge(n.modes);return fi({isDocked:t.get,setDocked:t.set,getInitialPosition:o.get,setInitialPosition:o.set,isVisible:e.get,setVisible:e.set,getModes:r.get,setModes:r.set,readState:function(){return"docked:  "+t.get()+", visible: "+e.get()+", modes: "+r.get().join(",")}})}}),CD=nc({fields:SD,name:"docking",active:wD,apis:xD,state:kD}),OD={fadeInClass:"tox-editor-dock-fadein",fadeOutClass:"tox-editor-dock-fadeout",transitionClass:"tox-editor-dock-transition"},_D=function(header){var n=header.element;Sr(n).each((function(t){var e="padding-"+CD.getModes(header)[0];if(CD.isDocked(header)){var o=Cu(t);Gi(n,"width",o+"px"),Gi(t,e,function(n){return vu(n)+(parseInt(qi(n,"margin-top"),10)||0)+(parseInt(qi(n,"margin-bottom"),10)||0)}(n)+"px")}else Zi(n,"width"),Zi(t,e)}))},TD=function(n,t){t?(Ei(n,OD.fadeOutClass),Bi(n,[OD.transitionClass,OD.fadeInClass])):(Ei(n,OD.fadeInClass),Bi(n,[OD.fadeOutClass,OD.transitionClass]))},ED=function(n,t){var e=he.fromDom(n.getContainer());t?(_i(e,"tox-tinymce--toolbar-sticky-on"),Ei(e,"tox-tinymce--toolbar-sticky-off")):(_i(e,"tox-tinymce--toolbar-sticky-off"),Ei(e,"tox-tinymce--toolbar-sticky-on"))},DD=function(n,t){var e=ge(O.none()),o=t.getSink,r=function(n){o().each((function(t){return n(t.element)}))},c=function(t){n.inline||_D(t),ED(n,CD.isDocked(t)),t.getSystem().broadcastOn([gf()],{}),o().each((function(n){return n.getSystem().broadcastOn([gf()],{})}))},f=n.inline?[]:function(){var n;return[rc.config({channels:(n={},n[xT()]={onReceive:_D},n)})]}();return x([fg.config({}),CD.config({contextual:v({lazyContext:function(t){var header,e,o=vu(t.element),r=n.inline?n.getContentAreaContainer():n.getContainer(),c=Pu(he.fromDom(r)),f=c.height-o,l=c.y+(header=t,e="top",L(CD.getModes(header),e)?0:o);return O.some(Vu(c.x,l,c.width,f))},onShow:function(){r((function(n){return TD(n,!0)}))},onShown:function(n){r((function(n){return Ai(n,[OD.transitionClass,OD.fadeInClass])})),e.get().each((function(t){var o,r,c;o=n.element,c=vr(r=t),ac(c).filter((function(n){return!Le(r,n)})).filter((function(n){return Le(n,he.fromDom(c.dom.body))||Ue(o,n)})).each((function(){return uc(r)})),e.set(O.none())}))},onHide:function(n){e.set(function(n,t){return cc(n).orThunk((function(){return t().toOptional().bind((function(n){return cc(n.element)}))}))}(n.element,o)),r((function(n){return TD(n,!1)}))},onHidden:function(){r((function(n){return Ai(n,[OD.transitionClass])}))}},OD),modes:[t.header.getDockingMode()],onDocked:c,onUndocked:c})],f)},BD=Object.freeze({__proto__:null,setup:function(n,t,e){n.inline||(t.header.isPositionedAtTop()||n.on("ResizeEditor",(function(){e().each(CD.reset)})),n.on("ResizeWindow ResizeEditor",(function(){e().each(_D)})),n.on("SkinLoaded",(function(){e().each((function(n){CD.isDocked(n)?CD.reset(n):CD.refresh(n)}))})),n.on("FullscreenStateChanged",(function(){e().each(CD.reset)}))),n.on("AfterScrollIntoView",(function(n){e().each((function(header){CD.refresh(header);var t=header.element;Yd(t)&&function(n,t){var e=vr(t),o=e.dom.defaultView.innerHeight,r=Du(e),c=he.fromDom(n.elm),f=Hu(c),l=hu(c),d=f.y,m=d+l,h=wu(t),v=hu(t),y=h.top,x=y+v,w=Math.abs(y-r.top)<2,S=Math.abs(x-(r.top+o))<2;if(w&&d<x)Bu(r.left,d-v,e);else if(S&&m>y){var k=d-o+l+v;Bu(r.left,k,e)}}(n,t)}))})),n.on("PostRender",(function(){ED(n,!1)}))},isDocked:function(n){return n().map(CD.isDocked).getOr(!1)},getBehaviours:DD}),AD=zl({factory:function(n,t){var e={focus:Zm.focusIn,setMenus:function(n,e){var o=map(e,(function(n){var e={type:"menubutton",text:n.text,fetch:function(t){t(n.getItems())}},o=AT(e).mapError((function(n){return Mt(n)})).getOrDie();return mC(o,"tox-mbtn",t.backstage,O.some("menuitem"))}));rg.set(n,o)}};return{uid:n.uid,dom:n.dom,components:[],behaviours:Qa([rg.config({}),ig("menubar-events",[ur((function(component){n.onSetup(component)})),$o(io(),(function(n,t){Xu(n.element,".tox-mbtn--active").each((function(e){Yu(t.event.target,".tox-mbtn").each((function(t){Le(e,t)||n.getSystem().getByDom(e).each((function(e){n.getSystem().getByDom(t).each((function(n){Nx.expand(n),Nx.close(e),fg.focus(n)}))}))}))}))})),$o(Vo(),(function(n,t){t.event.prevFocus.bind((function(t){return n.getSystem().getByDom(t).toOptional()})).each((function(e){t.event.newFocus.bind((function(t){return n.getSystem().getByDom(t).toOptional()})).each((function(n){Nx.isOpen(e)&&(Nx.expand(n),Nx.close(e))}))}))}))]),Zm.config({mode:"flow",selector:".tox-mbtn",onEscape:function(t){return n.onEscape(t),O.some(!0)}}),Vy.config({})]),apis:e,domModification:{attributes:{role:"menubar"}}}},name:"silver.Menubar",configFields:[Wt("dom"),Wt("uid"),Wt("onEscape"),Wt("backstage"),re("onSetup",t)],apis:{focus:function(n,t){n.focus(t)},setMenus:function(n,t,e){n.setMenus(t,e)}}}),MD=[Ff("slotBehaviours",[])],FD=function(n){return"<alloy.field."+n+">"},ID=function(n,t){var e,o=function(t){return El(n)},r=function(t,e){return function(o,r){return Cl(o,n,r).map((function(slot){return t(slot,r)})).getOr(e)}},c=function(n,t){return"true"!==Hr(n.element,"aria-hidden")},f=r(c,!1),l=r((function(n,t){if(c(n)){var element=n.element;Gi(element,"display","none"),Pr(element,"aria-hidden","true"),Uo(n,Po(),{name:t,visible:!1})}})),d=(e=l,function(n,t){G(t,(function(t){return e(n,t)}))}),m=r((function(n,t){if(!c(n)){var element=n.element;Zi(element,"display"),Lr(element,"aria-hidden"),Uo(n,Po(),{name:t,visible:!0})}})),h={getSlotNames:o,getSlot:function(t,e){return Cl(t,n,e)},isShowing:f,hideSlot:l,hideAllSlots:function(n){return d(n,o())},showSlot:m};return{uid:n.uid,dom:n.dom,components:t,behaviours:If(n.slotBehaviours),apis:h}},RD=Tn({getSlotNames:function(n,t){return n.getSlotNames(t)},getSlot:function(n,t,e){return n.getSlot(t,e)},isShowing:function(n,t,e){return n.isShowing(t,e)},hideSlot:function(n,t,e){return n.hideSlot(t,e)},hideAllSlots:function(n,t){return n.hideAllSlots(t)},showSlot:function(n,t,e){return n.showSlot(t,e)}},(function(n){return ci(n)})),VD=v(v({},RD),{sketch:function(n){var t=function(){var n=[];return{slot:function(t,e){return n.push(t),yl("container",FD(t),e)},record:function(){return n}}}(),e=n(t),o=t.record(),r=map(o,(function(n){return sl({name:n,pname:FD(n)})}));return Il("container",MD,r,ID,e)}}),PD=gt([te("icon"),te("tooltip"),fe("onShow",t),fe("onHide",t),fe("onSetup",(function(){return t}))]),HD=function(n){return{element:function(){return n.element.dom}}},zD=function(n,e){var o=map(Cn(e),(function(n){var t=e[n],o=Bt(function(n){return Dt("sidebar",PD,n)}(t));return{name:n,getApi:HD,onSetup:o.onSetup,onShow:o.onShow,onHide:o.onHide}}));return map(o,(function(e){var r=ge(t);return n.slot(e.name,{dom:{tag:"div",classes:["tox-sidebar__pane"]},behaviours:Mh([Hv(e,r),zv(e,r),$o(Po(),(function(n,t){var data=t.event;K(o,(function(n){return n.name===data.name})).each((function(t){(data.visible?t.onShow:t.onHide)(t.getApi(n))}))}))])})}))},ND=function(n){return VD.sketch((function(t){return{dom:{tag:"div",classes:["tox-sidebar__pane-container"]},components:zD(t,n),slotBehaviours:Mh([ur((function(n){return VD.hideAllSlots(n)}))])}}))},LD=function(n){return Xl.getCurrent(n).bind((function(n){return gT.isGrowing(n)||gT.hasGrown(n)?Xl.getCurrent(n).bind((function(n){return K(VD.getSlotNames(n),(function(t){return VD.isShowing(n,t)}))})):O.none()}))},jD=Yr("FixSizeEvent"),UD=Yr("AutoSizeEvent"),WD=function(html){var n=he.fromHtml(html),t=Cr(n),e=function(n){var t=void 0!==n.dom.attributes?n.dom.attributes:[];return J(t,(function(b,n){var t;return"class"===n.name?b:v(v({},b),((t={})[n.name]=n.value,t))}),{})}(n),o=function(n){return Array.prototype.slice.call(n.dom.classList,0)}(n),r=0===t.length?{}:{innerHtml:Ir(n)};return v({tag:fr(n),classes:o,attributes:e},r)},GD=function(n){return{dom:{tag:"div",attributes:{"aria-label":n.translate("Loading...")},classes:["tox-throbber__busy-spinner"]},components:[{dom:WD('<div class="tox-spinner"><div></div><div></div><div></div></div>')}],behaviours:Qa([Zm.config({mode:"special",onTab:function(){return O.some(!0)},onShiftTab:function(){return O.some(!0)}}),fg.config({})])}},XD=function(n,t,e){var o=ge(!1),r=ge(O.none()),c=function(n){n!==o.get()&&(!function(n,t,e){var element=n.element;!0===t?(rg.set(n,[GD(e)]),Zi(element,"display"),Lr(element,"aria-hidden")):(rg.set(n,[]),Gi(element,"display","none"),Pr(element,"aria-hidden","true"))}(t(),n,e.providers),o.set(n))};n.on("ProgressState",(function(t){if(r.get().each(ep.clearTimeout),R(t.time)){var e=ep.setEditorTimeout(n,(function(){return c(t.state)}),t.time);r.set(O.some(e))}else c(t.state),r.set(O.none())}))},YD=qE.optional({factory:AD,name:"menubar",schema:[Wt("backstage")]}),qD=qE.optional({factory:{sketch:function(n){return ZE.sketch({uid:n.uid,dom:n.dom,listBehaviours:Qa([Zm.config({mode:"acyclic",selector:".tox-toolbar"})]),makeItem:function(){return TT({type:n.type,uid:Yr("multiple-toolbar-item"),cyclicKeying:!1,initGroups:[],providers:n.providers,onEscape:function(){return n.onEscape(),O.some(!0)}})},setupItem:function(n,t,data,e){A_.setGroups(t,data)},shell:!0})}},name:"multiple-toolbar",schema:[Wt("dom"),Wt("onEscape")]}),JD=qE.optional({factory:{sketch:function(n){return function(n){return n.type===Jp.sliding?_T:n.type===Jp.floating?OT:TT}(n)({type:n.type,uid:n.uid,onEscape:function(){return n.onEscape(),O.some(!0)},cyclicKeying:!1,initGroups:[],getSink:n.getSink,providers:n.providers,moreDrawerData:{lazyToolbar:n.lazyToolbar,lazyMoreButton:n.lazyMoreButton,lazyHeader:n.lazyHeader},attributes:n.attributes})}},name:"toolbar",schema:[Wt("dom"),Wt("onEscape"),Wt("getSink")]}),KD=qE.optional({factory:{sketch:function(n){var t=n.editor,e=n.sticky?DD:eD;return{uid:n.uid,dom:n.dom,components:n.components,behaviours:Qa(e(t,n.sharedBackstage))}}},name:"header",schema:[Wt("dom")]}),$D=qE.optional({name:"socket",schema:[Wt("dom")]}),QD=qE.optional({factory:{sketch:function(n){return{uid:n.uid,dom:{tag:"div",classes:["tox-sidebar"],attributes:{role:"complementary"}},components:[{dom:{tag:"div",classes:["tox-sidebar__slider"]},components:[],behaviours:Qa([Vy.config({}),fg.config({}),gT.config({dimension:{property:"width"},closedClass:"tox-sidebar--sliding-closed",openClass:"tox-sidebar--sliding-open",shrinkingClass:"tox-sidebar--sliding-shrinking",growingClass:"tox-sidebar--sliding-growing",onShrunk:function(n){Xl.getCurrent(n).each(VD.hideAllSlots),jo(n,UD)},onGrown:function(n){jo(n,UD)},onStartGrow:function(n){Uo(n,jD,{width:Ki(n.element,"width").getOr("")})},onStartShrink:function(n){Uo(n,jD,{width:Cu(n.element)+"px"})}}),rg.config({}),Xl.config({find:function(n){var t=rg.contents(n);return head(t)}})])}],behaviours:Qa([US(0),ig("sidebar-sliding-events",[$o(jD,(function(n,t){Gi(n.element,"width",t.event.width)})),$o(UD,(function(n,t){Zi(n.element,"width")}))])])}}},name:"sidebar",schema:[Wt("dom")]}),ZD=qE.optional({factory:{sketch:function(n){return{uid:n.uid,dom:{tag:"div",attributes:{"aria-hidden":"true"},classes:["tox-throbber"],styles:{display:"none"}},behaviours:Qa([rg.config({})]),components:[]}}},name:"throbber",schema:[Wt("dom")]}),nB=Nl({name:"OuterContainer",factory:function(n,t,e){var o={getSocket:function(t){return YE.getPart(t,n,"socket")},setSidebar:function(t,e){YE.getPart(t,n,"sidebar").each((function(n){return function(n,t){Xl.getCurrent(n).each((function(n){return rg.set(n,[ND(t)])}))}(n,e)}))},toggleSidebar:function(t,e){YE.getPart(t,n,"sidebar").each((function(n){return function(n,t){Xl.getCurrent(n).each((function(n){Xl.getCurrent(n).each((function(e){gT.hasGrown(n)?VD.isShowing(e,t)?gT.shrink(n):(VD.hideAllSlots(e),VD.showSlot(e,t)):(VD.hideAllSlots(e),VD.showSlot(e,t),gT.grow(n))}))}))}(n,e)}))},whichSidebar:function(t){return YE.getPart(t,n,"sidebar").bind(LD).getOrNull()},getHeader:function(t){return YE.getPart(t,n,"header")},getToolbar:function(t){return YE.getPart(t,n,"toolbar")},setToolbar:function(t,e){YE.getPart(t,n,"toolbar").each((function(n){n.getApis().setGroups(n,e)}))},setToolbars:function(t,e){YE.getPart(t,n,"multiple-toolbar").each((function(n){ZE.setItems(n,e)}))},refreshToolbar:function(t){YE.getPart(t,n,"toolbar").each((function(n){return n.getApis().refresh(n)}))},toggleToolbarDrawer:function(t){YE.getPart(t,n,"toolbar").each((function(n){var a,t;a=n.getApis().toggle,t=function(t){return t(n)},null!=a?O.some(t(a)):O.none()}))},isToolbarDrawerToggled:function(t){return YE.getPart(t,n,"toolbar").bind((function(n){return O.from(n.getApis().isOpen).map((function(t){return t(n)}))})).getOr(!1)},getThrobber:function(t){return YE.getPart(t,n,"throbber")},focusToolbar:function(t){YE.getPart(t,n,"toolbar").orThunk((function(){return YE.getPart(t,n,"multiple-toolbar")})).each((function(n){Zm.focusIn(n)}))},setMenubar:function(t,e){YE.getPart(t,n,"menubar").each((function(n){AD.setMenus(n,e)}))},focusMenubar:function(t){YE.getPart(t,n,"menubar").each((function(n){AD.focus(n)}))}};return{uid:n.uid,dom:n.dom,components:t,apis:o,behaviours:n.behaviours}},configFields:[Wt("dom"),Wt("behaviours")],partFields:[KD,YD,JD,qD,$D,QD,ZD],apis:{getSocket:function(n,t){return n.getSocket(t)},setSidebar:function(n,t,e){n.setSidebar(t,e)},toggleSidebar:function(n,t,e){n.toggleSidebar(t,e)},whichSidebar:function(n,t){return n.whichSidebar(t)},getHeader:function(n,t){return n.getHeader(t)},getToolbar:function(n,t){return n.getToolbar(t)},setToolbar:function(n,t,e){var o=map(e,(function(n){return ST(n)}));n.setToolbar(t,o)},setToolbars:function(n,t,e){var o=map(e,(function(g){return map(g,ST)}));n.setToolbars(t,o)},refreshToolbar:function(n,t){return n.refreshToolbar(t)},toggleToolbarDrawer:function(n,t){n.toggleToolbarDrawer(t)},isToolbarDrawerToggled:function(n,t){return n.isToolbarDrawerToggled(t)},getThrobber:function(n,t){return n.getThrobber(t)},setMenubar:function(n,t,e){n.setMenubar(t,e)},focusMenubar:function(n,t){n.focusMenubar(t)},focusToolbar:function(n,t){n.focusToolbar(t)}}}),tB={file:{title:"File",items:"newdocument restoredraft | preview | export print | deleteallconversations"},edit:{title:"Edit",items:"undo redo | cut copy paste pastetext | selectall | searchreplace"},view:{title:"View",items:"code | visualaid visualchars visualblocks | spellchecker | preview fullscreen | showcomments"},insert:{title:"Insert",items:"image link media addcomment pageembed template codesample inserttable | charmap emoticons hr | pagebreak nonbreaking anchor toc | insertdatetime"},format:{title:"Format",items:"bold italic underline strikethrough superscript subscript codeformat | formats blockformats fontformats fontsizes align lineheight | forecolor backcolor | removeformat"},tools:{title:"Tools",items:"spellchecker spellcheckerlanguage | a11ycheck code wordcount"},table:{title:"Table",items:"inserttable | cell row column | advtablesort | tableprops deletetable"},help:{title:"Help",items:"help"}},eB=function(n){return"string"==typeof n?n.split(" "):n},oB=function(n,t){var e=v(v({},tB),t.menus),o=Cn(t.menus).length>0,r=void 0===t.menubar||!0===t.menubar?eB("file edit view insert format tools table help"):eB(!1===t.menubar?"":t.menubar),c=filter(r,(function(n){return o&&t.menus.hasOwnProperty(n)&&t.menus[n].hasOwnProperty("items")||tB.hasOwnProperty(n)})),f=map(c,(function(o){var r=e[o];return function(menu,n,t){var e=function(n){return n.getParam("removed_menuitems","")}(t).split(/[ ,]/);return{text:menu.title,getItems:function(){return Z(menu.items,(function(i){var t=i.toLowerCase();return 0===t.trim().length||j(e,(function(n){return n===t}))?[]:"separator"===t||"|"===t?[{type:"separator"}]:n.menuItems[t]?[n.menuItems[t]]:[]}))}}}({title:r.title,items:eB(r.items)},t,n)}));return filter(f,(function(menu){return menu.getItems().length>0&&j(menu.getItems(),(function(n){return"separator"!==n.type}))}))},rB=function(n){var t=function(){n._skinLoaded=!0,function(n){n.fire("SkinLoaded")}(n)};return function(){n.initialized?t():n.on("init",t)}},iB=function(n,t,e){return new Cp((function(o,r){e.load(t,o,r),n.on("remove",(function(){return e.unload(t)}))}))},uB=function(n,t){return iB(n,t+"/skin.min.css",n.ui.styleSheetLoader)},aB=function(n,t){var e;return(e=he.fromDom(n.getElement()),Hi(e).isSome())?iB(n,t+"/skin.shadowdom.min.css",Lh.DOM.styleSheetLoader):Cp.resolve()},cB=function(n,t){var e=function(n){var t=n.getParam("skin"),e=n.getParam("skin_url");if(!1!==t){var o=t||"oxide";e=e?n.documentBaseURI.toAbsolute(e):ov.baseURL+"/skins/ui/"+o}return e}(t);e&&t.contentCSS.push(e+(n?"/content.inline":"/content")+".min.css"),!1===function(n){return!1===n.getParam("skin")}(t)&&E(e)?Cp.all([uB(t,e),aB(t,e)]).then(rB(t),function(n,t){return function(){return function(n,t){return n.fire("SkinLoadError",t)}(n,{message:t})}}(t,"Skin could not be loaded")):rB(t)()},iframe=c(cB,!1),sB=c(cB,!0),fB=function(n,t,e,o){var r=t.outerContainer,c=e.toolbar,f=e.buttons;if(V(c,E)){var l=c.map((function(t){var r={toolbar:t,buttons:f,allowToolbarGroups:e.allowToolbarGroups};return LE(n,r,{backstage:o},O.none())}));nB.setToolbars(r,l)}else nB.setToolbar(r,LE(n,e,{backstage:o},O.none()))},lB=He(),dB=lB.os.isiOS()&&lB.os.version.major<=12,mB=Object.freeze({__proto__:null,render:function(n,t,e,o,r){var c=ge(0),f=t.outerContainer;iframe(n);var l=he.fromDom(r.targetNode),d=Pi(Vi(l));!function(element,n){nf(element,n,Tr)}(l,t.mothership),Zs(d,t.uiMothership),n.on("PostRender",(function(){fB(n,t,e,o),c.set(n.getWin().innerWidth),nB.setMenubar(f,oB(n,e)),nB.setSidebar(f,e.sidebar),function(n,t){var e=n.dom,o=n.getWin(),r=n.getDoc().documentElement,c=ge(yu(o.innerWidth,o.innerHeight)),f=ge(yu(r.offsetWidth,r.offsetHeight)),l=function(){var t=c.get();t.left===o.innerWidth&&t.top===o.innerHeight||(c.set(yu(o.innerWidth,o.innerHeight)),Ob(n))},d=function(){var t=n.getDoc().documentElement,e=f.get();e.left===t.offsetWidth&&e.top===t.offsetHeight||(f.set(yu(t.offsetWidth,t.offsetHeight)),Ob(n))},m=function(t){return function(n,t){return n.fire("ScrollContent",t)}(n,t)};e.bind(o,"resize",l),e.bind(o,"scroll",m);var h=dy(he.fromDom(n.getBody()),"load",d),v=t.uiMothership.element;n.on("hide",(function(){Gi(v,"display","none")})),n.on("show",(function(){Zi(v,"display")})),n.on("NodeChange",d),n.on("remove",(function(){h.unbind(),e.unbind(o,"resize",l),e.unbind(o,"scroll",m),o=null}))}(n,t)}));var m,h,v,y=nB.getSocket(f).getOrDie("Could not find expected socket element");if(dB){Xi(y.element,{overflow:"scroll","-webkit-overflow-scrolling":"touch"});var x=(m=function(){n.fire("ScrollContent")},h=20,v=null,{cancel:function(){null!==v&&(clearTimeout(v),v=null)},throttle:function(){for(var n=[],t=0;t<arguments.length;t++)n[t]=arguments[t];null===v&&(v=setTimeout((function(){m.apply(null,n),v=null}),h))}}),w=ly(y.element,"scroll",x.throttle);n.on("remove",w.unbind)}Av(n,t),n.addCommand("ToggleSidebar",(function(t,e){nB.toggleSidebar(f,e),n.fire("ToggleSidebar")})),n.addQueryValueHandler("ToggleSidebar",(function(){return nB.whichSidebar(f)}));var S=pv(n);S!==Jp.sliding&&S!==Jp.floating||n.on("ResizeWindow ResizeEditor ResizeContent",(function(){var e=n.getWin().innerWidth;e!==c.get()&&(nB.refreshToolbar(t.outerContainer),c.set(e))}));var k={enable:function(){Bv(t,!1)},disable:function(){Bv(t,!0)},isDisabled:function(){return ev.isDisabled(f)}};return{iframeContainer:y.element.dom,editorContainer:f.element.dom,api:k}}}),gB=function(n){return/^[0-9\.]+(|px)$/i.test(""+n)?O.some(parseInt(""+n,10)):O.none()},pB=function(n){return R(n)?n+"px":n},hB=function(n,t,e){var o=t.filter((function(t){return n<t})),r=e.filter((function(t){return n>t}));return o.or(r).getOr(n)},vB=function(n){return function(n){var t=rv(n),e=av(n),o=sv(n);return gB(t).map((function(n){return hB(n,e,o)}))}(n).getOr(rv(n))},bB=function(n){var t=iv(n),e=uv(n),o=cv(n);return gB(t).map((function(n){return hB(n,e,o)}))},yB=function(n,t,e,o,r){var c=e.uiMothership,f=e.outerContainer,l=Lh.DOM,d=wv(n),m=Cv(n),h=cv(n).or(bB(n)),v=o.shared.header,y=v.isPositionedAtTop,x=pv(n),w=x===Jp.sliding||x===Jp.floating,S=ge(!1),k=function(){return S.get()&&!n.removed},C=function(n){return w?n.fold((function(){return 0}),(function(n){return n.components().length>1?hu(n.components()[1].element):0})):0},O=function(){c.broadcastOn([gf()],{})},_=function(n){if(void 0===n&&(n=!1),k()){var e;if(d||(e=h.getOrThunk((function(){var n=gB(qi(body(),"margin-left")).getOr(0);return Cu(body())-wu(t).left+n})),Gi(r.get().element,"max-width",e+"px")),w&&nB.refreshToolbar(f),d||function(){var n=nB.getToolbar(f),e=C(n),o=Pu(t),c=y()?Math.max(o.y-hu(r.get().element)+e,0):o.bottom;Xi(f.element,{position:"absolute",top:Math.round(c)+"px",left:Math.round(o.x)+"px"})}(),m){var o=r.get();n?CD.reset(o):CD.refresh(o)}O()}},T=function(e){if(void 0===e&&(e=!0),!d&&m&&k()){var o=v.getDockingMode(),c=function(e){switch(bv(n)){case gv.auto:var o=nB.getToolbar(f),r=C(o),c=hu(e.element)-r,l=Pu(t);if(l.y>c)return"top";var d=xr(t),m=Math.max(d.dom.scrollHeight,hu(d));return l.bottom<m-c||zu().bottom<l.bottom-c?"bottom":"top";case gv.bottom:return"bottom";case gv.top:default:return"top"}}(r.get());c!==o&&(!function(n){var t=r.get();CD.setModes(t,[n]),v.setDockingMode(n);var e=y()?$u.TopToBottom:$u.BottomToTop;Pr(t.element,Vc,e)}(c),e&&_(!0))}};return{isVisible:k,isPositionedAtTop:y,show:function(){S.set(!0),Gi(f.element,"display","flex"),l.addClass(n.getBody(),"mce-edit-focus"),Zi(c.element,"display"),T(!1),_()},hide:function(){S.set(!1),e.outerContainer&&(Gi(f.element,"display","none"),l.removeClass(n.getBody(),"mce-edit-focus")),Gi(c.element,"display","none")},update:_,updateMode:T,repositionPopups:O}},xB=function(n,t){var e=Pu(n);return{pos:t?e.y:e.bottom,bounds:e}},wB=Object.freeze({__proto__:null,render:function(n,t,e,o,r){var c=t.mothership,f=t.uiMothership,l=t.outerContainer,d=ge(null),m=he.fromDom(r.targetNode),h=yB(n,m,t,o,d),v=function(n){return n.getParam("toolbar_persist",!1,"boolean")}(n);sB(n);var y=function(){if(d.get())h.show();else{d.set(nB.getHeader(l).getOrDie());var r=Sv(n);Zs(r,c),Zs(r,f),fB(n,t,e,o),nB.setMenubar(l,oB(n,e)),h.show(),function(n,t,e,o){var r=ge(xB(t,e.isPositionedAtTop())),c=function(o){var c=xB(t,e.isPositionedAtTop()),f=c.pos,l=c.bounds,d=r.get(),m=d.pos,h=d.bounds,v=l.height!==h.height||l.width!==h.width;r.set({pos:f,bounds:l}),v&&Ob(n,o),e.isVisible()&&(m!==f?e.update(!0):v&&(e.updateMode(),e.repositionPopups()))};o||(n.on("activate",e.show),n.on("deactivate",e.hide)),n.on("SkinLoaded ResizeWindow",(function(){return e.update(!0)})),n.on("NodeChange keydown",(function(n){ep.requestAnimationFrame((function(){return c(n)}))})),n.on("ScrollWindow",(function(){return e.updateMode()}));var f=BE();f.set(dy(he.fromDom(n.getBody()),"load",c)),n.on("remove",(function(){f.clear()}))}(n,m,h,v),n.nodeChanged()}};n.on("show",y),n.on("hide",h.hide),v||(n.on("focus",y),n.on("blur",h.hide)),n.on("init",(function(){(n.hasFocus()||v)&&y()})),Av(n,t);var x={show:function(){h.show()},hide:function(){h.hide()},enable:function(){Bv(t,!1)},disable:function(){Bv(t,!0)},isDisabled:function(){return ev.isDisabled(l)}};return{editorContainer:l.element.dom,api:x}}}),SB=function(n,t){!function(n,t){var e=dE(0,t,yE(n));n.ui.registry.addNestedMenuItem("align",{text:t.shared.providers.translate("Align"),getSubmenuItems:function(){return e.items.validateItems(e.getStyleItems())}})}(n,t),function(n,t){var e=dE(0,t,SE(n));n.ui.registry.addNestedMenuItem("fontformats",{text:t.shared.providers.translate("Fonts"),getSubmenuItems:function(){return e.items.validateItems(e.getStyleItems())}})}(n,t),function(n,t){var e=v({type:"advanced"},t.styleselect),o=dE(0,t,IE(n,e));n.ui.registry.addNestedMenuItem("formats",{text:"Formats",getSubmenuItems:function(){return o.items.validateItems(o.getStyleItems())}})}(n,t),function(n,t){var e=dE(0,t,FE(n));n.ui.registry.addNestedMenuItem("blockformats",{text:"Blocks",getSubmenuItems:function(){return e.items.validateItems(e.getStyleItems())}})}(n,t),function(n,t){var e=dE(0,t,_E(n));n.ui.registry.addNestedMenuItem("fontsizes",{text:"Font sizes",getSubmenuItems:function(){return e.items.validateItems(e.getStyleItems())}})}(n,t)},kB=function(n,t){return function(){n.execCommand("mceToggleFormat",!1,t)}},CB=function(n){!function(n){YS.each([{name:"bold",text:"Bold",icon:"bold"},{name:"italic",text:"Italic",icon:"italic"},{name:"underline",text:"Underline",icon:"underline"},{name:"strikethrough",text:"Strikethrough",icon:"strike-through"},{name:"subscript",text:"Subscript",icon:"subscript"},{name:"superscript",text:"Superscript",icon:"superscript"}],(function(t,e){n.ui.registry.addToggleButton(t.name,{tooltip:t.text,icon:t.icon,onSetup:AE(n,t.name),onAction:kB(n,t.name)})}));for(var i=1;i<=6;i++){var t="h"+i;n.ui.registry.addToggleButton(t,{text:t.toUpperCase(),tooltip:"Heading "+i,onSetup:AE(n,t),onAction:kB(n,t)})}}(n),function(n){YS.each([{name:"cut",text:"Cut",action:"Cut",icon:"cut"},{name:"copy",text:"Copy",action:"Copy",icon:"copy"},{name:"paste",text:"Paste",action:"Paste",icon:"paste"},{name:"help",text:"Help",action:"mceHelp",icon:"help"},{name:"selectall",text:"Select all",action:"SelectAll",icon:"select-all"},{name:"newdocument",text:"New document",action:"mceNewDocument",icon:"new-document"},{name:"removeformat",text:"Clear formatting",action:"RemoveFormat",icon:"remove-formatting"},{name:"remove",text:"Remove",action:"Delete",icon:"remove"}],(function(t){n.ui.registry.addButton(t.name,{tooltip:t.text,icon:t.icon,onAction:function(){return n.execCommand(t.action)}})}))}(n),function(n){YS.each([{name:"blockquote",text:"Blockquote",action:"mceBlockQuote",icon:"quote"}],(function(t){n.ui.registry.addToggleButton(t.name,{tooltip:t.text,icon:t.icon,onAction:function(){return n.execCommand(t.action)},onSetup:AE(n,t.name)})}))}(n)},OB=function(n){CB(n),function(n){YS.each([{name:"bold",text:"Bold",action:"Bold",icon:"bold",shortcut:"Meta+B"},{name:"italic",text:"Italic",action:"Italic",icon:"italic",shortcut:"Meta+I"},{name:"underline",text:"Underline",action:"Underline",icon:"underline",shortcut:"Meta+U"},{name:"strikethrough",text:"Strikethrough",action:"Strikethrough",icon:"strike-through",shortcut:""},{name:"subscript",text:"Subscript",action:"Subscript",icon:"subscript",shortcut:""},{name:"superscript",text:"Superscript",action:"Superscript",icon:"superscript",shortcut:""},{name:"removeformat",text:"Clear formatting",action:"RemoveFormat",icon:"remove-formatting",shortcut:""},{name:"newdocument",text:"New document",action:"mceNewDocument",icon:"new-document",shortcut:""},{name:"cut",text:"Cut",action:"Cut",icon:"cut",shortcut:"Meta+X"},{name:"copy",text:"Copy",action:"Copy",icon:"copy",shortcut:"Meta+C"},{name:"paste",text:"Paste",action:"Paste",icon:"paste",shortcut:"Meta+V"},{name:"selectall",text:"Select all",action:"SelectAll",icon:"select-all",shortcut:"Meta+A"}],(function(t){n.ui.registry.addMenuItem(t.name,{text:t.text,icon:t.icon,shortcut:t.shortcut,onAction:function(){return n.execCommand(t.action)}})})),n.ui.registry.addMenuItem("codeformat",{text:"Code",icon:"sourcecode",onAction:kB(n,"code")})}(n)},_B=function(n,t,e){var o=function(){return!!t.undoManager&&t.undoManager[e]()},r=function(){n.setDisabled(t.mode.isReadOnly()||!o())};return n.setDisabled(!o()),t.on("Undo Redo AddUndo TypingUndo ClearUndos SwitchMode",r),function(){return t.off("Undo Redo AddUndo TypingUndo ClearUndos SwitchMode",r)}},TB=function(n){!function(n){n.ui.registry.addMenuItem("undo",{text:"Undo",icon:"undo",shortcut:"Meta+Z",onSetup:function(t){return _B(t,n,"hasUndo")},onAction:function(){return n.execCommand("undo")}}),n.ui.registry.addMenuItem("redo",{text:"Redo",icon:"redo",shortcut:"Meta+Y",onSetup:function(t){return _B(t,n,"hasRedo")},onAction:function(){return n.execCommand("redo")}})}(n),function(n){n.ui.registry.addButton("undo",{tooltip:"Undo",icon:"undo",onSetup:function(t){return _B(t,n,"hasUndo")},onAction:function(){return n.execCommand("undo")}}),n.ui.registry.addButton("redo",{tooltip:"Redo",icon:"redo",onSetup:function(t){return _B(t,n,"hasRedo")},onAction:function(){return n.execCommand("redo")}})}(n)},EB={unsupportedLength:["em","ex","cap","ch","ic","rem","lh","rlh","vw","vh","vi","vb","vmin","vmax","cm","mm","Q","in","pc","pt","px"],fixed:["px","pt"],relative:["%"],empty:[""]},pattern=(pE=["Infinity","[0-9]+\\."+(gE=function(input){return"(?:"+input+")?"})("[0-9]+")+gE("[eE][+-]?[0-9]+"),"\\.[0-9]+"+gE("[eE][+-]?[0-9]+"),"[0-9]+"+gE("[eE][+-]?[0-9]+")].join("|"),new RegExp("^([+-]?(?:"+pE+"))(.*)$")),DB=function(input,n){return O.from(pattern.exec(input)).bind((function(t){var e=Number(t[1]),o=t[2];return function(n,t){return j(t,(function(t){return j(EB[t],(function(t){return n===t}))}))}(o,n)?O.some({value:e,unit:o}):O.none()}))},BB=function(input){return function(input,n){return DB(input,n).map((function(n){return n.value+n.unit}))}(input,["fixed","relative","empty"]).getOr(input)},AB=function(n){var t=function(n){return n.getParam("lineheight_formats","1 1.1 1.2 1.3 1.4 1.5 2","string").split(" ")}(n),e=new Map,o=DE(),r=function(){var t=BB(n.queryCommandValue("LineHeight"));O.from(e.get(t)).fold((function(){return o.clear()}),(function(n){o.set({destroy:function(){n.setActive(!1)}}),n.setActive(!0)}))};return n.on("nodeChange",r),map(t,(function(c,i){return{type:"togglemenuitem",text:c,onSetup:function(f){return e.set(BB(c),f),i+1===t.length&&r(),function(){0===i&&(n.off("nodeChange",r),o.clear())}},onAction:function(){return n.execCommand("LineHeight",!1,c)}}}))},MB=function(n){!function(n){n.ui.registry.addNestedMenuItem("lineheight",{type:"nestedmenuitem",text:"Line height",getSubmenuItems:function(){return AB(n)}})}(n),function(n){n.ui.registry.addMenuButton("lineheight",{tooltip:"Line height",icon:"line-height",fetch:function(t){return t(AB(n))}})}(n)},FB=function(n,t){!function(n){YS.each([{name:"alignleft",text:"Align left",cmd:"JustifyLeft",icon:"align-left"},{name:"aligncenter",text:"Align center",cmd:"JustifyCenter",icon:"align-center"},{name:"alignright",text:"Align right",cmd:"JustifyRight",icon:"align-right"},{name:"alignjustify",text:"Justify",cmd:"JustifyFull",icon:"align-justify"}],(function(t){n.ui.registry.addToggleButton(t.name,{tooltip:t.text,onAction:function(){return n.execCommand(t.cmd)},icon:t.icon,onSetup:AE(n,t.name)})}));var t="alignnone",e="No alignment",o="JustifyNone",r="align-none";n.ui.registry.addButton(t,{tooltip:e,onAction:function(){return n.execCommand(o)},icon:r})}(n),OB(n),SB(n,t),TB(n),function(n){!function(n){n.addCommand("mceApplyTextcolor",(function(t,e){!function(n,t,e){n.undoManager.transact((function(){n.focus(),n.formatter.apply(t,{value:e}),n.nodeChanged()}))}(n,t,e)})),n.addCommand("mceRemoveTextcolor",(function(t){!function(n,t){n.undoManager.transact((function(){n.focus(),n.formatter.remove(t,{value:null},null,!0),n.nodeChanged()}))}(n,t)}))}(n);var t=ge(null),e=ge(null);Hb(n,"forecolor","forecolor","Text color",t),Hb(n,"backcolor","hilitecolor","Background color",e),zb(n,"forecolor","forecolor","Text color"),zb(n,"backcolor","hilitecolor","Background color")}(n),function(n){!function(n){n.ui.registry.addButton("visualaid",{tooltip:"Visual aids",text:"Visual aids",onAction:function(){return n.execCommand("mceToggleVisualAid")}})}(n),function(n){n.ui.registry.addToggleMenuItem("visualaid",{text:"Visual aids",onSetup:function(t){return function(n,t){n.setActive(t.hasVisual);var e=function(t){n.setActive(t.hasVisual)};return t.on("VisualAid",e),function(){return t.off("VisualAid",e)}}(t,n)},onAction:function(){n.execCommand("mceToggleVisualAid")}})}(n)}(n),function(n){!function(n){n.ui.registry.addButton("outdent",{tooltip:"Decrease indent",icon:"outdent",onSetup:function(t){return function(n,t){n.setDisabled(!t.queryCommandState("outdent"));var e=function(){n.setDisabled(!t.queryCommandState("outdent"))};return t.on("NodeChange",e),function(){return t.off("NodeChange",e)}}(t,n)},onAction:function(){return n.execCommand("outdent")}}),n.ui.registry.addButton("indent",{tooltip:"Increase indent",icon:"indent",onAction:function(){return n.execCommand("indent")}})}(n)}(n),MB(n)},IB=function(n,t){return{anchor:"makeshift",x:n,y:t}},RB=function(n){return"longpress"===n.type||0===n.type.indexOf("touch")},VB=function(element,n){var t=Lh.DOM.getPos(element);return function(n,t,e){return IB(n.x+t,n.y+e)}(n,t.x,t.y)},PB=function(n,t){return"contextmenu"===t.type||"longpress"===t.type?n.inline?function(n){if(RB(n)){var t=n.touches[0];return IB(t.pageX,t.pageY)}return IB(n.pageX,n.pageY)}(t):VB(n.getContentAreaContainer(),function(n){if(RB(n)){var t=n.touches[0];return IB(t.clientX,t.clientY)}return IB(n.clientX,n.clientY)}(t)):HB(n)},HB=function(n){return{anchor:"selection",root:he.fromDom(n.selection.getNode())}},zB=function(n){return{anchor:"node",node:O.some(he.fromDom(n.selection.getNode())),root:he.fromDom(n.getBody())}},NB=function(n,t,e,o,r,c){var f=e(),l=c?zB(n):PB(n,t);lC(f,Kp.CLOSE_ON_EXECUTE,o,!1).map((function(n){t.preventDefault(),Wg.showMenuAt(r,l,{menu:{markers:uh("normal")},data:n})}))},LB={onLtr:function(){return[Pa,Ma,Fa,Ia,Ra,Va,np,tp,Qg,Kg,Zg,$g]},onRtl:function(){return[Pa,Fa,Ma,Ra,Ia,Va,np,tp,Zg,$g,Qg,Kg]}},jB={valignCentre:[],alignCentre:[],alignLeft:["tox-pop--align-left"],alignRight:["tox-pop--align-right"],right:["tox-pop--right"],left:["tox-pop--left"],bottom:["tox-pop--bottom"],top:["tox-pop--top"]},UB=function(n,t,e,o,r,c,f){var l=c?zB(n):function(n,t){return v({bubble:Mc(0,12,jB),layouts:LB,overrides:{maxWidthFunction:E_(),maxHeightFunction:Ec()}},PB(n,t))}(n,t);lC(e,Kp.CLOSE_ON_EXECUTE,o,!0).map((function(e){t.preventDefault(),Wg.showMenuWithinBounds(r,l,{menu:{markers:uh("normal"),highlightImmediately:f},data:e,type:"horizontal"},(function(){return O.some(oE(n,o.shared))})),n.fire("contexttoolbar-hide")}))},WB=function(n,t,e,o,r,c){var f=He(),l=f.os.isiOS(),d=f.os.isOSX(),m=f.os.isAndroid(),h=f.deviceType.isTouch(),v=function(){var f=e();UB(n,t,f,o,r,c,!(m||l||d&&h))};if(!d&&!l||c)m&&!c&&n.selection.setCursorLocation(t.target,0),v();else{var y=function(){!function(n){var t=n.selection.getRng(),e=function(){ep.setEditorTimeout(n,(function(){n.selection.setRng(t)}),10),c()};n.once("touchend",e);var o=function(n){n.preventDefault(),n.stopImmediatePropagation()};n.on("mousedown",o,!0);var r=function(){return c()};n.once("longpresscancel",r);var c=function(){n.off("touchend",e),n.off("longpresscancel",r),n.off("mousedown",o)}}(n),v()};!function(n,t){var e=n.selection;if(e.isCollapsed()||t.touches.length<1)return!1;var o=t.touches[0],r=e.getRng();return ss(n.getWin(),Xc.domRange(r)).exists((function(n){return n.left<=o.clientX&&n.right>=o.clientX&&n.top<=o.clientY&&n.bottom>=o.clientY}))}(n,t)?(n.once("selectionchange",y),n.once("touchend",(function(){return n.off("selectionchange",y)}))):y()}},GB=function(n){return"string"==typeof n?n.split(/[ ,]/):n},XB=function(n){return n.getParam("contextmenu_never_use_native",!1,"boolean")},YB=function(n){return function(n,t,e){var o=n.ui.registry.getAll().contextMenus;return O.from(n.getParam(t)).map(GB).getOrThunk((function(){return filter(GB(e),(function(n){return In(o,n)}))}))}(n,"contextmenu","link linkchecker image imagetools table spellchecker configurepermanentpen")},qB=function(n){return E(n)?"|"===n:"separator"===n.type},JB={type:"separator"},KB=function(n){if(E(n))return n;switch(n.type){case"separator":return JB;case"submenu":return{type:"nestedmenuitem",text:n.text,icon:n.icon,getSubmenuItems:function(){var t=n.getSubmenuItems();return E(t)?t:map(t,KB)}};default:return{type:"menuitem",text:n.text,icon:n.icon,onAction:(t=n.onAction,function(){return t()})}}var t},$B=function(n,t){if(0===t.length)return n;var e=un(n).filter((function(n){return!qB(n)})).fold((function(){return[]}),(function(n){return[JB]}));return n.concat(e).concat(t).concat([JB])},QB=function(n,t){return"longpress"!==t.type&&(2!==t.button||t.target===n.getBody()&&""===t.pointerType)},ZB=function(n,t){return QB(n,t)?n.selection.getStart(!0):t.target},nA=function(n,t,e){var o=He().deviceType.isTouch,r=du(Wg.sketch({dom:{tag:"div"},lazySink:t,onEscape:function(){return n.focus()},onShow:function(){return e.setContextMenuState(!0)},onHide:function(){return e.setContextMenuState(!1)},fireDismissalEventInstead:{},inlineBehaviours:Qa([ig("dismissContextMenu",[$o(Io(),(function(t,e){df.close(t),n.focus()}))])])})),c=function(n){return Wg.hide(r)},f=function(t){if(XB(n)&&t.preventDefault(),!function(n,t){return t.ctrlKey&&!XB(n)}(n,t)&&!function(n){return!1===n.getParam("contextmenu")}(n)){var c=function(n,t){var e=function(n){return n.getParam("contextmenu_avoid_overlap","","string")}(n);if(QB(n,t))return!0;if(e){var o=ZB(n,t);return gy(he.fromDom(o),e)}return!1}(n,t);(o()?WB:NB)(n,t,(function(){var e=ZB(n,t),o=n.ui.registry.getAll(),r=YB(n);return function(n,t,e){var o=J(t,(function(t,o){if(In(n,o)){var r=n[o].update(e);if(E(r))return $B(t,r.split(" "));if(r.length>0){var c=map(r,KB);return $B(t,c)}return t}return t.concat([o])}),[]);return o.length>0&&qB(o[o.length-1])&&o.pop(),o}(o.contextMenus,r,e)}),e,r,c)}};n.on("init",(function(){var t="ResizeEditor ScrollContent ScrollWindow longpresscancel"+(o()?"":" ResizeWindow");n.on(t,c),n.on("longpress contextmenu",f)}))},tA=Vn([{offset:["x","y"]},{absolute:["x","y"]},{fixed:["x","y"]}]),eA=function(n){return function(t){return t.translate(-n.left,-n.top)}},oA=function(n){return function(t){return t.translate(n.left,n.top)}},rA=function(n){return function(t,e){return J(n,(function(n,t){return t(n)}),yu(t,e))}},iA=function(n,t,e){return n.fold(rA([oA(e),eA(t)]),rA([eA(t)]),rA([]))},uA=function(n,t,e){return n.fold(rA([oA(e)]),rA([]),rA([oA(t)]))},aA=function(n,t,e){return n.fold(rA([]),rA([eA(e)]),rA([oA(t),eA(e)]))},cA=function(n,t,e){var o=n.fold((function(n,t){return{position:O.some("absolute"),left:O.some(n+"px"),top:O.some(t+"px")}}),(function(n,t){return{position:O.some("absolute"),left:O.some(n-e.left+"px"),top:O.some(t-e.top+"px")}}),(function(n,t){return{position:O.some("fixed"),left:O.some(n+"px"),top:O.some(t+"px")}}));return v({right:O.none(),bottom:O.none()},o)},sA=function(n,t,e,o){var r=function(n,r){return function(c,f){var l=n(t,e,o);return r(c.getOr(l.left),f.getOr(l.top))}};return n.fold(r(aA,fA),r(uA,lA),r(iA,dA))},fA=tA.offset,lA=tA.absolute,dA=tA.fixed,mA=function(element,n){var t=Hr(element,n);return M(t)?NaN:parseInt(t,10)},gA=function(component,n,t,e){return function(component,n){var element=component.element,t=mA(element,n.leftAttr),e=mA(element,n.topAttr);return isNaN(t)||isNaN(e)?O.none():O.some(yu(t,e))}(component,n).fold((function(){return t}),(function(n){return dA(n.left+e.left,n.top+e.top)}))},pA=function(component,n,t,e,o,r){var c=gA(component,n,t,e),f=n.mustSnap?bA(component,n,c,o,r):yA(component,n,c,o,r),l=iA(c,o,r);return function(component,n,t){var element=component.element;Pr(element,n.leftAttr,t.left+"px"),Pr(element,n.topAttr,t.top+"px")}(component,n,l),f.fold((function(){return{coord:dA(l.left,l.top),extra:O.none()}}),(function(n){return{coord:n.output,extra:n.extra}}))},hA=function(component,n){!function(component,n){var element=component.element;Lr(element,n.leftAttr),Lr(element,n.topAttr)}(component,n)},vA=function(n,t,e,o){return cn(n,(function(n){var r=n.sensor;return function(n,t,e,o,r,c){var f=uA(n,r,c),l=uA(t,r,c);return Math.abs(f.left-l.left)<=e&&Math.abs(f.top-l.top)<=o}(t,r,n.range.left,n.range.top,e,o)?O.some({output:sA(n.output,t,e,o),extra:n.extra}):O.none()}))},bA=function(component,n,t,e,o){var r=n.getSnapPoints(component);return vA(r,t,e,o).orThunk((function(){return J(r,(function(n,r){var c=r.sensor,f=function(n,t,e,o,r,c){var f=uA(n,r,c),l=uA(t,r,c),d=Math.abs(f.left-l.left),m=Math.abs(f.top-l.top);return yu(d,m)}(t,c,r.range.left,r.range.top,e,o);return n.deltas.fold((function(){return{deltas:O.some(f),snap:O.some(r)}}),(function(t){return(f.left+f.top)/2<=(t.left+t.top)/2?{deltas:O.some(f),snap:O.some(r)}:n}))}),{deltas:O.none(),snap:O.none()}).snap.map((function(n){return{output:sA(n.output,t,e,o),extra:n.extra}}))}))},yA=function(component,n,t,e,o){var r=n.getSnapPoints(component);return vA(r,t,e,o)},xA=Object.freeze({__proto__:null,snapTo:function(component,n,t,e){var o=n.getTarget(component.element);if(n.repositionTarget){var r=vr(component.element),c=Du(r),f=iD(o),l=function(n,t,e){return{coord:sA(n.output,n.output,t,e),extra:n.extra}}(e,c,f),d=cA(l.coord,0,f);Yi(o,d)}}}),wA=function(n,t){n.getSystem().addToGui(t),function(n){Sr(n.element).filter(dr).each((function(t){Ki(t,"z-index").each((function(n){Pr(t,"data-initial-z-index",n)})),Gi(t,"z-index",qi(n.element,"z-index"))}))}(t)},SA=function(n){!function(n){Sr(n.element).filter(dr).each((function(n){zr(n,"data-initial-z-index").fold((function(){return Zi(n,"z-index")}),(function(t){return Gi(n,"z-index",t)})),Lr(n,"data-initial-z-index")}))}(n),n.getSystem().removeFromGui(n)},kA=function(component,n,t){return component.getSystem().build(Dy.sketch({dom:{styles:{left:"0px",top:"0px",width:"100%",height:"100%",position:"fixed","z-index":"1000000000000000"},classes:[n]},events:t}))},CA=oe("snaps",[Wt("getSnapPoints"),sa("onSensor"),Wt("leftAttr"),Wt("topAttr"),re("lazyViewport",zu),re("mustSnap",!1)]),OA=[re("useFixed",d),Wt("blockerClass"),re("getTarget",r),re("onDrag",t),re("repositionTarget",!0),re("onDrop",t),fe("getBounds",zu),CA],_A=function(n){return(t=Ki(n,"left"),e=Ki(n,"top"),o=Ki(n,"position"),r=function(n,t,e){return("fixed"===e?dA:fA)(parseInt(n,10),parseInt(t,10))},t.isSome()&&e.isSome()&&o.isSome()?O.some(r(t.getOrDie(),e.getOrDie(),o.getOrDie())):O.none()).getOrThunk((function(){var t=wu(n);return lA(t.left,t.top)}));var t,e,o,r},TA=function(component,n,t,e,o,r,c){return function(component,n,t,e,o){var r=o.bounds,c=uA(n,t,e),f=wc(c.left,r.x,r.x+r.width-o.width),l=wc(c.top,r.y,r.y+r.height-o.height),d=lA(f,l);return n.fold((function(){var n=aA(d,t,e);return fA(n.left,n.top)}),(function(){return d}),(function(){var n=iA(d,t,e);return dA(n.left,n.top)}))}(0,n.fold((function(){var n,c,f,l=(n=t,c=r.left,f=r.top,n.fold((function(n,t){return fA(n+c,t+f)}),(function(n,t){return lA(n+c,t+f)}),(function(n,t){return dA(n+c,t+f)}))),d=iA(l,e,o);return dA(d.left,d.top)}),(function(n){var c=pA(component,n,t,r,e,o);return c.extra.each((function(t){n.onSensor(component,t)})),c.coord})),e,o,c)},EA=function(n,t){return{bounds:n.getBounds(),height:vu(t.element),width:Ou(t.element)}},DA=function(component,n,t,e,o){var r=t.update(e,o),c=t.getStartData().getOrThunk((function(){return EA(n,component)}));r.each((function(t){!function(component,n,t,e){var o=n.getTarget(component.element);if(n.repositionTarget){var r=vr(component.element),c=Du(r),f=iD(o),l=_A(o),d=TA(component,n.snaps,l,c,f,e,t),m=cA(d,0,f);Yi(o,m)}n.onDrag(component,o,e)}(component,n,c,t)}))},BA=function(component,n,t,e){n.each(SA),t.snaps.each((function(n){hA(component,n)}));var o=t.getTarget(component.element);e.reset(),t.onDrop(component,o)},AA=function(n){return function(t,e){var o=function(n){e.setStartData(EA(t,n))};return qo(x([$o(Bo(),(function(n){e.getStartData().each((function(){return o(n)}))}))],n(t,e,o)))}},MA=Object.freeze({__proto__:null,getData:function(n){return O.from(yu(n.x,n.y))},getDelta:function(n,t){return yu(t.left-n.left,t.top-n.top)}}),FA=function(n,t,e){return[$o(to(),(function(component,o){if(0===o.event.raw.button){o.stop();var r=function(){return BA(component,O.some(l),n,t)},c=py(r,200),f={drop:r,delayDrop:c.schedule,forceDrop:r,move:function(e){c.cancel(),DA(component,n,t,MA,e)}},l=kA(component,n.blockerClass,function(n){return qo([$o(to(),n.forceDrop),$o(ro(),n.drop),$o(eo(),(function(t,e){n.move(e.event)})),$o(oo(),n.delayDrop)])}(f));e(component),wA(component,l)}}))]},IA=x(OA,[output("dragger",{handlers:AA(FA)})]),RA=Object.freeze({__proto__:null,getData:function(n){var t=n.raw.touches;return 1===t.length?function(n){var t=n[0];return O.some(yu(t.clientX,t.clientY))}(t):O.none()},getDelta:function(n,t){return yu(t.left-n.left,t.top-n.top)}}),VA=function(n,t,e){var o=ge(O.none());return[$o($e(),(function(component,r){r.stop();var c=function(){BA(component,o.get(),n,t),o.set(O.none())},f={drop:c,delayDrop:function(){},forceDrop:c,move:function(e){DA(component,n,t,RA,e)}},l=kA(component,n.blockerClass,function(n){return qo([$o($e(),n.forceDrop),$o(Ze(),n.drop),$o(no(),n.drop),$o(Qe(),(function(t,e){n.move(e.event)}))])}(f));o.set(O.some(l));e(component),wA(component,l)})),$o(Qe(),(function(component,e){e.stop(),DA(component,n,t,RA,e.event)})),$o(Ze(),(function(component,e){e.stop(),BA(component,o.get(),n,t),o.set(O.none())})),$o(no(),(function(component){BA(component,o.get(),n,t),o.set(O.none())}))]},PA=IA,HA=x(OA,[output("dragger",{handlers:AA(VA)})]),zA=x(OA,[output("dragger",{handlers:AA((function(n,t,e){return x(FA(n,t,e),VA(n,t,e))}))})]),NA=ec({branchKey:"mode",branches:Object.freeze({__proto__:null,mouse:PA,touch:HA,mouseOrTouch:zA}),name:"dragging",active:{events:function(n,t){return n.dragger.handlers(n,t)}},extra:{snap:function(n){return{sensor:n.sensor,range:n.range,output:n.output,extra:O.from(n.extra)}}},state:Object.freeze({__proto__:null,init:function(){var n=O.none(),t=O.none(),e=o({});return fi({readState:e,reset:function(){n=O.none(),t=O.none()},update:function(t,e){return t.getData(e).bind((function(e){return function(t,e){var o=n.map((function(n){return t.getDelta(n,e)}));return n=O.some(e),o}(t,e)}))},getStartData:function(){return t},setStartData:function(data){t=O.some(data)}})}}),apis:xA}),LA=function(n,td,t,e,o,r){return n.fold((function(){return NA.snap({sensor:lA(t-20,e-20),range:yu(o,r),output:lA(O.some(t),O.some(e)),extra:{td:td}})}),(function(n){var o=t-20,r=e-20,rect=n.element.dom.getBoundingClientRect();return NA.snap({sensor:lA(o,r),range:yu(40,40),output:lA(O.some(t-rect.width/2),O.some(e-rect.height/2)),extra:{td:td}})}))},jA=function(n,t,e){return{getSnapPoints:n,leftAttr:"data-drag-left",topAttr:"data-drag-top",onSensor:function(component,n){var td=n.td;(function(n,td){return n.exists((function(n){return Le(n,td)}))})(t.get(),td)||(t.set(O.some(td)),e(td))},mustSnap:!0}},UA=function(n){return ip(op.sketch({dom:{tag:"div",classes:["tox-selector"]},buttonBehaviours:Qa([NA.config({mode:"mouseOrTouch",blockerClass:"blocker",snaps:n}),jx.config({})]),eventOrder:{mousedown:["dragging","alloy.base.behaviour"],touchstart:["dragging","alloy.base.behaviour"]}}))},WA=function(n,t){var e=ge([]),o=ge([]),r=ge(!1),c=ge(O.none()),f=ge(O.none()),l=function(td){var n=Hu(td);return LA(v.getOpt(t),td,n.x,n.y,n.width,n.height)},d=function(td){var n=Hu(td);return LA(y.getOpt(t),td,n.right,n.bottom,n.width,n.height)},m=jA((function(){return map(e.get(),(function(td){return l(td)}))}),c,(function(t){f.get().each((function(e){n.fire("TableSelectorChange",{start:t,finish:e})}))})),h=jA((function(){return map(o.get(),(function(td){return d(td)}))}),f,(function(t){c.get().each((function(e){n.fire("TableSelectorChange",{start:e,finish:t})}))})),v=UA(m),y=UA(h),x=du(v.asSpec()),w=du(y.asSpec()),S=function(t,e,o,r){var c=o(e);NA.snapTo(t,c);!function(t,e,o,r){var c=e.dom.getBoundingClientRect();Zi(t.element,"display");var f=wr(he.fromDom(n.getBody())).dom.innerHeight,l=o(c),d=r(c,f);(l||d)&&Gi(t.element,"display","none")}(t,e,(function(rect){return rect[r]<0}),(function(rect,n){return rect[r]>n}))},k=function(n){return S(x,n,l,"top")},C=function(n){return S(w,n,d,"bottom")};He().deviceType.isTouch()&&(n.on("TableSelectionChange",(function(n){r.get()||(qs(t,x),qs(t,w),r.set(!0)),c.set(O.some(n.start)),f.set(O.some(n.finish)),n.otherCells.each((function(t){e.set(t.upOrLeftCells),o.set(t.downOrRightCells),k(n.start),C(n.finish)}))})),n.on("ResizeEditor ResizeWindow ScrollContent",(function(){c.get().each(k),f.get().each(C)})),n.on("TableSelectionClear",(function(){r.get()&&($s(x),$s(w),r.set(!1)),c.set(O.none()),f.set(O.none())})))};!function(n){n[n.None=0]="None",n[n.Both=1]="Both",n[n.Vertical=2]="Vertical"}(hE||(hE={}));var GA=function(n,t,e){var o=he.fromDom(n.getContainer()),r=function(n,t,e,o,r){var c={};return c.height=hB(o+t.top,av(n),sv(n)),e===hE.Both&&(c.width=hB(r+t.left,uv(n),cv(n))),c}(n,t,e,hu(o),Cu(o));_n(r,(function(n,t){return Gi(o,t,pB(n))})),function(n){n.fire("ResizeEditor")}(n)},XA=function(n){if(1===n.nodeType){if("BR"===n.nodeName||n.getAttribute("data-mce-bogus"))return!0;if("bookmark"===n.getAttribute("data-mce-type"))return!0}return!1},YA=function(n,t,e){t.delimiter||(t.delimiter="");return{dom:{tag:"div",classes:["tox-statusbar__path"],attributes:{role:"navigation"}},behaviours:Qa([Zm.config({mode:"flow",selector:"div[role=button]"}),ev.config({disabled:e.isDisabled}),Mv(),Vy.config({}),rg.config({}),ig("elementPathEvents",[ur((function(o,r){n.shortcuts.add("alt+F11","focus statusbar elementpath",(function(){return Zm.focusIn(o)})),n.on("NodeChange",(function(r){var c,f,l=function(t){for(var e=[],i=t.length;i-- >0;){var o=t[i];if(1===o.nodeType&&!XA(o)){var r=n.fire("ResolveName",{name:o.nodeName.toLowerCase(),target:o});if(r.isDefaultPrevented()||e.push({name:r.name,element:o}),r.isPropagationStopped())break}}return e}(r.parents);l.length>0?rg.set(o,(c=map(l||[],(function(t,o){return op.sketch({dom:{tag:"div",classes:["tox-statusbar__path-item"],attributes:{role:"button","data-index":o,"tab-index":-1,"aria-level":o+1},innerHtml:t.name},action:function(e){n.focus(),n.selection.select(t.element),n.nodeChanged()},buttonBehaviours:Qa([Iv(e.isDisabled),Mv()])})})),f={dom:{tag:"div",classes:["tox-statusbar__path-divider"],attributes:{"aria-hidden":!0},innerHtml:" "+t.delimiter+" "}},J(c.slice(1),(function(n,element){var t=n;return t.push(f),t.push(element),t}),[c[0]]))):rg.set(o,[])}))}))])]),components:[]}},qA=function(n,t){var e=function(){var label,e=[];return n.getParam("elementpath",!0,"boolean")&&e.push(YA(n,{},t)),n.hasPlugin("wordcount")&&e.push(function(n,t){var e,o=function(n,e,o){return rg.set(n,[text(t.translate(["{0} "+o,e[o]]))])};return op.sketch({dom:{tag:"button",classes:["tox-statusbar__wordcount"]},components:[],buttonBehaviours:Qa([Iv(t.isDisabled),Mv(),Vy.config({}),rg.config({}),Mf.config({store:{mode:"memory",initialValue:{mode:"words",count:{words:0,characters:0}}}}),ig("wordcount-events",[sr((function(n){var t=Mf.getValue(n),e="words"===t.mode?"characters":"words";Mf.setValue(n,{mode:e,count:t.count}),o(n,t.count,e)})),ur((function(t){n.on("wordCountUpdate",(function(n){var e=Mf.getValue(t).mode;Mf.setValue(t,{mode:e,count:n.wordCount}),o(t,n.wordCount,e)}))}))])]),eventOrder:(e={},e[wo()]=["disabling","alloy.base.behaviour","wordcount-events"],e)})}(n,t)),n.getParam("branding",!0,"boolean")&&e.push({dom:{tag:"span",classes:["tox-statusbar__branding"],innerHtml:'<a href="https://www.tiny.cloud/?utm_campaign=editor_referral&amp;utm_medium=poweredby&amp;utm_source=tinymce&amp;utm_content=v5" rel="noopener" target="_blank" tabindex="-1" aria-label="'+(label=jh.translate(["Powered by {0}","Tiny"]))+'">'+label+"</a>"}}),e.length>0?[{dom:{tag:"div",classes:["tox-statusbar__text-container"]},components:e}]:[]};return{dom:{tag:"div",classes:["tox-statusbar"]},components:function(){var o=e(),r=function(n){var t=!n.hasPlugin("autoresize"),e=n.getParam("resize",t);return!1===e?hE.None:"both"===e?hE.Both:hE.Vertical}(n);return r!==hE.None&&o.push(function(e){return{dom:{tag:"div",classes:["tox-statusbar__resize-handle"],attributes:{title:t.translate("Resize"),"aria-hidden":"true"},innerHtml:ap("resize-handle",t.icons)},behaviours:Qa([NA.config({mode:"mouse",repositionTarget:!1,onDrag:function(t,o,r){GA(n,r,e)},blockerClass:"tox-blocker"})])}}(r)),o}()}},JA=function(n){var t,e,o,r=n.inline,c=r?wB:mB,header=Cv(n)?BD:oD,f=O.none(),l=He(),d=l.browser.isIE()?["tox-platform-ie"]:[],m=l.deviceType.isTouch()?["tox-platform-touch"]:[],h=yv(n),y=Le(body(),Sv(n)),x=jh.isRtl()?{attributes:{dir:"rtl"}}:{},w={attributes:(t={},t[Vc]=h?$u.BottomToTop:$u.TopToBottom,t)},S=function(){return f.bind(nB.getHeader)},k=function(){Gi($.element,"width",document.body.clientWidth+"px")},C=du((e={dom:v({tag:"div",classes:["tox","tox-silver-sink","tox-tinymce-aux"].concat(d).concat(m)},x),behaviours:Qa([Us.config({useFixed:function(){return header.isDocked(S)}})])},o={dom:{styles:{width:document.body.clientWidth+"px"}},events:qo([$o(Ao(),k)])},zn(e,y?o:{}))),_=function(){return ln.value(C)},T=ip({dom:{tag:"div",classes:["tox-anchorbar"]}}),E=function(){return f.bind((function(n){return nB.getThrobber(n)})).getOrDie("Could not find throbber element")},D=T_(C,n,(function(){return f.bind((function(n){return T.getOpt(n)})).getOrDie("Could not find a anchor bar element")})),B=nB.parts.menubar({dom:{tag:"div",classes:["tox-menubar"]},backstage:D,onEscape:function(){n.focus()}}),A=pv(n),M=nB.parts.toolbar(v({dom:{tag:"div",classes:["tox-toolbar"]},getSink:_,providers:D.shared.providers,onEscape:function(){n.focus()},type:A,lazyToolbar:function(){return f.bind((function(n){return nB.getToolbar(n)})).getOrDie("Could not find more toolbar element")},lazyHeader:function(){return S().getOrDie("Could not find header element")}},w)),F=nB.parts["multiple-toolbar"]({dom:{tag:"div",classes:["tox-toolbar-overlord"]},providers:D.shared.providers,onEscape:function(){n.focus()},type:A}),I=nB.parts.socket({dom:{tag:"div",classes:["tox-edit-area"]}}),R=nB.parts.sidebar({dom:{tag:"div",classes:["tox-sidebar"]}}),V=nB.parts.throbber({dom:{tag:"div",classes:["tox-throbber"]},backstage:D}),P=n.getParam("statusbar",!0,"boolean")&&!r?O.some(qA(n,D.shared.providers)):O.none(),H={dom:{tag:"div",classes:["tox-sidebar-wrap"]},components:[I,R]},z=mv(n),N=lv(n),L=fv(n),j=nB.parts.header({dom:v({tag:"div",classes:["tox-editor-header"]},w),components:Q([L?[B]:[],z?[F]:N?[M]:[],wv(n)?[]:[T.asSpec()]]),sticky:Cv(n),editor:n,sharedBackstage:D.shared}),U=Q([h?[]:[j],r?[]:[H],h?[j]:[]]),W=Q([[{dom:{tag:"div",classes:["tox-editor-container"]},components:U}],r?[]:P.toArray(),[V]]),X=kv(n),Y=v(v({role:"application"},jh.isRtl()?{dir:"rtl"}:{}),X?{"aria-hidden":"true"}:{}),J=du(nB.sketch({dom:{tag:"div",classes:["tox","tox-tinymce"].concat(r?["tox-tinymce-inline"]:[]).concat(h?["tox-tinymce--toolbar-bottom"]:[]).concat(m).concat(d),styles:v({visibility:"hidden"},X?{opacity:"0",border:"0"}:{}),attributes:Y},components:W,behaviours:Qa([Mv(),ev.config({disableClass:"tox-tinymce--disabled"}),Zm.config({mode:"cyclic",selector:".tox-menubar, .tox-toolbar, .tox-toolbar__primary, .tox-toolbar__overflow--open, .tox-sidebar__overflow--open, .tox-statusbar__path, .tox-statusbar__wordcount, .tox-statusbar__branding a"})])}));f=O.some(J),n.shortcuts.add("alt+F9","focus menubar",(function(){nB.focusMenubar(J)})),n.shortcuts.add("alt+F10","focus toolbar",(function(){nB.focusToolbar(J)})),n.addCommand("ToggleToolbarDrawer",(function(){nB.toggleToolbarDrawer(J)})),n.addQueryStateHandler("ToggleToolbarDrawer",(function(){return nB.isToolbarDrawerToggled(J)}));var K=By(J),$=By(C);!function(n,t,e){var o=function(n,o){G([t,e],(function(t){t.broadcastEvent(n,o)}))},r=function(n,o){G([t,e],(function(t){t.broadcastOn([n],o)}))},c=function(n){return r(mf(),{target:n.target})},f=ly(he.fromDom(document),"touchstart",c),l=ly(he.fromDom(document),"touchmove",(function(n){return o(Eo(),n)})),d=ly(he.fromDom(document),"touchend",(function(n){return o(Do(),n)})),m=ly(he.fromDom(document),"mousedown",c),h=ly(he.fromDom(document),"mouseup",(function(n){0===n.raw.button&&r(pf(),{target:n.target})})),v=function(n){return r(mf(),{target:he.fromDom(n.target)})},y=function(n){0===n.button&&r(pf(),{target:he.fromDom(n.target)})},x=function(n){return o(Bo(),my(n))},w=function(n){r(gf(),{}),o(Ao(),my(n))},S=function(){return r(gf(),{})};n.on("PostRender",(function(){n.on("click",v),n.on("tap",v),n.on("mouseup",y),n.on("ScrollWindow",x),n.on("ResizeWindow",w),n.on("ResizeEditor",S)})),n.on("remove",(function(){n.off("click",v),n.off("tap",v),n.off("mouseup",y),n.off("ScrollWindow",x),n.off("ResizeWindow",w),n.off("ResizeEditor",S),m.unbind(),f.unbind(),l.unbind(),d.unbind(),h.unbind()})),n.on("detach",(function(){tf(t),tf(e),t.destroy(),e.destroy()}))}(n,K,$);var Z=function(){var t=pB(vB(n)),e=pB(function(n){return bB(n).getOr(iv(n))}(n));return n.inline||(Qi("div","width",e)&&Gi(J.element,"width",e),Qi("div","height",t)?Gi(J.element,"height",t):Gi(J.element,"height","200px")),t};return{mothership:K,uiMothership:$,backstage:D,renderUI:function(){header.setup(n,D.shared,S),FB(n,D),nA(n,_,D),function(n){var t=n.ui.registry.getAll().sidebars;G(Cn(t),(function(e){var o=t[e],r=function(){return O.from(n.queryCommandValue("ToggleSidebar")).is(e)};n.ui.registry.addToggleButton(e,{icon:o.icon,tooltip:o.tooltip,onAction:function(t){n.execCommand("ToggleSidebar",!1,e),t.setActive(r())},onSetup:function(t){var e=function(){return t.setActive(r())};return n.on("ToggleSidebar",e),function(){n.off("ToggleSidebar",e)}}})}))}(n),XD(n,E,D.shared),Tn(function(n){return n.getParam("toolbar_groups",{},"object")}(n),(function(t,e){n.ui.registry.addGroupToolbarButton(e,t)}));var t=n.ui.registry.getAll(),e=t.buttons,o=t.menuItems,r=t.contextToolbars,f=t.sidebars,l=dv(n),d={menuItems:o,menus:Ov(n),menubar:_v(n),toolbar:l.getOrThunk((function(){return function(n){return n.getParam("toolbar",!0)}(n)})),allowToolbarGroups:A===Jp.floating,buttons:e,sidebar:f};XE(n,r,C,{backstage:D}),WA(n,C);var m=n.getElement(),h=Z(),v={mothership:K,uiMothership:$,outerContainer:J},y={targetNode:m,height:h};return c.render(n,v,d,D,y)},getUi:function(){return{channels:{broadcastAll:$.broadcast,broadcastOn:$.broadcastOn,register:function(){}}}}}},KA=o([Wt("lazySink"),option("dragBlockClass"),fe("getBounds",zu),re("useTabstopAt",m),re("eventOrder",{}),Ff("modalBehaviours",[Zm]),fa("onExecute"),da("onEscape")]),$A={sketch:r},QA=o([ll({name:"draghandle",overrides:function(n,t){return{behaviours:Qa([NA.config({mode:"mouse",getTarget:function(n){return Gu(n,'[role="dialog"]').getOr(n)},blockerClass:n.dragBlockClass.getOrDie(new Error("The drag blocker class was not specified for a dialog with a drag handle: \n"+JSON.stringify(t,null,2)).message),getBounds:n.getDragBounds})])}}}),sl({schema:[Wt("dom")],name:"title"}),sl({factory:$A,schema:[Wt("dom")],name:"close"}),sl({factory:$A,schema:[Wt("dom")],name:"body"}),ll({factory:$A,schema:[Wt("dom")],name:"footer"}),fl({factory:{sketch:function(n,t){return v(v({},n),{dom:t.dom,components:t.components})}},schema:[re("dom",{tag:"div",styles:{position:"fixed",left:"0px",top:"0px",right:"0px",bottom:"0px"}}),re("components",[])],name:"blocker"})]),ZA=Object.freeze({__proto__:null,block:function(component,n,t,e){Pr(component.element,"aria-busy",!0);var o=n.getRoot(component).getOr(component),r=Qa([Zm.config({mode:"special",onTab:function(){return O.some(!0)},onShiftTab:function(){return O.some(!0)}}),fg.config({})]),c=e(o,r),f=o.getSystem().build(c);rg.append(o,mu(f)),f.hasConfigured(Zm)&&Zm.focusIn(f),t.isBlocked()||n.onBlock(component),t.blockWith((function(){return rg.remove(o,f)}))},unblock:function(component,n,t){Lr(component.element,"aria-busy"),t.isBlocked()&&n.onUnblock(component),t.clear()}}),nM=[fe("getRoot",O.none),sa("onBlock"),sa("onUnblock")],tM=nc({fields:nM,name:"blocking",apis:ZA,state:Object.freeze({__proto__:null,init:function(){var n=DE();return fi({readState:n.isSet,blockWith:function(t){n.set({destroy:t})},clear:n.clear,isBlocked:n.isSet})}})}),eM=Nl({name:"ModalDialog",configFields:KA(),partFields:QA(),factory:function(n,t,e,o){var c,f=ge(O.none()),l=Yr("modal-events"),d=v(v({},n.eventOrder),((c={})[Mo()]=[l].concat(n.eventOrder["alloy.system.attached"]||[]),c));return{uid:n.uid,dom:n.dom,components:t,apis:{show:function(dialog){f.set(O.some(dialog));var t=n.lazySink(dialog).getOrDie(),e=o.blocker(),r=t.getSystem().build(v(v({},e),{components:e.components.concat([mu(dialog)]),behaviours:Qa([fg.config({}),ig("dialog-blocker-events",[ir(uo(),(function(){Zm.focusIn(dialog)}))])])}));qs(t,r),Zm.focusIn(dialog)},hide:function(dialog){f.set(O.none()),Sr(dialog.element).each((function(n){dialog.getSystem().getByDom(n).each((function(n){$s(n)}))}))},getBody:function(dialog){return Ol(dialog,n,"body")},getFooter:function(dialog){return Ol(dialog,n,"footer")},setIdle:function(dialog){tM.unblock(dialog)},setBusy:function(dialog,n){tM.block(dialog,n)}},eventOrder:d,domModification:{attributes:{role:"dialog","aria-modal":"true"}},behaviours:Rf(n.modalBehaviours,[rg.config({}),Zm.config({mode:"cyclic",onEnter:n.onExecute,onEscape:n.onEscape,useTabstopAt:n.useTabstopAt}),tM.config({getRoot:f.get}),ig(l,[ur((function(t){var e,o,c,f,l,d;e=t.element,o=Ol(t,n,"title").element,c=zr(e,"id").fold((function(){var n=Yr("dialog-label");return Pr(o,"id",n),n}),r),Pr(e,"aria-labelledby",c),f=t.element,l=Ol(t,n,"body").element,d=O.from(Hr(f,"id")).fold((function(){var n=Yr("dialog-describe");return Pr(l,"id",n),n}),r),Pr(f,"aria-describedby",d)}))])])}},apis:{show:function(n,dialog){n.show(dialog)},hide:function(n,dialog){n.hide(dialog)},getBody:function(n,dialog){return n.getBody(dialog)},getFooter:function(n,dialog){return n.getFooter(dialog)},setBusy:function(n,dialog,t){n.setBusy(dialog,t)},setIdle:function(n,dialog){n.setIdle(dialog)}}}),oM=gt([Yt("type"),Yt("name")].concat(kh)),rM=zt,iM=[wt("name","name",Yn((function(){return Yr("button-name")})),Ht),te("icon"),ce("align","end",["start","end"]),se("primary",!1),se("disabled",!1)],uM=x(iM,[Yt("text")]),aM=x([qt("type",["submit","cancel","custom"])],uM),cM=x([qt("type",["menu"]),te("text"),te("tooltip"),te("icon"),Qt("items",oM)],iM),sM=It("type",{submit:aM,cancel:aM,custom:aM,menu:cM}),fM=[Yt("type"),Yt("text"),qt("level",["info","warn","error","success"]),Yt("icon"),re("url","")],lM=gt(fM),dM=[Yt("type"),Yt("text"),se("disabled",!1),se("primary",!1),wt("name","name",Yn((function(){return Yr("button-name")})),Ht),te("icon"),se("borderless",!1)],mM=gt(dM),gM=[Yt("type"),Yt("name"),Yt("label"),se("disabled",!1)],pM=gt(gM),hM=zt,vM=[Yt("type"),Yt("name")],bM=vM.concat([te("label")]),yM=bM.concat([re("columns","auto")]),xM=gt(yM),wM=Ot([Yt("value"),Yt("text"),Yt("icon")]),SM=gt(bM),kM=Ht,CM=gt(bM),OM=Ht,_M=vM.concat([ae("tag","textarea"),Yt("scriptId"),Yt("scriptUrl"),function(n,t){return ie(n,t,jt)}("settings",void 0)]),TM=vM.concat([ae("tag","textarea"),Jt("init")]),EM=Tt((function(n){return Dt("customeditor.old",mt(TM),n).orThunk((function(){return Dt("customeditor.new",mt(_M),n)}))})),DM=Ht,BM=gt(bM),AM=pt(Ct),MM=function(n){return[Yt("type"),Xt("columns"),n]},FM=[Yt("type"),Yt("html"),ce("presets","presentation",["presentation","document"])],IM=gt(FM),RM=bM.concat([se("sandboxed",!0)]),VM=gt(RM),PM=Ht,HM=bM.concat([Gt("currentState",gt([Wt("blob"),Yt("url")]))]),zM=gt(HM),NM=bM.concat([te("inputMode"),te("placeholder"),se("maximized",!1),se("disabled",!1)]),LM=gt(NM),jM=Ht,UM=function(n){return[Yt("type"),Yt("label"),n]},WM=[Yt("text"),Yt("value")],GM=[Yt("text"),Qt("items",function(desc,n){return t=n,e=Ln((function(){return t()})),{extract:function(path,n,t){return e().extract(path,n,t)},toString:function(){return e().toString()}};var t,e}(0,(function(){return XM})))],XM=ht([gt(WM),gt(GM)]),YM=bM.concat([Qt("items",XM),se("disabled",!1)]),qM=gt(YM),JM=Ht,KM=bM.concat([$t("items",[Yt("text"),Yt("value")]),ue("size",1),se("disabled",!1)]),$M=gt(KM),QM=Ht,ZM=bM.concat([se("constrain",!0),se("disabled",!1)]),nF=gt(ZM),tF=gt([Yt("width"),Yt("height")]),eF=[Yt("type"),Qt("header",Ht),Qt("cells",pt(Ht))],oF=gt(eF),rF=bM.concat([te("placeholder"),se("maximized",!1),se("disabled",!1)]),iF=gt(rF),uF=Ht,aF=bM.concat([ce("filetype","file",["image","media","file"]),re("disabled",!1)]),cF=gt(aF),sF=gt([Yt("value"),re("meta",{})]),fF=function(n){return wt("items","items",Gn(),pt(Tt((function(t){return Dt("Checking item of "+n,lF,t).fold((function(n){return ln.error(Mt(n))}),(function(n){return ln.value(n)}))}))))},lF=_t((function(){return Ft("type",{alertbanner:lM,bar:gt((n=fF("bar"),[Yt("type"),n])),button:mM,checkbox:pM,colorinput:SM,colorpicker:CM,dropzone:BM,grid:gt(MM(fF("grid"))),iframe:VM,input:LM,listbox:qM,selectbox:$M,sizeinput:nF,textarea:iF,urlinput:cF,customeditor:EM,htmlpanel:IM,imagetools:zM,collection:xM,label:gt(UM(fF("label"))),table:oF,panel:mF});var n})),dF=[Yt("type"),re("classes",[]),Qt("items",lF)],mF=gt(dF),gF=[wt("name","name",Yn((function(){return Yr("tab-name")})),Ht),Yt("title"),Qt("items",lF)],pF=[Yt("type"),$t("tabs",gF)],hF=gt(pF),vF=uM,bF=sM,yF=gt([Yt("title"),Gt("body",Ft("type",{panel:mF,tabpanel:hF})),ae("size","normal"),Qt("buttons",bF),re("initialData",{}),fe("onAction",t),fe("onChange",t),fe("onSubmit",t),fe("onClose",t),fe("onCancel",t),re("onTabChange",t)]),xF=gt(x([qt("type",["cancel","custom"])],vF)),wF=gt([Yt("title"),Yt("url"),ne("height"),ne("width"),function(n,t){return Zt(n,pt(t))}("buttons",xF),fe("onAction",t),fe("onCancel",t),fe("onClose",t),fe("onMessage",t)]),SF=function(n){return D(n)?[n].concat(Z(Mn(n),SF)):B(n)?Z(n,SF):[]},kF=function(n){return E(n.type)&&E(n.name)},CF={checkbox:hM,colorinput:kM,colorpicker:OM,dropzone:AM,input:jM,iframe:PM,sizeinput:tF,selectbox:QM,listbox:JM,size:tF,textarea:uF,urlinput:sF,customeditor:DM,collection:wM,togglemenuitem:rM},OF=function(n){var t=function(n){return filter(SF(n),kF)}(n),e=Z(t,(function(n){return function(n){return O.from(CF[n.type])}(n).fold((function(){return[]}),(function(t){return[Gt(n.name,t)]}))}));return gt(e)},_F=function(n){return{internalDialog:Bt(Dt("dialog",yF,n)),dataValidator:OF(n),initialData:n.initialData}},TF={open:function(n,t){var e=_F(t);return n(e.internalDialog,e.initialData,e.dataValidator)},openUrl:function(n,t){return n(Bt(Dt("dialog",wF,t)))},redial:function(n){return _F(n)}},EF=function(n){var t=[],e={};return _n(n,(function(n,o){n.fold((function(){t.push(o)}),(function(n){e[o]=n}))})),t.length>0?ln.error(t):ln.value(e)},DF=function(n,t){var e=ip(IS.sketch((function(e){return{dom:{tag:"div",classes:["tox-form"].concat(n.classes)},components:map(n.items,(function(n){return FO(e,n,t)}))}})));return{dom:{tag:"div",classes:["tox-dialog__body"]},components:[{dom:{tag:"div",classes:["tox-dialog__body-content"]},components:[e.asSpec()]}],behaviours:Qa([Zm.config({mode:"acyclic",useTabstopAt:f(ck)}),jS(e),$S(e,{postprocess:function(n){return EF(n).fold((function(n){return console.error(n),{}}),(function(n){return n}))}})])}},BF=zl({name:"TabButton",configFields:[re("uid",void 0),Wt("value"),wt("dom","dom",qn((function(){return{attributes:{role:"tab",id:Yr("aria"),"aria-selected":"false"}}})),Rt()),option("action"),re("domModification",{}),Ff("tabButtonBehaviours",[fg,Zm,Mf]),Wt("view")],factory:function(n,t){return{uid:n.uid,dom:n.dom,components:n.components,events:Cg(n.action),behaviours:Rf(n.tabButtonBehaviours,[fg.config({}),Zm.config({mode:"execution",useSpace:!0,useEnter:!0}),Mf.config({store:{mode:"memory",initialValue:n.value}})]),domModification:n.domModification}}}),AF=o([Wt("tabs"),Wt("dom"),re("clickToDismiss",!1),Ff("tabbarBehaviours",[rd,Zm]),aa(["tabClass","selectedClass"])]),MF=ml({factory:BF,name:"tabs",unit:"tab",overrides:function(n){var e=function(n,button){rd.dehighlight(n,button),Uo(n,zo(),{tabbar:n,button:button})},o=function(n,button){rd.highlight(n,button),Uo(n,Ho(),{tabbar:n,button:button})};return{action:function(button){var r=button.getSystem().getByUid(n.uid).getOrDie(),c=rd.isHighlighted(r,button);(c&&n.clickToDismiss?e:c?t:o)(r,button)},domModification:{classes:[n.markers.tabClass]}}}}),FF=o([MF]),IF=Nl({name:"Tabbar",configFields:AF(),partFields:FF(),factory:function(n,t,e,o){return{uid:n.uid,dom:n.dom,components:t,"debug.sketcher":"Tabbar",domModification:{attributes:{role:"tablist"}},behaviours:Rf(n.tabbarBehaviours,[rd.config({highlightClass:n.markers.selectedClass,itemClass:n.markers.tabClass,onHighlight:function(n,t){Pr(t.element,"aria-selected","true")},onDehighlight:function(n,t){Pr(t.element,"aria-selected","false")}}),Zm.config({mode:"flow",getInitial:function(n){return rd.getHighlighted(n).map((function(n){return n.element}))},selector:"."+n.markers.tabClass,executeOnMove:!0})])}}}),RF=zl({name:"Tabview",configFields:[Ff("tabviewBehaviours",[rg])],factory:function(n,t){return{uid:n.uid,dom:n.dom,behaviours:Rf(n.tabviewBehaviours,[rg.config({})]),domModification:{attributes:{role:"tabpanel"}}}}}),VF=o([re("selectFirst",!0),sa("onChangeTab"),sa("onDismissTab"),re("tabs",[]),Ff("tabSectionBehaviours",[])]),PF=sl({factory:IF,schema:[Wt("dom"),Kt("markers",[Wt("tabClass"),Wt("selectedClass")])],name:"tabbar",defaults:function(n){return{tabs:n.tabs}}}),HF=sl({factory:RF,name:"tabview"}),zF=o([PF,HF]),NF=Nl({name:"TabSection",configFields:VF(),partFields:zF(),factory:function(n,t,e,o){var r=function(section,t){Cl(section,n,"tabbar").each((function(n){t(n).each(Wo)}))};return{uid:n.uid,dom:n.dom,components:t,behaviours:If(n.tabSectionBehaviours),events:qo(Q([n.selectFirst?[ur((function(section,n){r(section,rd.getFirst)}))]:[],[$o(Ho(),(function(section,t){!function(button){var t=Mf.getValue(button);Cl(button,n,"tabview").each((function(e){K(n.tabs,(function(n){return n.value===t})).each((function(t){var o=t.view();zr(button.element,"id").each((function(n){Pr(e.element,"aria-labelledby",n)})),rg.set(e,o),n.onChangeTab(e,button,o)}))}))}(t.event.button)})),$o(zo(),(function(section,t){var button=t.event.button;n.onDismissTab(section,button)}))]])),apis:{getViewItems:function(section){return Cl(section,n,"tabview").map((function(n){return rg.contents(n)})).getOr([])},showTab:function(section,n){r(section,(function(t){var e=rd.getCandidates(t);return K(e,(function(t){return Mf.getValue(t)===n})).filter((function(n){return!rd.isHighlighted(t,n)}))}))}}}},apis:{getViewItems:function(n,component){return n.getViewItems(component)},showTab:function(n,component,t){n.showTab(component,t)}}}),LF=function(n,t){Gi(n,"height",t+"px"),He().browser.isIE()?Zi(n,"flex-basis"):Gi(n,"flex-basis",t+"px")},jF=function(n,t,e){Gu(n,'[role="dialog"]').each((function(dialog){Xu(dialog,'[role="tablist"]').each((function(n){e.get().map((function(e){return Gi(t,"height","0"),Gi(t,"flex-basis","0"),Math.min(e,function(dialog,n,t){var e,o=xr(dialog).dom,r=Gu(dialog,".tox-dialog-wrap").getOr(dialog);e="fixed"===qi(r,"position")?Math.max(o.clientHeight,window.innerHeight):Math.max(o.offsetHeight,o.scrollHeight);var c=hu(n),f=n.dom.offsetLeft>=t.dom.offsetLeft+Cu(t)?Math.max(hu(t),c):c,l=parseInt(qi(dialog,"margin-top"),10)||0,d=parseInt(qi(dialog,"margin-bottom"),10)||0;return e-(hu(dialog)+l+d-f)}(dialog,t,n))})).each((function(n){LF(t,n)}))}))}))},UF=function(dialog){return Xu(dialog,'[role="tabpanel"]')},WF=function(n){var t;return{smartTabHeight:(t=ge(O.none()),{extraEvents:[ur((function(e){var dialog=e.element;UF(dialog).each((function(o){Gi(o,"visibility","hidden"),e.getSystem().getByDom(o).toOptional().each((function(e){var r=function(n){return head(on(n,(function(a,b){return a>b?-1:a<b?1:0})))}(function(n,t,e){return map(n,(function(o,i){rg.set(e,n[i].view());var rect=t.dom.getBoundingClientRect();return rg.set(e,[]),rect.height}))}(n,o,e));t.set(r)})),jF(dialog,o,t),Zi(o,"visibility"),function(n,t){head(n).each((function(n){return NF.showTab(t,n.value)}))}(n,e),ep.requestAnimationFrame((function(){jF(dialog,o,t)}))}))})),$o(Ao(),(function(n){var dialog=n.element;UF(dialog).each((function(n){jF(dialog,n,t)}))})),$o(Ky,(function(n,e){var dialog=n.element;UF(dialog).each((function(n){var e=ac();Gi(n,"visibility","hidden");var o=Ki(n,"height").map((function(n){return parseInt(n,10)}));Zi(n,"height"),Zi(n,"flex-basis");var r=n.dom.getBoundingClientRect().height;o.forall((function(n){return r>n}))?(t.set(O.from(r)),jF(dialog,n,t)):o.each((function(t){LF(n,t)})),Zi(n,"visibility"),e.each(uc)}))}))],selectFirst:!1}),naiveTabHeight:{extraEvents:[],selectFirst:!0}}},GF=function(n,t){var e=ge({}),o=function(form){var n=Mf.getValue(form),t=EF(n).getOr({}),o=e.get(),r=zn(o,t);e.set(r)},r=function(form){var n=e.get();Mf.setValue(form,n)},c=ge(null),l=map(n.tabs,(function(n){return{value:n.name,dom:{tag:"div",classes:["tox-dialog__body-nav-item"],innerHtml:t.shared.providers.translate(n.title)},view:function(){return[IS.sketch((function(e){return{dom:{tag:"div",classes:["tox-form"]},components:map(n.items,(function(n){return FO(e,n,t)})),formBehaviours:Qa([Zm.config({mode:"acyclic",useTabstopAt:f(ck)}),ig("TabView.form.events",[ur(r),ar(o)]),rc.config({channels:Qn([{key:"send-data-to-section",value:{onReceive:o}},{key:"send-data-to-view",value:{onReceive:r}}])})])}}))]}}})),d=WF(l).smartTabHeight;return NF.sketch({dom:{tag:"div",classes:["tox-dialog__body"]},onChangeTab:function(section,button,n){var t=Mf.getValue(button);Uo(section,Jy,{name:t,oldName:c.get()}),c.set(t)},tabs:l,components:[NF.parts.tabbar({dom:{tag:"div",classes:["tox-dialog__body-nav"]},components:[IF.parts.tabs({})],markers:{tabClass:"tox-tab",selectedClass:"tox-dialog__body-nav-item--active"},tabbarBehaviours:Qa([Vy.config({})])}),NF.parts.tabview({dom:{tag:"div",classes:["tox-dialog__body-content"]}})],selectFirst:d.selectFirst,tabSectionBehaviours:Qa([ig("tabpanel",d.extraEvents),Zm.config({mode:"acyclic"}),Xl.config({find:function(n){return head(NF.getViewItems(n))}}),Mf.config({store:{mode:"manual",getValue:function(n){return n.getSystem().broadcastOn(["send-data-to-section"],{}),e.get()},setValue:function(n,t){e.set(t),n.getSystem().broadcastOn(["send-data-to-view"],{})}}})])})},XF=Yr("update-dialog"),YF=Yr("update-title"),qF=Yr("update-body"),JF=Yr("update-footer"),KF=Yr("body-send-message"),$F=function(n,t,e,o){return{dom:{tag:"div",classes:["tox-dialog__content-js"],attributes:v(v({},t.map((function(n){return{id:n}})).getOr({})),o?{"aria-live":"polite"}:{})},components:[],behaviours:Qa([US(0),VT.config({channel:qF,updateState:function(n,t){return O.some({isTabPanel:function(){return"tabpanel"===t.body.type}})},renderComponents:function(n){switch(n.body.type){case"tabpanel":return[GF(n.body,e)];default:return[DF(n.body,e)]}},initialData:n})])}},QF=Gv.deviceType.isTouch(),ZF=function(title,n){return{dom:{tag:"div",styles:{display:"none"},classes:["tox-dialog__header"]},components:[title,n]}},nI=function(n,t){return eM.parts.close(op.sketch({dom:{tag:"button",classes:["tox-button","tox-button--icon","tox-button--naked"],attributes:{type:"button","aria-label":t.translate("Close")}},action:n,buttonBehaviours:Qa([Vy.config({})])}))},tI=function(){return eM.parts.title({dom:{tag:"div",classes:["tox-dialog__title"],innerHtml:"",styles:{display:"none"}}})},eI=function(n,t){return eM.parts.body({dom:{tag:"div",classes:["tox-dialog__body"]},components:[{dom:{tag:"div",classes:["tox-dialog__body-content"]},components:[{dom:WD("<p>"+t.translate(n)+"</p>")}]}]})},oI=function(n){return eM.parts.footer({dom:{tag:"div",classes:["tox-dialog__footer"]},components:n})},rI=function(n,t){return[Dy.sketch({dom:{tag:"div",classes:["tox-dialog__footer-start"]},components:n}),Dy.sketch({dom:{tag:"div",classes:["tox-dialog__footer-end"]},components:t})]},iI=function(n){var t,e="tox-dialog",o=e+"-wrap",r=o+"__backdrop",c=e+"__disable-scroll";return eM.sketch({lazySink:n.lazySink,onEscape:function(t){return n.onEscape(t),O.some(!0)},useTabstopAt:function(n){return!ck(n)},dom:{tag:"div",classes:[e].concat(n.extraClasses),styles:v({position:"relative"},n.extraStyles)},components:x([n.header,n.body],n.footer.toArray()),parts:{blocker:{dom:WD('<div class="'+o+'"></div>'),components:[{dom:{tag:"div",classes:QF?[r,r+"--opaque"]:[r]}}]}},dragBlockClass:o,modalBehaviours:Qa(x([fg.config({}),ig("dialog-events",n.dialogEvents.concat([ir(uo(),(function(n,t){Zm.focusIn(n)}))])),ig("scroll-lock",[ur((function(){_i(body(),c)})),ar((function(){Ei(body(),c)}))])],n.extraBehaviours)),eventOrder:v((t={},t[wo()]=["dialog-events"],t[Mo()]=["scroll-lock","dialog-events","alloy.base.behaviour"],t[Fo()]=["alloy.base.behaviour","dialog-events","scroll-lock"],t),n.eventOrder)})},uI=function(n){return op.sketch({dom:{tag:"button",classes:["tox-button","tox-button--icon","tox-button--naked"],attributes:{type:"button","aria-label":n.translate("Close"),title:n.translate("Close")}},components:[{dom:{tag:"div",classes:["tox-icon"],innerHtml:ap("close",n.icons)}}],action:function(n){jo(n,Wy)}})},aI=function(n,t,e){var o=function(data){return[text(e.translate(data.title))]};return{dom:{tag:"div",classes:["tox-dialog__title"],attributes:v({},t.map((function(n){return{id:n}})).getOr({}))},components:o(n),behaviours:Qa([VT.config({channel:YF,renderComponents:o})])}},cI=function(){return{dom:WD('<div class="tox-dialog__draghandle"></div>')}},sI=function(title,n){return function(n,t){var e=eM.parts.title(aI(n,O.none(),t)),o=eM.parts.draghandle(cI()),r=eM.parts.close(uI(t)),c=[e].concat(n.draggable?[o]:[]).concat([r]);return Dy.sketch({dom:WD('<div class="tox-dialog__header"></div>'),components:c})}({title:n.shared.providers.translate(title),draggable:n.dialog.isDraggableModal()},n.shared.providers)},fI=function(n,t){return{dom:{tag:"div",classes:["tox-dialog__busy-spinner"],attributes:{"aria-label":n},styles:{left:"0px",right:"0px",bottom:"0px",top:"0px",position:"absolute"}},behaviours:t,components:[{dom:WD('<div class="tox-spinner"><div></div><div></div><div></div></div>')}]}},lI=function(n,t){return{onClose:function(){return t.closeWindow()},onBlock:function(t){eM.setBusy(n(),(function(n,e){return fI(t.message,e)}))},onUnblock:function(){eM.setIdle(n())}}},dI=function(n,t,e,o){var r;return du(iI(v(v({},n),{lazySink:o.shared.getSink,extraBehaviours:x([VT.config({channel:XF,updateState:function(n,t){return O.some(t)},initialData:t}),nk({})],n.extraBehaviours),onEscape:function(n){jo(n,Wy)},dialogEvents:e,eventOrder:(r={},r[xo()]=[VT.name(),rc.name()],r[Mo()]=["scroll-lock",VT.name(),"messages","dialog-events","alloy.base.behaviour"],r[Fo()]=["alloy.base.behaviour","dialog-events","messages",VT.name(),"scroll-lock"],r)})))},mI=function(n){return map(n,(function(button){return"menu"===button.type?function(button){var n=map(button.items,(function(n){var t=ge(!1);return v(v({},n),{storage:t})}));return v(v({},button),{items:n})}(button):button}))},gI=function(n){return J(n,(function(n,button){return"menu"===button.type?J(button.items,(function(n,t){return n[t.name]=t.storage,n}),n):n}),{})},pI=function(n,t){return[er(uo(),ak),n(Uy,(function(n,e){t.onClose(),e.onClose()})),n(Wy,(function(n,t,e,o){t.onCancel(n),jo(o,Uy)})),$o(qy,(function(n,e){return t.onUnblock()})),$o(Yy,(function(n,e){return t.onBlock(e.event)}))]},hI=function(n,t){var e=function(t,e){return $o(t,(function(t,r){o(t,(function(o,c){e(n(),o,r.event,t)}))}))},o=function(n,t){VT.getState(n).get().each((function(e){t(e,n)}))};return x(pI(e,t),[e(Gy,(function(n,t,e){t.onAction(n,{name:e.name})}))])},vI=function(n,t,e){var o=function(t,e){return $o(t,(function(t,o){r(t,(function(r,c){e(n(),r,o.event,t)}))}))},r=function(n,t){VT.getState(n).get().each((function(e){t(e.internalDialog,n)}))};return x(pI(o,t),[o(Xy,(function(n,t){return t.onSubmit(n)})),o(jy,(function(n,t,e){t.onChange(n,{name:e.name})})),o(Gy,(function(n,t,o,component){var r=function(){return Zm.focusIn(component)},c=function(n){return Nr(n,"disabled")||zr(n,"aria-disabled").exists((function(n){return"true"===n}))},f=Vi(component.element),l=ac(f);t.onAction(n,{name:o.name,value:o.value}),ac(f).fold(r,(function(n){c(n)||l.exists((function(t){return Ue(n,t)&&c(t)}))?r():e().toOptional().filter((function(t){return!Ue(t.element,n)})).each(r)}))})),o(Jy,(function(n,t,e){t.onTabChange(n,{newTabName:e.name,oldTabName:e.oldName})})),ar((function(component){var t=n();Mf.setValue(component,t.getData())}))])},bI=function(n,t){var e=t.map((function(s){return s.footerButtons})).getOr([]),o=X(e,(function(button){return"start"===button.align})),r=function(n,t){return Dy.sketch({dom:{tag:"div",classes:["tox-dialog__footer-"+n]},components:map(t,(function(button){return button.memento.asSpec()}))})};return[r("start",o.pass),r("end",o.fail)]},yI=function(n,t){return{dom:WD('<div class="tox-dialog__footer"></div>'),components:[],behaviours:Qa([VT.config({channel:JF,initialData:n,updateState:function(n,data){var e=map(data.buttons,(function(button){var n=ip(function(button,n){return wC(button,button.type,n)}(button,t));return{name:button.name,align:button.align,memento:n}}));return O.some({lookupByName:function(n,t){return function(n,t,e){return K(t,(function(button){return button.name===e})).bind((function(t){return t.memento.getOpt(n)}))}(n,e,t)},footerButtons:e})},renderComponents:bI})])}},xI=function(n,t){return eM.parts.footer(yI(n,t))},wI=function(n,t){if(n.getRoot().getSystem().isConnected()){var e=Xl.getCurrent(n.getFormWrapper()).getOr(n.getFormWrapper());return IS.getField(e,t).fold((function(){var footer=n.getFooter();return VT.getState(footer).get().bind((function(n){return n.lookupByName(e,t)}))}),(function(n){return O.some(n)}))}return O.none()},SI=function(n,t,e){var o=function(t){var e=n.getRoot();e.getSystem().isConnected()&&t(e)},r={getData:function(){var t=n.getRoot(),o=t.getSystem().isConnected()?n.getFormWrapper():t,r=Mf.getValue(o),c=Tn(e,(function(n){return n.get()}));return v(v({},r),c)},setData:function(t){o((function(o){var c=r.getData(),f=v(v({},c),t),l=function(n,data){var t=n.getRoot();return VT.getState(t).get().map((function(n){return Bt(Dt("data",n.dataValidator,data))})).getOr(data)}(n,f),form=n.getFormWrapper();Mf.setValue(form,l),_n(e,(function(n,t){In(f,t)&&n.set(f[t])}))}))},disable:function(t){wI(n,t).each(ev.disable)},enable:function(t){wI(n,t).each(ev.enable)},focus:function(t){wI(n,t).each(fg.focus)},block:function(n){if(!E(n))throw new Error("The dialogInstanceAPI.block function should be passed a blocking message of type string as an argument");o((function(t){Uo(t,Yy,{message:n})}))},unblock:function(){o((function(n){jo(n,qy)}))},showTab:function(t){o((function(e){var body=n.getBody();VT.getState(body).get().exists((function(b){return b.isTabPanel()}))&&Xl.getCurrent(body).each((function(n){NF.showTab(n,t)}))}))},redial:function(n){o((function(e){var o=t(n);e.getSystem().broadcastOn([XF],o),e.getSystem().broadcastOn([YF],o.internalDialog),e.getSystem().broadcastOn([qF],o.internalDialog),e.getSystem().broadcastOn([JF],o.internalDialog),r.setData(o.initialData)}))},close:function(){o((function(n){jo(n,Uy)}))}};return r},kI=function(n,t,e){var header=sI(n.internalDialog.title,e),body=function(n,t){var e=$F(n,O.none(),t,!1);return eM.parts.body(e)}({body:n.internalDialog.body},e),o=mI(n.internalDialog.buttons),r=gI(o),footer=xI({buttons:o},e),c=vI((function(){return d}),lI((function(){return dialog}),t),e.shared.getSink),f=function(n){switch(n){case"large":return["tox-dialog--width-lg"];case"medium":return["tox-dialog--width-md"];default:return[]}}(n.internalDialog.size),l={header:header,body:body,footer:O.some(footer),extraClasses:f,extraBehaviours:[],extraStyles:{}},dialog=dI(l,n,c,e),d=SI({getRoot:function(){return dialog},getBody:function(){return eM.getBody(dialog)},getFooter:function(){return eM.getFooter(dialog)},getFormWrapper:function(){var n=eM.getBody(dialog);return Xl.getCurrent(n).getOr(n)}},t.redial,r);return{dialog:dialog,instanceApi:d}},CI=function(n,t,e,o){var r,c,f,l,d,m=Yr("dialog-label"),h=Yr("dialog-content"),v=ip((f={title:n.internalDialog.title,draggable:!0},l=m,d=e.shared.providers,Dy.sketch({dom:WD('<div class="tox-dialog__header"></div>'),components:[aI(f,O.some(l),d),cI(),uI(d)],containerBehaviours:Qa([NA.config({mode:"mouse",blockerClass:"blocker",getTarget:function(n){return Yu(n,'[role="dialog"]').getOrDie()},snaps:{getSnapPoints:function(){return[]},leftAttr:"data-drag-left",topAttr:"data-drag-top"}})])}))),y=ip(function(n,t,e,o){return $F(n,O.some(t),e,o)}({body:n.internalDialog.body},h,e,o)),x=mI(n.internalDialog.buttons),w=gI(x),S=ip(function(n,t){return yI(n,t)}({buttons:x},e)),k=vI((function(){return C}),{onBlock:function(n){tM.block(dialog,(function(t,e){return fI(n.message,e)}))},onUnblock:function(){tM.unblock(dialog)},onClose:function(){return t.closeWindow()}},e.shared.getSink),dialog=du({dom:{tag:"div",classes:["tox-dialog","tox-dialog-inline"],attributes:(r={role:"dialog"},r["aria-labelledby"]=m,r["aria-describedby"]=""+h,r)},eventOrder:(c={},c[xo()]=[VT.name(),rc.name()],c[wo()]=["execute-on-form"],c[Mo()]=["reflecting","execute-on-form"],c),behaviours:Qa([Zm.config({mode:"cyclic",onEscape:function(n){return jo(n,Uy),O.some(!0)},useTabstopAt:function(n){return!ck(n)&&("button"!==fr(n)||"disabled"!==Hr(n,"disabled"))}}),VT.config({channel:XF,updateState:function(n,t){return O.some(t)},initialData:n}),fg.config({}),ig("execute-on-form",k.concat([ir(uo(),(function(n,t){Zm.focusIn(n)}))])),tM.config({getRoot:function(){return O.some(dialog)}}),rg.config({}),nk({})]),components:[v.asSpec(),y.asSpec(),S.asSpec()]}),C=SI({getRoot:function(){return dialog},getFooter:function(){return S.get(dialog)},getBody:function(){return y.get(dialog)},getFormWrapper:function(){var body=y.get(dialog);return Xl.getCurrent(body).getOr(body)}},t.redial,w);return{dialog:dialog,instanceApi:C}},OI=tinymce.util.Tools.resolve("tinymce.util.URI"),_I=["insertContent","setContent","execCommand","close","block","unblock"],TI=function(data){return D(data)&&-1!==_I.indexOf(data.mceAction)},EI=function(n,t,e,o){var r,c,l,header=sI(n.title,o),body=function(n){var t={dom:{tag:"div",classes:["tox-dialog__content-js"]},components:[{dom:{tag:"div",classes:["tox-dialog__body-iframe"]},components:[ik({dom:{tag:"iframe",attributes:{src:n.url}},behaviours:Qa([Vy.config({}),fg.config({})])})]}],behaviours:Qa([Zm.config({mode:"acyclic",useTabstopAt:f(ck)})])};return eM.parts.body(t)}(n),footer=n.buttons.bind((function(n){return 0===n.length?O.none():O.some(xI({buttons:n},o))})),d=hI((function(){return k}),lI((function(){return dialog}),t)),m=v(v({},n.height.fold((function(){return{}}),(function(n){return{height:n+"px","max-height":n+"px"}}))),n.width.fold((function(){return{}}),(function(n){return{width:n+"px","max-width":n+"px"}}))),h=n.width.isNone()&&n.height.isNone()?["tox-dialog--width-lg"]:[],y=new OI(n.url,{base_uri:new OI(window.location.href)}),x=y.protocol+"://"+y.host+(y.port?":"+y.port:""),w=ge(O.none()),S=[ig("messages",[ur((function(){var t=ly(he.fromDom(window),"message",(function(t){if(y.isSameOrigin(new OI(t.raw.origin))){var data=t.raw.data;TI(data)?function(n,t,data){switch(data.mceAction){case"insertContent":n.insertContent(data.content);break;case"setContent":n.setContent(data.content);break;case"execCommand":var e=!!A(data.ui)&&data.ui;n.execCommand(data.cmd,e,data.value);break;case"close":t.close();break;case"block":t.block(data.message);break;case"unblock":t.unblock()}}(e,k,data):function(data){return!TI(data)&&D(data)&&In(data,"mceAction")}(data)&&n.onMessage(k,data)}}));w.set(O.some(t))})),ar((function(){w.get().each((function(n){return n.unbind()}))}))]),rc.config({channels:(r={},r[KF]={onReceive:function(n,data){Xu(n.element,"iframe").each((function(n){n.dom.contentWindow.postMessage(data,x)}))}},r)})],dialog=dI({header:header,body:body,footer:footer,extraClasses:h,extraBehaviours:S,extraStyles:m},n,d,o),k=(c=dialog,l=function(n){c.getSystem().isConnected()&&n(c)},{block:function(n){if(!E(n))throw new Error("The urlDialogInstanceAPI.block function should be passed a blocking message of type string as an argument");l((function(t){Uo(t,Yy,{message:n})}))},unblock:function(){l((function(n){jo(n,qy)}))},close:function(){l((function(n){jo(n,Uy)}))},sendMessage:function(data){l((function(n){n.getSystem().broadcastOn([KF],data)}))}});return{dialog:dialog,instanceApi:k}},DI=function(n,t,e){return t&&e?[]:[CD.config({contextual:{lazyContext:function(){return O.some(Pu(he.fromDom(n.getContentAreaContainer())))},fadeInClass:"tox-dialog-dock-fadein",fadeOutClass:"tox-dialog-dock-fadeout",transitionClass:"tox-dialog-dock-transition"},modes:["top"]})]},BI=function(n){var t=n.backstage,e=n.editor,o=Cv(e),r=function(n){var t=n.backstage.shared;return{open:function(e,o){var r=function(){eM.hide(d),o()},c=ip(wC({name:"close-alert",text:"OK",primary:!0,align:"end",disabled:!1,icon:O.none()},"cancel",n.backstage)),f=tI(),l=nI(r,t.providers),d=du(iI({lazySink:function(){return t.getSink()},header:ZF(f,l),body:eI(e,t.providers),footer:O.some(oI(rI([],[c.asSpec()]))),onEscape:r,extraClasses:["tox-alert-dialog"],extraBehaviours:[],extraStyles:{},dialogEvents:[$o(Wy,r)],eventOrder:{}}));eM.show(d);var m=c.get(d);fg.focus(m)}}}(n),c=function(n){var t=n.backstage.shared;return{open:function(e,o){var r=function(n){eM.hide(m),o(n)},c=ip(wC({name:"yes",text:"Yes",primary:!0,align:"end",disabled:!1,icon:O.none()},"submit",n.backstage)),f=wC({name:"no",text:"No",primary:!1,align:"end",disabled:!1,icon:O.none()},"cancel",n.backstage),l=tI(),d=nI((function(){return r(!1)}),t.providers),m=du(iI({lazySink:function(){return t.getSink()},header:ZF(l,d),body:eI(e,t.providers),footer:O.some(oI(rI([],[f,c.asSpec()]))),onEscape:function(){return r(!1)},extraClasses:["tox-confirm-dialog"],extraBehaviours:[],extraStyles:{},dialogEvents:[$o(Wy,(function(){return r(!1)})),$o(Xy,(function(){return r(!0)}))],eventOrder:{}}));eM.show(m);var h=c.get(m);fg.focus(h)}}}(n),f=function(n,o){return TF.openUrl((function(n){var dialog=EI(n,{closeWindow:function(){eM.hide(dialog.dialog),o(dialog.instanceApi)}},e,t);return eM.show(dialog.dialog),dialog.instanceApi}),n)},l=function(n,e){return TF.open((function(n,o,r){var c=o,dialog=kI({dataValidator:r,initialData:c,internalDialog:n},{redial:TF.redial,closeWindow:function(){eM.hide(dialog.dialog),e(dialog.instanceApi)}},t);return eM.show(dialog.dialog),dialog.instanceApi.setData(c),dialog.instanceApi}),n)},d=function(n,r,c,f){return TF.open((function(n,l,d){var m,h=Bt(Dt("data",d,l)),y=(m=ge(O.none()),{clear:function(){return m.set(O.none())},set:function(s){return m.set(O.some(s))},isSet:function(){return m.get().isSome()},on:function(n){return m.get().each(n)}}),w=t.shared.header.isPositionedAtTop(),S=function(){return y.on((function(dialog){Wg.reposition(dialog),CD.refresh(dialog)}))},k=CI({dataValidator:d,initialData:h,internalDialog:n},{redial:TF.redial,closeWindow:function(){y.on(Wg.hide),e.off("ResizeEditor",S),y.clear(),c(k.instanceApi)}},t,f),C=du(Wg.sketch(v(v({lazySink:t.shared.getSink,dom:{tag:"div",classes:[]},fireDismissalEventInstead:{}},w?{}:{fireRepositionEventInstead:{}}),{inlineBehaviours:Qa(x([ig("window-manager-inline-events",[$o(Io(),(function(n,t){jo(k.dialog,Wy)}))])],DI(e,o,w))),isExtraPart:function(n,t){return function(n){return gy(n,".tox-alert-dialog")||gy(n,".tox-confirm-dialog")}(t)}})));return y.set(C),Wg.showWithin(C,r,mu(k.dialog),O.some(body())),o&&w||(CD.refresh(C),e.on("ResizeEditor",S)),k.instanceApi.setData(h),Zm.focusIn(k.dialog),k.instanceApi}),n)};return{open:function(n,e,o){return void 0!==e&&"toolbar"===e.inline?d(n,t.shared.anchors.inlineDialog(),o,e.ariaAttrs):void 0!==e&&"cursor"===e.inline?d(n,t.shared.anchors.cursor(),o,e.ariaAttrs):l(n,o)},openUrl:function(n,t){return f(n,t)},alert:function(n,t){r.open(n,(function(){t()}))},close:function(n){n.close()},confirm:function(n,t){c.open(n,(function(n){t(n)}))}}};h.add("silver",(function(n){var t=JA(n),e=t.uiMothership,r=t.backstage,c=t.renderUI,f=t.getUi;sy(n,r.shared);var l=BI({editor:n,backstage:r});return{renderUI:c,getWindowManagerImpl:o(l),getNotificationManagerImpl:function(){return lp(0,{backstage:r},e)},ui:f()}}))}()}).call(this,e(111))}}]);</script>
</body>
</html>
