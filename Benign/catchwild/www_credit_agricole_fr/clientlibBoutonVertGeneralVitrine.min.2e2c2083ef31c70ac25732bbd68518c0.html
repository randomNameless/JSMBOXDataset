<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>clientlibBoutonVertGeneralVitrine.min.2e2c2083ef31c70ac25732bbd68518c0.html</title>
</head>
<body>

<script>
/*
 jQuery Validation Plugin v1.16.0

 http://jqueryvalidation.org/

 Copyright (c) 2016 JÃ¶rn Zaefferer
 Released under the MIT license
*/
(function(document,$,Granite,$document){NPC.startKeepAlive=function(){var url=location.origin+location.pathname.replace(".html",".activate-session.html");if(isFinite(NPC.keepAliveTime)){NPC.keepAliveInterval=setInterval(function(){var urlAjax=NPC.AddTransactionIdToUrl(url);$.ajax({type:"GET",url:urlAjax,success:function(data){console.log("keep alive - succeed to activate session")},error:function(data){console.error("keep alive - failed to activate session")}})},NPC.keepAliveTime);console.log("keep alive - startKeepAlive - OK");
return NPC.keepAliveInterval}else console.error("keep alive - could not set interval because of NPC.keepAliveTime value \x3d ["+NPC.keepAliveTime+"]")};NPC.endKeepAlive=function(){clearInterval(NPC.keepAliveInterval);console.log("keep alive - endKeepAlive - OK")}})(document,jQuery,Granite,jQuery(document));
(function(document,$,Granite,$document){var tchatOuvert=false;var chatSessionSave=null;var insererScriptGenesys=function(){var baseUrl=NPC.genesysTchatJsUrl;if(genesysScriptInserted==false)insererScript(baseUrl,function(){genesysScriptInserted=true;$(window).trigger("genesys.loaded")})};var insererScript=function(src,callback){var node=document.createElement("script");node.type="text/javascript";node.async=0;node.src=src;node.onload=node.onreadystatechange=function(_,isAbort){if(isAbort||!node.readyState||
/loaded|complete/.test(node.readyState)){node.onload=node.onreadystatechange=null;if(node.parentNode)node.parentNode.removeChild(node);node=null;if(!isAbort)callback()}};var s=document.getElementsByTagName("script")[0];s.parentNode.appendChild(node)};var genesysScriptInserted=false;var _getServletUrl=function(selector){var path=window.location.pathname;var pathPart=path.split(".");var size=pathPart.length-1;if(size<1)return;pathPart.splice(size,1);var basePath=pathPart.join(".");return basePath+"/jcr:content."+
selector};var urlSessionTchat=NPC.genererURLJson("get-session-tchat");var urlSuppressionSessionTchat=NPC.genererURLJson("remove-session-tchat");var fermerBoutonVertWCB=function(){$(window).trigger("close.bv");$(".js-GreenBtnContainer").find(".GreenBtn-callbackHome").hide();$(".js-GreenBtnContainer").find(".GreenBtn").hide()};insererScriptGenesys();$(window).on("genesys.loaded",function(){NPC.GENESYS={};NPC.GENESYS.openChat=function(){var openSessionObject=initVariables(1);lancerTchat(openSessionObject)};
NPC.GENESYS.openRappel=function(){var openSessionObject=initVariables(2);initWebCallBack(openSessionObject)};NPC.GENESYS.openNewChat=function(){lancerChatNew()}});var getInformationsClient=function(){var informationsClientModel=NPC.BV.$_BV_WRAPPER.data("value").modelData!=undefined?NPC.BV.$_BV_WRAPPER.data("value").modelData.informationsClient:null;var informationsClient={last_name:"",first_name:"",title_code:"",customer_id:"",phone_number:""};if(informationsClientModel){var prenomClients=informationsClientModel.firstNames;
if(prenomClients!=null&&prenomClients.length>0)prenomClient=prenomClients.join(" ");var nomClient="";var namesOfIndividualPerson=informationsClientModel.namesOfIndividualPerson;if(namesOfIndividualPerson!=null)if(namesOfIndividualPerson.usualName!=null&&namesOfIndividualPerson.usualName.trim()!="")nomClient=namesOfIndividualPerson.usualName;else if(namesOfIndividualPerson.marriedName!=null&&namesOfIndividualPerson.marriedName.trim()!="")nomClient=namesOfIndividualPerson.marriedName;else if(namesOfIndividualPerson.lastName!=
null&&namesOfIndividualPerson.lastName.trim()!="")nomClient=namesOfIndividualPerson.lastName;informationsClient.last_name=nomClient;informationsClient.first_name=prenomClient;informationsClient.title_code=informationsClientModel.titleLongLabel!=null?informationsClientModel.titleLongLabel:"";informationsClient.phone_number=informationsClientModel.mobilePhoneNumber!=null?informationsClientModel.mobilePhoneNumber:"";informationsClient.customer_id=informationsClientModel.id!=null?informationsClientModel.id:
""}return informationsClient};var initVariables=function(idChannel){var labelChannel=idChannel==1?"Chat":"wcb";var motifSelectionne=NPC.BV._BV_THEME;var gpuData=NPC.BV.$_BV_WRAPPER.data("value").gpuData;var idMarcheSelectionne=gpuData!="undefined"&&gpuData!=null&&gpuData.marcheSelectionne!=null&&!isNaN(gpuData.marcheSelectionne.marketId)?gpuData.marcheSelectionne.marketId:-1;var labelMarcheSelectionne=idMarcheSelectionne!=-1?gpuData.marcheSelectionne.label:undefined;var nomClient="";var prenomClient=
"";var civiliteClient="";var idClient="";var telClient="";var openSessionObject={theme:{"id":motifSelectionne.id,"label":motifSelectionne.label},channel:{"id":idChannel,"label":labelChannel},market:{"id":idMarcheSelectionne,"label":labelMarcheSelectionne},context:{"application_code":"string","origin_url":"string","device":NPC.BV.$_BV_WRAPPER.data("value").modelData.device,"legal_notice_url":NPC.BV.$_BV_WRAPPER.data("value").modelData.legalNoticeUrl},contact:getInformationsClient()};return openSessionObject};
var lancerTchat=function(openSessionObject){if(genesysScriptInserted==true){var numCR=NPC.idLiveCopyCaisse;numCR=numCR!="national"&&numCR!="master"?numCR.substring(2):numCR;var postParamsOpenSession={numeroCR:numCR,idMarche:openSessionObject.market.id,labelMarche:openSessionObject.market.label,idTheme:openSessionObject.theme.id,labelTheme:openSessionObject.theme.label,idChannel:openSessionObject.channel.id,labelChannel:openSessionObject.channel.label,customerId:openSessionObject.contact.customer_id,
titleCode:openSessionObject.contact.title_code,firstName:openSessionObject.contact.first_name,lastName:openSessionObject.contact.last_name,phoneNumber:openSessionObject.contact.phone_number};openSession(postParamsOpenSession,openSessionObject)}};var lancerChatNew=function(){var ncCallBackFct=function(){NPC.endKeepAlive()};var ncSuccessFct=function(){NPC.startKeepAlive();fermerBoutonVertWCB()};var ncTechnicalFct=function(){fermerBoutonVertWCB()};var ncBusinessFct=function(){fermerBoutonVertWCB()};
var gpuData=NPC.BV.$_BV_WRAPPER.data("value").gpuData;var motifSelectionne=NPC.BV._BV_THEME;var numeroCR=NPC.idLiveCopyCaisse;numeroCR=numeroCR!="national"&&numeroCR!="master"?numeroCR.substring(2):numeroCR;var idMarcheSelectionne=gpuData!="undefined"&&gpuData!=null&&gpuData.marcheSelectionne!=null&&!isNaN(gpuData.marcheSelectionne.marketId)?gpuData.marcheSelectionne.marketId:-1;var newChatData={"regional_bank_id":numeroCR,"market_id":idMarcheSelectionne,"theme_id":motifSelectionne.id};BVER.open_chat_new(newChatData,
ncCallBackFct,ncSuccessFct,ncTechnicalFct,ncBusinessFct)};function initWebCallBack(openSessionObject){var numeroCR=NPC.idLiveCopyCaisse;numeroCR=numeroCR!="national"&&numeroCR!="master"?numeroCR.substring(2):numeroCR;var request_wcb={technical_wcb:{frame_id:".js-GreenBtnContainer",div_id:".js-GreenBtnContainer",authorized_key:NPC.genesysTchatJsAuthorizationKey},business_wcb:{channel_id:"2",customer_id:openSessionObject.contact.customer_id,first_name:openSessionObject.contact.first_name,last_name:openSessionObject.contact.last_name,
market_id:openSessionObject.market.id,regional_bank_id:numeroCR,theme_id:openSessionObject.theme.id+"#"+openSessionObject.theme.label,title_code:openSessionObject.contact.title_code,schedule:getWebCallBackScheduls(),device:openSessionObject.context.device,legal_notice_url:location.origin+openSessionObject.context.legal_notice_url,time_zone_difference:NPC.BV.$_BV_WRAPPER.data("value").timezone_difference}};var reponseWcb={label_id:""};var successFct=function(){var $jscomp$this=this;var isIntoTchatWCBContainer=
$(this).filter(function(){return $($jscomp$this).parents(".tchatWCBContainer").length||$($jscomp$this).hasClass("tchatWCBContainer")});if(isIntoTchatWCBContainer){NPC.BV.FUNCTIONS.OPENCLOSE.ouvrirBoutonVert();$(window).trigger("startBV.loaded")}$(".js-radio-label").on("click",function(){var $this=$(this);var $input=$this.prev("input");$input.prop("checked","checked")});$(".GreenBtn-callbackClose").on("click",function(){NPC.BV.FUNCTIONS.OPENCLOSE.closeBV()});NPC.FUNCTIONS.TRACKING.refreshTracking();
$(window).trigger("layout.bv")};var technicalFct=function(reponseWcb){fermerBoutonVertWCB()};var businessFct=function(reponseWcb){fermerBoutonVertWCB()};var wcbEndedCallBack=function(){$(window).trigger("close.bv")};BVER.open_wcb(request_wcb,wcbEndedCallBack,successFct,technicalFct,businessFct);$(window).trigger("wcb.called");$(window).trigger("layout.bv")}function initTchat(openSessionObject,reponse){var numeroCR=NPC.idLiveCopyCaisse;numeroCR=numeroCR!="national"&&numeroCR!="master"?numeroCR.substring(2):
numeroCR;var request_chat={technical_chat:{div_id:"#tchat_session",frame_id:"#tchat_session",session_id:reponse.session_id,user_id:reponse.user_id,secure_key:reponse.secure_key,alias:reponse.alias,authorized_key:NPC.genesysTchatJsAuthorizationKey},business_chat:{regional_bank_id:numeroCR,first_name:openSessionObject.contact.first_name,last_name:openSessionObject.contact.last_name,customer_id:openSessionObject.contact.customer_id,market_id:openSessionObject.market.id,channel_id:openSessionObject.channel.id,
theme_id:openSessionObject.theme.id+"#"+openSessionObject.theme.label,device:openSessionObject.context.device,legal_notice_url:location.origin+openSessionObject.context.legal_notice_url}};var successFct=function(){$(window).trigger("npcTchat.ouvert");var chatSession={};chatSession.ouvrirChat=true;chatSession.openSessionObject=openSessionObject;chatSession.wasConnected=NPC.user.isConnected;chatSession.requestChat=request_chat;tchatOuvert=true;var cookieNavString=NPC.recupererCookie("chat-session-navigation");
var cookieNavObject=null;if(!cookieNavString)cookieNavObject=chatSession;else{cookieNavObject=JSON.parse(window.unescape(cookieNavString));cookieNavObject.ouvrirChat=chatSession.ouvrirChat;cookieNavObject.openSessionObject=chatSession.openSessionObject;cookieNavObject.wasConnected=chatSession.wasConnected}NPC.affecterCookie("chat-session-navigation",JSON.stringify(cookieNavObject));chatSessionSave=cookieNavObject;NPC.startKeepAlive();fermerBoutonVertWCB()};var reponse={label_id:""};var technicalFct=
function(reponse){};var businessFct=function(reponse){};var successFctEnd=function(){NPC.supprimerCookie("chat-session-navigation");chatSessionSave=null};var chatEndedCallBackFct=function(){supprimerTchatSession();NPC.supprimerCookie("chat-session-navigation");chatSessionSave=null;NPC.endKeepAlive()};var supprimerTchatSession=function(){var urlAjax=NPC.AddTransactionIdToUrl(urlSuppressionSessionTchat);$.ajax({type:"POST",url:urlAjax,data:{},cache:true,success:function(data){},error:function(data){}})};
var isTchatlaunchedBeforCo=NPC.recupererCookie("chat-session");var chatSessionNavigation=NPC.recupererCookie("chat-session-navigation");var chatData;if(!isTchatlaunchedBeforCo)if(chatSessionNavigation){var tchatSessionObject=JSON.parse(window.unescape(chatSessionNavigation));var chatData=tchatSessionObject.requestChat?tchatSessionObject.requestChat:request_chat;BVER.open_chat(chatData,chatEndedCallBackFct,successFct,technicalFct,businessFct)}else{chatData=request_chat;BVER.open_chat(chatData,chatEndedCallBackFct,
successFct,technicalFct,businessFct)}else{var updateChatSession=JSON.parse(chatSessionNavigation);var chatData=updateChatSession.requestChat;NPC.supprimerCookie("chat-session");var informationsCliensAJour=getInformationsClient();if(informationsCliensAJour){chatData.business_chat.last_name=informationsCliensAJour.last_name?informationsCliensAJour.last_name:"";chatData.business_chat.first_name=informationsCliensAJour.first_name?informationsCliensAJour.first_name:"";chatData.business_chat.customer_id=
informationsCliensAJour.customer_id?informationsCliensAJour.customer_id:""}chatData.business_chat.regional_bank_id=numeroCR;updateChatSession.requestChat=chatData;NPC.supprimerCookie("chat-session-navigation");NPC.affecterCookie("chat-session-navigation",JSON.stringify(updateChatSession));BVER.open_chat(chatData,chatEndedCallBackFct,successFct,technicalFct,businessFct)}}function getWebCallBackScheduls(){var bvDataSelector=NPC.BV.$_BV_WRAPPER.data("value");var motifSelectionne=null;var motifSelectionneId=
null;var gpuData=null;var themesList=null;var SchedulsWCB=null;if(bvDataSelector.motifSelected==undefined)return false;else if(bvDataSelector.motifSelected.id==undefined)return false;else if(bvDataSelector.gpuData==undefined)return false;else if(bvDataSelector.gpuData.listThemes==undefined)return false;else{motifSelectionne=bvDataSelector.motifSelected;motifSelectionneId=motifSelectionne.id;gpuData=bvDataSelector.gpuData;themesList=gpuData!=null?gpuData.listThemes:null;if(themesList!=null)$.each(themesList,
function(index,currentTheme){if(currentTheme!=undefined&&currentTheme.themeId==motifSelectionneId){$.each(currentTheme.channelsList,function(index,currentChannel){if(currentChannel.channelId==2){SchedulsWCB=currentChannel.schedule;return false}});return false}})}return SchedulsWCB}function openSession(postParamsOpenSession,openSessionObject){var urlAjax=NPC.AddTransactionIdToUrl(urlSessionTchat);$.ajax({type:"POST",url:urlAjax,data:postParamsOpenSession,cache:true,success:function(data){initTchat(openSessionObject,
data)},error:function(data){return null}})}$(window).load(function(){var chatSessionJSON=NPC.recupererCookie("chat-session-navigation");if(chatSessionJSON){var dataChatSession=JSON.parse(window.unescape(chatSessionJSON));if(dataChatSession&&dataChatSession.ouvrirChat&&dataChatSession.openSessionObject&&dataChatSession.requestChat)initTchat(dataChatSession.openSessionObject,dataChatSession.requestChat.technical_chat);else{var variables=initVariableForChatMOCO(dataChatSession);initTchat(variables,dataChatSession)}}});
function initVariableForChatMOCO(data){var variables=initVariables(1);variables.market.id=data.id_market;variables.market.label=data.label_market;return variables}$(".npc-msl-button[name\x3d'btnMeConnecter']").click(function(){$(window).trigger("connexion.tchat")});$(window).on("connexion.tchat",function(){if(chatSessionSave!=null)NPC.affecterCookie("chat-session",true)});$("#header-logged-logoff-modal").click(function(){fermetureTchatAuto()});var fermetureTchatAuto=function(){var successFct=function(){NPC.supprimerCookie("chat-session-navigation")};
var technicalFct=function(reponse){};var businessFct=function(reponse){};var chatSessionJSON=NPC.recupererCookie("chat-session-navigation");if(chatSessionJSON){var chatSessionObject=JSON.parse(window.unescape(chatSessionJSON));BVER.close_chat(chatSessionObject.requestChat,successFct,technicalFct,businessFct)}};$(window).onbeforeunload=function(){fermetureTchatAuto()}})(document,jQuery,Granite,jQuery(document));var deconnecter;
(function(document,$,Granite,$document){$("#header-logged-logoff").on("click",function(evt){if($("#tchat_session").children().length>0){evt.preventDefault();$("#modalTchat").modal("show")}});deconnecter=function(url){if($("#tchat_session").children().length>0)$("#modalTchat").modal("show");else NPC.deconnexion.deconnexionManuelle(url)}})(document,jQuery,Granite,jQuery(document));
if(!Array.prototype.filter)Array.prototype.filter=function(fun){if(this===void 0||this===null)throw new TypeError;var t=Object(this);var len=t.length>>>0;if(len>t.length||typeof fun!="function")throw new TypeError;var res=[];var thisArg=arguments.length>=2?arguments[1]:void 0;for(var i=0;i<len;i++)if(i in t){var val=t[i];if(fun.call(thisArg,val,i,t))res.push(val)}return res};
if(!Array.prototype.forEach)Array.prototype.forEach=function(callback){var T,k;if(this==null)throw new TypeError(" this vaut null ou n est pas d\u00e9fini");var O=Object(this);var len=O.length>>>0;if(typeof callback!=="function")throw new TypeError(callback+" n est pas une fonction");if(arguments.length>1)T=arguments[1];k=0;while(k<len){var kValue;if(k in O){kValue=O[k];callback.call(T,kValue,k,O)}k++}};
if(typeof Object.assign!="function")Object.defineProperty(Object,"assign",{value:function assign(target){if(target==null)throw new TypeError("Cannot convert undefined or null to object");var to=Object(target);for(var index=1;index<arguments.length;index++){var nextSource=arguments[index];if(nextSource!=null)for(var nextKey in nextSource)if(Object.prototype.hasOwnProperty.call(nextSource,nextKey))to[nextKey]=nextSource[nextKey]}return to},writable:true,configurable:true});
var listManagerFactory=function(){var map={};var list=[];return{hasItemId:function(id){return map[id]!==undefined},addItem:function(item){if(this.hasItemId(item.id)===true)return false;map[item.id]=item;list.push(item.id)},removeItemId:function(id){if(this.hasItemId(id)===false)return false;map[id]=undefined;list.splice(list.indexOf(id),1)},removeAll:function(){map={};list=[]},getLength:function(){return list.length},getAll:function(){var r=[];list.forEach(function(id){r.push(map[id])});return r},
getById:function(id){return map[id]},forEach:function(forFunc){var listClone=list.slice(0);return listClone.forEach(function(id){forFunc(map[id])})}}};var mapFactory=null;
(function(){var defaultOptions={ZOOM:13,ICONS:{public:"../resources/images/commun/ca-pin.png",specific:"../resources/images/commun/ca-pin4.png",green_point:"../resources/images/commun/ca-pin2.png",square:"../resources/images/commun/ca-pin3.png",chalus:"../resources/images/commun/ca-pin-chalus.png"},DEFAULT_ICON:"public",GOOGLE_ITINERARY_PATTERN:"https://www.google.fr/maps/dir/"};mapFactory=function(map,opts){var gmap=null;var oldMap=null;var markers=listManagerFactory();var mapInfo=null;var options;
var onClickMarkerList=[];var onBoxCloseList=[];var markerIdOpened=null;var setOptions=function(opts){options=Object.assign({},defaultOptions,window.StoreLocatorFactoryOptions,opts);return true};var initMap=function(map){if(map===oldMap)return false;var mapOptions={zoom:options.ZOOM,mapTypeId:google.maps.MapTypeId.ROADMAP};gmap=new google.maps.Map(map,mapOptions);mapInfo=new google.maps.InfoWindow({content:""});google.maps.event.addListener(mapInfo,"closeclick",function(){onBoxCloseList.forEach(function(onBoxClose){onBoxClose(getMarkerById(markerIdOpened))})});
oldMap=map};var addOnBoxClose=function(func){onBoxCloseList.push(func)};var addOnClickMarker=function(func){onClickMarkerList.push(func)};var getMarkerById=function(markerId){return markers.getById(markerId)||null};var getMarkerPosition=function(marker){return marker.marker.getPosition()};var fitBounds=function(delta){if(delta===undefined||typeof delta!=="object"){var intDelta=isNaN(delta)?0:parseFloat(delta);delta={lat:intDelta,lng:intDelta}}if(markers.getLength()===1){var marker=markers.getAll()[0];
var position=getMarkerPosition(marker);gmap.setCenter({lat:position.lat(),lng:position.lng()});gmap.setZoom(options.ZOOM);return true}var latMin=Infinity;var latMax=-Infinity;var lngMin=Infinity;var lngMax=-Infinity;markers.forEach(function(marker){var lat=marker.marker.position.lat();var lng=marker.marker.position.lng();if(lat<latMin)latMin=lat;if(lat>latMax)latMax=lat;if(lng<lngMin)lngMin=lng;if(lng>lngMax)lngMax=lng});gmap.fitBounds(new google.maps.LatLngBounds(new google.maps.LatLng(latMin-delta.lat,
lngMin-delta.lng),new google.maps.LatLng(latMax+delta.lat,lngMax+delta.lng)))};var getMarkerOpened=function(){if(mapInfo.getAnchor()===null||markerIdOpened===null)return false;return markers.getById(markerIdOpened)};var closeMarker=function(){if(mapInfo.getAnchor()!==null)mapInfo.close();markerIdOpened=null};addOnClickMarker(closeMarker);var openMarker=function(markerId){var marker;if(typeof markerId==="string")marker=getMarkerById(markerId);else marker=markerId;markerIdOpened=marker.id;if(marker.content){mapInfo.setContent(marker.content);
mapInfo.open(gmap,marker.marker)}};var setVisibleById=function(markerId,visible){var marker=getMarkerById(markerId);if(marker===null)return false;marker.marker.setVisible(visible);if(visible===false&&mapInfo.getAnchor()===marker.marker)mapInfo.close();else if(visible===true&&marker.id===markerIdOpened)openMarker(markerId);return true};var triggerFocus=function(marker){onClickMarkerList.forEach(function(onFocusMarker){onFocusMarker(marker)})};setOptions(opts);initMap(map);var getIcon=function(type){if(type[0]==
2)return"green_point";else if(type[0]==3)return"square";else if(type[0]==4||type[0]==5)return"dab";else if(type[0]==6)return"e_agence";else if(NPC.idLiveCopyCaisse=="cr764")return"chalus";else return"public"};var actions={initMap:initMap,setOptions:setOptions,getOptions:function(){return options},getGmap:function(){return gmap},addMarker:function(marker){var newMarker={id:marker.id,content:marker.content,marker:new google.maps.Marker({position:new google.maps.LatLng(marker.lat,marker.lng),clickable:!!marker.content,
icon:"undefined"!=typeof marker.type&&options.ICONS[marker.type]||"undefined"!=typeof marker.type&&options.ICONS[getIcon(marker.type)]||options.ICONS[options.DEFAULT_ICON],map:gmap})};google.maps.event.addListener(newMarker.marker,"click",function(){triggerFocus(newMarker)});markers.addItem(newMarker);return true},fitBounds:fitBounds,getMarkerById:getMarkerById,getMarkerPosition:getMarkerPosition,getMarkerOpened:getMarkerOpened,getAllMarkers:function(){return markers.getAll()},removeMarker:function(markerId){var marker=
getMarkerById(markerId);marker.marker.setMap(null);markers.removeItemId(markerId)},showMarker:function(markerId){return setVisibleById(markerId,true)},hideMarker:function(markerId){return setVisibleById(markerId,false)},removeAllMarker:function(){markers.forEach(function(marker){actions.removeMarker(marker.id)});return true},openMarker:openMarker,focusMarker:function(markerId,needOpen){var marker=getMarkerById(markerId);if(marker===null||marker.marker.getVisible()===false)return false;if(needOpen)openMarker(marker);
else gmap.panTo(marker.marker.getPosition())},addOnClickMarker:addOnClickMarker,addOnBoxClose:addOnBoxClose,openItinerary:function(){var url=options.GOOGLE_ITINERARY_PATTERN;if(typeof NPC!=="undefined"&&typeof NPC.geoloc!=="undefined")if(NPC.geoloc.geolocalized)url+=NPC.geoloc.lat+","+NPC.geoloc.long;var marker=getMarkerOpened();if(marker===false)return false;var position=getMarkerPosition(marker);url+="/"+position.lat()+","+position.lng()+"/";return window.open(url,"_blank")}};return actions}})();
var filtersManagerFactory;
(function(){filtersManagerFactory=function($forms,baseFilters){var currentFilters=Object.assign({},baseFilters);var tempFilters=Object.assign({},currentFilters);var onApplyFiltersList=[];var $checks,$selects;var getFilters=function(){return Object.assign({},currentFilters)};var render=function(){$checks.each(function(){var $this=$(this);var filter=$this.data("filter");var value=$this.val();var checked=$this.is(":checked");var needCheck=hasCurrentFilterValue(filter,value);if(checked!==needCheck)$this.prop("checked",
needCheck)});$selects.each(function(){var $this=$(this);var filter=$this.data("filter");var value=$this.val();var needCheck=value!==currentFilters[filter];if(needCheck===true)$this.val(currentFilters[filter]).trigger("change")})};var applyFilters=function(){currentFilters=Object.assign({},tempFilters);render();var filters=getFilters();onApplyFiltersList.forEach(function(onApplyFilters){onApplyFilters(filters)})};var hasFilterValue=function(filters,filterName,value){if(typeof currentFilters[filterName]===
"string")return currentFilters[filterName]===value;else return currentFilters[filterName].indexOf(value)!==-1};var hasTempFilterValue=function(filterName,value){return hasFilterValue(tempFilters,filterName,value)};var hasCurrentFilterValue=function(filterName,value){return hasFilterValue(currentFilters,filterName,value)};var setTempFilterValue=function(filterName,value,add){if(typeof tempFilters[filterName]==="string")tempFilters[filterName]=add===true?value:"";else{var index=tempFilters[filterName].indexOf(value);
if(add===true&&index===-1)tempFilters[filterName]=[].concat(tempFilters[filterName],value);else if(add===false&&index!==-1)tempFilters[filterName]=tempFilters[filterName].filter(function(val){return val!==value})}};var initFormsElements=function($forms){$checks=$forms.find('input[type\x3d"checkbox"]');$selects=$forms.find("select");$checks.off("click.filterManager").on("click.filterManager",function(){var $this=$(this);var filter=$this.data("filter");var value=$this.val();var checked=$this.is(":checked");
if(hasTempFilterValue(filter,value)!==checked)setTempFilterValue(filter,value,checked)});$selects.off("change.filterManager").on("change.filterManager",function(){var $this=$(this);var filter=$this.data("filter");var value=$this.val();if(!hasTempFilterValue(filter,value))setTempFilterValue(filter,value,true)});render()};initFormsElements($forms);return{resetFilters:function(){tempFilters=Object.assign({},baseFilters);applyFilters()},applyFilters:applyFilters,cancelFilters:function(){tempFilters=Object.assign({},
currentFilters);render()},setFilterValue:setTempFilterValue,getFilters:getFilters,addOnApplyFilters:function(func){onApplyFiltersList.push(func)},initFormsElements:initFormsElements}}})();var mapManagerFactory;
(function($,listManagerFactory){var mapManagerDefaultOptions=function(){return{ZOOM:13,ICONS:{public:"../images/commun/ca-pin.png",specific:"../images/commun/ca-pin4.png",green_point:"../images/commun/ca-pin2.png",square:"../images/commun/ca-pin3.png"},DEFAULT_ICON:"public",CONTENT_CONTAINER_SELECTOR:".js-StoreLocatorMap-content",AGENCY_CONTENT_SELECTOR:".js-storeLoc-content",ACTIVE_CLASS:"active",TOGGLE_CLASS:"toggle-open",MAP_CLASS:"js-StoreLocatorMap-Map",CURRENT_CLASS:"current",HIDDEN_CLASS:"hidden",
MAP_FOCUSED_CLASS:"has-mapFocus",MAP_LEFT_CLASS:"has-mapLeft",OPEN_CLASS:"open",MODAL_SEARCH_CLASS:"js-FilterModal-Search",STORE_LOCATOR_MAP_SELECTOR:".js-StoreLocatorMap-GMap",FILTER_FORMS_SELECTOR:".js-StoreLocatorMap-Filters,.js-FilterModal-Filters",STORE_LOCATOR_TOGGLE_SELECTOR:".js-StoreLocatorToggle",STORE_LOCATOR_FILTER_TOGGLE_SELECTOR:".js-StoreLocatorFilterToggle",STORE_LOCATOR_FINDER_SELECTOR:".js-StoreLocatorFinder",HEAD_LINK_SELECTOR:".js-StoreLocatorCard-headLink",HEAD_LINK__REDIRECT_SELECTOR:".js-StoreLocatorCard-headLink--redirect",
OPEN_FILTER_SELECTOR:".js-filter",AGENCY_SELECTOR:".js-storeLoc-agency",SELECT_AGENCY_SELECTOR:".js-storeLoc-selectAgency",FILTER_FORMS_AUTO_SUBMIT_SELECTOR:".js-StoreLocatorMap-Filters",AGENCY_COUNT_SELECTOR:".js-StoreLocatorMap-near",NO_AGENCIES_SELECTOR:".js-StoreLocatorMap-Agency--noResult",FILTER_MODAL_SELECTOR:".js-FilterModal",FILTER_MODAL__APPLY_SELECTOR:".js-FilterModal-apply",FILTER_MODAL__RESET_SELECTOR:".js-FilterModal-reset",MAP_FOCUSED_BASE:false,SEARCH_FOCUSED_BASE:false,GOOGLE_ITINERARY_PATTERN:"https://www.google.fr/maps/dir//",
AGENCY_COUNT_TEXT:function(showedCount){return showedCount+" agence"+(showedCount>1?"s":"")},DEFINE_SELECTED_STRUCTURE_TYPE:function(agencies){var allAgenciesTypes=agencies.map(function(agency){return agency.type});var agenciesUniqueTypes=allAgenciesTypes.filter(function(value,index,self){return self.indexOf(value)===index});return agenciesUniqueTypes.length===1?agenciesUniqueTypes[0]:null},DEFAULT_FILTERS:function(agencies){var uniqueStructureSelected=this.DEFINE_SELECTED_STRUCTURE_TYPE(agencies);
return{type:uniqueStructureSelected?uniqueStructureSelected:"",service:[],openings:[],attribute:[]}},DEFINE_AGENCY_WITH_AGENCY:function($agency,options){var data=$agency.data("val");var content=$agency.find(options.AGENCY_CONTENT_SELECTOR).html();return{id:data.id,lat:data.latitude,lng:data.longitude,type:data.type,isEagence:data.isEagence,service:data.service,openings:data.openings,attribute:data.attribute,content:content,$item:$agency}},IS_FILTERED_AGENCY:function(agency,filters){if(filters.type!==
""&&agency.type.indexOf(filters.type)===-1)return false;if(filters.service.length!==0&&filters.service.indexOf(agency.service)===-1)return false;var agencyOpenedMonday=agency.openings.indexOf("monday")!==-1;var agencyOpenedSaturday=agency.openings.indexOf("saturday")!==-1;var filterMonday=filters.openings.indexOf("monday")!==-1;var filterSaturday=filters.openings.indexOf("saturday")!==-1;if(filters.openings.length!==0){if(filterMonday===true&&agencyOpenedMonday===false)return false;if(filterSaturday===
true&&agencyOpenedSaturday===false)return false}if(filters.attribute.length!==0&&filters.attribute.indexOf(agency.attribute)===-1)return false;return true}}}();mapManagerFactory=function($containerBase,opts){var options=Object.assign({},mapManagerDefaultOptions,window.StoreLocatorFactoryOptions,opts);var $container;var $filterModal;var $filterModalApply;var $filterModalReset;var $containers;var mapElement;var $filterForms;var $contentContainer;var $StoreLocatorToggle;var $StoreLocatorFilterToggle;
var $StoreLocatorFinder;var $headLink;var $headLinkRedirect;var $openFilter;var $agencies;var $filterFormsAutoSubmit;var $agencyCount;var $noAgencies;var map,filters,hasSearch;var filtersLast=null;var mapFocused=options.MAP_FOCUSED_BASE;var mapFocusedLast=null;var searchFocused=options.SEARCH_FOCUSED_BASE;var searchFocusedLast=null;var agencies=null;var dirtyAgencies=true;var render=function(){var currentFilters=filters.getFilters();if(dirtyAgencies===true||JSON.stringify(currentFilters)!==filtersLast){var showedCount=
0;agencies.forEach(function(agency){var showed=options.IS_FILTERED_AGENCY(agency,currentFilters);agency.$item.toggleClass(options.HIDDEN_CLASS,showed===false);if(showed===true){map.showMarker(agency.id);showedCount+=1}else map.hideMarker(agency.id)});$agencyCount.text(typeof options.AGENCY_COUNT_TEXT==="function"?options.AGENCY_COUNT_TEXT(showedCount):options.AGENCY_COUNT_TEXT);$noAgencies.toggleClass(options.HIDDEN_CLASS,showedCount!==0);filtersLast=JSON.stringify(filters.getFilters())}if(mapFocused!==
mapFocusedLast){$contentContainer.toggleClass(options.MAP_FOCUSED_CLASS,mapFocused);$StoreLocatorToggle.each(function(){var $this=$(this);$this.toggleClass(options.ACTIVE_CLASS,$this.data("target")===options.MAP_CLASS?mapFocused:!mapFocused)});mapFocusedLast=mapFocused}if(searchFocused!==searchFocusedLast){$StoreLocatorFilterToggle.each(function(){var $this=$(this);var target=$this.data("target");var toggle=target===options.MODAL_SEARCH_CLASS?searchFocused:!searchFocused;$this.toggleClass(options.ACTIVE_CLASS,
toggle);$containers.find("."+target).toggleClass(options.TOGGLE_CLASS,toggle)});$StoreLocatorFinder.toggleClass(options.OPEN_CLASS,searchFocused);$headLink.toggleClass(options.HIDDEN_CLASS,!hasSearch||searchFocused);$headLinkRedirect.toggleClass(options.HIDDEN_CLASS,hasSearch&&!searchFocused);searchFocusedLast=searchFocused}dirtyAgencies=false};var getMapElement=function(){return $containers.find(options.STORE_LOCATOR_MAP_SELECTOR)[0]};var getAgencies=function(){return $containers.find(options.AGENCY_SELECTOR)};
var initAgencies=function(){dirtyAgencies=true;$agencies=getAgencies();$noAgencies=$containers.find(options.NO_AGENCIES_SELECTOR);if(!agencies)agencies=listManagerFactory();else agencies.removeAll()};var initMap=function(){if(!map)map=mapFactory(mapElement,options);else{map.removeAllMarker();map.initMap(mapElement)}var hasAgence=false;var $eagencies=[];$agencies.each(function(){var $agency=$(this);var agency=options.DEFINE_AGENCY_WITH_AGENCY($agency,options);if(!agency.isEagence){hasAgence=true;agencies.addItem(agency);
map.addMarker({id:agency.id,lat:agency.lat,lng:agency.lng,type:agency.type[0],content:agency.content})}else $eagencies.push(agency)});if(hasAgence)map.fitBounds(.005);$eagencies.forEach(function(eagency){agencies.addItem(eagency);map.addMarker({id:eagency.id,lat:eagency.lat,lng:eagency.lng,type:eagency.type[0],content:eagency.content})});if(!hasAgence)map.fitBounds(.005);render()};var init=function($containerBase){$container=$containerBase;$filterModal=$container.find(options.FILTER_MODAL_SELECTOR);
$filterModalApply=$filterModal.find(options.FILTER_MODAL__APPLY_SELECTOR);$filterModalReset=$filterModal.find(options.FILTER_MODAL__RESET_SELECTOR);$containers=$container.add($filterModal);mapElement=getMapElement();$filterForms=$containers.find(options.FILTER_FORMS_SELECTOR);$contentContainer=$containers.find(options.CONTENT_CONTAINER_SELECTOR);$StoreLocatorToggle=$containers.find(options.STORE_LOCATOR_TOGGLE_SELECTOR);$StoreLocatorFilterToggle=$containers.find(options.STORE_LOCATOR_FILTER_TOGGLE_SELECTOR);
$StoreLocatorFinder=$containers.find(options.STORE_LOCATOR_FINDER_SELECTOR);$headLink=$containers.find(options.HEAD_LINK_SELECTOR);$headLinkRedirect=$containers.find(options.HEAD_LINK__REDIRECT_SELECTOR);$openFilter=$containers.find(options.OPEN_FILTER_SELECTOR);$filterFormsAutoSubmit=$containers.find(options.FILTER_FORMS_AUTO_SUBMIT_SELECTOR);$agencyCount=$containers.find(options.AGENCY_COUNT_SELECTOR);hasSearch=$headLink.length!==0;initAgencies();filtersLast=null;mapFocusedLast=null;searchFocusedLast=
null;if(!filters)filters=filtersManagerFactory($filterForms,typeof options.DEFAULT_FILTERS==="function"?options.DEFAULT_FILTERS(agencies.getAll()):options.DEFAULT_FILTERS);else filters.initFormsElements($filterForms);initMap();var focusAgency=function(agency){map.focusMarker(agency.id,true);agencies.forEach(function(a){a.$item.toggleClass(options.CURRENT_CLASS,a.id===agency.id)});mapFocused=true;render()};map.addOnClickMarker(focusAgency);map.addOnBoxClose(function(marker){agencies.getById(marker.id).$item.removeClass(options.CURRENT_CLASS)});
agencies.forEach(function(agency){agency.$item.off("click.storeLocator",options.SELECT_AGENCY_SELECTOR).on("click.storeLocator",options.SELECT_AGENCY_SELECTOR,function(e){e.preventDefault();focusAgency(agency)})});filters.addOnApplyFilters(function(){render()});$StoreLocatorToggle.off("click.storeLocator").on("click.storeLocator",function(e){e.preventDefault();mapFocused=$(this).data("target")===options.MAP_CLASS;render()});$StoreLocatorFilterToggle.off("click.storeLocator").on("click.storeLocator",
function(e){e.preventDefault();searchFocused=$(this).data("target")===options.MODAL_SEARCH_CLASS;render()});$openFilter.off("click.storeLocator").on("click.storeLocator",function(e){e.preventDefault();$filterModal.modal("show")});$filterModalApply.off("click.storeLocator").on("click.storeLocator",function(e){e.preventDefault();filters.applyFilters();$filterModal.modal("hide");render()});$filterModalReset.off("click.storeLocator").on("click.storeLocator",function(e){e.preventDefault();filters.resetFilters()});
$filterModal.off("hidden.bs.modal.storeLocator").on("hidden.bs.modal.storeLocator",function(){filters.cancelFilters()});var asyncApplyFilters=function(){setTimeout(function(){filters.applyFilters()},10)};$filterFormsAutoSubmit.off("click.storeLocator",'input[type\x3d"checkbox"]').on("click.storeLocator",'input[type\x3d"checkbox"]',asyncApplyFilters);$filterFormsAutoSubmit.off("change.storeLocator","select").on("change.storeLocator","select",asyncApplyFilters);$headLink.on("click.storeLocator").on("click.storeLocator",
function(e){e.preventDefault();searchFocused=true;render()});$contentContainer.toggleClass(options.MAP_LEFT_CLASS,$StoreLocatorToggle.filter('[data-target\x3d"'+options.MAP_CLASS+'"]:first').length);render()};init($containerBase);return{initialize:function($containerBase){return init($containerBase)},resetFilters:function(){return filters.resetFilters()},requireInit:function(){if($containerBase!==$container)return true;if(mapElement!==getMapElement())return true;if(this.agenciesIsChanged()===true)return true;
return false},agenciesChanged:function(){initAgencies();initMap()},agenciesIsChanged:function(){var $currentAgencies=getAgencies();var sameAgenciesElements=true;$currentAgencies.each(function(i){if(this!==$agencies[i]){sameAgenciesElements=false;return false}});return sameAgenciesElements!==true}}}})(jQuery,listManagerFactory);
$(function(){var $controls=$(".js-FindAgency-Control");var $submit=$(".js-FindAgency-Submit");if($controls.length>0&&$submit.length>0){$submit.attr("disabled",true);$controls.on("keyup change",function(){var filled=false;$controls.each(function(){var $this=$(this);if($this.val()&&$this.val()!=="")filled=true});if(!filled)$submit.attr("disabled",true);else $submit.attr("disabled",false)});return true}else return false});
$(function(){var regex_agence=/(agence)\/.*\.html|\.html/;var stl_replacement="$1/jcr:content.localisation-agences.html";var clearSessionGeolocData=function(){var target=location.pathname.replace(regex_agence,stl_replacement);var data={"storelocator_no_redirection":1};$.ajax({url:target,type:"POST",data:data,dataType:"json",error:function(){console.log("Erreur lors de la suppression des donnees de geoloc")},success:function(code_json){}})};var refreshWithLatLong=function(){var lat=NPC.geoloc.lat;
var long=NPC.geoloc.long;if(lat===undefined&&long===undefined){var target=location.pathname.replace(regex_agence,stl_replacement);var $form=$(NPC.createHiddenFormCode(target,"post",{"storelocator_locationagencies_latitude":lat,"storelocator_locationagencies_longitude":long}));$("body").append($form);$form.submit()}else getPostalCode(lat,long,postDataByLocation)};var refreshWithErrorPage=function(){var target=location.pathname.replace(regex_agence,stl_replacement);var $form=$(NPC.createHiddenFormCode(target,
"post",{}));$("body").append($form);$form.submit()};function getPostalCode(lat,long,_callback){var latlng={lat:parseFloat(lat),lng:parseFloat(long)};var geocoder=new google.maps.Geocoder;try{geocoder.geocode({location:latlng}).then(function(response){if(response.results[0])var cp=response.results[0].address_components.find(function(element){return element.types.includes("postal_code")}).long_name;else var cp="";_callback(lat,long,cp)}).catch(function(e){return console.error("API Geocoder indisponnible -"+
e)})}catch(ex){console.error("API google maps indisponnible -",ex.message)}}function postDataByLocation(lat,long,zipCode){var target=location.pathname.replace(regex_agence,stl_replacement);var $form=$(NPC.createHiddenFormCode(target,"post",{"storelocator_locationagencies_latitude":lat,"storelocator_locationagencies_longitude":long,"storelocator_locationagencies_zipcode":zipCode}));$("body").append($form);$form.submit()}var refreshWithAddress=function(address,city){var address=$(address).val();var zipcode=
$(city+" option:selected").val();var cityName=$(city+" option:selected").text();if(zipcode&&cityName){var params={"storelocator_locationagencies_cityname":cityName,"storelocator_locationagencies_zipcode":zipcode};postData(params)}else{var geocoder=new google.maps.Geocoder;geocoder.geocode({"address":address},function(results,status){if(status==="OK")if(results[0].address_components.find(function(element){return element.types.includes("postal_code")})){var params={"storelocator_locationagencies_address":address,
"storelocator_locationagencies_zipcode":results[0].address_components.find(function(element){return element.types.includes("postal_code")}).long_name};postData(params)}else{var long=results[0].geometry.location.lng();var lat=results[0].geometry.location.lat();getPostalCode(lat,long,postDataByLocation)}else{var params={"storelocator_locationagencies_address":address};postData(params)}})}};function postData(params){var target=location.pathname.replace(regex_agence,stl_replacement);var $form=$(NPC.createHiddenFormCode(target,
"post",params));$("body").append($form);$form.submit()}var tryToGeoloc=false;if(NPC.storeLocator.enableCleanGeoLoc){NPC.geoloc.addCallBackFnc(null,clearSessionGeolocData);tryToGeoloc=true}if(NPC&&NPC.t034&&NPC.t034.refreshWithLatLong){NPC.geoloc.addCallBackFnc(refreshWithLatLong);tryToGeoloc=true}if(tryToGeoloc)NPC.geoloc.tryToGeoloc();var checkGeolocalizedAndCallRefreshWithLatLong=function(){if(NPC.geoloc.geolocalized)refreshWithLatLong();else{NPC.geoloc.addCallBackFnc(refreshWithLatLong,refreshWithErrorPage);
NPC.geoloc.tryToGeoloc()}};$(".FindAgency .searchByAddress").on("click touchstart",function(){refreshWithAddress("#address","#city")});$(".FindAgency .searchByLocation").on("click touchstart",function(){checkGeolocalizedAndCallRefreshWithLatLong()});$(".StoreLocatorFinder .searchByAddress").on("click touchstart",function(){refreshWithAddress("#address","#city")});$(".StoreLocatorFinder .searchByLocation").on("click touchstart",function(){checkGeolocalizedAndCallRefreshWithLatLong()});$(".FilterModal-Search .m-searchByAddress").on("click touchstart",
function(){refreshWithAddress("#m-address","#m-city")});$(".FilterModal-Search .m-searchByLocation").on("click touchstart",function(){checkGeolocalizedAndCallRefreshWithLatLong()})});
$(function(){$(".js-FindAgency-flexAlign").matchHeight();enquire.register(CommonNPC.medias.mqXsMax,{match:function(){$(".js-StoreLocator-tabs").addClass("tab-content").children(".tab-pane").addClass("fade in");$(".StoreLocator-filtersNavTabs").on("show.bs.tab.StoreLocator",function(e){$(this).find(".StoreLocator-filtersNavTab--active").removeClass("StoreLocator-filtersNavTab--active");$(e.target).closest(".StoreLocator-filtersNavTab").addClass("StoreLocator-filtersNavTab--active")}).each(function(){$(this).find('[data-toggle\x3d"tab"]').eq(0).tab("show")})},
unmatch:function(){$(".js-StoreLocator-tabs").removeClass("tab-content").children(".tab-pane").removeClass("fade in");$(".StoreLocator-filtersNavTabs").off("show.bs.tab.StoreLocator")}})});
window.StoreLocatorFactoryOptions={ICONS:{public:"/etc.clientlibs/settings/wcm/designs/ca/npc/clientlib-resources/resources/images/store-locator/ca-pin.png",specific:"/etc.clientlibs/settings/wcm/designs/ca/npc/clientlib-resources/resources/images/store-locator/ca-pin.png",green_point:"/etc.clientlibs/settings/wcm/designs/ca/npc/clientlib-resources/resources/images/store-locator/ca-pin2.png",square:"/etc.clientlibs/settings/wcm/designs/ca/npc/clientlib-resources/resources/images/store-locator/ca-pin3.png",
dab:"/etc.clientlibs/settings/wcm/designs/ca/npc/clientlib-resources/resources/images/store-locator/ca-pin4.png",chalus:"/etc.clientlibs/settings/wcm/designs/ca/npc/clientlib-resources/resources/images/store-locator/ca-pin-chalus.png",e_agence:"/etc.clientlibs/settings/wcm/designs/ca/npc/clientlib-resources/resources/images/store-locator/ca-pin6.png"}};var NPC=NPC||{};
(function($){NPC.formTrouverAgence=NPC.formTrouverAgence||function(){var me={};me.countDesk=0;me.countMobile=0;me.clearAddress=function(){if(me.countDesk==0)var $desk=$("#address").val("");else me.countDesk=0};me.clearAddressMobile=function(){if(me.countMobile==0)var $mobile=$("#m-address").val("");else me.countMobile=0};me.clearCity=function(){if(me.countDesk==0){var $desk=$("#city").val("");$desk.prop("selected",true);$desk.parent().find("li.selected").removeClass("selected");me.countDesk++;$desk.trigger("change")}else me.clearAddress()};
me.clearCityMobile=function(){if(me.countMobile==0){var $mobile=$("#m-city").val("");$desk.parent().find("li.selected").removeClass("selected");me.countMobile++;$mobile.trigger("change")}else me.clearAddress()};return me}()})($);
(function($,mapManagerFactory){$(window).on("google.maps.api.loaded",function(){if(!mapManagerFactory){console.warn("error while loading store map module");return false}$(".js-StoreLocator-bloc").each(function(){var $StoreLocatorBloc=$(this);var mapManager=mapManagerFactory($StoreLocatorBloc,$StoreLocatorBloc.data("store-map-param")||{});$(window).on("storemap.init",function(){if(mapManager.requireInit()===true){console.log("storemap.init",mapManager);mapManager.initialize($StoreLocatorBloc)}});$(window).on("storemap.agenciesChanged",
function(){if(mapManager.agenciesIsChanged()===true){console.log("storemap.agenciesChanged",mapManager);mapManager.agenciesChanged($StoreLocatorBloc)}});$(window).on("storemap.resetFilters",function(){mapManager.resetFilters()})})})})(jQuery,mapManagerFactory);
(function($,mapFactory){var AGENCY_LINK_SELECTOR=".js-StoreLocatorCard-headLink";var FINDER_BLOCK_SELECTOR=".js-StoreLocatorFinder";var ITINERARY_LINK_SELECTOR=".js-CTA-itinerary";var MAIL_LINK_SELECTOR=".js-CTA-mail";var MAIL_POPIN_SELECTOR="#modalShareByEmail";var PRINT_LINK_SELECTOR=".js-CTA-print";var AGENCY_MAP_SELECTOR=".js-CardAgencyMap";var mapCharge=false;var StoreCard={$findAgencyLink:null,$finderBlock:null,$map:null,$staticMap:null,$itineraryLink:null,$mailLink:null,$mailPopin:null,$printLink:null,
data:{},mapError:function(missing){console.warn("Map Error : ","No "+missing+" found for this agency");return false},initialize:function(){if(this.initElements()){this.initFindAgencyToggle();this.initCTA();return true}return false},initElements:function(){this.$findAgencyLink=$(AGENCY_LINK_SELECTOR);this.$finderBlock=$(FINDER_BLOCK_SELECTOR);this.$map=$(AGENCY_MAP_SELECTOR);this.$itineraryLink=$(ITINERARY_LINK_SELECTOR);this.$mailLink=$(MAIL_LINK_SELECTOR);this.$mailPopin=$(MAIL_POPIN_SELECTOR);this.$printLink=
$(PRINT_LINK_SELECTOR);if(!mapFactory){console.warn("error while loading store locator module");return false}var map=mapFactory(this.$map[0],this.$map.data("map-options"));this.data=this.$map.data("value")||{};if(this.data.type&&this.data.type.length)this.data.type=this.data.type[0];var marker={id:"1-123456789"||this.data.id||1,lat:this.data.latitude,lng:this.data.longitude,type:[this.data.type||"public"]};map.addMarker(marker);map.focusMarker(marker.id,true);map.fitBounds();$(window).on("debounced-resize",
function(){map.fitBounds()});this.map=map;return true},initFindAgencyToggle:function(){this.$findAgencyLink.on("click.StoreCard",function(e){e.preventDefault();StoreCard.$finderBlock.toggleClass("open")})},initCTA:function(){this.initItinerary();this.initMail();this.initPrint()},initItinerary:function(){if(!this.$itineraryLink.length)return this.mapError("itinerary");this.$itineraryLink.on("click.StoreCard",function(e){e.preventDefault();StoreCard.map.openItinerary()})},initMail:function(){if(!this.$mailLink.length&&
!this.$mailPopin)return this.mapError("mail");this.$mailLink.on("click.StoreCard",function(e){e.preventDefault();StoreCard.$mailPopin.modal("show")})},initPrint:function(){if(!this.$printLink.length)return this.mapError("print");if(typeof NPC!=="undefined"&&typeof NPC.googleApiKey!=="undefined"&&this.$staticMap===null){var currentZoom=this.map.getGmap().getZoom();var pinUrl=window.location.origin+this.map.getOptions().ICONS[this.data.type];this.$staticMap=$('\x3cimg src\x3d"https://maps.googleapis.com/maps/api/staticmap?size\x3d480x480\x26zoom\x3d'+
currentZoom+"\x26markers\x3dicon:"+pinUrl+"%7C"+this.data.latitude+","+this.data.longitude+"\x26key\x3d"+NPC.googleApiKey+'" class\x3d"visible-print-block"\x3e');$(AGENCY_MAP_SELECTOR).after(this.$staticMap)}this.$printLink.on("click.StoreCard",function(e){e.preventDefault();window.print()})}};$(window).on("google.maps.api.loaded",function(){if(!mapCharge){StoreCard.initialize();mapCharge=true}})})(jQuery,mapFactory);
$(function(){var _getServletUrl=function(selector){var path=window.location.pathname;var pathPart=path.split(".");var size=pathPart.length-1;if(size<1)return;pathPart.splice(size,1);var basePath=pathPart.join(".");return basePath+"."+selector};$(".js-StoreLocatorCard-headLink").on("click",function(){if($(".js-StoreLocatorCard-headLink--redirect").hasClass("hidden")){$(".js-StoreLocatorCard-headLink--redirect").removeClass("hidden");$(".js-StoreLocatorCard-headLink").addClass("hidden")}else{$(".js-StoreLocatorCard-headLink--redirect").addClass("hidden");
$(".js-StoreLocatorCard-headLink").removeClass("hidden")}});$("#open-mail-to-cr-modal-btn").on("click",function(){var resultDiv=$("#mail-to-cr-result");resultDiv.html("");resultDiv.attr("class","");$("#client_email").val("");$("#mail_subject").val("");$("#mail_body").val("")});$("#send-mail-to-cr-btn").on("click",function(){var url=_getServletUrl("send-mail-to-csr.json");var agencyId=$("#agency_id");var clientMail=$("#client_email");var mailSubject=$("#mail_subject");var mailBody=$("#mail_body");
var _displayResult=function(cssClass,message){var resultDiv=$("#mail-to-cr-result");resultDiv.attr("class",cssClass);resultDiv.html(message);mailSubject.val("");mailBody.val("")};$.ajax({type:"POST",url:url,data:{agency_id:agencyId.val(),client_email:clientMail.val(),mail_subject:mailSubject.val(),mail_body:mailBody.val()},success:function(){_displayResult("alert alert-success","Votre mail a bien \u00e9t\u00e9 envoy\u00e9 !")},error:function(){_displayResult("alert alert-danger","Une erreur est survenue lors de l'envoi du mail !")}})});
$(".link-agence-repli").on("click",function(){var id_repli=$(".link-agence-repli").data("val");if(id_repli!=""){var params={"storelocator_retrieveagency_agencyid":id_repli};var regex_agence=/(particulier|professionnel|entreprise|agriculteur|banque-privee|association|collectivites-publiques)\/.*\.html|\.html/;var stl_replacement="$1/jcr:content.fiche-agence.html";var target=location.pathname.replace(regex_agence,stl_replacement);var $form=$(NPC.createHiddenFormCode(target,"post",params));$("body").append($form);
$form.submit()}})});
var checkEmailMulti=function(element){var emailRegex=new RegExp(/^[a-zA-Z0-9.!#$%&\u2019*+/=?^_`{|}~-]+@[a-zA-Z0-9-]+(?:\.[a-zA-Z0-9-]+)*$/);var email=$(element).val();if($.trim(email).length!=0){var validate;var emailTab=email.split(",");if(emailTab.length>4)validate=false;else for(var i=0;i<emailTab.length;i++){var result=emailRegex.test($.trim(emailTab[i]));if(!result){validate=false;break}else validate=true}if(!validate){$(element).parent().addClass("has-error");return false}else{$(element).parent().removeClass("has-error");return true}}else{$(element).parent().addClass("has-error");
return false}};
$(document).ready(function(){var _getCaptcha=function(){return $("#modalMail").find("[data-npc-captcha]")};var _refreshCaptcha=function(){var captcha=_getCaptcha();captcha.npcCaptcha("refresh")};var errorZone=$(".ShareMail-error");var urlProtocol=window.location.protocol;var urlHostName=window.location.host;var urlMail=NPC.urlRewrite?urlProtocol+"//"+urlHostName+NPC.urlRewrite.replace("_jcr_content","jcr:content.sendByMail.json"):null;var checkInputRequired=function(element){if($(element).val().trim()==""){$(element).parent().addClass("has-error");
return false}else{$(element).parent().removeClass("has-error");return true}};var displayError=function(error){errorZone.html(error);errorZone.show()};var clearError=function(){errorZone.html("");errorZone.hide();$(".ShareMail .js-Captcha-errorMessageMissing").addClass("hidden");$(".ShareMail .js-Captcha-errorMessageValue").addClass("hidden");$(".ShareMail .js-Captcha-response").parent().removeClass("has-error");$(".fieldFormSendByMail").each(function(){$(this).removeClass("Modal-emailError");$(this).removeClass("Modal-inputRequired");
$(this).parent().removeClass("has-error")})};var disableSubmitButton=function(){$(".ShareMail .js-ShareMail-submit")[0].disabled=true};var resetSubmitButton=function(){$(".ShareMail .js-ShareMail-submit")[0].disabled=false};var checkFields=function(){var contact="#contact1StoreLocator33";var lastname="#lastnameStoreLocator33";var firstname="#firstnameStoreLocator33";var captcha=".ShareMail .js-Captcha-response";var emailsOk=checkEmailMulti(contact);var lastNameOk=checkInputRequired(lastname);var firstNameOk=
checkInputRequired(firstname);var captchaOk=checkInputRequired(captcha);if(!(lastNameOk&&firstNameOk&&emailsOk&&captchaOk))displayError("Veuillez renseigner les champs obligatoires");return lastNameOk&&firstNameOk&&emailsOk&&captchaOk};var _displaySendMailError=function(error){if(error&&error.echecsList){displayError(error.echecsList);$(error.fieldList).parent().addClass("has-error")}else displayError("Une erreur inconnue est survenue lors de l'envoi du mail !");_refreshCaptcha()};var submitFormSendMail=
function(e){if(undefined!=e)e.preventDefault();clearError();var contact="#contact1StoreLocator33";var lastname="#lastnameStoreLocator33";var firstname="#firstnameStoreLocator33";var nomUtilisateur=$(lastname).val();var prenomUtilisateur=$(firstname).val();var emailDestinataire=$(contact).val();var lienUrl=window.location.pathname;var storeLocatorCaptcha=_getCaptcha();var captchaResponse=storeLocatorCaptcha.npcCaptcha("getResponse");var titre=$("#titre").val();var params="nomUtilisateur\x3d"+nomUtilisateur+
"\x26prenomUtilisateur\x3d"+prenomUtilisateur+"\x26emailDestinataire\x3d"+emailDestinataire+"\x26titre\x3d"+titre+"\x26captchaId\x3d"+storeLocatorCaptcha.npcCaptcha("getId")+"\x26captchaResponse\x3d"+captchaResponse+"\x26urlLien\x3d"+lienUrl;if(urlMail==null){console.log("erreur url de la page pour acceder au service envoie de mail");_displaySendMailError(null);resetSubmitButton()}$.ajax({type:"POST",url:urlMail,data:params,success:function(msg){if(msg.isSend==true){_refreshCaptcha();voirModalMessage()}else _displaySendMailError(msg);
resetSubmitButton()},error:function(msg){_displaySendMailError(msg);resetSubmitButton()}});return false};$(".js-ShareMail").submit(function(e){disableSubmitButton();if(undefined!=e)e.preventDefault();if(checkFields())submitFormSendMail();else resetSubmitButton()});$("#modalMail").on("hidden.bs.modal",function(e){resetModal()});$("#closePopinSendMail").on("click",function(e){_refreshCaptcha()});function voirModalMessage(){$(".js-ShareMail").addClass("hidden");$(".js-ShareMail-legalNotice").addClass("hidden");
$(".js-ShareMail-sendInformationsSuccessful").removeClass("hidden")}function resetModal(){$(".js-ShareMail").removeClass("hidden");$(".js-ShareMail-legalNotice").removeClass("hidden");$(".js-ShareMail-sendInformationsSuccessful").addClass("hidden");$(".fieldFormSendByMail").each(function(){$(this).val("")});clearError();_refreshCaptcha();resetSubmitButton()}function onFocus(){var offset;if(document.body.classList.contains("modal--opened")){offset=parseInt(document.body.style.top,10);document.body.classList.remove("modal--opened");
document.body.scrollTop=offset*-1}else{offset=document.body.scrollTop;document.body.style.top=offset*-1+"px";document.body.classList.add("modal--opened")}}_refreshCaptcha()});
(function($){var idCR=$("#sl-detail-agence-code-cr").attr("value");var dateUTC=new Date;var timeZoneString="Europe/Paris";if(idCR==="900")timeZoneString="America/Guadeloupe";else if(idCR==="902")timeZoneString="America/Martinique";else if(idCR==="903")timeZoneString="Indian/Reunion";var options={timeZone:timeZoneString,hour:"numeric",hour12:false,minute:"numeric"};var currentDate=new Date(dateUTC.toLocaleDateString("en-US",options));var currentday=currentDate.getDay();var currentHours=currentDate.getHours();
var currentMinutes=currentDate.getMinutes();var currentTimeToMinutes=currentHours*60+currentMinutes;var dayOfWeek={0:"dimanche",1:"lundi",2:"mardi",3:"mercredi",4:"jeudi",5:"vendredi",6:"samedi"};var isAgencyHasOpeningHours=$("ul").hasClass("ficheAgence-jours");function timeToMinutes(time){var result;if(time){var hoursAndMinutes=time.split("h");var hours=hoursAndMinutes[0];var minutes=hoursAndMinutes[1];result=parseInt(hours)*60+parseInt(minutes)}return result}function extractTimeSlot(timeSlot){var startTime;
var endTime;if(timeSlot&&timeSlot!=="Ferm\u00e9"){var startTimeAndEndTime=timeSlot.split("-");startTime=startTimeAndEndTime[0];endTime=startTimeAndEndTime[1]}return{startTime:startTime,endTime:endTime}}function agenceOpeningDay(day){return $("#"+dayOfWeek[day%7]+" "+"span.ficheAgence-jourHorairesOuverture").map(function(){var slot1=this.children[0];var hours="Ferm\u00e9";var isConseil=false;var isRdv=false;var isTemporaryClosed=false;if(slot1){hours=extractTimeSlot(slot1.outerText);isConseil=slot1.className===
"ficheAgence-conseil-a-distance";isRdv=slot1.className==="ficheAgence-sur-rendez-vous";isTemporaryClosed=slot1.className==="ficheAgence-ferme-temporairement"}var range_1={hours:hours,isConseil:isConseil,isRdv:isRdv,isTemporaryClosed:isTemporaryClosed};var slot2=this.children[2];hours="Ferm\u00e9";isConseil=false;isRdv=false;isTemporaryClosed=false;if(slot2){hours=extractTimeSlot(slot2.outerText);isConseil=slot2.className==="ficheAgence-conseil-a-distance";isRdv=slot2.className==="ficheAgence-sur-rendez-vous";
isTemporaryClosed=slot2.className==="ficheAgence-ferme-temporairement"}var range_2={hours:hours,isConseil:isConseil,isRdv:isRdv,isTemporaryClosed:isTemporaryClosed};return[range_1,range_2]}).get()}function getInfoStatus(){var timeSlot=agenceOpeningDay(currentday);var startFirstSlot=timeToMinutes(timeSlot[0].hours.startTime);var endFirstSlot=timeToMinutes(timeSlot[0].hours.endTime);var startSecondSlot=timeToMinutes(timeSlot[1].hours.startTime);var endSecondSlot=timeToMinutes(timeSlot[1].hours.endTime);
var subTitle;if(currentTimeToMinutes<startFirstSlot){updateTitleSatus("Ferm\u00e9");if(timeSlot[0].isTemporaryClosed)subTitle=getCorrectTemporyClosingSubTitle(timeSlot);else if(timeSlot[0].isConseil)subTitle="Ouvre en conseil \u00e0 distance uniquement \u00e0 "+timeSlot[0].hours.startTime;else if(timeSlot[0].isRdv)subTitle="Ouvre sur RDV uniquement \u00e0 "+timeSlot[0].hours.startTime;else subTitle="Ouvre \u00e0 "+timeSlot[0].hours.startTime;return subTitle}if(currentTimeToMinutes>=startFirstSlot&&
currentTimeToMinutes<=endFirstSlot){if(timeSlot[0].isTemporaryClosed)updateTitleSatus("Ferm\u00e9 temporairement");else if(timeSlot[0].isConseil)updateTitleSatus("Accessible \u00e0 distance uniquement");else if(timeSlot[0].isRdv)updateTitleSatus("Ouvert uniquement sur rendez-vous");else updateTitleSatus("Ouvert");if(endFirstSlot===startSecondSlot)if(timeSlot[0].isConseil&&timeSlot[1].isConseil)subTitle="Ouvre en conseil \u00e0 distance uniquement jusqu'\u00e0 "+timeSlot[1].hours.endTime;else if(timeSlot[0].isRdv&&
timeSlot[1].isRdv)subTitle="Ouvre sur RDV uniquement jusqu'\u00e0 "+timeSlot[1].hours.endTime;else subTitle="Ferme \u00e0 "+timeSlot[1].hours.endTime;else if(timeSlot[0].isConseil)subTitle="Ouvre en conseil \u00e0 distance uniquement jusqu'\u00e0 "+timeSlot[0].hours.endTime;else if(timeSlot[0].isRdv)subTitle="Ouvre sur RDV uniquement jusqu'\u00e0 "+timeSlot[0].hours.endTime;else subTitle="Ferme \u00e0 "+timeSlot[0].hours.endTime;if(timeSlot[0].isTemporaryClosed)subTitle=getCorrectTemporyClosingSubTitle(timeSlot);
return subTitle}if(currentTimeToMinutes<startSecondSlot){updateTitleSatus("Ferm\u00e9");if(timeSlot[1].isTemporaryClosed)subTitle=getCorrectTemporyClosingSubTitle(timeSlot);else if(timeSlot[1].isConseil)subTitle="Ouvre en conseil \u00e0 distance uniquement \u00e0 "+timeSlot[1].hours.startTime;else if(timeSlot[1].isRdv)subTitle="Ouvre sur RDV uniquement \u00e0 "+timeSlot[1].hours.startTime;else subTitle="Ouvre \u00e0 "+timeSlot[1].hours.startTime;return subTitle}if(currentTimeToMinutes>=startSecondSlot&&
currentTimeToMinutes<=endSecondSlot){if(timeSlot[1].isTemporaryClosed){updateTitleSatus("Ferm\u00e9 temporairement");subTitle=getCorrectTemporyClosingSubTitle(timeSlot)}else if(timeSlot[1].isConseil){updateTitleSatus("Accessible \u00e0 distance uniquement");subTitle="Ouvre en conseil \u00e0 distance uniquement jusqu'\u00e0 "+timeSlot[1].hours.endTime}else if(timeSlot[1].isRdv){updateTitleSatus("Ouvert uniquement sur rendez-vous");subTitle="Ouvre sur RDV uniquement jusqu'\u00e0 "+timeSlot[1].hours.endTime}else{updateTitleSatus("Ouvert");
subTitle="Ferme \u00e0 "+timeSlot[1].hours.endTime}return subTitle}if(startSecondSlot===undefined&&currentTimeToMinutes>endFirstSlot||currentTimeToMinutes>endSecondSlot)updateTitleSatus("Ferm\u00e9");return getNextOpeningSubTitle(currentday+1)}function getCorrectTemporyClosingSubTitle(timeSlot){if(timeSlot[1].hours.startTime&&timeSlot[1].hours.startTime!=="Ferm\u00e9"&&!timeSlot[1].isTemporaryClosed){var subTitle="Ouvre \u00e0 "+timeSlot[1].hours.startTime;if(timeSlot[1].isConseil)subTitle="Ouvre en conseil \u00e0 distance uniquement \u00e0 "+
timeSlot[1].hours.startTime;else if(timeSlot[1].isRdv)subTitle="Ouvre sur RDV uniquement \u00e0 "+timeSlot[1].hours.startTime;return subTitle}return getNextOpeningSubTitle(currentday+1)}function getNextOpeningSubTitle(day){var nextDay=day%7;var dayString=dayOfWeek[nextDay];var timeSlot=agenceOpeningDay(nextDay);if(timeSlot[0].hours.startTime&&timeSlot[0].hours.startTime!=="Ferm\u00e9"&&!timeSlot[0].isTemporaryClosed){var subTitle="Ouvre "+dayString+" \u00e0 "+timeSlot[0].hours.startTime;if(timeSlot[0].isConseil)subTitle=
"Ouvre en conseil \u00e0 distance uniquement "+dayString+" \u00e0 "+timeSlot[0].hours.startTime;else if(timeSlot[0].isRdv)subTitle="Ouvre sur RDV uniquement "+dayString+" \u00e0 "+timeSlot[0].hours.startTime;return subTitle}if(timeSlot[1].hours.startTime&&timeSlot[1].hours.startTime!=="Ferm\u00e9"&&!timeSlot[1].isTemporaryClosed){var subTitle$0="Ouvre "+dayString+" \u00e0 "+timeSlot[1].hours.startTime;if(timeSlot[1].isConseil)subTitle$0="Ouvre en conseil \u00e0 distance uniquement "+dayString+" \u00e0 "+
timeSlot[1].hours.startTime;else if(timeSlot[1].isRdv)subTitle$0="Ouvre sur RDV uniquement "+dayString+" \u00e0 "+timeSlot[1].hours.startTime;return subTitle$0}if(nextDay===currentday)return"";return getNextOpeningSubTitle(nextDay+1)}function updateTitleSatus(title){var openedClass="npc-sl-strct-infos-ctct-ouverture-opened";var closedClass="npc-sl-strct-infos-ctct-ouverture-closed";var divElementOpen=$("div."+openedClass);var divElementClosed=$("div."+closedClass);var spanContent="\x3cspan class\x3d'npc-sl-strct-infos-ctct-dot'\x3e";
if(divElementOpen[0]){divElementOpen.empty();divElementOpen.append(spanContent);divElementOpen.append(title);if(title.includes("Ferm\u00e9"))divElementOpen.removeClass(openedClass).addClass(closedClass);else divElementOpen.removeClass(closedClass).addClass(openedClass)}else if(divElementClosed[0]){divElementClosed.empty();divElementClosed.append(spanContent);divElementClosed.append(title);if(title.includes("Ferm\u00e9"))divElementClosed.removeClass(openedClass).addClass(closedClass);else divElementClosed.removeClass(closedClass).addClass(openedClass)}}
function focusOpeningDay(){$("span.ficheAgence-jourNom").removeClass("ficheAgence-aujourdhui").addClass("ficheAgence-autreJour");$("#"+dayOfWeek[currentday%7]+" "+"span.ficheAgence-jourNom").removeClass("ficheAgence-autreJour").addClass("ficheAgence-aujourdhui")}if(isAgencyHasOpeningHours){focusOpeningDay();$("div.npc-sl-strct-infos-ctct-horaire").text(getInfoStatus())}})(jQuery);
$(function(){NPC.BV={};NPC.BV._BV_MODAL="ContainerBvModal";NPC.BV._BV_MODAL_JS=NPC.BV._BV_MODAL+"--js";NPC.BV._BV_MODAL_HIDDEN=NPC.BV._BV_MODAL+"--hidden";NPC.BV._BV_WRAPPER=NPC.BV._BV_MODAL+"--wrapper";NPC.BV._BV_MODAL_CONTENT=NPC.BV._BV_MODAL+"--content";NPC.BV._BV_TEMATIC_SELCT="selectMotifBV";NPC.BV._BV_CAPTCHA="CaptchaBoutonVert";NPC.BV._BV_FORMID="bv-form";NPC.BV.INPUTS={trouverAgenceByAdresse:"trouverAgenceByAdresse"};NPC.BV.STORELOC_GEOLOC=false;NPC.BV.STORELOC_INPUT="";NPC.BV.STORELOC_MAP=
false;NPC.BV.isBoutonVertOpen=false;NPC.BV.$_BV_WRAPPER=$("."+NPC.BV._BV_WRAPPER);NPC.BV.$_BV_MODAL_CONTENT=$("."+NPC.BV._BV_MODAL_CONTENT);NPC.BV.$_BV_PANEL=$("#"+NPC.BV._BV_MODAL+"--panel");NPC.BV._HISTORY=[];NPC.BV.FUNCTIONS={};NPC.BV.PANEL_DATA={};NPC.BV._BV_ARCEP={0:"",1:"npc-num-tel-arcep--greenDegraded",2:"npc-num-tel-arcep--grayDegraded",3:"npc-num-tel-arcep--purpleDegraded"};NPC.BV.CURRENT_PARCOUR={};NPC.BV._BV_CARDS_STATUS={};NPC.BV._BV_THEME={};var BV_COMMON_BODY_OVERFLOW="is-overflowHidden";
var BV_COMMON_TRUE_POPIN_MEDIA=CommonNPC.medias.mqSmMax;var bvModalClasses=[NPC.BV._BV_MODAL,NPC.BV._BV_MODAL_JS,NPC.BV._BV_MODAL_HIDDEN];var bvModalHTML='\x3cdiv class\x3d"'+bvModalClasses.join(" ")+'"/\x3e';var $containerBvModal=$(bvModalHTML).appendTo("body");var $containerBvZDG=$(".bvContainer");var isZDG5050=$containerBvZDG.closest(".col-md-4").length===0;NPC.BV.$_BV_MODAL_JS=$("."+NPC.BV._BV_MODAL+"--js");function layerBvZDGFactory(){var open=function(){CommonNPC.scrollTo(0);$containerBvZDG.prepend(NPC.BV.$_BV_MODAL_CONTENT)};
var close=function(){NPC.BV.$_BV_WRAPPER.append(NPC.BV.$_BV_MODAL_CONTENT)};return{init:function(){$(window).off("open.bv.zdg").on("open.bv.zdg",open).off("close.bv.zdg").on("close.bv.zdg",close);if(NPC.BV.isBoutonVertOpen===true)open();else close()},destroy:function(){$(window).off("open.bv.zdg").off("close.bv.zdg")},close:close,open:open}}function layerBvModalFactory(layerBvZDG){var $bodyHtml=$("body,html");var overlayMobile={match:function(){$(window).off("open.bv.mobile.popin").on("open.bv.mobile.popin",
function(){$bodyHtml.addClass(BV_COMMON_BODY_OVERFLOW)}).off("close.bv.mobile.popin").on("close.bv.mobile.popin",function(){$bodyHtml.removeClass(BV_COMMON_BODY_OVERFLOW)});if(NPC.BV.isBoutonVertOpen)$bodyHtml.addClass(BV_COMMON_BODY_OVERFLOW)},unmatch:function(){if(NPC.BV.isBoutonVertOpen&&!window.matchMedia(BV_COMMON_TRUE_POPIN_MEDIA).matches){CommonNPC.scrollTo(0);$bodyHtml.removeClass(BV_COMMON_BODY_OVERFLOW)}}};var setHeights=function(){var headerHeight;var windowHeight=$(window.top).height();
if(window.matchMedia(BV_COMMON_TRUE_POPIN_MEDIA).matches)$containerBvModal.css({top:"",marginTop:"",minHeight:"",height:windowHeight});else if($(".Template")!==undefined&&$(".Template")!==null&&$(".Template").offset()!==undefined&&$(".Template").offset()!==null){headerHeight=NPC?NPC.getHeaderHeight():120;$containerBvModal.css({top:headerHeight,marginTop:"",minHeight:windowHeight-headerHeight,height:""})}};var centerItems=function(){function getElementHeight(element){if(element)return element.outerHeight()}
function centerElem(element,delta,contentHeight){if(delta>0&&contentHeight!==0)element.addClass("centerElm");else element.removeClass("centerElm")}var centerElm=$(".centerElm");if(centerElm)centerElm.each(function(){$(this).removeClass("centerElm")});var $header=$(".GreenBtn-header");var $headerWCB=$(".GreenBtn-callbackHomeHeader");var $ContainerBvLayerWCB=$(".GreenBtn-callbackHome");var $ContainerBvLayerWCBContent=$(".GreenBtn-callbackHomeContent");var $ContainerBvLayer=$(".GreenBtn");var $ContainerBvLayerContent=
$(".GreenBtn-content");var heightheader=getElementHeight($header);var heightheaderWCB=getElementHeight($headerWCB);var heightContainerBvLayerWCB=getElementHeight($ContainerBvLayerWCB);var heightContainerBvLayerWCBContent=getElementHeight($ContainerBvLayerWCBContent);var heightContainerBvLayer=getElementHeight($ContainerBvLayer);var heightContainerBvLayerContent=getElementHeight($ContainerBvLayerContent);if($headerWCB&&$ContainerBvLayerWCB&&$ContainerBvLayerWCBContent)var DeltaWCB=heightContainerBvLayerWCB-
heightContainerBvLayerWCBContent-heightheaderWCB;if($header&&$ContainerBvLayer&&$ContainerBvLayerContent)var DeltaLayer=heightContainerBvLayer-heightContainerBvLayerContent-heightheader;centerElem($ContainerBvLayerWCB,DeltaWCB,heightContainerBvLayerWCBContent);centerElem($ContainerBvLayer,DeltaLayer,heightContainerBvLayerContent)};return{init:function(){layerBvZDG.destroy();var openPopinBV=function(){CommonNPC.scrollTo(0);$containerBvModal.removeClass(NPC.BV._BV_MODAL_HIDDEN)};var closePopinBV=function(){$containerBvModal.addClass(NPC.BV._BV_MODAL_HIDDEN)};
$(window).off("open.bv.popin").on("open.bv.popin",openPopinBV).off("close.bv.popin").on("close.bv.popin",closePopinBV).off("layout.bv").on("layout.bv",function(){var sAgent=window.navigator.userAgent;var Idx=sAgent.indexOf("MSIE");if(Idx>0)centerItems();else if(!!navigator.userAgent.match(/Trident\/7\./))centerItems()});$containerBvModal.toggleClass(NPC.BV._BV_MODAL_HIDDEN,NPC.BV.isBoutonVertOpen===false);$containerBvModal.append(NPC.BV.$_BV_MODAL_CONTENT);$(window).off("load.ContainerBvOnFullPage").on("load.ContainerBvOnFullPage",
setHeights).off("header.heightChanged.ContainerBvOnFullPage").on("header.heightChanged.ContainerBvOnFullPage",setHeights).off("marginChanged.template.ContainerBvOnFullPage").on("marginChanged.template.ContainerBvOnFullPage",setHeights).off("debounced-resize.ContainerBvOnFullPage").on("debounced-resize.ContainerBvOnFullPage",setHeights);enquire.register(BV_COMMON_TRUE_POPIN_MEDIA,overlayMobile);setHeights()},destroy:function(){enquire.unregister(BV_COMMON_TRUE_POPIN_MEDIA,overlayMobile);$containerBvModal.css({top:"",
height:""});$(window).off("load.ContainerBvOnFullPage").off("header.heightChanged.ContainerBvOnFullPage").off("marginChanged.template.ContainerBvOnFullPage").off("debounced-resize.ContainerBvOnFullPage");setHeights();layerBvZDG.init();$(window).off("open.bv.popin").off("close.bv.popin")}}}function InitBV(){var openBV=function(){NPC.BV.isBoutonVertOpen=true};var closeBV=function(){NPC.BV.isBoutonVertOpen=false};var layerBvZDG=layerBvZDGFactory();var layerBvModal=layerBvModalFactory(layerBvZDG);$(window).off("open.bv.init").on("open.bv.init",
openBV).off("close.bv.init").on("close.bv.init",closeBV);if($containerBvZDG.length===0||isZDG5050===false)layerBvModal.init();else{layerBvZDG.init();enquire.register(BV_COMMON_TRUE_POPIN_MEDIA,{match:layerBvModal.init,unmatch:layerBvModal.destroy})}NPC.BV.$_BV_MODAL_JS.prepend('\x3cdiv class\x3d"greenBtnModalBackgoundLock"\x3e\x3c/div\x3e')}InitBV();initBvDisplay();initOpenCloseBV();initBvStoreLocator();initBvRestitAgence(NPC);initBvFormFunction();initPanelLoader();$document.ready(function(){NPC.BV.FUNCTIONS.OPENCLOSE.onReady()})});
function initBvDisplay(){NPC.layoutTriggerd=false;NPC.boutonVert=NPC.boutonVert||{};var boutonVerWrapperSelector=NPC.BV.$_BV_WRAPPER;var arrayOuvertureCanaux=[];var bubblesSelector=$(".GreenBtn-callbackHomeContentBubbleLink");var numeroConseillerLienSelector=$("#numeroConseillerLien");var numeroAgenceLienSelector=$("#numeroAgenceLien");var blockConseillerSelector=$("#blockConseiller");var blockAgenceSelector=$("#blockAgence");NPC.BV.FUNCTIONS.valueIsDefine=function(element){return element!=undefined&&
element!=null&&element!="undefined"};NPC.AddTransactionIdToUrl=function(url){if(NPC.checkMemeOrigin(url)){var transactionId=NPC.$_GET("transactionId");if(transactionId!==undefined&&transactionId!=null&&transactionId!=="")if(url.indexOf("?")>-1)url=url+"\x26transactionId\x3d"+transactionId;else url=url+"?transactionId\x3d"+transactionId}return url};$("#lienFaq").attr("href",NPC.recupererUrlFaq);function getTimeInfoFunc(url,postParam){$.ajax({type:"POST",url:url,data:postParam,cache:true,async:false,
success:function(data){var dateCR=data;if(NPC.BV.FUNCTIONS.valueIsDefine(dateCR)){var dayDateData=dateCR.dateDuJour;var dayTimeData=dateCR.dayTime;var timezoneCaisse=_timeZoneCaisse(postParam.numeroCR)/6E4;var timezoneDifference=timezoneCaisse/60-postParam.userTimeZoneOffset/60;if(NPC.BV.FUNCTIONS.valueIsDefine(dayDateData)){var dayDateArray=dayDateData.split("-");NPC.BV.$_BV_WRAPPER.data("value").dayDate=new Date(dayDateArray[0],dayDateArray[1]-1,dayDateArray[2])}if(NPC.BV.FUNCTIONS.valueIsDefine(dayTimeData))NPC.BV.$_BV_WRAPPER.data("value").dayTime=
dayTimeData;if(NPC.BV.FUNCTIONS.valueIsDefine(timezoneDifference))NPC.BV.$_BV_WRAPPER.data("value").timezone_difference=timezoneDifference}},fail:function(){NPC.BV.$_BV_WRAPPER.data("value").erreurTableStart=true}})}function getGpuInfoFunc(url,postParam){$.ajax({type:"POST",url:url,data:postParam,cache:true,async:false,success:function(data){NPC.BV.$_BV_WRAPPER.data("value").erreurGpu=false;NPC.BV.$_BV_WRAPPER.data("value").gpuData=data},error:function(data){NPC.BV.$_BV_WRAPPER.data("value").erreurGpu=
true;NPC.BV.FUNCTIONS.loadErrorPanel()}})}function getStartInfoFunc(url,postParam){$.ajax({type:"POST",url:url,data:postParam,cache:true,async:false,success:function(data){var startInfo=data;if(NPC.BV.FUNCTIONS.valueIsDefine(startInfo)){var startDataInf=startInfo.idsParametrageAem;var startDataOpt=startInfo.blocsParcoursOptionnel;if(startDataInf==undefined&&startDataOpt==undefined)NPC.BV.$_BV_WRAPPER.data("value").erreurTableStart=true;else{NPC.BV.$_BV_WRAPPER.data("value").startDataInf=startDataInf;
NPC.BV.$_BV_WRAPPER.data("value").startDataOpt=startDataOpt}}},error:function(){NPC.BV.$_BV_WRAPPER.data("value").erreurTableStart=true}})}function _timeZoneCaisse(numeroCR){switch(numeroCR){case "900":return NPC.offsetGuadeloupe;case "902":return NPC.offsetMartinique;case "903":return NPC.offsetReunion;default:return NPC.offsetParis}}NPC.BV.FUNCTIONS.InitBvData=function(){var urlGpuInfo=NPC.genererURLJson("get-info-gpu");var urlFoncInfo=NPC.genererURLJson("get-info-date");var urlStartInfo=NPC.genererURLJson("get-info-start");
var modelData=NPC.BV.$_BV_WRAPPER.data("value").modelData;var isConnected=NPC!==undefined&&NPC!==null&&NPC.user!==null&&NPC.user!==undefined&&NPC.user.isConnected!=undefined?NPC.user.isConnected:false;var numeroCR=NPC.idLiveCopyCaisse;var userTimeZoneOffset=-(new Date).getTimezoneOffset();var marcheCourant=NPC.BV.FUNCTIONS.valueIsDefine(modelData)&&modelData.idMarche!=-1?modelData.idMarche:null;var postParamsFonc={"numeroCR":numeroCR,"userTimeZoneOffset":userTimeZoneOffset};getTimeInfoFunc(NPC.AddTransactionIdToUrl(urlFoncInfo),
postParamsFonc);if(NPC.BV.FUNCTIONS.valueIsDefine(modelData)){var numeroCRSansCR=numeroCR!="national"&&numeroCR!="master"?numeroCR.substring(2):numeroCR;var ListeMotifArboRecup=NPC.BV.$_BV_WRAPPER.data("value").idMotif;var listMotifString=ListeMotifArboRecup!=null?ListeMotifArboRecup.toString():"";var postParamsGpu={"numeroCR":numeroCRSansCR,"MODE_CLIENT":isConnected,"idMarche":modelData.idMarche,"listMotifArboresence":listMotifString};getGpuInfoFunc(NPC.AddTransactionIdToUrl(urlGpuInfo),postParamsGpu)}var postParamsStart=
{"numeroCR":numeroCR,"marche":marcheCourant};getStartInfoFunc(NPC.AddTransactionIdToUrl(urlStartInfo),postParamsStart);var displayBlocConseiller=NPC.BV.$_BV_WRAPPER.data("value").startDataOpt[7]!=null?NPC.BV.$_BV_WRAPPER.data("value").startDataOpt[7]:false;var conseillerInfo=NPC.BV.$_BV_WRAPPER.data("value").conseiller;if(conseillerInfo!=undefined&&conseillerInfo!=""&&(conseillerInfo.firstName!=null||conseillerInfo.lastName!=null)&&displayBlocConseiller)NPC.BV.$_BV_WRAPPER.data("value").conseillerDispo=
true};function getDefaultMotif(){var motifSelected=NPC.BV._BV_THEME;var gpuData=NPC.BV.$_BV_WRAPPER.data("value").gpuData;if(!NPC.BV.FUNCTIONS.valueIsDefine(motifSelected)||!NPC.BV.FUNCTIONS.valueIsDefine(motifSelected.id)){var listObjetMotif=getThematicList(gpuData);var first=listObjetMotif.entries().next().value;motifSelected={"id":first[0],"label":first[1]};NPC.BV._BV_THEME=motifSelected;NPC.BV.$_BV_WRAPPER.data("value").motifSelected=motifSelected}return motifSelected}NPC.BV.FUNCTIONS.initCard=
function(){var resultMotif=null;var resultMarcheTheme=null;var gpuData=NPC.BV.$_BV_WRAPPER.data("value").gpuData;if(NPC.BV.FUNCTIONS.valueIsDefine(gpuData)&&NPC.BV.FUNCTIONS.valueIsDefine(gpuData.listThemes)){var motifSelected=getDefaultMotif();resultMotif=gpuData.listThemes.filter(function(theme){return theme.themeId===parseInt(motifSelected.id)})[0];resultMarcheTheme=gpuData.marcheSelectionne.theme.filter(function(theme){return theme.themeId===parseInt(motifSelected.id)})[0]}if(resultMotif!=null&&
resultMotif!==undefined&&resultMotif.channelsList!=null)NPC.BV.FUNCTIONS.manageBubbles(resultMotif.channelsList,resultMarcheTheme.channelsList,true)};NPC.BV.FUNCTIONS.selectThematicList=function(element){$("#"+NPC.BV._BV_TEMATIC_SELCT+' option[selected\x3d"selected"]').attr("selected",false);var motifSelected={"id":element.value,"label":$('option[value\x3d"'+element.value+'"]').text()};NPC.BV._BV_THEME=motifSelected;NPC.BV.$_BV_WRAPPER.data("value").motifSelected=motifSelected;$("#"+NPC.BV._BV_TEMATIC_SELCT+
' option[value\x3d"'+element.value+'"]').attr("selected",true);$(element).parent().find(".npc-bv-selected")[0].innerText=motifSelected.label;$(element).parent().find('ul li[select-value\x3d"'+motifSelected.id+'"]').addClass("active");$("#"+NPC.BV._BV_TEMATIC_SELCT).attr("data-tracking-oic_objet_demande",motifSelected.label.toUpperCase());$("#fermetureLayerBV").attr("data-tracking-oic_objet_demande",motifSelected.label.toUpperCase())};function getThematicList(gpuData){var themeParDefaut=gpuData.themeParDefaut;
var listObjetMotif=new Map(Object.entries(gpuData.motifMapDeroulantes));var themeParDefautMap=listObjetMotif;if(NPC.BV.FUNCTIONS.valueIsDefine(themeParDefaut)&&themeParDefaut.themeId!=undefined){listObjetMotif.delete(themeParDefaut.themeId+"");themeParDefautMap=new Map;themeParDefautMap.set(themeParDefaut.themeId+"",themeParDefaut.label);listObjetMotif.forEach(function(value,key){themeParDefautMap.set(key,value)})}return themeParDefautMap}NPC.BV.FUNCTIONS.initThematicList=function(){var gpuData=NPC.BV.$_BV_WRAPPER.data("value").gpuData;
if(NPC.BV.FUNCTIONS.valueIsDefine(gpuData)){var listObjetMotif=getThematicList(gpuData);var selectThematicListObject=$("#"+NPC.BV._BV_TEMATIC_SELCT);selectThematicListObject.find("option").remove();if(NPC.BV.FUNCTIONS.valueIsDefine(listObjetMotif)){listObjetMotif.forEach(function(theme,key,map){selectThematicListObject.append('\x3coption value\x3d"'+key+'"\x3e'+theme+"\x3c/option\x3e");selectThematicListObject.parent().find("ul").append('\x3cli select-value\x3d"'+key+'" role\x3d"bouton" tabindex\x3d"-1"\x3e'+
theme+"\x3c/li\x3e")});selectThematicListObject[0].value="Comptes et Cartes"}setInitThematicSelect()}};function setInitThematicSelect(){var motifSelectionne=NPC.BV._BV_THEME;var selectThematicListObject=$("#"+NPC.BV._BV_TEMATIC_SELCT);if(NPC.BV.FUNCTIONS.valueIsDefine(motifSelectionne)&&motifSelectionne.label!=undefined){selectThematicListObject.value=motifSelectionne.id;NPC.BV.FUNCTIONS.selectThematicList(selectThematicListObject)}else NPC.BV.FUNCTIONS.selectThematicList(selectThematicListObject)}
NPC.BV.FUNCTIONS.setInfMotifSelected=function(){var motidId=getDefaultMotif();var TableauDonneeStart=NPC.BV.$_BV_WRAPPER.data("value").startDataInf;if(TableauDonneeStart!=undefined&&TableauDonneeStart!=null)$(TableauDonneeStart).each(function(index,currentElement){if(currentElement!=null&&currentElement.codeMotif!=null&&currentElement.codeMotif==motidId.id){if(currentElement.resultatListeGenerique!=null&&currentElement.resultatListeGenerique.indexOf(";")!=-1){var d=currentElement.resultatListeGenerique.trim().replace(/(\r|\n|&nbsp;)/gi,
"");donneeStartInfAAfficher=d.split(";");NPC.BV.$_BV_WRAPPER.data("value").startDataInfMotifSelected=donneeStartInfAAfficher}return false}})};function checkInExceptional(exceptionalList,dayDate,dayTime){var checkInExceptionalReturn=false;if(exceptionalList!=null&&exceptionalList.length>0)exceptionalList.forEach(function(currentExceptional){currentExceptional=currentExceptional.split(" - ");var start=currentExceptional[0].replace("[","").split(" ");var end=currentExceptional[1].replace("]","").split(" ");
var day=start[0].split("/");var startingTime=start[1];var endingTime=end[1];day=new Date(day[2],day[1]-1,day[0]);var sameDay=NPC.BV.FUNCTIONS.isSameDay(day,dayDate);if(sameDay){var timeLap="["+startingTime+" - "+endingTime+"]";var isIn=NPC.BV.FUNCTIONS.testTimeIn(timeLap,dayTime);if(isIn){checkInExceptionalReturn=true;return true}return false}});return checkInExceptionalReturn}NPC.BV.FUNCTIONS.checkInShedule=function(scheduleList,dayDate,dayTime){var isIn=false;if(scheduleList!=null&&scheduleList.length>
0)scheduleList.forEach(function(currentSchedule){var currentScheduleDayDate=currentSchedule.date;var scheduleTimeLaps=currentSchedule.openning;if(currentScheduleDayDate!=null&&currentScheduleDayDate!=undefined&&currentSchedule.openning!=null){currentScheduleDayDate=currentScheduleDayDate.split("-");currentScheduleDayDate=new Date(currentScheduleDayDate[0],currentScheduleDayDate[1]-1,currentScheduleDayDate[2]);var sameDay=NPC.BV.FUNCTIONS.isSameDay(currentScheduleDayDate,dayDate);if(sameDay)if(currentSchedule.holiday==
false)if(scheduleTimeLaps.indexOf(",")==-1)isIn=NPC.BV.FUNCTIONS.testTimeIn(scheduleTimeLaps,dayTime);else{scheduleTimeLaps=scheduleTimeLaps.split(" , ");$(scheduleTimeLaps).each(function(index,currentLaps){isIn=NPC.BV.FUNCTIONS.testTimeIn(currentLaps,dayTime)})}}});return isIn};NPC.BV.FUNCTIONS.setDefaultCardStatus=function(){NPC.BV._BV_CARDS_STATUS={"chat":"hide","chatMessage":"","chatOdigo":false,"rappel":"hide","rappelMessage":"","mail":"hide","mailMessage":"","rdv":"hide","rdvMessage":""}};NPC.BV.FUNCTIONS.manageBubbles=
function(channelList,themeChannelList,updateWcb){var dayDate=boutonVerWrapperSelector.data("value").dayDate;var dayTime=boutonVerWrapperSelector.data("value").dayTime;NPC.BV.FUNCTIONS.setDefaultCardStatus();var getChannelFromLabel=function(label){var channel=[];if(NPC.BV.$_BV_WRAPPER.data("value")!==undefined&&NPC.BV.$_BV_WRAPPER.data("value")!==null&&NPC.BV.$_BV_WRAPPER.data("value").gpuData!==undefined&&NPC.BV.$_BV_WRAPPER.data("value").gpuData!==null&&NPC.BV.$_BV_WRAPPER.data("value").gpuData.channelsListGlobal!==
undefined)channel=NPC.BV.$_BV_WRAPPER.data("value").gpuData.channelsListGlobal.filter(function(channel){return channel.label==label});return channel};channelList.forEach(function(channel){var channelId=channel.channelId;var alwaysOpen=channel.alwaysOpen;var scheduleList=channel.schedule;var channelFromLabel=getChannelFromLabel(channel.label)[0];var exceptionalOpenning=channelFromLabel!==undefined&&channelFromLabel!==null?channelFromLabel.exceptional0penning:null;var exceptionalClosing=channelFromLabel!==
undefined&&channelFromLabel!==null?channelFromLabel.exceptionalClosing:null;var availableChannel=channel.available;var isExOpen=checkInExceptional(exceptionalOpenning,dayDate,dayTime);var isExClose=checkInExceptional(exceptionalClosing,dayDate,dayTime);var isInShedule=NPC.BV.FUNCTIONS.checkInShedule(scheduleList,dayDate,dayTime);if(channelId===1&&themeChannelList.filter(function(channel){return channel.channelId===1})[0].odigoPilot)NPC.BV._BV_CARDS_STATUS.chatOdigo=true;if(availableChannel)if(alwaysOpen)NPC.BV.FUNCTIONS.setCardStatus(channelId,
"show");else if(channelId===2&&scheduleList!==null&&scheduleList.length>0)NPC.BV.FUNCTIONS.setCardStatus(channelId,"show");else if(isInShedule)if(isExClose){NPC.BV.FUNCTIONS.setCardStatus(channelId,"close");NPC.BV.FUNCTIONS.setMessageChannel(channelId,scheduleList,true)}else NPC.BV.FUNCTIONS.setCardStatus(channelId,"show");else if(isExOpen)NPC.BV.FUNCTIONS.setCardStatus(channelId,"show");else{NPC.BV.FUNCTIONS.setCardStatus(channelId,"close");NPC.BV.FUNCTIONS.setMessageChannel(channelId,scheduleList)}})};
NPC.BV.FUNCTIONS.isOneChannelOpen=function(){return NPC.BV._BV_CARDS_STATUS.chat==="show"||NPC.BV._BV_CARDS_STATUS.mail==="show"||NPC.BV._BV_CARDS_STATUS.rappel==="show"||NPC.BV._BV_CARDS_STATUS.rdv==="show"};NPC.BV.FUNCTIONS.getFullMessageChannel=function(name,message,exClose){if(exClose)message="Le service "+name+" est exceptionnellement ferm\u00e9.";else if(message==="")message="Le service "+name+" est ferm\u00e9 ";else message="Le service "+name+" est ouvert "+message;return message};NPC.BV.FUNCTIONS.addOpenChannelInfo=
function(message){if(NPC.BV.FUNCTIONS.isOneChannelOpen())return message+"\x3cbr\x3e\x3cbr\x3eVous pouvez nous contacter par un autre canal : ";else return message+"\x3cbr\x3e\x3cbr\x3eNous vous invitons \u00e0 renouveler votre demande ult\u00e9rieurement."};NPC.BV.FUNCTIONS.setMessageChannel=function(channelId,scheduleList,exClose){exClose=exClose===undefined?false:exClose;var arrayOuvertureCanal=[];arrayOuvertureCanal=NPC.BV.FUNCTIONS.fillArrayOuvertureCanal(arrayOuvertureCanal,scheduleList);messageOpenning=
NPC.BV.FUNCTIONS.fillChannelOpenningMessage(arrayOuvertureCanal);switch(channelId){case 1:NPC.BV._BV_CARDS_STATUS.chatMessage=NPC.BV.FUNCTIONS.getFullMessageChannel("Tchat",messageOpenning,exClose);break;case 2:NPC.BV._BV_CARDS_STATUS.rappelMessage=NPC.BV.FUNCTIONS.getFullMessageChannel("Rappel",messageOpenning,exClose);break;case 4:NPC.BV._BV_CARDS_STATUS.mailMessage=NPC.BV.FUNCTIONS.getFullMessageChannel("Mail",messageOpenning,exClose);break;case 5:NPC.BV._BV_CARDS_STATUS.rdvMessage=NPC.BV.FUNCTIONS.getFullMessageChannel("Rdv",
messageOpenning,exClose);break}};NPC.BV.FUNCTIONS.setCardStatus=function(channel,status){switch(channel){case 1:NPC.BV._BV_CARDS_STATUS.chat=status;break;case 2:NPC.BV._BV_CARDS_STATUS.rappel=status;break;case 4:NPC.BV._BV_CARDS_STATUS.mail=status;break;case 5:NPC.BV._BV_CARDS_STATUS.rdv=status;break}};NPC.BV.FUNCTIONS.isSameDay=function(currentSechedulDate,currentDate){if(currentSechedulDate!=null&&currentSechedulDate!=undefined&&currentDate!=null&&currentDate!=undefined)try{var currentDateMs=currentDate.getTime();
var currentSechedulDateMs=currentSechedulDate.getTime();if(currentSechedulDateMs==currentDateMs)return true;else return false}catch(err){return false}};NPC.BV.FUNCTIONS.isTimeIn=function(scheduleTimeLaps,dayTime){var isIn=false;if(scheduleTimeLaps!=null&&scheduleTimeLaps!=undefined&&dayTime!=null&&dayTime!=undefined)if(Array.isArray(scheduleTimeLaps))$(scheduleTimeLaps).each(function(index,currentScheduleTimeLap){isIn=NPC.BV.FUNCTIONS.testTimeIn(currentScheduleTimeLap,dayTime);if(isIn)return false});
else isIn=NPC.BV.FUNCTIONS.testTimeIn(scheduleTimeLaps,dayTime);return isIn};NPC.BV.FUNCTIONS.addToArrayOuvertureCanaux=function(objetMessageCanal){var objetPourComparer={canalId:objetMessageCanal.canalId};var positionInArray=NPC.Utils.searchItemIndexByAttributes(arrayOuvertureCanaux,objetPourComparer,false);if(positionInArray>-1)arrayOuvertureCanaux[positionInArray]=objetMessageCanal;else arrayOuvertureCanaux.push(objetMessageCanal)};NPC.BV.FUNCTIONS.removeFromArrayOuvertureCanaux=function(canalId){var objetPourComparer=
{canalId:canalId};var positionInArray=NPC.Utils.searchItemIndexByAttributes(arrayOuvertureCanaux,objetPourComparer,false);if(positionInArray>-1)arrayOuvertureCanaux.splice(positionInArray,1)};NPC.BV.FUNCTIONS.formatChannelSchedule=function(schedule){var scheduleOutput=null;if(schedule!=undefined&&schedule!=null&&schedule.length>0){var countTimeLaps=(schedule.match(/\[/g)||[]).length;if(countTimeLaps>0){var scheduleTmp=schedule.replace(/\[/g,"").trim();scheduleOutput=scheduleTmp.split("]");scheduleOutput.splice(-1,
1)}}return scheduleOutput};NPC.BV.FUNCTIONS.testTimeIn=function(timeLap,dayTime){var isIn=false;var formatedOppening=NPC.BV.FUNCTIONS.formatChannelSchedule(timeLap);if(formatedOppening!=undefined&&formatedOppening!=null)$(formatedOppening).each(function(index,currentSchedule){isIn=NPC.BV.FUNCTIONS.scheduleIsIn(currentSchedule,dayTime);if(isIn)return false});return isIn};NPC.BV.FUNCTIONS.scheduleIsIn=function(schedule,dayTime){var isIn=false;var scheduleHourDebut;var scheduleHourFin;var scheduleMinDebut;
var scheduleMinFin;var timeLap=NPC.BV.FUNCTIONS.getStartEndScheduleOpenning(schedule);if(timeLap!=null){var scheduleDebut=timeLap[0].split(":");var scheduleFin=timeLap[1].split(":");dayTime=dayTime.split(":");var dayHour=dayTime[0];var dayMin=dayTime[1];scheduleHourDebut=scheduleDebut[0];scheduleMinDebut=scheduleDebut[1];scheduleHourDebut=scheduleHourDebut.replace("[","");scheduleHourFin=scheduleFin[0];scheduleMinFin=scheduleFin[1];scheduleMinFin=scheduleMinFin.replace("]","");var isSupStartInfEndHour=
dayHour<scheduleHourFin&&dayHour>scheduleHourDebut;var isEqualEndHourInfEndMin=dayHour==scheduleHourFin&&dayMin<=scheduleMinFin;var isEqualStartHourSupStartMin=dayHour==scheduleHourDebut&&dayMin>=scheduleMinDebut;if(isSupStartInfEndHour||isEqualEndHourInfEndMin||isEqualStartHourSupStartMin)isIn=true}return isIn};NPC.BV.FUNCTIONS.manageBubblesMaster=function(){$("#caseOneLinkMail").hide();$("#caseOneLinkMeeting").hide();$(window).trigger("startBV.loaded")};NPC.BV.FUNCTIONS.fillArrayOuvertureCanal=
function(arryOuvertureCanal,scheduleList){if(scheduleList!=null&&scheduleList.length>0)$(scheduleList).each(function(index,currentSchedule){if(currentSchedule.openning!=null){var elementOuvertureCanal={label:currentSchedule.label,openning:currentSchedule.openning};arryOuvertureCanal.push(elementOuvertureCanal)}});return arryOuvertureCanal};NPC.BV.FUNCTIONS.fillChannelOpenningMessage=function(arryOuvertureCanal){var message="";if(arryOuvertureCanal.length>0){var message="\x3cbr\x3e- ";$(arryOuvertureCanal).each(function(index,
currentElement){var dayLabel=currentElement.label;var formatedOppening=NPC.BV.FUNCTIONS.formatChannelSchedule(currentElement.openning);if(formatedOppening!=undefined&&formatedOppening!=null){var arraySchedule=formatedOppening;if(arraySchedule.length==1){var openning=NPC.BV.FUNCTIONS.getStartEndScheduleOpenning(arraySchedule[0]);if(openning!=null){var messageOuvertureMatin=NPC.BV.FUNCTIONS.getChannelOpenningMessage(openning,dayLabel,true);message=message+messageOuvertureMatin;if(index!=arryOuvertureCanal.length-
1)message=message+"\x3cbr\x3e- "}}else if(arraySchedule.length==2){var openningMatin=NPC.BV.FUNCTIONS.getStartEndScheduleOpenning(arraySchedule[0]);var openningSoir=NPC.BV.FUNCTIONS.getStartEndScheduleOpenning(arraySchedule[1]);if(openningMatin!=null){var messageOuvertureMatin=NPC.BV.FUNCTIONS.getChannelOpenningMessage(openningMatin,dayLabel,true);message=message+messageOuvertureMatin}if(openningSoir!=null){var messageOuvertureSoir=NPC.BV.FUNCTIONS.getChannelOpenningMessage(openningSoir,dayLabel,
false);message=message+messageOuvertureSoir}if((openningMatin!=null||openningSoir!=null)&&index!=arryOuvertureCanal.length-1)message=message+"\x3cbr\x3e- "}}})}return message};NPC.BV.FUNCTIONS.getChannelOpenningMessage=function(openning,dayLabel,morning){var ouverture=openning[0].split(":");var fermeture=openning[1].split(":");var message=morning?"le "+dayLabel+" de "+ouverture[0]+"h"+ouverture[1]+" \u00e0 "+fermeture[0]+"h"+fermeture[1]:" et de "+ouverture[0]+"h"+ouverture[1]+" \u00e0 "+fermeture[0]+
"h"+fermeture[1];return message};NPC.BV.FUNCTIONS.gererMessageOuvertureAgenceConnecte=function(message){var messageModifie=[];if(message!=undefined&&message!=null)if(message.indexOf(" | ")>-1){message=message.split(" | ");for(var i=0;i<message.length;i++)if(message[i]!=""){message[i]=NPC.BV.FUNCTIONS.gererFormatHorairesAgenceCo(message[i]);messageModifie.push(message[i])}}else if(message[i]!=""){message=NPC.BV.FUNCTIONS.gererFormatHorairesAgenceCo(message);messageModifie.push(message)}return messageModifie};
NPC.BV.FUNCTIONS.gererFormatHorairesAgenceCo=function(message){message=message.replace(/:/g,"h");message=message.replace(/00/g,"");return message};NPC.BV.FUNCTIONS.getStartEndScheduleOpenning=function(timeLaps){if(timeLaps.indexOf(" - ")!=-1){timeLaps=timeLaps.replace("[","");timeLaps=timeLaps.replace("]","");timeLaps=timeLaps.split(" - ")}else if(timeLaps.indexOf("-")!=-1)timeLaps=timeLaps.split("-");else timeLaps=null;return timeLaps};NPC.BV.FUNCTIONS.addChannelErrorMessage=function(channelId,message){var channelName=
"";switch(channelId){case "1":channelName="Tchat";break;case "2":channelName="Rappel";break;case "4":channelName="Mail";break;case "5":channelName="Rdv";break}if(channelName!=""){message="Le service "+channelName+" est ouvert "+message;if(message.indexOf("[")>-1)message=message.replace(/\[/g,"");$("#messageChannelAvailable").html(message);$("#messageChannelAvailable").next().html("Vous pouvez nous contacter par un autre canal :")}};NPC.BV.FUNCTIONS.deleteChannelErrorMessage=function(currentPageChannel){$("#messageChannelAvailable").html("");
$("#messageChannelAvailable").next().html("")};NPC.BV.FUNCTIONS.initDisplayHeaderConnecte=function(){var parametrage=NPC.BV.$_BV_WRAPPER.data("value");var isConnected=NPC!=undefined&&NPC.user!=undefined&&NPC.user.isConnected!=undefined?NPC.user.isConnected:false;if(isConnected)if(parametrage.conseillerDispo==false){NPC.BV.FUNCTIONS.showBlockAgence();NPC.BV.FUNCTIONS.hideBlockConseiller();numeroAgenceLienSelector.hide()}else{NPC.BV.FUNCTIONS.showBlockConseiller();NPC.BV.FUNCTIONS.hideBlockAgence()}};
NPC.BV.FUNCTIONS.hideBlockConseiller=function(){numeroConseillerLienSelector.hide();blockConseillerSelector.hide()};NPC.BV.FUNCTIONS.setMessageOuvertureAgenceConnecte=function(){var isConnected=NPC!=undefined&&NPC.user!=undefined&&NPC.user.isConnected!=undefined?NPC.user.isConnected:false;var agence=NPC.BV.$_BV_WRAPPER.data("value").agence;if(agence!="undefined"&&agence!=null)if(isConnected){var horaireOuvertures=NPC.BV.FUNCTIONS.gererMessageOuvertureAgenceConnecte(agence.messageHorairesBlocAdvisorConnecte);
if(horaireOuvertures!=undefined)$(horaireOuvertures).each(function(index,currentElement){var ligneOuverture=".ouverturesAgenceCoL"+(index+1);$(ligneOuverture).html(currentElement);$(ligneOuverture).show()})}};NPC.BV.FUNCTIONS.hideBlockAgence=function(){numeroAgenceLienSelector.hide();blockAgenceSelector.hide()};NPC.BV.FUNCTIONS.showBlockConseiller=function(){numeroConseillerLienSelector.show();blockConseillerSelector.show()};NPC.BV.FUNCTIONS.showBlockAgence=function(){numeroAgenceLienSelector.show();
blockAgenceSelector.show()};numeroConseillerLienSelector.click(function(){NPC.BV.FUNCTIONS.hideBlockConseiller();NPC.BV.FUNCTIONS.showBlockAgence()});numeroAgenceLienSelector.click(function(){NPC.BV.FUNCTIONS.hideBlockAgence();NPC.BV.FUNCTIONS.showBlockConseiller()});bubblesSelector.click(function(event){var channelId=$(this).data("bubblenumber");var channelIsFound=false;if(channelId!=undefined&&channelId.indexOf("bubble")>-1){channelId=channelId.replace("bubble","");$(arrayOuvertureCanaux).each(function(index,
currentChannel){if(channelId==currentChannel.canalId){var message=currentChannel.message;channelIsFound=true;NPC.BV.FUNCTIONS.addChannelErrorMessage(channelId,message);event.preventDefault()}})}if(channelIsFound==false)NPC.BV.FUNCTIONS.deleteChannelErrorMessage(channelId)})}
function initBvStoreLocator(){$document=$(document);var index_infoTableau_phone="0";var index_infoTableau_libelle="1";var index_infoTableau_tarif="2";var index_infoTableau_IDarcep="3";var index_infoTableau_tarifArcep="4";var index_infoTableau_horaire1="5";var index_infoTableau_horaire2="6";var index_infoTableau_horaire3="7";function _checkIfTableValueVisible(index){var blocShowTableau=NPC.BV.$_BV_WRAPPER.data("value").startDataOpt;var result=blocShowTableau!=undefined&&blocShowTableau[index]!=undefined&&
blocShowTableau[index]!=null&&blocShowTableau[index].valeur?blocShowTableau[index].valeur:false;return result?"":"hidden"}NPC.BV.PANEL_DATA.getDataNumAgenceNiv1=function(){return{title:NPC.BV.CURRENT_PARCOUR.parcourTitle,showHideBlocStoreLocator:"",showHideBlocContactTel:"hidden",showHideBlocContactForm:"hidden",parcours:NPC.BV.CURRENT_PARCOUR.parcourName,itemTitlebloc:"Choisissez l'agence que vous souhaitez contacter"}};NPC.BV.PANEL_DATA.getDataEmailNiv1=function(){return{title:NPC.BV.CURRENT_PARCOUR.parcourTitle,
showHideStoreLocator:_checkIfTableValueVisible(4),showHideBlocContactTel:"hidden",showHideBlocContactForm:_checkIfTableValueVisible(3),parcours:NPC.BV.CURRENT_PARCOUR.parcourName,itemTitlebloc:"Choisissez l'agence que vous souhaitez contacter",boutonParcours:"sendEmail"}};NPC.BV.PANEL_DATA.getDataRdvNiv1=function(){var blocInfoTableau=NPC.BV.$_BV_WRAPPER.data("value").startDataInfMotifSelected;var numberNotStartWithZero=blocInfoTableau[8]!=undefined?blocInfoTableau[8].substring(1,14):"";NPC.BV.FUNCTIONS.serviceArcep=
{0:"",1:"Service \x26 appel gratuits",2:"Service gratuit + prix appel",3:"Service \x3cb\x3e"+blocInfoTableau[11]+"\x3c/b\x3e \u20ac / min + prix appel"};return{title:NPC.BV.CURRENT_PARCOUR.parcourTitle,showHideStoreLocator:_checkIfTableValueVisible(1),showHideBlocContactTel:_checkIfTableValueVisible(2),showHideBlocContactForm:_checkIfTableValueVisible(0),parcours:NPC.BV.CURRENT_PARCOUR.parcourName,itemTitlebloc:"Prendre rendez-vous en ligne",boutonParcours:"rdv",sansArcep:blocInfoTableau[10]!=undefined&&
blocInfoTableau[10]==="0"?"":"hidden",avecArcep:blocInfoTableau[10]!=undefined&&blocInfoTableau[10]!=="0"?"":"hidden",serviceArcep:NPC.BV.FUNCTIONS.serviceArcep[blocInfoTableau[10]],typeArcep:NPC.BV._BV_ARCEP[blocInfoTableau[10]],phoneNumber:blocInfoTableau[8],phoneNumberHref:"tel://+33"+numberNotStartWithZero,callPrice:blocInfoTableau[11],greyTitle:blocInfoTableau[9],hours1:blocInfoTableau[12],hours2:blocInfoTableau[13],hours3:blocInfoTableau[14]}};NPC.BV.PANEL_DATA.getDataEmailRdvNiv3=function(agence,
visite,showHideDDN,showHidePhone){agence=agence===undefined?false:agence;visite=visite===undefined?false:visite;showHideDDN=showHideDDN===undefined?true:showHideDDN;showHidePhone=showHidePhone===undefined?true:showHidePhone;return{title:NPC.BV.CURRENT_PARCOUR.parcourTitle,qualifdemande:NPC.BV._BV_THEME.label,showHideAgence:agence?"":"hidden",showHideVisite:visite?"":"hidden",showHideDDN:showHideDDN?"":"hidden",showHidePhone:showHidePhone?"":"hidden",trackingClass:NPC.BV.CURRENT_PARCOUR.parcourName===
"parcoursEmail"?"oic_moyen_email_validation":"oic_moyen_prise_de_rdv_validation"}};function getCardStatus(card){switch(card){case "show":return"";case "hide":return"hidden";case "close":return"npc-bv-cr-card--closed"}}NPC.BV.PANEL_DATA.getDataCaisse=function(){var blocInfoTableau=NPC.BV.$_BV_WRAPPER.data("value").startDataInfMotifSelected;var dataOpt=NPC.BV.$_BV_WRAPPER.data("value").startDataOpt;var numberNotStartWithZero=blocInfoTableau[index_infoTableau_phone]!=undefined?blocInfoTableau[index_infoTableau_phone].substring(1,
14):"";NPC.BV.FUNCTIONS.priceArcep={0:"",1:"Service \x26 appel gratuits",2:"Service gratuit + prix appel",3:"Service \x3cb\x3e"+blocInfoTableau[index_infoTableau_tarifArcep]+"\x3c/b\x3e \u20ac / min + prix appel"};var displayTrouverUneAgence=dataOpt!=null&&dataOpt["5"]!=null&&dataOpt["5"].valeur?"":"hidden";var displayFaireReclamation=dataOpt!=null&&dataOpt["6"]!=null&&dataOpt["6"].valeur?"":"hidden";var displayBlocInfoAgence="";if(NPC.user!=null&&NPC.user!==undefined&&NPC.user.isConnected===true||
numberNotStartWithZero==="")displayBlocInfoAgence="hidden";if(displayBlocInfoAgence===""&&NPC.BV!==null&&NPC.BV!==undefined)NPC.FUNCTIONS.TRACKING.eventPageVirtuelle(this,{evt_page_nom:"oic_numero_generique",evenement_categorie:"Prise-de-contact",evenement_oic_objet_demande:NPC.BV._BV_THEME&&Object.keys(NPC.BV._BV_THEME).length>0?NPC.BV._BV_THEME.label.toUpperCase():null});NPC.BV._BV_CARDS_STATUS=NPC.BV._BV_CARDS_STATUS!==null&&NPC.BV._BV_CARDS_STATUS!==undefined?NPC.BV._BV_CARDS_STATUS:{};return{showHideCardRappel:getCardStatus(NPC.BV._BV_CARDS_STATUS.rappel),
showHideCardRdv:getCardStatus(NPC.BV._BV_CARDS_STATUS.rdv),showHideCardMail:getCardStatus(NPC.BV._BV_CARDS_STATUS.mail),showHideCardChat:getCardStatus(NPC.BV._BV_CARDS_STATUS.chat),trackingClassRappel:"oic_moyen_rappel",trackingClassRdv:"oic_moyen_prise_de_rdv",trackingClassMail:"oic_moyen_mail",trackingClassChat:"oic_moyen_tchat",sansArcep:blocInfoTableau[index_infoTableau_IDarcep]!=undefined&&blocInfoTableau[index_infoTableau_IDarcep]==="0"?"":"hidden",avecArcep:blocInfoTableau[index_infoTableau_IDarcep]!=
undefined&&blocInfoTableau[index_infoTableau_IDarcep]!=="0"?"":"hidden",serviceArcep:NPC.BV.FUNCTIONS.priceArcep[blocInfoTableau[index_infoTableau_IDarcep]],typeArcep:NPC.BV._BV_ARCEP[blocInfoTableau[index_infoTableau_IDarcep]],phoneNumber:blocInfoTableau[index_infoTableau_phone],phoneNumberHref:"tel://+33"+numberNotStartWithZero,callPrice:blocInfoTableau[index_infoTableau_tarif],title:blocInfoTableau[index_infoTableau_libelle],hours1:blocInfoTableau[index_infoTableau_horaire1],hours2:blocInfoTableau[index_infoTableau_horaire2],
hours3:blocInfoTableau[index_infoTableau_horaire3],displayBlocInfoAgence:displayBlocInfoAgence,displayTrouverUneAgence:displayTrouverUneAgence,displayFaireReclamation:displayFaireReclamation}};NPC.BV.PANEL_DATA.getDataFeedback=function(title){title=title===undefined?"":title;return{title:NPC.BV.CURRENT_PARCOUR.parcourTitle,info:NPC.BV.CURRENT_PARCOUR.parcourName==="parcoursEmail"?"Votre message a bien \u00e9t\u00e9 envoy\u00e9.":"Votre demande de rendez-vous a bien \u00e9t\u00e9 envoy\u00e9e."}};
function initAutocompleteAdresse(){var autocompleteInput=document.getElementById(NPC.BV.INPUTS.trouverAgenceByAdresse);if(autocompleteInput)new google.maps.places.Autocomplete(autocompleteInput,{types:["geocode"],componentRestrictions:{country:["fr","re","gp","mq","gf","mc","pm","yt","nc","pf","mf","tf"]}})}NPC.BV.FUNCTIONS.intialiserAutoCompletion=function(){if(NPC.isGoogleMapsApiLoaded)initAutocompleteAdresse();else $(window).on("google.maps.api.loaded",initAutocompleteAdresse)};function hiddeErrorStorelocMessages(){$("#"+
NPC.BV.INPUTS.trouverAgenceByAdresse).removeClass("error-border");$("#emptyAdress").addClass("hidden");$("#errorAdress").addClass("hidden");$("#errorGeolocalisation").addClass("hidden");$("#noAgenceByGeolocalisation").addClass("hidden");$("#noAgenceByAdress").addClass("hidden")}function showrrorStorelocMessage(errorId){$("#"+NPC.BV.INPUTS.trouverAgenceByAdresse).addClass("error-border");$(errorId).removeClass("hidden")}NPC.BV.FUNCTIONS.findAgenceAuto=function(){hiddeErrorStorelocMessages();NPC.BV.STORELOC_GEOLOC=
true;NPC.BV.FUNCTIONS.trouverAgencesRun()};NPC.BV.FUNCTIONS.findAgenceForm=function(checkInput){checkInput=checkInput===undefined?true:checkInput;var runSearch=true;if(checkInput){hiddeErrorStorelocMessages();var regex=/^[a-zA-Z0-9-\u00e0\u00e9\u00e8\u00f9\u00c0\u00c9\u00c8\u00d9\u00e2\u00ea\u00ee\u00f4\u00fb\u00c2\u00ca\u00ce\u00d4\u00db\u00e4\u00eb\u00ef\u00f6\u00fc\u00ff\u00c4\u00cb\u00cf\u00d6\u00dc\u00e7\u00c7\u0153\u0152', ]+$/;var $inputTrouverAgenceByAdresse=$("#"+NPC.BV.INPUTS.trouverAgenceByAdresse);
var inputValue=undefined;if($inputTrouverAgenceByAdresse!==undefined&&$inputTrouverAgenceByAdresse!==null&&$inputTrouverAgenceByAdresse.val()!==undefined&&$inputTrouverAgenceByAdresse.val()!==null)inputValue=$("#"+NPC.BV.INPUTS.trouverAgenceByAdresse).val().trim();if(inputValue===""){showrrorStorelocMessage("#emptyAdress");runSearch=false}else if(!regex.test(inputValue)){showrrorStorelocMessage("#errorAdress");runSearch=false}}if(runSearch){NPC.BV.STORELOC_GEOLOC=false;NPC.BV.FUNCTIONS.trouverAgencesAddresseRun()}};
NPC.BV.FUNCTIONS.loadPanelAfterStoreLoc=function(element){var idAgence=NPC.BV.FUNCTIONS.valueIsDefine($(element).attr("data-agenceid"))?$(element).attr("data-agenceid").split("-")[1]:undefined;if(NPC.BV.FUNCTIONS.valueIsDefine(idAgence)&&idAgence!=""){var agence=NPC.BV.listeAgence.filter(function(uneAgence){return uneAgence.id===idAgence});if(NPC.BV.CURRENT_PARCOUR.parcourName==="storelocator"){NPC.BV.FUNCTIONS.loadInfoAgence(NPC.BV.FUNCTIONS.formatDataAgence(agence[0]));$("#masquerMoreInfo").addClass("hidden")}else{var panelData=
NPC.BV.CURRENT_PARCOUR.parcourName==="parcoursRdv"?NPC.BV.PANEL_DATA.getDataEmailRdvNiv3(true,true):NPC.BV.PANEL_DATA.getDataEmailRdvNiv3(true,false,false);var data=Object.assign(NPC.BV.FUNCTIONS.formatDataAgence(agence[0]),panelData);NPC.BV.FUNCTIONS.loadFormPanel(data);$(".js-blockMoreInformations").addClass("hidden")}}else console.error("Une erreur est survenue lors du chargement de la page de formulaire.\nAucun ID agence trouv\u00e9.")};$document.on("click","#masquerMoreInfo .js-moreInformationsLink",
function(e){e.preventDefault();$(".js-blockMoreInformations").toggleClass("hidden");$(".js-moreInformationsLink").html($(".js-blockMoreInformations").hasClass("hidden")?"\x3cspan\x3ePlus d'informations\x3c/span\x3e":"\x3cspan\x3eMasquer\x3c/span\x3e")});$document.on("click","#voirPlusAgences",function(e){e.preventDefault();var $listeAgence=$(".bv-listeAgenceGeolocalisee.hidden:not(.js-storeLoc-agency)");var numberAgencies=10;$listeAgence.slice(0,numberAgencies).addClass("StoreLocatorMap-Agency").addClass("js-storeLoc-agency").removeClass("hidden");
$(window).trigger("storemap.agenciesChanged");if($listeAgence.length<=numberAgencies)$(this).addClass("hidden")})}
function initPanelLoader(){var _BV_PANEL_NATIONAl="bv-panel-national";var _BV_PANEL_CAISSE="bv-panel-caisse";var _BV_PANEL_AIDE_ET_URGENCE="bv-panel-aide-et-urgence";var _BV_PANEL_ERROR="bv-panel-error";var _BV_PANEL_STORELOCATOR="bv-panel-storelocator";var _BV_PANEL_CHOICE="bv-panel-choice";var _BV_PANEL_FORM="bv-panel-form";var _BV_PANEL_FORM_FEEDBACK="bv-panel-form-feedback";var _BV_PANEL_HOME_DEFAULT="bv-panel-home";var _BV_PANEL_INFO_AGENCE="bv-panel-info-agence";var _bv_help_trigger="js-bv-callbackOpenAideEtUrgence";
var _bv_numAgence_trigger="js-bv-callbackOpenChoixNumAgence";var _bv_email_trigger="js-bv-callbackOpenChoixEmail";var _bv_rdv_trigger="js-bv-callbackOpenChoixRdv";var _bv_chat_trigger="js-bv-callbackOpenChoixChat";var _bv_rappel_trigger="js-bv-callbackOpenChoixRappel";var _bv_national_cr_trigger="js-bv-trigger-natioUrgence";var _bv_storeLocGeoLock_trigger="js-bv-formStoreLoc-geoLoc";var _bv_storeLoc_trigger="js-bv-formStoreLoc";var _bv_form_trigger="js-bv-callbackOpenForm";var _bv_form_goHome_trigger=
"js-bv-form-goHome";var _BV_feedback_leaveBV="js-bv-leaveBV";var _BV_LEAVE_BUTTON=$("#fermetureLayerBV");var _BV_BACK_BUTTON=$("#backLayerBV");var _BV_HEADER=$(".npc-bv-header");var _BV_BACK_DISPLAY_PANEL_LIST=[_BV_PANEL_AIDE_ET_URGENCE,_BV_PANEL_STORELOCATOR,_BV_PANEL_CHOICE,_BV_PANEL_FORM,_BV_PANEL_INFO_AGENCE];var _BV_HEADER_DISPLAY_PANEL_LIST_CO=[_BV_PANEL_CAISSE,_BV_PANEL_ERROR];var _BV_HEADER_DISPLAY_PANEL_LIST_NOCO=[_BV_PANEL_CAISSE,_BV_PANEL_CHOICE,_BV_PANEL_ERROR];var isDisplayBackButton=
function(){var currentPage=NPC.BV._HISTORY[NPC.BV._HISTORY.length-1].id;if(_BV_BACK_DISPLAY_PANEL_LIST.includes(currentPage))_BV_BACK_BUTTON.show();else _BV_BACK_BUTTON.hide()};var isDisplayHeader=function(){var currentPage=NPC.BV._HISTORY[NPC.BV._HISTORY.length-1].id;if(NPC.user.isConnected===false)showHideDisplayHeader(_BV_HEADER_DISPLAY_PANEL_LIST_NOCO.includes(currentPage));else showHideDisplayHeader(_BV_HEADER_DISPLAY_PANEL_LIST_CO.includes(currentPage))};var showHideDisplayHeader=function(isDisplay){if(isDisplay)_BV_HEADER.show();
else _BV_HEADER.hide()};var onClickBackButton=function(){if(NPC.BV._HISTORY.length>1){NPC.BV._HISTORY.pop();var jsonHistory=NPC.BV._HISTORY[NPC.BV._HISTORY.length-1];NPC.BV._HISTORY.pop();loadPanel(jsonHistory.id,jsonHistory.data)}};_BV_BACK_BUTTON.off("click").on("click",onClickBackButton);var onClickLeaveButton=function(){NPC.BV._HISTORY=[];NPC.BV.$_BV_PANEL.empty();NPC.BV.FUNCTIONS.OPENCLOSE.closeBV()};_BV_LEAVE_BUTTON.on("click",onClickLeaveButton);var loadPanelStructure=function(id,data){data=
data===undefined?{}:data;NPC.BV.$_BV_PANEL.empty();NPC.BV.$_BV_PANEL.loadTemplate($("#"+id),data);NPC.BV._HISTORY.push({id:id,data:data});isDisplayBackButton();isDisplayHeader();$(window).trigger("layout.bv");NPC.FUNCTIONS.TRACKING.refreshTracking();$(".ContainerBvModal--content")[0].focus();$(document).scrollTop(0)};var loadPanel=function(id,dataParam){dataParam=dataParam===undefined?{}:dataParam;switch(id){case _BV_PANEL_HOME_DEFAULT:loadDefaultPanel(dataParam);break;case _BV_PANEL_NATIONAl:loadNationalPanel(dataParam);
break;case _BV_PANEL_CAISSE:loadCaissesPanel(dataParam);break;case _BV_PANEL_AIDE_ET_URGENCE:loadAideEtUrgencePanel(dataParam);break;case _BV_PANEL_ERROR:loadErrorPanel(dataParam);break;case _BV_PANEL_STORELOCATOR:if(NPC.BV.STORELOC_GEOLOC)NPC.BV.FUNCTIONS.findAgenceAuto();else NPC.BV.FUNCTIONS.findAgenceForm(false);break;case _BV_PANEL_CHOICE:loadChoicePanel(dataParam);break}};var loadDefaultPanel=function(dataParam){dataParam=dataParam===undefined?{}:dataParam;NPC.loadLibGoogleMaps();var cr=NPC.idLiveCopyCaisse;
if(cr==="national")loadNationalPanel(dataParam);else{NPC.BV.FUNCTIONS.initCard();NPC.BV.FUNCTIONS.setInfMotifSelected();loadCaissesPanel(NPC.BV.PANEL_DATA.getDataCaisse())}};var loadAideEtUrgencePanel=function(dataParam){dataParam=dataParam===undefined?{}:dataParam;loadPanelStructure(_BV_PANEL_AIDE_ET_URGENCE);initCollapse()};var loadNationalPanel=function(dataParam){dataParam=dataParam===undefined?{}:dataParam;loadPanelStructure(_BV_PANEL_NATIONAl);initSelectorBV();$("."+_bv_national_cr_trigger).on("click",
function(e){e.preventDefault();NPC.storeLocator.gotoAccesCr()});$("."+_bv_help_trigger).on("click",function(){loadAideEtUrgencePanel()})};var loadCaissesPanel=function(dataParam){dataParam=dataParam===undefined?{}:dataParam;loadPanelStructure(_BV_PANEL_CAISSE,dataParam);var msgCard=$("#"+NPC.BV._BV_MODAL+"--panel #messageChannel");NPC.BV.FUNCTIONS.initThematicList();initBvGenesys();NPC.BV.FUNCTIONS.setMessageOuvertureAgenceConnecte();NPC.BV.FUNCTIONS.initDisplayHeaderConnecte();initSelectorBV();msgCard.hide();
$("."+_bv_help_trigger).on("click",function(){loadAideEtUrgencePanel()});$("#"+NPC.BV._BV_TEMATIC_SELCT).on("change",function(){NPC.BV.FUNCTIONS.selectThematicList(this);loadDefaultPanel()});$("."+_bv_numAgence_trigger).on("click",function(){loadChoicePanelSTORLOC()});$("."+_bv_email_trigger).on("click",function(){if(NPC.BV._BV_CARDS_STATUS.mail==="close"){msgCard.show();msgCard.html(NPC.BV.FUNCTIONS.addOpenChannelInfo(NPC.BV._BV_CARDS_STATUS.mailMessage))}else if(!NPC.user.isConnected)loadChoicePanelEMAIL()});
$("."+_bv_rdv_trigger).on("click",function(){if(NPC.BV._BV_CARDS_STATUS.rdv==="close"){msgCard.show();msgCard.htmlNPC.BV.FUNCTIONS.addOpenChannelInfo(NPC.BV._BV_CARDS_STATUS.rdvMessage)}else if(!NPC.user.isConnected)loadChoicePanelRDV()});$("."+_bv_chat_trigger).on("click",function(){if(NPC.BV._BV_CARDS_STATUS.chat==="close"){msgCard.show();msgCard.html(NPC.BV.FUNCTIONS.addOpenChannelInfo(NPC.BV._BV_CARDS_STATUS.chatMessage))}else if(NPC.BV._BV_CARDS_STATUS.chatOdigo)NPC.GENESYS.openNewChat();else NPC.GENESYS.openChat()});
$("."+_bv_rappel_trigger).on("click",function(){if(NPC.BV._BV_CARDS_STATUS.rappel==="close"){msgCard.show();msgCard.html(NPC.BV.FUNCTIONS.addOpenChannelInfo(NPC.BV._BV_CARDS_STATUS.rappelMessage))}else NPC.GENESYS.openRappel()})};var loadChoicePanel=function(dataParam){dataParam=dataParam===undefined?{}:dataParam;loadPanelStructure(_BV_PANEL_CHOICE,dataParam);NPC.BV.FUNCTIONS.intialiserAutoCompletion();$("."+_bv_form_trigger).on("click",function(){if(NPC.BV.CURRENT_PARCOUR.parcourName==="parcoursEmail")loadFormPanel(NPC.BV.PANEL_DATA.getDataEmailRdvNiv3());
else loadFormPanel(NPC.BV.PANEL_DATA.getDataEmailRdvNiv3(false,true))});$("."+_bv_storeLocGeoLock_trigger).on("click",function(e){e.preventDefault();NPC.BV.STORELOC_MAP=false;NPC.BV.FUNCTIONS.findAgenceAuto()});$("."+_bv_storeLoc_trigger).on("submit",function(e){e.preventDefault();NPC.BV.STORELOC_MAP=false;NPC.BV.FUNCTIONS.findAgenceForm()})};var loadFormPanel=function(dataParam){dataParam=dataParam===undefined?{}:dataParam;loadPanelStructure(_BV_PANEL_FORM,dataParam);NPC.BV.FUNCTIONS.FORM.initForm();
NPC.BV.FUNCTIONS.FORM.createFormTrigger();$("."+_bv_form_goHome_trigger).on("click",function(){loadDefaultPanel()})};var loadInfoAgence=function(dataParam){dataParam=dataParam===undefined?{}:dataParam;if(NPC.BV!==null&&NPC.BV!==undefined)NPC.FUNCTIONS.TRACKING.eventPageVirtuelle(this,{evt_page_nom:"Impression_oic_agence",evenement_categorie:"Prise-de-contact",evenement_oic_objet_demande:NPC.BV._BV_THEME&&Object.keys(NPC.BV._BV_THEME).length>0?NPC.BV._BV_THEME.label.toUpperCase():null});loadPanelStructure(_BV_PANEL_INFO_AGENCE,
dataParam);$("."+_BV_feedback_leaveBV).on("click",function(){NPC.BV.FUNCTIONS.OPENCLOSE.closeBV()})};var loadStoreLocPanel=function(dataParam){dataParam=dataParam===undefined?{}:dataParam;loadPanelStructure(_BV_PANEL_STORELOCATOR,dataParam)};var loadErrorPanel=function(){NPC.loadLibGoogleMaps();NPC.FUNCTIONS.TRACKING.eventPageVirtuelle(this,{evt_page_nom:"oic_erreur",evenement_categorie:"Prise-de-contact"});var dataParam={};dataParam.displayFaireReclamation="hidden";loadPanelStructure(_BV_PANEL_ERROR,
dataParam);$("."+_bv_help_trigger).on("click",function(){loadAideEtUrgencePanel()});$("."+_bv_numAgence_trigger).on("click",function(){loadChoicePanelSTORLOC()})};var loadFeedbackPanel=function(){loadPanelStructure(_BV_PANEL_FORM_FEEDBACK,NPC.BV.PANEL_DATA.getDataFeedback());$("."+_BV_feedback_leaveBV).on("click",function(){NPC.BV.FUNCTIONS.OPENCLOSE.closeBV()})};var loadChoicePanelRDV=function(){NPC.BV.CURRENT_PARCOUR={parcourName:"parcoursRdv",parcourTitle:"Prendre rendez-vous"};loadChoicePanel(NPC.BV.PANEL_DATA.getDataRdvNiv1())};
var loadChoicePanelEMAIL=function(){NPC.BV.CURRENT_PARCOUR={parcourName:"parcoursEmail",parcourTitle:"Envoyer un Email"};loadChoicePanel(NPC.BV.PANEL_DATA.getDataEmailNiv1())};var loadChoicePanelSTORLOC=function(){NPC.BV.CURRENT_PARCOUR={parcourName:"storelocator",parcourTitle:"Trouver le num\u00e9ro d'une agence"};loadChoicePanel(NPC.BV.PANEL_DATA.getDataNumAgenceNiv1())};NPC.BV.FUNCTIONS.loadDefaultPanel=loadDefaultPanel;NPC.BV.FUNCTIONS.loadStoreLocPanel=loadStoreLocPanel;NPC.BV.FUNCTIONS.loadInfoAgence=
loadInfoAgence;NPC.BV.FUNCTIONS.loadFormPanel=loadFormPanel;NPC.BV.FUNCTIONS.loadErrorPanel=loadErrorPanel;NPC.BV.FUNCTIONS.loadFeedbackPanel=loadFeedbackPanel;NPC.BV.FUNCTIONS.loadChoicePanelRDV=loadChoicePanelRDV;NPC.BV.FUNCTIONS.loadChoicePanelEMAIL=loadChoicePanelEMAIL}function initBvGenesys(){$(window).trigger("genesys.loaded")}
function initBvRestitAgence(NPC){NPC.geoloc=NPC.geoloc||{};var recupererMarches=function(data){var markets=[];for(var market in data)if(data[market]===true)markets.push(market);var indexPro=markets.indexOf("pro");var indexFarmer=markets.indexOf("farmer");var indexAssociation=markets.indexOf("association");if(indexPro!=-1||indexFarmer!=-1||indexAssociation!=-1)markets.push("pro_farmer_association");markets.join(",");return markets};var openingDays=function(agenceWeekPlanning){var openingDay=[];if(agenceWeekPlanning!=
null&&agenceWeekPlanning!=undefined){if(agenceWeekPlanning.openMonday===true)openingDay.push("monday");if(agenceWeekPlanning.openSaturday===true)openingDay.push("saturday")}return openingDay};var planingFunction=function(dayOfWeek,agence,hasOnlyRDV,hasOnlyFermTemp){var dayPlanning="";if(dayOfWeek&&agence)if(dayOfWeek.openingHours.length===0||agence.exceptionalClosure)dayPlanning="Ferm\u00e9";else if(dayOfWeek.openingHours.length===1)dayPlanning=dayOfWeek.openingHours[0].opening+"-"+dayOfWeek.openingHours[0].closing+
infoSupHours(agence,dayOfWeek,0,hasOnlyRDV,hasOnlyFermTemp);else dayPlanning=dayOfWeek.openingHours[0].opening+"-"+dayOfWeek.openingHours[0].closing+infoSupHours(agence,dayOfWeek,0,hasOnlyRDV,hasOnlyFermTemp)+" "+dayOfWeek.openingHours[1].opening+"-"+dayOfWeek.openingHours[1].closing+infoSupHours(agence,dayOfWeek,1,hasOnlyRDV,hasOnlyFermTemp);return dayPlanning};function messageCarteAgenceOuverteJournee(mobile,weekScheduleOfToday){if(mobile){var message="\x3cspan class\x3d'GMap-Today-InfoBulle'\x3e\x3cspan class\x3d'dot'\x3e\x3c/span\x3eAgence ouverte aujourd\u2019hui \x3cbr class\x3d\"visible-xs visible-sm\"/\x3ede "+
weekScheduleOfToday[0].opening+" \u00e0 "+weekScheduleOfToday[0].closing;if(weekScheduleOfToday.length>1)message+='\x3cbr class\x3d"visible-xs visible-sm"/\x3eet de '+weekScheduleOfToday[1].opening+" \u00e0 "+weekScheduleOfToday[1].closing;message+="\x3c/span\x3e";return message}else{var message="\x3cspan class\x3d'GMap-Today-InfoBulle'\x3e\x3cspan class\x3d'dot'\x3e\x3c/span\x3eAgence ouverte aujourd\u2019hui de "+weekScheduleOfToday[0].opening+" \u00e0 "+weekScheduleOfToday[0].closing;if(weekScheduleOfToday.length>
1)message+=" et de "+weekScheduleOfToday[1].opening+" \u00e0 "+weekScheduleOfToday[1].closing;message+="\x3c/span\x3e";return message}}function generateSpecialScheduleDayCarte(weekScheduleOfToday){var message="";weekScheduleOfToday.forEach(function(weekSchedule){if(onRDV(weekSchedule)==="OUV_RDV")message+="\x3cbr/\x3e\x3cspan class\x3d'GMap-Today-Ouv-Rdv'\x3eOuverture uniquement sur rendez-vous de "+weekSchedule.opening+" \u00e0 "+weekSchedule.closing+"\x3c/span\x3e";else if(onRDV(weekSchedule)===
"CONSEIL_DIST")message+="\x3cbr/\x3e\x3cspan class\x3d'GMap-Today-Conseil-Dist'\x3eConseil \u00e0 distance de "+weekSchedule.opening+" \u00e0 "+weekSchedule.closing+"\x3c/span\x3e";else if(onRDV(weekSchedule)==="FERM_TEMPO")message+="\x3cbr/\x3e\x3cspan class\x3d'GMap-Today-Ferm-Tempo'\x3eFermeture temporaire de "+weekSchedule.opening+" \u00e0 "+weekSchedule.closing+"\x3c/span\x3e"});return message}function messageHoraireCarte(agence,mobile){var message="";if(agence.exceptionalClosure)message="\x3cspan class\x3d'GMap-Today-Ferm-Tempo'\x3eAgence exceptionnellement ferm\u00e9e\x3c/span\x3e";
else if(!agence.weekPlanning.weekScheduleOfToday||agence.weekPlanning.weekScheduleOfToday.length===0)message="\x3cspan class\x3d'GMap-Today-Ferm-Tempo'\x3eAgence ferm\u00e9e aujourd\u2019hui\x3c/span\x3e";else if(agence.weekPlanning.isOpenAllWeek)message=generateSpecialScheduleDayCarte(agence.weekPlanning.weekScheduleOfToday);else if(agence.weekPlanning.weekScheduleOfToday&&agence.weekPlanning.weekScheduleOfToday.length>0&&agence.weekPlanning.weekScheduleOfToday[0].opening&&agence.weekPlanning.weekScheduleOfToday[0].closing){message=
messageCarteAgenceOuverteJournee(mobile,agence.weekPlanning.weekScheduleOfToday);message+=generateSpecialScheduleDayCarte(agence.weekPlanning.weekScheduleOfToday)}return message}function generateOpeningDaysForCard(agence){if(agence.weekPlanning.isOpenAllWeek)return"\x3cspan class\x3d'GMap-Today-InfoBulle'\x3e\x3cspan class\x3d'dot'\x3e\x3c/span\x3eOuvert 24h/24 7j/7\x3c/span\x3e";return"Ouvert "+agence.weekPlanning.labelOpenDays}var horaireToday=function(weekPlanning,agence){var horaire="";if(weekPlanning!=
null&&weekPlanning!=undefined&&agence.exceptionalClosure!=undefined)horaire=messageHoraireCarte(agence,false);return horaire};var horaireTodayForMobile=function(agence){var horaire="";if(agence)horaire=messageHoraireCarte(agence,true);return horaire};function messageHoraire(agence,mobile){var message="";if(agence.exceptionalClosure)message="Agence exceptionnellement ferm\u00e9e";else if(!agence.weekPlanning.weekScheduleOfNow)message="Agence ferm\u00e9e aujourd\u2019hui";else if(agence.weekPlanning.weekScheduleOfNow&&
agence.weekPlanning.weekScheduleOfNow.opening&&agence.weekPlanning.weekScheduleOfNow.closing)if(onRDV(agence.weekPlanning.weekScheduleOfNow)==="OUV_RDV"){message=messageAgenceOuverte(mobile,agence.weekPlanning.weekScheduleOfNow.opening,agence.weekPlanning.weekScheduleOfNow.closing);message+="\x3cbr/\x3eOuverture uniquement sur rendez-vous"}else if(onRDV(agence.weekPlanning.weekScheduleOfNow)==="FERM_TEMPO")message="Fermeture temporaire";else message=messageAgenceOuverte(mobile,agence.weekPlanning.weekScheduleOfNow.opening,
agence.weekPlanning.weekScheduleOfNow.closing);return message}function onRDV(hours){if(hours&&hours.hoursType&&hours.hoursType.hoursTypeId)return hours.hoursType.hoursTypeId;else return""}function messageAgenceOuverte(mobile,heureDebut,heureFin){if(mobile)return'Agence ouverte aujourd\u2019hui \x3cbr class\x3d"visible-xs visible-sm"/\x3ede '+heureDebut+" \u00e0 "+heureFin;else return"Agence ouverte aujourd\u2019hui de "+heureDebut+" \u00e0 "+heureFin}function infoSupHours(agence,dayOfWeek,dayIndex,
hasOnlyRDV,hasOnlyFermTemp){if(!agence.exceptionalClosure&&(dayOfWeek&&dayOfWeek.openingHours[dayIndex]&&dayOfWeek.openingHours[dayIndex].hoursType&&dayOfWeek.openingHours[dayIndex].hoursType.hoursTypeId))if((hasOnlyRDV||hasOnlyFermTemp)&&(dayOfWeek.openingHours[dayIndex].hoursType.hoursTypeId==="OUV_RDV"||dayOfWeek.openingHours[dayIndex].hoursType.hoursTypeId==="FERM_TEMPO"))return"\x3csup\x3e*\x3c/sup\x3e";else if(dayOfWeek.openingHours[dayIndex].hoursType.hoursTypeId==="OUV_RDV")return"\x3csup\x3e1\x3c/sup\x3e";
else if(dayOfWeek.openingHours[dayIndex].hoursType.hoursTypeId==="FERM_TEMPO")return"\x3csup\x3e2\x3c/sup\x3e";else return"";else return""}function recupererDistance(distance){var distStr="";if(distance!==null&&distance!=="0.0")distStr="~ "+distance+" km";return distStr}var ouverturePlanning=function(dayOfWeek,weekPlanning){var classe="";if(weekPlanning!=null&&dayOfWeek!=null)if(dayOfWeek.dayOfWeek=="today"&&weekPlanning.weekScheduleOfNow===null)classe="CardAgencyFunc-day--today CardAgencyFunc-day--closed";
else if(dayOfWeek.dayOfWeek=="today"&&weekPlanning.weekScheduleOfNow!=null)classe="CardAgencyFunc-day--today";return classe};function combineAllMarketObj(listeAgence){return listeAgence.map(function(agency){return agency.market}).reduce(function(accu,curr){for(var key in curr)if(curr[key]===true)if(accu!=undefined&&typeof accu==="object")if(accu.hasOwnProperty(key))accu[key]=true;return accu})}function getTrueMarketList(uniqueTypesObj){if(uniqueTypesObj)return Object.keys(uniqueTypesObj).filter(function(v){return uniqueTypesObj[v]});
else return[]}NPC.BV.FUNCTIONS.formatDataAgence=function(agence){function generateNumeroAgence(){var phoneNumberHref=agence.contact.phoneNumber;var numeroAgence=agence.contact.phoneNumber;if(phoneNumberHref){phoneNumberHref=phoneNumberHref.split(" ").join("");phoneNumberHref=phoneNumberHref.startsWith("0")?"tel://+33"+phoneNumberHref.substr(1):"tel://+33"+phoneNumberHref;return'\n                \x3ca href\x3d"'+phoneNumberHref+'" target\x3d"" class\x3d"npc-msl-link  npc-msl-small npc-sl-strct-infos-ctct-icons-underline "\x3e\n      \t\t\t\t\x3ci class\x3d"icon npc-phone"\x3e\x3c/i\x3e\n      \t\t\t\t\x3cspan class\x3d"sl_desktop"\x3e'+
numeroAgence+'\x3c/span\x3e\n      \t\t\t\t\x3cspan class\x3d"sl_mobile"\x3eAppeler\x3c/span\x3e\n    \t\t\t\x3c/a\x3e\n                '}else return""}function generateNumeroFax(){if(agence.contact.fax)return'\n\t\t\t\t\x3ca aria-label\x3d"Envoyer un fax" href\x3d"#" target\x3d"" class\x3d"npc-msl-link  npc-msl-small npc-sl-strct-infos-ctct-actions-fax npc-sl-strct-infos-ctct-icons-underline "\x3e\n        \t\t\t\x3cspan\x3eFax : '+agence.contact.fax+"\x3c/span\x3e\n      \t\t\t\x3c/a\x3e\n            ";
else return""}function generateEmail(){if(agence.contact.emailAddress)return"\n\t\t    \t\x3ca aria-label\x3d\"Envoyer un email \u00e0 l'adresse "+agence.contact.emailAddress+'" href\x3d"mailto:'+agence.contact.emailAddress+'" target\x3d"" class\x3d"npc-msl-link  npc-msl-small npc-sl-strct-infos-ctct-icons-underline "\x3e\n        \t\t\t\x3ci class\x3d"icon npc-mail"\x3e\x3c/i\x3e\n        \t\t\t\x3cspan id\x3d"emailAgency"\x3e'+agence.contact.emailAddress+"\x3c/span\x3e\n      \t\t\t\x3c/a\x3e\n                ";
else return""}function generateItineraire(){return'\n\t\t    \x3ca href\x3d"#" target\x3d"" class\x3d"npc-msl-link  npc-msl-small  js-CTA-itinerary npc-sl-strct-infos-ctct-icons-underline"\x3e\n\t\t    \t\x3ci class\x3d"icon npc-locator"\x3e\x3c/i\x3e\n\t\t    \t\x3cspan\x3eObtenir l\'itin\u00e9raire\x3c/span\x3e\n\t\t    \x3c/a\x3e\n            '}function generatePartagerEmail(){return'\n\t\t\t\x3ca href\x3d"#modalMail" data-toggle\x3d"modal" target\x3d"" class\x3d"npc-msl-link  npc-msl-small npc-sl-strct-infos-ctct-icons-underline "\x3e\n        \t\t\x3ci class\x3d"icon npc-launch"\x3e\x3c/i\x3e\n        \t\t\x3cspan\x3ePartager par email\x3c/span\x3e\n      \t\t\x3c/a\x3e\n            '}
function generateService(typeService,typeIcon,text){if(typeService)return'\n                \x3cdiv class\x3d"npc-sl-strct-srv-card "\x3e\n                    \x3ci class\x3d"icon '+typeIcon+' npc-sl-strct-srv-card--icone"\x3e\x3c/i\x3e\n                    \x3cspan class\x3d"npc-sl-strct-srv-card--text "\x3e'+text+"\x3c/span\x3e\n                \x3c/div\x3e\n                ";else return""}function hasAtLeastOne(agence,status){var flag=false;var days=["monday","tuesday","wednesday","thursday","friday",
"saturday","sunday"];var weekPlanning=agence.weekPlanning?Object.keys(agence.weekPlanning).filter(function(k){return days.includes(k)}):[];weekPlanning.forEach(function(day){var dayPlanning=agence.weekPlanning[day];var ohs=dayPlanning.openingHours;if(typeof ohs!=="undefined"&&ohs.length>0)ohs.forEach(function(oh,el){var openingHour=dayPlanning.openingHours[el];if(typeof openingHour!=="undefined"){var hourTypeId=openingHour.hoursType&&openingHour.hoursType.hoursTypeId;if(hourTypeId===status)flag=true}})});
return flag}function hasAtLeastOneRDVFunc(agence){return hasAtLeastOne(agence,"OUV_RDV")}function hasAtLeastOneFermTempFunc(agence){return hasAtLeastOne(agence,"FERM_TEMPO")}var hasAtLeastOneFermTemp=hasAtLeastOneFermTempFunc(agence);var hasAtLeastOneRDV=hasAtLeastOneRDVFunc(agence);var hasOnlyRDV=hasAtLeastOneRDV&&!hasAtLeastOneFermTemp;var hasOnlyFermTemp=hasAtLeastOneFermTemp&&!hasAtLeastOneRDV;function generateRDVLegend(hasOnlyRDV,hasOnlyFermTemp){if(!agence.exceptionalClosure&&hasAtLeastOneRDV)if(hasOnlyRDV!=
hasOnlyFermTemp)return"\x3csup\x3e*\x3c/sup\x3eOuverture sur rendez-vous uniquement";else return"\x3csup\x3e1\x3c/sup\x3eOuverture sur rendez-vous uniquement";else return""}function generateTempFermLegend(hasOnlyRDV,hasOnlyFermTemp){if(!agence.exceptionalClosure&&hasAtLeastOneFermTemp)if(hasOnlyFermTemp!=hasOnlyRDV)return"\x3csup\x3e*\x3c/sup\x3eFermeture temporaire";else return"\x3csup\x3e2\x3c/sup\x3eFermeture temporaire";else return""}function generateAgenceName(agence){if(agence.type==1)return"Agence bancaire "+
agence.name;else if(agence.type==2)if(NPC.idLiveCopyCaisse=="cr764")return"Chalus "+agence.name+"-"+agence.address.cityName;else return"CA "+agence.name+"-"+agence.address.cityName;else if(agence.type==3)return"Agence Immobili\u00e8re "+agence.name+" Square Habitat";else if(agence.type==4)return"Distributeur automatique de billets "+agence.name;else if(agence.type==5)return"Guichet Automatique de banque "+agence.name;else if(agence.type==6)return"Agence en ligne "+agence.name}function generateJourLundi(todayX,
openX,agence){var template='\x3cli class\x3d"ficheAgence-jour" id\x3d"lundi"\x3e';if(todayX)template=template+'\x3cspan class\x3d"ficheAgence-jourNom ficheAgence-aujourdhui"\x3eLundi\x3c/span\x3e\n                    \x3cspan class\x3d"ficheAgence-jourHorairesOuverture"\x3e';else template=template+'\x3cspan class\x3d"ficheAgence-jourNom ficheAgence-autreJour"\x3eLundi\x3c/span\x3e\n                    \x3cspan class\x3d"ficheAgence-jourHorairesOuverture"\x3e';if(!openX)if(!todayX)template=template+
'\x3cspan class\x3d"ficheAgence-jour--ferme"\x3eFerm\u00e9\x3c/span\x3e';else template=template+"\x3cspan\x3eFerm\u00e9\x3c/span\x3e";else{var openMondayRDV=agence.weekPlanning.monday.openingHours.length!=0&&agence.weekPlanning.monday.openingHours[0].hoursType.hoursTypeId=="OUV_RDV";var openMondayCnsDist=agence.weekPlanning.monday.openingHours.length!=0&&agence.weekPlanning.monday.openingHours[0].hoursType.hoursTypeId=="CONSEIL_DIST";var openMondayFermTemp=agence.weekPlanning.monday.openingHours.length!=
0&&agence.weekPlanning.monday.openingHours[0].hoursType.hoursTypeId=="FERM_TEMPO";var openMonday2=agence.weekPlanning.monday.openingHours.length>1&&agence.weekPlanning.monday.openingHours[1].opening.trim()!=""&&agence.weekPlanning.monday.openingHours[1].closing.trim()!="";if(openMondayRDV)template=template+'\x3cspan class\x3d"ficheAgence-sur-rendez-vous"\x3e'+agence.weekPlanning.monday.openingHours[0].opening+"-"+agence.weekPlanning.monday.openingHours[0].closing+"\x3c/span\x3e";else if(openMondayCnsDist)template=
template+'\x3cspan class\x3d"ficheAgence-conseil-a-distance"\x3e'+agence.weekPlanning.monday.openingHours[0].opening+"-"+agence.weekPlanning.monday.openingHours[0].closing+"\x3c/span\x3e";else if(openMondayFermTemp)template=template+'\x3cspan class\x3d"ficheAgence-ferme-temporairement"\x3e'+agence.weekPlanning.monday.openingHours[0].opening+"-"+agence.weekPlanning.monday.openingHours[0].closing+"\x3c/span\x3e";else if(agence.weekPlanning.monday.openingHours.length!=0)template=template+"\x3cspan\x3e"+
agence.weekPlanning.monday.openingHours[0].opening+"-"+agence.weekPlanning.monday.openingHours[0].closing+"\x3c/span\x3e";if(openMonday2){var openMonday2RDV=agence.weekPlanning.monday.openingHours.length>1&&agence.weekPlanning.monday.openingHours[1].hoursType.hoursTypeId=="OUV_RDV";var openMonday2CnsDist=agence.weekPlanning.monday.openingHours.length>1&&agence.weekPlanning.monday.openingHours[1].hoursType.hoursTypeId=="CONSEIL_DIST";var openMonday2FermTemp=agence.weekPlanning.monday.openingHours.length>
1&&agence.weekPlanning.monday.openingHours[1].hoursType.hoursTypeId=="FERM_TEMPO";template=template+'\x3cspan class\x3d"ficheAgence-jourSeparateur"\x3e\x3c/span\x3e';if(openMonday2RDV)template=template+'\x3cspan class\x3d"ficheAgence-sur-rendez-vous"\x3e'+agence.weekPlanning.monday.openingHours[1].opening+"-"+agence.weekPlanning.monday.openingHours[1].closing+"\x3c/span\x3e";else if(openMonday2CnsDist)template=template+'\x3cspan class\x3d"ficheAgence-conseil-a-distance"\x3e'+agence.weekPlanning.monday.openingHours[1].opening+
"-"+agence.weekPlanning.monday.openingHours[1].closing+"\x3c/span\x3e";else if(openMonday2FermTemp)template=template+'\x3cspan class\x3d"ficheAgence-ferme-temporairement"\x3e'+agence.weekPlanning.monday.openingHours[1].opening+"-"+agence.weekPlanning.monday.openingHours[1].closing+"\x3c/span\x3e";else if(agence.weekPlanning.monday.openingHours.length>1)template=template+"\x3cspan \x3e"+agence.weekPlanning.monday.openingHours[1].opening+"-"+agence.weekPlanning.monday.openingHours[1].closing+"\x3c/span\x3e"}}return template+
"\x3c/span\x3e\x3c/li\x3e"}function generateJourMardi(todayX,openX,agence){var template='\x3cli class\x3d"ficheAgence-jour" id\x3d"mardi"\x3e';if(todayX)template=template+'\x3cspan class\x3d"ficheAgence-jourNom ficheAgence-aujourdhui"\x3eMardi\x3c/span\x3e\n                    \x3cspan class\x3d"ficheAgence-jourHorairesOuverture"\x3e';else template=template+'\x3cspan class\x3d"ficheAgence-jourNom ficheAgence-autreJour"\x3eMardi\x3c/span\x3e\n                    \x3cspan class\x3d"ficheAgence-jourHorairesOuverture"\x3e';
if(!openX)if(!todayX)template=template+'\x3cspan class\x3d"ficheAgence-jour--ferme"\x3eFerm\u00e9\x3c/span\x3e';else template=template+"\x3cspan\x3eFerm\u00e9\x3c/span\x3e";else{var openTuesdayRDV=agence.weekPlanning.tuesday.openingHours.length!=0&&agence.weekPlanning.tuesday.openingHours[0].hoursType.hoursTypeId=="OUV_RDV";var openTuesdayCnsDist=agence.weekPlanning.tuesday.openingHours.length!=0&&agence.weekPlanning.tuesday.openingHours[0].hoursType.hoursTypeId=="CONSEIL_DIST";var openTuesdayFermTemp=
agence.weekPlanning.tuesday.openingHours.length!=0&&agence.weekPlanning.tuesday.openingHours[0].hoursType.hoursTypeId=="FERM_TEMPO";var openTuesday2=agence.weekPlanning.tuesday.openingHours.length>1&&agence.weekPlanning.tuesday.openingHours[1].opening.trim()!=""&&agence.weekPlanning.tuesday.openingHours[1].closing.trim()!="";if(openTuesdayRDV)template=template+'\x3cspan class\x3d"ficheAgence-sur-rendez-vous"\x3e'+agence.weekPlanning.tuesday.openingHours[0].opening+"-"+agence.weekPlanning.tuesday.openingHours[0].closing+
"\x3c/span\x3e";else if(openTuesdayCnsDist)template=template+'\x3cspan class\x3d"ficheAgence-conseil-a-distance"\x3e'+agence.weekPlanning.tuesday.openingHours[0].opening+"-"+agence.weekPlanning.tuesday.openingHours[0].closing+"\x3c/span\x3e";else if(openTuesdayFermTemp)template=template+'\x3cspan class\x3d"ficheAgence-ferme-temporairement"\x3e'+agence.weekPlanning.tuesday.openingHours[0].opening+"-"+agence.weekPlanning.tuesday.openingHours[0].closing+"\x3c/span\x3e";else if(agence.weekPlanning.tuesday.openingHours.length!=
0)template=template+"\x3cspan\x3e"+agence.weekPlanning.tuesday.openingHours[0].opening+"-"+agence.weekPlanning.tuesday.openingHours[0].closing+"\x3c/span\x3e";if(openTuesday2){var openTuesday2RDV=agence.weekPlanning.tuesday.openingHours.length>1&&agence.weekPlanning.tuesday.openingHours[1].hoursType.hoursTypeId=="OUV_RDV";var openTuesday2CnsDist=agence.weekPlanning.tuesday.openingHours.length>1&&agence.weekPlanning.tuesday.openingHours[1].hoursType.hoursTypeId=="CONSEIL_DIST";var openTuesday2FermTemp=
agence.weekPlanning.tuesday.openingHours.length>1&&agence.weekPlanning.tuesday.openingHours[1].hoursType.hoursTypeId=="FERM_TEMPO";template=template+'\x3cspan class\x3d"ficheAgence-jourSeparateur"\x3e\x3c/span\x3e';if(openTuesday2RDV)template=template+'\x3cspan class\x3d"ficheAgence-sur-rendez-vous"\x3e'+agence.weekPlanning.tuesday.openingHours[1].opening+"-"+agence.weekPlanning.tuesday.openingHours[1].closing+"\x3c/span\x3e";else if(openTuesday2CnsDist)template=template+'\x3cspan class\x3d"ficheAgence-conseil-a-distance"\x3e'+
agence.weekPlanning.tuesday.openingHours[1].opening+"-"+agence.weekPlanning.tuesday.openingHours[1].closing+"\x3c/span\x3e";else if(openTuesday2FermTemp)template=template+'\x3cspan class\x3d"ficheAgence-ferme-temporairement"\x3e'+agence.weekPlanning.tuesday.openingHours[1].opening+"-"+agence.weekPlanning.tuesday.openingHours[1].closing+"\x3c/span\x3e";else if(agence.weekPlanning.tuesday.openingHours.length>1)template=template+"\x3cspan \x3e"+agence.weekPlanning.tuesday.openingHours[1].opening+"-"+
agence.weekPlanning.tuesday.openingHours[1].closing+"\x3c/span\x3e"}}return template+"\x3c/span\x3e\x3c/li\x3e"}function generateJourMercredi(todayX,openX,agence){var template='\x3cli class\x3d"ficheAgence-jour" id\x3d"mercredi"\x3e';if(todayX)template=template+'\x3cspan class\x3d"ficheAgence-jourNom ficheAgence-aujourdhui"\x3eMercredi\x3c/span\x3e\n                    \x3cspan class\x3d"ficheAgence-jourHorairesOuverture"\x3e';else template=template+'\x3cspan class\x3d"ficheAgence-jourNom ficheAgence-autreJour"\x3eMercredi\x3c/span\x3e\n                    \x3cspan class\x3d"ficheAgence-jourHorairesOuverture"\x3e';
if(!openX)if(!todayX)template=template+'\x3cspan class\x3d"ficheAgence-jour--ferme"\x3eFerm\u00e9\x3c/span\x3e';else template=template+"\x3cspan\x3eFerm\u00e9\x3c/span\x3e";else{var openWednesdayRDV=agence.weekPlanning.wednesday.openingHours.length!=0&&agence.weekPlanning.wednesday.openingHours[0].hoursType.hoursTypeId=="OUV_RDV";var openWednesdayCnsDist=agence.weekPlanning.wednesday.openingHours.length!=0&&agence.weekPlanning.wednesday.openingHours[0].hoursType.hoursTypeId=="CONSEIL_DIST";var openWednesdayFermTemp=
agence.weekPlanning.wednesday.openingHours.length!=0&&agence.weekPlanning.wednesday.openingHours[0].hoursType.hoursTypeId=="FERM_TEMPO";var openWednesday2=agence.weekPlanning.wednesday.openingHours.length>1&&agence.weekPlanning.wednesday.openingHours[1].opening.trim()!=""&&agence.weekPlanning.wednesday.openingHours[1].closing.trim()!="";if(openWednesdayRDV)template=template+'\x3cspan class\x3d"ficheAgence-sur-rendez-vous"\x3e'+agence.weekPlanning.wednesday.openingHours[0].opening+"-"+agence.weekPlanning.wednesday.openingHours[0].closing+
"\x3c/span\x3e";else if(openWednesdayCnsDist)template=template+'\x3cspan class\x3d"ficheAgence-conseil-a-distance"\x3e'+agence.weekPlanning.wednesday.openingHours[0].opening+"-"+agence.weekPlanning.wednesday.openingHours[0].closing+"\x3c/span\x3e";else if(openWednesdayFermTemp)template=template+'\x3cspan class\x3d"ficheAgence-ferme-temporairement"\x3e'+agence.weekPlanning.wednesday.openingHours[0].opening+"-"+agence.weekPlanning.wednesday.openingHours[0].closing+"\x3c/span\x3e";else if(agence.weekPlanning.wednesday.openingHours.length!=
0)template=template+"\x3cspan\x3e"+agence.weekPlanning.wednesday.openingHours[0].opening+"-"+agence.weekPlanning.wednesday.openingHours[0].closing+"\x3c/span\x3e";if(openWednesday2){var openWednesday2RDV=agence.weekPlanning.wednesday.openingHours.length>1&&agence.weekPlanning.wednesday.openingHours[1].hoursType.hoursTypeId=="OUV_RDV";var openWednesday2CnsDist=agence.weekPlanning.wednesday.openingHours.length>1&&agence.weekPlanning.wednesday.openingHours[1].hoursType.hoursTypeId=="CONSEIL_DIST";var openWednesday2FermTemp=
agence.weekPlanning.wednesday.openingHours.length>1&&agence.weekPlanning.wednesday.openingHours[1].hoursType.hoursTypeId=="FERM_TEMPO";template=template+'\x3cspan class\x3d"ficheAgence-jourSeparateur"\x3e\x3c/span\x3e';if(openWednesday2RDV)template=template+'\x3cspan class\x3d"ficheAgence-sur-rendez-vous"\x3e'+agence.weekPlanning.wednesday.openingHours[1].opening+"-"+agence.weekPlanning.wednesday.openingHours[1].closing+"\x3c/span\x3e";else if(openWednesday2CnsDist)template=template+'\x3cspan class\x3d"ficheAgence-conseil-a-distance"\x3e'+
agence.weekPlanning.wednesday.openingHours[1].opening+"-"+agence.weekPlanning.wednesday.openingHours[1].closing+"\x3c/span\x3e";else if(openWednesday2FermTemp)template=template+'\x3cspan class\x3d"ficheAgence-ferme-temporairement"\x3e'+agence.weekPlanning.wednesday.openingHours[1].opening+"-"+agence.weekPlanning.wednesday.openingHours[1].closing+"\x3c/span\x3e";else if(agence.weekPlanning.wednesday.openingHours.length>1)template=template+"\x3cspan \x3e"+agence.weekPlanning.wednesday.openingHours[1].opening+
"-"+agence.weekPlanning.wednesday.openingHours[1].closing+"\x3c/span\x3e"}}return template+"\x3c/span\x3e\x3c/li\x3e"}function generateJourJeudi(todayX,openX,agence){var template='\x3cli class\x3d"ficheAgence-jour" id\x3d"jeudi"\x3e';if(todayX)template=template+'\x3cspan class\x3d"ficheAgence-jourNom ficheAgence-aujourdhui"\x3eJeudi\x3c/span\x3e\n                    \x3cspan class\x3d"ficheAgence-jourHorairesOuverture"\x3e';else template=template+'\x3cspan class\x3d"ficheAgence-jourNom ficheAgence-autreJour"\x3eJeudi\x3c/span\x3e\n                    \x3cspan class\x3d"ficheAgence-jourHorairesOuverture"\x3e';
if(!openX)if(!todayX)template=template+'\x3cspan class\x3d"ficheAgence-jour--ferme"\x3eFerm\u00e9\x3c/span\x3e';else template=template+"\x3cspan\x3eFerm\u00e9\x3c/span\x3e";else{var openThursdayRDV=agence.weekPlanning.thursday.openingHours.length!=0&&agence.weekPlanning.thursday.openingHours[0].hoursType.hoursTypeId=="OUV_RDV";var openThursdayCnsDist=agence.weekPlanning.thursday.openingHours.length!=0&&agence.weekPlanning.thursday.openingHours[0].hoursType.hoursTypeId=="CONSEIL_DIST";var openThursdayFermTemp=
agence.weekPlanning.thursday.openingHours.length!=0&&agence.weekPlanning.thursday.openingHours[0].hoursType.hoursTypeId=="FERM_TEMPO";var openThursday2=agence.weekPlanning.thursday.openingHours.length>1&&agence.weekPlanning.thursday.openingHours[1].opening.trim()!=""&&agence.weekPlanning.thursday.openingHours[1].closing.trim()!="";if(openThursdayRDV)template=template+'\x3cspan class\x3d"ficheAgence-sur-rendez-vous"\x3e'+agence.weekPlanning.thursday.openingHours[0].opening+"-"+agence.weekPlanning.thursday.openingHours[0].closing+
"\x3c/span\x3e";else if(openThursdayCnsDist)template=template+'\x3cspan class\x3d"ficheAgence-conseil-a-distance"\x3e'+agence.weekPlanning.thursday.openingHours[0].opening+"-"+agence.weekPlanning.thursday.openingHours[0].closing+"\x3c/span\x3e";else if(openThursdayFermTemp)template=template+'\x3cspan class\x3d"ficheAgence-ferme-temporairement"\x3e'+agence.weekPlanning.thursday.openingHours[0].opening+"-"+agence.weekPlanning.thursday.openingHours[0].closing+"\x3c/span\x3e";else if(agence.weekPlanning.thursday.openingHours.length!=
0)template=template+"\x3cspan\x3e"+agence.weekPlanning.thursday.openingHours[0].opening+"-"+agence.weekPlanning.thursday.openingHours[0].closing+"\x3c/span\x3e";if(openThursday2){var openThursday2RDV=agence.weekPlanning.thursday.openingHours.length>1&&agence.weekPlanning.thursday.openingHours[1].hoursType.hoursTypeId=="OUV_RDV";var openThursday2CnsDist=agence.weekPlanning.thursday.openingHours.length>1&&agence.weekPlanning.thursday.openingHours[1].hoursType.hoursTypeId=="CONSEIL_DIST";var openThursday2FermTemp=
agence.weekPlanning.thursday.openingHours.length>1&&agence.weekPlanning.thursday.openingHours[1].hoursType.hoursTypeId=="FERM_TEMPO";template=template+'\x3cspan class\x3d"ficheAgence-jourSeparateur"\x3e\x3c/span\x3e';if(openThursday2RDV)template=template+'\x3cspan class\x3d"ficheAgence-sur-rendez-vous"\x3e'+agence.weekPlanning.thursday.openingHours[1].opening+"-"+agence.weekPlanning.thursday.openingHours[1].closing+"\x3c/span\x3e";else if(openThursday2CnsDist)template=template+'\x3cspan class\x3d"ficheAgence-conseil-a-distance"\x3e'+
agence.weekPlanning.thursday.openingHours[1].opening+"-"+agence.weekPlanning.thursday.openingHours[1].closing+"\x3c/span\x3e";else if(openThursday2FermTemp)template=template+'\x3cspan class\x3d"ficheAgence-ferme-temporairement"\x3e'+agence.weekPlanning.thursday.openingHours[1].opening+"-"+agence.weekPlanning.thursday.openingHours[1].closing+"\x3c/span\x3e";else if(agence.weekPlanning.thursday.openingHours.length>1)template=template+"\x3cspan \x3e"+agence.weekPlanning.thursday.openingHours[1].opening+
"-"+agence.weekPlanning.thursday.openingHours[1].closing+"\x3c/span\x3e"}}return template+"\x3c/span\x3e\x3c/li\x3e"}function generateJourVendredi(todayX,openX,agence){var template='\x3cli class\x3d"ficheAgence-jour" id\x3d"vendredi"\x3e';if(todayX)template=template+'\x3cspan class\x3d"ficheAgence-jourNom ficheAgence-aujourdhui"\x3eVendredi\x3c/span\x3e\n                    \x3cspan class\x3d"ficheAgence-jourHorairesOuverture"\x3e';else template=template+'\x3cspan class\x3d"ficheAgence-jourNom ficheAgence-autreJour"\x3eVendredi\x3c/span\x3e\n                    \x3cspan class\x3d"ficheAgence-jourHorairesOuverture"\x3e';
if(!openX)if(!todayX)template=template+'\x3cspan class\x3d"ficheAgence-jour--ferme"\x3eFerm\u00e9\x3c/span\x3e';else template=template+"\x3cspan\x3eFerm\u00e9\x3c/span\x3e";else{var openFridayRDV=agence.weekPlanning.friday.openingHours.length!=0&&agence.weekPlanning.friday.openingHours[0].hoursType.hoursTypeId=="OUV_RDV";var openFridayCnsDist=agence.weekPlanning.friday.openingHours.length!=0&&agence.weekPlanning.friday.openingHours[0].hoursType.hoursTypeId=="CONSEIL_DIST";var openFridayFermTemp=agence.weekPlanning.friday.openingHours.length!=
0&&agence.weekPlanning.friday.openingHours[0].hoursType.hoursTypeId=="FERM_TEMPO";var openFriday2=agence.weekPlanning.friday.openingHours.length>1&&agence.weekPlanning.friday.openingHours[1].opening.trim()!=""&&agence.weekPlanning.friday.openingHours[1].closing.trim()!="";if(openFridayRDV)template=template+'\x3cspan class\x3d"ficheAgence-sur-rendez-vous"\x3e'+agence.weekPlanning.friday.openingHours[0].opening+"-"+agence.weekPlanning.friday.openingHours[0].closing+"\x3c/span\x3e";else if(openFridayCnsDist)template=
template+'\x3cspan class\x3d"ficheAgence-conseil-a-distance"\x3e'+agence.weekPlanning.friday.openingHours[0].opening+"-"+agence.weekPlanning.friday.openingHours[0].closing+"\x3c/span\x3e";else if(openFridayFermTemp)template=template+'\x3cspan class\x3d"ficheAgence-ferme-temporairement"\x3e'+agence.weekPlanning.friday.openingHours[0].opening+"-"+agence.weekPlanning.friday.openingHours[0].closing+"\x3c/span\x3e";else if(agence.weekPlanning.friday.openingHours.length!=0)template=template+"\x3cspan\x3e"+
agence.weekPlanning.friday.openingHours[0].opening+"-"+agence.weekPlanning.friday.openingHours[0].closing+"\x3c/span\x3e";if(openFriday2){var openFriday2RDV=agence.weekPlanning.friday.openingHours.length>1&&agence.weekPlanning.friday.openingHours[1].hoursType.hoursTypeId=="OUV_RDV";var openFriday2CnsDist=agence.weekPlanning.friday.openingHours.length>1&&agence.weekPlanning.friday.openingHours[1].hoursType.hoursTypeId=="CONSEIL_DIST";var openFriday2FermTemp=agence.weekPlanning.friday.openingHours.length>
1&&agence.weekPlanning.friday.openingHours[1].hoursType.hoursTypeId=="FERM_TEMPO";template=template+'\x3cspan class\x3d"ficheAgence-jourSeparateur"\x3e\x3c/span\x3e';if(openFriday2RDV)template=template+'\x3cspan class\x3d"ficheAgence-sur-rendez-vous"\x3e'+agence.weekPlanning.friday.openingHours[1].opening+"-"+agence.weekPlanning.friday.openingHours[1].closing+"\x3c/span\x3e";else if(openFriday2CnsDist)template=template+'\x3cspan class\x3d"ficheAgence-conseil-a-distance"\x3e'+agence.weekPlanning.friday.openingHours[1].opening+
"-"+agence.weekPlanning.friday.openingHours[1].closing+"\x3c/span\x3e";else if(openFriday2FermTemp)template=template+'\x3cspan class\x3d"ficheAgence-ferme-temporairement"\x3e'+agence.weekPlanning.friday.openingHours[1].opening+"-"+agence.weekPlanning.friday.openingHours[1].closing+"\x3c/span\x3e";else if(agence.weekPlanning.friday.openingHours.length>1)template=template+"\x3cspan \x3e"+agence.weekPlanning.friday.openingHours[1].opening+"-"+agence.weekPlanning.friday.openingHours[1].closing+"\x3c/span\x3e"}}return template+
"\x3c/span\x3e\x3c/li\x3e"}function generateJourSamedi(todayX,openX,agence){var template='\x3cli class\x3d"ficheAgence-jour" id\x3d"samedi"\x3e';if(todayX)template=template+'\x3cspan class\x3d"ficheAgence-jourNom ficheAgence-aujourdhui"\x3eSamedi\x3c/span\x3e\n                    \x3cspan class\x3d"ficheAgence-jourHorairesOuverture"\x3e';else template=template+'\x3cspan class\x3d"ficheAgence-jourNom ficheAgence-autreJour"\x3eSamedi\x3c/span\x3e\n                    \x3cspan class\x3d"ficheAgence-jourHorairesOuverture"\x3e';
if(!openX)if(!todayX)template=template+'\x3cspan class\x3d"ficheAgence-jour--ferme"\x3eFerm\u00e9\x3c/span\x3e';else template=template+"\x3cspan\x3eFerm\u00e9\x3c/span\x3e";else{var openSaturdayRDV=agence.weekPlanning.saturday.openingHours.length!=0&&agence.weekPlanning.saturday.openingHours[0].hoursType.hoursTypeId=="OUV_RDV";var openSaturdayCnsDist=agence.weekPlanning.saturday.openingHours.length!=0&&agence.weekPlanning.saturday.openingHours[0].hoursType.hoursTypeId=="CONSEIL_DIST";var openSaturdayFermTemp=
agence.weekPlanning.saturday.openingHours.length!=0&&agence.weekPlanning.saturday.openingHours[0].hoursType.hoursTypeId=="FERM_TEMPO";var openSaturday2=agence.weekPlanning.saturday.openingHours.length>1&&agence.weekPlanning.saturday.openingHours[1].opening.trim()!=""&&agence.weekPlanning.saturday.openingHours[1].closing.trim()!="";if(openSaturdayRDV)template=template+'\x3cspan class\x3d"ficheAgence-sur-rendez-vous"\x3e'+agence.weekPlanning.saturday.openingHours[0].opening+"-"+agence.weekPlanning.saturday.openingHours[0].closing+
"\x3c/span\x3e";else if(openSaturdayCnsDist)template=template+'\x3cspan class\x3d"ficheAgence-conseil-a-distance"\x3e'+agence.weekPlanning.saturday.openingHours[0].opening+"-"+agence.weekPlanning.saturday.openingHours[0].closing+"\x3c/span\x3e";else if(openSaturdayFermTemp)template=template+'\x3cspan class\x3d"ficheAgence-ferme-temporairement"\x3e'+agence.weekPlanning.saturday.openingHours[0].opening+"-"+agence.weekPlanning.saturday.openingHours[0].closing+"\x3c/span\x3e";else if(agence.weekPlanning.saturday.openingHours.length!=
0)template=template+"\x3cspan\x3e"+agence.weekPlanning.saturday.openingHours[0].opening+"-"+agence.weekPlanning.saturday.openingHours[0].closing+"\x3c/span\x3e";if(openSaturday2){var openSaturday2RDV=agence.weekPlanning.saturday.openingHours.length>1&&agence.weekPlanning.saturday.openingHours[1].hoursType.hoursTypeId=="OUV_RDV";var openSaturday2CnsDist=agence.weekPlanning.saturday.openingHours.length>1&&agence.weekPlanning.saturday.openingHours[1].hoursType.hoursTypeId=="CONSEIL_DIST";var openSaturday2FermTemp=
agence.weekPlanning.saturday.openingHours.length>1&&agence.weekPlanning.saturday.openingHours[1].hoursType.hoursTypeId=="FERM_TEMPO";template=template+'\x3cspan class\x3d"ficheAgence-jourSeparateur"\x3e\x3c/span\x3e';if(openSaturday2RDV)template=template+'\x3cspan class\x3d"ficheAgence-sur-rendez-vous"\x3e'+agence.weekPlanning.saturday.openingHours[1].opening+"-"+agence.weekPlanning.saturday.openingHours[1].closing+"\x3c/span\x3e";else if(openSaturday2CnsDist)template=template+'\x3cspan class\x3d"ficheAgence-conseil-a-distance"\x3e'+
agence.weekPlanning.saturday.openingHours[1].opening+"-"+agence.weekPlanning.saturday.openingHours[1].closing+"\x3c/span\x3e";else if(openSaturday2FermTemp)template=template+'\x3cspan class\x3d"ficheAgence-ferme-temporairement"\x3e'+agence.weekPlanning.saturday.openingHours[1].opening+"-"+agence.weekPlanning.saturday.openingHours[1].closing+"\x3c/span\x3e";else if(agence.weekPlanning.saturday.openingHours.length>1)template=template+"\x3cspan \x3e"+agence.weekPlanning.saturday.openingHours[1].opening+
"-"+agence.weekPlanning.saturday.openingHours[1].closing+"\x3c/span\x3e"}}return template+"\x3c/span\x3e\x3c/li\x3e"}function generateJourDimanche(todayX,openX,agence){var template='\x3cli class\x3d"ficheAgence-jour" id\x3d"dimanche"\x3e';if(todayX)template=template+'\x3cspan class\x3d"ficheAgence-jourNom ficheAgence-aujourdhui"\x3eDimanche\x3c/span\x3e\n                    \x3cspan class\x3d"ficheAgence-jourHorairesOuverture"\x3e';else template=template+'\x3cspan class\x3d"ficheAgence-jourNom ficheAgence-autreJour"\x3eDimanche\x3c/span\x3e\n                    \x3cspan class\x3d"ficheAgence-jourHorairesOuverture"\x3e';
if(!openX)if(!todayX)template=template+'\x3cspan class\x3d"ficheAgence-jour--ferme"\x3eFerm\u00e9\x3c/span\x3e';else template=template+"\x3cspan\x3eFerm\u00e9\x3c/span\x3e";else{var openSundayRDV=agence.weekPlanning.sunday.openingHours.length!=0&&agence.weekPlanning.sunday.openingHours[0].hoursType.hoursTypeId=="OUV_RDV";var openSundayCnsDist=agence.weekPlanning.sunday.openingHours.length!=0&&agence.weekPlanning.sunday.openingHours[0].hoursType.hoursTypeId=="CONSEIL_DIST";var openSundayFermTemp=agence.weekPlanning.sunday.openingHours.length!=
0&&agence.weekPlanning.sunday.openingHours[0].hoursType.hoursTypeId=="FERM_TEMPO";var openSunday2=agence.weekPlanning.sunday.openingHours.length>1&&agence.weekPlanning.sunday.openingHours[1].opening.trim()!=""&&agence.weekPlanning.sunday.openingHours[1].closing.trim()!="";if(openSundayRDV)template=template+'\x3cspan class\x3d"ficheAgence-sur-rendez-vous"\x3e'+agence.weekPlanning.sunday.openingHours[0].opening+"-"+agence.weekPlanning.sunday.openingHours[0].closing+"\x3c/span\x3e";else if(openSundayCnsDist)template=
template+'\x3cspan class\x3d"ficheAgence-conseil-a-distance"\x3e'+agence.weekPlanning.sunday.openingHours[0].opening+"-"+agence.weekPlanning.sunday.openingHours[0].closing+"\x3c/span\x3e";else if(openSundayFermTemp)template=template+'\x3cspan class\x3d"ficheAgence-ferme-temporairement"\x3e'+agence.weekPlanning.sunday.openingHours[0].opening+"-"+agence.weekPlanning.sunday.openingHours[0].closing+"\x3c/span\x3e";else if(agence.weekPlanning.sunday.openingHours.length!=0)template=template+"\x3cspan\x3e"+
agence.weekPlanning.sunday.openingHours[0].opening+"-"+agence.weekPlanning.sunday.openingHours[0].closing+"\x3c/span\x3e";if(openSunday2){var openSunday2RDV=agence.weekPlanning.sunday.openingHours.length>1&&agence.weekPlanning.sunday.openingHours[1].hoursType.hoursTypeId=="OUV_RDV";var openSunday2CnsDist=agence.weekPlanning.sunday.openingHours.length>1&&agence.weekPlanning.sunday.openingHours[1].hoursType.hoursTypeId=="CONSEIL_DIST";var openSunday2FermTemp=agence.weekPlanning.sunday.openingHours.length>
1&&agence.weekPlanning.sunday.openingHours[1].hoursType.hoursTypeId=="FERM_TEMPO";template=template+'\x3cspan class\x3d"ficheAgence-jourSeparateur"\x3e\x3c/span\x3e';if(openSunday2RDV)template=template+'\x3cspan class\x3d"ficheAgence-sur-rendez-vous"\x3e'+agence.weekPlanning.sunday.openingHours[1].opening+"-"+agence.weekPlanning.sunday.openingHours[1].closing+"\x3c/span\x3e";else if(openSunday2CnsDist)template=template+'\x3cspan class\x3d"ficheAgence-conseil-a-distance"\x3e'+agence.weekPlanning.sunday.openingHours[1].opening+
"-"+agence.weekPlanning.sunday.openingHours[1].closing+"\x3c/span\x3e";else if(openSunday2FermTemp)template=template+'\x3cspan class\x3d"ficheAgence-ferme-temporairement"\x3e'+agence.weekPlanning.sunday.openingHours[1].opening+"-"+agence.weekPlanning.sunday.openingHours[1].closing+"\x3c/span\x3e";else if(agence.weekPlanning.sunday.openingHours.length>1)template=template+"\x3cspan \x3e"+agence.weekPlanning.sunday.openingHours[1].opening+"-"+agence.weekPlanning.sunday.openingHours[1].closing+"\x3c/span\x3e"}}return template+
"\x3c/span\x3e\x3c/li\x3e"}function generateHoraireAgence(agence){var openMonday=!agence.exceptionalClosure&&agence.weekPlanning.monday.openingHours.length!=0&&agence.weekPlanning.monday.openingHours[0].opening.trim()!=""&&agence.weekPlanning.monday.openingHours[0].closing.trim()!="";var openTuesday=!agence.exceptionalClosure&&agence.weekPlanning.tuesday.openingHours.length!=0&&agence.weekPlanning.tuesday.openingHours[0].opening.trim()!=""&&agence.weekPlanning.tuesday.openingHours[0].closing.trim()!=
"";var openWednesday=!agence.exceptionalClosure&&agence.weekPlanning.wednesday.openingHours.length!=0&&agence.weekPlanning.wednesday.openingHours[0].opening.trim()!=""&&agence.weekPlanning.wednesday.openingHours[0].closing.trim()!="";var openThursday=!agence.exceptionalClosure&&agence.weekPlanning.thursday.openingHours.length!=0&&agence.weekPlanning.thursday.openingHours[0].opening.trim()!=""&&agence.weekPlanning.thursday.openingHours[0].closing.trim()!="";var openFriday=!agence.exceptionalClosure&&
agence.weekPlanning.friday.openingHours.length!=0&&agence.weekPlanning.friday.openingHours[0].opening.trim()!=""&&agence.weekPlanning.friday.openingHours[0].closing.trim()!="";var openSaturday=!agence.exceptionalClosure&&agence.weekPlanning.saturday.openingHours.length!=0&&agence.weekPlanning.saturday.openingHours[0].opening.trim()!=""&&agence.weekPlanning.saturday.openingHours[0].closing.trim()!="";var openSunday=!agence.exceptionalClosure&&agence.weekPlanning.sunday.openingHours.length!=0&&agence.weekPlanning.sunday.openingHours[0].opening.trim()!=
""&&agence.weekPlanning.sunday.openingHours[0].closing.trim()!="";var hasAtLeastOneDay=openMonday||openTuesday||openWednesday||openThursday||openFriday||openSaturday||openSaturday||openSunday;if(agence.type==2&&!hasAtLeastOneDay)return"Les horaires de ce Relais CA ne sont pas disponibles.";else{var todayMonday=agence.weekPlanning.monday.dayOfWeek=="today";var todayTuesday=agence.weekPlanning.tuesday.dayOfWeek=="today";var todayWednesday=agence.weekPlanning.wednesday.dayOfWeek=="today";var todayThursday=
agence.weekPlanning.thursday.dayOfWeek=="today";var todayFriday=agence.weekPlanning.friday.dayOfWeek=="today";var todaySaturday=agence.weekPlanning.saturday.dayOfWeek=="today";var todaySunday=agence.weekPlanning.sunday.dayOfWeek=="today";var template='\x3cul class\x3d"ficheAgence-jours ficheAgence-jours-bv"\x3e\x3cdiv\x3e';template=template+generateJourLundi(agence.weekPlanning.monday.dayOfWeek=="today",openMonday,agence);template=template+generateJourMardi(agence.weekPlanning.tuesday.dayOfWeek==
"today",openTuesday,agence);template=template+generateJourMercredi(agence.weekPlanning.wednesday.dayOfWeek=="today",openWednesday,agence);template=template+generateJourJeudi(agence.weekPlanning.thursday.dayOfWeek=="today",openThursday,agence);template=template+"\x3c/div\x3e\x3cdiv\x3e";template=template+generateJourVendredi(agence.weekPlanning.friday.dayOfWeek=="today",openFriday,agence);template=template+generateJourSamedi(agence.weekPlanning.saturday.dayOfWeek=="today",openSaturday,agence);template=
template+generateJourDimanche(agence.weekPlanning.sunday.dayOfWeek=="today",openSunday,agence);return template+"\x3c/div\x3e\x3c/ul\x3e"}}function generateInfosComplementaires(){var openMondayFermTemp=agence.weekPlanning.monday.openingHours.length!=0&&agence.weekPlanning.monday.openingHours[0].hoursType.hoursTypeId=="FERM_TEMPO";var openMonday2FermTemp=agence.weekPlanning.monday.openingHours.length>1&&agence.weekPlanning.monday.openingHours[1].hoursType.hoursTypeId=="FERM_TEMPO";var openTuesdayFermTemp=
agence.weekPlanning.tuesday.openingHours.length!=0&&agence.weekPlanning.tuesday.openingHours[0].hoursType.hoursTypeId=="FERM_TEMPO";var openTuesday2FermTemp=agence.weekPlanning.tuesday.openingHours.length>1&&agence.weekPlanning.tuesday.openingHours[1].hoursType.hoursTypeId=="FERM_TEMPO";var openWednesdayFermTemp=agence.weekPlanning.wednesday.openingHours.length!=0&&agence.weekPlanning.wednesday.openingHours[0].hoursType.hoursTypeId=="FERM_TEMPO";var openWednesday2FermTemp=agence.weekPlanning.wednesday.openingHours.length>
1&&agence.weekPlanning.wednesday.openingHours[1].hoursType.hoursTypeId=="FERM_TEMPO";var openThursdayFermTemp=agence.weekPlanning.thursday.openingHours.length!=0&&agence.weekPlanning.thursday.openingHours[0].hoursType.hoursTypeId=="FERM_TEMPO";var openThursday2FermTemp=agence.weekPlanning.thursday.openingHours.length>1&&agence.weekPlanning.thursday.openingHours[1].hoursType.hoursTypeId=="FERM_TEMPO";var openFridayFermTemp=agence.weekPlanning.friday.openingHours.length!=0&&agence.weekPlanning.friday.openingHours[0].hoursType.hoursTypeId==
"FERM_TEMPO";var openFriday2FermTemp=agence.weekPlanning.friday.openingHours.length>1&&agence.weekPlanning.friday.openingHours[1].hoursType.hoursTypeId=="FERM_TEMPO";var openSaturdayFermTemp=agence.weekPlanning.saturday.openingHours.length!=0&&agence.weekPlanning.saturday.openingHours[0].hoursType.hoursTypeId=="FERM_TEMPO";var openSaturday2FermTemp=agence.weekPlanning.saturday.openingHours.length>1&&agence.weekPlanning.saturday.openingHours[1].hoursType.hoursTypeId=="FERM_TEMPO";var openSundayFermTemp=
agence.weekPlanning.sunday.openingHours.length!=0&&agence.weekPlanning.sunday.openingHours[0].hoursType.hoursTypeId=="FERM_TEMPO";var openSunday2FermTemp=agence.weekPlanning.sunday.openingHours.length>1&&agence.weekPlanning.sunday.openingHours[1].hoursType.hoursTypeId=="FERM_TEMPO";var openMondayRDV=agence.weekPlanning.monday.openingHours.length!=0&&agence.weekPlanning.monday.openingHours[0].hoursType.hoursTypeId=="OUV_RDV";var openMonday2RDV=agence.weekPlanning.monday.openingHours.length>1&&agence.weekPlanning.monday.openingHours[1].hoursType.hoursTypeId==
"OUV_RDV";var openTuesdayRDV=agence.weekPlanning.tuesday.openingHours.length!=0&&agence.weekPlanning.tuesday.openingHours[0].hoursType.hoursTypeId=="OUV_RDV";var openTuesday2RDV=agence.weekPlanning.tuesday.openingHours.length>1&&agence.weekPlanning.tuesday.openingHours[1].hoursType.hoursTypeId=="OUV_RDV";var openWednesdayRDV=agence.weekPlanning.wednesday.openingHours.length!=0&&agence.weekPlanning.wednesday.openingHours[0].hoursType.hoursTypeId=="OUV_RDV";var openWednesday2RDV=agence.weekPlanning.wednesday.openingHours.length>
1&&agence.weekPlanning.wednesday.openingHours[1].hoursType.hoursTypeId=="OUV_RDV";var openThursdayRDV=agence.weekPlanning.thursday.openingHours.length!=0&&agence.weekPlanning.thursday.openingHours[0].hoursType.hoursTypeId=="OUV_RDV";var openThursday2RDV=agence.weekPlanning.thursday.openingHours.length>1&&agence.weekPlanning.thursday.openingHours[1].hoursType.hoursTypeId=="OUV_RDV";var openFridayRDV=agence.weekPlanning.friday.openingHours.length!=0&&agence.weekPlanning.friday.openingHours[0].hoursType.hoursTypeId==
"OUV_RDV";var openFriday2RDV=agence.weekPlanning.friday.openingHours.length>1&&agence.weekPlanning.friday.openingHours[1].hoursType.hoursTypeId=="OUV_RDV";var openSaturdayRDV=agence.weekPlanning.saturday.openingHours.length!=0&&agence.weekPlanning.saturday.openingHours[0].hoursType.hoursTypeId=="OUV_RDV";var openSaturday2RDV=agence.weekPlanning.saturday.openingHours.length>1&&agence.weekPlanning.saturday.openingHours[1].hoursType.hoursTypeId=="OUV_RDV";var openSundayRDV=agence.weekPlanning.sunday.openingHours.length!=
0&&agence.weekPlanning.sunday.openingHours[0].hoursType.hoursTypeId=="OUV_RDV";var openSunday2RDV=agence.weekPlanning.sunday.openingHours.length>1&&agence.weekPlanning.sunday.openingHours[1].hoursType.hoursTypeId=="OUV_RDV";var openMondayCnsDist=agence.weekPlanning.monday.openingHours.length!=0&&agence.weekPlanning.monday.openingHours[0].hoursType.hoursTypeId=="CONSEIL_DIST";var openMonday2CnsDist=agence.weekPlanning.monday.openingHours.length>1&&agence.weekPlanning.monday.openingHours[1].hoursType.hoursTypeId==
"CONSEIL_DIST";var openTuesdayCnsDist=agence.weekPlanning.tuesday.openingHours.length!=0&&agence.weekPlanning.tuesday.openingHours[0].hoursType.hoursTypeId=="CONSEIL_DIST";var openTuesday2CnsDist=agence.weekPlanning.tuesday.openingHours.length>1&&agence.weekPlanning.tuesday.openingHours[1].hoursType.hoursTypeId=="CONSEIL_DIST";var openWednesdayCnsDist=agence.weekPlanning.wednesday.openingHours.length!=0&&agence.weekPlanning.wednesday.openingHours[0].hoursType.hoursTypeId=="CONSEIL_DIST";var openWednesday2CnsDist=
agence.weekPlanning.wednesday.openingHours.length>1&&agence.weekPlanning.wednesday.openingHours[1].hoursType.hoursTypeId=="CONSEIL_DIST";var openWednesdayCnsDist=agence.weekPlanning.wednesday.openingHours.length!=0&&agence.weekPlanning.wednesday.openingHours[0].hoursType.hoursTypeId=="CONSEIL_DIST";var openWednesday2CnsDist=agence.weekPlanning.wednesday.openingHours.length>1&&agence.weekPlanning.wednesday.openingHours[1].hoursType.hoursTypeId=="CONSEIL_DIST";var openThursdayCnsDist=agence.weekPlanning.thursday.openingHours.length!=
0&&agence.weekPlanning.thursday.openingHours[0].hoursType.hoursTypeId=="CONSEIL_DIST";var openThursday2CnsDist=agence.weekPlanning.thursday.openingHours.length>1&&agence.weekPlanning.thursday.openingHours[1].hoursType.hoursTypeId=="CONSEIL_DIST";var openFridayCnsDist=agence.weekPlanning.friday.openingHours.length!=0&&agence.weekPlanning.friday.openingHours[0].hoursType.hoursTypeId=="CONSEIL_DIST";var openFriday2CnsDist=agence.weekPlanning.friday.openingHours.length>1&&agence.weekPlanning.friday.openingHours[1].hoursType.hoursTypeId==
"CONSEIL_DIST";var openSaturdayCnsDist=agence.weekPlanning.saturday.openingHours.length!=0&&agence.weekPlanning.saturday.openingHours[0].hoursType.hoursTypeId=="CONSEIL_DIST";var openSaturday2CnsDist=agence.weekPlanning.saturday.openingHours.length>1&&agence.weekPlanning.saturday.openingHours[1].hoursType.hoursTypeId=="CONSEIL_DIST";var openSundayCnsDist=agence.weekPlanning.sunday.openingHours.length!=0&&agence.weekPlanning.sunday.openingHours[0].hoursType.hoursTypeId=="CONSEIL_DIST";var openSunday2CnsDist=
agence.weekPlanning.sunday.openingHours.length>1&&agence.weekPlanning.sunday.openingHours[1].hoursType.hoursTypeId=="CONSEIL_DIST";var hasAtLeastOneFermTemp=openMondayFermTemp||openMonday2FermTemp||openTuesdayFermTemp||openTuesday2FermTemp||openWednesdayFermTemp||openWednesday2FermTemp||openThursdayFermTemp||openThursday2FermTemp||openFridayFermTemp||openFriday2FermTemp||openSaturdayFermTemp||openSaturday2FermTemp||openSundayFermTemp||openSunday2FermTemp;var hasAtLeastOneRDV=openMondayRDV||openMonday2RDV||
openTuesdayRDV||openTuesday2RDV||openWednesdayRDV||openWednesday2RDV||openThursdayRDV||openThursday2RDV||openFridayRDV||openFriday2RDV||openSaturdayRDV||openSaturday2RDV||openSundayRDV||openSunday2RDV;var hasAtLeastOneCnsDist=openMondayCnsDist||openMonday2CnsDist||openTuesdayCnsDist||openTuesday2CnsDist||openWednesdayCnsDist||openWednesday2CnsDist||openThursdayCnsDist||openThursday2CnsDist||openFridayCnsDist||openFriday2CnsDist||openSaturdayCnsDist||openSaturday2CnsDist||openSundayCnsDist||openSunday2CnsDist;
var template="";if(!agence.exceptionalClosure&&(hasAtLeastOneFermTemp||hasAtLeastOneRDV||hasAtLeastOneCnsDist)){template=template+'\x3cul class\x3d"npc-sl-strct-horaires-options"\x3e';if(hasAtLeastOneRDV)template=template+'\x3cli class\x3d"legende-ficheAgence-sur-rendez-vous"\x3e* Ouverture uniquement sur rendez-vous\x3c/li\x3e';if(hasAtLeastOneFermTemp)template=template+'\x3cli class\x3d"legende-ficheAgence-ferme-temporairement"\x3e** Ferm\u00e9 temporairement\x3c/li\x3e';if(hasAtLeastOneCnsDist)template=
template+'\x3cli class\x3d"legende-ficheAgence-conseil-a-distance"\x3e*** Conseil \u00e0 distance\x3c/li\x3e';template=template+"\x3c/ul\x3e"}return template}function generateNextOpeningOrClosingLibelle(){var template;template='\x3cdiv class\x3d"npc-sl-strct-infos-ctct-ouverture-'+agence.openedOrClosed+'"\x3e';template=template+'\x3cspan class\x3d"npc-sl-strct-infos-ctct-dot "\x3e\x3c/span\x3e'+agence.currentOpeningLibelle+"\x3c/div\x3e";if(agence.nextOpeningOrClosingLibelle.trim()!=""&&!agence.weekPlanning.isOpenAllWeek)template=
template+'\x3cdiv class\x3d"npc-sl-strct-infos-ctct-horaire "\x3e'+agence.nextOpeningOrClosingLibelle+"\x3c/div\x3e";return template}function generateBandeauAgenceDeRepli(agence){var template;if(agence.exceptionalClosure&&agence.idStructRepli)template='\x3cdiv class\x3d"npc-sl-strct-bandeau-repli"\x3e\n                        \x3cdiv class\x3d"npc-msl-feedback npc-msl-feedback--danger npc-msl-feedback-icon"\x3e\n                            \x3ci class\x3d"icon"\x3e\x3c/i\x3e\n                            \x3cdiv class\x3d"npc-msl-feedback--content"\x3e\n                                \x3cp class\x3d"npc-msl-fc--title"\x3eVotre agence est ferm\u00e9e exceptionnellement\x3c/p\x3e\n                                \x3cdiv class\x3d"npc-msl-fc--body"\x3e\n                                    \x3cdiv class\x3d"feedback-texte"\x3eEn attendant, nous vous proposons une agence de remplacement proche de votre agence habituelle.\x3c/div\x3e\n                                \t\x3ca href\x3d"#" class\x3d"npc-msl-link npc-msl-fc--link link-agence-repli-BV" data-val\x3d"'+
agence.idStructRepli+'"\x3eVoir mon agence de remplacement\x3c/a\x3e\n                                \x3c/div\x3e\n                            \x3c/div\x3e\n                        \x3c/div\x3e\n                    \x3c/div\x3e';return template}return{currentOpeningLibelle:agence.currentOpeningLibelle,nextOpeningOrClosingLibelle:generateNextOpeningOrClosingLibelle(),agenceName:generateAgenceName(agence),agenceDeRepli:generateBandeauAgenceDeRepli(agence),addressCpVille:agence.address.address+", "+
agence.address.zipCode+" "+agence.address.cityName,phoneNumber:generateNumeroAgence(),fax:generateNumeroFax(),emailAddress:generateEmail(),itineraire:generateItineraire(),serviceACM:generateService(agence.services.automaticCashMachine,"ic_ATM_large","Guichets automatiques"),serviceATM:generateService(agence.services.atm,"ic_banknote_large","Distributeurs automatiques de billets"),serviceEX:generateService(agence.services.exchangeCurrency,"ic_change_large","Change"),serviceWCA:generateService(agence.services.wheelChairAccess,
"ic_handicap_large","Acc\u00e8s handicap\u00e9"),serviceES1:generateService(agence.services.extraService1,"ic_info_large",agence.services.extraService1),serviceES2:generateService(agence.services.extraService2,"ic_info_large",agence.services.extraService2),serviceES3:generateService(agence.services.extraService3,"ic_info_large",agence.services.extraService3),serviceCP:generateService(agence.services.carPark,"ic_parking_large","Parking"),serviceACMClass:agence.services.automaticCashMachine!=true?"hidden":
"",serviceATMClass:agence.services.atm!=true?"hidden":"",serviceEXClass:agence.services.exchangeCurrency!=true?"hidden":"",serviceWCAClass:agence.services.wheelChairAccess!=true?"hidden":"",serviceES1Class:agence.services.extraService1!=true?"hidden":"",serviceES2Class:agence.services.extraService2!=true?"hidden":"",serviceES3Class:agence.services.extraService3!=true?"hidden":"",serviceCPClass:agence.services.carPark!=true?"hidden":"",serviceTitleClass:agence.services.automaticCashMachine!=true&&
agence.services.atm!=true&&agence.services.exchangeCurrency!=true&&agence.services.wheelChairAccess!=true&&agence.services.extraService1!=true&&agence.services.extraService2!=true&&agence.services.extraService3!=true&&agence.services.carPark!=true?"hidden":"",openAllWeektrue:agence.weekPlanning&&agence.weekPlanning.isOpenAllWeek!=true?"hidden":"",openAllWeekfalse:agence.weekPlanning&&agence.weekPlanning.isOpenAllWeek!=false?"hidden":"",horaireAgence:agence.weekPlanning?generateHoraireAgence(agence):
"",infosComplementaires:agence.weekPlanning?generateInfosComplementaires():""}};function _displayResultAgences(listeAgence,estParGeoloc){if(listeAgence.length===0)if(estParGeoloc){$("#noAgenceByAdress").addClass("hidden");$("#noAgenceByGeolocalisation").removeClass("hidden")}else{$("#noAgenceByGeolocalisation").addClass("hidden");$("#noAgenceByAdress").removeClass("hidden")}else{NPC.BV.listeAgence=listeAgence;var uniqueTypes=combineAllMarketObj(listeAgence);var marketList={generalPublic:uniqueTypes.generalPublic,
privateBanking:uniqueTypes.privateBanking,enterprise:uniqueTypes.enterprise,pro_farmer_association:uniqueTypes.pro||uniqueTypes.farmer||uniqueTypes.association,publicCollectivity:uniqueTypes.publicCollectivity};NPC.BV.FUNCTIONS.loadStoreLocPanel({title:NPC.BV.CURRENT_PARCOUR.parcourTitle,isNotPublic:marketList.generalPublic?"":"hidden",isNotPrivateBanking:marketList.privateBanking?"":"hidden",isNotEnterprise:marketList.enterprise?"":"hidden",isNotProFarmAssoc:marketList.pro_farmer_association?"":
"hidden",isNotPublicCollectivity:marketList.publicCollectivity?"":"hidden",isNotAll:getTrueMarketList(marketList).length===1?"hidden":"",dataSize:getTrueMarketList(marketList).length});NPC.BV.$_BV_PANEL.find(".selectpicker").selectpicker("refresh");if(getTrueMarketList(marketList).length===1)$("#greenBtnblockContainer").find(".selectpicker").val(getTrueMarketList(marketList)[0]).selectpicker("refresh");var contentAucuneAgence='\x3cli class\x3d"StoreLocatorMap-Agency StoreLocatorMap-Agency--noResult js-StoreLocatorMap-Agency--noResult"\x3e\x3ch2 class\x3d"StoreLocatorMap-AgencyTitle"\x3eAucun r\u00e9sultat\x3c/h2\x3e\x3c/li\x3e';
$(".bv-storelocator-agency-list").append(contentAucuneAgence);if(!listeAgence||listeAgence.length==0){$("#voirPlusAgences").addClass("hidden");return}$(".bv-storelocator-agency-list").loadTemplate($("#template-carte-agence"),listeAgence.map(function(agence){var pinAgence="";if(agence.type===6)pinAgence="/etc.clientlibs/settings/wcm/designs/ca/npc/clientlib-resources/resources/images/store-locator/ca-pin6.png";else pinAgence="/etc.clientlibs/settings/wcm/designs/ca/npc/clientlib-resources/resources/images/store-locator/ca-pin.png";
var data={latitude:agence.coordinates.latitude,longitude:agence.coordinates.longitude,markets:recupererMarches(agence.market),opening:openingDays(agence.weekPlanning),agenceName:agence.name,labelOpenDays:agence.weekPlanning&&agence.weekPlanning.labelOpenDays?generateOpeningDaysForCard(agence):"",horaireTodayAgence:agence.weekPlanning?horaireToday(agence.weekPlanning,agence):"",horaireTodayAgenceForMobile:agence.weekPlanning?horaireTodayForMobile(agence):"",agenceId:"ficheAgence-"+agence.id,horaireAdresseCpVille:agence.weekPlanning?
horaireToday(agence.weekPlanning,agence)+"\x3c/br\x3e"+agence.address.address+" "+agence.address.zipCode+" "+agence.address.cityName:"",agenceDistance:recupererDistance(agence.distance),agenceIdList:"ficheAgence-"+agence.id,agenceType:[agence.typeName],pinAgence:pinAgence};data.valueAttr=JSON.stringify({id:data.agenceIdList,latitude:data.latitude,longitude:data.longitude,type:data.markets,openings:data.opening});return data}),{append:true});$document.off("click",".plusInfo").on("click",".plusInfo",
function(e){e.preventDefault();NPC.BV.STORELOC_MAP=true;NPC.BV.FUNCTIONS.loadPanelAfterStoreLoc(e.currentTarget)});$(".bv-listeAgenceGeolocalisee").on("click",function(e){e.preventDefault();NPC.BV.STORELOC_MAP=false;NPC.BV.FUNCTIONS.loadPanelAfterStoreLoc(e.currentTarget)});var $listeAgenceGeoloc=$(".bv-listeAgenceGeolocalisee");var numberAgencies=15;$listeAgenceGeoloc.slice(numberAgencies).addClass("hidden").removeClass("js-storeLoc-agency").addClass("StoreLocatorMap-Agency");$(window).trigger("google.maps.api.loaded");
if(NPC.BV.STORELOC_MAP){$("#mapAgency").addClass("active");$("#listAgency").removeClass("active");$(".js-StoreLocatorMap-content").addClass("has-mapFocus")}else{$("#mapAgency").removeClass("active");$("#listAgency").addClass("active")}}}var _findNearlyAgences=function(){if(NPC.storeLocator)NPC.storeLocator.trouverAgencesProches(NPC.geoloc.lat,NPC.geoloc.long,_displayResultAgences)};var afficherMessageErreur=function(){$("#errorGeolocalisation").removeClass("hidden");$("#errorGeolocalisation").addClass("npc-error-geolocalisation")};
function _findNearlyAgencesAddresse(){if(NPC.storeLocator){var addressUser="";if($("#"+NPC.BV.INPUTS.trouverAgenceByAdresse).length!==0){addressUser=$.trim($("#"+NPC.BV.INPUTS.trouverAgenceByAdresse).val());NPC.BV.STORELOC_INPUT=addressUser}else addressUser=NPC.BV.STORELOC_INPUT;NPC.storeLocator.trouverAgencesProchesAdresse(addressUser,_displayResultAgences)}}NPC.BV.FUNCTIONS.trouverAgencesRun=function(){if(!NPC.geoloc.alreadyAsked){NPC.geoloc.addCallBackFnc(function(){_findNearlyAgences()},function(){afficherMessageErreur()});
NPC.geoloc.tryToGeoloc()}else if(NPC.geoloc.geolocalized)_findNearlyAgences();else if(NPC.geoloc.userDenied)afficherMessageErreur()};NPC.BV.FUNCTIONS.trouverAgencesAddresseRun=function(){_findNearlyAgencesAddresse()}}
function initBvFormFunction(){NPC.BV.FUNCTIONS.FORM={};function initBvFormRules(){$("#"+NPC.BV._BV_FORMID).validate({rules:{dayForm:{date:false,dateITA:true},birthdateForm:{date:false,dateITA:true},comment:{required:true,minlength:20},lastname:{required:true,minlength:2},firstname:{required:true,minlength:2},phonenumberForm:{required:true},emailForm:{email:true,required:true},checkboxMentionsLegales:{required:true}},messages:{firstname:{required:"V\u00e9rifiez votre saisie",minlength:jQuery.format("V\u00e9rifiez votre saisie")},
lastname:{required:"V\u00e9rifiez votre saisie",minlength:jQuery.format("V\u00e9rifiez votre saisie")},phonenumberForm:{required:"V\u00e9rifiez votre saisie",minlength:jQuery.format("V\u00e9rifiez votre saisie"),maxlength:jQuery.format("V\u00e9rifiez votre saisie")},emailForm:{required:"V\u00e9rifiez votre saisie",email:"Veuillez entrer une adresse email valide"},comment:{required:"Veuillez entrer au moins 20 caract\u00e8res",minlength:jQuery.format("Veuillez entrer au moins 20 caract\u00e8res")},
checkboxMentionsLegales:{required:"Veuillez indiquer que vous avez bien pris connaissance des mentions l\u00e9gales"}},highlight:function(element){$(element).closest(".form-group").addClass("has-error")},unhighlight:function(element){$(element).closest(".form-group").removeClass("has-error")},errorElement:"p",errorClass:"has-error",errorPlacement:function(error,element){if(element.is(":checkbox")){if(!error.hasClass("npc-form-error-custom"))error.addClass("npc-form-error-custom");element.closest(".checkbox").parent().append(error)}else{if(!error.hasClass("help-block"))error.addClass("help-block");
error.insertAfter(element)}}})}function validateBvForm(){initBvFormRules();var formElement=$("#"+NPC.BV._BV_FORMID);if(formElement.valid()){var agenceCouranteEmail=NPC.BV.$_BV_WRAPPER.data("value").startDataInfMotifSelected[15];var lastName=formElement.find("#lastname").val();var firstName=formElement.find("#firstname").val();var phoneNumber=formElement.find("#phonenumberForm").val();var emailUser=formElement.find("#emailForm").val();var civility=formElement.find("#civility").val();var country=formElement.find("#country").val();
var birthDate=formElement.find("#birthdateForm").val();var comment=formElement.find("#comment").val().replace(/\n/g,"\x3cbr/\x3e");var qualifDemande=NPC.BV._BV_THEME.label;var hour=formElement.find("#hour").val();var day=formElement.find("#dayForm").val();var agenceFicheEmail=$("#emailAgency").text();var emailAgency="";if(NPC.BV._HISTORY[NPC.BV._HISTORY.length-2].id==="bv-panel-storelocator")emailAgency=agenceFicheEmail;else emailAgency=agenceCouranteEmail;if(NPC.BV.CURRENT_PARCOUR.parcourName===
"parcoursEmail")sendEmailForm(lastName,firstName,phoneNumber,emailUser,emailAgency,comment,civility,country,qualifDemande);else sendEmailForm(lastName,firstName,phoneNumber,emailUser,emailAgency,comment,civility,country,qualifDemande,hour,day,birthDate)}}function sendEmailForm(lastName,firstName,phoneNumber,emailUser,emailAgency,comment,civility,country,qualifDemande,hour,day,birthDate){var captchaId="";var captchaValue="";var boutonVertCaptchaElement=getBtnVertCaptcha();if(boutonVertCaptchaElement.length>
0){captchaId=boutonVertCaptchaElement.npcCaptcha("getId");captchaValue=boutonVertCaptchaElement.npcCaptcha("getResponse")}var postParams={"lastName":lastName,"firstName":firstName,"phoneNumber":phoneNumber,"emailUser":emailUser,"emailAgency":emailAgency,"comment":comment,"civility":civility,"country":country,"day":day,"hour":hour,"birthDate":birthDate,"qualifDemande":qualifDemande,"captchaId":captchaId,"captchaValue":captchaValue};var urlSendMailAjax=window.location.pathname.replace(".html",".greenbtn-sendemail.json");
$.ajax({type:"POST",url:urlSendMailAjax,data:postParams,cache:true,success:function(){refreshCaptcha();NPC.BV.FUNCTIONS.loadFeedbackPanel(true)},fail:function(){refreshCaptcha();console.error("Probleme mail envoi layer BV! (fail)");NPC.BV.FUNCTIONS.loadFeedbackPanel(true)},error:function(){refreshCaptcha();console.error("Probleme mail envoi layer BV! (error)");NPC.BV.FUNCTIONS.loadFeedbackPanel(true)}})}function getBtnVertCaptcha(){return NPC.BV.$_BV_CAPTCHA.find("[data-npc-captcha]")}function refreshCaptcha(callback){var boutonVertCaptchaElement=
getBtnVertCaptcha();boutonVertCaptchaElement.npcCaptcha("refresh",callback)}function loadCaptcha(){refreshCaptcha(function(){this.npcCaptcha("hideErrors");NPC.BV.$_BV_CAPTCHA.removeClass("hidden")})}function initBvIndicatif(){var indicatifList=[{minlength:"12",maxlength:"14",value:"France (+33)"},{minlength:"14",maxlength:"19",value:"Belgique (+32)"},{minlength:"14",maxlength:"19",value:"Allemagne (+49)"},{minlength:"14",maxlength:"19",value:"Italie (+39)"},{minlength:"14",maxlength:"19",value:"Royaume-Uni (+44)"},
{minlength:"14",maxlength:"19",value:"Espagne (+34)"},{minlength:"14",maxlength:"19",value:"Gibraltar (+350)"},{minlength:"14",maxlength:"19",value:"Portugal (+351)"},{minlength:"14",maxlength:"19",value:"Luxembourg (+352)"},{minlength:"14",maxlength:"19",value:"Irlande (+353)"},{minlength:"14",maxlength:"19",value:"Islande (+354)"},{minlength:"14",maxlength:"19",value:"Albanie (+355)"},{minlength:"14",maxlength:"19",value:"Malte (+356)"},{minlength:"14",maxlength:"19",value:"Chypre (+357)"},{minlength:"14",
maxlength:"19",value:"Finlande (+358)"},{minlength:"14",maxlength:"19",value:"Bulgarie (+359)"},{minlength:"14",maxlength:"19",value:"Hongrie (+36)"},{minlength:"14",maxlength:"19",value:"Lituanie (+370)"},{minlength:"14",maxlength:"19",value:"Lettonie (+371)"},{minlength:"14",maxlength:"19",value:"Estonie (+372)"},{minlength:"14",maxlength:"19",value:"Moldavie (+373)"},{minlength:"14",maxlength:"19",value:"Arm\u00e9nie (+374)"},{minlength:"14",maxlength:"19",value:"Bi\u00e9lorussie (+375)"},{minlength:"14",
maxlength:"19",value:"Andorre (+376)"},{minlength:"14",maxlength:"19",value:"Monaco (+377)"},{minlength:"14",maxlength:"19",value:"Saint-Marin (+378)"},{minlength:"14",maxlength:"19",value:"Vatican (+379)"},{minlength:"14",maxlength:"19",value:"Ukraine (+380)"},{minlength:"14",maxlength:"19",value:"Serbie (+381)"},{minlength:"14",maxlength:"19",value:"Mont\u00e9n\u00e9gro (+382)"},{minlength:"14",maxlength:"19",value:"Croatie (+385)"},{minlength:"14",maxlength:"19",value:"Slov\u00e9nie (+386)"},{minlength:"14",
maxlength:"19",value:"Bosnie-Herz\u00e9govine (+387)"},{minlength:"14",maxlength:"19",value:"Mac\u00e9doine (+389)"},{minlength:"14",maxlength:"19",value:"Roumanie (+40)"},{minlength:"14",maxlength:"19",value:"Suisse (+41)"},{minlength:"14",maxlength:"19",value:"Gr\u00e8ce (+30)"},{minlength:"14",maxlength:"19",value:"Pays-Bas (+31)"},{minlength:"14",maxlength:"19",value:"R\u00e9publique tch\u00e8que (+420)"},{minlength:"14",maxlength:"19",value:"Slovaquie (+421)"},{minlength:"14",maxlength:"19",
value:"Liechtenstein (+423)"},{minlength:"14",maxlength:"19",value:"Autriche (+43)"},{minlength:"14",maxlength:"19",value:"Danemark (+45)"},{minlength:"14",maxlength:"19",value:"Su\u00e8de (+46)"},{minlength:"14",maxlength:"19",value:"Norv\u00e8ge (+47)"},{minlength:"14",maxlength:"19",value:"Pologne (+48)"},{minlength:"14",maxlength:"19",value:"\u00c9tats-Unis (+1)"},{minlength:"14",maxlength:"19",value:"Canada (+1)"},{minlength:"14",maxlength:"19",value:"Bahamas (+1242)"},{minlength:"14",maxlength:"19",
value:"Barbade (+1246)"},{minlength:"14",maxlength:"19",value:"Anguilla (+1264)"},{minlength:"14",maxlength:"19",value:"Antigua-et-Barbuda (+1268)"},{minlength:"14",maxlength:"19",value:"\u00celes Vierges britanniques (+1284)"},{minlength:"14",maxlength:"19",value:"\u00celes Vierges des \u00c9tats-Unis (+1340)"},{minlength:"14",maxlength:"19",value:"\u00celes Ca\u00efmans (+1345)"},{minlength:"14",maxlength:"19",value:"Bermudes (+1441)"},{minlength:"14",maxlength:"19",value:"Grenade (+1473)"},{minlength:"14",
maxlength:"19",value:"\u00eeles Turks-et-Ca\u00efcos (+1649)"},{minlength:"14",maxlength:"19",value:"Montserrat (+1664)"},{minlength:"14",maxlength:"19",value:"\u00celes Mariannes du Nord (+1670)"},{minlength:"14",maxlength:"19",value:"Guam (+1671)"},{minlength:"14",maxlength:"19",value:"Samoa am\u00e9ricaines (+1684)"},{minlength:"14",maxlength:"19",value:"Saint-Martin (+1921)"},{minlength:"14",maxlength:"19",value:"Sainte-Lucie (+1958)"},{minlength:"14",maxlength:"19",value:"Dominique (+1967)"},
{minlength:"14",maxlength:"19",value:"Saint-Vincent-et-les-Grenadines (+1984)"},{minlength:"14",maxlength:"19",value:"Porto Rico (+1987)"},{minlength:"14",maxlength:"19",value:"R\u00e9publique dominicaine (+1809)"},{minlength:"14",maxlength:"19",value:"Trinit\u00e9-et-Tobago (+1868)"},{minlength:"14",maxlength:"19",value:"Saint-Christophe-et-Ni\u00e9v\u00e8s (+1869)"},{minlength:"14",maxlength:"19",value:"Jama\u00efque (+1876)"},{minlength:"14",maxlength:"19",value:"\u00c9gypte (+20)"},{minlength:"14",
maxlength:"19",value:"Soudan du Sud (+211)"},{minlength:"14",maxlength:"19",value:"Maroc (+212)"},{minlength:"14",maxlength:"19",value:"Alg\u00e9rie (+213)"},{minlength:"14",maxlength:"19",value:"Tunisie (+216)"},{minlength:"14",maxlength:"19",value:"Libye (+218)"},{minlength:"14",maxlength:"19",value:"Gambie (+220)"},{minlength:"14",maxlength:"19",value:"S\u00e9n\u00e9gal (+221)"},{minlength:"14",maxlength:"19",value:"Mauritanie (+222)"},{minlength:"14",maxlength:"19",value:"Mali (+223)"},{minlength:"14",
maxlength:"19",value:"Guin\u00e9e (+224)"},{minlength:"14",maxlength:"19",value:"C\u00f4te d'Ivoire (+225)"},{minlength:"14",maxlength:"19",value:"Burkina Faso (+226)"},{minlength:"14",maxlength:"19",value:"Niger (+227)"},{minlength:"14",maxlength:"19",value:"Togo (+228)"},{minlength:"14",maxlength:"19",value:"B\u00e9nin (+229)"},{minlength:"14",maxlength:"19",value:"Maurice (+230)"},{minlength:"14",maxlength:"19",value:"Lib\u00e9ria (+231)"},{minlength:"14",maxlength:"19",value:"Sierra Leone (+232)"},
{minlength:"14",maxlength:"19",value:"Ghana (+233)"},{minlength:"14",maxlength:"19",value:"Nigeria (+234)"},{minlength:"14",maxlength:"19",value:"Tchad (+235)"},{minlength:"14",maxlength:"19",value:"R\u00e9publique centrafricaine (+236)"},{minlength:"14",maxlength:"19",value:"Cameroun (+237)"},{minlength:"14",maxlength:"19",value:"Cap-Vert (+238)"},{minlength:"14",maxlength:"19",value:"Sao Tom\u00e9-et-Principe (+239)"},{minlength:"14",maxlength:"19",value:"Guin\u00e9e \u00e9quatoriale (+240)"},{minlength:"14",
maxlength:"19",value:"Gabon (+241)"},{minlength:"14",maxlength:"19",value:"R\u00e9publique du Congo (+242)"},{minlength:"14",maxlength:"19",value:"R\u00e9publique d\u00e9mocratique du Congo (+243)"},{minlength:"14",maxlength:"19",value:"Angola (+244)"},{minlength:"14",maxlength:"19",value:"Guin\u00e9e-Bissau (+245)"},{minlength:"14",maxlength:"19",value:"Territoire Britannique de l'oc\u00e9an Indien (+246)"},{minlength:"14",maxlength:"19",value:"Seychelles (+248)"},{minlength:"14",maxlength:"19",
value:"Soudan (+249)"},{minlength:"14",maxlength:"19",value:"Rwanda (+250)"},{minlength:"14",maxlength:"19",value:"\u00c9thiopie (+251)"},{minlength:"14",maxlength:"19",value:"Somalie (+252)"},{minlength:"14",maxlength:"19",value:"Djibouti (+253)"},{minlength:"14",maxlength:"19",value:"Kenya (+254)"},{minlength:"14",maxlength:"19",value:"Tanzanie (+255)"},{minlength:"14",maxlength:"19",value:"Ouganda (+256)"},{minlength:"14",maxlength:"19",value:"Burundi (+257)"},{minlength:"14",maxlength:"19",value:"Mozambique (+258)"},
{minlength:"14",maxlength:"19",value:"Zambie (+260)"},{minlength:"14",maxlength:"19",value:"Madagascar (+261)"},{minlength:"14",maxlength:"19",value:"La R\u00e9union (+262)"},{minlength:"14",maxlength:"19",value:"Mayotte (+262)"},{minlength:"14",maxlength:"19",value:"Zimbabwe (+263)"},{minlength:"14",maxlength:"19",value:"Namibie (+264)"},{minlength:"14",maxlength:"19",value:"Malawi (+265)"},{minlength:"14",maxlength:"19",value:"Lesotho (+266)"},{minlength:"14",maxlength:"19",value:"Botswana (+267)"},
{minlength:"14",maxlength:"19",value:"Swaziland (+268)"},{minlength:"14",maxlength:"19",value:"Comores (+269)"},{minlength:"14",maxlength:"19",value:"Afrique du Sud (+27)"},{minlength:"14",maxlength:"19",value:"Saint Helena (+290)"},{minlength:"14",maxlength:"19",value:"\u00c9rythr\u00e9e (+291)"},{minlength:"14",maxlength:"19",value:"Aruba (+297)"},{minlength:"14",maxlength:"19",value:"\u00celes F\u00e9ro\u00e9 (+298)"},{minlength:"14",maxlength:"19",value:"Groenland (+299)"},{minlength:"14",maxlength:"19",
value:"Belize (+501)"},{minlength:"14",maxlength:"19",value:"Guatemala (+502)"},{minlength:"14",maxlength:"19",value:"Salvador (+503)"},{minlength:"14",maxlength:"19",value:"Honduras (+504)"},{minlength:"14",maxlength:"19",value:"Nicaragua (+505)"},{minlength:"14",maxlength:"19",value:"Costa Rica (+506)"},{minlength:"14",maxlength:"19",value:"Panama (+507)"},{minlength:"14",maxlength:"19",value:"Saint-Pierre-et-Miquelon (+508)"},{minlength:"14",maxlength:"19",value:"Ha\u00efti (+509)"},{minlength:"14",
maxlength:"19",value:"P\u00e9rou (+51)"},{minlength:"14",maxlength:"19",value:"Mexique (+52)"},{minlength:"14",maxlength:"19",value:"Cuba (+53)"},{minlength:"14",maxlength:"19",value:"Argentine (+54)"},{minlength:"14",maxlength:"19",value:"Br\u00e9sil (+55)"},{minlength:"14",maxlength:"19",value:"Chili (+56)"},{minlength:"14",maxlength:"19",value:"Colombie (+57)"},{minlength:"14",maxlength:"19",value:"Venezuela (+58)"},{minlength:"14",maxlength:"19",value:"Guadeloupe (+590)"},{minlength:"14",maxlength:"19",
value:"Saint-Barth\u00e9lemy (+590)"},{minlength:"14",maxlength:"19",value:"Saint-Martin (+590)"},{minlength:"14",maxlength:"19",value:"Bolivie (+591)"},{minlength:"14",maxlength:"19",value:"Guyana (+592)"},{minlength:"14",maxlength:"19",value:"\u00c9quateur (+593)"},{minlength:"14",maxlength:"19",value:"Guyane Fran\u00e7aise (+594)"},{minlength:"14",maxlength:"19",value:"Paraguay (+595)"},{minlength:"14",maxlength:"19",value:"Martinique (+596)"},{minlength:"14",maxlength:"19",value:"Suriname (+597)"},
{minlength:"14",maxlength:"19",value:"Uruguay (+598)"},{minlength:"14",maxlength:"19",value:"Cura\u00e7ao (+599)"},{minlength:"14",maxlength:"19",value:"Malaisie (+60)"},{minlength:"14",maxlength:"19",value:"Australie (+61)"},{minlength:"14",maxlength:"19",value:"Indon\u00e9sie (+62)"},{minlength:"14",maxlength:"19",value:"Philippines (+63)"},{minlength:"14",maxlength:"19",value:"Nouvelle-Z\u00e9lande (+64)"},{minlength:"14",maxlength:"19",value:"Singapour (+65)"},{minlength:"14",maxlength:"19",value:"Tha\u00eflande (+66)"},
{minlength:"14",maxlength:"19",value:"Timor oriental (+670)"},{minlength:"14",maxlength:"19",value:"Norfolk Island (+672)"},{minlength:"14",maxlength:"19",value:"Brunei (+673)"},{minlength:"14",maxlength:"19",value:"Nauru (+674)"},{minlength:"14",maxlength:"19",value:"Papouasie-Nouvelle-Guin\u00e9e (+675)"},{minlength:"14",maxlength:"19",value:"Tonga (+676)"},{minlength:"14",maxlength:"19",value:"Salomon (+677)"},{minlength:"14",maxlength:"19",value:"Vanuatu (+678)"},{minlength:"14",maxlength:"19",
value:"Fidji (+679)"},{minlength:"14",maxlength:"19",value:"Palaos (+680)"},{minlength:"14",maxlength:"19",value:"Wallis-et-Futuna (+681)"},{minlength:"14",maxlength:"19",value:"\u00celes Cook (+682)"},{minlength:"14",maxlength:"19",value:"Niue (+683)"},{minlength:"14",maxlength:"19",value:"Samoa am\u00e9ricaines (+1684)"},{minlength:"14",maxlength:"19",value:"Samoa (+685)"},{minlength:"14",maxlength:"19",value:"Kiribati (+686)"},{minlength:"14",maxlength:"19",value:"Nouvelle-Cal\u00e9donie (+687)"},
{minlength:"14",maxlength:"19",value:"Tuvalu (+688)"},{minlength:"14",maxlength:"19",value:"Polyn\u00e9sie fran\u00e7aise (+689)"},{minlength:"14",maxlength:"19",value:"Tokelau (+690)"},{minlength:"14",maxlength:"19",value:"\u00c9tats f\u00e9d\u00e9r\u00e9s de Micron\u00e9sie (+691)"},{minlength:"14",maxlength:"19",value:"\u00celes Marshall (+692)"},{minlength:"14",maxlength:"19",value:"Kazakhstan (+7)"},{minlength:"14",maxlength:"19",value:"Russie (+7)"},{minlength:"14",maxlength:"19",value:"Japon (+81)"},
{minlength:"14",maxlength:"19",value:"Cor\u00e9e du Sud (+82)"},{minlength:"14",maxlength:"19",value:"Vi\u00eatnam (+84)"},{minlength:"14",maxlength:"19",value:"Cor\u00e9e du Nord (+850)"},{minlength:"14",maxlength:"19",value:"Hong Kong (+852)"},{minlength:"14",maxlength:"19",value:"Macao (+853)"},{minlength:"14",maxlength:"19",value:"Cambodge (+855)"},{minlength:"14",maxlength:"19",value:"Laos (+856)"},{minlength:"14",maxlength:"19",value:"Chine (+86)"},{minlength:"14",maxlength:"19",value:"Bangladesh (+880)"},
{minlength:"14",maxlength:"19",value:"Ta\u00efwan (+886)"},{minlength:"14",maxlength:"19",value:"Turquie (+90)"},{minlength:"14",maxlength:"19",value:"Inde (+91)"},{minlength:"14",maxlength:"19",value:"Pakistan (+92)"},{minlength:"14",maxlength:"19",value:"Afghanistan (+93)"},{minlength:"14",maxlength:"19",value:"Sri Lanka (+94)"},{minlength:"14",maxlength:"19",value:"Birmanie (+95)"},{minlength:"14",maxlength:"19",value:"Maldives (+960)"},{minlength:"14",maxlength:"19",value:"Liban (+961)"},{minlength:"14",
maxlength:"19",value:"Jordanie (+962)"},{minlength:"14",maxlength:"19",value:"Syrie (+963)"},{minlength:"14",maxlength:"19",value:"Irak (+964)"},{minlength:"14",maxlength:"19",value:"Kowe\u00eft (+965)"},{minlength:"14",maxlength:"19",value:"Arabie saoudite (+966)"},{minlength:"14",maxlength:"19",value:"Y\u00e9men (+967)"},{minlength:"14",maxlength:"19",value:"Oman (+968)"},{minlength:"14",maxlength:"19",value:"Palestine (+970)"},{minlength:"14",maxlength:"19",value:"\u00c9mirats arabes unis (+971)"},
{minlength:"14",maxlength:"19",value:"Isra\u00ebl (+972)"},{minlength:"14",maxlength:"19",value:"Bahre\u00efn (+973)"},{minlength:"14",maxlength:"19",value:"Qatar (+974)"},{minlength:"14",maxlength:"19",value:"Bhoutan (+975)"},{minlength:"14",maxlength:"19",value:"Mongolie (+976)"},{minlength:"14",maxlength:"19",value:"N\u00e9pal (+977)"},{minlength:"14",maxlength:"19",value:"Iran (+98)"},{minlength:"14",maxlength:"19",value:"Tadjikistan (+992)"},{minlength:"14",maxlength:"19",value:"Turkm\u00e9nistan (+993)"},
{minlength:"14",maxlength:"19",value:"Azerba\u00efdjan (+994)"},{minlength:"14",maxlength:"19",value:"G\u00e9orgie (+995)"},{minlength:"14",maxlength:"19",value:"Kirghizistan (+996)"}];var countrySelector=$("#"+NPC.BV._BV_FORMID).find("#country");indicatifList.sort(function(a,b){return a.value.toString().localeCompare(b.value)});indicatifList.forEach(function(option){var isActive=option.value==="France (+33)"?' class\x3d"active"':"";countrySelector.append('\x3coption data-minlength\x3d"'+option.minlength+
'" data-maxlength\x3d"'+option.maxlength+'" value\x3d"'+option.value+'"\x3e'+option.value+"\x3c/option\x3e");countrySelector.parent().find("ul").append('\x3cli select-value\x3d"'+option.value+'" role\x3d"bouton" '+isActive+' tabindex\x3d"-1"\x3e'+option.value+"\x3c/li\x3e")});countrySelector[0].value="France (+33)";countrySelector.parent().find(".npc-bv-selected")[0].innerText="France (+33)"}function initDatePickerAppointment(){var $birthdatepicker=$("#birthdateForm.js-appointmentCalendar");var $dayformdatepicker=
$("#dayForm.js-appointmentCalendar");var lang="fr";var natDays=["2017-11-30","2017-12-25","2018-01-01"];if($birthdatepicker.length){var disabledDates=[];for(var i=0;i<natDays.length;i++)disabledDates[i]=$.fn.datepicker.DPGlobal.formatDate(new Date(natDays[i]),$.fn.datepicker.dates[lang]["format"],lang);var startDate=new Date("01/01/1850"),endDate=new Date;$birthdatepicker.datepicker({language:lang,startView:2,startDate:startDate,endDate:endDate,autoclose:true})}if($dayformdatepicker.length)$dayformdatepicker.datepicker({todayBtn:"linked",
language:lang,startDate:new Date,autoclose:true,todayHighlight:true,datesDisabled:disabledDates,daysOfWeekDisabled:[0,1]})}function initFormTrigger(){$("#phonenumberForm").on("keypress change keyup",function(e){$(this).val(function(index,value){return value.replace(/\W/gi,"").replace(/(.{2})/g,"$1 ").trim()})});$("#country").on("change",function(){var selectedElement=$(this).find("option:selected");$("#phonenumberForm").attr("maxlength",$(selectedElement).data("maxlength")).attr("minlength",$(selectedElement).data("minlength")).val("")});
$("button[data-id\x3dcountry]").on("click",function(){$("#emailNewContainer .glyphicon").remove()});$(window).on("datePicker.init.appointment",function(){initDatePickerAppointment()})}function loadDataConnectedClient(){var modelData=NPC.BV.$_BV_WRAPPER.data("value").modelData;var informationsClient=modelData!=undefined&&modelData!==null?modelData.informationsClient:null;var nomClient="";var prenomClient="";var civiliteClient="";if(informationsClient!=null){var prenomsClient=informationsClient.firstNames;
if(prenomsClient!=null&&prenomsClient.length>0)prenomClient=prenomsClient.join(" ");var namesOfIndividualPerson=informationsClient.namesOfIndividualPerson;if(namesOfIndividualPerson!=null)if(namesOfIndividualPerson.usualName!=null&&namesOfIndividualPerson.usualName.trim()!="")nomClient=namesOfIndividualPerson.usualName;else if(namesOfIndividualPerson.marriedName!=null&&namesOfIndividualPerson.marriedName.trim()!="")nomClient=namesOfIndividualPerson.marriedName;else if(namesOfIndividualPerson.lastName!=
null&&namesOfIndividualPerson.lastName.trim()!="")nomClient=namesOfIndividualPerson.lastName;civiliteClient=informationsClient.titleLongLabel!=null?informationsClient.titleLongLabel:""}$("#lastname").val(nomClient);$("#firstname").val(prenomClient);if(NPC.utilisateur.email!=null)$("#emailForm").val(NPC.utilisateur.email);$("#civility option").each(function(){if(this.value===civiliteClient){$(this).prop("selected",true);$(this).parent().value=civiliteClient;$(this).parent().parent().find(".npc-bv-selected")[0].innerText=
civiliteClient}});$("#civility").change()}NPC.BV.FUNCTIONS.FORM.createFormTrigger=function(){$("#"+NPC.BV._BV_FORMID).on("submit",function(e){e.preventDefault();if(!NPC.user.isConnected){var boutonVertCaptchaElement=getBtnVertCaptcha();if(boutonVertCaptchaElement.length>0)boutonVertCaptchaElement.npcCaptcha("validate",function(){validateBvForm()});else validateBvForm()}else validateBvForm()});$("#phonenumberForm").on("input",function(){this.value=this.value.replace(/[^0-9]/g,"")})};NPC.BV.FUNCTIONS.FORM.initForm=
function(){NPC.BV.$_BV_CAPTCHA=$("#"+NPC.BV._BV_CAPTCHA);initBvIndicatif();loadDataConnectedClient();initSelectorBV();initFormTrigger();refreshCaptcha();loadCaptcha();$(window).trigger("datePicker.init.appointment");$("#"+NPC.BV._BV_FORMID).find("#birthdateForm").datepicker("refresh");$("#"+NPC.BV._BV_FORMID).find("#dayForm").datepicker("refresh")}}
function initOpenCloseBV(){NPC.BV.FUNCTIONS.OPENCLOSE={};function _setTriggerBVLoaded(){$(window).off("startBV.loaded").on("startBV.loaded",function(){$(window).trigger("open.bv")})}NPC.BV.FUNCTIONS.OPENCLOSE.ouvrirBoutonVert=function(){if(NPC.BV.isBoutonVertOpen)return;var numeroCR=NPC.idLiveCopyCaisse;_setTriggerBVLoaded();NPC.BV._BV_THEME={};NPC.BV.FUNCTIONS.setDefaultCardStatus();if(numeroCR!="master"&&numeroCR!="national"){NPC.BV.FUNCTIONS.InitBvData();$(window).trigger("startBV.loaded")}else if(numeroCR==
"master")NPC.BV.FUNCTIONS.manageBubblesMaster();else if(numeroCR=="national")$(window).trigger("startBV.loaded");if(!NPC.BV.$_BV_WRAPPER.data("value").erreurGpu)NPC.BV.FUNCTIONS.loadDefaultPanel()};NPC.BV.FUNCTIONS.OPENCLOSE.closeBV=function(){$(window).trigger("close.bv");NPC.layoutTriggerd=false;NPC.BV.ORIGIN[0].focus()};NPC.BV.FUNCTIONS.OPENCLOSE.onReady=function(){var cr=NPC.idLiveCopyCaisse;var boutonVertRequired=NPC.recupererCookie("ouvrirBoutonVert");var boutonVertRequiredModeCo=NPC.recupererCookie("ouvrirBoutonVertModeConnecte");
var parcoursRdvRequired=NPC.recupererCookie("boutonvertParcoursRdv");var parcoursEmailRequired=NPC.recupererCookie("boutonvertParcoursEmail");var parcoursStoreLocatorRequired=NPC.recupererCookie("boutonvertParcoursStorelocator");var isConnected=NPC.user!==null&&NPC.user!==undefined&&NPC.user.isConnected?NPC.user.isConnected:false;if(isConnected&&parcoursRdvRequired&&!NPC.puPriseRdvActivated){NPC.BV.FUNCTIONS.OPENCLOSE.ouvrirBoutonVert();NPC.BV.FUNCTIONS.loadChoicePanelRDV();NPC.supprimerCookie("boutonvertParcoursRdv")}else if(isConnected&&
parcoursRdvRequired&&NPC.puPriseRdvActivated){var marcheUser=NPC.utilisateur.libMarcheUtilisateur;if(marcheUser=="particulier"||marcheUser=="banque-privee"){NPC.affecterCookie("ouvrirBoutonVertModeConnecte",false);window.location.href="profil/banque-moi/prendre-un-rdv.html"}else{NPC.affecterCookie("ouvrirBoutonVertModeConnecte",false);window.location.href="profil/banque-vous/prendre-un-rdv.html"}NPC.supprimerCookie("boutonvertParcoursRdv")}else if(isConnected&&parcoursEmailRequired&&!NPC.puMessagerieSecuriseeActivated){NPC.BV.FUNCTIONS.OPENCLOSE.ouvrirBoutonVert();
NPC.BV.FUNCTIONS.loadChoicePanelEMAIL();NPC.supprimerCookie("boutonvertParcoursEmail")}else if(isConnected&&parcoursEmailRequired&&NPC.puMessagerieSecuriseeActivated){var marcheUser=NPC.utilisateur.libMarcheUtilisateur;if(marcheUser=="particulier"||marcheUser=="banque-privee"){NPC.affecterCookie("ouvrirBoutonVertModeConnecte",false);window.location.href="profil/banque-moi/messagerie/msecriture.html"}else{NPC.affecterCookie("ouvrirBoutonVertModeConnecte",false);window.location.href="profil/banque-vous/messagerie/msecriture.html"}NPC.supprimerCookie("boutonvertParcoursEmail")}else if(isConnected&&
boutonVertRequiredModeCo==="true"){NPC.BV.FUNCTIONS.OPENCLOSE.ouvrirBoutonVert();NPC.supprimerCookie("ouvrirBoutonVertModeConnecte");if(!localStorage.getItem("npcd"))localStorage.setItem("BVModeConnecteOuvert",true)}else if(cr!=undefined&&cr!=NPC.constantes.ID_CR_NATIONAL&&boutonVertRequired){NPC.BV.FUNCTIONS.OPENCLOSE.ouvrirBoutonVert();NPC.supprimerCookie("ouvrirBoutonVert")}else if(isConnected&&parcoursStoreLocatorRequired){NPC.BV.FUNCTIONS.OPENCLOSE.ouvrirBoutonVert();NPC.supprimerCookie("boutonvertParcoursStorelocator")}};
function openBvTrigger(){$(".Header-help--bouton-vert--trigger").on("click",function(){NPC.BV.ORIGIN=$(this);NPC.BV.FUNCTIONS.OPENCLOSE.ouvrirBoutonVert()});$(".bv-trigger-burger").on("click",function(e){e.preventDefault();$(window).trigger("close.layerNav");NPC.BV.ORIGIN=$(this);NPC.BV.FUNCTIONS.OPENCLOSE.ouvrirBoutonVert()});$(document).on("click",".openBV",function(){NPC.BV.ORIGIN=$(this);NPC.BV.FUNCTIONS.OPENCLOSE.ouvrirBoutonVert()});$(window).on("triggerBV",function(){NPC.BV.FUNCTIONS.OPENCLOSE.ouvrirBoutonVert()})}
function closeBvTrigger(){$(document).on("click","button.ficheAgence",function(){NPC.BV.FUNCTIONS.OPENCLOSE.closeBV()})}function isPhoneTablette(){return NPC&&NPC.informationNavigateur&&NPC.informationNavigateur.mobile}openBvTrigger();closeBvTrigger();$(document).on("click",".puPriseDeRdvActivated",function(e){if(isPhoneTablette()==false)NPC.affecterCookie("ouvrirBoutonVertModeConnecte",true)});$(document).on("click",".puMessagerieSecuriseeActivated",function(e){if(isPhoneTablette()==false)NPC.affecterCookie("ouvrirBoutonVertModeConnecte",
true)});$(document).on("click",".loginGreenBtn",function(){NPC.affecterCookie("ouvrirBoutonVertModeConnecte",true)});$(document).on("click",".js-bv-trigger-natioUrgence",function(){NPC.affecterCookie("ouvrirBoutonVert",true)});$(document).on("click","#lienConnexionClientAccesCompte",function(){switch(NPC.BV.CURRENT_PARCOUR.parcourName){case "parcoursRdv":NPC.affecterCookie("boutonvertParcoursRdv",true);break;case "parcoursEmail":NPC.affecterCookie("boutonvertParcoursEmail",true);break;case "storelocator":NPC.affecterCookie("boutonvertParcoursStorelocator",
true);break}});var scrollTopListQuery=[".js-storeLoc-agency",".GreenBtn-GMap-more",".GreenBtn-callbackHomeContentContactMail",".GreenBtn-callbackHomeContentContactMeeting","#rdv","#sendEmail",".TrouverNumeroAgenceLien","#sendEmailForm"];$(document).on("click",scrollTopListQuery.join(", "),function(){CommonNPC.scrollTo(0)})}
(function($){$.extend($.fn,{validate:function(options){if(!this.length){options&&options.debug&&window.console&&console.warn("nothing selected, can't validate, returning nothing");return}var validator=$.data(this[0],"validator");if(validator)return validator;this.attr("novalidate","novalidate");validator=new $.validator(options,this[0]);$.data(this[0],"validator",validator);if(validator.settings.onsubmit){var inputsAndButtons=this.find("input, button");inputsAndButtons.filter(".cancel").click(function(){validator.cancelSubmit=
true});if(validator.settings.submitHandler)inputsAndButtons.filter(":submit").click(function(){validator.submitButton=this});this.submit(function(event){if(validator.settings.debug)event.preventDefault();function handle(){if(validator.settings.submitHandler){if(validator.submitButton)var hidden=$("\x3cinput type\x3d'hidden'/\x3e").attr("name",validator.submitButton.name).val(validator.submitButton.value).appendTo(validator.currentForm);validator.settings.submitHandler.call(validator,validator.currentForm);
if(validator.submitButton)hidden.remove();return false}return true}if(validator.cancelSubmit){validator.cancelSubmit=false;return handle()}if(validator.form()){if(validator.pendingRequest){validator.formSubmitted=true;return false}return handle()}else{validator.focusInvalid();return false}})}return validator},valid:function(){if($(this[0]).is("form"))return this.validate().form();else{var valid=true;var validator=$(this[0].form).validate();this.each(function(){valid&=validator.element(this)});return valid}},
removeAttrs:function(attributes){var result={},$element=this;$.each(attributes.split(/\s/),function(index,value){result[value]=$element.attr(value);$element.removeAttr(value)});return result},rules:function(command,argument){var element=this[0];if(command){var settings=$.data(element.form,"validator").settings;var staticRules=settings.rules;var existingRules=$.validator.staticRules(element);switch(command){case "add":$.extend(existingRules,$.validator.normalizeRule(argument));staticRules[element.name]=
existingRules;if(argument.messages)settings.messages[element.name]=$.extend(settings.messages[element.name],argument.messages);break;case "remove":if(!argument){delete staticRules[element.name];return existingRules}var filtered={};$.each(argument.split(/\s/),function(index,method){filtered[method]=existingRules[method];delete existingRules[method]});return filtered}}var data=$.validator.normalizeRules($.extend({},$.validator.metadataRules(element),$.validator.classRules(element),$.validator.attributeRules(element),
$.validator.staticRules(element)),element);if(data.required){var param=data.required;delete data.required;data=$.extend({required:param},data)}return data}});$.extend($.expr[":"],{blank:function(a){return!$.trim(""+a.value)},filled:function(a){return!!$.trim(""+a.value)},unchecked:function(a){return!a.checked}});$.validator=function(options,form){this.settings=$.extend(true,{},$.validator.defaults,options);this.currentForm=form;this.init()};$.validator.format=function(source,params){if(arguments.length==
1)return function(){var args=$.makeArray(arguments);args.unshift(source);return $.validator.format.apply(this,args)};if(arguments.length>2&&params.constructor!=Array)params=$.makeArray(arguments).slice(1);if(params.constructor!=Array)params=[params];$.each(params,function(i,n){source=source.replace(new RegExp("\\{"+i+"\\}","g"),n)});return source};$.extend($.validator,{defaults:{messages:{},groups:{},rules:{},errorClass:"error",validClass:"valid",errorElement:"label",focusInvalid:true,errorContainer:$([]),
errorLabelContainer:$([]),onsubmit:true,ignore:":hidden",ignoreTitle:false,onfocusin:function(element,event){this.lastActive=element;if(this.settings.focusCleanup&&!this.blockFocusCleanup){this.settings.unhighlight&&this.settings.unhighlight.call(this,element,this.settings.errorClass,this.settings.validClass);this.addWrapper(this.errorsFor(element)).hide()}},onfocusout:function(element,event){if(!this.checkable(element)&&(element.name in this.submitted||!this.optional(element)))this.element(element)},
onkeyup:function(element,event){this.valid();this.element(element)},onclick:function(element,event){if(element.name in this.submitted)this.element(element);else if(element.parentNode.name in this.submitted)this.element(element.parentNode)},highlight:function(element,errorClass,validClass){if(element.type==="radio")this.findByName(element.name).addClass(errorClass).removeClass(validClass);else $(element).addClass(errorClass).removeClass(validClass)},unhighlight:function(element,errorClass,validClass){if(element.type===
"radio")this.findByName(element.name).removeClass(errorClass).addClass(validClass);else $(element).removeClass(errorClass).addClass(validClass)}},setDefaults:function(settings){$.extend($.validator.defaults,settings)},messages:{required:"This field is required.",remote:"Please fix this field.",email:"Please enter a valid email address.",url:"Please enter a valid URL.",date:"Please enter a valid date.",dateISO:"Please enter a valid date (ISO).",number:"Please enter a valid number.",digits:"Please enter only digits.",
creditcard:"Please enter a valid credit card number.",equalTo:"Please enter the same value again.",accept:"Please enter a value with a valid extension.",maxlength:$.validator.format("Please enter no more than {0} characters."),minlength:$.validator.format("Please enter at least {0} characters."),rangelength:$.validator.format("Please enter a value between {0} and {1} characters long."),range:$.validator.format("Please enter a value between {0} and {1}."),max:$.validator.format("Please enter a value less than or equal to {0}."),
min:$.validator.format("Please enter a value greater than or equal to {0}.")},autoCreateRanges:false,prototype:{init:function(){this.labelContainer=$(this.settings.errorLabelContainer);this.errorContext=this.labelContainer.length&&this.labelContainer||$(this.currentForm);this.containers=$(this.settings.errorContainer).add(this.settings.errorLabelContainer);this.submitted={};this.valueCache={};this.pendingRequest=0;this.pending={};this.invalid={};this.reset();var groups=this.groups={};$.each(this.settings.groups,
function(key,value){$.each(value.split(/\s/),function(index,name){groups[name]=key})});var rules=this.settings.rules;$.each(rules,function(key,value){rules[key]=$.validator.normalizeRule(value)});function delegate(event){var validator=$.data(this[0].form,"validator"),eventType="on"+event.type.replace(/^validate/,"");validator.settings[eventType]&&validator.settings[eventType].call(validator,this[0],event)}$(this.currentForm).validateDelegate("[type\x3d'text'], [type\x3d'password'], [type\x3d'file'], select, textarea, "+
"[type\x3d'number'], [type\x3d'search'] ,[type\x3d'tel'], [type\x3d'url'], "+"[type\x3d'email'], [type\x3d'datetime'], [type\x3d'date'], [type\x3d'month'], "+"[type\x3d'week'], [type\x3d'time'], [type\x3d'datetime-local'], "+"[type\x3d'range'], [type\x3d'color'] ","focusin focusout keyup",delegate).validateDelegate("[type\x3d'radio'], [type\x3d'checkbox'], select, option","click",delegate);if(this.settings.invalidHandler)$(this.currentForm).bind("invalid-form.validate",this.settings.invalidHandler)},
form:function(){this.checkForm();$.extend(this.submitted,this.errorMap);this.invalid=$.extend({},this.errorMap);if(!this.valid())$(this.currentForm).triggerHandler("invalid-form",[this]);this.showErrors();return this.valid()},checkForm:function(){this.prepareForm();for(var i=0,elements=this.currentElements=this.elements();elements[i];i++)this.check(elements[i]);return this.valid()},element:function(element){element=this.validationTargetFor(this.clean(element));this.lastElement=element;this.prepareElement(element);
this.currentElements=$(element);var result=this.check(element);if(result)delete this.invalid[element.name];else this.invalid[element.name]=true;if(!this.numberOfInvalids())this.toHide=this.toHide.add(this.containers);this.showErrors();return result},showErrors:function(errors){if(errors){$.extend(this.errorMap,errors);this.errorList=[];for(var name in errors)this.errorList.push({message:errors[name],element:this.findByName(name)[0]});this.successList=$.grep(this.successList,function(element){return!(element.name in
errors)})}this.settings.showErrors?this.settings.showErrors.call(this,this.errorMap,this.errorList):this.defaultShowErrors()},resetForm:function(){if($.fn.resetForm)$(this.currentForm).resetForm();this.submitted={};this.lastElement=null;this.prepareForm();this.hideErrors();this.elements().removeClass(this.settings.errorClass)},numberOfInvalids:function(){return this.objectLength(this.invalid)},objectLength:function(obj){var count=0;for(var i in obj)count++;return count},hideErrors:function(){this.addWrapper(this.toHide).hide()},
valid:function(){return this.size()==0},size:function(){return this.errorList.length},focusInvalid:function(){if(this.settings.focusInvalid)try{$(this.findLastActive()||this.errorList.length&&this.errorList[0].element||[]).filter(":visible").focus().trigger("focusin")}catch(e){}},findLastActive:function(){var lastActive=this.lastActive;return lastActive&&$.grep(this.errorList,function(n){return n.element.name==lastActive.name}).length==1&&lastActive},elements:function(){var validator=this,rulesCache=
{};return $(this.currentForm).find("input, select, textarea").not(":submit, :reset, :image, [disabled]").not(this.settings.ignore).filter(function(){!this.name&&validator.settings.debug&&window.console&&console.error("%o has no name assigned",this);if(this.name in rulesCache||!validator.objectLength($(this).rules()))return false;rulesCache[this.name]=true;return true})},clean:function(selector){return $(selector)[0]},errors:function(){return $(this.settings.errorElement+"."+this.settings.errorClass,
this.errorContext)},reset:function(){this.successList=[];this.errorList=[];this.errorMap={};this.toShow=$([]);this.toHide=$([]);this.currentElements=$([])},prepareForm:function(){this.reset();this.toHide=this.errors().add(this.containers)},prepareElement:function(element){this.reset();this.toHide=this.errorsFor(element)},check:function(element){element=this.validationTargetFor(this.clean(element));var rules=$(element).rules();var dependencyMismatch=false;for(var method in rules){var rule={method:method,
parameters:rules[method]};try{var result=$.validator.methods[method].call(this,element.value.replace(/\r/g,""),element,rule.parameters);if(result=="dependency-mismatch"){dependencyMismatch=true;continue}dependencyMismatch=false;if(result=="pending"){this.toHide=this.toHide.not(this.errorsFor(element));return}if(!result){this.formatAndAdd(element,rule);return false}}catch(e){this.settings.debug&&window.console&&console.log("exception occured when checking element "+element.id+", check the '"+rule.method+
"' method",e);throw e;}}if(dependencyMismatch)return;if(this.objectLength(rules))this.successList.push(element);return true},customMetaMessage:function(element,method){if(!$.metadata)return;var meta=this.settings.meta?$(element).metadata()[this.settings.meta]:$(element).metadata();return meta&&meta.messages&&meta.messages[method]},customMessage:function(name,method){var m=this.settings.messages[name];return m&&(m.constructor==String?m:m[method])},findDefined:function(){for(var i=0;i<arguments.length;i++)if(arguments[i]!==
undefined)return arguments[i];return undefined},defaultMessage:function(element,method){return this.findDefined(this.customMessage(element.name,method),this.customMetaMessage(element,method),!this.settings.ignoreTitle&&element.title||undefined,$.validator.messages[method],"\x3cstrong\x3eWarning: No message defined for "+element.name+"\x3c/strong\x3e")},formatAndAdd:function(element,rule){var message=this.defaultMessage(element,rule.method),theregex=/\$?\{(\d+)\}/g;if(typeof message=="function")message=
message.call(this,rule.parameters,element);else if(theregex.test(message))message=jQuery.format(message.replace(theregex,"{$1}"),rule.parameters);this.errorList.push({message:message,element:element});this.errorMap[element.name]=message;this.submitted[element.name]=message},addWrapper:function(toToggle){if(this.settings.wrapper)toToggle=toToggle.add(toToggle.parent(this.settings.wrapper));return toToggle},defaultShowErrors:function(){for(var i=0;this.errorList[i];i++){var error=this.errorList[i];
this.settings.highlight&&this.settings.highlight.call(this,error.element,this.settings.errorClass,this.settings.validClass);this.showLabel(error.element,error.message)}if(this.errorList.length)this.toShow=this.toShow.add(this.containers);if(this.settings.success)for(var i=0;this.successList[i];i++)this.showLabel(this.successList[i]);if(this.settings.unhighlight)for(var i=0,elements=this.validElements();elements[i];i++)this.settings.unhighlight.call(this,elements[i],this.settings.errorClass,this.settings.validClass);
this.toHide=this.toHide.not(this.toShow);this.hideErrors();this.addWrapper(this.toShow).show()},validElements:function(){return this.currentElements.not(this.invalidElements())},invalidElements:function(){return $(this.errorList).map(function(){return this.element})},showLabel:function(element,message){var label=this.errorsFor(element);if(label.length){label.removeClass(this.settings.validClass).addClass(this.settings.errorClass);label.attr("generated")&&label.html(message)}else{label=$("\x3c"+this.settings.errorElement+
"/\x3e").attr({"for":this.idOrName(element),generated:true}).addClass(this.settings.errorClass).html(message||"");if(this.settings.wrapper)label=label.hide().show().wrap("\x3c"+this.settings.wrapper+"/\x3e").parent();if(!this.labelContainer.append(label).length)this.settings.errorPlacement?this.settings.errorPlacement(label,$(element)):label.insertAfter(element)}if(!message&&this.settings.success){label.text("");typeof this.settings.success=="string"?label.addClass(this.settings.success):this.settings.success(label)}this.toShow=
this.toShow.add(label)},errorsFor:function(element){var name=this.idOrName(element);return this.errors().filter(function(){return $(this).attr("for")==name})},idOrName:function(element){return this.groups[element.name]||(this.checkable(element)?element.name:element.id||element.name)},validationTargetFor:function(element){if(this.checkable(element))element=this.findByName(element.name).not(this.settings.ignore)[0];return element},checkable:function(element){return/radio|checkbox/i.test(element.type)},
findByName:function(name){var form=this.currentForm;return $(document.getElementsByName(name)).map(function(index,element){return element.form==form&&element.name==name&&element||null})},getLength:function(value,element){switch(element.nodeName.toLowerCase()){case "select":return $("option:selected",element).length;case "input":if(this.checkable(element))return this.findByName(element.name).filter(":checked").length}return value.length},depend:function(param,element){return this.dependTypes[typeof param]?
this.dependTypes[typeof param](param,element):true},dependTypes:{"boolean":function(param,element){return param},"string":function(param,element){return!!$(param,element.form).length},"function":function(param,element){return param(element)}},optional:function(element){return!$.validator.methods.required.call(this,$.trim(element.value),element)&&"dependency-mismatch"},startRequest:function(element){if(!this.pending[element.name]){this.pendingRequest++;this.pending[element.name]=true}},stopRequest:function(element,
valid){this.pendingRequest--;if(this.pendingRequest<0)this.pendingRequest=0;delete this.pending[element.name];if(valid&&this.pendingRequest==0&&this.formSubmitted&&this.form()){$(this.currentForm).submit();this.formSubmitted=false}else if(!valid&&this.pendingRequest==0&&this.formSubmitted){$(this.currentForm).triggerHandler("invalid-form",[this]);this.formSubmitted=false}},previousValue:function(element){return $.data(element,"previousValue")||$.data(element,"previousValue",{old:null,valid:true,message:this.defaultMessage(element,
"remote")})}},classRuleSettings:{required:{required:true},email:{email:true},url:{url:true},date:{date:true},dateISO:{dateISO:true},dateDE:{dateDE:true},number:{number:true},numberDE:{numberDE:true},digits:{digits:true},creditcard:{creditcard:true}},addClassRules:function(className,rules){className.constructor==String?this.classRuleSettings[className]=rules:$.extend(this.classRuleSettings,className)},classRules:function(element){var rules={};var classes=$(element).attr("class");classes&&$.each(classes.split(" "),
function(){if(this in $.validator.classRuleSettings)$.extend(rules,$.validator.classRuleSettings[this])});return rules},attributeRules:function(element){var rules={};var $element=$(element);for(var method in $.validator.methods){var value;if(method==="required"&&typeof $.fn.prop==="function")value=$element.prop(method);else value=$element.attr(method);if(value)rules[method]=value;else if($element[0].getAttribute("type")===method)rules[method]=true}if(rules.maxlength&&/-1|2147483647|524288/.test(rules.maxlength))delete rules.maxlength;
return rules},metadataRules:function(element){if(!$.metadata)return{};var meta=$.data(element.form,"validator").settings.meta;return meta?$(element).metadata()[meta]:$(element).metadata()},staticRules:function(element){var rules={};var validator=$.data(element.form,"validator");if(validator.settings.rules)rules=$.validator.normalizeRule(validator.settings.rules[element.name])||{};return rules},normalizeRules:function(rules,element){$.each(rules,function(prop,val){if(val===false){delete rules[prop];
return}if(val.param||val.depends){var keepRule=true;switch(typeof val.depends){case "string":keepRule=!!$(val.depends,element.form).length;break;case "function":keepRule=val.depends.call(element,element);break}if(keepRule)rules[prop]=val.param!==undefined?val.param:true;else delete rules[prop]}});$.each(rules,function(rule,parameter){rules[rule]=$.isFunction(parameter)?parameter(element):parameter});$.each(["minlength","maxlength","min","max"],function(){if(rules[this])rules[this]=Number(rules[this])});
$.each(["rangelength","range"],function(){if(rules[this])rules[this]=[Number(rules[this][0]),Number(rules[this][1])]});if($.validator.autoCreateRanges){if(rules.min&&rules.max){rules.range=[rules.min,rules.max];delete rules.min;delete rules.max}if(rules.minlength&&rules.maxlength){rules.rangelength=[rules.minlength,rules.maxlength];delete rules.minlength;delete rules.maxlength}}if(rules.messages)delete rules.messages;return rules},normalizeRule:function(data){if(typeof data=="string"){var transformed=
{};$.each(data.split(/\s/),function(){transformed[this]=true});data=transformed}return data},addMethod:function(name,method,message){$.validator.methods[name]=method;$.validator.messages[name]=message!=undefined?message:$.validator.messages[name];if(method.length<3)$.validator.addClassRules(name,$.validator.normalizeRule(name))},methods:{required:function(value,element,param){if(!this.depend(param,element))return"dependency-mismatch";switch(element.nodeName.toLowerCase()){case "select":var val=$(element).val();
return val&&val.length>0;case "input":if(this.checkable(element))return this.getLength(value,element)>0;default:return $.trim(value).length>0}},remote:function(value,element,param){if(this.optional(element))return"dependency-mismatch";var previous=this.previousValue(element);if(!this.settings.messages[element.name])this.settings.messages[element.name]={};previous.originalMessage=this.settings.messages[element.name].remote;this.settings.messages[element.name].remote=previous.message;param=typeof param==
"string"&&{url:param}||param;if(this.pending[element.name])return"pending";if(previous.old===value)return previous.valid;previous.old=value;var validator=this;this.startRequest(element);var data={};data[element.name]=value;$.ajax($.extend(true,{url:param,mode:"abort",port:"validate"+element.name,dataType:"json",data:data,success:function(response){validator.settings.messages[element.name].remote=previous.originalMessage;var valid=response===true;if(valid){var submitted=validator.formSubmitted;validator.prepareElement(element);
validator.formSubmitted=submitted;validator.successList.push(element);validator.showErrors()}else{var errors={};var message=response||validator.defaultMessage(element,"remote");errors[element.name]=previous.message=$.isFunction(message)?message(value):message;validator.showErrors(errors)}previous.valid=valid;validator.stopRequest(element,valid)}},param));return"pending"},minlength:function(value,element,param){return this.optional(element)||this.getLength($.trim(value),element)>=param},maxlength:function(value,
element,param){return this.optional(element)||this.getLength($.trim(value),element)<=param},rangelength:function(value,element,param){var length=this.getLength($.trim(value),element);return this.optional(element)||length>=param[0]&&length<=param[1]},min:function(value,element,param){return this.optional(element)||value>=param},max:function(value,element,param){return this.optional(element)||value<=param},range:function(value,element,param){return this.optional(element)||value>=param[0]&&value<=param[1]},
email:function(value,element){return this.optional(element)||/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))$/i.test(value)},
url:function(value,element){return this.optional(element)||/^(https?|ftp):\/\/(((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:)*@)?(((\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5]))|((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?)(:\d*)?)(\/((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)+(\/(([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)*)*)?)?(\?((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|[\uE000-\uF8FF]|\/|\?)*)?(#((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|\/|\?)*)?$/i.test(value)},
date:function(value,element){return this.optional(element)||!/Invalid|NaN/.test(new Date(value))},dateISO:function(value,element){return this.optional(element)||/^\d{4}[\/-]\d{1,2}[\/-]\d{1,2}$/.test(value)},number:function(value,element){return this.optional(element)||/^-?(?:\d+|\d{1,3}(?:,\d{3})+)(?:\.\d+)?$/.test(value)},digits:function(value,element){return this.optional(element)||/^\d+$/.test(value)},creditcard:function(value,element){if(this.optional(element))return"dependency-mismatch";if(/[^0-9 -]+/.test(value))return false;
var nCheck=0,nDigit=0,bEven=false;value=value.replace(/\D/g,"");for(var n=value.length-1;n>=0;n--){var cDigit=value.charAt(n);var nDigit=parseInt(cDigit,10);if(bEven)if((nDigit*=2)>9)nDigit-=9;nCheck+=nDigit;bEven=!bEven}return nCheck%10==0},accept:function(value,element,param){param=typeof param=="string"?param.replace(/,/g,"|"):"png|jpe?g|gif";return this.optional(element)||value.match(new RegExp(".("+param+")$","i"))},equalTo:function(value,element,param){var target=$(param).unbind(".validate-equalTo").bind("blur.validate-equalTo",
function(){$(element).valid()});return value==target.val()}}});$.format=$.validator.format})(jQuery);
(function($){var pendingRequests={};if($.ajaxPrefilter)$.ajaxPrefilter(function(settings,_,xhr){var port=settings.port;if(settings.mode=="abort"){if(pendingRequests[port])pendingRequests[port].abort();pendingRequests[port]=xhr}});else{var ajax=$.ajax;$.ajax=function(settings){var mode=("mode"in settings?settings:$.ajaxSettings).mode,port=("port"in settings?settings:$.ajaxSettings).port;if(mode=="abort"){if(pendingRequests[port])pendingRequests[port].abort();return pendingRequests[port]=ajax.apply(this,
arguments)}return ajax.apply(this,arguments)}}})(jQuery);
(function($){if(!jQuery.event.special.focusin&&!jQuery.event.special.focusout&&document.addEventListener)$.each({focus:"focusin",blur:"focusout"},function(original,fix){$.event.special[fix]={setup:function(){this.addEventListener(original,handler,true)},teardown:function(){this.removeEventListener(original,handler,true)},handler:function(e){arguments[0]=$.event.fix(e);arguments[0].type=fix;return $.event.handle.apply(this,arguments)}};function handler(e){e=$.event.fix(e);e.type=fix;return $.event.handle.call(this,
e)}});$.extend($.fn,{validateDelegate:function(delegate,type,handler){return this.bind(type,function(event){var target=$(event.target);if(target.is(delegate))return handler.apply(target,arguments)})}})})(jQuery);
(function(factory){if(typeof define==="function"&&define.amd)define(["jquery","./jquery.validate"],factory);else if(typeof module==="object"&&module.exports)module.exports=factory(require("jquery"));else factory(jQuery)})(function($){(function(){function stripHtml(value){return value.replace(/<.[^<>]*?>/g," ").replace(/&nbsp;|&#160;/gi," ").replace(/[.(),;:!?%#$'"_+=\/\-\u00e2\u20ac\u0153\u00e2\u20ac\u009d\u00e2\u20ac\u2122]*/g,"")}$.validator.addMethod("maxWords",function(value,element,params){return this.optional(element)||
stripHtml(value).match(/\b\w+\b/g).length<=params},$.validator.format("Please enter {0} words or less."));$.validator.addMethod("minWords",function(value,element,params){return this.optional(element)||stripHtml(value).match(/\b\w+\b/g).length>=params},$.validator.format("Please enter at least {0} words."));$.validator.addMethod("rangeWords",function(value,element,params){var valueStripped=stripHtml(value),regex=/\b\w+\b/g;return this.optional(element)||valueStripped.match(regex).length>=params[0]&&
valueStripped.match(regex).length<=params[1]},$.validator.format("Please enter between {0} and {1} words."))})();$.validator.addMethod("accept",function(value,element,param){var typeParam=typeof param==="string"?param.replace(/\s/g,""):"image/*",optionalValue=this.optional(element),i,file,regex;if(optionalValue)return optionalValue;if($(element).attr("type")==="file"){typeParam=typeParam.replace(/[\-\[\]\/\{\}\(\)\+\?\.\\\^\$\|]/g,"\\$\x26").replace(/,/g,"|").replace(/\/\*/g,"/.*");if(element.files&&
element.files.length){regex=new RegExp(".?("+typeParam+")$","i");for(i=0;i<element.files.length;i++){file=element.files[i];if(!file.type.match(regex))return false}}}return true},$.validator.format("Please enter a value with a valid mimetype."));$.validator.addMethod("alphanumeric",function(value,element){return this.optional(element)||/^\w+$/i.test(value)},"Letters, numbers, and underscores only please");$.validator.addMethod("bankaccountNL",function(value,element){if(this.optional(element))return true;
if(!/^[0-9]{9}|([0-9]{2} ){3}[0-9]{3}$/.test(value))return false;var account=value.replace(/ /g,""),sum=0,len=account.length,pos,factor,digit;for(pos=0;pos<len;pos++){factor=len-pos;digit=account.substring(pos,pos+1);sum=sum+factor*digit}return sum%11===0},"Please specify a valid bank account number");$.validator.addMethod("bankorgiroaccountNL",function(value,element){return this.optional(element)||$.validator.methods.bankaccountNL.call(this,value,element)||$.validator.methods.giroaccountNL.call(this,
value,element)},"Please specify a valid bank or giro account number");$.validator.addMethod("bic",function(value,element){return this.optional(element)||/^([A-Z]{6}[A-Z2-9][A-NP-Z1-9])(X{3}|[A-WY-Z0-9][A-Z0-9]{2})?$/.test(value.toUpperCase())},"Please specify a valid BIC code");$.validator.addMethod("cifES",function(value){var cifRegEx=new RegExp(/^([ABCDEFGHJKLMNPQRSUVW])(\d{7})([0-9A-J])$/gi);var letter=value.substring(0,1),number=value.substring(1,8),control=value.substring(8,9),all_sum=0,even_sum=
0,odd_sum=0,i,n,control_digit,control_letter;function isOdd(n){return n%2===0}if(value.length!==9||!cifRegEx.test(value))return false;for(i=0;i<number.length;i++){n=parseInt(number[i],10);if(isOdd(i)){n*=2;odd_sum+=n<10?n:n-9}else even_sum+=n}all_sum=even_sum+odd_sum;control_digit=(10-all_sum.toString().substr(-1)).toString();control_digit=parseInt(control_digit,10)>9?"0":control_digit;control_letter="JABCDEFGHI".substr(control_digit,1).toString();if(letter.match(/[ABEH]/))return control===control_digit;
else if(letter.match(/[KPQS]/))return control===control_letter;else return control===control_digit||control===control_letter;return false},"Please specify a valid CIF number.");$.validator.addMethod("cpfBR",function(value){value=value.replace(/([~!@#$%^&*()_+=`{}\[\]\-|\\:;'<>,.\/? ])+/g,"");if(value.length!==11)return false;var sum=0,firstCN,secondCN,checkResult,i;firstCN=parseInt(value.substring(9,10),10);secondCN=parseInt(value.substring(10,11),10);checkResult=function(sum,cn){var result=sum*10%
11;if(result===10||result===11)result=0;return result===cn};if(value===""||value==="00000000000"||value==="11111111111"||value==="22222222222"||value==="33333333333"||value==="44444444444"||value==="55555555555"||value==="66666666666"||value==="77777777777"||value==="88888888888"||value==="99999999999")return false;for(i=1;i<=9;i++)sum=sum+parseInt(value.substring(i-1,i),10)*(11-i);if(checkResult(sum,firstCN)){sum=0;for(i=1;i<=10;i++)sum=sum+parseInt(value.substring(i-1,i),10)*(12-i);return checkResult(sum,
secondCN)}return false},"Please specify a valid CPF number");$.validator.addMethod("creditcard",function(value,element){if(this.optional(element))return"dependency-mismatch";if(/[^0-9 \-]+/.test(value))return false;var nCheck=0,nDigit=0,bEven=false,n,cDigit;value=value.replace(/\D/g,"");if(value.length<13||value.length>19)return false;for(n=value.length-1;n>=0;n--){cDigit=value.charAt(n);nDigit=parseInt(cDigit,10);if(bEven)if((nDigit*=2)>9)nDigit-=9;nCheck+=nDigit;bEven=!bEven}return nCheck%10===
0},"Please enter a valid credit card number.");$.validator.addMethod("creditcardtypes",function(value,element,param){if(/[^0-9\-]+/.test(value))return false;value=value.replace(/\D/g,"");var validTypes=0;if(param.mastercard)validTypes|=1;if(param.visa)validTypes|=2;if(param.amex)validTypes|=4;if(param.dinersclub)validTypes|=8;if(param.enroute)validTypes|=16;if(param.discover)validTypes|=32;if(param.jcb)validTypes|=64;if(param.unknown)validTypes|=128;if(param.all)validTypes=1|2|4|8|16|32|64|128;if(validTypes&
1&&/^(5[12345])/.test(value))return value.length===16;if(validTypes&2&&/^(4)/.test(value))return value.length===16;if(validTypes&4&&/^(3[47])/.test(value))return value.length===15;if(validTypes&8&&/^(3(0[012345]|[68]))/.test(value))return value.length===14;if(validTypes&16&&/^(2(014|149))/.test(value))return value.length===15;if(validTypes&32&&/^(6011)/.test(value))return value.length===16;if(validTypes&64&&/^(3)/.test(value))return value.length===16;if(validTypes&64&&/^(2131|1800)/.test(value))return value.length===
15;if(validTypes&128)return true;return false},"Please enter a valid credit card number.");$.validator.addMethod("currency",function(value,element,param){var isParamString=typeof param==="string",symbol=isParamString?param:param[0],soft=isParamString?true:param[1],regex;symbol=symbol.replace(/,/g,"");symbol=soft?symbol+"]":symbol+"]?";regex="^["+symbol+"([1-9]{1}[0-9]{0,2}(\\,[0-9]{3})*(\\.[0-9]{0,2})?|[1-9]{1}[0-9]{0,}(\\.[0-9]{0,2})?|0(\\.[0-9]{0,2})?|(\\.[0-9]{1,2})?)$";regex=new RegExp(regex);
return this.optional(element)||regex.test(value)},"Please specify a valid currency");$.validator.addMethod("dateFA",function(value,element){return this.optional(element)||/^[1-4]\d{3}\/((0?[1-6]\/((3[0-1])|([1-2][0-9])|(0?[1-9])))|((1[0-2]|(0?[7-9]))\/(30|([1-2][0-9])|(0?[1-9]))))$/.test(value)},$.validator.messages.date);$.validator.addMethod("dateITA",function(value,element){var check=false,re=/^\d{1,2}\/\d{1,2}\/\d{4}$/,adata,gg,mm,aaaa,xdata;if(re.test(value)){adata=value.split("/");gg=parseInt(adata[0],
10);mm=parseInt(adata[1],10);aaaa=parseInt(adata[2],10);xdata=new Date(Date.UTC(aaaa,mm-1,gg,12,0,0,0));if(xdata.getUTCFullYear()===aaaa&&xdata.getUTCMonth()===mm-1&&xdata.getUTCDate()===gg)check=true;else check=false}else check=false;return this.optional(element)||check},$.validator.messages.date);$.validator.addMethod("dateNL",function(value,element){return this.optional(element)||/^(0?[1-9]|[12]\d|3[01])[\.\/\-](0?[1-9]|1[012])[\.\/\-]([12]\d)?(\d\d)$/.test(value)},$.validator.messages.date);$.validator.addMethod("extension",
function(value,element,param){param=typeof param==="string"?param.replace(/,/g,"|"):"png|jpe?g|gif";return this.optional(element)||value.match(new RegExp("\\.("+param+")$","i"))},$.validator.format("Please enter a value with a valid extension."));$.validator.addMethod("giroaccountNL",function(value,element){return this.optional(element)||/^[0-9]{1,7}$/.test(value)},"Please specify a valid giro account number");$.validator.addMethod("iban",function(value,element){if(this.optional(element))return true;
var iban=value.replace(/ /g,"").toUpperCase(),ibancheckdigits="",leadingZeroes=true,cRest="",cOperator="",countrycode,ibancheck,charAt,cChar,bbanpattern,bbancountrypatterns,ibanregexp,i,p;var minimalIBANlength=5;if(iban.length<minimalIBANlength)return false;countrycode=iban.substring(0,2);bbancountrypatterns={"AL":"\\d{8}[\\dA-Z]{16}","AD":"\\d{8}[\\dA-Z]{12}","AT":"\\d{16}","AZ":"[\\dA-Z]{4}\\d{20}","BE":"\\d{12}","BH":"[A-Z]{4}[\\dA-Z]{14}","BA":"\\d{16}","BR":"\\d{23}[A-Z][\\dA-Z]","BG":"[A-Z]{4}\\d{6}[\\dA-Z]{8}",
"CR":"\\d{17}","HR":"\\d{17}","CY":"\\d{8}[\\dA-Z]{16}","CZ":"\\d{20}","DK":"\\d{14}","DO":"[A-Z]{4}\\d{20}","EE":"\\d{16}","FO":"\\d{14}","FI":"\\d{14}","FR":"\\d{10}[\\dA-Z]{11}\\d{2}","GE":"[\\dA-Z]{2}\\d{16}","DE":"\\d{18}","GI":"[A-Z]{4}[\\dA-Z]{15}","GR":"\\d{7}[\\dA-Z]{16}","GL":"\\d{14}","GT":"[\\dA-Z]{4}[\\dA-Z]{20}","HU":"\\d{24}","IS":"\\d{22}","IE":"[\\dA-Z]{4}\\d{14}","IL":"\\d{19}","IT":"[A-Z]\\d{10}[\\dA-Z]{12}","KZ":"\\d{3}[\\dA-Z]{13}","KW":"[A-Z]{4}[\\dA-Z]{22}","LV":"[A-Z]{4}[\\dA-Z]{13}",
"LB":"\\d{4}[\\dA-Z]{20}","LI":"\\d{5}[\\dA-Z]{12}","LT":"\\d{16}","LU":"\\d{3}[\\dA-Z]{13}","MK":"\\d{3}[\\dA-Z]{10}\\d{2}","MT":"[A-Z]{4}\\d{5}[\\dA-Z]{18}","MR":"\\d{23}","MU":"[A-Z]{4}\\d{19}[A-Z]{3}","MC":"\\d{10}[\\dA-Z]{11}\\d{2}","MD":"[\\dA-Z]{2}\\d{18}","ME":"\\d{18}","NL":"[A-Z]{4}\\d{10}","NO":"\\d{11}","PK":"[\\dA-Z]{4}\\d{16}","PS":"[\\dA-Z]{4}\\d{21}","PL":"\\d{24}","PT":"\\d{21}","RO":"[A-Z]{4}[\\dA-Z]{16}","SM":"[A-Z]\\d{10}[\\dA-Z]{12}","SA":"\\d{2}[\\dA-Z]{18}","RS":"\\d{18}","SK":"\\d{20}",
"SI":"\\d{15}","ES":"\\d{20}","SE":"\\d{20}","CH":"\\d{5}[\\dA-Z]{12}","TN":"\\d{20}","TR":"\\d{5}[\\dA-Z]{17}","AE":"\\d{3}\\d{16}","GB":"[A-Z]{4}\\d{14}","VG":"[\\dA-Z]{4}\\d{16}"};bbanpattern=bbancountrypatterns[countrycode];if(typeof bbanpattern!=="undefined"){ibanregexp=new RegExp("^[A-Z]{2}\\d{2}"+bbanpattern+"$","");if(!ibanregexp.test(iban))return false}ibancheck=iban.substring(4,iban.length)+iban.substring(0,4);for(i=0;i<ibancheck.length;i++){charAt=ibancheck.charAt(i);if(charAt!=="0")leadingZeroes=
false;if(!leadingZeroes)ibancheckdigits+="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ".indexOf(charAt)}for(p=0;p<ibancheckdigits.length;p++){cChar=ibancheckdigits.charAt(p);cOperator=""+cRest+""+cChar;cRest=cOperator%97}return cRest===1},"Please specify a valid IBAN");$.validator.addMethod("integer",function(value,element){return this.optional(element)||/^-?\d+$/.test(value)},"A positive or negative non-decimal number please");$.validator.addMethod("ipv4",function(value,element){return this.optional(element)||
/^(25[0-5]|2[0-4]\d|[01]?\d\d?)\.(25[0-5]|2[0-4]\d|[01]?\d\d?)\.(25[0-5]|2[0-4]\d|[01]?\d\d?)\.(25[0-5]|2[0-4]\d|[01]?\d\d?)$/i.test(value)},"Please enter a valid IP v4 address.");$.validator.addMethod("ipv6",function(value,element){return this.optional(element)||/^((([0-9A-Fa-f]{1,4}:){7}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){6}:[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){5}:([0-9A-Fa-f]{1,4}:)?[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){4}:([0-9A-Fa-f]{1,4}:){0,2}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){3}:([0-9A-Fa-f]{1,4}:){0,3}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){2}:([0-9A-Fa-f]{1,4}:){0,4}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){6}((\b((25[0-5])|(1\d{2})|(2[0-4]\d)|(\d{1,2}))\b)\.){3}(\b((25[0-5])|(1\d{2})|(2[0-4]\d)|(\d{1,2}))\b))|(([0-9A-Fa-f]{1,4}:){0,5}:((\b((25[0-5])|(1\d{2})|(2[0-4]\d)|(\d{1,2}))\b)\.){3}(\b((25[0-5])|(1\d{2})|(2[0-4]\d)|(\d{1,2}))\b))|(::([0-9A-Fa-f]{1,4}:){0,5}((\b((25[0-5])|(1\d{2})|(2[0-4]\d)|(\d{1,2}))\b)\.){3}(\b((25[0-5])|(1\d{2})|(2[0-4]\d)|(\d{1,2}))\b))|([0-9A-Fa-f]{1,4}::([0-9A-Fa-f]{1,4}:){0,5}[0-9A-Fa-f]{1,4})|(::([0-9A-Fa-f]{1,4}:){0,6}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){1,7}:))$/i.test(value)},
"Please enter a valid IP v6 address.");$.validator.addMethod("lettersonly",function(value,element){return this.optional(element)||/^[a-z]+$/i.test(value)},"Letters only please");$.validator.addMethod("letterswithbasicpunc",function(value,element){return this.optional(element)||/^[a-z\-.,()'"\s]+$/i.test(value)},"Letters or punctuation only please");$.validator.addMethod("mobileNL",function(value,element){return this.optional(element)||/^((\+|00(\s|\s?\-\s?)?)31(\s|\s?\-\s?)?(\(0\)[\-\s]?)?|0)6((\s|\s?\-\s?)?[0-9]){8}$/.test(value)},
"Please specify a valid mobile number");$.validator.addMethod("mobileUK",function(phone_number,element){phone_number=phone_number.replace(/\(|\)|\s+|-/g,"");return this.optional(element)||phone_number.length>9&&phone_number.match(/^(?:(?:(?:00\s?|\+)44\s?|0)7(?:[1345789]\d{2}|624)\s?\d{3}\s?\d{3})$/)},"Please specify a valid mobile number");$.validator.addMethod("nieES",function(value){var nieRegEx=new RegExp(/^[MXYZ]{1}[0-9]{7,8}[TRWAGMYFPDXBNJZSQVHLCKET]{1}$/gi);var validChars="TRWAGMYFPDXBNJZSQVHLCKET",
letter=value.substr(value.length-1).toUpperCase(),number;value=value.toString().toUpperCase();if(value.length>10||value.length<9||!nieRegEx.test(value))return false;value=value.replace(/^[X]/,"0").replace(/^[Y]/,"1").replace(/^[Z]/,"2");number=value.length===9?value.substr(0,8):value.substr(0,9);return validChars.charAt(parseInt(number,10)%23)===letter},"Please specify a valid NIE number.");$.validator.addMethod("nifES",function(value){value=value.toUpperCase();if(!value.match("((^[A-Z]{1}[0-9]{7}[A-Z0-9]{1}$|^[T]{1}[A-Z0-9]{8}$)|^[0-9]{8}[A-Z]{1}$)"))return false;
if(/^[0-9]{8}[A-Z]{1}$/.test(value))return"TRWAGMYFPDXBNJZSQVHLCKE".charAt(value.substring(8,0)%23)===value.charAt(8);if(/^[KLM]{1}/.test(value))return value[8]===String.fromCharCode(64);return false},"Please specify a valid NIF number.");$.validator.addMethod("notEqualTo",function(value,element,param){return this.optional(element)||!$.validator.methods.equalTo.call(this,value,element,param)},"Please enter a different value, values must not be the same.");$.validator.addMethod("nowhitespace",function(value,
element){return this.optional(element)||/^\S+$/i.test(value)},"No white space please");$.validator.addMethod("pattern",function(value,element,param){if(this.optional(element))return true;if(typeof param==="string")param=new RegExp("^(?:"+param+")$");return param.test(value)},"Invalid format.");$.validator.addMethod("phoneNL",function(value,element){return this.optional(element)||/^((\+|00(\s|\s?\-\s?)?)31(\s|\s?\-\s?)?(\(0\)[\-\s]?)?|0)[1-9]((\s|\s?\-\s?)?[0-9]){8}$/.test(value)},"Please specify a valid phone number.");
$.validator.addMethod("phonesUK",function(phone_number,element){phone_number=phone_number.replace(/\(|\)|\s+|-/g,"");return this.optional(element)||phone_number.length>9&&phone_number.match(/^(?:(?:(?:00\s?|\+)44\s?|0)(?:1\d{8,9}|[23]\d{9}|7(?:[1345789]\d{8}|624\d{6})))$/)},"Please specify a valid uk phone number");$.validator.addMethod("phoneUK",function(phone_number,element){phone_number=phone_number.replace(/\(|\)|\s+|-/g,"");return this.optional(element)||phone_number.length>9&&phone_number.match(/^(?:(?:(?:00\s?|\+)44\s?)|(?:\(?0))(?:\d{2}\)?\s?\d{4}\s?\d{4}|\d{3}\)?\s?\d{3}\s?\d{3,4}|\d{4}\)?\s?(?:\d{5}|\d{3}\s?\d{3})|\d{5}\)?\s?\d{4,5})$/)},
"Please specify a valid phone number");$.validator.addMethod("phoneUS",function(phone_number,element){phone_number=phone_number.replace(/\s+/g,"");return this.optional(element)||phone_number.length>9&&phone_number.match(/^(\+?1-?)?(\([2-9]([02-9]\d|1[02-9])\)|[2-9]([02-9]\d|1[02-9]))-?[2-9]([02-9]\d|1[02-9])-?\d{4}$/)},"Please specify a valid phone number");$.validator.addMethod("postalcodeBR",function(cep_value,element){return this.optional(element)||/^\d{2}.\d{3}-\d{3}?$|^\d{5}-?\d{3}?$/.test(cep_value)},
"Informe um CEP v\u00c3\u00a1lido.");$.validator.addMethod("postalCodeCA",function(value,element){return this.optional(element)||/^[ABCEGHJKLMNPRSTVXY]\d[ABCEGHJKLMNPRSTVWXYZ] *\d[ABCEGHJKLMNPRSTVWXYZ]\d$/i.test(value)},"Please specify a valid postal code");$.validator.addMethod("postalcodeIT",function(value,element){return this.optional(element)||/^\d{5}$/.test(value)},"Please specify a valid postal code");$.validator.addMethod("postalcodeNL",function(value,element){return this.optional(element)||
/^[1-9][0-9]{3}\s?[a-zA-Z]{2}$/.test(value)},"Please specify a valid postal code");$.validator.addMethod("postcodeUK",function(value,element){return this.optional(element)||/^((([A-PR-UWYZ][0-9])|([A-PR-UWYZ][0-9][0-9])|([A-PR-UWYZ][A-HK-Y][0-9])|([A-PR-UWYZ][A-HK-Y][0-9][0-9])|([A-PR-UWYZ][0-9][A-HJKSTUW])|([A-PR-UWYZ][A-HK-Y][0-9][ABEHMNPRVWXY]))\s?([0-9][ABD-HJLNP-UW-Z]{2})|(GIR)\s?(0AA))$/i.test(value)},"Please specify a valid UK postcode");$.validator.addMethod("require_from_group",function(value,
element,options){var $fields=$(options[1],element.form),$fieldsFirst=$fields.eq(0),validator=$fieldsFirst.data("valid_req_grp")?$fieldsFirst.data("valid_req_grp"):$.extend({},this),isValid=$fields.filter(function(){return validator.elementValue(this)}).length>=options[0];$fieldsFirst.data("valid_req_grp",validator);if(!$(element).data("being_validated")){$fields.data("being_validated",true);$fields.each(function(){validator.element(this)});$fields.data("being_validated",false)}return isValid},$.validator.format("Please fill at least {0} of these fields."));
$.validator.addMethod("skip_or_fill_minimum",function(value,element,options){var $fields=$(options[1],element.form),$fieldsFirst=$fields.eq(0),validator=$fieldsFirst.data("valid_skip")?$fieldsFirst.data("valid_skip"):$.extend({},this),numberFilled=$fields.filter(function(){return validator.elementValue(this)}).length,isValid=numberFilled===0||numberFilled>=options[0];$fieldsFirst.data("valid_skip",validator);if(!$(element).data("being_validated")){$fields.data("being_validated",true);$fields.each(function(){validator.element(this)});
$fields.data("being_validated",false)}return isValid},$.validator.format("Please either skip these fields or fill at least {0} of them."));$.validator.addMethod("stateUS",function(value,element,options){var isDefault=typeof options==="undefined",caseSensitive=isDefault||typeof options.caseSensitive==="undefined"?false:options.caseSensitive,includeTerritories=isDefault||typeof options.includeTerritories==="undefined"?false:options.includeTerritories,includeMilitary=isDefault||typeof options.includeMilitary===
"undefined"?false:options.includeMilitary,regex;if(!includeTerritories&&!includeMilitary)regex="^(A[KLRZ]|C[AOT]|D[CE]|FL|GA|HI|I[ADLN]|K[SY]|LA|M[ADEINOST]|N[CDEHJMVY]|O[HKR]|PA|RI|S[CD]|T[NX]|UT|V[AT]|W[AIVY])$";else if(includeTerritories&&includeMilitary)regex="^(A[AEKLPRSZ]|C[AOT]|D[CE]|FL|G[AU]|HI|I[ADLN]|K[SY]|LA|M[ADEINOPST]|N[CDEHJMVY]|O[HKR]|P[AR]|RI|S[CD]|T[NX]|UT|V[AIT]|W[AIVY])$";else if(includeTerritories)regex="^(A[KLRSZ]|C[AOT]|D[CE]|FL|G[AU]|HI|I[ADLN]|K[SY]|LA|M[ADEINOPST]|N[CDEHJMVY]|O[HKR]|P[AR]|RI|S[CD]|T[NX]|UT|V[AIT]|W[AIVY])$";
else regex="^(A[AEKLPRZ]|C[AOT]|D[CE]|FL|GA|HI|I[ADLN]|K[SY]|LA|M[ADEINOST]|N[CDEHJMVY]|O[HKR]|PA|RI|S[CD]|T[NX]|UT|V[AT]|W[AIVY])$";regex=caseSensitive?new RegExp(regex):new RegExp(regex,"i");return this.optional(element)||regex.test(value)},"Please specify a valid state");$.validator.addMethod("strippedminlength",function(value,element,param){return $(value).text().length>=param},$.validator.format("Please enter at least {0} characters"));$.validator.addMethod("time",function(value,element){return this.optional(element)||
/^([01]\d|2[0-3]|[0-9])(:[0-5]\d){1,2}$/.test(value)},"Please enter a valid time, between 00:00 and 23:59");$.validator.addMethod("time12h",function(value,element){return this.optional(element)||/^((0?[1-9]|1[012])(:[0-5]\d){1,2}( ?[AP]M))$/i.test(value)},"Please enter a valid time in 12-hour am/pm format");$.validator.addMethod("url2",function(value,element){return this.optional(element)||/^(https?|ftp):\/\/(((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:)*@)?(((\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5]))|((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)*(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?)(:\d*)?)(\/((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)+(\/(([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)*)*)?)?(\?((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|[\uE000-\uF8FF]|\/|\?)*)?(#((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|\/|\?)*)?$/i.test(value)},
$.validator.messages.url);$.validator.addMethod("vinUS",function(v){if(v.length!==17)return false;var LL=["A","B","C","D","E","F","G","H","J","K","L","M","N","P","R","S","T","U","V","W","X","Y","Z"],VL=[1,2,3,4,5,6,7,8,1,2,3,4,5,7,9,2,3,4,5,6,7,8,9],FL=[8,7,6,5,4,3,2,10,0,9,8,7,6,5,4,3,2],rs=0,i,n,d,f,cd,cdv;for(i=0;i<17;i++){f=FL[i];d=v.slice(i,i+1);if(i===8)cdv=d;if(!isNaN(d))d*=f;else for(n=0;n<LL.length;n++)if(d.toUpperCase()===LL[n]){d=VL[n];d*=f;if(isNaN(cdv)&&n===8)cdv=LL[n];break}rs+=d}cd=
rs%11;if(cd===10)cd="X";if(cd===cdv)return true;return false},"The specified vehicle identification number (VIN) is invalid.");$.validator.addMethod("zipcodeUS",function(value,element){return this.optional(element)||/^\d{5}(-\d{4})?$/.test(value)},"The specified US ZIP Code is invalid");$.validator.addMethod("ziprange",function(value,element){return this.optional(element)||/^90[2-5]\d\{2\}-\d{4}$/.test(value)},"Your ZIP-code must be in the range 902xx-xxxx to 905xx-xxxx");return $});
</script>

</body>
</html>
