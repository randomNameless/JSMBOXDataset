<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>2315-1732182386016-2209619cda6e8894.html</title>
</head>
<body>

<script>
"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2315],{52895:function(e,t,r){r.d(t,{TD:function(){return _},U4:function(){return m},WX:function(){return w},hP:function(){return k},u8:function(){return g},uX:function(){return h}});var n,o,a,c,s=r(50029),u=r(64687),i=r.n(u),l=r(11752),d=r.n(l),p={de:{url:"https://auth.ionos.de/1.0/",market:"2"},uk:{url:"https://auth.ionos.co.uk/1.0/",market:"6"},fr:{url:"https://auth.ionos.fr/1.0/",market:"7"},ca:{url:"https://auth.ionos.ca/1.0/",market:"18"},mx:{url:"https://auth.ionos.mx/1.0/",market:"22"},es:{url:"https://auth.ionos.es/1.0/",market:"16"},us:{url:"https://auth.ionos.com/1.0/",market:"11"},it:{url:"https://auth.ionos.it/1.0/",market:"21"}},f="/oauth",h=(n=(0,s.Z)(i().mark(function e(t,r,n,o){var a,c,s;return i().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if((a=new URLSearchParams).append("redirect_uri",location.origin+f),a.append("response_type","code"),a.append("client_id",r),a.append("state","same_state"),a.append("market",p[o].market),a.append("code_challenge_method","S256"),a.append("code_challenge",t),a.append("prompt","none"),a.append("ui_locales",n),p[o]){e.next=12;break}throw Error("tld not found: ".concat(o));case 12:c="".concat(p[o].url,"oauth/auth/init"),s="".concat(c,"?").concat(a.toString()),window.location.href=s;case 15:case"end":return e.stop()}},e)})),function(e,t,r,o){return n.apply(this,arguments)}),m=(o=(0,s.Z)(i().mark(function e(t){var r,n,o,a;return i().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=d()().publicRuntimeConfig.REACT_APP_PRICE_SERVICE_URL){e.next=4;break}throw Error("Env URL is not defined");case 4:return e.prev=4,n="".concat(r,"/api/shop/trackingservice/hash/customer?customerNumber=").concat(t),e.next=8,fetch(n,{method:"GET"});case 8:if((o=e.sent).ok){e.next=11;break}throw Error("Failed to fetch data: ".concat(o.status," - ").concat(o.statusText));case 11:return e.next=13,o.text();case 13:return a=e.sent,e.abrupt("return",a);case 17:throw e.prev=17,e.t0=e.catch(4),Error("Failed to fetch data: ".concat(e.t0.message));case 20:case"end":return e.stop()}},e,null,[[4,17]])})),function(e){return o.apply(this,arguments)}),k=(a=(0,s.Z)(i().mark(function e(t,r,n){var o,a,c,s,u,l,d,h,m,k;return i().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(a=(o=new URLSearchParams(window.location.search)).get("code"),c=o.get("error"),s="".concat(p[n].url,"oauth/token"),!(!a||c)){e.next=6;break}throw Error("[get access token] "+(c||""));case 6:return u={grant_type:"authorization_code",code:a,redirect_uri:location.origin+f,client_id:r,code_verifier:t},(l=new Headers).append("Content-Type","application/x-www-form-urlencoded"),d={method:"POST",headers:l,body:b(u)},e.next=12,fetch(s,d);case 12:if((h=e.sent).ok){e.next=18;break}return e.next=16,h.json();case 16:throw m=e.sent,Error("[Get Access Tocken] Network response was not ok. Error "+h.status+"details: "+JSON.stringify(m));case 18:return e.next=20,h.json();case 20:return k=e.sent,e.abrupt("return",k);case 23:case"end":return e.stop()}},e)})),function(e,t,r){return a.apply(this,arguments)}),g=(c=(0,s.Z)(i().mark(function e(t){var r,n;return i().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=p[t].url+"/oauth/.well-known/jwks.json",e.next=3,fetch(r);case 3:if((n=e.sent).ok){e.next=6;break}throw Error("[Fetch Well Known Url] Network response was not ok. Error "+n.status);case 6:return e.next=8,n.json();case 8:return e.abrupt("return",e.sent);case 9:case"end":return e.stop()}},e)})),function(e){return c.apply(this,arguments)}),_=function(e){return JSON.parse(decodeURIComponent(atob(e.replace(/-/g,"+").replace(/_/g,"/")).split("").map(function(e){return"%"+("00"+e.charCodeAt(0).toString(16)).slice(-2)}).join("")))},w=function(e,t){for(var r=0;r<t.keys.length;r++)if(t.keys[r].kid===e)return!0;return!1},b=function(e){return Object.keys(e).map(function(t){return"redirect_uri"===t?t+"="+encodeURIComponent(e[t]):t+"="+e[t]}).join("&")}},35571:function(e,t,r){r.d(t,{k:function(){return i}});var n,o=r(50029),a=r(64687),c=r.n(a);function s(e){return("0"+e.toString(16)).substring(-2)}function u(){return(u=(0,o.Z)(c().mark(function e(t){var r;return c().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,function(e){var t=new TextEncoder().encode(e);return window.crypto.subtle.digest("SHA-256",t)}(t);case 2:return r=function(e){for(var t="",r=new Uint8Array(e),n=r.byteLength,o=0;o<n;o++)t+=String.fromCharCode(r[o]);return btoa(t).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}(e.sent),e.abrupt("return",r);case 5:case"end":return e.stop()}},e)}))).apply(this,arguments)}var i=(n=(0,o.Z)(c().mark(function e(){var t,r;return c().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=function(){var e=new Uint32Array(8);return window.crypto.getRandomValues(e),Array.from(e,s).join("")}(),e.next=3,function(e){return u.apply(this,arguments)}(t);case 3:return r=e.sent,e.abrupt("return",{codeVerifier:t,codeChallenge:r});case 5:case"end":return e.stop()}},e)})),function(){return n.apply(this,arguments)})},22315:function(e,t,r){r.r(t),r.d(t,{getHashedCustomerId:function(){return f},isLoggedIn:function(){return p}});var n=r(50029),o=r(64687),a=r.n(o),c=r(52895),s=r(35571),u=r(18311),i=r(67294),l=r(74071),d=r(85893);function p(){return"logged_in"===localStorage.getItem("login_state")}function f(){var e=window.localStorage.getItem("customer_info");try{var t,r=JSON.parse(e);return null!==(t=null==r?void 0:r.legacy_ccd_customernumber)&&void 0!==t?t:null}catch(e){}return null}t.default=function(){var e="code_verifier",t="token_consumed",r=(0,u.dK)().substring(3).toLocaleLowerCase();return(0,i.useEffect)(function(){var o,i="localhost:3000"===window.location.host?"playground.showroom.ionos.com":"showroom.ionos.com",d=(o=(0,n.Z)(a().mark(function n(){var o,d,p,f,h,m,k,g,_,w,b;return a().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(n.prev=0,!("true"!==localStorage.getItem("is_redirected"))){n.next=11;break}return n.next=4,(0,s.k)();case 4:return o=n.sent,localStorage.setItem("is_redirected","true"),localStorage.setItem(e,o.codeVerifier),n.next=9,(0,c.uX)(o.codeChallenge,i,(0,u.dK)(),r);case 9:n.next=41;break;case 11:if(localStorage.setItem("current_user",(0,l.ej)("user_login")),d=localStorage.getItem(e),p=localStorage.getItem(t),!(!d||"true"===p)){n.next=16;break}throw Error("no code verifier or token consumed");case 16:return n.next=18,(0,c.hP)(d,i,r);case 18:if(f=n.sent){n.next=21;break}throw Error("unable to get token");case 21:return localStorage.setItem(t,"true"),n.next=24,(0,c.u8)(r);case 24:if(h=n.sent,m=f.id_token,k=(0,c.TD)(m.split(".")[0]).kid,!(0,c.WX)(k,h)){n.next=41;break}if(!(null!=(g=(0,c.TD)(m.split(".")[1]))&&g.legacy_ccd_customernumber)){n.next=35;break}return n.next=33,(0,c.U4)(g.legacy_ccd_customernumber);case 33:_=n.sent,g.legacy_ccd_customernumber=_;case 35:localStorage.setItem("customer_info",JSON.stringify(g)),localStorage.setItem("login_state","logged_in"),localStorage.setItem("ac_token",f.access_token),localStorage.setItem("ac_token_creation_time",new Date().toISOString()),(w=localStorage.getItem("redirect_path"))&&(location.href=window.location.origin+w);case 41:n.next=49;break;case 43:n.prev=43,n.t0=n.catch(0),console.error(null===n.t0||void 0===n.t0?void 0:n.t0.message),b=localStorage.getItem("redirect_path"),sessionStorage.setItem("login_error_message",n.t0.message),location.href=window.location.origin+b;case 49:case"end":return n.stop()}},n,null,[[0,43]])})),function(){return o.apply(this,arguments)});(0,n.Z)(a().mark(function e(){var t,r;return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=(0,l.ej)("user_login"),r=localStorage.getItem("login_state"),t&&!r&&d();case 3:case"end":return e.stop()}},e)}))()},[]),(0,d.jsx)("div",{})}},18311:function(e,t,r){r.d(t,{dK:function(){return a},K5:function(){return c}});var n=r(11752),o=r.n(n)()().publicRuntimeConfig,a=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";switch(o.NEXT_APP_COUNTRY){case"us":e="en_US";break;case"de":default:e="de_DE";break;case"ca":e="en_CA";break;case"fr":e="fr_FR";break;case"es":e="es_ES";break;case"it":e="it_IT";break;case"mx":e="mx_MX";break;case"at":e="de_AT";break;case"uk":e="en_UK"}return e},c=function(e){switch(e){case"US":e="en_US";break;case"DE":e="de_DE";break;case"CA":e="en_CA";break;case"FR":e="fr_FR";break;case"ES":e="es_ES";break;case"IT":e="it_IT";break;case"MX":e="mx_MX";break;case"AT":e="de_AT";break;case"UK":e="en_UK";break;default:e="de-DE"}return e}}}]);
</script>

</body>
</html>
