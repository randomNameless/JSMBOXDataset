<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>cpex-package.min.html</title>
</head>
<body>

<script>
var CpexPackage=function(){"use strict";("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{}).SENTRY_RELEASE={id:"3.24.1"};let e=Date.now();function t(){return window.cpexPackage||window.cpexPackageFormats}function i(e){(e=[].slice.call(e)).unshift("display: inline-block; color: #fff; background: #555; padding: 1px 4px; border-radius: 3px;");e.unshift("%cCPEx Package");return e}function s(e){return e?JSON.parse(JSON.stringify(e)):e}function n(){if(t().debugMode){const t=Date.now();Array.prototype.push.call(arguments,t-e);e=t;console.log.apply(this,i(arguments))}}function a(e){console.log("%cCPEx Package%c "+e,"display: inline-block; color: #fff; background: #555; padding: 1px 4px; border-radius: 3px;","font-size: 15px; padding-top: 10px; font-weight: bold; border-bottom: none")}function d(){console.warn.apply(this,i(arguments))}function o(e,s){s instanceof Error?s.message=e+", reason: "+s.message:s=new Error(e||"missing error message");const n=t();n.sentry&&!0===n.settingsLoaded&&n.sentry.captureException(s);console.error.apply(this,i(arguments));return s}function r(e){return"object"==typeof e&&null!==e&&!1===Array.isArray(e)}function l(e){return Array.isArray(e)&&e.length>0}function c(e){return!!r(e)&&r(e.ball)}function h(e,t){const i=new RegExp(t+"=(?<value>[^a-zA-Z]+)(/| )","gm").exec(e);if(i&&i.groups)return i.groups.value}function p(e){const t=e.match(/<!--(?<value>.+?)-->/m);if(t&&t.groups)return t.groups.value}function g(e,t){return new Promise(((i,s)=>{if("string"!=typeof e){n("LoadScript: URL  for "+t+" not given, is it intentional?");return i()}const a=document.createElement("script");a.onload=()=>{i()};a.onerror=e=>{s(e)};a.src=e;document.head.appendChild(a)}))}function m(e){const t=document.createElement("style");t.innerHTML=e;document.head.appendChild(t);return t}function u(e,t){if("object"!=typeof e||"object"!=typeof t)return!1;for(const i in t)S(t[i])?e[i]=t[i]:t.hasOwnProperty(i)&&(i in e?"object"!=typeof e[i]||"object"!=typeof t[i]||e[i].concat&&t[i].concat?e[i]=t[i]:e[i]=u(e[i],t[i]):e[i]=t[i]);return e}function b(){window.gdprAppliesGlobally=!0;!function(e,t,i,s,n){function a(e,i,s,a){if("function"!=typeof s)return;window[t]||(window[t]=[]);let d=!1;n&&(d=n(e,a,s));d||window[t].push({command:e,version:i,callback:s,parameter:a})}a.stub=!0;a.stubVersion=2;function d(t){if(!window[e]||!0!==window[e].stub)return;if(!t.data)return;const n="string"==typeof t.data;let a;try{a=n?JSON.parse(t.data):t.data}catch(d){return}if(a[i]){const o=a[i];function r(e,i){const a={};a[s]={returnValue:e,success:i,callId:o.callId};t.source.postMessage(n?JSON.stringify(a):a,"*")}window[e](o.command,o.version,r,o.parameter)}}if("function"!=typeof window[e]){window[e]=a;window.addEventListener?window.addEventListener("message",d,!1):window.attachEvent("onmessage",d)}}("__tcfapi","__tcfapiBuffer","__tcfapiCall","__tcfapiReturn");!function e(t){if(!window.frames[t])if(document.body&&document.body.firstChild){const e=document.createElement("iframe");e.style.display="none";e.name=t;e.title=t;document.body.insertBefore(e,document.body.firstChild)}else setTimeout((function(){e(t)}),5)}("__tcfapiLocator")}function f(e,t){let i=document.getElementById(e);if(!i)return d(`Element id '${e}' not found`);const s=i.getAttribute("data-target-id-moved");document.getElementById(s)&&(i=document.getElementById(s));if(i){let e,s,n,a=i.getElementsByClassName("debugTags")[0];if(a){e=a.children[0];s=i.getElementsByClassName("regularTags")[0];n=i.getElementsByClassName("extraTags")[0]}else{a=document.createElement("div");a.classList.add("debugTags");a.style.cssText="position: relative; display: block; height: 0px";i.prepend(a);e=document.createElement("div");e.style.cssText="position: absolute; top: 0px; left: 0px; padding: 10px; z-index: 99999";a.appendChild(e);s=document.createElement("span");s.classList.add("regularTags");e.appendChild(s);n=document.createElement("span");n.classList.add("extraTags");e.appendChild(n)}for(const[e,i]of Object.entries(t)){const t=document.createElement("span");switch(e){case"hb":t.innerHTML="<b>HB</b>, bidder: <b>"+i.bidder+"</b>, cpm: <b>"+Math.round(100*i.cpm)/100+"</b>, size: <b>"+i.size+"</b>";i.hbkey&&(t.innerHTML+=", <b>hbKey:</b> "+i.hbkey);t.style.cssText="color: black; font-size: 8px; display: inline-block; padding: 4px; margin: 1px; border-radius: 3px; background: #1a73e8; color: #fff; box-shadow: 0px 0px 2px #888A";n.appendChild(t);break;case"json":t.innerHTML="<b>JSON</b>";t.style.cssText="color: black; font-size: 8px; display: inline-block; padding: 4px; margin: 1px; border-radius: 3px; background: #8fe81a; color: #fff; box-shadow: 0px 0px 2px #888A";n.appendChild(t);break;case"customType":if(!n.querySelector(".customType")){t.innerHTML="CPEx Format: <b>"+i+"</b>";t.style.cssText="color: black; font-size: 8px; display: inline-block; padding: 4px; margin: 1px; border-radius: 3px; background: #ee2024; color: #fff; box-shadow: 0px 0px 2px #888A";t.classList.add("customType");n.appendChild(t)}break;default:t.innerHTML=e+": <b>"+i+"</b>";t.style.cssText="color: black; font-size: 8px; display: inline-block; padding: 4px; margin: 1px; border-radius: 3px; background: #eee; box-shadow: 0px 0px 2px #888A";s.appendChild(t)}}}}function w(){return navigator.userAgent.match(/Mobi/)}function v(){return new Promise((e=>"loading"!==document.readyState?e():document.addEventListener("DOMContentLoaded",e))).catch((e=>o("DOM loaded failed",e)))}function x(e,t,i){const s=document.createElement("iframe");s.style.cssText="border:none; display:block; overflow:hidden; border:none; margin:auto;";e.appendChild(s);"function"==typeof i&&(s.onload=()=>{i(s)});Object.assign(s,t);s.setAttribute("scrolling","no");s.setAttribute("marginwidth","0");s.setAttribute("marginheight","0");return s}function y(e,t){e.open("text/html","replace");e.write(t);e.close()}function A(e){if(document.getElementById(e)){const t=document.getElementById(e).children;for(const e of t)e.classList.contains("debugTags")||(e.style.display="none")}}function S(e){return e instanceof Element}function k(e){const t=document.createElement("img");t.setAttribute("src",e);t.style.width="1px";t.style.height="1px";t.style.position="absolute";t.style.bottom="0px";t.style.right="0px";t.style.border="none";document.body.appendChild(t)}function I(e,t){return e.replace(/\${(.*?)}/g,((e,i)=>t[i]))}function C(e,t){return e.length>t?e.substring(0,t)+"...":e}function E(){return!("object"!=typeof window.pbjs||!window.pbjs.version)}function T(e,t,i){const s=document.createElement(e);Object.assign(s,i);void 0!==i&&i.class&&s.setAttribute("class",i.class);return t.appendChild(s)}function L(){return`\n    body.subscriptionModalOpen {\n      overflow: hidden !important;\n    }\n    #cpexSubs_veil {\n      z-index: 99999;\n      width: 100%;\n      height: 100%;\n      position: fixed;\n      top: 0px;\n      left: 0px;\n      background-color: #0005;\n      backdrop-filter: blur(10px);\n      -webkit-backdrop-filter: blur(10px);\n    }\n\n    #cpexSubs_modalWrapper {\n      position: fixed;\n      top: 0px;\n      left: 0px;\n      width: 100%;\n      height: 100%;\n      z-index: 999999;\n      display: flex;\n      align-items: center;\n      justify-content: center;\n    }\n    #cpexSubs_modal {\n      position: relative;\n      display: flex;\n      flex-direction: column;\n      width: 900px;\n      min-height: 100px;\n      max-height: 95%;\n      box-sizing: border-box;\n      margin-top: 20px;\n      border-radius: 10px;\n      box-shadow: 0px 1px 6px #0002;\n      font-family: Helvetica, Calibri, Arial, sans-serif;\n      background-color: #FFF;\n      overflow: hidden;\n    }\n      #cpexSubs_content {\n        position: relative;\n        flex-grow: 1;\n        overflow: auto;\n        padding-top: 40px;\n      }\n      #cpexSubs_modal::before,\n      #cpexSubs_modal::after {\n        display: block;\n        content: '';\n        position: absolute;\n        left: 0;\n        right: 0;\n        height: 100px;\n        z-index: 1;\n        pointer-events: none;\n      }\n      #cpexSubs_modal::before {\n        top: 0;\n        background: linear-gradient(to bottom, white, transparent);\n      }\n      #cpexSubs_modal::after {\n        bottom: 0;\n        background: linear-gradient(to top, white, transparent);\n      }\n      #cpexSubs_modal.hideTop::before { display: none }\n      #cpexSubs_modal.hideBottom::after { display: none }\n\n      #cpexSubs_content a {\n        color: #263238;\n      }\n\n      #cpexSubs_primaryLogo {\n        display: block;\n        margin: auto;\n      }\n      #cpexSubs_secondaryLogo {\n        position: absolute;\n        top: 30px;\n        right: 30px;\n      }\n      #cpexSubs_headline {\n        margin-top: 40px;\n        margin-bottom: 0px;\n        padding: 0px 20px;\n        font-size: 12pt;\n        font-weight: normal;\n        text-align: center;\n      }\n      #cpexSubs_modal main {\n        display: flex;\n        gap: 40px;\n        padding: 20px 40px;\n        padding-bottom: 60px;\n        background-color: #FFF;\n      }\n        #cpexSubs_modal main p {\n          font-size: 11pt;\n          overflow: auto;\n          line-height: 140%;\n          margin: 15px 0px;\n          height: 12em;\n        }\n        #cpexSubs_modal main div {\n          flex: 1;\n        }\n          #cpexSubs_modal main div h2 {\n            color: #333;\n          }\n      \n      #cpexSubs_cmpButtons, #cpexSubs_subButtons {\n        display: flex;\n        align-items: center;\n      }\n\n      #cpexSubs_modal main button {\n        font-size: 14pt;\n        padding: 15px 30px;\n        cursor: pointer;\n        margin-right: 20px;\n        border-radius: 3px;\n      }\n\n        #cpexSubs_consentButton {\n          background-color: ${window.Didomi.getConfig().theme.color};\n          border: none;\n          color: white;\n        }\n        #cpexSubs_subscribeButton {\n          background-color: #EEE;\n          border: 1px #AAA solid;\n          color: black;\n        }\n\n      #cpexSubs_linkPurposes, #cpexSubs_linkLogin {\n        color: ${window.Didomi.getConfig().theme.linkColor};\n        text-decoration: none;\n        float: left;\n      }\n\n      #cpexSubs_bottom {\n        background-color: #eee;\n        padding: 20px 40px;\n        font-size: 10pt;\n        color: gray;\n        border-radius: 0px 0px 10px 10px;\n      }\n        #cpexSubs_bottom a {\n          text-decoration: none;\n        }\n        #cpexSubs_bottom p {\n          margin: 0px;\n          font-size: 10pt;\n          color: gray;\n          padding: 0px;\n          line-height: 120%;\n        }\n          #cpexSubs_bottom p:first-letter {\n            text-transform: uppercase;\n          }\n        #cpexSubs_links {\n          padding-top: 10px;\n          padding-bottom: 10px;\n        }\n\n    @media only screen and (max-width: 1080px) {\n      #cpexSubs_modal main p {\n        height: 10.5em;\n      }\n    }\n\n    @media only screen and (max-width: 900px) {\n      #cpexSubs_modal {\n        width: calc(100% - 40px);\n        margin: 20px auto;\n      }\n        #cpexSubs_modal main {\n          flex-direction: column;\n          position: relative;\n        }\n    }\n    @media only screen and (max-width: 400px) {\n      #cpexSubs_modal {\n        width: calc(100% - 10px);\n        margin: 5px;\n      }\n        #cpexSubs_modal main {\n          padding: 20px;\n        }\n          #cpexSubs_modal main p {\n            max-height: 5em;\n          }\n    }\n  `}class j{constructor(e){this.consent=window.Didomi.getUserConsentStatusForAll();this.isConfigured=!1;this.config=e.settings.cmp.payConfig;const t=()=>(this.config.required||["cookies"]).some((e=>this.consent.purposes.disabled.includes(e))),i=()=>{if(!this.config.consentDateLimit)return!1;return new Date(window.Didomi.getUserStatus().updated)<new Date(this.config.consentDateLimit)};if("function"!=typeof this.config.isSubscribed)return d("Please define isSubscribed function in cpexPackage.cmp.payConfig");if(void 0===this.config.enabled||!0===this.config.enabled){const e=0===this.consent.vendors.enabled.length||t()||i();if(!0!==this.config.isSubscribed()&&e){this.configure();this.showModal()}}}configure(){const e=window.Didomi.getRequiredVendors().length,t=(({partnerNum:e})=>({mainHeadline:"",cmpHeadline:"Prosíme o souhlas",subHeadline:"Předplaťte si web bez reklam*",cmpBody:'S Vaším souhlasem pro zobrazování, cílení a měření reklamy můžete naše stránky používat <b>ZDARMA</b>. Díky cookies či dalším síťovým identifikátorům víme např. jak procházíte naše stránky, jaký obsah Vás zajímá či pro jaké účely, jste nám dali svůj souhlas. My a naši partneři máme k těmto osobním údajům ve Vašem zařízení přístup nebo je ukládáme a následně zpracováváme pro účely uvedené níže. Tyto údaje nám <b>pomáhají</b> provozovat a zlepšovat naše služby či připravit obsah, který Vás bude zajímat. Pro některé účely je vyžadován <b>Váš souhlas</b>, jindy postačí tzv. oprávněný zájem. Své volby pro volitelné účely, včetně nastavení souhlasu či vznesení námitky vůči oprávněnému zájmu, můžete provést v Podrobném nastavení“ nebo je následně změnit či souhlas odvolat <a href="https://www.cncenter.cz/cookies" target="_blank">zde</a>.<br>Vaše nastavení se použije pro všechny naše webové stránky. Pokud se rozhodnete souhlas neudělit i pro vyžadované reklamní účely pro používání stránek ZDARMA, nabízíme Vám předplatné bez reklam.',subBody:'Chcete používat tento web bez sdílení informací s třetími stranami o historii Vašeho prohlížení a bez cílené reklamy a reklamních bannerů? Stačí se zaregistrovat nebo se přihlásit s Vašim stávajícím účtem a zakoupit předplatné <b>webu bez reklam za ... Kč/měsíc</b>. Informace o zpracování údajů v rámci webu bez reklam naleznete <a href="https://www.cncenter.cz/cookies" target="_blank">zde</a>.<br> Pokud jste již předplatitelem služby Premium či Premium+, získáváte předplatné webu bez reklam jako benefit. Stačí se přihlásit s Vaším Premium účtem a odsouhlasit podmínky webu bez reklam.<br>* Netýká se reklamy zobrazované v rámci obsahu, jako jsou komerční sdělení, native či PR články.',butConsent:"Souhlasím",linkPurposes:"Podrobné nastavení",butRegister:"Koupit",linkLogin:"Přihlásit se",purposeListHeadline:`My a našich <a href="javascript:Didomi.preferences.show('vendors')">${e} partnerů</a> zpracováváme údaje následujícím způsobem:<br>`,purposeListFallback:`My a našich <a href="javascript:Didomi.preferences.show('vendors')">${e} partnerů</a> zpracováváme údaje následujícím způsobem:<br>Personalizovaná reklama a obsah, měření reklamy a obsahu, poznatky o okruzích publika a vývoj produktů, Technický provoz stránek, Ukládání a/nebo přístup k informacím v zařízení, Zpracování údajů vydavateli a dalšími partnery`}))({partnerNum:e}),i={generalCSS:L,texts:t,veil:!0,purposeList:!0},s="function"==typeof this.config.texts?this.config.texts({partnerNum:e}):this.config.texts;"object"==typeof s&&(this.config.texts={...i.texts,...s});this.settings={...i,...this.config};this.settings.generalCSS&&T("style",document.head,{innerHTML:this.settings.generalCSS()});this.settings.overrideCSS&&T("style",document.head,{innerHTML:this.settings.overrideCSS()});this.isConfigured=!0}onSubscribe(){window.open(this.settings.registerURL,"_self")}onLogin(){}showModal(){this.elements={};this.isConfigured||this.configure();this.settings.veil&&(this.elements.veil=T("div",document.body,{id:"cpexSubs_veil"}));document.body.classList.add("subscriptionModalOpen");this.elements.wrapper=T("div",document.body,{id:"cpexSubs_modalWrapper"});this.elements.modal=T("div",this.elements.wrapper,{id:"cpexSubs_modal"});this.elements.content=T("div",this.elements.modal,{id:"cpexSubs_content"});this.settings.primaryLogoURL&&(this.elements.primaryLogo=T("img",this.elements.content,{id:"cpexSubs_primaryLogo",src:this.settings.primaryLogoURL,height:50}));this.settings.secondaryLogoURL&&(this.elements.secondaryLogo=T("img",this.elements.content,{id:"cpexSubs_secondaryLogo",src:this.settings.secondaryLogoURL,height:20}));this.settings.texts.mainHeadline&&T("div",this.elements.content,{innerHTML:this.settings.texts.mainHeadline,id:"cpexSubs_headline"});this.elements.main=T("main",this.elements.content);this.elements.cmp=T("div",this.elements.main,{id:"cpexSubs_cmp"});this.elements.sub=T("div",this.elements.main,{id:"cpexSubs_sub"});this.elements.cmpTop=T("div",this.elements.cmp,{id:"cpexSubs_cmpText"});this.elements.subTop=T("div",this.elements.sub,{id:"cpexSubs_subText"});T("h2",this.elements.cmpTop,{innerHTML:this.settings.texts.cmpHeadline});T("p",this.elements.cmpTop,{innerHTML:this.settings.texts.cmpBody});T("h2",this.elements.subTop,{innerHTML:this.settings.texts.subHeadline});T("p",this.elements.subTop,{innerHTML:this.settings.texts.subBody});this.elements.cmpButtons=T("div",this.elements.cmp,{id:"cpexSubs_cmpButtons"});this.elements.subButtons=T("div",this.elements.sub,{id:"cpexSubs_subButtons"});this.elements.butConsent=T("button",this.elements.cmpButtons,{innerHTML:this.settings.texts.butConsent,id:"cpexSubs_consentButton"});this.elements.linkPurposes=T("a",this.elements.cmpButtons,{innerHTML:this.settings.texts.linkPurposes,href:"#",id:"cpexSubs_linkPurposes"});this.elements.butRegister=T("button",this.elements.subButtons,{innerHTML:this.settings.texts.butRegister,id:"cpexSubs_subscribeButton"});this.elements.butRegister.addEventListener("click",(()=>{this.onSubscribe()}));this.elements.linkLogin=T("a",this.elements.subButtons,{href:this.settings.loginURL,innerHTML:this.settings.texts.linkLogin,id:"cpexSubs_linkLogin"});this.elements.linkLogin.addEventListener("click",(()=>{this.onLogin()}));this.elements.bottom=T("div",this.elements.content,{id:"cpexSubs_bottom"});this.settings.texts.bottomText&&T("p",this.elements.bottom,{innerHTML:this.settings.texts.bottomText,id:"cpexSubs_bottomText"});if(this.settings.purposeList){const e=[];window.Didomi.getCategories().forEach((t=>{if(t.name?.cs)return t.name.cs.toLowerCase();const i=t.purposeId,s=window.Didomi.getPurposes()[i];s&&s.name&&s.name.cs&&e.push(s.name.cs.toLowerCase())}));const t=this.settings.texts.purposeListHeadline;T("p",this.elements.bottom,{innerHTML:t+e.filter(Boolean).join(", ")||t+this.settings.texts.purposeListFallback,id:"cpexSubs_purposeList"})}if(Array.isArray(this.settings.links)&&this.settings.links.length>0){this.elements.links=T("p",this.elements.bottom,{id:"cpexSubs_links"});this.settings.links.forEach((e=>{"privacyPolicy"===e.href&&(e.href=window.Didomi.getConfig().app.privacyPolicyURL);T("a",this.elements.links,{...e})}))}this.elements.butConsent.addEventListener("click",(()=>{this.hideModal();setTimeout((()=>{window.Didomi.setUserAgreeToAll()}),50)}));this.elements.linkPurposes.addEventListener("click",(()=>{window.Didomi.preferences.show("purposes")}));this.updateShadows=()=>{const{content:e,modal:t}=this.elements,i=e.scrollTop>0,s=e.scrollHeight-e.clientHeight-e.scrollTop>10;t.classList.toggle("hideTop",!i);t.classList.toggle("hideBottom",!s)};this.elements.content.addEventListener("scroll",this.updateShadows);window.addEventListener("resize",this.updateShadows);this.updateShadows();this.elements.cmp.querySelectorAll("details summary").forEach((e=>e.addEventListener("click",(t=>{t.preventDefault();const i=e.parentElement;i.hasAttribute("open")?i.removeAttribute("open"):i.setAttribute("open","");Array.from(i.parentElement.children).forEach((e=>e!==i&&e.removeAttribute("open")))}))))}hideModal(){this.elements.veil&&(this.elements.veil.style.display="none");this.elements.wrapper.style.display="none";document.body.classList.remove("subscriptionModalOpen")}}class B{constructor(e){this.main=e;this.loaded=!1;this.settings=this.main.settings.cmp;if(this.settings.enabled){this.settings.payEnabled&&(window.didomiConfig={notice:{enable:!1}});this.addDidomi();this.settings.payEnabled&&this.addPayOkay()}else window.__tcfapi||b()}addDidomi(){if(window.Didomi){d("CMP: Didomi already present");this.loaded=!0}else if(window.__tcfapi){d("CMP: Generic CMP already present");this.loaded=!0}else{b();const e=this.main.localhost?"cpex.cz":document.location.hostname;g("https://sdk.privacy-center.org/9a8e2159-3781-4da1-9590-fbf86806f86e/loader.js"+(this.settings.didomiTemplate?"?target_type=notice&target="+this.settings.didomiTemplate:"?target="+e),"Didomi loader for SDK");window.didomiEventListeners=window.didomiEventListeners||[];window.didomiOnReady=window.didomiOnReady||[];window.didomiOnReady.push((()=>{this.loaded=!0;n("CMP: Didomi loaded");!1===window.Didomi.isTCFEnabled()&&o("TCF compliance disabled in Didomi console");this.fireConsentPixels();this.addCloseButton()}))}}addPayOkay(){window.didomiEventListeners.push({event:"preferences.clicksavechoices",listener:()=>{window.cpexCmpSubscription.hideModal()}});window.didomiEventListeners.push({event:"preferences.clickagreetoall",listener:()=>{window.cpexCmpSubscription.hideModal()}});window.didomiOnReady.push((()=>{this.pay=new j(this.main)}))}fireConsentPixels(e){window.didomiEventListeners.push({event:"consent.changed",listener:()=>{this.fireConsentPixels(!0)}});const t=window.localStorage.getItem("pixelsLastFired")||0,i=Date.now();i-864e5>t||e?Array.isArray(this.settings.pixelList)&&window.__tcfapi("addEventListener",2,((e,t)=>{if(!1!==t&&e.vendor.consents)if(Object.keys(e.vendor.consents).length>0){this.settings.pixelList.forEach((t=>{k(t.replace("%CONSENT%",e.tcString))}));window.localStorage.setItem("pixelsLastFired",i);n("CMP: Added consent pixels")}else d("CMP: Missing consent for calling pixels")})):n("CMP: 24 hours have not yet passed, based on pixelsLastFired in local storage")}addCloseButton(){if(void 0!==window.cpexCmpAllowCloseButton||-1!==window.location.href.indexOf("cpexCmpAllowCloseButton")){const e=document.getElementById("didomi-notice")||document.getElementsByClassName("didomi-popup-notice-logo-container")[0];if(e){const t=document.createElement("div");t.textContent="×";t.style.cssText="position: absolute; top: 10px; right: 10px; width: 40px; height: 40px; cursor: pointer; font-size: 20pt; text-align: center; line-height: 40px;";t.addEventListener("click",(function(){window.Didomi.notice.hide()}));e.appendChild(t)}}}}class P{constructor(e){this.main=e;this.dependenciesLoading=!1;this.adapter="googletag";this.displayed=!1;this.slots=[]}load(){n("Adserver: GoogleTag adapter loading");this.pubAdsReady=new Promise((e=>{const t=setInterval((()=>{if(window.googletag.pubadsReady){clearInterval(t);e()}}),100)}));const e=[this.pubAdsReady];window.googletag=window.googletag||{cmd:[]};if(this.main.settings.adserver.loadPrerequisites&&!0!==this.dependenciesLoading){this.dependenciesLoading=!0;if(window.googletag&&"function"==typeof window.googletag.getVersion)d("Adserver: GPT already present, version: ",window.googletag.getVersion());else{const t=g("https://securepubads.g.doubleclick.net/tag/js/gpt.js","GPT").then((()=>{window.googletag.cmd.unshift((()=>{window.googletag.pubads().disableInitialLoad()}))}));e.push(t)}e.push(new Promise(((e,t)=>{window.googletag.cmd.push((()=>{window.googletag.pubads().disableInitialLoad();window.googletag.pubads().enableSingleRequest();window.googletag.pubads().enableAsyncRendering();window.googletag.enableServices();this.dependenciesLoading=!1;e()}))})).catch((e=>o("Googletag que init failed",e))))}if(this.main.settings.adserver.defineSlots){window.googletag.cmd.push((()=>{window.googletag.destroySlots()}));this.slotsDefined=new Promise(((e,t)=>{this.main.settings.adserver.defineSlots.forEach((e=>{document.getElementById(e.elementId)?window.googletag.cmd.push((()=>{window.googletag.defineSlot(e.path,e.sizes,e.elementId).addService(window.googletag.pubads())})):n(e.elementId+" not found in the page, probably intended")}));window.googletag.cmd.push((()=>{e()}))}));e.push(this.slotsDefined)}this.loading=Promise.all(e).then((()=>{n("Adserver: Googletag adapter loaded")})).catch((e=>o("Googletag failed to load",e)));return this.loading}async getAdsList(){await this.loading;return window.googletag.pubads().getSlots().map((e=>e.getSlotElementId()))}async call(){await this.loading;this.main.debugMode&&this.logSlotTable();this.eventHandler&&window.googletag.pubads().removeEventListener("slotRenderEnded",this.eventHandler);window.googletag.pubads().getSlots().forEach((e=>{const t=e.getSlotElementId();!1===this.displayed&&window.googletag.display(t);this.main.headerbidding&&E()&&this.addBid(t,e);this.main.regularAds[t]={element:document.getElementById(t),slot:e};this.slots[e.getAdUnitPath()]=e}));this.eventHandler=e=>this.adRenderDebug(e);window.googletag.pubads().addEventListener("slotRenderEnded",this.eventHandler);n("Adserver: GoogleTag display/refresh called");window.googletag.pubads().refresh();this.displayed=!0}async getElementId(e){return(await this.getAdsList()).includes(e)?e:null}adRenderDebug(e){if(this.main.debugMode){const t=e.slot.getSlotElementId();n("AdServer: googletag rendered into elementId "+t,e);setTimeout((()=>{this.prepareMetaData(t,e)}),1e3)}}addBid(e,t){const i=window.pbjs.getHighestCpmBids(e)[0];if(i){t.setTargeting("hb_pb_"+i.bidder,i.adserverTargeting.hb_pb.toString());"eco"!==this.main.settings.publisher.code&&t.setTargeting("pos",t.getAdUnitPath())}}gamReRender(e){const t=e.split("/");t.length<=3&&o("GAM returns only id part of path, this suggests that defineSlot names dont match. First slot will be used");const i=t[t.length-1],s=Object.keys(this.slots).filter((e=>-1!==e.indexOf(i)));if(s.length>0){const e=this.slots[s[0]];e.fromHB=!0;const t=e.getSlotElementId();this.main.headerbidding.reRender(t)}else o("Adserver: Slot not found")}prepareMetaData(e,t){const i={adapter:this.adapter,id:e,size:t.size,creativeId:t.creativeId};this.main.customAds[e]&&(i.customType=this.main.customAds[e].type);f(e,i)}logSlotTable(){const e=window.googletag.pubads().getSlots();if(e.length>0){a("Adserver: Found these GAM slots:");const t=[];e.forEach((e=>{let i="";e.getSizes().forEach((e=>{i+=`[${e.width},${e.height}], `}));t.push({path:e.getAdUnitPath(),element:e.getSlotElementId(),sizes:i.slice(0,-2)})}));console.table(t)}else d("Adserver: No GAM slots found")}}class M{constructor(e){this.adapter="sastracker";this.main=e;this.dependenciesLoading=!1;this.areaKey=e.settings.adserver.areaKey||"area";this.debugRenderAttempts=0;window.top.sasTracker=window.top.sasTracker||{};window.top.sasTracker.que=window.top.sasTracker.que||[]}load(){n("AdServer: SAStracker adapter loading");this.domLoaded=v();"vlm"===this.main.settings.publisher.code&&window.addEventListener("cpexAdRendered",(e=>{e.detail?.element&&e.detail.element.dataset&&(e.detail.element.dataset.loaded=!0)}));if(this.main.settings.adserver.loadPrerequisites&&!0!==this.dependenciesLoading){this.dependenciesLoading=!0;if(window.postscribe){d("Adserver: Postscribe already present");this.postscribeLoaded=Promise.resolve()}else this.postscribeLoaded=g("https://cdn.cpex.cz/package/prerequisites/postscribe.min.js","Postscribe").then((()=>{this.dependenciesLoading=!1}));this.loading=Promise.all([this.domLoaded,this.postscribeLoaded]).catch((e=>o("Loading requirements failed",e)))}else this.loading=this.domLoaded;this.loading.then((()=>{n("AdServer: SAStracker adapter loaded")}));return this.loading}async getAdsList(){const e=[];for(const t in window.AdsObject)"ball"!==t&&e.push(window.AdsObject[t][this.areaKey]);return e}async call(e){await this.loading;if(this.main.settings.adserver.delayCall){n("AdServer: Adserver call delayed by "+this.main.settings.adserver.delayCall);await new Promise((e=>setTimeout(e,this.main.settings.adserver.delayCall))).catch((e=>o("Delay timeout failed",e)))}if(!c(window.AdsObject))return o("AdServer: Missing window.AdsObject or ball property on it, call will fail");let t;if(l(e)){t=s(window.AdsObject);window.AdsObject=Object.fromEntries(Object.entries(window.AdsObject).filter((([t,i])=>e.includes(i[this.areaKey]))));window.AdsObject.ball=t.ball}this.main.settings.adserver.addConsent&&await this.addConsent();if(this.main.headerbidding&&E()){this.addBids();window.dispatchEvent(new window.Event("cpexBidsAdded"))}if(window.iinfo)window.iinfo.adverts.sas.sas.onCpexSasTrackerTrack();else if("echo"!==this.main.settings.publisher.code){"function"==typeof window.sasTracker.track?window.sasTracker.track():window.sasTracker.que.push((()=>{window.sasTracker.track()}));n("AdServer: SAS called with this AdsObject: ",window.AdsObject)}t&&(window.AdsObject=t)}async getElementId(e){return(await this.getAdsList()).includes(e)?e:null}adRenderDebug(e,t){if(this.main.debugMode)if(window.top.sasTracker.rr&&window.top.sasTracker.rr[e]&&document.getElementById(e)){const i=window.top.sasTracker.rr[e];n("AdServer: SAS rendered this ad:",i);"{"===i.res[0]&&(t.json=!0);const s=document.getElementById(e).getAttribute("data-target-id-moved");if(document.getElementById(s)){t.originalId=e;e=s}this.prepareMetaData(e,t,i.res)}else if(this.debugRenderAttempts<=5){this.debugRenderAttempts++;setTimeout((()=>{this.adRenderDebug(e,t)}),250)}}async refresh(e){if(!c(window.AdsObject)){o("AdServer: Missing window.AdsObject or ball property on it, call will fail");return!1}this.main.clearAds(e);this.main.headerbidding&&await this.main.headerbidding.refresh(e);this.call(e);n("AdServer: SAS refreshed with this AdsObject: ",window.AdsObject);return!0}isFromHB(e){return p(e)?.includes("HB")}render(e,t,i,s){n(`AdServer: SAStracker returned creative for ${e}, size: ${i}x${s}`);i=parseInt(i);s=parseInt(s);const a=this.isFromHB(t),d=parseInt(h(t,"SASF_ADVERTISERID"));try{setTimeout((()=>{this.adRenderDebug(e,{width:i,height:s,fromHB:a,sspId:d})}),250)}catch(e){console.error("Debug tags failed to render",e)}const o=!Object.values(this.main.settings.adserver.allowedSSPs).map((e=>parseInt(e))).includes(d);if(a||o){this.main.regularAds[e]={element:document.getElementById(e)};return!1}return this.main.render(e,t,i,s)}addBids(){for(const e in window.AdsObject){if("ball"===e)continue;const t=window.AdsObject[e],i=window.pbjs.getHighestCpmBids(t[this.areaKey])[0];if(i){t.hbid=i.cpm;t.bidTier=i.adserverTargeting.hb_pb;t.hbid_v=this.main.settings.adserver.bidderTable[i.bidderCode]||"unknown";t.bidderCode=i.bidderCode;i.size&&(t.bidderSize=i.size);i.dealId&&(t.bidDealId=i.dealId);i.vastUrl&&(t.hbVastUrl=encodeURIComponent(i.vastUrl))}else["hbid","bidTier","hbid_v","bidderCode","bidderSize","bidDealId"].forEach((e=>delete t[e]))}const e=window.pbjs.getUserIds();e.pubcid&&(window.AdsObject.ball.pcid=e.pubcid);e.id5id&&(window.AdsObject.ball.id5=e.id5id.uid);this.main.ab.group&&this.main.ab.sasKey&&(window.AdsObject.ball[this.main.ab.sasKey]=this.main.ab.group)}addConsent(){return new Promise(((e,t)=>{try{window.__tcfapi("addEventListener",2,((i,s)=>{if(s&&i&&i.tcString){window.AdsObject.ball.gdpr="1";window.AdsObject.ball.consent=i.tcString;e()}else t()}))}catch(e){o("AdServer: CMP not responding properly",e);t(e)}}))}prepareMetaData(e,t,i){const s={adapter:"sasTracker "+window.sasTracker.version?.substring(0,3),id:(t.originalId||e)+", fcid: "+h(i,"SASF_FCID"),size:t.width+"x"+t.height,sspId:t.sspId};t.json&&(s.json=!0);this.main.customAds[t.originalId||e]&&(s.customType=this.main.customAds[t.originalId||e].type);f(e,s)}}class z{constructor(e){this.main=e;this.adapter="sasic"}load(){n("Adserver: Sasic adapter loading");this.loading=v();this.loading.then((()=>{n("Adserver: Sasic adapter loaded")}));window._sasic_queue.push(["customRender",e=>{const t=h(e.code,"SASF_WIDTH"),i=h(e.code,"SASF_HEIGHT");return this.render(e.elementId,e.code,t,i)}]);return this.loading}async getAdsList(){return window._sasic.getAllPositions().map((e=>e.options?.hb_key)).filter((e=>!!e))}async call(){await this.loading;const e={};if(E())for(const t of await this.getAdsList()){const i=window.pbjs.getHighestCpmBids(t)[0];i&&(e[i.adUnitCode]={hbid:i.cpm,hbid_v:this.main.settings.adserver.bidderTable[i.bidderCode]||"unknown"})}window._sasic_queue.push(["loadAllHb",e]);n("AdServer: SAS called with these AdUnits: ",e)}async getElementId(e){return Object.values(window._sasic.get(["groups"])).map((e=>Object.values(e.positions))).flat().filter((e=>!!e)).find((t=>t.options.hb_key===e))?.elementId}async sasicReRender(e){this.main.headerbidding.reRender(await this.getElementId(e),e)}getElementsList(){return window._sasic.getAllPositions().map((e=>e.elementId))}isFromHB(e){return p(e).includes("HB")}render(e,t,i,s){n(`AdServer: Sashic returned creative for ${e}, size: ${i}x${s}`);i=parseInt(i);s=parseInt(s);const a=this.isFromHB(t),d=parseInt(h(t,"ADVID"));if(this.main.debugMode)try{n("AdServer: SAS rendered this ad: ",e);const o=h(t,"FCID"),r=t.match(/hb_key: (?<value>\S+)/m)?.groups?.value;setTimeout((()=>{this.prepareMetaData(e,{width:i,height:s,fromHB:a,sspId:d,fcId:o,hbKey:r})}),1e3)}catch(e){console.error("Debug tags failed to render",e)}const o=!Object.values(this.main.settings.adserver.allowedSSPs).includes(d);if(a||o){this.main.regularAds[e]={element:document.getElementById(e)};return!1}return this.main.render(e,t,i,s)}prepareMetaData(e,t){const i={adapter:"sasic",id:e+", fcid: "+t.fcId,size:t.width+"x"+t.height,advid:t.sspId};this.main.customAds[e]&&(i.customType=this.main.customAds[e].type);f(e,i)}}class H{constructor(e){this.main=e;this.adapter="paticka";this.loading=!0}load(){n("Adserver: Paticka adapter loading");this.loading=v();this.loading.then((()=>{n("Adserver: Paticka adapter loaded")}));return this.loading}async getAdsList(){return"object"==typeof window.Unidata.biddingData[0]?Object.keys(window.Unidata.biddingData[0]):[]}async call(e){await this.loading;if(window.Unidata?.biddingData){window.sasBidding=window.sasBidding||{};if(this.main.headerbidding&&E())for(const t of await this.getAdsList()){if(e&&!e.includes(t))continue;const i=window.pbjs.getHighestCpmBids(t)[0];if(i){const e={hbid:i.cpm,hbid_v:this.main.settings.adserver.bidderTable[i.bidderCode]||"unknown"};if(i.vastUrl)window.Ads.positions[t].prebidVAST=encodeURIComponent(i.vastUrl);else if(i.vastXml){const e=new Blob([i.vastXml],{type:"application/xml"});window.Ads.positions[t].prebidVAST=encodeURIComponent(URL.createObjectURL(e))}window.sasBidding[t]=e}}}else o("Missing Unidata.biddingData");"function"==typeof window.sasBiddingDone?window.sasBiddingDone():o("sasBiddingDone function not present");n("AdServer: SAS called with these AdUnits: ",window.sasBidding)}async getElementId(e){return(await this.getAdsList()).includes(e)?e:null}async refresh(e){window.sasBidding={};this.main.headerbidding&&await this.main.headerbidding.refresh(e);this.call(e);n("AdServer: Adserver refreshed for these adUnits: ",e);return!0}patickaReRender(e,t){t=t||e;this.main.regularAds[t]={element:document.getElementById(e||t)};this.main.headerbidding.reRender(e,t);this.main.debugMode&&setTimeout((()=>{this.prepareMetaData(e||t)}),250)}renderMafraSlideup(e){if(window.Ads){const t=document.documentElement.clientWidth||window.innerWidth;let i=e.width,s=e.height,n=1;if(e.width>t){n=t/e.width;i=e.width*n;s=e.height*n}const a=()=>{const t=document.getElementById(`${e.adUnitCode}_iframe_hb`);if(t){this.main.headerbidding.pbjs.renderAd(t.contentWindow.document,e.adId);const i=t.contentDocument.createElement("style");i.textContent=`body { transform: scale(${n}); transform-origin: top left }`;t.contentDocument.head.appendChild(i)}},d=`max-width:${i}px; max-height:${s}px; `,o=`<iframe id='${e.adUnitCode}_iframe_hb' width='${i}' height='${s}' style='${d}' align='middle' scrolling='no' frameborder='0' marginwidth='0' marginheight='0' allowtransparency='true'></iframe>`;window.Ads.mobilniSticky({onShow:a,html:o,async:e.adUnitCode,noCookie:!0,transparent:!0,instant:!0})}else o("Missing Ads library")}prepareMetaData(e){const t={adapter:"paticka",id:e};this.main.customAds[e]&&(t.customType=this.main.customAds[e].type);f(e,t)}}class R{constructor(e){this.main=e;this.adapter="test";this.creatives={banner:"<img src='https://playground.cpex.cz/creatives/square.jpg'>",interscroller:"<img src='https://playground.cpex.cz/creatives/interscroller.jpg'>",skin:"<img src='https://playground.cpex.cz/creatives/skin.jpg'>",native:"<script>\n        window.postMessage({\n          clickTag: 'https://www.cpex.cz',\n          creativeType: 'native',\n          data: 'ewogICJuYXRpdmUiOiB7CiAgICAidmVyIjogIjEuMiIsCiAgICAibGluayI6IHsKICAgICAgInVybCI6ICJodHRwczovL3d3dy5jcGV4LmN6LyIKICAgIH0sCiAgICAiYXNzZXRzIjogWwogICAgewogICAgICAicmVxdWlyZWQiOiAxLAogICAgICAidGl0bGUiOiB7CiAgICAgICAgInRleHQiOiAiQ1BFeCBOYXRpdmUgRXhhbXBsZSBBZCBIZWFkbGluZSIsCiAgICAgICAgImxlbiI6IDMxCiAgICAgIH0KICAgIH0sIHsKICAgICAgImRhdGEiOiB7CiAgICAgICAgInR5cGUiOiAyLAogICAgICAgICJ2YWx1ZSI6ICJCYXNlZCBvbiBpYWIgT3BlblJUQiBEeW5hbWljIE5hdGl2ZSBBZHMgQVBJIDEuMiBzcGVjaWZpY2F0aW9uLCBmb3IgYnJvYWQgcmV1c2FiaWxpdHkuIgogICAgICB9CiAgICB9LCB7CiAgICAgICJpbWciOiB7CiAgICAgICAgInR5cGUiOiAzLAogICAgICAgICJ1cmwiOiAiaHR0cHM6Ly9wbGF5Z3JvdW5kLmNwZXguY3ovY3JlYXRpdmVzL25hdGl2ZS5qcGciLAogICAgICAgICJ3IjogNDAwLAogICAgICAgICJoIjogMzAwCiAgICAgIH0KICAgIH1dCiAgfQp9'\n        }, '*')\n      <\/script>",slideup:"<img src='https://playground.cpex.cz/creatives/billboard.jpg'>"}}load(){n("Adserver: Test adapter loading");this.main.settings.headerbidding.enabled=!1;if(window.AdsObject||window.googletag){const e=window.AdsObject?new M(this.main):new P(this.main);this.loading=e.load().catch((e=>o("TempAdapter failed to load",e))).then((()=>{n("Adserver: Test adapter loaded")}));return this.loading}o("Adserver: Cannot find SAS or GAM adUnits")}async call(){this.skinFound=!1;window.googletag&&await v();await this.loading;n("Adserver: Called Test adserver");if(this.main.settings.adserver.delayCall){n("AdServer: Adserver call delayed by "+this.main.settings.adserver.delayCall);await new Promise((e=>setTimeout(e,this.main.settings.adserver.delayCall))).catch((e=>o("Delay timeout failed",e)))}if(window.AdsObject)for(const e in window.AdsObject)"ball"!==e&&this.testRender(window.AdsObject[e].area);else window.googletag?window.googletag.pubads().getSlots().forEach((e=>{const t=e.getSlotElementId();this.slots[e.getAdUnitPath()]=t;this.testRender(t)})):o("Adserver: Cannot find SAS or GAM setup. Have to get adUnits from somewhere")}showMetaData(e,t){setTimeout((()=>{const i={adapter:"test",area:e,size:t.width+"x"+t.height};this.main.customAds[e]&&(i.customType=this.main.customAds[e].type);f(e,i)}),500)}testRender(e){const t=(e,t,i,s)=>{this.main.renderAny(e,t,i,s);this.showMetaData(e,{width:i,height:s})};if(void 0!==this.main.settings.formats&&r(this.main.settings.formats.testCreatives)&&r(this.main.settings.formats.testCreatives[e])){const i=this.main.settings.formats.testCreatives[e];i.preset&&this.creatives[i.preset]?t(e,this.creatives[i.preset],i.width,i.height):i.html&&t(e,i.html,i.width,i.height)}else if(e.indexOf("rect")>-1||e.indexOf("square")>-1)t(e,this.creatives.banner,300,300);else if(e.indexOf("interscroller")>-1)t(e,this.creatives.interscroller,480,820);else if((e.indexOf("leaderboard")>-1||e.indexOf("skin")>-1)&&!1===this.skinFound){t(e,this.creatives.skin,2e3,1400);this.skinFound=!0}else e.indexOf("native")>-1?t(e,this.creatives.native,548,150):e.indexOf("slideup")>-1?t(e,this.creatives.slideup,970,250):e.indexOf("vignette")>-1&&t(e,this.creatives.native,300,300)}render(e,t,i,s){}gamReRender(e){}}class _{constructor(e,t){this.data=e;this.adElement=t;this.modalOpen=!1;this.parameters={};if(0===e?.adrender&&e?.transparency){t.style.position="relative";e.transparency.forEach((e=>{[1,2,3].forEach((t=>{if(e.dsaparams.includes(t)){this.parameters[t]=this.parameters[t]||[];this.parameters[t].push(e.domain)}}))}));setTimeout((()=>{this.render(t)}),100)}}render(){T("style",this.adElement,{innerHTML:U});this.wrapper=T("div",this.adElement,{class:"cpexDSA"});this.iconEl=T("button",this.wrapper,{class:"cpexDSA_icon info",innerHTML:D});this.iconEl.addEventListener("click",(()=>this.toggleModal()))}toggleModal(){this.modalOpen?this.closeModal():this.openModal();this.modalOpen=!this.modalOpen}openModal(){this.iconEl.innerHTML=O;this.iconEl.classList.remove("info");this.modalEl=T("div",this.wrapper,{class:"cpexDSA_modal"});T("h3",this.modalEl,{innerHTML:"O této reklamě"});const e=T("table",this.modalEl,{class:"cpexDSA_info"});this.data.behalf&&T("tr",e,{innerHTML:`<td>Inzerent</td><td>${this.data.behalf}</td>`});T("tr",e,{innerHTML:`<td>Plátce</td><td>${this.data.paid}</td>`});T("h3",this.modalEl,{innerHTML:"Použité cílení"});const t=T("ul",this.modalEl);this.parameters[1]&&T("li",t,{innerHTML:`Informace o tom, jaké stránky si prohlížíte. <span>(${this.parameters[1].join(", ")})</span>`});this.parameters[2]&&T("li",t,{innerHTML:`Informace o typu Vašeho zařízení nebo prohlížeče, IP adrese nebo přibližné poloze (dle IP adresy). <span>(${this.parameters[2].join(", ")})</span>`});this.parameters[3]&&T("li",t,{innerHTML:`Informace o Vaší poloze. <span>(${this.parameters[3].join(", ")})</span>`})}closeModal(){this.iconEl.innerHTML=D;this.iconEl.classList.add("info");this.wrapper.removeChild(this.modalEl)}}const D="<svg width='3' height='14'><ellipse fill='#fff' cx='1.5' cy='1.5' rx='1.5' ry='1.5' /><rect fill='#fff' height='8' width='3' y='6' rx='1.5' ry='1.5' /></svg>",O="<svg width='14' height='14'><rect fill='#666' height='14' width='3' x='5.5' y='0' rx='1.5' ry='1.5' transform='rotate(45 7 7)' /><rect fill='#666' height='14' width='3' x='5.5' y='0' rx='1.5' ry='1.5' transform='rotate(-45 7 7)' /></svg>",U="\n  .cpexDSA, .cpexDSA_icon, .cpexDSA_modal {\n    position: absolute;\n    top: 0px;\n    right: 0px;\n    z-index: 999999;\n  }\n    .cpexDSA_icon {\n      width: 20px;\n      height: 30px;\n      display: flex;\n      align-items: center;\n      justify-content: center;\n      border: none;\n      background: none !important;\n      padding: 0px;\n      cursor: pointer;\n      z-index: 9999999;\n    }\n      .cpexDSA_icon:hover {\n        transform: scale(1.2);\n      }\n      .cpexDSA_icon.info svg {\n        filter: drop-shadow(0.5px 0.5px 1.5px #000A);\n      }\n    .cpexDSA_modal {\n      width: 300px;\n      padding: 20px;\n      padding-top: 0px;\n      box-sizing: border-box;\n      background-color: #f5f5f5;\n      font-size: 13px;\n      box-shadow: 2px 2px 6px #0003;\n      text-align: left;\n    }\n    .cpexDSA h3 {\n      margin-bottom: 5px;\n      font-size: 16px;\n      text-align: center;\n      text-transform: uppercase;\n    }\n    .cpexDSA table {\n      width: 100%;\n    }\n    .cpexDSA ul {\n      padding: 0px 0px 0px 15px;\n    }\n    .cpexDSA li {\n      margin-bottom: 5px;\n    }\n    .cpexDSA li span {\n      color: #666;\n      font-size: 12px;\n    }\n";class N{constructor(e){this.main=e;this.aliases={};this.adUnits=[];this.prebidLoaded=!1;this.prebidLoadedPromise=new Promise(((e,t)=>{this.loadedResolve=e;this.loadedReject=t}));this.ipAddress={}}async load(){this.pbjs=window.pbjs=window.pbjs||{};window.pbjs.que=window.pbjs.que||[];window.pbjs.que.push((()=>{this.prebidLoaded=!0;this.loadedResolve();n("Headerbidding: Loaded")}));this.prebidLoaded||(E()?d("Headerbidding: Publisher using own Prebid, version: ",window.pbjs.version):await g(this.main.settings.headerbidding.prebidPath,"Prebid").catch((e=>{(t=this.main.settings.headerbidding.prebidPath,new Promise(((e,i)=>{try{const i=new window.XMLHttpRequest;i.onreadystatechange=()=>{if(4===i.readyState)switch(i.status){case 0:return e(!0);case 200:return e(!1)}};i.open("GET",t,!0);i.setRequestHeader("Cache-Control","no-cache");i.setRequestHeader("Access-Control-Allow-Origin","*");i.send()}catch(e){i(d("AdBlock testing failed",e))}}))).then((t=>{t?this.hasAdblock=this.main.hasAdblock=!0:o("Prebid failed to load, probably wrong path",e);this.loadedResolve()})).catch((e=>{d("Adblock blocked Prebid from loading")}));var t})))}async configure(){if(this.hasAdblock)return;if(!this.pbjs||!this.pbjs.setConfig){this.load().catch((e=>o("Loading of Prebid failed",e)));await this.prebidLoadedPromise}const e=document.querySelector('meta[name="keywords"]');this.keywords=[...e?.content?e.content.split(","):[],...window.s_keywords?window.s_keywords:[],...window.AdsObject?.ball?.geneawords?window.AdsObject.ball.geneawords.split(","):[]];this.keywords=this.keywords.map((e=>e.trim()));if(this.pbjs.configured){this.pbjs.removeAdUnit();n("Headerbidding: Reset")}else{try{await new Promise((e=>{window.__tcfapi("addEventListener",2,((t,i)=>{t&&i&&(this.cpexConsent=t.vendor.consents[570]);e()}),[570]);setTimeout((()=>{e()}),1e3)}))}catch(e){o("TCF API not available",e)}try{this.cpexConsent&&(this.ipAddress=await async function(){let e=window.localStorage.getItem("pdip");if(e){e=JSON.parse(e);if(e.ip4||e.ip6)return e}const t=await fetch("https://api64.ipify.org?format=json");if(200===t.status){const e=await t.json();if(e.ip.includes(".")){window.localStorage.setItem("pdip",JSON.stringify({ip4:e.ip}));return{ip4:e.ip}}if(e.ip.includes(":")){window.localStorage.setItem("pdip",JSON.stringify({ip6:e.ip}));return{ip6:e.ip}}return{}}return{}}())}catch(e){o("IP API not reached",e)}const e={debug:this.main.debugMode,bidderTimeout:this.main.settings.headerbidding.auctionTimeoutMs||1e3,consentManagement:{gdpr:{cmpApi:"iab",defaultGdprScope:!0,rules:[{purpose:"storage",enforcePurpose:!1,enforceVendor:!1},{purpose:"basicAds",enforcePurpose:!1,enforceVendor:!1},{purpose:"measurement",enforcePurpose:!1,enforceVendor:!1}],timeout:this.main.settings.headerbidding.cmpLoadTimeoutMs||2e3,actionTimeout:this.main.settings.headerbidding.cmpActionTimeoutMs||0}},currency:{adServerCurrency:this.main.settings.headerbidding.currency,defaultRates:{USD:{USD:1,CZK:23},EUR:{USD:1,CZK:24}}},schain:{config:{nodes:[{sid:this.main.settings.publisher.sellerId,asi:"cpex.cz",hp:1}],ver:"1.0",complete:1},validation:"strict"},cache:{url:"https://prebid.adnxs.com/pbc/v1/cache"},appnexusAuctionKeywords:{keyword:this.keywords},ortb2:{},enableTIDs:!0};this.main.settings.headerbidding.priceFloorsUrl&&(e.floors={endpoint:{url:this.main.settings.headerbidding.priceFloorsUrl},auctionDelay:100,additionalSchemaFields:{bidder:e=>e.bidder}});const t=this.main.settings.headerbidding.userIDs;if(Array.isArray(t)&&t.length&&this.pbjs.installedModules.includes("userId")){e.userSync={userIds:[],filterSettings:{iframe:{bidders:["connectad"],filter:"include"}}};const i={id5Id:{name:"id5Id",storage:{name:"id5id",type:"html5",expires:365,refreshInSeconds:28800},externalModuleUrl:"https://cdn.id5-sync.com/api/1.0/id5PrebidModule.js"},sharedId:{name:"sharedId",storage:{name:"_sharedid",type:"cookie",expires:365,refreshInSeconds:28800}},criteo:{name:"criteo"},czechAdId:{name:"czechAdId"}};if(t.includes("id5Id")){i.id5Id.params={partner:"mafra"===this.main.settings.publisher.code?469:250};if(this.cpexConsent)try{i.id5Id.params.pd=await async function(e){const t={9:window.location.hostname,8:window.location.href,12:navigator.userAgent};e.ip4&&(t[10]=e.ip4);e.ip6&&(t[11]=e.ip6);const i=Object.keys(t).map((e=>e+"="+encodeURIComponent(t[e]))).join("&");return window.btoa(i)}(this.ipAddress)}catch(e){o("ID5 partner data not loaded",e)}}t.forEach((t=>{t in i&&e.userSync.userIds.push(i[t])}))}if(r(window.sellerDefinedAudiences))if(window.sellerDefinedAudiences.site){e.ortb2=window.sellerDefinedAudiences;if(Array.isArray(window.sellerDefinedAudiences.site.content?.data[0]?.segment)){this.sda=window.sellerDefinedAudiences.site.content.data[0].segment.map((e=>e.id)).join();e.appnexusAuctionKeywords.sda=this.sda}}else e.ortb2={site:{content:{data:[window.sellerDefinedAudiences]}}};e.ortb2.device={ua:navigator.userAgent};if(this.main.ab.group){e.ortb2.user=e.ortb2.user??{};e.ortb2.user.ext=e.ortb2.user.ext??{};e.ortb2.user.ext.data=e.ortb2.user.ext.data??{};e.ortb2.user.ext.data.cpexAB=this.main.ab.group;e.appnexusAuctionKeywords.cpexAB=this.main.ab.group}if(this.main.settings.dsa.enabled){e.ortb2.regs=e.ortb2.regs||{};e.ortb2.regs.ext=e.ortb2.regs.ext||{};e.ortb2.regs.ext.dsa=this.main.settings.dsa.customConfig||{dsarequired:1,pubrender:1,datatopub:1,transparency:[{domain:location.hostname.split(".").reverse().splice(0,2).reverse().join("."),dsaparams:[1,2]}]}}this.pbjs.setConfig(e);if("mafra"===this.main.settings.publisher.code){this.pbjs.setBidderConfig({bidders:["adform"],config:{schain:{validation:"relaxed",config:{ver:"1.0",complete:1,nodes:[{asi:"adform.com",sid:"2723",hp:1}]}}}});this.pbjs.setBidderConfig({bidders:["omg-adform"],config:{schain:{validation:"relaxed",config:{ver:"1.0",complete:1,nodes:[{asi:"adform.com",sid:"2700",hp:1}]}}}});this.pbjs.setBidderConfig({bidders:["fragile-adform"],config:{schain:{validation:"relaxed",config:{ver:"1.0",complete:1,nodes:[{asi:"adform.com",sid:"2950",hp:1}]}}}});this.pbjs.setBidderConfig({bidders:["smart"],config:{schain:{validation:"off",config:{ver:"1.0",complete:1}}}});this.ipAddress.ip4&&this.pbjs.setBidderConfig({bidders:["adform","omg-adform","fragile-adform"],config:{ortb2:{device:{ip:this.ipAddress.ip4}}}});this.ipAddress.ip6&&this.pbjs.setBidderConfig({bidders:["adform","omg-adform","fragile-adform"],config:{ortb2:{device:{ipv6:this.ipAddress.ip6}}}})}"csfd"===this.main.settings.publisher.code&&this.pbjs.setBidderConfig({bidders:["projectagora"],config:{schain:{validation:"strict",config:{ver:"1.0",complete:1,nodes:[{asi:"projectagora.com",sid:"csfd.sk"===this.main.settings.website.name?"110439":"110438",hp:1}]}}}});this.pbjs.setBidderConfig({bidders:["performax"],config:{schain:{config:{ver:"1.0",complete:1,nodes:[{asi:"performax.cz",sid:"2459",hp:1}]}}}});this.main.settings.headerbidding.analytics.includes("id5Analytics")&&this.pbjs.installedModules.includes("id5AnalyticsAdapter")&&this.pbjs.enableAnalytics({provider:"id5Analytics",options:{partnerId:250,eventsToTrack:["auctionEnd","bidWon"]}});this.main.settings.headerbidding.analytics.includes("cpexAnalytics")&&this.pbjs.installedModules.includes("cpexAnalyticsAdapter")&&this.pbjs.enableAnalytics({provider:"cpexAnalytics"});this.main.settings.headerbidding.analytics.includes("pubmatic")&&this.pbjs.installedModules.includes("pubmaticAnalyticsAdapter")&&this.pbjs.enableAnalytics({provider:"pubmatic",options:{publisherId:158732}});this.pbjs.configured=!0}this.pbjs.onEvent("beforeRequestBids",(e=>{this.pbjs.bidderSettings={standard:{adserverTargeting:[{key:"hb_pb",val:e=>this.setBidTier(e)},{key:"hb_adid",val:e=>e.adId}]},criteo:{storageAllowed:!0,fastBidVersion:"latest"},projectagora:{storageAllowed:!0}};this.main.settings.headerbidding.bidderSettings&&(this.pbjs.bidderSettings={...this.pbjs.bidderSettings,...this.main.settings.headerbidding.bidderSettings});const t=this.pbjs.getUserIds();e.forEach((e=>{e.bids.forEach((e=>{"rubicon"!==e.bidder&&"rubicon"!==e.bidderModuleName||this.fillRubiconInventory(e,t);"appnexus"===e.bidder&&(e.params.keywords=[this.keywords.join(",")])}));const i=this.pbjs.getConfig("appnexusAuctionKeywords");i.id5=t.id5Id?1:0;i.cxid=t.czechAdId?1:0;this.pbjs.setConfig({appnexusAuctionKeywords:i})}))}));await this.setAdUnits().catch((e=>o("Setting of ad units failed",e)));n("Headerbidding: Configured")}calculateBucket(e){const t=e-7;if(t<=0)return 1;return function(e,t,i){return e>i?i:e<=t?t:e}(Math.round(Math.log(t)/Math.log(1.39)),1,16)}getBucket(e){const t=this.main.settings.headerbidding.customBuckets,i=t.findIndex((t=>e<t));return-1===i?t.length+1:i+1}setBidTier(e){const t="CZK"===this.main.settings.headerbidding.currency?e.cpm:this.pbjs.convertCurrency(e.cpm,this.main.settings.headerbidding.currency,"CZK");if("number"==typeof t)return Array.isArray(this.main.settings.headerbidding.customBuckets)?this.getBucket(t):this.calculateBucket(t);o("cpmCZK is not a number")}call(){n("Headerbidding: Called");if(this.hasAdblock)return this.callAdserverIfEnabled();const e=new Promise((e=>setTimeout(e,this.main.settings.headerbidding.cmpLoadTimeoutMs+this.main.settings.headerbidding.cmpActionTimeoutMs+this.main.settings.headerbidding.auctionTimeoutMs)));if(l(this.adUnits)){const t=this.pbjs.requestBids();Promise.race([t,e]).then((e=>{if(e&&e.bids)this.bidsBack(!0,e.bids);else{o("Headerbidding: Prebid failed to return bids");this.callAdserverIfEnabled()}}))}else{d("Headerbidding: No adUnits, skipping auction");this.callAdserverIfEnabled()}}callAdserverIfEnabled(){this.main.adserver&&!0===this.main.settings.adserver.enabled&&this.main.adserver.call()}async refresh(e){n("Headerbidding: Called");const t=await this.pbjs.requestBids({adUnitCodes:e});if(t.bids){const i=await Promise.all(e.map((async e=>await this.main.adserver.getElementId(e))));this.main.clearAds(i);this.bidsBack(!1,t.bids)}else d("Headerbidding: No valid adUnits, auction skipped");return!0}filterAdUnitsBeforeAuction(e){const t=e=>{return t=e.cookie,(t=new RegExp("(?:^|;\\s*)"+(""+t).replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")+"=([^;]*)").exec(document.cookie))&&t[1];var t},i=(e,t)=>{n("Headerbidding: Filtered out "+e.code+", reason: "+t,e)};return e.filter((e=>{if(r(e.filter)){if((s=e.filter).maxWidth&&window.innerWidth>parseInt(s.maxWidth)){i(e,"Is above specified maximum width");return!1}if((e=>!!e.minWidth&&window.innerWidth<parseInt(e.minWidth))(e.filter)){i(e,"Is below specified minimum width");return!1}if((e=>!!e.urlIs&&void 0!==e.urlIs.split(",").find((e=>e===window.location.host+window.location.pathname)))(e.filter)){i(e,"URL is one of the location strings");return!1}if((e=>!!e.urlIsNot&&void 0===e.urlIsNot.split(",").find((e=>e===window.location.host+window.location.pathname)))(e.filter)){i(e,"URL is not one of the location strings");return!1}if((e=>!!e.urlHas&&void 0!==e.urlHas.split(",").find((e=>-1!==window.location.href.indexOf(e))))(e.filter)){i(e,"URL contains at least one of the strings");return!1}if((e=>!!e.urlHasNot&&e.urlHasNot.split(",").every((e=>-1===window.location.href.indexOf(e))))(e.filter)){i(e,"URL does not contain any of the strings");return!1}if((e=>!(!window.cpexAdUnitParam||!e.variable)&&window.cpexAdUnitParam===e.variable)(e.filter)){i(e,"Page does not contain required variable");return!1}if(t(e.filter)){i(e,"Page contains filtering cookie");return!1}}var s;return!0}))}filterAdUnitsAfterAuction(e){this.adUnits.forEach((t=>{if(r(t.filter)&&t.filter.skin){if(e.find((e=>this.main.formats.isSkin(e.width,e.height)))){this.pbjs.removeAdUnit(t.code);n("Headerbidding: Filtered out an adUnit, reason: Skin present",t)}}}))}async setAdUnits(){this.adUnits=[];if(!this.main.settings.headerbidding.adUnits)return o("Headerbidding: Failed, no AdUnits found");if(!Array.isArray(this.main.settings.headerbidding.adUnits))return o("Headerbidding: Failed, AdUnits are not an array");const e=this.filterAdUnitsBeforeAuction(s(this.main.settings.headerbidding.adUnits));let t=[];this.main.adserver&&(t=await this.main.adserver.getAdsList().catch((e=>o("Ads list not returned",e))));e.length>0?e.forEach((e=>{if(document.getElementById(e.code)||t.includes(e.code)){Object.keys(e.mediaTypes).includes("native")&&(e.mediaTypes.native={ortb:{ver:"1.2",context:1,plcmttype:1,assets:[{id:1,required:1,img:{type:3,wmin:199,hmin:199}},{id:2,required:1,title:{len:90}},{id:3,required:0,data:{type:2}},{id:4,required:0,data:{type:1}}],eventtrackers:[{event:1,methods:[1]}],privacy:1}});if(Object.keys(e.mediaTypes).includes("video")){const t="outstream"===e.mediaTypes.video.type?"outstream":"instream";e.mediaTypes.video={plcmt:1,placement:1,startdelay:0,context:t,mimes:["video/mp4","video/x-flv"],protocols:[1,2,3,4,5,6,7,8],api:[1,2,3,4,5],linearity:1,...e.mediaTypes.video};this.pbjs.setConfig({video:{providers:[{divId:e.video.divId,vendorCode:2,playerConfig:{params:{adPluginConfig:{numRedirects:10,debug:!0},vendorConfig:{controls:!0,autoplay:!1,preload:"auto"}}}}]}});this.pbjs.onEvent("videoSetupFailed",(e=>{d("Player setup failed: ",e)}));this.pbjs.onEvent("videoBidError",(e=>{d("An Ad Error came from a Bid: ",e)}))}this.adUnits.push(e)}})):this.adUnits=e;for(const e of this.adUnits)for(const t of e.bids){"r2b2"===t.bidder&&this.main.adserver.getElementId&&(t.params.element="#"+await this.main.adserver.getElementId(e.code));if(t.bidderModuleName&&!this.aliases[t.bidder]){this.aliases[t.bidder]=t.bidderModuleName;const e={};t.bidder.includes("adform")&&(e.gvlid=50);t.bidder.includes("rubicon")&&(e.gvlid=52);t.bidder.includes("pubmatic")&&(e.gvlid=76);this.pbjs.aliasBidder(t.bidderModuleName,t.bidder,e)}}n("AdUnits for Prebid added",this.adUnits);this.pbjs.addAdUnits(this.adUnits);this.pbjs.CPEX_adUnits=this.adUnits}fillRubiconInventory(e,t){e.params.inventory={domain:[window.location.hostname],gdpr:this.cpexConsent?[1]:[0]};this.keywords.length>0&&(e.params.inventory.keyword=[this.keywords.join(",")]);this.sda&&(e.params.inventory.iab_cont=this.sda);0!==Object.keys(t).length&&(e.params.inventory={...e.params.inventory,cxidc:[t.czechAdId?1:0],crid:[t.criteoId?1:0],shid:[t.sharedid?1:0],pcid:[t.pubcid?1:0],id5:[void 0!==t.id5id&&"0"!==t.id5id.uid&&window.localStorage.getItem("id5id")?1:0]});this.main.ab.group&&(e.params.inventory.cpexAB=this.main.ab.group)}bidsBack(e,t,i,s){const a=this.pbjs.getHighestCpmBids();this.filterAdUnitsAfterAuction(a);this.saveBids(t);this.adUnits.forEach((e=>{const t=a.find((t=>t.adUnitCode===e.code));if("video"===t?.mediaType){["sasic","sastracker","paticka"].includes(this.main.settings.adserver.adapter)&&(t.sasVendor=this.main.settings.adserver.bidderTable[t.bidderCode]||"unknown");window.dispatchEvent(new window.CustomEvent("cpexAuctionDoneVideo",{detail:t}))}}));!1===this.main.settings.adserver.enabled?this.adUnits.forEach((e=>{const t=e.code,i=document.getElementById(t);if(i){this.main.regularAds[t]={element:i};const e=this.winningBids[t],s=this.main.settings.headerbidding.passbacks[t];e?this.reRender(t):"function"==typeof s&&s()}else d("Headerbidding: Element for rendering not found")})):e&&this.main.adserver.call();n("Headerbidding: BidsBack")}saveBids(e={}){this.winningBids={};this.winningBidsVideo={};this.adUnits.forEach((e=>{const t=this.pbjs.getHighestCpmBids(e.code)[0];if(t){this.winningBids[e.code]=t;this.main.settings.adserver.bidderTable&&(t.sasVendor=this.main.settings.adserver.bidderTable[t.bidderCode]||"unknown");"video"===t.mediaType&&(this.winningBidsVideo[e.code]=t)}}));this.pbjs.winningBids=this.winningBids;if(this.main.debugMode){const t=[],i=[];Object.values(e).forEach((e=>{let s={cpm:0};e.bids.forEach((e=>{e.cpm>s.cpm&&(s=e)}));if(s.adUnitCode){t.push({adUnit:s.adUnitCode,bidderCode:s.bidderCode,width:s.width,height:s.height,domain:s.meta?.advertiserDomains?.[0],cpm:s.cpm,originalCpm:s.originalCpm,adId:s.adId,currency:s.currency,ttl:s.ttl});i.push(s.requestId)}}));a(`Headerbidding: Current auction winning bids (${Object.keys(t).length}):`);console.table(t);const s=[];Object.values(this.winningBids).forEach((e=>{i.includes(e.requestId)||s.push({adUnit:e.adUnitCode,bidderCode:e.bidderCode,width:e.width,height:e.height,domain:e.meta?.advertiserDomains?.[0],cpm:e.cpm,originalCpm:e.originalCpm,adId:e.adId,currency:e.currency,ttl:e.ttl})}));a(`Headerbidding: Cached winning bids (${Object.keys(s).length}):`);console.table(s)}}reRender(e,t){const i=t||e;e=e||t;if(document.getElementById(e)){const t=this.main.regularAds[e]||this.main.registerAd(e),s=this.winningBids[i];if(s?.adId){if(this.main.settings.dsa.enabled&&this.main.settings.dsa.render){const e=s.ext?.dsa||s.meta?.dsa;e&&(t.dsa=new _(e,t.element))}const a=this.main.formats.match(e,s.width,s.height,s.bidderCode);if("native"===a||s.native){const t=this.main.formats.create("native",e,s.width,s.height);this.main.customAds[e]=t;let i=s.native;try{if(!i&&"{"===s.ad[0]){i=JSON.parse(s.ad);s.native=i.native}}catch(e){o("Headerbidding: Smart Native - ad data not parsed",e)}t.render(i,s.bidderCode);s.native&&t.addPrebidEvents(s);n("Headerbidding: True Native Ad reRendered from HB: ",s.adUnitCode)}else if("mafra"===this.main.settings.publisher.code&&"slideup"===a)if(this.main.adserver.renderMafraSlideup)this.main.adserver.renderMafraSlideup(s);else{A(e);const i=this.prepareIframe(e,t,s.width,s.height);this.pbjs.renderAd(i.contentWindow.document,s.adId)}else{A(e);const n=a?this.main.formats.prepareIframe(a,e,s.width,s.height,i):this.prepareIframe(e,t,s.width,s.height);this.pbjs.renderAd(n.contentWindow.document,s.adId)}n("Headerbidding: Ad reRendered from Prebid adUnit: ",i);window.dispatchEvent(new window.CustomEvent("cpexAdReRendered",{detail:t}))}else d("Headerbidding: Winning bid not found, or missing adId");this.main.debugMode&&setTimeout((()=>{this.prepareMetaData(s,e)}),50)}else o("Headerbidding: Element for "+i+" not found, cannot update it with HB creative")}prepareIframe(e,t,i,s,n){t.iframe=x(t.element,{id:e+"_iframe_hb",width:i,height:s,...n});t.iframeCSS&&(t.iframe.style.cssText=t.iframeCSS);return t.iframe}prepareMetaData(e,t,i={}){e&&(i.hb={bidder:e.bidder,cpm:e.cpm,size:(e.width||"0")+"×"+(e.height||"O")});this.main.customAds[t]&&(i.customType=this.main.customAds[t].type);f(t,i)}}class F{constructor(e,t,i,s){this.type="skin";this.elementId=e;this.settings=t.formats.skin;this.settings.backgroundEl=this.settings.backgroundEl||document.body;this.width=i;this.height=s;this.loaded=!1;this.hidden=[];this.offset=0;this.iframeCSS=`width: ${i}px; height: ${s}px; border:none; display:block; overflow:hidden; margin-left: 50%; transform: translateX(-50%); max-width: initial; `;n("Skin: Caught Skin custom format, in elementId "+e)}prepareIframe(){if(!this.validateSettings(this.settings))return o("Skin: Incorrect skin settings: "+JSON.stringify(this.settings));this.backgroundEl=this.settings.backgroundEl||document.body;if(S(this.settings.contentEl)){this.contentEl=this.settings.contentEl;this.contentStyleBackup=window.getComputedStyle(this.contentEl)}this.settings.generalCSS&&(this.generalCSSEl=m(this.settings.generalCSS));Array.isArray(this.settings.hide)&&this.settings.hide.length>0&&this.settings.hide.forEach((e=>{if(S(e)){this.hidden.push({element:e,display:e.style.display});e.style.display="none"}}));this.element=document.createElement("div");this.element.id="cpex-skin";this.getOffset();this.element.style.cssText=`position: fixed; top: ${this.offset}px; left: 0px; width: 100%; ${"number"==typeof this.settings.zIndex?"z-index:"+this.settings.zIndex:""};`;this.backgroundEl.prepend(this.element);const e=document.getElementById(this.elementId);e&&e.setAttribute("data-target-id-moved",this.element.id);this.contentEl&&(this.contentEl.style.cssText=this.settings.contentCSS);this.iframe=x(this.element,{id:this.elementId+"-iframe"},(e=>{this.loaded=!0;n("Skin: Rendered into ",this.backgroundEl)}));this.iframe.style.cssText=this.iframeCSS;if(this.settings.offset&&this.settings.offsetScroll){this.updateOffset();window.addEventListener("scroll",(()=>{this.updateOffset()}))}return this.iframe}getOffset(){"function"==typeof this.settings.offset?this.offset=this.settings.offset():"number"==typeof this.settings.offset&&(this.offset=this.settings.offset)}updateOffset(){this.element.style.top=window.scrollY<this.offset?this.offset-window.scrollY+"px":"0px"}reset(){this.element.remove();this.contentEl&&(this.contentEl.style=this.contentStyleBackup);if(this.generalCSSEl){this.generalCSSEl.remove();delete this.generalCSSEl}this.hidden.forEach((e=>{e.element.style.display=e.display}));const e=window.cpexPackage.customAds;e&&delete e[this.elementId]}validateSettings(e){return r(e)&&S(e.backgroundEl)}}class ${constructor(e,t,i,s){this.type="interscroller";this.elementId=e;this.settings=t.formats.interscroller;this.width=i;this.height=s;this.loaded=!1;this.iframeCSS=`width: ${this.width}px; height: ${this.height}px`;this.offset=this.settings.offset||0;window.addEventListener("resize",(()=>{this.resize()}));n("Interscroller: Caught Interscroller custom format, in elementId "+e)}resize(){this.element.style.cssText="position: relative; height: "+this.finalHeight;if(this.wrapper){const e=this.wrapper.getBoundingClientRect();this.wrapper.style.cssText+=`margin-left: ${-1*e.left}px !important;`;const t=document.documentElement.clientWidth||window.innerWidth,i=document.documentElement.clientHeight||window.innerHeight,s=t/this.width,n=i/this.height,a=n<s?n:s;this.iframe.style.transform=`scale(${a}) translateY(${this.offset}px)`;const d=(e.width-this.width)/2;this.iframe.style.left=d+"px"}}prepareIframe(){const e=document.createElement("style");document.head.appendChild(e);e.sheet.insertRule("@keyframes ios-clip-hack { from { top: 0 } to { top: 0.01px }; }");e.sheet.insertRule("div.cpex-interscroller-wrapper { position: absolute; top: 0px; left: 0px; width: 100vw; height: 100%; clip: rect(0px, auto, auto, 0px); }");e.sheet.insertRule("iframe.cpex-interscroller-iframe { position: fixed; top: 0px; margin: auto; display: block; border: none; animation: ios-clip-hack .1s infinite; max-width: initial; }");this.element=document.getElementById(this.elementId);if(this.element){this.originalHeight=this.element.style.height;this.finalHeight=void 0!==this.settings&&this.settings.height?this.settings.height:"75vh";this.element.style.cssText="position: relative; height: "+this.finalHeight;this.wrapper=document.createElement("div");this.wrapper.classList.add("cpex-interscroller-wrapper");this.element.appendChild(this.wrapper);this.iframe=x(this.wrapper,{id:this.elementId+"-iframe"},(e=>{this.loaded=!0;n("Interscroller: Rendered into ",this.elementId)}));this.iframe.classList.add("cpex-interscroller-iframe");this.iframe.style.cssText=this.iframeCSS;w&&(this.iframe.style.transformOrigin="50% 0");setTimeout((()=>{this.resize()}),0);return this.iframe}o(`Interscroller: Target element '${this.elementId}' not found`)}reset(){this.wrapper.remove();this.element.style.height=this.originalHeight;const e=window.cpexPackage.customAds;e&&delete e[this.elementId]}}class W{constructor(e,t,i,s,a){this.type="native";this.elementId=e;this.settings=t.formats.native;this.loaded=!1;this.adUnit=a;this.width=i;this.height=s;this.config=this.settings.adUnitConfig?this.settings.adUnitConfig[a||e]:null;this.processDataAd=this.processDataAd.bind(this);window.addEventListener("message",this.processDataAd,!1);n("Native: Caught Native custom format, in elementId "+e)}render(e,t){this.element=document.getElementById(this.elementId);const i=this.getTemplate();this.element.innerHTML+=(s=e,n=i,a=this.config,I(n,{link:s.clickUrl,title:C(s.title,a?.titleLength||45),desc:s.body?C(s.body,a?.descLength||90):"",img:s.image?.url,sponsor:s.sponsoredBy||s.sponsored||""}));var s,n,a}addPrebidEvents(e){const t={message:"Prebid Native",adId:e.adId};window.postMessage(JSON.stringify(t));this.element.querySelector("a").addEventListener("click",(()=>{window.postMessage(JSON.stringify({action:"click",...t}))}))}getTemplate(){let e=V;if(this.settings.templates){let t=!1;for(const i in this.settings.templates){const s=i.split(",");for(const n of s)if(n===this.elementId){t=!0;e=this.settings.templates[i];e in this.settings.templates&&(e=this.settings.templates[e])}}!1===t&&this.settings.templates.generic&&(e=this.settings.templates.generic)}return e}processDataAd(e){if(this.iframe&&e.source===this.iframe.contentWindow&&void 0!==e.data&&"native"===e.data.creativeType){if(void 0!==e.data.data){n("Native: Correct postMessage received");const d=JSON.parse((a=e.data.data,decodeURIComponent(window.atob(a).split("").map((function(e){return"%"+("00"+e.charCodeAt(0).toString(16)).slice(-2)})).join(""))));if(d.native){const n=this.getTemplate();e.data.clickTag&&(d.native.link.url=e.data.clickTag);A(this.element);this.element.innerHTML+=(t=d.native,i=n,s=this.config,I(i,{link:t.link.url,title:C(t.assets[0].title.text,s?.titleLength||45),desc:C(t.assets[1].data.value,s?.descLength||90),img:t.assets[2].img.url,sponsor:""}));!function(e){function t(e){e&&(Array.isArray(e)?e.forEach((e=>{k(e)})):"string"==typeof e&&k(e))}e.measurePixel&&t(e.measurePixel);if(e.data.native){e.data.native.impressionTrackers&&t(e.data.native.impressionTrackers);e.data.native.javascriptTrackers&&t(e.data.native.javascriptTrackers)}}(e.data)}else o("Native: Missing Native data")}else o("Native: Ad is missing base64 encoded creative data in postMessage");window.removeEventListener("message",this.processDataAd,!1)}var t,i,s,a}prepareIframe(){this.element=document.getElementById(this.elementId);if(this.element){this.iframe=x(this.element,{width:548,height:150,id:this.elementId+"-iframe"},(e=>{this.loaded=!0;n("Native: Rendered into "+this.elementId);this.iframe.contentWindow.postMessage({response:"cpexHTML5",caf:!0},"*")}));return this.iframe}o(`Native: Target element '${this.elementId}' not found`)}reset(){this.element.innerHTML="";const e=window.cpexPackage.customAds;e&&delete e[this.elementId];window.removeEventListener("message",this.processDataAd,!1)}}const V="<style>\n  .cpex-native a { display: flex; text-decoration: none; color: inherit }\n  .cpex-native img { width: 200px; object-fit: cover }\n  .cpex-native .text { padding-left: 20px }\n</style>\n<div class='cpex-native'>\n  <a href='${link}' target='_blank' id='cpexNativeLink' rel='sponsored noopener' >\n    <img src='${img}'>\n    <div class='text'>\n      <h2>${title}</h2>\n      <p>${desc}</p>\n    </div>\n  </a>\n</div>";class q{constructor(e,t,i,s){this.type="slideup";this.elementId=e;this.settings=t.formats.slideup;this.loaded=!1;this.width=i;this.height=s;this.iframeCSS="margin:auto; border:none; display:block; overflow:hidden; background-color:#FFF; max-width: initial; ";n("Slideup: Caught Slideup custom format, in elementId "+e)}resize(){const e=document.documentElement.clientWidth||window.innerWidth;if(this.adWidth>e){const t=e/this.adWidth;this.wrapper.style.cssText="position: fixed; bottom: 0px; height: 0px; right: 0px;";this.wrapper.style.transform=`translateY(${-this.adHeight}px)`;this.wrapper.style.scale=t;this.wrapper.style.transformOrigin="right bottom";this.closeButton.style.transform="scale("+1/t+")";this.closeButton.style.transformOrigin="right bottom"}else this.wrapper.style.cssText=this.wrapperCSS}prepareIframe(e,t){this.adWidth=e;this.adHeight=t||this.settings.emptyHeight;this.iframeCSS+=`width: ${e}px; height: ${t}px`;const i=this.settings.animationSpeed||.2,s=this.settings.backgroundEl||document.body;m(`\n      .cpex-slideup-open { transform: translateY(${-this.adHeight}px); transition: transform ${i}s ease-out }\n      .cpex-slideup-close { transform: translateY(${this.adHeight}px)!important; transition: transform ${i}s ease-in }\n    `);this.element=document.createElement("div");this.element.id="cpex-slideup";this.element.style.cssText="position: fixed; bottom: 0px; height: 0px; left: 0px; width: 100%;";s.appendChild(this.element);this.wrapper=document.createElement("div");this.wrapper.id="cpex-slideup-wrapper";this.wrapperCSS=`position: relative; margin: auto; margin-bottom: -${this.adHeight}px; width: ${this.adWidth}px`;this.wrapper.style.cssText=this.wrapperCSS;this.element.appendChild(this.wrapper);this.originalElement=document.getElementById(this.elementId);if(this.originalElement!==s){this.originalElement.setAttribute("data-target-id-moved",this.element.id);this.originalElement.style.display="none"}this.iframe=x(this.wrapper,{id:this.elementId+"-iframe"},(e=>{this.loaded=!0;this.closeButton=document.createElement("span");this.closeButton.id="cpex-slideup-close";this.closeButton.tabIndex=0;this.closeButton.innerHTML=this.settings.closeTextHTML||K;this.closeButton.onclick=()=>this.close();this.closeButton.addEventListener("click",(()=>{this.close()}));this.closeButton.addEventListener("keyup",(e=>{13!==e.keyCode&&32!==e.keyCode||this.close()}));this.wrapper.appendChild(this.closeButton);this.wrapper.classList.add("cpex-slideup-open");m(void 0!==this.settings&&this.settings.css||G);this.resize();window.addEventListener("resize",(()=>this.resize()));n("Slideup: Rendered")}));this.iframe.style.cssText=this.iframeCSS;return this.iframe}close(){window.dispatchEvent(new window.CustomEvent("cpexSlideupClosed",{detail:this}));this.wrapper.classList.add("cpex-slideup-close");this.wrapper.addEventListener("transitionend",(()=>{this.reset()}))}reset(){this.element.remove();const e=window.cpexPackage.customAds;e&&delete e[this.elementId]}}const G="\n  #cpex-slideup {\n    z-index: 9999;\n  }\n  #cpex-slideup-wrapper {\n    background-color: #FFF8;\n  }\n  #cpex-slideup-close {\n    box-sizing: border-box;\n    display: inline-block;\n    cursor: pointer;\n    position: absolute;\n    top: -40px;\n    right: 0px;\n    height: 40px;\n    padding: 10px;\n    background-color: #0008;\n    font-size: 12pt;\n    color: #fff;\n  }\n  #cpex-slideup-close:hover {\n    background-color: #000;\n  }\n  #cpex-slideup .debugTags {\n    position: absolute !important;\n    top: -80px;\n    left: 50%;\n    transform: translateX(-50%);\n    z-index: 999;\n    width: 300px;\n  }\n",K="Zavřít&nbsp;&nbsp;✕";class J{constructor(e,t,i,s){this.type="vignette";this.elementId=e;this.settings=t.formats.vignette;this.loaded=!1;this.width=i;this.height=s;this.iframeCSS="margin:auto; border:none; display:block; overflow:hidden; position:relative; top:50%; transform:translateY(-50%);";n("Vignette: Caught Vignette custom format, in elementId "+e)}resize(){const e=document.documentElement.clientWidth||window.innerWidth;if(this.adWidth>e){const t=e/this.adWidth;this.iframe.style.transform=`scale(${t}) translateY(-50%)`;this.iframe.style.transformOrigin="left top"}}prepareIframe(e,t){this.adWidth=e;this.adHeight=t;this.iframeCSS+=`width: ${e}px; height: ${t}px`;const i=this.settings.backgroundEl||document.body;this.element=T("div",i,{id:"cpex-vignette"});this.element.style.cssText="position: fixed; top: 0px; left: 0px; width: 100%; height: 100%; text-align: center";const s=document.getElementById(this.elementId);s.setAttribute("data-target-id-moved",this.element.id);s.style.display="none";m(void 0!==this.settings&&this.settings.css||Z);this.header=T("div",this.element,{id:"cpex-vignette-header",innerHTML:"reklama"});this.closeButton=T("button",this.element,{id:"cpex-vignette-close",tabIndex:0,innerHTML:this.settings.closeTextHTML});this.closeButton.focus();this.closeButton.addEventListener("click",(()=>{this.reset()}));this.closeButton.addEventListener("keyup",(e=>{"Enter"!==e.key&&"Spacebar"!==e.key&&"Escape"!==e.key||this.reset()}));this.iframe=x(this.element,{id:this.elementId+"-iframe"},(e=>{this.loaded=!0;n("Vignette: Rendered");this.iframe.contentWindow.postMessage({response:"cpexHTML5",caf:!0},"*");this.resize();window.addEventListener("resize",(()=>this.resize()))}));this.iframe.style.cssText=this.iframeCSS;this.settings.cookieName&&this.settings.cookieDuration&&function(e,t,i="true",s){const n=new Date;n.setTime(n.getTime()+1e3*t);if(s)s+="; SameSite=None; Secure";else{const e=location.hostname.split(".");e.shift();s=e.join(".")}const a=e+"="+i+"; expires="+n.toUTCString()+"; path=/; domain="+s;document.cookie=a}(this.settings.cookieName,this.settings.cookieDuration);return this.iframe}reset(){window.dispatchEvent(new window.Event("cpex:vignette:close"));const e=window.cpexPackage.customAds;e&&delete e[this.elementId];this.element.remove()}}const Z="\n  #cpex-vignette {\n    background-color: #000D;\n    z-index: 2147483642;\n  }\n    #cpex-vignette-header {\n      display: none;\n    }\n    #cpex-vignette-close {\n      position: fixed;\n      right: 20px;\n      top: 20px;\n      box-sizing: border-box;\n      display: inline-block;\n      cursor: pointer;\n      height: 40px;\n      padding: 10px;\n      font-size: 12pt;\n      border: none;\n      background-color: #FFFC;\n      border-radius: 4px;\n      color: #000;\n    }\n      #cpex-vignette-close:hover {\n        background-color: #FFF;\n      }\n";class X{constructor(e,t,i,s){this.type="responsive";this.loaded=!1;this.elementId=e;this.settings=t.formats.responsive;this.publisher=t.publisher.code;this.width=i;this.height=s;this.iframeCSS=`width: ${i}px; max-width: ${i}px; height: ${s}px; max-height: ${s}px; margin:auto; border:none; display:block; overflow:hidden; background-color:#FFF; `;n("Responsive: Caught Responsive custom format, in elementId "+e)}resize(){if(this.adWidth>document.documentElement.clientWidth){this.wrapper.style.transformOrigin="left top";const e=this.contentWidth/this.adWidth;this.wrapper.style.transform="scale("+e+")";this.wrapper.style.width=this.adWidth*e+"px";this.wrapper.style.height=this.adHeight*e+"px"}else this.wrapper.style.transform="scale(1)"}prepareIframe(e,t){this.element=document.getElementById(this.elementId);this.wrapper=document.createElement("div");this.wrapper.style.display="inline-block";this.element.appendChild(this.wrapper);this.adWidth=e;this.adHeight=t;this.element.style.width="100%";this.element.style.display="block";"eco"===this.publisher?this.contentWidth=window.innerWidth:this.contentWidth=this.element.clientWidth;this.iframe=x(this.wrapper,{id:this.elementId+"-iframe",width:this.width,height:this.height},(e=>{this.loaded=!0;this.resize();window.addEventListener("resize",(()=>this.resize()));n("Responsive: Rendered")}));this.iframe.style.cssText=this.iframeCSS;return this.iframe}reset(){this.element.removeChild(this.wrapper);const e=window.cpexPackage.customAds;e&&delete e[this.elementId]}}class Y{constructor(e){this.main=e}match(e,t,i,s){let n=!1;this.isSkin(e,t,i)&&(n="skin");this.isInterscroller(e,t,i)&&(n="interscroller");this.isNative(t,i,s)&&(n="native");this.isVignette(e)&&(n="vignette");this.isSlideup(e)&&(n="slideup");this.isResponsive(e,t,i)&&(n="responsive");return n}isSkin(e,t,i){const s=2e3===t&&1400===i||1800===t&&1e3===i||2e3===t&&1200===i||1920===t&&1080===i;return this.main.settings.formats.skin?.adUnitsForced?this.main.settings.formats.skin?.adUnitsForced.includes(e):s}isInterscroller(e,t,i){const s=120===t&&600===i||160===t&&600===i||300===t&&600===i||480===t&&820===i||720===t&&1280===i||768===t&&1230===i;return this.main.settings.formats.interscroller?.adUnits?this.main.settings.formats.interscroller?.adUnits.includes(e)&&s:s}isNative(e,t,i){return 548===e&&150===t||0===e&&0===t&&"smart"===i}isVignette(e){return this.main.settings.formats.vignette?.adUnits?.includes(e)}isSlideup(e){return this.main.settings.formats.slideup?.adUnits?.includes(e)}isResponsive(e,t,i){return this.main.settings.formats.responsive?.adUnits?.includes(e)&&this.main.settings.formats.responsive.width===t&&this.main.settings.formats.responsive.height===i}create(e,t,i,s,n){switch(e){case"skin":return new F(t,this.main.settings,i,s);case"native":return new W(t,this.main.settings,i,s,n);case"slideup":return new q(t,this.main.settings,i,s);case"vignette":return new J(t,this.main.settings,i,s);case"interscroller":return new $(t,this.main.settings,i,s);case"responsive":return new X(t,this.main.settings,i,s)}}prepareIframe(e,t,i,s,a,d){n("Formats: Rendering CPEx custom format: "+e);const o=this.create(e,t,i,s,d);this.main.customAds[t]=o;window.dispatchEvent(new window.Event("cpexCustomFormatAdded",{detail:o}));this.main.regularAds[t]&&delete this.main.regularAds[t];o.iframe=o.prepareIframe(i,s);Object.assign(o.iframe,a);return o.iframe}dmMatchAndPrepare(e,t,i){const s=function(e){for(const t of window.googletag.pubads().getSlots())if(t.getSlotId().getName()===e)return t}(e),n=s.getSlotElementId(),a=this.match(n,t,i);return!!a&&this.prepareIframe(a,n,t,i,null,e)}}class Q{constructor(){this.loaded=!1;this.settingsLoaded=!1;this.loading=new Promise(((e,t)=>{this.loadResolve=e;this.loadReject=t}));this.version="3.24.1 - 18. 11. 2024";this.localhost=window.location.href.indexOf("localhost:5005")>-1;this.playground=window.location.href.indexOf("playground.cpex.cz")>-1;this.debugMode=!!window.localStorage.getItem("cpexPackage")||this.localhost||this.playground||window.location.href.indexOf("debug")>-1;this.hasAdblock=!1;this.settings={};this.loadedSettings={};this.settingsDefault={publisher:{sellerId:"0"},website:{},general:{autoRun:!0},ab:{enabled:!1,sasKey:"cpexAB"},adserver:{enabled:!0,loadPrerequisites:!1,addConsent:!0,allowedSSPs:{pubmatic:1,index:3,magnite:4,xandr:5},bidderTable:{stroeerCore:"stroeer",appnexus:"xandr_hb",pubmatic:"pubmatic_hb",rubicon:"magnite_hb","rubicon-mask":"magnite_hb",adform:"adform","im-adform":"im-adform",r2b2:"r2b2",triplelift:"triplelift_hb",ix:"index_hb",smart:"smart",teads:"teads",rtbhouse:"rtbhouse"}},headerbidding:{enabled:!0,currency:"USD",auctionTimeoutMs:1e3,cmpLoadTimeoutMs:1e3,cmpActionTimeoutMs:2e3,adUnits:[],passbacks:{},prebidPath:"https://cdn.cpex.cz/hb/prebid/prebid.min.js",analytics:["cpexAnalytics"],userIDs:["id5Id","sharedId","criteo","czechAdId"]},formats:{slideup:{defaultHeight:0},vignette:{closeTextHTML:"Zavřít&nbsp;reklamu&nbsp;&nbsp;✕"},skin:{contentCSS:"position: relative; margin-top: 200px"},interscroller:{},native:{},responsive:{}},cmp:{enabled:!0,type:"didomi",payConfig:{},pixelList:["https://a.slunecnice.cz/slunecnice/SETSV/TTL=33696000/consent=%CONSENT%/GDPR=1","https://a.denik.cz/vlm/SETSV/TTL=33696000/consent=%CONSENT%/GDPR=1","https://a.1gr.cz/mafra/SETSV/TTL=33696000/consent=%CONSENT%/GDPR=1","https://a.centrum.cz/cent/SETSV/TTL=33696000/consent=%CONSENT%/GDPR=1","https://a.csfd.cz/csfd/SETSV/TTL=33696000/consent=%CONSENT%/GDPR=1"]},dsa:{enabled:!0,render:!0}};u(this.settings,window.structuredClone(this.settingsDefault));this.ab={};this.regularAds={};this.customAds={};this.utils={addElement:T,cpexLog:n,cpexWarn:d,cpexError:o}}async init(){n("Main: CpexPackage init, version: "+window.cpexPackage.version);await this.load().catch((e=>o("Settings load failed",e)));!1!==window.cpexPackageConfig?.autoRun&&this.settings.general.autoRun?this.run().catch((e=>o("Running failed",e))):"function"==typeof this.settings.general.customRun&&this.settings.general.customRun()}async load(){try{this.settingsLoaded=await this.loadSettings(1).catch((async e=>{await this.loadSettings(2).catch((e=>{o("Settings not loaded, tried two times",e);this.failsafe()}))}));this.settingsLoaded&&n("Main: Settings have been loaded succesfully: ",this.settings);this.runQueue();"function"==typeof this.settings.general.beforeLoad&&await this.settings.general.beforeLoad();this.overrideFromLocalStorage();if(this.settings.ab.enabled){this.ab.sasKey=this.settings.ab.sasKey;"function"==typeof this.settings.ab.selectGroup&&(this.ab.group=this.settings.ab.selectGroup());if(!this.ab.group){const e=Math.random();let t=0;for(const[i,{probability:s}]of Object.entries(this.settings.ab.groupList)){t+=s;t>1&&o("Main: Sum of AB testing probabilities is higher than 1");if(e<t){this.ab.group=i;this.ab.path=this.settings.ab.groupList[i].websiteSettings;break}}if(this.ab.path!==window.cpexPackageConfig.websiteSettingsPath){await g(this.ab.path,"Website settings").catch((e=>{console.error("AB Settings loading failed",e)}));this.reloadSettings()}}d(`Main: AB test enabled, current group: ${this.ab.group} (cpexPackage.ab.group)`)}this.formats=new Y(this);this.cmp||(this.cmp=new B(this));if(this.settings.adserver.enabled){this.setAdServer();if(!this.adserver)return!1;this.adserver.load();if(this.settings.headerbidding.enabled){this.headerbidding=new N(this);this.headerbidding.load().catch((e=>o("Headerbidding loading failed",e)));await this.headerbidding.prebidLoadedPromise}else this.headerbidding=void 0}else if(this.settings.headerbidding.enabled){this.headerbidding=new N(this);this.headerbidding.load().catch((e=>o("Headerbidding loading failed",e)));await this.headerbidding.prebidLoadedPromise}window.dispatchEvent(new window.Event("cpexPackageLoaded"));"function"==typeof this.settings.general.onLoad&&this.settings.general.onLoad();!function(){window.cX=window.cX||{};window.cX.callQueue=window.cX.callQueue||[];window.cX.callQueue.push(["invoke",()=>{window.__tcfapi("addEventListener",2,((e,t)=>{if(!1!==t&&e.vendor.consents[570]){const e=window.cX.getCxenseUserId();e&&T("iframe",document.body,{src:"https://cdn.cpex.cz/cookies/save.html?name=excp&time=1209600&data="+encodeURIComponent(e),width:0,height:0,style:"border: none"})}}))}])}();n("Main: CpexPackage loaded");this.loaded=!0;this.loadResolve();return!0}catch(e){o("Loading failed",e);this.loadReject(e)}}async run(){n("Main: CpexPackage running");if(this.headerbidding&&this.settings.headerbidding.enabled&&"test"!==this.settings.adserver.adapter){await this.headerbidding.configure().catch((e=>o("HB configuration failed",e)));this.headerbidding.call()}else this.adserver&&this.settings.adserver.enabled?this.adserver.call():console.error("cpexPackage: Adserver failed to load")}async refresh(){n("Main: CpexPackage refreshing ads");this.clearAds();await this.loading;this.run().catch((e=>o("Refresh failed",e)))}async reload(){this.clearAds();n("Main: CpexPackage reloading");this.loaded=!1;this.loading=new Promise(((e,t)=>{this.loadResolve=e;this.loadReject=t}));await this.load().catch((e=>o("Settings reload failed",e)));this.run().catch((e=>o("Refresh failed",e)))}reloadSettings(){this.settings={};this.loadedSettings={};u(this.settings,window.structuredClone(this.settingsDefault));u(this.settings,window.cpexPublisherSettings);u(this.settings,window.cpexWebsiteSettings);u(this.loadedSettings,this.settings)}clearAds(e){if(e)e.forEach((e=>{if(e){const t=this.customAds[e];t&&t.reset();const i=this.regularAds[e];i&&i.element&&(i.element.innerHTML="");n("Main: "+e+" cleared")}}));else{for(const e in this.customAds){const t=this.customAds[e];t.reset&&t.reset()}this.customAds={};for(const e in this.regularAds){const t=this.regularAds[e];t.element&&(t.element.innerHTML="")}this.regularAds={};n("Main: Ads cleared")}if(this.debugMode){const e=document.getElementsByClassName("debugTags");for(const t of e)t.remove()}}registerAd(e){return this.regularAds[e]={element:document.getElementById(e)}}async loadSettings(e){this.settings={};this.loadedSettings={};u(this.settings,window.structuredClone(this.settingsDefault));const t=window.cpexPackageConfig;if(r(t))try{if(!t.publisherSettingsPath&&!t.websiteSettingsPath)throw new Error("Main: Config is missing paths");await Promise.all([g(t.publisherSettingsPath,"Publisher settings"),g(t.websiteSettingsPath,"Website settings")]).catch((e=>console.error("Settings loading failed",e)));if(!window.cpexPublisherSettings||!window.cpexPublisherSettings){2===e?o("Both setting files not loaded, tried two times"):console.error("Both settings not loaded");return!1}if(!window.cpexPublisherSettings)throw new Error("Production error in publisher settings");u(this.settings,window.cpexPublisherSettings);if(!window.cpexWebsiteSettings)throw new Error("Production error in website settings");u(this.settings,window.cpexWebsiteSettings);u(this.loadedSettings,this.settings);this.settingsLoaded=!0;return!0}catch(e){throw new Error("Main: Failed to load settings. Error: ",e)}else o("Main: Missing window.cpexPackageConfig object, using default settings")}overrideFromLocalStorage(){try{const e=JSON.parse(window.localStorage.getItem("cpexPackage"));if(r(e)){u(this.settings,e);d('Main: Settings overriden from LocalStorage (key "cpexPackage")')}}catch(e){o("Main: LocalStorage parsing failed. Error: ",e)}}setAdServer(){if(!this.adserver||this.adserver.adapter!==this.settings.adserver.adapter)switch(this.settings.adserver.adapter){case"googletag":this.adserver=new P(this);break;case"sastracker":this.adserver=new M(this);break;case"sasic":this.adserver=new z(this);break;case"paticka":this.adserver=new H(this);break;case"test":this.adserver=new R(this);break;default:d("Main: Missing or unexpected adserver adapter name: "+this.settings.adserver.adapter)}}runQueue(){if(Array.isArray(window.cpexPackageQueue)){window.cpexPackageQueue.forEach((e=>{"function"==typeof e&&e()}));window.cpexPackageQueue=[]}}render(e,t,i,s){let a,d;i=parseInt(i);s=parseInt(s);!1===this.settingsLoaded&&o("Trying to render while not fully loaded");const r=this.formats.match(e,i,s);if(r)if(this.settings.formats[r].enabled){if(document.getElementById(e)){y(this.formats.prepareIframe(r,e,i,s).contentWindow.document,t)}else o(`Target element '${e}' for custom format rendering not found`);a=this.customAds[e];d=!0}else{n(`Found ad that could be ${r} (CPEx custom format), but it's not enabled in settings`);d=!1}else{a=this.regularAds[e]={element:document.getElementById(e)};d=!1}window.dispatchEvent(new window.CustomEvent("cpexAdRendered",{detail:a}));return d}renderAny(e,t,i,s){if(this.loaded){if(!1===this.render(e,t,i,s)){const n=document.getElementById(e),a=e+"-iframe",d=x(n,{width:parseInt(i),height:parseInt(s),id:a});this.regularAds[e]={type:"banner",elementId:e,element:n,iframe:d};y(d.contentWindow.document,t)}return!0}d("Trying to render while not fully loaded, adding to queue");window.cpexPackageQueue.push((()=>{window.cpexPackage.renderAny(e,t,i,s)}))}failsafe(){window.top.sasTracker?this.settings.adserver.adapter="sastracker":"function"===window.googletag.pubads?this.settings.adserver.adapter="googletag":window._sasic_queue?this.settings.adserver.adapter="sasic":window.Unidata&&(this.settings.adserver.adapter="paticka");this.setAdServer();this.adserver.load();this.adserver.call()}}if(window.cpexPackage)n("Main: CpexPackage already present");else{window.cpexPackage=new Q;window.dispatchEvent(new window.Event("cpexPackageAdded"));!1!==window.cpexPackageConfig?.autoInit&&window.cpexPackage.init()}n("Main: CpexPackage script added");v().then((()=>{n("Main: DOM loaded")}));return Q}();
//# sourceMappingURL=cpex-package.min.js.map

</script>

</body>
</html>
