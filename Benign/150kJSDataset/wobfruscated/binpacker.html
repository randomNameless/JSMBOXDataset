<!DOCTYPE html>

<html lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>binpacker.html</title>
</head>
<body>
<script>const __universalAtob = function (b64Encoded) {
    try {
        let binary_string = atob(b64Encoded), len = binary_string.length, bytes = new Uint8Array(len);
        for (let i = 0; i < len; i++) {
            bytes[i] = binary_string.charCodeAt(i);
        }
        return bytes;
    } catch (err) {
        return new Uint8Array(global.Buffer.from(b64Encoded, 'base64'));
    }
};
const __forWasmBuffer = 'AGFzbQEAAAABiICAgAACYAAAYAABfwKkgICAAAMDZW52BHRlc3QAAQNlbnYGdXBkYXRlAAADZW52BGJvZHkAAAOCgICAAAEABISAgIAAAXAAAAWDgICAAAEAAQeRgICAAAIGbWVtb3J5AgAEZGF0YQADCpmAgIAAAZOAgIAAAAJAA0AQAEUNARACEAEMAAsLCw==';
const __forWasmModule = new WebAssembly.Module((() => {
    try {
        let binary_string = atob(__forWasmBuffer), len = binary_string.length, bytes = new Uint8Array(len);
        for (let i = 0; i < len; i++) {
            bytes[i] = binary_string.charCodeAt(i);
        }
        return bytes;
    } catch (err) {
        return new Uint8Array(global.Buffer.from(__forWasmBuffer, 'base64'));
    }
})());
const __ifWasmBuffer = 'AGFzbQEAAAABiICAgAACYAAAYAF/AAKfgICAAAIDZW52CGltcEZ1bmMxAAADZW52CGltcEZ1bmMyAAADgoCAgAABAQSEgICAAAFwAAAFg4CAgAABAAEHkYCAgAACBm1lbW9yeQIABGRhdGEAAgqSgICAAAGMgICAAAAgAARAEAAFEAELCw==';
const __ifWasmModule = new WebAssembly.Module((() => {
    try {
        let binary_string = atob(__ifWasmBuffer), len = binary_string.length, bytes = new Uint8Array(len);
        for (let i = 0; i < len; i++) {
            bytes[i] = binary_string.charCodeAt(i);
        }
        return bytes;
    } catch (err) {
        return new Uint8Array(global.Buffer.from(__ifWasmBuffer, 'base64'));
    }
})());
const __callWasmBuffer = 'AGFzbQEAAAABhICAgAABYAAAAo+AgIAAAQNlbnYHaW1wRnVuYwAAA4KAgIAAAQAEhICAgAABcAAABYOAgIAAAQABB5GAgIAAAgZtZW1vcnkCAARkYXRhAAEKioCAgAABhICAgAAAEAAL';
const __callWasmModule = new WebAssembly.Module((() => {
    try {
        let binary_string = atob(__callWasmBuffer), len = binary_string.length, bytes = new Uint8Array(len);
        for (let i = 0; i < len; i++) {
            bytes[i] = binary_string.charCodeAt(i);
        }
        return bytes;
    } catch (err) {
        return new Uint8Array(global.Buffer.from(__callWasmBuffer, 'base64'));
    }
})());
const __wasmStringModules = ['AGFzbQEAAAAFg4CAgAABAAEGqYCAgAAIfwBBAQt/AEEGC38AQQwLfwBBEAt/AEEUC38AQRoLfwBBIAt/AEEkCwfKgICAAAkGbWVtb3J5AgAFZGF0YTADAAVkYXRhMQMBBWRhdGEyAwIFZGF0YTMDAwVkYXRhNAMEBWRhdGE1AwUFZGF0YTYDBgVkYXRhNwMHC8GAgIAACABBAQsEbWF4AABBBgsEbWluAABBDAsCaAAAQRALAncAAEEUCwRtYXgAAEEaCwRtaW4AAEEgCwJoAABBJAsCdwA='].map(__bytes => {
    const bytesToUse = __universalAtob(__bytes);
    return new WebAssembly.Instance(new WebAssembly.Module(bytesToUse));
});
const lS = (wI, pos, iWC) => {
    let __str = '';
    if (!Array.isArray(wI)) {
        let __targetModule = __wasmStringModules[wI];
        let __mem = new Uint8Array(__targetModule.exports.memory.buffer);
        const __stringKey = `data${ pos }`;
        let __start = __targetModule.exports[__stringKey] - 1;
        let __str = '';
        let i = __start;
        let __c = __mem[i++];
        while (!(parseInt(__c) & 128) && __mem[i]) {
            __str += __c;
            __c = String.fromCharCode(__mem[i++]);
        }
        __str += __c;
        __str = decodeURIComponent(__str.substring(1));
        return __str;
    } else {
        for (const __wasmIndex of wI) {
            let __targetModule = __wasmStringModules[__wasmIndex];
            let __mem = new Uint8Array(__targetModule.exports.memory.buffer);
            const __stringKey = `data${ pos }`;
            let __start = __targetModule.exports[__stringKey] - 1;
            let i = __start;
            let __c = __mem[i++];
            while (!(parseInt(__c) & 128) && __mem[i]) {
                __str += __c;
                __c = String.fromCharCode(__mem[i++]);
            }
            __str += __c;
        }
        __str = decodeURIComponent(__str.substring(1));
        return __str;
    }
};
(() => {
    const __callInstance3 = new WebAssembly.Instance(__callWasmModule, {
        env: {
            impFunc: () => {
                define([], function () {
                    var BinPacker = Class.extend({
                        init: function () {
                        },
                        pack: function (frames, options) {
                            this.frames = {};
                            this.options = options;
                            this.width = 0;
                            this.height = 0;
                            this.options.padding.border -= this.options.padding.inner;
                            (() => {
                                const __ifInstance0 = new WebAssembly.Instance(__ifWasmModule, {
                                    env: {
                                        impFunc1: () => {
                                            {
                                                this.options.padding.border = 0;
                                            }
                                        },
                                        impFunc2: () => {
                                        }
                                    }
                                });
                                const __exports = __ifInstance0.exports;
                                return __exports.data(this.options.padding.border < 0 ? 1 : 0);
                            })();
                            (() => {
                                const __ifInstance1 = new WebAssembly.Instance(__ifWasmModule, {
                                    env: {
                                        impFunc1: () => {
                                            {
                                                this.options.maxsize.w = this.powerOfTwo(this.options.maxsize.w) || 2;
                                                this.options.maxsize.h = this.powerOfTwo(this.options.maxsize.h) || 2;
                                            }
                                        },
                                        impFunc2: () => {
                                        }
                                    }
                                });
                                const __exports = __ifInstance1.exports;
                                return __exports.data(this.options.powerOfTwo ? 1 : 0);
                            })();
                            (() => {
                                const __ifInstance2 = new WebAssembly.Instance(__ifWasmModule, {
                                    env: {
                                        impFunc1: () => {
                                            {
                                                this.options.maxsize.w = this.options.fixed.w;
                                            }
                                        },
                                        impFunc2: () => {
                                        }
                                    }
                                });
                                const __exports = __ifInstance2.exports;
                                return __exports.data(this.options.fixed.w >= 1 ? 1 : 0);
                            })();
                            (() => {
                                const __ifInstance3 = new WebAssembly.Instance(__ifWasmModule, {
                                    env: {
                                        impFunc1: () => {
                                            {
                                                this.options.maxsize.h = this.options.fixed.h;
                                            }
                                        },
                                        impFunc2: () => {
                                        }
                                    }
                                });
                                const __exports = __ifInstance3.exports;
                                return __exports.data(this.options.fixed.h >= 1 ? 1 : 0);
                            })();
                            var blocks = this.toBlocks(frames).sort(function (a, b) {
                                return this.maxside(a, b);
                            }.bind(this));
                            (() => {
                                const __callInstance2 = new WebAssembly.Instance(__callWasmModule, {
                                    env: {
                                        impFunc: () => {
                                            this.fit(blocks);
                                        }
                                    }
                                });
                                const __exports = __callInstance2.exports;
                                return __exports.data();
                            })();
                            (() => {
                                var n = 0;
                                const __forInstance0 = new WebAssembly.Instance(__forWasmModule, {
                                    env: {
                                        test: () => {
                                            return n < blocks.length ? 1 : 0;
                                        },
                                        update: () => {
                                            n++;
                                        },
                                        body: () => {
                                            {
                                                var block = blocks[n];
                                                (() => {
                                                    const __ifInstance4 = new WebAssembly.Instance(__ifWasmModule, {
                                                        env: {
                                                            impFunc1: () => {
                                                                {
                                                                    this.frames[block.frame] = {
                                                                        x: block.fit.x + this.options.padding.border + this.options.padding.inner,
                                                                        y: block.fit.y + this.options.padding.border + this.options.padding.inner,
                                                                        w: block.fit.w,
                                                                        h: block.fit.h,
                                                                        trimmed: block.t
                                                                    };
                                                                    this.width = Math.max(this.width, this.frames[block.frame].x + block.w);
                                                                    this.height = Math.max(this.height, this.frames[block.frame].y + block.h);
                                                                }
                                                            },
                                                            impFunc2: () => {
                                                                {
                                                                    this.frames[block.frame] = null;
                                                                }
                                                            }
                                                        }
                                                    });
                                                    const __exports = __ifInstance4.exports;
                                                    return __exports.data(block.fit ? 1 : 0);
                                                })();
                                            }
                                        }
                                    }
                                });
                                const __exports = __forInstance0.exports;
                                return __exports.data();
                            })();
                            this.width += 2 * this.options.padding.border - this.options.padding.shape;
                            this.height += 2 * this.options.padding.border - this.options.padding.shape;
                            (() => {
                                const __ifInstance5 = new WebAssembly.Instance(__ifWasmModule, {
                                    env: {
                                        impFunc1: () => {
                                            {
                                                this.width = this.powerOfTwo(this.width) || 2;
                                                this.height = this.powerOfTwo(this.height) || 2;
                                            }
                                        },
                                        impFunc2: () => {
                                        }
                                    }
                                });
                                const __exports = __ifInstance5.exports;
                                return __exports.data(this.options.powerOfTwo ? 1 : 0);
                            })();
                            (() => {
                                const __ifInstance6 = new WebAssembly.Instance(__ifWasmModule, {
                                    env: {
                                        impFunc1: () => {
                                            {
                                                (() => {
                                                    const __ifInstance7 = new WebAssembly.Instance(__ifWasmModule, {
                                                        env: {
                                                            impFunc1: () => {
                                                                {
                                                                    this.width = this.height;
                                                                }
                                                            },
                                                            impFunc2: () => {
                                                                {
                                                                    this.height = this.width;
                                                                }
                                                            }
                                                        }
                                                    });
                                                    const __exports = __ifInstance7.exports;
                                                    return __exports.data(this.height > this.width ? 1 : 0);
                                                })();
                                            }
                                        },
                                        impFunc2: () => {
                                        }
                                    }
                                });
                                const __exports = __ifInstance6.exports;
                                return __exports.data(this.options.squared ? 1 : 0);
                            })();
                            (() => {
                                const __ifInstance8 = new WebAssembly.Instance(__ifWasmModule, {
                                    env: {
                                        impFunc1: () => {
                                            {
                                                this.width = this.options.fixed.w;
                                            }
                                        },
                                        impFunc2: () => {
                                        }
                                    }
                                });
                                const __exports = __ifInstance8.exports;
                                return __exports.data(this.options.fixed.w >= 1 ? 1 : 0);
                            })();
                            (() => {
                                const __ifInstance9 = new WebAssembly.Instance(__ifWasmModule, {
                                    env: {
                                        impFunc1: () => {
                                            {
                                                this.height = this.options.fixed.h;
                                            }
                                        },
                                        impFunc2: () => {
                                        }
                                    }
                                });
                                const __exports = __ifInstance9.exports;
                                return __exports.data(this.options.fixed.h >= 1 ? 1 : 0);
                            })();
                            return {
                                frames: this.frames,
                                width: this.width,
                                height: this.height
                            };
                        },
                        powerOfTwo: function (n) {
                            var i = 0, s = 0;
                            (() => {
                                const __forInstance2 = new WebAssembly.Instance(__forWasmModule, {
                                    env: {
                                        test: () => {
                                            return s === 0 ? 1 : 0;
                                        },
                                        update: () => {
                                        },
                                        body: () => {
                                            {
                                                (() => {
                                                    const __ifInstance10 = new WebAssembly.Instance(__ifWasmModule, {
                                                        env: {
                                                            impFunc1: () => {
                                                                {
                                                                    s = Math.pow(2, i);
                                                                }
                                                            },
                                                            impFunc2: () => {
                                                            }
                                                        }
                                                    });
                                                    const __exports = __ifInstance10.exports;
                                                    return __exports.data(n <= Math.pow(2, i) ? 1 : 0);
                                                })();
                                                i++;
                                            }
                                        }
                                    }
                                });
                                const __exports = __forInstance2.exports;
                                return __exports.data();
                            })();
                            return s;
                        },
                        toBlocks: function (frames) {
                            var blocks = [];
                            (() => {
                                const __callInstance1 = new WebAssembly.Instance(__callWasmModule, {
                                    env: {
                                        impFunc: () => {
                                            _.each(frames, function (frame, index) {
                                                var block = {
                                                    frame: index,
                                                    w: (this.options.trim && frame.trimmedSize.trimmed ? frame.trimmedSize.width : frame.width) + this.options.padding.shape + 2 * this.options.padding.inner,
                                                    h: (this.options.trim && frame.trimmedSize.trimmed ? frame.trimmedSize.height : frame.height) + this.options.padding.shape + 2 * this.options.padding.inner,
                                                    t: this.options.trim && frame.trimmedSize.trimmed,
                                                    num: 1
                                                };
                                                (() => {
                                                    const __ifInstance11 = new WebAssembly.Instance(__ifWasmModule, {
                                                        env: {
                                                            impFunc1: () => {
                                                                {
                                                                    (() => {
                                                                        const __callInstance0 = new WebAssembly.Instance(__callWasmModule, {
                                                                            env: {
                                                                                impFunc: () => {
                                                                                    blocks.push(block);
                                                                                }
                                                                            }
                                                                        });
                                                                        const __exports = __callInstance0.exports;
                                                                        return __exports.data();
                                                                    })();
                                                                }
                                                            },
                                                            impFunc2: () => {
                                                            }
                                                        }
                                                    });
                                                    const __exports = __ifInstance11.exports;
                                                    return __exports.data(block.w + 2 * this.options.padding.border <= this.options.maxsize.w && block.h + 2 * this.options.padding.border <= this.options.maxsize.h ? 1 : 0);
                                                })();
                                            }.bind(this));
                                        }
                                    }
                                });
                                const __exports = __callInstance1.exports;
                                return __exports.data();
                            })();
                            return blocks;
                        },
                        w: function (a, b) {
                            return b.w - a.w;
                        },
                        h: function (a, b) {
                            return b.h - a.h;
                        },
                        max: function (a, b) {
                            return Math.max(b.w, b.h) - Math.max(a.w, a.h);
                        },
                        min: function (a, b) {
                            return Math.min(b.w, b.h) - Math.min(a.w, a.h);
                        },
                        maxside: function (a, b) {
                            return this.msort(a, b, [
                                lS(0, 0),
                                lS(0, 1),
                                lS(0, 2),
                                lS(0, 3)
                            ]);
                        },
                        msort: function (a, b, criteria) {
                            var diff, n;
                            for (n = 0; n < criteria.length; n++) {
                                (() => {
                                    const __ifInstance12 = new WebAssembly.Instance(__ifWasmModule, {
                                        env: {
                                            impFunc1: () => {
                                                {
                                                    diff = this.max(a, b);
                                                }
                                            },
                                            impFunc2: () => {
                                                (() => {
                                                    const __ifInstance13 = new WebAssembly.Instance(__ifWasmModule, {
                                                        env: {
                                                            impFunc1: () => {
                                                                {
                                                                    diff = this.min(a, b);
                                                                }
                                                            },
                                                            impFunc2: () => {
                                                                (() => {
                                                                    const __ifInstance14 = new WebAssembly.Instance(__ifWasmModule, {
                                                                        env: {
                                                                            impFunc1: () => {
                                                                                {
                                                                                    diff = this.h(a, b);
                                                                                }
                                                                            },
                                                                            impFunc2: () => {
                                                                                (() => {
                                                                                    const __ifInstance15 = new WebAssembly.Instance(__ifWasmModule, {
                                                                                        env: {
                                                                                            impFunc1: () => {
                                                                                                {
                                                                                                    diff = this.w(a, b);
                                                                                                }
                                                                                            },
                                                                                            impFunc2: () => {
                                                                                            }
                                                                                        }
                                                                                    });
                                                                                    const __exports = __ifInstance15.exports;
                                                                                    return __exports.data(criteria[n] === lS(0, 7) ? 1 : 0);
                                                                                })();
                                                                            }
                                                                        }
                                                                    });
                                                                    const __exports = __ifInstance14.exports;
                                                                    return __exports.data(criteria[n] === lS(0, 6) ? 1 : 0);
                                                                })();
                                                            }
                                                        }
                                                    });
                                                    const __exports = __ifInstance13.exports;
                                                    return __exports.data(criteria[n] === lS(0, 5) ? 1 : 0);
                                                })();
                                            }
                                        }
                                    });
                                    const __exports = __ifInstance12.exports;
                                    return __exports.data(criteria[n] === lS(0, 4) ? 1 : 0);
                                })();
                                if (diff != 0) {
                                    return diff;
                                }
                            }
                            return 0;
                        },
                        fit: function (blocks) {
                            var n, node, block, len = blocks.length;
                            var w = len > 0 ? blocks[0].w : 0;
                            var h = len > 0 ? blocks[0].h : 0;
                            this.root = {
                                x: 0,
                                y: 0,
                                w: w,
                                h: h
                            };
                            (() => {
                                n = 0;
                                const __forInstance1 = new WebAssembly.Instance(__forWasmModule, {
                                    env: {
                                        test: () => {
                                            return n < len ? 1 : 0;
                                        },
                                        update: () => {
                                            n++;
                                        },
                                        body: () => {
                                            {
                                                block = blocks[n];
                                                (() => {
                                                    const __ifInstance16 = new WebAssembly.Instance(__ifWasmModule, {
                                                        env: {
                                                            impFunc1: () => {
                                                                {
                                                                    block.fit = this.splitNode(node, block.w, block.h);
                                                                }
                                                            },
                                                            impFunc2: () => {
                                                                {
                                                                    block.fit = this.growNode(block.w, block.h);
                                                                }
                                                            }
                                                        }
                                                    });
                                                    const __exports = __ifInstance16.exports;
                                                    return __exports.data((node = this.findNode(this.root, block.w, block.h)) ? 1 : 0);
                                                })();
                                            }
                                        }
                                    }
                                });
                                const __exports = __forInstance1.exports;
                                return __exports.data();
                            })();
                        },
                        findNode: function (root, w, h) {
                            if (root.used) {
                                return this.findNode(root.right, w, h) || this.findNode(root.down, w, h);
                            } else if (w <= root.w && h <= root.h) {
                                return root;
                            } else {
                                return null;
                            }
                        },
                        splitNode: function (node, w, h) {
                            node.used = true;
                            node.down = {
                                x: node.x,
                                y: node.y + h,
                                w: node.w,
                                h: node.h - h
                            };
                            node.right = {
                                x: node.x + w,
                                y: node.y,
                                w: node.w - w,
                                h: h
                            };
                            return node;
                        },
                        growNode: function (w, h) {
                            var canGrowDown = w <= this.root.w;
                            var canGrowRight = h <= this.root.h;
                            var shouldGrowRight = canGrowRight && this.root.h >= this.root.w + w;
                            var shouldGrowDown = canGrowDown && this.root.w >= this.root.h + h;
                            (() => {
                                const __ifInstance17 = new WebAssembly.Instance(__ifWasmModule, {
                                    env: {
                                        impFunc1: () => {
                                            {
                                                var pot = this.powerOfTwo(this.root.w) + 2 * this.options.padding.border - this.options.padding.shape;
                                                (() => {
                                                    const __ifInstance18 = new WebAssembly.Instance(__ifWasmModule, {
                                                        env: {
                                                            impFunc1: () => {
                                                                {
                                                                    shouldGrowDown = true;
                                                                    shouldGrowRight = false;
                                                                }
                                                            },
                                                            impFunc2: () => {
                                                            }
                                                        }
                                                    });
                                                    const __exports = __ifInstance18.exports;
                                                    return __exports.data(this.root.w + w + 2 * this.options.padding.border > pot && this.root.h + h + 2 * this.options.padding.border <= pot * 2 && canGrowDown ? 1 : 0);
                                                })();
                                            }
                                        },
                                        impFunc2: () => {
                                        }
                                    }
                                });
                                const __exports = __ifInstance17.exports;
                                return __exports.data(this.options.powerOfTwo ? 1 : 0);
                            })();
                            (() => {
                                const __ifInstance19 = new WebAssembly.Instance(__ifWasmModule, {
                                    env: {
                                        impFunc1: () => {
                                            {
                                                shouldGrowRight = false;
                                                canGrowRight = false;
                                            }
                                        },
                                        impFunc2: () => {
                                        }
                                    }
                                });
                                const __exports = __ifInstance19.exports;
                                return __exports.data(this.root.w + w + 2 * this.options.padding.border > this.options.maxsize.w ? 1 : 0);
                            })();
                            (() => {
                                const __ifInstance20 = new WebAssembly.Instance(__ifWasmModule, {
                                    env: {
                                        impFunc1: () => {
                                            {
                                                shouldGrowDown = false;
                                                canGrowDown = false;
                                            }
                                        },
                                        impFunc2: () => {
                                        }
                                    }
                                });
                                const __exports = __ifInstance20.exports;
                                return __exports.data(this.root.h + h + 2 * this.options.padding.border > this.options.maxsize.h ? 1 : 0);
                            })();
                            if (shouldGrowRight) {
                                return this.growRight(w, h);
                            } else if (shouldGrowDown) {
                                return this.growDown(w, h);
                            } else if (canGrowRight) {
                                return this.growRight(w, h);
                            } else if (canGrowDown) {
                                return this.growDown(w, h);
                            } else {
                                return null;
                            }
                        },
                        growRight: function (w, h) {
                            this.root = {
                                used: true,
                                x: 0,
                                y: 0,
                                w: this.root.w + w,
                                h: this.root.h,
                                down: this.root,
                                right: {
                                    x: this.root.w,
                                    y: 0,
                                    w: w,
                                    h: this.root.h
                                }
                            };
                            if (node = this.findNode(this.root, w, h)) {
                                return this.splitNode(node, w, h);
                            } else {
                                return null;
                            }
                        },
                        growDown: function (w, h) {
                            this.root = {
                                used: true,
                                x: 0,
                                y: 0,
                                w: this.root.w,
                                h: this.root.h + h,
                                down: {
                                    x: 0,
                                    y: this.root.h,
                                    w: this.root.w,
                                    h: h
                                },
                                right: this.root
                            };
                            if (node = this.findNode(this.root, w, h)) {
                                return this.splitNode(node, w, h);
                            } else {
                                return null;
                            }
                        }
                    });
                    return BinPacker;
                });
            }
        }
    });
    const __exports = __callInstance3.exports;
    return __exports.data();
})();</script>
</body>
</html>
