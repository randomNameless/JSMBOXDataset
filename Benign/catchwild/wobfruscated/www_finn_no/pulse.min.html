<!DOCTYPE html>

<html lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>pulse.min.html</title>
</head>
<body>
<script>!function(){"use strict";function e(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function t(e){if(Array.isArray(e))return e}function n(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function r(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function o(e,n){return t(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,s,a=[],c=!0,u=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=i.call(n)).done)&&(a.push(r.value),a.length!==t);c=!0);}catch(e){u=!0,o=e}finally{try{if(!c&&null!=n.return&&(s=n.return(),Object(s)!==s))return}finally{if(u)throw o}}return a}}(e,n)||s(e,n)||r()}function i(t){return function(t){if(Array.isArray(t))return e(t)}(t)||n(t)||s(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function s(t,n){if(t){if("string"==typeof t)return e(t,n);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?e(t,n):void 0}}function a(e){const t=typeof e;return null!=e&&("object"===t||"function"===t)}function c(e){return a(e)&&!Array.isArray(e)}function u(e){return"function"==typeof e}function l(e){return"[object String]"===Object.prototype.toString.call(e)}function d(e){return e instanceof Promise}function p(e,...t){function n(e,t){if(Array.isArray(t)){if(Array.isArray(e)){for(let r=0,o=t.length;r<o;r++)e[r]=n(e[r],t[r]);return e}return[...t]}return d(e)||d(t)?Promise.all([e,t]).then((([e,t])=>c(t)||d(e)?n(Object.assign({},e),t):t)):"object"==typeof t?e&&"object"==typeof e?(function(e,t){for(const[r,o]of Object.entries(t))e[r]=null===o?o:n(e[r],o)}(e,t),e):t?{...t}:t:t??e??void 0}for(const r of t)n(e,r);return e}function f(e,t,n){if(!t||!l(t))return n;const r=t.split(".");for(const t of r){if(!e)return n;e=e[t]}return e??n}function g(e,t=0){let n,r=0;const o=function(...o){const i=Date.now(),s=t-(i-r);s<=0||s>t?(n&&(clearTimeout(n),n=null),r=i,e.apply(this,o)):n||(n=setTimeout((()=>{r=Date.now(),n=null,e.apply(this,o)}),s))};return o.cancel=()=>{n&&clearTimeout(n)},o}async function v(e){if(d(e))return e.then((e=>v(e)));if(Array.isArray(e))return Promise.all(e.map(v));if(u(e))return v(Promise.resolve(e()));if(a(e)){const t=Object.getOwnPropertyNames(e),n=t.reduce(((t,n)=>{const r=e[n];return a(r)||u(r)||d(r)?t.concat(v(r)):t.concat([r])}),[]);return Promise.all(n).then((e=>e.reduce(((e,n,r)=>p(e,{[t[r]]:n})),{})))}return Promise.resolve(e)}function h(e){return Array.isArray(e)?Promise.all(e.map((e=>v(e)))).then((e=>p({},...e.filter(a)))):v(e)}function m(e){const t=[/iPad/,/Android/];function n(t){for(let n=0;n<t.length;n+=1)if(t[n].test(e))return!0;return!1}if(e){if(n([/iPhone;/,/iPod;/,/iPod touch;/,/^HTC/,/Fennec/,/IEMobile/,/BB10;/,/BlackBerry/,/SymbianOS.*AppleWebKit/,/^Mozilla.*Mobile.*Firefox/,/^Mozilla.*Chrome.*Mobile/,/Opera Mobi/,/Android.*Mobile/,/Android.*Mini/,/Symbian/,/^SonyEricsson/,/^Nokia/,/^SAMSUNG/,/^LG/]))return"mobile";if(n(t))return"tablet";if(-1!==e.search(/Hermes.*_app_/))return"tablet"}return"desktop"}var y="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function w(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function I(e){if(e.__esModule)return e;var t=e.default;if("function"==typeof t){var n=function e(){return this instanceof e?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};n.prototype=t.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(e).forEach((function(t){var r=Object.getOwnPropertyDescriptor(e,t);Object.defineProperty(n,t,r.get?r:{enumerable:!0,get:function(){return e[t]}})})),n}var b,E,S,P={},C={exports:{}};E=y,S=function(){var e=function(){},t="undefined",n=typeof window!==t&&typeof window.navigator!==t&&/Trident\/|MSIE /.test(window.navigator.userAgent),r=["trace","debug","info","warn","error"],o={},i=null;function s(e,t){var n=e[t];if("function"==typeof n.bind)return n.bind(e);try{return Function.prototype.bind.call(n,e)}catch(t){return function(){return Function.prototype.apply.apply(n,[e,arguments])}}}function a(){console.log&&(console.log.apply?console.log.apply(console,arguments):Function.prototype.apply.apply(console.log,[console,arguments])),console.trace&&console.trace()}function c(){for(var n=this.getLevel(),o=0;o<r.length;o++){var i=r[o];this[i]=o<n?e:this.methodFactory(i,n,this.name)}if(this.log=this.debug,typeof console===t&&n<this.levels.SILENT)return"No console available for logging"}function u(e){return function(){typeof console!==t&&(c.call(this),this[e].apply(this,arguments))}}function l(r,o,i){return function(r){return"debug"===r&&(r="log"),typeof console!==t&&("trace"===r&&n?a:void 0!==console[r]?s(console,r):void 0!==console.log?s(console,"log"):e)}(r)||u.apply(this,arguments)}function d(e,n){var s,a,u,d=this,p="loglevel";function f(){var e;if(typeof window!==t&&p){try{e=window.localStorage[p]}catch(e){}if(typeof e===t)try{var n=window.document.cookie,r=encodeURIComponent(p),o=n.indexOf(r+"=");-1!==o&&(e=/^([^;]+)/.exec(n.slice(o+r.length+1))[1])}catch(e){}return void 0===d.levels[e]&&(e=void 0),e}}function g(e){var t=e;if("string"==typeof t&&void 0!==d.levels[t.toUpperCase()]&&(t=d.levels[t.toUpperCase()]),"number"==typeof t&&t>=0&&t<=d.levels.SILENT)return t;throw new TypeError("log.setLevel() called with invalid level: "+e)}"string"==typeof e?p+=":"+e:"symbol"==typeof e&&(p=void 0),d.name=e,d.levels={TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,SILENT:5},d.methodFactory=n||l,d.getLevel=function(){return null!=u?u:null!=a?a:s},d.setLevel=function(e,n){return u=g(e),!1!==n&&function(e){var n=(r[e]||"silent").toUpperCase();if(typeof window!==t&&p){try{return void(window.localStorage[p]=n)}catch(e){}try{window.document.cookie=encodeURIComponent(p)+"="+n+";"}catch(e){}}}(u),c.call(d)},d.setDefaultLevel=function(e){a=g(e),f()||d.setLevel(e,!1)},d.resetLevel=function(){u=null,function(){if(typeof window!==t&&p){try{window.localStorage.removeItem(p)}catch(e){}try{window.document.cookie=encodeURIComponent(p)+"=; expires=Thu, 01 Jan 1970 00:00:00 UTC"}catch(e){}}}(),c.call(d)},d.enableAll=function(e){d.setLevel(d.levels.TRACE,e)},d.disableAll=function(e){d.setLevel(d.levels.SILENT,e)},d.rebuild=function(){if(i!==d&&(s=g(i.getLevel())),c.call(d),i===d)for(var e in o)o[e].rebuild()},s=g(i?i.getLevel():"WARN");var v=f();null!=v&&(u=g(v)),c.call(d)}(i=new d).getLogger=function(e){if("symbol"!=typeof e&&"string"!=typeof e||""===e)throw new TypeError("You must supply a name when creating a logger.");var t=o[e];return t||(t=o[e]=new d(e,i.methodFactory)),t};var p=typeof window!==t?window.log:void 0;return i.noConflict=function(){return typeof window!==t&&window.log===i&&(window.log=p),i},i.getLoggers=function(){return o},i.default=i,i},(b=C).exports?b.exports=S():E.log=S();for(var A,O=C.exports,_=w(O),T=[],j=0;j<256;++j)T.push((j+256).toString(16).slice(1));var N=new Uint8Array(16);function k(){if(!A&&!(A="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return A(N)}var D={randomUUID:"undefined"!=typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};function L(e,t,n){if(D.randomUUID&&!t&&!e)return D.randomUUID();var r=(e=e||{}).random||(e.rng||k)();return r[6]=15&r[6]|64,r[8]=63&r[8]|128,function(e,t=0){return(T[e[t+0]]+T[e[t+1]]+T[e[t+2]]+T[e[t+3]]+"-"+T[e[t+4]]+T[e[t+5]]+"-"+T[e[t+6]]+T[e[t+7]]+"-"+T[e[t+8]]+T[e[t+9]]+"-"+T[e[t+10]]+T[e[t+11]]+T[e[t+12]]+T[e[t+13]]+T[e[t+14]]+T[e[t+15]]).toLowerCase()}(r)}function R(e,t="__REALM_NOT_SET__"){return`sdrn:${t}:user:${e||"__USER_ID_NOT_SET__"}`}function U(e){return Object.prototype.hasOwnProperty.call(e,"actor")}function V(e){const{actor:t}=e||{};if(!t)return;const{id:n,realm:r,...o}=function(e){if(l(e))return{id:e};const{id:t,realm:n,...r}=e||{};return{id:t,realm:n,...r}}(t);if(!n)return;const i=R(n,r),s={"@id":i,"spt:userId":i};return Object.assign(s,o)}const x=()=>{};var B=Object.freeze({__proto__:null,default:V,defaultValue:x,generateActorSDRN:R,isActorInput:U});const M={},W=(e,...t)=>{M[e]||(M[e]=!0,console.warn(...t))},$=async e=>await K(e),K=async(e={},t={})=>U(e)||U(t)?await h(e.actor||t.actor||{}):(W("no-actor-builder-and-no-event-present","Cis sync initiated with no actor builder and no event available. If you do not use a login system, please indicate this using tracker.update({ actor: undefined }), otherwise do tracker.update({ actor: somePromise }) with a promise that resolves to the login state."),{}),H={PULSE_COOKIE_KEY:"_pulse2data",TEST_COOKIE_KEY:"_pulse2test",ENV_COOKIE_KEY:"_pulse2env",USE_SECURE_COOKIES:!0,USE_LOCALSTORAGE:!1},F="undefined"!=typeof window&&void 0!==window.document,G=e=>{if(F)return window[e]},J={crypto:F?crypto:globalThis.crypto,localStorage:G("localStorage"),sessionStorage:G("sessionStorage")},{USE_SECURE_COOKIES:q,USE_LOCALSTORAGE:z}=H;function Y(e,t=z){if(!F)return"";if(t){const t=localStorage.getItem(e)||"";if(t)return t}return decodeURIComponent(document.cookie.replace(new RegExp(`(?:(?:^|.*;)\\s*${encodeURIComponent(e).replace(/[-.+*]/g,"\\$&")}\\s*\\=\\s*([^;]*).*$)|^.*$`),"$1"))}function Q(e,t,n,r=1,o=z,i=q){if(F){const s=function(e=1){const t=Date.now()+1e3*e*60*60*24;return new Date(t)}(r).toUTCString();let a;a=`${e}=${encodeURIComponent(t)}`,a+=";path=/",n&&(a+=`;domain=${n}`),r&&(a+=`;expires=${s}`),i&&"https:"===window.location.protocol&&void 0===window.safari&&(a+=";SameSite=None;Secure"),document.cookie=a,o&&(""===t?localStorage.removeItem(e):localStorage.setItem(e,t))}}function X(e,t){Q(e,"",t,-1)}const{TEST_COOKIE_KEY:Z}=H;let ee=function(){let e;return()=>{if(!F)return"";if(e)return e;const t=`${window.location.hostname}`.split("."),n=function(e=16){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=t.length;let r="";if(e<0)return r;const o=new Uint32Array(e);return J.crypto?.getRandomValues(o),o.forEach((e=>{r+=t.charAt(e%n)})),r}();let r=window.location.hostname,o="";for(let e=0;e<t.length;e+=1)try{if(r=t.slice(-(e+1)).join("."),Q(Z,n,r,1),o=Y(Z),X(Z,r),o===n)break}catch(e){}return e=r,r}}();const te=(e="localStorage")=>{const t=J[e];return{getItem:e=>F&&t?t.getItem(e):void 0,setItem:(e,n)=>{F&&t&&t.setItem(e,n)}}},ne="_pulse.internal.identity.ppid",re="_pulse.internal.identity.cis";var oe={getCisCacheFromStorage:()=>{try{const e=te();return JSON.parse(e.getItem(re)??"")}catch(e){return{}}},setCisCacheToStorage:e=>{try{return te().setItem(re,JSON.stringify(e)),!0}catch(e){return!1}},getPPIDsFromStorage:()=>{try{const e=te();return JSON.parse(e.getItem(ne)??"")}catch(e){return{}}},setPPIDsToStorage:e=>{try{return te().setItem(ne,JSON.stringify(e)),!0}catch(e){return!1}}};const{PULSE_COOKIE_KEY:ie,ENV_COOKIE_KEY:se}=H,ae=9e5,ce=144e5,ue=new class{constructor(){this.events={}}on(e,t){"object"!=typeof this.events[e]&&(this.events[e]=[]),this.events[e].push(t)}off(e,t){this.removeListener(e,t)}removeListener(e,t){if("object"==typeof this.events[e]){const n=this.events[e].indexOf(t);-1!==n&&this.events[e].splice(n,1)}}removeAllListeners(){this.events={}}emit(e,t){"object"==typeof this.events[e]&&this.events[e].filter((e=>null!=e)).forEach((e=>e(t)))}};function le(e=Y(ie)){let t=decodeURIComponent(e).split(",");10!==t.length&&(t=[]),Y(se);const n=oe.getPPIDsFromStorage(),r=oe.getCisCacheFromStorage();return{environmentId:t[0],prevUserId:t[2]?t[2]:void 0,refreshAfterTimestamp:t[3]?parseInt(t[3],10):void 0,jwe:t[4],anId:t[5],syncWithAppNexus:t[6]?parseInt(t[6],10):void 0,doTracking:t[7]?"true"===t[7]:void 0,pixelInjected:t[8]?"true"===t[8]:void 0,adId:t[9],altEnvIds:undefined,visitorIdPlaceholder:t[1],ppId:n,includeAdvertising:r?.includeAdvertising}}function de(e){const{environmentId:t="",prevUserId:n="",jwe:r="",anId:o="",doTracking:i="",pixelInjected:s="",adId:a="",visitorIdPlaceholder:c="v",ppId:u={},refreshAfterTimestamp:l,includeAdvertising:d}=e||{},p=Date.now(),f=[t,c,n,l||new Date(p+ae).getTime(),r,o,o?(new Date).setTime(p+ce):0,i,s,a].join(",");oe.setPPIDsToStorage(u),oe.setCisCacheToStorage({includeAdvertising:d}),Q(ie,f,ee(),730),ue.emit("environmentIdSet",t),ue.emit("jweSet",r)}var pe;function fe(){const e={...le(),adId:"",anId:"",includeAdvertising:!1,jwe:"",syncWithAppNexus:0};return de(e),e}function ge(e,t=Date.now()){return e.syncWithAppNexus&&t>e.syncWithAppNexus||!e.anId}!function(e){e.Initialise="initialise",e.Login="login",e.Logout="logout",e.Refresh="refresh",e.NewAnid="new-anid",e.includeAdvertisingChange="includeAdvertisingChange"}(pe||(pe={}));const ve=(e,t)=>!t||t.includes(e),he=(e,t)=>Boolean(e)&&String(e)!==String(t),me=(e,t)=>!e&&String(e)!==String(t),ye=(e,t)=>t&&e>t,we=(e,t)=>e!==t,Ie=(e,t,n=!1,r=[])=>!e||-1!==e.indexOf("undefined")||!t.environmentId||!t.jwe||n&&r.length>0&&0===Object.keys(t.ppId).length;function be(e,t={}){const{investigateSyncOn:n,cookie:r=Y(ie),includeAdvertising:o,vendors:i}=t,s=le(r),a=Date.now(),c=!!t?.xandrEnabled&&ge(s,a);return he(e,s.prevUserId)?{syncWithCis:!0,waitForCis:!0,syncWithAppNexus:c,syncWithCisReason:pe.Login}:me(e,s.prevUserId)?{syncWithCis:!0,waitForCis:!0,syncWithAppNexus:c,syncWithCisReason:pe.Logout}:ye(a,s.refreshAfterTimestamp)?{syncWithCis:!0,waitForCis:!0,syncWithAppNexus:c,syncWithCisReason:pe.Refresh}:Ie(r,s,o,i)?{syncWithCis:!0,waitForCis:!0,syncWithAppNexus:c,syncWithCisReason:pe.Initialise}:t?.xandrEnabled&&ve(pe.NewAnid,n)?{syncWithCis:!0,waitForCis:!0,syncWithAppNexus:!1,syncWithCisReason:pe.NewAnid}:we(s.includeAdvertising,o)?{syncWithCis:!0,waitForCis:!0,syncWithAppNexus:c,syncWithCisReason:pe.includeAdvertisingChange}:{syncWithCis:!1,syncWithAppNexus:c}}const Ee="https://secure.adnxs.com/getuidj",Se="pulse2an_36jayge7acx2ge456aau2ls4tpa0z";function Pe(e){if(!F)return!1;if(!document.getElementById(Se)){const t=document.createElement("img");t.src=`https://secure.adnxs.com/getuid?${new URL("/api/v1/sync?ANID=$UID",e).toString()}`,t.id=Se,t.style.display="none";return document.getElementsByTagName("body").item(0).appendChild(t),!0}return!1}let Ce=Promise.resolve(!1);async function Ae(e="https://cis.schibsted.com"){if(ge(le())){return!!Pe(e)&&(await new Promise((e=>{setTimeout((()=>e(!0)),2e3)})),Ce=Ce.then((()=>fetch(Ee,{method:"GET",credentials:"include"}).then((e=>e.json())).then((({uid:e}={})=>{if(e){const t=le();if(e!==t.anId)return de({...t,anId:e}),!0}return!1})).catch((()=>!1)))),Ce)}return!1}const{PULSE_COOKIE_KEY:Oe}=H;let _e="cis.schibsted.com";const Te="user",je="guest",Ne=e=>{let t=je;return e&&(t=Te),`/api/v2/identify/${t}`},ke=new Headers({"Content-Type":"application/json"}),De=2,Le=new Map;async function Re({anId:e,cisLocation:t,clientId:n,includeAdvertising:r,resolvedJwe:o,trackerType:i,trackerVersion:s,userId:a,vendors:c},u=0){if(u>De)throw new Error("Too many CIS redirects");const l=await async function({anId:e,cisLocation:t,clientId:n,includeAdvertising:r,resolvedJwe:o,trackerType:i,trackerVersion:s,userId:a,vendors:c}={}){const u=`${"/"===t?.at(-1)?t.slice(0,-1):t}${Ne(a)}`;if(document.requestStorageAccessFor&&t){const{state:e}=await navigator.permissions.query({name:"top-level-storage-access",requestedOrigin:t});if("granted"===e||navigator.userActivation.isActive)try{await document.requestStorageAccessFor(t)}catch(e){O.warn(`requestStorageAccessFor for origin ${t} failed, cis cookie will not be available`),O.warn(e)}else O.warn("requestStorageAccessFor not called since permissions were not granted. initiating pulse as a result of a user action will resolve this. 3rd party cookies will not work."),O.warn("See https://developers.google.com/privacy-sandbox/3pcd/related-website-sets-integration#user_prompt_and_user_gesture for details")}return fetch(new URL(u).toString(),{method:"POST",credentials:"include",headers:ke,body:JSON.stringify({anId:e,clientId:n,includeAdvertising:r,jwe:o,trackerType:i,trackerVersion:s,userId:a,vendors:c})})}({anId:e,cisLocation:t,clientId:n,includeAdvertising:r,resolvedJwe:o,trackerType:i,trackerVersion:s,userId:a,vendors:c}),{data:d}=await l.json();return d.redirectToHost?(_e=d.redirectToHost,Re({anId:e,resolvedJwe:o,userId:a,cisLocation:`https://${_e}`,clientId:n,trackerType:i,trackerVersion:s,includeAdvertising:r,vendors:c},u+1)):d}let Ue=Promise.resolve(le()),Ve=Promise.resolve(le());async function xe(e,t=!1,n,r,o,i,s,a,c,u){const l=Y(Oe),{syncWithCis:d,syncWithCisReason:p}=be(e,{cookie:l,investigateSyncOn:[i],...u}),{anId:f,jwe:g,prevUserId:v}=le(l),h=async()=>{const i=r||g;let l=e;p!==pe.Login&&p!==pe.Logout&&(l=v);const h=l&&`sdrn:${o}:user:${l}`;if(d||t)try{const t=await Re({anId:f,resolvedJwe:i,userId:h,cisLocation:n,clientId:s,trackerType:a,trackerVersion:c,includeAdvertising:u?.includeAdvertising,vendors:u?.vendors}),r=t.refreshAfter?new Date(t.refreshAfter).getTime():0,o={ppId:{},...t,prevUserId:e,refreshAfterTimestamp:r,includeAdvertising:u?.includeAdvertising};return de(o),o}catch(e){}finally{u?.trackerId&&Le.delete(u.trackerId)}return le()};if(u?.trackerId){const{request:e,requestReason:n}=Le.get(u.trackerId)||{};let r=e;return r&&n===p&&!t||(r=h(),Le.set(u.trackerId,{request:r,requestReason:p})),r}return Ue=Ue.then(h),Ue}var Be={SDK_VERSION:"6.1.0",GIT_COMMIT:"17992514"};const Me=()=>{!function(e){const t={...le(),refreshAfterTimestamp:e?e.getTime():(new Date).getTime()};de(t)}(new Date)},We=async(e,t,n)=>{const r=K(e,t),{cisBaseUrl:o,cisEnabled:i,includeAdvertising:s,isHybrid:a,nativeJwe:c,providerId:u,trackerId:l,vendors:d,xandrEnabled:p}=n||{},[f,g]=await Promise.all([s,r]),{id:v,realm:h}=g;return i?async function(e,t,n,r="schibsted.com",o,i,s,a,c,u){i||"boolean"==typeof i||(i=u?.vendors?.includes("xandr")||!1);const{syncWithAppNexus:l,syncWithCis:d,waitForCis:p,syncWithCisReason:f}=be(e,{investigateSyncOn:o,xandrEnabled:i,...u}),g=le(),v=n||"https://cis.schibsted.com";let h=Promise.resolve(g);(d||u?.forceSync)&&(h=xe(e,Boolean(u?.forceSync),v,t,r,f,s||"",a||"",c,u));let m=Promise.resolve(g);return(p||u?.forceSync)&&(m=h),i&&l&&u?.includeAdvertising&&(Ve=Ve.then((()=>m)).then((()=>Ae(v))).then((n=>n?xe(e,!0,v,t,r,pe.NewAnid,s||"",a||"",c,u):le()))),m}(v,c,o,h,void 0,p,u,a?"Hybrid":"Web",Be.SDK_VERSION,{includeAdvertising:f,vendors:d,trackerId:l}):{doTracking:!0}},$e=async(e,t)=>{const{vendors:n}=t;if(!Array.isArray(n))throw new Error("'vendors' given is not an array as expected");const{adId:r,ppId:o}=await We({actor:$(e)},e,t),i={};return o?(n.forEach((e=>{const t=o[e];t&&(i[e]="xandr"===e&&r?{...t,adId:r}:t)})),i):{}};var Ke,He,Fe;function Ge(e){return Boolean(e&&"object"==typeof e&&"string"==typeof e.status&&Object.values(Fe).includes(e.status))}!function(e){e.CMP_ANALYTICS="CMP_ANALYTICS",e.CMP_MARKETING="CMP_MARKETING",e.CMP_ADVERTISING="CMP_ADVERTISING",e.CMP_PERSONALIZATION="CMP_PERSONALIZATION"}(Ke||(Ke={})),function(e){e.DEFAULT="default",e.CMP="cmp",e.CACHE="cache"}(He||(He={})),function(e){e.ACCEPTED="accepted",e.REJECTED="rejected",e.UNKNOWN="unknown"}(Fe||(Fe={}));const Je=e=>!(!e||d(e)||!e?.purposes||!Object.values(e.purposes).every((e=>{return t=e,!t?.status;var t}))),qe='Invalid consents passed to the Pulse SDK. "requireAdvertisingOptIn" and no "consents" config param present.';async function ze(e,t){e||void 0===t||void 0===t||W("NO_CONSENT_IN_CONFIG",qe);const n=await Qe(e,t);return n||fe(),n}function Ye(e,t){e||void 0===t||void 0===t||W("NO_CONSENT_IN_CONFIG",qe);const n=Xe(e,t);return n||fe(),n}async function Qe(e,t){if(!await t)return!0;if(d(e)){const t=await e;return t?.purposes?.[Ke.CMP_ADVERTISING]?.status===Fe.ACCEPTED}return Je(e)?Boolean(e?.purposes?.[Ke.CMP_ADVERTISING]?.optIn):e?.purposes?.[Ke.CMP_ADVERTISING]?.status===Fe.ACCEPTED}function Xe(e,t){return!t||(Je(e)?Boolean(e?.purposes?.[Ke.CMP_ADVERTISING]?.optIn):e?.purposes?.[Ke.CMP_ADVERTISING]?.status===Fe.ACCEPTED)}function Ze(e){const{consents:t}=e||{};if(!t)return;return{purposes:tt(t?.purposes??{}),source:t?.source}}const et={[Ke.CMP_ADVERTISING]:{optIn:!1,status:Fe.UNKNOWN},[Ke.CMP_ANALYTICS]:{optIn:!1,status:Fe.UNKNOWN},[Ke.CMP_MARKETING]:{optIn:!1,status:Fe.UNKNOWN},[Ke.CMP_PERSONALIZATION]:{optIn:!1,status:Fe.UNKNOWN}};function tt(e){const t={...et};for(const r in e){const o=r;if(Boolean(et[o])){const r=e[o];l(r)&&((n=r)&&""!==n)?t[o]=nt(e[o]):a(r)&&(r.status&&void 0===r.optIn&&(r.optIn=r.status===Fe.ACCEPTED),t[o]=r)}}var n;return t}function nt(e){return{"@id":e,optIn:!0}}var rt=Object.freeze({__proto__:null,get ConsentsCategory(){return Ke},get ConsentsPurposeCategoryStatus(){return Fe},get ConsentsSource(){return He},applyAdvertisingConsent:ze,applyAdvertisingConsentSync:Ye,default:Ze,defaultPurposes:et,isConsentsPurposeCategory:Ge,isConsentsPurposes:function(e){if(!e||"object"!=typeof e||!e.purposes||"object"!=typeof e.purposes)return!1;for(const t in e.purposes){if(!Object.values(Ke).includes(t))return!1;if(!Ge(e.purposes[t]))return!1}return!0},resolveIncludeAdvertising:Qe,resolveIncludeAdvertisingSync:Xe});function ot(e){return`sdrn:schibsted:environment:${e}`}const it=e=>t=>{const{device:n}=t||{};if(!n)return;const r=p({},e(),function(e){if(l(e))return{id:e};const{id:t,...n}=e||{};return{id:t,...n}}(n)),{id:o,additionalIds:i,...s}=r;if(!o)return;const a={"@type":"Device",environmentId:ot(o)};return i&&(a.additionalEnvironmentIds=i.map(ot)),Object.assign(a,s)},st="undefined"!=typeof window&&void 0!==window.document,at=e=>{if(st)return window[e]},ct={crypto:st?crypto:globalThis.crypto,localStorage:at("localStorage"),sessionStorage:at("sessionStorage")};function ut(){try{const{localStorage:e}=window;return e.setItem("pulse4test","check"),e.removeItem("pulse4test"),!0}catch(e){return!1}}function lt(){if(!st)return"";let e,t;const{document:n}=window;return void 0!==window.innerWidth?(e=window.innerWidth,t=window.innerHeight):void 0!==n.documentElement.clientWidth&&0!==n.documentElement.clientWidth?(e=n.documentElement.clientWidth,t=n.documentElement.clientHeight):(e=n.getElementsByTagName("body")[0].clientWidth,t=n.getElementsByTagName("body")[0].clientHeight),`${e}x${t}`}const dt=()=>{if(!st)return{};const{navigator:e,screen:t}=window;return{acceptLanguage:e.userLanguage||e.language,screenSize:`${t.width}x${t.height}`,userAgent:e.userAgent,deviceType:m(window.navigator.userAgent),viewportSize:lt(),localStorageEnabled:ut()}};function pt(e){const{device:t}=e||{},{environmentId:n,jwe:r}=le(),o={id:n,jweIds:r,...l(t)?{id:t}:t};return it(dt)({device:o})}var ft=Object.freeze({__proto__:null,default:pt,defaultValue:dt,device:it,generateEnvironmentSDRN:ot});function gt(e){const{errors:t,assignmentId:n,requestTimestamp:r}=(e||{}).experimentMetadata||{},o={};return t&&t.length&&(o.errors=t),n&&(o.assignmentId=n),r&&(o.requestTimestamp=r),function(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}(o)?void 0:o}function vt(){}var ht=Object.freeze({__proto__:null,default:gt,defaultValue:vt});function mt(e,t){return`sdrn:${t}:experiment:${e}`}function yt(e){const{id:t,platform:n,...r}=e||{};return{"@id":mt(t,n),...n&&{platform:n},...r}}function wt(e){const t=(e||{}).experiments||[];if(t.length>0)return t.map(yt)}const It=()=>{};var bt=Object.freeze({__proto__:null,default:wt,defaultValue:It});const Et="GeoCoordinates";function St(e){if(null!=e&&""!==e&&!Number.isNaN(e))return(Math.round(1e3*Number(e))/1e3).toFixed(3)}function Pt(e){const{location:t}=e||{},{latitude:n,longitude:r,altitude:o,...i}=t||{},s=St(n),a=St(r);if(s||a)return{"@type":Et,...i,latitude:s,longitude:a}}function Ct(){}var At=Object.freeze({__proto__:null,default:Pt,defaultValue:Ct});const Ot={classifiedad:"classified",notificationcontent:"notification",businesstransaction:"transaction",uielement:"element"},_t=(e="")=>Ot[e.toLowerCase()]??e.toLowerCase();function Tt(e,t,n){if(function(e){return l(e)&&e?.startsWith("sdrn:")}(e))return e;if((l(e)||Number.isFinite(e))&&l(t)&&l(n)){return`sdrn:${t}:${_t(n)}:${e}`}}function jt({object:e,provider:t}){const{id:n,type:r="Content",custom:o,...i}=e||{},{id:s}=t||{},a=Tt(n,s,r);let c={};return a&&(c={"@id":a,"@type":r}),o&&(c["spt:custom"]=o),p({},c,i)}const Nt={UIElement:function({object:e,provider:t,page:n,target:r}){const{id:o,type:i,custom:s,...a}=e||{},{id:c,type:u}=n||{},{id:l,type:d}=r||{},{id:f}=t||{},g={"@id":u||d?`${Tt(c||l,f,u||d)||""}:element:${o}`:Tt(o,f,i),"@type":i};return s&&(g["spt:custom"]=s),p({},g,a)},Account:function({object:e}){const{id:t,realm:n="schibsted.com",type:r,custom:o,...i}=e||{};if(!t)return;const s={"@id":`sdrn:${n}:user:${t}`,"@type":"Account",accountId:t};return o&&(s["spt:custom"]=o),p({},s,i)}};const kt=(e,t)=>{const{object:n={}}=e||{},{page:r}=n,o=t||r,i=Object.keys(n).reduce(((t,r)=>{const i=n[r];return Array.isArray(i)?{...t,[r]:i.map((t=>c(t)?kt(Object.assign({},e,{object:t}),o):t))}:a(i)?{...t,[r]:kt(Object.assign({},e,{object:i}),o)}:{...t,[r]:i}}),{}),s=Object.assign({},e,{page:o,object:i});return(u=n.type,Nt[u]||jt)(s);var u},Dt=()=>{if(!st)return{};const{location:e={href:void 0}}=window;return{name:document.title,url:e.href,id:e.href}};var Lt=Object.freeze({__proto__:null,default:kt,defaultValue:Dt,formatObject:kt,generateObjectSDRN:Tt});const Rt=new RegExp("^unknown$|^sdrn:(.*)$");function Ut(e){const{origin:t,provider:n}=e||{},{id:r,type:o,...i}=t||{},{id:s}=n||{},a=l(c=r)&&Rt.test(c)?r:Tt(r,s,o);var c;const u={...a&&{"@id":a},...o&&{"@type":o}};return Object.assign({},u,i)}const Vt=()=>({url:st?document.referrer:""});var xt=Object.freeze({__proto__:null,default:Ut,defaultValue:Vt});const Bt="--PROVIDER-ID-NOT-DEFINED--",Mt="Organization";function Wt(e){return e?`sdrn:schibsted:client:${e}`:Bt}function $t(e){const{provider:t}=e||{},{id:n,type:r=Mt,...o}=t||{},i={"@type":r,"@id":Wt(n)};return Object.assign({},i,o)}const Kt=()=>{};var Ht=Object.freeze({__proto__:null,default:$t,defaultValue:Kt,generateProviderSDRN:Wt});function Ft(e){const{tracker:t}=e||{},n={name:"Pulse Node.js SDK",type:"JS",version:Be.SDK_VERSION};return Object.assign({},n,t)}const Gt=()=>{};var Jt=Object.freeze({__proto__:null,default:Ft,defaultValue:Gt});const qt="schema.schibsted.com";function zt({eventInput:e,sdkConfig:t}={}){return Object.assign({},e,{schema:(e||{}).schema||`http://${t?.schemaLocation||qt}/events/base-routable-event.json/238.json#`,provider:$t(e),actor:V(e)})}function Yt(e){return p({actor:x(),experiments:It(),experimentMetadata:void 0,device:dt(),location:void 0,object:Dt(),origin:Vt(),provider:Kt(),tracker:Gt()},e)}function Qt({eventInput:e,sdkConfig:t}={}){const n=Yt(e),r=e?.pageViewId,o=t?.pageViewId;return Object.assign({},(s=["type"],(i=e)?Object.fromEntries(Object.entries(i).filter((([e])=>!s.includes(e)))):{}),{"@type":e?.type||"View",pageViewId:r||o,schema:e?.schema||`http://${t?.schemaLocation||qt}/events/tracker-event.json/351.json`,actor:V(n),consents:Ze(n),experiments:wt(n),experimentMetadata:gt(n),device:pt(n),location:Pt(n),object:kt(n),origin:Ut(n),provider:$t(n),target:n.target&&kt(Object.assign({},n,{object:n.target})),tracker:Ft(n)});var i,s}function Xt({eventInput:e,sdkConfig:t}={}){return Object.assign(Qt({eventInput:e,sdkConfig:t}),{schema:e?.schema||`http://${t?.schemaLocation||qt}/events/engagement-event.json/378.json`,"@type":"Engagement"})}function Zt({eventInput:e={}}={}){return e}zt.defaults=function(e){return p({actor:x(),provider:Kt()},e)},Qt.defaults=Yt,Xt.defaults=Yt,Zt.defaults=()=>({});var en=Object.freeze({__proto__:null,engagementEvent:Xt,identityEvent:Zt,routableEvent:zt,trackerEvent:Qt});const{USE_LOCALSTORAGE:tn}=H,nn="_pulsesession",rn=()=>{const e=(e=>{try{const t=Y(e);if(t)return JSON.parse(t)}catch(e){return}})(nn);if(e){const[t,n,r]=e,o=new Date(n),i=new Date(r);if(t&&o&&i&&!isNaN(o.getTime())&&!isNaN(i.getTime()))return{id:t,startTime:o,lastEventTime:i}}},on=(e,t)=>{const n=t??new Date;return!e||e.lastEventTime.getTime()<n.getTime()-18e5?(e=>{const t=e??new Date;return{id:(n=L(),`sdrn:schibsted:session:${n}`),startTime:t,lastEventTime:t};var n})(n):{...e,lastEventTime:n}};function sn(e,t){const n=rn(),r=on(n,t);(e=>{const{id:t,startTime:n,lastEventTime:r}=e;try{const e=[t,n.getTime(),r.getTime()],o=1/48;Q(nn,JSON.stringify(e),ee(),o),!tn&&st&&window.localStorage&&window.localStorage.removeItem(nn)}catch(e){}})(r);const{id:o,startTime:i}=r;return{"@id":o,startTime:i.toISOString()}}var an=Object.freeze({__proto__:null,actor:B,consents:rt,device:ft,events:en,experimentMetadata:ht,experiments:bt,location:At,objects:Lt,origin:xt,provider:Ht,session:sn,tracker:Jt});const cn={cisEnabled:!0,eventDebounce:200,environment:"browser",collectorPath:"/api/v1/track",useBeaconWhenAvailable:!0},un=()=>{};const ln=()=>()=>({});var dn;!function(e){e.BEFORE_UNLOAD="beforeunload",e.PAGE_HIDE="pagehide",e.POP_STATE="popstate",e.VISIBILITY_CHANGE="visibilitychange",e.SCROLL="scroll",e.RESIZE="resize",e.MOUSEDOWN="mousedown",e.MOUSEMOVE="mousemove",e.KEYDOWN="keydown",e.TOUCHSTART="touchstart"}(dn||(dn={}));let pn,fn,gn=[],vn=[],hn=[],mn=null,yn=g((()=>{}),0),wn=0,In={value:0,interval:void 0,timeSinceLastActivity:0},bn={type:"Leave",engagement:{objectViewPercentage:0,maxObjectViewPercentage:0,pageViewPercentage:0,maxPageViewPercentage:0,pageScrollPosition:0,maxPageScrollPosition:0}},En=ln();function Sn(e,t,n,r,o={}){fn=o.additionalHeightBuilder,Pn()?O.warn("addPageLeaveTracking was called while leave-tracking was already active. Consider using updatePageLeaveTracking with resetProperties=false if you want to update the page/object element!"):(pn=e.state.useBeacon,e.state.useBeacon=!0,En=r||ln(),function(e){const t=Vn([dn.BEFORE_UNLOAD],(()=>Dn(e,En(),dn.BEFORE_UNLOAD)),{capture:!0}),n=Vn([dn.PAGE_HIDE],(()=>Dn(e,En(),dn.PAGE_HIDE)),{capture:!0}),r=Vn([dn.POP_STATE],(()=>Dn(e,En(),dn.POP_STATE)),{capture:!0}),o=Vn([dn.VISIBILITY_CHANGE],(()=>{"hidden"===document.visibilityState&&Dn(e,En(),dn.VISIBILITY_CHANGE)}),{capture:!0});gn.push(...t),gn.push(...n),gn.push(...r),gn.push(...o)}(e),An(t,n,o.objectResizable),wn=Nn(),O.debug("addPageLeaveTracking:after:state",bn))}function Pn(){return!(0===gn.length&&0===vn.length&&0===hn.length)}function Cn(e){e.state.useBeacon=pn,gn=xn(gn,{capture:!0}),On(),_n(),En=ln(),O.debug("removePageLeaveTracking:after:state",En())}function An(e,t,n=!1){!function(e,t,n){Ln(e,t),yn=g((()=>Ln(e,t)),500),vn=Vn([dn.SCROLL,dn.RESIZE],yn),n&&(mn||(mn=new ResizeObserver((()=>{jn(),yn()}))),mn.observe(e))}(e,t,n),function(){if(void 0!==In.interval)return;const e=1e3,t=3e4;In.interval=window.setInterval((()=>{In.timeSinceLastActivity+=e,In.timeSinceLastActivity<t&&(In.value+=e)}),e);const n=[dn.SCROLL,dn.MOUSEDOWN,dn.MOUSEMOVE,dn.KEYDOWN,dn.TOUCHSTART],r=Mn();hn=Vn(n,(()=>{In=function(e){return{...e,timeSinceLastActivity:0}}(In)}),!!r&&{passive:!0})}()}function On(){vn=xn(vn),hn=xn(hn),mn&&(mn.disconnect(),mn=null)}const _n=()=>{bn={type:"Leave",engagement:{objectViewPercentage:0,maxObjectViewPercentage:0,pageViewPercentage:0,maxPageViewPercentage:0,pageScrollPosition:0,maxPageScrollPosition:0}},wn=Nn(),In=Tn()},Tn=()=>(clearInterval(In.interval),{value:0,interval:void 0,timeSinceLastActivity:0}),jn=()=>{bn.engagement=Object.assign({},bn.engagement,{objectViewPercentage:0,maxObjectViewPercentage:0,pageViewPercentage:0,maxPageViewPercentage:0,pageScrollPosition:0,maxPageScrollPosition:0})},Nn=()=>(new Date).getTime();function kn(e){p(bn,e)}async function Dn(e,t,n){const r=(new Date).getTime()-wn,o=t||En(),i=p({...bn,engagement:{duration:r,activityDuration:In.value,...bn.engagement},object:{...n&&{"spt:custom":{"spt:eventName":n}}}},o);O.debug("trackPageLeave: event",i),e.track("trackerEvent",i,{applyBookmarkKey:er.PAGE_VIEW}),Cn(e)}function Ln(e,t){const{totalHeight:n,viewedHeight:r}=u(fn)?fn():{totalHeight:0,viewedHeight:0},o=Rn(e)+r,i=Rn(t)+r,s=Un(t)+r,a=Math.max(s,Number(bn.engagement.maxPageScrollPosition)),c=Bn(o,e.scrollHeight+n),l=Math.max(c,Number(bn.engagement.maxObjectViewPercentage)),d=Bn(i,t.scrollHeight+n),f=Math.max(d,Number(bn.engagement.maxPageViewPercentage));O.debug("updateViewedContent:before:engagement",{...bn.engagement}),p(bn.engagement,{pageScrollPosition:s,maxPageScrollPosition:a,objectViewPercentage:c,maxObjectViewPercentage:l,pageViewPercentage:d,maxPageViewPercentage:f}),O.debug("updateViewedContent:after:engagement",{...bn.engagement})}const Rn=e=>{const t=e.getBoundingClientRect(),n=st?e.scrollHeight-t.bottom+window.innerHeight:0;return n<=0?0:Math.min(n,e.scrollHeight)},Un=e=>Math.abs(Math.min(e.getBoundingClientRect().top,0));function Vn(e,t,n){return e.map((e=>(st&&window.addEventListener(e,t,n),[e,t])))}function xn(e,t={}){return e.forEach((([e,n])=>{st&&window.removeEventListener(e,n,t)})),yn.cancel(),[]}const Bn=(e,t)=>Math.round(100*e/t),Mn=()=>{let e;if(void 0!==e)return e;try{const t={get passive(){return e=!0,!1}},n=()=>{};window.addEventListener("test",n,t),window.removeEventListener("test",n)}catch(t){e=!1}return e},Wn=st&&Boolean(window.navigator.sendBeacon);const $n="_pulse.internal.remote.config";let Kn=null;async function Hn(e,t=3){try{return await async function(e){return(await fetch(e,{method:"GET"})).json()}(e)}catch(n){if(t>1)return Hn(e,t-1);throw n}}function Fn(e,t,n){return!function(e){const t=!!e;return _.debug(`RemoteConfig: isConfigValid: ${t}`),t}(t)||function(e,t){const n=!e||!t||new Date(e).getTime()+6e4*Math.min(t,10080)<=(new Date).getTime();return _.debug(`RemoteConfig: isConfigExpired: ${n}`),n}(n?.updatedAt,t?.["ttl-minutes"])||e!==n?.remoteConfigUrl}let Gn=null;async function Jn(e="default",t){try{if(Kn||(Kn=function(){try{return JSON.parse(ct.localStorage?.getItem($n)??"")}catch(e){return null}}()),!Kn||Fn(t,Kn.config,Kn.metadata)){let e;Gn?e=await Gn:(Gn=Hn(t),e=await Gn,Gn=null),Kn=function(e,t){try{const n={config:e,metadata:{remoteConfigUrl:t,updatedAt:(new Date).toISOString()}};return ct.localStorage?.setItem($n,JSON.stringify(n)),n}catch(e){return null}}(e,t)}return function(e,t){if(l(e)&&t){let n=t.scopes&&t.scopes[e]?.services||null;return n||"default"===e||(n=t.scopes.default.services),n}return null}(e,Kn?.config)}catch(e){return _.debug(e),Gn=null,null}}const{generateProviderSDRN:qn}=Ht,zn={identity:Zt,trackerEvent:Qt,engagementEvent:Xt,routableEvent:zt};function Yn(e){return e in zn?zn[e]:zn.trackerEvent}const Qn=e=>Boolean(e?.isHybrid)||Boolean(e?.nativeJwe);let Xn=!1,Zn=!1;const er={PAGE_VIEW:"page-view"};let tr=class e{constructor(e,t,n){if(_.setLevel(t?.logLevel??_.levels.ERROR),!e||"string"!=typeof e)throw new Error("Required parameter `providerId` missing");let r;if(r=d(t?.consents)?ze(t?.consents,t?.requireAdvertisingOptIn):Ye(t?.consents,t?.requireAdvertisingOptIn),Zn=Boolean(t?.cisBaseUrl),Xn=Boolean(t?.collectorBaseUrl),function(e=""){const{jwe:t}=le();e&&t!==e&&fe()}(t?.nativeJwe),this.state=p({},cn,{includeAdvertising:r,isHybrid:Qn(t),pageViewId:L(),providerId:e,trackerId:L(),deployStage:"pro",vendors:["xandr"],collectorBaseUrl:t?.fallbackCollectorBaseUrl,cisBaseUrl:t?.fallbackCisBaseUrl},t),this.builders=p({},n,{provider:{id:e},tracker:{version:Be.SDK_VERSION}}),this.bookmark=new Map,this.eventQueue=[],this.retryEventQueue=[],"browser"===this.state.environment&&st&&window.navigator?.sendBeacon){const e=this.state.useBeacon;window.addEventListener("pagehide",(()=>{this.state.useBeacon=!0,this._sendImmediately().then((()=>{}))}),{capture:!0}),window.addEventListener("pageshow",(()=>{this.state.useBeacon=e}))}}track(e,t,n){const r={...this.builders},o=async o=>{const i=this.createEvent(t);return this.evaluateEvent(e,i,r,n).then((async e=>{if(n?.bookmarkKey&&this.bookmark.set(n.bookmarkKey,e),this.state.altEventHandler){return(0,this.state.altEventHandler)(JSON.stringify(e)),Promise.resolve(o)}const t=this._push(e,n).then((()=>{}));return await this.send(),t.then((e=>e))}))};return this.syncRemoteResources(t,r).then(o,o)}createEvent(e){const t=new Date;return p({},e,{"@id":L(),creationDate:t.toISOString(),session:sn(0,t)})}async evaluateEvent(e,t,n=this.builders,r){const o=Yn(e);return this.evaluateEventInputs(e,t,n,r).then((e=>h(o({eventInput:e,sdkConfig:this.state}))))}async evaluateEventInputs(e,t,n=this.builders,r){return Promise.all([h(n),h(t)]).then((t=>{let n=t.reduce(((e,t)=>p(e,t)),{});return n=this.applyEventTypeDefaults(n,e),n=this.applyBookmarkedEvent(n,r?.applyBookmarkKey),n=this.applyConsents(n),n}))}applyEventTypeDefaults(e,t){return p({},(0,Yn(t).defaults)(),e)}applyBookmarkedEvent(e,t){const n=Object.assign({},e);if(t){const e=this.bookmark.get(t)??{},{"@id":r,"@type":o,creationDate:i,...s}=e;return p({},n,s)}return e}async applyConsents(e){return p({},e,await this.evaluateConsents())}async evaluateConsents(){const e=await Promise.resolve(this.state.consents);return{...e&&{consents:e}}}async addConsentPurposes(e){W("addConsentPurposes","Deprecated method: addConsentPurposes");for(const t in e){const n=t;await this.addSingleConsentPurpose(n,e[n])}}async addSingleConsentPurpose(e,t){const n=await Promise.resolve(this.state.consents);W("addSingleConsentPurpose","Deprecated method: addSingleConsentPurpose"),n?.purposes?n.purposes[e]=t:this.state.consents={purposes:{[e]:t}}}async removeConsentPurposes(e){W("removeConsentPurposes","Deprecated method: removeConsentPurposes");for(const t of e)await this.removeSingleConsentPurpose(t)}async removeSingleConsentPurpose(e){W("removeSingleConsentPurpose","Deprecated method: removeSingleConsentPurpose");const t=await Promise.resolve(this.state.consents);delete t?.purposes[e],this.state.consents=t}clearConsentPurposes(){W("clearConsentPurposes","Deprecated method: clearConsentPurposes"),this.replaceConsentPurposes({})}replaceConsentPurposes(e){W("replaceConsentPurposes","Deprecated method: replaceConsentPurposes"),this.state.consents={purposes:e}}async getConsents(){return(await this.evaluateConsents()).consents}setConsents(e){const t=this.state.includeAdvertising,n=Ye(e,this.state.requireAdvertisingOptIn);return this.state.includeAdvertising=n,this.state.consents=e,t!==n&&Me(),{...this.state.consents}}clone({trackerId:t}={}){return new e(this.state.providerId,{...this.state,trackerId:t||L()},{...this.builders})}update(e,t=!1){this.builders=t?p({},this.builders,e):Object.assign({},this.builders,e)}async getUserId(){return(async e=>{const{id:t}=await $(e);return t})(this.builders)}getIncludeAdvertising(){return this.state.includeAdvertising}async getAdId(){return(async(e,t)=>{const{adId:n}=await We({actor:$(e)},e,t);return n})(this.builders,this.state)}async getActor(){return $(this.builders)}async getEnvironmentId(){return(async(e,t)=>{const n=await $(e),{environmentId:r}=await We({actor:n},e,t);return r})(this.builders,this.state)}async getXandrPPID1(){W("getXandrPPID1","Deprecated method: getXandrPPID1");const{xandr:e}=await $e(this.builders,{...this.state});return e?.ppId1}async getXandrPPID2(){W("getXandrPPID2","Deprecated method: getXandrPPID2");const{xandr:e}=await $e(this.builders,{...this.state});return e?.ppId2}async getAdvertisingIdentifiers(e){return e&&W("getAdvertisingIdentifiers-no-vendor","getAdvertisingIdentifiers no longer accepts vendors as input, the vendors given in SDK construtor is used"),$e(this.builders,{...this.state})}getPageViewId(){return this.state.pageViewId}newPageView(){this.state.pageViewId=L()}async _applyRemoteConfigEndpoints(){const{fallbackCisBaseUrl:e,fallbackCollectorBaseUrl:t,environment:n,configurationTag:r,remoteConfigurationUrl:o}=this.state;if("browser"===n){const n=await Jn(r,o);Xn||(this.state.collectorBaseUrl=n?.collector||t),Zn||(this.state.cisBaseUrl=n?.cis||e)}}async syncRemoteResources(e,t){return await this._applyRemoteConfigEndpoints(),We(e,t,{...this.state})}_getCollectorPath(e){const{environment:t}=this.state;let{collectorPath:n,collectorBaseUrl:r}=this.state;if("/"===n.at(0)&&(n=n.slice(1)),"/"!==r?.at(-1)&&(r=`${r}/`),"node"===t)return new URL(n,r).toString();const o=e||this.state.providerId;return"string"==typeof o&&0===o.indexOf("sdrn")?new URL(`${n}/${o}`,r).toString():new URL(`${n}/${qn(o)}`,r).toString()}async _sendImmediately(){if(this.eventQueue.length+this.retryEventQueue.length>0){const e=this.eventQueue.splice(0),t=e.map((e=>e.inputValue)),n=this.retryEventQueue;this.eventQueue=[],this.retryEventQueue=[];const{doTracking:r}=await We({},this.builders,this.state);if(!r)return Promise.resolve([]);const o=await Promise.all(t),i=this._getCollectorPath(this.state.providerId);return await function(e,t,n){const r=Array.isArray(t)?t.reduce(((e,t)=>(e[0].length>=10?e=[[t]].concat(e):e[0].push(t),e)),[[]]):[[t]];if(st&&Wn&&(n.useBeaconWhenAvailable||n.useBeacon))return r.reduce(((t,n)=>t&&window.navigator.sendBeacon(e,JSON.stringify(n))),!0)?Promise.resolve(!0):Promise.reject(!1);const o=r.map((t=>fetch(e,{headers:new Headers({"Content-Type":"application/x-www-form-urlencoded"}),method:"POST",body:JSON.stringify(t)})));return Promise.all(o)}(i,[...o,...n],this.state).then((t=>t.status>=400?(this.retryEventQueue=this.retryEventQueue.concat(o),e.map((e=>e.reject(t))),Promise.reject(o)):(e.map((e=>e.resolve(t))),Promise.resolve(o))),(t=>(this.retryEventQueue=this.retryEventQueue.concat(o),e.map((e=>e.reject(t))),Promise.reject(o))))}return Promise.resolve([])}_push(e,t={}){const n=function(e){let t=un,n=un;return{promise:new Promise(((e,r)=>{t=e,n=r})),resolve:t,reject:n,inputValue:e}}(e);return this.eventQueue.push(n),t.resolveOnQueued&&n.resolve(e),n.promise}getBookmarkedEvent(e){return this.bookmark.get(e)}async send(){if(this.state.useBeacon)try{return await this._sendImmediately()}catch(e){return e}return this.debouncedSend||(this.debouncedSend=g((()=>this._sendImmediately().catch((e=>e))),this.state.eventDebounce)),this.debouncedSend()}trackPageView(e={},t={}){return this.newPageView(),this.track("trackerEvent",{type:"View",...e},{...t,bookmarkKey:er.PAGE_VIEW})}addPageLeaveTracking(e,t,n,r={}){return Sn(this,e,t,n,r),kn}removePageLeaveTracking(){Cn(this)}updatePageLeaveTracking(e,t,n=!1){!function(e,t,n){vn.length>0&&(On(),n&&_n(),An(e,t))}(e,t,n)}resetPageLeaveViewedContent(e,t){jn(),Ln(e,t)}updatePageLeaveViewedContent(e,t){Ln(e,t)}async trackPageLeave(e,t){await Dn(this,e,t)}trackActivePageLeave(e,t){!function(e,t,n){Pn()&&Dn(e,t,n)}(this,e,t)}};var nr=I(Object.freeze({__proto__:null,BookmarkKeys:er,EventBuilders:an,Tracker:tr,default:tr}));!function(e){var t=y&&y.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var o=Object.getOwnPropertyDescriptor(t,n);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),n=y&&y.__exportStar||function(e,n){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(n,r)||t(n,e,r)},r=y&&y.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(e,"__esModule",{value:!0}),e.Tracker=void 0,n(nr,e);const o=r(nr),i={dev:"https://collector.pulse-internal-dev.m10s.io",pre:"https://collector.pulse-internal-pre.m10s.io",pro:"https://dc.m10s.io"},s={dev:"https://cis.pulse-internal-dev.m10s.io",pre:"https://cis.pulse-internal-pre.m10s.io",pro:"https://mcis.schibsted.com"},a={dev:"https://sdkconfig.pulse-internal-dev.m10s.io/js/config.json",pre:"https://sdkconfig.pulse-internal-pre.m10s.io/js/config.json",pro:"https://sdkconfig.pulse.m10s.io/js/config.json"};class c extends o.default{constructor(e,t,n){const r=(null==t?void 0:t.deployStage)||"pro";super(e,Object.assign({remoteConfigurationUrl:a[r],fallbackCisBaseUrl:s[r],fallbackCollectorBaseUrl:i[r],schemaLocation:"schema.schibsted.com"},t),n)}}e.Tracker=c,e.default=c}(P);var rr=w(P);function or(e){var t;(t="_pulse2debug",decodeURIComponent(document.cookie.replace(new RegExp("(?:(?:^|.*;)\\s*".concat(encodeURIComponent(t).replace(/[-.+*]/g,"\\$&"),"\\s*\\=\\s*([^;]*).*$)|^.*$")),"$1"))||!1)&&console.log("pulse4",e)}function ir(e){var t,n,r=new Promise((function(e,r){t=e,n=r}));return r.resolve=t,r.reject=n,r.inputValue=e,r}function sr(e,t){var n=e instanceof Promise?e.inputValue[0]:e[0],r=t instanceof Promise?t.inputValue[0]:t[0];return"provide"===n&&"provide"===r?0:"provide"===n?-1:"provide"===r?1:0}var ar="3.2.0",cr="defaultTracker",ur={},lr={};function dr(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.trackerName,n=void 0===t?cr:t,r=e.providerId,o=e.config,i=e.builders,s=window.__nativeJwe__||window.hermesJwe?{nativeJwe:window.__nativeJwe__||window.hermesJwe}:{},a=window.pulseEventHandler?{altEventHandler:window.pulseEventHandler}:{};return ur[n]=new rr(r,p({},s,a,o),p({tracker:{autoTrackerVersion:ar}},i)),ur[n]}var pr=!1;function fr(){try{window.pulse.q.sort(sr);var e=window.pulse.q;pr&&e.find((function(e){return"provide"===(e instanceof Promise?e.inputValue[0]:e[0])}))&&(pr=!1);for(var a,c=!pr&&e.shift();!pr&&c;){try{c instanceof Promise&&c.inputValue?c=(a=c).inputValue:a=ir(c);var d=t(x=c)||n(x)||s(x)||r(),p=d[0],g=void 0===p?"":p,v=d.slice(1),h=l(g)&&-1===g.indexOf(".");if(u(g))g(ur[cr]),a.resolve(ur[cr]);else if("init"===g){var m=o(v,4),y=m[0],w=m[1],I=m[2],b=m[3];a.resolve(dr({providerId:y,config:w,builders:I,trackerName:b}))}else if("provide"===g){var E=o(v,2),S=E[0],P=E[1];lr[S]=P,a.resolve(),pr=!1}else if(l(g)&&-1!==g.indexOf("require")){var C=h?cr:g.split(".")[0],A=o(v,2),O=A[0],_=A[1],T=void 0===_?{}:_;if(!lr[O])return pr=!0,void window.pulse.q.push(a);var j=lr[O];ur[C][O]=new j(ur[C],T)}else{var N=o(h?[cr,g]:[g.split(".")[0],g.split(".").splice(1).join(".")],2),k=N[0],D=N[1];if(""===D)u(v[0])&&v[0](ur[k]),a.resolve(ur[k]);else if(ur[D])u(v[0])&&v[0](ur[D]),a.resolve(ur[D]);else{var L=D.split("."),R=-1===D.indexOf(".")?k:"".concat(k,".").concat(L.slice(0,-1).join(".")),U=f(ur,R),V=U[L[L.length-1]].apply(U,i(v));u(v[0])&&v[0](V),a.resolve(V)}}}catch(e){or(e),a.reject(e)}c=e.shift()}}catch(e){or(e)}var x}window.pulse=window.pulse||function(){var e=ir.apply(void 0,arguments);return(window.pulse.q=window.pulse.q||[]).push(e),e},window.pulse.q=window.pulse.q||[],window.pulse.q.push=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return Array.prototype.push.apply(this,t),setTimeout(fr,1),this.length},setTimeout(fr,1)}();
//# sourceMappingURL=pulse.min.js.map</script>
</body>
</html>
