<!DOCTYPE html>

<html lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>mx-biz-freeze.66f5e2440e281e6f.html</title>
</head>
<body>
<script>(self.webpackChunkmexcMain=self.webpackChunkmexcMain||[]).push([[46856],{304992:function(t,e,i){"use strict";i.r(e),i.d(e,{addEventListener:function(){return W},canIUse:function(){return m},closePage:function(){return T},copyToClipboard:function(){return O},fetch:function(){return C},getAppInfo:function(){return x},getStatusBarHeight:function(){return F},getUserInfo:function(){return _},hideLoading:function(){return P},isOnLine:function(){return N},login:function(){return w},openPage:function(){return S},removeEventListener:function(){return Y},reportLog:function(){return b},setBackDisable:function(){return R},setCloseButtonVisible:function(){return L},setTitle:function(){return A},setTitleBarVisible:function(){return B},share:function(){return M},showAlert:function(){return I},showDialog:function(){return V},showLoading:function(){return D},showShare:function(){return z},showToast:function(){return k},tel:function(){return E},useAppInfo:function(){return j},useIsOnline:function(){return K},useStatusBarHeight:function(){return X},useUserInfo:function(){return H}});var n=i(424235),o=i(832848),r=i(788183),a=i.n(r),s=i(986122),l=i(901911);function u(t){if("undefined"!==typeof window&&t.event){var e=window.mexcAppJsBridge.events[t.event];e&&e.length&&setTimeout((function(){e.forEach((function(e){return null===e||void 0===e?void 0:e(t.data)}))}))}}function c(t,e){var i,n,o=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if("undefined"===typeof window)return Promise.resolve(null);if(console.log("mxmx---0  window.isMexcApp: ".concat(window.isMexcApp,", window.isAndroid: ").concat(window.isAndroid)),!window.isMexcApp)return Promise.resolve(null);i=o?new Promise((function(t){n=h(t)})):Promise.resolve(null);try{window.isAndroid?window.mexcAppJsBridge.callNative(t,e?JSON.stringify(e):"",n):window.webkit.messageHandlers.mexcAppJsBridge.postMessage(JSON.stringify({method:t,param:e,callbackMethod:n}))}catch(r){console.log("mxmx---0  catch err:".concat(r)),i=Promise.resolve(null)}return i}function h(t){var e="__mexc_native_call_h5_fn".concat(window.mexcAppJsBridge.callbackMethodId++,"__");return window.mexcAppJsBridge[e]=function(i){var n=window.isAndroid?i:JSON.parse(i);window.mexcAppJsBridge[e]=void 0,delete window.mexcAppJsBridge[e],null===t||void 0===t||t(n)},e}function d(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}!function(){var t,e,i,n;"undefined"!==typeof window&&(window.isInited||(console.log("mxmx----inited---",Date.now()),window.isMexcApp=!1,window.isAndroid=!1,window.isInited=!0,(window.top.mexcAppJsBridge||window.mexcAppJsBridge)&&(window!==window.top&&(window.mexcAppJsBridge=window.top.mexcAppJsBridge),window.isMexcApp=!0,window.isAndroid=!0),(null!==(t=window.top.webkit)&&void 0!==t&&null!==(e=t.messageHandlers)&&void 0!==e&&e.mexcAppJsBridge||null!==(i=window.webkit)&&void 0!==i&&null!==(n=i.messageHandlers)&&void 0!==n&&n.mexcAppJsBridge)&&(window.mexcAppJsBridge=window.mexcAppJsBridge||{},window!==window.top&&(window.webkit=window.top.webkit,window.top.mexcAppJsBridge=window.mexcAppJsBridge),window.isMexcApp=!0,window.isAndroid=!1),window.isMexcApp&&(window.mexcAppJsBridge.events=window.mexcAppJsBridge.events||{},window.mexcAppJsBridge.handleEventFromApp=window.mexcAppJsBridge.handleEventFromApp||u,window.mexcAppJsBridge.callbackMethodId=window.mexcAppJsBridge.callbackMethodId||1)))}();var p,v=null,g=null,f={},y=new WeakMap,m=function(){var t=(0,n.Z)(a().mark((function t(e){var i,n;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(i=y.get(e)||e){t.next=3;break}return t.abrupt("return",!1);case 3:if("undefined"===typeof f[i]){t.next=5;break}return t.abrupt("return",f[i]);case 5:return t.next=7,c("caniuse",{method:i},!0);case 7:return n=t.sent,f[i]=0===(null===n||void 0===n?void 0:n.code),t.abrupt("return",f[i]);case 10:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),x=function(){var t=(0,n.Z)(a().mark((function t(){var e,i=arguments;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(!(i.length>0&&void 0!==i[0])||i[0])||!v){t.next=3;break}return t.abrupt("return",v);case 3:return t.next=5,c("getAppInfo",null,!0);case 5:return e=t.sent,v=0===(null===e||void 0===e?void 0:e.code)?null===e||void 0===e?void 0:e.data:null,t.abrupt("return",v);case 8:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),_=function(){var t=(0,n.Z)(a().mark((function t(){var e,i=arguments;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(!(i.length>0&&void 0!==i[0])||i[0])||!g){t.next=3;break}return t.abrupt("return",g);case 3:return t.next=5,c("getUserInfo",null,!0);case 5:return e=t.sent,g=0===(null===e||void 0===e?void 0:e.code)?null===e||void 0===e?void 0:e.data:null,t.abrupt("return",g);case 8:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),w=function(){var t=(0,n.Z)(a().mark((function t(){var e,i=arguments;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(!(i.length>0&&void 0!==i[0])||i[0])||!g){t.next=3;break}return t.abrupt("return",g);case 3:return t.next=5,c("login",null,!0);case 5:return e=t.sent,g=0===(null===e||void 0===e?void 0:e.code)?null===e||void 0===e?void 0:e.data:null,t.abrupt("return",g);case 8:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),b=function(){},C=function(){},S=function(t,e){var i,n=new Promise((function(t){i=h(t)}));return c("openPage",{route:t,callbackMethod:i,closePageStack:e}),n},T=function(){c("closePage",null)},E=function(t){c("tel",{number:t})},I=function(t,e){c("alert",{content:t},!0).then((function(t){0===(null===t||void 0===t?void 0:t.code)&&(null===e||void 0===e||e())}))},D=function(){c("showLoading",null)},P=function(){c("hideLoading",null)},k=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"default",i={default:0,success:1,error:2}[e];c("showToast",{content:t,type:i})},M=function(){c("share",null)},A=function(t){c("setTitle",{title:t})},B=function(t){c("setTitleBarVisible",{visible:t})},L=function(t){c("setCloseButtonVisible",{visible:t})},F=function(){var t=(0,n.Z)(a().mark((function t(){var e,i,n=arguments;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(!(n.length>0&&void 0!==n[0])||n[0])||"number"!==typeof p){t.next=3;break}return t.abrupt("return",p);case 3:return t.next=5,c("getStatusBarHeight",null,!0);case 5:return i=t.sent,p=0===(null===i||void 0===i?void 0:i.code)?null===i||void 0===i||null===(e=i.data)||void 0===e?void 0:e.height:null,t.abrupt("return",p);case 8:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),O=function(t){c("copyToClipboard",{content:t})},R=function(t){c(t?"disableBack":"enableBack",null)},N=function(){var t=(0,n.Z)(a().mark((function t(){return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,m(N);case 2:if(t.sent){t.next=4;break}return t.abrupt("return",!0);case 4:return t.abrupt("return",c("checkNetAvailable",null,!0).then((function(t){return 0===(null===t||void 0===t?void 0:t.code)})));case 5:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),V=function(t){var e=function(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?d(Object(i),!0).forEach((function(e){(0,l.Z)(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):d(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}({title:"Confirm",positiveText:"Ok",negativeText:"Cancel",cancelable:!0},t);return c("alert",e,!0).then((function(t){return Promise.resolve(0===(null===t||void 0===t?void 0:t.code))}))},z=function(t){c("showShare",{img:t})},W=function(t,e){!function(t,e){var i,n;if("undefined"!==typeof window&&window.mexcAppJsBridge){window.mexcAppJsBridge.events=window.mexcAppJsBridge.events||{};var o=window.mexcAppJsBridge.events;o[t]=o[t]||[],null===(i=o[t])||void 0===i||null===(n=i.push)||void 0===n||n.call(i,e)}}(t,e)},Y=function(t,e){!function(t,e){var i,n;if("undefined"!==typeof window&&window.mexcAppJsBridge){var o=null===(i=window.mexcAppJsBridge)||void 0===i||null===(n=i.events)||void 0===n?void 0:n[t];o&&(window.mexcAppJsBridge.events[t]=e?o.filter((function(t){return t!==e})):[])}}(t,e)};y.set(x,"getAppInfo"),y.set(_,"getUserInfo"),y.set(w,"login"),y.set(S,"openPage"),y.set(T,"closePage"),y.set(E,"tel"),y.set(I,"alert"),y.set(D,"showLoading"),y.set(P,"hideLoading"),y.set(k,"showToast"),y.set(M,"share"),y.set(A,"setTitle"),y.set(B,"setTitleBarVisible"),y.set(L,"setCloseButtonVisible"),y.set(F,"getStatusBarHeight"),y.set(O,"copyToClipboard"),y.set(R,"disableBack"),y.set(N,"checkNetAvailable"),y.set(V,"alert"),y.set(V,"showShare");var H=function(){var t=(0,s.useState)(null),e=(0,o.Z)(t,2),i=e[0],r=e[1];return(0,s.useEffect)((function(){(0,n.Z)(a().mark((function t(){var e;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=null,t.next=3,_();case 3:e=t.sent,r(e);case 5:case"end":return t.stop()}}),t)})))()}),[]),i},j=function(){var t=(0,s.useState)(null),e=(0,o.Z)(t,2),i=e[0],r=e[1];return(0,s.useEffect)((function(){(0,n.Z)(a().mark((function t(){var e;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=null,t.next=3,x();case 3:e=t.sent,r(e);case 5:case"end":return t.stop()}}),t)})))()}),[]),i},X=function(){var t=(0,s.useState)(0),e=(0,o.Z)(t,2),i=e[0],r=e[1];return(0,s.useEffect)((function(){(0,n.Z)(a().mark((function t(){var e;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,F();case 2:e=t.sent,r(e);case 4:case"end":return t.stop()}}),t)})))()}),[]),i},K=function(){var t=(0,s.useState)(0),e=(0,o.Z)(t,2),i=e[0],r=e[1];return(0,s.useEffect)((function(){(0,n.Z)(a().mark((function t(){var e;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=null,t.next=3,N();case 3:e=t.sent,r(e);case 5:case"end":return t.stop()}}),t)})))()}),[]),i}},748779:function(t,e,i){var n,o,r;!function(){function a(a,s){var l;l=function(t){"use strict";var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])},e(t,i)};function n(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+i+" is not a constructor or null");function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}var o=function(){return o=Object.assign||function(t){for(var e,i=1,n=arguments.length;n>i;i++)for(var o in e=arguments[i])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t},o.apply(this,arguments)};function r(t,e,i,n){return new(i||(i=Promise))((function(o,r){function a(t){try{l(n.next(t))}catch(t){r(t)}}function s(t){try{l(n.throw(t))}catch(t){r(t)}}function l(t){var e;t.done?o(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(a,s)}l((n=n.apply(t,e||[])).next())}))}function s(t,e){var i,n,o,r,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(s){return function(l){return function(s){if(i)throw new TypeError("Generator is already executing.");for(;r&&(r=0,s[0]&&(a=0)),a;)try{if(i=1,n&&(o=2&s[0]?n.return:s[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,s[1])).done)return o;switch(n=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,n=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!((o=(o=a.trys).length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&o[3]>s[1])){a.label=s[1];break}if(6===s[0]&&o[1]>a.label){a.label=o[1],o=s;break}if(o&&o[2]>a.label){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=e.call(t,a)}catch(t){s=[6,t],n=0}finally{i=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,l])}}}function l(t){var e="function"==typeof Symbol&&Symbol.iterator,i=e&&t[e],n=0;if(i)return i.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function u(t,e){var i="function"==typeof Symbol&&t[Symbol.iterator];if(!i)return t;var n,o,r=i.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(n=r.next()).done;)a.push(n.value)}catch(t){o={error:t}}finally{try{n&&!n.done&&(i=r.return)&&i.call(r)}finally{if(o)throw o.error}}return a}function c(t,e,i){if(i||2===arguments.length)for(var n,o=0,r=e.length;r>o;o++)!n&&o in e||(n||(n=Array.prototype.slice.call(e,0,o)),n[o]=e[o]);return t.concat(n||Array.prototype.slice.call(e))}var h=void 0!==a?a:"undefined"!=typeof window?window:"undefined"!=typeof i.g?i.g:"undefined"!=typeof self?self:{},d={};!function(t){!function(e){var i,n=1e6,o="[big.js] ",r=o+"Invalid ",a=r+"decimal places",s=o+"Division by zero",l={},u=void 0,c=/^-?(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i;function h(t,e,i,n){var o=t.c;if(i===u&&(i=t.constructor.RM),0!==i&&1!==i&&2!==i&&3!==i)throw Error("[big.js] Invalid rounding mode");if(1>e)n=3===i&&(n||!!o[0])||0===e&&(1===i&&o[0]>=5||2===i&&(o[0]>5||5===o[0]&&(n||o[1]!==u))),o.length=1,n?(t.e=t.e-e+1,o[0]=1):o[0]=t.e=0;else if(o.length>e){if(n=1===i&&o[e]>=5||2===i&&(o[e]>5||5===o[e]&&(n||o[e+1]!==u||1&o[e-1]))||3===i&&(n||!!o[0]),o.length=e,n)for(;++o[--e]>9;)if(o[e]=0,0===e){++t.e,o.unshift(1);break}for(e=o.length;!o[--e];)o.pop()}return t}function d(t,e,i){var n=t.e,o=t.c.join(""),r=o.length;if(e)o=o.charAt(0)+(r>1?"."+o.slice(1):"")+(0>n?"e":"e+")+n;else if(0>n){for(;++n;)o="0"+o;o="0."+o}else if(n>0)if(++n>r)for(n-=r;n--;)o+="0";else r>n&&(o=o.slice(0,n)+"."+o.slice(n));else r>1&&(o=o.charAt(0)+"."+o.slice(1));return 0>t.s&&i?"-"+o:o}l.abs=function(){var t=new this.constructor(this);return t.s=1,t},l.cmp=function(t){var e,i=this,n=i.c,o=(t=new i.constructor(t)).c,r=i.s,a=t.s,s=i.e,l=t.e;if(!n[0]||!o[0])return n[0]?r:o[0]?-a:0;if(r!=a)return r;if(e=0>r,s!=l)return s>l^e?1:-1;for(a=(s=n.length)<(l=o.length)?s:l,r=-1;++r<a;)if(n[r]!=o[r])return n[r]>o[r]^e?1:-1;return s==l?0:s>l^e?1:-1},l.div=function(t){var e=this,i=e.constructor,o=e.c,r=(t=new i(t)).c,l=e.s==t.s?1:-1,c=i.DP;if(c!==~~c||0>c||c>n)throw Error(a);if(!r[0])throw Error(s);if(!o[0])return t.s=l,t.c=[t.e=0],t;var d,p,v,g,f,y=r.slice(),m=d=r.length,x=o.length,_=o.slice(0,d),w=_.length,b=t,C=b.c=[],S=0,T=c+(b.e=e.e-t.e)+1;for(b.s=l,l=0>T?0:T,y.unshift(0);w++<d;)_.push(0);do{for(v=0;10>v;v++){if(d!=(w=_.length))g=d>w?1:-1;else for(f=-1,g=0;++f<d;)if(r[f]!=_[f]){g=r[f]>_[f]?1:-1;break}if(g>=0)break;for(p=w==d?r:y;w;){if(_[--w]<p[w]){for(f=w;f&&!_[--f];)_[f]=9;--_[f],_[w]+=10}_[w]-=p[w]}for(;!_[0];)_.shift()}C[S++]=g?v:++v,_[0]&&g?_[w]=o[m]||0:_=[o[m]]}while((m++<x||_[0]!==u)&&l--);return C[0]||1==S||(C.shift(),b.e--,T--),S>T&&h(b,T,i.RM,_[0]!==u),b},l.eq=function(t){return 0===this.cmp(t)},l.gt=function(t){return this.cmp(t)>0},l.gte=function(t){return this.cmp(t)>-1},l.lt=function(t){return 0>this.cmp(t)},l.lte=function(t){return 1>this.cmp(t)},l.minus=l.sub=function(t){var e,i,n,o,r=this,a=r.constructor,s=r.s,l=(t=new a(t)).s;if(s!=l)return t.s=-l,r.plus(t);var u=r.c.slice(),c=r.e,h=t.c,d=t.e;if(!u[0]||!h[0])return h[0]?t.s=-l:u[0]?t=new a(r):t.s=1,t;if(s=c-d){for((o=0>s)?(s=-s,n=u):(d=c,n=h),n.reverse(),l=s;l--;)n.push(0);n.reverse()}else for(i=((o=h.length>u.length)?u:h).length,s=l=0;i>l;l++)if(u[l]!=h[l]){o=h[l]>u[l];break}if(o&&(n=u,u=h,h=n,t.s=-t.s),(l=(i=h.length)-(e=u.length))>0)for(;l--;)u[e++]=0;for(l=e;i>s;){if(u[--i]<h[i]){for(e=i;e&&!u[--e];)u[e]=9;--u[e],u[i]+=10}u[i]-=h[i]}for(;0===u[--l];)u.pop();for(;0===u[0];)u.shift(),--d;return u[0]||(t.s=1,u=[d=0]),t.c=u,t.e=d,t},l.mod=function(t){var e,i=this,n=i.constructor,o=i.s,r=(t=new n(t)).s;if(!t.c[0])throw Error(s);return i.s=t.s=1,e=1==t.cmp(i),i.s=o,t.s=r,e?new n(i):(o=n.DP,r=n.RM,n.DP=n.RM=0,i=i.div(t),n.DP=o,n.RM=r,this.minus(i.times(t)))},l.neg=function(){var t=new this.constructor(this);return t.s=-t.s,t},l.plus=l.add=function(t){var e,i,n,o=this,r=o.constructor;if(t=new r(t),o.s!=t.s)return t.s=-t.s,o.minus(t);var a=o.e,s=o.c,l=t.e,u=t.c;if(!s[0]||!u[0])return u[0]||(s[0]?t=new r(o):t.s=o.s),t;if(s=s.slice(),e=a-l){for(e>0?(l=a,n=u):(e=-e,n=s),n.reverse();e--;)n.push(0);n.reverse()}for(0>s.length-u.length&&(n=u,u=s,s=n),e=u.length,i=0;e;s[e]%=10)i=(s[--e]=s[e]+u[e]+i)/10|0;for(i&&(s.unshift(i),++l),e=s.length;0===s[--e];)s.pop();return t.c=s,t.e=l,t},l.pow=function(t){var e=this,i=new e.constructor("1"),n=i,o=0>t;if(t!==~~t||-1e6>t||t>1e6)throw Error(r+"exponent");for(o&&(t=-t);1&t&&(n=n.times(e)),t>>=1;)e=e.times(e);return o?i.div(n):n},l.prec=function(t,e){if(t!==~~t||1>t||t>n)throw Error(r+"precision");return h(new this.constructor(this),t,e)},l.round=function(t,e){if(t===u)t=0;else if(t!==~~t||-n>t||t>n)throw Error(a);return h(new this.constructor(this),t+this.e+1,e)},l.sqrt=function(){var t,e,i,n=this,r=n.constructor,a=n.s,s=n.e,l=new r("0.5");if(!n.c[0])return new r(n);if(0>a)throw Error(o+"No square root");0===(a=Math.sqrt(n+""))||a===1/0?((e=n.c.join("")).length+s&1||(e+="0"),s=((s+1)/2|0)-(0>s||1&s),t=new r(((a=Math.sqrt(e))==1/0?"5e":(a=a.toExponential()).slice(0,a.indexOf("e")+1))+s)):t=new r(a+""),s=t.e+(r.DP+=4);do{t=l.times((i=t).plus(n.div(i)))}while(i.c.slice(0,s).join("")!==t.c.slice(0,s).join(""));return h(t,(r.DP-=4)+t.e+1,r.RM)},l.times=l.mul=function(t){var e,i=this,n=i.c,o=(t=new(0,i.constructor)(t)).c,r=n.length,a=o.length,s=i.e,l=t.e;if(t.s=i.s==t.s?1:-1,!n[0]||!o[0])return t.c=[t.e=0],t;for(t.e=s+l,a>r&&(e=n,n=o,o=e,l=r,r=a,a=l),e=Array(l=r+a);l--;)e[l]=0;for(s=a;s--;){for(a=0,l=r+s;l>s;)a=e[l]+o[s]*n[l-s-1]+a,e[l--]=a%10,a=a/10|0;e[l]=a}for(a?++t.e:e.shift(),s=e.length;!e[--s];)e.pop();return t.c=e,t},l.toExponential=function(t,e){var i=this,o=i.c[0];if(t!==u){if(t!==~~t||0>t||t>n)throw Error(a);for(i=h(new i.constructor(i),++t,e);t>i.c.length;)i.c.push(0)}return d(i,!0,!!o)},l.toFixed=function(t,e){var i=this,o=i.c[0];if(t!==u){if(t!==~~t||0>t||t>n)throw Error(a);for(t=t+(i=h(new i.constructor(i),t+i.e+1,e)).e+1;t>i.c.length;)i.c.push(0)}return d(i,!1,!!o)},l.toJSON=l.toString=function(){var t=this,e=t.constructor;return d(t,e.NE>=t.e||t.e>=e.PE,!!t.c[0])},l.toNumber=function(){var t=Number(d(this,!0,!0));if(!0===this.constructor.strict&&!this.eq(""+t))throw Error(o+"Imprecise conversion");return t},l.toPrecision=function(t,e){var i=this,o=i.constructor,a=i.c[0];if(t!==u){if(t!==~~t||1>t||t>n)throw Error(r+"precision");for(i=h(new o(i),t,e);t>i.c.length;)i.c.push(0)}return d(i,i.e>=t||o.NE>=i.e||i.e>=o.PE,!!a)},l.valueOf=function(){var t=this,e=t.constructor;if(!0===e.strict)throw Error(o+"valueOf disallowed");return d(t,e.NE>=t.e||t.e>=e.PE,!0)},i=function t(){function e(i){var n=this;if(!(n instanceof e))return i===u?t():new e(i);if(i instanceof e)n.s=i.s,n.e=i.e,n.c=i.c.slice();else{if("string"!=typeof i){if(!0===e.strict&&"bigint"!=typeof i)throw TypeError(r+"value");i=0===i&&0>1/i?"-0":i+""}!function(t,e){var i,n,o;if(!c.test(e))throw Error(r+"number");for(t.s="-"==e.charAt(0)?(e=e.slice(1),-1):1,(i=e.indexOf("."))>-1&&(e=e.replace(".","")),(n=e.search(/e/i))>0?(0>i&&(i=n),i+=+e.slice(n+1),e=e.substring(0,n)):0>i&&(i=e.length),o=e.length,n=0;o>n&&"0"==e.charAt(n);)++n;if(n==o)t.c=[t.e=0];else{for(;o>0&&"0"==e.charAt(--o););for(t.e=i-n-1,t.c=[],i=0;o>=n;)t.c[i++]=+e.charAt(n++)}}(n,i)}n.constructor=e}return e.prototype=l,e.DP=20,e.RM=1,e.NE=-7,e.PE=21,e.strict=!1,e.roundDown=0,e.roundHalfUp=1,e.roundHalfEven=2,e.roundUp=3,e}(),i.default=i.Big=i,t.exports?t.exports=i:e.Big=i}(h)}({get exports(){return d},set exports(t){d=t}});var p=d;d.Big.DP=40,d.Big.NE=-40,d.Big.PE=40;var v=function(t,e,i,n,o,r){void 0===r&&(r=!1);var a="",s="";try{a=""+t,s=""+e}catch(t){return o(a,s)}if(r||a.indexOf("e")>0||s.indexOf("e")>0)try{return i(a,s)}catch(t){return o(a,s)}try{return n(a,s)}catch(t){}try{return i(a,s)}catch(t){return o(a,s)}};function g(t,e,i){void 0===i&&(i=!1);var n=""+t;if(e>0){var o=0===n.indexOf("-"),r="."+(n=n.slice(o?1:0).padStart(e+1,"0")).slice(-e);if(i){var a=r.replace(/0+$/,"");r="."===a?"":a}return(o?"-":"")+(n.slice(0,-e)+r)}return n}var f=function(t,e,i){window.calcCommon=f;var n=u(e.split("."),2),o=n[0],r=n[1],a=void 0===r?"":r,s=u(i.split("."),2),l=s[0],c=s[1],h=void 0===c?"":c,d=Math.max(a.length,h.length),p=BigInt(o+a.padEnd(d,"0")),v=BigInt(l+h.padEnd(d,"0")),y=null;switch(t){case"+":y=p+v;break;case"-":y=p-v;break;default:y=""}return g(y,d)};p.DP=40,p.NE=-40,p.PE=40;var y=!1;function m(t,e,i){var n=0,o=0;for(o=t.length-1;n!==o;){var r=Math.floor((o+n)/2),a=o-n,s=t[r][e];if(i===t[n][e])return n;if(i===t[o][e])return o;if(i===s)return r;if(i>s?n=r:o=r,2>=a)break}return n}function x(t,e,i){return void 0===i&&(i=!1),null==e&&(e=10),+(i?z:W)(t,e=Math.min(Math.max(0,e),20))}function _(t,e,i){var n=[Number.MIN_SAFE_INTEGER,Number.MAX_SAFE_INTEGER];return t.forEach((function(t){var o,r;n[0]=K(null!==(o=t[e])&&void 0!==o?o:t,n[0]),n[1]=X(null!==(r=t[i])&&void 0!==r?r:t,n[1])})),n}function w(t){return y?0===t||"0"===t?-1/0:M(Math.log(Number(t)),Math.log(10)):Math.log(Number(t))/Math.log(10)}function b(t){return y?t===-1/0?0:V(10,t):Math.pow(10,t)}function C(t){return!("number"!=typeof t&&"string"!=typeof t||""===t||!isFinite(Number(t))||0>Math.abs(Number(t)))}var S,T=new Map,E=new Map,I=new Map,D=new Map,P=new Map;function k(t,e){return function(t,e,i,n,o){return void 0===n&&(n=d.Big.DP),v(t,e,(function(){return""+new d.Big(t).div(new d.Big(e))}),(function(t,e){var i=u(t.split("."),2),o=i[0],r=i[1],a=u(e.split("."),2),s=a[0],l=a[1],c=(null==l?void 0:l.length)||0,h=((null==r?void 0:r.length)||0)-c-n,d=h>0?h:0;return g(BigInt(o+(r||"").padEnd(c+d+n,"0"))/BigInt(s+(l||"")),n+d)}),(function(t,e){return Number(t)/Number(e)}),o)}(t,e)}function M(t,e,i){if(void 0===i&&(i=!1),!y&&!i)return Number(t)/Number(e);if(0===t||"0"===t||0===e||"0"===e)return Number(t)/Number(e);var n="".concat(t,"||").concat(e);if(15>n.length)return k(t,e);var o=T.get(n);if(void 0!==o)return o;var r=k(t,e);return T.set(n,r),r}function A(t,e){return function(t,e,i,n){return v(t,e,(function(){return""+new d.Big(t).minus(new d.Big(e))}),(function(t,e){return f("-",t,e)}),(function(t,e){return Number(t)-Number(e)}),n)}(t,e)}function B(t,e){if(!y)return Number(t)-Number(e);var i="".concat(t,"||").concat(e);if(15>i.length)return A(t,e);var n=E.get(i);if(void 0!==n)return n;var o=A(t,e);return E.set(i,o),o}function L(t,e){return function(t,e,i,n){return v(t,e,(function(){return""+new d.Big(t).times(new d.Big(e))}),(function(t,e){var i=u(t.split("."),2),n=i[0],o=i[1],r=u(e.split("."),2),a=r[0],s=r[1],l=(null==o?void 0:o.length)||0,c=(null==s?void 0:s.length)||0;return g(BigInt(n+(o||""))*BigInt(a+(s||"")),l+c,!0)}),(function(t,e){return Number(t)*Number(e)}),n)}(t,e)}function F(t,e,i){if(void 0===i&&(i=!1),!y&&!i)return Number(t)*Number(e);var n="".concat(t,"||").concat(e);if(15>n.length)return L(t,e);var o=I.get(n);if(void 0!==o)return o;var r=L(t,e);return I.set(n,r),r}function O(t,e){return function(t,e,i,n){return v(t,e,(function(){return""+new d.Big(t).plus(new d.Big(e))}),(function(t,e){return f("+",t,e)}),(function(t,e){return Number(t)+Number(e)}),n)}(t,e)}function R(t,e,i){if(void 0===i&&(i=!1),!y&&!i)return Number(t)+Number(e);var n="".concat(t,"||").concat(e);if(15>n.length)return O(t,e);var o=D.get(n);if(void 0!==o)return o;var r=O(t,e);return D.set(n,r),r}function N(t,e){return void 0===e&&(e=NaN),y?""===t?0:C(t)?""+p(t).abs():e:Math.abs(Number(t))}function V(t,e,i){if(void 0===i&&(i=NaN),!y)return Math.pow(Number(t),e);try{return""===t?0:C(t)?""+p(t).pow(e):i}catch(t){return i}}function z(t,e,i,n){return void 0===n&&(n=NaN),"string"==typeof t&&(t=t.trim()),C(t)?p(t).toFixed(e,i):n}function W(t,e,i,n){return void 0===n&&(n=NaN),y?z(t,e,i,n):Number(t).toFixed(e)}function Y(t,e,i){return void 0===i&&(i=!1),(y||i)&&C(t)&&C(e)?p(t).gt(p(e)):Number(t)>Number(e)}function H(t,e,i){if(void 0===i&&(i=!1),!y&&!i)return Number(t)===Number(e);if(t===e)return!0;if(t=(""+t).trim(),e=(""+e).trim(),t.indexOf("e")>0||e.indexOf("e")>0)return p(t).eq(p(e));var n="+",o="+";(t.includes("-")||t.includes("+"))&&(n=t.slice(0,1),t=t.slice(1)),(e.includes("-")||e.includes("+"))&&(o=e.slice(0,1),e=e.slice(1));var r=u(t.split("."),2),a=r[0],s=r[1],l=void 0===s?"":s,c=u(e.split("."),2),h=c[0],d=c[1],v=void 0===d?"":d;return n===o&&a.padStart(h.length,"0")===h.padStart(a.length,"0")&&l.padEnd(v.length,"0")===v.padEnd(l.length,"0")}function j(t,e){return y&&C(t)&&C(e)?p(t).lt(p(e)):Number(e)>Number(t)}function X(t,e){if(!y)return Math.min(Number(t),Number(e));var i=t,n=e;return""===t&&(i=0),""===e&&(n=0),j(i,n)?i:n}function K(t,e){if(!y)return Math.max(Number(t),Number(e));var i=t,n=e;return""===t&&(i=0),""===e&&(n=0),Y(i,n)?i:n}function q(){T.clear(),E.clear(),I.clear(),D.clear(),P.clear()}function U(){Z(),S=setInterval((function(){var t=E.size,e=I.size,i=D.size,n=P.size;T.size>1e5&&T.clear(),t>1e5&&E.clear(),e>1e5&&I.clear(),i>1e5&&D.clear(),n>1e5&&P.clear()}),6e4)}function Z(){S&&clearInterval(S)}function G(t,e){if(tt(t)||tt(e))for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){var n=t[i],o=e[i];tt(o)&&tt(n)&&!$(o)&&!$(n)?G(n,o):it(e[i])&&(t[i]=e[i])}}function J(t){if(!tt(t)||!$(t))return t;var e;for(var i in e=$(t)?[]:{},t)if(Object.prototype.hasOwnProperty.call(t,i)){var n=t[i];e[i]=tt(n)?J(n):n}return e}function $(t){return"[object Array]"===Object.prototype.toString.call(t)}function Q(t){return"function"==typeof t}function tt(t){return"object"==typeof t}function et(t){return"number"==typeof t&&!isNaN(t)}function it(t){return null!=t}function nt(t){return"boolean"==typeof t}function ot(t){return"string"==typeof t}U();var rt=/\\(\\)?/g,at=RegExp("[^.[\\]]+|\\[(?:([^\"'][^[]*)|([\"'])((?:(?!\\2)[^\\\\]|\\\\.)*?)\\2)\\]|(?=(?:\\.|\\[\\])(?:\\.|\\[\\]|$))","g");function st(t,e,i){if(it(t)){var n=[];e.replace(at,(function(t){for(var e=[],i=1;arguments.length>i;i++)e[i-1]=arguments[i];var o=t;return it(e[1])?o=e[2].replace(rt,"$1"):it(e[0])&&(o=e[0].trim()),n.push(o),""}));for(var o=t,r=0,a=n.length;it(o)&&a>r;)o=null==o?void 0:o[n[r++]];return it(o)?o:null!=i?i:"--"}return null!=i?i:"--"}function lt(t,e,i){var n=new Date(e),o={YYYY:""+n.getFullYear(),YY:(""+n.getFullYear()).slice(-2),MM:Et(""+(n.getMonth()+1),2,"0"),DD:Et(""+n.getDate(),2,"0"),HH:Et(""+n.getHours(),2,"0"),mm:Et(""+n.getMinutes(),2,"0"),ss:Et(""+n.getSeconds(),2,"0")};return i.replace(/YYYY|YY|MM|DD|HH|mm|ss/g,(function(t){return o[t]}))}function ut(t,e){var i=+t;return et(i)?W(t,null!=e?e:2):"".concat(i)}function ct(t,e){return void 0===e&&(e=wt),et(+t)?Y(t,1e12)?"".concat(e(Number(W(M(t,1e12),3))),"T"):Y(t,1e9)?"".concat(e(Number(W(M(t,1e9),3))),"B"):Y(t,1e6)?"".concat(e(Number(W(M(t,1e6),3))),"M"):Y(t,1e3)?"".concat(e(Number(W(M(t,1e3),3))),"K"):"".concat(e(t)):"--"}var ht,dt,pt,vt,gt,ft,yt,mt,xt,_t=function(t){var e=(""+t).split(".");return e[0]=e[0].replace(/\B(?=(\d{3})+(?!\d))/g,","),e.join(".")},wt=_t,bt=function(t){return"".concat(t,"%")},Ct=bt,St=function(t,e,i){void 0===e&&(e=4),void 0===i&&(i=!1);var n=W(t,e,void 0,t);return i&&isFinite(+n)?(n+"").replace(/\.?0+$/,""):n};function Tt(t,e,i){return void 0===i&&(i=wt),i(ut(t,e))}function Et(t,e,i){if(void 0===i&&(i=" "),t.length>=(e=Math.floor(e)||0))return t;i+="";for(var n="";e>n.length+t.length;)n+=i;return n.slice(0,e-t.length)+t}t.LineType=void 0,(ht=t.LineType||(t.LineType={})).Dashed="dashed",ht.Solid="solid",t.PolygonType=void 0,(dt=t.PolygonType||(t.PolygonType={})).Stroke="stroke",dt.Fill="fill",dt.StrokeFill="stroke_fill",t.TooltipShowRule=void 0,(pt=t.TooltipShowRule||(t.TooltipShowRule={})).Always="always",pt.FollowCross="follow_cross",pt.None="none",t.TooltipShowType=void 0,(vt=t.TooltipShowType||(t.TooltipShowType={})).Standard="standard",vt.Rect="rect",t.TooltipIconPosition=void 0,(gt=t.TooltipIconPosition||(t.TooltipIconPosition={})).Left="left",gt.Middle="middle",gt.Right="right",t.CandleType=void 0,(ft=t.CandleType||(t.CandleType={})).CandleSolid="candle_solid",ft.CandleStroke="candle_stroke",ft.CandleUpStroke="candle_up_stroke",ft.CandleDownStroke="candle_down_stroke",ft.Ohlc="ohlc",ft.Area="area",t.YAxisPosition=void 0,(yt=t.YAxisPosition||(t.YAxisPosition={})).Left="left",yt.Right="right",t.YAxisType=void 0,(mt=t.YAxisType||(t.YAxisType={})).Normal="normal",mt.Percentage="percentage",mt.Log="log",t.FormatDateType=void 0,(xt=t.FormatDateType||(t.FormatDateType={}))[xt.Tooltip=0]="Tooltip",xt[xt.Crosshair=1]="Crosshair",xt[xt.XAxis=2]="XAxis";var It;function Dt(t){var e={width:0,height:0,left:0,right:0,top:0,bottom:0};return void 0!==t&&G(e,t),e}t.ActionType=void 0,(It=t.ActionType||(t.ActionType={})).OnZoom="onZoom",It.OnScroll="onScroll",It.OnVisibleRangeChange="onVisibleRangeChange",It.OnTooltipIconClick="onTooltipIconClick",It.OnCrosshairChange="onCrosshairChange",It.OnCandleBarClick="onCandleBarClick",It.OnPaneDrag="onPaneDrag",It.OnShowMenuChange="onShowMenuChange",It.OnBarLengthChange="onBarLengthChange",It.OnScrollToTimestamp="onScrollToTimestamp",It.OnScrollYAxis="onScrollYAxis";var Pt,kt=function(){function t(){this._callbacks=[]}return t.prototype.subscribe=function(t){var e;0>(null!==(e=this._callbacks.indexOf(t))&&void 0!==e?e:-1)&&this._callbacks.push(t)},t.prototype.unsubscribe=function(t){var e;if(void 0!==t){var i=null!==(e=this._callbacks.indexOf(t))&&void 0!==e?e:-1;i>-1&&this._callbacks.splice(i,1)}else this._callbacks=[]},t.prototype.execute=function(t){this._callbacks.forEach((function(e){e(t)}))},t.prototype.isEmpty=function(){return 0===this._callbacks.length},t}(),Mt=new(function(){function t(){this._baseId=1}return t.prototype.next=function(t){var e=(new Date).getTime();return e===this._prevIdTimestamp?++this._baseId:this._baseId=1,this._prevIdTimestamp=e,"".concat(null!=t?t:"").concat(e,"_").concat(this._baseId)},t}());function At(t){return Mt.next(t)}function Bt(t,e){var i,n=document.createElement(t),o=null!=e?e:{};for(var r in o)n.style[r]=null!==(i=o[r])&&void 0!==i?i:"";return n}function Lt(t){var e,i,n;return null!==(n=null===(i=null===(e=t.ownerDocument)||void 0===e?void 0:e.defaultView)||void 0===i?void 0:i.devicePixelRatio)&&void 0!==n?n:2}function Ft(t,e,i){return"".concat(null!=e?e:"normal"," ").concat(null!=t?t:12,"px ").concat(null!=i?i:"Helvetica Neue")}function Ot(t,e,i,n){if(void 0===Pt){var o=document.createElement("canvas"),r=Lt(o);(Pt=o.getContext("2d")).scale(r,r)}return Pt.font=Ft(e,i,n),Math.round(Pt.measureText(t).width)}function Rt(t,e,i){var n=[0,1,2,3,4,5,6,7,8,9].map((function(n){return Ot(n+"",t,e,i)}));return n.indexOf(Math.max.apply(Math,c([],u(n),!1)))}var Nt,Vt=function(){function e(t){this._dateTimeFormat=this._buildDateTimeFormat(),this._zoomEnabled=!0,this._scrollEnabled=!0,this._loading=!0,this._loadMoreCallback=null,this._more=!0,this._totalBarSpace=0,this._barSpace=6,this._offsetRightDistance=50,this._startScrollOffsetRightBarCount=0,this._minVisibleBarCount={left:2,right:2},this._visibleRange={from:0,to:0,realFrom:0,realTo:0},this._chartStore=t,this._gapBarSpace=this._calcGapBarSpace(),this._offsetRightBarCount=this._offsetRightDistance/this._barSpace}return e.prototype._calcGapBarSpace=function(){return Math.max(1,Math.min(Math.floor(.82*this._barSpace),Math.floor(this._barSpace)-1))},e.prototype.adjustVisibleRange=function(){var e,i=this._chartStore.getDataList(),n=i.length,o=this._totalBarSpace/this._barSpace,r=o-Math.min(this._minVisibleBarCount.left,n);this._offsetRightBarCount>r&&(this._offsetRightBarCount=r);var a=-n+Math.min(this._minVisibleBarCount.right,n);a>this._offsetRightBarCount&&(this._offsetRightBarCount=a);var s=Math.round(this._offsetRightBarCount+n+.5),l=s;s>n&&(s=n);var u=Math.round(s-(o-(this._offsetRightBarCount>0?this._offsetRightBarCount:0)))-1,c=u;if(0>u&&(u=0),this._visibleRange={from:u,to:s,realFrom:c,realTo:l},this._chartStore.getActionStore().execute(t.ActionType.OnVisibleRangeChange,this._visibleRange),this._chartStore.adjustVisibleDataList(),0===u&&this.getMore()&&!this.getLoading()&&null!==this._loadMoreCallback){this.setLoading(!0);var h=i[0];this._loadMoreCallback(null!==(e=null==h?void 0:h.timestamp)&&void 0!==e?e:null).catch((function(){}))}},e.prototype.setMore=function(t){return this._more=t,this},e.prototype.getMore=function(){return this._more},e.prototype.setLoading=function(t){return this._loading=t,this},e.prototype.getLoading=function(){return this._loading},e.prototype.getDateTimeFormat=function(){return this._dateTimeFormat},e.prototype._buildDateTimeFormat=function(t){var e={hour12:!1,year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"};void 0!==t&&(e.timeZone=t);var i=null;try{i=new Intl.DateTimeFormat("en",e)}catch(t){}return i},e.prototype.setTimezone=function(t){var e=this._buildDateTimeFormat(t);null!==e&&(this._dateTimeFormat=e)},e.prototype.getTimezone=function(){return this._dateTimeFormat.resolvedOptions().timeZone},e.prototype.getBarSpace=function(){return{bar:this._barSpace,halfBar:this._barSpace/2,gapBar:this._gapBarSpace,halfGapBar:this._gapBarSpace/2}},e.prototype.setBarSpace=function(t,e){1>t||t>50||this._barSpace===t||(this._barSpace=t,this._gapBarSpace=this._calcGapBarSpace(),null==e||e(),this.adjustVisibleRange(),this._chartStore.getCrosshairStore().recalculate(!0),this._chartStore.getChart().adjustPaneViewport(!1,!0,!0,!0))},e.prototype.setTotalBarSpace=function(t){return this._totalBarSpace!==t&&(this._totalBarSpace=t,this.adjustVisibleRange(),this._chartStore.getCrosshairStore().recalculate(!0)),this},e.prototype.setOffsetRightDistance=function(t,e){return this._offsetRightDistance=t,this._offsetRightBarCount=t/this._barSpace,null!=e&&e&&(this.adjustVisibleRange(),this._chartStore.getCrosshairStore().recalculate(!0),this._chartStore.getChart().adjustPaneViewport(!1,!0,!0,!0)),this},e.prototype.resetOffsetRightDistance=function(){this.setOffsetRightDistance(this._offsetRightDistance)},e.prototype.getOffsetRightDistance=function(){return this._offsetRightDistance},e.prototype.getOffsetRightBarCount=function(){return this._offsetRightBarCount},e.prototype.setOffsetRightBarCount=function(t){return this._offsetRightBarCount=t,this},e.prototype.setLeftMinVisibleBarCount=function(t){return this._minVisibleBarCount.left=t,this},e.prototype.setRightMinVisibleBarCount=function(t){return this._minVisibleBarCount.right=t,this},e.prototype.getVisibleRange=function(){return this._visibleRange},e.prototype.startScroll=function(){this._startScrollOffsetRightBarCount=this._offsetRightBarCount},e.prototype.scroll=function(e){if(this._scrollEnabled){var i=e/this._barSpace;this._chartStore.getActionStore().execute(t.ActionType.OnScroll),this._offsetRightBarCount=this._startScrollOffsetRightBarCount-i,this.adjustVisibleRange(),this._chartStore.getCrosshairStore().recalculate(!0),this._chartStore.getChart().adjustPaneViewport(!1,!0,!0,!0)}},e.prototype.getDataByDataIndex=function(t){var e;return null!==(e=this._chartStore.getDataList()[t])&&void 0!==e?e:null},e.prototype.coordinateToFloatIndex=function(t){var e=this._chartStore.getDataList().length;return Math.round(1e6*(e+this._offsetRightBarCount-(this._totalBarSpace-t)/this._barSpace))/1e6},e.prototype.dataIndexToTimestamp=function(t){var e,i=this.getDataByDataIndex(t);return null!==(e=null==i?void 0:i.timestamp)&&void 0!==e?e:null},e.prototype.timestampToDataIndex=function(t){var e=this._chartStore.getDataList();if(0===e.length)return 0;var i=m(e,"timestamp",t);return t>e[e.length-1].timestamp&&(i=e.length-1),i},e.prototype.dataIndexToCoordinate=function(t){var e=this._chartStore.getDataList().length;return this._totalBarSpace-(e+this._offsetRightBarCount-t-.5)*this._barSpace},e.prototype.coordinateToDataIndex=function(t){return Math.ceil(this.coordinateToFloatIndex(t))-1},e.prototype.zoom=function(e,i){var n,o=this;if(this._zoomEnabled){if(void 0===(null==i?void 0:i.x)){var r=this._chartStore.getCrosshairStore().get();i={x:null!==(n=null==r?void 0:r.x)&&void 0!==n?n:this._totalBarSpace/2}}this._chartStore.getActionStore().execute(t.ActionType.OnZoom);var a=this.coordinateToFloatIndex(i.x);this.setBarSpace(this._barSpace+e*(this._barSpace/10),(function(){o._offsetRightBarCount+=a-o.coordinateToFloatIndex(null==i?void 0:i.x)}))}},e.prototype.setZoomEnabled=function(t){return this._zoomEnabled=t,this},e.prototype.getZoomEnabled=function(){return this._zoomEnabled},e.prototype.setScrollEnabled=function(t){return this._scrollEnabled=t,this},e.prototype.getScrollEnabled=function(){return this._scrollEnabled},e.prototype.setLoadMoreCallback=function(t){return this._loadMoreCallback=t,this},e.prototype.getLoadMoreCallback=function(){return this._loadMoreCallback},e.prototype.clear=function(){this.setMore(!0),this.setLoading(!0),this._visibleRange={from:0,to:0,realFrom:0,realTo:0}},e}();function zt(t,e,i,n,r,a){void 0===a&&(a=!1);var s,l=e.result,u=e.figures,c=e.styles,h=e.hideFigures,d=st(c,"circles",n.circles),p=d.length,v=st(c,"bars",n.bars),g=v.length,f=st(c,"lines",n.lines),y=f.length,m=st(c,"polygon",n.polygons),x=m.length,_=0,w=0,b=0,C=0,S=0;u.forEach((function(u){var c;switch(u.type){case"circle":S=_;var T=d[_%p];s=o(o({},T),{color:T.noChangeColor}),_++;break;case"bar":S=w;var E=v[w%g];s=o(o({},E),{color:E.noChangeColor}),w++;break;case"line":S=b,s=f[b%y],b++;break;case"polygon":S=C,s=m[C%x],C++}if(it(s)&&!(null==h?void 0:h.includes(u.key))){var I=i;a&&(0>(I=l.findIndex((function(t){return t.dataIndex===i})))&&(I=0),I>l.length-1&&(I=l.length-1));var D=null===(c=u.styles)||void 0===c?void 0:c.call(u,{prev:{kLineData:t[i-1],indicatorData:l[I-1]},current:{kLineData:t[i],indicatorData:l[I]},next:{kLineData:t[i+1],indicatorData:l[I+1]}},e,n);r(u,o(o({},s),D),S)}}))}t.IndicatorSeries=void 0,(Nt=t.IndicatorSeries||(t.IndicatorSeries={})).Normal="normal",Nt.Price="price",Nt.Volume="volume";var Wt=function(){function e(e){var i;this.result=[],this._precisionFlag=!1;var n=e.name,o=e.shortName,r=e.series,a=e.calcParams,s=e.figures,l=e.precision,u=e.shouldOhlc,c=e.shouldFormatBigNumber,h=e.visible,d=e.minValue,p=e.maxValue,v=e.styles,g=e.extendData,f=e.regenerateFigures,y=e.createTooltipDataSource,m=e.draw,x=e.hideFigures;this.name=n,this.shortName=null!=o?o:n,this.series=null!=r?r:t.IndicatorSeries.Normal,this.precision=null!=l?l:4,this.calcParams=null!=a?a:[],this.figures=null!=s?s:[],this.shouldOhlc=null!=u&&u,this.shouldFormatBigNumber=null!=c&&c,this.visible=null==h||h,this.minValue=null!=d?d:null,this.maxValue=null!=p?p:null,this.styles=null!=v?v:null,this.extendData=g,this.regenerateFigures=null!=f?f:null,this.createTooltipDataSource=null!=y?y:null,this.draw=null!=m?m:null,this.hideFigures=null!=x?x:[];var _=null===(i=e.initCache)||void 0===i?void 0:i.call(e);void 0!==_&&(this.cache=_)}return e.prototype.setShortName=function(t){return this.shortName!==t&&(this.shortName=t,!0)},e.prototype.setSeries=function(t){return this.series!==t&&(this.series=t,!0)},e.prototype.setPrecision=function(t,e){var i=null!=e&&e,n=Math.floor(t);return!(n===this.precision||0>t||i&&(!i||this._precisionFlag)||(this.precision=n,i||(this._precisionFlag=!0),0))},e.prototype.setCalcParams=function(t){var e,i;return this.calcParams=t,this.figures=null!==(i=null===(e=this.regenerateFigures)||void 0===e?void 0:e.call(this,t))&&void 0!==i?i:this.figures,!0},e.prototype.setShouldOhlc=function(t){return this.shouldOhlc!==t&&(this.shouldOhlc=t,!0)},e.prototype.setShouldFormatBigNumber=function(t){return this.shouldFormatBigNumber!==t&&(this.shouldFormatBigNumber=t,!0)},e.prototype.setVisible=function(t){return this.visible!==t&&(this.visible=t,!0)},e.prototype.setStyles=function(t){return this.styles!==t&&(this.styles=t,!0)},e.prototype.setExtendData=function(t){return this.extendData!==t&&(this.extendData=t,!0)},e.prototype.setFigures=function(t){return this.figures!==t&&(this.figures=t,!0)},e.prototype.setMinValue=function(t){return this.minValue!==t&&(this.minValue=t,!0)},e.prototype.setMaxValue=function(t){return this.maxValue!==t&&(this.maxValue=t,!0)},e.prototype.setRegenerateFigures=function(t){return this.regenerateFigures!==t&&(this.regenerateFigures=t,!0)},e.prototype.setCreateTooltipDataSource=function(t){return this.createTooltipDataSource!==t&&(this.createTooltipDataSource=t,!0)},e.prototype.setDraw=function(t){return this.draw!==t&&(this.draw=t,!0)},e.prototype.setHideFigures=function(t){return this.hideFigures=t,!0},e.prototype.calcIndicator=function(t){return r(this,void 0,void 0,(function(){var e;return s(this,(function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),[4,this.calc(t,this)];case 1:return e=i.sent(),this.result=e,[2,!0];case 2:return i.sent(),[2,!1];case 3:return[2]}}))}))},e.extend=function(t){return function(e){function i(){return e.call(this,t)||this}return n(i,e),i.prototype.initCache=function(){var e;return null===(e=t.initCache)||void 0===e?void 0:e.call(t)},i.prototype.calc=function(e,i){return t.calc(e,i)},i}(e)},e}(),Yt={name:"AVP",shortName:"AVP",series:t.IndicatorSeries.Price,precision:2,figures:[{key:"avp",title:"AVP: ",type:"line"}],calc:function(t){var e=0,i=0;return t.map((function(t){var n,o,r={},a=null!==(n=null==t?void 0:t.turnover)&&void 0!==n?n:0,s=null!==(o=null==t?void 0:t.volume)&&void 0!==o?o:0;return e=R(e,a),0!==(i=R(i,s))&&(r.avp=M(e,i)),r}))}},Ht={name:"AO",shortName:"AO",calcParams:[5,34],figures:[{key:"ao",title:"AO: ",type:"bar",baseValue:0,styles:function(t,e,i){var n,o,r,a,s,l=null!==(o=null===(n=t.prev.indicatorData)||void 0===n?void 0:n.ao)&&void 0!==o?o:Number.MIN_SAFE_INTEGER,u=null!==(a=null===(r=t.current.indicatorData)||void 0===r?void 0:r.ao)&&void 0!==a?a:Number.MIN_SAFE_INTEGER;return{color:s=u>l?st(e.styles,"bars[0].upColor",i.bars[0].upColor):st(e.styles,"bars[0].downColor",i.bars[0].downColor),style:u>l?"stroke":"fill",borderColor:s}}}],calc:function(t,e){var i=e.calcParams,n=Math.max(i[0],i[1]),o=0,r=0,a=0,s=0;return t.map((function(e,l){var u,c={},h=M(R(e.low,e.high),2);return o=R(h,o),r=R(h,r),i[0]-1>l||(a=M(o,i[0]),o=B(o,M(R((u=t[l-(i[0]-1)]).low,u.high),2))),i[1]-1>l||(s=M(r,i[1]),r=B(r,M(R((u=t[l-(i[1]-1)]).low,u.high),2))),n-1>l||(c.ao=B(a,s)),c}))}},jt={name:"BIAS",shortName:"BIAS",calcParams:[6,12,24],figures:[{key:"bias1",title:"BIAS6: ",type:"line"},{key:"bias2",title:"BIAS12: ",type:"line"},{key:"bias3",title:"BIAS24: ",type:"line"}],regenerateFigures:function(t){return t.map((function(t,e){return{key:"bias".concat(e+1),title:"BIAS".concat(t,": "),type:"line"}}))},calc:function(t,e){var i=e.calcParams,n=e.figures,o=[];return t.map((function(e,r){var a={},s=e.close;return i.forEach((function(e,l){var u;if(o[l]=R(null!==(u=o[l])&&void 0!==u?u:0,s),r>=e-1){var c=M(o[l],i[l]);a[n[l].key]=F(M(B(s,c),c),100),o[l]=B(o[l],t[r-(e-1)].close)}})),a}))}},Xt=function(t,e,i){var n,o,r,a,s,l;if(void 0===e&&(e=[]),!t)return"";var u="";return i.length>0&&(u="_"+i.map((function(t){var e;return null!==(e=t.key)&&void 0!==e?e:""})).join("_")),"".concat(t.timestamp,"_").concat(null!==(n=t.high)&&void 0!==n?n:0,"_").concat(null!==(o=t.open)&&void 0!==o?o:0,"_").concat(null!==(r=t.low)&&void 0!==r?r:0,"_").concat(null!==(a=t.close)&&void 0!==a?a:0,"_").concat(null!==(s=t.volume)&&void 0!==s?s:0,"_").concat(null!==(l=t.turnover)&&void 0!==l?l:0)+(e.length?"_".concat(e.join("_")):"")+u};function Kt(t,e){var i=t.length,n=0;return t.forEach((function(t){var i=B(t.close,e);n=R(n,F(i,i))})),function(t){if(!y)return Math.sqrt(Number(t));var e=t,i=P.get(e);if(void 0!==i)return i;var n=function(t){return""===t?0:C(t)?""+p(t).sqrt():Math.sqrt(Number(t))}(t);return P.set(e,n),n}(M(n=N(n),i))}var qt={name:"BOLL",shortName:"BOLL",series:t.IndicatorSeries.Price,calcParams:[20,2],precision:2,shouldOhlc:!0,figures:[{key:"up",title:"UP: ",type:"line"},{key:"mid",title:"MID: ",type:"line"},{key:"dn",title:"DN: ",type:"line"}],initCache:function(){return{values:new Map,closeSum:0}},calc:function(t,e){var i=e.calcParams,n=e.figures,o=e.initCache,r=e.cache,a=i[0]-1,s=0,l=[],u=Array.from(r.values.keys());u[0]===Xt(t[0],i,n)?(s=r.closeSum,r.values.delete(u[u.length-1]),l=Array.from(r.values.values())):(null==o?void 0:o())&&(e.cache=null==o?void 0:o(),r=e.cache);for(var c=l.length;t.length>c;c++){var h=t[c],d={};if(s=R(s,h.close),c>=a){d.mid=M(s,i[0]);var p=Kt(t.slice(c-a,c+1),d.mid);d.up=R(d.mid,F(i[1],p)),d.dn=B(d.mid,F(i[1],p)),s=B(s,t[c-a].close)}r.values.set(Xt(h,i,n),d),l.push(d),c===t.length-2&&(r.closeSum=s)}return l}},Ut={name:"BRAR",shortName:"BRAR",calcParams:[26],figures:[{key:"br",title:"BR: ",type:"line"},{key:"ar",title:"AR: ",type:"line"}],calc:function(t,e){var i=e.calcParams,n=0,o=0,r=0,a=0;return t.map((function(e,s){var l,u,c={},h=e.high,d=e.low,p=e.open,v=(null!==(l=t[s-1])&&void 0!==l?l:e).close;if(r=R(r,B(h,p)),a=R(a,B(p,d)),n=R(n,B(h,v)),o=R(o,B(v,d)),s>=i[0]-1){c.ar=H(a,0)?0:F(M(r,a),100),c.br=H(o,0)?0:F(M(n,o),100);var g=t[s-(i[0]-1)],f=g.high,y=g.low,m=g.open,x=(null!==(u=t[s-i[0]])&&void 0!==u?u:t[s-(i[0]-1)]).close;n=B(n,B(f,x)),o=B(o,B(x,y)),r=B(r,B(f,m)),a=B(a,B(m,y))}return c}))}},Zt={name:"BBI",shortName:"BBI",series:t.IndicatorSeries.Price,precision:2,calcParams:[3,6,12,24],shouldOhlc:!0,figures:[{key:"bbi",title:"BBI: ",type:"line"}],calc:function(t,e){var i=e.calcParams,n=Math.max.apply(Math,c([],u(i),!1)),o=[],r=[];return t.map((function(e,a){var s={},l=e.close;if(i.forEach((function(e,i){var n;o[i]=R(null!==(n=o[i])&&void 0!==n?n:0,l),e-1>a||(r[i]=M(o[i],e),o[i]=B(o[i],t[a-(e-1)].close))})),a>=n-1){var u=0;r.forEach((function(t){u=R(u,t)})),s.bbi=M(u,4)}return s}))}},Gt={name:"CCI",shortName:"CCI",calcParams:[20],figures:[{key:"cci",title:"CCI: ",type:"line"}],calc:function(t,e){var i=e.calcParams,n=i[0]-1,o=0,r=[];return t.map((function(e,a){var s={},l=M(R(R(e.high,e.low),e.close),3);if(o=R(o,l),r.push(l),!j(a,n)){var u=M(o,i[0]),c=r.slice(a-n,a+1),h=0;c.forEach((function(t){h=R(h,N(B(t,u)))}));var d=h/i[0];s.cci=H(d,0)?0:M(M(B(l,u),d),.015);var p=M(R(R(t[a-n].high,t[a-n].low),t[a-n].close),3);o=B(o,p)}return s}))}},Jt={name:"CR",shortName:"CR",calcParams:[26,10,20,40,60],figures:[{key:"cr",title:"CR: ",title2:"CR",calcParamsIndex:0,type:"line"},{key:"ma1",title:"MA1: ",title2:"MA1",calcParamsIndex:1,type:"line"},{key:"ma2",title:"MA2: ",title2:"MA2",calcParamsIndex:2,type:"line"},{key:"ma3",title:"MA3: ",title2:"MA3",calcParamsIndex:3,type:"line"},{key:"ma4",title:"MA4: ",title2:"MA4",calcParamsIndex:4,type:"line"}],calc:function(t,e){var i=e.calcParams,n=Math.ceil(Number(R(M(i[1],2.5),1))),o=Math.ceil(Number(R(M(i[2],2.5),1))),r=Math.ceil(Number(R(M(i[3],2.5),1))),a=Math.ceil(Number(R(M(i[4],2.5),1))),s=0,l=[],u=0,c=[],h=0,d=[],p=0,v=[],g=[];return t.forEach((function(e,f){var y,m,x,_,w,b={},C=null!==(y=t[f-1])&&void 0!==y?y:e,S=M(R(R(R(C.high,C.close),C.low),C.open),4),T=K(0,B(e.high,S)),E=K(0,B(S,e.low));i[0]-1>f||(b.cr=H(E,0)?0:F(M(T,E),100),s=R(s,b.cr),u=R(u,b.cr),h=R(h,b.cr),p=R(p,b.cr),i[0]+i[1]-2>f||(l.push(M(s,i[1])),i[0]+i[1]+n-3>f||(b.ma1=l[l.length-1-n]),s=B(s,null!==(m=g[f-(i[1]-1)].cr)&&void 0!==m?m:0)),i[0]+i[2]-2>f||(c.push(M(u,i[2])),i[0]+i[2]+o-3>f||(b.ma2=c[c.length-1-o]),u=B(u,null!==(x=g[f-(i[2]-1)].cr)&&void 0!==x?x:0)),i[0]+i[3]-2>f||(d.push(M(h,i[3])),i[0]+i[3]+r-3>f||(b.ma3=d[d.length-1-r]),h=B(h,null!==(_=g[f-(i[3]-1)].cr)&&void 0!==_?_:0)),i[0]+i[4]-2>f||(v.push(M(p,i[4])),i[0]+i[4]+a-3>f||(b.ma4=v[v.length-1-a]),p=B(p,null!==(w=g[f-(i[4]-1)].cr)&&void 0!==w?w:0))),g.push(b)})),g}},$t={name:"DMA",shortName:"DMA",calcParams:[10,50,10],figures:[{key:"dma",title:"DMA: ",type:"line"},{key:"ama",title:"AMA: ",type:"line"}],calc:function(t,e){var i=e.calcParams,n=Math.max(i[0],i[1]),o=0,r=0,a=0,s=[];return t.forEach((function(e,l){var u,c={},h=e.close;o=R(o,h),r=R(r,h);var d=0,p=0;if(i[0]-1>l||(d=M(o,i[0]),o=B(o,t[l-(i[0]-1)].close)),i[1]-1>l||(p=M(r,i[1]),r=B(r,t[l-(i[1]-1)].close)),l>=n-1){var v=B(d,p);c.dma=v,a=R(a,v),n+i[2]-2>l||(c.ama=M(a,i[2]),a=B(a,null!==(u=s[l-(i[2]-1)].dma)&&void 0!==u?u:0))}s.push(c)})),s}},Qt={name:"DMI",shortName:"DMI",calcParams:[14,6],figures:[{key:"pdi",title:"PDI: ",type:"line"},{key:"mdi",title:"MDI: ",type:"line"},{key:"adx",title:"ADX: ",type:"line"},{key:"adxr",title:"ADXR: ",type:"line"}],calc:function(t,e){var i=e.calcParams,n=0,o=0,r=0,a=0,s=0,l=0,u=0,c=0,h=[];return t.forEach((function(e,d){var p,v,g={},f=null!==(p=t[d-1])&&void 0!==p?p:e,y=f.close,m=e.high,x=e.low,_=B(m,x),w=N(B(m,y)),b=N(B(y,x)),C=B(m,f.high),S=B(f.low,x),T=K(K(_,w),b),E=Y(C,0)&&Y(C,S)?C:0,I=Y(S,0)&&Y(S,C)?S:0;if(n=R(n,T),o=R(o,E),r=R(r,I),d>=i[0]-1){d>i[0]-1?(a=R(B(a,M(a,i[0])),T),s=R(B(s,M(s,i[0])),E),l=R(B(l,M(l,i[0])),I)):(a=n,s=o,l=r);var D=0,P=0;H(a,0)||(D=M(F(s,100),a),P=M(F(l,100),a)),g.pdi=D,g.mdi=P;var k=0;H(R(P,D),0)||(k=F(M(N(B(P,D)),R(P,D)),100)),u=R(u,k),2*i[0]-2>d||(c=M(d>2*i[0]-2?R(F(c,i[0]-1),k):u,i[0]),g.adx=c,2*i[0]+i[1]-3>d||(g.adxr=M(R(null!==(v=h[d-(i[1]-1)].adx)&&void 0!==v?v:0,c),2)))}h.push(g)})),h}},te={name:"EMV",shortName:"EMV",calcParams:[14,9],figures:[{key:"emv",title:"EMV: ",type:"line"},{key:"maEmv",title:"MAEMV: ",type:"line"}],calc:function(t,e){var i=e.calcParams,n=0,o=0,r=[],a=[];return t.forEach((function(e,s){var l,u,c,h={},d=null!==(l=t[s-1])&&void 0!==l?l:e,p=e.high,v=e.low,g=null!==(u=e.turnover)&&void 0!==u?u:0,f=M(R(p,v),2),y=M(R(d.high,d.low),2),m=B(p,v),x=0;H(g,0)||(x=M(F(B(f,y),m),g)),r.push(x),n=R(n,x),i[0]-1>s||(h.emv=n,n=B(n,r[s-(i[0]-1)]),o=R(o,h.emv),i[0]+i[1]-2>s||(h.maEmv=M(o,i[1]),o=B(o,null!==(c=a[s-(i[1]-1)].emv)&&void 0!==c?c:0))),a.push(h)})),a}},ee={name:"EMA",shortName:"EMA",series:t.IndicatorSeries.Price,calcParams:[6,12,20],precision:2,shouldOhlc:!0,figures:[{key:"ema1",title:"EMA6: ",type:"line"},{key:"ema2",title:"EMA12: ",type:"line"},{key:"ema3",title:"EMA20: ",type:"line"}],regenerateFigures:function(t){return t.map((function(t,e){return{key:"ema".concat(e+1),title:"EMA".concat(t,": "),type:"line"}}))},initCache:function(){return{values:new Map,closeSum:0,emaValues:[]}},calc:function(t,e){var i=e.calcParams,n=e.figures,o=e.initCache,r=e.cache,a=0,s=[],l=[],h=Array.from(r.values.keys());h[0]===Xt(t[0],i,n)?(a=r.closeSum,l=c([],u(r.emaValues),!1),r.values.delete(h[h.length-1]),s=Array.from(r.values.values())):(null==o?void 0:o())&&(e.cache=null==o?void 0:o(),r=e.cache);for(var d=function(e){var o=t[e],h={},d=o.close;a=R(a,d),i.forEach((function(t,i){t-1>e||(l[i]=e>t-1?M(R(F(2,d),F(B(t,1),l[i])),R(t,1)):M(a,t),h[n[i].key]=l[i])})),r.values.set(Xt(o,i,n),h),s.push(h),e===t.length-2&&(r.closeSum=a,r.emaValues=c([],u(l),!1))},p=s.length;t.length>p;p++)d(p);return s}},ie={name:"MTM",shortName:"MTM",calcParams:[12,6],figures:[{key:"mtm",title:"MTM: ",type:"line"},{key:"maMtm",title:"MAMTM: ",type:"line"}],calc:function(t,e){var i=e.calcParams,n=0,o=[];return t.forEach((function(e,r){var a,s={};i[0]>r||(s.mtm=B(e.close,t[r-i[0]].close),n=R(n,s.mtm),i[0]+i[1]-1>r||(s.maMtm=M(n,i[1]),n=B(n,null!==(a=o[r-(i[1]-1)].mtm)&&void 0!==a?a:0))),o.push(s)})),o}},ne={name:"MA",shortName:"MA",series:t.IndicatorSeries.Price,calcParams:[5,10,30,60],precision:2,shouldOhlc:!0,figures:[{key:"ma5",title:"MA5: ",type:"line"},{key:"ma10",title:"MA10: ",type:"line"},{key:"ma30",title:"MA30: ",type:"line"},{key:"ma60",title:"MA60: ",type:"line"}],regenerateFigures:function(t){return t.map((function(t,e){return{key:"ma".concat(e+1),title:"MA".concat(t,": "),type:"line"}}))},initCache:function(){return{closeSums:[],values:new Map}},calc:function(t,e){var i=e.calcParams,n=e.figures,o=e.initCache,r=e.cache,a=[],s=[],l=Array.from(r.values.keys());l[0]===Xt(t[0],i,n)?(s=c([],u(r.closeSums),!1),r.values.delete(l[l.length-1]),a=Array.from(r.values.values())):(null==o?void 0:o())&&(e.cache=null==o?void 0:o(),r=e.cache);for(var h=function(e){var o=t[e],l={},h=o.close;i.forEach((function(i,o){var r;s[o]=R(null!==(r=s[o])&&void 0!==r?r:0,h),i-1>e||(l[n[o].key]=M(s[o],i),s[o]=B(s[o],t[e-(i-1)].close))})),r.values.set(Xt(o,i,n),l),a.push(l),e===t.length-2&&(r.closeSums=c([],u(s),!1))},d=a.length;t.length>d;d++)h(d);return a}},oe={name:"MACD",shortName:"MACD",calcParams:[12,26,9],figures:[{key:"dif",title:"DIF: ",type:"line"},{key:"dea",title:"DEA: ",type:"line"},{key:"macd",title:"MACD: ",type:"bar",baseValue:0,styles:function(t,e,i){var n,o,r,a,s,l=null!==(o=null===(n=t.prev.indicatorData)||void 0===n?void 0:n.macd)&&void 0!==o?o:Number.MIN_SAFE_INTEGER,u=null!==(a=null===(r=t.current.indicatorData)||void 0===r?void 0:r.macd)&&void 0!==a?a:Number.MIN_SAFE_INTEGER;return s=Y(u,0)?st(e.styles,"bars[0].upColor",i.bars[0].upColor):j(u,0)?st(e.styles,"bars[0].downColor",i.bars[0].downColor):st(e.styles,"bars[0].noChangeColor",i.bars[0].noChangeColor),{style:j(l,u)?"stroke":"fill",color:s,borderColor:s}}}],initCache:function(){return{values:new Map,closeSum:0,difSum:0,dea:0,emaShort:void 0,emaLong:void 0}},calc:function(t,e){var i,n,o=e.calcParams,r=e.initCache,a=e.figures,s=e.cache,l=0,u=0,c=0,h=0,d=Math.max(o[0],o[1]),p=[],v=Array.from(s.values.keys());v[0]===Xt(t[0],o,a)?(l=s.closeSum,void 0!==s.emaShort&&(i=s.emaShort),void 0!==s.emaLong&&(n=s.emaLong),c=s.difSum,h=s.dea,s.values.delete(v[v.length-1]),p=Array.from(s.values.values())):(null==r?void 0:r())&&(e.cache=null==r?void 0:r(),s=e.cache);for(var g=p.length;t.length>g;g++){var f={},y=t[g],m=y.close;l=R(l,m),o[0]-1>g||(i=g>o[0]-1?M(R(F(2,m),F(o[0]-1,i)),o[0]+1):M(l,o[0])),o[1]-1>g||(n=g>o[1]-1?M(R(F(2,m),F(o[1]-1,n)),o[1]+1):M(l,o[1])),d-1>g||(u=B(i,n),f.dif=u,c=R(c,u),d+o[2]-2>g||(h=g>d+o[2]-2?M(R(F(u,2),F(h,o[2]-1)),o[2]+1):M(c,o[2]),f.macd=F(B(u,h),2),f.dea=h)),s.values.set(Xt(y,o,a),f),g===t.length-2&&(s.closeSum=l,s.emaShort=i,s.emaLong=n,s.difSum=c,s.dea=h),p.push(f)}return p}},re={name:"OBV",shortName:"OBV",calcParams:[30],figures:[{key:"obv",title:"OBV: ",type:"line"},{key:"maObv",title:"MAOBV: ",type:"line"}],calc:function(t,e){var i=e.calcParams,n=0,o=0,r=[];return t.forEach((function(e,a){var s,l,u,c,h=null!==(s=t[a-1])&&void 0!==s?s:e;j(e.close,h.close)?o=B(o,null!==(l=e.volume)&&void 0!==l?l:0):Y(e.close,h.close)&&(o=R(o,null!==(u=e.volume)&&void 0!==u?u:0));var d={obv:o};n=R(n,o),i[0]-1>a||(d.maObv=M(n,i[0]),n=B(n,null!==(c=r[a-(i[0]-1)].obv)&&void 0!==c?c:0)),r.push(d)})),r}},ae={name:"PVT",shortName:"PVT",figures:[{key:"pvt",title:"PVT: ",type:"line"}],calc:function(t){var e=0;return t.map((function(i,n){var o,r,a={},s=i.close,l=null!==(o=i.volume)&&void 0!==o?o:1,u=(null!==(r=t[n-1])&&void 0!==r?r:i).close,c=0,h=F(u,l);return H(h,0)||(c=M(B(s,u),h)),e=R(e,c),a.pvt=e,a}))}},se={name:"PSY",shortName:"PSY",calcParams:[12,6],figures:[{key:"psy",title:"PSY: ",type:"line"},{key:"maPsy",title:"MAPSY: ",type:"line"}],calc:function(t,e){var i=e.calcParams,n=0,o=0,r=[],a=[];return t.forEach((function(e,s){var l,u,c={},h=(null!==(l=t[s-1])&&void 0!==l?l:e).close,d=Y(B(e.close,h),0)?1:0;r.push(d),n=R(n,d),i[0]-1>s||(c.psy=F(M(n,i[0]),100),o=R(o,c.psy),i[0]+i[1]-2>s||(c.maPsy=M(o,i[1]),o=B(o,null!==(u=a[s-(i[1]-1)].psy)&&void 0!==u?u:0)),n=B(n,r[s-(i[0]-1)])),a.push(c)})),a}},le={name:"ROC",shortName:"ROC",calcParams:[9,6,0],figures:[{key:"roc",title:"ROC: ",title2:"ROC",calcParamsIndex:0,type:"line"},{key:"maRoc",title:"MAROC: ",title2:"MAROC",calcParamsIndex:1,type:"line"},{key:"zeroLine",title:"ZEROLINE: ",type:"line"}],calc:function(t,e){var i=e.calcParams,n=[],o=0;return t.forEach((function(e,r){var a,s,l={};if(r>=i[0]-1){var u=(null!==(a=t[r-i[0]])&&void 0!==a?a:t[r-(i[0]-1)]).close;l.roc=0!==u?F(M(B(e.close,u),u),100):0,1===i[1]?l.maRoc=l.roc:i[0]-1+i[1]-1>r||(o=R(o,l.roc),l.maRoc=M(o,i[1]),o=B(o,null!==(s=n[r-(i[1]-1)].roc)&&void 0!==s?s:0))}l.zeroLine=i[2],n.push(l)})),n}},ue=function(){function t(t){this.length=t,this.filled=!1,this.pointer=0,this.buffer=Array(t),this.maxIndex=t-1}return t.prototype.push=function(t){var e=this.buffer[this.pointer];return this.buffer[this.pointer]=t,this.iteratorNext(),e},t.prototype.pushback=function(t){this.iteratorPrev();var e=this.buffer[this.pointer];return this.buffer[this.pointer]=t,e},t.prototype.peek=function(){return this.buffer[this.pointer]},t.prototype.forEach=function(t){for(var e=this.pointer,i=0;i!==this.length;)t(this.buffer[e],i),e=(this.length+e+1)%this.length,i++},t.prototype.forEachRight=function(t){for(var e=(this.length+this.pointer-1)%this.length,i=this.length-1;i!==this.length;)t(this.buffer[e],i),e=(this.length+e-1)%this.length,i--},t.prototype.fill=function(t){this.buffer.fill(t),this.filled=!0},t.prototype.toArray=function(){return this.buffer},t.prototype.iteratorNext=function(){this.pointer++,this.pointer>this.maxIndex&&(this.pointer=0,this.filled=!0)},t.prototype.iteratorPrev=function(){this.pointer--,0>this.pointer&&(this.pointer=this.maxIndex)},t}(),ce=function(){function t(t){this.period=t,this.sum=0,this.circular=new ue(t)}return t.prototype.nextValue=function(t){var e=this;if(this.circular.push(t),this.sum=R(this.sum,t),this.circular.filled)return this.nextValue=function(t){return e.sum=R(B(e.sum,e.circular.push(t)),t),M(e.sum,e.period)},M(this.sum,this.period)},t}(),he=function(){function t(t){this.max=-1/0,this.highest=new ue(t)}return t.prototype.filled=function(){return this.highest.filled},t.prototype.nextValue=function(t){j(this.max,t)&&(this.max=t);var e=this.highest.push(t);return void 0!==e&&H(e,this.max)&&!H(t,this.max)&&(this.max=function(t){for(var e=-1/0,i=t.length-1;i>=0;i--){var n=t[i];j(e,n)&&(e=n)}return e}(this.highest.toArray())),this.max},t}(),de=function(){function t(t){this.min=1/0,this.lowest=new ue(t)}return t.prototype.filled=function(){return this.lowest.filled},t.prototype.nextValue=function(t){Y(this.min,t)&&(this.min=t);var e=this.lowest.push(t);return void 0!==e&&H(e,this.min)&&!H(t,this.min)&&(this.min=function(t){for(var e=1/0,i=t.length-1;i>=0;i--){var n=t[i];Y(e,n)&&(e=n)}return e}(this.lowest.toArray())),this.min},t}(),pe=function(){function t(t){this.period=t,this.sum=0,this.avg=0,this.filled=!1,this.fill=0}return t.prototype.nextValue=function(t){var e=this;return this.filled?(this.nextValue=function(t){return e.avg=M(R(F(e.avg,B(e.period,1)),t),e.period)},this.nextValue(t)):(this.sum=R(this.sum,t),this.fill++,this.fill===this.period?(this.filled=!0,this.avg=M(this.sum,this.period),this.avg):0)},t}(),ve=function(){function t(t){this.avgGain=new pe(t),this.avgLoss=new pe(t)}return t.prototype.nextValue=function(t){var e=B(t,this.prev);if(this.prev){var i=Y(e,0),n=j(e,0)?e:0,o=this.avgGain.nextValue(i?e:0),r=this.avgLoss.nextValue(n);return this.prev=t,{upAvg:o,downAvg:r}}this.prev=t},t}(),ge=function(){function t(t){void 0===t&&(t=14),this.change=new ve(t)}return t.prototype.nextValue=function(t){var e,i=null!==(e=this.change.nextValue(t))&&void 0!==e?e:{},n=i.downAvg,o=i.upAvg;if(void 0!==o&&void 0!==n){var r=M(o,F(-1,n));return isNaN(Number(r))?100:B(100,M(100,R(1,r)))}},t}(),fe=function(){function t(t,e,i,n){void 0===t&&(t=14),void 0===e&&(e=14),void 0===i&&(i=3),void 0===n&&(n=3),this.rsi=new ge(e),this.min=new de(t),this.max=new he(t),this.kma=new ce(i),this.dma=new ce(n)}return t.prototype.nextValue=function(t){var e=this.rsi.nextValue(t),i=this.max.nextValue(e),n=this.min.nextValue(e);if(this.max.filled){var o=F(M(B(e,n),B(i,n)),100);if(!isNaN(Number(o))){var r=this.kma.nextValue(o||0);return isFinite(Number(r))?{k:r,d:this.dma.nextValue(r||0)}:{k:r}}}},t}(),ye=function(){function t(t,e,i){void 0===t&&(t=9),void 0===e&&(e=26),void 0===i&&(i=52),this.conversionMax=new he(t),this.conversionMin=new de(t),this.baseMin=new de(e),this.baseMax=new he(e),this.laggingSpanBMax=new he(i),this.laggingSpanBMin=new de(i)}return t.prototype.nextValue=function(t){var e=this.conversionMax.nextValue(t.high),i=this.conversionMin.nextValue(t.low),n=this.baseMax.nextValue(t.high),o=this.baseMin.nextValue(t.low),r=this.laggingSpanBMax.nextValue(t.high),a=this.laggingSpanBMin.nextValue(t.low);return{conversion:M(R(e,i),2),base:M(R(n,o),2),laggingSpanB:M(R(r,a),2),leadingSpan:void 0,laggingSpanA:void 0}},t}(),me={name:"RSI",shortName:"RSI",calcParams:[6,12,24],figures:[{key:"rsi1",title:"RSI1: ",title2:"RSI1",calcParamsIndex:0,type:"line"},{key:"rsi2",title:"RSI2: ",title2:"RSI2",calcParamsIndex:1,type:"line"},{key:"rsi3",title:"RSI3: ",title2:"RSI3",calcParamsIndex:2,type:"line"}],regenerateFigures:function(t){return t.map((function(t,e){var i=e+1;return{key:"rsi".concat(i),title:"RSI".concat(i,": "),title2:"RSI".concat(i),calcParamsIndex:e,type:"line"}}))},calc:function(t,e){var i=e.figures,n=e.calcParams.map((function(t,e){return{key:i[e].key,rsi:new ge(t)}})),o=[];return t.forEach((function(t){var e={};n.forEach((function(i){e[i.key]=i.rsi.nextValue(t.close)})),o.push(e)})),o}},xe={name:"SAR",shortName:"SAR",series:t.IndicatorSeries.Price,calcParams:[2,2,20],precision:2,shouldOhlc:!0,figures:[{key:"sar",title:"SAR: ",type:"circle",styles:function(t,e,i){var n,o,r=t.current,a=null!==(o=null===(n=r.indicatorData)||void 0===n?void 0:n.sar)&&void 0!==o?o:Number.MIN_SAFE_INTEGER,s=r.kLineData;return{color:j(a,M(R(null==s?void 0:s.high,null==s?void 0:s.low),2))?st(e.styles,"circles[0].upColor",i.circles[0].upColor):st(e.styles,"circles[0].downColor",i.circles[0].downColor)}}}],initCache:function(){return{values:new Map,af:void 0,ep:-100,isIncreasing:!1,sar:0}},calc:function(t,e){var i=e.calcParams,n=e.initCache,o=e.figures,r=e.cache,a=i[0]/100,s=i[1]/100,l=i[2]/100,u=a,c=-100,h=!1,d=0,p=[],v=Array.from(r.values.keys());v[0]===Xt(t[0],i,o)?(void 0!==r.af&&(u=r.af),c=r.ep,h=r.isIncreasing,d=r.sar,r.values.delete(v[v.length-1]),p=Array.from(r.values.values())):(null==n?void 0:n())&&(e.cache=null==n?void 0:n(),r=e.cache);for(var g=p.length;t.length>g;g++){var f=t[g],y=d,m=f.high,x=f.low;if(h){(H(c,-100)||j(c,m))&&(c=m,u=X(R(u,s),l)),d=R(y,F(u,B(c,y)));var _=X(t[B(K(1,g),1)].low,x);Y(d,f.low)?(d=c,u=a,c=-100,h=!h):Y(d,_)&&(d=_)}else{(H(c,-100)||Y(c,x))&&(c=x,u=X(R(u,s),l)),d=R(y,F(u,B(c,y)));var w=K(t[B(K(1,g),1)].high,m);j(d,f.high)?(d=c,u=0,c=-100,h=!h):j(d,w)&&(d=w)}r.values.set(Xt(f,i,o),{sar:d}),p.push({sar:d}),g===t.length-2&&(r.af=u,r.ep=c,r.isIncreasing=h,r.sar=d)}return p}},_e={name:"VOL",shortName:"VOL",series:t.IndicatorSeries.Volume,calcParams:[5,10,20],shouldFormatBigNumber:!0,precision:0,minValue:0,figures:[{key:"volume",title:"VOLUME: ",type:"bar",baseValue:0,styles:function(t,e,i){var n=t.current.kLineData;return n?{color:n.close>n.open?st(e.styles,"bars[0].upColor",i.bars[0].upColor):n.open>n.close?st(e.styles,"bars[0].downColor",i.bars[0].downColor):st(e.styles,"bars[0].noChangeColor",i.bars[0].noChangeColor)}:{color:st(e.styles,"bars[0].noChangeColor",i.bars[0].noChangeColor)}}},{key:"ma1",title:"MA(5): ",type:"line"},{key:"ma2",title:"MA(10): ",type:"line"},{key:"ma3",title:"MA(20): ",type:"line"}],initCache:function(){return{values:new Map,volSums:[]}},regenerateFigures:function(t){var e=t.map((function(t,e){return{key:"ma".concat(e+1),title:"MA(".concat(t,"): "),type:"line"}}));return e.unshift({key:"volume",title:"VOLUME: ",type:"bar",baseValue:0,styles:function(t,e,i){var n=t.current.kLineData;return n?{color:n.close>n.open?st(e.styles,"bars[0].upColor",i.bars[0].upColor):n.open>n.close?st(e.styles,"bars[0].downColor",i.bars[0].downColor):st(e.styles,"bars[0].noChangeColor",i.bars[0].noChangeColor)}:{color:st(e.styles,"bars[0].noChangeColor",i.bars[0].noChangeColor)}}}),e},calc:function(t,e){var i,n=e.calcParams,o=e.figures,r=e.initCache,a=e.cache,s=[],l=[],h=Array.from(a.values.keys());h[0]===Xt(t[0],n,o)?(l=c([],u(a.volSums),!1),a.values.delete(h[h.length-1]),s=Array.from(a.values.values())):(null==r?void 0:r())&&(e.cache=null==r?void 0:r(),a=e.cache);for(var d=function(e){var r=t[e],h=null!==(i=r.volume)&&void 0!==i?i:0,d={volume:h,turnover:r.turnover};n.forEach((function(i,n){var r,a;l[n]=R(null!==(r=l[n])&&void 0!==r?r:0,h),i-1>e||(d[o[n+1].key]=M(l[n],i),l[n]=B(l[n],null!==(a=t[e-(i-1)].volume)&&void 0!==a?a:0))})),a.values.set(Xt(r,n,o),d),s.push(d),e===t.length-2&&(a.volSums=c([],u(l),!1))},p=s.length;t.length>p;p++)d(p);return s}},we={name:"VR",shortName:"VR",calcParams:[26,6],figures:[{key:"vr",title:"VR: ",type:"line"},{key:"maVr",title:"MAVR: ",type:"line"}],calc:function(t,e){var i=e.calcParams,n=0,o=0,r=0,a=0,s=[];return t.forEach((function(e,l){var u,c,h,d,p,v={},g=e.close,f=(null!==(u=t[l-1])&&void 0!==u?u:e).close,y=null!==(c=e.volume)&&void 0!==c?c:0;if(Y(g,f)?n=R(n,y):f>g?o=R(o,y):r=R(r,y),l>=i[0]-1){var m=M(r,2);v.vr=H(R(o,m),0)?0:F(M(R(n,m),R(o,m)),100),a=R(a,v.vr),i[0]+i[1]-2>l||(v.maVr=M(a,i[1]),a=B(a,null!==(h=s[l-(i[1]-1)].vr)&&void 0!==h?h:0));var x=t[l-(i[0]-1)],_=null!==(d=t[l-i[0]])&&void 0!==d?d:x,w=x.close,b=null!==(p=x.volume)&&void 0!==p?p:0;Y(w,_.close)?n=B(n,b):_.close>w?o=B(o,b):r=B(r,b)}s.push(v)})),s}},be={name:"WR",shortName:"WR",calcParams:[6,10,14],figures:[{key:"wr1",title:"WR1: ",title2:"WR1",calcParamsIndex:0,type:"line"},{key:"wr2",title:"WR2: ",title2:"WR2",calcParamsIndex:1,type:"line"},{key:"wr3",title:"WR3: ",title2:"WR3",calcParamsIndex:2,type:"line"}],regenerateFigures:function(t){return t.map((function(t,e){return{key:"wr".concat(e+1),title:"WR".concat(e+1,": "),title2:"WR".concat(e+1),calcParamsIndex:e,type:"line"}}))},calc:function(t,e){var i=e.calcParams,n=e.figures;return t.map((function(e,o){var r={},a=e.close;return i.forEach((function(e,i){var s=e-1;if(o>=s){var l=_(t.slice(o-s,o+1),"high","low"),u=l[0],c=B(u,l[1]);r[n[i].key]=H(c,0)?0:F(M(B(a,u),c),100)}})),r}))}},Ce={name:"ICHIMOKU Cloud",shortName:"ICHIMOKU Cloud",series:t.IndicatorSeries.Price,calcParams:[9,26,52,26],precision:2,shouldOhlc:!0,figures:[{key:"conversion",title:"Conversion Line: ",title2:"Conversion Line",calcParamsIndex:0,type:"line"},{key:"base",title:"Base Line: ",title2:"Base Line",calcParamsIndex:1,type:"line"},{key:"leadingSpan",title:"Leading Span: ",type:"line"},{key:"laggingSpanA",title:"Lagging Span A: ",title2:"Lagging Span A",calcParamsIndex:2,type:"line"},{key:"laggingSpanB",title:"Lagging Span B: ",title2:"Lagging Span B",calcParamsIndex:3,type:"line"},{key:"background",title:"Plots Background: ",type:"polygon",originalKey:"laggingSpanA",referenceKey:"laggingSpanB",styles:function(t,e,i){var n,o,r,a,s=t.current;return{style:"fill",color:(null!==(o=null===(n=s.indicatorData)||void 0===n?void 0:n[this.originalKey])&&void 0!==o?o:0)>(null!==(a=null===(r=s.indicatorData)||void 0===r?void 0:r[this.referenceKey])&&void 0!==a?a:0)?st(e.styles,"polygons[0].upColor",i.polygons[0].upColor):st(e.styles,"polygons[0].downColor",i.polygons[0].downColor)}}}],hideFigures:[],calc:function(t,e){for(var i,n,o,r=u(e.calcParams,4),a=r[0],s=r[1],l=r[2],c=r[3],h=new ye(a,s,l),d=[],p=0;t.length+2*(c-1)>p;p++)d[p]={conversion:void 0,base:void 0,leadingSpan:void 0,laggingSpanA:void 0,laggingSpanB:void 0,dataIndex:p-c+1},t.length>p&&(d[p].leadingSpan=null===(i=t[p])||void 0===i?void 0:i.close);for(p=0;t.length>p;p++){var v=h.nextValue(t[p]),g=v.base,f=v.laggingSpanB,y=p+ +c-1;a-1>p||(d[y].conversion=v.conversion),s-1>p||(d[y].base=g),it(d[y].conversion)&&it(d[y].base)&&(d[y+ +c-1].laggingSpanA=M(R(null!==(n=d[y].conversion)&&void 0!==n?n:0,null!==(o=d[y].base)&&void 0!==o?o:0),2)),l-1>p||(d[y+ +c-1].laggingSpanB=f)}return d}},Se={};function Te(t){var e;return null!==(e=Se[t])&&void 0!==e?e:null}[Yt,Ht,jt,qt,Ut,Zt,Gt,Jt,$t,Qt,te,ee,ie,ne,oe,re,ae,se,le,me,{name:"SMA",shortName:"SMA",series:t.IndicatorSeries.Price,calcParams:[12,2],precision:2,figures:[{key:"sma",title:"SMA: ",type:"line"}],shouldOhlc:!0,calc:function(t,e){var i=e.calcParams,n=0,o=0;return t.map((function(t,e){var r={},a=t.close;return n=R(n,a),i[0]-1>e||(o=e>i[0]-1?M(R(F(a,i[1]),F(o,i[0]-i[1]+1)),i[0]+1):M(n,i[0]),r.sma=o),r}))}},{name:"KDJ",shortName:"KDJ",calcParams:[9,3,3],figures:[{key:"k",title:"K: ",type:"line"},{key:"d",title:"D: ",type:"line"},{key:"j",title:"J: ",type:"line"}],calc:function(t,e){var i=e.calcParams,n=[];return t.forEach((function(e,o){var r,a,s,l,u={},c=e.close;if(o>=i[0]-1){var h=_(t.slice(o-(i[0]-1),o+1),"high","low"),d=h[1],p=B(h[0],d),v=F(M(B(c,d),H(p,0)?1:p),100);u.k=M(R(F(i[1]-1,null!==(a=null===(r=n[o-1])||void 0===r?void 0:r.k)&&void 0!==a?a:50),v),i[1]),u.d=M(R(F(i[2]-1,null!==(l=null===(s=n[o-1])||void 0===s?void 0:s.d)&&void 0!==l?l:50),u.k),i[2]),u.j=B(F(3,u.k),F(2,u.d))}n.push(u)})),n}},xe,{name:"TRIX",shortName:"TRIX",calcParams:[12,9],figures:[{key:"trix",title:"TRIX: ",type:"line"},{key:"maTrix",title:"MATRIX: ",type:"line"}],calc:function(t,e){var i,n,o,r=e.calcParams,a=0,s=0,l=0,u=0,c=[];return t.forEach((function(t,e){var h,d={},p=t.close;if(a=R(a,p),e>=r[0]-1&&(i=e>r[0]-1?M(R(F(2,p),F(B(r[0],1),i)),r[0]+1):M(a,r[0]),s=R(s,i),e>=2*r[0]-2&&(n=e>2*r[0]-2?M(R(F(2,i),F(r[0]-1,n)),r[0]+1):M(s,r[0]),l=R(l,n),e>=3*r[0]-3))){var v=void 0,g=0;e>3*r[0]-3?(v=M(R(F(2,n),F(r[0]-1,o)),r[0]+1),g=F(M(B(v,o),o),100)):v=M(l,r[0]),o=v,d.trix=g,u=R(u,g),3*r[0]+r[1]-4>e||(d.maTrix=M(u,r[1]),u=B(u,null!==(h=c[e-(r[1]-1)].trix)&&void 0!==h?h:0))}c.push(d)})),c}},_e,we,be,{name:"StochRSI",shortName:"StochRSI",calcParams:[14,14,3,3],figures:[{key:"k",title:"Smooth K: ",type:"line"},{key:"d",title:"Smooth D: ",type:"line"}],calc:function(t,e){var i=new(fe.bind.apply(fe,c([void 0],u(e.calcParams),!1))),n=[];return t.forEach((function(t){n.push(i.nextValue(t.close))})),n}},Ce].forEach((function(t){Se[t.name]=Wt.extend(t)}));var Ee,Ie=function(){function e(t){this._instances=new Map,this._chartStore=t}return e.prototype._overrideInstance=function(t,e){var i=e.shortName,n=e.series,o=e.calcParams,r=e.precision,a=e.figures,s=e.minValue,l=e.maxValue,u=e.shouldOhlc,c=e.shouldFormatBigNumber,h=e.visible,d=e.styles,p=e.extendData,v=e.regenerateFigures,g=e.createTooltipDataSource,f=e.draw,y=e.calc,m=e.hideFigures,x=!1;void 0!==i&&t.setShortName(i)&&(x=!0),void 0!==n&&t.setSeries(n)&&(x=!0);var _=!1;return void 0!==o&&t.setCalcParams(o)&&(x=!0,_=!0),void 0!==a&&t.setFigures(a)&&(x=!0,_=!0),void 0!==s&&t.setMinValue(s)&&(x=!0),void 0!==l&&t.setMinValue(l)&&(x=!0),void 0!==r&&t.setPrecision(r)&&(x=!0),void 0!==u&&t.setShouldOhlc(u)&&(x=!0),void 0!==c&&t.setShouldFormatBigNumber(c)&&(x=!0),void 0!==h&&t.setVisible(h)&&(x=!0),void 0!==d&&t.setStyles(d)&&(x=!0),void 0!==p&&t.setExtendData(p)&&(x=!0,_=!0),void 0!==v&&t.setRegenerateFigures(v)&&(x=!0),void 0!==g&&t.setCreateTooltipDataSource(g)&&(x=!0),void 0!==f&&t.setDraw(f)&&(x=!0),void 0!==m&&t.setHideFigures(m)&&(x=!0),void 0!==y&&(t.calc=y,_=!0),[x,_]},e.prototype.addInstance=function(t,e,i){var n;return r(this,void 0,void 0,(function(){var o,r,a,l;return s(this,(function(s){switch(s.label){case 0:return o=t.name,r=this._instances.get(e),null!==(n=null==r?void 0:r.has(o))&&void 0!==n&&n?[4,Promise.reject(Error("Duplicate indicators."))]:[3,2];case 1:case 3:return[2,s.sent()];case 2:return void 0===r&&(r=new Map,this._instances.set(e,r)),a=Te(o),l=new a,this._overrideInstance(l,t),i||r.clear(),r.set(o,l),[4,l.calcIndicator(this._chartStore.getDataList())]}}))}))},e.prototype.getInstances=function(t){var e;return null!==(e=this._instances.get(t))&&void 0!==e?e:new Map},e.prototype.removeInstance=function(t,e){var i=!1,n=this._instances.get(t);return void 0!==n&&(void 0!==e?n.has(e)&&(n.delete(e),i=!0):(n.clear(),i=!0),0===n.size&&this._instances.delete(t)),i},e.prototype.hasInstances=function(t){return this._instances.has(t)},e.prototype.calcInstance=function(t,e){var i;return r(this,void 0,void 0,(function(){var n,o,r,a=this;return s(this,(function(s){switch(s.label){case 0:return n=[],void 0!==t?void 0!==e?(o=this._instances.get(e),null!==(i=null==o?void 0:o.has(t))&&void 0!==i&&i&&(r=null==o?void 0:o.get(t),n.push(r.calcIndicator(this._chartStore.getDataList())))):this._instances.forEach((function(e){if(e.has(t)){var i=null==e?void 0:e.get(t);n.push(i.calcIndicator(a._chartStore.getDataList()))}})):this._instances.forEach((function(t){t.forEach((function(t){n.push(t.calcIndicator(a._chartStore.getDataList()))}))})),[4,Promise.all(n)];case 1:return[2,s.sent().includes(!0)]}}))}))},e.prototype.getInstanceByPaneId=function(t,e){var i;if(void 0!==t){var n=this._instances.get(t);return void 0!==e?null!==(i=null==n?void 0:n.get(e))&&void 0!==i?i:null:null!=n?n:null}return this._instances},e.prototype.setSeriesPrecision=function(e){this._instances.forEach((function(i){i.forEach((function(i){i.series===t.IndicatorSeries.Price&&i.setPrecision(e.price,!0),i.series===t.IndicatorSeries.Volume&&i.setPrecision(e.volume,!0)}))}))},e.prototype.override=function(t,e){return r(this,void 0,void 0,(function(){var i,n,o,r,a,l,u=this;return s(this,(function(s){switch(s.label){case 0:return i=t.name,n=new Map,null!==e?void 0!==(o=this._instances.get(e))&&n.set(e,o):n=this._instances,r=!1,a=[],n.forEach((function(e){var n=e.get(i);if(void 0!==n){var o=u._overrideInstance(n,t);o[1]?a.push(n.calcIndicator(u._chartStore.getDataList())):o[0]&&(r=!0)}})),[4,Promise.all(a)];case 1:return l=s.sent(),[2,[r,l.includes(!0)]]}}))}))},e}(),De=function(){function t(t){this._crosshair={},this._chartStore=t,this._status=!0}return t.prototype.set=function(t,e){var i,n,r=this._chartStore.getDataList(),a=null!=t?t:{},s=r[n=void 0!==a.x?0>(i=this._chartStore.getTimeScaleStore().coordinateToDataIndex(a.x))?0:i>r.length-1?r.length-1:i:i=r.length-1],l=this._chartStore.getTimeScaleStore().dataIndexToCoordinate(i),u=this._crosshair.x,c=this._crosshair.y,h=this._crosshair.paneId;return this._crosshair=o(o({},a),{realX:l,kLineData:s,realDataIndex:i,dataIndex:n}),u===a.x&&c===a.y&&h===a.paneId||(null!==s&&this._chartStore.getChart().crosshairChange(this._crosshair),null!=e&&e||this._chartStore.getChart().updatePane(1)),this},t.prototype.recalculate=function(t){this.set(this._crosshair,t)},t.prototype.get=function(){return this._crosshair},t.prototype.setStatus=function(t){this._status=t},t.prototype.getStatus=function(){return this._status},t}(),Pe=function(){function t(){this._activeIconInfo=null}return t.prototype.setActiveIconInfo=function(t){this._activeIconInfo=null!=t?t:null},t.prototype.getActiveIconInfo=function(){return this._activeIconInfo},t}();t.OverlayMode=void 0,(Ee=t.OverlayMode||(t.OverlayMode={})).Normal="normal",Ee.WeakMagnet="weak_magnet",Ee.StrongMagnet="strong_magnet";var ke="overlay_figure_",Me=Number.MAX_SAFE_INTEGER,Ae=function(){function e(e){this.currentStep=1,this.points=[],this._prevPressedPoint=null,this._prevPressedPoints=[];var i=e.mode,n=e.extendData,o=e.styles,r=e.totalStep,a=e.lock,s=e.visible,l=e.zLevel,u=e.modeSensitivity,c=e.needDefaultPointFigure,h=e.needDefaultXAxisFigure,d=e.needDefaultYAxisFigure,p=e.createPointFigures,v=e.createXAxisFigures,g=e.createYAxisFigures,f=e.performEventPressedMove,y=e.performEventMoveForDrawing,m=e.onDrawStart,x=e.onDrawing,_=e.onDrawEnd,w=e.onClick,b=e.onRightClick,C=e.onPressedMoveStart,S=e.onPressedMoving,T=e.onPressedMoveEnd,E=e.onMouseEnter,I=e.onMouseMove,D=e.onMouseLeave,P=e.onRemoved,k=e.onSelected,M=e.onDeselected;this.name=e.name,this.totalStep=void 0===r||2>r?1:r,this.lock=null!=a&&a,this.visible=null==s||s,this.zLevel=null!=l?l:0,this.originalZLevel=null!=l?l:0,this.modeSensitivity=null!=u?u:8,this.needDefaultPointFigure=null!=c&&c,this.needDefaultXAxisFigure=null!=h&&h,this.needDefaultYAxisFigure=null!=d&&d,this.mode=null!=i?i:t.OverlayMode.Normal,this.extendData=n,this.styles=null!=o?o:null,this.createPointFigures=null!=p?p:null,this.createXAxisFigures=null!=v?v:null,this.createYAxisFigures=null!=g?g:null,this.performEventPressedMove=null!=f?f:null,this.performEventMoveForDrawing=null!=y?y:null,this.onDrawStart=null!=m?m:null,this.onDrawing=null!=x?x:null,this.onDrawEnd=null!=_?_:null,this.onClick=null!=w?w:null,this.onRightClick=null!=b?b:null,this.onPressedMoveStart=null!=C?C:null,this.onPressedMoving=null!=S?S:null,this.onPressedMoveEnd=null!=T?T:null,this.onMouseEnter=null!=E?E:null,this.onMouseMove=null!=I?I:null,this.onMouseLeave=null!=D?D:null,this.onRemoved=null!=P?P:null,this.onSelected=null!=k?k:null,this.onDeselected=null!=M?M:null}return e.prototype.setId=function(t){return void 0===this.id&&(this.id=t,!0)},e.prototype.setGroupId=function(t){return void 0===this.groupId&&(this.groupId=t,!0)},e.prototype.setExtendData=function(t){return t!==this.extendData&&(this.extendData=t,!0)},e.prototype.setStyles=function(t){return t!==this.styles&&(this.styles=t,!0)},e.prototype.setPoints=function(t){if(t.length>0){var e=void 0;if(this.points=c([],u(t),!1),this.totalStep-1>t.length?(this.currentStep=t.length+1,e=t.length):(this.currentStep=-1,e=this.totalStep-1),null!==this.performEventMoveForDrawing)for(var i=0;e>i;i++)this.performEventMoveForDrawing({currentStep:i+2,mode:this.mode,points:this.points,performPointIndex:i,performPoint:this.points[i]});return-1===this.currentStep&&null!==this.performEventPressedMove&&this.performEventPressedMove({currentStep:this.currentStep,mode:this.mode,points:this.points,performPointIndex:this.points.length-1,performPoint:this.points[this.points.length-1]}),!0}return!1},e.prototype.setLock=function(t){return this.lock!==t&&(this.lock=t,!0)},e.prototype.setVisible=function(t){return this.visible!==t&&(this.visible=t,!0)},e.prototype.setZLevel=function(t){return this.zLevel!==t&&(t===Me&&(this.originalZLevel=this.zLevel),this.zLevel=t,!0)},e.prototype.setModeSensitivity=function(t){return this.modeSensitivity!==t&&(this.modeSensitivity=t,!0)},e.prototype.setMode=function(t){return t!==this.mode&&(this.mode=t,!0)},e.prototype.setOnDrawStartCallback=function(t){return this.onDrawStart!==t&&(this.onDrawStart=t,!0)},e.prototype.setOnDrawingCallback=function(t){return this.onDrawing!==t&&(this.onDrawing=t,!0)},e.prototype.setOnDrawEndCallback=function(t){return this.onDrawEnd!==t&&(this.onDrawEnd=t,!0)},e.prototype.setOnClickCallback=function(t){return this.onClick!==t&&(this.onClick=t,!0)},e.prototype.setOnRightClickCallback=function(t){return this.onRightClick!==t&&(this.onRightClick=t,!0)},e.prototype.setOnPressedMoveStartCallback=function(t){return this.onPressedMoveStart!==t&&(this.onPressedMoveStart=t,!0)},e.prototype.setOnPressedMovingCallback=function(t){return this.onPressedMoving!==t&&(this.onPressedMoving=t,!0)},e.prototype.setOnPressedMoveEndCallback=function(t){return this.onPressedMoveEnd!==t&&(this.onPressedMoveEnd=t,!0)},e.prototype.setOnMouseEnterCallback=function(t){return this.onMouseEnter!==t&&(this.onMouseEnter=t,!0)},e.prototype.setOnMouseMoveCallback=function(t){return this.onMouseMove!==t&&(this.onMouseMove=t,!0)},e.prototype.setOnMouseLeaveCallback=function(t){return this.onMouseLeave!==t&&(this.onMouseLeave=t,!0)},e.prototype.setOnRemovedCallback=function(t){return this.onRemoved!==t&&(this.onRemoved=t,!0)},e.prototype.setOnSelectedCallback=function(t){return this.onSelected!==t&&(this.onSelected=t,!0)},e.prototype.setOnDeselectedCallback=function(t){return this.onDeselected!==t&&(this.onDeselected=t,!0)},e.prototype.nextStep=function(){this.currentStep===this.totalStep-1?this.currentStep=-1:this.currentStep++},e.prototype.forceComplete=function(){this.currentStep=-1},e.prototype.isDrawing=function(){return-1!==this.currentStep},e.prototype.isStart=function(){return 1===this.currentStep},e.prototype.eventMoveForDrawing=function(t){var e,i=this.currentStep-1,n={};void 0!==t.timestamp&&(n.timestamp=t.timestamp),void 0!==t.dataIndex&&(n.dataIndex=t.dataIndex),void 0!==t.value&&(n.value=t.value),this.points[i]=n,null===(e=this.performEventMoveForDrawing)||void 0===e||e.call(this,{currentStep:this.currentStep,mode:this.mode,points:this.points,performPointIndex:i,performPoint:n})},e.prototype.eventPressedPointMove=function(t,e){var i;void 0!==t.dataIndex&&(this.points[e].dataIndex=t.dataIndex,this.points[e].timestamp=t.timestamp),void 0!==t.value&&(this.points[e].value=t.value),null===(i=this.performEventPressedMove)||void 0===i||i.call(this,{currentStep:this.currentStep,points:this.points,mode:this.mode,performPointIndex:e,performPoint:this.points[e]})},e.prototype.startPressedMove=function(t){this._prevPressedPoint=o({},t),this._prevPressedPoints=J(this.points)},e.prototype.eventPressedOtherMove=function(t,e){var i,n;null!==this._prevPressedPoint&&(void 0!==t.dataIndex&&void 0!==this._prevPressedPoint.dataIndex&&(i=t.dataIndex-this._prevPressedPoint.dataIndex),void 0!==t.value&&void 0!==this._prevPressedPoint.value&&(n=B(t.value,this._prevPressedPoint.value)),this.points=this._prevPressedPoints.map((function(t){var r;void 0===t.dataIndex&&void 0!==t.timestamp&&(t.dataIndex=e.timestampToDataIndex(t.timestamp));var a=o({},t);return void 0!==i&&void 0!==t.dataIndex&&(a.dataIndex=t.dataIndex+i,a.timestamp=null!==(r=e.dataIndexToTimestamp(a.dataIndex))&&void 0!==r?r:void 0),void 0!==n&&void 0!==t.value&&(a.value=R(t.value,n)),a})))},e.extend=function(t){return function(e){function i(){return e.call(this,t)||this}return n(i,e),i}(e)},e}();function Be(t,e){return Math.sqrt(Math.pow(t.x+e.x,2)+Math.pow(t.y+e.y,2))}function Le(t){var e=Be(t[0],t[1]),i=e+Be(t[1],t[2]),n=[t[2].x-t[0].x,t[2].y-t[0].y];return[{x:t[1].x-.5*n[0]*e/i,y:t[1].y-.5*n[1]*e/i},{x:t[1].x+.5*n[0]*e/i,y:t[1].y+.5*n[1]*e/i}]}function Fe(t,e){var i=e.coordinates;if(i.length>1)for(var n=1;i.length>n;n++){var o=i[n-1],r=i[n];if(o.x===r.x&&4>Math.abs(o.y-t.y)+Math.abs(r.y-t.y)-Math.abs(o.y-r.y)&&2>Math.abs(t.x-o.x))return!0;var a=Ne(o,r);if(a){var s=Oe(a,t),l=Math.abs(s-t.y);if(4>Math.abs(o.x-t.x)+Math.abs(r.x-t.x)-Math.abs(o.x-r.x)&&4>l*l/(a[0]*a[0]+1))return!0}}return!1}function Oe(t,e){return null!=t?e.x*t[0]+t[1]:e.y}function Re(t,e,i){return Oe(Ne(t,e),i)}function Ne(t,e){var i=t.x-e.x;if(0!==i){var n=(t.y-e.y)/i;return[n,t.y-n*t.x]}return null}function Ve(e,i,n){var o=i.coordinates,r=o.length;if(r>1){var a=n.style,s=void 0===a?t.LineType.Solid:a,l=n.smooth,u=n.size,c=n.color,h=void 0===c?"currentColor":c,d=n.dashedValue,p=void 0===d?[2,2]:d;if(e.lineWidth=void 0===u?1:u,e.strokeStyle=h,e.setLineDash(s===t.LineType.Dashed?p:[]),e.beginPath(),e.moveTo(o[0].x,o[0].y),null!=l&&l){for(var v=[],g=1;r-1>g;g++)v=v.concat(Le([o[g-1],o[g],o[g+1]]));e.quadraticCurveTo(v[0].x,v[0].y,o[1].x,o[1].y);for(var f=2;r-1>f;f++)e.bezierCurveTo(v[2*(f-2)+1].x,v[2*(f-2)+1].y,v[2*(f-1)].x,v[2*(f-1)].y,o[f].x,o[f].y);e.quadraticCurveTo(v[2*(f-2)+1].x,v[2*(f-2)+1].y,o[f].x,o[f].y)}else for(f=1;o.length>f;f++)e.lineTo(o[f].x,o[f].y);e.stroke(),e.closePath()}}var ze={name:"line",checkEventOn:Fe,draw:function(t,e,i){Ve(t,e,i)}};function We(t,e,i){var n=null!=i?i:0,o=[];if(t.length>1)if(t[0].x===t[1].x){var r=e.height;if(o.push({coordinates:[{x:t[0].x,y:0},{x:t[0].x,y:r}]}),t.length>2){o.push({coordinates:[{x:t[2].x,y:0},{x:t[2].x,y:r}]});for(var a=B(t[0].x,t[2].x),s=0;n>s;s++){var l=F(a,s+1);o.push({coordinates:[{x:Number(R(t[0].x,l)),y:0},{x:Number(R(t[0].x,l)),y:r}]})}}}else{var u=e.width,c=Ne(t[0],t[1]),h=c[0],d=c[1];if(o.push({coordinates:[{x:0,y:Number(R(F(0,h),d))},{x:u,y:Number(R(F(u,h),d))}]}),t.length>2){var p=B(t[2].y,F(h,t[2].x));for(o.push({coordinates:[{x:0,y:Number(R(F(0,h),p))},{x:u,y:Number(R(F(u,h),p))}]}),a=B(d,p),s=0;n>s;s++){var v=R(d,F(a,s+1));o.push({coordinates:[{x:0,y:Number(R(F(0,h),v))},{x:u,y:Number(R(F(u,h),v))}]})}}}return o}function Ye(t,e){var i;return t.length>1?(i=t[0].x===t[1].x&&t[0].y!==t[1].y?t[1].y>t[0].y?{x:t[0].x,y:e.height}:{x:t[0].x,y:0}:t[0].x>t[1].x?{x:0,y:Re(t[0],t[1],{x:0,y:t[0].y})}:{x:e.width,y:Re(t[0],t[1],{x:e.width,y:t[0].y})},{coordinates:[t[0],i]}):[]}var He={name:"simpleAnnotation",totalStep:2,createPointFigures:function(t){var e,i,n=t.overlay,o=t.coordinates;it(n.extendData)&&(i=Q(n.extendData)?n.extendData(n):null!==(e=n.extendData)&&void 0!==e?e:"");var r=o[0].x,a=o[0].y-6,s=a-50,l=s-5;return[{type:"line",attrs:{coordinates:[{x:r,y:a},{x:r,y:s}]},ignoreEvent:!0},{type:"polygon",attrs:{coordinates:[{x:r,y:s},{x:r-4,y:l},{x:r+4,y:l}]},ignoreEvent:!0},{type:"rectText",attrs:{x:r,y:l,text:null!=i?i:"",align:"center",baseline:"bottom"},ignoreEvent:!0}]}},je={name:"simpleTag",totalStep:2,createPointFigures:function(t){var e=t.coordinates;return{type:"line",attrs:{coordinates:[{x:0,y:e[0].y},{x:t.bounding.width,y:e[0].y}]},ignoreEvent:!0}},createYAxisFigures:function(t){var e,i,n,o,r,a=t.overlay,s=t.coordinates,l=t.bounding,u=t.yAxis,c=t.precision;return null!==(e=null==u?void 0:u.isFromZero())&&void 0!==e&&e?(n="left",o=0):(n="right",o=l.width),it(a.extendData)&&(r=Q(a.extendData)?a.extendData(a):null!==(i=a.extendData)&&void 0!==i?i:""),it(r)||void 0===a.points[0].value||(r=ut(a.points[0].value,c.price)),{type:"rectText",attrs:{x:o,y:s[0].y,text:null!=r?r:"",align:n,baseline:"middle"}}}},Xe={};function Ke(t){Xe[t.name]=Ae.extend(t)}function qe(t){var e;return null!==(e=Xe[t])&&void 0!==e?e:null}[{name:"fibonacciLine",totalStep:3,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,createPointFigures:function(t){var e=t.coordinates,i=t.precision,n=t.overlay.points;if(e.length>0){var o=[],r=[],a=t.bounding.width;if(e.length>1&&void 0!==n[0].value&&void 0!==n[1].value){var s=e[0].y-e[1].y,l=B(n[0].value,n[1].value);[1,.786,.618,.5,.382,.236,0].forEach((function(t){var u,c=Number(R(e[1].y,F(s,t))),h=wt(W(R(null!==(u=n[1].value)&&void 0!==u?u:0,F(l,t)),i.price));o.push({coordinates:[{x:0,y:c},{x:a,y:c}]}),r.push({x:0,y:c,text:"".concat(h," (").concat(Ct((100*t).toFixed(1)),")"),baseline:"bottom"})}))}return[{type:"line",attrs:o},{type:"text",isCheckEvent:!1,attrs:r}]}return[]}},{name:"horizontalRayLine",totalStep:3,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,createPointFigures:function(t){var e=t.coordinates,i={x:0,y:e[0].y};return void 0!==e[1]&&e[1].x>e[0].x&&(i.x=t.bounding.width),[{type:"line",attrs:{coordinates:[e[0],i]}}]},performEventPressedMove:function(t){var e=t.points,i=t.performPoint;e[0].value=i.value,e[1].value=i.value},performEventMoveForDrawing:function(t){2===t.currentStep&&(t.points[0].value=t.performPoint.value)}},{name:"horizontalSegment",totalStep:3,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,createPointFigures:function(t){var e=t.coordinates,i=[];return 2===e.length&&i.push({coordinates:e}),[{type:"line",attrs:i}]},performEventPressedMove:function(t){var e=t.points,i=t.performPoint;e[0].value=i.value,e[1].value=i.value},performEventMoveForDrawing:function(t){2===t.currentStep&&(t.points[0].value=t.performPoint.value)}},{name:"horizontalStraightLine",totalStep:2,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,createPointFigures:function(t){var e=t.coordinates;return[{type:"line",attrs:{coordinates:[{x:0,y:e[0].y},{x:t.bounding.width,y:e[0].y}]}}]}},{name:"parallelStraightLine",totalStep:4,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,createPointFigures:function(t){return[{type:"line",attrs:We(t.coordinates,t.bounding)}]}},{name:"priceChannelLine",totalStep:4,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,createPointFigures:function(t){return[{type:"line",attrs:We(t.coordinates,t.bounding,1)}]}},{name:"priceLine",totalStep:2,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,createPointFigures:function(t){var e=t.coordinates,i=t.overlay.points[0].value;return[{type:"line",attrs:{coordinates:[e[0],{x:t.bounding.width,y:e[0].y}]}},{type:"text",ignoreEvent:!0,attrs:{x:e[0].x,y:e[0].y,text:wt(W(void 0===i?0:i,t.precision.price)),baseline:"bottom"}}]}},{name:"rayLine",totalStep:3,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,createPointFigures:function(t){return[{type:"line",attrs:Ye(t.coordinates,t.bounding)}]}},{name:"segment",totalStep:3,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,createPointFigures:function(t){var e=t.coordinates;return 2===e.length?[{type:"line",attrs:{coordinates:e}}]:[]}},{name:"straightLine",totalStep:3,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,createPointFigures:function(t){var e=t.coordinates,i=t.bounding;return 2===e.length?e[0].x===e[1].x?[{type:"line",attrs:{coordinates:[{x:e[0].x,y:0},{x:e[0].x,y:i.height}]}}]:[{type:"line",attrs:{coordinates:[{x:0,y:Re(e[0],e[1],{x:0,y:e[0].y})},{x:i.width,y:Re(e[0],e[1],{x:i.width,y:e[0].y})}]}}]:[]}},{name:"verticalRayLine",totalStep:3,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,createPointFigures:function(t){var e=t.coordinates;if(2===e.length){var i={x:e[0].x,y:0};return e[1].y>e[0].y&&(i.y=t.bounding.height),[{type:"line",attrs:{coordinates:[e[0],i]}}]}return[]},performEventPressedMove:function(t){var e=t.points,i=t.performPoint;e[0].timestamp=i.timestamp,e[0].dataIndex=i.dataIndex,e[1].timestamp=i.timestamp,e[1].dataIndex=i.dataIndex},performEventMoveForDrawing:function(t){var e=t.points,i=t.performPoint;2===t.currentStep&&(e[0].timestamp=i.timestamp,e[0].dataIndex=i.dataIndex)}},{name:"verticalSegment",totalStep:3,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,createPointFigures:function(t){var e=t.coordinates;return 2===e.length?[{type:"line",attrs:{coordinates:e}}]:[]},performEventPressedMove:function(t){var e=t.points,i=t.performPoint;e[0].timestamp=i.timestamp,e[0].dataIndex=i.dataIndex,e[1].timestamp=i.timestamp,e[1].dataIndex=i.dataIndex},performEventMoveForDrawing:function(t){var e=t.points,i=t.performPoint;2===t.currentStep&&(e[0].timestamp=i.timestamp,e[0].dataIndex=i.dataIndex)}},{name:"verticalStraightLine",totalStep:2,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,createPointFigures:function(t){var e=t.coordinates;return[{type:"line",attrs:{coordinates:[{x:e[0].x,y:0},{x:e[0].x,y:t.bounding.height}]}}]}},He,je].forEach((function(t){Xe[t.name]=Ae.extend(t)}));var Ue=function(){function t(){this._children=[],this._callbacks=new Map}return t.prototype.registerEvent=function(t,e){return this._callbacks.set(t,e),this},t.prototype.onEvent=function(t,e,i){var n=this._callbacks.get(t);return!(void 0===n||!this.checkEventOn(e))&&n(e,i)},t.prototype.checkEventOn=function(t){var e,i;try{for(var n=l(this._children),o=n.next();!o.done;o=n.next())if(o.value.checkEventOn(t))return!0}catch(t){e={error:t}}finally{try{o&&!o.done&&(i=n.return)&&i.call(n)}finally{if(e)throw e.error}}return!1},t.prototype.dispatchEvent=function(t,e,i){var n=this._children.length-1;if(n>-1)for(var o=n;o>-1;o--)if(this._children[o].dispatchEvent(t,e,i))return!0;return this.onEvent(t,e,i)},t.prototype.addChild=function(t){return this._children.push(t),this},t.prototype.clear=function(){this._children=[]},t}(),Ze="main",Ge="xAxis",Je="yAxis",$e="separator",Qe=function(t){function e(e,i){var n=t.call(this)||this;return n._bounding=Dt(),n._pane=i,n._init(e),n}return n(e,t),e.prototype._init=function(t){if(this._container=Bt("div",this.getContainerStyle()),this.insertBefore()){var e=t.lastChild;null!==e?t.insertBefore(this._container,e):t.appendChild(this._container)}else t.appendChild(this._container)},e.prototype.setBounding=function(t){return G(this._bounding,t),this},e.prototype.getContainer=function(){return this._container},e.prototype.getBounding=function(){return this._bounding},e.prototype.getPane=function(){return this._pane},e.prototype.update=function(t){this.updateImp(t,this._container,this._bounding)},e.prototype.insertBefore=function(){return!1},e}(Ue),ti=function(e){function i(t,i){var n,o,r=e.call(this,t,i)||this;return r._dragFlag=!1,r._dragStartY=0,r._active=!1,r._topPaneHeight=0,r._currentPaneHeight=0,r._pressedMouseMoveEvent=(n=r._pressedTouchMouseMoveEvent,20,o=0,function(){var t=Date.now();t-o>20&&(n.apply(this,arguments),o=t)}),r._moveDom=Bt("div",{width:"100%",height:"".concat(7,"px"),margin:"0",padding:"0",position:"absolute",top:"-3px",zIndex:"20",boxSizing:"border-box"}),r.getContainer().appendChild(r._moveDom),r.registerEvent("touchStartEvent",r._mouseDownEvent.bind(r)).registerEvent("touchMoveEvent",r._pressedMouseMoveEvent.bind(r)).registerEvent("touchEndEvent",r._mouseUpEvent.bind(r)).registerEvent("mouseDownEvent",r._mouseDownEvent.bind(r)).registerEvent("mouseUpEvent",r._mouseUpEvent.bind(r)).registerEvent("pressedMouseMoveEvent",r._pressedMouseMoveEvent.bind(r)).registerEvent("mouseEnterEvent",r._mouseEnterEvent.bind(r)).registerEvent("mouseLeaveEvent",r._mouseLeaveEvent.bind(r)),r}return n(i,e),i.prototype.getName=function(){return $e},i.prototype.checkEventOn=function(){return!0},i.prototype._mouseDownEvent=function(t){var e,i;this._dragFlag=!0,this._dragStartY=t.pageY;var n=this.getPane();return this._topPaneHeight=null!==(i=null===(e=n.getTopPane())||void 0===e?void 0:e.getBounding().height)&&void 0!==i?i:0,this._currentPaneHeight=n.getBounding().height,!0},i.prototype._mouseUpEvent=function(){return this._dragFlag=!1,this._mouseLeaveEvent()},i.prototype._pressedTouchMouseMoveEvent=function(e){var i=e.pageY-this._dragStartY,n=this.getPane(),o=n.getTopPane(),r=0>i;if(null!==o&&n.getOptions().dragEnabled){var a=void 0,s=void 0,l=void 0,u=void 0;r?(a=o,s=n,l=this._topPaneHeight,u=this._currentPaneHeight):(a=n,s=o,l=this._currentPaneHeight,u=this._topPaneHeight);var c=a.getOptions().minHeight;if(l>c){var h=Math.max(l-Math.abs(i),c),d=l-h;a.setBounding({height:h}),s.setBounding({height:u+d});var p=n.getChart();p.getChartStore().getActionStore().execute(t.ActionType.OnPaneDrag,{paneId:n.getId}),p.adjustPaneViewport(!0,!0,!0,!0,!0)}}return!0},i.prototype._mouseEnterEvent=function(){var t=this.getPane();if(t.getOptions().dragEnabled){this._active=!0;var e=t.getChart().getStyles().separator;return this.getContainer().style.cursor="ns-resize",this._moveDom.style.background=e.activeBackgroundColor,!0}return!1},i.prototype._mouseLeaveEvent=function(){return!this._dragFlag&&(this._active=!1,this.getContainer().style.cursor="",this._moveDom.style.background="",!0)},i.prototype.getContainerStyle=function(){return{margin:"0",padding:"0",position:"relative",boxSizing:"border-box"}},i.prototype.insertBefore=function(){return!0},i.prototype.updateImp=function(t,e,i){if(4===t||2===t){var n=this.getPane().getChart().getStyles().separator;this._moveDom.style.top="".concat(-Math.floor((7-n.size)/2),"px"),this._moveDom.style.height="".concat(7,"px");var o=n.fill;e.style.backgroundColor=this._active?n.activeColor:n.color,e.style.height="".concat(n.size,"px"),e.style.marginLeft="".concat(o?0:i.left,"px"),e.style.width=o?"100%":"".concat(i.width,"px")}},i.prototype.getImage=function(){var t=this.getPane().getChart().getStyles().separator,e=this.getContainer().offsetWidth,i=t.size,n=Bt("canvas",{width:"".concat(e,"px"),height:"".concat(i,"px"),boxSizing:"border-box"}),o=n.getContext("2d"),r=Lt(n);return n.width=e*r,n.height=i*r,o.scale(r,r),o.fillStyle=t.color,o.fillRect(this.getBounding().left,0,e,i),n},i}(Qe),ei="candle_pane",ii="indcator_pane_",ni="xaxis_pane",oi=function(){function t(t,e,i,n,o){this._yAxisWidget=null,this._separatorWidget=null,this._axis=this.createAxisComponent(),this._bounding=Dt(),this._options={minHeight:30,dragEnabled:!0,gap:{top:.2,bottom:.1}},this._chart=e,this._id=i,this._topPane=null!=n?n:null,this._bottomPane=null!=o?o:null,this._init(t)}return t.prototype._init=function(t){this._container=t,this._seriesContiainer=Bt("div",{width:"100%",margin:"0",padding:"0",position:"relative",overflow:"hidden",boxSizing:"border-box"}),this._separatorWidget=this.createSeparatorWidget(t);var e=t.lastChild;null!==e?t.insertBefore(this._seriesContiainer,e):t.appendChild(this._seriesContiainer),this._mainWidget=this.createMainWidget(this._seriesContiainer),this._yAxisWidget=this.creatYAxisWidget(this._seriesContiainer)},t.prototype.getContainer=function(){return this._seriesContiainer},t.prototype.getId=function(){return this._id},t.prototype.setOptions=function(t){return G(this._options,t),this},t.prototype.getOptions=function(){return this._options},t.prototype.getChart=function(){return this._chart},t.prototype.getAxisComponent=function(){return this._axis},t.prototype.setBounding=function(t,e,i){var n,r,a;G(this._bounding,t);var s=0;if(null!==this._separatorWidget){s=this._chart.getStyles().separator.size;var l=o(o({},t),{height:7});void 0!==t.top&&(l.top=t.top-Math.floor((7-s)/2)),this._separatorWidget.setBounding(l)}var u={};return void 0!==t.height&&(u.height=t.height-s),void 0!==t.top&&(u.top=t.top+s),this._mainWidget.setBounding(u),null===(n=this._yAxisWidget)||void 0===n||n.setBounding(u),void 0!==e&&(this._mainWidget.setBounding(e),null===(r=this._separatorWidget)||void 0===r||r.setBounding(e)),void 0!==i&&(null===(a=this._yAxisWidget)||void 0===a||a.setBounding(i)),this},t.prototype.getTopPane=function(){return this._topPane},t.prototype.setTopPane=function(t){return this._topPane=t,this},t.prototype.getBottomPane=function(){return this._bottomPane},t.prototype.setBottomPane=function(t){return this._bottomPane=t,this},t.prototype.getBounding=function(){return this._bounding},t.prototype.getMainWidget=function(){return this._mainWidget},t.prototype.getYAxisWidget=function(){return this._yAxisWidget},t.prototype.getSeparatorWidget=function(){return this._separatorWidget},t.prototype.update=function(t){var e,i;this._bounding.width!==this._seriesContiainer.offsetWidth&&(this._seriesContiainer.style.width="".concat(this._bounding.width,"px"));var n=this._mainWidget.getBounding().height;n!==this._seriesContiainer.offsetHeight&&(this._seriesContiainer.style.height="".concat(n,"px"));var o=null!=t?t:3;this._mainWidget.update(o),null===(e=this._yAxisWidget)||void 0===e||e.update(o),null===(i=this._separatorWidget)||void 0===i||i.update(o)},t.prototype.getImage=function(t){var e=this._bounding,i=e.width,n=e.height,o=Bt("canvas",{width:"".concat(i,"px"),height:"".concat(n,"px"),boxSizing:"border-box"}),r=o.getContext("2d"),a=Lt(o);o.width=i*a,o.height=n*a,r.scale(a,a);var s=0;if(null!=this._separatorWidget){var l=this.getChart().getStyles().separator.size;s=l,r.drawImage(this._separatorWidget.getImage(),0,0,i,l)}var u=this._mainWidget.getBounding();if(r.drawImage(this._mainWidget.getImage(t),u.left,s,u.width,u.height),null!==this._yAxisWidget){var c=this._yAxisWidget.getBounding();r.drawImage(this._yAxisWidget.getImage(t),c.left,s,c.width,c.height)}return o},t.prototype.destroy=function(){var t,e,i;null===(e=null===(t=this._mainWidget)||void 0===t?void 0:t.destroy)||void 0===e||e.call(t),null===(i=this._yAxisWidget)||void 0===i||i.destroy(),this._container.removeChild(this._seriesContiainer),null!==this._separatorWidget&&this._container.removeChild(this._separatorWidget.getContainer())},t.prototype.createSeparatorWidget=function(t){return null},t.prototype.creatYAxisWidget=function(t){return null},t}(),ri=function(){function t(t){this._instances=new Map,this._progressInstanceInfo=null,this._pressedInstanceInfo={paneId:"",instance:null,figureType:0,figureKey:"",figureIndex:-1,attrsIndex:-1},this._hoverInstanceInfo={paneId:"",instance:null,figureType:0,figureKey:"",figureIndex:-1,attrsIndex:-1},this._clickInstanceInfo={paneId:"",instance:null,figureType:0,figureKey:"",figureIndex:-1,attrsIndex:-1},this._chartStore=t}return t.prototype._overrideInstance=function(t,e){var i=e.id,n=e.groupId,o=e.points,r=e.styles,a=e.lock,s=e.visible,l=e.mode,u=e.extendData,c=e.zLevel,h=e.modeSensitivity,d=e.onDrawStart,p=e.onDrawing,v=e.onDrawEnd,g=e.onClick,f=e.onRightClick,y=e.onPressedMoveStart,m=e.onPressedMoving,x=e.onPressedMoveEnd,_=e.onMouseEnter,w=e.onMouseMove,b=e.onMouseLeave,C=e.onRemoved,S=e.onSelected,T=e.onDeselected,E=!1,I=!1;return void 0!==i&&t.setId(i),void 0!==n&&t.setGroupId(n),void 0!==o&&t.setPoints(o)&&(E=!0),void 0!==r&&t.setStyles(r)&&(E=!0),void 0!==a&&t.setLock(a),void 0!==s&&t.setVisible(s)&&(E=!0),void 0!==c&&t.setZLevel(c)&&(E=!0,I=!0),void 0!==h&&t.setModeSensitivity(h),void 0!==l&&t.setMode(l),void 0!==u&&t.setExtendData(u)&&(E=!0),void 0!==d&&t.setOnDrawStartCallback(d),void 0!==p&&t.setOnDrawingCallback(p),void 0!==v&&t.setOnDrawEndCallback(v),void 0!==g&&t.setOnClickCallback(g),void 0!==f&&t.setOnRightClickCallback(f),void 0!==y&&t.setOnPressedMoveStartCallback(y),void 0!==m&&t.setOnPressedMovingCallback(m),void 0!==x&&t.setOnPressedMoveEndCallback(x),void 0!==_&&t.setOnMouseEnterCallback(_),void 0!==w&&t.setOnMouseMoveCallback(w),void 0!==b&&t.setOnMouseLeaveCallback(b),void 0!==C&&t.setOnRemovedCallback(C),void 0!==S&&t.setOnSelectedCallback(S),void 0!==T&&t.setOnDeselectedCallback(T),[E,I]},t.prototype.getInstanceById=function(t){var e,i;try{for(var n=l(this._instances),o=n.next();!o.done;o=n.next()){var r=o.value[1].find((function(e){return e.id===t}));if(void 0!==r)return r}}catch(t){e={error:t}}finally{try{o&&!o.done&&(i=n.return)&&i.call(n)}finally{if(e)throw e.error}}return null!==this._progressInstanceInfo&&this._progressInstanceInfo.instance.id===t?this._progressInstanceInfo.instance:null},t.prototype._sort=function(t){var e;void 0!==t?null===(e=this._instances.get(t))||void 0===e||e.sort((function(t,e){return t.zLevel-e.zLevel})):this._instances.forEach((function(t){t.sort((function(t,e){return t.zLevel-e.zLevel}))}))},t.prototype.addInstance=function(t,e,i){var n,o,r,a,s=null!==(n=t.id)&&void 0!==n?n:At("overlay_");if(null===this.getInstanceById(s)){var l=new(qe(t.name)),u=null!==(o=t.groupId)&&void 0!==o?o:s;return t.id=s,t.groupId=u,this._overrideInstance(l,t),l.isDrawing()?this._progressInstanceInfo={paneId:e,instance:l,appointPaneFlag:i}:(this._instances.has(e)||this._instances.set(e,[]),null===(r=this._instances.get(e))||void 0===r||r.push(l)),null===(a=l.onDrawStart)||void 0===a||a.call(l,{overlay:l}),this._chartStore.getChart().updatePane(1,e),s}return null},t.prototype.getProgressInstanceInfo=function(){return this._progressInstanceInfo},t.prototype.progressInstanceComplete=function(){var t;if(null!==this._progressInstanceInfo){var e=this._progressInstanceInfo,i=e.instance,n=e.paneId;i.isDrawing()||(this._instances.has(n)||this._instances.set(n,[]),null===(t=this._instances.get(n))||void 0===t||t.push(i),this._sort(n),this._progressInstanceInfo=null)}},t.prototype.updateProgressInstanceInfo=function(t,e){null!==this._progressInstanceInfo&&(void 0!==e&&e&&(this._progressInstanceInfo.appointPaneFlag=e),this._progressInstanceInfo.paneId=t)},t.prototype.getInstances=function(t){var e;if(void 0===t){var i=[];return this._instances.forEach((function(t){i=i.concat(t)})),i}return null!==(e=this._instances.get(t))&&void 0!==e?e:[]},t.prototype.override=function(t){var e=this,i=t.id,n=t.groupId,o=t.name,r=!1,a=!1,s=function(i){var n=e._overrideInstance(i,t);n[0]&&(r=!0),n[1]&&(a=!0)};if(void 0!==i){var l=this.getInstanceById(i);null!==l&&s(l)}else if(this._instances.forEach((function(t){t.forEach((function(t){(void 0!==o&&t.name===o||void 0!==n&&t.groupId===n||void 0===o&&void 0===n)&&s(t)}))})),null!==this._progressInstanceInfo){var u=this._progressInstanceInfo.instance;(void 0!==o&&u.name===o||void 0!==n&&u.groupId===n||void 0===o&&void 0===n)&&s(u)}a&&this._sort(),r&&this._chartStore.getChart().updatePane(1)},t.prototype.removeInstance=function(t){var e,i,n,o=function(t,e){if(void 0!==t.id){if(e.id!==t.id)return!1}else if(void 0!==t.groupId){if(e.groupId!==t.groupId)return!1}else if(void 0!==t.name&&e.name!==t.name)return!1;return!0},r=[];if(null!==this._progressInstanceInfo){var a=this._progressInstanceInfo.instance;(void 0===t||void 0!==t&&o(t,a))&&(r.push(this._progressInstanceInfo.paneId),null===(n=a.onRemoved)||void 0===n||n.call(a,{overlay:a}),this._progressInstanceInfo=null)}if(void 0!==t){var s=new Map,u=function(e){var i=e[1].filter((function(i){var n;return!o(t,i)||(r.includes(e[0])||r.push(e[0]),null===(n=i.onRemoved)||void 0===n||n.call(i,{overlay:i}),!1)}));i.length>0&&s.set(e[0],i)};try{for(var c=l(this._instances),h=c.next();!h.done;h=c.next())u(h.value)}catch(t){e={error:t}}finally{try{h&&!h.done&&(i=c.return)&&i.call(c)}finally{if(e)throw e.error}}this._instances=s}else this._instances.forEach((function(t,e){r.push(e),t.forEach((function(t){var e;null===(e=t.onRemoved)||void 0===e||e.call(t,{overlay:t})}))})),this._instances.clear();if(r.length>0){var d=this._chartStore.getChart();r.forEach((function(t){d.updatePane(1,t)})),d.updatePane(1,ni)}},t.prototype.setPressedInstanceInfo=function(t){this._pressedInstanceInfo=t},t.prototype.getPressedInstanceInfo=function(){return this._pressedInstanceInfo},t.prototype.setHoverInstanceInfo=function(t,e){var i,n,r,a,s,l=this._hoverInstanceInfo,u=l.instance,c=l.figureKey,h=l.figureIndex;(null==u?void 0:u.id)===(null===(i=t.instance)||void 0===i?void 0:i.id)&&l.figureType===t.figureType&&h===t.figureIndex||(this._hoverInstanceInfo=t,(null==u?void 0:u.id)!==(null===(n=t.instance)||void 0===n?void 0:n.id)&&(null===(r=null==u?void 0:u.onMouseLeave)||void 0===r||r.call(u,o({overlay:u,figureKey:c,figureIndex:h},e)),null==u||u.setZLevel(null==u?void 0:u.originalZLevel),null!==t.instance&&(null===(s=(a=t.instance).onMouseEnter)||void 0===s||s.call(a,o({overlay:t.instance,figureKey:t.figureKey,figureIndex:t.figureIndex},e)),t.instance.setZLevel(Me),this._sort())))},t.prototype.getHoverInstanceInfo=function(){return this._hoverInstanceInfo},t.prototype.setClickInstanceInfo=function(t,e){var i,n,r,a,s,l,u,c,h,d=this._clickInstanceInfo,p=d.paneId,v=d.instance,g=d.figureType,f=d.figureKey,y=d.figureIndex;if(null!==(n=null===(i=t.instance)||void 0===i?void 0:i.isDrawing())&&void 0!==n&&n||null===(a=null===(r=t.instance)||void 0===r?void 0:r.onClick)||void 0===a||a.call(r,o({overlay:t.instance,figureKey:t.figureKey,figureIndex:t.figureIndex},e)),((null==v?void 0:v.id)!==(null===(s=t.instance)||void 0===s?void 0:s.id)||g!==t.figureType||y!==t.figureIndex)&&(this._clickInstanceInfo=t,(null==v?void 0:v.id)!==(null===(l=t.instance)||void 0===l?void 0:l.id))){null===(u=null==v?void 0:v.onDeselected)||void 0===u||u.call(v,o({overlay:v,figureKey:f,figureIndex:y},e)),null===(h=null===(c=t.instance)||void 0===c?void 0:c.onSelected)||void 0===h||h.call(c,o({overlay:t.instance,figureKey:t.figureKey,figureIndex:t.figureIndex},e));var m=this._chartStore.getChart();m.updatePane(1,t.paneId),p!==t.paneId&&m.updatePane(1,p),m.updatePane(1,ni)}},t.prototype.getClickInstanceInfo=function(){return this._clickInstanceInfo},t.prototype.isEmpty=function(){return 0===this._instances.size&&null===this._progressInstanceInfo},t.prototype.isDrawing=function(){var t,e;return null!==this._progressInstanceInfo&&null!==(e=null===(t=this._progressInstanceInfo)||void 0===t?void 0:t.instance.isDrawing())&&void 0!==e&&e},t}(),ai=function(){function t(){this._actions=new Map}return t.prototype.execute=function(t,e){var i;null===(i=this._actions.get(t))||void 0===i||i.execute(e)},t.prototype.subscribe=function(t,e){var i;this._actions.has(t)||this._actions.set(t,new kt),null===(i=this._actions.get(t))||void 0===i||i.subscribe(e)},t.prototype.unsubscribe=function(t,e){var i=this._actions.get(t);void 0!==i&&(i.unsubscribe(e),i.isEmpty()&&this._actions.delete(t))},t.prototype.has=function(t){var e=this._actions.get(t);return void 0!==e&&!e.isEmpty()},t}(),si={light:{grid:{horizontal:{color:"#EDEDED"},vertical:{color:"#EDEDED"}},candle:{priceMark:{high:{text:{color:"#76808F"},line:{color:"#76808F"}},low:{text:{color:"#76808F"},line:{color:"#76808F"}}},tooltip:{rect:{color:"#FEFEFE",borderColor:"#F2F3F5"},text:{color:"#76808F"}}},indicator:{tooltip:{text:{color:"#76808F"}}},xAxis:{axisLine:{color:"#DDDDDD"},tickText:{color:"#76808F"},tickLine:{color:"#DDDDDD"}},yAxis:{axisLine:{color:"#DDDDDD"},tickText:{color:"#76808F"},tickLine:{color:"#DDDDDD"}},separator:{color:"#DDDDDD"},crosshair:{horizontal:{line:{color:"#76808F"},text:{borderColor:"#686D76",backgroundColor:"#686D76"}},vertical:{line:{color:"#76808F"},text:{borderColor:"#686D76",backgroundColor:"#686D76"}}}},dark:{grid:{horizontal:{color:"#292929"},vertical:{color:"#292929"}},candle:{priceMark:{high:{text:{color:"#929AA5"},line:{color:"#929AA5"}},low:{text:{color:"#929AA5"},line:{color:"#929AA5"}}},tooltip:{rect:{color:"rgba(10, 10, 10, .6)",borderColor:"rgba(10, 10, 10, .6)"},text:{color:"#929AA5"}}},indicator:{tooltip:{text:{color:"#929AA5"}}},xAxis:{axisLine:{color:"#333333"},tickText:{color:"#929AA5"},tickLine:{color:"#333333"}},yAxis:{axisLine:{color:"#333333"},tickText:{color:"#929AA5"},tickLine:{color:"#333333"}},separator:{color:"#333333"},crosshair:{horizontal:{line:{color:"#929AA5"},text:{borderColor:"#373a40",backgroundColor:"#373a40"}},vertical:{line:{color:"#929AA5"},text:{borderColor:"#373a40",backgroundColor:"#373a40"}}}}};function li(t){var e;return null!==(e=si[t])&&void 0!==e?e:null}var ui=function(){function e(e,i){this._styles={grid:{show:!0,horizontal:{show:!0,size:1,color:"#EDEDED",style:t.LineType.Dashed,dashedValue:[2,2]},vertical:{show:!0,size:1,color:"#EDEDED",style:t.LineType.Dashed,dashedValue:[2,2]}},candle:{type:t.CandleType.CandleSolid,bar:{upColor:"#26A69A",downColor:"#EF5350",noChangeColor:"#999999"},area:{lineSize:2,lineColor:"#1677FF",value:"close",backgroundColor:[{offset:0,color:"rgba(22, 119, 255, 0.01)"},{offset:1,color:"rgba(22, 119, 255, 0.2)"}]},priceMark:{show:!0,high:{show:!0,text:{show:!0,color:"#76808F",offset:5,size:10,family:"Helvetica Neue",weight:"normal"},line:{show:!1,style:t.LineType.Dashed,color:"#76808F",size:1,dashedValue:[2,2]}},low:{show:!0,text:{show:!0,color:"#76808F",offset:5,size:10,family:"Helvetica Neue",weight:"normal"},line:{show:!1,style:t.LineType.Dashed,color:"#76808F",size:1,dashedValue:[2,2]}},last:{show:!0,upColor:"#26A69A",downColor:"#EF5350",noChangeColor:"#888888",line:{show:!0,style:t.LineType.Dashed,dashedValue:[4,4],size:1},text:{show:!0,style:t.PolygonType.Fill,size:12,paddingLeft:4,paddingTop:4,paddingRight:4,paddingBottom:4,borderStyle:t.LineType.Solid,borderSize:1,borderDashedValue:[2,2],color:"#FFFFFF",family:"Helvetica Neue",weight:"normal",borderRadius:2}}},tooltip:{showRule:t.TooltipShowRule.Always,showType:t.TooltipShowType.Standard,custom:null,defaultValue:"n/a",rect:{paddingLeft:0,paddingRight:0,paddingTop:0,paddingBottom:8,offsetLeft:10,offsetTop:8,offsetRight:10,borderRadius:4,borderSize:1,borderColor:"#F2F3F5",color:"#FEFEFE"},text:{size:12,family:"Helvetica Neue",weight:"normal",color:"#76808F",marginLeft:10,marginTop:8,marginRight:6,marginBottom:0},icons:[]}},indicator:{ohlc:{upColor:"rgba(38, 166, 154, .65)",downColor:"rgba(239, 83, 80, .65)",noChangeColor:"#888888"},bars:[{style:t.PolygonType.Fill,borderStyle:t.LineType.Solid,borderSize:1,borderDashedValue:[2,2],upColor:"rgba(38, 166, 154, .65)",downColor:"rgba(239, 83, 80, .65)",noChangeColor:"#888888"}],lines:[{style:t.LineType.Solid,smooth:!1,size:1,dashedValue:[2,2],color:"#FF9600"},{style:t.LineType.Solid,smooth:!1,size:1,dashedValue:[2,2],color:"#9D65C9"},{style:t.LineType.Solid,smooth:!1,size:1,dashedValue:[2,2],color:"#1677FF"},{style:t.LineType.Solid,smooth:!1,size:1,dashedValue:[2,2],color:"#E11D74"},{style:t.LineType.Solid,smooth:!1,size:1,dashedValue:[2,2],color:"#01C5C4"}],circles:[{style:t.PolygonType.Fill,borderStyle:t.LineType.Solid,borderSize:1,borderDashedValue:[2,2],upColor:"rgba(38, 166, 154, .65)",downColor:"rgba(239, 83, 80, .65)",noChangeColor:"#888888"}],lastValueMark:{show:!1,text:{show:!1,style:t.PolygonType.Fill,color:"#FFFFFF",size:12,family:"Helvetica Neue",weight:"normal",borderStyle:t.LineType.Solid,borderSize:1,borderDashedValue:[2,2],paddingLeft:4,paddingTop:4,paddingRight:4,paddingBottom:4,borderRadius:2}},tooltip:{showRule:t.TooltipShowRule.Always,showType:t.TooltipShowType.Standard,showName:!0,showParams:!0,defaultValue:"n/a",text:{size:12,family:"Helvetica Neue",weight:"normal",color:"#76808F",marginLeft:10,marginTop:8,marginRight:6,marginBottom:0},icons:[]},polygons:[{style:t.PolygonType.Fill,borderStyle:t.LineType.Solid,borderSize:1,borderDashedValue:[2,2],upColor:"rgba(67,160,71,0.1)",downColor:"rgba(242,54,69,0.1)",noChangeColor:"#888888"}]},xAxis:{show:!0,size:"auto",axisLine:{show:!0,color:"#DDDDDD",size:1},tickText:{show:!0,color:"#76808F",size:12,family:"Helvetica Neue",weight:"normal",marginStart:4,marginEnd:4},tickLine:{show:!0,size:1,length:3,color:"#DDDDDD"}},yAxis:{show:!0,size:"auto",type:t.YAxisType.Normal,position:t.YAxisPosition.Right,inside:!1,reverse:!1,minWidth:56,axisLine:{show:!0,color:"#DDDDDD",size:1},tickText:{show:!0,color:"#76808F",size:12,family:"Helvetica Neue",weight:"normal",marginStart:4,marginEnd:4},tickLine:{show:!0,size:1,length:3,color:"#DDDDDD"}},separator:{size:1,color:"#DDDDDD",fill:!0,activeColor:"#DDDDDD",activeBackgroundColor:"rgba(33, 150, 243, 0.08)"},crosshair:{show:!0,horizontal:{show:!0,line:{show:!0,style:t.LineType.Dashed,dashedValue:[4,2],size:1,color:"#76808F"},text:{show:!0,style:t.PolygonType.Fill,color:"#FFFFFF",size:12,family:"Helvetica Neue",weight:"normal",borderStyle:t.LineType.Solid,borderDashedValue:[2,2],borderSize:1,borderColor:"#686D76",borderRadius:2,paddingLeft:4,paddingRight:4,paddingTop:4,paddingBottom:4,backgroundColor:"#686D76"}},vertical:{show:!0,line:{show:!0,style:t.LineType.Dashed,dashedValue:[4,2],size:1,color:"#76808F"},text:{show:!0,style:t.PolygonType.Fill,color:"#FFFFFF",size:12,family:"Helvetica Neue",weight:"normal",borderStyle:t.LineType.Solid,borderDashedValue:[2,2],borderSize:1,borderRadius:2,borderColor:"#686D76",paddingLeft:4,paddingRight:4,paddingTop:4,paddingBottom:4,backgroundColor:"#686D76"}}},overlay:{point:{color:"#1677FF",borderColor:"rgba(22, 119, 255, 0.35)",borderSize:1,radius:5,activeColor:"#1677FF",activeBorderColor:"rgba(22, 119, 255, 0.35)",activeBorderSize:3,activeRadius:5},line:{style:t.LineType.Solid,smooth:!1,color:"#1677FF",size:1,dashedValue:[2,2]},rect:{style:t.PolygonType.Fill,color:"rgba(22, 119, 255, 0.25)",borderColor:"#1677FF",borderSize:1,borderRadius:0,borderStyle:t.LineType.Solid,borderDashedValue:[2,2]},polygon:{style:t.PolygonType.Fill,color:"#1677FF",borderColor:"#1677FF",borderSize:1,borderStyle:t.LineType.Solid,borderDashedValue:[2,2]},circle:{style:t.PolygonType.Fill,color:"rgba(22, 119, 255, 0.25)",borderColor:"#1677FF",borderSize:1,borderStyle:t.LineType.Solid,borderDashedValue:[2,2]},arc:{style:t.LineType.Solid,color:"#1677FF",size:1,dashedValue:[2,2]},text:{color:"#1677FF",size:12,family:"Helvetica Neue",weight:"normal"},rectText:{style:t.PolygonType.Fill,color:"#FFFFFF",size:12,family:"Helvetica Neue",weight:"normal",borderStyle:t.LineType.Solid,borderDashedValue:[2,2],borderSize:1,borderRadius:2,borderColor:"#1677FF",paddingLeft:4,paddingRight:4,paddingTop:4,paddingBottom:4,backgroundColor:"#1677FF"}},logo:{height:void 0,width:void 0,left:void 0,bottom:void 0},depth:{bidLineSize:1,bidLineColor:"#16b979",bidBackgroundColor:[{offset:0,color:"rgba(22, 185, 121, 0.05)"},{offset:1,color:"rgba(22, 185, 121, 0.3)"}],askLineSize:1,askLineColor:"#EF5350",askBackgroundColor:[{offset:0,color:"rgba(238, 44, 90, 0.05)"},{offset:1,color:"rgba(238, 44, 90, 0.3)"}]}},this._customApi={formatDate:lt,formatBigNumber:ct,formatNumber:wt,formatPercent:Ct},this._locale="en-US",this._interval=void 0,this._showCountDown=!0,this._logo=void 0,this._showPriceFluctuationRatio=!1,this._showPlusBtn=!1,this._precision={price:2,volume:0},this._dataList=[],this._timeScaleStore=new Vt(this),this._indicatorStore=new Ie(this),this._overlayStore=new ri(this),this._crosshairStore=new De(this),this._tooltipStore=new Pe,this._actionStore=new ai,this._visibleDataList=[],this._chart=e,this.setOptions(i)}return e.prototype.adjustVisibleDataList=function(){this._visibleDataList=[];for(var t=this._timeScaleStore.getVisibleRange(),e=t.realTo,i=t.realFrom;e>i;i++){var n=this._dataList[i],o=this._timeScaleStore.dataIndexToCoordinate(i);this._visibleDataList.push({dataIndex:i,x:o,data:n})}},e.prototype.setOptions=function(t){var e=this;if(void 0!==t){var i=t.locale,n=t.timezone,o=t.styles,r=t.customApi,a=t.interval,s=t.showCountDown,l=t.logo,u=t.showPlusBtn,c=t.tooltipOptions,h=t.showPriceFluctuationRatio;if(void 0!==i&&(this._locale=i),void 0!==n&&this._timeScaleStore.setTimezone(n),void 0!==o&&(ot(o)?G(this._styles,li(o)):G(this._styles,o)),void 0!==r&&(G(this._customApi,r),r.formatNumber&&(wt=r.formatNumber),r.formatPercent&&(Ct=r.formatPercent),r.cutFloatDecimal&&(St=r.cutFloatDecimal)),void 0!==a&&(this._interval=a),void 0!==s&&(this._showCountDown=s),void 0!==h&&(this._showPriceFluctuationRatio=h),void 0!==u&&(this._showPlusBtn=u),void 0!==l){var d=new Image;d.src=l,d.onload=function(){e._logo=d}}void 0!==c&&(this._tooltipOptions=c)}return this},e.prototype.getStyles=function(){return this._styles},e.prototype.getLocale=function(){return this._locale},e.prototype.getInterval=function(){return this._interval},e.prototype.getShowCountDown=function(){return this._showCountDown},e.prototype.getShowPriceFluctuationRatio=function(){return this._showPriceFluctuationRatio},e.prototype.getLogo=function(){return this._logo},e.prototype.getShowPlusBtn=function(){return this._showPlusBtn},e.prototype.getCustomApi=function(){return this._customApi},e.prototype.getPrecision=function(){return this._precision},e.prototype.setPrecision=function(t){return this._precision=t,this._indicatorStore.setSeriesPrecision(t),this},e.prototype.getDataList=function(){return this._dataList},e.prototype.getVisibleDataList=function(t){return void 0===t&&(t=!1),t?this._visibleDataList:this._visibleDataList.filter((function(t){return t.data}))},e.prototype.addData=function(e,i,n){if($(e)){this._timeScaleStore.setLoading(!1),this._timeScaleStore.setMore(null==n||n);var o=0===this._dataList.length;this._dataList=e.concat(this._dataList),o&&this._timeScaleStore.resetOffsetRightDistance(),this._timeScaleStore.adjustVisibleRange(),this._actionStore.execute(t.ActionType.OnBarLengthChange,this._dataList.length)}else if(this._dataList.length>i)this._dataList[i]=e,this.adjustVisibleDataList();else{this._dataList.push(e);var r=this._timeScaleStore.getOffsetRightBarCount();0>r&&this._timeScaleStore.setOffsetRightBarCount(--r),this._timeScaleStore.adjustVisibleRange(),this._actionStore.execute(t.ActionType.OnBarLengthChange,this._dataList.length)}this._crosshairStore.recalculate(!0)},e.prototype.clearDataList=function(){this._dataList=[],this._visibleDataList=[],this._timeScaleStore.clear()},e.prototype.getTimeScaleStore=function(){return this._timeScaleStore},e.prototype.getIndicatorStore=function(){return this._indicatorStore},e.prototype.getOverlayStore=function(){return this._overlayStore},e.prototype.getCrosshairStore=function(){return this._crosshairStore},e.prototype.getTooltipStore=function(){return this._tooltipStore},e.prototype.getActionStore=function(){return this._actionStore},e.prototype.getChart=function(){return this._chart},e.prototype.getTooltipOptions=function(){return this._tooltipOptions},e}();function ci(t){return null==window.requestAnimationFrame?window.setTimeout(t,20):window.requestAnimationFrame(t)}function hi(t){null==window.cancelAnimationFrame&&window.clearTimeout(t),window.cancelAnimationFrame(t)}var di=-1,pi=function(t){function e(e,i){var n=t.call(this,e,i)||this;n._mainRequestAnimationId=di,n._overlayRequestAnimationId=di;var o=n.getContainer();return n._mainCanvas=Bt("canvas",{position:"absolute",top:"0",left:"0",zIndex:"2",boxSizing:"border-box"}),n._mainCtx=n._mainCanvas.getContext("2d"),n._overlayCanvas=Bt("canvas",{position:"absolute",top:"0",left:"0",zIndex:"2",boxSizing:"border-box"}),n._overlayCtx=n._overlayCanvas.getContext("2d"),o.appendChild(n._mainCanvas),o.appendChild(n._overlayCanvas),n}return n(e,t),e.prototype.getContainerStyle=function(){return{margin:"0",padding:"0",position:"absolute",top:"0",overflow:"hidden",boxSizing:"border-box"}},e.prototype._optimalUpdateMain=function(t,e){var i=this;this._mainRequestAnimationId!==di&&(hi(this._mainRequestAnimationId),this._mainRequestAnimationId=di),this._mainRequestAnimationId=ci((function(){if(t!==i._mainCanvas.offsetWidth||e!==i._mainCanvas.offsetHeight){i._mainCtx.clearRect(0,0,i._mainCanvas.offsetWidth,i._mainCanvas.offsetHeight);var n=Lt(i._mainCanvas),o=Math.floor(t*n),r=Math.floor(e*n);i._mainCanvas.style.width="".concat(t,"px"),i._mainCanvas.style.height="".concat(e,"px"),i._mainCanvas.width=o,i._mainCanvas.height=r,i._mainCtx.scale(n,n)}else i._mainCtx.clearRect(0,0,i._mainCanvas.offsetWidth,i._mainCanvas.offsetHeight);i.updateMain(i._mainCtx)}))},e.prototype._optimalUpdateOverlay=function(t,e){var i=this;this._overlayRequestAnimationId!==di&&(hi(this._overlayRequestAnimationId),this._overlayRequestAnimationId=di),this._overlayRequestAnimationId=ci((function(){if(t!==i._overlayCanvas.offsetWidth||e!==i._overlayCanvas.offsetHeight){i._overlayCtx.clearRect(0,0,i._overlayCanvas.offsetWidth,i._overlayCanvas.offsetHeight);var n=Lt(i._overlayCanvas),o=Math.floor(t*n),r=Math.floor(e*n);i._overlayCanvas.style.width="".concat(t,"px"),i._overlayCanvas.style.height="".concat(e,"px"),i._overlayCanvas.width=o,i._overlayCanvas.height=r,i._overlayCtx.scale(n,n)}else i._overlayCtx.clearRect(0,0,i._overlayCanvas.offsetWidth,i._overlayCanvas.offsetHeight);i.updateOverlay(i._overlayCtx)}))},e.prototype.updateImp=function(t,e,i){var n=i.width,o=i.height;e.style.left="".concat(i.left,"px");var r=t;switch(n===e.offsetWidth&&o===e.offsetHeight||(e.style.width="".concat(n,"px"),e.style.height="".concat(o,"px"),r=3),r){case 0:this._optimalUpdateMain(n,o);break;case 1:this._optimalUpdateOverlay(n,o);break;case 3:case 4:this._optimalUpdateMain(n,o),this._optimalUpdateOverlay(n,o)}},e.prototype.getImage=function(t){var e=this.getBounding(),i=e.width,n=e.height,o=Bt("canvas",{width:"".concat(i,"px"),height:"".concat(n,"px"),boxSizing:"border-box"}),r=o.getContext("2d"),a=Lt(o);return o.width=i*a,o.height=n*a,r.scale(a,a),r.drawImage(this._mainCanvas,0,0,i,n),t&&r.drawImage(this._overlayCanvas,0,0,i,n),o},e.prototype.destroy=function(){},e}(Qe),vi=function(t){function e(e){var i=t.call(this)||this;return i.attrs=e.attrs,i.styles=e.styles,i}return n(e,t),e.prototype.checkEventOn=function(t){return this.checkEventOnImp(t,this.attrs,this.styles)},e.prototype.draw=function(t){this.drawImp(t,this.attrs,this.styles)},e.extend=function(t){var i=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return n(i,e),i.prototype.checkEventOnImp=function(e,i,n){return t.checkEventOn(e,i,n)},i.prototype.drawImp=function(e,i,n){t.draw(e,i,n)},i}(e);return i},e}(Ue);function gi(t,e){var i=t.x-e.x,n=t.y-e.y,o=e.r;return!(i*i+n*n>o*o)}function fi(e,i,n){var o=i.x,r=i.y,a=i.r,s=n.style,l=void 0===s?t.PolygonType.Fill:s,u=n.color,c=n.borderSize,h=void 0===c?1:c,d=n.borderColor,p=void 0===d?"currentColor":d,v=n.borderStyle,g=void 0===v?t.LineType.Solid:v,f=n.borderDashedValue,y=void 0===f?[2,2]:f;l!==t.PolygonType.Fill&&n.style!==t.PolygonType.StrokeFill||(e.fillStyle=void 0===u?"currentColor":u,e.beginPath(),e.arc(o,r,a,0,2*Math.PI),e.closePath(),e.fill()),l!==t.PolygonType.Stroke&&n.style!==t.PolygonType.StrokeFill||(e.strokeStyle=p,e.lineWidth=h,e.setLineDash(g===t.LineType.Dashed?y:[]),e.beginPath(),e.arc(o,r,a,0,2*Math.PI),e.closePath(),e.stroke())}var yi={name:"circle",checkEventOn:gi,draw:function(t,e,i){fi(t,e,i)}};function mi(t,e){for(var i=!1,n=e.coordinates,o=0,r=n.length-1;n.length>o;r=o++)n[o].y>t.y!=n[r].y>t.y&&(n[r].x-n[o].x)*(t.y-n[o].y)/(n[r].y-n[o].y)+n[o].x>t.x&&(i=!i);return i}function xi(e,i,n){var o=i.coordinates,r=n.style,a=void 0===r?t.PolygonType.Fill:r,s=n.color,l=n.borderSize,u=void 0===l?1:l,c=n.borderColor,h=void 0===c?"currentColor":c,d=n.borderStyle,p=void 0===d?t.LineType.Solid:d,v=n.borderDashedValue,g=void 0===v?[2,2]:v;if(a===t.PolygonType.Fill||n.style===t.PolygonType.StrokeFill){e.fillStyle=void 0===s?"currentColor":s,e.beginPath(),e.moveTo(o[0].x,o[0].y);for(var f=1;o.length>f;f++)e.lineTo(o[f].x,o[f].y);e.closePath(),e.fill()}if(a===t.PolygonType.Stroke||n.style===t.PolygonType.StrokeFill){for(e.strokeStyle=h,e.lineWidth=u,e.setLineDash(p===t.LineType.Dashed?g:[]),e.beginPath(),e.moveTo(o[0].x,o[0].y),f=1;o.length>f;f++)e.lineTo(o[f].x,o[f].y);e.closePath(),e.stroke()}}var _i={name:"polygon",checkEventOn:mi,draw:function(t,e,i){xi(t,e,i)}};function wi(t,e){return!(e.x>t.x||t.x>e.x+e.width||e.y>t.y||t.y>e.y+e.height)}function bi(e,i,n){var o=i.x,r=i.y,a=i.width,s=i.height,l=n.style,u=void 0===l?t.PolygonType.Fill:l,c=n.color,h=n.borderSize,d=void 0===h?1:h,p=n.borderColor,v=void 0===p?"currentColor":p,g=n.borderStyle,f=void 0===g?t.LineType.Solid:g,y=n.borderRadius,m=void 0===y?0:y,x=n.borderDashedValue,_=void 0===x?[2,2]:x;u!==t.PolygonType.Fill&&n.style!==t.PolygonType.StrokeFill||(e.fillStyle=void 0===c?"currentColor":c,e.beginPath(),e.moveTo(o+m,r),e.arcTo(o+a,r,o+a,r+s,m),e.arcTo(o+a,r+s,o,r+s,m),e.arcTo(o,r+s,o,r,m),e.arcTo(o,r,o+a,r,m),e.closePath(),e.fill()),u!==t.PolygonType.Stroke&&n.style!==t.PolygonType.StrokeFill||(e.strokeStyle=v,e.lineWidth=d,e.setLineDash(f===t.LineType.Dashed?_:[]),e.beginPath(),e.moveTo(o+m,r),e.arcTo(o+a,r,o+a,r+s,m),e.arcTo(o+a,r+s,o,r+s,m),e.arcTo(o,r+s,o,r,m),e.arcTo(o,r,o+a,r,m),e.closePath(),e.stroke())}var Ci={name:"rect",checkEventOn:wi,draw:function(t,e,i){bi(t,e,i)}};function Si(t,e,i){var n=e.size,o=void 0===n?12:n,r=e.paddingLeft,a=void 0===r?0:r,s=e.paddingTop,l=void 0===s?0:s,u=e.paddingRight,c=void 0===u?0:u,h=e.paddingBottom,d=void 0===h?0:h,p=t.x,v=t.y,g=t.align,f=t.baseline,y=void 0===f?"top":f;i=null!=i?i:o*t.text.length;var m,x,_=o;switch(void 0===g?"left":g){case"left":case"start":m=p;break;case"right":case"end":m=p-c-i-a;break;default:m=p-i/2-a}switch(y){case"top":case"hanging":x=v;break;case"bottom":case"ideographic":case"alphabetic":x=v-_-l-d;break;default:x=v-_/2-l}return{x:m,y:x,width:a+i+c,height:l+_+d}}function Ti(t,e,i){var n=Si(e,i),o=n.x,r=n.y;return!(o>t.x||t.x>o+n.width||r>t.y||t.y>r+n.height)}function Ei(t,e,i){var n=e.x,o=e.y,r=e.text,a=e.align,s=e.baseline,l=void 0===s?"top":s,u=i.color,c=void 0===u?"currentColor":u,h=i.size,d=void 0===h?12:h,p=i.family,v=i.weight;t.textAlign=void 0===a?"left":a,t.textBaseline=l,t.font=Ft(d,v,p),t.fillStyle=c,t.fillText(r,n,o)}var Ii={name:"text",checkEventOn:function(t,e,i){return Ti(t,e,i)},draw:function(t,e,i){Ei(t,e,i)}};function Di(t,e,i){var n=e.text,r=i.size,a=i.paddingLeft,s=void 0===a?0:a,l=i.paddingTop,u=void 0===l?0:l,c=i.textWidth;t.font=Ft(void 0===r?12:r,i.weight,i.family);var h=Si(e,i,null!=c?c:t.measureText(n).width);bi(t,h,o(o({},i),{color:i.backgroundColor})),Ei(t,{x:h.x+s,y:h.y+u,text:n,align:"left",baseline:"top"},i)}var Pi={name:"rectText",checkEventOn:function(t,e,i){return Ti(t,e,i)},draw:function(t,e,i){Di(t,e,i)}};function ki(t,e){if(Math.abs(Math.sqrt((h=(u=t).x-(c=e).x)*h+(d=u.y-c.y)*d)-e.r)<2){var i=e.r,n=e.startAngle,o=e.endAngle,r=i*Math.cos(n)+e.x,a=i*Math.sin(n)+e.y,s=i*Math.cos(o)+e.x,l=i*Math.sin(o)+e.y;return!(t.x>Math.max(r,s)+2||Math.min(r,s)-2>t.x||t.y>Math.max(a,l)+2||Math.min(a,l)-2>t.y)}var u,c,h,d;return!1}function Mi(e,i,n){var o=i.x,r=i.y,a=i.r,s=i.startAngle,l=i.endAngle,u=n.style,c=void 0===u?t.LineType.Solid:u,h=n.size,d=n.color,p=void 0===d?"currentColor":d,v=n.dashedValue,g=void 0===v?[2,2]:v;e.lineWidth=void 0===h?1:h,e.strokeStyle=p,e.setLineDash(c===t.LineType.Dashed?g:[]),e.beginPath(),e.arc(o,r,a,s,l),e.stroke(),e.closePath()}var Ai={name:"arc",checkEventOn:ki,draw:function(t,e,i){Mi(t,e,i)}},Bi={};function Li(t){var e;return null!==(e=Bi[t])&&void 0!==e?e:null}[yi,ze,_i,Ci,Ii,Pi,Ai].forEach((function(t){Bi[t.name]=vi.extend(t)}));var Fi=function(t){function e(e){var i=t.call(this)||this;return i._widget=e,i}return n(e,t),e.prototype.getWidget=function(){return this._widget},e.prototype.createFigure=function(t,e,i,n){var o=function(t){var e;return null!==(e=Bi[t])&&void 0!==e?e:null}(t);if(null!==o){var r=new o({name:t,attrs:e,styles:i});if(void 0!==n){for(var a in n)n.hasOwnProperty(a)&&r.registerEvent(a,n[a]);this.addChild(r)}return r}return null},e.prototype.draw=function(t){this.clear(),this.drawImp(t)},e}(Ue),Oi=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.drawImp=function(t){var e,i=this,n=this.getWidget(),o=this.getWidget().getPane(),r=o.getChart(),a=n.getBounding(),s=r.getStyles().grid;if(s.show){t.save(),t.globalCompositeOperation="destination-over";var l=s.horizontal;l.show&&o.getAxisComponent().getTicks().forEach((function(e){var n;null===(n=i.createFigure("line",{coordinates:[{x:0,y:e.coord},{x:a.width,y:e.coord}]},l))||void 0===n||n.draw(t)}));var u=s.vertical;u.show&&(null===(e=r.getPaneById(ni))||void 0===e?void 0:e.getAxisComponent()).getTicks().forEach((function(e){var n;null===(n=i.createFigure("line",{coordinates:[{x:e.coord,y:0},{x:e.coord,y:a.height}]},u))||void 0===n||n.draw(t)})),t.restore()}},e}(Fi),Ri=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.eachChildren=function(t,e){void 0===e&&(e=!1);var i=this.getWidget().getPane().getChart().getChartStore(),n=i.getVisibleDataList(e),o=i.getTimeScaleStore().getBarSpace();n.forEach((function(e,i){t(e,o,i)}))},e}(Fi),Ni=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i._boundCandleBarClickEvent=function(e){return function(){return i.getWidget().getPane().getChart().getChartStore().getActionStore().execute(t.ActionType.OnCandleBarClick,e),!1}},i}return n(i,e),i.prototype.drawImp=function(t){var e=this,i=this.getWidget().getPane(),n=i.getId()===ei,o=i.getChart().getChartStore(),r=this.getCandleBarOptions(o);if(null!==r){var a=i.getAxisComponent();this.eachChildren((function(i,o){e._drawCandleBar(t,a,i,o,r,n)}))}},i.prototype.getCandleBarOptions=function(t){var e=t.getStyles().candle;return{type:e.type,styles:e.bar}},i.prototype._drawCandleBar=function(e,i,n,o,r,a){var s,l=this,u=n.data,c=n.x,h=u.open,d=u.high,p=u.low,v=u.close,g=o.halfGapBar,f=o.gapBar,y=r.type,m=r.styles;s=Y(v,h)?m.upColor:j(v,h)?m.downColor:m.noChangeColor;var x=i.convertToPixel(h),_=i.convertToPixel(v),w=[x,_,i.convertToPixel(d),i.convertToPixel(p)];w.sort((function(t,e){return t-e}));var b=Math.max(1,w[2]-w[1]),C=[];y!==t.CandleType.Ohlc?(C.push({name:"rect",attrs:{x:c-.5,y:w[0],width:1,height:w[1]-w[0]},styles:{color:s}}),y===t.CandleType.CandleStroke||y===t.CandleType.CandleUpStroke&&j(h,v)||y===t.CandleType.CandleDownStroke&&Y(h,v)?C.push({name:"rect",attrs:{x:c-g+.5,y:w[1],width:f-1,height:b},styles:{style:t.PolygonType.Stroke,borderColor:s}}):C.push({name:"rect",attrs:{x:c-g,y:w[1],width:f,height:b},styles:{color:s}}),C.push({name:"rect",attrs:{x:c-.5,y:w[2],width:1,height:w[3]-w[2]},styles:{color:s}})):C=[{name:"rect",attrs:{x:c-.5,y:w[0],width:1,height:w[3]-w[0]},styles:{color:s}},{name:"rect",attrs:{x:c-g,y:x,width:g,height:1},styles:{color:s}},{name:"rect",attrs:{x:c,y:_,width:g,height:1},styles:{color:s}}],C.forEach((function(t){var i,o,r=t.attrs,s=t.styles;a&&(o={mouseClickEvent:l._boundCandleBarClickEvent(n)}),null===(i=l.createFigure("rect",r,s,o))||void 0===i||i.draw(e)}))},i}(Ri),Vi=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return n(i,e),i.prototype.getCandleBarOptions=function(e){var i,n,o=this.getWidget().getPane();if(!o.getAxisComponent().isInCandle()){var r=e.getIndicatorStore().getInstances(o.getId());try{for(var a=l(r),s=a.next();!s.done;s=a.next()){var u=s.value[1];if(u.shouldOhlc&&u.visible){var c=u.styles,h=e.getStyles().indicator;return{type:t.CandleType.Ohlc,styles:{upColor:st(c,"ohlc.upColor",h.ohlc.upColor),downColor:st(c,"ohlc.downColor",h.ohlc.downColor),noChangeColor:st(c,"ohlc.noChangeColor",h.ohlc.noChangeColor)}}}}}catch(e){i={error:e}}finally{try{s&&!s.done&&(n=a.return)&&n.call(a)}finally{if(i)throw i.error}}}return null},i.prototype.drawImp=function(t){var i,n=this;e.prototype.drawImp.call(this,t);var o=this.getWidget(),r=o.getPane(),a=r.getChart(),s=o.getBounding(),l=null===(i=a.getPaneById(ni))||void 0===i?void 0:i.getAxisComponent(),u=r.getAxisComponent(),c=a.getChartStore(),h=c.getDataList(),d=c.getTimeScaleStore(),p=d.getVisibleRange(),v=c.getIndicatorStore().getInstances(r.getId()),g=c.getStyles().indicator;v.forEach((function(e){var i;if(e.visible){var o=!1;if(null!==e.draw&&(t.save(),o=null!==(i=e.draw({ctx:t,kLineDataList:h,indicator:e,visibleRange:p,bounding:s,barSpace:d.getBarSpace(),defaultStyles:g,xAxis:l,yAxis:u}))&&void 0!==i&&i,t.restore()),!o){var r=e.result;if(!(null==r?void 0:r.length))return;var a=[],c="dataIndex"in(r[0]||{});n.eachChildren((function(i,o){var s,d,p,v=o.halfGapBar,f=o.gapBar,y=i.dataIndex,m=i.x,x=c?r.findIndex((function(t){return t.dataIndex===y})):y;if(!c||x>=0){l.convertToPixel(y-1);var _=l.convertToPixel(y+1),w=null!==(s=r[x-1])&&void 0!==s?s:{},b=null!==(d=r[x])&&void 0!==d?d:{},S=null!==(p=r[x+1])&&void 0!==p?p:{},T={x:m},E={x:_};e.figures.forEach((function(t){var e=t.key,i=w[e];C(i)&&u.convertToPixel(i);var n=b[e];C(n)&&(T[e]=u.convertToPixel(n));var o=S[e];C(o)&&(E[e]=u.convertToPixel(o))})),zt(h,e,y,g,(function(e,i,o){var r,s,l,c,h,d,p,g;if(it(b[null!==(r=e.originalKey)&&void 0!==r?r:e.key])){var y=T[null!==(s=e.originalKey)&&void 0!==s?s:e.key],x=void 0;switch(e.type){case"polygon":var _=T[null!==(l=e.referenceKey)&&void 0!==l?l:e.key],w=y,C=E[null!==(c=e.referenceKey)&&void 0!==c?c:e.key],S=E[null!==(h=e.originalKey)&&void 0!==h?h:e.key];et(_)&&et(w)&&(x={coordinates:[{x:T.x,y:_},{x:T.x,y:w}]},et(C)&&et(S)&&(x.coordinates.push({x:E.x,y:S}),x.coordinates.push({x:E.x,y:C})));break;case"circle":x={x:m,y:y,r:v};break;case"bar":var I=null!==(d=e.baseValue)&&void 0!==d?d:u.getExtremum().min,D=u.convertToPixel(I),P=Math.abs(D-y);I!==b[e.key]&&(P=Math.max(1,P)),x={x:m-v,y:y>D?D:y,width:f,height:P};break;case"line":it(a[o])||(a[o]=[]),et(T[e.key])&&et(E[e.key])&&a[o].push({coordinates:[{x:T.x,y:T[e.key]},{x:E.x,y:E[e.key]}],styles:i})}var k=e.type;it(x)&&k&&"line"!==k&&"polygon"!==k?null===(p=n.createFigure("bar"===k?"rect":k,x,i))||void 0===p||p.draw(t):it(x)&&"polygon"===k&&(null===(g=n.createFigure(k,x,i))||void 0===g||g.draw(t))}}),c)}}),c),a.forEach((function(e){var i,o,r,a;if(e.length>1){for(var s=[{coordinates:[e[0].coordinates[0],e[0].coordinates[1]],styles:e[0].styles}],l=1;e.length>l;l++){var u=s[s.length-1],c=e[l],h=u.coordinates[u.coordinates.length-1];h.x===c.coordinates[0].x&&h.y===c.coordinates[0].y&&u.styles.style===c.styles.style&&u.styles.color===c.styles.color&&u.styles.size===c.styles.size&&u.styles.smooth===c.styles.smooth&&(null===(i=u.styles.dashedValue)||void 0===i?void 0:i[0])===(null===(o=c.styles.dashedValue)||void 0===o?void 0:o[0])&&(null===(r=u.styles.dashedValue)||void 0===r?void 0:r[1])===(null===(a=c.styles.dashedValue)||void 0===a?void 0:a[1])?u.coordinates.push(c.coordinates[1]):s.push({coordinates:[c.coordinates[0],c.coordinates[1]],styles:c.styles})}s.forEach((function(e){var i;null===(i=n.createFigure("line",{coordinates:e.coordinates},e.styles))||void 0===i||i.draw(t)}))}}))}}}))},i}(Ni),zi=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.drawImp=function(t){var e=this.getWidget(),i=e.getPane(),n=e.getBounding(),o=e.getPane().getChart().getChartStore();if(o.getCrosshairStore().getStatus()){var r=o.getCrosshairStore().get(),a=o.getStyles().crosshair;if(void 0!==r.paneId&&a.show){if(r.paneId===i.getId()){var s=r.y;this._drawLine(t,[{x:0,y:s},{x:n.width,y:s}],a.horizontal)}var l=r.realX;this._drawLine(t,[{x:l,y:0},{x:l,y:n.height}],a.vertical)}}},e.prototype._drawLine=function(t,e,i){var n;if(i.show){var o=i.line;o.show&&(null===(n=this.createFigure("line",{coordinates:e},o))||void 0===n||n.draw(t))}},e}(Fi),Wi=function(e){function i(i){var n=e.call(this,i)||this;return n._boundIconClickEvent=function(e,i){return function(){return n.getWidget().getPane().getChart().getChartStore().getActionStore().execute(t.ActionType.OnTooltipIconClick,o(o({},e),{iconId:i})),!0}},n._boundIconMouseMoveEvent=function(t,e){return function(){return n.getWidget().getPane().getChart().getChartStore().getTooltipStore().setActiveIconInfo(o(o({},t),{iconId:e})),!0}},n._initContainer(i.getContainer()),n._tooltipOptions=n.getWidget().getPane().getChart().getChartStore().getTooltipOptions(),n}return n(i,e),i.prototype.getTooltipOptions=function(){return this._tooltipOptions},i.prototype.getIndicatorTooltipContainer=function(){return this._indicatorTooltipContainer},i.prototype._initContainer=function(t){this._indicatorTooltipContainer=Bt("div",{position:"relative",width:"100%"}),this._indicatorTooltipContainer.className="origin-kline-tooltip-wrapper",this._indicatorTooltipContainer.addEventListener("mousemove",(function(t){var e,i;"none"!==(null===(i=null===(e=null==t?void 0:t.target)||void 0===e?void 0:e.dataset)||void 0===i?void 0:i.stopprop)&&t.stopPropagation()})),this._indicatorTooltipContainer.addEventListener("mousedown",(function(t){t.stopPropagation()})),t.appendChild(this._indicatorTooltipContainer)},i.prototype.drawImp=function(t){var e=this.getWidget(),i=e.getPane(),n=i.getChart().getChartStore(),o=n.getCrosshairStore().get();if(void 0!==o.kLineData){var r=e.getBounding(),a=n.getCustomApi(),s=n.getIndicatorStore().getInstances(i.getId()),l=n.getTooltipStore().getActiveIconInfo(),u=n.getStyles().indicator;this.drawIndicatorTooltip(t,i.getId(),n.getDataList(),o,l,s,a,r,u)}},i.prototype.destroy=function(){var t,e=null===(t=this.getTooltipOptions())||void 0===t?void 0:t.onDestroy;null==e||e(this._indicatorTooltipContainer)},i.prototype.drawIndicatorTooltip=function(t,e,i,n,o,r,a,s,l,c,h){var d=this,p=l.tooltip,v=0;if(this.isDrawTooltip(n,p)){var g=p.text,f=0,y=null!=c?c:0,m=0,x=this.getTooltipOptions();if(null==x?void 0:x.tooltipFn){var _=[];return h&&_.push({name:"last",values:h}),r.forEach((function(t){var e,o,r,s=d.getIndicatorTooltipData(i,n,t,a,l),u=s.name,c=s.values,h=c.findIndex((function(t){return t.title.text.indexOf("VOLUME:")>=0}));if("VOL"===t.name&&h>=0){var v=null!==(e=t.result)&&void 0!==e?e:[],g=c[h],f=(null!==(o=v[n.dataIndex])&&void 0!==o?o:{}).turnover;if(it(f)){f=ut(f,t.precision);var y=null===(r=null==a?void 0:a.indicatorTooltipFormatNumber)||void 0===r?void 0:r[t.name],m=null!=y?y:a.formatNumber;f=t.shouldFormatBigNumber?a.formatBigNumber(f,m):m(f)}c.splice(h+1,0,{title:{text:"TURNOVER: ",color:g.title.color},value:{text:null!=f?f:p.defaultValue,color:g.value.color}})}_.push({name:u,values:c})})),null==x?void 0:x.tooltipFn({ele:this._indicatorTooltipContainer,contentList:_})}r.forEach((function(r){var c=d.getIndicatorTooltipData(i,n,r,a,l),h=c.name,p=c.calcParamsText,x=c.values,_=h.length>0,w=x.length>0;if(_||w){var b=u(d.classifyTooltipIcons(c.icons),3),C=b[1],S=b[2],T=u(d.drawStandardTooltipIcons(t,s,{paneId:e,indicatorName:r.name,iconId:""},o,b[0],f,y,m),4);if(f=T[0],y=T[1],v+=T[3],m=T[2],_){var E=h;p.length>0&&(E="".concat(E).concat(p));var I=u(d.drawStandardTooltipLabels(t,s,[{title:{text:"",color:g.color},value:{text:E,color:g.color}}],f,y,m,g),4);f=I[0],y=I[1],v+=I[3],m=I[2]}var D=u(d.drawStandardTooltipIcons(t,s,{paneId:e,indicatorName:r.name,iconId:""},o,C,f,y,m),4);if(f=D[0],y=D[1],v+=D[3],m=D[2],w){var P=u(d.drawStandardTooltipLabels(t,s,x,f,y,m,g),4);f=P[0],y=P[1],v+=P[3],m=P[2]}var k=u(d.drawStandardTooltipIcons(t,s,{paneId:e,indicatorName:r.name,iconId:""},o,S,f,y,m),4);f=0,v+=k[3],y=k[1]+k[2],m=0}}))}return v},i.prototype.drawStandardTooltipIcons=function(t,e,i,n,o,r,a,s){var l=this,u=r,c=a,h=0,d=0,p=0;return o.length>0&&(o.forEach((function(e){var i=e.marginLeft,n=e.marginTop,o=e.marginRight,r=e.marginBottom,a=e.paddingLeft,s=e.paddingTop,l=e.paddingRight,u=e.paddingBottom,c=e.size,p=e.icon;t.font=Ft(c,"normal",e.fontFamily),h+=i+a+t.measureText(p).width+l+o,d=Math.max(d,n+s+c+u+r)})),u+h>e.width?(u=o[0].marginLeft,c+=s,p=d):p=Math.max(0,d-s),o.forEach((function(e){var o,r=e.marginRight,a=e.paddingLeft,s=e.paddingRight,h=e.icon,d=(null==n?void 0:n.paneId)===i.paneId&&(null==n?void 0:n.indicatorName)===i.indicatorName&&(null==n?void 0:n.iconId)===e.id;null===(o=l.createFigure("rectText",{text:h,x:u+=e.marginLeft,y:c+e.marginTop},{paddingLeft:a,paddingTop:e.paddingTop,paddingRight:s,paddingBottom:e.paddingBottom,color:d?e.activeColor:e.color,size:e.size,family:e.fontFamily,backgroundColor:d?e.activeBackgroundColor:e.backgroundColor},{mouseClickEvent:l._boundIconClickEvent(i,e.id),mouseMoveEvent:l._boundIconMouseMoveEvent(i,e.id)}))||void 0===o||o.draw(t),u+=a+t.measureText(h).width+s+r}))),[u,c,Math.max(s,d),p]},i.prototype.drawStandardTooltipLabels=function(t,e,i,n,o,r,a){var s=this,l=n,u=o,c=0,h=0,d=r;if(i.length>0){var p=a.marginLeft,v=a.marginTop,g=a.marginRight,f=a.marginBottom,y=a.size,m=a.family,x=a.weight;t.font=Ft(y,x,m),i.forEach((function(i){var n,o,r=i.title,a=i.value,_=t.measureText(r.text).width,w=t.measureText(a.text).width,b=y+v+f;l+p+(_+w)+g>e.width?(l=p,u+=b,h+=b):(l+=p,h+=Math.max(0,b-d)),d=c=Math.max(d,b),r.text.length>0&&(null===(n=s.createFigure("text",{x:l,y:u+v,text:r.text},{color:r.color,size:y,family:m,weight:x}))||void 0===n||n.draw(t),l+=_),null===(o=s.createFigure("text",{x:l,y:u+v,text:a.text},{color:a.color,size:y,family:m,weight:x}))||void 0===o||o.draw(t),l+=w+g}))}return[l,u,c,h]},i.prototype.isDrawTooltip=function(e,i){var n=i.showRule;return n===t.TooltipShowRule.Always||n===t.TooltipShowRule.FollowCross&&void 0!==e.paneId},i.prototype.getIndicatorTooltipData=function(t,e,i,n,o){var r,a,s,l=o.tooltip,u=l.showName?i.shortName:"",c="",h=i.calcParams;h.length>0&&l.showParams&&(c="(".concat(h.join(","),")"));var d={name:u,calcParamsText:c,values:[],icons:l.icons},p=e.dataIndex,v=p,g=null!==(r=i.result)&&void 0!==r?r:[],f="dataIndex"in(g[0]||{});f&&(p=e.realDataIndex,0>(v=g.findIndex((function(t){return t.dataIndex===p})))&&(v=0),p>g[g.length-1].dataIndex&&(v=g.length-1));var y=[];if(i.visible){var m=null!==(a=g[v])&&void 0!==a?a:{};zt(t,i,p,o,(function(t,e){var o;if(void 0!==t.title&&"polygon"!==t.type){var r=e.color,a=m[t.key];if(it(a)){a=ut(a,i.precision);var s=null===(o=null==n?void 0:n.indicatorTooltipFormatNumber)||void 0===o?void 0:o[i.name],u=null!=s?s:n.formatNumber;a=i.shouldFormatBigNumber?n.formatBigNumber(a,(function(t){return u(t,!1)})):u(a,!1)}var c=void 0;void 0!==t.title2&&void 0!==(null==t?void 0:t.calcParamsIndex)&&(c="".concat(t.title2,"(").concat(h[null==t?void 0:t.calcParamsIndex]+"","): ")),y.push({title:{text:t.title,textWithPeriod:c,color:r},value:{text:null!=a?a:l.defaultValue,color:r}})}}),f),d.values=y}if(null!==i.createTooltipDataSource){var x=this.getWidget(),_=x.getPane(),w=_.getChart().getChartStore(),b=i.createTooltipDataSource({kLineDataList:t,indicator:i,visibleRange:w.getTimeScaleStore().getVisibleRange(),bounding:x.getBounding(),crosshair:e,defaultStyles:o,xAxis:null===(s=_.getChart().getPaneById(ni))||void 0===s?void 0:s.getAxisComponent(),yAxis:_.getAxisComponent()}),C=b.name,S=b.calcParamsText,T=b.values,E=b.icons;if(void 0!==C&&l.showName&&(d.name=C),void 0!==S&&l.showParams&&(d.calcParamsText=S),void 0!==E&&(d.icons=E),void 0!==T&&i.visible){var I=[],D=o.tooltip.text.color;T.forEach((function(t){var e={text:"",color:D};tt(t.title)?e=t.title:e.text=t.title;var i={text:"",color:D};tt(t.value)?i=t.value:i.text=t.value,I.push({title:e,value:i})})),d.values=I}}return d},i.prototype.classifyTooltipIcons=function(e){var i=[],n=[],o=[];return e.forEach((function(e){switch(e.position){case t.TooltipIconPosition.Left:i.push(e);break;case t.TooltipIconPosition.Middle:n.push(e);break;case t.TooltipIconPosition.Right:o.push(e)}})),[i,n,o]},i}(Fi),Yi=function(e){function i(t){var i=e.call(this,t)||this;return i._initEvent(),i}return n(i,e),i.prototype.isOverlayViewInstance=function(){return!0},i.prototype._initEvent=function(){var t=this,e=this.getWidget().getPane(),i=e.getId(),n=e.getChart().getChartStore().getOverlayStore();this.registerEvent("mouseMoveEvent",(function(e){var r,a=n.getProgressInstanceInfo();if(null!==a){var s=a.instance,l=a.paneId;s.isStart()&&(n.updateProgressInstanceInfo(i),l=i);var u=s.points.length-1,c="".concat(ke,"point_").concat(u);return s.isDrawing()&&l===i&&(s.eventMoveForDrawing(t._coordinateToPoint(a.instance,e)),null===(r=s.onDrawing)||void 0===r||r.call(s,o({overlay:s,figureKey:c,figureIndex:u},e))),t._figureMouseMoveEvent(s,1,c,u,0)(e)}return n.setHoverInstanceInfo({paneId:i,instance:null,figureType:0,figureKey:"",figureIndex:-1,attrsIndex:-1},e),!1})).registerEvent("mouseClickEvent",(function(e){var r,a,s=n.getProgressInstanceInfo();if(null!==s){var l=s.instance,u=s.paneId;l.isStart()&&(n.updateProgressInstanceInfo(i,!0),u=i);var c=l.points.length-1,h="".concat(ke,"point_").concat(c);return l.isDrawing()&&u===i&&(l.eventMoveForDrawing(t._coordinateToPoint(l,e)),null===(r=l.onDrawing)||void 0===r||r.call(l,o({overlay:l,figureKey:h,figureIndex:c},e)),l.nextStep(),l.isDrawing()||(n.progressInstanceComplete(),null===(a=l.onDrawEnd)||void 0===a||a.call(l,o({overlay:l,figureKey:h,figureIndex:c},e)))),t._figureMouseClickEvent(l,1,h,c,0)(e)}return n.setClickInstanceInfo({paneId:i,instance:null,figureType:0,figureKey:"",figureIndex:-1,attrsIndex:-1},e),!1})).registerEvent("mouseDoubleClickEvent",(function(t){var e,r=n.getProgressInstanceInfo();if(null!==r){var a=r.instance,s=r.paneId;if(a.isDrawing()&&s===i&&(a.forceComplete(),!a.isDrawing())){n.progressInstanceComplete();var l=a.points.length-1,u="".concat(ke,"point_").concat(l);null===(e=a.onDrawEnd)||void 0===e||e.call(a,o({overlay:a,figureKey:u,figureIndex:l},t))}return!0}return!1})).registerEvent("mouseRightClickEvent",(function(e){var i=n.getProgressInstanceInfo();if(null!==i){var o=i.instance;if(o.isDrawing()){var r=o.points.length-1;return t._figureMouseRightClickEvent(o,1,"".concat(ke,"point_").concat(r),r,0)(e)}}return!1})).registerEvent("mouseUpEvent",(function(t){var e,r=n.getPressedInstanceInfo(),a=r.instance;return null!==a&&(null===(e=a.onPressedMoveEnd)||void 0===e||e.call(a,o({overlay:a,figureKey:r.figureKey,figureIndex:r.figureIndex},t))),n.setPressedInstanceInfo({paneId:i,instance:null,figureType:0,figureKey:"",figureIndex:-1,attrsIndex:-1}),!1})).registerEvent("pressedMouseMoveEvent",(function(e){var i,r,a=n.getPressedInstanceInfo(),s=a.instance,l=a.figureType,u=a.figureIndex;if(null!==s){if(!(s.lock||null!==(r=null===(i=s.onPressedMoving)||void 0===i?void 0:i.call(s,o({overlay:s,figureIndex:u,figureKey:a.figureKey},e)))&&void 0!==r&&r)){var c=t._coordinateToPoint(s,e);1===l?s.eventPressedPointMove(c,u):s.eventPressedOtherMove(c,t.getWidget().getPane().getChart().getChartStore().getTimeScaleStore())}return!0}return!1}))},i.prototype._createFigureEvents=function(t,e,i,n,o,r){var a;if(!t.isDrawing()){var s=[];if(void 0!==r&&(nt(r)?r&&(s=["mouseClickEvent","mouseRightClickEvent","tapEvent","mouseDownEvent","touchStartEvent","mouseMoveEvent","touchMoveEvent"]):s=r),0===s.length)return{mouseMoveEvent:this._figureMouseMoveEvent(t,e,i,n,o),mouseDownEvent:this._figureMouseDownEvent(t,e,i,n,o),mouseClickEvent:this._figureMouseClickEvent(t,e,i,n,o),mouseRightClickEvent:this._figureMouseRightClickEvent(t,e,i,n,o)};a={},s.includes("mouseMoveEvent")||s.includes("touchMoveEvent")||(a.mouseMoveEvent=this._figureMouseMoveEvent(t,e,i,n,o)),s.includes("mouseDownEvent")||s.includes("touchStartEvent")||(a.mouseDownEvent=this._figureMouseDownEvent(t,e,i,n,o)),s.includes("mouseClickEvent")||s.includes("tapEvent")||(a.mouseClickEvent=this._figureMouseClickEvent(t,e,i,n,o)),s.includes("mouseRightClickEvent")||(a.mouseRightClickEvent=this._figureMouseRightClickEvent(t,e,i,n,o))}return a},i.prototype._figureMouseMoveEvent=function(t,e,i,n,r){var a=this;return function(s){var l,u=a.getWidget().getPane(),c=u.getChart().getChartStore().getOverlayStore();return null===(l=t.onMouseMove)||void 0===l||l.call(t,o({overlay:t,figureIndex:n,figureKey:i},s)),c.setHoverInstanceInfo({paneId:u.getId(),instance:t,figureType:e,figureKey:i,figureIndex:n,attrsIndex:r},s),!0}},i.prototype._figureMouseDownEvent=function(t,e,i,n,r){var a=this;return function(s){var l,u=a.getWidget().getPane(),c=u.getId(),h=u.getChart().getChartStore().getOverlayStore();return t.startPressedMove(a._coordinateToPoint(t,s)),null===(l=t.onPressedMoveStart)||void 0===l||l.call(t,o({overlay:t,figureIndex:n,figureKey:i},s)),h.setPressedInstanceInfo({paneId:c,instance:t,figureType:e,figureKey:i,figureIndex:n,attrsIndex:r}),!0}},i.prototype._figureMouseClickEvent=function(t,e,i,n,o){var r=this;return function(a){var s=r.getWidget().getPane(),l=s.getId();return s.getChart().getChartStore().getOverlayStore().setClickInstanceInfo({paneId:l,instance:t,figureType:e,figureKey:i,figureIndex:n,attrsIndex:o},a),!0}},i.prototype._figureMouseRightClickEvent=function(t,e,i,n,r){var a=this;return function(e){var r,s;return null!==(s=null===(r=t.onRightClick)||void 0===r?void 0:r.call(t,o({overlay:t,figureIndex:n,figureKey:i},e)))&&void 0!==s&&s||a.getWidget().getPane().getChart().getChartStore().getOverlayStore().removeInstance(t),!0}},i.prototype._coordinateToPoint=function(e,i){var n,o,r={},a=this.getWidget().getPane(),s=a.getChart(),l=a.getId(),u=s.getChartStore().getTimeScaleStore();if(this.coordinateToPointTimestampDataIndexFlag()){var c=(null===(n=s.getPaneById(ni))||void 0===n?void 0:n.getAxisComponent()).convertFromPixel(i.x),h=null!==(o=u.dataIndexToTimestamp(c))&&void 0!==o?o:void 0;r.dataIndex=c,r.timestamp=h}if(this.coordinateToPointValueFlag()){var d=a.getAxisComponent(),p=d.convertFromPixel(i.y);if(e.mode!==t.OverlayMode.Normal&&l===ei&&void 0!==r.dataIndex){var v=u.getDataByDataIndex(r.dataIndex);if(null!==v){var g=e.modeSensitivity;if(Y(p,v.high))if(e.mode===t.OverlayMode.WeakMagnet){var f=d.convertToPixel(v.high);j(p,d.convertFromPixel(Number(B(f,g))))&&(p=v.high)}else p=v.high;else if(j(p,v.low))if(e.mode===t.OverlayMode.WeakMagnet){var y=d.convertToPixel(v.low);Y(p,d.convertFromPixel(Number(R(y,g))))&&(p=v.low)}else p=v.low;else{var m=K(v.open,v.close),x=X(v.open,v.close);p=Y(p,m)?j(B(p,m),B(v.high,p))?m:v.high:j(p,x)?j(B(p,v.low),B(x,p))?v.low:x:j(B(m,p),B(p,x))?m:x}}}r.value=p}return r},i.prototype.coordinateToPointValueFlag=function(){return!0},i.prototype.coordinateToPointTimestampDataIndexFlag=function(){return!0},i.prototype.dispatchEvent=function(t,i,n){return this.getWidget().getPane().getChart().getChartStore().getOverlayStore().isDrawing()?this.onEvent(t,i,n):e.prototype.dispatchEvent.call(this,t,i,n)},i.prototype.checkEventOn=function(){return!0},i.prototype.drawImp=function(t){var e,i=this,n=this.getWidget(),o=n.getPane(),r=o.getId(),a=o.getChart(),s=o.getAxisComponent(),l=null===(e=a.getPaneById(ni))||void 0===e?void 0:e.getAxisComponent(),u=n.getBounding(),c=a.getChartStore(),h=c.getCustomApi(),d=c.getTimeScaleStore(),p=d.getDateTimeFormat(),v=d.getBarSpace(),g=c.getPrecision(),f=c.getStyles().overlay,y=c.getOverlayStore(),m=y.getHoverInstanceInfo(),x=y.getClickInstanceInfo();this.getCompleteOverlays(y,r).forEach((function(e){e.visible&&i._drawOverlay(t,e,u,v,g,p,h,f,l,s,m,x,d)}));var _=y.getProgressInstanceInfo();if(null!==_){var w=this.getProgressOverlay(_,r);null!==w&&w.visible&&this._drawOverlay(t,w,u,v,g,p,h,f,l,s,m,x,d)}this._drawPlusBtn(t)},i.prototype._drawPlusBtn=function(t){var e,i,n,o,r=this.getWidget().getPane(),a=r.getChart().getChartStore(),s=a.getCrosshairStore().get(),l=a.getShowPlusBtn(),u=a.getCustomApi();if(l&&s.paneId===r.getId()&&"candle_pane"===s.paneId&&this.isOverlayViewInstance()){var c=this.getWidget().getBounding(),h={mouseClickEvent:function(t){var e,i=r.getChart().convertFromPixel([{x:t.x,y:t.y}],{paneId:"candle_pane"});return null===(e=u.onPlusBtnClick)||void 0===e||e.call(u,i[0].value,s.y),!1}};null===(e=this.createFigure("rect",{x:c.width-21,y:s.y-10,width:20,height:20},{style:"stroke_fill",opacity:1,borderColor:"#6D727A",backgroundColor:"#6D727A",color:"#6D727A",borderRadius:2},h))||void 0===e||e.draw(t),null===(i=this.createFigure("circle",{x:c.width-10.5,y:s.y,r:7},{style:"stroke",borderColor:"#fff",color:"transparent"}))||void 0===i||i.draw(t),null===(n=this.createFigure("line",{coordinates:[{x:c.width-10.5-3.5,y:s.y-.5},{x:c.width-10.5+3.5,y:s.y-.5}]},{color:"#fff"}))||void 0===n||n.draw(t),null===(o=this.createFigure("line",{coordinates:[{x:c.width-10.5,y:s.y-3.5},{x:c.width-10.5,y:s.y+3.5}]},{color:"#fff"}))||void 0===o||o.draw(t)}},i.prototype._drawOverlay=function(t,e,i,n,o,r,a,s,l,u,c,h,d){var p=e.points.map((function(t){var e,i,n=t.dataIndex;void 0!==t.timestamp&&(n=d.timestampToDataIndex(t.timestamp));var o={x:0,y:0};return void 0!==n&&(o.x=null!==(e=null==l?void 0:l.convertToPixel(n))&&void 0!==e?e:0),void 0!==t.value&&(o.y=null!==(i=null==u?void 0:u.convertToPixel(t.value))&&void 0!==i?i:0),o}));if(p.length>0){var v=[].concat(this.getFigures(e,p,i,n,o,r,s,l,u));this.drawFigures(t,e,v,s)}this.drawDefaultFigures(t,e,p,i,o,r,a,s,l,u,c,h)},i.prototype.drawFigures=function(t,e,i,n){var r=this;i.forEach((function(i,a){var s=i.type,l=i.styles,u=i.ignoreEvent;[].concat(i.attrs).forEach((function(c,h){var d,p,v,g=r._createFigureEvents(e,2,null!==(d=i.key)&&void 0!==d?d:"",a,h,u),f=o(o(o({},n[s]),null===(p=e.styles)||void 0===p?void 0:p[s]),l);null===(v=r.createFigure(s,c,f,g))||void 0===v||v.draw(t)}))}))},i.prototype.getCompleteOverlays=function(t,e){return t.getInstances(e)},i.prototype.getProgressOverlay=function(t,e){return t.paneId===e?t.instance:null},i.prototype.getFigures=function(t,e,i,n,o,r,a,s,l){var u,c;return null!==(c=null===(u=t.createPointFigures)||void 0===u?void 0:u.call(t,{overlay:t,coordinates:e,bounding:i,barSpace:n,precision:o,dateTimeFormat:r,defaultStyles:a,xAxis:s,yAxis:l}))&&void 0!==c?c:[]},i.prototype.drawDefaultFigures=function(t,e,i,n,r,a,s,l,u,c,h,d){var p,v,g=this;if(e.needDefaultPointFigure&&((null===(p=h.instance)||void 0===p?void 0:p.id)===e.id&&0!==h.figureType||(null===(v=d.instance)||void 0===v?void 0:v.id)===e.id&&0!==d.figureType)){var f=e.styles,y=o(o({},l.point),null==f?void 0:f.point);i.forEach((function(i,n){var o,r,a,s=i.x,l=i.y,u=y.radius,c=y.color,d=y.borderColor,p=y.borderSize;(null===(o=h.instance)||void 0===o?void 0:o.id)===e.id&&1===h.figureType&&h.figureIndex===n&&(u=y.activeRadius,c=y.activeColor,d=y.activeBorderColor,p=y.activeBorderSize),null===(r=g.createFigure("circle",{x:s,y:l,r:u+p},{color:d},g._createFigureEvents(e,1,"".concat(ke,"point_").concat(n),n,0)))||void 0===r||r.draw(t),null===(a=g.createFigure("circle",{x:s,y:l,r:u},{color:c}))||void 0===a||a.draw(t)}))}},i}(Fi),Hi=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n._gridView=new Oi(n),n._indicatorView=new Vi(n),n._crosshairLineView=new zi(n),n._tooltipView=n.createTooltipView(),n._overlayView=new Yi(n),n.addChild(n._tooltipView),n.addChild(n._overlayView),n.getContainer().style.cursor="crosshair",n.registerEvent("mouseMoveEvent",(function(){return i.getChart().getChartStore().getTooltipStore().setActiveIconInfo(),!1})),n}return n(e,t),e.prototype.getName=function(){return Ze},e.prototype.updateMain=function(t){this.updateMainContent(t),this._indicatorView.draw(t),this._gridView.draw(t)},e.prototype.destroy=function(){this._tooltipView.destroy()},e.prototype.createTooltipView=function(){return new Wi(this)},e.prototype.updateMainContent=function(t){},e.prototype.updateOverlay=function(t){this._overlayView.draw(t),this._crosshairLineView.draw(t),this._tooltipView.draw(t)},e}(pi),ji=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.drawImp=function(t){var e,i,n=this.getWidget(),o=n.getPane(),r=o.getChart(),a=n.getBounding(),s=o.getAxisComponent(),l=r.getStyles().candle.area,u=[],c=[],h=Number.MAX_SAFE_INTEGER;this.eachChildren((function(t,e,i){var n=t.x,o=e.halfGapBar,r=t.data[l.value];if(et(+r)){var d=s.convertToPixel(r);if(0===i){var p=n-o;c.push({x:p,y:a.height}),c.push({x:p,y:d}),u.push({x:p,y:d})}u.push({x:n,y:d}),c.push({x:n,y:d}),h=Math.min(h,d)}}));var d=c.length;if(d>0){var p=c[d-1],v=p.x;u.push({x:v,y:p.y}),c.push({x:v,y:p.y}),c.push({x:v,y:a.height})}if(u.length>0&&(null===(e=this.createFigure("line",{coordinates:u},{color:l.lineColor,size:l.lineSize}))||void 0===e||e.draw(t)),c.length>0){var g=l.backgroundColor,f=void 0;if($(g)){var y=t.createLinearGradient(0,a.height,0,h);try{g.forEach((function(t){y.addColorStop(t.offset,t.color)}))}catch(t){}f=y}else f=g;null===(i=this.createFigure("polygon",{coordinates:c},{color:f}))||void 0===i||i.draw(t)}},e}(Ri),Xi=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.drawImp=function(t){var e=this.getWidget().getPane(),i=e.getChart().getChartStore(),n=i.getStyles().candle.priceMark,o=n.high,r=n.low,a=i.getCustomApi().formatNumber;if(n.show&&(o.show||r.show)){var s=i.getPrecision(),l=e.getAxisComponent(),u=Number.MIN_SAFE_INTEGER,c=0,h=Number.MAX_SAFE_INTEGER,d=0;this.eachChildren((function(t){var e=t.data,i=t.x;j(u,e.high)&&(u=e.high,c=i),Y(h,e.low)&&(h=e.low,d=i)}));var p=l.convertToPixel(u),v=l.convertToPixel(h);o.show&&u!==Number.MIN_SAFE_INTEGER&&(o.text.show&&this._drawTextMark(t,Tt(u,s.price,a),{x:c,y:p},v>p?[-2,-5]:[2,5],o.text),o.line.show&&this._drawLineMark(t,{x:c,y:p},o.line)),r.show&&h!==Number.MAX_SAFE_INTEGER&&(r.text.show&&this._drawTextMark(t,Tt(h,s.price,a),{x:d,y:v},v>p?[2,5]:[-2,-5],r.text),r.line.show&&this._drawLineMark(t,{x:d,y:v},r.line))}},e.prototype._drawTextMark=function(t,e,i,n,o){var r,a,s,l,u,c,h=i.x,d=i.y+n[0];null===(r=this.createFigure("line",{coordinates:[{x:h-2,y:d+n[0]},{x:h,y:d},{x:h+2,y:d+n[0]}]},{color:o.color}))||void 0===r||r.draw(t),h>this.getWidget().getBounding().width/2?(u=(l=h-5)-o.offset,c="right"):(c="left",u=(l=h+5)+o.offset);var p=d+n[1];null===(a=this.createFigure("line",{coordinates:[{x:h,y:d},{x:h,y:p},{x:l,y:p}]},{color:o.color}))||void 0===a||a.draw(t),null===(s=this.createFigure("text",{x:u,y:p,text:e,align:c,baseline:"middle"},o))||void 0===s||s.draw(t)},e.prototype._drawLineMark=function(t,e,i){var n,o=this.getWidget().getBounding();null===(n=this.createFigure("line",{coordinates:[{x:0,y:e.y},{x:o.width,y:e.y}]},i))||void 0===n||n.draw(t)},e}(Ri),Ki=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.drawImp=function(t){var e,i=this.getWidget(),n=i.getPane(),o=i.getBounding(),r=n.getChart().getChartStore(),a=r.getStyles().candle.priceMark,s=a.last,l=s.line;if(a.show&&s.show&&l.show){var u=n.getAxisComponent(),c=r.getDataList(),h=c[c.length-1];if(null!=h){var d,p=h.close,v=h.open,g=u.convertToNicePixel(p);d=Y(p,v)?s.upColor:j(p,v)?s.downColor:s.noChangeColor,null===(e=this.createFigure("line",{coordinates:[{x:0,y:g},{x:o.width,y:g}]},{style:l.style,color:d,size:l.size,dashedValue:l.dashedValue}))||void 0===e||e.draw(t)}}},e}(Fi),qi={"zh-CN":{time:"\u65f6\u95f4\uff1a",open:"\u5f00\uff1a",high:"\u9ad8\uff1a",low:"\u4f4e\uff1a",close:"\u6536\uff1a",volume:"\u6210\u4ea4\u91cf\uff1a"},"en-US":{time:"Time: ",open:"Open: ",high:"High: ",low:"Low: ",close:"Close: ",volume:"Volume: "}};function Ui(t,e){var i,n;return null!==(n=null===(i=qi[e])||void 0===i?void 0:i[t])&&void 0!==n?n:t}var Zi=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return n(i,e),i.prototype.drawImp=function(e){var i,n=this.getWidget(),o=n.getPane(),r=o.getId(),a=o.getChart().getChartStore(),s=a.getCrosshairStore().get();if(void 0!==s.kLineData){var l=n.getBounding(),u=null===(i=o.getYAxisWidget())||void 0===i?void 0:i.getBounding(),c=a.getDataList(),h=a.getPrecision(),d=a.getLocale(),p=a.getCustomApi(),v=a.getTooltipStore().getActiveIconInfo(),g=a.getIndicatorStore().getInstances(o.getId()),f=a.getTimeScaleStore().getDateTimeFormat(),y=a.getStyles(),m=y.candle,x=y.indicator;if(m.tooltip.showType===t.TooltipShowType.Rect&&x.tooltip.showType===t.TooltipShowType.Rect){var _=this.isDrawTooltip(s,m.tooltip),w=this.isDrawTooltip(s,x.tooltip);this._drawRectTooltip(e,c,g,l,u,s,h,f,d,p,_,w,y,0)}else if(m.tooltip.showType===t.TooltipShowType.Standard&&x.tooltip.showType===t.TooltipShowType.Standard){var b=this._drawCandleStandardTooltip(e,c,r,l,s,v,h,f,d,p,m);this.drawIndicatorTooltip(e,r,c,s,v,g,p,l,x,b.top,b.values)}else if(m.tooltip.showType===t.TooltipShowType.Rect&&x.tooltip.showType===t.TooltipShowType.Standard){var C=this.drawIndicatorTooltip(e,r,c,s,v,g,p,l,x,0);_=this.isDrawTooltip(s,m.tooltip),this._drawRectTooltip(e,c,g,l,u,s,h,f,d,p,_,!1,y,C)}else{var S=this._drawCandleStandardTooltip(e,c,r,l,s,v,h,f,d,p,m).top;w=this.isDrawTooltip(s,x.tooltip),this._drawRectTooltip(e,c,g,l,u,s,h,f,d,p,!1,w,y,S)}}},i.prototype._drawCandleStandardTooltip=function(t,e,i,n,o,r,a,s,l,c,h){var d,p,v,g=h.tooltip,f=g.text,y=0;if(this.isDrawTooltip(o,g)){var m=null!==(d=o.dataIndex)&&void 0!==d?d:0,x=this._getCandleTooltipData({prev:null!==(p=e[m-1])&&void 0!==p?p:null,current:o.kLineData,next:null!==(v=e[m+1])&&void 0!==v?v:null},a,s,l,c,h),_=this.getTooltipOptions();if(null==_?void 0:_.tooltipFn)return{top:0,values:x};var w=0,b=0,C=0,S=u(this.classifyTooltipIcons(g.icons),3),T=S[1],E=S[2],I=u(this.drawStandardTooltipIcons(t,n,{paneId:i,indicatorName:"",iconId:""},r,S[0],w,b,0),4);y+=I[3];var D=u(this.drawStandardTooltipIcons(t,n,{paneId:i,indicatorName:"",iconId:""},r,T,w=I[0],b=I[1],C=I[2]),4);if(w=D[0],b=D[1],y+=D[3],C=D[2],x.length>0){var P=u(this.drawStandardTooltipLabels(t,n,x,w,b,C,f),4);w=P[0],b=P[1],y+=P[3],C=P[2]}var k=u(this.drawStandardTooltipIcons(t,n,{paneId:i,indicatorName:"",iconId:""},r,E,w,b,C),4);w=k[0],b=k[1],y+=k[3],C=k[2]}return{top:y,values:[]}},i.prototype._drawRectTooltip=function(e,i,n,o,r,a,s,l,u,c,h,d,p,v){var g,f,y,m,x,_=this,w=p.candle,b=p.indicator,C=w.tooltip,S=b.tooltip;if(h||d){var T=null!==(g=a.dataIndex)&&void 0!==g?g:0,E=this._getCandleTooltipData({prev:null!==(f=i[T-1])&&void 0!==f?f:null,current:a.kLineData,next:null!==(y=i[T+1])&&void 0!==y?y:null},s,l,u,c,w),I=C.text,D=I.marginLeft,P=I.marginRight,k=I.marginTop,M=I.marginBottom,A=I.size,B=I.weight,L=I.family,F=C.rect,O=F.paddingLeft,R=F.paddingRight,N=F.paddingTop,V=F.paddingBottom,z=F.offsetLeft,W=F.offsetRight,Y=F.offsetTop,H=F.borderSize,j=F.borderRadius,X=F.borderColor,K=F.color,q=0,U=0,Z=0;h&&(e.font=Ft(A,B,L),E.forEach((function(t){var i=t.value,n="".concat(t.title.text).concat(i.text),o=e.measureText(n).width+D+P;q=Math.max(q,o)})),Z+=(M+k+A)*E.length);var G=S.text,J=G.marginLeft,$=G.marginRight,Q=G.marginTop,tt=G.marginBottom,et=G.size,it=G.weight,nt=G.family,ot=[];if(d&&(e.font=Ft(et,it,nt),n.forEach((function(t){var n,o=null!==(n=_.getIndicatorTooltipData(i,a,t,c,b).values)&&void 0!==n?n:[];ot.push(o),o.forEach((function(t){var i=t.value,n="".concat(t.title.text).concat(i.text),o=e.measureText(n).width+J+$;q=Math.max(q,o),Z+=Q+tt+et}))}))),0!==(U+=q)&&0!==Z){var rt;U+=2*H+O+R,(null!==(m=a.realX)&&void 0!==m?m:0)<o.width/2?(rt=o.width-W-U,p.yAxis.inside&&p.yAxis.position===t.YAxisPosition.Right&&(rt-=r.width)):(rt=z,p.yAxis.inside&&p.yAxis.position===t.YAxisPosition.Left&&(rt+=r.width));var at=v+Y;null===(x=this.createFigure("rect",{x:rt,y:at,width:U,height:Z+=2*H+N+V},{style:t.PolygonType.StrokeFill,color:K,borderColor:X,borderSize:H,borderRadius:j}))||void 0===x||x.draw(e);var st=rt+H+O+D,lt=at+H+N;if(h&&E.forEach((function(t){var i,n,o=t.title;null===(i=_.createFigure("text",{x:st,y:lt+=k,text:o.text},{color:o.color,size:A,family:L,weight:B}))||void 0===i||i.draw(e);var r=t.value;null===(n=_.createFigure("text",{x:rt+U-H-P-R,y:lt,text:r.text,align:"right"},{color:r.color,size:A,family:L,weight:B}))||void 0===n||n.draw(e),lt+=A+M})),d){var ut=rt+H+O+J;ot.forEach((function(t){t.forEach((function(t){var i,n,o=t.title,r=t.value;null===(i=_.createFigure("text",{x:ut,y:lt+=Q,text:o.text},{color:o.color,size:et,family:nt,weight:it}))||void 0===i||i.draw(e),null===(n=_.createFigure("text",{x:rt+U-H-$-R,y:lt,text:r.text,align:"right"},{color:r.color,size:et,family:nt,weight:it}))||void 0===n||n.draw(e),lt+=et+tt}))}))}}}},i.prototype._getCandleTooltipData=function(e,i,n,o,r,a){var s,l,u,c=a.tooltip,h=c.text.color,d=[];if(Q(c.custom))(null!==(l=null===(s=c.custom)||void 0===s?void 0:s.call(c,e,a))&&void 0!==l?l:[]).forEach((function(t){var e=t.title,i=t.value,n={text:"",color:""};tt(e)?n=e:(n.text=e,n.color=h),n.text=Ui(n.text,o);var r={text:"",color:""};tt(i)?r=i:(r.text=i,r.color=h),d.push({title:n,value:r})}));else{var p=i.price,v=i.volume,g=e.current;d=[{title:{text:Ui("time",o),color:h},value:{text:r.formatDate(n,g.timestamp,"YYYY-MM-DD HH:mm",t.FormatDateType.Tooltip),color:h}},{title:{text:Ui("open",o),color:h},value:{text:ut(g.open,p),color:h}},{title:{text:Ui("high",o),color:h},value:{text:ut(g.high,p),color:h}},{title:{text:Ui("low",o),color:h},value:{text:ut(g.low,p),color:h}},{title:{text:Ui("close",o),color:h},value:{text:ut(g.close,p),color:h}},{title:{text:Ui("volume",o),color:h},value:{text:r.formatBigNumber(ut(null!==(u=g.volume)&&void 0!==u?u:c.defaultValue,v),r.formatNumber),color:h}}]}return d},i}(Wi),Gi=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.drawImp=function(t){var e,i,n,o,r,a=this.getWidget().getPane(),s=a.getChart().getChartStore(),l=s.getStyles().logo,u=s.getLogo(),c=a.getBounding().height;u&&t.drawImage(u,null!==(e=null==l?void 0:l.left)&&void 0!==e?e:0,c-(null!==(i=null==l?void 0:l.height)&&void 0!==i?i:0)-(null!==(n=null==l?void 0:l.bottom)&&void 0!==n?n:0),null!==(o=l.width)&&void 0!==o?o:0,null!==(r=l.height)&&void 0!==r?r:0)},e}(Fi),Ji=function(e){function i(t,i){var n=e.call(this,t,i)||this;return n._candleBarView=new Ni(n),n._candleAreaView=new ji(n),n._candleHighLowPriceView=new Xi(n),n._candleLastPriceLineView=new Ki(n),n._logoView=new Gi(n),n.addChild(n._candleBarView),n}return n(i,e),i.prototype.updateMainContent=function(e){var i=this.getPane().getChart().getStyles().candle;this._logoView.draw(e),i.type!==t.CandleType.Area?(this._candleBarView.draw(e),this._candleHighLowPriceView.draw(e),this._candleLastPriceLineView.draw(e)):this._candleAreaView.draw(e)},i.prototype.createTooltipView=function(){return new Zi(this)},i}(Hi),$i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.drawImp=function(t){var e,i=this,n=this.getWidget(),o=n.getPane(),r=n.getBounding(),a=o.getAxisComponent(),s=this.getAxisStyles(o.getChart().getStyles());if(s.show){s.axisLine.show&&(null===(e=this.createFigure("line",this.createAxisLine(r,s),s.axisLine))||void 0===e||e.draw(t));var l=a.getTicks();s.tickLine.show&&this.createTickLines(l,r,s).forEach((function(e){var n;null===(n=i.createFigure("line",e,s.tickLine))||void 0===n||n.draw(t)})),s.tickText.show&&this.createTickTexts(l,r,s).forEach((function(e){var n;null===(n=i.createFigure("text",e,s.tickText))||void 0===n||n.draw(t)}))}},e}(Fi),Qi=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getAxisStyles=function(t){return t.yAxis},e.prototype.createAxisLine=function(t,e){var i,n=this.getWidget().getPane().getAxisComponent(),o=e.axisLine.size;return{coordinates:[{x:i=n.isFromZero()?o/2:t.width-o,y:0},{x:i,y:t.height}]}},e.prototype.createTickLines=function(t,e,i){var n=this.getWidget().getPane().getAxisComponent(),o=i.axisLine,r=i.tickLine,a=0,s=0;return n.isFromZero()?(a=0,o.show&&(a+=o.size),s=a+r.length):(a=e.width,o.show&&(a-=o.size),s=a-r.length),t.map((function(t){return{coordinates:[{x:a,y:t.coord},{x:s,y:t.coord}]}}))},e.prototype.createTickTexts=function(t,e,i){var n=this.getWidget().getPane().getAxisComponent(),o=i.axisLine,r=i.tickLine,a=i.tickText,s=0;n.isFromZero()?(s=a.marginStart,o.show&&(s+=o.size),r.show&&(s+=r.length)):(s=e.width-a.marginEnd,o.show&&(s-=o.size),r.show&&(s-=r.length));var l=this.getWidget().getPane().getAxisComponent().isFromZero()?"left":"right";return t.map((function(t){return{x:s,y:t.coord,text:t.text,align:l,baseline:"middle"}}))},e}($i),tn=function(e){function i(t){var i=e.call(this,t)||this;return i.destroyed=!1,i.animation(),i}return n(i,e),i.prototype.animation=function(){var t=this;this.destroyed||ci((function(){t._ctx&&t.drawImp(t._ctx),t.animation()}))},i.prototype.setDestroyed=function(){this.destroyed=!0},i.prototype.setCtx=function(t){this._ctx=t},i.prototype.drawImp=function(e){var i,n,r,a=this.getWidget(),s=a.getPane(),l=a.getBounding(),u=s.getChart().getChartStore(),c=u.getStyles().candle.priceMark,h=c.last,d=h.text;if(c.show&&h.show&&d.show){var p=u.getPrecision(),v=u.getInterval(),g=u.getShowCountDown(),f=s.getAxisComponent(),y=u.getDataList(),m=u.getVisibleDataList(),x=y[y.length-1];if(void 0!==x){var _,w=x.close,b=x.open,C=x.timestamp,S=f.convertToNicePixel(w);_=Y(w,b)?h.upColor:j(w,b)?h.downColor:h.noChangeColor;var T=void 0;if(f.getType()===t.YAxisType.Percentage){var E=m[0].data.close;T="".concat(W(u.getCustomApi().formatPercent(F(M(B(w,E),E),100)),2))}else T=Tt(w,p.price,u.getCustomApi().formatNumber);var I=void 0,D=void 0;if(f.isFromZero()?(I=0,D="left"):(I=l.width,D="right"),g&&1!==v){var P=function(t,e,i){var n,o,r,a,s,l,u=(2592e3===i?(o=(n=new Date(t)).getTimezoneOffset(),r=new Date(n.getTime()+60*o*1e3),a=new Date(r.getTime()+288e5),s=a.getUTCFullYear(),l=a.getUTCMonth()+1,new Date(Date.UTC(12===l?s+1:s,(12===l?1:l+1)-1,1,0,0,0))).getTime():t+(e?t-(null!=e?e:0):1e3*(null!=i?i:0)))-Date.now();if(0>u)return{isValid:!1,text:""};var c=Math.floor(u/864e5),h=Math.floor(u%864e5/36e5),d="".concat(10>h?"0":"").concat(h),p=Math.floor(u%36e5/6e4),v="".concat(10>p?"0":"").concat(p),g=Math.floor(u%6e4/1e3),f="".concat(10>g?"0":"").concat(g);return{isValid:!0,text:0!==c?"".concat(c,"D ").concat(h,"H"):0!==h?"".concat(d,":").concat(v,":").concat(f):"".concat(v,":").concat(f)}}(C,(y[y.length-2]||{}).timestamp,v),k=P.isValid,A=P.text,L=k?Math.max(e.measureText(T).width,e.measureText(A).width):void 0;null===(i=this.createFigure("rectText",{x:I,y:S,text:T,align:D,baseline:"middle"},o(o({},d),{backgroundColor:_,textWidth:L})))||void 0===i||i.draw(e),k&&(null===(n=this.createFigure("rectText",{x:I,y:S+16,text:A,align:D,baseline:"middle"},o(o({},d),{backgroundColor:_,textWidth:L})))||void 0===n||n.draw(e))}else null===(r=this.createFigure("rectText",{x:I,y:S,text:T,align:D,baseline:"middle"},o(o({},d),{backgroundColor:_})))||void 0===r||r.draw(e)}}},i}(Fi),en=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.drawImp=function(t){var e=this,i=this.getWidget(),n=i.getPane(),r=i.getBounding(),a=n.getChart().getChartStore(),s=a.getCustomApi(),l=a.getStyles().indicator,u=l.lastValueMark,c=u.text;if(u.show){var h=n.getAxisComponent(),d=a.getDataList(),p=d.length-1;a.getIndicatorStore().getInstances(n.getId()).forEach((function(i){var n=i.result[p];if(void 0!==n&&i.visible){var a=i.precision;zt(d,i,p,l,(function(l,u){var d,p=n[l.key];if(it(p)){var v=h.convertToNicePixel(p),g=ut(p,a);g=i.shouldFormatBigNumber?s.formatBigNumber(g,wt):s.formatNumber(g);var f=void 0,y=void 0;h.isFromZero()?(f=0,y="left"):(f=r.width,y="right"),null===(d=e.createFigure("rectText",{x:f,y:v,text:g,align:y,baseline:"middle"},o(o({},c),{backgroundColor:u.color})))||void 0===d||d.draw(t)}}))}}))}},e}(Fi),nn=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.isOverlayViewInstance=function(){return!1},e.prototype.coordinateToPointTimestampDataIndexFlag=function(){return!1},e.prototype.drawDefaultFigures=function(t,e,i,n,o,r,a,s,l,u,c,h){this.drawFigures(t,e,this.getDefaultFigures(e,i,n,o,r,a,l,u,h),s)},e.prototype.getDefaultFigures=function(t,e,i,n,o,r,a,s,l){var u,c,h=[];if(t.needDefaultYAxisFigure&&t.id===(null===(u=l.instance)||void 0===u?void 0:u.id)&&l.paneId===this.getWidget().getPane().getId()){var d,p,v=Number.MAX_SAFE_INTEGER,g=Number.MIN_SAFE_INTEGER;null!==(c=null==s?void 0:s.isFromZero())&&void 0!==c&&c?(d="left",p=0):(d="right",p=i.width),e.forEach((function(e,i){var o=t.points[i];if(void 0!==o.value){v=Math.min(v,e.y),g=Math.max(g,e.y);var a=Tt(o.value,n.price,r.formatNumber);h.push({type:"rectText",attrs:{x:p,y:e.y,text:a,align:d,baseline:"middle"},ignoreEvent:!0})}})),e.length>1&&h.unshift({type:"rect",attrs:{x:0,y:v,width:i.width,height:g-v},ignoreEvent:!0})}return h},e.prototype.getFigures=function(t,e,i,n,o,r,a,s,l){var u,c;return null!==(c=null===(u=t.createYAxisFigures)||void 0===u?void 0:u.call(t,{overlay:t,coordinates:e,bounding:i,barSpace:n,precision:o,dateTimeFormat:r,defaultStyles:a,xAxis:s,yAxis:l}))&&void 0!==c?c:[]},e}(Yi),on=function(){function t(t){this._extremum={min:0,max:0,range:0,realMin:0,realMax:0,realRange:0},this._prevExtremum={min:0,max:0,range:0,realMin:0,realMax:0,realRange:0},this._ticks=[],this._autoCalcTickFlag=!0,this._parent=t}return t.prototype.getParent=function(){return this._parent},t.prototype.buildTicks=function(t){return this._autoCalcTickFlag&&(this._extremum=this.calcExtremum()),!(this._prevExtremum.min===this._extremum.min&&this._prevExtremum.max===this._extremum.max&&!t||(this._prevExtremum=this._extremum,this._ticks=this.optimalTicks(this._calcTicks()),0))},t.prototype.getTicks=function(){return this._ticks},t.prototype.setExtremum=function(t){this._autoCalcTickFlag=!1,this._extremum=t},t.prototype.getExtremum=function(){return this._extremum},t.prototype.setAutoCalcTickFlag=function(t){this._autoCalcTickFlag=t},t.prototype.getAutoCalcTickFlag=function(){return this._autoCalcTickFlag},t.prototype._calcTicks=function(){var t=this._extremum,e=t.realMin,i=t.realMax,n=t.realRange,o=[];if(!j(n,0)){var r=u(this._calcTickInterval(n),2),a=r[0],s=r[1],l=x(F(Math.ceil(M(e,a,!0)),a,!0),s,!0),c=x(F(Math.floor(M(i,a,!0)),a,!0),s,!0),h=0,d=l;if(C(a)&&!H(a,0,!0)&&C(c))for(;C(d)&&!Y(d,c,!0);){var p=z(d,Number(s));o[h]={text:p+"",coord:0,value:p},++h,d=R(d,a,!0)}}return o},t.prototype._calcTickInterval=function(t){var e,i,n,o,r=(e=M(t,8),i=Math.floor(Number(w(e))),e=F(j(o=M(e,n=b(Number(i))),1.5)?1:j(o,2.5)?2:j(o,3.5)?3:j(o,4.5)?4:j(o,5.5)?5:j(o,6.5)?6:8,n),j(i,-20)?e:+W(e,j(i,0)?-i:0)),a=function(t){var e=""+t,i=e.indexOf("e");if(i>0){var n=+e.slice(i+1);return 0>n?-n:0}var o=e.indexOf(".");return 0>o?0:e.length-1-o}(r);return[r,a]},t}(),rn=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return n(i,e),i.prototype.calcExtremum=function(){var e,i,n,o,r,a=this.getParent(),s=a.getChart(),l=s.getChartStore(),u=Number.MAX_SAFE_INTEGER,c=Number.MIN_SAFE_INTEGER,h=[],d=!1,p=Number.MAX_SAFE_INTEGER,v=Number.MIN_SAFE_INTEGER,g=Number.MAX_SAFE_INTEGER,f=l.getIndicatorStore().getInstances(a.getId());f.forEach((function(t){var e,i,n;d||(d=null!==(e=t.shouldOhlc)&&void 0!==e&&e),g=Math.min(g,t.precision),null!==t.minValue&&(p=X(p,t.minValue)),null!==t.maxValue&&(v=K(v,t.maxValue)),h.push({figures:null!==(i=t.figures)&&void 0!==i?i:[],result:null!==(n=t.result)&&void 0!==n?n:[]})}));var y=4,m=this.isInCandle();if(m){var x=l.getPrecision().price;y=g!==Number.MAX_SAFE_INTEGER?Math.min(g,x):x}else g!==Number.MAX_SAFE_INTEGER&&(y=g);var _=l.getVisibleDataList(),C=s.getStyles().candle,S=C.type===t.CandleType.Area,T=C.area.value,E=m&&!S||!m&&d;_.forEach((function(t){var e=t.dataIndex,i=t.data;if(E&&(u=X(u,i.low),c=K(c,i.high)),m&&S){var n=i[T];u=X(u,n),c=K(c,n)}h.forEach((function(t){var i,n=null!==(i=t.result[e])&&void 0!==i?i:{};t.figures.forEach((function(t){var e=n[t.key];it(e)&&(u=X(u,e),c=K(c,e))}))}))})),f.get("VOL")||u!==Number.MAX_SAFE_INTEGER&&c!==Number.MIN_SAFE_INTEGER?(u=X(p,u),c=K(v,c)):(u=0,c=10);var I,D=this.getType();switch(D){case t.YAxisType.Percentage:var P=null===(e=_[0])||void 0===e?void 0:e.data;void 0!==(null==P?void 0:P.close)&&(u=Number(F(M(B(u,P.close),P.close),100)),c=Number(F(M(B(c,P.close),P.close),100))),I=.01;break;case t.YAxisType.Log:u=w(u),c=w(c),I=F(.05,b(-y));break;default:I=b(-y)}if(H(u,c)||j(N(B(u,c)),I)){var k=H(p,u),A=H(v,c);u=k?u:B(u,F(A?8:4,I)),c=A?c:R(c,F(k?8:4,I))}var L=null!==(n=null===(i=this.getParent().getYAxisWidget())||void 0===i?void 0:i.getBounding().height)&&void 0!==n?n:0,O=a.getOptions().gap,V=null!==(o=null==O?void 0:O.top)&&void 0!==o?o:.2;1>V||(V=M(V,L));var z=null!==(r=null==O?void 0:O.bottom)&&void 0!==r?r:.1;1>z||(z/=L);var W,Y,q,U=N(B(c,u));return u=B(u,F(U,z)),U=N(B(c=R(c,F(U,V)),u)),D===t.YAxisType.Log?(W=b(Number(u)),q=N(B(Y=b(Number(c)),W))):(W=u,Y=c,q=U),{min:u,max:c,range:U,realMin:W,realMax:Y,realRange:q}},i.prototype._innerConvertToPixel=function(t){var e,i,n=null!==(i=null===(e=this.getParent().getYAxisWidget())||void 0===e?void 0:e.getBounding().height)&&void 0!==i?i:0,o=this.getExtremum(),r=o.range,a=B(t,o.min)/r;return this.isReverse()?x(F(a,n),0):x(F(B(1,a),n),0)},i.prototype.isInCandle=function(){return"candle"===this.getParent().getName()},i.prototype.getType=function(){return this.isInCandle()?this.getParent().getChart().getStyles().yAxis.type:t.YAxisType.Normal},i.prototype.getPosition=function(){return this.getParent().getChart().getStyles().yAxis.position},i.prototype.isReverse=function(){return!!this.isInCandle()&&this.getParent().getChart().getStyles().yAxis.reverse},i.prototype.isFromZero=function(){var e=this.getParent().getChart().getStyles().yAxis,i=e.inside;return e.position===t.YAxisPosition.Left&&i||e.position===t.YAxisPosition.Right&&!i},i.prototype.optimalTicks=function(e){var i,n,o=this,r=this.getParent(),a=null!==(n=null===(i=r.getYAxisWidget())||void 0===i?void 0:i.getBounding().height)&&void 0!==n?n:0,s=r.getChart().getChartStore(),l=s.getCustomApi(),u=[],c=this.getType(),h=s.getIndicatorStore().getInstances(r.getId()),d=0,p=!1;this.isInCandle()?d=s.getPrecision().price:h.forEach((function(t){d=Math.max(d,t.precision),p||(p=t.shouldFormatBigNumber)}));var v,g=s.getStyles().xAxis.tickText.size;return e.forEach((function(e){var i,n=e.value,r=o._innerConvertToPixel(y?n:+n);switch(c){case t.YAxisType.Percentage:i="".concat(l.formatPercent(ut(n,2)));break;case t.YAxisType.Log:r=o._innerConvertToPixel(w(+n)),i=ut(n,d);break;default:i=ut(n,d),i=p?l.formatBigNumber(n,l.formatNumber):l.formatNumber(i)}r>g&&a-g>r&&(void 0!==v&&Math.abs(v-r)>2*g||void 0===v)&&(u.push({text:i,coord:r,value:n}),v=r)})),u},i.prototype.getAutoSize=function(){var e=this.getParent(),i=e.getChart(),n=i.getStyles(),o=n.yAxis,r=o.size;if("auto"!==r)return r;var a=i.getChartStore(),s=a.getCustomApi(),l=0;if(o.show&&(o.axisLine.show&&(l+=o.axisLine.size),o.tickLine.show&&(l+=o.tickLine.length),o.tickText.show)){var u=Rt(o.tickText.size,o.tickText.weight,o.tickText.family),c=0;this.getTicks().forEach((function(t){c=Math.max(c,Ot(t.text.replace(/\d/g,u+""),o.tickText.size,o.tickText.weight,o.tickText.family))})),l+=o.tickText.marginStart+o.tickText.marginEnd+c}var h=n.crosshair,d=0;if(h.show&&h.horizontal.show&&h.horizontal.text.show){var p=a.getIndicatorStore().getInstances(e.getId()),v=0,g=!1;p.forEach((function(t){v=Math.max(t.precision,v),g||(g=t.shouldFormatBigNumber)}));var f=2;if(this.getType()!==t.YAxisType.Percentage)if(this.isInCandle()){var y=a.getPrecision().price,m=n.indicator.lastValueMark;f=m.show&&m.text.show?Math.max(v,y):y}else f=v;var x=ut(this.getExtremum().max,f);x=g?s.formatBigNumber(x,s.formatNumber):s.formatNumber(x,!0,{keepTight:!0});var _=Rt(h.horizontal.text.size,h.horizontal.text.weight,h.horizontal.text.family);d+=h.horizontal.text.paddingLeft+h.horizontal.text.paddingRight+2*h.horizontal.text.borderSize+Ot(x.replace(/\d/g,_+""),h.horizontal.text.size,h.horizontal.text.weight,h.horizontal.text.family)}return Math.max(l,d)},i.prototype.convertFromPixel=function(e){var i,n,o,r=null!==(n=null===(i=this.getParent().getYAxisWidget())||void 0===i?void 0:i.getBounding().height)&&void 0!==n?n:0,a=this.getExtremum(),s=a.min,l=a.range,u=R(F(this.isReverse()?e/r:1-e/r,l),s);switch(this.getType()){case t.YAxisType.Percentage:var c=null===(o=this.getParent().getChart().getChartStore().getVisibleDataList()[0])||void 0===o?void 0:o.data;return void 0!==(null==c?void 0:c.close)?Number(R(M(F(c.close,u),100),c.close)):0;case t.YAxisType.Log:return b(Number(u));default:return u}},i.prototype.convertToRealValue=function(e){var i=e;return this.getType()===t.YAxisType.Log&&(i=b(Number(e))),i},i.prototype.convertToPixel=function(e){var i,n=e;switch(this.getType()){case t.YAxisType.Percentage:var o=null===(i=this.getParent().getChart().getChartStore().getVisibleDataList()[0])||void 0===i?void 0:i.data;void 0!==(null==o?void 0:o.close)&&(n=F(M(B(e,o.close),o.close),100));break;case t.YAxisType.Log:n=w(e);break;default:n=e}return this._innerConvertToPixel(n)},i.prototype.convertToNicePixel=function(t){var e,i,n=null!==(i=null===(e=this.getParent().getYAxisWidget())||void 0===e?void 0:e.getBounding().height)&&void 0!==i?i:0,o=this.convertToPixel(t);return Math.round(Math.max(.05*n,Math.min(o,.98*n)))},i}(on),an=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return n(i,e),i.prototype.drawImp=function(t){var e,i,n,r,a,s,l=this,u=this.getWidget(),c=u.getPane(),h=u.getBounding(),d=u.getPane().getChart().getChartStore();if(d.getCrosshairStore().getStatus()){var p=d.getCrosshairStore().get(),v=d.getStyles().crosshair;if(void 0!==p.paneId&&this.compare(p,c.getId())&&v.show){var g=this.getDirectionStyles(v),f=g.text;if(g.show&&f.show){var y=c.getAxisComponent(),m=this.getText(p,d,y);t.font=Ft(f.size,f.weight,f.family);var x=this.getTextAttrs(m,t.measureText(m).width,p,h,y,f);f.textWidth=Math.min(t.measureText(m).width,h.width-(null!==(e=f.paddingRight)&&void 0!==e?e:0)-(null!==(i=f.paddingLeft)&&void 0!==i?i:0));var _=function(t,e,i){void 0===e&&(e="");for(var n=[],o="",r=0,a=e.length;a>r;r++)o+=e.charAt(r),t.measureText(o).width>i&&(n.push(o.substring(0,o.length-1)),o="",r--);return n.push(o),n}(t,m,h.width-(null!==(n=f.paddingRight)&&void 0!==n?n:0)-(null!==(r=f.paddingLeft)&&void 0!==r?r:0)+1),w=y instanceof rn,b=y.getParent()instanceof cn;if(d.getShowPriceFluctuationRatio()&&w&&b){var C=d.getPrecision(),S=y.convertFromPixel(p.y);if(Y(S=ut(S,C.price),0)){var T=d.getDataList(),E=null===(a=T[T.length-1])||void 0===a?void 0:a.close,I=F(M(B(S,E),E),100),D=St(I,2,!0),P="";Number(I)>0?P="+":0>Number(I)&&0===Number(D)&&(P="-");var k="".concat(P).concat(d.getCustomApi().formatPercent(D));f.textWidth=Math.max(t.measureText(k).width,f.textWidth);var A=o(o({},x),{text:k,y:x.y+16*_.length});null===(s=this.createFigure("rectText",A,f))||void 0===s||s.draw(t)}}_.forEach((function(e,i){var n;null===(n=l.createFigure("rectText",o(o({},x),{text:e,y:x.y+16*i}),f))||void 0===n||n.draw(t)}))}}}},i.prototype.compare=function(t,e){return t.paneId===e},i.prototype.getDirectionStyles=function(t){return t.horizontal},i.prototype.getText=function(e,i,n){var o,r,a,s=n,l=n.convertFromPixel(e.y);if(s.getType()===t.YAxisType.Percentage){var u=null!==(r=null===(o=i.getVisibleDataList()[0])||void 0===o?void 0:o.data)&&void 0!==r?r:{};a="".concat(i.getCustomApi().formatPercent(W(F(M(B(l,u.close),u.close),100),2)))}else{var c=i.getIndicatorStore().getInstances(e.paneId),h=0,d=!1;s.isInCandle()?h=i.getPrecision().price:c.forEach((function(t){h=Math.max(t.precision,h),d||(d=t.shouldFormatBigNumber)})),a=ut(l,h);var p=i.getCustomApi();a=d?p.formatBigNumber(a,p.formatNumber):p.formatNumber(a,!1)}return a},i.prototype.getTextAttrs=function(t,e,i,n,o,r){var a,s;return o.isFromZero()?(a=0,s="left"):(a=n.width,s="right"),{x:a,y:i.y,text:t,align:s,baseline:"middle"}},i}(Fi),sn=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n._yAxisView=new Qi(n),n._candleLastPriceLabelView=new tn(n),n._indicatorLastValueView=new en(n),n._overlayYAxisView=new nn(n),n._crosshairHorizontalLabelView=new an(n),n.getContainer().style.cursor="ns-resize",n.addChild(n._overlayYAxisView),n}return n(e,t),e.prototype.getName=function(){return Je},e.prototype.updateMain=function(t){this._yAxisView.draw(t),this._indicatorLastValueView.draw(t),this._overlayYAxisView.draw(t),this.getPane().getAxisComponent().isInCandle()&&(this._candleLastPriceLabelView.setCtx(t),this._candleLastPriceLabelView.draw(t))},e.prototype.updateOverlay=function(t){this._crosshairHorizontalLabelView.draw(t)},e.prototype.destroy=function(){this._candleLastPriceLabelView.setDestroyed()},e}(pi),ln=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getName=function(){return"indicator"},e.prototype.createAxisComponent=function(){return new rn(this)},e.prototype.createMainWidget=function(t){return new Hi(t,this)},e.prototype.createSeparatorWidget=function(t){return new ti(t,this)},e.prototype.creatYAxisWidget=function(t){return new sn(t,this)},e}(oi),un=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getName=function(){return"candle"},e.prototype.createMainWidget=function(t){return new Ji(t,this)},e.prototype.createSeparatorWidget=function(){return null},e}(ln),cn=un,hn=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getAxisStyles=function(t){return t.xAxis},e.prototype.createAxisLine=function(t,e){var i=e.axisLine.size/2;return{coordinates:[{x:0,y:i},{x:t.width,y:i}]}},e.prototype.createTickLines=function(t,e,i){var n=i.tickLine,o=i.axisLine.size;return t.map((function(t){return{coordinates:[{x:t.coord,y:0},{x:t.coord,y:o+n.length}]}}))},e.prototype.createTickTexts=function(t,e,i){var n=i.tickText,o=i.axisLine.size,r=i.tickLine.length;return t.map((function(t){return{x:t.coord,y:o+r+n.marginStart,text:t.text,align:"center",baseline:"top"}}))},e}($i),dn=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return n(i,e),i.prototype.coordinateToPointTimestampDataIndexFlag=function(){return!0},i.prototype.coordinateToPointValueFlag=function(){return!1},i.prototype.getCompleteOverlays=function(t){return t.getInstances()},i.prototype.getProgressOverlay=function(t){return t.instance},i.prototype.getDefaultFigures=function(e,i,n,o,r,a,s,l,u){var c,h=[];if(e.needDefaultXAxisFigure&&e.id===(null===(c=u.instance)||void 0===c?void 0:c.id)){var d=Number.MAX_SAFE_INTEGER,p=Number.MIN_SAFE_INTEGER;i.forEach((function(i,n){d=Math.min(d,i.x),p=Math.max(p,i.x);var o=e.points[n];if(void 0!==o.timestamp){var s=a.formatDate(r,o.timestamp,"YYYY-MM-DD HH:mm",t.FormatDateType.Crosshair);h.push({type:"rectText",attrs:{x:i.x,y:0,text:s,align:"center"},ignoreEvent:!0})}})),i.length>1&&h.unshift({type:"rect",attrs:{x:d,y:0,width:p-d,height:n.height},ignoreEvent:!0})}return h},i.prototype.getFigures=function(t,e,i,n,o,r,a,s,l){var u,c;return null!==(c=null===(u=t.createXAxisFigures)||void 0===u?void 0:u.call(t,{overlay:t,coordinates:e,bounding:i,barSpace:n,precision:o,dateTimeFormat:r,defaultStyles:a,xAxis:s,yAxis:l}))&&void 0!==c?c:[]},i}(nn),pn=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return n(i,e),i.prototype.compare=function(t){var e;return(null!==(e=null==t?void 0:t.realDataIndex)&&void 0!==e?e:0)>=0},i.prototype.getDirectionStyles=function(t){return t.vertical},i.prototype.getText=function(e,i){var n,o,r,a,s,l,u,c,h=null!==(n=e.dataIndex)&&void 0!==n?n:0,d=null!==(o=e.realDataIndex)&&void 0!==o?o:0,p=1e3*(null!==(r=i.getInterval())&&void 0!==r?r:0),v=0;return h===e.realDataIndex?v=null===(a=e.kLineData)||void 0===a?void 0:a.timestamp:d>h?v=(null!==(l=null===(s=e.kLineData)||void 0===s?void 0:s.timestamp)&&void 0!==l?l:0)+(d-h)*p:h>d&&(v=(null!==(c=null===(u=e.kLineData)||void 0===u?void 0:u.timestamp)&&void 0!==c?c:0)+d*p),i.getCustomApi().formatDate(i.getTimeScaleStore().getDateTimeFormat(),v,"YYYY-MM-DD HH:mm",t.FormatDateType.Crosshair)},i.prototype.getTextAttrs=function(t,e,i,n,o,r){var a=i.realX;return{x:0>a-e/2-r.paddingLeft?r.paddingLeft+e/2:a+e/2+r.paddingRight>n.width?n.width-r.paddingRight-e/2:a,y:0,text:t,align:"center",baseline:"top"}},i}(an),vn=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n._xAxisView=new hn(n),n._overlayXAxisView=new dn(n),n._crosshairVerticalLabelView=new pn(n),n.getContainer().style.cursor="ew-resize",n.addChild(n._overlayXAxisView),n}return n(e,t),e.prototype.getName=function(){return Ge},e.prototype.updateMain=function(t){this._xAxisView.draw(t)},e.prototype.updateOverlay=function(t){this._overlayXAxisView.draw(t),this._crosshairVerticalLabelView.draw(t)},e}(pi),gn=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return n(i,e),i.prototype.calcExtremum=function(){var t=this.getParent().getChart().getChartStore().getTimeScaleStore().getVisibleRange(),e=t.from,i=t.to,n=t.realTo;return{min:e,max:i-1,range:i-e,realMin:e,realMax:n-1,realRange:n-e}},i.prototype.optimalTicks=function(e){var i,n,o,r=this.getParent().getChart(),a=r.getChartStore(),s=a.getCustomApi().formatDate,l=[],u=e.length,c=a.getDataList(),h=1e3*(null!==(i=a.getInterval())&&void 0!==i?i:0);if(c.length>0){var d=a.getTimeScaleStore().getDateTimeFormat(),p=r.getStyles().xAxis.tickText,v=Ot("00-00 00:00",p.size,p.weight,p.family),g=this.convertToPixel(parseInt(e[0].value,10)),f=1;if(u>1){var y=this.convertToPixel(parseInt(e[1].value,10)),m=Math.abs(y-g);v>m&&(f=Math.ceil(v/m))}for(var x=0;u>x;x+=f){var _=parseInt(e[x].value,10),w=this._getTimestamp(c,h,_),b=s(d,w,"HH:mm",t.FormatDateType.XAxis);if(0!==x){var C=this._getTimestamp(c,h,parseInt(e[x-f].value,10));b=null!==(n=this._optimalTickLabel(s,d,w,C))&&void 0!==n?n:b}var S=this.convertToPixel(_);l.push({text:b,coord:S,value:w})}if(1===l.length)l[0].text=s(d,l[0].value,"YYYY-MM-DD HH:mm",t.FormatDateType.XAxis);else{var T=l[0].value,E=l[1].value;if(void 0!==l[2]){var I=l[2].text;/^[0-9]{2}-[0-9]{2}$/.test(I)?l[0].text=s(d,T,"MM-DD",t.FormatDateType.XAxis):/^[0-9]{4}-[0-9]{2}$/.test(I)?l[0].text=s(d,T,"YYYY-MM",t.FormatDateType.XAxis):/^[0-9]{4}$/.test(I)&&(l[0].text=s(d,T,"YYYY",t.FormatDateType.XAxis))}else l[0].text=null!==(o=this._optimalTickLabel(s,d,T,E))&&void 0!==o?o:l[0].text}}return l},i.prototype._optimalTickLabel=function(e,i,n,o){var r=e(i,n,"YYYY",t.FormatDateType.XAxis),a=e(i,n,"YYYY-MM",t.FormatDateType.XAxis),s=e(i,n,"MM-DD",t.FormatDateType.XAxis);return r!==e(i,o,"YYYY",t.FormatDateType.XAxis)?r:a!==e(i,o,"YYYY-MM",t.FormatDateType.XAxis)?a:s!==e(i,o,"MM-DD",t.FormatDateType.XAxis)?s:null},i.prototype.getAutoSize=function(){var t=this.getParent().getChart().getStyles(),e=t.xAxis,i=e.size;if("auto"!==i)return i;var n=t.crosshair,o=0;e.show&&(e.axisLine.show&&(o+=e.axisLine.size),e.tickLine.show&&(o+=e.tickLine.length),e.tickText.show&&(o+=e.tickText.marginStart+e.tickText.marginEnd+e.tickText.size));var r=0;return n.show&&n.vertical.show&&n.vertical.text.show&&(r+=n.vertical.text.paddingTop+n.vertical.text.paddingBottom+2*n.vertical.text.borderSize+n.vertical.text.size),Math.max(o,r)},i.prototype.convertFromPixel=function(t){return this.getParent().getChart().getChartStore().getTimeScaleStore().coordinateToDataIndex(t)},i.prototype.convertToPixel=function(t){return this.getParent().getChart().getChartStore().getTimeScaleStore().dataIndexToCoordinate(t)},i.prototype._getTimestamp=function(t,e,i){var n=t.length-1,o=t[i]||{};return i>n&&(o.timestamp=t[n].timestamp+(i-n)*e),0>i&&(o.timestamp=t[0].timestamp+i*e),o.timestamp},i}(on),fn=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.getName=function(){return"xAxis"},e.prototype.createAxisComponent=function(){return new gn(this)},e.prototype.createMainWidget=function(t){return new vn(t,this)},e}(oi);function yn(){var t;return"undefined"!=typeof window&&(null!==(t=window.navigator.userAgent.toLowerCase().indexOf("firefox"))&&void 0!==t?t:-1)>-1}function mn(){return"undefined"!=typeof window&&/iPhone|iPad|iPod/.test(window.navigator.platform)}var xn,_n,wn=function(){function t(t,e,i){var n=this;this._clickCount=0,this._clickTimeoutId=null,this._clickCoordinate={x:-1/0,y:1/0},this._tapCount=0,this._tapTimeoutId=null,this._tapCoordinate={x:-1/0,y:1/0},this._longTapTimeoutId=null,this._longTapActive=!1,this._mouseMoveStartCoordinate=null,this._touchMoveStartCoordinate=null,this._touchMoveExceededManhattanDistance=!1,this._cancelClick=!1,this._cancelTap=!1,this._unsubscribeOutsideMouseEvents=null,this._unsubscribeOutsideTouchEvents=null,this._unsubscribeMobileSafariEvents=null,this._unsubscribeMousemove=null,this._unsubscribeMouseWheel=null,this._unsubscribeContextMenu=null,this._unsubscribeRootMouseEvents=null,this._unsubscribeRootTouchEvents=null,this._startPinchMiddleCoordinate=null,this._startPinchDistance=0,this._pinchPrevented=!1,this._preventTouchDragProcess=!1,this._mousePressed=!1,this._lastTouchEventTimeStamp=0,this._activeTouchId=null,this._acceptMouseLeave=!mn(),this._onFirefoxOutsideMouseUp=function(t){n._mouseUpHandler(t)},this._onMobileSafariDoubleClick=function(t){n._firesTouchEvents(t)?(++n._tapCount,null!==n._tapTimeoutId&&n._tapCount>1&&(30>n._mouseTouchMoveWithDownInfo(n._getCoordinate(t),n._tapCoordinate).manhattanDistance&&!n._cancelTap&&n._processEvent(n._makeCompatEvent(t),n._handler.doubleTapEvent),n._resetTapTimeout())):(++n._clickCount,null!==n._clickTimeoutId&&n._clickCount>1&&(5>n._mouseTouchMoveWithDownInfo(n._getCoordinate(t),n._clickCoordinate).manhattanDistance&&!n._cancelClick&&n._processEvent(n._makeCompatEvent(t),n._handler.mouseDoubleClickEvent),n._resetClickTimeout()))},this._target=t,this._handler=e,this._options=i,this._init()}return t.prototype.destroy=function(){null!==this._unsubscribeOutsideMouseEvents&&(this._unsubscribeOutsideMouseEvents(),this._unsubscribeOutsideMouseEvents=null),null!==this._unsubscribeOutsideTouchEvents&&(this._unsubscribeOutsideTouchEvents(),this._unsubscribeOutsideTouchEvents=null),null!==this._unsubscribeMousemove&&(this._unsubscribeMousemove(),this._unsubscribeMousemove=null),null!==this._unsubscribeMouseWheel&&(this._unsubscribeMouseWheel(),this._unsubscribeMouseWheel=null),null!==this._unsubscribeContextMenu&&(this._unsubscribeContextMenu(),this._unsubscribeContextMenu=null),null!==this._unsubscribeRootMouseEvents&&(this._unsubscribeRootMouseEvents(),this._unsubscribeRootMouseEvents=null),null!==this._unsubscribeRootTouchEvents&&(this._unsubscribeRootTouchEvents(),this._unsubscribeRootTouchEvents=null),null!==this._unsubscribeMobileSafariEvents&&(this._unsubscribeMobileSafariEvents(),this._unsubscribeMobileSafariEvents=null),this._clearLongTapTimeout(),this._resetClickTimeout()},t.prototype._mouseEnterHandler=function(t){var e,i,n,o=this;null===(e=this._unsubscribeMousemove)||void 0===e||e.call(this),null===(i=this._unsubscribeMouseWheel)||void 0===i||i.call(this),null===(n=this._unsubscribeContextMenu)||void 0===n||n.call(this);var r=this._mouseMoveHandler.bind(this);this._unsubscribeMousemove=function(){o._target.removeEventListener("mousemove",r)},this._target.addEventListener("mousemove",r);var a=this._mouseWheelHandler.bind(this);this._unsubscribeMouseWheel=function(){o._target.removeEventListener("wheel",a)},this._target.addEventListener("wheel",a,{passive:!1});var s=this._contextMenuHandler.bind(this);this._unsubscribeContextMenu=function(){o._target.removeEventListener("contextmenu",s)},this._target.addEventListener("contextmenu",s,{passive:!1}),this._firesTouchEvents(t)||(this._processEvent(this._makeCompatEvent(t),this._handler.mouseEnterEvent),this._acceptMouseLeave=!0)},t.prototype._resetClickTimeout=function(){null!==this._clickTimeoutId&&clearTimeout(this._clickTimeoutId),this._clickCount=0,this._clickTimeoutId=null,this._clickCoordinate={x:-1/0,y:1/0}},t.prototype._resetTapTimeout=function(){null!==this._tapTimeoutId&&clearTimeout(this._tapTimeoutId),this._tapCount=0,this._tapTimeoutId=null,this._tapCoordinate={x:-1/0,y:1/0}},t.prototype._mouseMoveHandler=function(t){this._mousePressed||null!==this._touchMoveStartCoordinate||this._firesTouchEvents(t)||(this._processEvent(this._makeCompatEvent(t),this._handler.mouseMoveEvent),this._acceptMouseLeave=!0)},t.prototype._mouseWheelHandler=function(t){if(Math.abs(t.deltaX)>Math.abs(t.deltaY)){if(void 0===this._handler.mouseWheelHortEvent)return;if(this._preventDefault(t),0===Math.abs(t.deltaX))return;this._handler.mouseWheelHortEvent(this._makeCompatEvent(t),-t.deltaX)}else{if(void 0===this._handler.mouseWheelVertEvent)return;var e=-t.deltaY/100;if(0===e)return;switch(this._preventDefault(t),t.deltaMode){case t.DOM_DELTA_PAGE:e*=120;break;case t.DOM_DELTA_LINE:e*=32}if(0!==e){var i=Math.sign(e)*Math.min(1,Math.abs(e));this._handler.mouseWheelVertEvent(this._makeCompatEvent(t),i)}}},t.prototype._contextMenuHandler=function(t){this._preventDefault(t)},t.prototype._touchMoveHandler=function(t){var e=this._touchWithId(t.changedTouches,this._activeTouchId);if(null!==e&&(this._lastTouchEventTimeStamp=this._eventTimeStamp(t),null===this._startPinchMiddleCoordinate&&!this._preventTouchDragProcess)){this._pinchPrevented=!0;var i=this._mouseTouchMoveWithDownInfo(this._getCoordinate(e),this._touchMoveStartCoordinate),n=i.yOffset;if(this._touchMoveExceededManhattanDistance||i.manhattanDistance>=5){if(!this._touchMoveExceededManhattanDistance){var o=.5*i.xOffset,r=n>=o&&!this._options.treatVertDragAsPageScroll(),a=o>n&&!this._options.treatHorzDragAsPageScroll();r||a||(this._preventTouchDragProcess=!0),this._touchMoveExceededManhattanDistance=!0,this._cancelTap=!0,this._clearLongTapTimeout(),this._resetTapTimeout()}this._preventTouchDragProcess||this._processEvent(this._makeCompatEvent(t,e),this._handler.touchMoveEvent)}}},t.prototype._mouseMoveWithDownHandler=function(t){0===t.button&&(5>this._mouseTouchMoveWithDownInfo(this._getCoordinate(t),this._mouseMoveStartCoordinate).manhattanDistance||(this._cancelClick=!0,this._resetClickTimeout()),this._cancelClick&&this._processEvent(this._makeCompatEvent(t),this._handler.pressedMouseMoveEvent))},t.prototype._mouseTouchMoveWithDownInfo=function(t,e){var i=Math.abs(e.x-t.x),n=Math.abs(e.y-t.y);return{xOffset:i,yOffset:n,manhattanDistance:i+n}},t.prototype._touchEndHandler=function(t){var e=this._touchWithId(t.changedTouches,this._activeTouchId);if(null===e&&0===t.touches.length&&(e=t.changedTouches[0]),null!==e){this._activeTouchId=null,this._lastTouchEventTimeStamp=this._eventTimeStamp(t),this._clearLongTapTimeout(),this._touchMoveStartCoordinate=null,null!==this._unsubscribeRootTouchEvents&&(this._unsubscribeRootTouchEvents(),this._unsubscribeRootTouchEvents=null);var i=this._makeCompatEvent(t,e);this._processEvent(i,this._handler.touchEndEvent),++this._tapCount,null!==this._tapTimeoutId&&this._tapCount>1?(30>this._mouseTouchMoveWithDownInfo(this._getCoordinate(e),this._tapCoordinate).manhattanDistance&&!this._cancelTap&&this._processEvent(i,this._handler.doubleTapEvent),this._resetTapTimeout()):this._cancelTap||(this._processEvent(i,this._handler.tapEvent),void 0!==this._handler.tapEvent&&this._preventDefault(t)),0===this._tapCount&&this._preventDefault(t),0===t.touches.length&&this._longTapActive&&(this._longTapActive=!1,this._preventDefault(t))}},t.prototype._mouseUpHandler=function(t){if(0===t.button){var e=this._makeCompatEvent(t);this._mouseMoveStartCoordinate=null,this._mousePressed=!1,null!==this._unsubscribeRootMouseEvents&&(this._unsubscribeRootMouseEvents(),this._unsubscribeRootMouseEvents=null),yn()&&this._target.ownerDocument.documentElement.removeEventListener("mouseleave",this._onFirefoxOutsideMouseUp),this._firesTouchEvents(t)||(this._processEvent(e,this._handler.mouseUpEvent),++this._clickCount,null!==this._clickTimeoutId&&this._clickCount>1?(5>this._mouseTouchMoveWithDownInfo(this._getCoordinate(t),this._clickCoordinate).manhattanDistance&&!this._cancelClick&&this._processEvent(e,this._handler.mouseDoubleClickEvent),this._resetClickTimeout()):this._cancelClick||this._processEvent(e,this._handler.mouseClickEvent))}},t.prototype._clearLongTapTimeout=function(){null!==this._longTapTimeoutId&&(clearTimeout(this._longTapTimeoutId),this._longTapTimeoutId=null)},t.prototype._touchStartHandler=function(t){if(null===this._activeTouchId){var e=t.changedTouches[0];this._activeTouchId=e.identifier,this._lastTouchEventTimeStamp=this._eventTimeStamp(t);var i=this._target.ownerDocument.documentElement;this._cancelTap=!1,this._touchMoveExceededManhattanDistance=!1,this._preventTouchDragProcess=!1,this._touchMoveStartCoordinate=this._getCoordinate(e),null!==this._unsubscribeRootTouchEvents&&(this._unsubscribeRootTouchEvents(),this._unsubscribeRootTouchEvents=null);var n=this._touchMoveHandler.bind(this),o=this._touchEndHandler.bind(this);this._unsubscribeRootTouchEvents=function(){i.removeEventListener("touchmove",n),i.removeEventListener("touchend",o)},i.addEventListener("touchmove",n,{passive:!1}),i.addEventListener("touchend",o,{passive:!1}),this._clearLongTapTimeout(),this._longTapTimeoutId=setTimeout(this._longTapHandler.bind(this,t),500),this._processEvent(this._makeCompatEvent(t,e),this._handler.touchStartEvent),null===this._tapTimeoutId&&(this._tapCount=0,this._tapTimeoutId=setTimeout(this._resetTapTimeout.bind(this),500),this._tapCoordinate=this._getCoordinate(e))}},t.prototype._mouseDownHandler=function(t){if(2===t.button)return this._preventDefault(t),void this._processEvent(this._makeCompatEvent(t),this._handler.mouseRightClickEvent);if(0===t.button){var e=this._target.ownerDocument.documentElement;yn()&&e.addEventListener("mouseleave",this._onFirefoxOutsideMouseUp),this._cancelClick=!1,this._mouseMoveStartCoordinate=this._getCoordinate(t),null!==this._unsubscribeRootMouseEvents&&(this._unsubscribeRootMouseEvents(),this._unsubscribeRootMouseEvents=null);var i=this._mouseMoveWithDownHandler.bind(this),n=this._mouseUpHandler.bind(this);this._unsubscribeRootMouseEvents=function(){e.removeEventListener("mousemove",i),e.removeEventListener("mouseup",n)},e.addEventListener("mousemove",i),e.addEventListener("mouseup",n),this._mousePressed=!0,this._firesTouchEvents(t)||(this._processEvent(this._makeCompatEvent(t),this._handler.mouseDownEvent),null===this._clickTimeoutId&&(this._clickCount=0,this._clickTimeoutId=setTimeout(this._resetClickTimeout.bind(this),500),this._clickCoordinate=this._getCoordinate(t)))}},t.prototype._init=function(){var t=this;this._target.addEventListener("mouseenter",this._mouseEnterHandler.bind(this)),this._target.addEventListener("touchcancel",this._clearLongTapTimeout.bind(this));var e=this._target.ownerDocument,i=function(e){null!=t._handler.mouseDownOutsideEvent&&(e.composed&&t._target.contains(e.composedPath()[0])||null!==e.target&&t._target.contains(e.target)||t._handler.mouseDownOutsideEvent({x:0,y:0,pageX:0,pageY:0}))};this._unsubscribeOutsideTouchEvents=function(){e.removeEventListener("touchstart",i)},this._unsubscribeOutsideMouseEvents=function(){e.removeEventListener("mousedown",i)},e.addEventListener("mousedown",i),e.addEventListener("touchstart",i,{passive:!0}),mn()&&(this._unsubscribeMobileSafariEvents=function(){t._target.removeEventListener("dblclick",t._onMobileSafariDoubleClick)},this._target.addEventListener("dblclick",this._onMobileSafariDoubleClick)),this._target.addEventListener("mouseleave",this._mouseLeaveHandler.bind(this)),this._target.addEventListener("touchstart",this._touchStartHandler.bind(this),{passive:!0}),this._target.addEventListener("mousedown",(function(t){if(1===t.button)return t.preventDefault(),!1})),this._target.addEventListener("mousedown",this._mouseDownHandler.bind(this)),this._initPinch(),this._target.addEventListener("touchmove",(function(){}),{passive:!1})},t.prototype._initPinch=function(){var t=this;void 0===this._handler.pinchStartEvent&&void 0===this._handler.pinchEvent&&void 0===this._handler.pinchEndEvent||(this._target.addEventListener("touchstart",(function(e){return t._checkPinchState(e.touches)}),{passive:!0}),this._target.addEventListener("touchmove",(function(e){if(2===e.touches.length&&null!==t._startPinchMiddleCoordinate&&void 0!==t._handler.pinchEvent){var i=t._getTouchDistance(e.touches[0],e.touches[1])/t._startPinchDistance;t._handler.pinchEvent(o(o({},t._startPinchMiddleCoordinate),{pageX:0,pageY:0}),i),t._preventDefault(e)}}),{passive:!1}),this._target.addEventListener("touchend",(function(e){t._checkPinchState(e.touches)})))},t.prototype._checkPinchState=function(t){1===t.length&&(this._pinchPrevented=!1),2!==t.length||this._pinchPrevented||this._longTapActive?this._stopPinch():this._startPinch(t)},t.prototype._startPinch=function(t){var e,i=null!==(e=this._target.getBoundingClientRect())&&void 0!==e?e:{left:0,top:0};this._startPinchMiddleCoordinate={x:(t[0].clientX-i.left+(t[1].clientX-i.left))/2,y:(t[0].clientY-i.top+(t[1].clientY-i.top))/2},this._startPinchDistance=this._getTouchDistance(t[0],t[1]),void 0!==this._handler.pinchStartEvent&&this._handler.pinchStartEvent({x:0,y:0,pageX:0,pageY:0}),this._clearLongTapTimeout()},t.prototype._stopPinch=function(){null!==this._startPinchMiddleCoordinate&&(this._startPinchMiddleCoordinate=null,void 0!==this._handler.pinchEndEvent&&this._handler.pinchEndEvent({x:0,y:0,pageX:0,pageY:0}))},t.prototype._mouseLeaveHandler=function(t){var e,i,n;null===(e=this._unsubscribeMousemove)||void 0===e||e.call(this),null===(i=this._unsubscribeMouseWheel)||void 0===i||i.call(this),null===(n=this._unsubscribeContextMenu)||void 0===n||n.call(this),this._firesTouchEvents(t)||this._acceptMouseLeave&&(this._processEvent(this._makeCompatEvent(t),this._handler.mouseLeaveEvent),this._acceptMouseLeave=!mn())},t.prototype._longTapHandler=function(t){var e=this._touchWithId(t.touches,this._activeTouchId);null!==e&&(this._processEvent(this._makeCompatEvent(t,e),this._handler.longTapEvent),this._cancelTap=!0,this._longTapActive=!0)},t.prototype._firesTouchEvents=function(t){var e;return void 0!==(null===(e=t.sourceCapabilities)||void 0===e?void 0:e.firesTouchEvents)?t.sourceCapabilities.firesTouchEvents:this._eventTimeStamp(t)<this._lastTouchEventTimeStamp+500},t.prototype._processEvent=function(t,e){null==e||e.call(this._handler,t)},t.prototype._makeCompatEvent=function(t,e){var i,n=this,o=null!=e?e:t,r=null!==(i=this._target.getBoundingClientRect())&&void 0!==i?i:{left:0,top:0};return{x:o.clientX-r.left,y:o.clientY-r.top,pageX:o.pageX,pageY:o.pageY,isTouch:!t.type.startsWith("mouse")&&"contextmenu"!==t.type&&"click"!==t.type,preventDefault:function(){"touchstart"!==t.type&&n._preventDefault(t)}}},t.prototype._getTouchDistance=function(t,e){var i=t.clientX-e.clientX,n=t.clientY-e.clientY;return Math.sqrt(i*i+n*n)},t.prototype._preventDefault=function(t){t.cancelable&&t.preventDefault()},t.prototype._getCoordinate=function(t){return{x:t.pageX,y:t.pageY}},t.prototype._eventTimeStamp=function(t){var e;return null!==(e=t.timeStamp)&&void 0!==e?e:performance.now()},t.prototype._touchWithId=function(t,e){for(var i=0;t.length>i;++i)if(t[i].identifier===e)return t[i];return null},t}(),bn=function(){function e(t,e){var i=this;this._flingStartTime=(new Date).getTime(),this._flingScrollRequestId=null,this._startScrollCoordinate=null,this._touchCoordinate=null,this._touchCancelCrosshair=!1,this._touchZoomed=!1,this._pinchScale=1,this._mouseDownWidget=null,this._prevYAxisExtremum=null,this._xAxisStartScaleCoordinate=null,this._xAxisStartScaleDistance=0,this._xAxisScale=1,this._yAxisStartScaleDistance=0,this._mouseMoveTriggerWidgetInfo={pane:null,widget:null},this._boundKeyBoardDownEvent=function(t){if(t.shiftKey)switch(t.code){case"Equal":i._chart.getChartStore().getTimeScaleStore().zoom(.5);break;case"Minus":i._chart.getChartStore().getTimeScaleStore().zoom(-.5);break;case"ArrowLeft":(e=i._chart.getChartStore().getTimeScaleStore()).startScroll(),e.scroll(-3*e.getBarSpace().bar);break;case"ArrowRight":var e;(e=i._chart.getChartStore().getTimeScaleStore()).startScroll(),e.scroll(3*e.getBarSpace().bar)}},this._container=t,this._chart=e,this._event=new wn(t,this,{treatVertDragAsPageScroll:function(){return!1},treatHorzDragAsPageScroll:function(){return!1}}),t.addEventListener("keydown",this._boundKeyBoardDownEvent)}return e.prototype.pinchStartEvent=function(){return this._touchZoomed=!0,this._pinchScale=1,!0},e.prototype.pinchEvent=function(t,e){var i=this._findWidgetByEvent(t),n=i.pane,o=i.widget;if((null==n?void 0:n.getId())!==ni&&(null==o?void 0:o.getName())===Ze){var r=this._makeWidgetEvent(t,o),a=5*(e-this._pinchScale);return this._pinchScale=e,this._chart.getChartStore().getTimeScaleStore().zoom(a,{x:r.x,y:r.y}),!0}return!1},e.prototype.mouseWheelHortEvent=function(t,e){var i=this._chart.getChartStore().getTimeScaleStore();return i.startScroll(),i.scroll(e),!0},e.prototype.mouseWheelVertEvent=function(t,e){var i,n,o=this._findWidgetByEvent(t),r=o.pane,a=o.widget,s=null!==(i=t.isTouch)&&void 0!==i&&i,l=this._makeWidgetEvent(t,a),u=null,c=null==a?void 0:a.getName();if(s){if(c!==Ze&&c!==Ge){var h=null!==(n=null==r?void 0:r.getAxisComponent().getExtremum())&&void 0!==n?n:null;return null!==h&&this._changeExtremumForYAxis({pane:r,scale:1-e/10,extremum:h,force:!0}),!0}u={x:l.x,y:l.y}}else c===Ze&&(u={x:l.x,y:l.y});return null!==u&&(this._chart.getChartStore().getTimeScaleStore().zoom(e,{x:l.x,y:l.y}),!0)},e.prototype.mouseDownEvent=function(t){var e,i,n=this._findWidgetByEvent(t),r=n.pane,a=n.widget;if(this._mouseDownWidget=a,null!==a){this._onShowMenuChange(!1,a);var s=this._makeWidgetEvent(t,a);switch(a.getName()){case $e:return a.dispatchEvent("mouseDownEvent",s);case Ze:var l=null!==(e=null==r?void 0:r.getAxisComponent().getExtremum())&&void 0!==e?e:null;return this._prevYAxisExtremum=null===l?l:o({},l),this._startScrollCoordinate={x:s.x,y:s.y},this._chart.getChartStore().getTimeScaleStore().startScroll(),a.dispatchEvent("mouseDownEvent",s);case Ge:return(u=a.dispatchEvent("mouseDownEvent",s))&&this._chart.updatePane(1),this._xAxisStartScaleCoordinate={x:s.x,y:s.y},this._xAxisStartScaleDistance=s.pageX,u;case Je:var u;return(u=a.dispatchEvent("mouseDownEvent",s))&&this._chart.updatePane(1),l=null!==(i=null==r?void 0:r.getAxisComponent().getExtremum())&&void 0!==i?i:null,this._prevYAxisExtremum=null===l?l:o({},l),this._yAxisStartScaleDistance=s.pageY,u}}return!1},e.prototype.mouseMoveEvent=function(t){var e,i,n,o=this._findWidgetByEvent(t),r=o.pane,a=o.widget,s=this._makeWidgetEvent(t,a);if((null===(e=this._mouseMoveTriggerWidgetInfo.pane)||void 0===e?void 0:e.getId())===(null==r?void 0:r.getId())&&(null===(i=this._mouseMoveTriggerWidgetInfo.widget)||void 0===i?void 0:i.getName())===(null==a?void 0:a.getName())||(null==a||a.dispatchEvent("mouseEnterEvent",s),null===(n=this._mouseMoveTriggerWidgetInfo.widget)||void 0===n||n.dispatchEvent("mouseLeaveEvent",s),this._mouseMoveTriggerWidgetInfo={pane:r,widget:a}),null!==a)switch(a.getName()){case Ze:var l=a.dispatchEvent("mouseMoveEvent",s),u=this._chart.getChartStore(),c={x:s.x,y:s.y,paneId:null==r?void 0:r.getId()};return l&&null!==u.getTooltipStore().getActiveIconInfo()&&(c=void 0,null!==a&&(a.getContainer().style.cursor="pointer")),this._chart.getChartStore().getCrosshairStore().set(c),l;case $e:case Ge:case Je:return l=a.dispatchEvent("mouseMoveEvent",s),this._chart.getChartStore().getCrosshairStore().set(),l}return!1},e.prototype.pressedMouseMoveEvent=function(t){var e,i,n,o;if(null!==this._mouseDownWidget&&this._mouseDownWidget.getName()===$e)return this._mouseDownWidget.dispatchEvent("pressedMouseMoveEvent",t);var r=this._findWidgetByEvent(t),a=r.pane,s=r.widget;if(null!==s&&(null===(e=this._mouseDownWidget)||void 0===e?void 0:e.getPane().getId())===(null==a?void 0:a.getId())&&(null===(i=this._mouseDownWidget)||void 0===i?void 0:i.getName())===s.getName()){var l=this._makeWidgetEvent(t,s);switch(s.getName()){case Ze:var u=s.getBounding();if(!(w=s.dispatchEvent("pressedMouseMoveEvent",l))&&null!==this._startScrollCoordinate){var c=null==a?void 0:a.getAxisComponent();if(null!==this._prevYAxisExtremum&&!c.getAutoCalcTickFlag()){var h=this._prevYAxisExtremum,d=h.min,p=h.max,v=F(h.range,b=(null!==(n=null==c?void 0:c.isReverse())&&void 0!==n&&n?this._startScrollCoordinate.y-l.y:l.y-this._startScrollCoordinate.y)/u.height),g=R(d,v),f=R(p,v),y=c.convertToRealValue(g),m=c.convertToRealValue(f);c.setExtremum({min:g,max:f,range:B(f,g),realMin:y,realMax:m,realRange:B(m,y)})}var x=l.x-this._startScrollCoordinate.x;this._chart.getChartStore().getTimeScaleStore().scroll(x)}return this._chart.getChartStore().getCrosshairStore().set({x:l.x,y:l.y,paneId:null==a?void 0:a.getId()}),w;case Ge:if(w=s.dispatchEvent("pressedMouseMoveEvent",l))this._chart.updatePane(1);else{var _=10*((b=this._xAxisStartScaleDistance/l.pageX)-this._xAxisScale);this._xAxisScale=b,this._chart.getChartStore().getTimeScaleStore().zoom(_,null!==(o=this._xAxisStartScaleCoordinate)&&void 0!==o?o:void 0)}return w;case Je:var w,b;return(w=s.dispatchEvent("pressedMouseMoveEvent",l))?this._chart.updatePane(1):null!==this._prevYAxisExtremum&&this._changeExtremumForYAxis({pane:a,scale:b=l.pageY/this._yAxisStartScaleDistance,extremum:this._prevYAxisExtremum}),w}}return!1},e.prototype.mouseUpEvent=function(t){var e=this._findWidgetByEvent(t).widget,i=!1;if(null!==e){var n=this._makeWidgetEvent(t,e);switch(e.getName()){case Ze:case $e:case Ge:case Je:i=e.dispatchEvent("mouseUpEvent",n)}i&&this._chart.updatePane(1)}return this._mouseDownWidget=null,this._startScrollCoordinate=null,this._prevYAxisExtremum=null,this._xAxisStartScaleCoordinate=null,this._xAxisStartScaleDistance=0,this._xAxisScale=1,this._yAxisStartScaleDistance=0,i},e.prototype.mouseClickEvent=function(t){var e=this._findWidgetByEvent(t).widget;if(null!==e){this._onShowMenuChange(!1,e);var i=this._makeWidgetEvent(t,e);return e.dispatchEvent("mouseClickEvent",i)}return!1},e.prototype.mouseRightClickEvent=function(t){var e=this._findWidgetByEvent(t).widget,i=!1;if(null!==e){var n=this._makeWidgetEvent(t,e);switch(this._onShowMenuChange(!0,e,n),e.getName()){case Ze:case Ge:case Je:i=e.dispatchEvent("mouseRightClickEvent",n)}i&&this._chart.updatePane(1)}return!1},e.prototype.mouseDoubleClickEvent=function(t){var e=this._findWidgetByEvent(t),i=e.pane,n=e.widget;if(null!==n)switch(this._onShowMenuChange(!1,n),n.getName()){case Ze:var o=this._makeWidgetEvent(t,n);return n.dispatchEvent("mouseDoubleClickEvent",o);case Je:var r=null==i?void 0:i.getAxisComponent();if(!r.getAutoCalcTickFlag())return r.setAutoCalcTickFlag(!0),this._chart.adjustPaneViewport(!1,!0,!0,!0),!0}return!1},e.prototype.mouseLeaveEvent=function(){return this._chart.getChartStore().getCrosshairStore().set(),!0},e.prototype.touchStartEvent=function(t){var e=this._findWidgetByEvent(t),i=e.pane,n=e.widget;if(null!==n){this._onShowMenuChange(!1,n);var o=this._makeWidgetEvent(t,n);switch(n.getName()){case Ze:var r=this._chart.getChartStore(),a=r.getCrosshairStore();if(n.dispatchEvent("mouseDownEvent",o))return this._touchCancelCrosshair=!0,this._touchCoordinate=null,a.set(void 0,!0),this._chart.updatePane(1),!0;if(null!==this._flingScrollRequestId&&(clearTimeout(this._flingScrollRequestId),this._flingScrollRequestId=null),this._flingStartTime=(new Date).getTime(),this._startScrollCoordinate={x:o.x,y:o.y},r.getTimeScaleStore().startScroll(),this._touchZoomed=!1,null!==this._touchCoordinate){var s=o.x-this._touchCoordinate.x,l=o.y-this._touchCoordinate.y;10>Math.sqrt(s*s+l*l)?(this._touchCoordinate={x:o.x,y:o.y},a.set({x:o.x,y:o.y,paneId:null==i?void 0:i.getId()})):(this._touchCoordinate=null,this._touchCancelCrosshair=!0,a.set())}return!0;case Ge:case Je:var u=n.dispatchEvent("mouseDownEvent",o);return u&&this._chart.updatePane(1),u}}return!1},e.prototype.touchMoveEvent=function(t){var e,i,n,o=this._findWidgetByEvent(t),r=o.pane,a=o.widget;if(null!==a){var s=this._makeWidgetEvent(t,a),l=a.getName(),u=this._chart.getChartStore(),c=u.getCrosshairStore();switch(l){case Ze:if(a.dispatchEvent("pressedMouseMoveEvent",s))return null===(e=s.preventDefault)||void 0===e||e.call(s),c.set(void 0,!0),this._chart.updatePane(1),!0;if(null!==this._touchCoordinate)null===(i=s.preventDefault)||void 0===i||i.call(s),c.set({x:s.x,y:s.y,paneId:null==r?void 0:r.getId()});else if(null!==this._startScrollCoordinate&&Math.abs(this._startScrollCoordinate.x-s.x)>this._startScrollCoordinate.y-s.y){var h=s.x-this._startScrollCoordinate.x;u.getTimeScaleStore().scroll(h)}return!0;case Ge:case Je:var d=a.dispatchEvent("pressedMouseMoveEvent",s);return d&&(null===(n=s.preventDefault)||void 0===n||n.call(s),this._chart.updatePane(1)),d}}return!1},e.prototype.touchEndEvent=function(t){var e=this,i=this._findWidgetByEvent(t).widget;if(null!==i){var n=this._makeWidgetEvent(t,i);switch(i.getName()){case Ze:if(i.dispatchEvent("mouseUpEvent",n),null!==this._startScrollCoordinate){var o=(new Date).getTime()-this._flingStartTime,r=(n.x-this._startScrollCoordinate.x)/(o>0?o:1)*20;if(200>o&&Math.abs(r)>0){var a=this._chart.getChartStore().getTimeScaleStore(),s=function(){e._flingScrollRequestId=ci((function(){a.startScroll(),a.scroll(r),1>Math.abs(r*=.975)?null!==e._flingScrollRequestId&&(hi(e._flingScrollRequestId),e._flingScrollRequestId=null):s()}))};s()}}return!0;case Ge:case Je:i.dispatchEvent("mouseUpEvent",n)&&this._chart.updatePane(1)}}return!1},e.prototype.tapEvent=function(t){var e=this._findWidgetByEvent(t),i=e.pane,n=e.widget,o=!1;if(null!==n){this._onShowMenuChange(!1,n);var r=this._makeWidgetEvent(t,n),a=n.dispatchEvent("mouseClickEvent",r);if(n.getName()===Ze){var s=this._makeWidgetEvent(t,n),l=this._chart.getChartStore().getCrosshairStore();a?(this._touchCancelCrosshair=!0,this._touchCoordinate=null,l.set(void 0,!0),o=!0):(this._touchCancelCrosshair||this._touchZoomed||(this._touchCoordinate={x:s.x,y:s.y},l.set({x:s.x,y:s.y,paneId:null==i?void 0:i.getId()},!0),o=!0),this._touchCancelCrosshair=!1)}(o||a)&&this._chart.updatePane(1)}return o},e.prototype.doubleTapEvent=function(t){return this.mouseDoubleClickEvent(t)},e.prototype.longTapEvent=function(t){var e=this._findWidgetByEvent(t),i=e.pane,n=e.widget;if(null!==n&&n.getName()===Ze){var o=this._makeWidgetEvent(t,n);return this._touchCoordinate={x:o.x,y:o.y},this._chart.getChartStore().getCrosshairStore().set({x:o.x,y:o.y,paneId:null==i?void 0:i.getId()}),!0}return!1},e.prototype._findWidgetByEvent=function(t){var e,i,n=this._chart.getAllPanes(),o=t.x,r=t.y,a=null;try{for(var s=l(n),c=s.next();!c.done;c=s.next()){var h=u(c.value,2)[1],d=h.getBounding();if(!(d.left>o||o>d.left+d.width||d.top>r||r>d.top+d.height)){a=h;break}}}catch(t){e={error:t}}finally{try{c&&!c.done&&(i=s.return)&&i.call(s)}finally{if(e)throw e.error}}null===a&&(a=this._chart.getPaneById(ni));var p=null;if(null!==a){var v=a.getSeparatorWidget();if(null!==v){var g=v.getBounding();g.left>o||o>g.left+g.width||g.top>r||r>g.top+7||(p=v)}if(null===p){var f=a.getMainWidget(),y=f.getBounding();y.left>o||o>y.left+y.width||y.top>r||r>y.top+y.height||(p=f)}if(null===p){var m=a.getYAxisWidget();if(null!==m){var x=m.getBounding();x.left>o||o>x.left+x.width||x.top>r||r>x.top+x.height||(p=m)}}}return{pane:a,widget:p}},e.prototype._makeWidgetEvent=function(t,e){var i,n,r,a=null!==(i=null==e?void 0:e.getBounding())&&void 0!==i?i:null;return o(o({},t),{x:t.x-(null!==(n=null==a?void 0:a.left)&&void 0!==n?n:0),y:t.y-(null!==(r=null==a?void 0:a.top)&&void 0!==r?r:0)})},e.prototype._changeExtremumForYAxis=function(e){var i=e.pane,n=e.extremum,o=e.force,r=void 0!==o&&o,a=n.min,s=n.max,l=n.range,u=F(l,e.scale),c=M(B(u,l),2),h=B(a,c),d=R(s,c),p=null==i?void 0:i.getAxisComponent(),v=p.convertToRealValue(h),g=p.convertToRealValue(d),f=this._chart.getChartStore().getPrecision().price;f>0&&j(u,M(1,V(10,f)))||(p.setExtremum({min:h,max:d,range:u,realMin:v,realMax:g,realRange:B(g,v)}),this._chart.getChartStore().getActionStore().execute(t.ActionType.OnScrollYAxis),this._chart.adjustPaneViewport(!1,!0,!0,!0,r))},e.prototype._onShowMenuChange=function(e,i,n){var o=i.getPane();o.getChart().getChartStore().getActionStore().execute(t.ActionType.OnShowMenuChange,{show:e,widgetName:null==i?void 0:i.getName(),paneName:o.getName(),event:n})},e.prototype.destroy=function(){this._container.removeEventListener("keydown",this._boundKeyBoardDownEvent),this._event.destroy()},e}(),Cn=function(t,e,i,n){var o,r,a;if(void 0===xn){var s=document.createElement("canvas"),l=null!==(a=null===(r=null===(o=s.ownerDocument)||void 0===o?void 0:o.defaultView)||void 0===r?void 0:r.devicePixelRatio)&&void 0!==a?a:2;(xn=s.getContext("2d")).scale(l,l)}return xn.font="".concat(null!=i?i:"normal"," ").concat(null!=e?e:12,"px ").concat(null!=n?n:"Helvetica Neue"),Math.round(xn.measureText(t).width)};function Sn(e){var i=this,n=e.id,a=e.direction,l=e.point,u=e.text,c=e.tooltipText,h=e.onMouseEnter,d=e.onMouseLeave;if(l){var p=!1;return this.createOverlay({id:n,name:"historyOrder",extendData:{showTooltip:!1,direction:a,text:u},points:[l],styles:{offset:e.offset,arrowColor:e.arrowColor,tooltipBackgroundColor:"#525658",cursor:"pointer"},onMouseEnter:function(e){return r(i,void 0,void 0,(function(){var i,r;return s(this,(function(s){switch(s.label){case 0:return this.getDom(ei,t.DomPosition.Main).style.cursor="wait",p=!0,(r=h)?[4,h(e)]:[3,2];case 1:r=s.sent(),s.label=2;case 2:return i=r||{},p?(this.getDom(ei,t.DomPosition.Main).style.cursor="pointer",null==this||this.overrideOverlay({id:n,extendData:o({showTooltip:!0,direction:a,text:u,tooltipText:c},i)}),[2,!1]):[2,!1]}}))}))},onMouseLeave:function(e){return r(i,void 0,void 0,(function(){return s(this,(function(i){switch(i.label){case 0:return d?[4,d(e)]:[3,2];case 1:i.sent(),i.label=2;case 2:return this.overrideOverlay({id:n,extendData:{showTooltip:!1,direction:a,text:u}}),this.getDom(ei,t.DomPosition.Main).style.cursor="crosshair",p=!1,[2,!1]}}))}))}})}}t.HistoryOrderArrowDirection=void 0,(_n=t.HistoryOrderArrowDirection||(t.HistoryOrderArrowDirection={}))[_n.Up=0]="Up",_n[_n.Down=1]="Down";var Tn={name:"historyOrder",totalStep:2,lock:!0,createPointFigures:function(e){var i,n,r,a,s,l,h,d=e.coordinates,p=e.overlay,v=e.barSpace,g=function(e,i,n,r){void 0===n&&(n=7),void 0===r&&(r=2);var a=i===t.HistoryOrderArrowDirection.Up,s=a?-1:1,l=Math.round(2*n/3),u=Math.round(n/2),c=function(t,e,i,n,o){return{x:t.x,y:t.y-n*e-i*n-o*n}}(e,n,r,s,u),h=function(t,e){return{x:t.x-e,y:t.y-e}}(c,n),d=function(t,e,i,n){return{x:t.x,y:t.y+n*(e+i)}}(c,n,u,s);return{center:c,rectAttr:o(o({},h),{width:2*n,height:2*n}),angleAttr:{coordinates:function(t,e,i,n){return[t,{x:t.x-e/2,y:t.y-(i+1)*n},{x:t.x+e/2,y:t.y-(i+1)*n}]}(d,l,u,s)},textAttr:function(t,e,i,n){return{x:t.x-.5*e,y:t.y+e/2*1.3*i*(n?1:-1)}}(c,n,s,a)}}(d[0],p.extendData.direction,8,v.bar-v.gapBar>2?v.bar-v.gapBar:2),f=g.rectAttr,y=g.angleAttr,m=g.textAttr;p.extendData._p=o(o({},g.center),{halfWidth:8});var x=null!==(n=null===(i=p.styles)||void 0===i?void 0:i.offset)&&void 0!==n?n:0,_=p.extendData.direction===t.HistoryOrderArrowDirection.Up?1:-1,w=[{type:"rect",ignoreEvent:["mouseDownEvent","mouseRightClickEvent"],attrs:f,styles:{style:"fill",color:null===(r=p.styles)||void 0===r?void 0:r.arrowColor,borderRadius:4}},{type:"polygon",ignoreEvent:["mouseDownEvent","mouseRightClickEvent"],attrs:y,styles:{style:"fill",color:null===(a=p.styles)||void 0===a?void 0:a.arrowColor}},{type:"text",ignoreEvent:!0,attrs:o(o({},m),{text:p.extendData.text||""}),styles:{color:"#fff",align:"center",size:11.2}}],b=null!==(s=p.extendData.tooltipText)&&void 0!==s?s:"";if(p.extendData.showTooltip&&b){for(var C=null===(l=p.styles)||void 0===l?void 0:l.tooltipBackgroundColor,S=284,T=S,E=b.split(" "),I=0;E.length>I;I++){var D=E[I];if(Cn(D)>S){for(var P=1;D.length>P&&Cn(D.substring(0,P))<=S;)P++;E.splice(I+1,0,D.substring(P-1)),E[I]=D.substring(0,P-1)}}var k=[],M=0;for(I=0;E.length>I;I++){var A=null!==(h=k[M])&&void 0!==h?h:"",B=A+(A?" ":"")+E[I];Cn(B)>S?(M++,k[M]=E[I]):k[M]=B}var L=k.map((function(t){return Cn(null!=t?t:"")}));T=Math.min(Math.max.apply(Math,c([],u(L),!1)),S);var F=d[0].x-(T+=16)/2;w.push({type:"polygon",ignoreEvent:!0,attrs:{coordinates:[{x:d[0].x,y:d[0].y+x+4*_*-1},{x:d[0].x-6,y:d[0].y+x+10*_*-1},{x:d[0].x+6,y:d[0].y+x+10*_*-1}]},styles:{color:C}}),w.push({type:"rect",ignoreEvent:!0,attrs:{x:F,y:d[0].y+x+10*_*-1+(1===_?20*k.length:0)*_*-1,width:T,height:20*k.length},styles:{color:C,borderRadius:4}}),k.forEach((function(t,e){w.push({type:"text",ignoreEvent:!0,attrs:{x:F+8,y:d[0].y+x+20*(1===_?k.length-e:e+1)*_*-1-e,align:"left",baseline:"middle",text:t},styles:{color:"#ffffff"}})}))}return w}},En="extendDataText",In="closeBtn",Dn="switch",Pn="profitBtn",kn="lossBtn",Mn=19,An=Mn,Bn=11,Ln="-apple-system, BlinkMacSystemFont, Segoe UI, Roboto, Helvetica Neue, Helvetica, Arial, sans-serif",Fn=function(t){var e=t.figures,i=t.x,n=t.y,o=t.text,r=t.tooltipBackgroundColor,a=t.tooltipTextColor,s=Cn(o)+16;e.push({type:"polygon",ignoreEvent:!0,attrs:{coordinates:[{x:+i,y:n-15},{x:+i-6,y:n-21},{x:+i+6,y:n-21}]},styles:{color:r}}),e.push({type:"rect",ignoreEvent:!0,attrs:{x:i-s/2,y:n-45,width:s,height:24},styles:{color:r,borderRadius:4}}),e.push({type:"text",ignoreEvent:!0,attrs:{x:+i,y:n-33,align:"center",baseline:"middle",text:o},styles:{color:a||"#ffffff"}})},On=function(t){var e=t.figures,i=t.key,n=t.x,o=t.y,r=t.width,a=t.text,s=t.backgroundColor,l=t.textColor,u=t.borderColor,c=t.borderRadius;e.push({key:void 0===i?"":i,type:"rect",ignoreEvent:["mouseRightClickEvent"],attrs:{x:n,y:o-9.5,width:r,height:Mn},styles:{style:"stroke_fill",color:s,borderColor:void 0===u?s:u,borderRadius:void 0===c?0:c}}),e.push({type:"text",ignoreEvent:!0,attrs:{x:+n+r/2,y:o,align:"center",baseline:"middle",text:a},styles:{color:l,size:Bn,family:Ln}})},Rn=function(t){var e=t.figures,i=t.x,n=t.y,o=t.width,r=t.lineColor;e.push({type:"rect",ignoreEvent:["mouseDownEvent","mouseRightClickEvent"],attrs:{x:i,y:n-9.5,width:o,height:Mn},styles:{style:"stroke_fill",color:"transparent",borderColor:"transparent"}}),e.push({type:"line",ignoreEvent:!0,attrs:{coordinates:[{x:i,y:n},{x:+i+ +o,y:n}]},styles:{style:"dashed",color:r}})};function Nn(e){var i=this,n=null,r=function(e){var r=e.onReverse,a=e.onClose,s=e.closeBtnTooltipText,l=void 0===s?"":s,u=e.closeBtnText,c=e.reverseBtnTooltipText,h=e.tooltipText,d=e.profitBtnText,p=e.profitBtnTooltipText,v=e.lossBtnText,g=e.lossBtnTooltipText,f=e.onClickProfitBtn,y=e.onClickLossBtn,m=e.onMoveProfitBtn,x=e.onMoveLossBtn,_={text:e.text,volume:e.volume,closeBtnText:void 0===u?"\u2715":u,showProfitBtn:e.showProfitBtn,showLossBtn:e.showLossBtn},w=function(e){i.getChartStore().getCrosshairStore().setStatus(!1);var n=e.overlay.id,r=o(o({},_),{profitBtnText:d,lossBtnText:v});switch(e.figureKey){case En:i.overrideOverlay({id:n,extendData:o(o({},r),{tooltipText:h})}),i.getDom(ei,t.DomPosition.Main).style.cursor="default";break;case In:i.overrideOverlay({id:n,extendData:o(o({},r),{closeBtnTooltipText:l})}),i.getDom(ei,t.DomPosition.Main).style.cursor="pointer";break;case Dn:i.overrideOverlay({id:n,extendData:o(o({},r),{reverseBtnTooltipText:c})}),i.getDom(ei,t.DomPosition.Main).style.cursor="pointer";break;case Pn:i.overrideOverlay({id:n,extendData:o(o({},r),{profitBtnTooltipText:p})}),i.getDom(ei,t.DomPosition.Main).style.cursor="pointer";break;case kn:i.overrideOverlay({id:n,extendData:o(o({},r),{lossBtnTooltipText:g})}),i.getDom(ei,t.DomPosition.Main).style.cursor="pointer";break;default:i.overrideOverlay({id:n,extendData:r}),i.getDom(ei,t.DomPosition.Main).style.cursor="default"}return!1};return{name:"position",id:e.id,extendData:_,points:[{value:e.price}],styles:{color:e.color,textColor:e.textColor,volumeBackgroundColor:e.volumeBackgroundColor,switchBackgroundColor:e.switchBackgroundColor,closeBackgroundColor:e.closeBackgroundColor,volumeTextColor:e.volumeTextColor,tooltipBackgroundColor:e.tooltipBackgroundColor,tooltipColor:e.tooltipColor,closeBtnColor:e.closeBtnColor,profitOrLossColor:e.profitOrLossColor,profitOrLossBackgroundColor:e.profitOrLossBackgroundColor,profitOrLossPNLBackgroundColor:e.profitOrLossPNLBackgroundColor},onMouseEnter:w,onMouseMove:w,onMouseLeave:function(e){return i.overrideOverlay({id:e.overlay.id,extendData:_}),i.getChartStore().getCrosshairStore().setStatus(!0),i.getDom(ei,t.DomPosition.Main).style.cursor="crosshair",!1},onClick:function(t){switch(n&&clearTimeout(n),n=null,t.figureKey){case Dn:null==r||r(t);break;case In:null==a||a(t);break;case Pn:null==f||f();break;case kn:null==y||y()}return!1},onPressedMoving:function(t){var e,n,r,a,s,l=i.convertFromPixel([{y:null!==(e=t.y)&&void 0!==e?e:0}],{paneId:ei}),u=i.getPriceVolumePrecision(),c=W(l[0].value,u.price)+"";switch(t.figureKey){case Pn:var h=null!==(n=null==m?void 0:m(c))&&void 0!==n?n:{};i.overrideOverlay({id:t.overlay.id,extendData:o(o(o({},_),h),{profitBtnText:d,lossBtnText:v,profitBtnY:null!==(r=t.y)&&void 0!==r?r:0})});break;case kn:h=null!==(a=null==x?void 0:x(c))&&void 0!==a?a:{},i.overrideOverlay({id:t.overlay.id,extendData:o(o(o({},_),h),{profitBtnText:d,lossBtnText:v,lossBtnY:null!==(s=t.y)&&void 0!==s?s:0})})}return!0},onPressedMoveEnd:function(e){return n=setTimeout((function(){var t,n=i.convertFromPixel([{y:null!==(t=e.y)&&void 0!==t?t:0}],{paneId:ei}),o=i.getPriceVolumePrecision(),r=W(n[0].value,o.price)+"";switch(e.figureKey){case Pn:null==f||f(r);break;case kn:null==y||y(r)}}),20),i.overrideOverlay({id:e.overlay.id,extendData:_}),i.getChartStore().getCrosshairStore().setStatus(!0),i.getDom(ei,t.DomPosition.Main).style.cursor="crosshair",!1}}},a=this.createOverlay(r(e));return[a,function(t){var n,s,l=r(o(o({},e),t)),u=null===(s=null===(n=i.getOverlayById)||void 0===n?void 0:n.call(i,a))||void 0===s?void 0:s.extendData;l.extendData=o(o({},u),l.extendData),i.overrideOverlay(l)}]}var Vn,zn={name:"position",lock:!1,createPointFigures:function(t){var e,i,n,o,r,a,s,l,u,c,h,d,p,v,g,f,y,m,x,_,w,b,C,S,T,E,I,D,P,k,M,A,B,L,F,O,R,N,V,z,W,Y,H,j=t.bounding,X=t.overlay,K=null===(e=X.styles)||void 0===e?void 0:e.color,q=null===(i=X.styles)||void 0===i?void 0:i.textColor,U=t.coordinates[0].y,Z=X.extendData.text,G=Cn(Z)+12,J=null!==(n=X.extendData.volume)&&void 0!==n?n:0,$=Cn(J),Q=Math.max($+12,Mn),tt=null!==(o=X.extendData.closeBtnText)&&void 0!==o?o:"",et=Math.max(Mn,Cn(tt)+10),it=X.extendData.showProfitBtn,nt=X.extendData.showLossBtn,ot=null!==(r=X.extendData.profitBtnText)&&void 0!==r?r:"",rt=Math.max(Mn,Cn(ot)+16),at=null!==(a=X.extendData.profitPNLText)&&void 0!==a?a:"",st=Math.max(Mn,Cn(at)+12),lt=null!==(s=X.extendData.lossBtnText)&&void 0!==s?s:"",ut=Math.max(Mn,Cn(lt)+16),ct=null!==(l=X.extendData.lossPNLText)&&void 0!==l?l:"",ht=Math.max(Mn,Cn(ct)+12),dt=null!==(u=X.extendData.tooltipText)&&void 0!==u?u:"",pt=null!==(c=X.extendData.reverseBtnTooltipText)&&void 0!==c?c:"",vt=null!==(h=X.extendData.closeBtnTooltipText)&&void 0!==h?h:"",gt=null!==(d=X.extendData.profitBtnTooltipText)&&void 0!==d?d:"",ft=null!==(p=X.extendData.lossBtnTooltipText)&&void 0!==p?p:"",yt=null!==(v=X.extendData.profitBtnY)&&void 0!==v?v:0,mt=null!==(g=X.extendData.lossBtnY)&&void 0!==g?g:0,xt=[{key:En,type:"rect",ignoreEvent:["mouseDownEvent","mouseRightClickEvent"],attrs:{x:0,y:U-9.5,width:G,height:Mn},styles:{style:"stroke_fill",color:q,borderColor:q}},{type:"text",ignoreEvent:!0,attrs:{x:G/2,y:U,align:"center",baseline:"middle",text:Z},styles:{color:"#ffffff",size:Bn,family:Ln}},{type:"rect",ignoreEvent:["mouseDownEvent","mouseRightClickEvent"],attrs:{x:G,y:U-9.5,width:Q,height:Mn},styles:{style:"stroke_fill",borderColor:K,color:null!==(y=null===(f=X.styles)||void 0===f?void 0:f.volumeBackgroundColor)&&void 0!==y?y:"transparent"}},{type:"text",ignoreEvent:!0,attrs:{x:G+Q/2,y:U,align:"center",baseline:"middle",text:J,size:Bn,family:Ln},styles:{color:(null===(m=X.styles)||void 0===m?void 0:m.volumeTextColor)||"#ffffff"}},{key:Dn,type:"rect",ignoreEvent:["mouseDownEvent","mouseRightClickEvent"],attrs:{x:G+Q,y:U-9.5,width:An,height:An},styles:{style:"stroke_fill",borderColor:K,color:null!==(_=null===(x=X.styles)||void 0===x?void 0:x.switchBackgroundColor)&&void 0!==_?_:"transparent"}},{type:"line",ignoreEvent:!0,attrs:{coordinates:[{x:G+Q+7,y:U-5},{x:G+Q+7,y:U+5}]},styles:{color:K,size:1}},{type:"polygon",ignoreEvent:!0,attrs:{coordinates:[{x:G+Q+4.5,y:U-2.5},{x:G+Q+7,y:U-5},{x:G+Q+9.5,y:U-2.5}]},styles:{style:"fill",color:K,size:1}},{type:"line",ignoreEvent:!0,attrs:{coordinates:[{x:G+Q+13,y:U-5},{x:G+Q+13,y:U+5}]},styles:{color:K,size:1}},{type:"polygon",ignoreEvent:!0,attrs:{coordinates:[{x:G+Q+10.5,y:U+2.5},{x:G+Q+13,y:U+5},{x:G+Q+15.5,y:U+2.5}]},styles:{style:"fill",color:K,size:1}},{key:In,type:"rect",ignoreEvent:["mouseDownEvent","mouseRightClickEvent"],attrs:{x:G+Q+An,y:U-9.5,width:et,height:Mn},styles:{style:"stroke_fill",borderColor:K,color:null!==(b=null===(w=X.styles)||void 0===w?void 0:w.closeBackgroundColor)&&void 0!==b?b:"transparent",borderRadius:0}},{type:"text",ignoreEvent:!0,attrs:{x:G+Q+An+et/2,y:U,align:"center",baseline:"middle",text:tt},styles:{color:(null===(C=X.styles)||void 0===C?void 0:C.closeBtnColor)||"#ffffff",size:Bn,family:Ln}}],_t=G+Q+An+et,wt=0,bt=0;(ot.length>0||lt.length>0)&&Rn({figures:xt,x:_t,y:U,width:(wt=12)+(yt?rt:0),lineColor:K});var Ct=_t+wt,St=Ct;ot.length>0&&it&&(bt=4,St=Ct+rt,On({figures:xt,key:Pn,x:Ct,y:yt||U,width:rt,text:ot,backgroundColor:null===(S=X.styles)||void 0===S?void 0:S.profitOrLossBackgroundColor,textColor:null===(T=X.styles)||void 0===T?void 0:T.profitOrLossColor,borderRadius:2}));var Tt=St,Et=Tt;return lt.length>0&&nt&&(Et=(Tt+=bt)+ut,Rn({figures:xt,x:St,y:U,width:bt+(mt?ut:0),lineColor:K}),On({figures:xt,key:kn,x:Tt,y:mt||U,width:ut,text:lt,backgroundColor:null===(E=X.styles)||void 0===E?void 0:E.profitOrLossBackgroundColor,textColor:null===(I=X.styles)||void 0===I?void 0:I.profitOrLossColor,borderRadius:2})),xt.push({type:"line",ignoreEvent:!0,attrs:{coordinates:[{x:Et,y:U},{x:j.width,y:U}]},styles:{style:"dashed",color:K}}),yt&&(On({figures:xt,x:Ct+rt,y:yt,width:st,text:at,backgroundColor:null===(D=X.styles)||void 0===D?void 0:D.profitOrLossPNLBackgroundColor,textColor:null===(P=X.styles)||void 0===P?void 0:P.profitOrLossColor,borderColor:null===(k=X.styles)||void 0===k?void 0:k.profitOrLossBackgroundColor}),xt.push({type:"line",ignoreEvent:!0,attrs:{coordinates:[{x:Ct+rt+st,y:yt},{x:j.width,y:yt}]},styles:{style:"dashed",color:K}})),mt&&(On({figures:xt,x:Tt+ut,y:mt,width:ht,text:ct,backgroundColor:null===(M=X.styles)||void 0===M?void 0:M.profitOrLossPNLBackgroundColor,textColor:null===(A=X.styles)||void 0===A?void 0:A.profitOrLossColor,borderColor:null===(B=X.styles)||void 0===B?void 0:B.profitOrLossBackgroundColor}),xt.push({type:"line",ignoreEvent:!0,attrs:{coordinates:[{x:Tt+ut+ht,y:mt},{x:j.width,y:mt}]},styles:{style:"dashed",color:K}})),dt.length>0&&Fn({figures:xt,x:G/2,y:U,text:dt,tooltipBackgroundColor:null===(L=X.styles)||void 0===L?void 0:L.tooltipBackgroundColor,tooltipTextColor:null===(F=X.styles)||void 0===F?void 0:F.tooltipColor}),pt.length>0&&Fn({figures:xt,x:G+Q+9.5,y:U,text:pt,tooltipBackgroundColor:null===(O=X.styles)||void 0===O?void 0:O.tooltipBackgroundColor,tooltipTextColor:null===(R=X.styles)||void 0===R?void 0:R.tooltipColor}),vt.length>0&&Fn({figures:xt,x:G+Q+An+et/2,y:U,text:vt,tooltipBackgroundColor:null===(N=X.styles)||void 0===N?void 0:N.tooltipBackgroundColor,tooltipTextColor:null===(V=X.styles)||void 0===V?void 0:V.tooltipColor}),gt.length>0&&Fn({figures:xt,x:Ct+rt/2,y:U,text:gt,tooltipBackgroundColor:null===(z=X.styles)||void 0===z?void 0:z.tooltipBackgroundColor,tooltipTextColor:null===(W=X.styles)||void 0===W?void 0:W.tooltipColor}),ft.length>0&&Fn({figures:xt,x:Tt+ut/2,y:U,text:ft,tooltipBackgroundColor:null===(Y=X.styles)||void 0===Y?void 0:Y.tooltipBackgroundColor,tooltipTextColor:null===(H=X.styles)||void 0===H?void 0:H.tooltipColor}),xt},createYAxisFigures:function(t){var e,i,n=t.overlay,o=t.precision,r=t.yAxis,a=null===(e=n.styles)||void 0===e?void 0:e.color,s=n.points[0].value,l=[{type:"rectText",ignoreEvent:!0,attrs:{x:0,y:t.coordinates[0].y,baseline:"middle",text:"".concat(wt(void 0!==s?W(s,o.price,void 0,""):""))},styles:{style:"fill",family:Ln,size:Bn,color:"#ffffff",backgroundColor:a,borderRadius:0,paddingLeft:4,paddingTop:4,paddingRight:4,paddingBottom:4}}],u=n.extendData,c=u.profitBtnY,h=u.lossBtnY;return(c||h)&&l.push({type:"rectText",ignoreEvent:!0,attrs:{x:0,y:c||h,baseline:"middle",text:"".concat(wt(null!==(i=W(r.convertFromPixel(c||h),o.price))&&void 0!==i?i:""))},styles:{style:"fill",family:Ln,size:Bn,color:"#ffffff",backgroundColor:a,borderRadius:0,paddingLeft:4,paddingTop:4,paddingRight:4,paddingBottom:4}}),l}};t.currentOrderType=void 0,(Vn=t.currentOrderType||(t.currentOrderType={})).limit="limit",Vn.plan="plan",Vn.stop="stop",Vn.liquidate="liquidate";var Wn="extendDataText",Yn="volumeTooltip",Hn="thirdTextTooltip",jn="closeBtn",Xn=21,Kn=function(t){var e=t.figures,i=t.x,n=t.y,o=t.text,r=t.tooltipBackgroundColor,a=t.tooltipTextColor,s=t.isTooltipEnableNewLine,l=[o];s&&o.includes("\n")&&(l=o.split("\n"));var h=Math.max(l.length,1),d=Math.max.apply(Math,c([],u(l.map((function(t){return Cn(t)}))),!1))+16,p=20*h+4+0*(h-1);e.push({type:"polygon",ignoreEvent:!0,attrs:{coordinates:[{x:+i,y:n-15},{x:+i-6,y:n-Xn},{x:+i+6,y:n-Xn}]},styles:{color:r}}),e.push({type:"rect",ignoreEvent:!0,attrs:{x:i-d/2,y:n-21-p,width:d,height:p},styles:{color:r,borderRadius:4}}),l.reverse().forEach((function(t,o){var r=s&&l.length>1?"left":"center",u=+i;"left"===r&&(u=u+8-d/2),e.push({type:"text",ignoreEvent:!0,attrs:{x:u,y:n-33-20*o-0*o,align:r,baseline:"middle",text:t},styles:{color:a||"#ffffff"}})}))};function qn(e){var i=this,n=e.onMove,r=e.onClose,a=e.lock,s=e.volumeTooltipText,l=e.thirdTextTooltipText,u=e.onClickVolume,c=e.closeBtnTooltipText,h={text:e.text,volume:e.volume,isHideCloseBtn:e.isHideCloseBtn,isBodyOffset:e.isBodyOffset,thirdText:e.thirdText,isTooltipEnableNewLine:e.isTooltipEnableNewLine},d=function(t){var e=i.getOverlayById(t),n={};return e&&Object.keys(h).forEach((function(t){n[t]=e.extendData[t]})),n},p=function(e){i.getChartStore().getCrosshairStore().setStatus(!1);var n=d(e.overlay.id);return i.overrideOverlay(e.figureKey===Yn||e.figureKey===Wn?{id:e.overlay.id,extendData:o({volumeTooltipText:s},n)}:e.figureKey===jn?{id:e.overlay.id,extendData:o({closeBtnTooltipText:c},n)}:e.figureKey===Hn?{id:e.overlay.id,extendData:o({thirdTextTooltipText:l},n)}:{id:e.overlay.id,extendData:n}),i.getDom(ei,t.DomPosition.Main).style.cursor="pointer",!1};return this.createOverlay({name:e.name,id:e.id,lock:null!=a&&a,extendData:h,points:[{value:e.price}],styles:{color:e.color,offset:e.offset,bodyBackgroundColor:e.bodyBackgroundColor,closeBackgroundColor:e.closeBackgroundColor,volumeTextColor:e.volumeTextColor,tooltipTextColor:e.tooltipTextColor,tooltipBackgroundColor:e.tooltipBackgroundColor,volumeBackgroundColor:e.volumeBackgroundColor},onMouseEnter:p,onMouseMove:p,onMouseLeave:function(e){var n=d(e.overlay.id);return i.overrideOverlay({id:e.overlay.id,extendData:n}),i.getChartStore().getCrosshairStore().setStatus(!0),i.getDom(ei,t.DomPosition.Main).style.cursor="crosshair",!1},onClick:function(t){switch(t.figureKey){case Wn:case Yn:case Hn:null==u||u(t);break;case jn:null==r||r(t)}var e=d(t.overlay.id);return i.overrideOverlay({id:t.overlay.id,extendData:e}),!1},onPressedMoveEnd:function(t){var e=i.getChartStore().getPrecision().price,o=t.overlay.points[0].value;return null==n||n(t,void 0===o?o:W(o,e)),!1}})}function Un(e){return{name:e,totalStep:2,createPointFigures:function(i){var n,o,r,a,s,l,u,c,h,d,p,v,g,f,y,m,x,_,w,b,C,S,T,E=i.bounding,I=i.overlay,D=null===(n=I.styles)||void 0===n?void 0:n.color,P=null!==(r=null===(o=I.styles)||void 0===o?void 0:o.offset)&&void 0!==r?r:0,k=P,M=i.coordinates[0].y,A=null!==(a=I.extendData.volume)&&void 0!==a?a:0,B=Cn(A),L=Math.max(B+8,24),F=I.extendData.thirdText,O=void 0!==F?Cn(F):0,R=void 0!==F?O+8:0,N=(e!==t.currentOrderType.liquidate?"\u2507":"")+I.extendData.text,V=Cn(N)+8,z=null!==(s=I.extendData.volumeTooltipText)&&void 0!==s?s:"",W=null!==(l=I.extendData.thirdTextTooltipText)&&void 0!==l?l:"",Y=null!==(u=I.extendData.closeBtnTooltipText)&&void 0!==u?u:"",H=null!==(c=I.extendData.isHideCloseBtn)&&void 0!==c&&c,j=null!==(h=I.extendData.isBodyOffset)&&void 0!==h&&h,X=null!==(d=I.extendData.isTooltipEnableNewLine)&&void 0!==d&&d,K=H?0:21,q=V+L+R+K;k>0&&1>k&&(k=E.width*(1-P)),j&&(k+=q);var U=[{type:"line",ignoreEvent:!0,attrs:{coordinates:[{x:k=Math.min(Math.max(k,q+1),E.width),y:M},{x:E.width,y:M}]},styles:{style:"dashed",color:D}}];return H||(U.push({type:"rect",key:jn,ignoreEvent:["mouseDownEvent","mouseRightClickEvent"],attrs:{x:k-K,y:M-10.5,width:21,height:Xn},styles:{style:"stroke_fill",borderColor:D,color:null!==(v=null===(p=I.styles)||void 0===p?void 0:p.closeBackgroundColor)&&void 0!==v?v:"transparent"}}),U.push({type:"text",ignoreEvent:!0,attrs:{x:k-K/2,y:M,align:"center",baseline:"middle",text:"\u2715"},styles:{color:D,size:10}})),U.push({type:"rect",key:Yn,ignoreEvent:["mouseDownEvent","mouseRightClickEvent","mouseClickEvent"],attrs:{x:k-K-L-R,y:M-10.5,width:L,height:Xn},styles:{style:"stroke_fill",borderColor:D,color:null!==(f=null===(g=I.styles)||void 0===g?void 0:g.volumeBackgroundColor)&&void 0!==f?f:D}}),U.push({type:"text",ignoreEvent:!0,attrs:{x:k-K-L/2-R,y:M,align:"center",baseline:"middle",text:A},styles:{color:(null===(y=I.styles)||void 0===y?void 0:y.volumeTextColor)||"#ffffff"}}),void 0!==F&&(U.push({type:"rect",key:Hn,ignoreEvent:["mouseRightClickEvent"],attrs:{x:k-K-R,y:M-10.5,width:R,height:Xn},styles:{style:"stroke_fill",color:null===(m=I.styles)||void 0===m?void 0:m.bodyBackgroundColor,borderColor:D}}),U.push({type:"text",ignoreEvent:!0,attrs:{x:k-K-R/2,y:M,align:"center",baseline:"middle",text:F},styles:{color:D}})),U.push({type:"rect",key:Wn,ignoreEvent:["mouseRightClickEvent"],attrs:{x:k-K-L-R-V,y:M-10.5,width:V,height:Xn},styles:{style:"stroke_fill",color:null===(x=I.styles)||void 0===x?void 0:x.bodyBackgroundColor,borderColor:D}}),U.push({type:"text",ignoreEvent:!0,attrs:{x:k-K-L-R-V/2-(e!==t.currentOrderType.liquidate?2:0),y:M,align:"center",baseline:"middle",text:N},styles:{color:D}}),z.length>0&&Kn({figures:U,x:k-K-R-(L+V)/2,y:M,text:z,tooltipBackgroundColor:null===(_=I.styles)||void 0===_?void 0:_.tooltipBackgroundColor,tooltipTextColor:null===(w=I.styles)||void 0===w?void 0:w.tooltipTextColor,isTooltipEnableNewLine:X}),void 0!==F&&W.length>0&&Kn({figures:U,x:k-K-R/2,y:M,text:W,tooltipBackgroundColor:null===(b=I.styles)||void 0===b?void 0:b.tooltipBackgroundColor,tooltipTextColor:null===(C=I.styles)||void 0===C?void 0:C.tooltipTextColor,isTooltipEnableNewLine:X}),Y.length>0&&Kn({figures:U,x:k-K/2,y:M,text:Y,tooltipBackgroundColor:null===(S=I.styles)||void 0===S?void 0:S.tooltipBackgroundColor,tooltipTextColor:null===(T=I.styles)||void 0===T?void 0:T.tooltipTextColor,isTooltipEnableNewLine:X}),U},createYAxisFigures:function(t){var e,i=t.overlay,n=null===(e=i.styles)||void 0===e?void 0:e.color,o=i.points[0].value;return[{type:"rectText",ignoreEvent:!0,attrs:{x:0,y:t.coordinates[0].y,baseline:"middle",text:"".concat(wt(o?W(o,t.precision.price):""))},styles:{style:"fill",color:"#ffffff",backgroundColor:n,borderRadius:0,paddingLeft:4,paddingTop:4,paddingRight:4,paddingBottom:4}}]}}}var Zn=function(){if("undefined"!=typeof Map)return Map;function t(t,e){var i=-1;return t.some((function(t,n){return t[0]===e&&(i=n,!0)})),i}return function(){function e(){this.__entries__=[]}return Object.defineProperty(e.prototype,"size",{get:function(){return this.__entries__.length},enumerable:!0,configurable:!0}),e.prototype.get=function(e){var i=t(this.__entries__,e),n=this.__entries__[i];return n&&n[1]},e.prototype.set=function(e,i){var n=t(this.__entries__,e);~n?this.__entries__[n][1]=i:this.__entries__.push([e,i])},e.prototype.delete=function(e){var i=this.__entries__,n=t(i,e);~n&&i.splice(n,1)},e.prototype.has=function(e){return!!~t(this.__entries__,e)},e.prototype.clear=function(){this.__entries__.splice(0)},e.prototype.forEach=function(t,e){void 0===e&&(e=null);for(var i=0,n=this.__entries__;n.length>i;i++){var o=n[i];t.call(e,o[1],o[0])}},e}()}(),Gn="undefined"!=typeof window&&"undefined"!=typeof document&&window.document===document,Jn="undefined"!=typeof i.g&&i.g.Math===Math?i.g:"undefined"!=typeof self&&self.Math===Math?self:"undefined"!=typeof window&&window.Math===Math?window:Function("return this")(),$n="function"==typeof requestAnimationFrame?requestAnimationFrame.bind(Jn):function(t){return setTimeout((function(){return t(Date.now())}),1e3/60)},Qn=["top","right","bottom","left","width","height","size","weight"],to="undefined"!=typeof MutationObserver,eo=function(){function t(){this.connected_=!1,this.mutationEventsAdded_=!1,this.mutationsObserver_=null,this.observers_=[],this.onTransitionEnd_=this.onTransitionEnd_.bind(this),this.refresh=function(t,e){var i=!1,n=!1,o=0;function r(){i&&(i=!1,t()),n&&s()}function a(){$n(r)}function s(){var t=Date.now();if(i){if(2>t-o)return;n=!0}else i=!0,n=!1,setTimeout(a,20);o=t}return s}(this.refresh.bind(this))}return t.prototype.addObserver=function(t){~this.observers_.indexOf(t)||this.observers_.push(t),this.connected_||this.connect_()},t.prototype.removeObserver=function(t){var e=this.observers_,i=e.indexOf(t);~i&&e.splice(i,1),!e.length&&this.connected_&&this.disconnect_()},t.prototype.refresh=function(){this.updateObservers_()&&this.refresh()},t.prototype.updateObservers_=function(){var t=this.observers_.filter((function(t){return t.gatherActive(),t.hasActive()}));return t.forEach((function(t){return t.broadcastActive()})),t.length>0},t.prototype.connect_=function(){Gn&&!this.connected_&&(document.addEventListener("transitionend",this.onTransitionEnd_),window.addEventListener("resize",this.refresh),to?(this.mutationsObserver_=new MutationObserver(this.refresh),this.mutationsObserver_.observe(document,{attributes:!0,childList:!0,characterData:!0,subtree:!0})):(document.addEventListener("DOMSubtreeModified",this.refresh),this.mutationEventsAdded_=!0),this.connected_=!0)},t.prototype.disconnect_=function(){Gn&&this.connected_&&(document.removeEventListener("transitionend",this.onTransitionEnd_),window.removeEventListener("resize",this.refresh),this.mutationsObserver_&&this.mutationsObserver_.disconnect(),this.mutationEventsAdded_&&document.removeEventListener("DOMSubtreeModified",this.refresh),this.mutationsObserver_=null,this.mutationEventsAdded_=!1,this.connected_=!1)},t.prototype.onTransitionEnd_=function(t){var e=t.propertyName,i=void 0===e?"":e;Qn.some((function(t){return!!~i.indexOf(t)}))&&this.refresh()},t.getInstance=function(){return this.instance_||(this.instance_=new t),this.instance_},t.instance_=null,t}(),io=function(t,e){for(var i=0,n=Object.keys(e);n.length>i;i++){var o=n[i];Object.defineProperty(t,o,{value:e[o],enumerable:!1,writable:!1,configurable:!0})}return t},no=function(t){return t&&t.ownerDocument&&t.ownerDocument.defaultView||Jn},oo=lo(0,0,0,0);function ro(t){return parseFloat(t)||0}function ao(t){for(var e=[],i=1;arguments.length>i;i++)e[i-1]=arguments[i];return e.reduce((function(e,i){return e+ro(t["border-"+i+"-width"])}),0)}var so="undefined"!=typeof SVGGraphicsElement?function(t){return t instanceof no(t).SVGGraphicsElement}:function(t){return t instanceof no(t).SVGElement&&"function"==typeof t.getBBox};function lo(t,e,i,n){return{x:t,y:e,width:i,height:n}}var uo=function(){function t(t){this.broadcastWidth=0,this.broadcastHeight=0,this.contentRect_=lo(0,0,0,0),this.target=t}return t.prototype.isActive=function(){var t=function(t){return Gn?so(t)?function(t){var e=t.getBBox();return lo(0,0,e.width,e.height)}(t):function(t){var e=t.clientWidth,i=t.clientHeight;if(!e&&!i)return oo;var n=no(t).getComputedStyle(t),o=function(t){for(var e={},i=0,n=["top","right","bottom","left"];n.length>i;i++){var o=n[i];e[o]=ro(t["padding-"+o])}return e}(n),r=o.left+o.right,a=o.top+o.bottom,s=ro(n.width),l=ro(n.height);if("border-box"===n.boxSizing&&(Math.round(s+r)!==e&&(s-=ao(n,"left","right")+r),Math.round(l+a)!==i&&(l-=ao(n,"top","bottom")+a)),!function(t){return t===no(t).document.documentElement}(t)){var u=Math.round(s+r)-e,c=Math.round(l+a)-i;1!==Math.abs(u)&&(s-=u),1!==Math.abs(c)&&(l-=c)}return lo(o.left,o.top,s,l)}(t):oo}(this.target);return this.contentRect_=t,t.width!==this.broadcastWidth||t.height!==this.broadcastHeight},t.prototype.broadcastRect=function(){var t=this.contentRect_;return this.broadcastWidth=t.width,this.broadcastHeight=t.height,t},t}(),co=function(t,e){var i=function(t){var e=t.x,i=t.y,n=t.width,o=t.height,r="undefined"!=typeof DOMRectReadOnly?DOMRectReadOnly:Object,a=Object.create(r.prototype);return io(a,{x:e,y:i,width:n,height:o,top:i,right:e+n,bottom:o+i,left:e}),a}(e);io(this,{target:t,contentRect:i})},ho=function(){function t(t,e,i){if(this.activeObservations_=[],this.observations_=new Zn,"function"!=typeof t)throw new TypeError("The callback provided as parameter 1 is not a function.");this.callback_=t,this.controller_=e,this.callbackCtx_=i}return t.prototype.observe=function(t){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if("undefined"!=typeof Element&&Element instanceof Object){if(!(t instanceof no(t).Element))throw new TypeError('parameter 1 is not of type "Element".');var e=this.observations_;e.has(t)||(e.set(t,new uo(t)),this.controller_.addObserver(this),this.controller_.refresh())}},t.prototype.unobserve=function(t){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if("undefined"!=typeof Element&&Element instanceof Object){if(!(t instanceof no(t).Element))throw new TypeError('parameter 1 is not of type "Element".');var e=this.observations_;e.has(t)&&(e.delete(t),e.size||this.controller_.removeObserver(this))}},t.prototype.disconnect=function(){this.clearActive(),this.observations_.clear(),this.controller_.removeObserver(this)},t.prototype.gatherActive=function(){var t=this;this.clearActive(),this.observations_.forEach((function(e){e.isActive()&&t.activeObservations_.push(e)}))},t.prototype.broadcastActive=function(){if(this.hasActive()){var t=this.callbackCtx_,e=this.activeObservations_.map((function(t){return new co(t.target,t.broadcastRect())}));this.callback_.call(t,e,t),this.clearActive()}},t.prototype.clearActive=function(){this.activeObservations_.splice(0)},t.prototype.hasActive=function(){return this.activeObservations_.length>0},t}(),po="undefined"!=typeof WeakMap?new WeakMap:new Zn,vo=function t(e){if(!(this instanceof t))throw new TypeError("Cannot call a class as a function.");if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");var i=eo.getInstance(),n=new ho(e,i,this);po.set(this,n)};["observe","unobserve","disconnect"].forEach((function(t){vo.prototype[t]=function(){var e;return(e=po.get(this))[t].apply(e,arguments)}}));var go,fo=void 0!==Jn.ResizeObserver?Jn.ResizeObserver:vo,yo=function(){function e(e,i){var n,o=this;this._yAxisExtremum={realMin:0,realMax:0},this._flag=!1,this._isShow=!1,this._cacheBounding={width:0,height:0},this._requestAnimationId=-1,this._bidList=[],this._askList=[],this.destoryed=!1,this._chart=e,this._yAxis=e.getPaneById("candle_pane").getAxisComponent(),this._yAxisExtremum=this._yAxis.getExtremum(),this._flag=null!=i&&i,this._canvas=document.createElement("canvas"),this._canvas.style.position="absolute",this._canvas.style.top="0",this._canvas.style.left="0",this._canvas.style.width="100%",this._canvas.style.height="100%",this._canvas.style.zIndex="1",this._canvas.style.boxSizing="border-box",this._cacheBounding=this._buildBounding(),this._ctx=this._canvas.getContext("2d"),null===(n=e.getDom("candle_pane",t.DomPosition.YAxis))||void 0===n||n.appendChild(this._canvas),this._resizeObserver=new fo((function(t){o.update()})),this._resizeObserver.observe(this._canvas);var r=e.getDom("candle_pane",t.DomPosition.YAxis);r&&(this._parent=r,this._canvas.style.width="".concat(r.offsetWidth,"px"),this._canvas.style.height="".concat(r.offsetHeight,"px"),this._parentResizeObserver=new fo((function(t){o._canvas.style.width="".concat(r.offsetWidth,"px"),o._canvas.style.height="".concat(r.offsetHeight,"px"),o.update()})),this._parentResizeObserver.observe(this._parent));var a=function(){if(!o.destoryed){var t=o._yAxis.getExtremum();t.realMin===o._yAxisExtremum.realMin&&t.realMax===o._yAxisExtremum.realMax||(o._yAxisExtremum=t,o.update()),setTimeout((function(){a()}),20)}};a()}return e.prototype._buildBounding=function(){return{width:this._canvas.offsetWidth,height:this._canvas.offsetHeight}},e.prototype.getStyles=function(){return this._chart.getStyles().depth},e.prototype._draw=function(){var t,e,i,n,o,r,a,s,l=this;if(this._isShow){for(var u=this._canvas.offsetWidth,c=this._canvas.offsetHeight,h=this._yAxisExtremum,d=null===(t=this._bidList)||void 0===t?void 0:t.length,p=null===(e=this._askList)||void 0===e?void 0:e.length,v=null!==(o=null===(n=null===(i=this._askList)||void 0===i?void 0:i[0])||void 0===n?void 0:n.volume)&&void 0!==o?o:0,g=1;p>g;g++){var f=this._askList[g];if(Y(this._askList[g-1].price,h.realMax)&&!Y(f.price,h.realMax)){v=f.volume;break}}var y=null!==(s=null===(a=null===(r=this._bidList)||void 0===r?void 0:r[d-1])||void 0===a?void 0:a.volume)&&void 0!==s?s:0;for(g=d-2;g>-1;g--)if(f=this._bidList[g],j(this._bidList[g+1].price,h.realMin)&&!j(f.price,h.realMin)){y=f.volume;break}var m=v,x=y;if(this._flag&&(m=x=K(v,y)),p>0){var _=[{x:0,y:0}],w=[],b=0,C=(S=this.getStyles().askLineSize)/2;this._askList.forEach((function(t,e){var i=F(M(t.volume,m),u);b=K(i,b),0===e&&(_.push({x:Number(R(i,C)),y:0}),w.push({x:Number(R(i,C)),y:0}));var n=l._yAxis.convertToPixel(Number(t.price));_.push({x:Number(R(i,C)),y:n}),w.push({x:Number(R(i,C)),y:n}),e===p-1&&(_.push({x:0,y:n}),w.push({x:0,y:n}))})),this._drawAreaLine(_,w,{lineSize:S,lineColor:this.getStyles().askLineColor,backgroundColor:this.getStyles().askBackgroundColor},Number(b))}if(d>0){var S,T=[],E=[],I=0,D=(S=this.getStyles().askLineSize)/2;this._bidList.forEach((function(t,e){var i=F(M(t.volume,x),u);I=K(i,I);var n=l._yAxis.convertToPixel(Number(t.price));0===e?(T.push({x:0,y:n}),T.push({x:Number(i),y:n}),E.push({x:0,y:n}),E.push({x:Number(R(i,D)),y:n})):e===d-1?(T.push({x:Number(i),y:n}),T.push({x:Number(i),y:c}),T.push({x:0,y:c}),E.push({x:Number(R(i,D)),y:n}),E.push({x:Number(R(i,D)),y:c})):(T.push({x:Number(i),y:n}),E.push({x:Number(R(i,D)),y:n}))})),this._drawAreaLine(T,E,{lineSize:S,lineColor:this.getStyles().bidLineColor,backgroundColor:this.getStyles().bidBackgroundColor},Number(I))}}},e.prototype._drawAreaLine=function(t,e,i,n){var o,r=i.backgroundColor;if(wo.isArray(r)){var a=this._ctx.createLinearGradient(0,0,n,0);try{r.forEach((function(t){a.addColorStop(t.offset,t.color)}))}catch(t){}o=a}else o=r;var s=Li("polygon");null!==s&&new s({name:"polygon",attrs:{coordinates:t},styles:{color:o}}).draw(this._ctx);var l=Li("line");null!==l&&new l({name:"line",attrs:{coordinates:e},styles:{color:i.lineColor,size:i.lineSize}}).draw(this._ctx)},e.prototype.update=function(){var t=this;-1!==this._requestAnimationId&&(cancelAnimationFrame(this._requestAnimationId),this._requestAnimationId=-1),this._requestAnimationId=requestAnimationFrame((function(){if(t._cacheBounding.width!==t._canvas.offsetWidth||t._cacheBounding.height!==t._canvas.offsetHeight){t._ctx.clearRect(0,0,t._cacheBounding.width,t._cacheBounding.height);var e=window.devicePixelRatio;t._canvas.width=Math.floor(t._canvas.offsetWidth*e),t._canvas.height=Math.floor(t._canvas.offsetHeight*e),t._ctx.scale(e,e),t._cacheBounding=t._buildBounding()}else t._ctx.clearRect(0,0,t._canvas.offsetWidth,t._canvas.offsetHeight);t._draw()}))},e.prototype.getDom=function(){return this._canvas},e.prototype.setData=function(t){var e=t.bids,i=void 0===e?[]:e,n=t.asks,o=[],r=0;(void 0===n?[]:n).forEach((function(t){var e;r=R(r,null!==(e=t[1])&&void 0!==e?e:0),o.unshift({price:t[0],volume:r})})),this._askList=o;var a=[];r=0,i.forEach((function(t){var e;r=R(r,null!==(e=t[1])&&void 0!==e?e:0),a.push({price:t[0],volume:r})})),this._bidList=a,this.update()},e.prototype.setSwitchShow=function(t){this._isShow=t,t?this.update():this.clear()},e.prototype.clear=function(){this._ctx.clearRect(0,0,this._cacheBounding.width,this._cacheBounding.height)},e.prototype.destory=function(){this.destoryed=!0,this._resizeObserver.unobserve(this._canvas),this._parent&&this._parentResizeObserver&&this._parentResizeObserver.unobserve(this._parent)},e}();t.DomPosition=void 0,(go=t.DomPosition||(t.DomPosition={})).Root="root",go.Main="main",go.YAxis="yAxis";var mo=function(){function e(e,i){var n;this._panes=new Map,this._historyOrder=[],this._historyPoint=new Set,this._positions=[],this._positionLine=new Map,this._currentOrder=new Map,this._currentOrderLine=new Map,this._initContainer(e),this._chartEvent=new bn(this._chartContainer,this),this._chartStore=new ui(this,i),this._xAxisPane=new fn(this._chartContainer,this,ni),this._panes.set(ei,new cn(this._chartContainer,this,ei)),this.adjustPaneViewport(!0,!0,!0),Ke(Tn),Ke(zn),Ke(Un(t.currentOrderType.limit)),Ke(Un(t.currentOrderType.plan)),Ke(Un(t.currentOrderType.stop)),Ke(Un(t.currentOrderType.liquidate)),this._miniDepthChart=new yo(this),null===(n=this.getDom(ei,t.DomPosition.YAxis))||void 0===n||n.appendChild(this._miniDepthChart.getDom())}return e.prototype._initContainer=function(t){this._container=t,this._chartContainer=Bt("div",{position:"relative",width:"100%",outline:"none",borderStyle:"none",cursor:"crosshair",boxSizing:"border-box",userSelect:"none",webkitUserSelect:"none",msUserSelect:"none",MozUserSelect:"none",webkitTapHighlightColor:"transparent",overflow:"hidden"}),this._chartContainer.tabIndex=1,t.appendChild(this._chartContainer)},e.prototype._measurePaneHeight=function(){var t,e=this._container.offsetHeight,i=this._xAxisPane.getAxisComponent().getAutoSize(),n=e-i;0>n&&(n=0);var o=0;this._panes.forEach((function(t){if(t.getId()!==ei){var e=t.getBounding().height,i=t.getOptions().minHeight;i>e&&(e=i),o+e>n?e=Math.max(n-(o=n),0):o+=e,t.setBounding({height:e})}}));var r=n-o;null===(t=this._panes.get(ei))||void 0===t||t.setBounding({height:r});var a=0;this._panes.forEach((function(t){t.setBounding({top:a}),a+=t.getBounding().height})),this._xAxisPane.setBounding({height:i,top:a})},e.prototype._measurePaneWidth=function(){var e=Math.floor(this._container.clientWidth),i=this._chartStore.getStyles().yAxis,n=i.position===t.YAxisPosition.Left,o=!i.inside,r=i.minWidth,a=0,s=0,l=0,u=0;this._panes.forEach((function(t){t.getId()!==ni&&(s=Math.max(r,s,t.getAxisComponent().getAutoSize()))})),s>e&&(s=e),o?(a=e-s,n?(l=0,u=s):(l=e-s,u=0)):(a=e,u=0,l=n?0:e-s),this._chartStore.getTimeScaleStore().setTotalBarSpace(a);var c={width:e},h={width:a,left:u},d={width:s,left:l};this._panes.forEach((function(t){t.setBounding(c,h,d)})),this._xAxisPane.setBounding(c,h,d)},e.prototype._setPaneOptions=function(t,e){var i,n,o=this._panes.get(null!==(i=null==t?void 0:t.id)&&void 0!==i?i:""),r=!1;if(void 0!==o){var a=e;if(t.id!==ei&&void 0!==t.height&&t.height>0){var s=Math.max(null!==(n=t.minHeight)&&void 0!==n?n:o.getOptions().minHeight,0);o.setBounding({height:Math.max(s,t.height)}),a=!0,r=!0}o.setOptions(t),a&&this.adjustPaneViewport(r,!0,!0,!0,!0)}},e.prototype.getContainer=function(){return this._container},e.prototype.getChartStore=function(){return this._chartStore},e.prototype.getAllPanes=function(){return this._panes},e.prototype.adjustPaneViewport=function(t,e,i,n,o){t&&this._measurePaneHeight();var r=e,a=null!=o&&o;(null!=n&&n||a)&&this._panes.forEach((function(t){var e=t.getAxisComponent().buildTicks(a);r||(r=e)})),r&&this._measurePaneWidth(),null!=i&&i&&(this._xAxisPane.getAxisComponent().buildTicks(!0),this.updatePane(4))},e.prototype.updatePane=function(t,e){var i;void 0!==e?null===(i=this.getPaneById(e))||void 0===i||i.update(t):(this._xAxisPane.update(t),this._panes.forEach((function(e){e.update(t)})))},e.prototype.getPaneById=function(t){var e;return t===ni?this._xAxisPane:null!==(e=this._panes.get(t))&&void 0!==e?e:null},e.prototype.crosshairChange=function(e){var i=this,n=this._chartStore.getActionStore();if(n.has(t.ActionType.OnCrosshairChange)){var r={};this._panes.forEach((function(t,n){var o={};i._chartStore.getIndicatorStore().getInstances(n).forEach((function(t){var i,n=t.result;o[t.name]=n[null!==(i=e.dataIndex)&&void 0!==i?i:n.length-1]})),r[n]=o})),void 0!==e.paneId&&n.execute(t.ActionType.OnCrosshairChange,o(o({},e),{indicatorData:r}))}},e.prototype.getDom=function(e,i){var n,o;if(void 0===e)return this._chartContainer;var r=this.getPaneById(e);if(null!==r)switch(null!=i?i:t.DomPosition.Root){case t.DomPosition.Root:return r.getContainer();case t.DomPosition.Main:return r.getMainWidget().getContainer();case t.DomPosition.YAxis:return null!==(o=null===(n=r.getYAxisWidget())||void 0===n?void 0:n.getContainer())&&void 0!==o?o:null}return null},e.prototype.getSize=function(e,i){var n,o;if(void 0===e)return{width:this._chartContainer.offsetWidth,height:this._chartContainer.offsetHeight,left:0,top:0,right:0,bottom:0};var r=this.getPaneById(e);if(null!==r)switch(null!=i?i:t.DomPosition.Root){case t.DomPosition.Root:return r.getBounding();case t.DomPosition.Main:return r.getMainWidget().getBounding();case t.DomPosition.YAxis:return null!==(o=null===(n=r.getYAxisWidget())||void 0===n?void 0:n.getBounding())&&void 0!==o?o:null}return null},e.prototype.setStyles=function(t){var e,i,n;this._chartStore.setOptions({styles:t}),void 0!==(null===(e=null==(n=ot(t)?li(t):t)?void 0:n.yAxis)||void 0===e?void 0:e.type)&&(null===(i=this.getPaneById(ei))||void 0===i||i.getAxisComponent().setAutoCalcTickFlag(!0)),this._miniDepthChart.update(),this.adjustPaneViewport(!0,!0,!0,!0,!0)},e.prototype.getStyles=function(){return this._chartStore.getStyles()},e.prototype.setLocale=function(t){this._chartStore.setOptions({locale:t}),this.adjustPaneViewport(!0,!0,!0,!0,!0)},e.prototype.getLocale=function(){return this._chartStore.getLocale()},e.prototype.setCustomApi=function(t){this._chartStore.setOptions({customApi:t}),this.adjustPaneViewport(!0,!0,!0,!0,!0)},e.prototype.setPriceVolumePrecision=function(t,e){this._chartStore.setPrecision({price:t,volume:e})},e.prototype.getPriceVolumePrecision=function(){return this._chartStore.getPrecision()},e.prototype.setTimezone=function(t){this._chartStore.setOptions({timezone:t}),this._xAxisPane.getAxisComponent().buildTicks(!0),this._xAxisPane.update(3)},e.prototype.getTimezone=function(){return this._chartStore.getTimeScaleStore().getTimezone()},e.prototype.setOffsetRightDistance=function(t){this._chartStore.getTimeScaleStore().setOffsetRightDistance(t,!0)},e.prototype.setLeftMinVisibleBarCount=function(t){t>0&&this._chartStore.getTimeScaleStore().setLeftMinVisibleBarCount(Math.ceil(t))},e.prototype.setRightMinVisibleBarCount=function(t){t>0&&this._chartStore.getTimeScaleStore().setRightMinVisibleBarCount(Math.ceil(t))},e.prototype.setBarSpace=function(t){this._chartStore.getTimeScaleStore().setBarSpace(t)},e.prototype.getBarSpace=function(){return this._chartStore.getTimeScaleStore().getBarSpace().bar},e.prototype.getVisibleRange=function(){return this._chartStore.getTimeScaleStore().getVisibleRange()},e.prototype.clearData=function(){this._chartStore.clearDataList()},e.prototype.getDataList=function(){return this._chartStore.getDataList()},e.prototype.applyNewData=function(t,e){this._chartStore.clearDataList(),0===t.length?this.adjustPaneViewport(!1,!0,!0,!0):this.applyMoreData(t,e)},e.prototype.applyMoreData=function(t,e){var i=this;this._chartStore.addData(t,0,e),t.length>0&&this._chartStore.getIndicatorStore().calcInstance().then((function(t){i.adjustPaneViewport(!1,!0,!0,!0)})).then((function(){i.updateHistoryOrder()})).catch((function(t){}))},e.prototype.clearHistoryPoint=function(){var t=this;this._historyPoint.forEach((function(e){t.removeOverlay({id:e})})),this._historyPoint.clear()},e.prototype.clearHistoryOrders=function(){this.clearHistoryPoint(),this._historyOrder=[]},e.prototype.updateHistoryOrder=function(){var e=this;if(this.clearHistoryPoint(),this._historyOrder.length>0){var i=this.getDataList()||[],n={};this._historyOrder.map((function(e){var r,a,s,l,u,c,h,d,p,v=e.point,g=e.direction,f=o({},e),y=0,m=0,x=g===t.HistoryOrderArrowDirection.Up;return i&&v&&i.length>0&&i.some((function(t,e){var n=i[e+1];return!(!v.timestamp||t.timestamp>v.timestamp||v.timestamp>=((null==n?void 0:n.timestamp)||1/0)||(p={timestamp:t.timestamp,value:x?t.low:t.high},0))})),f.point=p||v,(null===(r=f.point)||void 0===r?void 0:r.timestamp)&&(null==n?void 0:n[null===(a=f.point)||void 0===a?void 0:a.timestamp])&&(y=(null===(l=n[null===(s=f.point)||void 0===s?void 0:s.timestamp])||void 0===l?void 0:l.buyOffset)||0,m=(null===(c=n[null===(u=f.point)||void 0===u?void 0:u.timestamp])||void 0===c?void 0:c.sellOffset)||0),x?y+=10:m-=10,(null===(h=f.point)||void 0===h?void 0:h.timestamp)&&(n[null===(d=f.point)||void 0===d?void 0:d.timestamp]={buyOffset:y,sellOffset:m}),o(o({},f),{offset:x?y:m})})).forEach((function(t){var i=Sn.call(e,t);e._historyPoint.add(i)}))}},e.prototype.updateData=function(t){var e=this,i=this._chartStore.getDataList(),n=i.length,o=t.timestamp,r=st(i[n-1],"timestamp",0);if(o>=r){var a=n;o===r&&(a=n-1),this._chartStore.addData(t,a),this._chartStore.getIndicatorStore().calcInstance().then((function(t){e.adjustPaneViewport(!1,!0,!0,!0)})).catch((function(t){}))}},e.prototype.loadMore=function(t){this._chartStore.getTimeScaleStore().setLoadMoreCallback(t)},e.prototype.setInterval=function(t){this._chartStore.setOptions({interval:t}),q()},e.prototype.setShowCountDown=function(t){this._chartStore.setOptions({showCountDown:t}),this.adjustPaneViewport(!0,!0,!0,!0,!0)},e.prototype.createIndicator=function(t,e,i,n){var o,r,a,s=this,l=ot(t)?{name:t}:t;if(null===Te(l.name))return null;if(void 0!==(null==i?void 0:i.id)&&this._panes.has(i.id))a=i.id,this._chartStore.getIndicatorStore().addInstance(l,a,null!=e&&e).then((function(t){var e,n;s._setPaneOptions(i,null!==(n=null===(e=s._panes.get(a))||void 0===e?void 0:e.getAxisComponent().buildTicks(!0))&&void 0!==n&&n)})).catch((function(t){}));else{a=null!==(o=null==i?void 0:i.id)&&void 0!==o?o:At(ii);var u=Array.from(this._panes.values()).pop(),c=new ln(this._chartContainer,this,a,u);u.setBottomPane(c);var h=null!==(r=null==i?void 0:i.height)&&void 0!==r?r:100;c.setBounding({height:h}),null!=i&&c.setOptions(i),this._panes.set(a,c),this._chartStore.getIndicatorStore().addInstance(l,a,null!=e&&e).finally((function(){s.adjustPaneViewport(!0,!0,!0,!0,!0),null==n||n()}))}return a},e.prototype.overrideIndicator=function(t,e,i){var n=this;this._chartStore.getIndicatorStore().override(t,null!=e?e:null).then((function(t){var e=u(t,2),o=e[1];(e[0]||o)&&(n.adjustPaneViewport(!1,o,!0,o),null==i||i())})).catch((function(){}))},e.prototype.getIndicatorByPaneId=function(t,e){return this._chartStore.getIndicatorStore().getInstanceByPaneId(t,e)},e.prototype.removeIndicator=function(t,e){var i=this._chartStore.getIndicatorStore();if(i.removeInstance(t,e)){var n=!1;if(t!==ei&&!i.hasInstances(t)){var o=this._panes.get(t);if(void 0!==o){n=!0;var r=o.getTopPane(),a=o.getBottomPane();null==a||a.setTopPane(r),null==r||r.setBottomPane(a),null==o||o.destroy(),this._panes.delete(t)}}this.adjustPaneViewport(n,!0,!0,!0,!0)}},e.prototype.createOverlay=function(t,e){var i=ot(t)?{name:t}:t;if(null===qe(i.name))return null;var n=!0;return void 0!==e&&null!==this.getPaneById(e)||(e=ei,n=!1),this._chartStore.getOverlayStore().addInstance(i,e,n)},e.prototype.getOverlayById=function(t){return this._chartStore.getOverlayStore().getInstanceById(t)},e.prototype.overrideOverlay=function(t){this._chartStore.getOverlayStore().override(t)},e.prototype.removeOverlay=function(t){var e;void 0!==t&&(e=ot(t)?{id:t}:t),this._chartStore.getOverlayStore().removeInstance(e)},e.prototype.setPaneOptions=function(t){this._setPaneOptions(t,!1)},e.prototype.setZoomEnabled=function(t){this._chartStore.getTimeScaleStore().setZoomEnabled(t)},e.prototype.isZoomEnabled=function(){return this._chartStore.getTimeScaleStore().getZoomEnabled()},e.prototype.setScrollEnabled=function(t){this._chartStore.getTimeScaleStore().setScrollEnabled(t)},e.prototype.isScrollEnabled=function(){return this._chartStore.getTimeScaleStore().getScrollEnabled()},e.prototype.scrollByDistance=function(t,e){var i=void 0===e||0>e?0:e,n=this._chartStore.getTimeScaleStore();if(i>0){n.startScroll();var o=(new Date).getTime(),r=function(){var e=((new Date).getTime()-o)/i,a=e>=1;n.scroll(a?t:t*e),a||requestAnimationFrame(r)};r()}else n.startScroll(),n.scroll(t)},e.prototype.scrollToRealTime=function(t){var e=this._chartStore.getTimeScaleStore(),i=e.getBarSpace().bar,n=e.getOffsetRightBarCount()-e.getOffsetRightDistance()/i;this.scrollByDistance(n*i,t)},e.prototype.scrollToDataIndex=function(e,i){var n,o=(null!==(n=this.getSize(ei,t.DomPosition.Main))&&void 0!==n?n:Dt()).width,r=this._chartStore.getTimeScaleStore(),a=r.getBarSpace().bar,s=(r.getOffsetRightBarCount()+(this.getDataList().length-1-e))*a-o/2;this.scrollByDistance(s,i)},e.prototype.scrollToTimestamp=function(t,e){var i={canceled:!1};return this.baseScrollToTimestamp(t,e,i),{cancel:function(){i.canceled=!0}}},e.prototype.baseScrollToTimestamp=function(e,i,n){var o=this;if(!(null==n?void 0:n.canceled)){var r=this.getDataList(),a=this._chartStore.getTimeScaleStore(),s=a.timestampToDataIndex(e);if(0===s&&a.getMore()&&!a.getLoading()){var l=a.getLoadMoreCallback();if(l){var u=r[0];return a.setLoading(!0),l(null==u?void 0:u.timestamp).then((function(){return o.baseScrollToTimestamp(e,i,n)})).catch((function(){}))}}this.scrollToDataIndex(s,i),this._chartStore.getActionStore().execute(t.ActionType.OnScrollToTimestamp)}},e.prototype.zoomAtCoordinate=function(t,e,i){var n=void 0===i||0>i?0:i,o=this._chartStore.getTimeScaleStore();if(n>0){var r=o.getBarSpace().bar,a=r*t-r,s=(new Date).getTime(),l=function(){var t=((new Date).getTime()-s)/n,i=t>=1;o.zoom((i?a:a*t)/r,e),i||requestAnimationFrame(l)};l()}else o.zoom(t,e)},e.prototype.zoomAtDataIndex=function(t,e,i){var n=this._chartStore.getTimeScaleStore().dataIndexToCoordinate(e);this.zoomAtCoordinate(t,{x:n,y:0},i)},e.prototype.zoomAtTimestamp=function(t,e,i){var n=m(this.getDataList(),"timestamp",e);this.zoomAtDataIndex(t,n,i)},e.prototype.convertToPixel=function(t,e){var i,n=e.paneId,o=void 0===n?ei:n,r=e.absolute,a=void 0!==r&&r,s=[];if(o!==ni){var l=this.getPaneById(o);if(null!==l){var u=this._chartStore.getTimeScaleStore(),c=l.getBounding(),h=[].concat(t),d=this._xAxisPane.getAxisComponent(),p=l.getAxisComponent();s=h.map((function(t){var e={},i=t.dataIndex;if(void 0!==t.timestamp&&(i=u.timestampToDataIndex(t.timestamp)),void 0!==i&&(e.x=null==d?void 0:d.convertToPixel(i)),void 0!==t.value){var n=null==p?void 0:p.convertToPixel(t.value);e.y=a?c.top+n:n}return e}))}}return $(t)?s:null!==(i=s[0])&&void 0!==i?i:{}},e.prototype.convertFromPixel=function(t,e){var i,n=e.paneId,o=void 0===n?ei:n,r=e.absolute,a=void 0!==r&&r,s=[];if(o!==ni){var l=this.getPaneById(o);if(null!==l){var u=this._chartStore.getTimeScaleStore(),c=l.getBounding(),h=[].concat(t),d=this._xAxisPane.getAxisComponent(),p=l.getAxisComponent();s=h.map((function(t){var e,i={};if(void 0!==t.x){var n=d.convertFromPixel(t.x);i.dataIndex=n,i.timestamp=null!==(e=u.dataIndexToTimestamp(n))&&void 0!==e?e:void 0}return void 0!==t.y&&(i.value=p.convertFromPixel(a?t.y-c.top:t.y)),i}))}}return $(t)?s:null!==(i=s[0])&&void 0!==i?i:{}},e.prototype.subscribeAction=function(t,e){this._chartStore.getActionStore().subscribe(t,e)},e.prototype.unsubscribeAction=function(t,e){this._chartStore.getActionStore().unsubscribe(t,e)},e.prototype.getConvertPictureUrl=function(t,e,i){var n=this._chartContainer.offsetWidth,o=this._chartContainer.offsetHeight,r=Bt("canvas",{width:"".concat(n,"px"),height:"".concat(o,"px"),boxSizing:"border-box"}),a=r.getContext("2d"),s=Lt(r);r.width=n*s,r.height=o*s,a.scale(s,s),a.fillStyle=null!=i?i:"#FFFFFF",a.fillRect(0,0,n,o);var l=null!=t&&t;this._panes.forEach((function(t){var e=t.getBounding();a.drawImage(t.getImage(l),0,e.top,n,e.height)}));var u=this._xAxisPane.getBounding();return a.drawImage(this._xAxisPane.getImage(l),0,u.top,n,u.height),r.toDataURL("image/".concat(null!=e?e:"jpeg"))},e.prototype.resize=function(){this.adjustPaneViewport(!0,!0,!0,!0,!0)},e.prototype.createHistoryOrders=function(t){this._historyOrder=t,this.updateHistoryOrder()},e.prototype.clearPosition=function(){var t=this;this._positionLine.forEach((function(e,i){t.removeOverlay({id:i})})),this._positionLine.clear()},e.prototype.updatePosition=function(){var t=this;this._positionLine.forEach((function(e,i){t._positions.find((function(t){return t.id===i}))||t.removeOverlay({id:i})})),this._positions.forEach((function(e){var i,n,o=c([],u(t._positionLine.entries()),!1).find((function(t){return u(t,1)[0]===e.id}));if(o)null===(n=null===(i=null==o?void 0:o[1])||void 0===i?void 0:i.overridePosition)||void 0===n||n.call(i,e);else{var r=u(Nn.call(t,e),2);t._positionLine.set(e.id,{overlayId:r[0],overridePosition:r[1]})}}))},e.prototype.createPositions=function(t){this._positions=t,this.updatePosition()},e.prototype.clearCurrentOrder=function(t){var e=this,i=this._currentOrderLine.get(t);this.removeOverlay({name:t}),Array.isArray(i)&&(i.forEach((function(t){e.removeOverlay({id:t})})),i.clear())},e.prototype.updateCurrentOrder=function(t){var e=this;this.clearCurrentOrder(t);var i=this._currentOrder.get(t),n=this._currentOrderLine.get(t);n||(this._currentOrderLine.set(t,new Set),n=this._currentOrderLine.get(t)),Array.isArray(i)&&i.forEach((function(i){i.name=t;var o=qn.call(e,i);null==n||n.add(o)}))},e.prototype.createCurrentOrder=function(t,e){this._currentOrder.set(t,e),this.updateCurrentOrder(t)},e.prototype.setShowDepthChart=function(t){this._miniDepthChart.setSwitchShow(t)},e.prototype.getDepthChart=function(){return this._miniDepthChart},e.prototype.setDepthData=function(t){this._miniDepthChart.setData(t)},e.prototype.destroy=function(){this._chartEvent.destroy(),this._panes.forEach((function(t){t.destroy()})),this._panes.clear(),this._xAxisPane.destroy(),this._miniDepthChart.destory(),this._container.removeChild(this._chartContainer),q(),Z()},e}(),xo={},_o=1,wo={clone:J,merge:G,isString:ot,isNumber:et,isValid:it,isObject:tt,isArray:$,isFunction:Q,isBoolean:nt,formatValue:st,formatPrecision:ut,formatNumber:wt,formatPrecisionAndComma:Tt,formatBigNumber:ct,formatDate:lt,getLinearSlopeIntercept:Ne,getLinearYFromSlopeIntercept:Oe,getLinearYFromCoordinates:Re,checkCoordinateOnArc:ki,checkCoordinateOnCircle:gi,checkCoordinateOnLine:Fe,checkCoordinateOnPolygon:mi,checkCoordinateOnRect:wi,checkCoordinateOnText:Ti,drawArc:Mi,drawCircle:fi,drawLine:Ve,drawPolygon:xi,drawRect:bi,drawText:Ei,drawRectText:Di};t.dispose=function(t){var e,i;if(wt=_t,Ct=bt,ot(t)){var n=document.getElementById(t);i=null!==(e=null==n?void 0:n.getAttribute("chartId"))&&void 0!==e?e:null}else i=t instanceof mo?t.id:null!=t?t:t.chartId;null!==i&&(xo[i].destroy(),delete xo[i])},t.getFigureClass=Li,t.getSupportedFigures=function(){return Object.keys(Bi)},t.getSupportedIndicators=function(){return Object.keys(Se)},t.getSupportedLocales=function(){return Object.keys(qi)},t.getSupportedOverlays=function(){return Object.keys(Xe)},t.init=function(t,e){var i,n;if(null===(n=ot(t)?document.getElementById(t):t))return null;var o=xo[null!==(i=n.chartId)&&void 0!==i?i:""];if(void 0!==o)return o;var r="k_line_chart_".concat(_o++);return y=!0===(null==e?void 0:e.precise),o=new mo(n,e),U(),o.id=r,n.chartId=r,xo[r]=o,o},t.registerFigure=function(t){Bi[t.name]=vi.extend(t)},t.registerIndicator=function(t){Se[t.name]=Wt.extend(t)},t.registerLocale=function(t,e){qi[t]=o(o({},qi[t]),e)},t.registerOverlay=Ke,t.registerStyles=function(t,e){si[t]=e},t.utils=wo,t.version=function(){return"2.6.2"}},"object"==typeof s?l(s):(o=[e],void 0===(r="function"===typeof(n=l)?n.apply(e,o):n)||(t.exports=r))}var s;s=function(t){var e="undefined"!=typeof globalThis;a("undefined"!=typeof globalThis?globalThis:void 0,t);var n=function(){var e={},n=this,o="undefined"!=typeof globalThis?globalThis:void 0,r="object"==typeof t&&!0,s=i.amdO;return r||s?a(o,e):a.call(n={},n,e),r||s?e:n.klinecharts};e&&globalThis.klinecharts?globalThis.klinecharts.createInstance=n:t.createInstance=n},s(e)}()},839360:function(t,e,i){"use strict";t.exports=i(748779)}}]);</script>
</body>
</html>
