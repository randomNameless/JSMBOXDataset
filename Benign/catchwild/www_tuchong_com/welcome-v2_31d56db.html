<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>welcome-v2_31d56db.html</title>
</head>
<body>

<script>
!function(t,e){t.tcc={get:function(t,i){if(t){var n={banner_list:[{image_url:"https://lf3-static.bytednsdoc.com/obj/eden-cn/edhypseh7penulw/tuchong/20220330-banner.jpeg",jump_url:"https://topic.tuchong.com/magic/eco/runtime/release/6242dc56fdfa000339d6d819?appType=tuchong"}]};e.ajax({url:"https://lf3-config.bytetcc.com/obj/tcc-config-web/tcc-v2-data-dfic.tcc.creative-default",type:"GET",dataType:"json",success:function(e){try{i(JSON.parse(e.data[t]))}catch(o){i(n)}},error:function(){i(n)}})}}}}(window.TuchongApi||(window.TuchongApi={}),$),function(t){function e(e,i,n,o,r){return t.each(e,function(t,e){e.computedHeight=n,e.computedWidth=Math.round(i/r*e.ratio),e.marginLeft=0==t?0:o,r-=e.ratio,i-=e.computedWidth}),e}t.generateRows=t.justifyPosts=function(i,n,o,r,s,a){o||(o=20),r||(r=120),a||(a=240);var c,l=[],u=[],h=0,p=n.length,f=0,d=0;return c=s?function(t,e){return t/e}:function(t,e){return Math.max(Math.min(t/e,4/3),.75)},t.each(n,function(t,n){var s=n.width||200,g=n.height||300;n.ratio=c(s,g),u.push(n);var m=u.length;h+=n.ratio;var _=i-(m-1)*o,v=Math.round(_/h);if(r>v||m>5){var y=u.pop();_=i-(u.length-1)*o,h-=y.ratio,l.push({items:e(u,_,f,o,h),rowHeight:f,complete:!0}),f>d&&(d=f),u=[y],m=1,h=y.ratio,_=i,v=Math.round(_/h)}if(f=v,t==p-1){var b=!0;v>a&&4>=m&&(b=!1,v=Math.round(.6*a+.4*r),_=Math.round(v*h)),l.push({items:e(u,_,v,o,h),rowHeight:v,complete:b})}}),l}}($),function(t){function e(e){var n=t(window).scrollTop(),o=e.find(".lazy-load");t.each(o,function(e,o){var r=t(o);r.offset().top<i+n&&"none"!=r.css("display")&&("image"==r.data("lazy-type")?r.attr("src",r.data("lazy-url")):r.css({backgroundImage:"url("+r.data("lazy-url")+")"}),r.removeClass("lazy-load"))})}var i=window.innerHeight;t.fn.lazyload=function(i){var n=this;n.each(function(n,o){var r=t(o),s=r.data("lazyload");s||(r.data("lazyload",!0),i||t(window).on("scroll",function(){e(r)})),e(r)})}}($),!function(){"use strict";function t(t,e){function i(t){return function(i){return function(t){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(r=2&t[0]?o.return:t[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,t[1])).done)return r;switch(o=0,r&&(t=[2&t[0],r.value]),t[0]){case 0:case 1:r=t;break;case 4:return a.label++,{value:t[1],done:!1};case 5:a.label++,o=t[1],t=[0];continue;case 7:t=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===t[0]||2===t[0])){a=0;continue}if(3===t[0]&&(!r||t[1]>r[0]&&t[1]<r[3])){a.label=t[1];break}if(6===t[0]&&a.label<r[1]){a.label=r[1],r=t;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(t);break}r[2]&&a.ops.pop(),a.trys.pop();continue}t=e.call(i,a)}catch(i){t=[6,i],o=0}finally{n=r=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}([t,i])}}var n,o,r,s,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return s={next:i(0),"throw":i(1),"return":i(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s}function e(t){var e="function"==typeof Symbol&&t[Symbol.iterator],i=0;return e?e.call(t):{next:function(){return t&&i>=t.length&&(t=void 0),{value:t&&t[i++],done:!t}}}}function i(t,e){var i="function"==typeof Symbol&&t[Symbol.iterator];if(!i)return t;var n,o,r=i.call(t),s=[];try{for(;(void 0===e||e-->0)&&!(n=r.next()).done;)s.push(n.value)}catch(t){o={error:t}}finally{try{n&&!n.done&&(i=r.return)&&i.call(r)}finally{if(o)throw o.error}}return s}function n(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(i(arguments[e]));return t}function o(t,e){return t(e={exports:{}},e.exports),e.exports}function r(t,e,i,n,o,r,s,a,c){try{var l=new XMLHttpRequest,u=a||"POST";l.open(u,""+t,!0),l.setRequestHeader("Content-Type","application/json; charset=utf-8"),s&&l.setRequestHeader("X-MCS-AppKey",""+s),n&&(l.withCredentials=!0),i&&(l.timeout=i,l.ontimeout=function(){r&&r(e,ae.TIMEOUT)}),l.onload=function(){if(o){var t=null;if(l.responseText){try{t=JSON.parse(l.responseText)}catch(e){t={}}o(t,e)}}},l.onerror=function(){l.abort(),r&&r(e,ae.XHR_ON)},l.send(c?e:JSON.stringify(e))}catch(t){}}function s(t,e,i,n){var o=t&&t.source||window.opener||window.parent,r=t&&t.origin||n||"*",s={type:e,payload:i};o.postMessage(JSON.stringify(s),r)}function a(t,e){Se[t]=Se[t]||[],Se[t].push(e)}function c(t){if(ke.some(function(t){return"*"===t})||ke.some(function(e){return t.origin.indexOf(e)>-1})){var e=t.data;if("string"==typeof t.data)try{e=JSON.parse(t.data)}catch(t){e=void 0}if(!e)return;var i=e.type,n=e.payload;Se[i]&&Se[i].forEach(function(e){"function"==typeof e&&e(t,n)})}}function l(t,e){var i=E({},t);delete i.filter,delete i.autotrack,(window.opener||window.parent).postMessage({type:"tea:sdk:info",config:i,version:e},"*"),window.addEventListener("message",c,!1)}function u(t){var e=t.event,i=t.editorUrl;t.collectInstance,t.fromSession,Ae||(Ae=!0,O(i,function(){s(e,"abEditorScriptloadSuccess")},function(){e&&s(e,"abEditorScriptloadError"),Ae=!1}))}function h(t,e){if(void 0===e&&(e="list"),!t)return!1;if(e&&"list"===e){if(["LI","TR","DL"].includes(t.nodeName))return!0;if(t.dataset&&t.dataset.hasOwnProperty("teaIdx"))return!0;if(t.hasAttribute&&t.hasAttribute("data-tea-idx"))return!0}else{if(["A","BUTTON"].includes(t.nodeName))return!0;if(t.dataset&&t.dataset.hasOwnProperty("teaContainer"))return!0;if(t.hasAttribute&&t.hasAttribute("data-tea-container"))return!0}return!1}function p(t){for(var e=t;e&&!h(e,"container");){if("HTML"===e.nodeName||"BODY"===e.nodeName)return t;e=e.parentElement}return e||t}function f(t){var e="";return 3===t.nodeType?e=t.textContent.trim():t.dataset&&t.dataset.hasOwnProperty("teaTitle")?e=t.getAttribute("data-tea-title"):t.hasAttribute("ata-tea-title")?e=t.getAttribute("data-tea-title"):t.hasAttribute("title")?e=t.getAttribute("title"):"INPUT"===t.nodeName&&["button","submit"].includes(t.getAttribute("type"))?e=t.getAttribute("value"):"IMG"===t.nodeName&&t.getAttribute("alt")&&(e=t.getAttribute("alt")),e.slice(0,200)}function d(t){for(var e=[];null!==t.parentElement;)e.push(t),t=t.parentElement;var i=[],n=[];return e.forEach(function(t){var e=function(t){if(null===t)return{str:"",index:0};var e=0,i=t.parentElement;if(i)for(var n=i.children,o=0;o<n.length&&n[o]!==t;o++)n[o].nodeName===t.nodeName&&e++;return{str:[t.nodeName.toLowerCase(),h(t,"list")?"[]":""].join(""),index:e}}(t),o=e.str,r=e.index;i.unshift(o),n.unshift(r)}),{element_path:"/"+i.join("/"),positions:n}}function g(t,e,i,n){var o={},r=function(t){if(t){var e=t.getBoundingClientRect(),i=e.width,n=e.height;return{left:e.left,top:e.top,element_width:i,element_height:n}}}(e),s=function(t,e){void 0===t&&(t={}),void 0===e&&(e={});var i=t.clientX,n=t.clientY,o=e.left,r=e.top,s=i-o>=0?i-o:0,a=n-r>=0?n-r:0;return{touch_x:Math.floor(s),touch_y:Math.floor(a)}}(t,r),a=r.element_width,c=r.element_height,l=s.touch_x,u=s.touch_y,h=d(e),g=h.element_path,m=h.positions,_=function(t){var e=p(t),i=[];return function n(t){var e=f(t);if(e&&-1===i.indexOf(e)&&i.push(e),t.childNodes.length>0)for(var o=t.childNodes,r=0;r<o.length;r++)8!==o[r].nodeType&&n(o[r])}(e),i}(e),v=window.performance.timing.navigationStart,y=Date.now()-v,b=m.map(function(t){return""+t}),w=null;if(window.TEAVisualEditor&&window.TEAVisualEditor.getOriginXpath&&(w=window.TEAVisualEditor.getOriginXpath({xpath:g,positions:b})),o.element_path=w&&w.xpath||g,o.positions=w&&w.positions||b,n&&!n.text&&(o.texts=_,o.element_title=function(t){var e=p(t),i="";return function n(t){var e=f(t);if(e&&(i+=e),t.childNodes.length>0)for(var o=t.childNodes,r=0;r<o.length;r++)3===o[r].nodeType&&n(o[r])}(e),i}(e)),o.element_id=e.getAttribute("id")||"",o.element_class_name=e.getAttribute("class")||"",o.element_type=e.nodeType,o.element_width=Math.floor(a),o.element_height=Math.floor(c),o.touch_x=l,o.touch_y=u,o.page_manual_key="",o.elememt_manual_key="",o.since_page_start_ms=y,o.page_start_ms=v,o.page_path=location.pathname,o.page_host=location.host,i.track_attr&&Ue(e,i.track_attr)){var E=je(e,i.track_attr);for(var S in E)o[S]=E[S]}var k=p(e);return"A"===k.tagName&&(o.href=k.getAttribute("href")),"IMG"===e.tagName&&(o.src=e.getAttribute("src")),o}function m(){try{var t=window.TEAVisualEditor.lang=window.TEAVisualEditor.lang||N.get(Ze),e=window.TEAVisualEditor.__editor_ajax_domain=window.TEAVisualEditor.__editor_ajax_domain||N.get(Xe),i=window.TEAVisualEditor.__editor_verison=window.TEAVisualEditor.__editor_verison||N.get(ti),n=window.TEAVisualEditor.__editor_url=window.TEAVisualEditor.__editor_url||N.get(ei),o=+new Date,r=new Date(o+18e5);N.set(Qe,"1",{expires:r}),N.set(Xe,e,{expires:r}),N.set(ei,n,{expires:r}),N.set(Ze,t,{expires:r}),N.set(ti,i||"",{expires:r})}catch(t){}}function _(t){var e=t.event,i=t.editorUrl,n=t.autoTrackInstance;ii||(ii=!0,O(i,function(){s(e,"editorScriptloadSuccess"),n.destroy()},function(){e&&s(e,"editorScriptloadError"),ii=!1}))}function v(t,e){window.TEAVisualEditor=window.TEAVisualEditor||{};var i="",n=q+"?query="+Date.now();window.TEAVisualEditor.appId=e.app_id;var o=e.channel_domain,r="";if(De(["*"]),o){var s,c="";try{var u=window.performance.getEntriesByType("resource");if(u&&u.length&&(u.forEach(function(t){"script"===t.initiatorType&&t.name&&-1!==t.name.indexOf("collect")&&(c=t.name)}),c&&(s=c.split("/"))&&s.length)){r="https:/";for(var h=2;h<s.length&&h!==s.length-1;h++)r=r+"/"+s[h];if(r&&r.indexOf("/5.0")){var p=r.split("/5.0");r=p[0]||r}}}catch(t){}}if(l(e,J),"1"===N.get(Qe)){var f=function(){var t=N.get(Xe);try{t=JSON.parse(t)}catch(t){}return t}(),d="";f&&(window.TEAVisualEditor.__editor_ajax_domain=f,d=N.get(ei)),_({event:null,editorUrl:d||n,autoTrackInstance:t}),m()}else try{a("tea:openVisualEditor",function(t){var e=t.data;if("string"==typeof t.data)try{e=JSON.parse(t.data)}catch(s){e=void 0}if(e){var a=e.referrer,c=e.lang;if(a&&(window.TEAVisualEditor.__editor_ajax_domain=a),i=n,o){var l=e.version;i=r?""+r+(l?"/visual-editor-rangers-v"+l:"/visual-editor-rangers-v1.0.0")+".js":n,window.TEAVisualEditor.__editor_verison=l}window.TEAVisualEditor.__editor_url=i,window.TEAVisualEditor.lang=c,_({event:t,editorUrl:i,autoTrackInstance:s}),m()}}),window.TEAVisualEditor.openAutotrackEditor=function(){_({event:null,editorUrl:window.TEAVisualEditor.__editor_url,autoTrackInstance:t})}}catch(t){}try{a("tea:openHeatMapCore",function(i){var n=W,o=i.data.app_id;o&&o!==e.app_id||_({event:i,editorUrl:n+".js?query="+Date.now(),autoTrackInstance:t})})}catch(t){}}var y,b,w,E=function(){return(E=Object.assign||function(t){for(var e,i=1,n=arguments.length;n>i;i++)for(var o in e=arguments[i])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},S=function(){function t(){this._hooks={},this._cache=[],this._hooksCache={}}return t.prototype.on=function(t,e){t&&e&&"function"==typeof e&&(this._hooks[t]||(this._hooks[t]=[]),this._hooks[t].push(e))},t.prototype.once=function(t,e){var i=this;t&&e&&"function"==typeof e&&this.on(t,function n(o){e(o),i.off(t,n)})},t.prototype.off=function(t,e){if(t&&this._hooks[t]&&this._hooks[t].length)if(e){var i=this._hooks[t].indexOf(e);-1!==i&&this._hooks[t].splice(i,1)}else this._hooks[t]=[]},t.prototype.emit=function(t,e,i){if(i){if(!t)return;-1!==this._cache.indexOf(i)?this._emit(t,e):(this._hooksCache.hasOwnProperty(i)||(this._hooksCache[i]={}),this._hooksCache[i].hasOwnProperty(t)||(this._hooksCache[i][t]=[]),this._hooksCache[i][t].push(e))}else this._emit(t,e)},t.prototype._emit=function(t,e){t&&this._hooks[t]&&this._hooks[t].length&&n(this._hooks[t]).forEach(function(t){try{t(e)}catch(t){}})},t.prototype.set=function(t){t&&-1===this._cache.indexOf(t)&&this._cache.push(t)},t}(),k=function(t){return null!=t&&"[object Object]"==Object.prototype.toString.call(t)},D=function(t){return Array.isArray(t)},T=(y=+Date.now()+Number((""+Math.random()).slice(2,8)),function(){return y+=1}),A=function(t){return function(t,e,i){if("string"==typeof t&&"number"==typeof e&&"number"==typeof i){var n,o=[];i=25>=i?i:i%25;var r=String.fromCharCode(i+97);n=t.split(r);for(var s=0;s<n.length;s++){var a=parseInt(n[s],i);a=1*a^e;var c=String.fromCharCode(a);o.push(c)}return o.join("")}}(t,64,25)},M=function(t){navigator.userAgent.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/)?window.addEventListener("pagehide",t,!1):window.addEventListener("beforeunload",t,!1)},O=function(t,e,i){var n=document.createElement("script");n.src=t,n.onerror=function(){i(t)},n.onload=function(){e()},document.getElementsByTagName("head")[0].appendChild(n)},x=function(){var t=0;return["hidden","msHidden","webkitHidden"].forEach(function(e){void 0!==document[e]&&(t=1)}),t},G=function(t,e){void 0===t&&(t=function(){}),void 0===e&&(e=1e3);var i,n=Date.now()+e;return i=window.setTimeout(function o(){var r=Date.now()-n;t(),n+=e,i=window.setTimeout(o,Math.max(0,e-r))},e),function(){window.clearTimeout(i)}},C=function(t){var e=document.createElement("a");return e.href=t,e},I=function(t){var e={};try{var i=C(t).search;if(!i)return e;(i=i.slice(1)).split("&").forEach(function(t){var i,n,o=t.split("=");o.length&&(i=o[0],n=o[1]);try{e[i]=decodeURIComponent(void 0===n?"":n)}catch(t){e[i]=n}})}catch(t){}return e},R=function(t){for(var e=0,i=0,n=(t+="").length,o=0;n>o;o++)((e=31*e+t.charCodeAt(i++))>0x7fffffffffff||-0x800000000000>e)&&(e&=0xffffffffffff);return 0>e&&(e+=0x7ffffffffffff),e},N=o(function(t){var e;e=function(){function t(){for(var t=0,e={};t<arguments.length;t++){var i=arguments[t];for(var n in i)e[n]=i[n]}return e}function e(t){return t.replace(/(%[0-9A-Z]{2})+/g,decodeURIComponent)}return function i(n){function o(){}function r(t,e,i){if("undefined"!=typeof document){"number"==typeof(i=s({path:"/"},o.defaults,i)).expires&&(i.expires=new Date(1*new Date+864e5*i.expires)),i.expires=i.expires?i.expires.toUTCString():"";try{var r=JSON.stringify(e);/^[\{\[]/.test(r)&&(e=r)}catch(s){}e=n.write?n.write(e,t):encodeURIComponent(String(e)).replace(/%(23|24|26|2B|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g,decodeURIComponent),t=encodeURIComponent(String(t)).replace(/%(23|24|26|2B|5E|60|7C)/g,decodeURIComponent).replace(/[\(\)]/g,escape);var a="";for(var c in i)i[c]&&(a+="; "+c,!0!==i[c]&&(a+="="+i[c].split(";")[0]));return document.cookie=t+"="+e+a}}function s(t,i){if("undefined"!=typeof document){for(var o={},r=document.cookie?document.cookie.split("; "):[],s=0;s<r.length;s++){var a=r[s].split("="),c=a.slice(1).join("=");i||'"'!==c.charAt(0)||(c=c.slice(1,-1));try{var l=e(a[0]);if(c=(n.read||n)(c,l)||e(c),i)try{c=JSON.parse(c)}catch(t){}if(o[l]=c,t===l)break}catch(t){}}return t?o[t]:o}}return o.set=r,o.get=function(t){return s(t,!1)},o.getJSON=function(t){return s(t,!0)},o.remove=function(e,i){r(e,"",t(i,{expires:-1}))},o.defaults={},o.withConverter=i,o}(function(){})},t.exports=e()}),z=function(t,e){try{return t?N.get(t,{domain:e||document.domain}):N.get()}catch(t){return""}},B=function(t,e,i,n){try{var o=n||document.domain,r=+new Date+(i||6048e5);N.set(t,e,{expires:new Date(r),path:"/",domain:o})}catch(t){}},$=function(){function t(){this.cache={}}return t.prototype.setItem=function(t,e){this.cache[t]=e},t.prototype.getItem=function(t){return this.cache[t]},t.prototype.removeItem=function(t){this.cache[t]=void 0},t.prototype.getCookie=function(t,e){return z(t,e)},t.prototype.setCookie=function(t,e,i,n){B(t,e,i,n)},t}(),U={getItem:function(t){try{var e=localStorage.getItem(t),i=e;try{e&&"string"==typeof e&&(i=JSON.parse(e))}catch(t){}return i||{}}catch(t){}return{}},setItem:function(t,e){try{var i="string"==typeof e?e:JSON.stringify(e);localStorage.setItem(t,i)}catch(t){}},removeItem:function(t){try{localStorage.removeItem(t)}catch(t){}},getCookie:function(t,e){return z(t,e)},setCookie:function(t,e,i,n){B(t,e,i,n)},isSupportLS:function(){try{return localStorage.setItem("_ranger-test-key","hi"),localStorage.getItem("_ranger-test-key"),localStorage.removeItem("_ranger-test-key"),!0}catch(t){return!1}}()},P={getItem:function(t){try{var e=sessionStorage.getItem(t),i=e;try{e&&"string"==typeof e&&(i=JSON.parse(e))}catch(t){}return i||{}}catch(t){}return{}},setItem:function(t,e){try{var i="string"==typeof e?e:JSON.stringify(e);sessionStorage.setItem(t,i)}catch(t){}},removeItem:function(t){try{sessionStorage.removeItem(t)}catch(t){}},getCookie:function(t,e){return z(t,e)},setCookie:function(t,e,i,n){B(t,e,i,n)},isSupportSession:function(){try{return sessionStorage.setItem("_ranger-test-key","hi"),sessionStorage.getItem("_ranger-test-key"),sessionStorage.removeItem("_ranger-test-key"),!0}catch(t){return!1}}()},L=function(){function t(t,e){this._storage=e&&"session"===e?P:!t&&U.isSupportLS?U:new $}return t.prototype.getItem=function(t){return this._storage.getItem(t)},t.prototype.setItem=function(t,e){this._storage.setItem(t,e)},t.prototype.getCookie=function(t,e){return this._storage.getCookie(t,e)},t.prototype.setCookie=function(t,e,i,n){this._storage.setCookie(t,e,i,n)},t.prototype.removeItem=function(t){this._storage.removeItem(t)},t}(),j=function(){function t(t,e,i){this.appid=t,this.domain=e,this.userAgent=window.navigator.userAgent,this.appVersion=window.navigator.appVersion,this.cookie_expire=i}return t.prototype.init=function(){var t=window.navigator.userAgent,e=window.navigator.language,i=document.referrer,n=i?C(i).hostname:"",o=I(window.location.href),r=/Mobile|htc|mini|Android|iP(ad|od|hone)/.test(this.appVersion)?"wap":"web";this.utm=function(t,e,i,n){var o=new L(!1),r=new L(!1,"session"),s=t?"_tea_utm_cache_"+t:"_tea_utm_cache",a=t?"_$utm_from_url_"+t:"_$utm_from_url",c={},l=["tr_shareuser","tr_admaster","tr_param1","tr_param2","tr_param3","tr_param4","$utm_from_url"],u={ad_id:Number(e.ad_id)||void 0,campaign_id:Number(e.campaign_id)||void 0,creative_id:Number(e.creative_id)||void 0,utm_source:e.utm_source,utm_medium:e.utm_medium,utm_campaign:e.utm_campaign,utm_term:e.utm_term,utm_content:e.utm_content,tr_shareuser:e.tr_shareuser,tr_admaster:e.tr_admaster,tr_param1:e.tr_param1,tr_param2:e.tr_param2,tr_param3:e.tr_param3,tr_param4:e.tr_param4};try{var h=!1;for(var p in u)u[p]&&(-1!==l.indexOf(p)?(c.hasOwnProperty("tracer_data")||(c.tracer_data={}),c.tracer_data[p]=u[p]):c[p]=u[p],h=!0);if(h)r.setItem(a,"1"),o.setCookie(s,JSON.stringify(c),n,i);else{var f=o.getCookie(s,i);f&&(c=JSON.parse(f))}r.getItem(a)&&(c.hasOwnProperty("tracer_data")||(c.tracer_data={}),c.tracer_data.$utm_from_url=1)}catch(t){return u}return c}(this.appid,o,this.domain,this.cookie_expire);var s=this.browser(),a=this.os();return{browser:s.browser,browser_version:s.browser_version,platform:r,os_name:a.os_name,os_version:a.os_version,userAgent:t,screen_width:window.screen&&window.screen.width,screen_height:window.screen&&window.screen.height,device_model:this.getDeviceModel(a.os_name),language:e,referrer:i,referrer_host:n,utm:this.utm,latest_data:this.last(i,n)}},t.prototype.last=function(t,e){var i="",n="",o="",r=location.hostname,s=!1;if(t&&e&&r!==e){i=t,n=e,s=!0;var a=I(t);a.keyword&&(o=a.keyword)}return{$latest_referrer:i,$latest_referrer_host:n,$latest_search_keyword:o,isLast:s}},t.prototype.browser=function(){var t,e,i="",n=""+parseFloat(this.appVersion),o=this.userAgent;return-1!==o.indexOf("Edge")||-1!==o.indexOf("Edg")?(i="Microsoft Edge",-1!==o.indexOf("Edge")?(t=o.indexOf("Edge"),n=o.substring(t+5)):(t=o.indexOf("Edg"),n=o.substring(t+4))):-1!==(t=o.indexOf("MSIE"))?(i="Microsoft Internet Explorer",n=o.substring(t+5)):-1!==(t=o.indexOf("Lark"))?(i="Lark",n=o.substring(t+5,t+11)):-1!==(t=o.indexOf("MetaSr"))?(i="sougoubrowser",n=o.substring(t+7,t+10)):-1!==o.indexOf("MQQBrowser")||-1!==o.indexOf("QQBrowser")?(i="qqbrowser",-1!==o.indexOf("MQQBrowser")?(t=o.indexOf("MQQBrowser"),n=o.substring(t+11,t+15)):-1!==o.indexOf("QQBrowser")&&(t=o.indexOf("QQBrowser"),n=o.substring(t+10,t+17))):-1!==o.indexOf("Chrome")?-1!==(t=o.indexOf("MicroMessenger"))?(i="weixin",n=o.substring(t+15,t+20)):-1!==(t=o.indexOf("360"))?(i="360browser",n=o.substring(o.indexOf("Chrome")+7)):-1!==o.indexOf("baidubrowser")||-1!==o.indexOf("BIDUBrowser")?(-1!==o.indexOf("baidubrowser")?(t=o.indexOf("baidubrowser"),n=o.substring(t+13,t+16)):-1!==o.indexOf("BIDUBrowser")&&(t=o.indexOf("BIDUBrowser"),n=o.substring(t+12,t+15)),i="baidubrowser"):-1!==(t=o.indexOf("xiaomi"))?-1!==o.indexOf("openlanguagexiaomi")?(i="openlanguage xiaomi",n=o.substring(t+7,t+13)):(i="xiaomi",n=o.substring(t-7,t-1)):-1!==(t=o.indexOf("TTWebView"))?(i="TTWebView",n=o.substring(t+10,t+23)):-1!==(t=o.indexOf("Chrome"))?(i="Chrome",n=o.substring(t+7)):-1!==(t=o.indexOf("Chrome"))&&(i="Chrome",n=o.substring(t+7)):-1!==o.indexOf("Safari")?-1!==(t=o.indexOf("QQ"))?(i="qqbrowser",n=o.substring(t+10,t+16)):-1!==(t=o.indexOf("Safari"))&&(i="Safari",n=o.substring(t+7),-1!==(t=o.indexOf("Version"))&&(n=o.substring(t+8))):-1!==(t=o.indexOf("Firefox"))?(i="Firefox",n=o.substring(t+8)):-1!==(t=o.indexOf("MicroMessenger"))?(i="weixin",n=o.substring(t+15,t+20)):-1!==(t=o.indexOf("QQ"))&&(i="qqbrowser",n=o.substring(t+3,t+8)),-1!==(e=n.indexOf(";"))&&(n=n.substring(0,e)),-1!==(e=n.indexOf(" "))&&(n=n.substring(0,e)),-1!==(e=n.indexOf(")"))&&(n=n.substring(0,e)),{browser:i,browser_version:n}},t.prototype.os=function(){for(var t="",e="",i=[{s:"Windows 10",r:/(Windows 10.0|Windows NT 10.0|Windows NT 10.1)/},{s:"Windows 8.1",r:/(Windows 8.1|Windows NT 6.3)/},{s:"Windows 8",r:/(Windows 8|Windows NT 6.2)/},{s:"Windows 7",r:/(Windows 7|Windows NT 6.1)/},{s:"Android",r:/Android/},{s:"Sun OS",r:/SunOS/},{s:"Linux",r:/(Linux|X11)/},{s:"iOS",r:/(iPhone|iPad|iPod)/},{s:"Mac OS X",r:/Mac OS X/},{s:"Mac OS",r:/(MacPPC|MacIntel|Mac_PowerPC|Macintosh)/}],n=0;n<i.length;n++){var o=i[n];if(o.r.test(this.userAgent)){"Mac OS X"===(t=o.s)&&this.isNewIpad()&&(t="iOS");break}}var r=function(t,e){var i=t.exec(e);return i&&i[1]?i[1]:""},s=function(t,e){var i=RegExp("(?:^|[^A-Z0-9-_]|[^A-Z0-9-]_|sprd-)(?:"+t+")","i").exec(e);return i?i.slice(1)[0]:""};/Windows/.test(t)&&(e=r(/Windows (.*)/,t),t="windows");var a,c;switch(t){case"Mac OS X":e=s("Mac[ +]OS[ +]X(?:[ /](?:Version )?(\\d+(?:[_\\.]\\d+)+))?",this.userAgent),t="mac";break;case"Android":a=this.userAgent,(c=r(/Android ([\.\_\d]+)/,a))||(c=r(/Android\/([\.\_\d]+)/,a)),e=c,t="android";break;case"iOS":e=this.isNewIpad()?s("Mac[ +]OS[ +]X(?:[ /](?:Version )?(\\d+(?:[_\\.]\\d+)+))?",this.userAgent):(e=/OS (\d+)_(\d+)_?(\d+)?/.exec(this.appVersion))?e[1]+"."+e[2]+"."+(0|e[3]):"",t="ios"}return{os_name:t,os_version:e}},t.prototype.getDeviceModel=function(t){var e="";try{if("android"===t)navigator.userAgent.split(";").forEach(function(t){t.indexOf("Build/")>-1&&(e=t.slice(0,t.indexOf("Build/")))});else if("ios"===t||"mac"===t||"windows"===t)if(this.isNewIpad())e="iPad";else{var i=navigator.userAgent.replace("Mozilla/5.0 (",""),n=i.indexOf(";");e=i.slice(0,n)}}catch(t){return e.trim()}return e.trim()},t.prototype.isNewIpad=function(){return void 0!==this.userAgent&&"MacIntel"===navigator.platform&&"number"==typeof navigator.maxTouchPoints&&navigator.maxTouchPoints>1},t}(),V={cn:"1fz22z22z1nz21z4mz4bz4bz22z1mz19z1jz1mz1ez4az1az22z1mz19z21z1lz21z21z1bz1iz4az1az1mz1k",va:"1fz22z22z1nz21z4mz4bz4bz22z1mz19z1jz1mz1ez4az1gz22z1mz19z21z1lz21z21z1bz1iz4az1az1mz1k",sg:"1fz22z22z1nz21z4mz4bz4bz22z1mz19z1jz1mz1ez4az22z1mz19z21z1lz21z21z1bz1iz4az1az1mz1k"},K={cn:"1fz22z22z1nz21z4mz4bz4bz1kz1az21z4az28z1gz1hz1gz1cz18z1nz1gz4az1az1mz1k",sg:"1fz22z22z1nz21z4mz4bz4bz21z1ez18z1jz1gz49z1kz1az21z4az19z27z22z1cz1mz24z1cz20z21z1cz18z4az1az1mz1k",va:"1fz22z22z1nz21z4mz4bz4bz1kz18z1jz1gz24z18z49z1kz1az21z4az19z27z22z1cz1mz24z1cz20z21z1cz18z4az1az1mz1k"},J="5.0.51",q="https://lf-cdn-tos.bytescm.com/obj/static/log-sdk/collect/visual-editor-rangers.js",H="https://lf-cdn-tos.bytescm.com/obj/static/log-sdk/collect/visual-ab-core.js",W="https://lf-cdn-tos.bytescm.com/obj/static/log-sdk/collect/heatmap-core",F=function(){function t(t,e){this.collector=t,this.config=e,this.eventNameWhiteList=["__bav_page","__bav_beat","__bav_page_statistics","__bav_click","__bav_page_exposure"],this.paramsNameWhiteList=["$inactive","$inline","$target_uuid_list","$source_uuid","$is_spider","$source_id","$is_first_time","_staging_flag"],this.regStr=new RegExp("^[a-zA-Z0-9][a-z0-9A-Z_.-]{1,255}$")}return t.prototype.checkVerify=function(t){var e=this;if(!t||!t.length)return!1;var i=t[0];if(!i)return!1;var n=i.events,o=i.header;if(!n||!n.length)return!1;var r=!0;return n.forEach(function(t){return t?(e.checkEventName(t.event)||(r=!1,t.checkEvent="浜嬩欢鍚嶄笉鑳戒互 $ or __寮€澶�"),void(e.checkEventParams(t.params)||(r=!1,t.checkParams="灞炴€у悕涓嶈兘浠� $ or __寮€澶�"))):(r=!1,void(t.checkEvent="浜嬩欢寮傚父"))}),this.checkEventParams(o)||(r=!1),r},t.prototype.checkEventName=function(t){return!!t&&this.calculate(t,"event")},t.prototype.checkEventParams=function(t){var e=t;if("string"==typeof t&&(e=JSON.parse(e)),!Object.keys(e).length)return!0;for(var i in e)return!(!this.calculate(i,"params")||"string"==typeof e[i]&&e[i].length>1024);return!0},t.prototype.calculate=function(t,e){return-1!==("event"===e?this.eventNameWhiteList:this.paramsNameWhiteList).indexOf(t)||!new RegExp("^\\$").test(t)&&!new RegExp("^__").test(t)||!1},t}();!function(t){t.Init="init",t.Config="config",t.Start="start",t.Ready="ready",t.UnReady="un-ready",t.TokenComplete="token-complete",t.TokenStorage="token-storage",t.TokenFetch="token-fetch",t.TokenError="token-error",t.ConfigUuid="config-uuid",t.ConfigWebId="config-webid",t.ConfigDomain="config-domain",t.CustomWebId="custom-webid",t.TokenChange="token-change",t.TokenReset="token-reset",t.ConfigTransform="config-transform",t.EnvTransform="env-transform",t.SessionReset="session-reset",t.SessionResetTime="session-reset-time",t.Event="event",t.Events="events",t.EventNow="event-now",t.CleanEvents="clean-events",t.BeconEvent="becon-event",t.SubmitBefore="submit-before",t.SubmitScuess="submit-scuess",t.SubmitAfter="submit-after",t.SubmitError="submit-error",t.SubmitVerify="submit-verify",t.Stay="stay",t.ResetStay="reset-stay",t.StayReady="stay-ready",t.SetStay="set-stay",t.RouteChange="route-change",t.RouteReady="route-ready",t.Ab="ab",t.AbVar="ab-var",t.AbAllVars="ab-all-vars",t.AbConfig="ab-config",t.AbExternalVersion="ab-external-version",t.AbVersionChangeOn="ab-version-change-on",t.AbVersionChangeOff="ab-version-change-off",t.AbOpenLayer="ab-open-layer",t.AbCloseLayer="ab-close-layer",t.AbReady="ab-ready",t.AbComplete="ab-complete",t.AbTimeout="ab-timeout",t.Profile="profile",t.ProfileSet="profile-set",t.ProfileSetOnce="profile-set-once",t.ProfileUnset="profile-unset",t.ProfileIncrement="profile-increment",t.ProfileAppend="profile-append",t.ProfileClear="profile-clear",t.Autotrack="autotrack",t.AutotrackReady="autotrack-ready",t.CepReady="cep-ready",t.TracerReady="tracer-ready",t.sessionRecord="session-record",t.SessionRecordStart="session-record-start",t.SessionRecordPause="session-record-pause",t.SessionRecordEnd="session-record-end",t.SessionRecordReport="session-record-report"}(b||(b={})),function(t){t.DEBUGGER_MESSAGE="debugger-message",t.DEBUGGER_MESSAGE_SDK="debugger-message-sdk",t.DEBUGGER_MESSAGE_FETCH="debugger-message-fetch",t.DEBUGGER_MESSAGE_FETCH_RESULT="debugger-message-fetch-result",t.DEBUGGER_MESSAGE_EVENT="debugger-message-event",t.DEVTOOL_WEB_READY="devtool-web-ready"}(w||(w={}));var Y,Q=b,X=void 0,Z=(new Date).getTimezoneOffset(),te=parseInt(""+-Z/60,10),ee=60*Z,ie=7776e6,ne=function(){function t(t,e){this.is_first_time=!0,this.configPersist=!1,this.initConfig=e,this.collect=t;var i=new j(e.app_id,e.cookie_domain||"",e.cookie_expire||ie).init();this.eventCheck=new F(t,e);var n="__tea_cache_first_"+e.app_id;this.configKey="__tea_cache_config_"+e.app_id,this.sessionStorage=new L(!1,"session"),this.localStorage=new L(!1,"local"),e.configPersist&&(this.configPersist=!0,this.storage=1===e.configPersist?this.sessionStorage:this.localStorage);var o=this.localStorage.getItem(n);o&&1==o?this.is_first_time=!1:(this.is_first_time=!0,this.localStorage.setItem(n,"1")),this.envInfo={user:{user_unique_id:X,user_type:X,user_id:X,user_is_auth:X,user_is_login:X,device_id:X,web_id:X,ip_addr_id:X,user_unique_id_type:X},header:{app_id:X,app_name:X,app_install_id:X,install_id:X,app_package:X,app_channel:X,app_version:X,ab_version:X,os_name:i.os_name,os_version:i.os_version,device_model:i.device_model,ab_client:X,traffic_type:X,client_ip:X,device_brand:X,os_api:X,access:X,language:i.language,region:X,app_language:X,app_region:X,creative_id:i.utm.creative_id,ad_id:i.utm.ad_id,campaign_id:i.utm.campaign_id,log_type:X,rnd:X,platform:i.platform,sdk_version:J,sdk_lib:"js",province:X,city:X,timezone:te,tz_offset:ee,tz_name:X,sim_region:X,carrier:X,resolution:i.screen_width+"x"+i.screen_height,browser:i.browser,browser_version:i.browser_version,referrer:i.referrer,referrer_host:i.referrer_host,width:i.screen_width,height:i.screen_height,screen_width:i.screen_width,screen_height:i.screen_height,utm_term:i.utm.utm_term,utm_content:i.utm.utm_content,utm_source:i.utm.utm_source,utm_medium:i.utm.utm_medium,utm_campaign:i.utm.utm_campaign,tracer_data:JSON.stringify(i.utm.tracer_data),custom:{},wechat_unionid:X,wechat_openid:X}},this.ab_version="",this.evtParams={},this.reportErrorCallback=function(){},this.isLast=!1,this.setCustom(i),this.initDomain(),this.initABData()}return t.prototype.initDomain=function(){var t=this.initConfig.channel_domain;if(t)this.domain=t;else{var e=this.initConfig.channel;this.domain=A(K[e])}},t.prototype.setDomain=function(t){this.domain=t},t.prototype.getDomain=function(){return this.domain},t.prototype.initABData=function(){var t="__tea_sdk_ab_version_"+this.initConfig.app_id,e=null;if(this.initConfig.ab_cross){var i=this.localStorage.getCookie(t,this.initConfig.ab_cookie_domain);e=i?JSON.parse(i):null}else e=this.localStorage.getItem(t);this.setAbCache(e)},t.prototype.setAbCache=function(t){this.ab_cache=t},t.prototype.getAbCache=function(){return this.ab_cache},t.prototype.setAbVersion=function(t){this.ab_version=t},t.prototype.getAbVersion=function(){return this.ab_version},t.prototype.clearAbCache=function(){this.ab_version="",this.ab_cache={}},t.prototype.getUrl=function(t){var e="";switch(t){case"event":e=this.initConfig.report_url||"/list";break;case"webid":e="/webid";break;case"tobid":e="/tobid"}var i="";return this.initConfig.caller&&(i="?sdk_version="+J+"&sdk_name=web&app_id="+this.initConfig.app_id+"&caller="+this.initConfig.caller),""+this.getDomain()+e+i},t.prototype.setCustom=function(t){if(t&&t.latest_data&&t.latest_data.isLast)for(var e in delete t.latest_data.isLast,this.isLast=!0,t.latest_data)this.envInfo.header.custom[e]=t.latest_data[e]},t.prototype.set=function(t){var e=this;Object.keys(t).forEach(function(i){void 0!==t[i]&&null!==t[i]||e.delete(i);try{e.eventCheck.calculate(i,"config")}catch(n){}if("traffic_type"===i&&e.isLast&&(e.envInfo.header.custom.$latest_traffic_source_type=t[i]),"evtParams"===i)e.evtParams=n({},e.evtParams||{},t.evtParams||{});else if("_staging_flag"===i)e.evtParams=n({},e.evtParams||{},{_staging_flag:t._staging_flag});else if("reportErrorCallback"===i&&"function"==typeof t[i])e.reportErrorCallback=t[i];else{var o="",r="";if(i.indexOf(".")>-1){var s=i.split(".");o=s[0],r=s[1]}o?"user"===o||"header"===o?e.envInfo[o][r]=t[i]:e.envInfo.header.custom[r]=t[i]:Object.hasOwnProperty.call(e.envInfo.user,i)?["user_type","ip_addr_id"].indexOf(i)>-1?e.envInfo.user[i]=t[i]?Number(t[i]):t[i]:["user_id","web_id","user_unique_id","user_unique_id_type"].indexOf(i)>-1?e.envInfo.user[i]=t[i]?String(t[i]):t[i]:["user_is_auth","user_is_login"].indexOf(i)>-1?e.envInfo.user[i]=Boolean(t[i]):"device_id"===i&&(e.envInfo.user[i]=t[i]):Object.hasOwnProperty.call(e.envInfo.header,i)?e.envInfo.header[i]=t[i]:e.envInfo.header.custom[i]=t[i]}})},t.prototype.get=function(t){try{return t?"evtParams"===t?this.evtParams:"reportErrorCallback"===t?this[t]:Object.hasOwnProperty.call(this.envInfo.user,t)?this.envInfo.user[t]:Object.hasOwnProperty.call(this.envInfo.header,t)?this.envInfo.header[t]:JSON.parse(JSON.stringify(this.envInfo[t])):JSON.parse(JSON.stringify(this.envInfo))}catch(t){this.collect.emit(w.DEBUGGER_MESSAGE,{type:w.DEBUGGER_MESSAGE_SDK,info:"鍙戠敓浜嗗紓甯�",level:"error",time:Date.now(),data:t.message})
}},t.prototype.setStore=function(t){try{if(!this.configPersist)return;var e=this.storage.getItem(this.configKey)||{};if(e&&Object.keys(t).length){var i=Object.assign(t,e);this.storage.setItem(this.configKey,i)}}catch(t){this.collect.emit(w.DEBUGGER_MESSAGE,{type:w.DEBUGGER_MESSAGE_SDK,info:"鍙戠敓浜嗗紓甯�",level:"error",time:Date.now(),data:t.message})}},t.prototype.getStore=function(){try{if(!this.configPersist)return null;var t=this.storage.getItem(this.configKey)||{};return t&&Object.keys(t).length?t:null}catch(t){return this.collect.emit(w.DEBUGGER_MESSAGE,{type:w.DEBUGGER_MESSAGE_SDK,info:"鍙戠敓浜嗗紓甯�",level:"error",time:Date.now(),data:t.message}),null}},t.prototype.delete=function(t){try{if(!this.configPersist)return;var e=this.storage.getItem(this.configKey)||{};e&&Object.hasOwnProperty.call(e,t)&&(delete e[t],this.storage.setItem(this.configKey,e))}catch(t){void this.collect.emit(w.DEBUGGER_MESSAGE,{type:w.DEBUGGER_MESSAGE_SDK,info:"鍙戠敓浜嗗紓甯�",level:"error",time:Date.now(),data:t.message})}},t}(),oe=function(){function t(t,e){this.isLog=e||!1,this.name=t||""}return t.prototype.info=function(t){this.isLog&&void 0},t.prototype.warn=function(t){this.isLog&&void 0},t.prototype.error=function(t){this.isLog&&void 0},t.prototype.throw=function(t){throw this.error(this.name),new Error(t)},t}(),re=function(){function t(){this.spiderBot=["Baiduspider","googlebot","360Spider","haosouspider","YoudaoBot","Sogou News Spider","Yisouspider","Googlebot","Headless","Applebot","Bingbot","PetalBot"]}return t.prototype.checkSpider=function(t){if(!t.enable_spider)return!1;var e=window.navigator.userAgent;if(!e)return!0;var i=!1;return this.spiderBot.forEach(function(t){-1!==e.indexOf(t)&&(i=!0)}),i},t}(),se=function(){function t(t,e){this.collect=t,this.native=e}var e=t.prototype;return e.bridgeInject=function(){try{return!!this.native&&(AppLogBridge?!0:!1)}catch(t){return!1}},e.bridgeReady=function(){return new Promise(function(t,e){try{i.bridgeInject()?AppLogBridge.hasStarted(function(i){i?t(!0):e(!1)}):e(!1)}catch(i){e(!1)}})},e.setNativeAppId=function(t){try{void AppLogBridge.setNativeAppId(JSON.stringify(t))}catch(t){}},e.setConfig=function(t){var e=this;try{Object.keys(t).forEach(function(i){"user_unique_id"===i?e.setUserUniqueId(t[i]):t[i]?e.addHeaderInfo(i,t[i]):e.removeHeaderInfo(i)})}catch(t){}},e.setUserUniqueId=function(t){try{AppLogBridge.setUserUniqueId(t)}catch(t){}},e.addHeaderInfo=function(t,e){try{AppLogBridge.addHeaderInfo(t,e)}catch(t){}},e.setHeaderInfo=function(t){try{AppLogBridge.setHeaderInfo(JSON.stringify(t))}catch(t){}},e.removeHeaderInfo=function(t){try{AppLogBridge.removeHeaderInfo(t)}catch(t){}},e.reportPv=function(t){this.onEventV3("predefine_pageview",t)},e.onEventV3=function(t,e){try{AppLogBridge.onEventV3(t,e),this.collect.emit(DebuggerMesssge.DEBUGGER_MESSAGE,{type:DebuggerMesssge.DEBUGGER_MESSAGE_EVENT,info:"bridge鍩嬬偣涓婃姤",time:Date.now(),data:[{events:[{event:t,params:e}]}],code:200,status:"success"})}catch(t){}},e.profileSet=function(t){try{AppLogBridge.profileSet(t)}catch(t){}},e.profileSetOnce=function(t){try{AppLogBridge.profileSetOnce(t)}catch(t){}},e.profileIncrement=function(t){try{AppLogBridge.profileIncrement(t)}catch(t){}},e.profileUnset=function(t){try{AppLogBridge.profileUnset(t)}catch(t){}},e.profileAppend=function(t){try{AppLogBridge.profileAppend(t)}catch(t){}},t}(),ae={NO_URL:4001,IMG_ON:4e3,IMG_CATCH:4002,BEACON_FALSE:4003,XHR_ON:500,RESPONSE:5001,TIMEOUT:5005},ce=4001,le=4e3,ue=4002,he=4003,pe=function(t,e,i,n){try{var o=t.match(/\/v\d\//),r="";r=o?o[0]:-1!==t.indexOf("/v1/")?"/v1/":"/v2/";var s=t.split(r)[0];if(!s)return void n(t,e,ce);e.forEach(function(o){var r=function(t){var e="";for(var i in t)t.hasOwnProperty(i)&&void 0!==t[i]&&(e+="&"+i+"="+encodeURIComponent(JSON.stringify(t[i])));return e="&"===e[0]?e.slice(1):e}(o),a=new Image(1,1);a.onload=function(){a=null,i&&i()},a.onerror=function(){a=null,n&&n(t,e,le)},a.src=s+"/gif?"+r})}catch(i){n&&n(t,e,ue,i.message)}},fe=function(t,e,i,n,o,s,a,c){var l=window.navigator.userAgent;if(-1===window.navigator.appName.indexOf("Microsoft Internet Explorer")||-1===l.indexOf("MSIE 8.0")&&-1===l.indexOf("MSIE 9.0")){if(a)return window.navigator&&window.navigator.sendBeacon?void(window.navigator.sendBeacon(t,JSON.stringify(e))?o():s(t,e,he)):void pe(t,e,o,s)}else pe(t,e,o,s);r(t,e,i,n,o,s,"","",c)},de=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var e=16*Math.random()|0;return("x"===t?e:3&e|8).toString(16)})},ge=function(){function t(){}return t.prototype.apply=function(t,e){var i=this;this.collect=t,this.storage=new L(!1,"session"),this.sessionKey="__tea_session_id_"+e.app_id,this.expireTime=e.expireTime||18e5,this.disableSession=e.disable_session,this.disableSession||(this.setSessionId(),this.collect.on(Q.SessionReset,function(){i.resetSessionId()}),this.collect.on(Q.SessionResetTime,function(){i.updateSessionIdTime()}))},t.prototype.updateSessionIdTime=function(){var t=this.storage.getItem(this.sessionKey);if(t&&t.sessionId){var e=t.timestamp;Date.now()-e>this.expireTime?t={sessionId:de(),timestamp:Date.now()}:t.timestamp=Date.now(),this.storage.setItem(this.sessionKey,t),this.resetExpTime()}},t.prototype.setSessionId=function(){var t=this,e=this.storage.getItem(this.sessionKey);e&&e.sessionId?e.timestamp=Date.now():e={sessionId:de(),timestamp:Date.now()},this.storage.setItem(this.sessionKey,e),this.sessionExp=setInterval(function(){t.checkEXp()},this.expireTime)},t.prototype.getSessionId=function(){var t=this.storage.getItem(this.sessionKey);return this.disableSession?"":t&&t.sessionId?t.sessionId:""},t.prototype.resetExpTime=function(){var t=this;this.sessionExp&&(clearInterval(this.sessionExp),this.sessionExp=setInterval(function(){t.checkEXp()},this.expireTime))},t.prototype.resetSessionId=function(){var t={sessionId:de(),timestamp:Date.now()};this.storage.setItem(this.sessionKey,t)},t.prototype.checkEXp=function(){var t=this.storage.getItem(this.sessionKey);t&&t.sessionId&&Date.now()-t.timestamp+30>=this.expireTime&&(t={sessionId:de(),timestamp:Date.now()},this.storage.setItem(this.sessionKey,t))},t}(),me=function(){function t(){this.eventLimit=50,this.enable_ttwebid=!1,this.eventCache=[],this.beconEventCache=[]}return t.prototype.apply=function(t,e){var i=this;this.collect=t,this.config=e,this.configManager=t.configManager,this.eventCheck=new F(t,e),this.cacheStorgae=new L(!0),this.localStorage=new L(!1),this.maxReport=e.max_report||10,this.reportTime=e.reportTime||e.report_time||30,this.timeout=e.timeout||1e5,this.enable_ttwebid=e.enable_ttwebid,this.reportUrl=this.configManager.getUrl("event"),this.eventKey="__tea_cache_events_"+this.configManager.get("app_id"),this.beconKey="__tea_cache_events_becon_"+this.configManager.get("app_id"),this.abKey="__tea_sdk_ab_version_"+this.configManager.get("app_id"),this.refer_key="__tea_cache_refer_"+this.configManager.get("app_id"),this.pageId=de(),this.collect.on(Q.Ready,function(){i.reportAll(!1)}),this.collect.on(Q.ConfigDomain,function(){i.reportUrl=i.configManager.getUrl("event")}),this.collect.on(Q.Event,function(t){i.event(t)}),this.collect.on(Q.BeconEvent,function(t){i.beconEvent(t)}),this.collect.on(Q.CleanEvents,function(){i.reportAll(!1)}),this.linster()},t.prototype.linster=function(){var t=this;window.addEventListener("unload",function(){t.reportAll(!0)},!1),M(function(){t.reportAll(!0)}),document.addEventListener("visibilitychange",function(){"hidden"===document.visibilityState&&t.reportAll(!0)},!1)},t.prototype.reportAll=function(t){this.report(t),this.reportBecon()},t.prototype.event=function(t){var e=this;try{var i=n(t,this.cacheStorgae.getItem(this.eventKey)||[]);if(this.cacheStorgae.setItem(this.eventKey,i),this.reportTimeout&&clearTimeout(this.reportTimeout),i.length>=this.maxReport)this.report(!1);else{var o=this.reportTime;this.reportTimeout=setTimeout(function(){e.report(!1),e.reportTimeout=null},o)}}catch(t){this.collect.emit(w.DEBUGGER_MESSAGE,{type:w.DEBUGGER_MESSAGE_SDK,info:"鍙戠敓浜嗗紓甯�",level:"error",time:Date.now(),data:t.message})}},t.prototype.beconEvent=function(t){var e=n(t,this.cacheStorgae.getItem(this.beconKey)||[]);this.cacheStorgae.setItem(this.beconKey,e),this.collect.destroyInstance||this.collect.sdkStop||this.collect.tokenManager.getReady()&&this.collect.sdkReady&&(this.cacheStorgae.removeItem(this.beconKey),this.send(this.split(this.merge(e)),!0))},t.prototype.reportBecon=function(){if(!this.collect.destroyInstance&&!this.collect.sdkStop&&this.collect.tokenManager.getReady()&&this.collect.sdkReady){var t=this.cacheStorgae.getItem(this.beconKey)||[];t&&t.length&&(this.cacheStorgae.removeItem(this.beconKey),this.send(this.split(this.merge(t)),!0))}},t.prototype.report=function(t){if(!this.collect.destroyInstance&&!this.collect.sdkStop&&this.collect.tokenManager.getReady()&&this.collect.sdkReady){var e=this.cacheStorgae.getItem(this.eventKey)||[];e.length&&(this.cacheStorgae.removeItem(this.eventKey),this.sliceEvent(e,t))}},t.prototype.sliceEvent=function(t,e){if(t.length>this.eventLimit)for(var i=0;i<t.length;i+=this.eventLimit){var n;n=t.slice(i,i+this.eventLimit);var o=this.split(this.merge(n));this.send(o,e)}else o=this.split(this.merge(t)),this.send(o,e)},t.prototype.handleRefer=function(){var t="";try{if(this.config.spa||this.config.autotrack){var e=this.localStorage.getItem(this.refer_key)||{};t=e.routeChange?e.refer_key:this.configManager.get("referrer")}else t=this.configManager.get("referrer")}catch(e){t=document.referrer}return t},t.prototype.merge=function(t,e){var i=this,n=this.configManager.get(),o=n.header,r=n.user;this.config.enable_pageid&&(o.custom.page_id=this.pageId),o.referrer=this.handleRefer(),o.custom=JSON.stringify(o.custom);var s=this.configManager.get("evtParams"),a=this.configManager.get("user_unique_id_type"),c=t.map(function(t){try{Object.keys(s).length&&!e&&(t.params=o({},s,t.params)),a&&(t.params.$user_unique_id_type=a);var n=i.configManager.getAbCache();return n&&n.uuid&&n.uuid===r.user_unique_id&&i.configManager.getAbVersion()&&(t.ab_sdk_version=i.configManager.getAbVersion()),t.session_id=i.collect.sessionManager.getSessionId(),t.params=JSON.stringify(t.params),t}catch(o){return i.collect.emit(w.DEBUGGER_MESSAGE,{type:w.DEBUGGER_MESSAGE_SDK,info:"鍙戠敓浜嗗紓甯�",level:"error",time:Date.now(),data:o.message}),t}}),l=JSON.parse(JSON.stringify({events:c,user:r,header:o}));l.local_time=Math.floor(Date.now()/1e3),l.user_unique_type=this.config.enable_ttwebid?this.config.user_unique_type:void 0,l.verbose=1;var u=[];return u.push(l),u},t.prototype.split=function(t){return t=t.map(function(t){var e=[];return e.push(t),e})},t.prototype.send=function(t,e){var i=this;t.length&&(this.config.disable_track_event||t.forEach(function(t){try{var n=JSON.parse(JSON.stringify(t));i.config.filter&&((n=i.config.filter(n))||void 0),i.collect.eventFilter&&n&&((n=i.collect.eventFilter(n))||void 0);var o=n||t,r=JSON.parse(JSON.stringify(o));if(i.eventCheck.checkVerify(r),!o.length)return;i.collect.emit(Q.SubmitBefore,o),fe(i.reportUrl,o,i.timeout,i.enable_ttwebid,function(t,e){t&&0!==t.e?(i.collect.emit(Q.SubmitError,{type:"f_data",eventData:e,errorCode:t.e,response:t}),i.collect.emit(w.DEBUGGER_MESSAGE,{type:w.DEBUGGER_MESSAGE_EVENT,info:"鍩嬬偣涓婃姤澶辫触",time:Date.now(),data:r,code:t.e,failType:"鏁版嵁寮傚父澶辫触",status:"fail"})):(i.collect.emit(Q.SubmitScuess,{eventData:e,res:t}),i.collect.emit(w.DEBUGGER_MESSAGE,{type:w.DEBUGGER_MESSAGE_EVENT,info:"鍩嬬偣涓婃姤鎴愬姛",time:Date.now(),data:r,code:200,status:"success"}))},function(t,e){i.configManager.get("reportErrorCallback")(t,e),i.collect.emit(Q.SubmitError,{type:"f_net",eventData:t,errorCode:e}),i.collect.emit(w.DEBUGGER_MESSAGE,{type:w.DEBUGGER_MESSAGE_EVENT,info:"鍩嬬偣涓婃姤缃戠粶寮傚父",time:Date.now(),data:r,code:e,failType:"缃戠粶寮傚父澶辫触",status:"fail"})},e,!1),i.collect.emit(Q.SubmitAfter,o)}catch(t){i.collect.emit(w.DEBUGGER_MESSAGE,{type:w.DEBUGGER_MESSAGE_SDK,info:"鍙戠敓浜嗗紓甯�",level:"error",time:Date.now(),data:t.message})}}))},t}(),_e=function(){return function t(e){return e?(e^16*Math.random()>>e/4).toString(10):([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,t)}().replace(/-/g,"").slice(0,19)},ve=function(){function t(){this.cacheToken={},this.enableCookie=!1,this.enable_ttwebid=!1,this.enableCustomWebid=!1}return t.prototype.apply=function(t,e){var i=this;this.collect=t,this.config=e,this.configManager=this.collect.configManager,this.storage=new L(!1),this.tokenKey="__tea_cache_tokens_"+e.app_id,this.enable_ttwebid=e.enable_ttwebid,this.enableCustomWebid=e.enable_custom_webid,this.collect.on(Q.ConfigUuid,function(t){i.setUuid(t)}),this.collect.on(Q.ConfigWebId,function(t){i.setWebId(t)}),this.enableCookie=e.cross_subdomain,this.expiresTime=e.cookie_expire||6048e5,this.cookieDomain=e.cookie_domain||"",this.checkStorage()},t.prototype.checkStorage=function(){var t=this;if(this.enableCookie){var e=this.storage.getCookie(this.tokenKey,this.cookieDomain);this.cacheToken=e&&"string"==typeof e?JSON.parse(e):{}}else this.cacheToken=this.storage.getItem(this.tokenKey)||{};this.tokenType=this.cacheToken&&this.cacheToken._type_?this.cacheToken._type_:"default","custom"!==this.tokenType||this.enableCustomWebid?this.enableCustomWebid?this.collect.on(Q.CustomWebId,function(){t.tokenReady=!0,t.collect.emit(Q.TokenComplete)}):this.checkEnv()||(this.enable_ttwebid?this.completeTtWid(this.cacheToken):this.check()):this.remoteWebid()},t.prototype.check=function(){this.cacheToken&&this.cacheToken.web_id?this.complete(this.cacheToken):this.config.disable_webid?this.complete({web_id:_e(),user_unique_id:this.configManager.get("user_unique_id")||_e()}):this.remoteWebid()},t.prototype.checkEnv=function(){var t=window.navigator.userAgent;if(-1!==t.indexOf("miniProgram")||-1!==t.indexOf("MiniProgram")){var e=I(window.location.href);return!(!e||!e.Web_ID||(this.complete({web_id:""+e.Web_ID,user_unique_id:this.configManager.get("user_unique_id")||""+e.Web_ID}),0))}return!1},t.prototype.remoteWebid=function(){var t=this,e=this.configManager.getUrl("webid"),i={app_key:this.config.app_key,app_id:this.config.app_id,url:location.href,user_agent:window.navigator.userAgent,referer:document.referrer,user_unique_id:""};this.collect.emit(w.DEBUGGER_MESSAGE,{type:w.DEBUGGER_MESSAGE_SDK,info:"SDK 鍙戣捣WEBID璇锋眰",logType:"fetch",level:"info",time:Date.now(),data:i});var n=_e();r(e,i,3e5,!1,function(e){var i;e&&0===e.e?(i=e.web_id,t.collect.emit(w.DEBUGGER_MESSAGE,{type:w.DEBUGGER_MESSAGE_SDK,info:"WEBID璇锋眰鎴愬姛",logType:"fetch",level:"info",time:Date.now(),data:e})):(i=n,t.collect.configManager.set({localWebId:n}),t.collect.emit(Q.TokenError),t.collect.emit(w.DEBUGGER_MESSAGE,{type:w.DEBUGGER_MESSAGE_SDK,info:"WEBID璇锋眰杩斿洖鍊煎紓甯�",logType:"fetch",level:"warn",time:Date.now(),data:e}),t.collect.logger.warn("appid: "+t.config.app_id+" get webid error, use local webid~")),t.complete({web_id:t.configManager.get("web_id")||i,user_unique_id:t.configManager.get("user_unique_id")||i})},function(){t.complete({web_id:t.configManager.get("web_id")||n,user_unique_id:t.configManager.get("user_unique_id")||n}),t.collect.configManager.set({localWebId:n}),t.collect.emit(Q.TokenError),t.collect.emit(w.DEBUGGER_MESSAGE,{type:w.DEBUGGER_MESSAGE_SDK,info:"WEBID璇锋眰缃戠粶寮傚父",logType:"fetch",level:"error",time:Date.now(),data:null}),t.collect.logger.warn("appid: "+t.config.app_id+", get webid error, use local webid~")})},t.prototype.complete=function(t){var e=t.web_id,i=t.user_unique_id;t.timestamp=Date.now(),this.collect.configManager.set({web_id:e,user_unique_id:i}),this.setStorage(t),this.tokenReady=!0,this.collect.emit(Q.TokenComplete)},t.prototype.completeTtWid=function(t){var e=t.user_unique_id||"",i=this.configManager.get("user_unique_id");(i||e)&&this.configManager.set({user_unique_id:i||e}),this.setStorage(t),this.tokenReady=!0,this.collect.emit(Q.TokenComplete)},t.prototype.setUuid=function(t){if(t&&-1===["null","undefined","Null","None"].indexOf(t)){var e=String(t),i=this.configManager.get("user_unique_id"),n=this.cacheToken&&this.cacheToken.user_unique_id;if(e===i&&e===n)return;this.configManager.set({user_unique_id:e}),this.cacheToken?this.cacheToken.user_unique_id=e:(this.cacheToken={},this.cacheToken.user_unique_id=e),this.cacheToken.timestamp=Date.now(),this.setStorage(this.cacheToken),this.collect.emit(Q.TokenChange,"uuid"),this.collect.emit(Q.SessionReset)}else this.clearUuid()},t.prototype.clearUuid=function(){this.config.enable_ttwebid||this.configManager.get("web_id")&&this.configManager.get("user_unique_id")!==this.configManager.get("web_id")&&(this.configManager.set({user_unique_id:this.configManager.get("web_id")}),this.cacheToken&&this.cacheToken.web_id&&(this.cacheToken.user_unique_id=this.cacheToken.web_id,this.cacheToken.timestamp=Date.now(),this.setStorage(this.cacheToken)),this.collect.emit(Q.TokenReset,"uuid"))},t.prototype.setWebId=function(t){if(t&&!this.config.enable_ttwebid){this.cacheToken&&this.cacheToken.web_id?this.cacheToken.web_id!==t&&(this.cacheToken.user_unique_id=this.cacheToken.web_id===this.cacheToken.user_unique_id?t:this.cacheToken.user_unique_id,this.cacheToken.web_id=t):(this.cacheToken={},this.cacheToken.web_id=t,this.cacheToken.user_unique_id=t),this.cacheToken.timestamp=Date.now();var e=this.configManager.get("web_id"),i=this.configManager.get("user_unique_id");i&&i!==e||(this.configManager.set({user_unique_id:t}),this.collect.emit(Q.TokenChange,"uuid")),e!==t&&(this.configManager.set({web_id:t}),this.collect.emit(Q.TokenChange,"webid")),this.setStorage(this.cacheToken)}},t.prototype.setStorage=function(t){t._type_=this.enableCustomWebid?"custom":"default",delete t["diss".split("").reverse().join("")],this.enableCookie||this.enable_ttwebid?(this.storage.setCookie(this.tokenKey,t,this.expiresTime,this.cookieDomain),this.enable_ttwebid&&(delete t.web_id,this.storage.setItem(this.tokenKey,t))):this.storage.setItem(this.tokenKey,t),this.cacheToken=t},t.prototype.getReady=function(){return this.tokenReady},t.prototype.getTobId=function(){var t=this,e=this.configManager.getUrl("tobid");return new Promise(function(i){r(e,{app_id:t.config.app_id,user_unique_id:t.configManager.get("user_unique_id"),web_id:t.configManager.get("web_id"),user_unique_id_type:t.configManager.get("user_unique_id_type")},3e4,t.enable_ttwebid,function(t){i(t&&0===t.e?t.tobid:"")},function(){i("")})})},t}(),ye=function(){function e(t,e){this.devToolReady=!1,this.devToolOrigin="*",this.sendAlready=!1,this.eventVerifyReady=!1,this.collect=t,this.config=e,this.app_id=e.app_id;var i=t.adapters,n=i.storage,o=i.fetch;this.cacheStorgae=new n(!1,"session"),this.fetch=o,this.eventVerifyInfo=[],this.sdk_type=J.includes("tob")?"tob":"inner",this.filterEvent=["__bav_page","__bav_beat","__bav_page_statistics","__bav_click","__bav_page_exposure","bav2b_page","bav2b_beat","bav2b_page_statistics","bav2b_click","bav2b_page_exposure","_be_active","predefine_pageview","__profile_set","__profile_set_once","__profile_increment","__profile_unset","__profile_append","predefine_page_alive","predefine_page_close","abtest_exposure"],e.enable_debug&&this.load()}return e.prototype.loadScript=function(t){try{var e=document.createElement("script");e.src=t,e.onerror=function(){},e.onload=function(){},document.getElementsByTagName("body")[0].appendChild(e)}catch(t){}},e.prototype.load=function(){return e=this,i=void 0,o=function(){var e,i,n;return t(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),e=I(window.location.href),1===this.getStorage()||e.open_devtool_web||parseInt(e.app_id)===this.app_id?(this.loadBaseInfo(),this.loadHook(),this.setStorage(),this.addLintener(),this.loadDebuggerModule(),this.loadDevTool(),[4,this.fetchEventInfo()]):[2];case 1:return i=t.sent(),this.sendData("devtool:web:verify",i.verifyStatus),this.eventVerifyInfo=i.data,[3,3];case 2:return n=t.sent(),[3,3];case 3:return[2]}})},new((n=void 0)||(n=Promise))(function(t,r){function s(t){try{c(o.next(t))}catch(t){r(t)}}function a(t){try{c(o.throw(t))}catch(t){r(t)}}function c(e){e.done?t(e.value):new n(function(t){t(e.value)}).then(s,a)}c((o=o.apply(e,i||[])).next())});var e,i,n,o},e.prototype.getStorage=function(){return this.cacheStorgae.getItem("__applog_devtool_web_"+this.app_id)},e.prototype.setStorage=function(){this.cacheStorgae.setItem("__applog_devtool_web_"+this.app_id,1)},e.prototype.loadDevTool=function(){this.loadScript("https://lf3-cdn-tos.bytescm.com/obj/static/log-sdk/collect/devtool/debug-web.0.0.2.js")},e.prototype.loadBaseInfo=function(){var t=this;this.info=[{title:"鍩烘湰淇℃伅",type:1,infoName:{app_id:this.config.app_id,channel:this.config.channel,"涓婃姤鍩熷悕":this.collect.configManager.getDomain(),"SDK鐗堟湰":J,"SDK寮曞叆鏂瑰紡":"script"}},{title:"鐢ㄦ埛淇℃伅",type:2,infoName:{uuid:this.collect.configManager.get("user").user_unique_id||"",web_id:this.collect.configManager.get("user").web_id||"",ssid:"鐐瑰嚮鑾峰彇SSID"}},{title:"鍏叡鍙傛暟淇℃伅",type:2,infoName:{"娴忚鍣�":this.collect.configManager.get("browser"),"娴忚鍣ㄧ増鏈�":this.collect.configManager.get("browser_version"),"骞冲彴":this.collect.configManager.get("platform"),"璁惧鍨嬪彿":this.collect.configManager.get("device_model"),"鎿嶄綔绯荤粺":this.collect.configManager.get("os_name"),"鎿嶄綔绯荤粺鐗堟湰":this.collect.configManager.get("os_version"),"灞忓箷鍒嗚鲸鐜�":this.collect.configManager.get("resolution"),"鏉ユ簮":this.collect.configManager.get("referrer"),"鑷畾涔変俊鎭�":""}},{title:"閰嶇疆淇℃伅",type:3,infoName:{"鍏ㄥ煁鐐�":!!this.config.autotrack,"鍋滅暀鏃堕暱":!!this.config.enable_stay_duration}},{title:"A/B閰嶇疆淇℃伅",type:4,infoName:{"A/B瀹為獙":!!this.config.enable_ab_test}},{title:"瀹㈡埛绔俊鎭�",type:3,infoName:{"鎵撻€氬紑鍏�":!!this.config.Native}}],this.log=[],this.event=[],this.collect.on(Q.Ready,function(){t.info[1].infoName.uuid=t.collect.configManager.get("user").user_unique_id,t.info[1].infoName.web_id=t.collect.configManager.get("user").web_id,t.info[2].infoName["鑷畾涔変俊鎭�"]=JSON.stringify(t.collect.configManager.get("custom")),t.config.enable_ab_test&&(t.info[4].infoName["宸叉洕鍏塚ID"]=t.collect.configManager.getAbVersion(),t.info[4].infoName["A/B鍩熷悕"]=t.config.ab_channel_domain||A(V[t.config.channel]),t.info[4].infoName["鍏ㄩ儴閰嶇疆"]=t.collect.configManager.getAbData()),t.config.Native&&(t.info[5].infoName["鏄惁鎵撻€�"]=!!t.collect.bridgeReport)})},e.prototype.loadHook=function(){var t=this;this.collect.stop(),this.collect.on(w.DEBUGGER_MESSAGE,function(e){switch(e.type){case w.DEBUGGER_MESSAGE_SDK:var i={time:e.time,type:e.logType||"sdk",level:e.level,name:e.info,show:!0,levelShow:!0,needDesc:!!e.data};return e.data&&(i.desc={content:JSON.stringify(e.data)}),t.updateLog(i),e.secType&&"AB"===e.secType?(t.info[4].infoName["宸叉洕鍏塚ID"]=t.collect.configManager.getAbVersion(),t.info[4].infoName["鍏ㄩ儴閰嶇疆"]=t.collect.configManager.getAbData()):"USER"===e.secType&&(t.info[1].infoName.uuid=t.collect.configManager.get("user").user_unique_id,t.info[1].infoName.web_id=t.collect.configManager.get("user").web_id),void t.updateInfo();case w.DEBUGGER_MESSAGE_EVENT:if(e.data&&e.data.length){var n=e.data[0],o=n.events,r=n.header;if(r.custom=JSON.parse(r.custom),!o.length)return;o.forEach(function(i){i.checkShow=!0,i.searchShow=!0,i.type=-1!==t.filterEvent.indexOf(i.event)?"sdk":"cus",i.type=t.collect.bridgeReport?"bridge":i.type,i.params=JSON.parse(i.params),"fail"===e.status&&(i.info={message:"code: "+e.code+"锛� msg: "+e.failType},i.failType=e.failType);var n=!1,o=!1,r=[];t.eventVerifyInfo&&t.eventVerifyInfo.length&&(t.eventVerifyInfo.forEach(function(t){t.eventStatus=!1}),t.eventVerifyInfo.forEach(function(e){i.event===e.name&&(o=!0,n=!0,i.verifyStatus=e.status,Object.keys(i.params).forEach(function(n){if("event_index"!==n){var s={};s.paramsKey=n,s.paramsKeyValue=i.params[""+n],s.paramsStatus=!1,s.paramsStatusInfo="灞炴€ф湭褰曞叆",e.params.forEach(function(e){n===e.name&&(e.checked=!0,typeof i.params[""+n]!==t.formatParamsType(e.value_type)?s.paramsStatusInfo="灞炴€х被鍨嬮敊璇紝搴斾负"+t.formatParamsType(e.value_type):(s.paramsStatus=!0,s.paramsStatusInfo=""))}),r.push(s),s.paramsStatusInfo&&(o=!1)}}),e.params.forEach(function(t){t.checked||(o=!1,r.push({paramsKey:t.name,paramsStatus:!1,paramsStatusInfo:"缂哄皯灞炴€�"+t.name}))}))})),i.reportStatus="success"===e.status,i.paramsInfo=r,i.eventStatus=o&&"success"===e.status,i.eventRecord=n}),t.updateEvent(n)}return}})},e.prototype.formatParamsType=function(t){switch(t){case 0:return"string";case 1:case 2:return"number";case 3:return"boolean"}},e.prototype.fetchEventInfo=function(){var t=this;try{return new Promise(function(e){var i=A("1fz22z22z1nz21z4mz4bz4bz18z1nz1nz1jz1mz1ez1fz1mz1kz1cz4az19z27z22z1cz1bz18z1lz1az1cz4az1lz1cz22z4bz18z1nz1nz1jz1mz1ez1bz1cz24z22z1mz1mz1jz21z4bz1mz1nz1cz1lz18z1nz1gz4bz24z4dz4bz18z1nz1nz16z1jz1mz1ez16z1kz1cz22z18")+"?app_id="+t.app_id+"&t="+t.sdk_type+"&nc=false";t.fetch(i,null,3e3,!1,function(i){t.eventVerifyReady=!0,t.collect.reStart(),e({data:i.data,verifyStatus:!0})},function(){t.eventVerifyReady=!0,t.collect.reStart(),e({data:[],verifyStatus:!1})},"","GET")})}catch(t){return{data:[],verifyStatus:!1}}},e.prototype.addLintener=function(){var t=this;window.addEventListener("message",function(e){if(e.origin===location.origin){if(e&&e.data&&"devtool:web:ready"===e.data.type){if(t.devToolOrigin=e.origin,t.devToolReady=!0,t.sendAlready)return;t.sendData("devtool:web:init",{info:t.info,log:t.log,event:t.event,appid:t.app_id}),t.sendAlready=!0}e&&e.data&&"devtool:web:ssid"===e.data.type&&t.collect.getToken(function(e){t.info[1].infoName.ssid=e.tobid,t.updateInfo()})}})},e.prototype.sendData=function(t,e){try{var i={type:t,payload:e};(window.opener||window.parent).postMessage(i,this.devToolOrigin)}catch(t){}},e.prototype.updateInfo=function(){this.devToolReady&&this.sendData("devtool:web:info",this.info)},e.prototype.updateLog=function(t){this.devToolReady?this.sendData("devtool:web:log",t):this.log.push(t)},e.prototype.updateEvent=function(t){this.devToolReady||this.eventVerifyReady?this.sendData("devtool:web:event",t):this.event.push(t)},e.prototype.loadDebuggerModule=function(){var t=document.head||document.getElementsByTagName("head")[0],e=document.createElement("style");e.appendChild(document.createTextNode("#debugger-applog-web {\n      position: fixed;\n      width: 50px;\n      height: 50px;\n      background-image: url('https://lf-cdn-tos.bytescm.com/obj/static/log-sdk/collect/devtool/applog.png');;\n      bottom: 5%;\n      right: 10%;\n      cursor: pointer;\n      z-index:100;\n      background-size: 50px;\n    }")),t.appendChild(e);var i=document.createElement("div");i.innerHTML='<div id="debugger-applog-web" class="debugger-applog-web"></div>';var n=document.createElement("div");n.innerHTML='<div id="debugger-container" class="debugger-container"></div>',document.getElementsByTagName("body")[0].appendChild(i),document.getElementsByTagName("body")[0].appendChild(n),document.getElementById("debugger-applog-web").addEventListener("click",function(){(window.opener||window.parent).postMessage({type:"devtool:web:open-draw"},location.origin)})},e}(),be=function(){function t(t){this.disableAutoPageView=!1,this.bridgeReport=!1,this.staging=!1,this.pluginInstances=[],this.sended=!1,this.started=!1,this.destroyInstance=!1,this.sdkReady=!1,this.adapters={},this.loadType="base",this.sdkStop=!1,this.name=t,this.hook=new S,this.remotePlugin=new Map,this.Types=Q,this.adapters.fetch=r,this.adapters.storage=L,this.loadType="full"}return t.usePlugin=function(e,i,n){if(i){for(var o=!1,r=0,s=t.plugins.length;s>r;r++)if(t.plugins[r].name===i){t.plugins[r].plugin=e,t.plugins[r].options=n||{},o=!0;break}o||t.plugins.push({name:i,plugin:e,options:n})}else t.plugins.push({plugin:e})},t.prototype.usePlugin=function(t,e,i){t&&("full"===this.loadType&&this.remotePlugin.get(t)?void 0:e?"string"==typeof e?this.remotePlugin.get(t)||this.remotePlugin.set(t,{src:e,call:i}):this.remotePlugin.get(t)||this.remotePlugin.set(t,{instance:e}):this.remotePlugin.get(t)||this.remotePlugin.set(t,"sdk"))},t.prototype.init=function(e){var i,n=this;this.logger=new oe(this.name,e.log),this.inited?this.logger.warn("[instance: "+this.name+"], every instance's api: init,  can be call only one time!"):e&&k(e)?e.app_id&&"number"==typeof(i=e.app_id)&&!isNaN(i)?!e.app_key||function(t){return"string"==typeof t}(e.app_key)?(e.channel_domain||-1!==["cn","sg","va"].indexOf(e.channel)||(this.logger.warn("channel must be `cn`, `sg`,`va` !"),e.channel="cn"),this.spider=new re,this.spider.checkSpider(e)?this.logger.warn("your env may be a spider, can not report!"):(this.appBridge=new se(this,e.enable_native),this.bridgeReport=this.appBridge.bridgeInject(),this.configManager=new ne(this,e),this.debugger=new ye(this,e),this.initConfig=e,this.emit(Q.Init),this.emit(w.DEBUGGER_MESSAGE,{type:w.DEBUGGER_MESSAGE_SDK,info:"SDK 鎵цINIT",data:e,level:"info",time:Date.now()}),e.disable_auto_pv&&(this.disableAutoPageView=!0),this.bridgeReport||(this.configManager.set({app_id:e.app_id}),this.eventManager=new me,this.tokenManager=new ve,this.sessionManager=new ge,Promise.all([new Promise(function(t){n.once(Q.TokenComplete,function(){t(!0)})}),new Promise(function(t){n.once(Q.Start,function(){t(!0)})})]).then(function(){try{t.plugins.reduce(function(t,e){var i=e.plugin,o=e.options,r=JSON.parse(JSON.stringify(n.initConfig)),s=Object.assign(r,o),a=new i;return a.apply(n,s),t.push(a),t},n.pluginInstances)}catch(e){n.emit(w.DEBUGGER_MESSAGE,{type:w.DEBUGGER_MESSAGE_SDK,info:"鍙戠敓浜嗗紓甯�",level:"error",time:Date.now(),data:e.message})}n.sdkReady=!0,n.emit(Q.Ready),n.emit(w.DEBUGGER_MESSAGE,{type:w.DEBUGGER_MESSAGE_SDK,info:"SDK 鍒濆鍖栧畬鎴�",time:Date.now(),level:"info",data:n.configManager.get("user")}),n.logger.info("appid: "+e.app_id+", userInfo:"+JSON.stringify(n.configManager.get("user"))),n.logger.info("appid: "+e.app_id+", sdk is ready, version type is "+n.loadType+", version is "+J+", you can report now !!!"),e.disable_auto_pv&&(n.disableAutoPageView=!0);try{"full"===n.loadType&&(e.enable_ab_test||e.autotrack)&&(window.opener||window.parent).postMessage("[tea-sdk]ready","*")}catch(e){n.emit(w.DEBUGGER_MESSAGE,{type:w.DEBUGGER_MESSAGE_SDK,info:"鍙戠敓浜嗗紓甯�",level:"error",time:Date.now(),data:e.message})}n.pageView(),n.on(Q.TokenChange,function(t){"webid"===t&&n.pageView(),n.logger.info("appid: "+e.app_id+" token change, new userInfo:"+JSON.stringify(n.configManager.get("user"))),n.emit(w.DEBUGGER_MESSAGE,{type:w.DEBUGGER_MESSAGE_SDK,info:"SDK 璁剧疆浜嗙敤鎴蜂俊鎭�",time:Date.now(),secType:"USER",level:"info",data:n.configManager.get("user")})}),n.on(Q.TokenReset,function(){n.logger.info("appid: "+e.app_id+" token reset, new userInfo:"+JSON.stringify(n.configManager.get("user"))),n.emit(w.DEBUGGER_MESSAGE,{type:w.DEBUGGER_MESSAGE_SDK,info:"SDK 閲嶇疆浜嗙敤鎴蜂俊鎭�",time:Date.now(),secType:"USER",level:"info",data:n.configManager.get("user")})}),n.on(Q.RouteChange,function(t){t.init||e.disable_route_report||n.pageView()})}),this.tokenManager.apply(this,e),this.eventManager.apply(this,e),this.sessionManager.apply(this,e)),this.inited=!0)):this.logger.warn("app_key param is error, must be string, please check!"):this.logger.warn("app_id param is error, must be number, please check!"):this.logger.warn("init params error,please check!")},t.prototype.config=function(t){if(this.inited)if(t&&k(t))if(this.bridgeReport)this.appBridge.setConfig(t);else{t._staging_flag&&1===t._staging_flag&&(this.staging=!0),t.disable_auto_pv&&(this.disableAutoPageView=!0,delete t.disable_auto_pv);var e=E({},t),i=this.initConfig.configPersist||this.initConfig.config_persist||!1;if(this.initConfig&&i){var n=this.configManager.getStore();n&&(e=Object.assign(n,t)),this.configManager.setStore(t)}e.web_id,e.user_unique_id;var o=function(t,e){var i={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(i[n]=t[n]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(t);o<n.length;o++)e.indexOf(n[o])<0&&(i[n[o]]=t[n[o]])}return i}(e,["web_id","user_unique_id"]);this.configManager.set(o),e.hasOwnProperty("web_id")&&this.emit(Q.ConfigWebId,e.web_id),e.hasOwnProperty("user_unique_id")&&this.emit(Q.ConfigUuid,e.user_unique_id),this.emit(w.DEBUGGER_MESSAGE,{type:w.DEBUGGER_MESSAGE_SDK,info:"SDK 鎵цCONFIG",level:"info",time:Date.now(),data:e})
}else this.logger.warn("config params is error, please check");else this.logger.warn("config must be use after function init")},t.prototype.setUserUniqueID=function(t){this.config({user_unique_id:t})},t.prototype.setHeaderInfo=function(t,e){var i={};i[t]=e,this.config(i)},t.prototype.removeHeaderInfo=function(t){var e={};e[t]=void 0,this.config(e)},t.prototype.setDomain=function(t){this.configManager&&this.configManager.setDomain(t),this.emit(Q.ConfigDomain)},t.prototype.getConfig=function(t){return this.configManager.get(t)},t.prototype.send=function(){this.start()},t.prototype.start=function(){this.inited&&!this.sended&&(this.sended=!0,this.started=!0,this.emit(Q.Start),this.emit(w.DEBUGGER_MESSAGE,{type:w.DEBUGGER_MESSAGE_SDK,info:"SDK 鎵цSTART",level:"info",time:Date.now()}),this.bridgeReport&&(this.pageView(),this.emit(Q.Ready)))},t.prototype.event=function(t,e){var i=this;try{var n=[];if(Array.isArray(t))t.forEach(function(t){var e=i.processEvent(t[0],t[1]||{});e&&n.push(e)});else{var o=this.processEvent(t,e);if(!o)return;n.push(o)}this.bridgeReport?n.forEach(function(t){var e=t.event,n=t.params;i.appBridge.onEventV3(e,JSON.stringify(n))}):n.length&&(this.emit(Q.Event,n),this.emit(Q.SessionResetTime))}catch(t){this.logger.warn("something error, please check"),this.emit(w.DEBUGGER_MESSAGE,{type:w.DEBUGGER_MESSAGE_SDK,info:"鍙戠敓浜嗗紓甯�",level:"error",time:Date.now(),data:t.message})}},t.prototype.beconEvent=function(t,e){if(Array.isArray(t))this.logger.warn("beconEvent not support batch report, please check");else{var i=[],n=this.processEvent(t,e||{});n&&(i.push(n),i.length&&(this.emit(Q.BeconEvent,i),this.emit(Q.SessionResetTime)))}},t.prototype.processEvent=function(t,e){void 0===e&&(e={});try{if(!t)return this.logger.warn("eventName is null锛� please check"),null;var i=t;/^event\./.test(t)&&(i=t.slice(6));var n=e;"object"!=typeof n&&(n={}),n.profile?delete n.profile:n.event_index=T();var o=void 0;return n.local_ms?(o=n.local_ms,delete n.local_ms):o=+new Date,{event:i,params:n,local_time_ms:o,is_bav:this.initConfig&&this.initConfig.autotrack?1:0}}catch(i){return this.emit(w.DEBUGGER_MESSAGE,{type:w.DEBUGGER_MESSAGE_SDK,info:"鍙戠敓浜嗗紓甯�",level:"error",time:Date.now(),data:i.message}),{event:t,params:e}}},t.prototype.filterEvent=function(t){this.eventFilter=t},t.prototype.on=function(t,e){this.hook.on(t,e)},t.prototype.once=function(t,e){this.hook.once(t,e)},t.prototype.off=function(t,e){this.hook.off(t,e)},t.prototype.emit=function(t,e,i){this.hook.emit(t,e,i)},t.prototype.set=function(t){this.hook.set(t)},t.prototype.stop=function(){this.sdkStop=!0},t.prototype.reStart=function(){this.sdkStop=!1},t.prototype.pageView=function(){this.disableAutoPageView||this.predefinePageView()},t.prototype.predefinePageView=function(t){if(void 0===t&&(t={}),this.inited){var e={title:document.title||location.pathname,url:location.href,url_path:location.pathname,time:Date.now(),referrer:window.document.referrer,$is_first_time:""+(this.configManager&&this.configManager.is_first_time||!1)},i=E({},e,t);this.event("predefine_pageview",i)}},t.prototype.clearEventCache=function(){this.emit(Q.CleanEvents)},t.prototype.setWebIDviaUnionID=function(t){if(t){var e=R(t);this.config({web_id:""+e,wechat_unionid:t}),this.emit(Q.CustomWebId)}},t.prototype.setWebId=function(t){this.config({web_id:""+t})},t.prototype.setWebIDviaOpenID=function(t){if(t){var e=R(t);this.config({web_id:""+e,wechat_openid:t}),this.emit(Q.CustomWebId)}},t.prototype.setNativeAppId=function(t){this.bridgeReport&&this.appBridge.setNativeAppId(t)},t.prototype.resetStayDuration=function(t,e,i){this.emit(Q.ResetStay,{url_path:t,title:e,url:i},Q.Stay)},t.prototype.resetStayParams=function(t,e,i){void 0===t&&(t=""),void 0===e&&(e=""),void 0===i&&(i=""),this.emit(Q.SetStay,{url_path:t,title:e,url:i},Q.Stay)},t.prototype.getToken=function(t,e){var i=this;if(this.inited){var n=!1,o=function(e){if(!n){n=!0;var o=i.configManager.get().user;return e&&(o.tobid=e,o["diss".split("").reverse().join("")]=e),t(E({},o))}},r=function(){i.tokenManager.getTobId().then(function(t){o(t)})};this.sdkReady?r():(e&&setTimeout(function(){o()},e),this.on(Q.Ready,function(){r()}))}},t.prototype.profileSet=function(t){this.bridgeReport?this.appBridge.profileSet(JSON.stringify(t)):this.emit(Q.ProfileSet,t,Q.Profile),this.emit(w.DEBUGGER_MESSAGE,{type:w.DEBUGGER_MESSAGE_SDK,info:"SDK 鎵цprofileSet",level:"info",time:Date.now(),data:t})},t.prototype.profileSetOnce=function(t){this.bridgeReport?this.appBridge.profileSetOnce(JSON.stringify(t)):this.emit(Q.ProfileSetOnce,t,Q.Profile),this.emit(w.DEBUGGER_MESSAGE,{type:w.DEBUGGER_MESSAGE_SDK,info:"SDK 鎵цprofileSetOnce",level:"info",time:Date.now(),data:t})},t.prototype.profileIncrement=function(t){this.bridgeReport?this.appBridge.profileIncrement(JSON.stringify(t)):this.emit(Q.ProfileIncrement,t,Q.Profile),this.emit(w.DEBUGGER_MESSAGE,{type:w.DEBUGGER_MESSAGE_SDK,info:"SDK 鎵цprofileIncrement",level:"info",time:Date.now(),data:t})},t.prototype.profileUnset=function(t){this.bridgeReport?this.appBridge.profileUnset(t):this.emit(Q.ProfileUnset,t,Q.Profile),this.emit(w.DEBUGGER_MESSAGE,{type:w.DEBUGGER_MESSAGE_SDK,info:"SDK 鎵цprofileUnset",level:"info",time:Date.now(),data:t})},t.prototype.profileAppend=function(t){this.bridgeReport?this.appBridge.profileAppend(JSON.stringify(t)):this.emit(Q.ProfileAppend,t,Q.Profile),this.emit(w.DEBUGGER_MESSAGE,{type:w.DEBUGGER_MESSAGE_SDK,info:"SDK 鎵цprofileAppend",level:"info",time:Date.now(),data:t})},t.prototype.setExternalAbVersion=function(t){this.emit(Q.AbExternalVersion,"string"==typeof t&&t?(""+t).trim():null,Q.Ab)},t.prototype.getVar=function(t,e,i){this.emit(Q.AbVar,{name:t,defaultValue:e,callback:i},Q.Ab)},t.prototype.getABconfig=function(t,e){this.emit(Q.AbConfig,{params:t,callback:e},Q.Ab)},t.prototype.getAbSdkVersion=function(){return this.configManager.getAbVersion()},t.prototype.onAbSdkVersionChange=function(t){var e=this;return this.emit(Q.AbVersionChangeOn,t,Q.Ab),function(){e.emit(Q.AbVersionChangeOff,t,Q.Ab)}},t.prototype.offAbSdkVersionChange=function(t){this.emit(Q.AbVersionChangeOff,t,Q.Ab)},t.prototype.openOverlayer=function(){this.emit(Q.AbOpenLayer,"",Q.Ab)},t.prototype.closeOverlayer=function(){this.emit(Q.AbCloseLayer,"",Q.Ab)},t.prototype.getAllVars=function(t){this.emit(Q.AbAllVars,t,Q.Ab)},t.prototype.destoryInstace=function(){this.destroyInstance||(this.destroyInstance=!0,this.off(Q.TokenComplete))},t.plugins=[],t}(),we=function(){return"undefined"!=typeof window?(window.LogPluginObject||(window.LogPluginObject={}),window.LogPluginObject):null},Ee="__rangers_ab_style__",Se={},ke=[],De=function(t){t.length&&t.forEach(function(t){ke.push(t)})},Te="",Ae=!1;!function(t){t[t.Var=0]="Var",t[t.All=1]="All"}(Y||(Y={}));var Me=function(){function t(){this.fetchStatus="no",this.refreshFetchStatus="complete",this.versions=[],this.extVersions=[],this.mulilinkVersions=[],this.enable_multilink=!1,this.enable_ab_visual=!1,this.editMode=!1,this.callbacks=[],this.data=null,this.changeListener=new Map,this.readyStatus=!1,this.exposureCache=[]}return t.prototype.apply=function(t,e){var i=this;if(this.collect=t,this.config=e,this.config.enable_ab_test){var n=e.enable_multilink,o=e.ab_channel_domain,r=e.enable_ab_visual,s=e.ab_cross,a=e.ab_cookie_domain,c=o||A(V[e.channel||"cn"]),l=t.adapters,u=l.storage,h=l.fetch;this.cacheStorgae=new u(!1),this.fetch=h,this.enable_multilink=n,this.enable_ab_visual=r,this.abKey="__tea_sdk_ab_version_"+e.app_id,this.ab_cross=s,this.ab_cookie_domain=a||"",this.fetchUrl=c+"/service/2/abtest_config/",this.reportUrl=""+t.configManager.getUrl("event"),this.exposureLimit=e.exposure_limit||20,this.ab_batch_time=e.ab_batch_time||500;var p=this.collect.Types;this.types=p,this.collect.on(p.TokenChange,function(t){"uuid"===t&&i.readyStatus&&(i.clearCache(),i.fetchAB())}),this.collect.on(p.TokenReset,function(t){"uuid"===t&&i.readyStatus&&(i.clearCache(),i.fetchAB())}),this.collect.on(p.AbVar,function(t){var e=t.name,n=t.defaultValue,o=t.callback;i.getVar(e,n,o)}),this.collect.on(p.AbAllVars,function(t){i.getAllVars(t)}),this.collect.on(p.AbConfig,function(t){var e=t.params,n=t.callback;i.getABconfig(e,n)}),this.collect.on(p.AbExternalVersion,function(t){i.setExternalAbVersion(t)}),this.collect.on(p.AbOpenLayer,function(){i.openOverlayer()}),this.collect.on(p.AbCloseLayer,function(){i.closeOverlayer()}),this.collect.on(p.AbVersionChangeOn,function(t){i.changeListener.set(t,t)}),this.collect.on(p.AbVersionChangeOff,function(t){i.changeListener.get(t)&&i.changeListener.delete(t)}),this.loadMode(),(this.enable_ab_visual||this.enable_multilink)&&this.openOverlayer(this.config.multilink_timeout_ms||500),this.checkLocal(),this.ready("ab"),this.readyStatus||(this.fetchAB(),this.readyStatus=!0),this.collect.emit(p.AbReady)}},t.prototype.ready=function(t){var e=this;if(this.collect.set(t),this.collect.hook._hooksCache.hasOwnProperty(t)){var i=this.collect.hook._hooksCache[t];if(!Object.keys(i).length)return;var n=function(t){i[t].length&&i[t].forEach(function(i){e.collect.hook.emit(t,i)})};for(var o in i)n(o)}},t.prototype.loadMode=function(){var t,e,i=function(){try{var t=JSON.parse(atob(window.name));return t||void 0}catch(t){return}}(),n="";if(i){var o=i.scenario,r=i.href;o?(this.editMode=!0,n=o):!r||-1===r.indexOf("datatester")&&-1===r.indexOf("visual-editor")||(this.editMode=!0,n="visual-editor")}this.enable_ab_visual&&(function(t,e){window.TEAVisualEditor=window.TEAVisualEditor||{},De(["*"]);var i,n="";l(e,J);var o="";try{var r=window.performance.getEntriesByType("resource");if(r&&r.length&&(r.forEach(function(t){"script"===t.initiatorType&&t.name&&-1!==t.name.indexOf("collect")&&(o=t.name)}),o||document.currentScript&&(o=document.currentScript.src),o&&(i=o.split("/"))&&i.length)){n="https:/";for(var c=2;c<i.length&&c!==i.length-1;c++)n=n+"/"+i[c];n+="/visual-ab-core"}}catch(t){}a("tea:openVisualABEditor",function(t){var i=t.data;if("string"==typeof t.data)try{i=JSON.parse(t.data)}catch(o){i=void 0}if(i){var r=i.lang;if(i.appId!==e.app_id)return void s(t,"appIdError");var a=i.version;Te=a&&n?n+(a?"."+a:".1.0.1")+".js?query="+Date.now():H+"?query="+Date.now(),window.TEAVisualEditor.lang=r,window.TEAVisualEditor.__ab_domin=e.channel_domain||"",u({event:t,editorUrl:Te,collectInstance:o})}})}(this.collect,this.config),"visual-editor"===n)?this.collect.destoryInstace():this.enable_multilink&&(t=this.collect,e=this.config,window.TEAVisualEditor=window.TEAVisualEditor||{},window.TEAVisualEditor.appId=e.app_id,a("tea:openTesterEventInspector",function(t){var e=t.data;if("string"==typeof t.data)try{e=JSON.parse(t.data)}catch(i){e=void 0}if(e){var n=e.referrer,o=e.lang,r=e.appId;window.TEAVisualEditor.__editor_ajax_domain=n||"",window.TEAVisualEditor.__ab_appId=r||"",window.TEAVisualEditor.lang=o||"",u({event:t,editorUrl:"https://lf3-data.volccdn.com/obj/data-static/log-sdk/collect/tester-event-inspector.js?query="+Date.now(),collectInstance:i})}}))},t.prototype.checkLocal=function(){var t=this.getABCache(),e=t.ab_version,i=t.ab_ext_version,n=t.ab_version_multilink,o=t.data,r=this.checkFromUrl();r?this.mulilinkVersions.push(r):this.mulilinkVersions=n||[],this.extVersions=i||[],this.versions=e||[],this.data=o;var s=this.versions.concat(this.extVersions);this.enable_multilink&&(s=s.concat(this.mulilinkVersions)),this.configVersions(s.join(","))},t.prototype.checkFromUrl=function(){var t=I(window.location.href);return t&&t.vid?t.vid:""},t.prototype.updateVersions=function(){var t=this.extVersions.length?this.versions.concat(this.extVersions):this.versions;this.enable_multilink&&(t=t.concat(this.mulilinkVersions)),this.configVersions(t.join(",")),this.updateABCache(),this.changeListener.size>0&&this.changeListener.forEach(function(e){"function"==typeof e&&e(t)})},t.prototype.configVersions=function(t){this.collect.configManager.setAbVersion(t)},t.prototype.getVar=function(t,e,i){if(!t)throw new Error("variable must not be empty");if(void 0===e)throw new Error("variable no default value");if("function"!=typeof i)throw new Error("callback must be a function");var n={name:t,defaultValue:e,callback:i,type:Y.Var};"complete"===this.fetchStatus&&"complete"===this.refreshFetchStatus?this.getRealVar(n,t):this.callbacks.push(n)},t.prototype.getRealVar=function(t,e){var i=t.name,n=t.defaultValue,o=t.callback,r=this.data;if(r){if(k(r[i])){var s=r[i].vid;return"$ab_url"===e?this.mulilinkVersions.includes(s)||this.mulilinkVersions.push(s):this.versions.includes(s)||this.versions.push(s),this.updateVersions(),this.fechEvent(s,e,n),o(r[i].val),void this.collect.emit(w.DEBUGGER_MESSAGE,{type:w.DEBUGGER_MESSAGE_SDK,secType:"AB",info:"SDK 鏇濆厜浜嗗疄楠�"+i,level:"info",time:Date.now(),data:r[i]})}this.collect.emit(w.DEBUGGER_MESSAGE,{type:w.DEBUGGER_MESSAGE_SDK,secType:"AB",info:"SDK 璋冪敤getVar",level:"info",time:Date.now(),data:n}),o(n)}else o(n)},t.prototype.getAllVars=function(t){if("function"!=typeof t)throw new Error("callback must be a function");var e={callback:t,type:Y.All};"complete"===this.fetchStatus&&"complete"===this.refreshFetchStatus?this.getRealAllVars(e):this.callbacks.push(e)},t.prototype.getRealAllVars=function(t){t.callback(this.data?JSON.parse(JSON.stringify(this.data)):{}),this.collect.emit(w.DEBUGGER_MESSAGE,{type:w.DEBUGGER_MESSAGE_SDK,secType:"AB",info:"SDK 璋冪敤getAllVars",level:"info",time:Date.now(),data:this.data})},t.prototype.fechEvent=function(t,e,i){try{if(this.config.disable_track_event)return;if(!t)return;var n=this.collect.configManager.get(),o=n.header,r=n.user,s=this.getABCache();if(s&&s.uuid&&s.uuid!==r.user_unique_id)return;var a={event:"abtest_exposure",ab_sdk_version:""+t,params:JSON.stringify({app_id:this.config.appId,ab_url:"$ab_url"===e?i:window.location.href}),local_time_ms:Date.now()};o.custom=JSON.stringify(o.custom);var c={events:[a],user:r,header:o};"$ab_url"===e&&window.navigator.sendBeacon?window.navigator.sendBeacon(this.reportUrl,JSON.stringify([c])):this.reportExposure(c)}catch(t){this.collect.emit(w.DEBUGGER_MESSAGE,{type:w.DEBUGGER_MESSAGE_SDK,info:"鍙戠敓浜嗗紓甯�",level:"error",time:Date.now(),data:t.message})}},t.prototype.reportExposure=function(t){var e=this;this.exposureCache.push(t),this.reportTimeout&&clearTimeout(this.reportTimeout),this.exposureCache.length>=this.exposureLimit?this.report():this.reportTimeout=setTimeout(function(){e.report(),clearTimeout(e.reportTimeout)},this.ab_batch_time)},t.prototype.report=function(){var t=this;this.fetch(this.reportUrl,this.exposureCache,2e4),this.exposureCache.forEach(function(e){t.collect.emit(w.DEBUGGER_MESSAGE,{type:w.DEBUGGER_MESSAGE_EVENT,info:"鍩嬬偣涓婃姤鎴愬姛",time:Date.now(),data:[e],code:200,status:"success"})}),this.exposureCache=[]},t.prototype.setExternalAbVersion=function(t){this.extVersions=[t],this.updateVersions()},t.prototype.getABconfig=function(t,e){var i=Object.keys(t);i&&i.length&&this.collect.configManager.set(t),this.fetchAB(e)},t.prototype.get=function(t){if(this.ab_cross){var e=this.cacheStorgae.getCookie(t,this.ab_cookie_domain);return e?JSON.parse(e):{}}return this.cacheStorgae.getItem(t)},t.prototype.set=function(t,e){this.ab_cross?this.cacheStorgae.setCookie(t,e,2592e6,this.ab_cookie_domain):this.cacheStorgae.setItem(t,e),this.collect.configManager.setAbCache(e)},t.prototype.getABCache=function(t){var e={ab_version:[],ab_ext_version:[],ab_version_multilink:[],data:null,timestamp:+new Date,uuid:""};return e=this.get(this.abKey)||e,t?e[t]:e},t.prototype.updateABCache=function(){var t=this.getABCache();t.ab_version_multilink=this.mulilinkVersions,t.ab_ext_version=this.extVersions,t.ab_version=this.versions,t.timestamp=Date.now(),this.set(this.abKey,t)},t.prototype.setAbCache=function(t){var e=this.getABCache();e.data=this.data,e.uuid=t,e.timestamp=Date.now(),this.set(this.abKey,e)},t.prototype.clearCache=function(){this.refreshFetchStatus="ing",this.data={},this.extVersions=[],this.mulilinkVersions=[],this.versions=[],this.collect.configManager.clearAbCache()},t.prototype.openOverlayer=function(t){var e=this;if(function(){if(!document.getElementById(Ee)){var t="body { opacity: 0 !important; }",e=document.head||document.getElementsByTagName("head")[0],i=document.createElement("style");i.id=Ee,i.type="text/css",i.styleSheet?i.styleSheet.cssText=t:i.appendChild(document.createTextNode(t)),e.appendChild(i)}}(),t)var i=setTimeout(function(){e.closeOverlayer(),clearTimeout(i)},t)},t.prototype.closeOverlayer=function(){var t;(t=document.getElementById(Ee))&&t.parentElement.removeChild(t)},t.prototype.fetchComplete=function(t,e){var i=this;try{if(t&&"[object Object]"==Object.prototype.toString.call(t)){this.data=t,this.setAbCache(e);var n=[];Object.keys(t).forEach(function(e){var i=t[e].vid;i&&n.push(i)}),this.versions=this.versions.filter(function(t){return n.includes(t)});var o=t.$ab_url,r=t.$ab_modification;if(r&&r.val&&this.enable_ab_visual){if(this.collect.destroyInstance)return;this.getVar("$ab_modification",window.location.href,function(){var t;t=r.val,window.TEAVisualEditor=window.TEAVisualEditor||{},window.TEAVisualEditor.__ab_config=t,O("https://lf-cdn-tos.bytescm.com/obj/static/log-sdk/collect/visual-ab-loader.js?query="+Date.now(),function(){},function(){}),i.closeOverlayer()})}else if(o&&this.enable_multilink){this.mulilinkVersions=this.mulilinkVersions.filter(function(t){return n.includes(t)});var s=o.val,a=o.vid;s&&a&&this.getVar("$ab_url",s,function(){i.editMode||(s!==window.location.href?setTimeout(function(){if(!i.collect.destroyInstance){var t=""+s;t=-1===t.indexOf("http")?"https://"+t:t,C(t).host!==location.host?t=t+"&vid="+a:window.history.replaceState("","",t),window.location.href=t}},100):i.closeOverlayer())})}this.updateVersions()}else this.closeOverlayer();this.callbacks.forEach(function(t){return i[t.type===Y.Var?"getRealVar":"getRealAllVars"](t,"")}),this.callbacks=[]}catch(t){}},t.prototype.fetchAB=function(t){var e=this,i=this.collect.configManager.get(),n={header:E({aid:this.config.app_id},i.user||{},i.header||{},{ab_sdk_version:this.collect.configManager.getAbVersion(),ab_url:window.location.href})};this.collect.emit(w.DEBUGGER_MESSAGE,{type:w.DEBUGGER_MESSAGE_SDK,info:"SDK 鍙戣捣AB瀹為獙璇锋眰",level:"info",logType:"fetch",time:Date.now(),data:n}),this.fetch(this.fetchUrl,n,this.config.ab_timeout||3e3,!1,function(n){e.fetchStatus="complete",e.refreshFetchStatus="complete";var o=n.data;"success"===n.message?(e.fetchComplete(o,i.user.user_unique_id),t&&t(o)):(e.fetchComplete(null,i.user.user_unique_id),t&&t(null)),e.collect.emit(e.types.AbComplete,o),e.collect.emit(w.DEBUGGER_MESSAGE,{type:w.DEBUGGER_MESSAGE_SDK,secType:"AB",info:"AB瀹為獙璇锋眰鎴愬姛",level:"info",logType:"fetch",time:Date.now(),data:o})},function(){e.fetchStatus="complete",e.refreshFetchStatus="complete",e.fetchComplete(null,i.user.user_unique_id),e.collect.emit(e.types.AbTimeout),t&&t(null),e.collect.emit(w.DEBUGGER_MESSAGE,{type:w.DEBUGGER_MESSAGE_SDK,secType:"AB",info:"AB瀹為獙璇锋眰缃戠粶寮傚父",level:"error",logType:"fetch",time:Date.now()})})},t.prototype.filterUrl=function(t){try{var e="";-1!==t.indexOf("&multilink=true")?e="&multilink=true[\x00-每]*":-1!==t.indexOf("?multilink=true")&&(e="\\?multilink=true[\x00-每]*");var i=new RegExp(e,"g");t=t.replace(i,"")}catch(t){}return t},t}();try{var Oe=we();Oe&&(Oe.LogAb=function(t,e){(new Me).apply(t,e)})}catch(E){}var xe=function(){function t(){}return t.prototype.apply=function(t,e){var i=this;if(t.adapters.fetch,e.event_verify_url&&"string"==typeof e.event_verify_url&&(this.url=e.event_verify_url+"/v1/list_test",this.url)){var n=t.Types;t.on(n.SubmitBefore,function(t){window.navigator.sendBeacon(i.url,JSON.stringify(t))})}},t}(),Ge=function(){function t(t,e){this.maxDuration=432e5,this.aliveDTime=6e4,this.options={aliveName:"predefine_page_alive",params:{}},this.collect=t,this.config=e,this.pageStartTime=Date.now(),this.sessionStartTime=this.pageStartTime,this.timerHandler=null,k(e.enable_stay_duration)&&(this.options=Object.assign(this.options,e.enable_stay_duration))}return t.prototype.setParams=function(t,e,i){this.set_path=t,this.set_url=i,this.set_title=e},t.prototype.enable=function(t,e,i){this.url_path=t,this.url=i,this.title=e,this.disableCallback=this.enablePageAlive()},t.prototype.disable=function(){this.disableCallback(),this.pageStartTime=Date.now()},t.prototype.sendEvent=function(t,e){void 0===e&&(e=!1);var i=e?this.aliveDTime:Date.now()-this.sessionStartTime;0>i||i>this.aliveDTime||Date.now()-this.pageStartTime>this.maxDuration||(this.collect.beconEvent(this.options.aliveName,E({url_path:this.getParams("url_path"),title:this.getParams("title"),url:this.getParams("url"),duration:i,is_support_visibility_change:x(),startTime:this.sessionStartTime,hidden:document.visibilityState,leave:t},this.options.params)),this.sessionStartTime=Date.now())},t.prototype.getParams=function(t){switch(t){case"url_path":return this.set_path||this.url_path||location.pathname;case"title":return this.set_title||this.title||document.title||location.pathname;case"url":return this.set_url||this.url||location.href}},t.prototype.setUpTimer=function(){var t=this;return this.timerHandler&&clearInterval(this.timerHandler),setInterval(function(){Date.now()-t.sessionStartTime>t.aliveDTime&&t.sendEvent(!1,!0)},1e3)},t.prototype.visibilitychange=function(){"hidden"===document.visibilityState?this.timerHandler&&(clearInterval(this.timerHandler),this.sendEvent(!1)):"visible"===document.visibilityState&&(this.sessionStartTime=Date.now(),this.timerHandler=this.setUpTimer())},t.prototype.beforeunload=function(){document.hidden||this.sendEvent(!0)},t.prototype.enablePageAlive=function(){var t=this;this.timerHandler=this.setUpTimer();var e=this.visibilitychange.bind(this),i=this.beforeunload.bind(this);return document.addEventListener("visibilitychange",e),window.addEventListener("pagehide",i),function(){t.beforeunload(),document.removeEventListener("visibilitychange",e),window.removeEventListener("pagehide",i)}},t}(),Ce=function(){function t(t,e){var i=this;this.maxDuration=432e5,this.aliveDTime=6e4,this.options={closeName:"predefine_page_close",params:{}},this.visibilitychange=function(){"hidden"===document.visibilityState?i.activeEndTime=Date.now():"visible"===document.visibilityState&&(i.activeEndTime&&(i.totalTime+=i.activeEndTime-i.activeStartTime,i.activeTimes+=1),i.activeEndTime=void 0,i.activeStartTime=Date.now())},this.beforeunload=function(){if(i.totalTime+=(i.activeEndTime||Date.now())-i.activeStartTime,i.config.autotrack)try{window.sessionStorage.setItem("_tea_cache_duration",JSON.stringify({duration:i.totalTime,page_title:document.title||location.pathname}))}catch(t){}i.sendEventPageClose()},this.collect=t,this.config=e,this.maxDuration=e.maxDuration||e.max_duration||864e5,this.pageStartTime=Date.now(),k(e.enable_stay_duration)&&(this.options=Object.assign(this.options,e.enable_stay_duration)),this.resetData()}return t.prototype.setParams=function(t,e,i){this.set_path=t,this.set_url=i,this.set_title=e},t.prototype.resetParams=function(t,e,i){this.url_path=t,this.url=i,this.title=e},t.prototype.enable=function(t,e,i){this.url_path=t,this.url=i,this.title=e,this.disableCallback=this.enablePageClose()},t.prototype.disable=function(){this.disableCallback()},t.prototype.resetData=function(){this.activeStartTime=void 0===this.activeStartTime?this.pageStartTime:Date.now(),this.activeEndTime=void 0,this.activeTimes=1,this.totalTime=0,this.resetParams(location.pathname,document.title,location.href)},t.prototype.sendEventPageClose=function(){var t=Date.now()-this.pageStartTime;this.totalTime<0||0>t||this.totalTime>=this.maxDuration||(this.collect.beconEvent(this.options.closeName,E({url_path:this.getParams("url_path"),title:this.getParams("title"),url:this.getParams("url"),active_times:this.activeTimes,duration:this.totalTime,total_duration:t,is_support_visibility_change:x()},this.options.params)),this.pageStartTime=Date.now(),this.resetData())},t.prototype.getParams=function(t){switch(t){case"url_path":return this.set_path||this.url_path||location.pathname;case"title":return this.set_title||this.title||document.title||location.pathname;case"url":return this.set_url||this.url||location.href}},t.prototype.enablePageClose=function(){var t=this,e=this.visibilitychange.bind(this),i=this.beforeunload.bind(this);return document.addEventListener("visibilitychange",e),window.addEventListener("pagehide",i),function(){t.beforeunload(),document.removeEventListener("visibilitychange",e),window.removeEventListener("pagehide",i)}},t}(),Ie=function(){function t(){}return t.prototype.apply=function(t,e){var i=this;if(this.collect=t,this.config=e,this.config.enable_stay_duration){this.title=document.title||location.pathname,this.url=location.href,this.url_path=location.pathname,this.pageAlive=new Ge(t,e),this.pageClose=new Ce(t,e);var n=this.collect.Types;this.collect.on(n.ResetStay,function(t){var e=t.url_path,n=t.title,o=t.url;i.resetStayDuration(e,n,o)}),this.collect.on(n.RouteChange,function(t){t.init||e.disable_route_report||i.resetStayDuration()}),this.collect.on(n.SetStay,function(t){var e=t.url_path,n=t.title,o=t.url;i.setStayParmas(e,n,o)}),this.enable(this.url_path,this.title,this.url),this.ready(n.Stay),this.collect.emit(n.StayReady)}},t.prototype.ready=function(t){var e=this;if(this.collect.set(t),this.collect.hook._hooksCache.hasOwnProperty(t)){var i=this.collect.hook._hooksCache[t];if(!Object.keys(i).length)return;var n=function(t){i[t].length&&i[t].forEach(function(i){e.collect.hook.emit(t,i)})};for(var o in i)n(o)}},t.prototype.enable=function(t,e,i){this.pageAlive.enable(t,e,i),this.pageClose.enable(t,e,i)},t.prototype.disable=function(){this.pageAlive.disable(),this.pageClose.disable()},t.prototype.setStayParmas=function(t,e,i){void 0===t&&(t=""),void 0===e&&(e=""),void 0===i&&(i=""),this.pageAlive.setParams(t,e,i),this.pageClose.setParams(t,e,i),this.collect.emit(w.DEBUGGER_MESSAGE,{type:w.DEBUGGER_MESSAGE_SDK,info:"SDK 鎵ц resetStayParams",level:"info",time:Date.now(),data:{url_path:t,title:e,url:i}})},t.prototype.reset=function(t,e,i){this.disable(),this.enable(t,e,i)},t.prototype.resetStayDuration=function(t,e,i){this.reset(t,e,i),this.collect.emit(w.DEBUGGER_MESSAGE,{type:w.DEBUGGER_MESSAGE_SDK,info:"SDK 鎵ц resetStayDuration",level:"info",time:Date.now(),data:{url_path:t,title:e,url:i}})},t}();try{var Re=we();Re&&(Re.LogStay=function(t,e){(new Ie).apply(t,e)})}catch(E){}var Ne,ze=function(){function t(){}return t.prototype.apply=function(t,e){var i=this;this.collect=t,this.config=e,this.duration=6e4,this.reportUrl=t.configManager.getDomain()+"/profile/list";var n=t.Types,o=t.adapters.fetch;this.eventCheck=new F(t,e),this.fetch=o,this.cache={},this.collect.on(n.ProfileSet,function(t){i.setProfile(t)}),this.collect.on(n.ProfileSetOnce,function(t){i.setOnceProfile(t)}),this.collect.on(n.ProfileUnset,function(t){i.unsetProfile(t)}),this.collect.on(n.ProfileIncrement,function(t){i.incrementProfile(t)}),this.collect.on(n.ProfileAppend,function(t){i.appendProfile(t)}),this.collect.on(n.ProfileClear,function(){i.cache={}}),this.ready(n.Profile)},t.prototype.ready=function(t){var e=this;if(this.collect.set(t),this.collect.hook._hooksCache.hasOwnProperty(t)){var i=this.collect.hook._hooksCache[t];if(!Object.keys(i).length)return;var n=function(t){i[t].length&&i[t].forEach(function(i){e.collect.hook.emit(t,i)})};for(var o in i)n(o)}},t.prototype.report=function(t,e){void 0===e&&(e={});try{if(this.config.disable_track_event)return;var i=[];i.push(this.collect.processEvent(t,e));var n=this.collect.eventManager.merge(i);this.fetch(this.reportUrl,n),this.collect.emit(w.DEBUGGER_MESSAGE,{type:w.DEBUGGER_MESSAGE_EVENT,info:"鍩嬬偣涓婃姤鎴愬姛",time:Date.now(),data:n,code:200,status:"success"})}catch(t){this.collect.emit(w.DEBUGGER_MESSAGE,{type:w.DEBUGGER_MESSAGE_SDK,info:"鍙戠敓浜嗗紓甯�",level:"error",time:Date.now(),data:t.message})}},t.prototype.setProfile=function(t){var e=this.formatParams(t);e&&Object.keys(e).length&&(this.pushCache(e),this.report("__profile_set",E({},e,{profile:!0})))},t.prototype.setOnceProfile=function(t){var e=this.formatParams(t,!0);e&&Object.keys(e).length&&(this.pushCache(e),this.report("__profile_set_once",E({},e,{profile:!0})))},t.prototype.incrementProfile=function(t){t?this.report("__profile_increment",E({},t,{profile:!0})):void 0},t.prototype.unsetProfile=function(t){if(t){var e={};e[t]="1",this.report("__profile_unset",E({},e,{profile:!0}))}},t.prototype.appendProfile=function(t){if(t){var e={};for(var i in t)"string"==typeof t[i]||"Array"===Object.prototype.toString.call(t[i]).slice(8,-1)?e[i]=t[i]:void 0;Object.keys(e).length&&this.report("__profile_append",E({},e,{profile:!0}))}},t.prototype.pushCache=function(t){var e=this;Object.keys(t).forEach(function(i){e.cache[i]={val:e.clone(t[i]),timestamp:Date.now()}})},t.prototype.formatParams=function(t,e){var i=this;void 0===e&&(e=!1);try{if(!t||"[object Object]"!==Object.prototype.toString.call(t))return void 0;var n={};for(var o in t)"string"==typeof t[o]||"number"==typeof t[o]||"Array"===Object.prototype.toString.call(t[o]).slice(8,-1)?n[o]=t[o]:void 0;var r=Object.keys(n);if(!r.length)return;if(!this.eventCheck.checkEventParams(n))return;var s=Date.now();return r.filter(function(n){var o=i.cache[n];return e?!o:!(o&&i.compare(o.val,t[n])&&s-o.timestamp<i.duration)}).reduce(function(t,e){return t[e]=n[e],t},{})}catch(t){void this.collect.emit(w.DEBUGGER_MESSAGE,{type:w.DEBUGGER_MESSAGE_SDK,info:"鍙戠敓浜嗗紓甯�",level:"error",time:Date.now(),data:t.message})}},t.prototype.compare=function(t,e){try{return JSON.stringify(t)===JSON.stringify(e)}catch(t){return this.collect.emit(w.DEBUGGER_MESSAGE,{type:w.DEBUGGER_MESSAGE_SDK,info:"鍙戠敓浜嗗紓甯�",level:"error",time:Date.now(),data:t.message}),!1}},t.prototype.clone=function(t){try{return JSON.parse(JSON.stringify(t))}catch(e){return this.collect.emit(w.DEBUGGER_MESSAGE,{type:w.DEBUGGER_MESSAGE_SDK,info:"鍙戠敓浜嗗紓甯�",level:"error",time:Date.now(),data:e.message}),t}},t.prototype.unReady=function(){},t}(),Be=function(){function t(){var t=this;this.setInterval=function(){t.clearIntervalFunc=G(function(){t.isSessionhasEvent&&t.endCurrentSession()},t.sessionInterval)},this.clearInterval=function(){t.clearIntervalFunc&&t.clearIntervalFunc()}}return t.prototype.apply=function(t,e){var i=this;if(this.collect=t,!e.disable_heartbeat){this.sessionInterval=6e4,this.startTime=0,this.lastTime=0,this.setInterval();var n=this.collect.Types;this.collect.on(n.SessionReset,function(){i.process()})}},t.prototype.endCurrentSession=function(){this.collect.event("_be_active",{start_time:this.startTime,end_time:this.lastTime,url:window.location.href,referrer:window.document.referrer,title:document.title||location.pathname}),this.isSessionhasEvent=!1,this.startTime=0},t.prototype.process=function(){this.isSessionhasEvent||(this.isSessionhasEvent=!0,this.startTime=+new Date);var t=this.lastTime||+new Date;this.lastTime=+new Date,this.lastTime-t>this.sessionInterval&&(this.clearInterval(),this.endCurrentSession(),this.setInterval())},t}(),$e=function(){function t(){}return t.prototype.apply=function(t,e){var i=this;if(this.collect=t,this.config=e,!this.config.channel_domain){var n=t.adapters.fetch;if(this.fetch=n,!e.disable_track_event&&!e.disable_sdk_monitor){this.url=t.configManager.getUrl("event");var o=this.collect.Types;this.collect.on(o.Ready,function(){i.sdkOnload()}),this.collect.on(o.SubmitError,function(t){var e=t.type,n=t.eventData,o=t.errorCode;"f_data"===e&&i.sdkError(n,o)})}}},t.prototype.sdkOnload=function(){var t=this;try{var e=this.collect.configManager.get(),i=e.header,n=e.user,o=i.app_id,r=i.app_name,s=i.sdk_version,a=n.web_id,c={events:[{event:"onload",params:JSON.stringify({app_id:o,app_name:r||"",sdk_version:s,sdk_type:"script",sdk_config:this.config,sdk_desc:"TOC",url:location.href}),local_time_ms:Date.now()}],user:{user_unique_id:a},header:{}};setTimeout(function(){t.fetch(t.url,[c],3e4,!1,function(){},function(){},"566f58151b0ed37e")},16)}catch(t){}},t.prototype.sdkError=function(t,e){var i=this;try{var n=t[0],o=n.user,r=n.header,s=[];
t.forEach(function(t){t.events.forEach(function(t){s.push(t)})});var a={events:s.map(function(t){return{event:"on_error",params:JSON.stringify({error_code:e,app_id:r.app_id,app_name:r.app_name||"",error_event:t.event,sdk_version:r.sdk_version,local_time_ms:t.local_time_ms,tea_event_index:Date.now(),params:t.params,header:JSON.stringify(r),user:JSON.stringify(o)}),local_time_ms:Date.now()}}),user:{user_unique_id:o.user_unique_id},header:{}};setTimeout(function(){i.fetch(i.url,[a],3e4,!1,function(){},function(){},"566f58151b0ed37e")},16)}catch(t){}},t}(),Ue=function(t,e){return!!Le(t,e)},Pe=function(t,e){return t.hasAttribute?t.hasAttribute(e):t.attributes?!(!t.attributes[e]||!t.attributes[e].specified):void 0},Le=function(t,e){if("string"==typeof e)return Pe(t,e);if(D(e)){for(var i=!1,n=0;n<e.length;n++)if(Pe(t,e[n])){i=!0;break}return i}},je=function(t,e){var i={};if("string"==typeof e)Pe(t,e)&&(i.attrs=t.getAttribute(e));else if(D(e))for(var n=0;n<e.length;n++)Pe(t,e[n])&&(i[e[n]]=t.getAttribute(e[n]));return i},Ve=function(t){if(t.children.length){var e=t.children;return![].slice.call(e).some(function(t){return t.children.length>0})}return!0},Ke=function(t){if("svg"===t.tagName.toLowerCase())return!0;for(var e=t.parentElement,i=!1;e;)"svg"===e.tagName.toLowerCase()?(e=null,i=!0):e=e.parentElement;return i},Je=function(){function t(t,e,i){var n=this;this.statistics=!1,this.pageView=!1,this.clickEvent=function(t){(function(t,e){if(window.innerHeight,window.innerWidth,1!==t.nodeType)return!1;if(!e.svg&&Ke(t))return!1;if(["HTML","BODY"].includes(t.tagName.toUpperCase()))return!1;var i=t;return!("none"===i.style.display||!h(i,"container")&&!Ve(i)&&!e.svg)})(t.target,n.options)&&n.eventHandel({eventType:"dom",eventName:"click"},t)},this.changeEvent=function(t){n.eventHandel({eventType:"dom",eventName:"change"},t)},this.submitEvent=function(t){n.eventHandel({eventType:"dom",eventName:"submit"},t)},this.getPageViewEvent=function(t,e){e&&"pushState"===e&&n.eventHandel({eventType:"dom",eventName:"beat"},E({beat_type:0},t)),n.eventHandel({eventType:"dom",eventName:"page_view"},t)},this.getPageLoadEvent=function(t){n.eventHandel({eventType:"dom",eventName:"page_statistics"},{lcp:t})},this.config=i.getConfig().eventConfig,this.collect=e,this.options=t,this.beatTime=t.beat,this.domContainer=t.container||document}return t.prototype.init=function(t){this.eventHandel=t;var e=this.config.mode;this.addListener(e)},t.prototype.addListener=function(t){var e=this;if("proxy-capturing"===t){if(this.config.click&&this.domContainer.addEventListener("click",this.clickEvent,!0),this.config.change&&this.domContainer.addEventListener("change",this.changeEvent,!0),this.config.submit&&this.domContainer.addEventListener("submit",this.submitEvent,!0),this.config.pv){this.collect.on("route-change",function(t){var i=t.config,n=t.name;e.getPageViewEvent(i,n),e.pageView=!0});var i=setTimeout(function(){e.pageView||(e.getPageViewEvent(e.getDefaultConfig()),e.pageView=!0,clearTimeout(i))},2e3)}if(this.config.beat){try{"complete"===document.readyState?this.beatEvent(this.beatTime):window.addEventListener("load",function(){e.beatEvent(e.beatTime)});var n=0,o=null;window.addEventListener("scroll",function(){clearTimeout(o),o=setTimeout(r,500),n=document.documentElement.scrollTop||document.body.scrollTop});var r=function(){(document.documentElement.scrollTop||document.body.scrollTop)==n&&e.eventHandel({eventType:"dom",eventName:"beat"},{beat_type:1})}}catch(t){}try{var s=window.performance&&window.performance.getEntriesByType("paint");if(s&&s.length){new PerformanceObserver(function(t){var i=t.getEntries(),n=i[i.length-1],o=n.renderTime||n.loadTime;e.statistics||(e.getPageLoadEvent(o),e.statistics=!0)}).observe({entryTypes:["largest-contentful-paint"]});var a=setTimeout(function(){e.statistics||(e.getPageLoadEvent(s[0].startTime||0),e.statistics=!0,clearTimeout(a))},2e3)}else this.getPageLoadEvent(0)}catch(t){this.getPageLoadEvent(0)}}}},t.prototype.removeListener=function(){this.domContainer.removeEventListener("click",this.clickEvent,!0),this.domContainer.removeEventListener("change",this.changeEvent,!0),this.domContainer.removeEventListener("submit",this.submitEvent,!0)},t.prototype.beatEvent=function(t){var e=this;try{var i;this.eventHandel({eventType:"dom",eventName:"beat"},{beat_type:3}),this.beatTime&&(i=setInterval(function(){e.eventHandel({eventType:"dom",eventName:"beat"},{beat_type:2})},t)),M(function(){e.eventHandel({eventType:"dom",eventName:"beat",eventSend:"becon"},{beat_type:0}),e.beatTime&&clearInterval(i)})}catch(t){}},t.prototype.getDefaultConfig=function(){return{is_html:1,url:location.href,referrer:document.referrer,page_key:location.href,refer_page_key:document.referrer,page_title:document.title||location.pathname,page_manual_key:"",refer_page_manual_key:"",refer_page_title:"",page_path:location.pathname,page_host:location.host}},t}(),qe={eventConfig:{mode:"proxy-capturing",submit:!1,click:!0,change:!1,pv:!0,beat:!0,hashTag:!1,impr:!1},scoutConfig:{mode:"xpath"}},He=function(){function t(t,e){this.config=t,this.config.eventConfig=Object.assign(this.config.eventConfig,e)}return t.prototype.getConfig=function(){return this.config},t.prototype.setConfig=function(t){return this.config=t},t}(),We=function(t,e,i,n,o){return E({event:t},g(e,i,n,o),{is_html:1,page_key:window.location.href,page_title:document.title})},Fe=function(){function t(t,e){this.ignore={text:!1},this.initConfig=t,this.options=e,this.eventName=e&&"tea"===e.custom?{click:"__bav_click",page:"__bav_page",beat:"__bav_beat","static":"__bav_page_statistics",exposure:"__bav_page_exposure"}:{click:"bav2b_click",page:"bav2b_page",beat:"bav2b_beat","static":"bav2b_page_statistics",exposure:"bav2b_exposure"},e&&!1===e.text&&(this.ignore.text=!0),e&&e.exposure&&e.exposure.eventName&&(this.eventName.exposure=e.exposure.eventName)}return t.prototype.handleEvent=function(t,e){try{if(function(t){for(var e=t;e&&e.parentNode;){if(e.hasAttribute("data-tea-ignore"))return!0;if("HTML"===e.nodeName||"body"===e.nodeName)return!1;e=e.parentNode}return!1}(t.target))return null;var i="bav2b_click";switch(e){case"click":return i=this.eventName.click,We(i,t,t.target,this.options,this.ignore);case"exposure":return i=this.eventName.exposure,We(i,t,t.target,this.options,this.ignore);case"change":return n({},We(i="bav2b_change",t,t.target,this.options),function(t,e){try{if("bav2b_change"===t)return e.hasAttribute("data-tea-track")?{value:e.value}:{}}catch(t){return{}}}(i,t.target));case"submit":return We(i="bav2b_submit",t,t.target,this.options)}}catch(n){return null}},t.prototype.handleViewEvent=function(t){t.event=this.eventName.page,t.page_title=document.title,t.page_total_width=window.innerWidth,t.page_total_height=window.innerHeight;try{var e=window.sessionStorage.getItem("_tea_cache_duration");if(e){var i=JSON.parse(e);t.refer_page_duration_ms=i?i.duration:""}t.scroll_width=document.documentElement.scrollLeft?document.documentElement.scrollLeft+window.innerWidth:window.innerWidth,t.scroll_height=document.documentElement.scrollTop?document.documentElement.scrollTop+window.innerHeight:window.innerHeight,t.page_start_ms=window.performance.timing.navigationStart}catch(t){}return t},t.prototype.handleStatisticsEvent=function(t){var e={};e.event=this.eventName.static,e.is_html=1,e.page_key=location.href,e.refer_page_key=document.referrer||"",e.page_title=document.title,e.page_manual_key=this.initConfig.autotrack.page_manual_key||"",e.refer_page_manual_key="";try{var i=t.lcp,n=window.performance.timing,o=n.loadEventEnd-n.navigationStart;e.page_init_cost_ms=parseInt(i||(o>0?o:0)),e.page_start_ms=n.navigationStart}catch(t){}return e},t.prototype.handleBeadtEvent=function(t){t.event=this.eventName.beat,t.page_key=window.location.href,t.is_html=1,t.page_title=document.title,t.page_manual_key=this.initConfig.autotrack.page_manual_key||"";try{t.page_viewport_width=window.innerWidth,t.page_viewport_height=window.innerHeight,t.page_total_width=document.documentElement.scrollWidth,t.page_total_height=document.documentElement.scrollHeight,t.scroll_width=document.documentElement.scrollLeft+window.innerWidth,t.scroll_height=document.documentElement.scrollTop+window.innerHeight,t.since_page_start_ms=Date.now()-window.performance.timing.navigationStart,t.page_start_ms=window.performance.timing.navigationStart}catch(t){}return t},t}(),Ye=function(){function t(t){this.collect=t,this.eventNameList=["report_click_event","report_change_event","report_submit_event","report_exposure_event","report_page_view_event","report_page_statistics_event","report_beat_event"]}return t.prototype.send=function(t,e){var i=t.eventSend,n=e.event;delete e.event,i&&"becon"===i?this.collect.beconEvent(n,e):this.collect.event(n,e)},t.prototype.get=function(t,e){var i=Object.assign({headers:{"content-type":"application/json"},method:"GET"},e);fetch(t,i)},t.prototype.post=function(t,e){var i=Object.assign({headers:{"content-type":"application/json"},method:"POST"},e);fetch(t,i)},t}(),Qe="_TEA_VE_OPEN",Xe="_TEA_VE_APIHOST",Ze="lang",ti="_VISUAL_EDITOR_V",ei="_VISUAL_EDITOR_U",ii=!1,ni=function(){function t(t){this._instance=null,this._intersection=t,this.init()}return t.prototype.init=function(){var t=this;this._instance=new MutationObserver(function(e){e.forEach(function(e){"attributes"===e.type&&t.attributeChangeObserve(e),"childList"===e.type&&t.modifyNodeObserve(e)})}),this._instance.observe(document.body,{childList:!0,attributes:!0,subtree:!0,attributeOldValue:!1})},t.prototype.attributeChangeObserve=function(t){t.target.hasAttribute("data-exposure")?this.exposureAdd(t,"mutation"):this.exposureRemove(t)},t.prototype.modifyNodeObserve=function(t){var e=this;Array.prototype.forEach.call(t.addedNodes,function(t){1===t.nodeType&&t.hasAttribute("data-exposure")&&e.exposureAdd(t,"intersect"),e.mapChild(t,e.exposureAdd)}),Array.prototype.forEach.call(t.removedNodes,function(t){1===t.nodeType&&t.hasAttribute("data-exposure")&&e.exposureRemove(t),e.mapChild(t,e.exposureRemove)})},t.prototype.mapChild=function(t,e){var i=this;1===t.nodeType&&t.children.length&&Array.prototype.forEach.call(t.children,function(t){1===t.nodeType&&t.hasAttribute("data-exposure")&&e(t),i.mapChild(t,e)})},t.prototype.exposureAdd=function(t,e){this._intersection.exposureAdd(t,e)},t.prototype.exposureRemove=function(t){this._intersection.exposureRemove(t)},t._exposure_observer=null,t}(),oi=function(){function t(e,i){this.count=1,this.instance=this.buildObserver(),this.observeMap=t._observer_map,this.Ratio=e.autotrack.exposure.ratio?e.autotrack.exposure.ratio:0===e.autotrack.exposure.ratio?0:.5,this.EventHandle=i}return t.prototype.buildObserver=function(){var e=this;return t._observer_instance?void 0:(IntersectionObserver&&(t._observer_instance=new IntersectionObserver(function(t){t.forEach(function(t){e.observeMap.get(t.target._observeId)&&e.exposureEvent(t)})},{threshold:[.01,.25,.5,.75,1]})),t._observer_instance)},t.prototype.exposureAdd=function(t,e){var i=t;"mutation"===e&&(i=t.target);var n=i._observeId;if(n||this.observeMap.has(n)){if(!1===i.visible){var o=i.getBoundingClientRect(),r=o.top,s=o.left,a=o.right,c=o.bottom;r>=0&&c<=window.innerHeight&&s>=0&&a<=window.innerWidth&&(i.visible=!0,this.EventHandle({eventType:"dom",eventName:"exposure"},t))}}else i._observeId=this.count,i.visible=!1,this.observeMap.set(this.count,i),this.observe(i),this.count++},t.prototype.exposureRemove=function(t){this.observeMap.has(t._observeId)&&(this.observeMap.delete(t._observeId),this.unobserve(t))},t.prototype.exposureEvent=function(t){if(t.intersectionRatio>=this.Ratio&&t.isIntersecting){if("0"===t.target.style.opacity||"hidden"===t.target.style.visibility)return;if(!0===t.target.visible)return;t.target.visible=!0,this.EventHandle({eventType:"dom",eventName:"exposure"},t)}else t.target.visible=!1},t.prototype.observe=function(t){this.instance.observe(t)},t.prototype.unobserve=function(t){this.instance.unobserve(t)},t._observer_instance=null,t._observer_map=new Map,t}(),ri=function(){function t(t,e){t.autotrack&&t.autotrack.exposure&&(this._intersection=new oi(t,e),this._observer=new ni(this._intersection),this.initObserver())}return t.prototype.initObserver=function(){var t=this;Array.prototype.forEach.call(document.querySelectorAll("[data-exposure]"),function(e){t._intersection.exposureAdd(e,"intersect")})},t}(),si={hashTag:!1,impr:!1},ai=function(){function t(){}return t.prototype.apply=function(t,e){if(this.autoTrackStart=!1,this.collect=t,this.config=e,e.autotrack){var i=t.Types;e.autotrack&&e.autotrack.collect_url&&!e.autotrack.collect_url()||(this.ready(i.Autotrack),this.collect.emit(i.AutotrackReady))}},t.prototype.ready=function(t){this.collect.set(t);var e=this.config.autotrack;e="object"==typeof e?e:{},e=Object.assign(si,e),this.destroyed=!1,this.options=e,this.Config=new He(qe,this.options),this.Exposure=new ri(this.config,this.handle.bind(this)),this.Listener=new Je(e,this.collect,this.Config),this.EventHandle=new Fe(this.config,e),this.Request=new Ye(this.collect),this.autoTrackStart=!0,this.init(),v(this,this.config)},t.prototype.init=function(){this.Listener.init(this.handle.bind(this));try{"base"===this.collect.loadType&&(window.opener||window.parent).postMessage("[tea-sdk]ready","*")}catch(t){}},t.prototype.handle=function(t,e){"dom"===t.eventType&&this.handleDom(t,e)},t.prototype.handleDom=function(t,e){try{var i=t.eventName;if("click"===i||"exposure"===i||"change"===i||"submit"===i){var n=this.EventHandle.handleEvent(e,i);null!==n&&this.Request.send({eventType:"custom",eventName:"report_"+i+"_event",extra:{methods:"GET"}},n)}else if("page_view"===i||"page_statistics"===i){var o=void 0;o="page_view"===i?this.EventHandle.handleViewEvent(e):this.EventHandle.handleStatisticsEvent(e),this.Request.send({eventType:"custom",eventName:"report_${eventName}_event",extra:{methods:"GET"}},o)}else if("beat"===i){var r=this.EventHandle.handleBeadtEvent(e),s=t.eventSend;this.Request.send({eventType:"custom",eventName:"report_${eventName}_event",extra:{methods:"GET"},eventSend:s},r)}}catch(t){}},t.prototype.destroy=function(){return this.autoTrackStart?(this.autoTrackStart=!1,void this.Listener.removeListener()):void 0},t}();try{var ci=we();ci&&(ci.LogAutoTrack=function(t,e){(new ai).apply(t,e)})}catch(E){}!function(t){t.Net="net",t.FailNet="f_net",t.FailData="f_data"}(Ne||(Ne={}));var li={pv:["predefine_pageview"],sdk:["_be_active","predefine_page_alive","predefine_page_close","__profile_set","__profile_set_once","__profile_increment","__profile_unset","__profile_append"],autotrack:["bav2b_click","bav2b_page","bav2b_beat","bav2b_page_statistics","__bav_click","__bav_page","__bav_beat","__bav_page_statistics"]},ui=function(){function t(){}return t.prototype.apply=function(t,e){var i=this;if(this.ready=e.app_id&&e.enable_tracer&&!e.disable_track_event,this.ready){this.limit={pv:1,sdk:3,autotrack:3,log:3},this.errorCode={f_net:0,f_data:0},this.tracerCache=new Map,this.collect=t,this.appid=e.app_id,this.reportUrl=t.configManager.getUrl("event");var n=this.collect.Types,o=t.adapters.fetch;this.fetch=o,this.collect.on(n.Event,function(){i.addCount("log")}),this.collect.on(n.SubmitError,function(t){var e=t.type,n=t.eventDate,o=t.errorCode,r=t.response;i.addErrorCount(n,e,o,r)}),this.listener(),this.collect.emit(n.TracerReady)}},t.prototype.addCount=function(t,e,i){void 0===e&&(e="net"),void 0===i&&(i=1);try{this.tracerCache||(this.tracerCache=new Map);var n=void 0;if(this.tracerCache.has(t))(o=this.tracerCache.get(t)).has(e)?(n=o.get(e).params.count,n++,o.set(e,this.processTracer(n,t,e))):(n=i,o.set(e,this.processTracer(i,t,e)));else{var o=new Map;n=i,o.set(e,this.processTracer(i,t,e)),this.tracerCache.set(t,o)}"net"===e&&n>=this.limit[t]&&this.report(!1)}catch(t){}},t.prototype.addErrorCount=function(t,e,i,n){var o=this;try{if(t&&t.length){var r=t[0].events;r&&r.length&&("f_data"===e?(n&&n.hasOwnProperty("sc")?this.addCount("log",e,r.length-n.sc):this.addCount("log",e,r.length),this.errorCode[e]=i):r.forEach(function(t){var n="log";for(var r in li)if(-1!==li[r].indexOf(t.event)){n=r;break}o.addCount(n,e,1),o.errorCode[e]=i}))}}catch(t){}},t.prototype.report=function(t){if(this.tracerCache){var e=[];this.tracerCache.forEach(function(t){t.forEach(function(t){e.push(t)})}),e&&e.length&&this.sendTracer(e,t)}},t.prototype.sendTracer=function(t,e){try{var i=this.collect.eventManager.merge(t);e&&window.navigator.sendBeacon?window.navigator.sendBeacon(this.reportUrl,JSON.stringify(i)):this.fetch(this.reportUrl,i),this.tracerCache=null}catch(t){}},t.prototype.processTracer=function(t,e,i){var n={count:t,state:i,key:e,params_for_special:"applog_trace",aid:this.appid,platform:"web",_staging_flag:1,sdk_version:J};"f_net"!==i&&"f_data"!==i||(n.errorCode=this.errorCode[i]);var o=this.collect.processEvent("applog_trace",n);return o&&o.event?(delete o.is_bav,o):void 0},t.prototype.listener=function(){var t=this;document.addEventListener("visibilitychange",function(){"hidden"===document.visibilityState&&t.leavePage()}),M(function(){t.leavePage()})},t.prototype.leavePage=function(){this.report(!0)},t}();try{var hi=we();hi&&(hi.LogTracer=function(t,e){(new ui).apply(t,e)})}catch(E){}var pi=function(){function t(){this.retryWaitTime=3e3,this.retryStatus=!1,this.retryCacheStatus=!1}return t.prototype.apply=function(t,e){var i=this;if(e.enable_storage&&!e.disable_storage&&(this.collect=t,this.config=e,!this.collect.destroyInstance)){var n=t.Types,o=t.adapters,r=o.storage,s=o.fetch;this.storage=new r(!1),this.fetch=s,this.eventUrl=this.collect.configManager.getUrl("event"),this.eventKey="__tea_cache_events_"+e.app_id,this.storageNum=e.storage_num||50,this.retryNum=e.retry_num||3,this.retryInterval=1e3,t.on(n.SubmitError,function(t){"f_data"!==t.type&&i.storeData(t)}),t.on(n.Ready,function(){i.checkStorage()})}},t.prototype.retryRightNow=function(t){var e=this;if(this.retryStatus)this.errorCache.push(t);else{var i=0;this.retryStatus=!0;var n=setInterval(function(){if(3===i)return e.storeData(e.errorCache),e.retryStatus=!1,void clearInterval(n);var o=t.eventData;e.fetchData(o,function(){e.retryStatus=!1,clearInterval(n),e.retryCacheStatus&&e.errorCache.splice(0,1),e.errorCache.length&&(e.retryCacheStatus=!0,e.retryRightNow(e.errorCache[0]))},function(){i++})},this.retryInterval)}},t.prototype.storeData=function(t){var e=this.storage.getItem(this.eventKey),i=t.eventData;Object.keys(e).length!==this.storageNum&&(e[Date.now()]=i,this.storage.setItem(this.eventKey,e))},t.prototype.checkStorage=function(){var t=this;try{if(!window.navigator.onLine)return;var e=this.storage.getItem(this.eventKey);if(!e||!Object.keys(e).length)return;var i={events:[{event:"ontest",params:{app_id:this.config.app_id},local_time_ms:Date.now()}],user:{user_unique_id:this.collect.configManager.get("web_id")},header:{}};this.fetchData([i],function(){var i=JSON.parse(JSON.stringify(e)),n=function(n){t.fetchData(e[n],function(){delete i[n],t.storage.setItem(t.eventKey,i)},function(){},!1)};for(var o in e)n(o)},function(){},!0)}catch(t){}},t.prototype.fetchData=function(t,e,i,n){this.fetch(this.eventUrl,t,3e4,!1,function(){e&&e()},function(){void(i&&i())},n?"566f58151b0ed37e":"")},t}(),fi=o(function(t){t.exports=function(){var t="millisecond",e="second",i="minute",n="hour",o="day",r="week",s="month",a="quarter",c="year",l="date",u="Invalid Date",h=/^(\d{4})[-\/]?(\d{1,2})?[-\/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,p=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,f={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_")},d=function(t,e,i){var n=String(t);return!n||n.length>=e?t:""+Array(e+1-n.length).join(i)+t},g={s:d,z:function(t){var e=-t.utcOffset(),i=Math.abs(e),n=Math.floor(i/60),o=i%60;return(0>=e?"+":"-")+d(n,2,"0")+":"+d(o,2,"0")},m:function k(t,e){if(t.date()<e.date())return-k(e,t);var i=12*(e.year()-t.year())+(e.month()-t.month()),n=t.clone().add(i,s),o=0>e-n,r=t.clone().add(i+(o?-1:1),s);return+(-(i+(e-n)/(o?n-r:r-n))||0)},a:function(t){return 0>t?Math.ceil(t)||0:Math.floor(t)},p:function(u){return{M:s,y:c,w:r,d:o,D:l,h:n,m:i,s:e,ms:t,Q:a}[u]||String(u||"").toLowerCase().replace(/s$/,"")},u:function(t){return void 0===t}},m="en",_={};_[m]=f;var v=function(t){return t instanceof E},y=function(t,e,i){var n;if(!t)return m;if("string"==typeof t)_[t]&&(n=t),e&&(_[t]=e,n=t);else{var o=t.name;_[o]=t,n=o}return!i&&n&&(m=n),n||!i&&m},b=function(t,e){if(v(t))return t.clone();var i="object"==typeof e?e:{};return i.date=t,i.args=arguments,new E(i)},w=g;w.l=y,w.i=v,w.w=function(t,e){return b(t,{locale:e.$L,utc:e.$u,x:e.$x,$offset:e.$offset})};var E=function(){function f(t){this.$L=y(t.locale,null,!0),this.parse(t)}var d=f.prototype;return d.parse=function(t){this.$d=function(t){var e=t.date,i=t.utc;if(null===e)return new Date(0/0);if(w.u(e))return new Date;if(e instanceof Date)return new Date(e);if("string"==typeof e&&!/Z$/i.test(e)){var n=e.match(h);if(n){var o=n[2]-1||0,r=(n[7]||"0").substring(0,3);return i?new Date(Date.UTC(n[1],o,n[3]||1,n[4]||0,n[5]||0,n[6]||0,r)):new Date(n[1],o,n[3]||1,n[4]||0,n[5]||0,n[6]||0,r)}}return new Date(e)}(t),this.$x=t.x||{},this.init()},d.init=function(){var t=this.$d;this.$y=t.getFullYear(),this.$M=t.getMonth(),this.$D=t.getDate(),this.$W=t.getDay(),this.$H=t.getHours(),this.$m=t.getMinutes(),this.$s=t.getSeconds(),this.$ms=t.getMilliseconds()},d.$utils=function(){return w},d.isValid=function(){return!(this.$d.toString()===u)},d.isSame=function(t,e){var i=b(t);return this.startOf(e)<=i&&i<=this.endOf(e)},d.isAfter=function(t,e){return b(t)<this.startOf(e)},d.isBefore=function(t,e){return this.endOf(e)<b(t)},d.$g=function(t,e,i){return w.u(t)?this[e]:this.set(i,t)},d.unix=function(){return Math.floor(this.valueOf()/1e3)},d.valueOf=function(){return this.$d.getTime()},d.startOf=function(t,a){var u=this,h=!!w.u(a)||a,p=w.p(t),f=function(t,e){var i=w.w(u.$u?Date.UTC(u.$y,e,t):new Date(u.$y,e,t),u);return h?i:i.endOf(o)},d=function(t,e){return w.w(u.toDate()[t].apply(u.toDate("s"),(h?[0,0,0,0]:[23,59,59,999]).slice(e)),u)},g=this.$W,m=this.$M,_=this.$D,v="set"+(this.$u?"UTC":"");switch(p){case c:return h?f(1,0):f(31,11);case s:return h?f(1,m):f(0,m+1);case r:var y=this.$locale().weekStart||0,b=(y>g?g+7:g)-y;return f(h?_-b:_+(6-b),m);case o:case l:return d(v+"Hours",0);case n:return d(v+"Minutes",1);case i:return d(v+"Seconds",2);case e:return d(v+"Milliseconds",3);default:return this.clone()}},d.endOf=function(t){return this.startOf(t,!1)},d.$set=function(r,a){var u,h=w.p(r),p="set"+(this.$u?"UTC":""),f=(u={},u[o]=p+"Date",u[l]=p+"Date",u[s]=p+"Month",u[c]=p+"FullYear",u[n]=p+"Hours",u[i]=p+"Minutes",u[e]=p+"Seconds",u[t]=p+"Milliseconds",u)[h],d=h===o?this.$D+(a-this.$W):a;if(h===s||h===c){var g=this.clone().set(l,1);g.$d[f](d),g.init(),this.$d=g.set(l,Math.min(this.$D,g.daysInMonth())).$d}else f&&this.$d[f](d);return this.init(),this},d.set=function(t,e){return this.clone().$set(t,e)},d.get=function(t){return this[w.p(t)]()},d.add=function(t,a){var l,u=this;t=Number(t);var h=w.p(a),p=function(e){var i=b(u);return w.w(i.date(i.date()+Math.round(e*t)),u)};if(h===s)return this.set(s,this.$M+t);if(h===c)return this.set(c,this.$y+t);if(h===o)return p(1);if(h===r)return p(7);var f=(l={},l[i]=6e4,l[n]=36e5,l[e]=1e3,l)[h]||1,d=this.$d.getTime()+t*f;return w.w(d,this)},d.subtract=function(t,e){return this.add(-1*t,e)},d.format=function(t){var e=this,i=this.$locale();if(!this.isValid())return i.invalidDate||u;var n=t||"YYYY-MM-DDTHH:mm:ssZ",o=w.z(this),r=this.$H,s=this.$m,a=this.$M,c=i.weekdays,l=i.months,h=function(t,i,o,r){return t&&(t[i]||t(e,n))||o[i].substr(0,r)},f=function(t){return w.s(r%12||12,t,"0")},d=i.meridiem||function(t,e,i){var n=12>t?"AM":"PM";return i?n.toLowerCase():n},g={YY:String(this.$y).slice(-2),YYYY:this.$y,M:a+1,MM:w.s(a+1,2,"0"),MMM:h(i.monthsShort,a,l,3),MMMM:h(l,a),D:this.$D,DD:w.s(this.$D,2,"0"),d:String(this.$W),dd:h(i.weekdaysMin,this.$W,c,2),ddd:h(i.weekdaysShort,this.$W,c,3),dddd:c[this.$W],H:String(r),HH:w.s(r,2,"0"),h:f(1),hh:f(2),a:d(r,s,!0),A:d(r,s,!1),m:String(s),mm:w.s(s,2,"0"),s:String(this.$s),ss:w.s(this.$s,2,"0"),SSS:w.s(this.$ms,3,"0"),Z:o};return n.replace(p,function(t,e){return e||g[t]||o.replace(":","")})},d.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},d.diff=function(t,l,u){var h,p=w.p(l),f=b(t),d=6e4*(f.utcOffset()-this.utcOffset()),g=this-f,m=w.m(this,f);return m=(h={},h[c]=m/12,h[s]=m,h[a]=m/3,h[r]=(g-d)/6048e5,h[o]=(g-d)/864e5,h[n]=g/36e5,h[i]=g/6e4,h[e]=g/1e3,h)[p]||g,u?m:w.a(m)},d.daysInMonth=function(){return this.endOf(s).$D},d.$locale=function(){return _[this.$L]},d.locale=function(t,e){if(!t)return this.$L;var i=this.clone(),n=y(t,e,!0);return n&&(i.$L=n),i},d.clone=function(){return w.w(this.$d,this)},d.toDate=function(){return new Date(this.valueOf())},d.toJSON=function(){return this.isValid()?this.toISOString():null},d.toISOString=function(){return this.$d.toISOString()},d.toString=function(){return this.$d.toUTCString()},f}(),S=E.prototype;return b.prototype=S,[["$ms",t],["$s",e],["$m",i],["$H",n],["$W",o],["$M",s],["$y",c],["$D",l]].forEach(function(t){S[t[1]]=function(e){return this.$g(e,t[0],t[1])}}),b.extend=function(t,e){return t.$i||(t(e,E,b),t.$i=!0),b},b.locale=y,b.isDayjs=v,b.unix=function(t){return b(1e3*t)},b.en=_[m],b.Ls=_,b.p={},b}()}),di=o(function(t){var e,i,n,o,r,s,a,c,l,u,h,p,f,d,g,m,_;t.exports=(r=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,c=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/,l={years:s=31536e6,months:a=2592e6,days:o=864e5,hours:n=36e5,minutes:6e4,seconds:1e3,milliseconds:1,weeks:6048e5},u=function(t){return t instanceof _},h=function(t,e,i){return new _(t,i,e.$l)},p=function(t){return i.p(t)+"s"},f=function(t){return 0>t},d=function(t){return f(t)?Math.ceil(t):Math.floor(t)},g=function(t){return Math.abs(t)},m=function(t,e){return t?f(t)?{negative:!0,format:""+g(t)+e}:{negative:!1,format:""+t+e}:{negative:!1,format:""}},_=function(){function t(t,e,i){var n=this;if(this.$d={},this.$l=i,void 0===t&&(this.$ms=0,this.parseFromMilliseconds()),e)return h(t*l[p(e)],this);if("number"==typeof t)return this.$ms=t,this.parseFromMilliseconds(),this;if("object"==typeof t)return Object.keys(t).forEach(function(e){n.$d[p(e)]=t[e]}),this.calMilliseconds(),this;if("string"==typeof t){var o=t.match(c);if(o){var r=o.slice(2).map(function(t){return Number(t)});return this.$d.years=r[0],this.$d.months=r[1],this.$d.weeks=r[2],this.$d.days=r[3],this.$d.hours=r[4],this.$d.minutes=r[5],this.$d.seconds=r[6],this.calMilliseconds(),this}}return this}var f=t.prototype;return f.calMilliseconds=function(){var t=this;this.$ms=Object.keys(this.$d).reduce(function(e,i){return e+(t.$d[i]||0)*l[i]},0)},f.parseFromMilliseconds=function(){var t=this.$ms;this.$d.years=d(t/s),t%=s,this.$d.months=d(t/a),t%=a,this.$d.days=d(t/o),t%=o,this.$d.hours=d(t/n),t%=n,this.$d.minutes=d(t/6e4),t%=6e4,this.$d.seconds=d(t/1e3),t%=1e3,this.$d.milliseconds=t},f.toISOString=function(){var t=m(this.$d.years,"Y"),e=m(this.$d.months,"M"),i=+this.$d.days||0;this.$d.weeks&&(i+=7*this.$d.weeks);var n=m(i,"D"),o=m(this.$d.hours,"H"),r=m(this.$d.minutes,"M"),s=this.$d.seconds||0;this.$d.milliseconds&&(s+=this.$d.milliseconds/1e3);var a=m(s,"S"),c=t.negative||e.negative||n.negative||o.negative||r.negative||a.negative,l=o.format||r.format||a.format?"T":"",u=(c?"-":"")+"P"+t.format+e.format+n.format+l+o.format+r.format+a.format;return"P"===u||"-P"===u?"P0D":u},f.toJSON=function(){return this.toISOString()},f.format=function(t){var e=t||"YYYY-MM-DDTHH:mm:ss",n={Y:this.$d.years,YY:i.s(this.$d.years,2,"0"),YYYY:i.s(this.$d.years,4,"0"),M:this.$d.months,MM:i.s(this.$d.months,2,"0"),D:this.$d.days,DD:i.s(this.$d.days,2,"0"),H:this.$d.hours,HH:i.s(this.$d.hours,2,"0"),m:this.$d.minutes,mm:i.s(this.$d.minutes,2,"0"),s:this.$d.seconds,ss:i.s(this.$d.seconds,2,"0"),SSS:i.s(this.$d.milliseconds,3,"0")};return e.replace(r,function(t,e){return e||String(n[t])})},f.as=function(t){return this.$ms/l[p(t)]},f.get=function(t){var e=this.$ms,i=p(t);return"milliseconds"===i?e%=1e3:e="weeks"===i?d(e/l[i]):this.$d[i],0===e?0:e},f.add=function(t,e,i){var n;return n=e?t*l[p(e)]:u(t)?t.$ms:h(t,this).$ms,h(this.$ms+n*(i?-1:1),this)},f.subtract=function(t,e){return this.add(t,e,!0)},f.locale=function(t){var e=this.clone();return e.$l=t,e},f.clone=function(){return h(this.$ms,this)},f.humanize=function(t){return e().add(this.$ms,"ms").locale(this.$l).fromNow(!t)},f.milliseconds=function(){return this.get("milliseconds")},f.asMilliseconds=function(){return this.as("milliseconds")},f.seconds=function(){return this.get("seconds")},f.asSeconds=function(){return this.as("seconds")},f.minutes=function(){return this.get("minutes")},f.asMinutes=function(){return this.as("minutes")},f.hours=function(){return this.get("hours")},f.asHours=function(){return this.as("hours")},f.days=function(){return this.get("days")},f.asDays=function(){return this.as("days")},f.weeks=function(){return this.get("weeks")},f.asWeeks=function(){return this.as("weeks")},f.months=function(){return this.get("months")},f.asMonths=function(){return this.as("months")},f.years=function(){return this.get("years")},f.asYears=function(){return this.as("years")},t}(),function(t,n,o){e=o,i=o().$utils(),o.duration=function(t,e){var i=o.locale();return h(t,{$l:i},e)},o.isDuration=u;var r=n.prototype.add,s=n.prototype.subtract;n.prototype.add=function(t,e){return u(t)&&(t=t.asMilliseconds()),r.bind(this)(t,e)},n.prototype.subtract=function(t,e){return u(t)&&(t=t.asMilliseconds()),s.bind(this)(t,e)}})});fi.extend(di);var gi=["__cep_sdk_onboard","__cep_trigger_sdk","_be_active"],mi=["and","or","not"],_i=function(){function t(){this.support=!0,this.currentPlan=1,this.shouldSendEvent=!1,this.staing=!1,this.test=!1,this.cepReady=!1,this.eventCache=[]}return t.prototype.apply=function(t,e){var i=this;if(this.collect=t,this.config=e,this.config.cep){var n=t.adapters,o=n.fetch,r=n.storage,s=t.Types;this.types=s,this.storage=new r(!1),this.fetch=o,this.configManager=t.configManager,this.url=e.cep_url?""+e.cep_url:t.configManager.getDomain()+"/service/2/cep_settings/",this.reportUrl=t.configManager.getUrl("event"),this.key="__tea_cep_plan_"+e.app_id,this.quotasKey="__tea_cep_plan_quotas_"+e.app_id,this.isWait=!1,this.eventCache=[],this.test=t.configManager.staging,this.collect.on(s.SubmitAfter,function(t){i.matchEvent(t)}),this.init()}},t.prototype.init=function(){var t=this,e=!0,i=0,n=0,o=0,r=!1,s=this.storage.getItem(this.key)||{};if(s&&Object.keys(s).length&&(r=!0,i=s.last_update_time,n=s.fetch_interval,o=s.config_version||0,e=Date.now()-i>1e3*n),e){var a=this.configManager.get(),c=a.header,l=a.user;this.fetch(this.url,{header:c,user:l,local_time:Date.now(),config_version:o},1e4,!1,function(e){e&&0===e.code?(s.fetch_interval=e.fetch_interval,s.data=e.data,s.last_update_time=Date.now(),s.config_version=e.config_version,t.clearQuotas(),t.initState(e.data),t.storage.setItem(t.key,s),e.data.forEach(function(e){t.event("__cep_sdk_onboard",e.plan_id)})):304!==e.code&&400!==e.code||!r?void 0:(s.last_update_time=Date.now(),t.storage.setItem(t.key,s),t.initState(s.data))},function(){r?(t.planData=s.data,t.initState(s.data)):void(t.support=!1)})}else s.last_update_time=Date.now(),this.storage.setItem(this.key,s),this.initState(s.data)},t.prototype.initState=function(t){var e=this;t&&t.length&&(this.stateArray=new Map,this.waitArray=new Map,this.planData=t,t.forEach(function(t){var i=new Map;if(t.pattern&&t.pattern.events){var n=1===t.pattern.events.length;t.pattern.events.forEach(function(t){i.set(t.id,{id:t.id,isMatch:!1,event:null,after:t.after||null,connection:t.connection||null,window:t.window||null,matchTime:0,initTime:Date.now(),singleRule:n})
}),e.stateArray.set(t.plan_id,{patternState:i,singleRule:n,pattern:{aid:t.aid,biz_id:t.biz_id,end_time:t.end_time,start_time:t.start_time,web_sdk_version:t.web_sdk_version,stage:t.stage},quotas:t.quotas})}}),this.cepReady=!0,this.dealCache(),this.collect.emit(this.types.CepReady))},t.prototype.check=function(t){var e=Date.now();return Date.now()>1e3*t.end_time?!1:e<1e3*t.start_time||e>1e3*t.end_time?!1:(this.staing="testing"===t.staing,!(J<t.web_sdk_version&&(this.support=!1,1)))},t.prototype.dealCache=function(){var t=this;if(this.eventCache.length){var e=1;this.eventCache.forEach(function(i){t.matchEvent(i),e++}),e===this.eventCache.length&&(this.eventCache=[])}},t.prototype.matchEvent=function(t){if(this.support&&(!this.staing||this.test)&&t&&t.length)try{if(!this.cepReady)return void this.eventCache.push(t);var e=t[0],i=e.header,n=e.user,o=e.events;o.length&&o.reverse();for(var r=0;r<o.length;r++){var s=o[r].event;if(-1!==gi.indexOf(s))return!1;this.matchRule(i,n,o[r])}}catch(t){return void this.collect.emit(w.DEBUGGER_MESSAGE,{type:w.DEBUGGER_MESSAGE_SDK,info:"鍙戠敓浜嗗紓甯�",level:"error",time:Date.now(),data:t.message})}},t.prototype.matchRule=function(t,e,i){try{for(var n=0;n<this.planData.length;n++){var o=this.planData[n],r=o.plan_id;if(this.check(o)&&this.checkQuotas(r)&&o.pattern&&o.pattern.events)for(var s=o.pattern.events,a=0;a<s.length;a++)if(this.rule(t,e,i,s[a].condition)){var c=this.stateArray.get(r).patternState,l=c.get(s[a].id);if(this.stateArray.get(r).singleRule){this.changeStatus(r,s[a].id,i),this.publish([i],r,s[a].id);break}if(!l.isMatch){l.after&&c.get(l.after).isMatch?this.changeStatus(r,s[a].id,i):l.after||this.changeStatus(r,s[a].id,i);break}}}this.statusCheck()}catch(t){return void this.collect.emit(w.DEBUGGER_MESSAGE,{type:w.DEBUGGER_MESSAGE_SDK,info:"鍙戠敓浜嗗紓甯�",level:"error",time:Date.now(),data:t.message})}},t.prototype.changeStatus=function(t,e,i){var n=this.stateArray.get(t),o=n.patternState.get(e);o.isMatch=!0,o.event=i,o.matchTime=i.local_time_ms||Date.now(),n.patternState.set(e,o),this.stateArray.set(t,n)},t.prototype.statusCheck=function(){var t,n,o,r;try{for(var s=e(this.stateArray),a=s.next();!a.done;a=s.next()){var c=i(a.value,2),l=c[0],u=c[1],h=u.patternState;if(u.isSingle)break;try{for(var p=e(h),f=p.next();!f.done;f=p.next()){var d=i(f.value,2),g=d[0],m=d[1];if(m.after&&(!m.after||h.get(m.after).isMatch)){if("NOT_FOLLOWED_BY"===m.connection){m.isMatch?this.reset(l,g):Date.now()-h.get(m.after).matchTime>m.window?this.publish([h.get(m.after).event,m.event],l,g):this.startWait(l,g,m);break}m.isMatch?m.matchTime-h.get(m.after).matchTime<=m.window?this.publish([h.get(m.after).event,m.event],l,g):this.reset(l,g):Date.now()-h.get(m.after).matchTime>m.window?this.reset(l,g):this.startWait(l,g,m);break}}}catch(t){o={error:t}}finally{try{f&&!f.done&&(r=p.return)&&r.call(p)}finally{if(o)throw o.error}}}}catch(n){t={error:n}}finally{try{a&&!a.done&&(n=s.return)&&n.call(s)}finally{if(t)throw t.error}}},t.prototype.startWait=function(t,e,i){var n=this;try{this.waitArray.get(t)||this.waitArray.set(t,new Map);var o=this.waitArray.get(t);if(!o.get(e)){var r=setTimeout(function(){var o=n.stateArray.get(t).patternState,r=o.get(e);if("NOT_FOLLOWED_BY"===r.connection)!r.isMatch&&o.get(r.after).isMatch||r.matchTime-o.get(r.after).matchTime>i.window?((s=n.waitArray.get(t).get(e)).triggerWait=!0,n.waitArray.set(t,n.waitArray.get(t).set(e,s)),n.publish([o.get(r.after).event],t,e)):n.reset(t,e);else if("FOLLOWED_BY"===r.connection){var s;r.isMatch&&o.get(r.after).isMatch?((s=n.waitArray.get(t).get(e)).triggerWait=!0,n.waitArray.set(t,n.waitArray.get(t).set(e,s)),n.publish([o.get(r.after).event],t,e)):n.reset(t,e)}},i.window);o.set(e,{waitFn:r,triggerWait:!1}),this.waitArray.set(t,o)}}catch(t){void this.collect.emit(w.DEBUGGER_MESSAGE,{type:w.DEBUGGER_MESSAGE_SDK,info:"鍙戠敓浜嗗紓甯�",level:"error",time:Date.now(),data:t.message})}},t.prototype.rule=function(t,e,i,n){var o=this;try{var r=i.event,s=i.params;if(s=JSON.parse(s),-1!==mi.indexOf(n.op)){if(n.conditions&&n.conditions.length){var a=n.conditions,c=0,l=new Map;l.set(c,{op:n.op,result:void 0,resultList:[],resultKey:[],resultLength:a.length}),!function m(i,n){for(var a=0;a<i.length;a++)if(c++,-1!==mi.indexOf(i[a].op)&&i[a].hasOwnProperty("conditions"))l.set(c,{op:i[a].op,result:void 0,fatherKey:n,resultList:[],resultKey:[],resultLength:i[a].conditions.length}),m(i[a].conditions,c);else{var u=o.scope(i[a].key),h=u.scope,p=u.key,f=u.key2,d=h?"header"===h?f?JSON.parse(t[f])[p]:t[p]:"user"===h?e[p]:s[p]:r,g=o.calculate(i[a].op,d,i[a].value);l.set(c,{op:i[a].op,result:g,fatherKey:n})}}(a,c);for(var u=l.get(0);void 0===u.result||u.resultList.length<u.resultLength;)l.forEach(function(t,e){if(void 0!==t.result&&void 0!==t.fatherKey){var i=l.get(t.fatherKey);i.resultList.length<i.resultLength&&-1===i.resultKey.indexOf(e)&&(i.resultKey.push(e),i.resultList.push(t.result),l.set(t.fatherKey,i))}}),l.forEach(function(t){t.resultList&&t.resultList.length===t.resultLength&&("and"===t.op&&(t.result=-1===t.resultList.indexOf(!1)),"or"===t.op&&(t.result=-1!==t.resultList.indexOf(!0)))});return l.get(0).result}return!1}var h=this.scope(n.key),p=h.scope,f=h.key,d=h.key2,g=p?"header"===p?d?JSON.parse(t[d])[f]:t[f]:"user"===p?e[f]:s[f]:r;return this.calculate(n.op,g,n.value)}catch(t){return this.collect.emit(w.DEBUGGER_MESSAGE,{type:w.DEBUGGER_MESSAGE_SDK,info:"鍙戠敓浜嗗紓甯�",level:"error",time:Date.now(),data:t.message}),!1}},t.prototype.publish=function(t,e,i){try{var n=this.configManager.get().user,o={biz_id:this.stateArray.get(e).pattern.biz_id,plan_id:e,uid:n.user_id||"",did:n.device_id||"",uuid:n.user_unique_id,events:t,extra:{url:window.location.href}};this.collect.emit("__cep_match",o),(window.opener||window.parent).postMessage({type:"__cep_match",data:o},"*"),this.event("__cep_trigger_sdk",e),this.addQuotas(e),void this.reset(e,i)}catch(t){return void this.collect.emit(w.DEBUGGER_MESSAGE,{type:w.DEBUGGER_MESSAGE_SDK,info:"鍙戠敓浜嗗紓甯�",level:"error",time:Date.now(),data:t.message})}},t.prototype.addQuotas=function(t){var e=this.stateArray.get(t).quotas;if(e&&e.length){var i=this.storage.getItem(this.quotasKey)||{};i[t]||(i[t]={value:0,lastTime:Date.now()});var n=i[t].value;0===n&&(i[t].lastTime=Date.now()),i[t].value=n+1,this.storage.setItem(this.quotasKey,i)}},t.prototype.checkQuotas=function(t){var e=this.stateArray.get(t).quotas,i=this.storage.getItem(this.quotasKey)||{};if(i[t]||(i[t]={value:0,lastTime:Date.now()}),e&&e.length){var n=e[0].granularity,o=e[0].value;if("per_keyid"!==e[0].type)return!0;var r=this.release(n);return"all"===r?!(i[t].value>=o):Date.now()-i[t].lastTime>=r?(i[t].value=0,i[t].lastTime=Date.now(),this.storage.setItem(this.quotasKey,i),!0):!(i[t].value>=o)}return!0},t.prototype.clearQuotas=function(){this.storage.setItem(this.quotasKey,null)},t.prototype.release=function(t){if("all"===t)return t;var e=fi.duration(t);return e?e.asMilliseconds():"all"},t.prototype.reset=function(t,e){var i=this.stateArray.get(t);if(i.singleRule){var n=i.patternState.get(e);n.isMatch=!1,n.event=null,n.matchTime=0,n.initTime=Date.now(),i.patternState.set(e,n)}else i.patternState.forEach(function(t){t.isMatch=!1,t.event=null,t.matchTime=0,t.initTime=Date.now()});this.stateArray.set(t,i);var o=this.waitArray.get(t);o&&o.get(e)&&(clearTimeout(o.get(e).waitFn),o.delete(e))},t.prototype.event=function(t,e){try{var i={event:t,params:JSON.stringify({plan_id:e||"",biz_id:this.stateArray.get(e).pattern.biz_id}),local_time_ms:Date.now()},n=this.configManager.get(),o=n.header,r=n.user;o.custom=JSON.stringify(o.custom);var s={events:[i],user:r,header:o};this.fetch(this.reportUrl,[s])}catch(t){return void this.collect.emit(w.DEBUGGER_MESSAGE,{type:w.DEBUGGER_MESSAGE_SDK,info:"鍙戠敓浜嗗紓甯�",level:"error",time:Date.now(),data:t.message})}},t.prototype.scope=function(t){var e="",i="";if(t.indexOf(".")>-1){var n=t.split(".");e=n[0],t=n[1],"header"===e&&"custom"===t&&(t=n[2],i=n[1])}return{scope:e,key:t,key2:i}},t.prototype.calculate=function(t,e,i){try{if("="===t)return e===i;if(-1!==["=","<",">",">=","<=","!="].indexOf(t))switch(t){case"=":return e===i;case"<":return i>e;case">":return e>i;case">=":return e>=i;case"<=":return i>=e;case"!=":return e!==i}else{if(-1!==["in","contains"].indexOf(t))return-1!==i.indexOf(e);if(-1!==["is not null","is null"].indexOf(t))return"is null"===t?null==e:null!=e;if(-1!==["startswith","endswith"].indexOf(t)){if("startswith"===t)return 0===e.indexOf(i);var n=e.length-i.length;return e.substr(n,i.length)===i}}}catch(t){return this.collect.emit(w.DEBUGGER_MESSAGE,{type:w.DEBUGGER_MESSAGE_SDK,info:"鍙戠敓浜嗗紓甯�",level:"error",time:Date.now(),data:t.message}),!1}},t}();try{var vi=we();vi&&(vi.LogCep=function(t,e){(new _i).apply(t,e)})}catch(E){}var yi={autotrack:{src:{cn:"https://lf3-cdn-tos.bytescm.com/obj/static/log-sdk/collect/5.0/plugin/autotrack.js",sg:"https://sf16-scmcdn-sg.ibytedtos.com/obj/static-sg/log-sdk/collect/5.0/plugin/autotrack.js",va:"https://sf16-scmcdn-va.ibytedtos.com/obj/static-us/log-sdk/collect/5.0/plugin/autotrack.js"},object:"LogAutoTrack"},ab:{src:{cn:"https://lf3-cdn-tos.bytescm.com/obj/static/log-sdk/collect/5.0/plugin/ab.js",sg:"https://sf16-scmcdn-sg.ibytedtos.com/obj/static-sg/log-sdk/collect/5.0/plugin/ab.js",va:"https://sf16-scmcdn-va.ibytedtos.com/obj/static-us/log-sdk/collect/5.0/plugin/ab.js"},object:"LogAb"},stay:{src:{cn:"https://lf3-cdn-tos.bytescm.com/obj/static/log-sdk/collect/5.0/plugin/stay.js",sg:"https://sf16-scmcdn-sg.ibytedtos.com/obj/static-sg/log-sdk/collect/5.0/plugin/stay.js",va:"https://sf16-scmcdn-va.ibytedtos.com/obj/static-us/log-sdk/collect/5.0/plugin/stay.js"},object:"LogStay"},route:{src:{cn:"https://lf3-cdn-tos.bytescm.com/obj/static/log-sdk/collect/5.0/plugin/route.js",sg:"https://sf16-scmcdn-sg.ibytedtos.com/obj/static-sg/log-sdk/collect/5.0/plugin/route.js",va:"https://sf16-scmcdn-va.ibytedtos.com/obj/static-us/log-sdk/collect/5.0/plugin/route.js"},object:"LogRoute"},cep:{src:{cn:"https://lf3-cdn-tos.bytescm.com/obj/static/log-sdk/collect/5.0/plugin/cep.js",sg:"https://sf16-scmcdn-sg.ibytedtos.com/obj/static-sg/log-sdk/collect/5.0/plugin/cep.js",va:"https://sf16-scmcdn-va.ibytedtos.com/obj/static-us/log-sdk/collect/5.0/plugin/cep.js"},object:"LogCep"},tracer:{src:{cn:"https://lf3-cdn-tos.bytescm.com/obj/static/log-sdk/collect/5.0/plugin/tracer.js",sg:"https://sf16-scmcdn-sg.ibytedtos.com/obj/static-sg/log-sdk/collect/5.0/plugin/tracer.js",va:"https://sf16-scmcdn-va.ibytedtos.com/obj/static-us/log-sdk/collect/5.0/plugin/tracer.js"},object:"LogTracer"},visual:{src:{cn:"https://lf3-cdn-tos.bytescm.com/obj/static/log-sdk/collect/5.0/plugin/visual.js",sg:"https://sf16-scmcdn-sg.ibytedtos.com/obj/static-sg/log-sdk/collect/5.0/plugin/visual.js",va:"https://sf16-scmcdn-va.ibytedtos.com/obj/static-us/log-sdk/collect/5.0/plugin/visual.js"},object:"LogVisual"}},bi=we(),wi=function(){function t(){}return t.prototype.apply=function(t,e){this._plugin={},this.config=e,this.collect=t,this.channel=e.channel||"cn",this.loadExtend()},t.prototype.loadExtend=function(){var t=this;try{this.collect.remotePlugin.forEach(function(e,i){if("sdk"===e){if(yi.hasOwnProperty(i)){var n=yi[i].object,o=yi[i].src[t.channel]+"?query="+Date.now();t.exist(i,n,o)}}else"object"==typeof e&&(e.src?t.exist(i,e.call,e.src):t.process(i,e.instance,"INSTANCE"))})}catch(t){void this.collect.emit(w.DEBUGGER_MESSAGE,{type:w.DEBUGGER_MESSAGE_SDK,info:"鍙戠敓浜嗗紓甯�",level:"error",time:Date.now(),data:t.message})}},t.prototype.exist=function(t,e,i){var n=this;bi[e]?void this.process(t,bi[e]):this.loadPlugin(t,i,function(){void n.process(t,bi[e])},function(){})},t.prototype.process=function(t,e,i){try{if(i){var n=new e;void(n.apply&&n.apply(this.collect,this.config))}else e&&e(this.collect,this.config)}catch(e){void this.collect.emit(w.DEBUGGER_MESSAGE,{type:w.DEBUGGER_MESSAGE_SDK,info:"鍙戠敓浜嗗紓甯�",level:"error",time:Date.now(),data:e.message})}},t.prototype.loadPlugin=function(t,e,i,n){var o=this;try{var r=document.createElement("script");r.src=e,this._plugin[t]||(this._plugin[t]=[]),this._plugin[t].push(i),r.onerror=function(){n(e)},r.onload=function(){o._plugin[t].forEach(function(t){t()})},document.getElementsByTagName("head")[0].appendChild(r)}catch(t){this.collect.emit(w.DEBUGGER_MESSAGE,{type:w.DEBUGGER_MESSAGE_SDK,info:"鍙戠敓浜嗗紓甯�",level:"error",time:Date.now(),data:t.message})}},t}(),Ei=function(){function t(){this.autotrack=!1,this.spa=!1,this.cache={},this.allowHash=!1}return t.prototype.apply=function(t,e){if(e.spa||e.autotrack){var i=t.Types;this.collect=t,this.config=e,this.appid=e.app_id,this.allowHash=e.allow_hash,this.fncArray=new Map,this.setKey(),this.setLocation(),this.hack(),this.init(),this.listener(),t.emit(i.RouteReady)}},t.prototype.setKey=function(){var t=this.collect.adapters.storage;this.storage=new t(!1),this.cache_key="__tea_cache_refer_"+this.appid,this.cache={refer_key:"",refer_title:document.title||location.pathname,refer_manual_key:"",routeChange:!1},this.config.autotrack&&"object"==typeof this.config.autotrack&&this.config.autotrack.page_manual_key&&(this.cache.refer_manual_key=this.config.autotrack.page_manual_key),this.storage.setItem(this.cache_key,this.cache)},t.prototype.hack=function(){var t=this,e=window.history.pushState;history.pushState=function(i){for(var o=[],r=1;r<arguments.length;r++)o[r-1]=arguments[r];"function"==typeof history.onpushstate&&history.onpushstate({state:i});var s=e.call.apply(e,n([history,i],o));if(t.lastLocation!==location.href){var a=t.getPopStateChangeEventData();return t.setReferCache(t.lastLocation),t.lastLocation=location.href,t.sendPv(a,"pushState"),s}};var i=history.replaceState;history.replaceState=function(e){for(var o=[],r=1;r<arguments.length;r++)o[r-1]=arguments[r];"function"==typeof history.onreplacestate&&history.onreplacestate({state:e});var s=i.call.apply(i,n([history,e],o));if(t.lastLocation!==location.href){var a=t.getPopStateChangeEventData();return t.setReferCache(t.lastLocation),t.lastLocation=location.href,t.sendPv(a),s}}},t.prototype.setLocation=function(){"undefined"!=typeof window&&(this.lastLocation=window.location.href)},t.prototype.getLocation=function(){return this.lastLocation},t.prototype.init=function(){var t=this.getPopStateChangeEventData();this.collect.emit("route-change",{config:t,init:!0})},t.prototype.listener=function(){var t=this,e=null;window.addEventListener("hashchange",function(){if(t.lastLocation!==window.location.href&&(clearTimeout(e),t.allowHash)){t.setReferCache(t.lastLocation),t.lastLocation=window.location.href;var i=t.getPopStateChangeEventData();t.sendPv(i)}}),window.addEventListener("popstate",function(){t.lastLocation!==window.location.href&&(e=setTimeout(function(){t.setReferCache(t.lastLocation),t.lastLocation=window.location.href;var e=t.getPopStateChangeEventData();t.sendPv(e)},10))})},t.prototype.getPopStateChangeEventData=function(){var t=this.pageConfig();return t.is_back=0,t},t.prototype.pageConfig=function(){try{var t=this.storage.getItem(this.cache_key)||{},e=!1,i=this.storage.getItem("__tea_cache_first_"+this.appid);return e=!i||1!=i,{is_html:1,url:location.href,referrer:this.handleRefer(),page_key:location.href,refer_page_key:this.handleRefer(),page_title:document.title||location.pathname,page_manual_key:this.config.autotrack&&this.config.autotrack.page_manual_key||"",refer_page_manual_key:t&&t.refer_manual_key||"",refer_page_title:t&&t.refer_title||"",page_path:location.pathname,page_host:location.host,is_first_time:""+e}}catch(t){return this.collect.emit(w.DEBUGGER_MESSAGE,{type:w.DEBUGGER_MESSAGE_SDK,info:"鍙戠敓浜嗗紓甯�",level:"error",time:Date.now(),data:t.message}),{}}},t.prototype.sendPv=function(t){this.collect.emit("route-change",{config:t,init:!1})},t.prototype.handleRefer=function(){var t="";try{var e=this.storage.getItem()||{};t=e.routeChange?e.refer_key:this.collect.configManager.get("referrer")}catch(e){t=document.referrer}return t},t.prototype.setReferCache=function(t){var e=this.storage.getItem(this.cache_key)||{};e.refer_key=t,e.routeChange=!0,this.storage.setItem(this.cache_key,e)},t}();try{var Si=we();Si&&(Si.LogRoute=function(t,e){(new Ei).apply(t,e)})}catch(E){}var ki=["getConfig","getAbSdkVersion"],Di=["init","usePlugin","autoInitializationRangers","on"],Ti=function(){function t(t){this.task=[],this.Collector=t,this.collectMap=new Map}return t.prototype.processTask=function(){var t=this;if(this.task.length){var e=this.findIndex(this.task,Di,"0");-1!==e?(this.processCmd.apply(this,n(this.task[e])),this.task.forEach(function(i,o){o!==e&&t.processCmd.apply(t,n(i))}),this.task=[]):void 0}},t.prototype.processCmd=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if(D(t)){var i=this.processScope(t[0]),n=i.scope,o=i.cmd;if(t.splice(0,1),-1!==ki.indexOf(o))return this.callCmd(n,o,t);this.callCmd(n,o,t)}},t.prototype.callCmd=function(t,e,i){try{if(-1!==Di.indexOf(e)&&(this.collectMap.get(t)||(this.collect=new this.Collector(t),this.collectMap.set(t,this.collect))),!this.collectMap.get(t))return void 0;var o=this.collectMap.get(t);if(o.__proto__.hasOwnProperty(e))if("event"===e)o.event.apply(o,n([e],i));else{if(-1!==ki.indexOf(e))return o[e].apply(o,n(i));o[e].apply(o,n(i))}else o.event.apply(o,n([e],i))}catch(t){}},t.prototype.findIndex=function(t,e,i){var n=this,o=-1;try{t.forEach(function(t,r){var s=void 0!==i?t[i]:t,a=n.processScope(s).cmd;-1!==e.indexOf(a)&&(o=r)})}catch(t){return o}return o},t.prototype.processScope=function(t){var e="default";try{if("string"==typeof t&&t.indexOf(".")>-1){var i=t.split(".");e=i[0],t=i[1]}}catch(i){return{scope:e,cmd:t}}return{scope:e,cmd:t}},t}();be.usePlugin(wi,"extend"),be.usePlugin(Me,"ab"),be.usePlugin(Ie,"stay"),be.usePlugin(ai,"autotrack"),be.usePlugin(pi,"store"),be.usePlugin(xe,"et"),be.usePlugin(ze,"profile"),be.usePlugin(_i,"cep"),be.usePlugin(Be,"heartbeat"),be.usePlugin($e,"monitor"),be.usePlugin(Ei,"route"),be.usePlugin(ui,"tracer"),function(t){if("undefined"!=typeof window){var e=function(){return"undefined"!=typeof window?window.LogAnalyticsObject||window.TeaAnalyticsObject:void 0}();if(e&&window[e]){var i=window[e];i.sdkLoad?void 0:(t.task=i.q||[],window[e]=t.processCmd.bind(t),window[e].sdkLoad=!0,t.processTask())}}}(new Ti(be))}(),function(t,e){function i(){i.q.push(arguments)}t.LogAnalyticsObject=e,t[e]||(i.q=i.q||[],t[e]=i),t[e].l=+new Date}(window,"collectEvent"),!function(t,e){function i(){window.collectEvent("init",{app_id:1186,channel:"cn"}),window.collectEvent("config",{user_unique_id:visitor.site_id||"",exParams:{user_id:visitor.site_id||""}}),window.collectEvent("start")}i(),t.toutiaoLog={post:function(t,i,n,o,r){e.ajax({url:"/rest/log-toutiao",type:"POST",data:{event_name:t,event_time:i,params:n},success:function(t){"SUCCESS"==t.result?o&&o(t):r&&r(t.message)},error:function(){r&&r("请求错误")}}),window.collectEvent(t,JSON.parse(n)[0])}}}(window.TuchongApi||(window.TuchongApi={}),$),function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window.jQuery,e=window,i=e.TuchongApi.toutiaoLog;t.toutiaoLogUpload={interactive_like:function(t){return t=_.extend({},{like_time:Date.now()/1e3,operation:"pc"},t),i.post("interactive_like",t.like_time,JSON.stringify([t]))},interactive_comment:function(t){return t=_.extend({},{comment_time:Date.now()/1e3,operation:"pc"},t),i.post("interactive_comment",t.comment_time,JSON.stringify([t]))},share_action:function(t){return t=_.extend({},{operation:"pc"},t),i.post("share_action",Date.now()/1e3,JSON.stringify([t]))},follow:function(t){return t=_.extend({},{operation:"pc"},t),i.post("follow",Date.now()/1e3,JSON.stringify([t]))},subscription:function(t){return t=_.extend({},{operation:"pc"},t),i.post("subscription",Date.now()/1e3,JSON.stringify([t]))},start_page:function(t){return t=_.extend({},{enter_time:Date.now()/1e3,operation:"pc"},t),i.post("start_page",t.enter_time,JSON.stringify([t]))},pinterest:function(t){return t=_.extend({},{operation:"pc"},t),i.post("pinterest",Date.now()/1e3,JSON.stringify([t]))},reg:function(t){return t=_.extend({},{operation:"pc"},t),i.post("reg",Date.now()/1e3,JSON.stringify([t]))},click_reward:function(t){return t=_.extend({},{operation:"pc"},t),i.post("click_reward",Date.now()/1e3,JSON.stringify([t]))},vote:function(t){return t=_.extend({},{platform:"pc"},t),i.post("vote_action",Date.now()/1e3,JSON.stringify([t]))},vote_start_page:function(t){return t=_.extend({},{enter_time:Date.now()/1e3,platform:"pc"},t),i.post("vote_action",Date.now()/1e3,JSON.stringify([t]))},click_banners:function(t){return t=_.extend({},{enter_time:Date.now()/1e3,platform:"pc"},t),i.post("click_banners",Date.now()/1e3,JSON.stringify([t]))},click_btn:function(t){return t=_.extend({},{enter_time:Date.now()/1e3,platform:"pc"},t),i.post("click_btn",Date.now()/1e3,JSON.stringify([t]))},click_contribute:function(t){return t=_.extend({},{enter_time:Date.now()/1e3,platform:"pc"},t),i.post("click_contribute",Date.now()/1e3,JSON.stringify([t]))},phpoto_detail_start_page:function(t){return t=_.extend({},{enter_time:Date.now()/1e3,platform:"pc"},t),i.post("right_button_action",Date.now()/1e3,JSON.stringify([t]))},remove_blacklist:function(t){return t=_.extend({},{enter_time:Date.now()/1e3,platform:"pc"},t),i.post("remove_blacklist",Date.now()/1e3,JSON.stringify([t]))},blacklist_operate:function(t){return t=_.extend({},{enter_time:Date.now()/1e3,platform:"pc"},t),i.post("blacklist_operate",Date.now()/1e3,JSON.stringify([t]))},comment_operate:function(t){return t=_.extend({},{enter_time:Date.now()/1e3,platform:"pc"},t),i.post("comment_operate",Date.now()/1e3,JSON.stringify([t]))},welcomeReg:function(t){return t=_.extend({},{platform:"pc"},t),i.post("click_reg",Date.now()/1e3,JSON.stringify([t]))},welcomeLogin:function(t){return t=_.extend({},{platform:"pc"},t),i.post("click_login",Date.now()/1e3,JSON.stringify([t]))},video_uploadenter_click:function(t){return t=_.extend({},{platform:"pc"},t),i.post("video_uploadenter_click",Date.now()/1e3,JSON.stringify([t]))},video_enter_click:function(t){return t=_.extend({},{platform:"pc"},t),i.post("video_enter_click",Date.now()/1e3,JSON.stringify([t]))},video_upload:function(t){return t=_.extend({},{platform:"pc"},t),i.post("video_upload",Date.now()/1e3,JSON.stringify([t]))},video_click:function(t){return t=_.extend({},{platform:"pc"},t),i.post("video_click",Date.now()/1e3,JSON.stringify([t]))},video_play_click:function(t){return t=_.extend({},{platform:"pc"},t),i.post("video_play_click",Date.now()/1e3,JSON.stringify([t]))},video_list_click:function(t){return t=_.extend({},{platform:"pc"},t),i.post("video_list_click",Date.now()/1e3,JSON.stringify([t]))},video_user_click:function(t){return t=_.extend({},{platform:"pc"},t),i.post("video_user_click",Date.now()/1e3,JSON.stringify([t]))},video_detail_click:function(t){return t=_.extend({},{platform:"pc"},t),i.post("video_detail_click",Date.now()/1e3,JSON.stringify([t]))},video_play_fullscreen_click:function(t){return t=_.extend({},{platform:"pc"},t),i.post("video_play_fullscreen_click",Date.now()/1e3,JSON.stringify([t]))},post_send_success:function(t){return t=_.extend({},{platform:"pc"},t),i.post("app_content_release",Date.now()/1e3,JSON.stringify([t]))},post_send_suc_reading:function(t){return t=_.extend({},{platform:"pc"},t),i.post("release_reading",Date.now()/1e3,JSON.stringify([t]))},post_send_suc_continue:function(t){return t=_.extend({},{platform:"pc"},t),i.post("release_continue",Date.now()/1e3,JSON.stringify([t]))},post_sync_toutiao:function(t){return t=_.extend({},{platform:"pc"},t),i.post("syncto_toutiao_release",Date.now()/1e3,JSON.stringify([t]))},click_search:function(t){return t=_.extend({},{platform:"pc"},t),i.post("web_click_search",Date.now()/1e3,JSON.stringify([t]))},wallpaper_switch:function(t){return t=_.extend({},{platform:"pc"},t),i.post("wallpaper_switch",Date.now()/1e3,JSON.stringify([t]))},report:function(t){return t=_.extend({},{platform:"pc"},t),i.post("report_operate",Date.now()/1e3,JSON.stringify([t]))},pc_home_click:function(t){return t=_.extend({},{platform:"pc"},t),i.post("pc_home_click",Date.now()/1e3,JSON.stringify([t]))},pc_launch:function(t){return t=_.extend({},{platform:"pc"},t),i.post("pc_launch",Date.now()/1e3,JSON.stringify([t]))},pc_search_buy:function(t){return t=_.extend({},{platform:"pc"},t),i.post("pc_search_buy",Date.now()/1e3,JSON.stringify([t]))},pc_image_buy:function(t){return t=_.extend({},{platform:"pc"},t),i.post("pc_image_buy",Date.now()/1e3,JSON.stringify([t]))},album_user_click:function(t){return t=_.extend({},{platform:"pc"},t),i.post("album_user_click",Date.now()/1e3,JSON.stringify([t]))},homepage_click:function(t){return t=_.extend({},{platform:"pc"},t),i.post("homepage_click",Date.now()/1e3,JSON.stringify([t]))},click_start_page_btn:function(t){return t=_.extend({},{platform:"pc"},t),i.post("click_start_page_btn",Date.now()/1e3,JSON.stringify([t]))},click_event_custom_tab:function(t){return t=_.extend({},{platform:"pc"},t),i.post("click_ad",Date.now()/1e3,JSON.stringify([t]))},click_follow_ad:function(t){return t=_.extend({},{platform:"pc"},t),i.post("click_contribute",Date.now()/1e3,JSON.stringify([t]))}}}(),function(t){t.siteLink=function(t){var e=0==t.site_id?"":"popover-action";return'<a href="'+t.url+'" data-popover-id="'+t.site_id+'" data-popover-type="user" class="site-link '+e+'"data-site-id="'+t.site_id+'" target="_blank">'+_.escape(t.name)+"</a>"},t.sitesLinks=function(e){for(var i=[],n=0,o=e.length;o>n&&7>n;n++)i.push(t.siteLink(e[n]));return i.join("，")+(e.length>7?" 等":"")},t.siteMapLinks=function(e,i){for(var n=[],o=0,r=e.length;r>o&&7>o;o++)n.push(t.siteLink(i[e[o]]));return n.join("、")+(e.length>7?" 等":"")},t.siteIcon=function(t){var e=t&&0==t.site_id?["site-icon"]:["site-icon popover-action"],i="",n=(t&&t.verification_list||[]).length;return 0!=n&&(1==n&&(i=0==t.verification_list[0].verification_type||1==t.verification_list[0].verification_type||11==t.verification_list[0].verification_type?'<i class="vip-blue vip-right"></i>':'<i class="vip-yellow vip-right"></i>'),n>1&&(i='<i class="vip-yellow vip-right"></i><i class="vip-blue vip-left"></i>')),'<a href="'+t.url+'" class="'+e.join(" ")+'" data-site-id="'+t.site_id+'" data-popover-id="'+t.site_id+'" data-popover-type="user" target="_blank">'+i+'<img src="'+t.icon+'" alt="'+_.escape(t.name)+'"></a>'},t.siteDesc=function(t){return t.description}}(window.Filter||(window.Filter={})),define("tips",function(){var t='<div class="widget-tips">\n	<p class="tips-msg"></p>\n</div>',e=Backbone.View.extend({render:_.template(t),onShow:null,onClose:null,initialize:function(){this.$el=$(this.render()).appendTo("body"),this.wrapper=this.$el.find(".tips-msg")},show:function(t,e){var i=this;e||(e=4e3),/\|html$/.test(t)?this.wrapper.html(t.replace("|html","")):this.wrapper.text(t),this.$el.show(),this.wrapper.css({opacity:1}),setTimeout(function(){i.wrapper.animate({opacity:0},500,null,function(){i.$el.hide()})},e)}}),i=null;return function(){return null===i&&(i=new e),i}}),define("main",["tips"],function(t){var e='<!-- 不输出最后一行 -->\n<% for(var i =0,len = rows.length; i < len; i++) { %>\n<% if(rows[i].complete) { %>\n<li class="post-row">\n    <% var posts = rows[i].items; %>\n    <% for(var j = 0, plen = posts.length; j < plen; j++) { %>\n    <div class="post-item" style="display:inline-block; margin-left: <%=posts[j].marginLeft%>;">\n        <a class="lazy-load image" data-lazy-url="<%=posts[j].cover_image.url%>"\n        style="width: <%=posts[j].computedWidth%>px;height: <%=posts[j].computedHeight%>px;display:inline-block;"\n        href="<%=posts[j].url%>" target="_blank"></a>\n        <div class="foot">\n            <div class="post-foot">\n                <%==Filter.siteIcon(posts[j].author)%>\n                <%==Filter.siteLink(posts[j].author)%>\n            </div>\n            <div class="post-ops">\n                <a class="icon-like" href="<%=posts[j].url%>"><%=posts[j].favorites%></a>\n                <a class="icon-comment" href="<%=posts[j].url%>"><%=posts[j].comments%></a>\n            </div>\n        </div>\n    </div>\n    <% } %>\n</li>\n<% } %>\n<% } %>',i='<ul class="events-list">\n    <% for (var i =0; i < eventList.length; i++ ){%>\n    <% var event = eventList[i] %>\n    <li>\n        <a class="item-mask" href="<%=event.url%>"></a>\n        <div class="event-pic lazy-load" data-lazy-url="<%=event.images[0]%>">\n            <% if (event.event_type != \'topic\' && event.deadline && event.dueDays > 0 && event.dueDays <= 20){ %>\n            <p class="item-active">距截止&nbsp;<%=event.dueDays%>&nbsp;天</p>\n            <% } %>\n        </div>\n        <div class="item-desc">\n            <h3 class="item-title"><%=event.title%></h3>\n            <p class="item-posts"><span class="pic-icon"></span><%=event.image_count%></p>\n            <% if (event.prize_desc!=\'\' ){%>\n            <p class="item-award"> <i></i><%=event.prize_desc%></p>\n            <% } %>\n        </div>\n    </li>\n    <% } %>\n</ul>',n=Backbone.View.extend({el:"main",menu:0,renderPost:_.template(e),renderEvent:_.template(i),hotPosts:[],initialize:function(){this.tips=new t,this.hotPosts=window.hotPosts;for(var e=0;e<hotPosts.length;e++)hotPosts[e].width=hotPosts[e].cover_image.width,hotPosts[e].height=hotPosts[e].cover_image.height;this.$postList=this.$el.find(".postList"),this.$el.find(".community .postList").show(),this.$el.find(".community .eventList").hide();var i=$.justifyPosts(this.$postList.width(),this.hotPosts,15,273);this.$postList.html(this.renderPost({rows:i})),this.$el.find(".eventList").html(this.renderEvent({eventList:window.eventList})),this._bindEvent(),$.toutiaoLogUpload.pc_launch({home_type:"new"})},events:{"click .hot-menu .hot-posts":"_showHotPosts","click .hot-menu .hot-events":"_showHotEvents","click .tuku":"_goToTuku"},_bindEvent:function(){var t=this;$(document).lazyload(),this.$el.find(".tuchong_stock_search_input").keyup(function(t){if(13===t.keyCode){var e=$(t.target).val()||"风景";window.open("http://stock.tuchong.com/search?source=tc_pc_home_search&term="+e),$.toutiaoLogUpload.pc_home_click({click_position:"search"})}}),this.$el.find(".tuchong_stock_search_btn").on("click",function(){var e=t.$el.find(".tuchong_stock_search_input").val()||"风景";window.open("http://stock.tuchong.com/search?source=tc_pc_home_search&term="+e),$.toutiaoLogUpload.pc_home_click({click_position:"search"})}),this.$el.find(".hot-words .word").click(function(t){var e=t.target.innerHTML;window.open("http://stock.tuchong.com/search?source=tc_pc_home_search&term="+e),$.toutiaoLogUpload.pc_home_click({click_position:"search_word"})}),$(".menu .tuku,.tuku .title,.tuku .intro").click(function(){$.toutiaoLogUpload.pc_home_click({click_position:"enter_gallery"})}),$(".kuaisheji").click(function(){$.toutiaoLogUpload.pc_home_click({click_position:"sheji"})}),$(".menu .community,.community .title,.community .intro").click(function(){$.toutiaoLogUpload.pc_home_click({click_position:"enter_community"})}),$(".contribute").click(function(){$.toutiaoLogUpload.pc_home_click({click_position:"apply_for_money"})}),this.$el.find(".post-item image,.post-ops").click(function(){$.toutiaoLogUpload.pc_home_click({click_position:"photo"})}),this.$el.find(".post-foot .site-icon,.post-foot .site-link").click(function(){$.toutiaoLogUpload.pc_home_click({click_position:"photo_user"})}),this.$el.find(".item-mask").click(function(){$.toutiaoLogUpload.pc_home_click({click_position:"activity"})}),this.$el.find(".swiper-slide").on("click",function(t){{var e=$(t.currentTarget);e.attr("data-index"),e.attr("href")}}),this.$el.find(".switch-type").on("click",function(){$(this).parent().hasClass("active")||($(this).closest(".nav-list").find(".active").removeClass("active"),$(this).parent().addClass("active"),t.eventslist.trigger("changeTab",{status:$(this).data("type")}))})},_showHotPosts:function(){this.$el.find(".community .postList").show(),this.$el.find(".community .eventList").hide(),this.$el.find(".community .hot-posts").removeClass("unactive"),this.$el.find(".community .hot-events").addClass("unactive");
var t=this.$el.find(".community .hot-line");"en"===window.lang?t.addClass("hot-left-en").removeClass("hot-right-en"):t.addClass("hot-left").removeClass("hot-right");var e=$.justifyPosts(this.$postList.width(),this.hotPosts,15,273);this.$postList.html(this.renderPost({rows:e}))},_showHotEvents:function(){this.$el.find(".community .postList").hide(),this.$el.find(".community .eventList").show(),this.$el.find(".community .hot-posts").addClass("unactive"),this.$el.find(".community .hot-events").removeClass("unactive");var t=this.$el.find(".community .hot-line");"en"===window.lang?t.addClass("hot-right-en").removeClass("hot-left-en"):t.addClass("hot-right").removeClass("hot-left")},_goToTuku:function(t){var e=t.target.className;"tuku"==e&&(window.open("https://stock.tuchong.com?source=tc_pc_home","_self"),$.toutiaoLogUpload.pc_home_click({click_position:"enter_gallery"}))}});return n}),require(["main"],function(t){new t});
</script>

</body>
</html>
