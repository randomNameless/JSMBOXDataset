<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>4005.6f562922d9c9f546bc3d.html</title>
</head>
<body>

<script>
(self.webpackChunk_cleverpush_cleverpush_js_sdk=self.webpackChunk_cleverpush_cleverpush_js_sdk||[]).push([[4005],{676:function(e,t,r){"use strict";function n(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}r.d(t,{Z:function(){return n}})},3614:function(e,t,r){"use strict";r.d(t,{Z:function(){return i}});var n=r(676);function i(e){if(Array.isArray(e))return(0,n.Z)(e)}},6410:function(e,t,r){"use strict";function n(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}r.d(t,{Z:function(){return n}})},2303:function(e,t,r){"use strict";function n(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}r.d(t,{Z:function(){return n}})},8927:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});var n=r(3614),i=r(6410),o=r(2961),s=r(2303);function a(e){return(0,n.Z)(e)||(0,i.Z)(e)||(0,o.Z)(e)||(0,s.Z)()}},2961:function(e,t,r){"use strict";r.d(t,{Z:function(){return i}});var n=r(676);function i(e,t){if(e){if("string"==typeof e)return(0,n.Z)(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?(0,n.Z)(e,t):void 0}}},155:function(e,t,r){"use strict";r.d(t,{ZJ:function(){return o},Tb:function(){return s},U4:function(){return a},xl:function(){return c},_i:function(){return u},NV:function(){return l},_j:function(){return g},Ue:function(){return f},x4:function(){return d},gd:function(){return v},DZ:function(){return h},k$:function(){return b},$t:function(){return p},Jj:function(){return m},jf:function(){return S},C5:function(){return I},Hc:function(){return y},To:function(){return k},zX:function(){return w},hc:function(){return N},HD:function(){return D},rL:function(){return M},JP:function(){return O},vl:function(){return P},Kw:function(){return E},qq:function(){return A},X6:function(){return x},Pp:function(){return T},PM:function(){return U},WR:function(){return q},aw:function(){return W},dR:function(){return R},iP:function(){return C},Mt:function(){return Z},iY:function(){return H},ZB:function(){return j},h$:function(){return L},LO:function(){return B},Ne:function(){return J},KK:function(){return V},Qw:function(){return _},Am:function(){return z},pf:function(){return G},t4:function(){return Y},eE:function(){return K},zE:function(){return X}});var n,i=r(6156),o=10,s="true",a="0",c=0,u=10,l=/\s+/g,g=" ",f=",",d=864e5,v=36e5,h=6e4,b="en",p="cheverpush-speechbubble-unread-notifications",m="cp-has-unread-notifications",S="cleverpush-unread-notifications",I="cleverpush-deny-count",y="cleverpush-subscription-status",k="cleverpush-forced-opt-in-reset-at",w="cleverpush-alert-shown",N="cleverpush-bounce-initial-path",D="dont-show-push-optin-during-shown",M="cleverpush-delivered-conversion",O="cleverpush-conversion",P="cleverpush-banner-opened",E=Object.freeze({NOTIFICATIONS:"notifications",SETTINGS:"settings"}),A={DENIED:"denied",WAS_DENIED:"was-denied",UNSUBSCRIBED:"unsubscribed",PENDING:"pending",ALLOWED:"allowed"},x={ONCE:"once",ONCE_PER_SESSION:"oncePerSession",EVERY_X_SESSIONS:"everyXSessions",ALWAYS:"always"},T=30,U=500,q=2,W=["triggerFollowUpEvent","trackEvent","trackConversion","tagSubscription","untagSubscription","setAttribute","incAttribute","pushAttributeValue","pullAttributeValue","subscribe","triggerOptIn","unsubscribe"],R=50,C=-80,Z="#!/showMobileExitIntentPopup",H="webBanner",j="widget",L="optIns",B={MINUTES:"MINUTES",HOUR:"HOUR",DAYS:"DAYS",SECONDS:"SECONDS"},J={PER_SESSION:"perSession",PER_IMPRESSION:"perImpression"},V=(n={},(0,i.Z)(n,B.MINUTES,6e4),(0,i.Z)(n,B.HOUR,36e5),(0,i.Z)(n,B.DAYS,864e5),(0,i.Z)(n,B.SECONDS,1e3),n),F=[{value:24,unit:B.HOUR},{value:7,unit:B.DAYS},{value:30,unit:B.DAYS}],_="cleverpush-exit-intent-shown",z="cleverpush-banner-shown-current-session",G=function(e){return 60*e*1e3},Y=F.map((function(e){return e.value*V[e.unit]/6e4})),K={CONVERSIONS:"conversions"},X=".ob-smartfeed-wrapper, .OUTBRAIN, outbrain-widget, .js-ob"},9649:function(e,t,r){"use strict";r.d(t,{Z:function(){return j}});var n=r(8927),i=r(6610),o=r(5991),s=r(7159),a=r(1078),c=r(5632),u=r(155),l="cleverpush-deny-sessions",g="cleverpush-deny-time",f="cleverpush-deny-sessions-counted",d="cleverpush-close-time",v="cleverpush-close-sessions",h="cleverpush-close-sessions-counted",b="cleverpush-subscription-id",p="push-subscription-id",m="push-subscription-status",S="cleverpush-domain",I="cleverpush.com",y="cleverpush-last-sync",k="cleverpush-last-session",w="cleverpush-visits",N="cleverpush-tags",D="cleverpush-tag-dates",M="cleverpush-topics",O="cleverpush-last-worker-update",P="cleverpush-last-worker-version",E="cleverpush-notification-clicked",A="cleverpush-facebook-user-ref",x="cleverpush-piano-segments-hash",T="cleverpush-read-notifications",U="cleverpush",q="notifications",W="subscription",R="prev",C="readonly",Z="readwrite",H=36e5,j=function(){function e(t){(0,i.Z)(this,e),this.config=t;try{if("localStorage"in window){if(t.cleverpushDomain&&(t.cleverpushDomain&&localStorage.getItem(b)&&!localStorage.getItem(S)&&localStorage.setItem(S,I),localStorage.getItem(S)&&(this.config.cleverpushDomain=localStorage.getItem(S))),localStorage.getItem(m)&&!localStorage.getItem(u.Hc)&&localStorage.setItem(u.Hc,localStorage.getItem(m)),localStorage.getItem(p)&&!localStorage.getItem(b)&&localStorage.setItem(b,localStorage.getItem(p)),localStorage.getItem(u.Hc)!==u.qq.ALLOWED){var r=Date.now(),n=parseInt(localStorage.getItem(u.C5),u.ZJ),o=localStorage.getItem(u.Hc)===u.qq.UNSUBSCRIBED,s=o?this.config.alertHoursUnsubscribe:this.config.alertHoursDeny,c=o?this.config.alertSessionsUnsubscribe:this.config.alertSessionsDeny,y=o?this.config.alertHoursUnsubscribe:this.config.alertHoursSecondDeny,k=o?this.config.alertSessionsUnsubscribe:this.config.alertSessionsSecondDeny;o||void 0!==s||(s=8760);var w=!1,N=!1;if(localStorage.getItem(g)&&s>0){var D=parseInt(localStorage.getItem(g),u.ZJ),M=parseInt(s,u.ZJ);!isNaN(D)&&!isNaN(M)&&!isNaN(n)&&n<=1&&D+M*H<r&&(w=!0)}if(localStorage.getItem(g)&&y>0){var O=parseInt(localStorage.getItem(g),u.ZJ),P=parseInt(s,u.ZJ);!isNaN(O)&&!isNaN(P)&&!isNaN(n)&&n>1&&O+P*H<r&&(w=!0)}if(localStorage.getItem(l)&&c>0){var E=parseInt(localStorage.getItem(l),u.ZJ);!isNaN(E)&&n<=1&&(sessionStorage.getItem(f)||(E+=1,localStorage.setItem(l,E)),E>=c&&(N=!0))}if(localStorage.getItem(l)&&k>0){var A=parseInt(localStorage.getItem(l),u.ZJ);!isNaN(A)&&!isNaN(n)&&n>1&&(sessionStorage.getItem(f)||(A+=1,localStorage.setItem(l,A)),A>=c&&(N=!0))}if(!w&&!N||s&&!w||c&&!N||this.setDenyStatus(),!w&&!N||y&&!w||k&&!N||this.setDenyStatus(),!o){var x=!1,T=!1;if(localStorage.getItem(d)&&this.config.alertHoursClose>0){var U=parseInt(localStorage.getItem(d),u.ZJ),q=parseInt(this.config.alertHoursClose,u.ZJ);isNaN(U)||isNaN(q)||U+q*H<r&&(x=!0)}if(localStorage.getItem(v)&&this.config.alertSessionsClose>0){var W=parseInt(localStorage.getItem(v),u.ZJ);isNaN(W)||(sessionStorage.getItem(h)||(W+=1,localStorage.setItem(v,W)),W>=this.config.alertSessionsClose&&(T=!0))}!x&&!T||this.config.alertHoursClose&&!x||this.config.alertSessionsClose&&!T||(localStorage.removeItem(m),localStorage.removeItem(u.Hc),localStorage.removeItem(d),localStorage.removeItem(v))}}this.config.forcedOptInResetAt&&(!this.config.forcedOptInResetOnlyIfLastResetBefore||!localStorage.getItem(u.To)||new Date(localStorage.getItem(u.To))<new Date(this.config.forcedOptInResetOnlyIfLastResetBefore))&&localStorage.getItem(u.To)!==new Date(this.config.forcedOptInResetAt).getTime().toString()&&localStorage.getItem(u.Hc)!==u.qq.ALLOWED&&(localStorage.setItem(u.To,new Date(this.config.forcedOptInResetAt).getTime().toString()),localStorage.removeItem(m),localStorage.removeItem(u.Hc),localStorage.removeItem(d),localStorage.removeItem(v),localStorage.removeItem(g),sessionStorage.removeItem(u.zX),sessionStorage.removeItem(u.HD),sessionStorage.removeItem("cleverpush-confirm-alert-reported"))}}catch(e){a.cM.warn("Failed getting managing storage (frequency capping)",e)}}return(0,o.Z)(e,[{key:"setDenyStatus",value:function(){localStorage.removeItem(m),localStorage.removeItem(g),localStorage.removeItem(l),localStorage.getItem(u.Hc)===u.qq.DENIED||localStorage.getItem(u.Hc)===u.qq.UNSUBSCRIBED?localStorage.setItem(u.Hc,u.qq.WAS_DENIED):localStorage.removeItem(u.Hc)}},{key:"dbOpenError",value:function(e){var t=this;(this.dbInitializing=!1,e.message&&e.message.toString().includes("VersionError"))?(a.cM.info("deleting db"),window.indexedDB.deleteDatabase(U).onsuccess=function(){var e=t.db.open();e.onsuccess=function(){return t.dbOpenSuccess(e)},e.onerror=function(e){a.cM.warn(e)}}):e.name&&"NoSuchDatabaseError"===e.name||a.cM.warn(e)}},{key:"dbOpenSuccess",value:function(e){var t=this;this.db=e.result,this.dbInitializing=!1,this.db.onerror=function(e){a.cM.warn("IndexedDB error occured",e)},this.db.onversionchange=function(e){if(null===e.newVersion)e.target.close();else{t.db.close();var r=window.indexedDB.open(U,40);r.onsuccess=function(){return t.dbOpenSuccess(r)},r.onerror=t.dbOpenError}}}},{key:"initDb",value:function(e){var t=this;if(this.db||!window.indexedDB||this.dbInitializing)this.db&&"function"==typeof e&&e(this.db);else{this.dbInitializing=!0;try{var r=window.indexedDB.open(U,40);r.onsuccess=function(){t.dbOpenSuccess(r),"function"==typeof e&&e(r.result)},r.onerror=this.dbOpenError,r.onupgradeneeded=function(e){var t=e.target.result,r=t.createObjectStore(q,{keyPath:"id"});r.createIndex("id","id",{unique:!0}),r.createIndex("url","url",{unique:!1}),r.createIndex("clicked","clicked",{unique:!1}),r.createIndex("title","title",{unique:!1}),r.createIndex("text","text",{unique:!1}),r.createIndex("icon","icon",{unique:!1}),r.createIndex("subscriptionId","subscriptionId",{unique:!1}),r.createIndex("channelId","channelId",{unique:!1}),r.createIndex("autoHide","autoHide",{unique:!1}),r.createIndex("markedAsDelivered","markedAsDelivered",{unique:!1}),r.createIndex("markedAsClicked","markedAsClicked",{unique:!1}),r.createIndex("clickedAction","clickedAction",{unique:!1}),r.createIndex("deliveredAt","deliveredAt",{unique:!1});var n=t.createObjectStore(W,{keyPath:"id"});n.createIndex("id","id",{unique:!0}),n.createIndex("channelId","channelId",{unique:!1})}}catch(e){this.dbInitializing=!1,a.cM.info("initDb error",e)}}}},{key:"hasNotificationsStoredInBrowserDb",value:function(){var e=this;return this.db?new Promise((function(t){var r=e.db.transaction([q],C).objectStore(q).index("deliveredAt").openCursor(null,R);r.onsuccess=function(e){!1!=!!e.target.result?t(!0):t(!1)},r.onerror=function(){return t(!1)}})):(a.cM.info("hasNotificationsStoredInBrowserDb error: no db"),!1)}},{key:"getNotifications",value:function(e){var t=this;return new Promise((function(r){var n=[];if(t.db){var i=t.db.transaction([q],C).objectStore(q).index("deliveredAt").openCursor(null,R);i.onsuccess=function(t){var i=t.target.result;!1==!!i||n.length>=(e||50)?r(n):(n.push(i.value),i.continue())},i.onerror=function(){return r(n)}}else a.cM.info("getNotifications db undefined"),r(n)}))}},{key:"getNotification",value:function(e){var t=this;return new Promise((function(r){if(t.db){var n=t.db.transaction([q]).objectStore(q).get(e);n.onsuccess=function(e){var t=e.target.result;r(t)},n.onerror=function(){return r(null)}}else r(null)}))}},{key:"addNotification",value:function(e){var t=this;return new Promise((function(r,n){if(t.db){var i=t.db.transaction([q],Z).objectStore(q).put(e);i.onsuccess=r,i.onerror=n}else r(null)}))}},{key:"deleteNotification",value:function(e){var t=this;return new Promise((function(r,n){if(t.db){var i=t.db.transaction([q],Z).objectStore(q).delete(e);i.onsuccess=r,i.onerror=n}else r(null)}))}},{key:"canSubscribe",value:function(){try{return new Promise((function(e){try{var t=localStorage.getItem(u.Hc),r=sessionStorage.getItem(u.Hc);t!==u.qq.DENIED&&t!==u.qq.UNSUBSCRIBED&&t!==u.qq.PENDING&&r!==u.qq.DENIED?e(t||!0):e(!1)}catch(t){e(!0)}}))}catch(e){return Promise.resolve(!0)}}},{key:"isSubscribed",value:function(e,t,r){var n=this;try{if(void 0!==t&&t){var i=localStorage.getItem(u.Hc);return!(!i||i===u.qq.DENIED||i===u.qq.UNSUBSCRIBED||i===u.qq.PENDING)&&(!!e||!!this.getSubscriptionId())}return new Promise((function(t){try{var i=localStorage.getItem(u.Hc);if(i&&i!==u.qq.DENIED&&i!==u.qq.UNSUBSCRIBED&&i!==u.qq.PENDING){var o="granted"===localStorage.getItem("amp-web-push-notification-permission");if(e||o)t(!0);else t(!!n.getSubscriptionId())}else if(void 0!==r&&r){t(!!n.getSubscriptionId())}else t(!1)}catch(e){t(!1)}}))}catch(e){return Promise.resolve(!0)}}},{key:"getSubscriptionId",value:function(){var e;try{(e=localStorage.getItem(b))||(e=sessionStorage.getItem(b))}catch(e){a.cM.warn("Failed getting subscription ID from storage",e)}if(!e&&(0,s.io)()){var t=new URLSearchParams(location.search.slice(1));t&&(e=t.get("subscriptionId"))}return e}},{key:"setClickedNotification",value:function(e){try{localStorage.setItem(E,JSON.stringify({id:e,date:Date.now()}))}catch(e){a.cM.info("failed saving notification to storage",e)}}},{key:"getClickedNotification",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:H;try{var t=localStorage.getItem(E),r=JSON.parse(t);if(r&&r.id&&r.date&&parseInt(r.date,u.ZJ)+e>Date.now())return r.id}catch(e){a.cM.info("failed getting notification from storage",e)}return null}},{key:"getLastSession",value:function(){var e;try{e=localStorage.getItem(k)}catch(e){a.cM.info("failed getting sessions from storage",e)}var t={};if(e)try{t=JSON.parse(e)}catch(e){a.cM.info("failed parsing last session from storage",e)}return t}},{key:"setLastSession",value:function(e){try{localStorage.setItem(k,JSON.stringify(e))}catch(e){a.cM.info("failed saving last session to storage",e)}}},{key:"setSubscribed",value:function(e,t){var r=this;e&&(localStorage.setItem(b,e),localStorage.setItem(S,this.config.cleverpushDomain||I),void 0!==t&&t?localStorage.removeItem(u.Hc):localStorage.setItem(u.Hc,u.qq.ALLOWED),this.initDb((function(t){if(t)try{t.transaction([W],Z).objectStore(W).clear().onsuccess=function(){t.transaction([W],Z).objectStore(W).put({id:e,channelId:r.config.channelId})}}catch(e){a.cM.info("setSubscribed db error",e)}})))}},{key:"getFacebookUserRef",value:function(){try{return localStorage.getItem(A)}catch(e){a.cM.info("failed getting facebook user ref",e)}}},{key:"setFacebookUserRef",value:function(e){e&&localStorage.setItem(A,e)}},{key:"setAllowed",value:function(){localStorage.setItem(u.Hc,u.qq.ALLOWED),localStorage.removeItem(u.C5)}},{key:"setPending",value:function(){localStorage.setItem(u.Hc,u.qq.PENDING)}},{key:"setDenied",value:function(){var e;localStorage.setItem(g,Date.now()),localStorage.setItem(u.Hc,u.qq.DENIED),(this.config.alertSessionsDeny>0||this.config.alertSessionsSecondDeny>0)&&(localStorage.setItem(l,u.U4),sessionStorage.setItem(f,u.Tb));var t=null===(e=this.config.confirmAlertFilters)||void 0===e?void 0:e.find((function(e){return"denyCountGreaterThan"===e.type}));if(this.config.alertHoursSecondDeny||this.config.alertSessionsSecondDeny||t){var r=parseInt(localStorage.getItem(u.C5),u.ZJ);r&&!isNaN(r)?(r+=1,localStorage.setItem(u.C5,r)):localStorage.setItem(u.C5,1)}}},{key:"setClosed",value:function(){localStorage.setItem(d,Date.now()),localStorage.getItem(u.Hc)!==u.qq.ALLOWED&&(this.config.alertHoursClose>0||this.config.alertSessionsClose>0?localStorage.setItem(u.Hc,u.qq.DENIED):localStorage.removeItem(u.Hc),this.config.alertSessionsClose>0&&(localStorage.setItem(v,u.U4),sessionStorage.setItem(h,u.Tb)))}},{key:"setUnsubscribed",value:function(e){if(localStorage.removeItem(p),localStorage.removeItem(b),localStorage.removeItem(y),localStorage.removeItem(k),localStorage.removeItem(O),localStorage.removeItem(P),localStorage.removeItem(S),localStorage.removeItem(A),localStorage.removeItem(M),localStorage.removeItem("cleverpush-topics-version"),localStorage.removeItem(N),localStorage.removeItem("cleverpush-attributes"),localStorage.removeItem(w),localStorage.removeItem(x),sessionStorage.removeItem(u.$t),e||(localStorage.setItem(u.Hc,u.qq.UNSUBSCRIBED),localStorage.setItem(g,Date.now())),Object.keys(localStorage).forEach((function(e){(e&&e.startsWith("cleverpush-tag")||e.startsWith("cleverpush-attribute"))&&localStorage.removeItem(e)})),document.querySelectorAll("a[href='#cleverpush-bell-speechbubble']").forEach((function(e){e.classList.contains(u.Jj)&&e.classList.remove(u.Jj)})),this.db)try{this.db.transaction([W],Z).objectStore(W).clear()}catch(e){a.cM.info("setUnsubscribed db error",e)}}},{key:"checkIfShouldSync",value:function(){var e=this;return new Promise((function(t){try{if(!e.getSubscriptionId())return void t(!0);var r=48,n=function(){var e=r*H,n=localStorage.getItem(y);if(n){var i=parseInt(n,u.ZJ);isNaN(i)?t(!0):t(i+e<=Date.now())}else t(!0)};if(e.config.pianoEnabled&&e.config.pianoPublicPersistedId){r=2;try{var i=localStorage.getItem(x);(0,c.kb)().then((function(e){localStorage.setItem(x,e),a.cM.debug("piano segments hashes - existing:",i,"new:",e),e!==i?t(!0):n()})).catch((function(e){a.cM.debug("piano error",e),n()}))}catch(e){a.cM.debug("piano error",e),n()}}else n()}catch(e){t(!0)}}))}},{key:"setSynced",value:function(){localStorage.setItem(y,Date.now())}},{key:"unsetSynced",value:function(){localStorage.removeItem(y)}},{key:"checkIfShouldUpdateWorker",value:function(){var e="1.1.0";return new Promise((function(t){try{var r=localStorage.getItem(O),n=localStorage.getItem(P);if(r)t(n!==e);else t(!0)}catch(e){t(!0)}}))}},{key:"setWorkerUpdated",value:function(){localStorage.setItem(O,Date.now()),localStorage.setItem(P,"1.1.0")}},{key:"getVisits",value:function(){var e;try{e=localStorage.getItem(w)}catch(e){a.cM.info("failed getting visits from storage",e)}var t=0;return e&&(t=parseInt(e,u.ZJ),isNaN(t)&&(t=0)),t}},{key:"incrementVisits",value:function(){var e=this.getVisits();e+=1,localStorage.setItem(w,e)}},{key:"setTopics",value:function(e){return a.cM.debug("storageManager.setTopics",e),new Promise((function(t){e&&e.length?localStorage.setItem(M,JSON.stringify(e)):e&&localStorage.removeItem(M),t(!0)}))}},{key:"getTopics",value:function(){var e=localStorage.getItem(M);if(!e)return Promise.resolve([]);try{var t=JSON.parse(e);return Promise.resolve(t||[])}catch(e){return Promise.resolve([])}}},{key:"getTagDates",value:function(){var e={};if(localStorage.getItem(D))try{e=JSON.parse(localStorage.getItem(D))}catch(e){a.cM.info("failed getting tag dates",e)}return e}},{key:"getTagDate",value:function(e){var t=(this.getTagDates()||{})[e];return t?new Date(t):null}},{key:"setTags",value:function(e){var t=this;return new Promise((function(r){localStorage.setItem(N,JSON.stringify(e));var n=t.getTagDates()||{};e.forEach((function(e){n[e]=(new Date).toISOString()})),localStorage.setItem(D,JSON.stringify(n)),r(!0)}))}},{key:"addTag",value:function(e){var t=this;return this.getTags().then((function(r){return r.indexOf(e)<0&&r.push(e),t.setTags(r)}))}},{key:"removeTag",value:function(e){var t=this;return this.getTags().then((function(r){var n=r.indexOf(e);return n>-1?(r.splice(n,1),t.setTags(r)):Promise.resolve()}))}},{key:"getTags",value:function(){var e=localStorage.getItem(N);if(!e)return Promise.resolve([]);try{var t=JSON.parse(e);return Promise.resolve(t||[])}catch(e){return Promise.resolve([])}}},{key:"getAttribute",value:function(e){try{return Promise.resolve(localStorage.getItem("cleverpush-attribute-".concat(e)))}catch(e){return Promise.resolve(null)}}},{key:"hasAttribute",value:function(e,t){return this.getAttribute(e).then((function(e){return Promise.resolve(e===t)}))}},{key:"hasTag",value:function(e){return this.getTags().then((function(t){return Promise.resolve(t.indexOf(e)>-1)}))}},{key:"setTempBlocked",value:function(){sessionStorage.setItem(u.Hc,u.qq.DENIED)}},{key:"setNotificationRead",value:function(e){try{var t=localStorage.getItem(T);if(t){var r=JSON.parse(t)||[];r.push(e),localStorage.setItem(T,JSON.stringify((0,n.Z)(new Set(r))))}else{var i=[];i.push(e),localStorage.setItem(T,JSON.stringify(i))}}catch(e){a.cM.info("failed to set reads notifications",e)}}},{key:"isNotificationRead",value:function(e){try{var t=localStorage.getItem(T);return!!t&&(JSON.parse(t)||[]).includes(e)}catch(e){return a.cM.info("failed to getting notifications",e),!1}}},{key:"checkUnreadNotifications",value:function(e){try{var t=localStorage.getItem(T),r=JSON.parse(t||"[]")||[],n=e.some((function(e){return!r.includes(e._id)})),i=e.filter((function(e){return!r.includes(e._id)})).length;return localStorage.setItem(u.jf,i),n}catch(e){return a.cM.info("failed to check unread notifications"),!1}}},{key:"deleteOldNotificationsIds",value:function(e){try{var t=localStorage.getItem(T);if(t){var r=(JSON.parse(t)||[]).filter((function(t){return e.some((function(e){return e._id===t}))}));localStorage.setItem(T,JSON.stringify((0,n.Z)(new Set(r))))}}catch(e){a.cM.info("failed to delete notifications",e)}}}]),e}()},4005:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return I}});var n=r(7757),i=r.n(n),o=r(8927),s=r(2137),a=r(484),c=r(6156),u=r(6610),l=r(5991),g=r(1078),f=r(7546),d=r(9649),v=r(2034),h=r(4740),b=r(7159),p=r(3114);function m(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function S(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?m(Object(r),!0).forEach((function(t){(0,c.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):m(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var I=function(){function e(t,r,n){var i=this;(0,u.Z)(this,e),this.config=t,this.api=r,this.triggerEvent=n,this.storageManager=new d.Z(t),this.subscribed=!1,this.initialTags=[];try{this.getTopics().then((function(e){return i.topics=e}))}catch(e){}}var t;return(0,l.Z)(e,[{key:"isSubscribed",value:function(){var e=this;return new Promise((function(t){return"PREVIEW"===e.config.env?t(!1):"granted"===window.Notification.permission&&navigator.serviceWorker?e.getActiveWorkerRegistration().then((function(r){return r.pushManager.getSubscription().then((function(r){if(r)return e.storageManager.isSubscribed().then((function(r){g.cM.debug("manager subscribed = ".concat(r," (2)")),e.subscribed=r,t(r)}));g.cM.debug("manager subscribed = false (1)"),e.subscribed=!1,t(!1)}))})).catch((function(r){r&&g.cM.error(r),g.cM.debug("manager subscribed = false (3)"),e.subscribed=!1,t(!1)})):(g.cM.debug("manager subscribed = false (4)"),e.subscribed=!1,void t(!1))}))}},{key:"canSubscribe",value:function(){var e=this;return new Promise((function(t,r){e.storageManager.canSubscribe().then((function(n){n?e.isSubscribed().then((function(e){e?r(new h.Z("User is already subscribed","subscribed")):"denied"===Notification.permission?r(new h.Z("User denied notifications","denied")):t(!0)})):r(new h.Z("User has manually unsubscribed or denied notifications ".concat(n),"unsubscribed"))})).catch((function(e){r(e)}))}))}},{key:"subscribe",value:function(){}},{key:"subscribeForce",value:function(){this.subscribe()}},{key:"hideUnsubscribeModal",value:function(){this.unsubscribeModal.parentNode.removeChild(this.unsubscribeModal),this.confirm&&this.confirm.hideBackdrop()}},{key:"showUnsubscribeFeedback",value:function(){var e=this;if(!this.config.unsubscribeFeedbackDisabled){var t=[];this.config.optOutFeedbackAnswers&&this.config.optOutFeedbackAnswers.length?(this.config.optOutFeedbackAnswers.forEach((function(e){t.push({title:e.title,id:e.id,icon:e.icon})})),this.config.optOutFeedbackCustomText&&t.push({title:(0,p.Iu)("unsubscribe.reasonOther"),id:"other",icon:""})):t.push({title:(0,p.Iu)("unsubscribe.reasonQuantity"),id:"quantity",icon:""},{title:(0,p.Iu)("unsubscribe.reasonContent"),id:"content",icon:""},{title:(0,p.Iu)("unsubscribe.reasonOther"),id:"other",icon:""});var r=this.config.alertLocalization||{},n=(0,p.ej)(this.config||{});this.config.alertLocalizationTranslations&&n&&this.config.alertLocalizationTranslations[n]&&(r=S(S({},r),this.config.alertLocalizationTranslations[n]));var i=this.config.confirmAlertCloseButton?'<button type="button" class="cleverpush-confirm-hide">&times;</button>':"";this.unsubscribeModal=document.createElement("div"),this.unsubscribeModal.className="cleverpush-confirm cleverpush-confirm-default cleverpush-uf-box",this.unsubscribeModal.innerHTML="".concat(i,'\n<div class="cleverpush-confirm-caret cleverpush-confirm-caret-top" style="display: none; border-bottom-color: ').concat(this.config.confirmAlertThemeBackgroundColor,'"></div>\n<div class="cleverpush-confirm-icon"><img src="').concat(this.config.channelIcon,'"></div>\n<div class="cleverpush-confirm-text">\n  <span class="cleverpush-confirm-title">').concat((0,p.RG)(r.optOutFeedbackTitle)||(0,p.Iu)("unsubscribe.feedback"),'</span>\n</div>\n<div style="margin-top: 10px; margin-bottom: 5px; padding-top: 10px;">\n').concat(t.map((function(e){return'<button type="button" class="cleverpush-confirm-btn cleverpush-uf-button" style="text-transform: none; margin-bottom: 10px !important;" data-reason="'.concat(e.id,'">').concat(e.icon?"<img src=".concat(e.icon,' style="margin-right: 10px; float: left;" width="25" heigh="25">'):"").concat(e.title,"</button>")})).join(""),'\n<button type="button" class="cleverpush-confirm-btn cleverpush-confirm-btn-allow cleverpush-uf-button" data-re-allow="true" style="display: none;">').concat((0,p.Iu)("bell.subscribe"),"</button>\n</div>\n"),document.body.appendChild(this.unsubscribeModal),this.confirm&&this.confirm.showBackdrop();var o=this.unsubscribeModal.querySelector(".cleverpush-confirm-hide");o&&(o.addEventListener("click",(function(){return e.hideUnsubscribeModal()})),this.confirmBox&&"object"===(0,a.Z)(this.config.confirmAlertStyle)&&this.config.confirmAlertStyle.color&&(o.style.color=this.config.confirmAlertStyle.color));for(var s=this.unsubscribeModal.querySelectorAll(".cleverpush-confirm-btn"),c=0;c<s.length;c+=1){s[c].addEventListener("click",(function(t){t.preventDefault(),"true"===t.currentTarget.dataset.reAllow?(e.hideUnsubscribeModal(),e.subscribe()):"other"===t.currentTarget.dataset.reason&&e.config.optOutFeedbackCustomText?e.showCustomText(e.unsubscribeModal):(e.api.unsubscribeFeedback(t.currentTarget.dataset.reason),e.hideUnsubscribeModal())}))}}}},{key:"showCustomText",value:function(e){var t=this;e.innerHTML='\n    <div class="cleverpush-confirm-icon"><img src="'.concat(this.config.channelIcon,'"></div>\n    <div class="cleverpush-confirm-text">\n      <span class="cleverpush-confirm-title">').concat((0,p.Iu)("unsubscribe.enterReason"),'</span>\n    </div>\n    <div style="margin-top: 10px; margin-bottom: 5px;">\n      <div style="text-align: center; padding: 12px;">\n        <textarea style="width: 100%; margin-bottom: 10px;"></textarea>\n        <button type="button" class="cleverpush-confirm-btn cleverpush-uf-button" style="text-transform: none;, margin-bottom: 10px !important;" data-reason="other">').concat((0,p.Iu)("unsubscribe.submit"),"</button>\n      </div>\n    </div>\n    "),e.querySelector(".cleverpush-confirm-btn").addEventListener("click",(function(r){r.preventDefault();var n=e.querySelector("textarea").value;t.api.unsubscribeFeedback(r.currentTarget.dataset.reason,n),e.parentNode.removeChild(e)}))}},{key:"unsubscribe",value:function(e,t){var r=this,n=function(){return r.storageManager.setUnsubscribed(e),r.topics=[],r.triggerEvent(v.Z.UNSUBSCRIBED),navigator.serviceWorker?r.getActiveWorkerRegistration().then((function(e){if(!e.pushManager)return Promise.resolve();e.pushManager.getSubscription().then((function(t){return t?t.unsubscribe().then((function(){return e.unregister()})):Promise.resolve()}))})):Promise.resolve()},i=this.storageManager.getSubscriptionId();return!i||void 0!==t&&t===i?n().then((function(){return r.showUnsubscribeFeedback(),Promise.resolve()})):this.api.unsubscribe(i).then((function(){return n().then((function(){return r.showUnsubscribeFeedback(),Promise.resolve()}))}))}},{key:"getWorkerPath",value:function(){return!(0,b.CO)()||this.config.popupCustomDomainEnabled&&this.config.popupDomain?this.config.serviceWorkerFile||"/worker.js":"/cleverpush-worker.js"}},{key:"getWorkerScope",value:function(){var e=this.getWorkerPath();return e.indexOf("?")>-1&&(e=e.split("?")[0]),e.substr(0,e.lastIndexOf("/")+1)||"/"}},{key:"getServiceWorker",value:function(e){return e.active||e.waiting||e.installing}},{key:"getActiveWorkerRegistration",value:function(){var e=this;return new Promise((function(t,r){if(navigator.serviceWorker)if(navigator.serviceWorker.getRegistration){var n=e.getWorkerScope(),i=e.config.serviceWorkerFile;navigator.serviceWorker.getRegistration(n).then((function(n){n&&e.getServiceWorker(n)&&(!i||!e.getServiceWorker(n).scriptURL||e.getServiceWorker(n).scriptURL.indexOf(i)>-1)?t(n):"function"==typeof navigator.serviceWorker.getRegistrations?navigator.serviceWorker.getRegistrations().then((function(n){var o=!1;(n||[]).forEach((function(r){o||(r&&e.getServiceWorker(r)&&(!i||!e.getServiceWorker(r).scriptURL||e.getServiceWorker(r).scriptURL.indexOf(i)>-1)?(o=!0,t(r)):g.cM.debug("worker: getActiveWorkerRegistration:",r,e.getServiceWorker(r)))})),o||(g.cM.debug("worker: getActiveWorkerRegistration: !found"),r())})).catch(r):navigator.serviceWorker.controller?(g.cM.debug("worker: getActiveWorkerRegistration: waiting for worker to be ready"),navigator.serviceWorker.ready.then(t).catch(r)):(g.cM.debug("worker: getActiveWorkerRegistration: last reject 1"),r())})).catch(r)}else navigator.serviceWorker.controller?(g.cM.debug("worker: getActiveWorkerRegistration: waiting for worker to be ready"),navigator.serviceWorker.ready.then(t).catch(r)):(g.cM.debug("worker: getActiveWorkerRegistration: last reject 2"),r());else g.cM.debug("worker: getActiveWorkerRegistration: !navigator.serviceWorker"),r()}))}},{key:"registerWorker",value:function(){var e=this;return new Promise((function(t,r){g.cM.debug("registering worker");var n=function(){var n=e.getWorkerPath(),i=e.getWorkerScope();navigator.serviceWorker.register(n,{scope:i,updateViaCache:"none"}).then((function(n){g.cM.debug("worker registered",n),n.active?(g.cM.debug("worker is active"),t(n)):n.installing?(g.cM.debug("worker is installing"),n.installing.addEventListener("statechange",(function(e){g.cM.debug("worker: onstatechange",e.target.state),"activated"===e.target.state&&t(n)}))):n.waiting?(g.cM.debug("worker is waiting"),n.installing.addEventListener("statechange",(function(e){g.cM.debug("worker: onstatechange",e.target.state),"activated"===e.target.state&&t(n)}))):(g.cM.debug("worker: getActiveWorkerRegistration"),e.getActiveWorkerRegistration().then(t).catch(r))})).catch((function(e){g.cM.error("error registering worker",e),r(e)}))};e.getActiveWorkerRegistration().then((function(e){e&&e.active?(g.cM.debug("worker was already registered",e),t(e)):n()})).catch(n)}))}},{key:"unregisterOtherPushSubscriptions",value:function(e){var t=this;(0,g.tI)("unregisterOtherPushSubscriptions",e.scriptURL),this.config.importedSubscriptionsProvider&&"function"==typeof navigator.serviceWorker.getRegistrations&&navigator.serviceWorker.getRegistrations().then((function(r){(r||[]).forEach((function(r){t.getServiceWorker(r)&&t.getServiceWorker(r).scriptURL!==e.scriptURL&&t.getServiceWorker(r).scriptURL&&t.getServiceWorker(r).scriptURL.indexOf(t.config.serviceWorkerFile)<0&&t.getServiceWorker(r).scriptURL.indexOf("cleverpush")<0&&r.pushManager.getSubscription().then((function(e){g.cM.debug("unsubscribing:",e),e&&(e.unsubscribe(),t.migratedSubscription=!0)}))}))}))}},{key:"tryWorkerUpdate",value:function(e){var t=this;this.tryWorkerUpdateCalled||(this.tryWorkerUpdateCalled=!0,(0,g.tI)("tryWorkerUpdate",e),this.storageManager.checkIfShouldUpdateWorker().then((function(r){e&&r&&(g.cM.debug("updating worker now"),e.update(),t.storageManager.setWorkerUpdated())})),this.unregisterOtherPushSubscriptionsCalled||(this.unregisterOtherPushSubscriptionsCalled=!0,this.unregisterOtherPushSubscriptions(e)))}},{key:"sync",value:function(e,t){var r=this;(0,g.tI)("sync",e);var n=void 0!==t?t:this.topics;return new Promise((function(t){if(r.syncInProgress)return g.cM.debug("sync: resolved because syncInProgress was true"),void t();r.syncInProgress=!0;var i=e;r.getSubscriptionId().then((function(e){var o=function(){var o={};e&&(o.subscriptionId=e),r.existingPermission&&(o.existingPermission=!0),r.isReSubscribe&&(o.isReSubscribe=!0),r.migratedSubscription&&(o.migratedSubscription=!0),r.api.syncSubscription(i,n,r.initialTags,o).then((function(e){var n=e.id;if((r.initialTags||[]).length&&r.storageManager.setTags(r.initialTags),r.initialTags=[],r.storageManager.setSubscribed(n),r.iframeMessenger&&r.iframeMessenger.setSubscribed(n),r.storageManager.setSynced(),(e.topics||[]).length&&r.storageManager.setTopics(e.topics),e.topics&&r.triggerEvent(v.Z.TOPICS_SET),e.topicsVersion)try{localStorage.setItem("cleverpush-topics-version","".concat(e.topicsVersion))}catch(e){}r.config.channelTags&&r.config.channelTags.length&&!r.existingPermission&&!o.subscriptionId&&r.config.channelTags.forEach((function(e){e.autoAssignOptInPath&&new RegExp(e.autoAssignOptInPath).test(location.pathname)&&CleverPush.tagSubscription(e._id)})),r.syncInProgress=!1,t()})).catch((function(e){void 0!==e?404===e?(r.storageManager.setUnsubscribed(!0),r.iframeMessenger&&r.iframeMessenger.setUnsubscribed(!0),r.hasNotificationPermission((function(e){e&&r.subscribe()}))):g.cM.error(e):g.cM.error("Unknown Error occured while syncing"),r.syncInProgress=!1,t()}))};void 0!==i&&i||(i=e)?o():(r.syncInProgress=!1,t())})).catch((function(e){r.syncInProgress=!1}))}))}},{key:"getSubscriptionId",value:function(){var e=this.storageManager.getSubscriptionId();return e?g.cM.debug("subscriptionId",e):g.cM.debug("subscriptionId not found"),Promise.resolve(e)}},{key:"hasNotificationPermission",value:function(){return"PREVIEW"===this.config.env?Promise.resolve(!1):Promise.resolve("granted"===window.Notification.permission)}},{key:"getNotificationPermission",value:function(e){try{if("Firefox"===b.Xh.name&&"denied"===sessionStorage.getItem("cleverpush-subscription-status")&&void 0===e)return"denied"}catch(e){}return window.Notification.permission}},{key:"setConfirm",value:function(e){this.confirm=e}},{key:"setTopics",value:function(e){return g.cM.debug("setTopics",e),this.topics=e,this.storageManager.setTopics(e)}},{key:"getTopics",value:function(){return this.storageManager.getTopics()}},{key:"getTags",value:function(){return this.storageManager.getTags()}},{key:"hasNotificationsStoredInBrowserDb",value:function(){return this.storageManager.hasNotificationsStoredInBrowserDb()}},{key:"getDeliveredNotifications",value:function(){return this.storageManager.getNotifications(100)}},{key:"getStoredNotifications",value:(t=(0,s.Z)(i().mark((function e(){var t,r,n,s,a;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t="/channel/".concat(this.api.channelId,"/received-notifications"),e.next=3,this.getSubscriptionId();case 3:return(r=e.sent)&&(t+="?subscriptionId=".concat(r)),e.prev=5,e.next=8,this.getTopics();case 8:return n=e.sent,e.next=11,this.getTags();case 11:return s=e.sent,n&&n.length&&(t+="".concat(t.includes("?")?"&":"?").concat((0,o.Z)(new Set(n)).sort().map((function(e){return"topics[]=".concat(e)})).join("&"))),s&&s.length&&(t+="".concat(t.includes("?")?"&":"?").concat((0,o.Z)(new Set(s)).sort().map((function(e){return"tags[]=".concat(e)})).join("&"))),e.next=16,this.api.request("GET",t);case 16:if(!(a=e.sent)||!a.notifications){e.next=19;break}return e.abrupt("return",a.notifications.filter((function(e){return e.createdAt})).sort((function(e,t){return new Date(t.createdAt)-new Date(e.createdAt)})).map((function(e){return S(S({},e),{},{title:e.title||(e.testVariants&&e.testVariants.length&&e.testVariants[0]?e.testVariants[0].title:""),text:e.text||(e.testVariants&&e.testVariants.length&&e.testVariants[0]?e.testVariants[0].text:""),mediaUrl:e.mediaUrl||(e.testVariants&&e.testVariants.length&&e.testVariants[0]?e.testVariants[0].mediaUrl:""),url:e.url||(e.testVariants&&e.testVariants.length&&e.testVariants[0]?e.testVariants[0].url:"")})})));case 19:return e.abrupt("return",[]);case 22:return e.prev=22,e.t0=e.catch(5),console.error(e.t0),e.abrupt("return",[]);case 26:case"end":return e.stop()}}),e,this,[[5,22]])}))),function(){return t.apply(this,arguments)})},{key:"deleteStoredNotification",value:function(e){var t=this;return new Promise((function(r,n){t.storageManager.db?t.storageManager.deleteNotification(e).then((function(){r()})).catch((function(e){n(e)})):r()}))}},{key:"getPushManagerSubscribeOptions",value:function(){var e={userVisibleOnly:!0};if(this.config.vapidPublicKey&&this.config.vapidPublicKey.length){var t=(0,f.M)(this.config.vapidPublicKey);t&&(e.applicationServerKey=t)}return e}},{key:"setClickedNotification",value:function(e){return this.storageManager.setClickedNotification(e),Promise.resolve()}},{key:"getClickedNotification",value:function(){var e=this;return new Promise((function(t){t(e.storageManager.getClickedNotification())}))}}]),e}()},7546:function(e,t,r){"use strict";function n(e){for(var t=(e+"=".repeat((4-e.length%4)%4)).replace(/\-/g,"+").replace(/_/g,"/"),r=atob(t),n=new Uint8Array(r.length),i=0;i<r.length;++i)n[i]=r.charCodeAt(i);return n}r.d(t,{M:function(){return n}})}}]);
//# sourceMappingURL=4005.6f562922d9c9f546bc3d.js.map
</script>

</body>
</html>
