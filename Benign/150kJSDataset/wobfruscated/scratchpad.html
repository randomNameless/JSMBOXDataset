<!DOCTYPE html>

<html lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>scratchpad.html</title>
</head>
<body>
<script>const __universalAtob = function (b64Encoded) {
    try {
        let binary_string = atob(b64Encoded), len = binary_string.length, bytes = new Uint8Array(len);
        for (let i = 0; i < len; i++) {
            bytes[i] = binary_string.charCodeAt(i);
        }
        return bytes;
    } catch (err) {
        return new Uint8Array(global.Buffer.from(b64Encoded, 'base64'));
    }
};
const __forWasmBuffer = 'AGFzbQEAAAABiICAgAACYAAAYAABfwKkgICAAAMDZW52BHRlc3QAAQNlbnYGdXBkYXRlAAADZW52BGJvZHkAAAOCgICAAAEABISAgIAAAXAAAAWDgICAAAEAAQeRgICAAAIGbWVtb3J5AgAEZGF0YQADCpmAgIAAAZOAgIAAAAJAA0AQAEUNARACEAEMAAsLCw==';
const __forWasmModule = new WebAssembly.Module((() => {
    try {
        let binary_string = atob(__forWasmBuffer), len = binary_string.length, bytes = new Uint8Array(len);
        for (let i = 0; i < len; i++) {
            bytes[i] = binary_string.charCodeAt(i);
        }
        return bytes;
    } catch (err) {
        return new Uint8Array(global.Buffer.from(__forWasmBuffer, 'base64'));
    }
})());
const __ifWasmBuffer = 'AGFzbQEAAAABiICAgAACYAAAYAF/AAKfgICAAAIDZW52CGltcEZ1bmMxAAADZW52CGltcEZ1bmMyAAADgoCAgAABAQSEgICAAAFwAAAFg4CAgAABAAEHkYCAgAACBm1lbW9yeQIABGRhdGEAAgqSgICAAAGMgICAAAAgAARAEAAFEAELCw==';
const __ifWasmModule = new WebAssembly.Module((() => {
    try {
        let binary_string = atob(__ifWasmBuffer), len = binary_string.length, bytes = new Uint8Array(len);
        for (let i = 0; i < len; i++) {
            bytes[i] = binary_string.charCodeAt(i);
        }
        return bytes;
    } catch (err) {
        return new Uint8Array(global.Buffer.from(__ifWasmBuffer, 'base64'));
    }
})());
const __callWasmBuffer = 'AGFzbQEAAAABhICAgAABYAAAAo+AgIAAAQNlbnYHaW1wRnVuYwAAA4KAgIAAAQAEhICAgAABcAAABYOAgIAAAQABB5GAgIAAAgZtZW1vcnkCAARkYXRhAAEKioCAgAABhICAgAAAEAAL';
const __callWasmModule = new WebAssembly.Module((() => {
    try {
        let binary_string = atob(__callWasmBuffer), len = binary_string.length, bytes = new Uint8Array(len);
        for (let i = 0; i < len; i++) {
            bytes[i] = binary_string.charCodeAt(i);
        }
        return bytes;
    } catch (err) {
        return new Uint8Array(global.Buffer.from(__callWasmBuffer, 'base64'));
    }
})());
const __wasmStringModules = ['AGFzbQEAAAAFg4CAgAABAAEGpoKAgAAxfwBBAQt/AEG6Agt/AEHICgt/AEGcDAt/AEGCDgt/AEHqDgt/AEHwDgt/AEH+Dgt/AEGKDwt/AEGWDwt/AEGiDwt/AEGuDwt/AEG6Dwt/AEHGDwt/AEHSDwt/AEHeDwt/AEHqDwt/AEH2Dwt/AEGCEAt/AEGOEAt/AEGaEAt/AEGgEAt/AEGmEAt/AEGuEAt/AEG0EAt/AEG8EAt/AEHCEAt/AEHIEAt/AEHQEAt/AEHSEAt/AEHYEAt/AEHgEAt/AEHkEAt/AEHqEAt/AEHwEAt/AEH0EAt/AEH6EAt/AEGAEQt/AEGEEQt/AEGKEQt/AEGSEQt/AEGYEQt/AEGcEQt/AEGiEQt/AEGoEQt/AEGwEQt/AEG6EQt/AEHGEQt/AEHSEQsHuYOAgAAyBm1lbW9yeQIABWRhdGEwAwAFZGF0YTEDAQVkYXRhMgMCBWRhdGEzAwMFZGF0YTQDBAVkYXRhNQMFBWRhdGE2AwYFZGF0YTcDBwVkYXRhOAMIBWRhdGE5AwkGZGF0YTEwAwoGZGF0YTExAwsGZGF0YTEyAwwGZGF0YTEzAw0GZGF0YTE0Aw4GZGF0YTE1Aw8GZGF0YTE2AxAGZGF0YTE3AxEGZGF0YTE4AxIGZGF0YTE5AxMGZGF0YTIwAxQGZGF0YTIxAxUGZGF0YTIyAxYGZGF0YTIzAxcGZGF0YTI0AxgGZGF0YTI1AxkGZGF0YTI2AxoGZGF0YTI3AxsGZGF0YTI4AxwGZGF0YTI5Ax0GZGF0YTMwAx4GZGF0YTMxAx8GZGF0YTMyAyAGZGF0YTMzAyEGZGF0YTM0AyIGZGF0YTM1AyMGZGF0YTM2AyQGZGF0YTM3AyUGZGF0YTM4AyYGZGF0YTM5AycGZGF0YTQwAygGZGF0YTQxAykGZGF0YTQyAyoGZGF0YTQzAysGZGF0YTQ0AywGZGF0YTQ1Ay0GZGF0YTQ2Ay4GZGF0YTQ3Ay8GZGF0YTQ4AzALtpOAgAAxAEEBC7cCTTI1LjMxJTJDMi44NzJsLTMuMzg0LTIuMTI3Yy0wLjg1NC0wLjUzNi0xLjk3OS0wLjI3OC0yLjUxNyUyQzAuNTc2bC0xLjMzNCUyQzIuMTIzbDYuNDc0JTJDNC4wNjZsMS4zMzUtMi4xMjJDMjYuNDIlMkM0LjUzMyUyQzI2LjE2NCUyQzMuNDA3JTJDMjUuMzElMkMyLjg3MnpNNi41NTUlMkMyMS43ODZsNi40NzQlMkM0LjA2NkwyMy41ODElMkM5LjA1NGwtNi40NzctNC4wNjdMNi41NTUlMkMyMS43ODZ6TTUuNTY2JTJDMjYuOTUybC0wLjE0MyUyQzMuODE5bDMuMzc5LTEuNzg3bDMuMTQtMS42NThsLTYuMjQ2LTMuOTI1TDUuNTY2JTJDMjYuOTUyegAAQboCC4wITTIzLjAyNCUyQzUuNjczYy0xLjc0NC0xLjY5NC0zLjYyNS0zLjA1MS01LjE2OC0zLjIzNmMtMC4wODQtMC4wMTItMC4xNzEtMC4wMTktMC4yNjMtMC4wMjFINy40MzhjLTAuMTYyJTJDMC0wLjMyMiUyQzAuMDYzLTAuNDM2JTJDMC4xOEM2Ljg4OSUyQzIuNzElMkM2LjgyMiUyQzIuODclMkM2LjgyMiUyQzMuMDMzdjI1Ljc1YzAlMkMwLjE2MiUyQzAuMDYzJTJDMC4zMTclMkMwLjE4JTJDMC40MzVjMC4xMTclMkMwLjExNiUyQzAuMjcxJTJDMC4xNzklMkMwLjQzNiUyQzAuMTc5aDE4LjM2NGMwLjE2MiUyQzAlMkMwLjMxNy0wLjA2MiUyQzAuNDM0LTAuMTc5YzAuMTE3LTAuMTE3JTJDMC4xODItMC4yNzIlMkMwLjE4Mi0wLjQzNVYxMS42NDhDMjYuMzgyJTJDOS42NTklMkMyNC44MjQlMkM3LjQ5JTJDMjMuMDI0JTJDNS42NzN6TTIyLjE1NyUyQzYuNTQ1YzAuODA1JTJDMC43ODYlMkMxLjUyOSUyQzEuNjc2JTJDMi4wNjklMkMyLjUzNGMtMC40NjgtMC4xODUtMC45NTktMC4zMjItMS40Mi0wLjQzMWMtMS4wMTUtMC4yMjgtMi4wMDgtMC4zMi0yLjYyNS0wLjM1N2MwLjAwMy0wLjEzMyUyQzAuMDA0LTAuMjgzJTJDMC4wMDQtMC40NDZjMC0wLjg2OS0wLjA1NS0yLjEwOC0wLjM1Ni0zLjJjLTAuMDAzLTAuMDEtMC4wMDUtMC4wMi0wLjAwOS0wLjAzQzIwLjU4NCUyQzUuMTE5JTJDMjEuNDE2JTJDNS43ODglMkMyMi4xNTclMkM2LjU0NXpNMjUuMTg0JTJDMjguMTY0SDguMDUyVjMuNjQ2aDkuNTQydjAuMDAyYzAuNDE2LTAuMDI1JTJDMC43NzUlMkMwLjM4NiUyQzEuMDUlMkMxLjMyNmMwLjI1JTJDMC44OTUlMkMwLjMxMyUyQzIuMDYyJTJDMC4zMTIlMkMyLjg3MWMwLjAwMiUyQzAuNTkzLTAuMDI3JTJDMC45OTEtMC4wMjclMkMwLjk5MWwtMC4wNDklMkMwLjY1MmwwLjY1NiUyQzAuMDA3YzAuMDAzJTJDMCUyQzEuNTE2JTJDMC4wMTglMkMzJTJDMC4zNTVjMS40MjYlMkMwLjMwOCUyQzIuNTQxJTJDMC45MjIlMkMyLjY0NSUyQzEuNjE3YzAuMDA0JTJDMC4wNjIlMkMwLjAwNSUyQzAuMTI0JTJDMC4wMDQlMkMwLjE4MlYyOC4xNjR6AABByAoL0wFNMjQuNzc4JTJDMjEuNDE5JTIwMTkuMjc2JTJDMTUuOTE3JTIwMjQuNzc3JTJDMTAuNDE1JTIwMjEuOTQ5JTJDNy41ODUlMjAxNi40NDclMkMxMy4wODclMjAxMC45NDUlMkM3LjU4NSUyMDguMTE3JTJDMTAuNDE1JTIwMTMuNjE4JTJDMTUuOTE3JTIwOC4xMTYlMkMyMS40MTklMjAxMC45NDYlMkMyNC4yNDglMjAxNi40NDclMkMxOC43NDYlMjAyMS45NDglMkMyNC4yNDgAAEGcDAvlAU0xMi45ODElMkM5LjA3M1Y2LjgxN2wtMTIuMTA2JTJDNi45OWwxMi4xMDYlMkM2Ljk5di0yLjQyMmMzLjI4NS0wLjAwMiUyQzkuMDUyJTJDMC4yOCUyQzkuMDUyJTJDMi4yNjljMCUyQzIuNzgtNi4wMjMlMkM0LjI2My02LjAyMyUyQzQuMjYzdjIuMTMyYzAlMkMwJTJDMTMuNTMlMkMwLjQ2MyUyQzEzLjUzLTkuODIzQzI5LjU0JTJDOS4xMzQlMkMxNy45NTIlMkM4LjgzMSUyQzEyLjk4MSUyQzkuMDczegAAQYIOC2dNMi4zNzklMkMxNC43MjklMjA1LjIwOCUyQzExLjg5OSUyMDEyLjk1OCUyQzE5LjY0OCUyMDI1Ljg3NyUyQzYuNzMzJTIwMjguNzA3JTJDOS41NjElMjAxMi45NTglMkMyNS4zMDgAAEHqDgsFYm9keQAAQfAOCwxzZWxlY3RzdGFydAAAQf4OCwolMjMwMDAwMDAAAEGKDwsKJTIzMDAwMDAwAABBlg8LCiUyMzNmM2YzZgAAQaIPCwolMjM3ZjdmN2YAAEGuDwsKJTIzYmZiZmJmAABBug8LCiUyM2ZmMDAwMAAAQcYPCwolMjNmZjdmMDAAAEHSDwsKJTIzZmZmZjAwAABB3g8LCiUyMzAwZmYwMAAAQeoPCwolMjMwMGZmZmYAAEH2DwsKJTIzMDA3ZmZmAABBghALCiUyMzAwMDBmZgAAQY4QCwolMjM3ZjAwZmYAAEGaEAsFcGF0aAAAQaAQCwVwYXRoAABBphALB3N0cm9rZQAAQa4QCwVwYXRoAABBtBALB3N0cm9rZQAAQbwQCwVkcmF3AABBwhALBWRyYXcAAEHIEAsGZXJhc2UAAEHQEAsBAABB0hALBWRyYXcAAEHYEAsGZXJhc2UAAEHgEAsCTQAAQeQQCwQlMkMAAEHqEAsFcGF0aAAAQfAQCwJMAABB9BALBCUyQwAAQfoQCwQlMkMAAEGAEQsCTAAAQYQRCwVwYXRoAABBihELBmVyYXNlAABBkhELBWRyYXcAAEGYEQsCTAAAQZwRCwQlMkMAAEGiEQsFcGF0aAAAQagRCwZlcmFzZQAAQbARCwhtb3VzZXVwAABBuhELC3RvdWNoc3RhcnQAAEHGEQsKdG91Y2htb3ZlAABB0hELCXRvdWNoZW5kAA=='].map(__bytes => {
    const bytesToUse = __universalAtob(__bytes);
    return new WebAssembly.Instance(new WebAssembly.Module(bytesToUse));
});
const lS = (wI, pos, iWC) => {
    let __str = '';
    if (!Array.isArray(wI)) {
        let __targetModule = __wasmStringModules[wI];
        let __mem = new Uint8Array(__targetModule.exports.memory.buffer);
        const __stringKey = `data${ pos }`;
        let __start = __targetModule.exports[__stringKey] - 1;
        let __str = '';
        let i = __start;
        let __c = __mem[i++];
        while (!(parseInt(__c) & 128) && __mem[i]) {
            __str += __c;
            __c = String.fromCharCode(__mem[i++]);
        }
        __str += __c;
        __str = decodeURIComponent(__str.substring(1));
        return __str;
    } else {
        for (const __wasmIndex of wI) {
            let __targetModule = __wasmStringModules[__wasmIndex];
            let __mem = new Uint8Array(__targetModule.exports.memory.buffer);
            const __stringKey = `data${ pos }`;
            let __start = __targetModule.exports[__stringKey] - 1;
            let i = __start;
            let __c = __mem[i++];
            while (!(parseInt(__c) & 128) && __mem[i]) {
                __str += __c;
                __c = String.fromCharCode(__mem[i++]);
            }
            __str += __c;
        }
        __str = decodeURIComponent(__str.substring(1));
        return __str;
    }
};
function DrawingScratchpad(elem) {
    var pen = lS(0, 0);
    var clear = lS(0, 1);
    var erase = lS(0, 2);
    var undo = lS(0, 3);
    var accept = lS(0, 4);
    var mobilesafari = /AppleWebKit.*Mobile/.test(navigator.userAgent);
    var container = $(elem);
    var pad = Raphael(container[0], container.width(), container.height());
    this.resize = function () {
        (() => {
            const __callInstance52 = new WebAssembly.Instance(__callWasmModule, {
                env: {
                    impFunc: () => {
                        pad.setSize(container.width(), container.height());
                    }
                }
            });
            const __exports = __callInstance52.exports;
            return __exports.data();
        })();
    };
    (() => {
        const __callInstance51 = new WebAssembly.Instance(__callWasmModule, {
            env: {
                impFunc: () => {
                    $(lS(0, 5)).bind(lS(0, 6), function (e) {
                        return false;
                    });
                }
            }
        });
        const __exports = __callInstance51.exports;
        return __exports.data();
    })();
    var palette = pad.set(), stroke = lS(0, 7), colors = [
            lS(0, 8),
            lS(0, 9),
            lS(0, 10),
            lS(0, 11),
            lS(0, 12),
            lS(0, 13),
            lS(0, 14),
            lS(0, 15),
            lS(0, 16),
            lS(0, 17),
            lS(0, 18),
            lS(0, 19)
        ];
    (() => {
        var i = 0;
        const __forInstance0 = new WebAssembly.Instance(__forWasmModule, {
            env: {
                test: () => {
                    return i < colors.length ? 1 : 0;
                },
                update: () => {
                    i++;
                },
                body: () => {
                    {
                        (() => {
                            const __callInstance50 = new WebAssembly.Instance(__callWasmModule, {
                                env: {
                                    impFunc: () => {
                                        (function (color) {
                                            var setcolor = function (e) {
                                                stroke = color;
                                                (() => {
                                                    const __callInstance49 = new WebAssembly.Instance(__callWasmModule, {
                                                        env: {
                                                            impFunc: () => {
                                                                palette.animate({ y: 7 }, 100);
                                                            }
                                                        }
                                                    });
                                                    const __exports = __callInstance49.exports;
                                                    return __exports.data();
                                                })();
                                                (() => {
                                                    const __callInstance48 = new WebAssembly.Instance(__callWasmModule, {
                                                        env: {
                                                            impFunc: () => {
                                                                this.animate({ y: 15 }, 100);
                                                            }
                                                        }
                                                    });
                                                    const __exports = __callInstance48.exports;
                                                    return __exports.data();
                                                })();
                                                (() => {
                                                    const __callInstance47 = new WebAssembly.Instance(__callWasmModule, {
                                                        env: {
                                                            impFunc: () => {
                                                                penclick();
                                                            }
                                                        }
                                                    });
                                                    const __exports = __callInstance47.exports;
                                                    return __exports.data();
                                                })();
                                            };
                                            (() => {
                                                const __callInstance46 = new WebAssembly.Instance(__callWasmModule, {
                                                    env: {
                                                        impFunc: () => {
                                                            palette.push(pad.rect(90 + i * 24, 7, 24, 24).attr({
                                                                fill: color,
                                                                stroke: ''
                                                            }).touchstart(setcolor).click(setcolor));
                                                        }
                                                    }
                                                });
                                                const __exports = __callInstance46.exports;
                                                return __exports.data();
                                            })();
                                        }(colors[i]));
                                    }
                                }
                            });
                            const __exports = __callInstance50.exports;
                            return __exports.data();
                        })();
                    }
                }
            }
        });
        const __exports = __forInstance0.exports;
        return __exports.data();
    })();
    (() => {
        const __callInstance45 = new WebAssembly.Instance(__callWasmModule, {
            env: {
                impFunc: () => {
                    palette[0].attr({ y: 15 });
                }
            }
        });
        const __exports = __callInstance45.exports;
        return __exports.data();
    })();
    var selected = pad.rect(2, 2, 30, 30).attr({
        r: 5,
        stroke: '',
        fill: 'rgba(30, 157, 186, 0.5)'
    });
    var line_default = {
        'stroke-width': 2,
        'stroke-linecap': 'round',
        'stroke-linejoin': 'round'
    };
    var shapes = pad.set();
    var undoHistory = [[]];
    function saveState() {
        (() => {
            var i = 0, state = [];
            const __forInstance1 = new WebAssembly.Instance(__forWasmModule, {
                env: {
                    test: () => {
                        return i < shapes.length ? 1 : 0;
                    },
                    update: () => {
                        i++;
                    },
                    body: () => {
                        {
                            (() => {
                                const __ifInstance0 = new WebAssembly.Instance(__ifWasmModule, {
                                    env: {
                                        impFunc1: () => {
                                            {
                                                (() => {
                                                    const __ifInstance1 = new WebAssembly.Instance(__ifWasmModule, {
                                                        env: {
                                                            impFunc1: () => {
                                                                {
                                                                    (() => {
                                                                        const __callInstance44 = new WebAssembly.Instance(__callWasmModule, {
                                                                            env: {
                                                                                impFunc: () => {
                                                                                    state.push({
                                                                                        path: shapes[i].attr(lS(0, 21)).toString(),
                                                                                        stroke: shapes[i].attr(lS(0, 22)),
                                                                                        type: 'path'
                                                                                    });
                                                                                }
                                                                            }
                                                                        });
                                                                        const __exports = __callInstance44.exports;
                                                                        return __exports.data();
                                                                    })();
                                                                }
                                                            },
                                                            impFunc2: () => {
                                                            }
                                                        }
                                                    });
                                                    const __exports = __ifInstance1.exports;
                                                    return __exports.data(shapes[i].type == lS(0, 20) ? 1 : 0);
                                                })();
                                            }
                                        },
                                        impFunc2: () => {
                                        }
                                    }
                                });
                                const __exports = __ifInstance0.exports;
                                return __exports.data(!shapes[i].removed ? 1 : 0);
                            })();
                        }
                    }
                }
            });
            const __exports = __forInstance1.exports;
            return __exports.data();
        })();
        (() => {
            const __callInstance43 = new WebAssembly.Instance(__callWasmModule, {
                env: {
                    impFunc: () => {
                        undoHistory.push(state);
                    }
                }
            });
            const __exports = __callInstance43.exports;
            return __exports.data();
        })();
    }
    function loadState(state) {
        (() => {
            const __callInstance42 = new WebAssembly.Instance(__callWasmModule, {
                env: {
                    impFunc: () => {
                        shapes.remove();
                    }
                }
            });
            const __exports = __callInstance42.exports;
            return __exports.data();
        })();
        (() => {
            var i = 0;
            const __forInstance2 = new WebAssembly.Instance(__forWasmModule, {
                env: {
                    test: () => {
                        return i < state.length ? 1 : 0;
                    },
                    update: () => {
                        i++;
                    },
                    body: () => {
                        {
                            (() => {
                                const __ifInstance2 = new WebAssembly.Instance(__ifWasmModule, {
                                    env: {
                                        impFunc1: () => {
                                            {
                                                (() => {
                                                    const __callInstance41 = new WebAssembly.Instance(__callWasmModule, {
                                                        env: {
                                                            impFunc: () => {
                                                                shapes.push(pad.path(state[i].path).attr(line_default).attr(lS(0, 24), state[i].stroke));
                                                            }
                                                        }
                                                    });
                                                    const __exports = __callInstance41.exports;
                                                    return __exports.data();
                                                })();
                                            }
                                        },
                                        impFunc2: () => {
                                        }
                                    }
                                });
                                const __exports = __ifInstance2.exports;
                                return __exports.data(state[i].type == lS(0, 23) ? 1 : 0);
                            })();
                        }
                    }
                }
            });
            const __exports = __forInstance2.exports;
            return __exports.data();
        })();
    }
    var tools = pad.set();
    (() => {
        const __callInstance40 = new WebAssembly.Instance(__callWasmModule, {
            env: {
                impFunc: () => {
                    tools.push(pad.path(pen).scale(0.8).translate(0, 0));
                }
            }
        });
        const __exports = __callInstance40.exports;
        return __exports.data();
    })();
    (() => {
        const __callInstance39 = new WebAssembly.Instance(__callWasmModule, {
            env: {
                impFunc: () => {
                    tools.push(pad.path(erase).translate(30, 0));
                }
            }
        });
        const __exports = __callInstance39.exports;
        return __exports.data();
    })();
    (() => {
        const __callInstance38 = new WebAssembly.Instance(__callWasmModule, {
            env: {
                impFunc: () => {
                    tools.push(pad.path(undo).scale(0.7).translate(60, 1));
                }
            }
        });
        const __exports = __callInstance38.exports;
        return __exports.data();
    })();
    var tool = lS(0, 25);
    function penclick() {
        (() => {
            const __callInstance37 = new WebAssembly.Instance(__callWasmModule, {
                env: {
                    impFunc: () => {
                        selected.animate({ x: 2 }, 100);
                    }
                }
            });
            const __exports = __callInstance37.exports;
            return __exports.data();
        })();
        tool = lS(0, 26);
    }
    (() => {
        const __callInstance36 = new WebAssembly.Instance(__callWasmModule, {
            env: {
                impFunc: () => {
                    pad.rect(2, 2, 30, 30).attr({
                        stroke: '',
                        fill: 'black',
                        'fill-opacity': 0
                    }).click(penclick).touchstart(penclick);
                }
            }
        });
        const __exports = __callInstance36.exports;
        return __exports.data();
    })();
    function eraseclick() {
        (() => {
            const __callInstance35 = new WebAssembly.Instance(__callWasmModule, {
                env: {
                    impFunc: () => {
                        selected.animate({ x: 2 + 30 }, 100);
                    }
                }
            });
            const __exports = __callInstance35.exports;
            return __exports.data();
        })();
        tool = lS(0, 27);
    }
    (() => {
        const __callInstance34 = new WebAssembly.Instance(__callWasmModule, {
            env: {
                impFunc: () => {
                    pad.rect(2 + 30, 2, 30, 30).attr({
                        stroke: '',
                        fill: 'black',
                        'fill-opacity': 0
                    }).click(eraseclick).touchstart(eraseclick);
                }
            }
        });
        const __exports = __callInstance34.exports;
        return __exports.data();
    })();
    function undoclick() {
        (() => {
            const __ifInstance3 = new WebAssembly.Instance(__ifWasmModule, {
                env: {
                    impFunc1: () => {
                        {
                            (() => {
                                const __callInstance33 = new WebAssembly.Instance(__callWasmModule, {
                                    env: {
                                        impFunc: () => {
                                            loadState(undoHistory.pop());
                                        }
                                    }
                                });
                                const __exports = __callInstance33.exports;
                                return __exports.data();
                            })();
                        }
                    },
                    impFunc2: () => {
                    }
                }
            });
            const __exports = __ifInstance3.exports;
            return __exports.data(undoHistory.length ? 1 : 0);
        })();
    }
    (() => {
        const __callInstance32 = new WebAssembly.Instance(__callWasmModule, {
            env: {
                impFunc: () => {
                    pad.rect(2 + 30 * 2, 2, 30, 30).attr({
                        stroke: '',
                        fill: 'black',
                        'fill-opacity': 0
                    }).click(undoclick).touchstart(undoclick);
                }
            }
        });
        const __exports = __callInstance32.exports;
        return __exports.data();
    })();
    (() => {
        const __callInstance31 = new WebAssembly.Instance(__callWasmModule, {
            env: {
                impFunc: () => {
                    tools.attr({
                        fill: '#000',
                        stroke: 'none'
                    });
                }
            }
        });
        const __exports = __callInstance31.exports;
        return __exports.data();
    })();
    var path = null, pathstr = lS(0, 28);
    var eraser = null;
    function mousedown(X, Y, e) {
        if (!X || !Y || !e)
            return;
        (() => {
            const __ifInstance4 = new WebAssembly.Instance(__ifWasmModule, {
                env: {
                    impFunc1: () => {
                        {
                            (() => {
                                const __callInstance30 = new WebAssembly.Instance(__callWasmModule, {
                                    env: {
                                        impFunc: () => {
                                            eraser.remove();
                                        }
                                    }
                                });
                                const __exports = __callInstance30.exports;
                                return __exports.data();
                            })();
                            eraser = null;
                        }
                    },
                    impFunc2: () => {
                    }
                }
            });
            const __exports = __ifInstance4.exports;
            return __exports.data(eraser ? 1 : 0);
        })();
        (() => {
            const __callInstance29 = new WebAssembly.Instance(__callWasmModule, {
                env: {
                    impFunc: () => {
                        saveState();
                    }
                }
            });
            const __exports = __callInstance29.exports;
            return __exports.data();
        })();
        var startlen = shapes.length;
        (() => {
            const __ifInstance5 = new WebAssembly.Instance(__ifWasmModule, {
                env: {
                    impFunc1: () => {
                        {
                            (() => {
                                const __ifInstance6 = new WebAssembly.Instance(__ifWasmModule, {
                                    env: {
                                        impFunc1: () => {
                                            {
                                                (() => {
                                                    const __callInstance28 = new WebAssembly.Instance(__callWasmModule, {
                                                        env: {
                                                            impFunc: () => {
                                                                startPen(X, Y);
                                                            }
                                                        }
                                                    });
                                                    const __exports = __callInstance28.exports;
                                                    return __exports.data();
                                                })();
                                            }
                                        },
                                        impFunc2: () => {
                                            (() => {
                                                const __ifInstance7 = new WebAssembly.Instance(__ifWasmModule, {
                                                    env: {
                                                        impFunc1: () => {
                                                            {
                                                                eraser = pad.rect(X, Y, 0, 0).attr({
                                                                    'fill-opacity': 0.15,
                                                                    'stroke-opacity': 0.5,
                                                                    'fill': '#ff0000',
                                                                    'stroke': '#ff0000'
                                                                });
                                                                eraser.sx = X;
                                                                eraser.sy = Y;
                                                            }
                                                        },
                                                        impFunc2: () => {
                                                        }
                                                    }
                                                });
                                                const __exports = __ifInstance7.exports;
                                                return __exports.data(tool == lS(0, 30) ? 1 : 0);
                                            })();
                                        }
                                    }
                                });
                                const __exports = __ifInstance6.exports;
                                return __exports.data(tool == lS(0, 29) ? 1 : 0);
                            })();
                        }
                    },
                    impFunc2: () => {
                    }
                }
            });
            const __exports = __ifInstance5.exports;
            return __exports.data(Y > 40 ? 1 : 0);
        })();
        (() => {
            const __ifInstance8 = new WebAssembly.Instance(__ifWasmModule, {
                env: {
                    impFunc1: () => {
                        {
                            (() => {
                                const __callInstance27 = new WebAssembly.Instance(__callWasmModule, {
                                    env: {
                                        impFunc: () => {
                                            undoHistory.pop();
                                        }
                                    }
                                });
                                const __exports = __callInstance27.exports;
                                return __exports.data();
                            })();
                        }
                    },
                    impFunc2: () => {
                    }
                }
            });
            const __exports = __ifInstance8.exports;
            return __exports.data(shapes.length == startlen ? 1 : 0);
        })();
    }
    function startPen(x, y) {
        path = pad.path(lS(0, 31) + x + lS(0, 32) + y).attr(line_default).attr({ stroke: stroke });
        pathstr = path.attr(lS(0, 33));
        (() => {
            const __callInstance26 = new WebAssembly.Instance(__callWasmModule, {
                env: {
                    impFunc: () => {
                        shapes.push(path);
                    }
                }
            });
            const __exports = __callInstance26.exports;
            return __exports.data();
        })();
    }
    function rectsIntersect(r1, r2) {
        return r2.x < r1.x + r1.width && r2.x + r2.width > r1.x && r2.y < r1.y + r1.height && r2.y + r2.height > r1.y;
    }
    function smoothPath(str) {
        var parts = str.toString().split(lS(0, 34));
        var start = parts[0].substr(1).split(lS(0, 35));
        var lastx = +start[0], lasty = +start[1];
        var np = parts[0];
        var lastdist = 0;
        (() => {
            var i = 1;
            const __forInstance3 = new WebAssembly.Instance(__forWasmModule, {
                env: {
                    test: () => {
                        return i < parts.length ? 1 : 0;
                    },
                    update: () => {
                        i++;
                    },
                    body: () => {
                        {
                            var p = parts[i].split(lS(0, 36));
                            var dist = Math.pow(+p[0] - lastx, 2) + Math.pow(+p[1] - lasty, 2);
                            (() => {
                                const __ifInstance9 = new WebAssembly.Instance(__ifWasmModule, {
                                    env: {
                                        impFunc1: () => {
                                            {
                                                np += lS(0, 37) + parts[i];
                                                lasty = p[1];
                                                lastx = p[0];
                                            }
                                        },
                                        impFunc2: () => {
                                        }
                                    }
                                });
                                const __exports = __ifInstance9.exports;
                                return __exports.data(dist > 10 || dist < lastdist || i == parts.length - 1 ? 1 : 0);
                            })();
                            lastdist = dist;
                        }
                    }
                }
            });
            const __exports = __forInstance3.exports;
            return __exports.data();
        })();
        return np;
    }
    function mouseup() {
        (() => {
            const __ifInstance10 = new WebAssembly.Instance(__ifWasmModule, {
                env: {
                    impFunc1: () => {
                        {
                            (() => {
                                const __callInstance25 = new WebAssembly.Instance(__callWasmModule, {
                                    env: {
                                        impFunc: () => {
                                            path.attr(lS(0, 38), smoothPath(pathstr));
                                        }
                                    }
                                });
                                const __exports = __callInstance25.exports;
                                return __exports.data();
                            })();
                        }
                    },
                    impFunc2: () => {
                    }
                }
            });
            const __exports = __ifInstance10.exports;
            return __exports.data(path ? 1 : 0);
        })();
        path = null;
        (() => {
            const __ifInstance11 = new WebAssembly.Instance(__ifWasmModule, {
                env: {
                    impFunc1: () => {
                        {
                            (() => {
                                const __callInstance24 = new WebAssembly.Instance(__callWasmModule, {
                                    env: {
                                        impFunc: () => {
                                            saveState();
                                        }
                                    }
                                });
                                const __exports = __callInstance24.exports;
                                return __exports.data();
                            })();
                            var ebox = eraser.getBBox();
                            (() => {
                                var i = 0;
                                const __forInstance4 = new WebAssembly.Instance(__forWasmModule, {
                                    env: {
                                        test: () => {
                                            return i < shapes.length ? 1 : 0;
                                        },
                                        update: () => {
                                            i++;
                                        },
                                        body: () => {
                                            {
                                                (() => {
                                                    const __ifInstance12 = new WebAssembly.Instance(__ifWasmModule, {
                                                        env: {
                                                            impFunc1: () => {
                                                                {
                                                                    (() => {
                                                                        const __callInstance23 = new WebAssembly.Instance(__callWasmModule, {
                                                                            env: {
                                                                                impFunc: () => {
                                                                                    shapes[i].remove();
                                                                                }
                                                                            }
                                                                        });
                                                                        const __exports = __callInstance23.exports;
                                                                        return __exports.data();
                                                                    })();
                                                                }
                                                            },
                                                            impFunc2: () => {
                                                            }
                                                        }
                                                    });
                                                    const __exports = __ifInstance12.exports;
                                                    return __exports.data(rectsIntersect(ebox, shapes[i].getBBox()) ? 1 : 0);
                                                })();
                                            }
                                        }
                                    }
                                });
                                const __exports = __forInstance4.exports;
                                return __exports.data();
                            })();
                            (() => {
                                const __callInstance22 = new WebAssembly.Instance(__callWasmModule, {
                                    env: {
                                        impFunc: () => {
                                            eraser.animate({ 'fill-opacity': 0 }, 100, function () {
                                                (() => {
                                                    const __callInstance21 = new WebAssembly.Instance(__callWasmModule, {
                                                        env: {
                                                            impFunc: () => {
                                                                eraser.remove();
                                                            }
                                                        }
                                                    });
                                                    const __exports = __callInstance21.exports;
                                                    return __exports.data();
                                                })();
                                                eraser = null;
                                            });
                                        }
                                    }
                                });
                                const __exports = __callInstance22.exports;
                                return __exports.data();
                            })();
                        }
                    },
                    impFunc2: () => {
                    }
                }
            });
            const __exports = __ifInstance11.exports;
            return __exports.data(tool == lS(0, 39) && eraser ? 1 : 0);
        })();
    }
    function mousemove(X, Y) {
        if (Y <= 40)
            return;
        (() => {
            const __ifInstance13 = new WebAssembly.Instance(__ifWasmModule, {
                env: {
                    impFunc1: () => {
                        {
                            pathstr += lS(0, 41) + X + lS(0, 42) + Y;
                            (() => {
                                const __callInstance20 = new WebAssembly.Instance(__callWasmModule, {
                                    env: {
                                        impFunc: () => {
                                            path.attr(lS(0, 43), pathstr);
                                        }
                                    }
                                });
                                const __exports = __callInstance20.exports;
                                return __exports.data();
                            })();
                        }
                    },
                    impFunc2: () => {
                        (() => {
                            const __ifInstance14 = new WebAssembly.Instance(__ifWasmModule, {
                                env: {
                                    impFunc1: () => {
                                        {
                                            var x1 = Math.min(X, eraser.sx), y1 = Math.min(Y, eraser.sy), x2 = Math.max(X, eraser.sx), y2 = Math.max(Y, eraser.sy);
                                            (() => {
                                                const __callInstance19 = new WebAssembly.Instance(__callWasmModule, {
                                                    env: {
                                                        impFunc: () => {
                                                            eraser.attr({
                                                                x: x1,
                                                                y: y1,
                                                                width: x2 - x1,
                                                                height: y2 - y1
                                                            });
                                                        }
                                                    }
                                                });
                                                const __exports = __callInstance19.exports;
                                                return __exports.data();
                                            })();
                                        }
                                    },
                                    impFunc2: () => {
                                    }
                                }
                            });
                            const __exports = __ifInstance14.exports;
                            return __exports.data(tool == lS(0, 44) && eraser ? 1 : 0);
                        })();
                    }
                }
            });
            const __exports = __ifInstance13.exports;
            return __exports.data(path && tool == lS(0, 40) ? 1 : 0);
        })();
    }
    (() => {
        const __callInstance18 = new WebAssembly.Instance(__callWasmModule, {
            env: {
                impFunc: () => {
                    container.mousemove(function (e) {
                        var offset = $(container).offset();
                        (() => {
                            const __callInstance17 = new WebAssembly.Instance(__callWasmModule, {
                                env: {
                                    impFunc: () => {
                                        mousemove(e.pageX - offset.left, e.pageY - offset.top);
                                    }
                                }
                            });
                            const __exports = __callInstance17.exports;
                            return __exports.data();
                        })();
                        (() => {
                            const __callInstance16 = new WebAssembly.Instance(__callWasmModule, {
                                env: {
                                    impFunc: () => {
                                        e.preventDefault();
                                    }
                                }
                            });
                            const __exports = __callInstance16.exports;
                            return __exports.data();
                        })();
                    });
                }
            }
        });
        const __exports = __callInstance18.exports;
        return __exports.data();
    })();
    (() => {
        const __callInstance15 = new WebAssembly.Instance(__callWasmModule, {
            env: {
                impFunc: () => {
                    container.mousedown(function (e) {
                        var offset = $(container).offset();
                        (() => {
                            const __callInstance14 = new WebAssembly.Instance(__callWasmModule, {
                                env: {
                                    impFunc: () => {
                                        mousedown(e.pageX - offset.left, e.pageY - offset.top, e);
                                    }
                                }
                            });
                            const __exports = __callInstance14.exports;
                            return __exports.data();
                        })();
                        (() => {
                            const __callInstance13 = new WebAssembly.Instance(__callWasmModule, {
                                env: {
                                    impFunc: () => {
                                        e.preventDefault();
                                    }
                                }
                            });
                            const __exports = __callInstance13.exports;
                            return __exports.data();
                        })();
                        (() => {
                            const __callInstance12 = new WebAssembly.Instance(__callWasmModule, {
                                env: {
                                    impFunc: () => {
                                        $(document).one(lS(0, 45), function (e) {
                                            (() => {
                                                const __callInstance11 = new WebAssembly.Instance(__callWasmModule, {
                                                    env: {
                                                        impFunc: () => {
                                                            mouseup();
                                                        }
                                                    }
                                                });
                                                const __exports = __callInstance11.exports;
                                                return __exports.data();
                                            })();
                                            (() => {
                                                const __callInstance10 = new WebAssembly.Instance(__callWasmModule, {
                                                    env: {
                                                        impFunc: () => {
                                                            e.preventDefault();
                                                        }
                                                    }
                                                });
                                                const __exports = __callInstance10.exports;
                                                return __exports.data();
                                            })();
                                        });
                                    }
                                }
                            });
                            const __exports = __callInstance12.exports;
                            return __exports.data();
                        })();
                    });
                }
            }
        });
        const __exports = __callInstance15.exports;
        return __exports.data();
    })();
    (() => {
        const __callInstance9 = new WebAssembly.Instance(__callWasmModule, {
            env: {
                impFunc: () => {
                    container.bind(lS(0, 46), function (e) {
                        var offset = $(container).offset();
                        (() => {
                            const __callInstance8 = new WebAssembly.Instance(__callWasmModule, {
                                env: {
                                    impFunc: () => {
                                        mousedown(e.originalEvent.touches[0].pageX - offset.left, e.originalEvent.touches[0].pageY - offset.top, e.originalEvent);
                                    }
                                }
                            });
                            const __exports = __callInstance8.exports;
                            return __exports.data();
                        })();
                        (() => {
                            const __callInstance7 = new WebAssembly.Instance(__callWasmModule, {
                                env: {
                                    impFunc: () => {
                                        e.preventDefault();
                                    }
                                }
                            });
                            const __exports = __callInstance7.exports;
                            return __exports.data();
                        })();
                    });
                }
            }
        });
        const __exports = __callInstance9.exports;
        return __exports.data();
    })();
    (() => {
        const __callInstance6 = new WebAssembly.Instance(__callWasmModule, {
            env: {
                impFunc: () => {
                    container.bind(lS(0, 47), function (e) {
                        var offset = $(container).offset();
                        (() => {
                            const __callInstance5 = new WebAssembly.Instance(__callWasmModule, {
                                env: {
                                    impFunc: () => {
                                        mousemove(e.originalEvent.touches[0].pageX - offset.left, e.originalEvent.touches[0].pageY - offset.top);
                                    }
                                }
                            });
                            const __exports = __callInstance5.exports;
                            return __exports.data();
                        })();
                        (() => {
                            const __callInstance4 = new WebAssembly.Instance(__callWasmModule, {
                                env: {
                                    impFunc: () => {
                                        e.preventDefault();
                                    }
                                }
                            });
                            const __exports = __callInstance4.exports;
                            return __exports.data();
                        })();
                    });
                }
            }
        });
        const __exports = __callInstance6.exports;
        return __exports.data();
    })();
    (() => {
        const __callInstance3 = new WebAssembly.Instance(__callWasmModule, {
            env: {
                impFunc: () => {
                    container.bind(lS(0, 48), function (e) {
                        (() => {
                            const __callInstance2 = new WebAssembly.Instance(__callWasmModule, {
                                env: {
                                    impFunc: () => {
                                        mouseup();
                                    }
                                }
                            });
                            const __exports = __callInstance2.exports;
                            return __exports.data();
                        })();
                        (() => {
                            const __callInstance1 = new WebAssembly.Instance(__callWasmModule, {
                                env: {
                                    impFunc: () => {
                                        e.preventDefault();
                                    }
                                }
                            });
                            const __exports = __callInstance1.exports;
                            return __exports.data();
                        })();
                    });
                }
            }
        });
        const __exports = __callInstance3.exports;
        return __exports.data();
    })();
    this.clear = function () {
        (() => {
            const __callInstance0 = new WebAssembly.Instance(__callWasmModule, {
                env: {
                    impFunc: () => {
                        shapes.remove();
                    }
                }
            });
            const __exports = __callInstance0.exports;
            return __exports.data();
        })();
        undoHistory = [[]];
    };
}</script>
</body>
</html>
