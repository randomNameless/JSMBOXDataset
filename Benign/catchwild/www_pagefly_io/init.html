<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>init.html</title>
</head>
<body>

<script>
!function(t){var e={};function n(r){if(e[r])return e[r].exports;var o=e[r]={i:r,l:!1,exports:{}};return t[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)n.d(r,o,function(e){return t[e]}.bind(null,o));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=0)}([function(t,e){
/**
 * @version     $Id$
 * @package     PageFly_Affiliate_System
 * @subpackage  Embed
 * @author      PageFly Team <admin@pagefly.io>
 * @copyright   Copyright (C) 2019 PageFly.io. All Rights Reserved.
 * @license     GNU/GPL v2 or later http://www.gnu.org/licenses/gpl-2.0.html
 */
const n={host:"https://partners.pagefly.io/",routes:{capture:["https://apps.pagefly.io/api/public/affiliates/capture-referrer","https://partners.pagefly.io/referral/capture"],add:["https://apps.pagefly.io/api/public/affiliates/track-conversion","https://partners.pagefly.io/referral/add"]},redirect:{"ref=flowio&target=app-listing":"https://shopify.pxf.io/x9G7y1","ref=reconvert&target=app-listing":"https://shopify.pxf.io/9WYXA5","app-listing":"https://apps.shopify.com/pagefly",upgrade:{"&plan=silver":"https://apps.pagefly.io/shopify/select-plan?plan_id=12","&plan=gold":"https://apps.pagefly.io/shopify/select-plan?plan_id=13","&plan=platinum":"https://apps.pagefly.io/shopify/select-plan?plan_id=14"}}},r=window.location.href.match(/^([^?]+).*[?&](ref|forwardRef)=([^&]+)(&target=([^&]+))?/);async function o(t,e,n="",r=null){let o;n&&(e.redirect=n);const i=t=>{"pfAffSys"===t.data.provider&&(o=t.data)};window.addEventListener("message",i);const a=(t,e)=>new Promise(r=>{let o=document.getElementById("pf-as-form");if(o||(o=document.createElement("form"),o.method="POST",o.id="pf-as-form",o.style.display="none",o.target=n?"_self":"pf-as-frame",document.body.appendChild(o),Object.keys(e).forEach(t=>{const n=document.createElement("input");n.type="hidden",n.name=t,n.value="object"==typeof e[t]?JSON.stringify(e[t]):e[t],o.appendChild(n)})),o.action=t,!n){let t=document.getElementById("pf-as-frame");t||(t=document.createElement("iframe"),t.id="pf-as-frame",t.src="about:blank",t.name="pf-as-frame",t.style.display="none",document.body.appendChild(t)),t.onload=()=>{setTimeout(()=>{const t=document.getElementById("pf-as-form");t&&t.parentNode.removeChild(t);const e=document.getElementById("pf-as-frame");e&&e.parentNode.removeChild(e),r(1)},200)}}o.submit()});let d;t=t;for(let n=0;n<t.length;n++){d=t[n];if("ok"===await fetch(d,{redirect:"manual"}).then(t=>t.text()).catch(console.error)){await a(d,e);break}}window.removeEventListener("message",i),n||(o||(delete e.redirect,o=await fetch(d,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}).then(t=>t.text()).catch(console.error),o=o&&o.split("window.parent.postMessage(")[1],o=o&&o.split(", '*')")[0],o=o&&JSON.parse(o)),r(o||{code:400,message:"Bad request"}))}async function i(t,e,r,i,d){let[l,s]=e.split("?");r=r||document.referrer||"",d&&(d=encodeURIComponent(window.location.href.replace(/([?&])ref=/,"$1forwardRef="))),o(n.routes.capture,{ref:t,page:e,from:r},d,r=>{if(console.log("PF_Affiliate::addReferrer",JSON.stringify(r)),r.code&&r.message)return a(!1);if(!l.startsWith(n.host)){let o;r=r||{partnerType:"content-provider",appStorePartnerId:"",custom_utm:{}};const{partnerType:a,appStorePartnerId:d,custom_utm:p,redirect:f}=r;if(e.indexOf("forwardRef=")>-1&&(e=e.replace(/([?&])forwardRef=/,"$1ref=")),s.indexOf("forwardRef=")>-1&&(s=s.replace(/([?&])?forwardRef=/,"$1ref=")),f){const t=Object.keys(f);t.sort((t,e)=>t.length>e.length?-1:t.length<e.length?1:0);const n=e.replace(/([?&])(target=)([^&]+)/,"$1$2app-listing"),r=s.replace(/([?&])?(target=)([^&]+)/,"$1$2app-listing");for(let e=0;e<t.length;e++){const i=t[e];if(0===n.indexOf(i)||0===r.indexOf(i)){o=f[i];break}}}if(!o&&n.redirect&&(n.redirect[e]||n.redirect[s])&&(o=n.redirect[e]||n.redirect[s]),!o&&i)if(n.redirect&&n.redirect[i]){if("string"==typeof n.redirect[i])o=`${n.redirect[i]}?utm_source=${p.utm_source||a+"s"}&utm_medium=${p.utm_medium||("app-provider"===a?d||t:"redirect")}&utm_campaign=${p.utm_campaign||"app-listing"}&utm_content=${p.utm_content||t}&utm_term=${p.utm_term||"pagefly-affiliate"}`;else for(let t in n.redirect[i])if(e.indexOf(t)>-1){o=n.redirect[i][t];break}}else o=`https://apps.shopify.com/pagefly?utm_source=${p.utm_source||a+"s"}&utm_medium=${p.utm_medium||("app-provider"===a?d||t:"redirect")}&utm_campaign=${p.utm_campaign||"app-listing"}&utm_content=${p.utm_content||t}&utm_term=${p.utm_term||"pagefly-affiliate"}`;o||(o=`${l}${(p.utm_source||a)&&`?utm_source=${p.utm_source||a+"s"}&utm_medium=${p.utm_medium||"app-provider"===a&&d||t}&utm_campaign=${p.utm_campaign||"website"}&utm_term=${p.utm_term||"pagefly-affiliate"}`}`),console.log("Redirect to "+o),window.location.href=o}})}function a(t=!0){t?(a.loading||(a.style=document.createElement("style"),a.style.type="text/css",a.style.textContent="\n\t\t\t\t.lds-backdrop {\n\t\t\t\t\tposition: fixed;\n\t\t\t\t\ttop: 0;\n\t\t\t\t\tright: 0;\n\t\t\t\t\tbottom: 0;\n\t\t\t\t\tleft: 0;\n\t\t\t\t\tz-index: 9999;\n\t\t\t\t\tdisplay: flex;\n\t\t\t\t\talign-items: center;\n\t\t\t\t\tjustify-content: center;\n\t\t\t\t\tbackground-color: #fff;\n\t\t\t\t}\n\t\t\t\t.lds-ring {\n\t\t\t\t\tdisplay: inline-block;\n\t\t\t\t\tposition: relative;\n\t\t\t\t\twidth: 80px;\n\t\t\t\t\theight: 80px;\n\t\t\t\t}\n\t\t\t\t.lds-ring div {\n\t\t\t\t\tbox-sizing: border-box;\n\t\t\t\t\tdisplay: block;\n\t\t\t\t\tposition: absolute;\n\t\t\t\t\twidth: 64px;\n\t\t\t\t\theight: 64px;\n\t\t\t\t\tmargin: 8px;\n\t\t\t\t\tborder: 8px solid #000;\n\t\t\t\t\tborder-radius: 50%;\n\t\t\t\t\tanimation: lds-ring 1.2s cubic-bezier(0.5, 0, 0.5, 1) infinite;\n\t\t\t\t\tborder-color: #000 transparent transparent transparent;\n\t\t\t\t}\n\t\t\t\t.lds-ring div:nth-child(1) {\n\t\t\t\t\tanimation-delay: -0.45s;\n\t\t\t\t}\n\t\t\t\t.lds-ring div:nth-child(2) {\n\t\t\t\t\tanimation-delay: -0.3s;\n\t\t\t\t}\n\t\t\t\t.lds-ring div:nth-child(3) {\n\t\t\t\t\tanimation-delay: -0.15s;\n\t\t\t\t}\n\t\t\t\t@keyframes lds-ring {\n\t\t\t\t\t0% {\n\t\t\t\t\t\ttransform: rotate(0deg);\n\t\t\t\t\t}\n\t\t\t\t\t100% {\n\t\t\t\t\t\ttransform: rotate(360deg);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t",a.loading=document.createElement("div"),a.loading.className="lds-backdrop",a.loading.innerHTML='<div class="lds-ring"><div></div><div></div><div></div><div></div></div>'),document.body?(document.head.appendChild(a.style),document.body.appendChild(a.loading)):setTimeout(()=>a(t),10)):!t&&a.loading&&(document.head&&document.head.removeChild(a.style),document.body&&document.body.removeChild(a.loading))}r&&(a(),"complete"===document.readyState||"loading"!==document.readyState&&document.documentElement&&!document.documentElement.doScroll?i(r[3],window.location.href,null,r[5],"ref"===r[2]):document.addEventListener("DOMContentLoaded",()=>i(r[3],window.location.href,null,r[5],"ref"===r[2]))),window.PF_Affiliate=window.PF_Affiliate||{addReferral:function(t,e,r,i,a,d,l,s){o(n.routes.add,{shopDomain:t,userEmail:e,userCountry:r,shopifyPlan:i,pageflyPlan:a,chargeAmount:d,billingOn:l},!1,t=>{console.log("PF_Affiliate::addReferral",JSON.stringify(t)),"function"==typeof s&&s(t)})},addFormSubmission:function(t,e){o(n.routes.add,{type:"form-submission",formData:t},!1,t=>{console.log("PF_Affiliate::addFormSubmission",JSON.stringify(t)),"function"==typeof e&&e(t)})},addUserToUserReferral:function(t,e){o(n.routes.add,{type:"user-to-user-referral",shopDomain:t},!1,t=>{console.log("PF_Affiliate::addUserToUserReferral",JSON.stringify(t)),"function"==typeof e&&e(t)})}}}]);
</script>

</body>
</html>
