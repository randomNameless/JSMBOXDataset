<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>acc.storefinder.min.html</title>
</head>
<body>

<script>
ACC.storefinder={_autoload:[["init",$(".js-store-finder").length!=0],["bindStoreChange",$(".js-store-finder").length!=0],["bindSearch",$(".js-store-finder").length!=0],"bindPagination"],storeData:"",storeId:"",coords:{},storeSearchData:{},createListItemHtml:function(e,f){var c=$("<input>").addClass("js-store-finder-input").attr("type","radio").attr("name","storeNamePost").attr("id","store-filder-entry-"+f).attr("data-id",f).val(e.displayName);var d=$("<span>").addClass("entry__info").append($("<span>").addClass("entry__name").text(e.displayName)).append($("<span>").addClass("entry__address").text(e.line1+" "+e.line2)).append($("<span>").addClass("entry__city").text(e.town));var b=$("<span>").addClass("entry__distance").append($("<span>").text(e.formattedDistance));var a=$("<label>").addClass("js-select-store-label").attr("for","store-filder-entry-"+f).append(d).append(b);return $("<li>").addClass("list__entry").append(c).append(a)},refreshNavigation:function(){data=ACC.storefinder.storeData;var b=$(".js-store-finder-navigation-list");b.empty();if(data){for(i=0;i<data.data.length;i++){b.append(ACC.storefinder.createListItemHtml(data.data[i],i))}var a=$(".js-store-finder-input")[0];$(a).click()}var c=ACC.storefinder.storeSearchData.page;$(".js-store-finder-pager-item-from").text(c*10+1);var d=((c*10+10)>ACC.storefinder.storeData.total)?ACC.storefinder.storeData.total:c*10+10;$(".js-store-finder-pager-item-to").text(d);$(".js-store-finder-pager-item-all").text(ACC.storefinder.storeData.total);$(".js-store-finder").removeClass("show-store")},bindPagination:function(){$(document).on("click",".js-store-finder-details-back",function(b){b.preventDefault();$(".js-store-finder").removeClass("show-store")});$(document).on("click",".js-store-finder-pager-prev",function(c){c.preventDefault();var b=ACC.storefinder.storeSearchData.page;ACC.storefinder.getStoreData(b-1);a(b-1)});$(document).on("click",".js-store-finder-pager-next",function(c){c.preventDefault();var b=ACC.storefinder.storeSearchData.page;ACC.storefinder.getStoreData(b+1);a(b+1)});function a(b){if(b==0){$(".js-store-finder-pager-prev").attr("disabled","disabled")}else{$(".js-store-finder-pager-prev").removeAttr("disabled")}if(b==Math.floor(ACC.storefinder.storeData.total/10)){$(".js-store-finder-pager-next").attr("disabled","disabled")}else{$(".js-store-finder-pager-next").removeAttr("disabled")}}},bindStoreChange:function(){$(document).on("change",".js-store-finder-input",function(b){b.preventDefault();storeData=ACC.storefinder.storeData.data;var a=$(this).data("id");var c=$(".js-store-finder-details");$.each(storeData[a],function(f,g){if(f=="image"){c.find(".js-store-image").empty();if(g!=""){c.find(".js-store-image").append($("<img>").attr("src",g).attr("alt",""))}}else{if(f=="productcode"){c.find(".js-store-productcode").val(g)}else{if(f=="openings"){var d=c.find(".js-store-"+f);d.empty();if(g!=""){$.each(g,function(j,h){d.append($("<dt>").text(j));d.append($("<dd>").text(h))})}}else{if(f=="specialOpenings"){}else{if(f=="features"){var e=c.find(".js-store-"+f);e.empty();$.each(g,function(j,h){e.append($("<li>").text(h))})}else{if(g!=""){c.find(".js-store-"+f).text(g)}else{c.find(".js-store-"+f).empty()}}}}}}});ACC.storefinder.storeId=storeData[a];ACC.storefinder.initGoogleMap()});$(document).on("click",".js-select-store-label",function(a){$(".js-store-finder").addClass("show-store")});$(document).on("click",".js-back-to-storelist",function(a){$(".js-store-finder").removeClass("show-store")})},initGoogleMap:function(){if($(".js-store-finder-map").length>0){ACC.global.addGoogleMapsApi("ACC.storefinder.loadGoogleMap")}},loadGoogleMap:function(){storeInformation=ACC.storefinder.storeId;if($(".js-store-finder-map").length>0){$(".js-store-finder-map").attr("id","store-finder-map");var e=new google.maps.LatLng(storeInformation.latitude,storeInformation.longitude);var b={zoom:13,zoomControl:true,panControl:true,streetViewControl:false,mapTypeId:google.maps.MapTypeId.ROADMAP,center:e};var d=new google.maps.Map(document.getElementById("store-finder-map"),b);var a=new google.maps.Marker({position:new google.maps.LatLng(storeInformation.latitude,storeInformation.longitude),map:d,title:storeInformation.name,icon:"https://maps.google.com/mapfiles/markerA.png"});var c=new google.maps.InfoWindow({content:ACC.common.encodeHtml(storeInformation.name),disableAutoPan:true});google.maps.event.addListener(a,"click",function(){c.open(d,a)})}},bindSearch:function(){$(document).on("submit","#storeFinderForm",function(c){c.preventDefault();var b=$(".js-store-finder-search-input").val();if(b.length>0){ACC.storefinder.getInitStoreData(b)}else{if($(".js-storefinder-alert").length<1){var a=$(".btn-primary").data("searchEmpty");$(".js-store-finder").hide();$("#storeFinder").before($("<div>").addClass("js-storefinder-alert alert alert-danger alert-dismissable getAccAlert").append($("<button>").addClass("close closeAccAlert").attr("type","button").attr("data-dismiss","alert").attr("aria-hidden","true").text("x")).text(a));$(".closeAccAlert").on("click",function(){$(this).parent(".getAccAlert").remove()})}}});$(".js-store-finder").hide();$(document).on("click","#findStoresNearMe",function(a){a.preventDefault();ACC.storefinder.getInitStoreData(null,ACC.storefinder.coords.latitude,ACC.storefinder.coords.longitude)})},getStoreData:function(a){ACC.storefinder.storeSearchData.page=a;url=$(".js-store-finder").data("url");$.ajax({url:url,data:ACC.storefinder.storeSearchData,type:"get",dataType:"json",success:function(b){ACC.storefinder.storeData=b;ACC.storefinder.refreshNavigation();if(ACC.storefinder.storeData.total<10){$(".js-store-finder-pager-next").attr("disabled","disabled")}}})},getInitStoreData:function(b,c,a){$(".alert").remove();data={q:"",page:0};if(b!=null){data.q=b}if(c!=null){data.latitude=c}if(a!=null){data.longitude=a}ACC.storefinder.storeSearchData=data;ACC.storefinder.getStoreData(data.page);$(".js-store-finder").show();$(".js-store-finder-pager-prev").attr("disabled","disabled");$(".js-store-finder-pager-next").removeAttr("disabled")},init:function(){$("#findStoresNearMe").attr("disabled","disabled");if(navigator.geolocation){navigator.geolocation.getCurrentPosition(function(a){ACC.storefinder.coords=a.coords;$("#findStoresNearMe").removeAttr("disabled")},function(a){console.log("An error occurred... The error code and message are: "+a.code+"/"+a.message)})}}};
</script>

</body>
</html>
