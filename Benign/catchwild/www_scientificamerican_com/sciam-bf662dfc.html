<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>sciam-bf662dfc.html</title>
</head>
<body>

<script>
import{r as u,j}from"./vendor-react-f9bf3b4a.js";/*! js-cookie v3.0.5 | MIT */function C(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var s in n)e[s]=n[s]}return e}var ne={read:function(e){return e[0]==='"'&&(e=e.slice(1,-1)),e.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent)},write:function(e){return encodeURIComponent(e).replace(/%(2[346BF]|3[AC-F]|40|5[BDE]|60|7[BCD])/g,decodeURIComponent)}};function M(e,t){function n(o,i,r){if(!(typeof document>"u")){r=C({},t,r),typeof r.expires=="number"&&(r.expires=new Date(Date.now()+r.expires*864e5)),r.expires&&(r.expires=r.expires.toUTCString()),o=encodeURIComponent(o).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape);var a="";for(var c in r)r[c]&&(a+="; "+c,r[c]!==!0&&(a+="="+r[c].split(";")[0]));return document.cookie=o+"="+e.write(i,o)+a}}function s(o){if(!(typeof document>"u"||arguments.length&&!o)){for(var i=document.cookie?document.cookie.split("; "):[],r={},a=0;a<i.length;a++){var c=i[a].split("="),d=c.slice(1).join("=");try{var l=decodeURIComponent(c[0]);if(r[l]=e.read(d,l),o===l)break}catch{}}return o?r[o]:r}}return Object.create({set:n,get:s,remove:function(o,i){n(o,"",C({},i,{expires:-1}))},withAttributes:function(o){return M(this.converter,C({},this.attributes,o))},withConverter:function(o){return M(C({},this.converter,o),this.attributes)}},{attributes:{value:Object.freeze(t)},converter:{value:Object.freeze(e)}})}var U=M(ne,{path:"/"});function Ne(e={},t=""){if(typeof window>"u")return;let{reset:n,...s}=oe(t||window.location.search);n&&se();let o={...e,...s};re(o,e)}function je(){try{return ie()}catch{return null}}function oe(e=""){return[...e.matchAll(/flag=([^&#]+)/g)].reduce((t,[n,s])=>{let o=s,i=!0,r=s.indexOf(":");return r>0&&(o=s.slice(0,r),i=s.slice(r+1)),t[o]=i||!0,t},{})}var se=()=>{try{Object.keys(localStorage).forEach(e=>e.startsWith(b)&&localStorage.removeItem(e))}catch(e){console.error("Error clearing local storage flags:",e)}},ie=()=>Object.fromEntries(Object.entries(localStorage).filter(([e])=>e.startsWith(b)).map(([e,t])=>[e.slice(b.length),t==="true"||t])),b="sciam:";function re(e={},t={}){if(!(typeof window>"u"))for(let[n,s]of Object.entries(e))try{s==="reset"?t[n]?localStorage.setItem(b+n,t[n]):localStorage.removeItem(b+n):localStorage.setItem(b+n,s)}catch(o){console.error(`Error setting local storage flag ${b+n}:`,o)}}var Fe=class{constructor(){this._key="_ecommStateTrackerData",this._state=this.loadState()}loadState(){try{let e=localStorage.getItem(this._key);return e?JSON.parse(e):{}}catch{return{}}}saveState(){localStorage.setItem(this._key,JSON.stringify(this._state))}setTerm(e,t){this._state.term_id=e,this._state.term_name=t,this.saveState()}setPrice(e){this._state.value=e,this.saveState()}setCoupon(e){this._state.coupon=e,this.saveState()}reset(){this._state={},this.saveState()}pushDataLayer(e){let t={event:e,ecommerce:{currency:"USD",value:this._state.value,coupon:this._state.coupon,items:[{item_id:this._state.term_id,item_name:this._state.term_name,price:this._state.value,quantity:1}]},checkout:{amount:this._state.value,subscriptionType:this._state.term_id,subscriptionName:this._state.term_name}};window.dataLayer.push(t)}},ae=(e="")=>{try{return typeof window>"u"||typeof window.atob!="function"?Buffer.from(e,"base64").toString():window.atob(e)}catch{return null}},ce=(e="")=>{try{let t=e.split(".")[1];return JSON.parse(ae(t))}catch{return null}},Be=()=>new Promise((e,t)=>{window.__hydrated__?window.__hydrated__==="error"?t():e():(window.addEventListener("hydration",e,{once:!0}),window.addEventListener("hydration-error",t,{once:!0}))}),ue=(e,t)=>Object.entries(t).forEach(([n,s])=>e.setAttribute(n,s)),S=(e="",t={})=>{window.dispatchEvent(new CustomEvent(e,{detail:t}))},de=(...e)=>{},le=e=>{let t=performance,n=e+"-start",s=e+"-end";return t.mark(n),()=>(t.mark(s),t.measure(e,n,s))},G=e=>typeof e=="function"?e():e,Y=e=>(e??(e=window.OptanonActiveGroups||""),{essential:!0,performance:e.includes("C0002"),functional:e.includes("C0003"),targeting:e.includes("C0004"),social:e.includes("C0005"),firstParty:e.includes("C0008"),thirdParty:e.includes("C0009"),gad:e.includes("gad")});function Je({onSdkInit:e,onFirstConsentSignal:t}){console.log("[onetrust] OneTrust loading");let n=!1;window.OptanonWrapper=function(){if(n)return;let s=window.OneTrust;s.GetDomainData().NoBanner||s.IsAlertBoxClosed()?J(window.OptanonActiveGroups,"ready"):console.log("[onetrust] CMP is open, waiting for change to run consent Queue"),s.OnConsentChanged(o=>J(o.detail||"","change")),e==null||e(s),n=!0},window.addEventListener("consent-signal",({detail:s})=>t==null?void 0:t(s),{once:!0})}var O=!1;function J(e,t){let n={consent:Y(e),raw:e};function s(i,r=t,a=!O){try{i({event:r,isFirstRun:a,...n})}catch(c){console.error("[onetrust] error running consentQueue",c)}}console.log(`[onetrust] CMP ${t}, running consentQueue`);let o=window.consentQueue;o.forEach(i=>s(i)),o.push=function(){for(let i of arguments)s(i,"ready",!0);return Array.prototype.push.apply(o,arguments)},t!=="error"&&(S("consent-signal",{event:t,isFirstRun:!O,...n}),O=!0)}function D(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var s in n)e[s]=n[s]}return e}var pe={read:function(e){return e[0]==='"'&&(e=e.slice(1,-1)),e.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent)},write:function(e){return encodeURIComponent(e).replace(/%(2[346BF]|3[AC-F]|40|5[BDE]|60|7[BCD])/g,decodeURIComponent)}};function N(e,t){function n(o,i,r){if(!(typeof document>"u")){r=D({},t,r),typeof r.expires=="number"&&(r.expires=new Date(Date.now()+r.expires*864e5)),r.expires&&(r.expires=r.expires.toUTCString()),o=encodeURIComponent(o).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape);var a="";for(var c in r)r[c]&&(a+="; "+c,r[c]!==!0&&(a+="="+r[c].split(";")[0]));return document.cookie=o+"="+e.write(i,o)+a}}function s(o){if(!(typeof document>"u"||arguments.length&&!o)){for(var i=document.cookie?document.cookie.split("; "):[],r={},a=0;a<i.length;a++){var c=i[a].split("="),d=c.slice(1).join("=");try{var l=decodeURIComponent(c[0]);if(r[l]=e.read(d,l),o===l)break}catch{}}return o?r[o]:r}}return Object.create({set:n,get:s,remove:function(o,i){n(o,"",D({},i,{expires:-1}))},withAttributes:function(o){return N(this.converter,D({},this.attributes,o))},withConverter:function(o){return N(D({},this.converter,o),this.attributes)}},{attributes:{value:Object.freeze(t)},converter:{value:Object.freeze(e)}})}var fe=N(pe,{path:"/"}),He=()=>{let[e,t]=u.useState(!1);return u.useEffect(()=>{let n=fe.get("_emailCollectorRegistered")==="1";t(n)},[]),e},ge=typeof window<"u"?u.useLayoutEffect:u.useEffect;function Ve(e="",t=!1){let[n,s]=u.useState(t);return ge(()=>{let o=window.matchMedia(e);s(o.matches);let i=r=>s(r.matches);return o.addEventListener("change",i,{passive:!0}),()=>o.removeEventListener("change",i)},[e]),n}var me={x:0,y:0},H=()=>typeof window>"u"?me:{x:window.scrollX,y:window.scrollY},We=(e,t=100)=>{let n=u.useRef(H()),s=null,o=()=>{let i=n.current,r=H();e(r,i),n.current=r,s=null};u.useEffect(()=>{let i=()=>{t?s===null&&(s=setTimeout(o,t)):o()};return window.addEventListener("scroll",i,{passive:!0}),()=>{window.removeEventListener("scroll",i),s&&clearTimeout(s)}},[])};function Ge({onBeforeLoad:e,onLoad:t,onError:n,readyWhen:s,...o}){let i=V(),r=V(),a=he({...o,onLoad:w,onError:m}),c,d=G(s),l={script:o.id,element:a},g=v=>de(`[${o.id}]`,v);async function w(){try{g("Load Success"),t&&t(a),S("script-load",l),i.resolve(a),d&&await d,g("Ready"),S("script-ready",l),r.resolve(a)}catch{n&&n(a),S("script-error",l),r.reject()}c()}function m(){g("Load Error"),n&&n(a),S("script-error",l),i.reject(a),r.reject(a),c()}function h(){return e==null||e(a),document.body.appendChild(a),g("Load Start"),S("script-loadstart",l),c=le(`loader-${o.id}`),o.inline&&w(),{element:a,loaded:i.promise,ready:r.promise}}return h}var V=(e=()=>{})=>{let t,n;return{promise:new Promise((s,o)=>{t=s,n=o}).catch(e),resolve:t,reject:n}};function he({src:e,inline:t,id:n,onLoad:s,onError:o,attrs:i}){let r=document.createElement("script");return r.id=n,i&&ue(r,i),t?(r.innerHTML=t,r):(r.src=G(e),r.defer=(i==null?void 0:i.defer)??!1,r.async=(i==null?void 0:i.async)??!0,r.onload=s,r.onerror=o,r)}var we=["a","span","strong","em","i","b","u","s","sub","sup","code"];function Ye(e="",{inline:t=!1,normalize:n=!0,stripEntities:s=!0,stripNewlines:o=!0}){if(!e)return"";let i=o?" ":`
`;return e=t?e.replace(/(<([^>]+)>)/gi,""):e.replace(/<\/?(\w*)[^>]*>/g,(r,a)=>we.includes(a)?"":i),n&&(e=e.normalize("NFD").replace(/[\u0300-\u036f]/g,"")),s&&(e=e.replace(/&nbsp;/g," ").replace(/&\w+;/g,"")),e=o?e.replace(/\s+/g," "):e.replace(/[^\S\n]+/g," ").replace(/\s*(\n)\s*/g,"$1"),e=e.trim(),e}/*! Bundled license information:

js-cookie/dist/js.cookie.mjs:
  (*! js-cookie v3.0.5 | MIT *)
*/const Q={name:"Production",slug:"prod",aid:"FU52w9tupu",authProvider:"auth0",authExternalClientId:"C1VZnhgUJaCUJCEC1aqmm6bg6I9L48fW",loaderUrl:"https://experience.tinypass.com/xbuilder/experience/load?aid=FU52w9tupu",cxenseSiteId:"4731406317427036748",endpointUrl:"https://buy.tinypass.com/api/v3",pianoIdUrl:"https://id.tp.scientificamerican.com",sdkUrl:"https://cdn.tp.scientificamerican.com/api/tinypass.min.js",defaultOffer:"OFU8RMQESTD8",winbackOffer:"OFJRF90GW1OM",terms:{winbackTerm1Year:"TMQPDNMS7RJV",winbackTerm2Year:"TM37JC43RWHD"}},z={name:"Pre-Production",slug:"preprod",aid:"zb26Lrf5pu",authProvider:"auth0",authExternalClientId:"949krH8ZEE0TwdIJxgIxuiQOVIT8nBJS",loaderUrl:"https://experience.tinypass.com/xbuilder/experience/load?aid=zb26Lrf5pu",endpointUrl:"https://buy.tinypass.com/api/v3",pianoIdUrl:"https://id.tinypass.com",sdkUrl:"https://cdn.tinypass.com/api/tinypass.min.js",defaultOffer:"OF85KSMYIFWO"},q={name:"Sandbox",slug:"sandbox",aid:"I2n3TREbsu",authProvider:"auth0",authExternalClientId:"949krH8ZEE0TwdIJxgIxuiQOVIT8nBJS",loaderUrl:"https://sandbox.tinypass.com/xbuilder/experience/load?aid=I2n3TREbsu",endpointUrl:"https://sandbox.tinypass.com/api/v3",pianoIdUrl:"https://sandbox.piano.io",sdkUrl:"https://sandbox.tinypass.com/api/tinypass.min.js",defaultOffer:"OFLWOLQY3245",winbackOffer:"OFBEBVV63VVA",terms:{winbackTerm1Year:"TMTAJO1X5L5A",winbackTerm2Year:"TM2EY1ESEFD9"}},ve=[Q,z,q],Ie=()=>{var e;return((e=document.cookie.match(/(?:^|;)\s*__utp\s*=\s*([^;]+)/))==null?void 0:e[1])||""},ye=e=>{e=e||Ie();const t=e?ce(e):null;return t?{...t,firstName:t.given_name,lastName:t.family_name,uid:t.sub,confirmed:void 0,valid:void 0,dirty:!0}:null},Ee=()=>{if(typeof window>"u")return!1;const e=localStorage,t="piano-debug",n=location.search.match(/debug=piano(?:-(prod|preprod|sandbox|log|reset))*/);if(!(n!=null&&n[0]))return e.getItem(t)||!1;const s=n[1]||"log";return s==="reset"?(e.removeItem(t),!1):(e.setItem(t,s),s)},_e=()=>{const e={prod:Q.sdkUrl,preprod:z.sdkUrl,sandbox:q.sdkUrl};if(typeof window>"u")return;if(window.location.hostname.match(/^(?:www|blogs)\./))return e.prod;const n=Ee();return n&&n!=="log"?e[n]:e.sandbox},A=()=>{const e=_e();return ve.find(t=>t.sdkUrl===e)},be=(e,t)=>new Promise((n,s)=>{try{window.tp.api.callApi(e,t,o=>n(o))}catch(o){s(o)}});function Qe(){return A().defaultOffer}function ze(){return A().winbackOffer}function qe(){return A().terms.winbackTerm1Year}function Ke(){return A().terms.winbackTerm2Year}const Ze=(e,t,n)=>{var o;(o=(window.tp||{}).offer)==null||o.startCheckout({offerId:e,termId:t,promoCode:n||void 0})},L="_active_piano_purchase",$e={start:()=>U.set(L,"1",{expires:1/24/60*.5}),end:()=>U.remove(L),isActive:()=>U.get(L)==="1"},y=(e="",t)=>{const n=u.useState(!1),[s,o]=n;return u.useEffect(()=>{if(!e||!t)return;if(e==="init")throw new Error("usePianoCallback: 'init' isn't a valid callback. Use usePianoInit instead.");window.tp=window.tp||[];const i=window.tp.push(["addHandler",e,(...r)=>s?void 0:t(...r)]);return()=>{i&&window.tp[i-1]&&(window.tp[i-1][1]=()=>{}),o(!0)}},[]),n},Se=e=>{const t=u.useState(!1),[n,s]=t;return u.useEffect(()=>{if(!e)return;window.tp=window.tp||[];const o=window.tp.push(["init",(...i)=>n?void 0:e(...i)]);return()=>{o&&window.tp[o-1]&&(window.tp[o-1][1]=()=>{}),s(!0)}},[]),t},Pe=(e="",t)=>{function n(s){if(!(!s.data||!s.origin.includes("piano.io")&&!s.origin.includes("tinypass.com")))try{const o=JSON.parse(s.data);o.event===e&&t(o)}catch(o){console.error("[usePianoMessage] ",o)}}u.useEffect(()=>{if(!(!e||!t))return window.addEventListener("message",n),()=>window.removeEventListener("message",n)},[])},k=e=>console.warn("caught in noop",e),K=u.createContext({loadStatus:"loading",authStatus:"logged-out",user:null,setLoadError:k,isMaybeLoggedIn:!1,isLoggedIn:!1,isLoggedOut:!1,isLoaded:!1,isLoading:!1,isReady:!1,isError:!1,pianoMeterCount:null,logout:k,showLoginModal:k,showRegisterModal:k});function Xe({children:e}){const t=Ae();return j.jsx(K.Provider,{value:t,children:e})}const Z=()=>u.useContext(K);function Ae(){const[e,t]=u.useState("loading"),[n,s]=u.useState("loading"),[o,i]=u.useState(null),r=n==="logged-in"||!!(n==="loading"&&(o!=null&&o.dirty)),a=n==="logged-in",c=n==="logged-out"||n==="error",d=e!=="loading",l=n==="loading",g=e==="success",w=n==="error"||e==="error",m=()=>{s("logged-in"),i(window.tp.pianoId.getUser()||null)},h=(p=!1)=>{s(p?"error":"logged-out"),i(null)},v=()=>{if(e!=="loading"||n!=="loading"||window.tp.user)return;t("error"),h(!!o)};u.useEffect(()=>{i(ye())},[]),y("loggedIn",()=>m()),y("loggedOut",()=>h()),y("loginFailed",()=>h(!0)),y("loginSuccess",()=>m()),y("registrationSuccess",()=>m()),y("registrationFailed",()=>h(!0)),y("profileUpdated",()=>m());const[f,E]=u.useState(null);function I(p){E(p.views)}return y("meterActive",I),y("meterExpired",I),Se(()=>{const p=window.tp;t("success"),s(p.user.isUserValid()?"logged-in":"logged-out"),i(p.pianoId.getUser()||null),p.user.isUserValid()&&!p.pianoId.getUser()&&p.pianoIdLite.getToken()&&(p.pianoId.updateUser({}),setTimeout(()=>i(p.pianoId.getUser()||null),5e3))}),Pe("closed",()=>{setTimeout(()=>{s(p=>p!=="loading"?p:window.tp.user.isUserValid()?"logged-in":"logged-out")},50)}),{loadStatus:e,authStatus:n,pianoMeterCount:f,user:o,setLoadError:v,isMaybeLoggedIn:r,isLoggedIn:a,isLoggedOut:c,isLoaded:g,isLoading:l,isReady:d,isError:w,logout:p=>{s("loading"),window.tp.pianoId.logout(()=>{s("logged-out"),i(null),typeof p=="function"&&p()})},showLoginModal:p=>{s("loading"),window.tp.pianoId.show({...p,screen:"login"})},showRegisterModal:p=>{s("loading"),window.tp.pianoId.show({...p,screen:"register"})}}}const $=u.createContext(null);function et(){return u.useContext($)}function tt({children:e}){const[t,n]=u.useState(null);return u.useEffect(()=>n(A()),[]),j.jsx($.Provider,{value:t,children:e})}function nt(e="redirect",t="/account/"){const n=Z();return u.useEffect(()=>{n.isLoggedOut&&(e==="modal"||e==="login-modal"||window.location.pathname===t?n.showLoginModal():e==="register-modal"?n.showRegisterModal():window.location.pathname=t)},[n.isLoggedOut]),n}let _=(...e)=>{};typeof window<"u"&&(window!=null&&window.location.search.match(/debug=access/))&&(_=console.debug.bind(window.console));async function X(e=!0){var n,s;let t;try{const o=await be("/access/list");t=((s=(n=o==null?void 0:o.data)==null?void 0:n.map)==null?void 0:s.call(n,({resource:i})=>i).filter(Boolean))||[]}catch(o){if(e)return[];throw o}return t}const P=(e=[],...t)=>{var n;return((n=e==null?void 0:e.some)==null?void 0:n.call(e,({rid:s})=>t.includes(s)))||!1},R=(e=[])=>{const t=["UNLMTD","DIGPRINT","DIGITAL","ADFREE","REGONLY"];for(let n of t){const s=e.find(o=>o.rid===n);if(s)return s}return e[0]||null};async function Ce(e=!0){if(e&&window._userHasSub!==void 0)return{hasSub:window._userHasSub};const t=await X(),n=P(t,"DIGITAL","DIGPRINT","UNLMTD");return window._userHasSub=n,{hasSub:n}}function De(){var t,n,s,o,i,r,a;if(typeof window===void 0)return;const e=window==null?void 0:window.dataLayer.find(c=>{var d;return(d=c==null?void 0:c.content)==null?void 0:d.publishedAtDate});if(e)return e.content.publishedAtDate;if(window!=null&&window.__NEXT_DATA__)return(s=(n=(t=window==null?void 0:window.__NEXT_DATA__)==null?void 0:t.props)==null?void 0:n.pageProps.dataLayerContent)==null?void 0:s.publishedAtDate;if(window!=null&&window.__DATA__)return(a=(r=(i=(o=window==null?void 0:window.__DATA__)==null?void 0:o.initialData)==null?void 0:i.dataLayerContent)==null?void 0:r.content)==null?void 0:a.publishedAtDate}function ke(){if(typeof window>"u")return!1;const e=De();let t={};try{const s=U.get("idp_details");s&&(t=JSON.parse(s))}catch(s){console.error(s)}if(t!=null&&t.BPID){if(!e)return!0;if(t.active_contracts===null)return _("[access] IDP accesss denied because there are no active entitlements"),!1;if(t.active_contracts===void 0)return _("[access] IDP accesss granted because the entitlements are undefined, failing open"),!0;const s=new Date(e);let o=!1;return t.active_contracts.forEach(i=>{let{to:r,from:a}=i;const c=new Date(a),d=new Date(r);s>=c&&s<=d&&(o=!0)}),_(`[access] IDP access ${o?"GRANTED":"DENIED"} for this page based on its release date`,{pubDate:s,active_contracts:t.active_contracts}),o}if(document.cookie.match("idp_magic="))return _("[access] IDP accesss granted because of a magic word"),!0;if(document.cookie.match("ezproxy_bpid="))return _("[access] IDP accesss granted because of a magic work"),!0;const n=!!document.cookie.match(/_pc_instaccess=1/);return n&&_("[access] IDP accesss granted on IP alone"),n}const ee=u.createContext({hasAccess:void 0,hasSub:void 0,hasAdFree:void 0,hasIdpAccess:void 0,hasUnlimitedAccess:void 0,terms:[],resources:[],checkAccess:()=>Promise.resolve([])});function ot({children:e}){const t=xe();return j.jsx(ee.Provider,{value:t,children:e})}const st=()=>u.useContext(ee);function xe(){const{isReady:e,authStatus:t}=Z(),[n,s]=u.useState([]),[o,i]=u.useState(void 0),[r,a]=u.useState(void 0),[c,d]=u.useState(void 0),[l,g]=u.useState(void 0),[w,m]=u.useState(()=>R(n)),h=c||o;u.useEffect(()=>{function f(){const E=ke();d(E),E&&g(!0)}return f(),window.addEventListener("ipd-update",f),()=>{window.removeEventListener("idp-update",f)}},[]),u.useEffect(()=>{n.length&&(i(P(n,"DIGITAL","DIGPRINT","UNLMTD")),a(P(n,"ADFREE","UNLMTD")),g(c||P(n,"UNLMTD")),m(R(n)))},[n]);async function v(){t==="logged-in"&&o===!1&&i(void 0);let f=await X();return s(f),i(P(f,"DIGITAL","DIGPRINT","UNLMTD")),a(P(f,"ADFREE","UNLMTD")),m(R(f)),!(f!=null&&f.length)&&!c&&g(!1),f}return u.useEffect(()=>{if(!e){i(void 0);return}if(t!=="loading"){if(t==="logged-out"||t==="error"){i(!1),g(!!c),s([]);return}v()}},[e,t]),{hasAccess:h,hasSub:o,hasAdFree:r,hasIdpAccess:c,hasUnlimitedAccess:l,resources:n,terms:n,primaryResource:w,checkAccess:v}}const it=[{name:"Test",slug:"test",tenant:"sciam-test",domain:"test-id.scientificamerican.com",clientId:"949krH8ZEE0TwdIJxgIxuiQOVIT8nBJS",issuer:"https://test-id.scientificamerican.com/",apiIssuer:"https://test-id.scientificamerican.com/",apiAudience:"https://sciam-test.us.auth0.com/api/v2/"},{name:"Staging",slug:"stage",tenant:"sciam-staging",domain:"staging-id.scientificamerican.com",clientId:"NOT_SET",issuer:"https://staging-id.scientificamerican.com/",apiIssuer:"https://staging-id.scientificamerican.com/",apiAudience:"https://staging-id.scientificamerican.com/api/v2/"},{name:"Production",slug:"prod",tenant:"sciam-prod",domain:"id.scientificamerican.com",clientId:"C1VZnhgUJaCUJCEC1aqmm6bg6I9L48fW",issuer:"https://id.scientificamerican.com/",apiIssuer:"https://id.scientificamerican.com/",apiAudience:"https://sciam-prod.us.auth0.com/api/v2/"}];function rt(e){const t=window.tp;let n=!1;function s(){n||(n=!0,e==null||e())}const o=t.consent.getByPurpose();console.log("[piano] Initial Piano consent",o),o||(console.log("[piano] Applying base consent until OneTrust consentQueue logic executes."),W(),console.log("[piano] base consent",t.consent.getByPurpose())),s(),window.consentQueue=window.consentQueue||[],window.consentQueue.push(function(){W(),console.log("[piano] Piano consentQueue logic executed.",t.consent.getByPurpose()),s()})}function W(e={}){const t=Y();console.log("[piano] OneTrust consent state:",t);const n=t.performance&&t.functional?"opt-in":"essential";Ue({AM:t.targeting?"opt-in":"opt-out",CP:n,AD:t.targeting&&t.social?"opt-in":t.targeting?"essential":"opt-out",PR:n,DL:n,...e})}function Ue(e){var n,s;const t=(s=(n=window.tp)==null?void 0:n.consent)==null?void 0:s.setByPurpose;Object.entries(e).forEach(([o,i])=>t==null?void 0:t(o,i))}const Te=()=>{const e={};for(const[t,n,s]of document.cookie.matchAll(/sa_piano_auth(?:\.(\w+))?=([^;]+)/g))e[n||"default"]=s;return e},Oe=(e="")=>{const t=Te();return t[e]||t.default},F="sa_piano_checkout_args",Le=()=>JSON.parse(localStorage.getItem(F)||"[]"),Re=(e=[{},"",{}])=>localStorage.setItem(F,JSON.stringify(e)),x=()=>localStorage.removeItem(F);function at(e,t=""){const n=window.tp,s=t.endsWith(".scientificamerican.com"),o=s&&t.startsWith("www."),i=s&&!o&&t.match(/^(?:main-www|local-www)\./);n.push(["setAid",e.aid]),o?(n.push(["setComposerHost","https://c2.tp.scientificamerican.com"]),n.push(["setPianoIdUrl","https://id.tp.scientificamerican.com"])):n.push(["setPianoIdUrl",e.pianoIdUrl]),n.push(["setEndpoint",e.endpointUrl]),s&&(i?n.push(["setCookieDomain",t]):n.push(["setCookieDomain","scientificamerican.com"])),e.cxenseSiteId&&n.push(["setCxenseSiteId",e.cxenseSiteId]),n.push(["setUseTinypassAccounts",!1]);const r=Oe(e.authExternalClientId);console.log("[piano] using Piano Auth Sync with external JWT",r),n.push(["setUsePianoIdUserProvider",!1]),n.push(["setUsePianoIdLiteUserProvider",!0]),r?n.push(["setExternalJWT",r]):document.cookie.includes("__utp")&&!document.cookie.match("sa_piano_auth.")&&(console.log("[piano] clearing Piano ID cookie"),document.cookie="sa_piano_cutover_status=logged-out; path=/; max-age=31536000",n.push(["init",()=>{var d,l;return(l=(d=window.tp.pianoId)==null?void 0:d.logout)==null?void 0:l.call(d)}]));function a(d,l,g){var h,v;if((v=(h=window.tp)==null?void 0:h.user)!=null&&v.isUserValid())return!1;const w=window.location.pathname;try{Re([{path:w,...d},l,g]),console.log("[piano] saved checkout params",d,l,g)}catch(f){console.error("[piano] error saving checkout params",f)}const m=d.startScreen==="register"?"/register/":"/login/";return window.location.href=m+"?returnTo="+encodeURIComponent(w+window.location.search),!1}function c(d){location.reload()}n.push(["addHandler","loginRequired",a]),n.push(["addHandler","externalCheckoutComplete",c]),n.push(["init",()=>{var E;const d=window.tp;d.experience.init();const{aid:l,composerHost:g,cookieDomain:w,cxCdnUrl:m,endpoint:h,pianoIdUrl:v}=d;if(console.log("[piano] env info",{aid:l,composerHost:g,cookieDomain:w,cxCdnUrl:m,endpoint:h,pianoIdUrl:v}),!d.user.isUserValid()||location.pathname.match(/account|login|logout|callback|register/))return;document.cookie.includes("sa_piano_cutover_status=logged-out")&&(console.log("[piano] Piano ID cutover complete, refreshing page"),document.cookie="sa_piano_cutover_status=complete; path=/; max-age=31536000");const f=Le();if(f){const[{path:I="",...T},te]=f;if(I!==window.location.pathname){console.log("[piano] skipping auto-checkout, path mismatch",I,window.location.pathname),x();return}if((E=I==null?void 0:I.includes)!=null&&E.call(I,"/article/"))return Ce().then(({hasSub:B})=>{if(B){console.log("[piano] skipping auto-checkout, user already has access"),x();return}d.offer.startCheckout(T),x()});d.offer.startCheckout(T),x()}}])}function ct(){window.tp.push(["setTags",["paywall-exempt"]])}function ut(e){[["language","en"],["primaryCategory",e.primaryCategory||""],["subCategory",e.subCategory||""],["subtype",e.subtype||""],["type",e.type||""],["contentId",""],["collectionId",""],["collectionName",""],["publishedAtDateTime",e.publishedAtDateTime||""],["publishedAtDate",e.publishedAtDate||""],["publishedAtTime",e.publishedAtTime||""],["updatedAtDateTime",e.updatedAtDateTime||""],["brand",""],["authors",e.authors||[]],["title",e.title||""],["tags",""],["template",""],["isSyndicated",!1],["isPartner",!1],["isSponsored",!1],["isResalable",!1],["containsMedia",""],["articleDoi",e.articleDoi||""],["journalIssueName",e.journalIssueName||""],["wordCount",void 0]].forEach(([t,n])=>window.tp.push(["setCustomVariable",t,n]))}export{ke as A,at as B,ut as C,ct as D,J as E,_e as F,rt as G,Be as H,le as I,Ne as K,Ge as L,tt as P,je as Z,Fe as _,Se as a,st as b,U as c,Ie as d,nt as e,et as f,A as g,Ve as h,W as i,He as j,Ye as k,it as l,qe as m,ce as n,ze as o,$e as p,Ke as q,y as r,Ze as s,Qe as t,Z as u,We as v,Xe as w,ot as x,Je as y,Ee as z};
//# sourceMappingURL=sciam-bf662dfc.js.map

</script>

</body>
</html>
