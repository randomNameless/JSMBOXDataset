<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Rl4gv2.m.html</title>
</head>
<body>

<script>
"use strict";(function($){$.fn.extend({gScrollingCarousel:function gScrollingCarousel(options){var defaults={scrolling:false,amount:false,onScroll:null};options=$.extend(defaults,options);var supportsTouch=false;if("ontouchstart"in window){supportsTouch=true}else if(window.navigator.msPointerEnabled){supportsTouch=true}else if("ontouchstart"in document.documentElement){supportsTouch=true}var x,left,down,newX,oldX,maxScrollLeft,am,amX,amL,leftElem,rightElem,currx,items,element,elements;element=$(this);if(options.amount==false){$(this).closest(".swiper").data("amount",element.children(":first").outerWidth(true))}else{$(this).closest(".swiper").data("amount",options.amount)}leftElem=$("<span />").addClass("jc-left").html('<svg focusable="false" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z"></path></svg>');rightElem=$("<span />").addClass("jc-right").html('<svg focusable="false" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"></path></svg>');element.parent().append(leftElem).append(rightElem);maxScrollLeft=element.get(0).scrollWidth-element.get(0).clientWidth;left=Math.abs(element.scrollLeft());if(maxScrollLeft==left){rightElem.hide()}else{rightElem.show()}if(left==0){leftElem.hide()}else{leftElem.show()}if(options.scrolling){element.bind("DOMMouseScroll mousewheel",function(event){var amount=$(this).closest(".swiper").data("amount");var oEvent=event.originalEvent,direction=oEvent.detail?oEvent.detail*-amount:oEvent.wheelDelta,position=Math.abs(element.scrollLeft());position+=direction>0?-amount:amount;$(this).scrollLeft(position);event.preventDefault();maxScrollLeft=element.get(0).scrollWidth-element.get(0).clientWidth;left=Math.abs(element.scrollLeft());if(0==left){rightElem.fadeOut(200)}else{rightElem.fadeIn(200)}if(left==maxScrollLeft){leftElem.fadeOut(200)}else{leftElem.fadeIn(200)}})}element.bind("mousedown",function(e){e.preventDefault();down=true;x=e.pageX;left=$(this).scrollLeft()}).bind("mousemove",function(e){if(down){if(options.onScroll){options.onScroll()}if(e.pageX!=x){element.addClass("nonclick");newX=e.pageX;oldX=Math.abs(element.scrollLeft());element.scrollLeft(left-newX+x);maxScrollLeft=element.get(0).scrollWidth-element.get(0).clientWidth;if(0==oldX){rightElem.fadeOut(200)}else{rightElem.fadeIn(200)}if(oldX==maxScrollLeft){leftElem.fadeOut(200)}else{leftElem.fadeIn(200)}}}else{element.removeClass("nonclick")}});rightElem.bind("click",function(e){var amount=$(this).closest(".swiper").data("amount");if(options.onScroll){options.onScroll()}items=$(this).siblings(".items");currx=Math.abs(items.scrollLeft());amX=parseInt($(this).parent().width()/amount);amX=amX>1?amX:2;am=amX*amount-amount;if($(this).closest(".swiper").hasClass("auto-swip")){am=$(this).closest(".swiper").find(" .items > div").eq(0).width()}maxScrollLeft=items.get(0).scrollWidth-items.get(0).clientWidth;if(maxScrollLeft>0){leftElem.fadeIn(200)}if(currx-am<=0)$(this).fadeOut(200);items.animate({scrollLeft:"+="+am},200)});leftElem.bind("click",function(e){var amount=$(this).closest(".swiper").data("amount");if(options.onScroll){options.onScroll()}rightElem.fadeIn(200);items=$(this).siblings(".items");currx=Math.abs(items.scrollLeft());amX=parseInt($(this).parent().width()/amount);amX=amX>1?amX:2;am=amX*amount-amount;if($(this).closest(".swiper").hasClass("auto-swip")){am=$(this).closest(".swiper").find(" .items > div").eq(0).width()}if(currx+am>=maxScrollLeft)$(this).fadeOut(200);if(maxScrollLeft>0){rightElem.fadeIn(200)}items.animate({scrollLeft:"-="+am},200)});$(window).on("resize",function(){element.each(function(){elements=$(this);maxScrollLeft=elements.get(0).scrollWidth-elements.get(0).clientWidth;left=Math.abs(elements.scrollLeft());if(maxScrollLeft==left){rightElem.fadeOut(200)}else{rightElem.fadeIn(200)}if(left==0){leftElem.fadeOut(200)}else{leftElem.fadeIn(200)}})});$(document).on("mouseup mousedown click",".nonclick a",function(e){e.preventDefault()});$(document).on("mouseup",function(e){setTimeout(function(){element.removeClass("nonclick");down=false},1)})}})})(jQuery);setInterval(function(){$(".auto-swip").each(function(){if(!$(this).find(".jc-left").is(":visible")){$(this).attr("swip-dir","right")}if(!$(this).find(".jc-right").is(":visible")){$(this).attr("swip-dir","left")}$(".auto-swip .jc-"+$(this).attr("swip-dir")).click()})},2e3);var thatStory=void 0;var storyComponent=createApp({template:'\n        <div class="story-container swiper">\n            <div class="its items">\n                <div class="story-item item" v-for="(story, index) in storyList">\n\n                    <div :class="[\'story-background\', getSeenStoryClass(story.i)]">\n                        <div class="story-avatar">\n                            <img :src="story.uau" @click="showStory(index)">\n                        </div>\n                    </div>\n                    <span class="story-username">\n                        <a :href="story.up">\n                            {{story.udn}}\n                        </a>\n                    </span>\n                </div>\n\n            </div>\n        </div>\n\n        <div id="show-story-modal-container" v-if="getStoryByIndex">\n            <i class="close-svg" @click="closeStory()"></i>\n            <div class="arrow-svg-container">\n                <i class="arrow-svg" id="next" @click="nextStory()" v-if="this.currentIndex != 0"></i>\n            </div>\n            <div class="show-modal">\n                <div class="flax-container justify-content-between">\n                    <div :class="[\'flax-container\', \'max-with\', getStoryByIndex.ims ? \'my-story-info\' : \'\']">\n                        <div class="avatar-wrapper">\n                            <i v-show="getStoryByIndex.uio" class="official-svg"></i>\n                            <a class="avatar-container" :href="getStoryByIndex.up" >\n                                <img :src="getStoryByIndex.uau" >\n                            </a>\n                        </div>\n                        <a id="username" :href="getStoryByIndex.up">\n                            {{getStoryByIndex.udn}}\n                        </a>\n                    </div>\n                    <div class="visit-count-container" v-if="getStoryByIndex.ims">\n                        <span>\n                            {{getStoryByIndex.vc}}\n                        </span>\n                        <i class="visit-svg"></i>\n                    </div>\n                    <i class="delete-btn delete-svg" v-if="getStoryByIndex.ims"\n                        @click="deleteStory(getStoryByIndex.i)">\n                    </i>\n                    <a :href="getStoryByIndex.vwp" class="reference-btn">\n                        تماشای کامل\n                    </a>\n                </div>\n\n                <div class="video-container">\n                    <video class="video-js vjs-default-skin" :src="getStoryByIndex.vu"\n                    crossorigin  playsinline preload="auto" id="videoStory"\n                    @loadstart="startVideo(getStoryByIndex.st, getStoryByIndex.et)">\n                    <source :src="getStoryByIndex.vu" type="video/mp4">\n                </video>\n                </div>\n\n                <div class="text-container">\n                    <p v-if="getStoryByIndex.t" v-html="getStoryByIndex.t"></p>\n                </div>\n            </div>\n            <div class="arrow-svg-container">\n                <i class="arrow-svg" id="previous" @click="previousStory()"\n                v-if="this.currentIndex != storyList.length-1"></i>\n            </div>\n        </div>\n        <i class="loading-svg preload" v-show="isLoading"></i>\n    ',props:{},setup:function setup(){var storyList=ref([]);var isHome=ref(0);var currentIndex=ref(-1);var stories=ref([]);var loadStartListeners=ref([]);var isLoading=ref(false);function getStoryList(){var _this=this;this.nothingFound=false;axios({method:"POST",url:"/story/storyList",headers:{"content-type":"application/x-www-form-urlencoded"},data:{isHome:this.isHome}}).then(function(response){_this.storyList=response.data.storyList;setTimeout(function(){$(".swiper .items").each(function(){$(this).gScrollingCarousel();$(this).closest(".swiper").find(".jc-right").click()})},1e3)})["catch"](function(error){showErrMessage("لطفا بعدا امتحان کنید!")})}function showStory(index){this.currentIndex=index;this.getSeenStoryClass(thatStory.getStoryByIndex.i);this.fetchStory()}function startVideo(startTime,endTime){var videoElement=$("#videoStory")[0];videoElement.currentTime=startTime;videoElement.play();var handelUpdateChange=function handelUpdateChange(){if(this.currentTime>=endTime){this.pause();if($(".arrow-svg#previous").length>0){$(".arrow-svg#previous").click()}else{setTimeout(function(){$(".close-svg").click()},1e3)}}};this.loadStartListeners.forEach(function(listener){videoElement.removeEventListener("timeupdate",listener)});this.loadStartListeners=[];this.loadStartListeners.push(handelUpdateChange);videoElement.addEventListener("timeupdate",handelUpdateChange)}function closeStory(){this.currentIndex=-1}function previousStory(){this.currentIndex+=1;this.getSeenStoryClass(thatStory.getStoryByIndex.i);this.fetchStory()}function nextStory(){this.currentIndex-=1;this.getSeenStoryClass(thatStory.getStoryByIndex.i);this.fetchStory()}function deleteStory(id){var _this2=this;this.nothingFound=false;showPrg("در حال دریافت اطلاعات");axios({method:"POST",url:"/story/delete",headers:{"content-type":"application/x-www-form-urlencoded"},data:{id:id}}).then(function(response){hidePrg();showErrMessage(response.r);_this2.closeStory();window.location.reload()})["catch"](function(error){hidePrg();showErrMessage("لطفا بعدا امتحان کنید!")})}function fetchStory(){var _this3=this;this.isLoading=true;this.nothingFound=false;axios({method:"POST",url:"/story/fetch",headers:{"content-type":"application/x-www-form-urlencoded"},data:{userId:thatStory.getStoryByIndex.ui,full:0}}).then(function(response){_this3.isLoading=false;if(response.data.success==0){if($(".arrow-svg#previous").length>0){$(".arrow-svg#previous").click()}else{setTimeout(function(){$(".close-svg").click()},1e3)}}})["catch"](function(error){_this3.isLoading=false})}function getStoryCookieKey(storyId){var key="user-".concat(USER_ID,"-seen-story-").concat(storyId);return key}function getStoryCookie(storyId){var key=this.getStoryCookieKey(storyId);return getCookie(key)}function getSeenStoryClass(storyId){if(this.getStoryCookie(storyId)){return"seen-story"}else{return null}}return{storyList:storyList,isHome:isHome,getStoryList:getStoryList,showStory:showStory,stories:stories,closeStory:closeStory,currentIndex:currentIndex,startVideo:startVideo,previousStory:previousStory,nextStory:nextStory,deleteStory:deleteStory,fetchStory:fetchStory,getStoryCookieKey:getStoryCookieKey,getStoryCookie:getStoryCookie,getSeenStoryClass:getSeenStoryClass,loadStartListeners:loadStartListeners,isLoading:isLoading}},mounted:function mounted(){thatStory=this;if(window.location.pathname==="/"){this.isHome=1}else{this.isHome=0}this.getStoryList()},computed:{getStoryByIndex:function getStoryByIndex(){if(this.currentIndex>=0){return this.storyList[this.currentIndex]}else{return null}}}});storyComponent.mount("#storyComponent");

</script>

</body>
</html>
