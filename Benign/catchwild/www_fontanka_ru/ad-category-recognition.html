<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ad-category-recognition.html</title>
</head>
<body>

<script>
!function(e){"function"==typeof define&&define.amd?define(e):e()}((function(){"use strict";function e(e,t,n,o){return new(n||(n=Promise))((function(i,r){function a(e){try{s(o.next(e))}catch(e){r(e)}}function d(e){try{s(o.throw(e))}catch(e){r(e)}}function s(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,d)}s((o=o.apply(e,t||[])).next())}))}"function"==typeof SuppressedError&&SuppressedError;const t={setRecognizeStatus(e){var t;null===(t=window.saluteAdSdk.status)||void 0===t||t.push(e),window.saluteAdSdk.onSetStatus&&window.saluteAdSdk.onSetStatus(e)},setRecognizedCategory(e){window.saluteAdSdk.categories=e,window.saluteAdSdk.isCategoryRecognized=!0,window.saluteAdSdk.onSetCategories&&window.saluteAdSdk.onSetCategories(e)},setError(e){window.saluteAdSdk.error=e,window.saluteAdSdk.onSetError&&window.saluteAdSdk.onSetError(e)},setData(e){window.saluteAdSdk.data=e,window.saluteAdSdk.onSetData&&window.saluteAdSdk.onSetData(e)}},n="[data-layersdk-article]",o="[data-salute-adsdk-article]",i=["Article","NewsArticle","TechArticle","SatiricalArticle","ScholarlyArticle","Report","SocialMediaPosting","AdvertiserContentArticle","AnalysisNewsArticle","AskPublicNewsArticle","BlogPosting","DiscussionForumPosting","LiveBlogPosting","MedicalScholarlyArticle","OpinionNewsArticle","ReportageNewsArticle"];function r(){const e=document.querySelector(n)||document.querySelector(o)||function(){const e=i.map((e=>`[itemtype*="schema.org/${e}"]`)).join(",");return document.querySelector(e)}();return e&&e.innerText}var a,d,s;function c(){let e=(new Date).getTime(),t="undefined"!=typeof performance&&performance.now&&1e3*performance.now()||0;return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(n=>{let o=16*Math.random();return e>0?(o=(e+o)%16|0,e=Math.floor(e/16)):(o=(t+o)%16|0,t=Math.floor(t/16)),("x"==n?o:7&o|8).toString(16)}))}let u,l;function g(){u&&(XMLHttpRequest.prototype.send=u)}function p(){l&&(XMLHttpRequest.prototype.send=l)}!function(e){e.TYPE="@type",e.REPRESENTATIVE_OF_PAGE="representativeOfPage",e.URL="url",e.WIDTH="width",e.HEIGHT="height",e.DESCRIPTION="description"}(a||(a={})),function(e){e.MAIN_ENTITY="mainEntityOfPage",e.HEADLINE="headline",e.ARTICLE_SECTION="articleSection",e.ARTICLE_BODY="articleBody",e.DATE_PUBLISHED="datePublished",e.DATE_MODIFIED="dateModified"}(d||(d={})),function(e){e.POST="POST",e.PEEK="PEEK"}(s||(s={}));const f="ad-category-recognition-debug";var S;function w(){const e=JSON.parse(localStorage.getItem(f)||"null");return e||localStorage.setItem(f,"{}"),Object.assign({},e)}!function(e){e.DISABLE_INTERCEPTION="disableInterception",e.CATEGORY_ENDPOIND_DEV="categoryEndpointDev"}(S||(S={}));const y={getDebugConfig:w,setValue:function(e,t){try{const n=w(),o=Object.assign(Object.assign({},n),{[e]:t});localStorage.setItem(f,JSON.stringify(o))}catch(e){console.log("Не удалось записать debug-параметры")}}},A={POST:{DEV:"https://outstream.stage.sberdevices.ru/api/v0/sdk/category",PROD:"https://outstream.sberdevices.ru/api/v0/sdk/category"},PEEK:{DEV:"https://outstream.stage.sberdevices.ru/api/v0/sdk/category/peek",PROD:"https://outstream.sberdevices.ru/api/v0/sdk/category/peek"}};window.saluteAdSdk||(window.saluteAdSdk={}),Object.assign(window.saluteAdSdk,{recognizeCategoryByUrl:m,recognizeCategoryByText:R,categories:[],status:[],isCategoryRecognized:!1});const h=y.getDebugConfig(),E="boolean"==typeof h.disableInterception?h.disableInterception:window.saluteAdSdk.disableInterception;function v(){return window.location.origin+window.location.pathname}function x(){if("loading"===document.readyState)document.addEventListener("DOMContentLoaded",(function(){if(k())return;const e=r();e?R(v(),e):t.setRecognizeStatus("no-article")}));else{if(k())return;const e=r();if(!e)return void t.setRecognizeStatus("no-article");R(v(),e)}}function k(){return Boolean(window.saluteAdSdk&&window.saluteAdSdk.categories&&window.saluteAdSdk.categories.length)}function R(e,n){const o={url:e,articleBody:n};return t.setData(o),D(s.POST,o)}function m(e){const n={url:e};return t.setData(n),D(s.PEEK,n)}function D(n,o,i=2e3){const r=A[n],a=c();return t.setRecognizeStatus(o.articleBody?"loading":"cachedLoading"),Promise.race([fetch(window.saluteAdSdk.debug||h.categoryEndpointDev?r.DEV:r.PROD,{method:"POST",body:JSON.stringify(o),headers:{"Content-Type":"application/json","X-Correlation-ID":a}}),new Promise(((e,t)=>{setTimeout((()=>{t()}),i)}))]).then((t=>e(this,void 0,void 0,(function*(){if(!t.ok){if(400===t.status){const e=yield t.json();throw new Error(e.detail)}throw new Error(`API Categories error: ${t.statusText}`)}return t.json()})))).then((e=>{var n,i;t.setRecognizeStatus(o.articleBody?"success":"cachedSuccess");const r=(e.categories||[]).map((e=>e));t.setRecognizedCategory(r),null===(i=null===(n=window.saluteAdSdk)||void 0===n?void 0:n.onRecognizeCategories)||void 0===i||i.call(n)})).catch((e=>{var n,i;t.setRecognizeStatus(o.articleBody?"fail":"cachedFail"),t.setError(e),t.setRecognizedCategory([]),null===(i=null===(n=window.saluteAdSdk)||void 0===n?void 0:n.onRecognizeCategories)||void 0===i||i.call(n)}))}E?function({bidderName:e}){l=XMLHttpRequest.prototype.send,XMLHttpRequest.prototype.send=function(...t){try{const n=function(e){if(e&&"string"==typeof e)try{return JSON.parse(e)}catch(e){return}}(t[0]),o=function(e,t){if(Array.isArray(null==e?void 0:e.data))return e.data.filter((e=>e.bidder===t))}(n,e);if(!(null==o?void 0:o.length))return void l.apply(this,t);this.setRequestHeader("X-Correlation-ID",c()),l.apply(this,[JSON.stringify(n)]),p()}catch(e){l.apply(this,t),p()}}}({bidderName:"yandex_LayerCV"}):function({bidderName:e}){u=XMLHttpRequest.prototype.send,XMLHttpRequest.prototype.send=function(...t){var n;try{const o=function(e){if(e&&"string"==typeof e)try{return JSON.parse(e)}catch(e){return}}(t[0]),i=function(e,t){if(Array.isArray(null==e?void 0:e.data))return e.data.filter((e=>e.bidder===t))}(o,e);if(!(null==i?void 0:i.length))return void u.apply(this,t);window.saluteAdSdk.onRecognizeCategories=()=>{i.forEach((e=>{var t,n;e.parameters.puid8=null===(n=null===(t=window.saluteAdSdk)||void 0===t?void 0:t.categories)||void 0===n?void 0:n.join(":")})),u.apply(this,[JSON.stringify(o)]),window.saluteAdSdk.onRecognizeCategories=void 0,g()},window.saluteAdSdk.isCategoryRecognized&&(null===(n=window.saluteAdSdk)||void 0===n||n.onRecognizeCategories())}catch(e){u.apply(this,t),g()}}}({bidderName:"yandex_LayerCV"}),t.setRecognizeStatus("inited"),E?x():m(v()).then(x)}));

</script>

</body>
</html>
