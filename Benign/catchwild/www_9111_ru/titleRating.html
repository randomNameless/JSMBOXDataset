<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>titleRating.html</title>
</head>
<body>

<script>
let rating_vote_current_status=!1;function titleRatingVote(t=0,e=5,s){add_coin1(100);$("#authorinfo").data("userId"),$("#authorinfo").data("isSubscriber");0!==site_vars.current_user.id&&site_vars.current_user.rating<500&&$.fancybox.open($("#popupRating")),!1===rating_vote_current_status&&void 0!==t&&t>0&&(rating_vote_current_status=!0,$.ajax({dataType:"json",type:"POST",url:"/ajax_server/forum/title_rating.php",cache:!1,data:{mode:"set_rating",title_id:t,rating:e},success:function(i){if(!0===i.success){let n=new URL(document.location.href);if(saveHidden(t,1),n)if($('.pubsItem[data-title-id="'+t+'"]').length>0){let s=$('.pubsItem[data-title-id="'+t+'"]');e<5&&$(s).fadeOut(200)}else if($('article[data-title-id="'+t+'"]').length>0){let s=$('article[data-title-id="'+t+'"]');e<5&&$(s).fadeOut(200)}if(i.likes&&((i.likes.plus||i.likes.minus)&&(1===$("#ratingCount"+t).length?$("#ratingCount"+t).html(i.likes.plus+" / "+i.likes.minus):$(".ratingCount").html(i.likes.plus+" / "+i.likes.minus),$("#btn_like__counter_plus_"+t).html(i.likes.plus),$("#btn_like__counter_minus_"+t).html(i.likes.minus)),s)){let t=s.querySelector("#emojiBlock--likes"),i=s.querySelector("#emojiBlock--dislikes"),n=s.querySelector(".btn_like--like"),a=s.querySelector(".btn_like--dislike");document.addEventListener("click",(function(e){n.contains(e.target)||a.contains(e.target)||i.contains(e.target)||t.contains(e.target)||"flex"!==t.style.display&&"flex"!==i.style.display||(t.style.display="none",i.style.display="none")})),t.addEventListener("click",(function(){t.style.display="none"})),i.addEventListener("click",(function(){i.style.display="none"})),e>2?"flex"!==t.style.display?(t.style.display="flex",i.style.display="none"):t.style.display="none":"flex"!==i.style.display?(i.style.display="flex",t.style.display="none"):i.style.display="none"}}else void 0!==i.msg&&new PopUper({body:i.msg,style:"notify",controls:[{title:"OK",enter:!0}]});rating_vote_current_status=!1}}))}function titleRatingEmoji(t,e){0!==site_vars.current_user.id&&site_vars.current_user.rating<500?$.fancybox.open($("#popupRating")):!1===rating_vote_current_status&&void 0!==t&&t>0&&e>0&&e<9&&(rating_vote_current_status=!0,$.ajax({dataType:"json",type:"POST",url:"/ajax_server/forum/title_rating.php",cache:!1,data:{mode:"set_rating_emoji",title_id:t,emoji_id:e},success:function(t){rating_vote_current_status=!1}}))}function hideFromFeed(t){$(".pubsListBoxesItem[data-title-id="+t+"]").fadeOut()}document.addEventListener("click",(t=>{if(t.target.closest(".box-rating")&&1===$("#forum_content").length){let e=t.target.closest(".box-rating"),s=document.querySelector("[data-forum-id]").dataset.forumId;t.target.closest(".btn_like--like")&&titleRatingVote(s,5,e),t.target.closest(".btn_like--dislike")&&titleRatingVote(s,1,e)}})),$(document).on("click",".pubsItem__hidden",(function(){let t=$(this).closest(".pubsItem"),e=parseInt($(t).data("titleId"));e>0&&saveHidden(e,1)})),$(document).on("click",".pubsItem__favorite",(function(){let t=$(this).closest(".pubsItem"),e=parseInt($(t).data("titleId"));e>0&&(favorites("add",e,2),forum_subscribe(e,1),saveHidden(e,1))})),$(document).on("click",".pubsItem__subscribe",(function(){let t=$(this).closest(".pubsItem"),e=parseInt($(t).data("titleId"));e>0&&(forum_subscribe(e,1),favorites("add",e,2),saveHidden(e,1))})),$(document).on("click",".pubsItem__hidden, .pubsItem__subscribe, .pubsItem__favorite",(function(){let t=$(this).closest(".pubsItem");$(t).fadeOut(100,(function(){$(t).remove()}))})),$(document).on("click",".pubs_items__likes__up, .pubs_items__likes__down",(function(){let t=$(this).closest(".pubsItem"),e=parseInt($(t).find(".pubs_items__likes").data("titleId"));e>0&&($(this).hasClass("pubs_items__likes__up")?(titleRatingVote(e,5),saveHidden(e,1)):$(this).hasClass("pubs_items__likes__down")&&(titleRatingVote(e,1),saveHidden(e,1),$(t).fadeOut(100,(function(){$(t).remove()}))))})),document.addEventListener("click",(t=>{t.target.closest(".pubsItem__options")&&!t.target.closest(".pubsItem__option")||$(".pubsItem__optionsList").fadeOut(100)}));
</script>

</body>
</html>
