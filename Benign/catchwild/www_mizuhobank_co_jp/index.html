<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>index.html</title>
</head>
<body>

<script>
var kt, Tt, xt, Ot, jt;
(function(t) {
  t[t.Dimension = 0] = "Dimension", t[t.EventScan = 1] = "EventScan";
})(kt || (kt = {})), function(t) {
  t[t.Boolean = 1] = "Boolean", t[t.Number = 2] = "Number", t[t.String = 3] = "String", t[t.Any = 4] = "Any", t[t.Unknown = 5] = "Unknown";
}(Tt || (Tt = {})), function(t) {
  t[t.Binary = 10] = "Binary", t[t.Literal = 11] = "Literal", t[t.Call = 12] = "Call", t[t.Ref = 13] = "Ref", t[t.Not = 14] = "Not", t[t.Unspecified = 15] = "Unspecified";
}(xt || (xt = {})), function(t) {
  t[t.Strings = 20] = "Strings", t[t.Numbers = 21] = "Numbers", t[t.Booleans = 22] = "Booleans";
}(Ot || (Ot = {})), function(t) {
  t[t.And = 30] = "And", t[t.Or = 31] = "Or", t[t.Eq = 32] = "Eq", t[t.Ne = 33] = "Ne", t[t.Lt = 34] = "Lt", t[t.Le = 35] = "Le", t[t.Gt = 36] = "Gt", t[t.Ge = 37] = "Ge", t[t.Match = 38] = "Match";
}(jt || (jt = {}));
const Me = (t) => ({ v: 1, ...t }), H = "send_event", tt = "event_res", fn = "ctx-fired", mn = "context-event-session-updated", yn = "context-event-storage-cleared", bn = "request-context-event-send", Jn = "ktid-detected";
Me({ name: "sample", pub: [H], sub: [] }), Me({ name: "global-dispatcher", pub: [H, "send_customer", "talk", "local", "local_settings", "request_reset_visitor"], sub: [] }), Me({ name: "sender", pub: [tt, "meta-changed"], sub: [H, "visibility-changed", "cmp_status_changed", Jn, "visid-detected"], storage: !0 });
const Qn = { v: 1, name: "context_event", pub: [H, fn, mn, yn], sub: [H, tt, bn], storage: !0 }, wn = typeof global == "object" && global && global.Object === Object && global;
var ei = typeof self == "object" && self && self.Object === Object && self;
const S = wn || ei || Function("return this")(), M = S.Symbol;
var kn = Object.prototype, ti = kn.hasOwnProperty, ni = kn.toString, te = M ? M.toStringTag : void 0, ii = Object.prototype.toString, ri = "[object Null]", oi = "[object Undefined]", Ct = M ? M.toStringTag : void 0;
function J(t) {
  return t == null ? t === void 0 ? oi : ri : Ct && Ct in Object(t) ? function(e) {
    var n = ti.call(e, te), i = e[te];
    try {
      e[te] = void 0;
      var r = !0;
    } catch {
    }
    var o = ni.call(e);
    return r && (n ? e[te] = i : delete e[te]), o;
  }(t) : function(e) {
    return ii.call(e);
  }(t);
}
function Q(t) {
  return t != null && typeof t == "object";
}
var si = "[object Symbol]";
function Le(t) {
  return typeof t == "symbol" || Q(t) && J(t) == si;
}
const N = Array.isArray;
var ai = 1 / 0, Et = M ? M.prototype : void 0, It = Et ? Et.toString : void 0;
function Tn(t) {
  if (typeof t == "string")
    return t;
  if (N(t))
    return function(n, i) {
      for (var r = -1, o = n == null ? 0 : n.length, s = Array(o); ++r < o; )
        s[r] = i(n[r], r, n);
      return s;
    }(t, Tn) + "";
  if (Le(t))
    return It ? It.call(t) : "";
  var e = t + "";
  return e == "0" && 1 / t == -ai ? "-0" : e;
}
var ui = /\s/, li = /^\s+/;
function ci(t) {
  return t && t.slice(0, function(e) {
    for (var n = e.length; n-- && ui.test(e.charAt(n)); )
      ;
    return n;
  }(t) + 1).replace(li, "");
}
function A(t) {
  var e = typeof t;
  return t != null && (e == "object" || e == "function");
}
var Ht = NaN, hi = /^[-+]0x[0-9a-f]+$/i, di = /^0b[01]+$/i, gi = /^0o[0-7]+$/i, _i = parseInt;
function At(t) {
  if (typeof t == "number")
    return t;
  if (Le(t))
    return Ht;
  if (A(t)) {
    var e = typeof t.valueOf == "function" ? t.valueOf() : t;
    t = A(e) ? e + "" : e;
  }
  if (typeof t != "string")
    return t === 0 ? t : +t;
  t = ci(t);
  var n = di.test(t);
  return n || gi.test(t) ? _i(t.slice(2), n ? 2 : 8) : hi.test(t) ? Ht : +t;
}
var vi = "[object AsyncFunction]", pi = "[object Function]", fi = "[object GeneratorFunction]", mi = "[object Proxy]";
function xn(t) {
  if (!A(t))
    return !1;
  var e = J(t);
  return e == pi || e == fi || e == vi || e == mi;
}
const qe = S.t;
var St, Lt = (St = /[^.]+$/.exec(qe && qe.keys && qe.keys.IE_PROTO || "")) ? "Symbol(src)_1." + St : "", yi = Function.prototype.toString;
function z(t) {
  if (t != null) {
    try {
      return yi.call(t);
    } catch {
    }
    try {
      return t + "";
    } catch {
    }
  }
  return "";
}
var bi = /^\[object .+?Constructor\]$/, wi = Function.prototype, ki = Object.prototype, Ti = wi.toString, xi = ki.hasOwnProperty, Oi = RegExp("^" + Ti.call(xi).replace(/[\\^$.*+?()[\]{}|]/g, "\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g, "$1.*?") + "$");
function ji(t) {
  return !(!A(t) || (e = t, Lt && Lt in e)) && (xn(t) ? Oi : bi).test(z(t));
  var e;
}
function G(t, e) {
  var n = function(i, r) {
    return i == null ? void 0 : i[r];
  }(t, e);
  return ji(n) ? n : void 0;
}
const Ke = G(S, "WeakMap");
var Pt = Object.create;
const Ci = function() {
  function t() {
  }
  return function(e) {
    if (!A(e))
      return {};
    if (Pt)
      return Pt(e);
    t.prototype = e;
    var n = new t();
    return t.prototype = void 0, n;
  };
}();
var Ei = Date.now, Ii = function() {
  try {
    var t = G(Object, "defineProperty");
    return t({}, "", {}), t;
  } catch {
  }
}();
const Ae = Ii;
var Hi = Ae ? function(t, e) {
  return Ae(t, "toString", { configurable: !0, enumerable: !1, value: (n = e, function() {
    return n;
  }), writable: !0 });
  var n;
} : function(t) {
  return t;
}, Mt, De, Re;
const Ai = (Mt = Hi, De = 0, Re = 0, function() {
  var t = Ei(), e = 16 - (t - Re);
  if (Re = t, e > 0) {
    if (++De >= 800)
      return arguments[0];
  } else
    De = 0;
  return Mt.apply(void 0, arguments);
});
function Si(t) {
  return t != t;
}
function Li(t, e) {
  return !!(t != null && t.length) && function(n, i, r) {
    return i == i ? function(o, s, a) {
      for (var u = a - 1, l = o.length; ++u < l; )
        if (o[u] === s)
          return u;
      return -1;
    }(n, i, r) : function(o, s, a, u) {
      for (var l = o.length, c = a + (u ? 1 : -1); u ? c-- : ++c < l; )
        if (s(o[c], c, o))
          return c;
      return -1;
    }(n, Si, r);
  }(t, e, 0) > -1;
}
var Pi = 9007199254740991, Mi = /^(?:0|[1-9]\d*)$/;
function nt(t, e) {
  var n = typeof t;
  return !!(e = e == null ? Pi : e) && (n == "number" || n != "symbol" && Mi.test(t)) && t > -1 && t % 1 == 0 && t < e;
}
function On(t, e, n) {
  e == "__proto__" && Ae ? Ae(t, e, { configurable: !0, enumerable: !0, value: n, writable: !0 }) : t[e] = n;
}
function jn(t, e) {
  return t === e || t != t && e != e;
}
var qi = Object.prototype.hasOwnProperty;
function it(t, e, n) {
  var i = t[e];
  qi.call(t, e) && jn(i, n) && (n !== void 0 || e in t) || On(t, e, n);
}
function le(t, e, n, i) {
  var r = !n;
  n || (n = {});
  for (var o = -1, s = e.length; ++o < s; ) {
    var a = e[o], u = i ? i(n[a], t[a], a, n, t) : void 0;
    u === void 0 && (u = t[a]), r ? On(n, a, u) : it(n, a, u);
  }
  return n;
}
var qt = Math.max, Di = 9007199254740991;
function rt(t) {
  return typeof t == "number" && t > -1 && t % 1 == 0 && t <= Di;
}
function Cn(t) {
  return t != null && rt(t.length) && !xn(t);
}
var Ri = Object.prototype;
function ot(t) {
  var e = t && t.constructor;
  return t === (typeof e == "function" && e.prototype || Ri);
}
function Dt(t) {
  return Q(t) && J(t) == "[object Arguments]";
}
var En = Object.prototype, Ni = En.hasOwnProperty, Fi = En.propertyIsEnumerable;
const st = Dt(function() {
  return arguments;
}()) ? Dt : function(t) {
  return Q(t) && Ni.call(t, "callee") && !Fi.call(t, "callee");
};
var In = typeof exports == "object" && exports && !exports.nodeType && exports, Rt = In && typeof module == "object" && module && !module.nodeType && module, Nt = Rt && Rt.exports === In ? S.Buffer : void 0;
const Hn = (Nt ? Nt.isBuffer : void 0) || function() {
  return !1;
};
var x = {};
function at(t) {
  return function(e) {
    return t(e);
  };
}
x["[object Float32Array]"] = x["[object Float64Array]"] = x["[object Int8Array]"] = x["[object Int16Array]"] = x["[object Int32Array]"] = x["[object Uint8Array]"] = x["[object Uint8ClampedArray]"] = x["[object Uint16Array]"] = x["[object Uint32Array]"] = !0, x["[object Arguments]"] = x["[object Array]"] = x["[object ArrayBuffer]"] = x["[object Boolean]"] = x["[object DataView]"] = x["[object Date]"] = x["[object Error]"] = x["[object Function]"] = x["[object Map]"] = x["[object Number]"] = x["[object Object]"] = x["[object RegExp]"] = x["[object Set]"] = x["[object String]"] = x["[object WeakMap]"] = !1;
var An = typeof exports == "object" && exports && !exports.nodeType && exports, ae = An && typeof module == "object" && module && !module.nodeType && module, Ne = ae && ae.exports === An && wn.process;
const W = function() {
  try {
    var t = ae && ae.require && ae.require("util").types;
    return t || Ne && Ne.binding && Ne.binding("util");
  } catch {
  }
}();
var Ft = W && W.isTypedArray;
const Vi = Ft ? at(Ft) : function(t) {
  return Q(t) && rt(t.length) && !!x[J(t)];
};
var Ui = Object.prototype.hasOwnProperty;
function Sn(t, e) {
  var n = N(t), i = !n && st(t), r = !n && !i && Hn(t), o = !n && !i && !r && Vi(t), s = n || i || r || o, a = s ? function(c, h) {
    for (var g = -1, d = Array(c); ++g < c; )
      d[g] = h(g);
    return d;
  }(t.length, String) : [], u = a.length;
  for (var l in t)
    !e && !Ui.call(t, l) || s && (l == "length" || r && (l == "offset" || l == "parent") || o && (l == "buffer" || l == "byteLength" || l == "byteOffset") || nt(l, u)) || a.push(l);
  return a;
}
function Ln(t, e) {
  return function(n) {
    return t(e(n));
  };
}
const $i = Ln(Object.keys, Object);
var zi = Object.prototype.hasOwnProperty;
function Xe(t) {
  return Cn(t) ? Sn(t) : function(e) {
    if (!ot(e))
      return $i(e);
    var n = [];
    for (var i in Object(e))
      zi.call(e, i) && i != "constructor" && n.push(i);
    return n;
  }(t);
}
var Gi = Object.prototype.hasOwnProperty;
function Bi(t) {
  if (!A(t))
    return function(r) {
      var o = [];
      if (r != null)
        for (var s in Object(r))
          o.push(s);
      return o;
    }(t);
  var e = ot(t), n = [];
  for (var i in t)
    (i != "constructor" || !e && Gi.call(t, i)) && n.push(i);
  return n;
}
function Ye(t) {
  return Cn(t) ? Sn(t, !0) : Bi(t);
}
var Ki = /\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/, Xi = /^\w*$/;
const ne = G(Object, "create");
var Yi = Object.prototype.hasOwnProperty, Zi = Object.prototype.hasOwnProperty;
function U(t) {
  var e = -1, n = t == null ? 0 : t.length;
  for (this.clear(); ++e < n; ) {
    var i = t[e];
    this.set(i[0], i[1]);
  }
}
function ce(t, e) {
  for (var n = t.length; n--; )
    if (jn(t[n][0], e))
      return n;
  return -1;
}
U.prototype.clear = function() {
  this.i = ne ? ne(null) : {}, this.size = 0;
}, U.prototype.delete = function(t) {
  var e = this.has(t) && delete this.i[t];
  return this.size -= e ? 1 : 0, e;
}, U.prototype.get = function(t) {
  var e = this.i;
  if (ne) {
    var n = e[t];
    return n === "__lodash_hash_undefined__" ? void 0 : n;
  }
  return Yi.call(e, t) ? e[t] : void 0;
}, U.prototype.has = function(t) {
  var e = this.i;
  return ne ? e[t] !== void 0 : Zi.call(e, t);
}, U.prototype.set = function(t, e) {
  var n = this.i;
  return this.size += this.has(t) ? 0 : 1, n[t] = ne && e === void 0 ? "__lodash_hash_undefined__" : e, this;
};
var Wi = Array.prototype.splice;
function q(t) {
  var e = -1, n = t == null ? 0 : t.length;
  for (this.clear(); ++e < n; ) {
    var i = t[e];
    this.set(i[0], i[1]);
  }
}
q.prototype.clear = function() {
  this.i = [], this.size = 0;
}, q.prototype.delete = function(t) {
  var e = this.i, n = ce(e, t);
  return !(n < 0) && (n == e.length - 1 ? e.pop() : Wi.call(e, n, 1), --this.size, !0);
}, q.prototype.get = function(t) {
  var e = this.i, n = ce(e, t);
  return n < 0 ? void 0 : e[n][1];
}, q.prototype.has = function(t) {
  return ce(this.i, t) > -1;
}, q.prototype.set = function(t, e) {
  var n = this.i, i = ce(n, t);
  return i < 0 ? (++this.size, n.push([t, e])) : n[i][1] = e, this;
};
const ue = G(S, "Map");
function he(t, e) {
  var n, i, r = t.i;
  return ((i = typeof (n = e)) == "string" || i == "number" || i == "symbol" || i == "boolean" ? n !== "__proto__" : n === null) ? r[typeof e == "string" ? "string" : "hash"] : r.map;
}
function D(t) {
  var e = -1, n = t == null ? 0 : t.length;
  for (this.clear(); ++e < n; ) {
    var i = t[e];
    this.set(i[0], i[1]);
  }
}
D.prototype.clear = function() {
  this.size = 0, this.i = { hash: new U(), map: new (ue || q)(), string: new U() };
}, D.prototype.delete = function(t) {
  var e = he(this, t).delete(t);
  return this.size -= e ? 1 : 0, e;
}, D.prototype.get = function(t) {
  return he(this, t).get(t);
}, D.prototype.has = function(t) {
  return he(this, t).has(t);
}, D.prototype.set = function(t, e) {
  var n = he(this, t), i = n.size;
  return n.set(t, e), this.size += n.size == i ? 0 : 1, this;
};
var Ji = "Expected a function";
function ut(t, e) {
  if (typeof t != "function" || e != null && typeof e != "function")
    throw new TypeError(Ji);
  var n = function() {
    var i = arguments, r = e ? e.apply(this, i) : i[0], o = n.cache;
    if (o.has(r))
      return o.get(r);
    var s = t.apply(this, i);
    return n.cache = o.set(r, s) || o, s;
  };
  return n.cache = new (ut.Cache || D)(), n;
}
ut.Cache = D;
var Qi = /[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g, er = /\\(\\)?/g, tr = function(t) {
  var e = ut(t, function(i) {
    return n.size === 500 && n.clear(), i;
  }), n = e.cache;
  return e;
}(function(t) {
  var e = [];
  return t.charCodeAt(0) === 46 && e.push(""), t.replace(Qi, function(n, i, r, o) {
    e.push(r ? o.replace(er, "$1") : i || n);
  }), e;
});
const nr = tr;
function Pe(t, e) {
  return N(t) ? t : function(n, i) {
    if (N(n))
      return !1;
    var r = typeof n;
    return !(r != "number" && r != "symbol" && r != "boolean" && n != null && !Le(n)) || Xi.test(n) || !Ki.test(n) || i != null && n in Object(i);
  }(t, e) ? [t] : nr(function(n) {
    return n == null ? "" : Tn(n);
  }(t));
}
var ir = 1 / 0;
function lt(t) {
  if (typeof t == "string" || Le(t))
    return t;
  var e = t + "";
  return e == "0" && 1 / t == -ir ? "-0" : e;
}
function rr(t, e) {
  for (var n = 0, i = (e = Pe(e, t)).length; t != null && n < i; )
    t = t[lt(e[n++])];
  return n && n == i ? t : void 0;
}
function ct(t, e) {
  for (var n = -1, i = e.length, r = t.length; ++n < i; )
    t[r + n] = e[n];
  return t;
}
var Vt = M ? M.isConcatSpreadable : void 0;
function or(t) {
  return N(t) || st(t) || !!(Vt && t && t[Vt]);
}
function Pn(t, e, n, i, r) {
  var o = -1, s = t.length;
  for (n || (n = or), r || (r = []); ++o < s; ) {
    var a = t[o];
    e > 0 && n(a) ? e > 1 ? Pn(a, e - 1, n, i, r) : ct(r, a) : i || (r[r.length] = a);
  }
  return r;
}
function sr(t) {
  return t != null && t.length ? Pn(t, 1) : [];
}
const Mn = Ln(Object.getPrototypeOf, Object);
function K(t) {
  var e = this.i = new q(t);
  this.size = e.size;
}
K.prototype.clear = function() {
  this.i = new q(), this.size = 0;
}, K.prototype.delete = function(t) {
  var e = this.i, n = e.delete(t);
  return this.size = e.size, n;
}, K.prototype.get = function(t) {
  return this.i.get(t);
}, K.prototype.has = function(t) {
  return this.i.has(t);
}, K.prototype.set = function(t, e) {
  var n = this.i;
  if (n instanceof q) {
    var i = n.i;
    if (!ue || i.length < 199)
      return i.push([t, e]), this.size = ++n.size, this;
    n = this.i = new D(i);
  }
  return n.set(t, e), this.size = n.size, this;
};
var qn = typeof exports == "object" && exports && !exports.nodeType && exports, Ut = qn && typeof module == "object" && module && !module.nodeType && module, $t = Ut && Ut.exports === qn ? S.Buffer : void 0, zt = $t ? $t.allocUnsafe : void 0;
function Dn() {
  return [];
}
var ar = Object.prototype.propertyIsEnumerable, Gt = Object.getOwnPropertySymbols;
const ht = Gt ? function(t) {
  return t == null ? [] : (t = Object(t), function(e, n) {
    for (var i = -1, r = e == null ? 0 : e.length, o = 0, s = []; ++i < r; ) {
      var a = e[i];
      n(a, i, e) && (s[o++] = a);
    }
    return s;
  }(Gt(t), function(e) {
    return ar.call(t, e);
  }));
} : Dn, Rn = Object.getOwnPropertySymbols ? function(t) {
  for (var e = []; t; )
    ct(e, ht(t)), t = Mn(t);
  return e;
} : Dn;
function Nn(t, e, n) {
  var i = e(t);
  return N(t) ? i : ct(i, n(t));
}
function ur(t) {
  return Nn(t, Xe, ht);
}
function lr(t) {
  return Nn(t, Ye, Rn);
}
const Ze = G(S, "DataView"), We = G(S, "Promise"), Y = G(S, "Set");
var Bt = "[object Map]", Kt = "[object Promise]", Xt = "[object Set]", Yt = "[object WeakMap]", Zt = "[object DataView]", cr = z(Ze), hr = z(ue), dr = z(We), gr = z(Y), _r = z(Ke), V = J;
(Ze && V(new Ze(new ArrayBuffer(1))) != Zt || ue && V(new ue()) != Bt || We && V(We.resolve()) != Kt || Y && V(new Y()) != Xt || Ke && V(new Ke()) != Yt) && (V = function(t) {
  var e = J(t), n = e == "[object Object]" ? t.constructor : void 0, i = n ? z(n) : "";
  if (i)
    switch (i) {
      case cr:
        return Zt;
      case hr:
        return Bt;
      case dr:
        return Kt;
      case gr:
        return Xt;
      case _r:
        return Yt;
    }
  return e;
});
const dt = V;
var vr = Object.prototype.hasOwnProperty;
const Wt = S.Uint8Array;
function Fe(t) {
  var e = new t.constructor(t.byteLength);
  return new Wt(e).set(new Wt(t)), e;
}
var pr = /\w*$/, Jt = M ? M.prototype : void 0, Qt = Jt ? Jt.valueOf : void 0, fr = "[object Boolean]", mr = "[object Date]", yr = "[object Map]", br = "[object Number]", wr = "[object RegExp]", kr = "[object Set]", Tr = "[object String]", xr = "[object Symbol]", Or = "[object ArrayBuffer]", jr = "[object DataView]", Cr = "[object Float32Array]", Er = "[object Float64Array]", Ir = "[object Int8Array]", Hr = "[object Int16Array]", Ar = "[object Int32Array]", Sr = "[object Uint8Array]", Lr = "[object Uint8ClampedArray]", Pr = "[object Uint16Array]", Mr = "[object Uint32Array]";
function qr(t, e, n) {
  var i, r, o, s = t.constructor;
  switch (e) {
    case Or:
      return Fe(t);
    case fr:
    case mr:
      return new s(+t);
    case jr:
      return function(a, u) {
        var l = u ? Fe(a.buffer) : a.buffer;
        return new a.constructor(l, a.byteOffset, a.byteLength);
      }(t, n);
    case Cr:
    case Er:
    case Ir:
    case Hr:
    case Ar:
    case Sr:
    case Lr:
    case Pr:
    case Mr:
      return function(a, u) {
        var l = u ? Fe(a.buffer) : a.buffer;
        return new a.constructor(l, a.byteOffset, a.length);
      }(t, n);
    case yr:
      return new s();
    case br:
    case Tr:
      return new s(t);
    case wr:
      return (o = new (r = t).constructor(r.source, pr.exec(r))).lastIndex = r.lastIndex, o;
    case kr:
      return new s();
    case xr:
      return i = t, Qt ? Object(Qt.call(i)) : {};
  }
}
var en = W && W.isMap;
const Dr = en ? at(en) : function(t) {
  return Q(t) && dt(t) == "[object Map]";
};
var tn = W && W.isSet;
const Rr = tn ? at(tn) : function(t) {
  return Q(t) && dt(t) == "[object Set]";
};
var Nr = 1, Fr = 2, Vr = 4, Fn = "[object Arguments]", Vn = "[object Function]", Ur = "[object GeneratorFunction]", Un = "[object Object]", T = {};
function we(t, e, n, i, r, o) {
  var s, a = e & Nr, u = e & Fr, l = e & Vr;
  if (n && (s = r ? n(t, i, r, o) : n(t)), s !== void 0)
    return s;
  if (!A(t))
    return t;
  var c = N(t);
  if (c) {
    if (s = function(_) {
      var v = _.length, m = new _.constructor(v);
      return v && typeof _[0] == "string" && vr.call(_, "index") && (m.index = _.index, m.input = _.input), m;
    }(t), !a)
      return function(_, v) {
        var m = -1, f = _.length;
        for (v || (v = Array(f)); ++m < f; )
          v[m] = _[m];
        return v;
      }(t, s);
  } else {
    var h = dt(t), g = h == Vn || h == Ur;
    if (Hn(t))
      return function(_, v) {
        if (v)
          return _.slice();
        var m = _.length, f = zt ? zt(m) : new _.constructor(m);
        return _.copy(f), f;
      }(t, a);
    if (h == Un || h == Fn || g && !r) {
      if (s = u || g ? {} : function(_) {
        return typeof _.constructor != "function" || ot(_) ? {} : Ci(Mn(_));
      }(t), !a)
        return u ? function(_, v) {
          return le(_, Rn(_), v);
        }(t, function(_, v) {
          return _ && le(v, Ye(v), _);
        }(s, t)) : function(_, v) {
          return le(_, ht(_), v);
        }(t, function(_, v) {
          return _ && le(v, Xe(v), _);
        }(s, t));
    } else {
      if (!T[h])
        return r ? t : {};
      s = qr(t, h, a);
    }
  }
  o || (o = new K());
  var d = o.get(t);
  if (d)
    return d;
  o.set(t, s), Rr(t) ? t.forEach(function(_) {
    s.add(we(_, e, n, _, t, o));
  }) : Dr(t) && t.forEach(function(_, v) {
    s.set(v, we(_, e, n, v, t, o));
  });
  var p = c ? void 0 : (l ? u ? lr : ur : u ? Ye : Xe)(t);
  return function(_, v) {
    for (var m = -1, f = _ == null ? 0 : _.length; ++m < f && v(_[m], m, _) !== !1; )
      ;
  }(p || t, function(_, v) {
    p && (_ = t[v = _]), it(s, v, we(_, e, n, v, t, o));
  }), s;
}
T[Fn] = T["[object Array]"] = T["[object ArrayBuffer]"] = T["[object DataView]"] = T["[object Boolean]"] = T["[object Date]"] = T["[object Float32Array]"] = T["[object Float64Array]"] = T["[object Int8Array]"] = T["[object Int16Array]"] = T["[object Int32Array]"] = T["[object Map]"] = T["[object Number]"] = T[Un] = T["[object RegExp]"] = T["[object Set]"] = T["[object String]"] = T["[object Symbol]"] = T["[object Uint8Array]"] = T["[object Uint8ClampedArray]"] = T["[object Uint16Array]"] = T["[object Uint32Array]"] = !0, T["[object Error]"] = T[Vn] = T["[object WeakMap]"] = !1;
function ke(t) {
  var e = -1, n = t == null ? 0 : t.length;
  for (this.i = new D(); ++e < n; )
    this.add(t[e]);
}
function $r(t, e) {
  return t.has(e);
}
function $n(t) {
  var e = -1, n = Array(t.size);
  return t.forEach(function(i) {
    n[++e] = i;
  }), n;
}
function zr(t, e) {
  return t != null && e in Object(t);
}
function Gr(t, e) {
  return t != null && function(n, i, r) {
    for (var o = -1, s = (i = Pe(i, n)).length, a = !1; ++o < s; ) {
      var u = lt(i[o]);
      if (!(a = n != null && r(n, u)))
        break;
      n = n[u];
    }
    return a || ++o != s ? a : !!(s = n == null ? 0 : n.length) && rt(s) && nt(u, s) && (N(n) || st(n));
  }(t, e, zr);
}
ke.prototype.add = ke.prototype.push = function(t) {
  return this.i.set(t, "__lodash_hash_undefined__"), this;
}, ke.prototype.has = function(t) {
  return this.i.has(t);
};
const Ve = function() {
  return S.Date.now();
};
var Br = "Expected a function", Kr = Math.max, Xr = Math.min;
function Yr(t, e, n) {
  var i, r, o, s, a, u, l = 0, c = !1, h = !1, g = !0;
  if (typeof t != "function")
    throw new TypeError(Br);
  function d(f) {
    var y = i, b = r;
    return i = r = void 0, l = f, s = t.apply(b, y);
  }
  function p(f) {
    var y = f - u;
    return u === void 0 || y >= e || y < 0 || h && f - l >= o;
  }
  function _() {
    var f = Ve();
    if (p(f))
      return v(f);
    a = setTimeout(_, function(y) {
      var b = e - (y - u);
      return h ? Xr(b, o - (y - l)) : b;
    }(f));
  }
  function v(f) {
    return a = void 0, g && i ? d(f) : (i = r = void 0, s);
  }
  function m() {
    var f = Ve(), y = p(f);
    if (i = arguments, r = this, u = f, y) {
      if (a === void 0)
        return function(b) {
          return l = b, a = setTimeout(_, e), c ? d(b) : s;
        }(u);
      if (h)
        return clearTimeout(a), a = setTimeout(_, e), d(u);
    }
    return a === void 0 && (a = setTimeout(_, e)), s;
  }
  return e = At(e) || 0, A(n) && (c = !!n.leading, o = (h = "maxWait" in n) ? Kr(At(n.maxWait) || 0, e) : o, g = "trailing" in n ? !!n.trailing : g), m.cancel = function() {
    a !== void 0 && clearTimeout(a), l = 0, i = u = r = a = void 0;
  }, m.flush = function() {
    return a === void 0 ? s : v(Ve());
  }, m;
}
function Zr(t, e, n) {
  for (var i = -1, r = t == null ? 0 : t.length; ++i < r; )
    if (n(e, t[i]))
      return !0;
  return !1;
}
function Wr(t, e, n, i) {
  if (!A(t))
    return t;
  for (var r = -1, o = (e = Pe(e, t)).length, s = o - 1, a = t; a != null && ++r < o; ) {
    var u = lt(e[r]), l = n;
    if (u === "__proto__" || u === "constructor" || u === "prototype")
      return t;
    if (r != s) {
      var c = a[u];
      (l = i ? i(c, u, a) : void 0) === void 0 && (l = A(c) ? c : nt(e[r + 1]) ? [] : {});
    }
    it(a, u, l), a = a[u];
  }
  return t;
}
function Jr(t, e) {
  return function(n, i, r) {
    for (var o = -1, s = i.length, a = {}; ++o < s; ) {
      var u = i[o], l = rr(n, u);
      r(l, u) && Wr(a, Pe(u, n), l);
    }
    return a;
  }(t, e, function(n, i) {
    return Gr(t, i);
  });
}
var Qr = function(t) {
  return Ai(function(e, n, i) {
    return n = qt(n === void 0 ? e.length - 1 : n, 0), function() {
      for (var r = arguments, o = -1, s = qt(r.length - n, 0), a = Array(s); ++o < s; )
        a[o] = r[n + o];
      o = -1;
      for (var u = Array(n + 1); ++o < n; )
        u[o] = r[o];
      return u[n] = i(a), function(l, c, h) {
        switch (h.length) {
          case 0:
            return l.call(c);
          case 1:
            return l.call(c, h[0]);
          case 2:
            return l.call(c, h[0], h[1]);
          case 3:
            return l.call(c, h[0], h[1], h[2]);
        }
        return l.apply(c, h);
      }(e, this, u);
    };
  }(t, void 0, sr), t + "");
}(function(t, e) {
  return t == null ? {} : Jr(t, e);
});
const zn = Qr;
function de(t, e, n) {
  var i = !0, r = !0;
  if (typeof t != "function")
    throw new TypeError("Expected a function");
  return A(n) && (i = "leading" in n ? !!n.leading : i, r = "trailing" in n ? !!n.trailing : r), Yr(t, e, { leading: i, maxWait: e, trailing: r });
}
const eo = Y && 1 / $n(new Y([, -0]))[1] == 1 / 0 ? function(t) {
  return new Y(t);
} : function() {
};
var to = 200;
function ge(t) {
  return t && t.length ? function(e, n, i) {
    var r = -1, o = Li, s = e.length, a = !0, u = [], l = u;
    if (i)
      a = !1, o = Zr;
    else if (s >= to) {
      var c = n ? null : eo(e);
      if (c)
        return $n(c);
      a = !1, o = $r, l = new ke();
    } else
      l = n ? [] : u;
    e:
      for (; ++r < s; ) {
        var h = e[r], g = n ? n(h) : h;
        if (h = i || h !== 0 ? h : 0, a && g == g) {
          for (var d = l.length; d--; )
            if (l[d] === g)
              continue e;
          n && l.push(g), u.push(h);
        } else
          o(l, g, i) || (l !== u && l.push(g), u.push(h));
      }
    return u;
  }(t) : [];
}
var Gn, Je = { exports: {} }, Z = typeof Reflect == "object" ? Reflect : null, nn = Z && typeof Z.apply == "function" ? Z.apply : function(t, e, n) {
  return Function.prototype.apply.call(t, e, n);
};
Gn = Z && typeof Z.ownKeys == "function" ? Z.ownKeys : Object.getOwnPropertySymbols ? function(t) {
  return Object.getOwnPropertyNames(t).concat(Object.getOwnPropertySymbols(t));
} : function(t) {
  return Object.getOwnPropertyNames(t);
};
var rn = Number.isNaN || function(t) {
  return t != t;
};
function k() {
  k.init.call(this);
}
Je.exports = k, Je.exports.once = function(t, e) {
  return new Promise(function(n, i) {
    function r(s) {
      t.removeListener(e, o), i(s);
    }
    function o() {
      typeof t.removeListener == "function" && t.removeListener("error", r), n([].slice.call(arguments));
    }
    cn(t, e, o, { once: !0 }), e !== "error" && function(s, a, u) {
      typeof s.on == "function" && cn(s, "error", a, u);
    }(t, r, { once: !0 });
  });
}, k.EventEmitter = k, k.prototype.o = void 0, k.prototype.u = 0, k.prototype.l = void 0;
var on = 10;
function Te(t) {
  if (typeof t != "function")
    throw new TypeError('The "listener" argument must be of type Function. Received type ' + typeof t);
}
function Bn(t) {
  return t.l === void 0 ? k.defaultMaxListeners : t.l;
}
function sn(t, e, n, i) {
  var r, o, s, a;
  if (Te(n), (o = t.o) === void 0 ? (o = t.o = /* @__PURE__ */ Object.create(null), t.u = 0) : (o.newListener !== void 0 && (t.emit("newListener", e, n.listener ? n.listener : n), o = t.o), s = o[e]), s === void 0)
    s = o[e] = n, ++t.u;
  else if (typeof s == "function" ? s = o[e] = i ? [n, s] : [s, n] : i ? s.unshift(n) : s.push(n), (r = Bn(t)) > 0 && s.length > r && !s.warned) {
    s.warned = !0;
    var u = new Error("Possible EventEmitter memory leak detected. " + s.length + " " + String(e) + " listeners added. Use emitter.setMaxListeners() to increase limit");
    u.name = "MaxListenersExceededWarning", u.emitter = t, u.type = e, u.count = s.length, a = u, console && console.warn && console.warn(a);
  }
  return t;
}
function no() {
  if (!this.fired)
    return this.target.removeListener(this.type, this.wrapFn), this.fired = !0, arguments.length === 0 ? this.listener.call(this.target) : this.listener.apply(this.target, arguments);
}
function an(t, e, n) {
  var i = { fired: !1, wrapFn: void 0, target: t, type: e, listener: n }, r = no.bind(i);
  return r.listener = n, i.wrapFn = r, r;
}
function un(t, e, n) {
  var i = t.o;
  if (i === void 0)
    return [];
  var r = i[e];
  return r === void 0 ? [] : typeof r == "function" ? n ? [r.listener || r] : [r] : n ? function(o) {
    for (var s = new Array(o.length), a = 0; a < s.length; ++a)
      s[a] = o[a].listener || o[a];
    return s;
  }(r) : Kn(r, r.length);
}
function ln(t) {
  var e = this.o;
  if (e !== void 0) {
    var n = e[t];
    if (typeof n == "function")
      return 1;
    if (n !== void 0)
      return n.length;
  }
  return 0;
}
function Kn(t, e) {
  for (var n = new Array(e), i = 0; i < e; ++i)
    n[i] = t[i];
  return n;
}
function cn(t, e, n, i) {
  if (typeof t.on == "function")
    i.once ? t.once(e, n) : t.on(e, n);
  else {
    if (typeof t.addEventListener != "function")
      throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type ' + typeof t);
    t.addEventListener(e, function r(o) {
      i.once && t.removeEventListener(e, r), n(o);
    });
  }
}
Object.defineProperty(k, "defaultMaxListeners", { enumerable: !0, get: function() {
  return on;
}, set: function(t) {
  if (typeof t != "number" || t < 0 || rn(t))
    throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received ' + t + ".");
  on = t;
} }), k.init = function() {
  this.o !== void 0 && this.o !== Object.getPrototypeOf(this).o || (this.o = /* @__PURE__ */ Object.create(null), this.u = 0), this.l = this.l || void 0;
}, k.prototype.setMaxListeners = function(t) {
  if (typeof t != "number" || t < 0 || rn(t))
    throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received ' + t + ".");
  return this.l = t, this;
}, k.prototype.getMaxListeners = function() {
  return Bn(this);
}, k.prototype.emit = function(t) {
  for (var e = [], n = 1; n < arguments.length; n++)
    e.push(arguments[n]);
  var i = t === "error", r = this.o;
  if (r !== void 0)
    i = i && r.error === void 0;
  else if (!i)
    return !1;
  if (i) {
    var o;
    if (e.length > 0 && (o = e[0]), o instanceof Error)
      throw o;
    var s = new Error("Unhandled error." + (o ? " (" + o.message + ")" : ""));
    throw s.context = o, s;
  }
  var a = r[t];
  if (a === void 0)
    return !1;
  if (typeof a == "function")
    nn(a, this, e);
  else {
    var u = a.length, l = Kn(a, u);
    for (n = 0; n < u; ++n)
      nn(l[n], this, e);
  }
  return !0;
}, k.prototype.addListener = function(t, e) {
  return sn(this, t, e, !1);
}, k.prototype.on = k.prototype.addListener, k.prototype.prependListener = function(t, e) {
  return sn(this, t, e, !0);
}, k.prototype.once = function(t, e) {
  return Te(e), this.on(t, an(this, t, e)), this;
}, k.prototype.prependOnceListener = function(t, e) {
  return Te(e), this.prependListener(t, an(this, t, e)), this;
}, k.prototype.removeListener = function(t, e) {
  var n, i, r, o, s;
  if (Te(e), (i = this.o) === void 0)
    return this;
  if ((n = i[t]) === void 0)
    return this;
  if (n === e || n.listener === e)
    --this.u == 0 ? this.o = /* @__PURE__ */ Object.create(null) : (delete i[t], i.removeListener && this.emit("removeListener", t, n.listener || e));
  else if (typeof n != "function") {
    for (r = -1, o = n.length - 1; o >= 0; o--)
      if (n[o] === e || n[o].listener === e) {
        s = n[o].listener, r = o;
        break;
      }
    if (r < 0)
      return this;
    r === 0 ? n.shift() : function(a, u) {
      for (; u + 1 < a.length; u++)
        a[u] = a[u + 1];
      a.pop();
    }(n, r), n.length === 1 && (i[t] = n[0]), i.removeListener !== void 0 && this.emit("removeListener", t, s || e);
  }
  return this;
}, k.prototype.off = k.prototype.removeListener, k.prototype.removeAllListeners = function(t) {
  var e, n, i;
  if ((n = this.o) === void 0)
    return this;
  if (n.removeListener === void 0)
    return arguments.length === 0 ? (this.o = /* @__PURE__ */ Object.create(null), this.u = 0) : n[t] !== void 0 && (--this.u == 0 ? this.o = /* @__PURE__ */ Object.create(null) : delete n[t]), this;
  if (arguments.length === 0) {
    var r, o = Object.keys(n);
    for (i = 0; i < o.length; ++i)
      (r = o[i]) !== "removeListener" && this.removeAllListeners(r);
    return this.removeAllListeners("removeListener"), this.o = /* @__PURE__ */ Object.create(null), this.u = 0, this;
  }
  if (typeof (e = n[t]) == "function")
    this.removeListener(t, e);
  else if (e !== void 0)
    for (i = e.length - 1; i >= 0; i--)
      this.removeListener(t, e[i]);
  return this;
}, k.prototype.listeners = function(t) {
  return un(this, t, !0);
}, k.prototype.rawListeners = function(t) {
  return un(this, t, !1);
}, k.listenerCount = function(t, e) {
  return typeof t.listenerCount == "function" ? t.listenerCount(e) : ln.call(t, e);
}, k.prototype.listenerCount = ln, k.prototype.eventNames = function() {
  return this.u > 0 ? Gn(this.o) : [];
};
class io extends Je.exports.EventEmitter {
  constructor(e, n, i, r) {
    super(), this.init = function() {
      var o;
      if (o = this, this.item)
        return this.item.addEventListener("click", function(s) {
          var a, u;
          if (!o.h)
            return u = o.options, a = { event_name: o.event_name, values: u, clickEvent: s }, o.emit("click", a);
        });
    }, this.destroy = function() {
      return this.h = !0;
    }, this.item = e, this.event_name = n, this.delegate = i, this.options = r != null ? r : {}, this.init(), this.h = !1;
  }
}
const ro = ["top", "search", "category", "item_detail", "article", "cart", "cv_staging", "cv", "faq_top", "faq_category", "faq_detail", "inquiry_page", "inquiry_form"];
function R(t) {
  return t ? t.replace(/["'<>]/g, "") : null;
}
function Se(t) {
  return t ? t.replace(/[\x00-\x1F\x7F-\x9F]/g, "") : null;
}
function gt(t) {
  let e = [];
  return t.split("%").forEach(function(n, i) {
    if (i === 0) {
      if (n.length > 0)
        for (let r = 0; r < n.length; r++)
          e.push(n.charCodeAt(r));
    } else {
      const r = n.slice(2), o = n.slice(0, 2);
      if (e.push(parseInt(o, 16)), r.length > 0)
        for (let s = 0; s < r.length; s++)
          e.push(r.charCodeAt(s));
    }
  }), new Uint8Array(e);
}
const $ = (t) => {
  if (document.querySelectorAll)
    try {
      return document.querySelectorAll(t);
    } catch (e) {
      return console.error(`'${t}' is invalid selectors.`, e), document.createDocumentFragment().childNodes;
    }
  else
    console.error("document.querySelectorAll is missing.");
}, oo = (t) => {
  if (document.querySelector)
    try {
      return document.querySelector(t);
    } catch (e) {
      return console.error(`'${t}' is invalid selectors.`, e), null;
    }
  else
    console.error("document.querySelector is missing.");
};
let X = null;
const hn = function() {
  let t;
  return X = {}, t = location.search.substring(1).split("&"), t.map(function(e) {
    var n;
    if ((n = e.split("=")).length === 2)
      return X[n[0]] = n[1];
  });
}, dn = function(t) {
  let e, n, i;
  return n = {}, i = t.split("?")[1] || "", e = i.split("&"), e.map(function(r) {
    var o;
    if ((o = r.split("=")).length === 2)
      return n[o[0]] = o[1];
  }), n;
}, se = function(t, e) {
  var n;
  return t ? (n = null, e ? n = t.getAttribute(e) : (n = t.textContent || t.title || t.value) === void 0 && (n = t.innerText), n && (n = (n = R(Se(n))) != null ? n.trim() : void 0), n) : null;
}, Ue = function(t) {
  let e, n, i, r, o;
  if (document.evaluate) {
    if (o = document.evaluate("//*[normalize-space(text())='" + t + "' or normalize-space(@title)='" + t + "' or normalize-space(@value)='" + t + "']", document, null, XPathResult.ORDERED_NODE_SNAPSHOT_TYPE, null), o.snapshotLength === 0)
      return [];
    for (e = [], n = i = 0, r = o.snapshotLength - 1; 0 <= r ? i <= r : i >= r; n = 0 <= r ? ++i : --i)
      e.push(o.snapshotItem(n));
    return e;
  }
}, _e = (t, e) => {
  let n, i;
  if (document.evaluate)
    return n = [], t && (e != null ? e.length : void 0) > 0 ? (n = Array.prototype.slice.call($(t)), i = e.map(function(r) {
      return { text_value: r, compare: "string_partial_match" };
    }), n = n.filter(function(r) {
      return Qe(r, i);
    })) : !t || e && e.length !== 0 ? !t && (e != null ? e.length : void 0) > 0 && (n = function(r) {
      let o, s, a, u, l, c;
      if (!r || r.length === 0 || !document.evaluate)
        return null;
      if (s = r.map(function(h) {
        return "contains(normalize-space(text()), '" + h + "') or contains(normalize-space(@title), '" + h + "') or contains(normalize-space(@value), '" + h + "')";
      }).join(" or "), s = "//*[" + s + "]", c = document.evaluate(s, document, null, XPathResult.ORDERED_NODE_SNAPSHOT_TYPE, null), c.snapshotLength === 0)
        return [];
      for (o = [], a = u = 0, l = c.snapshotLength - 1; 0 <= l ? u <= l : u >= l; a = 0 <= l ? ++u : --u)
        o.push(c.snapshotItem(a));
      return o;
    }(e)) : n = Array.prototype.slice.call($(t)), n;
}, Qe = function(t, e, n) {
  var i;
  if (t && e && e.length !== 0)
    return i = function(r) {
      let o, s, a;
      return document.charset === "Shift_JIS" ? (a = encodeURIComponent(r), o = gt(a), s = new TextDecoder("shift-jis"), R(Se(s.decode(o)))) : r;
    }(i = se(t, n)), !!e.some(function(r) {
      var o;
      return !(!r.compare || !r.text_value) && (o = Xn(r.compare, r.text_value), RegExp(o).test(i));
    }) && i;
};
function _t(t, e) {
  var o, s;
  const n = (o = e == null ? void 0 : e.url) == null ? void 0 : o.value, i = (s = e == null ? void 0 : e.url) != null && s.isRegex ? n : $e(n), r = Xn(e.compares, `${i}/?`);
  return !!new RegExp(r).test(t.origin + t.pathname) && function(a, u, l) {
    const c = a.split("&"), h = (u || []).every(function(d) {
      const p = d.isRegex ? d.value : "^" + $e(d.value) + "$";
      return c.some(function(_) {
        return new RegExp(p).test(_);
      });
    }), g = (l || []).every(function(d) {
      const p = d.isRegex ? d.value : "^" + $e(d.value) + "$";
      return c.every(function(_) {
        return !new RegExp(p).test(_);
      });
    });
    return h && g;
  }(t.search.substring(1), e.queries, e.excludedQueries);
}
const $e = function(t) {
  return t ? t.replace(/[-[\]{}()*+?.,\\^$|#]/g, "\\$&") : "";
};
function Xn(t, e) {
  switch (t) {
    case "default_equal":
      return "^" + e + "$";
    case "string_partial_match":
      return e;
    case "string_forward_match":
      return "^" + e;
    case "string_backward_match":
      return e + "$";
    default:
      throw new Error("invalid URL comparisonType: " + t);
  }
}
function ze(t, e) {
  if (!t || !e)
    return;
  let n;
  return ro.find((i) => {
    const r = function(o, s) {
      var a;
      if (!(!s || !s.urlConditions))
        return (a = s.urlConditions) == null ? void 0 : a.find((u) => {
          try {
            return _t(o, u);
          } catch {
            return;
          }
        });
    }(t, e[i]);
    if (r)
      return n = { type: i, setting: r }, !0;
  }), n;
}
function Yn(t, e, n) {
  return !(t || e && e.length !== 0) || !(!t || !_t(window.location, t)) || !!((e == null ? void 0 : e.length) > 0 && e.includes(n == null ? void 0 : n.type));
}
const so = (t) => {
  let e = {};
  return (t.split("?")[1] || "").split("&").map((n) => {
    const i = n.split("=");
    i.length == 2 && (e[i[0]] = i[1]);
  }), e;
};
function P(t, e) {
  let n;
  var i, r, o;
  return t.url_regexp ? (i = t.url_regexp, n = (r = e || location.href.replace(/[?#].*$/, "")) && (o = RegExp("" + i.replace(/\//g, "\\/")).exec(r)) ? R(o[1]) : null) : n = t.query_key ? function(s, a = "") {
    const u = so(a || window.location.search)[s];
    if (!u)
      return null;
    try {
      return R(decodeURIComponent(u));
    } catch {
      try {
        const c = gt(u);
        return new TextDecoder("shift-jis").decode(c);
      } catch (c) {
        return console.log(c), null;
      }
    }
  }(t.query_key, e) : t.query_selector ? function(s, a) {
    if (!s)
      return null;
    const u = oo(s);
    if (!u)
      return null;
    let l = null;
    return a ? l = u.getAttribute(a) : (l = u.textContent, l == null && (l = u.innerText)), l && (l = R(Se(l)), l = l ? l.trim() : null), l;
  }(t.query_selector, t.query_selector_attribute) : t.xpath ? function(s) {
    if (!s || !document.evaluate)
      return null;
    let a;
    return a = document.evaluate(s, document, null, XPathResult.STRING_TYPE, null).stringValue, a && (a = R(Se(a)), a = a ? a.trim() : null), a;
  }(t.xpath) : t.ogp_property ? function(s) {
    if (!document.getElementsByTagName)
      return null;
    const a = document.getElementsByTagName("meta");
    let u = "";
    for (let l = 0, c = a.length; l < c; l++)
      if (s && a[l].getAttribute("property") === s) {
        u = a[l].content;
        break;
      }
    return u;
  }(`og:${t.ogp_property}`) : null, t.convert_type && n != null && t.convert_type === "number" && (n = function(s) {
    if (!s)
      return null;
    let a;
    const u = (a = s.match(/\d[\d,]*/)) != null ? a[0] : void 0;
    let l = u ? u.replace(/[^\d]/g, "") : void 0, c = null;
    return l && (c = Number(l), (c > 1e8 || isNaN(c)) && (c = null)), c;
  }(n)), n;
}
function j(t, e, n = "", i = !1) {
  var s, a;
  i && (console.log(`makeItemInfo: eventType=${n}`), console.log("itemInfoSetting"), console.dir(t), console.log(`matchedAutoPageGroup ${e == null ? void 0 : e.type}`), console.dir(e)), n || (n = "context_event");
  const r = (t || []).filter((u) => !(n !== "test" && !(u.event_to_append_item_info || []).includes(n)) && !!Yn(u.urlCondition, u.auto_page_groups, e));
  i && console.log("makeItemInfo 2");
  let o = {};
  return r.forEach((u) => {
    Object.keys(u).forEach((l) => {
      ["urlCondition", "auto_page_groups", "event_to_append_item_info", "modified", "setting_id"].includes(l) || o[l] || (o[l] = P(u[l]));
    });
  }), i && console.log("makeItemInfo 3"), (e == null ? void 0 : e.type) === "item_detail" && (i && console.log("makeItemInfo 4"), ((s = e == null ? void 0 : e.setting) == null ? void 0 : s.extractors) && e.setting.extractors.length > 0 && (i && console.log("makeItemInfo 5"), o.item_id = P((a = e.setting) == null ? void 0 : a.extractors[0]))), i && (console.log("itemInfo"), console.dir(o)), Object.keys(o).length > 0 ? o : null;
}
const xe = "focusing", Oe = "comparing", je = "touring", Ce = "skipping", Ee = "searching", Ie = "checking_recommendation", He = "reaching_goal", Ge = "other", F = [{ name: xe, data: { target_view_count: 10, spend_time: 300, focusing_pv: 5, auto_page_groups: ["item_detail"] } }, { name: Oe, data: { target_view_count: 10, compare_pv: 3, auto_page_groups: ["item_detail"] } }, { name: je, data: { target_view_count: 10, spend_time: 30, page_count: 5, auto_page_groups: ["item_detail"] } }, { name: Ce, data: { target_view_count: 10, spend_time: 10, page_count: 5, auto_page_groups: ["item_detail"] } }, { name: Ie, data: { target_view_time: 120 } }, { name: Ee, data: { target_view_time: 120 } }, { name: He, data: { target_view_time: 120 } }], gn = 10, ao = 2, _n = function(t) {
  var e, n, i, r, o, s;
  for (t == null && (t = !0), e = {}, n = 0, i = (r = document.getElementsByTagName("meta")).length; n < i; n++)
    (o = (s = r[n]).getAttribute("name")) || (o = s.getAttribute("property")), o && (e[o] = s.content);
  return t ? { og_url: e["og:url"] } : { title: e.title || e["og:title"], description: e.description || e["og:description"], keywords: e.keywords || e["og:keywords"], og_title: e["og:title"], og_description: e["og:description"], og_type: e["og:type"], og_image: e["og:image"], og_url: e["og:url"], og_keywords: e["og:keywords"], og_site_name: e["og:site_name"] };
}, et = function(t) {
  return t.localName === "a" ? t : t.parentElement ? et(t.parentElement) : null;
}, Zn = function(t) {
  var e;
  return e = Array.prototype.slice.call(t.children).map(function(n) {
    return Zn(n);
  }).reduce(function(n, i) {
    return n.concat(i);
  }, []), (t.localName === "a" ? [t] : []).concat(e);
};
var Wn;
Wn = ["url", "protocol", "host", "path", "anchor", "query", "queryKey"];
const vn = function(t) {
  var e, n, i;
  return -1 < (n = t != null ? t.indexOf("?") : void 0) && n < (t != null ? t.indexOf("@") : void 0) && (e = t.substr(t.indexOf("?") + 1).replace(/@/g, "%40"), t = t.replace(/\?.*/g, "?" + e)), (t = vt(t)).url = (i = t.source) != null ? i.replace(/[?#].*$/, "") : void 0, t = zn(t, Wn);
};
function vt(t) {
  for (var e = vt.options, n = e.parser[e.strictMode ? "strict" : "loose"].exec(t), i = {}, r = 14; r--; )
    i[e.key[r]] = n[r] || "";
  return i[e.q.name] = {}, i[e.key[12]].replace(e.q.parser, function(o, s, a) {
    s && (i[e.q.name][s] = a);
  }), i;
}
function uo(t) {
  return function(n) {
    const i = JSON.stringify(n);
    return new TextEncoder().encode(i).length / 1024;
  }(t) > 45;
}
vt.options = { strictMode: !1, key: ["source", "protocol", "authority", "userInfo", "user", "password", "host", "port", "relative", "path", "directory", "file", "query", "anchor"], q: { name: "queryKey", parser: /(?:^|&)([^&=]*)=?([^&]*)/g }, parser: { strict: /^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/, loose: /^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/ } };
const ve = () => document.body ? Promise.resolve(document.body) : new Promise((t) => {
  document.addEventListener("DOMContentLoaded", () => {
    t(document.body);
  });
}), Be = "latest_event_date", pe = "session", ie = "context_mode", E = "krt.track_pv_count", re = "krt.track_recent_pv_in_session", oe = "krt.track_recent_events", fe = "krt.item_info_settings", pn = "krt.auto_page_group_settings", me = "krt.total_active_time", ye = "krt.sent_engaged_session", be = "krt.debug_mode";
class lo {
  constructor(e) {
    var n;
    this._ = function() {
      var i;
      (i = this.m()).settings.flow_event_settings = JSON.stringify(i.settings.flow_event_settings), this.g.pubsub.publish(H, { event_name: "_debug_context_event", debugContent: i });
    }, this.trackHaveInterest = function(i, r) {
      var o, s, a, u, l;
      let c = i.scroll_count, h = i.spend_time;
      if (this.p)
        return;
      var g;
      this.p = !0, (c == null || c <= 0) && (c = 10), (!h || h <= 0) && (h = 30), u = new Date().getTime(), l = null, s = 0, a = !1, g = this, o = function() {
        var _, v, m;
        var p;
        a ? g.k && console.log("_trackHaveInterest called but already sent.") : (p = new Date().getTime(), clearTimeout(l), l = setTimeout(function() {
          return s += 1;
        }, 500), s >= c && p - u > 1e3 * h && (window.removeEventListener("scroll", o), clearTimeout(d), a = !0, g.j("have_interest", { item: j(g.I, g.T), title: g.C, url: ((_ = g.O) == null ? void 0 : _.canonical_url) || ((m = (v = g.O) == null ? void 0 : v.uri) == null ? void 0 : m.url), scroll_count: s, spend_time: Math.round((p - u) / 1e3), setting_id: r })));
      }, window.addEventListener("scroll", o);
      const d = setTimeout(() => {
        o();
      }, 1e3 * h);
    }, this.trackHaveInterestTest = function(i, r) {
      var o;
      o = i.testSettings, this.A || (this.A = !0, this.S(o, r));
    }, this.S = function(i, r) {
      var o, s, a, u, l, c, h;
      l = new Date().getTime(), c = null, s = 0, a = !1, u = [], h = this, o = function() {
        var g, d;
        a ? h.k && console.log("_trackHaveInterestTest called but already sent.") : (g = function(p, _, v) {
          var m, f, y;
          !u.includes(v) && s >= p && d - l > 1e3 * _ && (u.push(v), i.length === u.length && (window.removeEventListener("scroll", o), a = !0), h.j("have_interest_test", { item: j(h.I, h.T), title: h.C, url: ((m = h.O) == null ? void 0 : m.canonical_url) || ((y = (f = h.O) == null ? void 0 : f.uri) == null ? void 0 : y.url), scroll_count: s, spend_time: Math.round((d - l) / 1e3), setting_id: r, test_id: v }));
        }, d = new Date().getTime(), clearTimeout(c), c = setTimeout(function() {
          s += 1;
        }, 500), i.map(function(p) {
          var _, v, m;
          _ = p.scroll_count, v = p.spend_time, m = p.test_id, _ <= 0 && (_ = 10), v <= 0 && (v = 30), g(_, v, m);
        }));
      }, window.addEventListener("scroll", o);
    }, this.trackFinishReading = (i, r) => {
      let o = i.scroll_rate, s = i.spend_time;
      if (this.M)
        return;
      this.M = !0, (o == null || o > 100 || o < 0) && (o = 80), (!s || s <= 0) && (s = 30);
      const a = new Date().getTime();
      let u = !1;
      const l = (c = this, function() {
        var f, y, b;
        var g, d, p, _, v, m;
        u ? c.k && console.log("_trackFinishReading called but already sent.") : (g = window.document.body, v = (d = window.document.documentElement).scrollTop || g.scrollTop, p = Math.max.apply(null, [g.clientHeight, g.scrollHeight, d.scrollHeight, d.clientHeight]), _ = (v + Math.min.apply(null, [d.clientHeight, g.clientHeight])) / p * 100, m = new Date().getTime(), o < _ && m - a > 1e3 * s && (window.removeEventListener("scroll", l), clearTimeout(h), u = !0, c.j("finish_reading", { item: j(c.I, c.T), title: c.C, url: ((f = c.O) == null ? void 0 : f.canonical_url) || ((b = (y = c.O) == null ? void 0 : y.uri) == null ? void 0 : b.url), spend_time: Math.round((m - a) / 1e3), scroll_rate: Math.round(_), setting_id: r })));
      });
      var c;
      window.addEventListener("scroll", l);
      const h = setTimeout(() => {
        l();
      }, 1e3 * s);
    }, this.trackLeaveTest = function(i, r) {
      var o;
      o = i.testSettings, this.D || (this.D = !0, this.L(o, r));
    }, this.L = function(i, r) {
      var o, s, a, u, l;
      a = [], u = {}, s = !1, l = this, o = function() {
        var c;
        s ? l.k && console.log("_trackLeaveTest called but already sent.") : (c = function(h, g) {
          var d;
          d = u[g], clearTimeout(d), u[g] = null, i.length === a.length && (window.removeEventListener("scroll", o), s = !0), a.includes(g) || (d = setTimeout(function() {
            var p, _, v;
            a.push(g), l.j("leave_test", { item: j(l.I, l.T), title: l.C, url: ((p = l.O) == null ? void 0 : p.canonical_url) || ((v = (_ = l.O) == null ? void 0 : _.uri) == null ? void 0 : v.url), spend_time: h, setting_id: r, test_id: g });
          }, 1e3 * h), u[g] = d);
        }, i.map(function(h) {
          var g, d, p;
          g = h.spend_minutes, d = h.spend_time, p = h.test_id, g && (d = 60 * g), d <= 0 && (d = 180), c(d, p);
        }));
      }, window.addEventListener("scroll", o);
    }, this.trackStayLongTime = function(i, r) {
      var o, s;
      o = i.spend_minutes, this.R || (this.R = !0, o <= 0 && (o = 3), setTimeout((s = this, function() {
        var a, u, l;
        return s.j("stay_long_time", { item: j(s.I, s.T), title: s.C, url: ((a = s.O) == null ? void 0 : a.canonical_url) || ((l = (u = s.O) == null ? void 0 : u.uri) == null ? void 0 : l.url), spend_time: 60 * o, setting_id: r });
      }), 60 * o * 1e3));
    }, this.trackWanderInPage = function(i, r) {
      var o, s, a, u, l, c, h, g;
      l = i.spend_minutes, c = i.spend_time, a = i.scroll_count, this.F || (this.F = !0, l && (c = 60 * l), (c === void 0 || c < 0) && (c = 0), a === void 0 || a <= 0 || (s = 0, u = !1, h = null, g = this, o = function() {
        var d;
        d = new Date(), h || (h = setInterval(function() {
          var p, _, v;
          new Date().getTime() - d.getTime() >= 500 && (clearInterval(h), h = null, s += 1, !u && s >= a && (g.j("wander_in_page", { item: j(g.I, g.T), title: g.C, url: ((p = g.O) == null ? void 0 : p.canonical_url) || ((v = (_ = g.O) == null ? void 0 : _.uri) == null ? void 0 : v.url), spend_time: c, scroll_count: s, setting_id: r }), window.removeEventListener("scroll", o), u = !0));
        }, 100));
      }, setTimeout(function() {
        window.addEventListener("scroll", o);
      }, 1e3 * c)));
    }, this.trackSearch = function(i, r) {
      var g, d, p, _, v, m;
      var o, s, a, u, l, c, h;
      if (c = i.query_key, o = i.auto_page_groups, !this.P) {
        if (this.P = !0, ((g = this.T) == null ? void 0 : g.type) == "search" && o.includes("search") && (l = this.T), a = (d = l == null ? void 0 : l.setting) == null ? void 0 : d.extractors, s = (p = l == null ? void 0 : l.setting) == null ? void 0 : p.extractor, u = c, a && a.length > 0)
          h = P(a[0]);
        else if (s)
          h = P(s);
        else if (u) {
          if (!function(f, y) {
            var b;
            return y ? b = dn(y) : (X || hn(), b = X), Object.keys(b).includes(f);
          }(u, null))
            return;
          h = function(f, y) {
            let b, w, O;
            if (y ? b = dn(y) : (X || hn(), b = X), !b[f])
              return null;
            try {
              return R(decodeURIComponent(b[f]));
            } catch {
              try {
                return w = gt(b[f]), O = new TextDecoder("shift-jis"), R(O.decode(w));
              } catch {
                return null;
              }
            }
          }(u, null);
        } else
          h = "";
        this.j("search", { item: j(this.I, this.T), title: this.C, url: ((_ = this.O) == null ? void 0 : _.canonical_url) || ((m = (v = this.O) == null ? void 0 : v.uri) == null ? void 0 : m.url), text: h, setting_id: r });
      }
    }, this.trackViewRanking = function(i, r) {
      var o, s, a;
      this.$ || (this.$ = !0, this.j("view_ranking", { item: j(this.I, this.T), title: this.C, url: ((o = this.O) == null ? void 0 : o.canonical_url) || ((a = (s = this.O) == null ? void 0 : s.uri) == null ? void 0 : a.url), setting_id: r }));
    }, this.trackViewNearGoal = function(i, r) {
      var o, s, a;
      this.V || (this.V = !0, this.j("view_near_goal", { item: j(this.I, this.T), title: this.C, url: ((o = this.O) == null ? void 0 : o.canonical_url) || ((a = (s = this.O) == null ? void 0 : s.uri) == null ? void 0 : a.url), setting_id: r }));
    }, this.trackMatchText = function(i, r) {
      this.U(i, r);
    }, this.U = function(i, r) {
      var o, s, a, u, l, c, h, g, d, p, _;
      a = i.auto_page_groups, c = i.event_name, g = i.query_selector, l = i.compare, p = i.text_value, d = i.text_conditions, u = i.check_recursively, d || (d = [{ text_value: p, compare: l }]), _ = this, o = function(v, m, f, y) {
        var pt, ft, mt, yt, bt, wt;
        var b, w, O, C, I, ee, L, B;
        if (m && (w = Array.prototype.slice.call($(m))), w.length !== 0) {
          for (((pt = _.T) == null ? void 0 : pt.type) == "search" && a.includes("search") && (L = _.T, C = (ft = L == null ? void 0 : L.setting) == null ? void 0 : ft.extractors, O = (mt = L == null ? void 0 : L.setting) == null ? void 0 : mt.extractor, C && C.length > 0 ? B = P(C[0]) : O && (B = P(O))), I = 0, ee = w.length; I < ee; I++)
            if (b = w[I], Qe(b, f)) {
              y && y.disconnect(), _.N.push(r), _.j(v, { item: j(_.I, _.T), title: _.C, url: ((yt = _.O) == null ? void 0 : yt.canonical_url) || ((wt = (bt = _.O) == null ? void 0 : bt.uri) == null ? void 0 : wt.url), selector: m, text: se(b), search_word: B, setting_id: r });
              break;
            }
        }
      }, s = de(function() {
        o(c, g, d, h);
      }, 1e3, { leading: !1 }), o(c, g, d), u && !this.N.includes(r) && (h = new MutationObserver(function() {
        return s();
      }), ve().then((v) => {
        h.observe(v, { childList: !0, subtree: !0 });
      }).catch(() => {
        console.log("failed to observe.");
      }));
    }, this.testMatchText = function(i) {
      var r, o, s, a, u, l, c, h, g, d;
      if (c = i.query_selector, r = i.compare, d = i.text_value, (g = i.text_conditions) || (g = [{ text_value: d, compare: r }]), c && (s = Array.prototype.slice.call($(c))), c && console.log("\u5BFE\u8C61\u3068\u306A\u308B\u8981\u7D20: \u8A08" + s.length + "\u500B"), s.length > 0)
        for (console.log("\u5404\u8981\u7D20\u306E\u30C6\u30AD\u30B9\u30C8\u306E\u5224\u5B9A\u7D50\u679C"), a = 0, u = s.length; a < u; a++)
          o = s[a], console.log(o), h = se(o), l = Qe(o, g), console.log("\u300C" + h + "\u300D : " + (l ? "\u5408\u81F4" : "\u5408\u81F4\u3057\u306A\u3044"));
    }, this.trackCustomClickOrDisplayed = function(i, r) {
      this.G(i, r);
    }, this.H = function(i, r, o, s, a) {
      var u, l, c;
      if (!this.N.includes(a))
        return this.N.push(a), this.j(r, { item: j(this.I, this.T), title: this.C, url: ((u = this.O) == null ? void 0 : u.canonical_url) || ((c = (l = this.O) == null ? void 0 : l.uri) == null ? void 0 : c.url), selector: o, text: se(i), search_word: this.B(), setting_id: a });
    }, this.B = function() {
      var r, o, s;
      var i;
      return ((r = this.T) == null ? void 0 : r.type) == "search" && (i = (s = (o = this.T) == null ? void 0 : o.setting) == null ? void 0 : s.extractors, i && i.length > 0) ? P(i[0]) : null;
    }, this.testCustomClickOrDisplayed = function(i, r) {
      var o, s, a;
      s = i.query_selector, a = i.text_value, s || a ? (o = _e(s, a ? [a] : []), console.log("\u5BFE\u8C61\u3068\u306A\u308B\u8981\u7D20: \u8A08" + o.length + "\u500B"), o.length > 0 && console.log(o)) : console.log("\u300C\u30C6\u30AD\u30B9\u30C8\u306E\u5024\u300D\u300CCSS\u30BB\u30EC\u30AF\u30BF\u300D\u306E\u3069\u3061\u3089\u304B\u307E\u305F\u306F\u4E21\u65B9\u3092\u6307\u5B9A\u3057\u3066\u304F\u3060\u3055\u3044");
    }, this.trackViewPage = function(i, r) {
      var o, s, a;
      this.j(i.event_name, { item: j(this.I, this.T), title: this.C, url: ((o = this.O) == null ? void 0 : o.canonical_url) || ((a = (s = this.O) == null ? void 0 : s.uri) == null ? void 0 : a.url), setting_id: r });
    }, this.trackPageInfo = function({}, i) {
      var r, o, s, a, u, l, c, h, g, d, p, _, v, m, f, y;
      const b = this;
      this.W || (this.W = !0, l = window.document.body, d = window.document.documentElement, r = "pvid_" + String(Number(new Date())), c = 0, p = 0, u = null, y = 0, m = 0, g = null, _ = null, f = 0, v = null, h = null, o = function(w) {
        u && (y += Math.abs(w - u)), u = w;
      }, s = function(w) {
        var O;
        return O = Math.max.apply(null, [l.clientHeight, l.scrollHeight, d.scrollHeight, d.clientHeight]), (w + (d.clientHeight || l.clientHeight)) / O * 100;
      }, a = function(w) {
        var O;
        return O = 0, !g || _ < w - 18e4 ? (g = w, _ = w) : O = ((_ = w) - g) / 1e3, O;
      }, window.addEventListener("scroll", function() {
        c++;
      }), setInterval(function() {
        var ee, L, B;
        var w, O, C, I;
        w = new Date(), h && c <= h.count || (c > p && (p = c, C = a(w), f = Math.max(f, C), I = d.scrollTop || l.scrollTop, o(I), O = s(I), m = Math.max(m, O)), c !== 0 && (v && w - v < 2e3 || _ && w - _ < 1e3 || (h = { max_scroll_rate: m, max_scroll_time: f, total_scroll: y, pv_id: r, url: ((ee = b.O) == null ? void 0 : ee.canonical_url) || ((B = (L = b.O) == null ? void 0 : L.uri) == null ? void 0 : B.url), title: b.C, count: c }, v = w, b.j("scroll_info", h))));
      }, 100));
    }, this.trackRageClick = function(i, r) {
      var o, s, a, u;
      u = i.in_seconds, s = i.click_times;
      const l = this;
      this.K || (this.K = !0, u <= 0 || s <= 0 || (a = 0, o = function(c) {
        var g, d, p, _, v, m;
        var h;
        (a += 1) === 1 ? setTimeout(function() {
          a = 0;
        }, 1e3 * u) : a === s && (h = (p = (g = c.target) == null ? void 0 : g.outerHTML) == null ? void 0 : p.replace((d = c.target) == null ? void 0 : d.innerHTML, ""), l.j("rage_click", { item: j(l.I, l.T), title: l.C, url: ((_ = l.O) == null ? void 0 : _.canonical_url) || ((m = (v = l.O) == null ? void 0 : v.uri) == null ? void 0 : m.url), click_target: h, click_count: a, setting_id: r }));
      }, window.addEventListener("mousedown", o)));
    }, this.testItemInfo = function(i) {
      return console.log("item info: " + JSON.stringify(j([i], this.T, "test"), null, 2));
    }, this.testClickInfo = function(i) {
      var r, o, s, a, u, l, c, h, g;
      g = i.query_selector, u = i.label_name, (c = i.link_condition) && (l = new RegExp(c)), r = function(d) {
        return !(!d || d.indexOf("http") !== 0) && (!l || l.test(d));
      }, g ? a = Array.prototype.slice.call($(g)) : u ? document.charset !== "UTF-8" ? (console.log("\u30B5\u30A4\u30C8\u306E\u6587\u5B57\u30B3\u30FC\u30C9\u304CUTF-8\u3067\u306A\u3044\u305F\u3081\u3001\u30E9\u30D9\u30EB\u540D\u3092\u4F7F\u3063\u305F\u5224\u5B9A\u306F\u884C\u3048\u307E\u305B\u3093"), a = []) : a = Ue(u) : a = Array.prototype.slice.call([document]), (g || u) && (console.log("\u5BFE\u8C61\u3068\u306A\u308B\u8981\u7D20: \u8A08" + a.length + "\u500B"), a.length > 0 && console.log(a)), s = a.map((d) => et(d)).filter((d) => !!d).filter((d) => r(d.href)), o = a.map((d) => Zn(d)).reduce((d, p) => d.concat(p), []).filter((d) => r(d.href)), h = s.concat(o).map((d) => d.href), console.log("\u5BFE\u8C61\u3068\u306A\u308B\u30EA\u30F3\u30AFURL: \u8A08" + h.length + "\u500B"), h.length > 0 && console.log("" + h.join(`
`));
    }, this.J = (n = this, function(i) {
      var r, o, s, a, u, l, c, h;
      c = i.trigger, n.k && console.log("_trackVisibilityChangeEvent ==="), n.X >= 3 || n.Y >= 30 ? n.k && console.log("stop _trackVisibilityChangeEvent") : n.Z && (l = ((u = new Date()).getTime() - n.Z.getTime()) / 1e3, n.tt && (h = (u.getTime() - n.tt.getTime()) / 1e3, n.et = n.et + h), n.et > l && (n.et = l), Math.round(l) < 1 || (r = { event_name: "_visibility_change", values: { vc_pv_id: n.nt, active_time: Math.round(l), user_active_time: n.it ? Math.round(n.et) : null, title: n.C, url: ((o = n.O) != null ? o.canonical_url : void 0) || ((s = n.O) != null && (a = s.uri) != null ? a.url : void 0), trigger: c } }, n.X += 1, n.Z = null, n.tt = null, n.et = 0, n.rt = !1, clearTimeout(n.ot), n.j(r.event_name, r.values), n.st(l)));
    }), this.ut = de(function() {
      var i, r, o;
      if (this.k && console.log("_checkAndtrackActivityChangeEvent ==="), this.et && this.ct())
        return this.j("_activity_change", { vc_pv_id: this.nt, user_active_time: Math.round(this.et), title: this.C, url: ((i = this.O) == null ? void 0 : i.canonical_url) || ((o = (r = this.O) == null ? void 0 : r.uri) == null ? void 0 : o.url), trigger: "activity_stop" }), this.Y += 1, this.et = 0;
    }, 1e3, { leading: !0, trailing: !1 }), this.g = e, this.lt = e.apiKey, e.storage && (this.ht = e.storage), this.vt = e.logger, this.ft = {}, this.customClickOrDisplayedObservers = [], this.ccodSettingIdMap = {}, this.replaceClickEventEmitters = [], this._t = new Date();
  }
  async init() {
    var s;
    if (!this.ht)
      throw new Error("localstorage is not available");
    this.p = !1, this.A = !1, this.M = !1, this.dt = !1, this.D = !1, this.R = !1, this.F = !1, this.P = !1, this.$ = !1, this.V = !1, this.W = !1, this.K = !1, this.gt = !1, this.yt = !1, this.wt = !1, this.bt = !1, this.kt = !1, this.xt = !1, this.jt = !1, this.I = this.It(), this.Tt = {}, this.Et = null, this.Ct = null, this.Ot = null, this.At = null, this.St = null, this.Mt = null, this.qt = null, this.Dt = null, this.Rt = null, this.Ft = null, this.Pt = [], this.$t = [], this.Vt = this.ht.get("krt.auto_page_group_settings") || null, this.T = ze(window.location, this.Vt), this.vt.log(`auto_page_group: ${(s = this.T) == null ? void 0 : s.type}`), this.Ut = this.Nt(), this.Ht = this.Bt(), this.Z = new Date(), this.tt = null, this.rt = !1, this.et = 0, this.Y = 0, this.X = 0, this.zt = !1, this.it = !1, this.k = this.Wt(), this.debug_loaded_settings = [], this.Kt(), this.Jt = !!this.Xt, this.ft = {}, this.N = [], this.Qt = 0, this.Yt = null, this.Zt = null, this.te = null, this.ee = null, this.ot = null, this.ne = null;
    const { title: e } = _n(!1), n = this.g.meta.getMainMeta();
    if (this.nt = n.pv_id, this.C = e || n.title, this.O = {}, this.O.uri = vn(location.href), this.O.canonical_url = n.canonical_url, window.location.search.indexOf("debug_edgejs_context_event") > 0 && this.ie(!0), this.k) {
      this._();
      var i = 1, r = setInterval((o = this, function() {
        if (o._(), ++i > 10)
          return clearInterval(r);
      }), 3e4);
    }
    var o;
    this.re(function(a) {
      return function() {
        a.te = null, a.Zt = null;
      };
    }(this), !0), this.g.pubsub.subscribe(bn, (a) => {
      this.j(a.event_name, a.values);
    });
  }
  updatePvId() {
    this.vt.log("updatePvId");
    const e = this;
    this._t = new Date(), Object.keys(this.ccodSettingIdMap).map((n) => {
      this.ft[n] && this.ft[n].length > 0 && this.oe(n);
    }), this.se(), this.N = [], this.T = ze(window.location, this.Vt), setTimeout(function() {
      e.zt && e.J({ trigger: "updatePvId" });
      var n = _n(!1).title;
      const i = e.g.eventMetaFunc.getMainMeta();
      e.nt = i.pv_id, e.C = n || document.title, e.O = {}, e.O.uri = vn(location.href), e.O.canonical_url = i.canonical_url, e.Z = new Date(), e.tt = null, e.rt = !1, e.et = 0, e.Y = 0, e.X = 0;
    }, 0);
  }
  outpuApiKey() {
    this.vt.log("called outpuApiKey"), this.vt.log(this.lt);
  }
  sendTestEvent() {
    this.vt.log("called sendTestEvent"), this.g.pubsub.publish(H, { event_name: "test-yasn-ev-pubsub2", values: {}, options: {} });
  }
  j(e, n) {
    var i;
    this.Qt += 1, this.Qt > 100 ? this.Qt === 101 && this.ue({ type: "trackerjs_contextevent_count_error", error_message: "number of sending context events in 1pv exceeds 100", details: { sending_event: { event_name: e, values: n } } }) : (this.k && (console.log("context event send. event_name: " + e), console.log(n)), n || (n = {}), n._system || (n._system = {}), n._system.event_type = "context", n.auto_page_group = (i = this.T) == null ? void 0 : i.type, uo(n) ? this.ue({ type: "trackerjs_contextevent_size_error", error_message: "context event size exceeds 45KB", details: { sending_event: { event_name: e, values: n } } }) : (this.g.pubsub.publish(H, { event_name: e, values: n }), this.g.pubsub.publish(fn, { setting_id: n.setting_id })));
  }
  ue(e) {
    this.jt || (this.k && console.log("_trackErrorEvent send. values: " + e), this.k && console.log(e), this.jt = !0, this.g.pubsub.publish(H, { event_name: "_error", values: e }));
  }
  Wt() {
    return this.ht.get(be) || !1;
  }
  ie(e) {
    this.ht.set(be, e), this.k = e;
  }
  It() {
    var e;
    return (e = this.ht.get(fe)) && !Array.isArray(e) && (e = [e]), e || [];
  }
  ce(e) {
    this.ht.set(fe, e), this.I = e;
  }
  ae(e) {
    this.ht.set(pn, e), this.Vt = e;
  }
  Nt() {
    return this.ht.get(me) || 0;
  }
  st(e) {
    var n;
    n = this.Nt(), n += e, this.ht.set(me, n), this.Ut = n;
  }
  Bt() {
    return this.ht.get(ye) || !1;
  }
  le(e) {
    return this.ht.set(ye, e), this.Ht = e;
  }
  Kt() {
    var e, n;
    e = new Date(this.ht.get(Be)), this.ht.get(pe), this.ht.get(ie);
    const i = new Date();
    n = "", (!e || (i.getTime() - e.getTime()) / 1e3 >= 1800) && (n = ((r = 21) => crypto.getRandomValues(new Uint8Array(r)).reduce((o, s) => o + ((s &= 63) < 36 ? s.toString(36) : s < 62 ? (s - 26).toString(36).toUpperCase() : s > 62 ? "-" : "_"), ""))(), this.ht.set(pe, n), this.ht.set(ie, void 0), this.g.pubsub.publish(mn, { session: n })), this.ht.set(Be, i);
  }
  Xt() {
    return this.ht.get(pe) || null;
  }
  setContextMode(e) {
    this.ht.set(ie, e);
  }
  he() {
    return this.ht.get(ie) || null;
  }
  ve() {
    var e, n;
    return e = this.Xt(), this.Zt ? this.Zt[e] || [] : ((n = this.ht.get(re)) != null ? n[e] : void 0) || [];
  }
  fe(e) {
    var o;
    var n, i, r;
    i = this.Xt(), n = e(n = ((o = this.ht.get(re)) == null ? void 0 : o[i]) || []), (r = {})[i] = n, this.ht.set(re, r), this.Zt = {}, this.Zt[i] = n;
  }
  _e() {
    var e, n;
    return e = this.Xt(), this.te ? this.te[e] || [] : (n = this.ht.get(oe), (n == null ? void 0 : n[e]) || []);
  }
  de(e) {
    var o;
    var n, i, r;
    return i = this.Xt(), n = e(n = ((o = this.ht.get(oe)) == null ? void 0 : o[i]) || []), (r = {})[i] = n, this.ht.set(oe, r), this.te = {}, this.te[i] = n;
  }
  me(e, n, i, r) {
    var o, s;
    s = this, o = function(a) {
      var u;
      return a.push({ url: e, title: n, location: zn(i || window.location, ["search", "origin", "pathname"]), item: j(s.I, s.T), date: new Date().getTime() / 1e3, pv_id: s.nt, auto_page_group: (u = s.T) != null ? u.type : void 0, spend_time: r != null ? r : 0 }), a;
    }, this.fe(o);
  }
  ge(e, n) {
    var i, r;
    r = this, i = function(o) {
      var a, u, l;
      var s;
      return o.length > 0 && (n = ((a = r.O) == null ? void 0 : a.canonical_url) || ((l = (u = r.O) == null ? void 0 : u.uri) == null ? void 0 : l.url), (s = o[o.length - 1]) && s.url === n && s.pv_id === r.nt ? s.spend_time += e : clearInterval(r.ee)), o;
    }, this.fe(i);
  }
  pe(e, n) {
    var i, r, o, s, a, u, l;
    return a = this.Xt(), u = this.ht.get(E), l = [], (s = (u == null ? void 0 : u[a]) || []).length === 0 && (u = {}), i = s.find((c) => c.type === "url" && c.url === e), i ? i.count++ : (i = { type: "url", url: e, count: 1, sent_settings: [], sent_testsettings: [] }, s.push(i)), l.push(i), this.Pt.map(function(c) {
      var h;
      if (h = c.frequency_category_field, n == null ? void 0 : n[h])
        return i = s.find((g) => g.type === h && g[h] === n[h]), i ? i.count++ : ((i = { type: h, count: 1, sent_settings: [], sent_testsettings: [] })[h] = n[h], s.push(i)), l.push(i);
    }), (r = (o = this.T) != null ? o.type : void 0) && (i = s.find((c) => c.type === r), i ? i.count++ : (i = { type: r, count: 1, sent_settings: [] }, s.push(i)), l.push(i)), u[a] = s, this.ht.set(E, u), l;
  }
  debugContextEvent() {
    var e;
    e = this.m(), console.log("*** context event info ***"), console.dir(e), console.log("***********");
  }
  m() {
    var e, n;
    return (e = {}).title = this.C, e.access = this.O, e.auto_page_group = (n = this.T) != null ? n.type : void 0, e.session = this.ht.get(pe), e.latest_event_date = this.ht.get(Be), e.context_mode = this.ht.get(ie), e.RECENT_PV_IN_SESSION_LOCAL_STORAGE_KEY = this.ht.get(re), e.PV_COUNT_LOCAL_STORAGE_KEY = this.ht.get(E), e.RECENT_EVENTS_KEY = this.ht.get(oe), e.ITEM_INFO_SETTINGS_KEY = this.ht.get(fe), e.TOTAL_ACTIVE_TIME_KEY = this.ht.get(me), e.SENT_ENGAGED_SESSION_KEY = this.ht.get(ye), e.DEBUG_MODE_KEY = this.ht.get(be), e.variables = { alreadySentErrorEvent: this.jt, total_active_time: this.Ut, sent_engaged_session: this.Ht, tab_active_time_start: this.Z, user_active_time_start: this.tt, is_user_active: this.rt, fixed_user_active_time: this.et, activity_change_event_send_count: this.Y, visibility_change_event_send_count: this.X, click_event_emitters: this.ft, context_sent_event_count: this.Qt, match_text_sent_settings: this.N, contextEventListeners: this.Yt }, e.settings = { auto_page_group_settings: this.Vt, auto_page_group_matched: this.T, context_item_info_settings: this.I, context_setting_viewfrequently_url: this.Rt, context_setting_viewfrequently_url_test: this.Ft, context_setting_viewfrequently_category: this.Pt, context_setting_viewfrequently_pagetype: this.$t, context_mode_settings: this.Tt, context_setting_focusing: this.Et, context_setting_comparing: this.Ct, context_setting_touring: this.Ot, context_setting_skipping: this.At, context_setting_searching: this.St, context_setting_checking: this.Mt, context_setting_reaching: this.qt, context_setting_getLinkItemId: this.Dt }, e.debug_loaded_settings = this.debug_loaded_settings, e;
  }
  clearContextEventLocalStorage() {
    this.ht.set(E, null), this.ht.set(re, null), this.ht.set(oe, null), this.ht.set(fe, null), this.ht.set(pn, null), this.ht.set(me, null), this.ht.set(ye, null), this.ht.set(be, null), this.Zt = null, this.te = null, this.Ut = 0, this.Ht = !1, this.Z = null, this.tt = null, this.rt = !0, this.et = 0, this.Y = 0, this.X = 0, clearInterval(this.ee), clearTimeout(this.ot), clearInterval(this.ne), this.g.pubsub.publish(yn);
  }
  trackLeave(e, n) {
    var i, r, o, s, a;
    this.dt || (this.dt = !0, o = e.spend_minutes ? 60 * e.spend_minutes : e.spend_time ? e.spend_time : 180, s = null, r = !1, a = this, i = function() {
      if (!r)
        return clearTimeout(s), s = setTimeout(function() {
          var u, l, c;
          window.removeEventListener("scroll", i), r = !0, a.j("leave", { item: j(a.I, a.T), title: a.C, url: ((u = a.O) == null ? void 0 : u.canonical_url) || ((c = (l = a.O) == null ? void 0 : l.uri) == null ? void 0 : c.url), spend_time: o, setting_id: n });
        }, 1e3 * o);
      a.k && console.log("_trackLeave called but already sent.");
    }, window.addEventListener("scroll", i));
  }
  G(e, n) {
    let i, r, o, s, a, u, l, c, h;
    var g;
    this.ccodSettingIdMap[n] = !0, o = e.event_name, a = e.query_selector, u = e.text_value, h = e.user_action, l = u ? [u] : [], c = !1, r = _e(a, l), this.k && (console.log("matched elements"), console.log(r)), h === "click" ? (this.k && console.log("its click"), this.ye({ elements: r, event_name: o, query_selector: a, label_name: "", link_condition: void 0, setting_id: n, useLinkItemId: !1 }), s = new MutationObserver((g = this, function() {
      r = _e(a, l), g.we({ elements: r, event_name: o, query_selector: a, label_name: "", link_condition: void 0, setting_id: n, useLinkItemId: !1 });
    })), ve().then((d) => {
      s.observe(d, { childList: !0, subtree: !0 }), this.be(s);
    }).catch(() => {
      console.log("failed to observe.");
    })) : h === "displayed" && (this.k && console.log("its displayed"), r != null && r.length > 0 && (i = r[0], this.H(i, o, a, "", n)), this.N.includes(n) || (s = new MutationObserver(function(d) {
      return function() {
        if (r = _e(a, l), r != null && r.length > 0)
          return s.disconnect(), i = r[0], d.H(i, o, a, "", n);
      };
    }(this)), ve().then((d) => {
      s.observe(d, { childList: !0, subtree: !0 }), this.be(s);
    }).catch(() => {
      console.log("failed to observe.");
    })));
  }
  getItemId(e, n) {
    var i;
    i = e.item_id, this.kt || (this.kt = !0, this.ce([{ item_id: i }]));
  }
  getLinkItemId(e, n) {
    var i;
    i = e.link_item_id, this.xt || (this.xt = !0, this.Dt = i);
  }
  getItemInfo(e, n) {
    this.bt || (this.bt = !0, e ? (Array.isArray(e) || (e = [e]), e.map(function(i) {
      if (!i.event_to_append_item_info || i.event_to_append_item_info.length === 0)
        return i.event_to_append_item_info = ["context_event"];
    }), this.ce(e)) : this.ce([]));
  }
  ke(e) {
    var n, i, r, o, s;
    return i = null, e && this.Dt && (i = P(this.Dt, e)), (s = document.createElement("a")).href = e, ((r = ze(s, this.Vt)) != null ? r.type : void 0) === "item_detail" && (n = r != null && (o = r.setting) != null ? o.extractor : void 0, e && n && (i = P(n, e))), i ? { item_id: i } : null;
  }
  trackAutoPageGroup(e) {
    this.ae(e);
  }
  isCurrentPageTarget(e, n) {
    return Yn(e, n, this.T);
  }
  isActionModeTargetPage(e, n, i, r) {
    const o = this;
    var s;
    return s = r == null ? void 0 : r.some(function(a) {
      var u;
      return (u = o.Vt) != null ? u[a] : void 0;
    }), (r == null ? void 0 : r.length) > 0 && s ? r.includes(e.auto_page_group) : !(n || (i == null ? void 0 : i.length) > 0) || !(n && !_t(e.location, n)) && !((i == null ? void 0 : i.length) > 0 && i.includes(e.url));
  }
  trackClickPageItem(e, n) {
    this.xe(e.event_name, e, n, !1);
  }
  trackClickLinkItem(e, n) {
    this.xe(e.event_name, e, n, !0);
  }
  xe(e, n, i, r) {
    var o, s, a, u, l, c;
    this.vt.log("_trackClickItemBase"), l = n.query_selector, s = n.label_name, a = n.link_condition, e === "check_item_info" && (a = null), l ? o = Array.prototype.slice.call($(l)) : s && (o = Ue(s)), this.ye({ elements: o, event_name: e, query_selector: l, label_name: s, link_condition: a, setting_id: i, useLinkItemId: r }), u = new MutationObserver((c = this, function() {
      l ? o = Array.prototype.slice.call($(l)) : s && (o = Ue(s)), c.we({ elements: o, event_name: e, query_selector: l, label_name: s, link_condition: a, setting_id: i, useLinkItemId: r });
    })), ve().then((h) => {
      u.observe(h, { childList: !0, subtree: !0 });
    }).catch(() => {
      console.log("failed to observe.");
    });
  }
  ye(e) {
    const { elements: n, event_name: i, query_selector: r, label_name: o, link_condition: s, setting_id: a, useLinkItemId: u } = e;
    var l;
    n && n.length !== 0 && n.map((l = this, function(c) {
      var h, g;
      return g = { title: l.C, selector: r, label_name: o || se(c), setting_id: a, _system: { event_type: "context" } }, h = function(d, p, _, v) {
        return p == null && (p = "click_item"), v == null && (v = {}), new io(d, p, _, v);
      }(c, i, l, g), h.on("click", function(d) {
        var f, y;
        var p, _, v;
        if (p = (y = et((f = d == null ? void 0 : d.clickEvent) == null ? void 0 : f.target)) == null ? void 0 : y.href, p && p.indexOf(".") === 0 && (p = function(b) {
          var w;
          return (w = document.createElement("a")).href = b, w.href;
        }(p)), p = (_ = p) ? (v = location.href, location.href.indexOf("#") >= 0 && (v = v.slice(0, location.href.indexOf("#"))), _.indexOf(v + "#") === 0 ? _.slice(v.length) : _) : null, s && (!p || !new RegExp(s).test(p)))
          return;
        const m = { event_name: d == null ? void 0 : d.event_name, values: d == null ? void 0 : d.values };
        p ? (m.values.item = u ? l.ke(p) : j(l.I, l.T), m.values.link = i === "check_item_info" ? null : p) : u || (m.values.item = j(l.I, l.T)), l.j(m.event_name, m.values);
      }), l.ft[a] || (l.ft[a] = []), l.ft[a].push(h);
    }));
  }
  we(e) {
    const n = de((r) => {
      we(this.replaceClickEventEmitters, 4).map((o) => {
        this.oe(o.setting_id), this.ye(o);
      });
    }, 1e3, { leading: !1 });
    let i = !1;
    this.replaceClickEventEmitters = this.replaceClickEventEmitters.map((r) => r.setting_id == e.setting_id ? (i = !0, e) : r), i || this.replaceClickEventEmitters.push(e), n();
  }
  oe(e) {
    var n;
    (n = this.ft[e]) == null || n.map((i) => {
      i.destroy();
    }), this.ft[e] = [];
  }
  be(e) {
    this.customClickOrDisplayedObservers || (this.customClickOrDisplayedObservers = []), this.customClickOrDisplayedObservers.push(e);
  }
  se() {
    this.customClickOrDisplayedObservers && (this.customClickOrDisplayedObservers.map((e) => e.disconnect()), this.customClickOrDisplayedObservers = []);
  }
  trackViewFrequentlyItem(e, n) {
    var i;
    i = e.frequency_threshold, this.gt || (this.gt = !0, this.Rt = { frequency_threshold: i, setting_id: n });
  }
  trackViewFrequentlyItemTest(e, n) {
    var i;
    i = e.testSettings, this.yt || (this.yt = !0, this.Ft = { testSettings: i, setting_id: n });
  }
  trackViewFrequentlyCategory(e, n) {
    var i, r;
    i = e.frequency_category_field, r = e.frequency_category_threshold, this.Pt.find((o) => o.frequency_category_field === i) || this.Pt.push({ frequency_category_field: i, frequency_category_threshold: r, setting_id: n });
  }
  trackViewFrequentlyPageType(e, n) {
    var i, r;
    r = e.frequency_threshold, (i = e.auto_page_groups) != null && i[0] && (this.wt || (this.wt = !0, this.$t.push({ page_type: i[0], frequency_threshold: r, setting_id: n })));
  }
  trackViewFrequently() {
    this.je();
  }
  je() {
    var e, n, i, r;
    return r = this, e = function() {
      var p, _, v, m;
      var o, s, a, u, l, c, h, g, d;
      if (d = ((p = r.O) == null ? void 0 : p.canonical_url) || ((v = (_ = r.O) == null ? void 0 : _.uri) == null ? void 0 : v.url), r.Kt(), u = j(r.I, r.T), o = r.pe(d, u), r.Rt && (s = o.find((f) => f.type === "url" && f.url === d), l = r.Rt, a = l.frequency_threshold, h = l.setting_id, !((m = s.sent_settings) != null && m.includes(h)) && s.count >= a && (r.Ie(d, h), r.j("view_frequently_item", { item: u, title: r.C, url: d, pv: s.count, setting_id: h }))), r.Ft && (s = o.find((f) => f.type === "url" && f.url === d), g = (c = r.Ft).testSettings, h = c.setting_id, g.map(function(f) {
        var b;
        var y;
        if (a = f.frequency_threshold, y = f.test_id, !((b = s.sent_testsettings) != null && b.includes(y)) && s.count >= a)
          return r.Ie(d, h, y), r.j("view_frequently_item_test", { item: u, title: r.C, url: d, pv: s.count, setting_id: h, test_id: y });
      })), r.Pt.length > 0 && r.Pt.map(function(f) {
        var C;
        var y, b, w, O;
        if (w = f.frequency_category_field, O = f.frequency_category_threshold, h = f.setting_id, (y = o.find((I) => I.type === w)) && !((C = y.sent_settings) != null && C.includes(h)) && y.count >= O)
          return r.Te(w, y[w], h), (b = { title: r.C, url: d, type: w, pv: y.count, setting_id: h })[w] = y[w], r.j("view_frequently_category", b);
      }), r.$t.length > 0)
        return r.$t.map(function(f) {
          var O;
          var y, b, w;
          if (b = f.page_type, a = f.frequency_threshold, h = f.setting_id, (w = o.find((C) => C.type === b)) && !((O = w.sent_settings) != null && O.includes(h)) && w.count >= a)
            return r.Ee(b, w[b], h), y = { title: r.C, url: d, type: b, pv: w.count, setting_id: h }, r.j("view_frequently_pagetype", y);
        });
    }, e(), n = "", i = "", document.hidden !== void 0 ? (n = "hidden", i = "visibilitychange") : document.msHidden !== void 0 ? (n = "msHidden", i = "msvisibilitychange") : document.webkitHidden !== void 0 && (n = "webkitHidden", i = "webkitvisibilitychange"), document.addEventListener(i, function() {
      if (!document[n])
        return e();
    });
  }
  Ie(e, n, i) {
    var r, o, s, a, u;
    a = this.Xt(), u = this.ht.get(E), (s = (u == null ? void 0 : u[a]) || []) && (r = s.find((l) => l.type === "url" && l.url === e), r && (i ? r.sent_testsettings.push(i) : r.sent_settings.push(n)));
    try {
      this.ht.set(E, u);
    } catch (l) {
      o = l, this.ue({ type: "trackerjs_localstorage_error", error_message: o.message, error_stack: o.stack, details: { localStorage_key: E, localStorage_data: r, adding_data: { url: e, setting_id: n, test_id: i } } }), this.clearContextEventLocalStorage();
    }
  }
  Te(e, n, i) {
    var r, o, s, a, u;
    a = this.Xt(), u = this.ht.get(E), (s = (u == null ? void 0 : u[a]) || []) && (r = s.find((l) => l.type === e && l[e] === n), r && r.sent_settings.push(i));
    try {
      this.ht.set(E, u);
    } catch (l) {
      o = l, this.ue({ type: "trackerjs_localstorage_error", error_message: o.message, error_stack: o.stack, details: { localStorage_key: E, localStorage_data: r, adding_data: { category: e, category_value: n, setting_id: i } } }), this.clearContextEventLocalStorage();
    }
  }
  Ee(e, n, i) {
    var r, o, s, a, u;
    a = this.Xt(), u = this.ht.get(E), (s = (u == null ? void 0 : u[a]) || []) && (r = s.find((l) => l.type === e), r && r.sent_settings.push(i));
    try {
      this.ht.set(E, u);
    } catch (l) {
      o = l, this.ue({ type: "trackerjs_localstorage_error", error_message: o.message, error_stack: o.stack, details: { localStorage_key: E, localStorage_data: r, adding_data: { patetype: e, setting_id: i } } }), this.clearContextEventLocalStorage();
    }
  }
  trackFocusing(e) {
    var n, i, r, o, s, a;
    s = e.target_view_count, i = e.frequency_threshold, o = e.spend_minutes, r = e.ng_urls, a = e.urlCondition, n = e.auto_page_groups, i || (i = 0), o || (o = 0), s && (i || o) && (this.Et = { target_view_count: s, focusing_pv: i, spend_time: 60 * o, ng_urls: r, urlCondition: a, auto_page_groups: n });
  }
  trackComparing(e) {
    var n, i, r, o, s;
    o = e.target_view_count, i = e.frequency_threshold, r = e.ng_urls, s = e.urlCondition, n = e.auto_page_groups, this.Ct = { target_view_count: o, compare_pv: i, ng_urls: r, urlCondition: s, auto_page_groups: n };
  }
  trackTouring(e) {
    var n, i, r, o, s, a, u;
    a = e.target_view_count, s = e.spend_time, o = e.spend_minutes, r = e.page_count, i = e.ng_urls, u = e.urlCondition, n = e.auto_page_groups, a && (o || s) && r && (this.Ot = { target_view_count: a, spend_time: s || 60 * o, page_count: r, ng_urls: i, urlCondition: u, auto_page_groups: n });
  }
  trackSkipping(e) {
    var n, i, r, o, s, a;
    s = e.target_view_count, o = e.spend_time, r = e.page_count, i = e.ng_urls, a = e.urlCondition, n = e.auto_page_groups, this.At = { target_view_count: s, spend_time: o, page_count: r, ng_urls: i, urlCondition: a, auto_page_groups: n };
  }
  trackSearching(e) {
    var n;
    n = e.target_view_minutes, this.St = { target_view_time: 60 * n };
  }
  trackCheckingRecommendation(e) {
    var n;
    n = e.target_view_minutes, this.Mt = { target_view_time: 60 * n };
  }
  trackReachingGoal(e) {
    var n;
    n = e.target_view_minutes, this.qt = { target_view_time: 60 * n };
  }
  setContextModeSettings(e) {
    var n;
    n = e.ng_urls, this.Tt = { ng_urls: n };
  }
  trackActionMode() {
    const e = this, n = function() {
      var a, u, l;
      var r, o, s;
      s = ((a = e.O) == null ? void 0 : a.canonical_url) || ((l = (u = e.O) == null ? void 0 : u.uri) == null ? void 0 : l.url), o = e.C || document.title, e.Kt(), e.me(s, o), r = 0, e.ee = setInterval(function() {
        r++, !e.ct() || r > 900 ? clearInterval(e.ee) : r <= 5 ? (e.ge(2), i(r)) : r > 5 && r <= 30 ? r % 5 == 0 && (e.ge(10), i(r)) : r > 30 && r % 30 == 0 && (e.ge(60), i(r));
      }, 2e3), i(0);
    }, i = function(r) {
      let o, s = e.he();
      s || (s = Ge);
      const a = Math.round((new Date().getTime() - e._t.getTime()) / 1e3);
      a >= 1800 || ((o = e.Ce()) ? s !== xe && e.Oe(xe, o, { update_times: r, second_from_view: a }) : (o = e.Ae()) ? s !== Oe && e.Oe(Oe, o, { update_times: r, second_from_view: a }) : (o = e.Se()) ? s !== Ee && e.Oe(Ee, o, { update_times: r, second_from_view: a }) : (o = e.Me()) ? s !== He && e.Oe(He, o, { update_times: r, second_from_view: a }) : (o = e.qe()) ? s !== Ie && e.Oe(Ie, o, { update_times: r, second_from_view: a }) : (o = e.De()) ? s !== Ce && e.Oe(Ce, o, { update_times: r, second_from_view: a }) : (o = e.Re()) ? s !== je && e.Oe(je, o, { update_times: r, second_from_view: a }) : s !== Ge && e.Fe({ update_times: r, second_from_view: a }));
    };
    n(), this.re(n, !1), this.Pe();
  }
  re(e, n, i) {
    var r, o;
    return r = "", o = "", document.hidden !== void 0 ? (r = "hidden", o = "visibilitychange") : document.msHidden !== void 0 ? (r = "msHidden", o = "msvisibilitychange") : document.webkitHidden !== void 0 && (r = "webkitHidden", o = "webkitvisibilitychange"), document.addEventListener(o, function() {
      (document[r] && n || !document[r] && !n) && e(i);
    });
  }
  ct() {
    var e;
    return e = "", document.hidden !== void 0 ? e = "hidden" : document.msHidden !== void 0 ? e = "msHidden" : document.webkitHidden !== void 0 && (e = "webkitHidden"), !document[e];
  }
  Ce() {
    var c;
    var e, n, i, r, o, s, a, u, l;
    return a = (o = this.Et) != null ? o : (c = F.find((h) => h.name === xe)) == null ? void 0 : c.data, a ? (e = ge((a.ng_urls || []).concat(this.Tt.ng_urls || [])), s = this.ve(), u = Math.max(0, s.length - a.target_view_count), r = s.slice(u), i = [], r.filter((l = this, function(h) {
      return l.isActionModeTargetPage(h, a.urlCondition, e, a.auto_page_groups);
    })).map(function(h) {
      var g;
      (g = i.find((d) => d.url === h.url)) ? (g.count += 1, g.pv_ids.push(h.pv_id), g.dates.push(h.date), g.max_spend_time = Math.max(g.max_spend_time, h.spend_time)) : (g = { url: h.url, title: h.title, item: h.item, pv_ids: [h.pv_id], dates: [h.date], max_spend_time: h.spend_time, count: 1 }, i.push(g));
    }), n = i.find((h) => a.focusing_pv !== 0 && h.count >= a.focusing_pv || a.spend_time !== 0 && h.max_spend_time >= a.spend_time), n ? { reasons: [n], first_event_date: n.dates[0], last_event_date: n.dates[n.dates.length - 1] } : null) : null;
  }
  Ae() {
    var g;
    const e = this;
    var n, i, r, o, s, a, u, l, c, h;
    return c = (u = this.Ct) != null ? u : (g = F.find((d) => d.name === Oe)) == null ? void 0 : g.data, c ? (r = ge((c.ng_urls || []).concat(this.Tt.ng_urls || [])), l = this.ve(), h = Math.max(0, l.length - c.target_view_count), a = l.slice(h), s = [], a.map(function(d) {
      var p;
      e.isActionModeTargetPage(d, c.urlCondition, r, c.auto_page_groups) && ((p = s.find(function(_) {
        return _.url === d.url;
      })) ? (p.count += 1, p.pv_ids.push(d.pv_id), p.dates.push(d.date)) : (p = { url: d.url, title: d.title, item: d.item, pv_ids: [d.pv_id], dates: [d.date], count: 1 }, s.push(p)));
    }), (o = s.filter(function(d) {
      return d.count >= c.compare_pv;
    })).length >= 2 ? (n = o.map(function(d) {
      return d.dates[0];
    }).reduce(function(d, p) {
      return d < p ? d : p;
    }), i = o.map(function(d) {
      return d.dates[d.dates.length - 1];
    }).reduce(function(d, p) {
      return d > p ? d : p;
    }), { reasons: o, first_event_date: n, last_event_date: i }) : null) : null;
  }
  Re() {
    var l;
    var e, n, i, r, o, s, a, u;
    return s = (r = this.Ot) != null ? r : (l = F.find((c) => c.name === je)) == null ? void 0 : l.data, s ? (e = ge((s.ng_urls || []).concat(this.Tt.ng_urls || [])), o = this.ve(), a = Math.max(0, o.length - s.target_view_count), n = o.slice(a), i = [], n.filter((u = this, function(c) {
      return u.isActionModeTargetPage(c, s.urlCondition, e, s.auto_page_groups);
    })).filter(function(c) {
      return c.spend_time >= s.spend_time;
    }).map(function(c) {
      var h;
      if (h = i.find(function(g) {
        return g.url === c.url;
      }), !h)
        return i.push({ url: c.url, title: c.title, item: c.item, spend_time: c.spend_time, pv_id: c.pv_id, date: c.date });
    }), i.length >= s.page_count ? { reasons: i, first_event_date: i[0].date, last_event_date: i[i.length - 1].date } : null) : null;
  }
  De() {
    var l;
    var e, n, i, r, o, s, a, u;
    return s = (r = this.At) != null ? r : (l = F.find((c) => c.name === Ce)) == null ? void 0 : l.data, s ? (e = ge((s.ng_urls || []).concat(this.Tt.ng_urls || [])), o = this.ve(), a = Math.max(0, o.length - s.target_view_count - 1), n = o.slice(a, -1), i = [], n.filter((u = this, function(c) {
      return u.isActionModeTargetPage(c, s.urlCondition, e, s.auto_page_groups);
    })).filter(function(c) {
      return c.spend_time <= s.spend_time;
    }).map(function(c) {
      var h;
      if (h = i.find(function(g) {
        return g.url === c.url;
      }), !h)
        return i.push({ url: c.url, title: c.title, item: c.item, spend_time: c.spend_time, pv_id: c.pv_id, date: c.date });
    }), i.length >= s.page_count ? { reasons: i, first_event_date: i[0].date, last_event_date: i[i.length - 1].date } : null) : null;
  }
  Se() {
    var s;
    var e, n, i, r, o;
    return o = (n = this.St) != null ? n : (s = F.find((a) => a.name === Ee)) == null ? void 0 : s.data, o ? (r = this._e(), e = new Date().getTime() / 1e3, i = r.filter(function(a) {
      return a.date + o.target_view_time > e;
    }).filter(function(a) {
      return a.event_name === "search";
    }).map(function(a) {
      var u;
      return { event_name: a.event_name, text: (u = a.values) != null ? u.text : void 0, pv_id: a.pv_id, date: a.date };
    }), i.length > 0 ? { reasons: i, first_event_date: i[0].date, last_event_date: i[i.length - 1].date } : null) : null;
  }
  qe() {
    var a;
    var e, n, i, r, o, s;
    return o = (i = this.Mt) != null ? i : (a = F.find((u) => u.name === Ie)) == null ? void 0 : a.data, o ? (s = ["view_ranking", "click_ranking_item", "click_recommend_item"], r = this._e(), n = new Date().getTime() / 1e3, e = r.filter(function(u) {
      return u.date + o.target_view_time > n;
    }).filter(function(u) {
      return s.includes(u.event_name);
    }).map(function(u) {
      var l, c, h, g;
      return u.event_name === "view_ranking" ? { event_name: u.event_name, url: (l = u.values) == null ? void 0 : l.url, title: (c = u.values) == null ? void 0 : c.title, pv_id: u.pv_id, date: u.date } : { event_name: u.event_name, item: (h = u.values) == null ? void 0 : h.item, link: (g = u.values) == null ? void 0 : g.link, pv_id: u.pv_id, date: u.date };
    }), e.length > 0 ? { reasons: e, first_event_date: e[0].date, last_event_date: e[e.length - 1].date } : null) : null;
  }
  Me() {
    var s;
    var e, n, i, r, o;
    return o = (i = this.qt) != null ? i : (s = F.find((a) => a.name === He)) == null ? void 0 : s.data, o ? (r = this._e(), e = new Date().getTime() / 1e3, n = r.filter(function(a) {
      return a.date + o.target_view_time > e;
    }).filter(function(a) {
      return a.event_name === "view_near_goal";
    }).map(function(a) {
      var u, l;
      return { event_name: a.event_name, url: (u = a.values) == null ? void 0 : u.url, title: (l = a.values) == null ? void 0 : l.title, pv_id: a.pv_id, date: a.date };
    }), n.length > 0 ? { reasons: n, first_event_date: n[0].date, last_event_date: n[n.length - 1].date } : null) : null;
  }
  Oe(e, { reasons: n, first_event_date: i, last_event_date: r }, { update_times: o, second_from_view: s }) {
    var l, c, h;
    const a = ((l = this.O) == null ? void 0 : l.canonical_url) || ((h = (c = this.O) == null ? void 0 : c.uri) == null ? void 0 : h.url), u = this.C || document.title;
    this.j("context_mode_change", { mode: e, title: u, url: a, reasons: n, first_event_date: i, last_event_date: r, update_times: o, second_from_view: s }), this.setContextMode(e);
  }
  Fe({ update_times: e, second_from_view: n }) {
    var o, s, a;
    const i = ((o = this.O) == null ? void 0 : o.canonical_url) || ((a = (s = this.O) == null ? void 0 : s.uri) == null ? void 0 : a.url), r = this.C || document.title;
    this.j("context_mode_change", { mode: "other", title: r, url: i, update_times: e, second_from_view: n }), this.setContextMode(Ge);
  }
  Pe() {
    var e, n, i;
    i = this, e = function() {
      var l;
      var r, o, s, a, u;
      i.Ht || (r = gn, s = ao, i.Z && (a = (new Date().getTime() - i.Z.getTime()) / 1e3, u = (l = i.ve()) == null ? void 0 : l.length, i.Ut + a >= r ? (o = { total_active_time: i.Ut + a, total_pv: u, trigger: "active_time" }, i.Jt && i.j("_engaged_session", o), i.le(!0)) : u >= s && (o = { total_active_time: i.Ut, total_pv: u, trigger: "page_count" }, i.Jt && i.j("_engaged_session", o), i.le(!0))));
    }, n = function(r) {
      return function() {
        var o;
        if ((o = gn - r.Ut) > 0)
          return setTimeout(function() {
            return e();
          }, 1e3 * o);
      };
    }(this), this.Ht || (e(), this.Ht || n());
  }
  trackVisibilityChange() {
    var e;
    this.k && console.log("trackVisibilityChange custom_tag on"), this.zt = !0, this.re(this.J, !0, { trigger: "tabHidden" }), this.re((e = this, function() {
      e.$e(), e.tt = null, e.rt = !1, e.et = 0;
    }), !1);
  }
  trackActivityChange() {
    var e, n, i;
    this.k && console.log("trackActivityChange custom_tag on"), this.it = !0, this.ot = null, n = de((i = this, function() {
      i.rt ? (clearTimeout(i.ot), i.ot = setTimeout(function() {
        i.rt = !1, i.Ve();
      }, 1e4)) : (i.Ue(), i.rt = !0);
    }), 1e3, { leading: !0 }), window.addEventListener("scroll", n), window.addEventListener("mousemove", n), e = 0, this.Y = 0, this.ne = setInterval(function(r) {
      return function() {
        ++e > 1800 || r.Y >= 30 || r.X >= 3 ? (r.k && console.log("clear _sendActivityChangeEventTimer"), clearInterval(r.ne)) : e <= 5 || (e > 5 && e <= 10 ? r.ut() : e > 10 && e <= 30 ? e % 5 == 0 && r.ut() : e > 30 && e <= 150 ? e % 15 == 0 && r.ut() : e > 150 && e <= 300 ? e % 30 == 0 && r.ut() : e > 300 && e <= 600 ? e % 60 == 0 && r.ut() : e > 600 && e % 150 == 0 && r.ut());
      };
    }(this), 2e3);
  }
  Ve() {
    var e;
    this.k && console.log("_updateUserActiveTime"), this.tt && (e = (new Date().getTime() - this.tt.getTime()) / 1e3 - 10, this.et = this.et + e, this.tt = null);
  }
  $e() {
    this.k && console.log("_resetTabActiveTime ==="), this.Z = new Date();
  }
  Ue() {
    this.k && console.log("_resetUserActiveTime ==="), this.tt = new Date();
  }
}
class co {
  constructor(e) {
    this.He = e;
  }
  trackHaveInterest(e, n) {
    this.He.isCurrentPageTarget(e != null ? e.urlCondition : void 0, e != null ? e.auto_page_groups : void 0) && (this.He.debug_loaded_settings.push({ event_name: "have_interest", setting_id: n }), this.He.trackHaveInterest(e, n));
  }
  trackHaveInterestTest(e, n) {
    this.He.isCurrentPageTarget(e != null ? e.urlCondition : void 0, e != null ? e.auto_page_groups : void 0) && (this.He.debug_loaded_settings.push({ event_name: "have_interest_test", setting_id: n }), this.He.trackHaveInterestTest(e, n));
  }
  trackFinishReading(e, n) {
    this.He.isCurrentPageTarget(e != null ? e.urlCondition : void 0, e != null ? e.auto_page_groups : void 0) && (this.He.debug_loaded_settings.push({ event_name: "finish_reading", setting_id: n }), this.He.trackFinishReading(e, n));
  }
  trackLeave(e, n) {
    this.He.isCurrentPageTarget(e != null ? e.urlCondition : void 0, e != null ? e.auto_page_groups : void 0) && (this.He.debug_loaded_settings.push({ event_name: "leave", setting_id: n }), this.He.trackLeave(e, n));
  }
  trackLeaveTest(e, n) {
    this.He.isCurrentPageTarget(e != null ? e.urlCondition : void 0, e != null ? e.auto_page_groups : void 0) && (this.He.debug_loaded_settings.push({ event_name: "leave_test", setting_id: n }), this.He.trackLeaveTest(e, n));
  }
  trackSearch(e, n) {
    this.He.isCurrentPageTarget(e != null ? e.urlCondition : void 0, e != null ? e.auto_page_groups : void 0) && (this.He.debug_loaded_settings.push({ event_name: "search", setting_id: n }), this.He.trackSearch(e, n));
  }
  trackPageInfo(e, n) {
    this.He.isCurrentPageTarget(e != null ? e.urlCondition : void 0, e != null ? e.auto_page_groups : void 0) && (this.He.debug_loaded_settings.push({ event_name: "scroll_info", setting_id: n }), this.He.trackPageInfo(e, n));
  }
  trackRageClick(e, n) {
    this.He.isCurrentPageTarget(e != null ? e.urlCondition : void 0, e != null ? e.auto_page_groups : void 0) && (this.He.debug_loaded_settings.push({ event_name: "rage_click", setting_id: n }), this.He.trackRageClick(e, n));
  }
  trackViewRanking(e, n) {
    this.He.isCurrentPageTarget(e != null ? e.urlCondition : void 0, e != null ? e.auto_page_groups : void 0) && (this.He.debug_loaded_settings.push({ event_name: "view_ranking", setting_id: n }), this.He.trackViewRanking(e, n));
  }
  trackViewNearGoal(e, n) {
    this.He.isCurrentPageTarget(e != null ? e.urlCondition : void 0, e != null ? e.auto_page_groups : void 0) && (this.He.debug_loaded_settings.push({ event_name: "view_near_goal", setting_id: n }), this.He.trackViewNearGoal(e, n));
  }
  trackClickPageItem(e, n) {
    this.He.isCurrentPageTarget(e != null ? e.urlCondition : void 0, e != null ? e.auto_page_groups : void 0) && (this.He.debug_loaded_settings.push({ event_name: e.event_name, setting_id: n }), this.He.trackClickPageItem(e, n));
  }
  trackClickLinkItem(e, n) {
    this.He.isCurrentPageTarget(e != null ? e.urlCondition : void 0, e != null ? e.auto_page_groups : void 0) && (this.He.debug_loaded_settings.push({ event_name: e.event_name, setting_id: n }), this.He.trackClickLinkItem(e, n));
  }
  testClickInfo(e) {
    this.He.testClickInfo(e);
  }
  trackMatchText(e, n) {
    this.He.isCurrentPageTarget(e != null ? e.urlCondition : void 0, e != null ? e.auto_page_groups : void 0) && (this.He.debug_loaded_settings.push({ event_name: e.event_name, setting_id: n }), this.He.trackMatchText(e, n));
  }
  testMatchText(e) {
    this.He.testMatchText(e);
  }
  trackCustomClickOrDisplayed(e, n) {
    this.He.isCurrentPageTarget(e != null ? e.urlCondition : void 0, e != null ? e.auto_page_groups : void 0) && (this.He.debug_loaded_settings.push({ event_name: e.event_name, setting_id: n }), this.He.trackCustomClickOrDisplayed(e, n));
  }
  trackViewPage(e, n) {
    this.He.isCurrentPageTarget(e != null ? e.urlCondition : void 0, e != null ? e.auto_page_groups : void 0) && (this.He.debug_loaded_settings.push({ event_name: e.event_name, setting_id: n }), this.He.trackViewPage(e, n));
  }
  trackStayLongTime(e, n) {
    this.He.isCurrentPageTarget(e != null ? e.urlCondition : void 0, e != null ? e.auto_page_groups : void 0) && (this.He.debug_loaded_settings.push({ event_name: "stay_long_time", setting_id: n }), this.He.trackStayLongTime(e, n));
  }
  trackWanderInPage(e, n) {
    this.He.isCurrentPageTarget(e != null ? e.urlCondition : void 0, e != null ? e.auto_page_groups : void 0) && (this.He.debug_loaded_settings.push({ event_name: "wander_in_page", setting_id: n }), this.He.trackWanderInPage(e, n));
  }
  trackViewFrequentlyItem(e, n) {
    this.He.isCurrentPageTarget(e != null ? e.urlCondition : void 0, e != null ? e.auto_page_groups : void 0) && (this.He.debug_loaded_settings.push({ event_name: "view_frequently_item", setting_id: n }), this.He.trackViewFrequentlyItem(e, n));
  }
  trackViewFrequentlyItemTest(e, n) {
    this.He.isCurrentPageTarget(e != null ? e.urlCondition : void 0, e != null ? e.auto_page_groups : void 0) && (this.He.debug_loaded_settings.push({ event_name: "view_frequently_item_test", setting_id: n }), this.He.trackViewFrequentlyItemTest(e, n));
  }
  trackViewFrequentlyCategory(e, n) {
    this.He.isCurrentPageTarget(e != null ? e.urlCondition : void 0, e != null ? e.auto_page_groups : void 0) && (this.He.debug_loaded_settings.push({ event_name: "view_frequently_category", setting_id: n }), this.He.trackViewFrequentlyCategory(e, n));
  }
  trackViewFrequentlyPageType(e, n) {
    this.He.isCurrentPageTarget(e != null ? e.urlCondition : void 0, e != null ? e.auto_page_groups : void 0) && (this.He.debug_loaded_settings.push({ event_name: "view_frequently_pagetype", setting_id: n }), this.He.trackViewFrequentlyPageType(e, n));
  }
  trackViewFrequently() {
    this.He.trackViewFrequently();
  }
  getItemId(e, n) {
    this.He.isCurrentPageTarget(e != null ? e.urlCondition : void 0, e != null ? e.auto_page_groups : void 0) && (this.He.debug_loaded_settings.push({ event_name: "get_item_id", setting_id: n }), this.He.getItemId(e, n));
  }
  getLinkItemId(e, n) {
    this.He.isCurrentPageTarget(e != null ? e.urlCondition : void 0, e != null ? e.auto_page_groups : void 0) && (this.He.debug_loaded_settings.push({ event_name: "get_link_item_id", setting_id: n }), this.He.getLinkItemId(e, n));
  }
  getItemInfo(e, n) {
    this.He.getItemInfo(e, n);
  }
  testItemInfo(e) {
    this.He.testItemInfo(e);
  }
  trackFocusing(e) {
    this.He.trackFocusing(e);
  }
  trackComparing(e) {
    this.He.trackComparing(e);
  }
  trackTouring(e) {
    this.He.trackTouring(e);
  }
  trackSkipping(e) {
    this.He.trackSkipping(e);
  }
  trackSearching(e) {
    this.He.trackSearching(e);
  }
  trackCheckingRecommendation(e) {
    this.He.trackCheckingRecommendation(e);
  }
  trackReachingGoal(e) {
    this.He.trackReachingGoal(e);
  }
  setContextModeSettings(e) {
    this.He.setContextModeSettings(e);
  }
  trackActionMode() {
    this.He.trackActionMode();
  }
  trackAutoPageGroup(e) {
    this.He.trackAutoPageGroup(e);
  }
  trackEngagement(e) {
  }
  trackVisibilityChange(e) {
    this.He.trackVisibilityChange();
  }
  trackActivityChange(e) {
    this.He.trackActivityChange();
  }
  debugContextEvent() {
    this.He.debugContextEvent();
  }
  clearContextEventLocalStorage() {
    this.He.clearContextEventLocalStorage();
  }
  getAutoPageGroupMatched() {
    return this.He.T;
  }
  getItemInfoSettings() {
    return this.He.I;
  }
}
const ho = Qn, go = (t) => {
  var n;
  if (typeof ((n = window.tracker) == null ? void 0 : n.init) == "function")
    return void t.logger.log("[krt:edge] context event has been already loaded.");
  const e = new lo(t);
  e.init().then(async () => {
    const i = `__KARTE_EDGE_${t.apiKey}`;
    window[i] !== null && typeof window[i] == "object" && window[i].constructor === Object && (window[i].__contextEvent = e);
    const r = new co(e);
    (async function(o, s) {
      new Function("contextEventTracker", o)(s);
    })(t.pluginParams.customTag, r).catch((o) => t.handle_error(o)), t.pubsub.subscribe(tt, (o, s) => {
      var a;
      try {
        if (o) {
          const u = t.meta.getMainMeta();
          (((a = o == null ? void 0 : o.req) == null ? void 0 : a.events) || []).find((l) => {
            var c;
            return (l.event_name || l.eventName) == "view" && ((c = l.meta) == null ? void 0 : c.pv_id) == (u == null ? void 0 : u.pv_id) && (u == null ? void 0 : u.pv_id) != (u == null ? void 0 : u.original_pv_id);
          }) && e.updatePvId();
        }
      } catch (u) {
        t.handle_error(u);
      }
    }), t.pubsub.subscribe(H, (o, s) => {
      try {
        if ((o == null ? void 0 : o.event_name) == "view" || (o == null ? void 0 : o.eventName) == "view") {
          const a = j(r.getItemInfoSettings(), r.getAutoPageGroupMatched(), "view", e.k), u = function(l) {
            var h;
            let c = {};
            return (l == null ? void 0 : l.type) === "category" ? ((h = l.setting.extractors) == null || h.map((g) => {
              g.field && (c[g.field] = P(g));
            }), c) : null;
          }(r.getAutoPageGroupMatched());
          if (a || u) {
            let l = {};
            a && (l.item = a), u && (l.category = u);
            const c = { event_name: "item_crawling", values: l };
            t.pubsub.publish(H, c), e.k && (console.log("context event send. event_name: " + c.event_name), console.log(c.values));
          }
        }
      } catch (a) {
        t.handle_error(a);
      }
    });
  }).catch(t.handle_error);
};
export {
  ho as config,
  go as default
};

</script>

</body>
</html>
