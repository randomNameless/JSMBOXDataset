<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>3538.983dc794879705f9.html</title>
</head>
<body>

<script>
"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3538],{12156:function(e,t,n){n.d(t,{Z:function(){return c}});var r=class extends Error{constructor(){super("Invalid swedish personal identity number")}},a=(e,t)=>{let n=e.getTime()-t.getTime();return n<0?-1:n>0?1:n},i=(e,t)=>{let n=a(e,t),r=Math.abs(e.getFullYear()-t.getFullYear());e.setFullYear(e.getFullYear()-n*r);let i=a(e,t)===-n,o=n*(r-+i);return 0===o?0:o},o=e=>{let t=0;e+="";for(let n=0,r=e.length;n<r;n++){let r=parseInt(e[n]);(r*=2-n%2)>9&&(r-=9),t+=r}return 10*Math.ceil(t/10)-t},s=(e,t,n)=>{let r=new Date(e,t-=1,n);return!(r.getFullYear()!==e||r.getMonth()!==t||r.getDate()!==n)},l=class{constructor(e,t){this._century="",this._fullYear="",this._year="",this._month="",this._day="",this._sep="",this._num="",this._check="",this.parse(e,{allowCoordinationNumber:!0,allowInterimNumber:!1,...t})}get century(){return this._century}get fullYear(){return this._fullYear}get year(){return this._year}get month(){return this._month}get day(){return this._day}get sep(){return this._sep}get num(){return this._num}get check(){return this._check}static parse(e,t){return new l(e,t)}static valid(e,t){try{return l.parse(e,t),!0}catch(e){return!1}}parse(e,t){if(e.length<10||e.length>13)throw new r;let n=/^(\d{2}){0,1}(\d{2})(\d{2})(\d{2})([+-]?)((?!000)\d{3}|[TRSUWXJKLMN]\d{2})(\d)$/.exec(e);if(!n)throw new r;let a=n[1],i=n[2],o=n[3],s=n[4],l=n[5],c=n[6],d=n[7];if(void 0!==a&&a.length)this._century=a,new Date().getFullYear()-parseInt(a+i,10)<100?this._sep="-":this._sep="+";else{let e=new Date,t=0;"+"===l?(this._sep="+",t=e.getFullYear()-100):(this._sep="-",t=e.getFullYear()),this._century=(""+(t-(t-parseInt(i))%100)).substr(0,2)}if(this._year=i,this._fullYear=this._century+i,this._month=o,this._day=s,this._num=c,this._check=d,!this.valid()||!(null==t?void 0:t.allowCoordinationNumber)&&this.isCoordinationNumber()||!(null==t?void 0:t.allowInterimNumber)&&this.isInterimNumber())throw new r}valid(){let e=o(this.year+this.month+this.day+this.num.replace(/[TRSUWXJKLMN]/,"1"))===+this.check&&!!this.check;return e&&s(parseInt(this.century+this.year),+this.month,+this.day)?e:e&&s(parseInt(this.century+this.year),+this.month,+this.day-60)}format(e=!1){return e?`${this.century}${this.year}${this.month}${this.day}${this.num}${this.check}`:`${this.year}${this.month}${this.day}${this.sep}${this.num}${this.check}`}getAge(){let e=this.getDate();return i(new Date(Date.now()),e)}getDate(){let e=+this.day;return this.isCoordinationNumber()&&(e-=60),new Date(this.century+this.year+"-"+this.month+"-"+(e<10?"0"+e:e))}isInterimNumber(){return/[TRSUWXJKLMN]/.test(this.num[0])}isCoordinationNumber(){return s(parseInt(this.century+this.year),+this.month,+this.day-60)}isFemale(){return!this.isMale()}isMale(){return parseInt(this.num.substr(-1))%2==1}},c=l},62527:function(e,t,n){n.d(t,{$4:function(){return s},GF:function(){return l},JS:function(){return o},Kp:function(){return h},_d:function(){return u},eN:function(){return d},j0:function(){return i},q:function(){return c},s1:function(){return a}});let r=new(n(69556)).bi(void 0,""),a=e=>{let{saveCard:t,selectedCardId:n,orderRef:a,userClickedContinue:i,cancelToken:o,klarnaAuthorizationToken:s}=e;return r.simplifiedPlaceOrderUsingPOST(t,n,a,s,i,{cancelToken:o,validateStatus:e=>e>=200&&e<300||402===e})},i=async()=>(await r.initializeCheckoutUsingGET()).data,o=(e,t)=>r.bankIdSignUsingPOST(e,t),s=(e,t)=>r.bankIdCollectUsingPOST({orderRef:e},t),l=(e,t)=>r.bankIdAuthUsingPOST(e,t),c=(e,t,n)=>r.bankIdCollectLoginUsingPOST({orderRef:e,rememberMe:t.toString()},n),d=e=>r.bankIdQrDataUsingPOST(e),u=(e,t)=>r.bankCancelUsingPOST({orderRef:e},t),h=e=>r.createSessionUsingGET(e)},66678:function(e,t,n){n.d(t,{Cp:function(){return c},DS:function(){return s},Lu:function(){return a},Zn:function(){return i},hY:function(){return l},jO:function(){return o}});let r=new(n(57455)).Ig({baseUrl:""}),a=e=>r.checkCustomerExistsUsingPost(e),i=e=>r.checkExistingB2BCustomerUsingGet({organisationNumber:e}),o=e=>r.checkExistingB2BCustomerBySapIdUsingGet({sapid:e}),s=e=>r.verifySmsTokenUsingPost(e),l=e=>r.validateEmailTokenUsingPost({token:e},{format:"json"}),c=(e,t,n,a,i,o)=>r.changePasswordUsingPost({token:e,pwd:t,checkPwd:n,rememberMe:a,pwdKey:i,checkPwdKey:o})},40949:function(e,t,n){n.d(t,{$R:function(){return K},Tq:function(){return V},bb:function(){return $}});var r=n(48282),a=n(18529),i=n(76924),o=n(63359),s=n(54735),l=n(90610),c=n(70313);let d=l.ZP.div.withConfig({componentId:"sc-fa771bfc-0"})(["margin-top:",";width:100%;"],(0,c.hO)(64)),u=(0,l.ZP)(s.Z).withConfig({componentId:"sc-fa771bfc-1"})(["width:100%;"]),h=l.ZP.div.withConfig({componentId:"sc-fa771bfc-2"})(["align-items:center;display:flex;flex-direction:column;justify-content:center;margin-top:",";width:100%;"],(0,c.hO)(40)),m=l.ZP.div.withConfig({componentId:"sc-fa771bfc-3"})(["display:flex;justify-content:center;margin:"," 0;max-width:",";"],(0,c.hO)(32),(0,c.hO)(300));var p=n(61699),g=n(6714);let{LOGIN_ALREADY_IN_PROGRESS:b,LOGIN_CANCELLED:f,LOGIN_CERTIFICATE_ERROR:y,LOGIN_CUSTOMER_NOT_FOUND:w,LOGIN_EXPIRED_TRANSACTION:x,LOGIN_INTERNAL_ERROR:Z,LOGIN_MAINTENANCE:_,LOGIN_NO_CLIENT:v,LOGIN_OUTSTANDING_TRANSACTION:C,LOGIN_REQUEST_TIMEOUT:j,LOGIN_START_FAILED:I,LOGIN_STARTED:S,LOGIN_USER_CANCEL:O,LOGIN_USER_SIGN:k}=o.BANK_ID_SIGN_HINT_CODES,{RFA1:R,RFA3:T,RFA4:P,RFA5:E,RFA6:A,RFA8:M,RFA9:F,RFA13:B,RFA15:D,RFA16:L,RFA17A:N,RFA17B:q,RFA21:G,RFA22:U}=o.BANK_ID_TRANSLATION_CODES,z=e=>{let{hintCode:t,isSameDevice:n}=e;switch(t){case C:case v:return n?B:R;case k:return F;case S:return D;default:return G}},W=e=>{let{isQr:t,hintCode:n}=e;switch(n){case f:return T;case b:return P;case Z:case j:case _:return E;case O:return A;case x:return M;case y:return L;case I:return t?q:N;case w:return o.bm;default:return U}};var H=n(67340);let $=e=>{let{handleCancel:t,hintCode:n,isSameDevice:a}=e,{t:o}=(0,i.Z)("bankid"),s=z({hintCode:n,isSameDevice:a});return(0,r.jsxs)(h,{"data-testid":"pending-auth",children:[(0,r.jsx)(p.Z,{type:"body",children:o("bankid:userMessage->".concat(s))}),(0,r.jsx)(m,{children:(0,r.jsx)(g.Z,{size:32})}),(0,r.jsx)(d,{children:(0,r.jsx)(u,{theme:"link",size:"small",onClick:()=>{(0,H.Ao)("Pending Statuses"),t()},children:o("login:login->bankId->cancel")})})]})},V=e=>{let{handleReturnClick:t,hintCode:n,isQr:s}=e,{t:l}=(0,i.Z)("bankid"),c=W({isQr:s,hintCode:n});return(0,a.useEffect)(()=>{(0,H.bZ)(s?o.XV:o.Wk,l("bankid:userMessage->".concat(c)))},[]),(0,r.jsxs)(h,{"data-testid":"failed-auth",children:[(0,r.jsx)(p.Z,{type:"body",children:l("bankid:userMessage->".concat(c))}),(0,r.jsx)(d,{children:(0,r.jsx)(u,{disabled:n===o.eC,onClick:t,children:l("login:login->bankId->return")})})]})},K=()=>{let{t:e}=(0,i.Z)("login");return(0,r.jsxs)(h,{"data-testid":"pending-auth",children:[(0,r.jsx)(p.Z,{type:"body",children:e("login->bankId->loggingIn")}),(0,r.jsx)(m,{children:(0,r.jsx)(g.Z,{size:32})})]})}},77068:function(e,t,n){n.d(t,{Z:function(){return g}});var r=n(48282),a=n(96676),i=n(18529),o=n(76924),s=n(90610),l=n(70313);let c=s.ZP.div.withConfig({componentId:"sc-9eccd4fd-0"})(["margin-top:",";"],(0,l.hO)(40)),d=s.ZP.div.withConfig({componentId:"sc-9eccd4fd-1"})(["display:flex;flex-direction:column;align-items:center;"]),u=s.ZP.div.withConfig({componentId:"sc-9eccd4fd-2"})(["margin-top:",";margin-bottom:",";"],(0,l.hO)(50),(0,l.hO)(80));var h=n(61699),m=n(54735),p=n(67340),g=e=>{let{startBankIdFlow:t,handleCancel:n,showPending:s,showError:l,qrData:g}=e,{t:b}=(0,o.Z)("login");return((0,i.useEffect)(()=>{t({mobile:!0,sameDevice:!1})},[]),s||l)?null:(0,r.jsxs)(c,{"data-testid":"bankid-qr",children:[(0,r.jsx)(d,{children:(0,r.jsx)(h.Z,{type:"body",children:b("login->bankId->startMobileAppQr")})}),(0,r.jsx)(u,{children:g&&(0,r.jsx)(a.tv,{value:g,size:140})}),(0,r.jsx)(m.Z,{theme:"link",size:"small",onClick:()=>{(0,p.Ao)("QR"),n()},children:b("login->bankId->cancel")})]})}},14976:function(e,t,n){n.d(t,{$:function(){return o},j:function(){return i}});var r=n(63359);let a=Object.keys(r.mN),i=e=>a.includes(e),o=e=>r.G_.includes(e)},22144:function(e,t,n){n.d(t,{Z:function(){return d}});var r=n(48282),a=n(33105),i=n(73828),o=n(70313),s=n(90610);let l=s.ZP.div.withConfig({componentId:"sc-e65aa260-0"})(["width:100%;position:relative;"]),c=(0,s.ZP)(i.Z).withConfig({componentId:"sc-e65aa260-1"})(["position:absolute;top:",";transform:translateY(-50%);right:",";left:auto;margin-top:0;",""],(0,o.hO)(26),(0,o.hO)(15),e=>e.withLabel&&(0,s.iv)(["top:",";"],(0,o.hO)(50)));var d=e=>{let{inputLabel:t,inputName:n,inputType:i,inputValue:o,inputAriaLabel:s,inputMaxLength:d,inputOnChange:u,inputOnBlur:h,iconProps:m,variant:p,placeholder:g,tooltipContent:b,pattern:f,tooltipAlign:y="center",tooltipPosition:w="bottom",required:x,customValidity:Z,customValidator:_,testId:v}=e;return(0,r.jsxs)(l,{children:[(0,r.jsx)(a.Z,{label:t,name:n,type:i,variant:p,placeholder:g,value:o,maxLength:d,onChange:u,onBlur:h,"aria-label":s,pattern:f,required:x,customValidity:Z,customValidator:_,testId:v}),(0,r.jsx)(c,{content:b,iconProps:m,align:y,position:w,color:"black",withLabel:!!t})]})}},53538:function(e,t,n){n.r(t),n.d(t,{default:function(){return td}});var r=n(48282),a=n(18529),i=n(76924),o=n(68942),s=n(49603),l=n(11785),c=n(18788),d=n(26387),u=n(85020),h=n(94579),m=n(95329),p=n(24912),g=n(91446),b=n(61699),f=n(83107),y=n(66678),w=n(37068),x=n(4622),Z=n(22144),_=n(70024),v=n(85234),C=n(81704),j=n(13005),I=n(33105),S=n(26859),O=n(50186),k=n(78227),R=n(90610),T=n(70313),P=n(11357);let E=R.ZP.div.withConfig({componentId:"sc-c5814ff2-0"})(["display:flex;flex-direction:column;align-items:flex-start;text-align:",";"," "," &:last-child{margin-bottom:",";}",""],e=>e.alignment||"left",e=>"center"===e.alignment&&(0,R.iv)(["align-items:center;"]),e=>"right"===e.alignment&&(0,R.iv)(["align-items:flex-end;"]),(0,T.hO)(7),e=>e.gap&&(0,R.iv)(["gap:",";"],(0,T.hO)(e.gap))),A=(0,R.ZP)(P.Z).withConfig({componentId:"sc-c5814ff2-1"})(["margin-bottom:",";"],(0,T.hO)(4));var M=n(34224),F=e=>{let{mode:t,formValues:n,setFormValues:o,step:s,isSubmitting:l,errorMsg:c}=e,{t:d}=(0,i.Z)("lostPassword"),u=(0,a.useMemo)(()=>n.password!==n.repeatPassword?d("account:customer->password->passwordMatchError"):"",[n.password,n.repeatPassword]);return(0,r.jsx)(r.Fragment,{children:!l&&(0,r.jsxs)("div",{children:[t&&1===s&&(0,r.jsx)(Z.Z,{required:!0,inputValue:n[t],inputName:t,iconProps:{svg:M.Z,size:16},inputAriaLabel:d("step1->".concat(t,"->placeholder")),inputType:"text",placeholder:d("step1->".concat(t,"->placeholder")),tooltipContent:d("step1->".concat(t,"->tooltip")),inputOnChange:e=>o({...n,[t]:e.target.value}),tooltipAlign:"right",inputOnBlur:()=>o({...n,[t]:(0,v.Z)(n[t])}),pattern:"[0-9]*",customValidator:e=>_.t[t].test(e)?"":d("step1->error->".concat(t))}),2===s&&(0,r.jsxs)(E,{gap:28,children:[(0,r.jsx)(b.Z,{type:"body",children:d("step2->title")}),n.email&&(0,r.jsxs)(E,{gap:10,children:[(0,r.jsx)(b.Z,{type:"body",children:d("step2->radioEmail")}),(0,r.jsx)(j.Z,{checked:"email"===n.passwordRecoveryMethod,onChange:()=>o({...n,passwordRecoveryMethod:"email",verifyField:""}),id:"emailRadio",children:(0,r.jsx)(b.Z,{type:"subhead",children:n.email})})]}),n.phone&&(0,r.jsxs)(E,{gap:10,children:[(0,r.jsx)(b.Z,{type:"body",children:d("step2->radioPhone")}),(0,r.jsx)(j.Z,{checked:"phone"===n.passwordRecoveryMethod,onChange:()=>o({...n,passwordRecoveryMethod:"phone",verifyField:""}),id:"phoneRadio",children:(0,r.jsx)(b.Z,{type:"subhead",children:n.phone})})]})]}),3===s&&(0,r.jsxs)(E,{gap:20,children:[(0,r.jsx)(b.Z,{type:"body",children:d("step3->".concat(n.passwordRecoveryMethod,"->title"))}),(0,r.jsxs)(E,{gap:4,children:[(0,r.jsx)(b.Z,{type:"body",children:d("step3->".concat(n.passwordRecoveryMethod,"->label"))}),(0,r.jsx)(b.Z,{type:"subhead",children:n[n.passwordRecoveryMethod]})]}),(0,r.jsx)(I.Z,{type:"phone"===n.passwordRecoveryMethod?"number":"email",name:n.passwordRecoveryMethod,"aria-label":d("step3->".concat(n.passwordRecoveryMethod,"->placeholder")),placeholder:d("step3->".concat(n.passwordRecoveryMethod,"->placeholder")),value:n.verifyField,onChange:e=>o({...n,verifyField:e.target.value}),required:!0})]}),4===s&&(0,r.jsx)(E,{gap:28,children:(0,r.jsx)(b.Z,{type:"body",children:d("step4->email->infoText")})}),5===s&&(0,r.jsxs)(E,{gap:20,children:["phone"===n.passwordRecoveryMethod&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(b.Z,{type:"body",children:(0,r.jsx)(C.Z,{i18nKey:"lostPassword:step5->phone->infoText",values:{phone:n.verifyField},components:[(0,r.jsx)("strong",{},1)]})}),(0,r.jsx)(I.Z,{required:!0,type:"number",name:"verifySMSCode",placeholder:d("step5->phone->smsCodePlaceholder"),"aria-label":d("step5->phone->smsCodePlaceholder"),maxLength:6,value:n.smsCode,onChange:e=>o({...n,smsCode:e.target.value})})]}),(0,r.jsx)(I.Z,{type:"password",name:"password",placeholder:d("step5->passwordPlaceholder"),value:n.password,onChange:e=>o({...n,password:e.target.value}),required:!0,passwordVisibilityToggle:!0,"aria-label":d("step5->passwordPlaceholder"),minLength:6,maxLength:30,customValidator:e=>e.length>=6&&!(0,O.Z)(e)?(0,r.jsxs)("div",{children:[d("createAccount:step2->error->passwordFormatTitle"),(0,r.jsxs)(k.My,{children:[(0,r.jsx)(C.Z,{i18nKey:"createAccount:step2->error->passwordFormatError",components:[(0,r.jsx)("li",{},1),(0,r.jsx)("li",{},2),(0,r.jsx)("li",{},3)]}),d("createAccount:step2->error->passwordFormatCharacters",{interpolation:{escapeValue:!1}})]})]}):""}),(0,r.jsx)(I.Z,{type:"password",name:"repeatPassword",placeholder:d("step5->repeatPasswordPlaceholder"),value:n.repeatPassword,onChange:e=>o({...n,repeatPassword:e.target.value}),required:!0,passwordVisibilityToggle:!0,"aria-label":d("step5->repeatPasswordPlaceholder"),customValidity:u,maxLength:30}),(0,r.jsx)(A,{checked:n.rememberMe,onChange:e=>o({...n,rememberMe:!n.rememberMe}),id:"lostpassword-remember-me",children:d("step5->rememberMe")})]}),6===s&&(0,r.jsx)(E,{gap:28,alignment:"center",children:(0,r.jsx)(b.Z,{type:"body",children:d("step6->infoText")})}),c&&7===s&&(0,r.jsx)(E,{gap:28,alignment:"center",children:(0,r.jsx)(b.Z,{type:"body",children:c})}),c&&7!==s&&(0,r.jsx)(S.Z,{name:"error-message",children:c})]})})},B=n(61961);let D=e=>(0,B.ZP)({event:"Track",category:"lost_password_modal".concat("b2b"===e?"_b2b":""),action:"b2c"===e?"filled_in_social_security_number":"filled_in_customer_number",label:"",value:0}),L=(e,t)=>(0,B.ZP)({event:"Track",category:"lost_password_modal".concat("b2b"===e?"_b2b":""),action:"recovery_method_".concat(t),label:"",value:0}),N=e=>(0,B.ZP)({event:"Track",category:"lost_password_modal".concat("b2b"===e?"_b2b":""),action:"verified_email_address",label:"",value:0}),q=e=>(0,B.ZP)({event:"Track",category:"lost_password_modal".concat("b2b"===e?"_b2b":""),action:"verified_phone_number",label:"",value:0}),G=e=>(0,B.ZP)({event:"Track",category:"lost_password_modal".concat("b2b"===e?"_b2b":""),action:"verified_sms_code",label:"",value:0}),U=(e,t)=>(0,B.ZP)({event:"Track",category:"lost_password_modal".concat("b2b"===e?"_b2b":""),action:"created_new_password",label:"keep_me_logged_in_".concat(t?"activated":"deactivated"),value:0}),z=(e,t)=>(0,B.ZP)({event:"Track",category:"lost_password_modal".concat("b2b"===e?"_b2b":""),action:"error_message_shown",label:t,value:0});var W=n(54735),H=n(36132);let $=R.ZP.div.withConfig({componentId:"sc-d31ab9e2-0"})(["display:flex;flex-direction:column;height:100%;","{padding:0 ",";flex:1 1 auto;height:auto;}",""],u.Z.MEDIA.FROM_TABLET_PORTRAIT,(0,T.hO)(24),e=>e.gap&&(0,R.iv)(["gap:",";"],(0,T.hO)(e.gap))),V=(0,R.ZP)(W.Z).withConfig({componentId:"sc-d31ab9e2-1"})(["width:100%;"]),K=(0,R.ZP)(H.Z).withConfig({componentId:"sc-d31ab9e2-2"})(["display:flex;flex-direction:column;text-align:left;margin-top:",";justify-content:space-between;height:100%;flex:1;","{gap:",";}"],(0,T.hO)(10),u.Z.MEDIA.FROM_TABLET_PORTRAIT,(0,T.hO)(40)),Y=R.ZP.div.withConfig({componentId:"sc-d31ab9e2-3"})(["margin-top:auto;display:flex;flex-direction:column;gap:",";","{margin-top:",";}"],(0,T.hO)(10),u.Z.MEDIA.FROM_TABLET_PORTRAIT,(0,T.hO)(4)),X={b2b:"",b2c:"",email:"",phone:"",verifyField:"",passwordRecoveryMethod:"email",smsCode:"",password:"",repeatPassword:"",rememberMe:!0,encryptedToken:"",uid:""};var Q=e=>{let{onCloseHandler:t,tab:o}=e,{t:s}=(0,i.Z)("lostPassword"),l=(0,d.Z)(),[u,h]=(0,a.useState)(!1),[Z,_]=(0,a.useState)(o||"b2c"),[v,C]=(0,a.useState)(X),[j,I]=(0,a.useState)(""),[S,O]=(0,a.useState)(!1),[k,R]=(0,a.useState)({currentStep:1,totalSteps:4}),{customer:T,refreshCustomer:P}=(0,c.Z)(),E=(e,t)=>{if(x.Z.error({error:"Lost password error, step: ".concat(t)}),e.hasOwnProperty("error")){let t=s("error->".concat(e.error[Object.keys(e.error)[0]]||"register.error.default"));z(Z,t),I(t)}},A=(e,t)=>{let{customerFound:n,customerHasMembership:r,phone:a,email:i,customerNeedContactSupport:o}=e;n&&(a||i)?(C({...v,[Z]:t,email:i,phone:a,passwordRecoveryMethod:i?"email":"phone"}),D(Z),R({...k,currentStep:2})):r||o?I(s("step1->error->noEmailPhone")):"b2c"===Z?O(!0):I(s("b2bNoAccountError")),h(!1)},M=async e=>{A((await (0,y.jO)(e)).data,e)},B=async e=>{let t=await (0,w.Z)(e);A((await (0,y.Lu)({socialSecurityNumber:t.str,socialSecurityNumberKey:t.key})).data,e)},H=async e=>{try{"b2b"===Z?await M(e):await B(e)}catch(e){e instanceof Response&&E(e,1),h(!1)}},Q=()=>{h(!1),L(Z,v.passwordRecoveryMethod),R({...k,currentStep:3})},J=async()=>{let{verifyAccountWithEmail:e,verifyAccountWithPhone:t}=await Promise.resolve().then(n.bind(n,54693)),r=await (0,w.Z)(v[Z]),{passwordRecoveryMethod:a,verifyField:i}=v,o={userNameCipherKey:r.key,encryptedUserName:r.str};try{if("email"===a)await e({...o,email:i}),N(Z),R({...k,currentStep:4});else{let{status:e,encryptedToken:n,uid:r}=(await t({...o,phone:i})).data;r&&n&&e?(C({...v,encryptedToken:n,uid:r}),q(Z),R({...k,currentStep:5})):I(s("error->register.phone.noMatch"))}}catch(e){e instanceof Response&&E(e,3)}h(!1)},ee=()=>{h(!1),t()},et=async()=>{let e=await (0,w.Z)(v.password),t=await (0,w.Z)(v.repeatPassword);try{if(v.smsCode){let{status:t}=(await (0,y.DS)({encryptedToken:v.encryptedToken,uid:v.uid,pwd:e.str,pwdKey:e.key,token:v.smsCode,rememberMe:v.rememberMe})).data;t?(await P(),G(Z),U(Z,v.rememberMe),R({...k,currentStep:6})):I(s("error->updatePwd.smsToken.invalid"))}else{var n;let r=null==l?void 0:null===(n=l.query)||void 0===n?void 0:n.token;await (0,y.Cp)(r,e.str,t.str,v.rememberMe,e.key,t.key),await P(),U((null==T?void 0:T.isB2BCustomer)?"b2b":"b2c",v.rememberMe),R({...k,currentStep:6})}}catch(e){e instanceof Response&&E(e,5)}h(!1)},en=()=>{h(!1),t()},er=()=>{h(!1),R({...k,currentStep:1}),l.replace({pathname:l.pathname,query:l.query},m.Z.LOST_PASSWORD,{shallow:!0})},ea=async e=>{h(!0);try{await (0,y.hY)(e),R({...k,currentStep:5})}catch(e){e instanceof Response&&(E(e,4),R({...k,currentStep:7}))}h(!1)},ei=async e=>{switch(e.preventDefault(),h(!0),I(""),k.currentStep){case 1:await H(v[Z]);break;case 2:await Q();break;case 3:await J();break;case 4:await ee();break;case 5:await et();break;case 6:await en();break;case 7:await er()}};return(0,a.useEffect)(()=>{if(l.isReady){var e,t;let n=l.asPath.split("?")[0];n.startsWith(m.Z.RESET_PASSWORD)||n.startsWith(m.Z.RESET_PASSWORD_B2B)?(null==l?void 0:null===(t=l.query)||void 0===t?void 0:t.token)?ea(l.query.token):l.replace({pathname:l.pathname,query:l.query},n.startsWith(m.Z.RESET_PASSWORD)?m.Z.LOST_PASSWORD:m.Z.LOST_PASSWORD_B2B,{shallow:!0}):(null===(e=l.query)||void 0===e?void 0:e.username)?(C({...v,[Z]:l.query.username}),h(!0),H(l.query.username)):n.startsWith(m.Z.LOST_PASSWORD_B2B)&&_("b2b")}},[l.isReady]),(0,a.useEffect)(()=>{I("")},[v,Z]),(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(g.Z,{size:"medium",hasCloseIcon:!0,onClose:t,internalNavigation:k,navigationCallback:e=>{I(""),e<1?l.replace({pathname:l.pathname,query:{...l.query,tab:Z}},{pathname:m.Z.USER_LOGIN}):R({...k,currentStep:e})},hasMinHeight:!0,children:(0,r.jsxs)($,{gap:20,children:[(0,r.jsx)(p.Z,{variant:"h2",size:"small",children:s("step".concat(k.currentStep,"->").concat(v.passwordRecoveryMethod,"->heading"))}),"b2b"===Z&&k.currentStep<=3&&(0,r.jsx)(b.Z,{type:"subtitle",size:"small",children:s("b2bSubHeading")}),(0,r.jsxs)(K,{onSubmit:ei,children:[(0,r.jsx)(F,{isSubmitting:u,formValues:v,setFormValues:C,mode:Z,step:k.currentStep,errorMsg:j}),(0,r.jsx)(V,{type:"submit",isSubmitting:u,children:s("step".concat(k.currentStep,"->").concat(v.passwordRecoveryMethod,"->submitButton"))})]}),(0,r.jsxs)(Y,{children:[1===k.currentStep&&(0,r.jsxs)(b.Z,{type:"body",size:"small",children:["".concat("b2c"===Z?s("b2bCustomer"):s("b2cCustomer"))," ",(0,r.jsx)(f.Z,{onClick:()=>_("b2c"===Z?"b2b":"b2c"),href:"b2c"===Z?m.Z.LOST_PASSWORD_B2B:m.Z.LOST_PASSWORD,children:s("resetPassword")})]}),(0,r.jsxs)(b.Z,{type:"body",size:"small",children:[s("infoTextHelp")," ",(0,r.jsx)(f.Z,{href:m.Z.external.ECOMMERCE_CONTACT,children:s("infoTextContact")})]})]})]})}),S&&(0,r.jsx)(g.Z,{size:"small",onClose:()=>O(!1),children:(0,r.jsxs)($,{gap:20,children:[(0,r.jsx)(p.Z,{variant:"h2",size:"small",children:s("modal->title")}),(0,r.jsx)(b.Z,{type:"body",children:s("modal->text")}),(0,r.jsx)(W.Z,{theme:"secondary",onClick:()=>O(!1),children:s("modal->cancelButton")}),(0,r.jsx)(W.Z,{theme:"primary",onClick:()=>{l.replace({pathname:m.Z.REGISTER_B2C_IDENTIFY})},children:s("modal->createAccountButton")})]})})]})};let J=()=>(0,B.ZP)({event:"Track",category:"offers_page_login_modal",action:"modal_shown",label:"",value:0}),ee=()=>(0,B.ZP)({event:"Track",category:"offers_page_login_modal",action:"modal_closed",label:"",value:0}),et=e=>(0,B.ZP)({event:"Track",category:"offers_page_login_modal",action:e,label:"",value:0});var en=n(74602),er=n(35073);let ea=R.ZP.div.withConfig({componentId:"sc-55eb9493-0"})(["position:absolute;width:",";padding:",";border-top:"," solid ",";box-shadow:0 "," "," "," ",";background-color:",";top:",";right:",";z-index:100;max-width:",";&::before,&::after{bottom:100%;right:",";border:solid transparent;content:'';height:0;width:0;position:absolute;pointer-events:none;","{right:",";}}&::before{border-bottom-color:",";border-width:",";margin-right:",";}&::after{border-bottom-color:",";border-width:",";margin-right:",";}"],(0,T.hO)(320),(0,T.hO)(24),(0,T.hO)(1),er.Z.colors.lightGray,(0,T.hO)(8),(0,T.hO)(28),(0,T.hO)(0),(0,T.m4)(er.Z.colors.black,.5),er.Z.colors.white,(0,T.hO)(er.Z.size.toolbarHeight+11),(0,T.hO)(10),(0,T.hO)(300),(0,T.hO)(105),u.Z.MEDIA.FROM_TABLET_LANDSCAPE,(0,T.hO)(45),er.Z.colors.lightGray,(0,T.hO)(11),(0,T.hO)(-11),er.Z.colors.white,(0,T.hO)(10),(0,T.hO)(-10)),ei=R.ZP.div.withConfig({componentId:"sc-55eb9493-1"})(["position:relative;display:flex;flex-direction:column;justify-content:space-around;"]),eo=(0,R.ZP)(b.Z).withConfig({componentId:"sc-55eb9493-2"})(["margin-bottom:",";"],(0,T.hO)(5)),es=R.ZP.div.withConfig({componentId:"sc-55eb9493-3"})(["margin-top:",";display:flex;justify-content:space-between;gap:",";"],(0,T.hO)(10),(0,T.hO)(20)),el=(0,R.ZP)(W.Z).withConfig({componentId:"sc-55eb9493-4"})(["flex-grow:1;flex-basis:0;"]),ec=(0,R.ZP)(l.Z).withConfig({componentId:"sc-55eb9493-5"})(["position:absolute;cursor:pointer;top:",";right:",";"],(0,T.hO)(-4),(0,T.hO)(-4));var ed=n(14095),eu=e=>{let{onClickLogin:t,onClickRegister:n,onClickClose:o}=e;(0,a.useEffect)(()=>{J()},[]);let s=()=>{ee(),o()},{t:l}=(0,i.Z)("loginHint");return(0,r.jsx)(en.Z,{clickHandler:s,children:(0,r.jsx)(ea,{children:(0,r.jsxs)(ei,{children:[(0,r.jsx)(eo,{type:"label",children:l("loginHint->title")}),(0,r.jsx)(b.Z,{type:"body",size:"small",children:l("loginHint->desc")}),(0,r.jsxs)(es,{children:[(0,r.jsx)(el,{size:"small",type:"button",theme:"secondary",onClick:()=>{et("continued_to_create_account"),n()},children:l("loginHint->createAccount")}),(0,r.jsx)(el,{size:"small",type:"button",theme:"primary",onClick:()=>{et("continued_to_login"),t()},children:l("loginHint->loginIn")})]}),(0,r.jsx)(ec,{svg:ed.Z,size:12,onClick:s})]})})})},eh=n(56493);let em=R.ZP.a.withConfig({componentId:"sc-bb3fccd4-0"})(["display:flex;align-items:center;cursor:pointer;padding:0 ",";> *{height:100%;align-items:center;display:flex;}",""],(0,T.hO)(20),e=>e.isLastElement&&(0,R.iv)(["border-left:"," solid ",";","{margin-right:",";}"],(0,T.hO)(1),er.Z.colors.lightGray,u.Z.MEDIA.FROM_DESKTOP,(0,T.hO)(-20))),ep=R.ZP.span.withConfig({componentId:"sc-bb3fccd4-1"})(["font-family:",";font-size:",";margin-left:",";color:",";"],er.Z.fonts.fontGothamMedium,(0,T.hO)(13),(0,T.hO)(10),er.Z.colors.lighterBlack);var eg=n(16478),eb=n(45014),ef=n.n(eb);let ey=R.ZP.div.withConfig({componentId:"sc-a2381deb-0"})(["display:flex;flex-direction:column;height:100%;","{padding:0 ",";flex:1 1 auto;height:auto;}"],u.Z.MEDIA.FROM_TABLET_PORTRAIT,(0,T.hO)(24)),ew=R.ZP.div.withConfig({componentId:"sc-a2381deb-1"})(["margin-top:",";flex-grow:1;display:flex;flex-direction:column;"],(0,T.hO)(15)),ex=(0,R.ZP)(H.Z).withConfig({componentId:"sc-a2381deb-2"})(["flex-grow:1;display:flex;"]),eZ=R.ZP.div.withConfig({componentId:"sc-a2381deb-3"})(["font-size:",";display:flex;flex-direction:column;margin-top:",";"],(0,T.hO)(13),(0,T.hO)(16)),e_=R.ZP.li.withConfig({componentId:"sc-a2381deb-4"})(["margin-top:",";"],(0,T.hO)(8)),ev=(0,R.ZP)(ef()).withConfig({componentId:"sc-a2381deb-5"})(["font-size:",";"],(0,T.hO)(13)),eC=(0,R.ZP)(b.Z).withConfig({componentId:"sc-a2381deb-6"})(["margin-bottom:",";padding-top:",";"],(0,T.hO)(11),(0,T.hO)(7));var ej=n(59541),eI=n(70493),eS=n(60167),eO=(e,t)=>s.default.post("/login",e,{cancelToken:t,headers:{"Content-Type":"application/json"}}),ek=n(67340),eR=n(88555),eT=n(42197),eP=n(97563),eE=n(47228),eA=n(68275),eM=n(89606),eF=e=>{let{onClose:t,tab:n}=e,{t:r}=(0,i.Z)("login"),{customer:o,refreshCustomer:l}=(0,c.Z)(),{cart:h,isCartEmpty:p,refreshCart:g}=(0,eA.Z)(),b=(0,eR.T)(),f=(0,d.Z)(),{trigger:y}=(0,eT.Z)(),[,Z]=(0,eM.Z)(u.Z.LOCAL_STORAGE_SELECTORS.bankIdTabLastSelected,!1),[_,C]=(0,a.useState)(n||((null==o?void 0:o.isB2BCustomer)?"b2b":"b2c")),j=(0,a.useMemo)(()=>"bankId"===_?"b2c":_,[_]),[I,S]=(0,a.useState)(!1),[O,k]=(0,a.useState)({b2b:"",b2c:""}),[R,T]=(0,a.useState)({b2b:{j_username:(null==o?void 0:o.sapId)?null==o?void 0:o.sapId:"b2b"===_?f.query.username:"",j_username_key:"",j_password:"",j_password_key:""},b2c:{j_username:(null==o?void 0:o.socialSecurityNumer)?null==o?void 0:o.socialSecurityNumer:"b2c"===_?f.query.username:"",j_username_key:"",j_password:"",j_password_key:""},j_remember_me:!0}),P=async()=>{let e={...R[j],j_remember_me:R.j_remember_me},t=await (0,w.Z)(e.j_username),n=await (0,w.Z)(e.j_password);return e.j_password=n.str,e.j_password_key=n.key,e.j_username=t.str,e.j_username_key=t.key,e},E=e=>{k({...O,[_]:e.data.message}),(0,ek.w_)(r(e.data.message)),S(!1)},A=async()=>{S(!1);let e=await l();e&&(0,ek.Ye)(e,!1),(0,ek.jn)("bankId"===_?"BankID":"password",R.j_remember_me),await l();let n=await y();if(p&&(null==h?void 0:h.slot)===null){let e=await (0,eP.gb)(n?eE.Z.KEEP_PERSISTENT:eE.Z.KEEP_SESSION);await g(e.data)}t(!0)};return{isSubmitting:I,activeTab:_,activeTabWithoutBankId:j,formValues:R,globalErrorMessage:O,handleInputChange:e=>{let{name:t,value:n}=e.target;T({...R,[_]:{...R[j],[t]:n}})},handleBlur:()=>{T({...R,[_]:{...R[j],j_username:(0,v.Z)(R[j].j_username)}})},onTabChange:(e,t)=>{(0,ek.z$)(e,t),C(e),f.replace({pathname:f.pathname,query:{...f.query,tab:e}},{pathname:"b2b"===e?m.Z.B2B_LOGIN:m.Z.USER_LOGIN},{shallow:!0}),k({b2b:"",b2c:""}),Z("bankId"===e)},onSubmitHandler:async e=>{e.preventDefault(),S(!0);let t=await P(),n=s.default.CancelToken.source();try{b((0,eS.Bd)(!0));let e=await eO(t,n.token);"true"===e.data.login_successful?await A():E(e)}catch(e){x.Z.error({error:"Login failed",message:e.message})}finally{b((0,eS.Bd)(!1))}},handleCheckboxChange:e=>{T({...R,j_remember_me:e})},onLoginSuccess:A}};let eB=R.ZP.div.withConfig({componentId:"sc-99371ff8-0"})(["text-align:left;display:flex;flex-direction:column;align-items:flex-start;margin-top:",";flex-grow:1;"],(0,T.hO)(12)),eD=R.ZP.div.withConfig({componentId:"sc-99371ff8-1"})(["width:100%;margin-bottom:",";"],(0,T.hO)(18)),eL=R.ZP.div.withConfig({componentId:"sc-99371ff8-2"})(["margin-bottom:",";line-height:",";"],(0,T.hO)(15),(0,T.hO)(11)),eN=R.ZP.div.withConfig({componentId:"sc-99371ff8-3"})(["color:",";font-size:",";"],er.Z.colors.primaryDark,(0,T.hO)(11)),eq=R.ZP.div.withConfig({componentId:"sc-99371ff8-4"})(["display:flex;justify-content:space-between;white-space:nowrap;","{margin-bottom:",";}"],u.Z.MEDIA.FROM_TABLET_PORTRAIT,(0,T.hO)(48)),eG=R.ZP.div.withConfig({componentId:"sc-99371ff8-5"})(["flex-direction:column;display:flex;width:100%;justify-content:space-between;flex-grow:1;button{margin:0 0 ",";width:100%;&:last-child{margin:0 0 0;}}","{margin:0;button{margin:0 "," "," 0;&:last-child{margin:0;}}}"],(0,T.hO)(10),u.Z.MEDIA.FROM_TABLET_PORTRAIT,(0,T.hO)(10),(0,T.hO)(10)),eU=(0,R.ZP)(P.Z).withConfig({componentId:"sc-99371ff8-6"})(["display:flex;width:100%;"]);var ez=e=>{let{activeTab:t,formValues:n,globalErrorMessage:a,handleInputChange:o,handleBlur:s,currentLoginMethod:l,isLoginConfirm:c,handleCheckboxChange:u,onClose:h,isSubmitting:p}=e,{t:g}=(0,i.Z)("login"),y=(0,d.Z)(),w="b2b"===t?g("login->inputs->company->placeholder"):g("login->inputs->ssn->placeholder"),x="b2b"===t?g("login->inputs->company->tooltip"):g("login->inputs->ssn->tooltip"),v="b2b"===t?n.b2b.j_password:n.b2c.j_password,C="b2b"===t?n.b2b.j_username:n.b2c.j_username;return(0,r.jsxs)(eB,{children:[a.b2c&&(0,r.jsx)(eL,{"data-testid":"backend-error",children:(0,r.jsx)(eN,{children:g(a.b2c)})}),a.b2b&&(0,r.jsx)(eL,{"data-testid":"backend-error",children:(0,r.jsx)(eN,{children:g(a.b2b)})}),(0,r.jsx)(eD,{children:(0,r.jsx)(Z.Z,{tooltipAlign:"right",inputName:"j_username",inputAriaLabel:w,inputValue:C,inputType:"text","inputaria-label":w,inputMaxLength:"b2b"===t?6:void 0,inputOnChange:o,inputOnBlur:s,iconProps:{svg:M.Z,size:16},placeholder:w,tooltipContent:(0,r.jsx)(r.Fragment,{children:x}),pattern:"[0-9]*",customValidator:e=>_.t[l].test(e)?"":g("login->error->".concat(l)),required:!0,testId:"login-input-username-".concat(l)})}),(0,r.jsx)(eD,{children:(0,r.jsx)(I.Z,{name:"j_password",value:v,type:"password",onChange:o,"aria-label":g("login->inputs->password->placeholder"),placeholder:g("login->inputs->password->placeholder"),autoComplete:c?"one-time-code":void 0,required:!0,testId:"login-input-password-".concat(l),passwordVisibilityToggle:!0})}),(0,r.jsxs)(eG,{children:[!c&&(0,r.jsxs)(eq,{children:[(0,r.jsx)(eU,{id:"login-remember-me",checked:n.j_remember_me,onChange:u,children:g("login->rememberMe")}),(0,r.jsx)(b.Z,{type:"body",size:"small",children:(0,r.jsx)(f.Z,{variant:"primary",href:{pathname:y.pathname,query:{...y.query,username:n[t].j_username,tab:t}},asProp:"b2c"===t?m.Z.LOST_PASSWORD:m.Z.LOST_PASSWORD_B2B,internal:!0,children:g("login->links->resetPassword")})})]}),c&&(0,r.jsx)(W.Z,{theme:"secondary",onClick:()=>h(),children:g("common:button->cancel")}),(0,r.jsx)(W.Z,{type:"submit",isSubmitting:p,"data-testid":"login-button-submit",children:g("login->submit")})]})]})},eW=n(63359);let eH=(0,a.createContext)({currentStatus:eW.HT,hintCode:eW.i_,qrData:"",bankIdDevice:eW.LC,rememberMe:!1,setCurrentStatus:()=>{},setHintCode:()=>{},setQrData:()=>{},setBankIdDevice:()=>{},setRememberMe:()=>{}}),e$=e=>{let{children:t}=e,[n,i]=(0,a.useState)(eW.HT),[o,s]=(0,a.useState)(eW.i_),[l,c]=(0,a.useState)(""),[d,u]=(0,a.useState)(eW.LC),[h,m]=(0,a.useState)(!1),p=(0,a.useMemo)(()=>({currentStatus:n,setCurrentStatus:i,hintCode:o,setHintCode:s,qrData:l,setQrData:c,bankIdDevice:d,setBankIdDevice:u,rememberMe:h,setRememberMe:m}),[n,o,l,d,h]);return(0,r.jsx)(eH.Provider,{value:p,children:t})},eV=()=>(0,a.useContext)(eH),eK=R.ZP.div.withConfig({componentId:"sc-efc141dd-0"})(["flex-grow:1;display:flex;","{flex-basis:",";}"],u.Z.MEDIA.FROM_TABLET_PORTRAIT,(0,T.hO)(160)),eY=(0,R.ZP)(P.Z).withConfig({componentId:"sc-efc141dd-1"})(["display:flex;width:100%;justify-content:center;margin-bottom:",";margin-top:",";"],(0,T.hO)(4),(0,T.hO)(20)),eX=R.ZP.div.withConfig({componentId:"sc-efc141dd-2"})(["display:flex;flex-direction:column;align-items:center;flex-grow:1;"]),eQ=(0,R.ZP)(W.Z).withConfig({componentId:"sc-efc141dd-3"})(["width:100%;margin-top:",";"],(0,T.hO)(16));var eJ=n(32284),e0=n.n(eJ),e1=e=>{let{handleDeviceClick:t,rememberMe:n,handleCheckBoxChange:o}=e,{t:s}=(0,i.Z)("login"),{isMobile:l}=(0,eg.Z)(),{rememberMe:c,setRememberMe:d}=eV();return(0,a.useEffect)(()=>{d(n)},[n,d]),(0,r.jsxs)(eX,{children:[(0,r.jsx)(eK,{children:(0,r.jsx)(e0(),{unoptimized:!0,src:"/icons/logos/BankID.svg",alt:"BankID",width:90,height:86,style:{height:"auto"}})}),(0,r.jsx)(eY,{id:"bankid-login-remember-me",checked:c,onChange:()=>{d(!c),o(!c)},children:s("login->rememberMe")}),l?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(eQ,{onClick:()=>t(c,eW.Wk),children:s("login->bankId->startBankIdSameDeviceText")}),(0,r.jsx)(eQ,{theme:"secondary",onClick:()=>t(c,eW.XV),children:s("login->bankId->bankIdOnOtherDeviceText")})]}):(0,r.jsx)(eQ,{onClick:()=>t(c,eW.XV),children:s("login->bankId->startDesktopFlowButtonText")})]})},e2=n(51433),e3=n(14976),e4=n(62527),e6=n(6842),e5=e=>{let{onLoginSuccess:t,onCustomerNotFound:n}=e,[r,i]=(0,a.useState)(!1),o=(0,a.useRef)(null),s=(0,a.useRef)(null),l=(0,a.useRef)(""),c=(0,a.useRef)(!1),d=(0,a.useRef)(!1),u=(0,a.useRef)(0),h=(0,a.useRef)(0),{setCurrentStatus:m,setHintCode:p,setQrData:g,rememberMe:b}=eV(),f=()=>{s.current&&(clearInterval(s.current),s.current=null)},y=()=>{d.current=!1,o.current&&(clearInterval(o.current),o.current=null),f()};(0,a.useEffect)(()=>()=>y(),[]);let w=()=>!!u.current&&u.current>0&&u.current<=4,Z=()=>{y(),l.current&&!c.current&&(o.current=setInterval(async()=>{d.current||await C(l.current)},2e3))},_=e=>{var t,n;y(),l.current="",u.current=0,h.current=0;let r=(0,e2.IZ)(e)&&(null===(n=e.response)||void 0===n?void 0:null===(t=n.data)||void 0===t?void 0:t.errorStatus);r&&(0,e3.j)(r)?m(r):m(eW.i_),i(!0)},v=e=>{let{status:r,hintCode:a,ssn:i}=e;r===eW.ig?y():r===eW.ly?(l.current="",y(),m(eW.ly),t()):r===eW.qX?(y(),n(i||"")):a===eW.H3&&s.current&&f(),r&&a&&(m((0,e3.j)(r)?r:eW.i_),p((0,e3.$)(a)?a:eW.i_))},C=async e=>{try{d.current=!0;let{status:t,hintCode:n,ssn:r}=(await (0,e4.q)(e,b)).data;if(!c.current){if(t===eW.ig&&n===eW.sM&&w()){y(),I({mobile:!0,sameDevice:!1});return}v({status:t,hintCode:n,ssn:r})}}catch(r){var t,n;let e=(0,e2.IZ)(r)&&(null===(n=r.response)||void 0===n?void 0:null===(t=n.data)||void 0===t?void 0:t.errorStatus);if(!e&&!(0,e3.j)(e)&&h.current>0){h.current-=1,Z();return}_(r)}finally{d.current=!1}},j=async()=>{try{let e=await (0,e4.eN)({validateStatus:e=>e>=200&&e<300||410===e});e.data&&g(e.data)}catch(e){_(e)}},I=async e=>{let{mobile:t,sameDevice:n,isIos:r=!1}=e;c.current=!1;try{m(eW.hA),p(eW.XC);let e=!n,{orderRef:a,autoStartToken:i}=(await (0,e4.GF)({mobile:t,generateQrData:e})).data;if(n&&i){if(h.current=r?5:0,r){let e=e6.Z.isSafariBrowser()?"".concat(window.location.href,"#bankid"):window.location.origin;window.location.href="https://app.bankid.com/?autostarttoken=".concat(i,"&redirect=").concat(e)}else window.location.href="bankid:///?autostarttoken=".concat(i,"&redirect=null")}a&&!c.current&&(l.current=a,o.current=setInterval(async()=>{d.current||await C(a)},2e3)),e&&!c.current&&(u.current+=1,s.current=setInterval(async()=>{await j()},1e3),await j())}catch(e){_(e)}},S=async()=>{try{await (0,e4._d)(l.current),l.current=""}catch(t){if((0,e2.IZ)(t)){var e;x.Z.error({error:"Failed BankId cancel",message:t.message,responseData:null===(e=t.response)||void 0===e?void 0:e.data})}}};return{isCollectingLogin:!!o.current,startBankIdAuth:I,handleRetry:()=>{i(!1),l.current="",u.current=0,h.current=0,m(eW.HT),p(eW.XC),g("")},handleCancel:e=>{c.current=!0,d.current=!1,l.current&&!e?S():l.current="",u.current=0,h.current=0,i(!1),y(),m(eW.HT),p(eW.XC),g("")},hasError:r}},e9=n(77068),e8=n(40949);let e7=R.ZP.div.withConfig({componentId:"sc-a16e9b72-0"})(["display:flex;flex-direction:column;align-items:center;justify-content:center;height:100%;padding:",";"],(0,T.hO)(16)),te=R.ZP.div.withConfig({componentId:"sc-a81f342-0"})(["display:flex;flex-direction:column;gap:",";"],(0,T.hO)(24)),tt=R.ZP.div.withConfig({componentId:"sc-a81f342-1"})(["display:flex;flex-direction:column;gap:",";","{flex-direction:row;gap:",";& > *{flex:1;}}"],(0,T.hO)(16),u.Z.MEDIA.FROM_TABLET_PORTRAIT,(0,T.hO)(20));var tn=n(12156),tr=e=>{let{ssn:t,handleCancel:n}=e,o=(0,d.Z)(),{t:s}=(0,i.Z)("login"),l=(0,a.useMemo)(()=>18>new tn.Z(t).getAge(),[t]);return(0,r.jsx)(g.Z,{size:"small",hasCloseIcon:!1,children:(0,r.jsxs)(te,{children:[(0,r.jsx)(p.Z,{variant:"h3",children:s("login->bankId->noCustomerFound->heading")}),(0,r.jsx)(b.Z,{type:"body",children:s(l?"login->bankId->noCustomerFound->bodyUnder18":"login->bankId->noCustomerFound->body")}),l?(0,r.jsx)(W.Z,{theme:"primary",onClick:n,children:s("login->bankId->noCustomerFound->okBtn")}):(0,r.jsxs)(tt,{children:[(0,r.jsx)(W.Z,{theme:"primary",onClick:()=>{(async()=>{o.push({pathname:m.Z.REGISTER_PRIVATE_CREATE,query:{...o.query,ssn:t}},{pathname:m.Z.REGISTER_PRIVATE_CREATE})})()},children:s("login->bankId->noCustomerFound->createAccountBtn")}),(0,r.jsx)(W.Z,{theme:"secondary",onClick:n,children:s("login->bankId->noCustomerFound->cancelBtn")})]})]})})},ta=e=>{let{selectedDevice:t,closeModal:n,onLoginSuccess:i}=e,[o,s]=(0,a.useState)(""),{hintCode:l,currentStatus:c,bankIdDevice:d,setBankIdDevice:u,qrData:h}=eV(),{isCollectingLogin:m,startBankIdAuth:p,handleCancel:b,hasError:f}=e5({onLoginSuccess:i,onCustomerNotFound:e=>s(e)}),{belowDesktop:y,isClient:w}=(0,eg.Z)(),x=d===eW.XV,Z=x&&l!==eW.XC,_=d===eW.Wk&&c!==eW.HT,v=f||c===eW.ig||c===eW.i_||c===eW.qX,C=c===eW.ly,j=(Z||_)&&!v&&!C,I=e=>{x&&u(eW.LC),b(l===eW.Sj),n(!0===e)};return(0,a.useEffect)(()=>(u(t),t===eW.Wk&&w&&p({mobile:y,sameDevice:!0,isIos:e6.Z.isIOS()}),()=>{m&&I()}),[w]),(0,r.jsx)(g.Z,{size:"medium",onClose:()=>I(!0),hasCloseIcon:!0,children:(0,r.jsxs)(e7,{children:[(0,r.jsx)(e0(),{unoptimized:!0,src:"/icons/logos/BankID.svg",alt:"BankID",width:90,height:86,style:{height:"auto"}}),d===eW.XV&&!C&&(0,r.jsx)(e9.Z,{startBankIdFlow:p,handleCancel:I,showPending:j,showError:v,qrData:h}),d&&j&&(0,r.jsx)(e8.bb,{handleCancel:I,hintCode:l,isSameDevice:d===eW.Wk}),d&&C&&(0,r.jsx)(e8.$R,{}),v&&(0,r.jsx)(e8.Tq,{handleReturnClick:()=>I(!1),hintCode:l,isQr:x}),o&&(0,r.jsx)(tr,{ssn:o,handleCancel:()=>n()})]})})},ti=e=>{let{closeParentModal:t,onLoginSuccess:n,rememberMe:i,handleCheckBoxChange:o}=e,[s,l]=(0,a.useState)(!1),[c,d]=(0,a.useState)(eW.LC);return(0,r.jsx)(r.Fragment,{children:(0,r.jsxs)(e$,{children:[!s&&(0,r.jsx)(e1,{handleDeviceClick:(e,t)=>{l(!0),d(t),(0,ek.aY)(t)},rememberMe:i,handleCheckBoxChange:o}),s&&c!=eW.LC&&(0,r.jsx)(ta,{closeModal:e=>{l(!1),d(eW.LC),e&&t()},selectedDevice:c,onLoginSuccess:n})]})})};let to=e=>"bankId"===e?"b2c":e;var ts=e=>{var t,n;let{onClose:o,from:s,isLoginConfirm:l,isCheckout:h,tab:y}=e,w=(0,d.Z)(),{t:x}=(0,i.Z)("login"),Z=(0,a.useMemo)(()=>to(y)||"b2c",[y]),{customer:_}=(0,c.Z)(),{isSubmitting:v,activeTab:C,activeTabWithoutBankId:j,formValues:I,globalErrorMessage:S,handleInputChange:O,onTabChange:k,handleBlur:R,onSubmitHandler:T,handleCheckboxChange:P,onLoginSuccess:E}=eF({onClose:o,tab:Z}),[A]=(0,eM.Z)(u.Z.LOCAL_STORAGE_SELECTORS.bankIdTabLastSelected,!1),M=()=>w.asPath.split("?")[0];(0,a.useEffect)(()=>{"bankId"===w.query.tab||A?k("bankId",!0):(M()===m.Z.B2B_LOGIN||l&&(null==_?void 0:_.isB2BCustomer))&&k("b2b",!0)},[]);let F={b2c:m.Z.REGISTER_B2C_IDENTIFY,b2b:m.Z.REGISTER_B2B_IDENTIFY};(0,a.useEffect)(()=>{l&&(0,ek.yK)((null==_?void 0:_.isB2BCustomer)||!1,h)},[l,null==_?void 0:_.isB2BCustomer,h]);let B=()=>"b2b"===C?(0,r.jsx)(ev,{href:m.Z.USER_LOGIN,onClick:e=>{e.preventDefault(),k("b2c")},children:x("login->links->b2cLogin")}):(0,r.jsx)(ev,{href:m.Z.B2B_LOGIN,onClick:e=>{e.preventDefault(),k("b2b")},children:x("login->links->b2bLogin")}),D=()=>(0,r.jsx)(ez,{isLoginConfirm:l,activeTab:j,formValues:I,globalErrorMessage:S,handleInputChange:O,handleBlur:R,currentLoginMethod:j,handleCheckboxChange:P,onClose:o,isSubmitting:v},C);return(0,r.jsx)(g.Z,{size:"medium",hasCloseIcon:!0,onClose:()=>o(),hasMinHeight:!0,children:(0,r.jsxs)(ey,{children:[(0,r.jsx)(p.Z,{variant:"h2",size:"small",children:"b2b"===C?x("login->headingB2B"):x("login->heading")}),(0,r.jsx)(ex,{onSubmit:T,children:(0,r.jsxs)(ew,{children:[l&&(0,r.jsx)(b.Z,{children:x("login->loginConfirmSubtitle")}),(()=>{let e="login->fromMessage->".concat(s);return s&&x(e)&&x(e)!==e?(0,r.jsx)(eC,{align:"center",type:"body","data-testid":"login-backend-message",children:x(e)}):null})(),l&&D(),!l&&("b2b"===C?D():(0,r.jsxs)(ej.Z,{activeTab:C,onTabChange:k,children:[(0,r.jsx)(eI.Z,{title:x("login->methodTabs->b2cPassword"),children:D()},"b2c"),(0,r.jsx)(eI.Z,{title:x("login->methodTabs->bankId"),children:(0,r.jsx)(ti,{closeParentModal:o,onLoginSuccess:E,handleCheckBoxChange:P,rememberMe:null==I?void 0:I.j_remember_me})},"bankId")]}))]})}),(0,r.jsx)(eZ,{"data-testid":"login-modal-footer",children:"CART_PAGE"===s?(0,r.jsxs)("ul",{children:[(0,r.jsx)(e_,{children:(0,r.jsx)(f.Z,{variant:"primary",href:m.Z.CHECKOUT,children:x("login->links->continueAsGuest")})}),(0,r.jsxs)(e_,{children:[(0,r.jsx)(B,{}),x("login->or"),(0,r.jsx)(f.Z,{variant:"primary",href:{pathname:F[Z],query:{username:null===(t=I[Z])||void 0===t?void 0:t.j_username,tab:Z}},asProp:F[Z],internal:!0,children:x("login->links->createAccount")})]})]}):(0,r.jsxs)("ul",{children:[(0,r.jsx)(e_,{children:(0,r.jsx)(f.Z,{variant:"primary",href:{pathname:F[Z],query:{username:null===(n=I[Z])||void 0===n?void 0:n.j_username,tab:Z}},asProp:F[Z],internal:!0,children:x("login->links->createAccount")})}),(0,r.jsx)(e_,{children:(0,r.jsx)(B,{})})]})})]})})},tl=n(88568);let tc=e=>{let{openModal:t}=e,n=(0,d.Z)(),[i,s]=(0,a.useState)(!1),l=(0,o.useMediaQuery)({query:u.Z.BREAKPOINTS.IS_MOBILE});(0,a.useEffect)(()=>{n.asPath.indexOf(m.Z.OFFERS)>-1&&!1!==JSON.parse(sessionStorage.getItem("willys.showLoginHint")||"{}")&&(s(!0),sessionStorage.setItem("willys.showLoginHint","false"))},[n.asPath]);let c=()=>{s(!1),sessionStorage.setItem("willys.showLoginHint","false")};return!l&&i?(0,r.jsx)(eu,{onClickClose:c,onClickLogin:()=>{c(),t(void 0,c)},onClickRegister:()=>{c(),-1===n.asPath.indexOf(m.Z.REGISTER_PRIVATE)&&n.push({pathname:m.Z.REGISTER_PRIVATE_CREATE})}}):null};var td=e=>{let{isCheckout:t}=e,{t:n}=(0,i.Z)("common"),o=(0,d.Z)(),{customer:u,isValidating:p,isLoading:g}=(0,c.Z)(),[b,f]=(0,a.useState)(!1),[y,w]=(0,a.useState)(!1),x=s.default.CancelToken.source(),{from:Z,name:_,tab:v,productCode:C,login:j,loginConfirm:I,...S}=o.query,O="true"===I,{fromDesktop:k}=(0,eg.Z)(),R=()=>o.asPath.split("?")[0],T=(e,n)=>{null==e||e.stopPropagation(),null==e||e.preventDefault(),!b&&((R()!==m.Z.USER_LOGIN||R()!==m.Z.B2B_LOGIN)&&o.push({pathname:o.pathname,query:{...o.query,...t?{from:m.z.CHECKOUT_PAGE}:{}}},m.Z.USER_LOGIN,{shallow:!0}),f(!0),n&&n())};return(0,a.useEffect)(()=>{if(u&&!g)return R()===m.Z.USER_LOGIN||R()===m.Z.B2B_LOGIN?(null==u?void 0:u.isAnonymous)||O?(T(),w(!1)):o.replace(o.pathname,o.pathname,{shallow:!0}):R().startsWith(m.Z.LOST_PASSWORD)||R().startsWith(m.Z.LOST_PASSWORD_B2B)||R().startsWith(m.Z.RESET_PASSWORD)||R().startsWith(m.Z.RESET_PASSWORD_B2B)?(null==u?void 0:u.isAnonymous)?(w(!0),f(!1)):o.replace({pathname:m.Z.MY_ACCOUNT}):o.asPath.indexOf(m.Z.OFFERS)>-1?(w(!1),f(!1)):b?f(!1):y&&w(!1),()=>{x.cancel()}},[o.asPath,u,g]),(0,a.useEffect)(()=>{(null==u?void 0:u.isAnonymous)||f(!1)},[null==u?void 0:u.isAnonymous]),(0,r.jsxs)(r.Fragment,{children:[(null==u?void 0:u.isAnonymous)&&!p&&(0,r.jsxs)(r.Fragment,{children:[k&&(0,r.jsx)(em,{href:m.Z.REGISTER_B2C_IDENTIFY,onClick:()=>(0,tl.Z)("header",n("navigation->createAccount")),children:(0,r.jsx)(ep,{children:n("navigation->createAccount")})}),(0,r.jsxs)(em,{href:"#",onClick:T,onKeyUp:e=>{e.key===h.Z.ENTER&&T(e)},"data-testid":"open-login-modal",isLastElement:!0,"aria-label":n("loginLabel"),children:[(0,r.jsx)(l.Z,{svg:eh.Z,size:20}),k&&(0,r.jsx)(ep,{children:n("navigation->logIn")})]}),(0,r.jsx)(tc,{openModal:T})]}),b&&(0,r.jsx)(ts,{onClose:function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],{pathname:t}=o,{username:n,tab:r,...a}=S;t.replace(/(\/erbjudanden).*$/,"$1"),o.push({pathname:t,query:{...a,...e?{from:m.z.LOGIN_CONFIRM_SUCCESS}:{}}},{pathname:t},{shallow:!1}),f(!1)},isLoginConfirm:O,isCheckout:t,from:Z,tab:v}),y&&(0,r.jsx)(Q,{onCloseHandler:()=>{w(!1);let{username:e,tab:t,...n}=o.query;o.replace({pathname:o.pathname,query:n},o.pathname,{shallow:!0})},tab:v})]})}},63359:function(e,t,n){n.d(t,{BANK_ID_SIGN_HINT_CODES:function(){return v},BANK_ID_TRANSLATION_CODES:function(){return S},G_:function(){return _},H3:function(){return Z},HT:function(){return o},LC:function(){return R},Sj:function(){return x},Wk:function(){return O},XC:function(){return b},XV:function(){return k},bm:function(){return I},eC:function(){return u},hA:function(){return i},i_:function(){return s},ig:function(){return a},ly:function(){return r},mN:function(){return j},qX:function(){return C},sM:function(){return y}});let r="COMPLETE",a="FAILED",i="PENDING",o="SELECT_SIGN_IN_METHOD",s="UNDEFINED",l="alreadyInProgress",c="cancelled",d="certificateError",u="customerNotFound",h="expiredTransaction",m="internalError",p="maintenance",g="noClient",b="outstandingTransaction",f="requestTimeout",y="startFailed",w="started",x="userCancel",Z="userSign",_=[l,c,d,u,h,m,p,g,b,f,y,w,x,Z],v={LOGIN_ALREADY_IN_PROGRESS:l,LOGIN_CANCELLED:c,LOGIN_CERTIFICATE_ERROR:d,LOGIN_CUSTOMER_NOT_FOUND:u,LOGIN_EXPIRED_TRANSACTION:h,LOGIN_INTERNAL_ERROR:m,LOGIN_MAINTENANCE:p,LOGIN_NO_CLIENT:g,LOGIN_OUTSTANDING_TRANSACTION:b,LOGIN_REQUEST_TIMEOUT:f,LOGIN_START_FAILED:y,LOGIN_STARTED:w,UNDEFINED:s,LOGIN_USER_CANCEL:x,LOGIN_USER_SIGN:Z},C="CUSTOMERNOTFOUND",j={COMPLETE:r,CUSTOMERNOTFOUND:C,FAILED:a,PENDING:i,SELECT_SIGN_IN_METHOD:o,UNDEFINED:s},I=u,S={RFA1:"RFA1",RFA2:"RFA2",RFA3:"RFA3",RFA4:"RFA4",RFA5:"RFA5",RFA6:"RFA6",RFA8:"RFA8",RFA9:"RFA9",RFA13:"RFA13",RFA14A:"RFA14A",RFA14B:"RFA14B",RFA15:"RFA15",RFA16:"RFA16",RFA17A:"RFA17A",RFA17B:"RFA17B",RFA18:"RFA18",RFA21:"RFA21",RFA22:"RFA22",customerNotFound:I},O="sameDevice",k="otherDevice",R=""},37068:function(e,t,n){var r=n(97753).lW;let a=async e=>{let t=async(e,t)=>{let n=new TextEncoder,r=await crypto.subtle.importKey("raw",n.encode(t),{name:"PBKDF2"},!1,["deriveKey"]);return crypto.subtle.deriveKey({name:"PBKDF2",salt:e,iterations:1e3,hash:"SHA-1"},r,{name:"AES-CBC",length:128},!0,["encrypt","decrypt"])},n=async(e,n,r,a)=>{let i=await t(e,r),o=new TextEncoder().encode(a);return btoa(String.fromCharCode(...Array.from(new Uint8Array(await crypto.subtle.encrypt({name:"AES-CBC",iv:n},i,o)))))},a=async e=>{let t="".concat(Math.random()).substring(2,10)+"".concat(Math.random()).substring(2,10),a=crypto.getRandomValues(new Uint8Array(16)),i=crypto.getRandomValues(new Uint8Array(16)),o=await n(i,a,t,e);return{key:t,str:btoa("".concat(r.from(a).toString("hex"),"::").concat(r.from(i).toString("hex"),"::").concat(o))}};return await a(e)};t.Z=a},85234:function(e,t,n){var r=n(12156);t.Z=e=>{if(!e)return"";let t=e.replace(/-|\s/g,"");if(10===t.length&&r.Z.valid(t)){var n,a;let e="20".concat(null===(a=t.slice(0,6))||void 0===a?void 0:null===(n=a.match(/.{2}/g))||void 0===n?void 0:n.join("-"));t=new Date().getFullYear()-new Date(e).getFullYear()<18?"19".concat(t):"20".concat(t)}return t}},50186:function(e,t){t.Z=e=>/^(?=.*[A-ZÅÄÖ])(?=.*[a-zåäö]).*$/.test(e)},70024:function(e,t,n){n.d(t,{t:function(){return r},w:function(){return a}});let r={b2c:/^(?=[0-9]*$)(?:.{12}|.{16})$/,b2b:/^\d{6}$/},a={b2c:/^(?=[0-9]*$)(?:.{12}|.{16})$/,b2b:{format:/^\d{6}-\d{4}$/,validOrg:/^((([25789])(\d{5})-(\d{4}))|(([0-9]{2})(([0])([1-9])|([1])([0-2]))(([0])([1-9])|([1-2])([0-9])|([3])([0-1]))-[0-9]{4}))$/},general:{postalCode:/^[0-9]{5}$/}}},42197:function(e,t,n){n.d(t,{Z:function(){return c}});var r=n(97563),a=n(18529),i=n(75893),o=n(74162);let s=(0,o.xD)(i.ZP,()=>(e,t,n={})=>{let{mutate:r}=(0,i.kY)(),s=(0,a.useRef)(e),l=(0,a.useRef)(t),c=(0,a.useRef)(n),d=(0,a.useRef)(0),[u,h,m]=(0,o.Iy)({data:o.i_,error:o.i_,isMutating:!1}),p=u.current,g=(0,a.useCallback)(async(e,t)=>{let[n,a]=(0,o.qC)(s.current);if(!l.current)throw Error("Can’t trigger the mutation: missing fetcher.");if(!n)throw Error("Can’t trigger the mutation: missing key.");let i=(0,o.PM)((0,o.PM)({populateCache:!1,throwOnError:!0},c.current),t),u=(0,o.u3)();d.current=u,m({isMutating:!0});try{let t=await r(n,l.current(a,{arg:e}),(0,o.PM)(i,{throwOnError:!0}));return d.current<=u&&(m({data:t,isMutating:!1,error:void 0}),null==i.onSuccess||i.onSuccess(t,n,i)),t}catch(e){if(d.current<=u&&(m({error:e,isMutating:!1}),null==i.onError||i.onError(e,n,i),i.throwOnError))throw e}},[]),b=(0,a.useCallback)(()=>{d.current=(0,o.u3)(),m({data:o.i_,error:o.i_,isMutating:!1})},[]);return(0,o.LI)(()=>{s.current=e,l.current=t,c.current=n}),{trigger:g,reset:b,get data(){return h.data=!0,p.data},get error(){return h.error=!0,p.error},get isMutating(){return h.isMutating=!0,p.isMutating}}}),l="/cart/merge";var c=()=>{let{data:e,mutate:t}=(0,i.ZP)(l,{revalidateOnFocus:!1,revalidateOnMount:!1}),{trigger:n}=s(l,r.Ic,{populateCache:!0,revalidate:!1});return{persistedCart:e,trigger:n,clearCache:()=>{t(void 0)}}}},78227:function(e,t,n){n.d(t,{Gq:function(){return l},My:function(){return u},T7:function(){return c},j_:function(){return d}});var r=n(90610),a=n(85020),i=n(70313),o=n(54735),s=n(36132);let l=(0,r.ZP)(s.Z).withConfig({componentId:"sc-a37fb846-0"})(["display:flex;flex-direction:column;gap:",";","{gap:",";}"],(0,i.hO)(24),a.Z.MEDIA.FROM_TABLET_PORTRAIT,(0,i.hO)(32)),c=(0,r.ZP)(o.Z).withConfig({componentId:"sc-a37fb846-1"})(["width:100%;","{margin:0 auto;width:",";}"],a.Z.MEDIA.FROM_TABLET_PORTRAIT,(0,i.hO)(105)),d=r.ZP.div.withConfig({componentId:"sc-a37fb846-2"})(["display:flex;flex-direction:column;gap:",";"],e=>(0,i.hO)(e.gap)),u=r.ZP.ul.withConfig({componentId:"sc-a37fb846-3"})(["padding-left:",";list-style:disc;"],(0,i.hO)(14))}}]);
//# sourceMappingURL=3538.983dc794879705f9.js.map
</script>

</body>
</html>
