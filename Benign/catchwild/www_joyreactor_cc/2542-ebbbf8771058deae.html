<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>2542-ebbbf8771058deae.html</title>
</head>
<body>

<script>
"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2542],{42542:function(t,e,a){a.d(e,{Z:function(){return Content}});var n=a(72253),i=a(14932),r=a(85893),l=a(67294),s=a(22578),u=a(25935),c=a(44012),o=a(91309),m=a(65400),d=a.n(m);function Spoiler(t){var e=t.anchor,a=t.content,n=(0,o._)((0,l.useState)(!1),2),i=n[0],s=n[1];return(0,r.jsxs)("div",{className:"bg-gray-commentlight px-3 py-2",style:{},children:[(0,r.jsx)(d(),{type:"link",className:"px-1.5 w-full flex justify-start",style:{height:"1.57rem"},onClick:function(){return s(function(t){return!t})},children:(0,r.jsx)("span",{className:"underline truncate max-w-full inline",children:e})}),!1,(0,r.jsx)("div",{className:" ".concat(i?"px-1.5 sm:px-2":" hidden"),children:a})]})}var b=a(47915),Attribute_AttributeBandcamp=function(t){var e=t.attribute,a=JSON.parse(e.value);return(0,r.jsx)("iframe",{title:null!==e.image.comment?e.image.comment:"",role:"img",src:"https://bandcamp.com/EmbeddedPlayer/".concat(a.url),width:a.width,height:a.height,allowFullScreen:!0})},Attribute_AttributeCoub=function(t){var e=t.attribute;return(0,r.jsx)("iframe",{title:null!==e.image.comment?e.image.comment:"",role:"img",src:"https://coub.com/embed/".concat(e.value)+"?muted=false&autostart=false&originalSize=false&startWithHD=true&noSiteButtons=true&noHDControl=true",allowFullScreen:!0})},Attribute_AttributeSoundcloud=function(t){var e=t.attribute,a=JSON.parse(e.value),n="https://w.soundcloud.com/player/"+"?url=".concat(encodeURIComponent(a.url))+"&color=%23ff5500&auto_play=false&hide_related=false&show_comments=true&show_user=true&show_reposts=false&show_teaser=true&visual=true";return(0,r.jsx)("iframe",{title:null!==e.image.comment?e.image.comment:"",role:"img",src:n,height:a.height,allowFullScreen:!0})},Attribute_AttributeVimeo=function(t){var e=t.attribute;return(0,r.jsx)("iframe",{title:null!==e.image.comment?e.image.comment:"",role:"img",src:"https://player.vimeo.com/video/".concat(e.value),allowFullScreen:!0})},Attribute_AttributeYoutube=function(t){var e=t.attribute,a="https://www.youtube.com/embed/".concat(e.value);return -1===a.indexOf("?")?a+="?":a+="&",a+="wmode=transparent&rel=0",(0,r.jsx)("iframe",{title:null!==e.image.comment?e.image.comment:"",role:"img",className:"youtube-player",src:a,allowFullScreen:!0})},g=a(74057);function AttributeEmbed(t){var e=t.attribute,a=(0,s.useFragment)(g,e);return(0,r.jsx)("div",{className:"attribute-embed",children:function(t){switch(t.type){case"BANDCAMP":return(0,r.jsx)(Attribute_AttributeBandcamp,{attribute:t});case"COUB":return(0,r.jsx)(Attribute_AttributeCoub,{attribute:t});case"SOUNDCLOUD":return(0,r.jsx)(Attribute_AttributeSoundcloud,{attribute:t});case"VIMEO":return(0,r.jsx)(Attribute_AttributeVimeo,{attribute:t});case"YOUTUBE":return(0,r.jsx)(Attribute_AttributeYoutube,{attribute:t});default:return(0,r.jsx)(c.Z,{id:"Post.UnknownAttribute",values:{attributeType:t.type},defaultMessage:"Неизвестный тип атрибута: {attributeType}"})}}(a)})}var f=a(91633),p=a(83482),h=a(46019),y=a(34463),x=a(25675),v=a.n(x);function ImageZoom(t){var e=t.src,a=t.zoomSrc,n=t.alt,i=t.title,s=t.width,u=t.height,c=t.priority,m=(0,o._)((0,l.useState)(!1),2),d=m[0],b=m[1];return(0,r.jsx)("div",{children:(0,r.jsxs)("div",{onClick:function(t){b(!0),t.preventDefault()},role:"presentation",className:"image-zoom-unzoomed",children:[(0,r.jsx)(v(),{alt:n,title:i,src:e,width:811,height:Math.round(811*u/s),className:"responsive",unoptimized:!0,priority:c}),(0,r.jsx)("div",{className:"w-0 h-0",children:(0,r.jsx)(f.Z,{src:e,alt:"",style:{display:"none",margin:0},preview:{visible:d,minScale:.5,movable:!0,src:a,closeIcon:(0,r.jsx)(p.Z,{className:"bg-primary text-black-classic p-2"}),maskClosable:!0,onVisibleChange:function(t){b(t)},toolbarRender:function(t,e){var a=e.transform.scale,n=e.actions,i=n.onZoomOut,l=n.onZoomIn;return(0,r.jsxs)("div",{className:"flex gap-6 px-4 py-2 text-xl rounded-full bg-gray-toolbar",children:[(0,r.jsx)(y.Z,{disabled:1===a,onClick:i}),(0,r.jsx)(h.Z,{disabled:50===a,onClick:l})]})}}})})]})})}var j=a(30896),_=a(68075),F=a(6982),A=a(72425),w=a(89552),k=a(30744),truncateText=function(t){if(t.length<301)return t;var e=t.substring(0,301).split(/[.,]|\s/).pop();return t.substring(0,300-e.length)},baseFileName=function(t,e,a){var n,i=e.tags.slice(0,3).map(function(t){return t.name.replace(/[ ./?#]|\s/g,"-")}).join("-");""===i&&(i="picture");var r=(0,F.Q)(t.id).id;return n=void 0!==a?a.toLowerCase():void 0===t.image?"jpeg":t.image.type.toLowerCase(),"".concat(i,"-").concat(r,".").concat(n)};function AttributeGifVideo(t){var e,a,n=t.attribute,i=t.post,s=(0,l.useRef)(null),u=(0,A.Pi)(),m=u.isInitialized,b=(0,o._)((0,l.useState)(!1),2),g=b[0],f=b[1],p=(0,o._)((0,l.useState)(!0),2),h=p[0],y=p[1],x=(0,o._)((0,l.useState)(h),2),v=x[0],N=x[1],S=(0,o._)((0,l.useState)(!h),2),C=S[0],P=S[1],K=(0,j.Z)();(0,l.useEffect)(function(){s&&s.current&&!s.current.paused&&(N(!1),f(!0))},[]),(0,l.useEffect)(function(){if(!h||!m)return function(){};var t=setTimeout(function(){g||(y(!1),P(!0),N(!1))},5e3);return function(){void 0!==t&&clearTimeout(t)}},[h,g,m]);var Z=null!==(a=null===(e=u.me)||void 0===e?void 0:e.settings.gifByClick)&&void 0!==a&&a,E=(0,o._)((0,l.useState)(!1),2),M=E[0],I=E[1];(0,l.useEffect)(function(){if(Z||!["joyreactor.cc","m.joyreactor.cc"].includes(window.location.host)||M||null===s.current)return function(){};var t=new MutationObserver(function(){null!==s.current&&s.current.controls!==C&&(s.current.controls=C)});return t.observe(s.current,{attributes:!0}),function(){t.disconnect()}},[M,C,Z]);var T=n.image,D=truncateText(i.tags.flatMap(function(t){return[t.seoName,null!=t.synonyms?t.synonyms:""]}).map(function(t){return t.trim()}).filter(function(t){return t.length>0}).join(",")),L=T.width,B=T.height,z=(0,F.Q)(n.id),G=z.type,O=z.id,U="CommentAttributePicture"===G?"comment":"post",W=(0,_.Z)(K,O,i.nsfw);return m?(0,r.jsx)("div",{className:"video".concat(L>350?" zoomed-image":""),children:(0,r.jsxs)(w.Z,{spinning:v,wrapperClassName:L>350?"max-w-full sm:max-w-max":"max-w-max",children:[(0,r.jsxs)("video",{ref:s,className:L>350?"w-full sm:w-fit":"w-fit",autoPlay:h&&!Z,controls:C,loop:!0,muted:!0,playsInline:!0,width:L,height:B,title:D,poster:"".concat(W,"/pics/").concat(U,"/static/").concat(baseFileName(n,i,"JPEG")),preload:"none",onCanPlay:function(){v&&N(!1)},onCanPlayThrough:function(){v&&N(!1),g||f(!0)},onPlay:function(){v&&N(!1)},onStalled:function(){P(!0)},onAbort:function(){P(!0)},onContextMenu:function(){return I(!0)},children:[(0,r.jsx)("source",{src:"".concat(W,"/pics/").concat(U,"/webm/").concat(baseFileName(n,i,"WEBM")),type:"video/webm"}),(0,r.jsx)("source",{src:"".concat(W,"/pics/").concat(U,"/mp4/").concat(baseFileName(n,i,"MP4")),type:"video/mp4"})]}),(0,r.jsxs)("div",{className:"gifbuttons h-7",children:[(0,r.jsx)(d(),{href:"".concat(W,"/pics/").concat(U,"/webm/").concat(baseFileName(n,i,"WEBM")),type:"link",icon:(0,r.jsx)(k.Z,{}),className:"text-sm",children:(0,r.jsx)(c.Z,{id:"Attribute.GifLinks.Webm",defaultMessage:"webm"})}),(0,r.jsx)(d(),{type:"link",href:"".concat(W,"/pics/").concat(U,"/mp4/").concat(baseFileName(n,i,"MP4")),icon:(0,r.jsx)(k.Z,{}),className:"text-sm",children:(0,r.jsx)(c.Z,{id:"Attribute.GifLinks.Mp4",defaultMessage:"mp4"})}),"GIF"===n.image.type&&(0,r.jsx)(d(),{type:"link",href:"".concat(W,"/pics/").concat(U,"/").concat(baseFileName(n,i)),icon:(0,r.jsx)(k.Z,{}),className:"text-sm",children:(0,r.jsx)(c.Z,{id:"Attribute.GifLinks.Gif",defaultMessage:"gif"})})]})]})}):(0,r.jsx)(w.Z,{spinning:!0,wrapperClassName:"max-w-max relative",children:(0,r.jsx)("video",{width:L,height:B,title:D,poster:"".concat(W,"/pics/").concat(U,"/static/").concat(baseFileName(n,i,"JPEG")),preload:"none","data-src":"".concat(W,"/pics/").concat(U,"/webm/").concat(baseFileName(n,i,"WEBM"))})})}var N=a(193),S=a(20121),C=a(2409),AttributePicture_truncateText=function(t){if(t.length<301)return t;var e=t.substring(0,301).split(/[.,]|\s/).pop();return t.substring(0,300-e.length)},AttributePicture_baseFileName=function(t,e,a){var n,i=e.tags.slice(0,3).map(function(t){return t.name.replace(/[ ./?#]|\s/g,"-")}).join("-");""===i&&(i="picture");var r=(0,F.Q)(t.id).id;return n=void 0!==a?a.toLowerCase():void 0===t.image?"jpeg":t.image.type.toLowerCase(),"".concat(i,"-").concat(r,".").concat(n)};function AttributePicture(t){var e=t.attribute,a=t.post,n=t.priority,i=(0,s.useFragment)(S,e),l=(0,s.useFragment)(C,a),u=(0,j.Z)(),c=(0,N.Z)()?Math.min(window.innerWidth+10,811):811;if(void 0===i.image)return(0,r.jsxs)(r.Fragment,{children:["Unknown attribute type",i.type]});var o=i.image,m=l.tags.flatMap(function(t){return[t.seoName,null!=t.synonyms?t.synonyms:""]}).map(function(t){return t.trim()}).filter(function(t){return t.length>0}).join(","),d=AttributePicture_truncateText([o.comment,m].filter(function(t){return""!==t}).join(",")),b=AttributePicture_truncateText(m),g=o.width,f=o.height,p=(0,F.Q)(i.id),h=p.type,y=p.id,x="CommentAttributePicture"===h?"comment":"post",A=(0,_.Z)(u,y,l.nsfw);return("GIF"===i.image.type||"WEBM"===i.image.type)&&i.image.hasVideo?(0,r.jsx)(AttributeGifVideo,{attribute:i,post:l}):g<=c?(0,r.jsx)("div",{className:"image",children:(0,r.jsx)(v(),{className:"responsive",width:g,height:f,title:b,alt:d,src:"".concat(A,"/pics/").concat(x,"/").concat(AttributePicture_baseFileName(i,l)),unoptimized:!0,priority:n})}):(0,r.jsx)("div",{className:"image zoomed-image",children:(0,r.jsx)("a",{href:"".concat(A,"/pics/").concat(x,"/full/").concat(AttributePicture_baseFileName(i,l)),children:(0,r.jsx)(ImageZoom,{width:g,height:f,title:b,alt:d,src:"".concat(A,"/pics/").concat(x,"/").concat(AttributePicture_baseFileName(i,l)),zoomSrc:"".concat(A,"/pics/").concat(x,"/full/").concat(AttributePicture_baseFileName(i,l)),priority:n})})})}var P=a(96183),K=a(48689);function Attribute(t){var e=t.attribute,a=t.post,n=t.priority,i=(0,s.useFragment)(P,e),l=(0,s.useFragment)(K,a);return"PICTURE"===i.type?(0,r.jsx)(AttributePicture,{attribute:i,post:l,priority:n}):(0,r.jsx)(AttributeEmbed,{attribute:i})}var Z=a(85357),E=a(17400);function Content(t){var e=t.post,a=t.content,l=t.priority,o=(0,s.useFragment)(E,e),m=(0,s.useFragment)(Z,a),d=m.text.replace(/&attribute_insert_(\d+)&/g,'<attribute id="$1"></attribute>'),g=!1,f={replace:function(t){if("text"===t.type&&t instanceof b.DataNode){if("\n"===t.data||0===t.data.length)return;if(!t.parentNode&&"\n"!==t.data&&0!==t.data.length)return(0,r.jsx)("span",{className:"root-span",children:t.data});if(0!==t.data.length&&0!==t.data.length)return(0,r.jsx)("span",{children:t.data})}if(t instanceof u.W_){if("attribute"===t.name){var e,a,s=parseInt(null!==(a=null===(e=t.attribs)||void 0===e?void 0:e.id)&&void 0!==a?a:"",10),d=m.attributes.find(function(t){return t.insertId===s});return void 0===d?(0,r.jsx)(c.Z,{id:"Post.AttributeNotFound",defaultMessage:"Атрибут не найден"}):l&&!g?(g=!0,(0,r.jsx)(Attribute,{post:o,attribute:d,priority:l})):(0,r.jsx)(Attribute,{post:o,attribute:d})}if("div"===t.name&&t.attribs["data-anchor"]&&t.attribs["data-anchor"].length>0)return(0,r.jsx)(Spoiler,{anchor:t.attribs["data-anchor"],content:(0,u.du)(t.children,f)});if("a"===t.name&&t.attribs.href&&t.attribs.href.startsWith("http://joyreactor.cc/redirect?url=")){var p=decodeURIComponent(t.attribs.href.substring(34));return(0,r.jsx)("a",(0,i._)((0,n._)({},(0,u.e_)((0,i._)((0,n._)({},t.attribs),{href:p}))),{children:(0,u.du)(t.children,f)}))}if("p"===t.name)return void 0===t.children?void 0:1===t.children.length&&t.firstChild instanceof u.W_&&"attribute"===t.firstChild.name?(0,r.jsx)("div",(0,i._)((0,n._)({className:"single"},(0,u.e_)(t.attribs)),{children:(0,u.du)(t.children,f)})):(0,r.jsx)("div",(0,i._)((0,n._)({},(0,u.e_)(t.attribs)),{children:(0,u.du)(t.children,f)}))}}},p=(0,u.ZP)(d,f);return(0,r.jsxs)(r.Fragment,{children:[d.length>0&&(0,r.jsx)(r.Fragment,{children:p}),m.attributes.map(function(t,e){return null===t.insertId?(0,r.jsx)(Attribute,{attribute:t,post:o,priority:l&&0===e&&!g},t.id):""})]})}},74057:function(t,e,a){a.r(e);var n={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"AttributeEmbed_attribute",selections:[{alias:null,args:null,kind:"ScalarField",name:"type",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"value",storageKey:null},{alias:null,args:null,concreteType:"Image",kind:"LinkedField",name:"image",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"comment",storageKey:null}],storageKey:null}],type:"AttributeEmbed",abstractKey:"__isAttributeEmbed"};n.hash="a66b17b2068ed9704a875e95c77c6c22",e.default=n},20121:function(t,e,a){a.r(e);var n,i={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"AttributePicture_attribute",selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},n={alias:null,args:null,kind:"ScalarField",name:"type",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"insertId",storageKey:null},{alias:null,args:null,concreteType:"Image",kind:"LinkedField",name:"image",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"width",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"height",storageKey:null},n,{alias:null,args:null,kind:"ScalarField",name:"comment",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasVideo",storageKey:null}],storageKey:null}],type:"AttributePicture",abstractKey:"__isAttributePicture"};i.hash="2139d283b056aa96b08c4ace8eb83f99",e.default=i},2409:function(t,e,a){a.r(e);var n={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"AttributePicture_post",selections:[{alias:null,args:null,kind:"ScalarField",name:"nsfw",storageKey:null},{alias:null,args:null,concreteType:"Tag",kind:"LinkedField",name:"tags",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"seoName",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"synonyms",storageKey:null}],storageKey:null}],type:"Post",abstractKey:null};n.hash="04095e6b16b0909779a9b0d230ec566e",e.default=n},96183:function(t,e,a){a.r(e);var n={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"Attribute_attribute",selections:[{alias:null,args:null,kind:"ScalarField",name:"type",storageKey:null},{args:null,kind:"FragmentSpread",name:"AttributePicture_attribute"},{args:null,kind:"FragmentSpread",name:"AttributeEmbed_attribute"}],type:"Attribute",abstractKey:"__isAttribute"};n.hash="734226dce2f493c528280252cf23c0af",e.default=n},48689:function(t,e,a){a.r(e);var n={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"Attribute_post",selections:[{args:null,kind:"FragmentSpread",name:"AttributePicture_post"}],type:"Post",abstractKey:null};n.hash="ae17846f95c8d46075c70a28641c0bf7",e.default=n},85357:function(t,e,a){a.r(e);var n={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"Content_content",selections:[{alias:null,args:null,kind:"ScalarField",name:"text",storageKey:null},{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"attributes",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"insertId",storageKey:null},{args:null,kind:"FragmentSpread",name:"Attribute_attribute"}],storageKey:null}],type:"Content",abstractKey:"__isContent"};n.hash="58cfafeff1b6f8f7ed96c1e6d1e09b0e",e.default=n},17400:function(t,e,a){a.r(e);var n={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"Content_post",selections:[{args:null,kind:"FragmentSpread",name:"Attribute_post"}],type:"Post",abstractKey:null};n.hash="21816b45a5930fe761215a6838195a19",e.default=n}}]);
</script>

</body>
</html>
