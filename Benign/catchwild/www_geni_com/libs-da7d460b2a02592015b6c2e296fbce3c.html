<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>libs-da7d460b2a02592015b6c2e296fbce3c.html</title>
</head>
<body>

<script>
/*!
 * Geni JavaScript Library
 * Copyright (c) MyHeritage
 */
function Panel(){this.initialize(...arguments)}function init_date_fields(){"function"!=typeof String.prototype.trim&&(String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")}),Geni.UI=Geni.UI||{},Geni.UI.DateFields=new DateFields,Geni.User&&(Geni.User.preferences.date.format_set||Geni.UI.DateFields.askUserToChooseFormat(),Geni.User.preferences.date.format&&Geni.UI.DateFields.setFormat(Geni.User.preferences.date.format),Geni.User.preferences.date.months&&Geni.UI.DateFields.setMonths(Geni.User.preferences.date.months)),Geni.UI.DateFields.renderAll(),Geni.UI.DateFields.rangeSelAll();var e=!1,t=!1;if(!1){console.log("Testing _compactDelimiters...");var i=new DateData;(a=[{input:"12",output:"12"},{input:"1  2",output:"1  2"},{input:"1, 2",output:"1,2"},{input:"1, ,2",output:"1,2"},{input:"1, -2",output:"1,-2"}]).forEach(function(e){var t=i._compactDelimiters(e.input);t!==e.output?console.log("FAIL",e.input,"(",e.output,"!=",t,")"):console.log("PASS",e.input)})}if(e){console.log("Testing _innerSplit...");i=new DateData;(a=[{input:["12","34"],format:0,output:!1},{input:["1-2","3-4"],format:0,output:!1},{input:["1-2"],format:0,output:"1,2"},{input:["1--2","34"],format:0,output:"1,-2,34"},{input:["Feb--1968"],format:0,output:"Feb,,1968"},{input:["5-21-1968"],format:0,output:"5,21,1968"},{input:["1-2--3"],format:0,output:"1,2,-3"},{input:["-3--1"],format:2,output:"-3,,1"},{input:["-3-Jan"],format:2,output:"-3,Jan"}]).forEach(function(e){i.format=e.format;var t=i._innerSplit(e.input);Array.isArray(t)&&(t=t.join(",")),t!==e.output?console.log("FAIL",e.input,"(",e.output,"!=",t,")"):console.log("PASS",e.input)})}if(t){console.log("Testing parseDateString...");for(var n=[" ",",","/","-","."],a=[{input:[["5","21","1968"],["21","5","1968"],["1968","5","21"]],output:[{year:1968,month:5,day:21},{year:1968,month:5,day:21},{year:1968,month:5,day:21}]},{input:[["2","1","3"],["1","2","3"],["3","2","1"]],output:[{year:3,month:2,day:1},{year:3,month:2,day:1},{year:3,month:2,day:1}]},{input:[["Feb","5","1968"],["5","Feb","1968"],["1968","Feb","5"]],output:[{year:1968,month:2,day:5},{year:1968,month:2,day:5},{year:1968,month:2,day:5}]},{input:[["Feb","","1968"],["","Feb","1968"],["1968","Feb",""]],output:[{year:1968,month:2},{year:1968,month:2},{year:1968,month:2}]},{input:[["Feb","1968"],["Feb","1968"],["1968","Feb"]],output:[{year:1968,month:2},{year:1968,month:2},{year:1968,month:2}]},{input:[["Feb"],["Feb"],["Feb"]],output:[{month:2},{month:2},{month:2}]},{input:[["Feb","1"],["1","Feb"],["Feb","1"]],output:[{month:2,day:1},{month:2,day:1},{month:2,day:1}]},{input:[["Feb","41"],["41","Feb"],["Feb","41"]],output:[{month:2,year:41},{month:2,year:41},{month:2,year:41}]},{input:[["1","2","-3"],["2","1","-3"],["-3","1","2"]],output:[{year:-3,month:1,day:2},{year:-3,month:1,day:2},{year:-3,month:1,day:2}]},{input:[["1","","-3"],["","1","-3"],["-3","1",""]],output:[{year:-3,month:1},{year:-3,month:1},{year:-3,month:1}]},{input:[["Jan","3"],["3","Jan"],["-3","Jan"]],output:[{month:1,day:3},{month:1,day:3},{month:1,year:-3}]},{input:[["","1","-3"],["1","","-3"],["-3","","1"]],output:[{year:-3,day:1},{year:-3,day:1},{year:-3,day:1}]},{input:[["2","1",""],["1","2",""],["-2","1"]],output:[{month:2,day:1},{month:2,day:1},{year:-2,month:1}]},{input:[["May","26,1950"],["26","May","1950"],["1950","May","26"]],output:[{year:1950,month:5,day:26},{year:1950,month:5,day:26},{year:1950,month:5,day:26}]},{input:[["May","26, 1950"],["26","May","1950"],["1950","May","26"]],output:[{year:1950,month:5,day:26},{year:1950,month:5,day:26},{year:1950,month:5,day:26}]},{input:[["9","Jan","1921"],["Jan","9","1921"],["1921","Jan","9"]],output:[{year:1921,month:1,day:9},{year:1921,month:1,day:9},{year:1921,month:1,day:9}]},{input:[[" Feb","2","1968 "],[" 2","Feb","1968 "],[" 1968","Feb","2 "]],output:[{year:1968,month:2,day:2},{year:1968,month:2,day:2},{year:1968,month:2,day:2}]},{input:[["2","1"],["1","2"],["2","1"]],output:[{month:2,day:1},{month:2,day:1},{month:2,day:1}]},{input:[["March","1,"," 1970"],["1","March,"," 1970"],["1970,","March"," 1"]],output:[{month:3,day:1,year:1970},{month:3,day:1,year:1970},{month:3,day:1,year:1970}]}],r=0;r<3;r++)for(var s=0;s<n.length;s++){var o=n[s];console.log("Format and separator: "+r+" ("+(new DateData).toLabel(r)+'), "'+o+'"'),a.forEach(function(e,t){var i=e.input[r].join(o),n=new DateData;n.format=r;var a=n.parseDateString(i),s=e.output[r];a.year==s.year&&a.month==s.month&&a.day==s.day||(n.parseDateString(i,!0),console.log("Case "+t+" Format "+r+' FAIL: "',i,'" (expected ',s,", got ",a,")"))})}i=new DateData;(a=[{input:"1980 ",format:0,output:{year:"1980",month:null,day:null}},{input:"Feb 22, 1980 ",format:2,output:{year:"1980",month:"2",day:"22"}},{input:"November 8",format:1,output:{year:null,month:"11",day:"8"}},{input:"November 1917",format:1,output:{year:1917,month:"11",day:null}}]).forEach(function(e){i.format=e.format;var t=i.parseDateString(e.input);t.year!=e.output.year||t.month!=e.output.month||t.day!=e.output.day?console.log("FAIL",e.input,"(expected ",e.output,", got ",t,")"):console.log("PASS",e.input)})}}function fbRequireSession(){FB.login(function(e){e.authResponse?fbOnSessionReadyCallback():fbOnSessionCanceledCallback()},{scope:Geni&&Geni.FB_Scope?Geni.FB_Scope:"email,publish_actions,user_birthday,user_gender,user_link"})}function fbOnSessionReadyCallback(){null!=fb_session_ready_url&&(window.location=fb_session_ready_url)}function fbOnSessionCanceledCallback(){fb_session_ready_url=null}function fbLoginAndRedirect(e,t){var i=(new Date).getTime();return i-fb_last_clicked_time>1500&&(fb_session_ready_url="/facebook/login?fb_source="+e+"&forward_to="+t,fbRequireSession()),fb_last_clicked_time=i,!1}function fbAutoLoginAndRedirect(e,t){window.location="/facebook/login?fb_source="+e+"&forward_to="+t}function fbLinkAccountAndForward(e,t){fb_session_ready_url="/facebook/link?fb_source="+e+"&forward_to="+t,fbConnected()?window.location=fb_session_ready_url:fbRequireSession()}function fbCallGraphApi(e,t){FB.api(e,t)}function fbConnected(){return"connected"==fb_status}function fbNotAuthorized(){return"not_authorized"==fb_status}function fbUnknown(){return"unknown"==fb_status}function fbDidGetLoginStatus(e){var t=jQuery("#fb-sharing-wrapper");t&&(fb_user_session_activated||"not_authorized"==e||"connected"==e)&&t.fadeIn()}function fbHandleNewsfeedStories(){new Ajax.Request("/facebook/publish_story_ajax",{onComplete:function(transport){var data=eval("["+transport.responseText+"]")[0];"done"==data.status?"function"==typeof handleStoriesCompleted&&handleStoriesCompleted():FB.ui({method:"stream.publish",message:data.user_message,attachment:data.attachment,action_links:data.action_links,user_prompt_message:data.user_message_prompt},function(){fbHandleNewsfeedStories()})}})}function collectBillingAddress(){ensureFormContainerExists(),new Panel({panelId:"lightbox",panelClass:"panel",url:"/paypal/billing_address_prompt",displayOverlay:!0,width:"450px"}).open()}function submitBillingAddress(){submitBillingAddressFields({street_address1:document.getElementById("paypal_billing_street_address1").value,street_address2:document.getElementById("paypal_billing_street_address2").value,city:document.getElementById("paypal_billing_city").value,country:document.getElementById("paypal_billing_country").value,region:document.getElementById("paypal_billing_state").value,zip:document.getElementById("paypal_billing_postal_code").value,latitude:document.getElementById("paypal_billing_latitude").value,longitude:document.getElementById("paypal_billing_longitude").value},!0)}function submitBillingAddressFields(e,t){var i={billing_address:e};i[Geni.AuthenticityParam]=Geni.AuthenticityToken,jQuery.ajax({url:"/paypal/billing_address",async:!1,method:"post",data:i,dataType:"json",success:function(e){jQuery("#paypal_form_container #billing_address").html(e.billing_address_id),updatePayPalForm(jQuery('[name="product_id"]').val(),document.getElementById("r_id").value,t)},error:function(){jQuery("#paypal_error").show()}})}function submitPayPalForm(){"true"==enable_paypal&&(0==jQuery("#default_paypal_product_warning").length||jQuery("#default_paypal_product_warning").html().blank()||confirm(jQuery("#default_paypal_product_warning").html()))&&collectBillingAddress()}function ensureFormContainerExists(){if(0==jQuery("#paypal_form_container").length){var e=document.createElement("div");e.setAttribute("id","paypal_form_container"),document.body.appendChild(e)}if(0==jQuery("#paypal_form_container #billing_address").length){var t=document.createElement("div");t.setAttribute("id","billing_address"),document.getElementById("paypal_form_container").appendChild(t)}}function updatePayPalForm(e,t,i){"true"==enable_paypal&&(ensureFormContainerExists(),billing_address_id=jQuery("#paypal_form_container #billing_address").html(),i?new Geni.Updater("#paypal_form_container","/paypal/form",{parameters:{product_id:e,r_id:t,billing_address_id:billing_address_id},onComplete:function(){jQuery("#paypal_payment_form").submit()}}):new Geni.Updater("#paypal_form_container","/paypal/form",{parameters:{product_id:e,r_id:t,billing_address_id:billing_address_id}}))}function iOSVersion(){if(/iP(hone|od|ad)/.test(navigator.platform)){var e=navigator.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/);return[parseInt(e[1],10),parseInt(e[2],10),parseInt(e[3]||0,10)].join(".")}}window.Geni=window.Geni||{},window.G=window.$g=window.Geni,Object.assign(Geni,{Version:.3,UI:{},isOpera:"[object Opera]"==Object.prototype.toString.call(window.opera),isWebKit:navigator.userAgent.indexOf("AppleWebKit/")>-1,AssetCachebust:"20230627",isMobilePhone:function(){return/Android|webOS|iPhone|iPod|BlackBerry|BB|PlayBook|IEMobile|Windows Phone|Kindle|Silk|Opera Mini/i.test(navigator.userAgent)&&!this.screenCanShowModal(900)},isMobileTablet:function(){return/iPad/i.test(navigator.userAgent)},isAndroid:function(){return/Android/i.test(navigator.userAgent)},screenCanShowModal:function(e){return!!(this.isLandscape()&&window.screen.width>e)||!this.isLandscape()&&window.screen.height>e},isLandscape:function(){return window.screen.width>window.screen.height},makePositioned:function(e){var t=window.getComputedStyle(e).position;return"static"!==t&&t!==undefined||(e.style.position="relative",e._madePositioned=t),e},undoPositioned:function(e){return e._madePositioned&&(e.style.position=e._madePositioned,e._madePositioned=null),e},makeClipping:function(e){return e._overflow?e:(e._overflow=window.getComputedStyle(e).overflow||"auto",e.style.overflow="hidden",e)},undoClipping:function(e){return e._overflow?(e.style.overflow="auto"==e._overflow?"":e._overflow,e._overflow=null,e):e},cumulativeOffset:function(e){"string"==typeof e&&(e=document.getElementById(e));for(var t=0,i=0;e;)t+=e.offsetTop,i+=e.offsetLeft,e=e.offsetParent;return{0:i,1:t,left:i,top:t}},cumulativeScrollOffset:function(e){var t=0,i=0;do{t+=e.scrollTop||0,i+=e.scrollLeft||0,e=e.parentNode}while(e);return{left:i,top:t}},getOffsetParent:function(e){if("string"==typeof e&&(e=document.getElementById(e)),isDocument(e)||isDetached(e)||isBody(e)||isHtml(e))return document.body;if(!("inline"===window.getComputedStyle(e).display)&&e.offsetParent)return e.offsetParent;for(;(e=e.parentNode)&&e!==document.body;)if("static"!==window.getComputedStyle(e).position)return isHtml(e)?document.body:e;return document.body},positionedOffset:function(e){"string"==typeof e&&(e=document.getElementById(e));var t=0,i=0;do{if(t+=e.offsetTop||0,i+=e.offsetLeft||0,e=e.offsetParent){if("body"===e.tagName.toLowerCase())break;if("static"!==window.getComputedStyle(e).position)break}}while(e);var n=window.getComputedStyle(e);return{left:i-=parseFloat(n.marginTop)||0,top:t-=parseFloat(n.marginLeft)||0}},values:function(e){var t=[];for(var i in e)t.push(e[i]);return t},saveSettings:function(e){return form_data={},form_data[Geni.AuthenticityParam]=Geni.AuthenticityToken,form_data.settings=e,jQuery.ajax({url:"/account_settings/save",type:"post",data:form_data})},saveTimezone:function(){var e;try{e=Intl.DateTimeFormat().resolvedOptions().timeZone}catch(i){}if(e)new Geni.Request("/account_settings/set_timezone",{parameters:{zone:e}});else{var t=$g.util.calculate_time_zone();new Geni.Request("/account_settings/set_timezone",{parameters:{offset:t}})}},updateDocumentProfileData:function(e,t){for(var i in t)t.hasOwnProperty(i)&&jQuery(".profile-decoration[data-profile-id="+e+"]").attr("data-"+i,t[i])},selectTargetText:e=>(e.select(),!1),setFocus:e=>(jQuery(e).focus(),!1),showGroup:function(e,t){if(this.showing||this.hiding)return!1;this.showing=!0;var i=jQuery(e),n=jQuery.extend({duration:400,easing:"swing"},t);return i.show(n),setTimeout(function(){this.showing=!1}.bind(this),n.duration),!1},hideGroup:function(e,t){if(this.hiding||this.showing)return!1;this.hiding=!0;var i=jQuery(e),n=jQuery.extend({duration:400,easing:"swing"},t);return i.hide(n),setTimeout(function(){this.hiding=!1}.bind(this),n.duration),!1},toggleGroup:function(e,t){var i=jQuery(e),n=jQuery.extend({duration:400,easing:"swing"},t);return i.toggle(n),t&&t.setFocus&&setFocus(t.setFocus),!(!t||!t.returnTrue)},removeGroup:function(e){return jQuery(e).remove(),!1},toggleElement:function(e,t){var i=null,n=null,a=null,r="height",s=400,o=null;e&&e.length>0&&(i=jQuery("#"+e)),t&&t.length>0&&(n=jQuery("#"+t)),t&&t.length>0&&(a=jQuery("#"+t+"-icon")),i.length>0&&(n.length>0&&(n.data("effect")&&n.data("effect").length>0&&(r=n.data("effect")),n.data("effect-duration")&&n.data("effect-duration").length>0&&(r=parseInt(n.data("effect-duration"))),i.is(":visible")?(o=!1,n.data("data-hide-text")&&n.html(unescape(n.data("data-hide-text")))):(o=!0,n.data("data-show-text")&&n.html(unescape(n.data("data-show-text"))))),animate_opts={},animate_opts[r]="toggle",i.animate(animate_opts,{duration:s,progress:function(e,t){o||(t=1-t),a.attr("data-progress",Math.floor(10*t))}}))},postNonAjax:function(e,t){var i;i=jQuery("<form />",{action:e,method:"POST",style:"display: none;"}),void 0!==t&&null!=t||(t={}),t[Geni.AuthenticityParam]=Geni.AuthenticityToken,jQuery.each(t,function(e,t){jQuery("<input />",{type:"hidden",name:e,value:t}).appendTo(i)}),i.appendTo("body").submit()},alert:function(e){"string"!=typeof e?(e.title||(e.title=!1),e.content||(e.content=!1),e.confirmButton&&(e.buttons||(e.buttons={}),e.buttons[e.confirmButton]=function(){},delete e.confirmButton),e.rtl=Geni.RTL,jQuery.alert(e)):Geni.alert({content:e})},confirm:function(e){if(e.title||(e.title=!1),e.content||(e.content=!1),e.scrollToPreviousElement||(e.scrollToPreviousElement=!1),e.buttons||(e.buttons={}),e.confirmButton){if(e.confirm?(e.buttons[e.confirmButton]=e.confirm,delete e.confirm):e.buttons[e.confirmButton]=function(){},e.keyboardEnabled){var t=e.buttons[e.confirmButton];e.buttons[e.confirmButton]={action:t,keys:["enter"]}}delete e.confirmButton}if(e.cancelButton){if(e.cancel?(e.buttons[e.cancelButton]=e.cancel,delete e.cancel):e.buttons[e.cancelButton]=function(){},e.keyboardEnabled){t=e.buttons[e.cancelButton];e.buttons[e.cancelButton]={action:t,keys:["esc"]}}delete e.cancelButton}if(e.keyboardEnabled&&delete e.keyboardEnabled,e.prompt){var i,n=e.prompt.formClass||"prompt-form",a=e.prompt.onSubmit||alert("missing onSubmit function in prompt opts!"),r="geni-prompt-"+(Math.random()+"").slice(2),s="form-"+r;e.content||(e.content='<form id="'+s+'" data-onsubmit="return false" data-nonce="'+Geni.CSPNonce+'" class="'+n+'">',e.content+='<div class="prompt-form-group">',e.content+=Geni.promptConfigToOpts(r,e.prompt),e.content+="</div></form>",e.content+=Geni.promptScriptReady(s)),i=e.prompt.inputs?function(){var e=this.$content.find("#form-"+r),t=jQuery(e).serializeObject();a(t)}:function(){var e,t=this.$content.find(".prompt-form-input");e="checkbox"===t.prop("type")?t.prop("checked"):t.val(),a(e)},e.buttons.formSubmit={text:e.prompt.button||trl("Submit"),btnClass:"btn-submit "+(e.prompt.buttonClass||"btn-blue"),action:i,keys:["enter"]},delete e.prompt}e.rtl=Geni.RTL,jQuery.confirm(e)},promptConfigToOpts(e,t){var i,n="",a=!1;return(i=t.inputs?t.inputs:[{type:t.type,message:t.message,placeholder:t.placeholder}]).forEach(function(e){e.focus&&(a=!0)}),i.forEach(function(t,i){var r=e+"-"+i,s=t.name||r,o=t["class"]||"";switch((t.focus||!a&&!t["default"])&&(o+=" set-focus",a=!0),t.type){case"checkbox":var l="checked"==t["default"]?"checked=checked":"";n+='<input id="'+r+'" type="checkbox" name="'+s+'"'+l+' class="prompt-form-input form-control '+o+'"/>',n+='<label for="'+r+'">'+t.message+"</label>";break;default:var u=t["default"]?'value="'+t["default"]+'"':"";n+='<label for="'+r+'">'+t.message+"</label>",n+='<input id="'+r+'" type="text" name="'+s+'" '+u+' placeholder="'+(t.placeholder||"")+'" class="prompt-form-input form-control '+o+'" />'}}),n},promptScriptReady(e){var t=[];return t.push('<script nonce="'+Geni.CSPNonce+'">'),t.push("  GeniLoader.ready(function() {"),t.push('    jQuery("#'+e+' input.set-focus").focus();'),t.push('    jQuery("#'+e+' input").on("keypress", function(event) {'),t.push("      if (event.code == 'Enter') {"),t.push("        event.stopPropagation();"),t.push("        event.preventDefault();"),t.push('        jQuery("#'+e+'").closest(".jconfirm-box-container").find("button.btn-submit").trigger("click");'),t.push("      }"),t.push("    });"),t.push("  });"),t.push("</script>"),t.join("\n")},removePlaceholder(e){var t=asElement(e);t.value==t.getAttribute("placeholder")&&t.removeAttribute("placeholder")},provide:function(e,t){for(var i=window.Geni,n=e?e.split("."):[],a=n.length,r=0;r<a;r++){var s=i[n[r]];s||(s=t&&r+1==a?t:{},i[n[r]]=s),i=s}return i},inherits:function(e,t){var i;i=function(){return e.apply(this,arguments)},Object.assign(i,e);var n=function(){};return n.prototype=e.prototype,i.prototype=new n,t&&Object.assign(i.prototype,t),Object.assign(i,e.prototype),i.prototype.constructor=i,i.__super__=e.prototype,i},evalScripts:function(jquery_selector){for(var el=jQuery(jquery_selector),arr=el.find("script"),n=0;n<arr.length;n++)eval(arr[n].innerHTML)},reinitializeCaptcha:function(e){var t=jQuery(e+" .g-recaptcha");t.length>0&&(t.html(""),this.appendCaptchaJS(e))},appendCaptchaJS:function(e){if(jQuery(e).length>0){var t=document.createElement("script");t.async=1,t.setAttribute("nonce",Geni.CSPNonce),t.src="https://www.google.com/recaptcha/api.js",jQuery(e)[0].appendChild(t)}},checkPasswordStrength:function(e){var t={};return t.length=e.length>=Geni.pwMinLength,t.lower=!!e.match(/[a-z]/),t.upper=!!e.match(/[A-Z]/),t.number=!!e.match(/[0-9]/),t.symbol=!!e.match(/[^a-zA-Z0-9]/),t},decoratePasswordStrength:function(e){var t=Geni.checkPasswordStrength(e);Object.keys(t).forEach(function(e){var i="span.pw-"+e;t[e]?jQuery(i).addClass("pw-strength-pass").html("check_box"):jQuery(i).removeClass("pw-strength-pass").html("check_box_outline_blank")})},comparePasswordConfirmation:function(e,t){e==t?(jQuery(".pw-compare-confirm").show(),jQuery(".pw-compare-noconfirm").hide()):(jQuery(".pw-compare-confirm").hide(),jQuery(".pw-compare-noconfirm").show())},passwordVisibility:function(e){var t=jQuery(e),i=t.prev("input");"password"==i.attr("type")?(i.attr("type","text"),t.html("visibility_off")):(i.attr("type","password"),t.html("visibility"))},currentURL:function(){return document.location.href},modifyAddressBar:function(e={}){finalURL=this.currentURL(),e.remove&&e.remove.forEach(function(e){finalURL=finalURL.replace(e,"")}),finalURL.endsWith("?")&&(finalURL=finalURL.substr(0,finalURL.length-1)),window.history.replaceState(null,document.title,finalURL)},logError:function(e){var t={},i=e.error,n=e.callstack,a=e.once;if(arguments[0].stack&&(i=arguments[0]),void 0!==i&&(t.exception_class=i.name,t.message=i.message,t.backtrace=this.sanitizeStackTrace(i.stack)),"undefined"!=typeof e.message&&(t.message=e.message),!0===n?t.backtrace=this.sanitizeStackTrace((new Error).stack):void 0!==n&&(t.backtrace=n),!0===a){if(this._loggedErrors||(this._loggedErrors={}),this._loggedErrors[message])return;this._loggedErrors[message]=!0}var r=new XMLHttpRequest;return r.open("POST","/flash/store_exception",!0),r.setRequestHeader("Content-type","application/json"),r.send(JSON.stringify({exception:t})),r},sanitizeStackTrace:function(e){return e?e.split("\n").splice(1).join("\n").trim():""},inViewport:function(e){var t=e.getBoundingClientRect();return t.top>=0&&t.bottom<=window.innerHeight||t.top<window.innerHeight&&t.bottom>=0&&"partial"},onVisibleOrHidden:function(e,t,i){var n=jQuery(e);if(n.is(i)&&this.inViewport(e))t(e);else if("function"==typeof IntersectionObserver){(a=new IntersectionObserver(function(a){!0===a[0].isIntersecting&&n.is(i)&&t(e)},{})).observe(e,{childList:!0})}else if("function"==typeof MutationObserver){var a=new MutationObserver(function(){n.is(i)&&this.inViewport(e)&&t(e)});":visible"==i&&"none"==n.css("display")||":hidden"==i&&"none"!=n.css("display")?a.observe(e,{childList:!0,attributes:!0}):n.parents().each(function(e,t){return!(":visible"==i&&"none"==jQuery(t).css("display")||":hidden"==i&&"none"!=jQuery(t).css("display"))||(a.observe(t,{childList:!0,attributes:!0}),!1)})}},onVisible:function(e,t){this.onVisibleOrHidden(e,t,":visible")},onHidden:function(e,t){this.onVisibleOrHidden(e,t,":hidden")}}),Geni.Events={observe:function(e,t){return this._callbacks||(this._callbacks={}),(this._callbacks[e]||(this._callbacks[e]=[])).push(t),this},stopObserving:function(e,t){var i,n;if(i=this._callbacks)if(t){if(!(n=i[e]))return this;li.each(function(e,i){throw t===e&&n.splice(i,1),$break})}else i[e]=[];return this},fire:function(e){var t,i;if(!(i=this._callbacks))return this;if(t=i[e]){var n=Array.prototype.slice.call(arguments,1);t.each(function(e){e.apply(this,n)})}return this}},Object.assign(Geni,Geni.Events),Geni.Controller=function(){this.delegateEvents(),this.delegateRoutes(),Geni.History?Geni.History.observe("hashchange",this.checkRoutes.bind(this)):jQuery(window).on("hashchange",this.checkRoutes.bind(this)),this.initialize.apply(this,arguments)},Geni.Controller.prototype={route_handlers:[],event_handlers:[],change_handlers:[],initialize:function(){},delegateEvents:function(e){if(e||(e=this.events))for(var t in e){var i=e[t],n=t.match(/^(\w+)\s*(.*)$/),a=n[1],r=n[2],s="string"==typeof i?this[i].bind(this):i;"change"==a?(jQuery(r).on("change",s),this.change_handlers.push([r,s])):this.event_handlers.push(jQuery(this.element||document.body).on(a,r,s))}},delegateRoutes:function(e){if(e||(e=this.routes)){for(var t in Geni.logError({message:"delegateRoutes called from: "+jQuery("body").attr("class"),callStack:!0,once:!0}),e){var i=e[t];this.route(t,this[i].bind(this))}Geni.History&&!Geni.History.polling&&Geni.History.start()}},route:function(e,t){e=this._routeToRegExp(e),this.route_handlers.push({route:e,callback:t})},checkRoutes:function(){Geni.logError({message:"checkRoutes called from: "+jQuery("body").attr("class"),callStack:!0,once:!0});var e=Geni.History.getHash();return this.route_handlers.any(function(t){if(t.route.test(e)){var i=this._extractParameters(t.route,e);return t.callback.apply(this,i),!0}}.bind(this))},destroy:function(){this.event_handlers.forEach(function(e){e.off()}),this.change_handlers.each(function(e){jQuery(e[0]).off("change",e[1])}.bind(this)),this.route_handlers=[]},_routeToRegExp:function(e){return e=e.replace(/:([\w\d]+)/g,"([^/]*)").replace(/\*([\w\d]+)/g,"(.*?)"),new RegExp("^"+e+"$")},_extractParameters:function(e,t){return e.exec(t).slice(1)}},Object.assign(Geni.Controller.prototype,Geni.Events),Geni.Controller.extend=function(e){var t=Geni.inherits(this,e);return t.extend=this.extend,t},Geni.History=function(){this.hash=this.getHash()},Geni.History.prototype={interval:100,getHash:function(e){return(e||window.location).hash.replace(/^#*/,"")},start:function(){return jQuery(window).on("hashchange",this.checkUrl.bind(this)),this.checkUrl()},checkUrl:function(e){var t=this.getHash();if(t==this.hash&&this.iframe&&(t=this.getHash(this.iframe.location)),t==this.hash||t==decodeURIComponent(this.hash))return!1;this.iframe&&(window.location.hash=this.iframe.location.hash=t),this.fire("hashchange",e)}};try{Object.assign(Geni.History.prototype,Geni.Events),Geni.History=new Geni.History}catch(e){}Geni.ajaxSubmit=function(e,t){(e=jQuery(e)).find('input[name="'+Geni.AuthenticityParam+'"]').length||e.append('<input type="hidden" name="'+Geni.AuthenticityParam+'" value="'+Geni.AuthenticityToken+'"/>'),t.data=t.parameters||e.serialize(),new Geni.Request(e.prop("action"),t)},Geni.sendRequest=function(e,t){return new Geni.Request(e,t),!1},Geni.Request=function(e,t){return this.url=e,this.options=t||{},"object"!=typeof this.url||Object.keys(this.options).some(e=>this.options.hasOwnProperty(e))||(this.options=this.url,this.url=this.options.url,delete this.options.url),this.options.data=this.options.data||this.options.parameters||{},this.options.method=this.options.method||"post",this.options.headers=this.options.headers||this.options.requestHeaders||{},"get"!=this.options.method.toLowerCase&&(this.options.data[Geni.AuthenticityParam]=Geni.AuthenticityToken),this.start()},Geni.Request.prototype={start:function(){return jQuery.ajax(this.url,this.options).done(this.onSuccess.bind(this)).fail(this.onFailure.bind(this)).always(this.onDone.bind(this))},onSuccess:function(e,t,i){this.options.onSuccess&&this.options.onSuccess(i)},onFailure:function(e){this.options.onFailure&&this.options.onFailure(e)},onDone:function(e,t,i){this.options.onComplete&&("string"==typeof i?(jqXHR=e,errorThrown=i):(data=e,jqXHR=i),this.options.onComplete(jqXHR))}},Geni.JsonxRequest=function(e,t){t||(t={});var i=t.headers||t.requestHeaders||{},n=i.Accept||"*/*";return i.Accept=n+", application/x-geni-jsonx",t.headers=i,new Geni.Request(e,t)},Geni.update=function(e,t,i){return new Geni.Updater(e,t,i),!1},Geni.confirmAndUpdate=function(e,t,i,n){confirm(e)&&Geni.Update(t,i,n)},Geni.Updater=function(e,t,i){this.container=e==document?"document":e,this.url=t,this.options=i||{},this.saveBody=null,this.options.data=this.options.data||this.options.parameters||{},this.options.method=this.options.method||"post",this.options.headers=this.options.headers||this.options.requestHeaders||{},"get"!=this.options.method.toLowerCase&&(this.options.data[Geni.AuthenticityParam]=Geni.AuthenticityToken),this.start()},Geni.Updater.prototype={start:function(){this.options.spinner&&Geni.Site.SpinnerTag&&(this.saveBody=jQuery(this.container).html(),jQuery(this.container).html(Geni.Site.SpinnerTag)),jQuery.ajax(this.url,this.options).done(this.onSuccess.bind(this)).fail(this.onFailure.bind(this)).always(this.onDone.bind(this))},onSuccess:function(e,t,i){var n=0,a=0,r=jQuery(this.container);if("document"==this.container)return document.open("text/html","replace"),document.write(e),document.close(),void documentReady();if(this.options.insertion){var s=$j("<div></div>");switch(s.css("display","inline"),this.options.insertion){case"before":s.insertBefore(r);break;case"after":s.insertAfter(r);default:console.log("Unknown insertion mode: ",this.options.insertion),s=r}r=s}this.options.fade?("number"==typeof this.options.fade?(n=this.options.fade,a=this.options.fade):(n=this.options.fade[0],a=this.options.fade[1]),r.fadeOut(n,function(){r.length>0&&(r[0].innerHTML=e),r.fadeIn(a)})):r.length>0&&(r[0].innerHTML=e),this.saveBody=null,this.options.evalScripts&&Geni.evalScripts(r),this.options.onSuccess&&this.options.onSuccess(i)},onFailure:function(e){this.saveBody&&(jQuery(this.container).html(this.saveBody),this.saveBody=null),this.options.onFailure&&this.options.onFailure(e)},onDone:function(e,t,i){this.options.onComplete&&("string"==typeof i?(jqXHR=e,errorThrown=i):(data=e,jqXHR=i),this.options.onComplete(jqXHR))}},Geni.PeriodicalUpdater=function(e,t,i){this.container=e,this.url=t,this.options=i||{},this.bindWindowEvents(),this.start()},Geni.PeriodicalUpdater.prototype={bindWindowEvents:function(){jQuery(window).on("blur",this.stop.bind(this)),jQuery(window).on("focus",this.start.bind(this))},start:function(){this.onTimeout()},stop:function(){clearTimeout(this.timer)},updateComplete:function(e){this.options.decay&&e==this.lastText?this.timeout+=1e3*this.options.decay:(this.timeout=1e3*this.options.frequency,this.lastText=e,jQuery(this.container).html(e)),this.timer=setTimeout(this.onTimeout.bind(this),this.timeout)},onTimeout:function(){jQuery.ajax(this.url,this.options).done(this.updateComplete.bind(this))}},Geni.scrollTo=function(e,t){t||(t={});var i=t.adjustment||t.offset||0;jQuery("html,body").animate({scrollTop:jQuery(e).offset().top+i})},Geni.showCaptchaIncomplete=function(){jQuery(".g-recaptcha").each(function(e,t){var i=jQuery(t).find(".geni-incomplete");if(0==i.length){var n=document.createElement("div");n.classList.add("geni-incomplete"),n.innerHTML="*"+trl("This checkbox is required"),t.appendChild(n)}i.show()})},Geni.hideCaptchaIncomplete=function(){jQuery(".g-recaptcha .geni-incomplete").hide()},Geni.showPageSpinner=function(){if(jQuery(".outro").length>0)jQuery(".outro").fadeIn(150);else{var e=document.body,t=document.documentElement,i=document.createElement("div"),n=document.createElement("div");i.className="outro",n.className="spinner",i.appendChild(n),e.appendChild(i),i.style.height=Math.max(e.scrollHeight,e.offsetHeight,t.clientHeight,t.scrollHeight,t.offsetHeight)+"px",n.style.top=(t.scrollTop||e.scrollTop)+window.innerHeight/2-60+"px",jQuery(".outro").mousedown(function(e){3!=e.which&&2!=e.which||jQuery(".outro").fadeOut(20)})}},Geni.hidePageSpinner=function(){jQuery(".outro").length>0&&jQuery(".outro").fadeOut(150)},Geni.beforeunload=function(){Geni.outro&&Geni.showPageSpinner()},Geni.saveOutro=null,Geni.suspendOutro=function(){null==Geni.saveOutro&&(Geni.saveOutro=Geni.outro),Geni.outro=!1},Geni.restoreOutro=function(){Geni.outro=Geni.saveOutro,Geni.saveOutro=null},Geni.bindSkipOutro=function(e){e?e.parentNode&&(e=e.parentNode):e=document,GeniLoader.ready(function(){e.querySelectorAll("[data-skip-outro]").forEach(function(e){e.addEventListener("click",function(){Geni.suspendOutro(),setTimeout(Geni.restoreOutro,500)})})})},GeniLoader.ready(function(){window.addEventListener("beforeunload",Geni.beforeunload),Geni.bindSkipOutro(document),window.CSPDomObserver=new MutationObserver(function(e){e.reduce(function(e,t){return t.addedNodes.length>0&&t.addedNodes.forEach(function(t){1==t.nodeType&&e.add(t)}),e},new Set).forEach(function(e){Geni.bindSkipOutro(e)})})}),String.prototype.blank||(String.prototype.blank=function(){return/^\s*$/.test(this)}),Geni.log=function(...e){Geni.reportJSExceptions&&(Geni.debugLog=Geni.debugLog||[],Geni.debugLog.push(e))},window.onerror=function(e,t,i,n,a){if(Geni.reportJSExceptions){if(a||(a=new Error),Geni.ignoreJSExceptionMatches){if(Geni.ignoreJSExceptionMatches.some(function(t){var i=new RegExp(t,"im");return!(!e||!e.match(i))||!(!a.stack||!a.stack.match(i))}))return}var r={"window.screen.height":window.screen.height,"window.screen.width":window.screen.width,"navigator.userAgent":navigator.userAgent,"geni.loader.log":GeniLoader.debugLog,"geni.log":Geni.debugLog},s={msg:e,page:window.location.href,url:t,line:i,col:n,environment:r,stack:a.stack};new Geni.Request("/error/log_js_exception",{data:s}),GeniLoader.debugLog=null,Geni.debugLog=null}},Geni.util={calculate_time_zone:function(){var e=new Date,t=new Date(e.getFullYear(),0,1,0,0,0,0),i=new Date(e.getFullYear(),6,1,0,0,0,0),n=t.toGMTString(),a=new Date(n.substring(0,n.lastIndexOf(" ")-1));n=i.toGMTString();var r=(t-a)/36e5,s=(i-new Date(n.substring(0,n.lastIndexOf(" ")-1)))/36e5;r==s||r-s>=0&&(r=s);return 60*r},diacritics_map:{"\u24b6":"A","\uff21":"A","\xc0":"A","\xc1":"A","\xc2":"A","\u1ea6":"A","\u1ea4":"A","\u1eaa":"A","\u1ea8":"A","\xc3":"A","\u0100":"A","\u0102":"A","\u1eb0":"A","\u1eae":"A","\u1eb4":"A","\u1eb2":"A","\u0226":"A","\u01e0":"A","\xc4":"A","\u01de":"A","\u1ea2":"A","\xc5":"A","\u01fa":"A","\u01cd":"A","\u0200":"A","\u0202":"A","\u1ea0":"A","\u1eac":"A","\u1eb6":"A","\u1e00":"A","\u0104":"A","\u023a":"A","\u2c6f":"A","\ua732":"AA","\xc6":"AE","\u01fc":"AE","\u01e2":"AE","\ua734":"AO","\ua736":"AU","\ua738":"AV","\ua73a":"AV","\ua73c":"AY","\u24b7":"B","\uff22":"B","\u1e02":"B","\u1e04":"B","\u1e06":"B","\u0243":"B","\u0182":"B","\u0181":"B","\u24b8":"C","\uff23":"C","\u0106":"C","\u0108":"C","\u010a":"C","\u010c":"C","\xc7":"C","\u1e08":"C","\u0187":"C","\u023b":"C","\ua73e":"C","\u24b9":"D","\uff24":"D","\u1e0a":"D","\u010e":"D","\u1e0c":"D","\u1e10":"D","\u1e12":"D","\u1e0e":"D","\u0110":"D","\u018b":"D","\u018a":"D","\u0189":"D","\ua779":"D","\u01f1":"DZ","\u01c4":"DZ","\u01f2":"Dz","\u01c5":"Dz","\u24ba":"E","\uff25":"E","\xc8":"E","\xc9":"E","\xca":"E","\u1ec0":"E","\u1ebe":"E","\u1ec4":"E","\u1ec2":"E","\u1ebc":"E","\u0112":"E",
"\u1e14":"E","\u1e16":"E","\u0114":"E","\u0116":"E","\xcb":"E","\u1eba":"E","\u011a":"E","\u0204":"E","\u0206":"E","\u1eb8":"E","\u1ec6":"E","\u0228":"E","\u1e1c":"E","\u0118":"E","\u1e18":"E","\u1e1a":"E","\u0190":"E","\u018e":"E","\u24bb":"F","\uff26":"F","\u1e1e":"F","\u0191":"F","\ua77b":"F","\u24bc":"G","\uff27":"G","\u01f4":"G","\u011c":"G","\u1e20":"G","\u011e":"G","\u0120":"G","\u01e6":"G","\u0122":"G","\u01e4":"G","\u0193":"G","\ua7a0":"G","\ua77d":"G","\ua77e":"G","\u24bd":"H","\uff28":"H","\u0124":"H","\u1e22":"H","\u1e26":"H","\u021e":"H","\u1e24":"H","\u1e28":"H","\u1e2a":"H","\u0126":"H","\u2c67":"H","\u2c75":"H","\ua78d":"H","\u24be":"I","\uff29":"I","\xcc":"I","\xcd":"I","\xce":"I","\u0128":"I","\u012a":"I","\u012c":"I","\u0130":"I","\xcf":"I","\u1e2e":"I","\u1ec8":"I","\u01cf":"I","\u0208":"I","\u020a":"I","\u1eca":"I","\u012e":"I","\u1e2c":"I","\u0197":"I","\u24bf":"J","\uff2a":"J","\u0134":"J","\u0248":"J","\u24c0":"K","\uff2b":"K","\u1e30":"K","\u01e8":"K","\u1e32":"K","\u0136":"K","\u1e34":"K","\u0198":"K","\u2c69":"K","\ua740":"K","\ua742":"K","\ua744":"K","\ua7a2":"K","\u24c1":"L","\uff2c":"L","\u013f":"L","\u0139":"L","\u013d":"L","\u1e36":"L","\u1e38":"L","\u013b":"L","\u1e3c":"L","\u1e3a":"L","\u0141":"L","\u023d":"L","\u2c62":"L","\u2c60":"L","\ua748":"L","\ua746":"L","\ua780":"L","\u01c7":"LJ","\u01c8":"Lj","\u24c2":"M","\uff2d":"M","\u1e3e":"M","\u1e40":"M","\u1e42":"M","\u2c6e":"M","\u019c":"M","\u24c3":"N","\uff2e":"N","\u01f8":"N","\u0143":"N","\xd1":"N","\u1e44":"N","\u0147":"N","\u1e46":"N","\u0145":"N","\u1e4a":"N","\u1e48":"N","\u0220":"N","\u019d":"N","\ua790":"N","\ua7a4":"N","\u01ca":"NJ","\u01cb":"Nj","\u24c4":"O","\uff2f":"O","\xd2":"O","\xd3":"O","\xd4":"O","\u1ed2":"O","\u1ed0":"O","\u1ed6":"O","\u1ed4":"O","\xd5":"O","\u1e4c":"O","\u022c":"O","\u1e4e":"O","\u014c":"O","\u1e50":"O","\u1e52":"O","\u014e":"O","\u022e":"O","\u0230":"O","\xd6":"O","\u022a":"O","\u1ece":"O","\u0150":"O","\u01d1":"O","\u020c":"O","\u020e":"O","\u01a0":"O","\u1edc":"O","\u1eda":"O","\u1ee0":"O","\u1ede":"O","\u1ee2":"O","\u1ecc":"O","\u1ed8":"O","\u01ea":"O","\u01ec":"O","\xd8":"O","\u01fe":"O","\u0186":"O","\u019f":"O","\ua74a":"O","\ua74c":"O","\u0152":"OE","\u01a2":"OI","\ua74e":"OO","\u0222":"OU","\u24c5":"P","\uff30":"P","\u1e54":"P","\u1e56":"P","\u01a4":"P","\u2c63":"P","\ua750":"P","\ua752":"P","\ua754":"P","\u24c6":"Q","\uff31":"Q","\ua756":"Q","\ua758":"Q","\u024a":"Q","\u24c7":"R","\uff32":"R","\u0154":"R","\u1e58":"R","\u0158":"R","\u0210":"R","\u0212":"R","\u1e5a":"R","\u1e5c":"R","\u0156":"R","\u1e5e":"R","\u024c":"R","\u2c64":"R","\ua75a":"R","\ua7a6":"R","\ua782":"R","\u24c8":"S","\uff33":"S","\u015a":"S","\u1e64":"S","\u015c":"S","\u1e60":"S","\u0160":"S","\u1e66":"S","\u1e62":"S","\u1e68":"S","\u0218":"S","\u015e":"S","\u2c7e":"S","\ua7a8":"S","\ua784":"S","\u1e9e":"SS","\u24c9":"T","\uff34":"T","\u1e6a":"T","\u0164":"T","\u1e6c":"T","\u021a":"T","\u0162":"T","\u1e70":"T","\u1e6e":"T","\u0166":"T","\u01ac":"T","\u01ae":"T","\u023e":"T","\ua786":"T","\ua728":"TZ","\u24ca":"U","\uff35":"U","\xd9":"U","\xda":"U","\xdb":"U","\u0168":"U","\u1e78":"U","\u016a":"U","\u1e7a":"U","\u016c":"U","\xdc":"U","\u01db":"U","\u01d7":"U","\u01d5":"U","\u01d9":"U","\u1ee6":"U","\u016e":"U","\u0170":"U","\u01d3":"U","\u0214":"U","\u0216":"U","\u01af":"U","\u1eea":"U","\u1ee8":"U","\u1eee":"U","\u1eec":"U","\u1ef0":"U","\u1ee4":"U","\u1e72":"U","\u0172":"U","\u1e76":"U","\u1e74":"U","\u0244":"U","\u24cb":"V","\uff36":"V","\u1e7c":"V","\u1e7e":"V","\u01b2":"V","\ua75e":"V","\u0245":"V","\ua760":"VY","\u24cc":"W","\uff37":"W","\u1e80":"W","\u1e82":"W","\u0174":"W","\u1e86":"W","\u1e84":"W","\u1e88":"W","\u2c72":"W","\u24cd":"X","\uff38":"X","\u1e8a":"X","\u1e8c":"X","\u24ce":"Y","\uff39":"Y","\u1ef2":"Y","\xdd":"Y","\u0176":"Y","\u1ef8":"Y","\u0232":"Y","\u1e8e":"Y","\u0178":"Y","\u1ef6":"Y","\u1ef4":"Y","\u01b3":"Y","\u024e":"Y","\u1efe":"Y","\u24cf":"Z","\uff3a":"Z","\u0179":"Z","\u1e90":"Z","\u017b":"Z","\u017d":"Z","\u1e92":"Z","\u1e94":"Z","\u01b5":"Z","\u0224":"Z","\u2c7f":"Z","\u2c6b":"Z","\ua762":"Z","\u24d0":"a","\uff41":"a","\u1e9a":"a","\xe0":"a","\xe1":"a","\xe2":"a","\u1ea7":"a","\u1ea5":"a","\u1eab":"a","\u1ea9":"a","\xe3":"a","\u0101":"a","\u0103":"a","\u1eb1":"a","\u1eaf":"a","\u1eb5":"a","\u1eb3":"a","\u0227":"a","\u01e1":"a","\xe4":"a","\u01df":"a","\u1ea3":"a","\xe5":"a","\u01fb":"a","\u01ce":"a","\u0201":"a","\u0203":"a","\u1ea1":"a","\u1ead":"a","\u1eb7":"a","\u1e01":"a","\u0105":"a","\u2c65":"a","\u0250":"a","\ua733":"aa","\xe6":"ae","\u01fd":"ae","\u01e3":"ae","\ua735":"ao","\ua737":"au","\ua739":"av","\ua73b":"av","\ua73d":"ay","\u24d1":"b","\uff42":"b","\u1e03":"b","\u1e05":"b","\u1e07":"b","\u0180":"b","\u0183":"b","\u0253":"b","\u24d2":"c","\uff43":"c","\u0107":"c","\u0109":"c","\u010b":"c","\u010d":"c","\xe7":"c","\u1e09":"c","\u0188":"c","\u023c":"c","\ua73f":"c","\u2184":"c","\u24d3":"d","\uff44":"d","\u1e0b":"d","\u010f":"d","\u1e0d":"d","\u1e11":"d","\u1e13":"d","\u1e0f":"d","\u0111":"d","\u018c":"d","\u0256":"d","\u0257":"d","\ua77a":"d","\u01f3":"dz","\u01c6":"dz","\u24d4":"e","\uff45":"e","\xe8":"e","\xe9":"e","\xea":"e","\u1ec1":"e","\u1ebf":"e","\u1ec5":"e","\u1ec3":"e","\u1ebd":"e","\u0113":"e","\u1e15":"e","\u1e17":"e","\u0115":"e","\u0117":"e","\xeb":"e","\u1ebb":"e","\u011b":"e","\u0205":"e","\u0207":"e","\u1eb9":"e","\u1ec7":"e","\u0229":"e","\u1e1d":"e","\u0119":"e","\u1e19":"e","\u1e1b":"e","\u0247":"e","\u025b":"e","\u01dd":"e","\u24d5":"f","\uff46":"f","\u1e1f":"f","\u0192":"f","\ua77c":"f","\u24d6":"g","\uff47":"g","\u01f5":"g","\u011d":"g","\u1e21":"g","\u011f":"g","\u0121":"g","\u01e7":"g","\u0123":"g","\u01e5":"g","\u0260":"g","\ua7a1":"g","\u1d79":"g","\ua77f":"g","\u24d7":"h","\uff48":"h","\u0125":"h","\u1e23":"h","\u1e27":"h","\u021f":"h","\u1e25":"h","\u1e29":"h","\u1e2b":"h","\u1e96":"h","\u0127":"h","\u2c68":"h","\u2c76":"h","\u0265":"h","\u0195":"hv","\u24d8":"i","\uff49":"i","\xec":"i","\xed":"i","\xee":"i","\u0129":"i","\u012b":"i","\u012d":"i","\xef":"i","\u1e2f":"i","\u1ec9":"i","\u01d0":"i","\u0209":"i","\u020b":"i","\u1ecb":"i","\u012f":"i","\u1e2d":"i","\u0268":"i","\u0131":"i","\u24d9":"j","\uff4a":"j","\u0135":"j","\u01f0":"j","\u0249":"j","\u24da":"k","\uff4b":"k","\u1e31":"k","\u01e9":"k","\u1e33":"k","\u0137":"k","\u1e35":"k","\u0199":"k","\u2c6a":"k","\ua741":"k","\ua743":"k","\ua745":"k","\ua7a3":"k","\u24db":"l","\uff4c":"l","\u0140":"l","\u013a":"l","\u013e":"l","\u1e37":"l","\u1e39":"l","\u013c":"l","\u1e3d":"l","\u1e3b":"l","\u0142":"l","\u019a":"l","\u026b":"l","\u2c61":"l","\ua749":"l","\ua781":"l","\ua747":"l","\u01c9":"lj","\u24dc":"m","\uff4d":"m","\u1e3f":"m","\u1e41":"m","\u1e43":"m","\u0271":"m","\u026f":"m","\u24dd":"n","\uff4e":"n","\u01f9":"n","\u0144":"n","\xf1":"n","\u1e45":"n","\u0148":"n","\u1e47":"n","\u0146":"n","\u1e4b":"n","\u1e49":"n","\u019e":"n","\u0272":"n","\u0149":"n","\ua791":"n","\ua7a5":"n","\u01cc":"nj","\u24de":"o","\uff4f":"o","\xf2":"o","\xf3":"o","\xf4":"o","\u1ed3":"o","\u1ed1":"o","\u1ed7":"o","\u1ed5":"o","\xf5":"o","\u1e4d":"o","\u022d":"o","\u1e4f":"o","\u014d":"o","\u1e51":"o","\u1e53":"o","\u014f":"o","\u022f":"o","\u0231":"o","\xf6":"o","\u022b":"o","\u1ecf":"o","\u0151":"o","\u01d2":"o","\u020d":"o","\u020f":"o","\u01a1":"o","\u1edd":"o","\u1edb":"o","\u1ee1":"o","\u1edf":"o","\u1ee3":"o","\u1ecd":"o","\u1ed9":"o","\u01eb":"o","\u01ed":"o","\xf8":"o","\u01ff":"o","\u0254":"o","\ua74b":"o","\ua74d":"o","\u0275":"o","\u0153":"oe","\u0276":"oe","\u01a3":"oi","\u0223":"ou","\ua74f":"oo","\u24df":"p","\uff50":"p","\u1e55":"p","\u1e57":"p","\u01a5":"p","\u1d7d":"p","\ua751":"p","\ua753":"p","\ua755":"p","\u24e0":"q","\uff51":"q","\u024b":"q","\ua757":"q","\ua759":"q","\u24e1":"r","\uff52":"r","\u0155":"r","\u1e59":"r","\u0159":"r","\u0211":"r","\u0213":"r","\u1e5b":"r","\u1e5d":"r","\u0157":"r","\u1e5f":"r","\u024d":"r","\u027d":"r","\ua75b":"r","\ua7a7":"r","\ua783":"r","\u24e2":"s","\uff53":"s","\u015b":"s","\u1e65":"s","\u015d":"s","\u1e61":"s","\u0161":"s","\u1e67":"s","\u1e63":"s","\u1e69":"s","\u0219":"s","\u015f":"s","\u023f":"s","\ua7a9":"s","\ua785":"s","\u017f":"s","\u1e9b":"s","\xdf":"ss","\u24e3":"t","\uff54":"t","\u1e6b":"t","\u1e97":"t","\u0165":"t","\u1e6d":"t","\u021b":"t","\u0163":"t","\u1e71":"t","\u1e6f":"t","\u0167":"t","\u01ad":"t","\u0288":"t","\u2c66":"t","\ua787":"t","\ua729":"tz","\u24e4":"u","\uff55":"u","\xf9":"u","\xfa":"u","\xfb":"u","\u0169":"u","\u1e79":"u","\u016b":"u","\u1e7b":"u","\u016d":"u","\xfc":"u","\u01dc":"u","\u01d8":"u","\u01d6":"u","\u01da":"u","\u1ee7":"u","\u016f":"u","\u0171":"u","\u01d4":"u","\u0215":"u","\u0217":"u","\u01b0":"u","\u1eeb":"u","\u1ee9":"u","\u1eef":"u","\u1eed":"u","\u1ef1":"u","\u1ee5":"u","\u1e73":"u","\u0173":"u","\u1e77":"u","\u1e75":"u","\u0289":"u","\u24e5":"v","\uff56":"v","\u1e7d":"v","\u1e7f":"v","\u028b":"v","\ua75f":"v","\u028c":"v","\ua761":"vy","\u24e6":"w","\uff57":"w","\u1e81":"w","\u1e83":"w","\u0175":"w","\u1e87":"w","\u1e85":"w","\u1e98":"w","\u1e89":"w","\u2c73":"w","\u24e7":"x","\uff58":"x","\u1e8b":"x","\u1e8d":"x","\u24e8":"y","\uff59":"y","\u1ef3":"y","\xfd":"y","\u0177":"y","\u1ef9":"y","\u0233":"y","\u1e8f":"y","\xff":"y","\u1ef7":"y","\u1e99":"y","\u1ef5":"y","\u01b4":"y","\u024f":"y","\u1eff":"y","\u24e9":"z","\uff5a":"z","\u017a":"z","\u1e91":"z","\u017c":"z","\u017e":"z","\u1e93":"z","\u1e95":"z","\u01b6":"z","\u0225":"z","\u0240":"z","\u2c6c":"z","\ua763":"z","\uff10":"0","\u2080":"0","\u24ea":"0","\u2070":"0","\xb9":"1","\u2474":"1","\u2081":"1","\u2776":"1","\u24f5":"1","\u2488":"1","\u2460":"1","\uff11":"1","\xb2":"2","\u2777":"2","\u2475":"2","\uff12":"2","\u2082":"2","\u24f6":"2","\u2461":"2","\u2489":"2","\xb3":"3","\uff13":"3","\u248a":"3","\u2476":"3","\u2083":"3","\u2778":"3","\u24f7":"3","\u2462":"3","\u24f8":"4","\u2463":"4","\u248b":"4","\uff14":"4","\u2074":"4","\u2084":"4","\u2779":"4","\u2477":"4","\u248c":"5","\u2085":"5","\u24f9":"5","\u2478":"5","\u277a":"5","\u2464":"5","\uff15":"5","\u2075":"5","\u2479":"6","\u2076":"6","\uff16":"6","\u277b":"6","\u2086":"6","\u2465":"6","\u24fa":"6","\u248d":"6","\uff17":"7","\u2077":"7","\u277c":"7","\u24fb":"7","\u248e":"7","\u2087":"7","\u247a":"7","\u2466":"7","\u2467":"8","\u248f":"8","\u24fc":"8","\u247b":"8","\u2078":"8","\uff18":"8","\u277d":"8","\u2088":"8","\u24fd":"9","\uff19":"9","\u2490":"9","\u277e":"9","\u247c":"9","\u2089":"9","\u2468":"9","\u2079":"9"},remove_diacritics:function(e){for(var t,i=e.split(""),n=i.length-1,a=!1;n>=0;n--)t=i[n],this.diacritics_map.hasOwnProperty(t)&&(i[n]=this.diacritics_map[t],a=!0);return a&&(e=i.join("")),e},escapeHTML:function(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")},escapeID:function(e){var t="";return 0==e.length?t:(e[0]>="a"&&e[0]<="z"||e[0]>="A"&&e[0]<="Z"||(t+="z"),t+=e.replace(/[^a-zA-Z0-9\:\.\-\_]/g,function(e){return" "==e?"_":"-"+e.charCodeAt(0).toString(16).toUpperCase()}))},truncateNum:(e,t,i)=>(e||(e=0),t||(t=99),i||(i="+"),e>t?t.toString()+i:e),non_english_regex:/([\u00AA\u00B5\u00BA\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u0527\u0531-\u0556\u0559\u0561-\u0587\u05D0-\u05EA\u05F0-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u08A0\u08A2-\u08AC\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0977\u0979-\u097F\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C33\u0C35-\u0C39\u0C3D\u0C58\u0C59\u0C60\u0C61\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D60\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E87\u0E88\u0E8A\u0E8D\u0E94-\u0E97\u0E99-\u0E9F\u0EA1-\u0EA3\u0EA5\u0EA7\u0EAA\u0EAB\u0EAD-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F4\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u1700-\u170C\u170E-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1877\u1880-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191C\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19C1-\u19C7\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4B\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1CE9-\u1CEC\u1CEE-\u1CF1\u1CF5\u1CF6\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2183\u2184\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005\u3006\u3031-\u3035\u303B\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312D\u3131-\u318E\u31A0-\u31BA\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FCC\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA697\uA6A0-\uA6E5\uA717-\uA71F\uA722-\uA788\uA78B-\uA78E\uA790-\uA793\uA7A0-\uA7AA\uA7F8-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA80-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uABC0-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]+)/g,has_non_english_chars:function(e){return!!e.match(this.non_english_regex)},zIndex:function(e){var t=jQuery(e);if(0===t.length||t.is("HTML"))return 0;var i=t.css("zIndex");return""!==i&&"auto"!==i?i:this.zIndex(t.parent())},coordinatesDistanceMeters:function(e,t,i,n){const a=6371e3,r=Math.PI/180;var s=(i-e)*r,o=(n-t)*r,l=Math.sin(s/2)*Math.sin(s/2)+Math.cos(e*r)*Math.cos(i*r)*Math.sin(o/2)*Math.sin(o/2);return a*(2*Math.atan2(Math.sqrt(l),Math.sqrt(1-l)))},coordinatesDistanceMiles:function(e,t,i,n){const a=1609.34;return this.coordinatesDistanceMeters(e,t,i,n)/a}};var LabelMaker=function(e,t,i,n){this.element=jQuery(e),this.element.length&&(""==t&&(t="\xa0"),this.text=t||this.element.val(),this.focus=i||{color:"#000000"},this.blur=n||{color:"#999999"},this.form=this.element.parents("form"),this.isSelect="select"==this.element[0].tagName.toLowerCase(),this.dropping=!1,this.removePreviousBindings(),this.element.on("focus",null,"LabelMaker",this.onFocus.bind(this)),this.element.on("blur",null,"LabelMaker",this.onBlur.bind(this)),this.element.on("drop",null,"LabelMaker",this.onDragDrop.bind(this)),this.element.on("dragenter",null,"LabelMaker",this.onDragDrop.bind(this)),this.element.on("dragleave",null,"LabelMaker",this.onDragDrop.bind(this)),this.isSelect&&this.initSelect(),this.element.attr("label",this.text),this.form[0]&&(this.form[0].haslabels||(this.originalOnSubmit=this.form[0].onsubmit||new Function,this.form[0].onsubmit=this.onSubmit.bind(this),this.form[0].haslabels=!0)),this.onBlur())};LabelMaker.prototype={initSelect:function(){var e=this.element[0];if(!e.options[0].isLabel){var t=e.selectedIndex,i=document.createElement("option");i.value="",i.text=this.text,i.isLabel=!0,e.options.add(i,0),this.element.selectedIndex=t+1,this.removePreviousBindings(),this.element.on("change",null,"LabelMaker",this.onChange.bind(this)),this.element.on("mousedown",null,"LabelMaker",this.onFocus.bind(this))}},removePreviousBindings:function(){var e=this.element;jQuery.each(jQuery._data(e[0],"events"),function(t,i){jQuery.each(i,function(i,n){n&&"LabelMaker"==n.data&&e.off(t,null,n)})})},onFocus:function(){this.isSelect&&this.setBlurStyle(this.element[0].options[0]),this.element.val()==this.text?this.element.val(""):this.dropping?this.dropping=!1:!Geni.isAndroid()&&this.element[0].select&&this.element[0].select(),this.setFocusStyle()},onDragDrop:function(e){"dragenter"==e.type?this.element.val()==this.text&&this.element.val(""):"dragleave"==e.type?""==this.element.val()&&this.element.val(this.text):"drop"==e.type&&(this.dropping=!0,this.setFocusStyle())},onBlur:function(){this.isSelect&&!this.element[0][this.element[0].selectedIndex].value?(this.element[0].selectedIndex=0,this.setBlurStyle()):""!=this.element.val()&&this.element.val()!=this.text||(this.element.val(this.text),this.setBlurStyle())},onChange:function(){this.element[0][this.element[0].selectedIndex].value?this.setFocusStyle():this.element[0].selectedIndex=0},onSubmit:function(){return this.form.find("input[label], select[label], textarea[label]").each(function(e,t){t.value==t.getAttribute("label")&&(t.value="")}),this.originalOnSubmit.bind(this.form[0])()},setFocusStyle:function(e){(e=jQuery(e||this.element)).removeClass(this.blur),"string"==typeof this.focus?e.addClass(this.focus):e.css(this.focus)},setBlurStyle:function(e){(e=jQuery(e||this.element)).removeClass(this.focus),"string"==typeof this.blur?e.addClass(this.blur):e.css(this.blur)}},Object.assign(LabelMaker,{updateField:function(e,t){var i=e.getAttribute("label")||"",n=new LabelMaker(e);n.setFocusStyle(),e.value=t||i,e.setAttribute("label",i),t||n.setBlurStyle()},clearFormLabels:function(e){(e?jQuery(e).find("input[label], select[label], textarea[label]"):jQuery("label.inside-label, input[label], textarea[label], select[label]")).each(function(e,t){t.value==t.getAttribute("label")&&(t.value="")})},init_labels:function(){jQuery("label.inside-label, input[label], textarea[label], select[label]").each(function(e,t){t.tagName&&"label"==t.tagName.toLowerCase()?new LabelMaker(t.htmlFor,t.innerHTML):new LabelMaker(t,t.getAttribute("label"))})}}),GeniLoader.ready(LabelMaker.init_labels);var Effect=Effect||undefined;Panel.prototype={initialize:function(e){return this.captureFormSelector=null,this.capturedFormData=null,this.asyncSubmitResponseCallback=null,this.asyncSubmitResponse=null,this.setOptions(e),this.selectshidden=!1,this.buildElements(),this.bindEventHandlers(),Panel.current=this,this},buildElements:function(){this.buildPanel(),this.buildOverlay(),this.useShim&&this.buildIframeShim()},buildPanel:function(){this.element=asElement(this.panelId),this.element||(this.element=document.createElement("div"),jQuery(this.element).hide(),this.panelId&&(this.element.id=this.panelId)),this.element.panel=this,jQuery(this.element).css({position:"absolute",zIndex:this.zIndex}),this.width&&jQuery(this.element).css({width:this.width}),this.maxWidth&&jQuery(this.element).css({maxWidth:this.maxWidth}),this.height&&jQuery(this.element).css({height:this.height}),this.style&&jQuery(this.element).css(this.style),(this.appendTo||document.body).insertAdjacentElement("afterbegin",this.element)},buildOverlay:function(){this.displayOverlay&&(this.overlay=document.getElementById(this.overlayId),this.overlay||(this.overlay=document.createElement("div"),jQuery(this.overlay).hide(),this.overlayId&&(this.overlay.id=this.overlayId)),jQuery(this.overlay).is(":visible")||jQuery(this.overlay).css({backgroundColor:this.overlayColor,opacity:this.overlayOpacity,position:"fixed",width:"100%",height:"100%",left:0,top:0,zIndex:this.zIndex-1}),document.body.insertAdjacentElement("afterbegin",this.overlay))},buildIframeShim:function(){this.iframe_shim=document.createElement("iframe"),this.iframe_shim.setAttribute("src","about:blank"),this.iframe_shim.setAttribute("data-deny-click",""),jQuery(this.iframe_shim).css({opacity:0,position:"absolute",zIndex:this.zIndex-2}).hide(),document.body.appendChild(this.iframe_shim)},updateContent:function(e){if(this.url)this.loadInfo();else{e=e||this.content;this.element.innerHTML="",e&&(jQuery(e).show(),"object"==typeof e?this.element.appendChild(e):this.element.innerHTML=e),this.element.className=this.panelClass}return this.setPosition(),this.useShim&&this.updateShim(),this.bindFormCapture(),bindInlineEventHandlers(),this},updateShim:function(){setTimeout(function(){this.iframe_shim=jQuery(this.iframe_shim).clone().css({top:jQuery(this.element).css("top"),left:jQuery(this.element).css("left"),width:jQuery(this.element).css("width"),height:jQuery(this.element).css("height")}).show()}.bind(this),1)},clickOut:function(e){e.target==this.element||jQuery(e.target).closest(this.element)||this.excludeFromClickOut&&(e.target==this.excludeFromClickOut||jQuery(e.target).closest(this.excludeFromClickOut))||(document.removeEventListener("mouseup",this.clickout),jQuery(this.element).is(":visible")&&(this.hide(),this.onClickOut&&this.onClickOut(this)))},escapeOut:function(e){if("Escape"==e.code){if(this.excludeFromEscapeOut&&(e.target==this.excludeFromEscapeOut||jQuery(e.target).closest(this.excludeFromEscapeOut)))return;document.removeEventListener("keyup",this.escapeout),jQuery(this.element).is(":visible")&&(this.hide(),this.onEscapeOut&&this.onEscapeOut(this))}},bindEventHandlers:function(){this.enableClickOut&&(this.clickout=this.clickOut.bind(this),document.addEventListener("mouseup",this.clickout)),this.enableEscapeOut&&(this.escapeout=this.escapeOut.bind(this),document.addEventListener("keyup",this.escapeout))},open:function(){return this.hidden||this.updateContent(),this.overlay&&jQuery(this.overlay).show(),this.showPanel(),this.useShim&&this.updateShim(),this.bindEventHandlers(),this.onOpen&&this.onOpen(this),this},close:function(){if(this.hideTooltips(),jQuery(this.element).is(":visible")){if(this.overlay)jQuery(this.overlay).css({zIndex:this.zIndex-1})&&jQuery(this.overlay).hide();return this.closePanel(),this.useShim&&jQuery(this.iframe_shim).hide(),Panel.last_zIndex-=1,this.onClose&&this.onClose(this),this}},hide:function(){if(this.hideTooltips(),this.hidden=!0,jQuery(this.element).is(":visible")){if(this.overlay)jQuery(this.overlay).css({zIndex:this.zIndex-1})&&jQuery(this.overlay).hide();return this.hidePanel(),this.useShim&&jQuery(this.iframe_shim).hide(),Panel.last_zIndex-=1,this.onClose&&this.onClose(this),this}},hideTooltips:function(){Geni.Tipped.hide(jQuery("#"+this.panelId+" .tipped-tip-added"))},toggle:function(){jQuery(this.element).is(":visible")?this.close():this.open()},loadInfo:function(e){this.showLoading&&(this.element.innerHTML=this.loadingText,this.element.className=this.loadingClass),this.showPanel(),this.ajaxOptions=Object.assign({evalScripts:!0,onComplete:function(){this.element.className=this.panelClass,this.showPanel(),this.useShim&&this.updateShim(),this.bindFormCapture(),this.onLoadComplete&&this.onLoadComplete(this)}.bind(this),onFailure:function(t){throw this.close(),this.onLoadFailure&&this.onLoadFailure(this,t),`There was a problem loading content from ${e}.`}.bind(this)},this.ajaxOptions),this.ajaxOptions.parameters===undefined&&(this.ajaxOptions.parameters={}),this.ajaxOptions.parameters[Geni.AuthenticityParam]=Geni.AuthenticityToken,new Geni.Updater(this.element,e||this.url,this.ajaxOptions),this.bindFormCapture()},setPosition:function(){if(this.beforeSetPosition&&this.beforeSetPosition(this),this.positionRelativeTo){this.target=this.positionRelativeTo;var e=this.getCorner(this.target,this.hooks[0]),t=this.getCorner(this.element,this.hooks[1]);if(this.positionRelativeTo.classList.contains("match-width")){var i=jQuery(this.positionRelativeTo).width();jQuery("div.autocomplete_content").css("width",i+"px")}var n=jQuery(this.target).offset(),a=n.left+e.left-t.left+this.offsetX,r=n.top+e.top-t.top+this.offsetY;jQuery(this.element).offset({left:a,top:r}),jQuery(this.element).css("zIndex",5+Geni.util.zIndex(this.positionRelativeTo))}else{var s={width:jQuery(this.element).outerWidth(),height:jQuery(this.element).outerHeight()},o={width:jQuery(window).width(),height:jQuery(window).height()};if(s.width>o.width){var l=this.element.children[0];if(l){var u=l.className;l.className=u.replace(new RegExp("(?:^|\\s)wide-col(?:\\s|$)")," "),l.classList.add("panel-max")}}if((s={width:jQuery(this.element).outerWidth(),height:jQuery(this.element).outerHeight()}).width>o.width){r=s.height/2*-1+this.offsetY+jQuery(window).scrollTop();jQuery(this.element).css({top:"50%",left:"50%",width:"90vw",maxWidth:s.width,marginLeft:a+"px",marginTop:r+"px"})}else{var c={left:jQuery(window).scrollLeft(),top:jQuery(window).scrollTop()};a=s.width/2*-1+this.offsetX+c.left,r=s.height/2*-1+this.offsetY+c.top;s.height>o.height&&(r/=2),jQuery(this.element).css({top:"50%",left:"50%",marginLeft:a+"px",marginTop:r+"px"})}}return this.afterSetPosition&&this.afterSetPosition(this),this},showPanel:function(){jQuery(this.element).show(),this.setPosition(),this.element.active_panel=this;var e={width:jQuery(this.element).outerWidth(),height:jQuery(this.element).outerHeight()},t=(jQuery(window).width(),jQuery(window).height(),{left:jQuery(window).scrollLeft(),top:jQuery(window).scrollTop()});e.width,this.offsetX,t.left,e.height,this.offsetY,t.top;jQuery(this.element).show(),this.addActions()},hidePanel:function(){jQuery(this.element).hide()},closePanel:function(){this.hidePanel(),jQuery(this.element).detach()},addActions:function(){this.element.addEventListener("click",function(e){var t=jQuery(e.target).closest("a,input,button")[0];t&&t.classList.contains("panel_action")&&(this[t.rel](t),e.stopPropagation(),e.preventDefault())}.bind(this))},update:function(e){return this.loadInfo(e),this},captureForm:function(e){return this.captureFormSelector=e,this.bindFormCapture(),this},bindFormCapture:function(){var e=null;this.captureFormSelector&&(e=jQuery(this.captureFormSelector)[0]),e&&(e.setAttribute("data-deny-submit","1"),e.addEventListener("submit",function(e){return!(jQuery(this.captureFormSelector).length>0)||(this.capturedFormData=jQuery(this.captureFormSelector).serializeArray(),this.hide(),this.asyncSubmitResponseCallback&&jQuery.ajax({url:jQuery(this.captureFormSelector)[0].action,method:"POST",data:this.capturedFormData,dataType:"json"}).done(function(e){this.asyncSubmitResponseCallback(e)}.bind(this)).fail(function(e,t,i){this.asyncSubmitResponseCallback(e.responseJSON,i)}.bind(this)),e.preventDefault(),!1)}.bind(this)))},asyncSubmit:function(e,t){return e&&""!=e&&(this.asyncSubmitResponseCallback=t,this.captureForm(e)),this},getCorner:function(e,t){var i={width:jQuery(e).outerWidth(),height:jQuery(e).outerHeight()};return{left:t.match(/R/i)?i.width:t.match(/L/i)?0:i.width/2,top:t.match(/B/i)?i.height:t.match(/T/i)?0:i.height/2}},setOptions:function(e){(e=Object.assign({panelId:null,panelClass:"panel",overlayId:"panel_overlay",overlayOpacity:.7,overlayColor:"#ffffff",width:null,height:null,style:null,content:null,url:null,ajaxOptions:{},displayOverlay:!0,useShim:!1,positionRelativeTo:null,hooks:["C","C"],offsetX:0,offsetY:0,zIndex:Panel.last_zIndex+=2,appendTo:null,loadingText:trl("Loading...","panel text"),loadingClass:"panel_loading",showLoading:!0,enableClickOut:!1,enableEscapeOut:!1,excludeFromClickOut:null,excludeFromEscapeOut:null,beforeSetPosition:null,afterSetPosition:null,onOpen:null,onClose:null,onClickOut:null,onEscapeOut:null,onLoadComplete:null,onLoadFailure:null},e||{})).appendTo&&(e.appendTo=asElement(e.appendTo)),Object.assign(this,e)}},Panel.last_zIndex=9e3,DropPanel=function(e,t){this.initialize(e,t)},DropPanel.prototype=Object.create(Panel.prototype),DropPanel.prototype.constructor=DropPanel,Object.assign(DropPanel.prototype,{initialize:function(e,t){return this.target=asElement(e),this.setOptions(t),this.setDropPanelOptions(t),this.selectshidden=!1,this.buildElements(),this.panel_timeout=null,this.target.removeEventListener("click",function(){}),this.target.addEventListener("click",this.toggle.bind(this)),this.element.addEventListener("mouseout",this.handleMouseOut.bind(this)),this.element.addEventListener("mouseover",this.handleMouseOver.bind(this)),this},handleMouseOut:function(){clearTimeout(this.panel_timeout),this.panel_timeout=setTimeout(this.close.bind(this),this.panelCloseDelay)},handleMouseOver:function(){clearTimeout(this.panel_timeout)},toggle:function(){clearTimeout(this.panel_timeout),Panel.prototype.toggle.call(this)},setDropPanelOptions:function(e){e=Object.assign({positionRelativeTo:this.target,excludeFromClickOut:[this.target],hooks:["BL","TL"],enableClickOut:!0,displayOverlay:!1,panelCloseDelay:1500},e||{});Object.assign(this,e)}}),PeopleTagger=function(e,t){this.initialize(e,t)},PeopleTagger.prototype={initialize:function(e,t){this.element=asElement(e),this.element&&(this.element.hasPeopleTagger||(this.element.hasPeopleTagger=!0,this.setOptions(t),this.setupAutoCompleteOptions(),GeniLoader.ready(this.buildAutoCompleter.bind(this))))},setupAutoCompleteOptions:function(){this.autocomplete_options=jQuery.extend(!0,{searchOptions:{searchParams:{},search_properties:["name","relation"],exceptions:function(e){return!!(this.options.excludeOwner&&e.relation&&e.relation.match(/yourself/i))||(!(!this.options.excludeDeceased||e.living)||(!(!this.options.excludeUnclaimed||e.claimed)||(!(!this.options.excludeClaimed||!e.claimed)||(!(!this.options.excludePrivate||e["public"])||(!(!this.options.excludePublic||!e["public"])||(!(!this.options.excludeUninvited||e.invited)||!!this.options.excludeIds&&this.options.excludeIds.find(function(t){return e.id==t})))))))}.bind(this)},appendToList:this.buildRemoteSearchForm.bind(this),noResultsText:this.buildNoResults.bind(this)},this.options)},disable:function(){this.autocompleter.disabled=!0},enable:function(){this.autocompleter.disabled=!1},addPerson:function(e,t){if(!this.autocompleter.data.find(function(t){return t.id==e})){var i={id:e,name:t};this.autocompleter.data.push(i)}},buildAutoCompleter:function(){this.autocompleter=new Autocomplete(this.element,[],this.autocomplete_options),this.managePeopleData()},managePeopleData:function(){this.options&&this.options.datasource||window.people?this.autocompleter&&(this.autocompleter.data=this.options&&this.options.datasource?this.options.datasource:window.people,this.options&&this.options.addPeople&&this.options.addPeople.forEach(function(e){this.addPerson(e.id,e.name)}.bind(this)),this.autocompleter.createSearcher()):window.setTimeout(this.managePeopleData.bind(this),100)},buildRemoteSearchForm:function(){if(!this.options.allowRemoteSearch)return null;var e=document.createElement("div");return e.classList.add("search"),this.buildRemoteSearchLink(e),e},buildNoResults:function(){if(!this.options.allowRemoteSearch&&!this.options.noResultsText)return null;var e=document.createElement("div"),t=this.options.noResultsText||tr("No Results Found. ","people tagger response");return this.options.allowRemoteSearch?this.buildRemoteSearchLink(e,t):e.innerHTML=t,e},buildRemoteSearchLink:function(e,t){var i=document.createElement("a");if(i.innerHTML=tr("Search More","people tagger prompt"),i.setAttribute("href","#"),i.addEventListener("mousedown",function(){this.autocompleter.clicking=!0}.bind(this)),i.addEventListener("click",this.performRemoteSearch.bind(this,e)),t){var n=document.createElement("span");n.innerHTML=t+" ",e.appendChild(n)}e.appendChild(i)},performRemoteSearch:function(e,t){jQuery(e).html(tr("Searching...","people tagger tooltip")),
searchAction=this.options.remoteSearchAction?this.options.remoteSearchAction:"people";var i={};this.options.searchOptions&&this.options.searchOptions.searchParams&&(i=this.options.searchOptions.searchParams),i.text=this.autocompleter.search_string||this.autocompleter.element.value,i.search_permission=this.options.searchPermission,i.include_lifespan=this.options.includeLifespan,new Geni.Request("/autocomplete/"+searchAction,{parameters:i,evalJSON:"force",onSuccess:function(t){this.options.onSearchSuccess&&this.options.onSearchSuccess(t),t.responseJSON&&t.responseJSON.length>0?this.autocompleter.handleSearchResults(t.responseJSON):jQuery(e).html(tr("Search returned no results.","people tagger response")),this.autocompleter.noResultsText=this.buildNoResults.bind(this)}.bind(this),onFailure:function(e){this.options.onSearchFailure&&this.options.onSearchFailure(e)}.bind(this)}),t.stopPropagation(),t.preventDefault()},setOptions:function(e){this.options=Object.assign({listTemplate:function(e){var t=e.name;return e.lifespan&&!e.lifespan.blank()&&(t+=" <span>"+e.lifespan+"</span>"),e.relation&&!e.relation.blank()&&(t+="<br><span>"+e.relation+"</span>"),t},inputTemplate:"#{name}",datasource:null,excludeOwner:!1,excludeDeceased:!1,excludeUnclaimed:!1,excludeClaimed:!1,excludePublic:!1,excludePrivate:!1,excludeUninvited:!1,excludeIds:null,allowRemoteSearch:!0,selectFirstItem:!1,tipText:null,onSelect:null,onClear:null,onNoSelection:null},e||{})}},PeopleTagger.Inline=function(e,t){this.initialize(e,t)},PeopleTagger.Inline.prototype=Object.create(PeopleTagger.prototype),PeopleTagger.Inline.prototype.constructor=PeopleTagger,Object.assign(PeopleTagger.Inline.prototype,{initialize:function(e,t){PeopleTagger.prototype.initialize.call(this,e,t)},buildAutoCompleter:function(){this.element&&(this.autocompleter=new Autocomplete.InlineAutocomplete(this.element,this.autocomplete_options),this.data=this.filteredPeopleData(window.people),this.autocomplete_options.addPeople&&this.autocomplete_options.addPeople.forEach(function(e){this.addPerson(e.id,e.name)}.bind(this)),this.managePeopleData())},filteredPeopleData:function(e){if(!e)return[];var t=[],i=this.autocomplete_options.searchOptions.exceptions;return e.forEach(function(e){i&&i(e)||t.push(e)}),t},managePeopleData:function(){this.autocompleter.addTrigger({start:"([,;:\\s]|^)@([^,;:\\s][^,;:]*$)",end:"[^,;:\\s]*[,;:\\s]",parse:"(?:[,;:\\s]|^)(@.*)|@",queryTemplate:function(e){return e.input.replace(/^@/,"")},data_provider:new AutoCompleteSearch(this.data),tipText:"Start typing a name",listTemplate:"#{name}",inputTemplate:"[[#{id}]]"}),this.autocompleter.updateChoices()},addPerson:function(e,t){var i=null;if("undefined"!=typeof window.people&&(i=window.people.find(function(t){return t.id==e})),!i){var n={id:e,name:t};this.data.push(n)}}}),PeopleTagger.List=function(e,t,i){this.initialize(e,t,i)},PeopleTagger.List.prototype=Object.create(PeopleTagger.prototype),PeopleTagger.List.prototype.constructor=PeopleTagger,Object.assign(PeopleTagger.List.prototype,{initialize:function(e,t,i){this.element=document.getElementById(e),this.list=document.getElementById(t),this.selectedList=[],PeopleTagger.prototype.initialize.call(this,e,i)},buildAutoCompleter:function(){this.autocompleter=new Autocomplete.List(this.element,this.list,[],this.autocomplete_options),this.autocompleter.onRemove=function(e){this.options.onRemove&&this.options.onRemove(e),this.selectedList=this.selectedList.filter(t=>t!=e),this.updateSelectedList()}.bind(this),this.autocompleter.onSelect=function(e){this.options.onSelect&&this.options.onSelect(e),this.selectedList.push(e),this.updateSelectedList()}.bind(this),this.managePeopleData()},addPerson:function(e,t){var i=this.autocompleter.searcher.data.find(function(t){return t.id==e});if(i)this.autocompleter.addToList(i),this.selectedList.push(i);else{var n={id:e,name:t};this.autocompleter.searcher.data.push(n),this.autocompleter.addToList(n),this.selectedList.push(n)}this.updateSelectedList()},clearList:function(){this.autocompleter.clearList(),this.selectedList=[],this.options.selectedList&&(document.getElementById(this.options.selectedList).innerHTML=""),this.list.innerHTML=""},updateSelectedList:function(){if(this.options.selectedList){var e=this.selectedList.map(function(e){return new Template(this.options.selectedListTemplate).evaluate(e)}.bind(this)).join(", ");document.getElementById(this.options.selectedList).innerHTML=e}},setOptions:function(e){PeopleTagger.prototype.setOptions.call(this,e);var t=Object.assign({entryTemplate:"<input type='checkbox' name='profiles[]' value='#{id}' class='remove' checked /> #{h.name}",allowDuplicates:!1,selectFirstItem:!0,addPeople:null,addOwner:!1,selectedList:null,selectedListTemplate:"<a href='"+Geni.Site.URL+"/profile/index/#{id}'>#{h.name}</a>"},e||{});this.options=Object.assign(this.options,t)}}),PeopleTagger.TextboxList=function(e,t){this.initialize(e,t)},PeopleTagger.TextboxList.prototype=Object.create(PeopleTagger.List.prototype),PeopleTagger.TextboxList.prototype.constructor=PeopleTagger,Object.assign(PeopleTagger.TextboxList.prototype,{initialize:function(e,t){this.addedPeople=[],PeopleTagger.prototype.initialize.call(this,e,t)},buildAutoCompleter:function(){this.autocompleter=new Autocomplete.TextboxList(this.element,[],this.autocomplete_options),this.autocompleter.onSelect=function(e){-1==this.addedPeople.indexOf(e.id)&&(this.addedPeople.push(e.id),this.options.onSelect&&this.options.onSelect(e))}.bind(this),this.autocompleter.onRemove=function(e){this.addedPeople=this.addedPeople.filter(t=>t.id!=e.id),this.options.onRemove&&this.options.onRemove(e)}.bind(this),this.addPeopleToList(),this.managePeopleData()},addPeopleToList:function(){this.options.addPeople&&this.options.addPeople.forEach(this.addPersonToList.bind(this))},addPersonToList:function(e){this.autocompleter.searcher.data||(this.autocompleter.searcher.data=[]);var t=this.autocompleter.searcher.data.find(function(t){return t.id==e.id});if(t){if(-1!=this.addedPeople.indexOf(t.id))return;this.autocompleter.addToList(t),this.addedPeople.push(t.id)}else{if(this.autocompleter.searcher.data.push(e),-1!=this.addedPeople.indexOf(e.id))return;this.autocompleter.addToList(e),this.addedPeople.push(e.id)}},addPerson:function(e,t){this.addPersonToList({id:e,name:t})},setOptions:function(e){PeopleTagger.prototype.setOptions.call(this,e);var t=Object.assign({inputName:"profile[]",inputValue:"id",entryTemplate:"#{h.name} <span class='remove'></span>",allowDuplicates:!1,selectFirstItem:!0,addPeople:null,addOwner:!1,tipText:tr("Type the first or last name of the person you want to add.","people tagger tooltip")},e||{});this.options=Object.assign(this.options,t)}}),LocationTagger=function(e,t){this.initialize(e,t)},LocationTagger.prototype={initialize:function(e,t){this.input=asElement(e),this.input.location_tagger=this,t.cached_only?this.cached_only=t.cached_only:this.cached_only=!1,this.current_value=this.input.value,this.setOptions(t),this.registerEvents(),this.clear_button&&this.toggleClearButton()},registerEvents:function(){this.input.addEventListener("focus",this.buildAutoCompleter.bind(this)),this.input.addEventListener("change",this.toggleClearButton.bind(this)),this.clear_button&&(asElement(this.clear_button).addEventListener("click",this.clearLocationDetails.bind(this)),this.input.addEventListener("keyup",this.toggleClearButton.bind(this))),this.details_button&&asElement(this.details_button).addEventListener("click",this.toggleLocationDetails.bind(this)),this.search_button&&asElement(this.search_button).addEventListener("click",this.manualLookUp.bind(this))},clearInput:function(){this.input.value=this.current_value,this.input.blur()},manualLookUp:function(){this.buildAutoCompleter(),this.autoCompleter.updateChoices()},buildAutoCompleter:function(){if(!this.autoCompleter){this.autocompleteOptions.panelOptions=Object.assign({excludeFromClickOut:[this.input,this.details_button],onClickOut:this.clearInput.bind(this)},this.autocompleteOptions.panelOptions);var e=Object.assign({listTemplate:"#{address} <div id='historical_dates'>#{date_range}</div>",inputTemplate:"#{address}",customSearcher:BackendGeoSearcher,openDetailOnSelect:!0,locationTagger:this,tipText:this.tipText,noResultsText:this.noResultsText,onSelect:this.handleSelection.bind(this)},this.autocompleteOptions);this.autoCompleter=new Autocomplete(this.input,null,e)}},handleSelection:function(e){this.current_value=this.input.value,this.populateLocationDetails(e),this.onSelect&&this.onSelect()},populateLocationDetails:function(e){var t=this.parseLocationData(e);this.googlePlace=e,this.locationDetails=t,this.prefix.match(/^occupation_|^graduation_/)?0==document.getElementById(this.prefix+"_place_name").length&&document.getElementById(this.prefix+"_place_name")&&(document.getElementById(this.prefix+"_place_name").value=t.place_name):document.getElementById(this.prefix+"_place_name")&&(document.getElementById(this.prefix+"_place_name").value=t.place_name),document.getElementById(this.prefix+"_street_address1")&&(document.getElementById(this.prefix+"_street_address1").value=t.street_number+" "+t.street_name),document.getElementById(this.prefix+"_city")&&(document.getElementById(this.prefix+"_city").value=t.city),document.getElementById(this.prefix+"_state")&&(document.getElementById(this.prefix+"_state").value=t.state),document.getElementById(this.prefix+"_county")&&(document.getElementById(this.prefix+"_county").value=t.county),document.getElementById(this.prefix+"_country")&&(document.getElementById(this.prefix+"_country").value=t.country),document.getElementById(this.prefix+"_postal_code")&&(document.getElementById(this.prefix+"_postal_code").value=t.postal_code),document.getElementById(this.prefix+"_latitude")&&(document.getElementById(this.prefix+"_latitude").value=t.latitude),document.getElementById(this.prefix+"_longitude")&&(document.getElementById(this.prefix+"_longitude").value=t.longitude),t.cached_id&&document.getElementById(this.prefix+"_cached_id")&&(document.getElementById(this.prefix+"_cached_id").value=t.cached_id,document.getElementById(this.prefix+"_street_name").value=t.street_name,document.getElementById(this.prefix+"_street_number").value=t.street_number,document.getElementById(this.prefix+"_start_year").value=t.start_year,document.getElementById(this.prefix+"_end_year").value=t.end_year,LocationManagementHandler.getSearchKeysFromDatabase(t.cached_id),LocationManagementHandler.unlockDetailFields(),document.getElementById(this.prefix+"_latitude")&&document.getElementById(this.prefix+"_longitude")&&LocationManagementHandler.initMap(t.latitude,t.longitude,8))},parseLocationData:function(e){var t={country:"",state:"",county:"",city:"",street_name:"",street_number:"",postal_code:"",place_name:"",formatted_address:"",search_key:"",latitude:"",longitude:"",start_year:"",end_year:"",cached_id:""},i={place_name:["establishment","colloquial_area","point_of_interest","sublocality_level_1","neighborhood"],street_number:["street_number"],street_name:["route"],city:["locality","administrative_area_level_3","postal_town"],county:["administrative_area_level_2"],state:["administrative_area_level_1"],country:["country"],postal_code:["postal_code"],formatted_address:["formatted_address"],search_key:["search_key"],latitude:["latitude"],longitude:["longitude"]};return jQuery.each(i,function(i,n){jQuery.each(n,function(n,a){if(jQuery.each(e.address_components,function(e,n){if(jQuery.each(n.types,function(e,r){if(r==a)return"string"==typeof n.long_name&&(t[i]=n.long_name),!1}),t[i].length>0)return!1}),t[i].length>0)return!1})}),t.cached_id=e.cached_id,t.latitude=e.geometry.location.lat,t.longitude=e.geometry.location.lng,t.start_year=e.start_year,t.end_year=e.end_year,t},clearLocationDetails:function(e){["place_name","full_address","street_name","street_number","street_address1","street_address2","street_address3","postal_code","city","state","country","county","latitude","longitude","start_year","end_year","default_key","cached_id","search_key"].forEach(function(e){var t=document.getElementById(this.prefix+"_"+e);this.prefix.match(/^occupation_|^graduation_/)&&"place_name"==e||t&&(t.value="")}.bind(this)),this.input.value=this.current_value="","geo_management"===this.prefix&&LocationManagementHandler.clearKeyList(),this.clear_button&&document.getElementById(this.clear_button).classList.remove("active"),e&&(e.stopPropagation(),e.preventDefault())},toggleClearButton:function(){this.input.value.blank()?(document.getElementById(this.clear_button).classList.remove("active"),this.clearLocationDetails()):document.getElementById(this.clear_button)&&document.getElementById(this.clear_button).classList.add("active")},openLocationDetails:function(){this.details_button.classList.add("edit_location_link_open"),jQuery(this.details_panel).show()},closeLocationDetails:function(){this.details_button.classList.remove("edit_location_link_open"),jQuery(this.details_panel).hide()},toggleLocationDetails:function(e){if(this.details_panel=asElement(this.prefix+"_details"),this.details_button=asElement(this.details_button),jQuery(this.details_panel).is(":visible"))this.closeLocationDetails();else{this.openLocationDetails();var t=jQuery(this.details_panel).find("input")[0];t&&(Geni.isMobilePhone()||(jQuery(t).focus(),jQuery(t).select()))}e&&(e.stopPropagation(),e.preventDefault())},hasValue:function(e){var t=document.getElementById(e);return t&&""!=t.value},isEmpty:function(e){for(var t in e)return!1;return!0},setOptions:function(e){e=Object.assign({clear_button:null,details_button:null,prefix:"",tipText:trl("Start typing a location","Edit location"),noResultsText:trl("Sorry, no matches found.","search result"),autocompleteOptions:{cached_only:e.cached_only}},e||{});Object.assign(this,e)}},BackendGeoSearcher=function(){this.initialize()},BackendGeoSearcher.prototype={initialize:function(){this.wait_limit=300},searchFor:function(e,t){var i=this;clearTimeout(this.delay_timer),this.delay_timer=setTimeout(function(){var n={address:e},a=i.cached_only;n[Geni.AuthenticityParam]=Geni.AuthenticityToken,n.cached_only=a,a&&jQuery(".geo_management_search_in_progress").show(),jQuery.ajax({url:"/geo/search",method:"POST",data:n,dataType:"json",success:function(e){i.processData(e,a,t),a&&jQuery(".geo_management_search_in_progress").hide()}})},this.wait_limit)},processData:function(e,t,i){e=e||[];pData=[],jQuery.each(e,function(e,t){t.address=t.formatted_address,(t.start_year&&t.start_year.length>0||t.end_year&&t.end_year.length>0)&&(t.date_range="["+t.start_year+" - "+t.end_year+"]"),t.geometry&&t.geometry.location&&(t.geometry.location=new google.maps.LatLng(t.geometry.location.latitude,t.geometry.location.longitude)),pData.push(t)}),i(pData)}},Autocomplete_Accent_Map={"\xc1":"a","\xe1":"a","\xc0":"a","\xe0":"a",A:"a",a:"a","\xc2":"a","\xe2":"a",A:"a",a:"a","\xc5":"a","\xe5":"a","\xc4":"a","\xe4":"a",A:"a",a:"a","\xc3":"a","\xe3":"a",A:"a",a:"a",A:"a",a:"a","\u0101":"a",b:"b",C:"c",c:"c",C:"c",c:"c",C:"c",c:"c",C:"c",c:"c","\xc7":"c","\xe7":"c",D:"d",d:"d","\xd0":"d",d:"d","\xd0":"d","\xf0":"d","\xc9":"e","\xe9":"e","\xc8":"e","\xe8":"e",E:"e",e:"e","\xca":"e","\xea":"e",E:"e",e:"e","\xcb":"e","\xeb":"e",E:"e",e:"e",E:"e",e:"e",E:"e",e:"e","\u0192":"f","\u0192":"f",G:"g",g:"g",G:"g",g:"g",G:"g",g:"g",G:"g",g:"g",G:"g",g:"g",G:"g",g:"g",H:"h",h:"h",H:"h",_:"h",H:"h",h:"h","\xcd":"i","\xed":"i","\xcc":"i","\xec":"i",I:"i",i:"i","\xce":"i","\xee":"i",I:"i",i:"i","\xcf":"i","\xef":"i",I:"i",i:"i",I:"i",i:"i",I:"i",i:"i",I:"i",i:"i",I:"i",i:"i",I:"i",J:"j",j:"j",J:"j",j:"j",K:"k",k:"k",K:"k",k:"k",L:"a",l:"l",L:"l",l:"l",L:"l",l:"l",L:"l",l:"l",L:"l",l:"l",l:"l",N:"n",n:"n",N:"n",n:"n","\xd1":"n","\xf1":"n",N:"n",n:"n",N:"n","\xa8":"n",n:"n","\xa8":"n","\u0146":"n","\xd3":"o","\xf3":"o","\xd2":"o","\xf2":"o",O:"o",o:"o","\xd4":"o","\xf4":"o",O:"o",o:"o","\xd6":"o","\xf6":"o",O:"o",o:"o","\xd5":"o","\xf5":"o","\xd8":"o","\xf8":"o",O:"o",o:"o",O:"o",o:"o",O:"o",o:"o",O:"o",o:"o",O:"o",P:"p","~":"p",p:"p","~":"p",R:"r",r:"r",R:"r",r:"r",R:"r",r:"r","\xdf":"s",S:"s",s:"s",S:"s",s:"s","\u0160":"s","\u0161":"s",S:"s",s:"s",S:"s",s:"s","\xde":"t","\xfe":"t",T:"t",t:"t",T:"t","\xa8":"t",T:"t",t:"t",T:"t",t:"t",t:"t",T:"t","\xda":"u","\xfa":"u","\xd9":"u","\xf9":"u",U:"u",u:"u","\xdb":"u","\xfb":"u",U:"u",u:"u",U:"u",u:"u","\xdc":"u","\xfc":"u",U:"u",u:"u",U:"u",u:"u",U:"u",u:"u",U:"u",u:"u",U:"u",u:"u",U:"u",u:"u",U:"u",u:"u",U:"u",u:"u",U:"u",u:"u",W:"w",w:"w",W:"w","\xb0":"w","\xdd":"y","\xfd":"y",Y:"y",y:"y",Y:"y","\xb0":"y","\u0178":"y","\xff":"y",Z:"z",z:"z","\u017d":"z","\u017e":"z",Z:"z",z:"z",z:"z"},Autocomplete=function(e,t,i){this.initialize(e,t,i)},Autocomplete.prototype={initialize:function(e,t,i){this.element=asElement(e),this.element.setAttribute("autocomplete","off"),this.disabled=!1,this.data=t,this.setOptions(i),this.options=i,this.createPanel(),this.createSearcher(),this.registerEvents(),this.clicking=null},createPanel:function(){var e=Object.assign({positionRelativeTo:this.element,hooks:["BL","TL"],panelClass:this.autocompleteClass,displayOverlay:!1,enableClickOut:!0,excludeFromClickOut:[this.element],onClickOut:function(){this.clearOnClickOut&&this.clearInput()}.bind(this)},this.panelOptions);this.panel=new Panel(e)},createSearcher:function(){this.searcher=this.customSearcher?new this.customSearcher(this.data,this.searchOptions):new AutoCompleteSearch(this.data,this.searchOptions)},registerEvents:function(){this.element.addEventListener("focus",this.handleFocusEvent.bind(this)),this.element.addEventListener("blur",this.closePanel.bind(this)),this.element.addEventListener("keydown",this.handleKeyEvents.bind(this)),this.element.addEventListener("change",this.handleChangeEvent.bind(this)),this.panel.element.addEventListener("mouseover",this.handleListEvents.bind(this)),this.panel.element.addEventListener("mousedown",this.handleListEvents.bind(this)),this.panel.element.addEventListener("click",this.handleListEvents.bind(this))},handleFocusEvent:function(){this.tipText&&this.element.value.blank()&&this.showMessage("tip",this.tipText),this.initialList&&this.initialList.length>0&&this.handleSearchResults(this.initialList)},handleChangeEvent:function(){this.element.value.blank()&&this.onClear&&this.onClear()},handleListEvents:function(e){var t=jQuery(e.target).closest("li")[0];if(t)switch(e.type){case"mouseover":this.markItem(t,!1);break;case"mousedown":this.clicking=!0;break;case"click":this.selectItem(t)}},handleKeyEvents:function(e){if(!this.disabled)switch(e.code){case"Enter":case"Tab":this.getItemByIndex(this.itemIndex)&&(this.selectItem(this.itemIndex),e.stopPropagation(),e.preventDefault());break;case"ArrowLeft":case"ArrowRight":break;case"ArrowUp":this.markItem(this.itemIndex-1,!0)&&(e.stopPropagation(),e.preventDefault());break;case"ArrowDown":this.markItem(this.itemIndex+1,!0)&&(e.stopPropagation(),e.preventDefault());break;case"Escape":this.closePanel(),e.stopPropagation(),e.preventDefault();break;default:this.observer&&clearTimeout(this.observer),this.observer=setTimeout(this.updateChoices.bind(this),0)}},accentFold:function(e){if(!e)return"";for(var t="",i=0,n=e.length;i<n;i++)t+=Autocomplete_Accent_Map[e.charAt(i)]||e.charAt(i);return t},updateChoices:function(){if(this.currentSearchTerm=this.accentFold(this.element.value),this.currentSearchTerm.blank())this.tipText?this.showMessage("tip",this.tipText):this.closePanel();else{if(this.list&&"new_message_people_search"==this.list.id){var e=jQuery("input[name=peopleTagDiscussionNames").val();if(e){e=JSON.parse(e);var t=this.data.map(function(e){return e.id}),i=this.data||[];e.forEach(function(e){t.includes(e.id)||i.unshift(e)}),this.data=i,this.searcher.createOptimizedData()}}"undefined"!=typeof this.options&&(this.searcher.cached_only=this.options.cached_only),this.searcher.searchFor(this.currentSearchTerm,this.handleSearchResults.bind(this))}},closePanel:function(){"none"!==this.panel.element.style.display&&(this.clicking?this.clicking=null:(this.panel.hide(),this.panel.updateContent()))},clearInput:function(){this.setValueTo(""),this.panel.updateContent()},markItem:function(e,t){if("none"===this.panel.element.style.display)return!1;var i=!1;"number"==typeof e&&(e=this.getItemByIndex(e));for(var n=this.panel.element.getElementsByTagName("li"),a=0;a<n.length;a++)n[a].classList.remove("hover");if(e){if(!e.classList.contains("ignore")){if(t){var r=JSON.parse(e.getAttribute("data"));i=this.setValueTo(this.applyTemplate(this.inputTemplate,r))}this.itemIndex=parseInt(e.getAttribute("autocomplete_index")),e.classList.add("hover")}}else t&&(i=this.setValueTo(this.currentSearchTerm)),this.itemIndex=-1;return i},selectItem:function(e){if(this.clicking=null,"number"==typeof e&&(e=this.getItemByIndex(e)),e&&!e.classList.contains("ignore")){this.closePanel();var t=JSON.parse(e.getAttribute("data"));this.clearAfterSelection?this.setValueTo(""):this.setValueTo(this.applyTemplate(this.inputTemplate,t)),this.element.blur(),this.onSelect&&this.onSelect(t),this.openDetailOnSelect&&jQuery(".edit_location").is(":hidden")&&(this.locationTagger.details_panel=asElement(this.locationTagger.prefix+"_details"),this.locationTagger.details_button=asElement(this.locationTagger.details_button),this.locationTagger.openLocationDetails())}},setValueTo:function(e){this.element.value=e},getItemByIndex:function(e){var t=this.panel.element.querySelectorAll("li:not([class~=ignore])");return t[e=e>t.length-1?-1:e<-1?t.length-1:e]||null},handleSearchResults:function(e){this.itemIndex=-1,0==e.length?this.noResultsText?this.showMessage("no_matches",this.noResultsText):this.closePanel():(this.buildList(e),this.selectFirstItem&&this.markItem(0))},buildList:function(e){var t=document.createElement("div");t.classList.add("autocomplete_content");var i=document.createElement("ul"),n=this;if(this.panel_items=[],e.forEach(function(e,t){if(!(n.searchOptions&&n.searchOptions.exceptions&&n.searchOptions.exceptions(e))){var a=this.applyTemplate(this.listTemplate,e),r=document.createElement("li");r.innerHTML=a,r.setAttribute("autocomplete_index",t),r.setAttribute("data",JSON.stringify(e)),i.appendChild(r)}}.bind(this)),this.appendToList){var a="function"==typeof this.appendToList?this.appendToList():this.appendToList;if(a){var r=document.createElement("li");r.classList.add("ignore"),r.appendChild(a),i.appendChild(r)}}t.appendChild(i),this.panel.open(),this.panel.updateContent(t),this.setDimensions()},showMessage:function(e,t){var i=document.createElement("div");i.classList.add("autocomplete_content");var n=document.createElement("div");n.classList.add(e),"function"==typeof t&&(t=t()),"object"==typeof t?n.appendChild(t):n.innerHTML=t,i.appendChild(n),this.panel.open(),this.panel.updateContent(i),this.setDimensions()},evaluateTemplate:function(e,t){evalPattern=/(^|.|\r|\n)(#\{(.*?)\})/;for(var i,n="";e.length>0;)if(i=e.match(evalPattern)){if(n+=e.slice(0,i.index),null==t)n+=i[1]+"";else{var a=i[1]||"";if("\\"==a)n+=i[2];else{var r=t,s=i[3],o=/^([^.[]+|\[((?:.*?[^\\])?)\])(\.|\[|$)/,l=!1;if("h."==s.substring(0,2)&&(l=!0,s=s.substring(2)),patternMatch=o.exec(s),null==patternMatch)n+=a;else{for(;null!=patternMatch;){if(null==(r=r[patternMatch[1].startsWith("[")?patternMatch[2].replace(/\\\\]/g,"]"):patternMatch[1]])||""==patternMatch[3])break;s=s.substring("["==patternMatch[3]?patternMatch[1].length:patternMatch[0].length),patternMatch=o.exec(s)}r=null==r?"":r,l&&(r=Geni.util.escapeHTML(r)),n+=a+r}}}e=e.slice(i.index+i[0].length)}else n+=e,e="";return n},applyTemplate:function(e,t){return t?"string"==typeof e?this.evaluateTemplate(e,t):"function"==typeof e?e(t):Geni.values(t).join(" "):this.currentSearchTerm},setDimensions:function(){this.panel.element.width="auto";var e=window.getComputedStyle(this.panel.element),t=(parseInt(e.top),parseInt(e.left),window.getComputedStyle(this.panel.target)),i=e.width>t.width?e.width:t.width;this.panel.element.width=i+"px"},setOptions:function(e){e=Object.assign({autocompleteClass:"autocomplete",panelOptions:{},searchOptions:{},listTemplate:null,inputTemplate:null,selectFirstItem:!1,appendToList:null,tipText:null,enableResetButton:!1,noResultsText:null,clearAfterSelection:!1,clearOnClickOut:!0,customSearcher:null,offsetX:0,offsetY:0,character_limit:3,onSelect:null,onClear:null,initialList:null},e||{});Object.assign(this,e),this.inputTemplate||(this.inputTemplate=this.listTemplate)}},Autocomplete.List=function(e,t,i,n){this.initialize(e,t,i,n)},Autocomplete.List.prototype=Object.create(Autocomplete.prototype),Autocomplete.List.prototype.constructor=Autocomplete.List,Object.assign(Autocomplete.List.prototype,{initialize:function(e,t,i,n){this.list=asElement(t),this.element=asElement(e),this.element.setAttribute("autocomplete","off"),this.data=i,this.listed=[],this.setOptions(n),this.createPanel(),this.createSearcher(),this.registerEvents()},registerEvents:function(){Autocomplete.prototype.registerEvents.call(this),this.list.addEventListener("click",this.handleEntryListEvents.bind(this))},handleEntryListEvents:function(e){var t=jQuery(e.target).closest(".remove")[0],i=jQuery(e.target).closest("li")[0];i&&t&&(this.removeEntry(i),e.stopPropagation(),e.preventDefault()),this.element.focus()},createSearcher:function(){var e=this.searchOptions.exceptions||function(){return!1};this.searchOptions.exceptions=function(t){return!(-1==this.listed.indexOf(t.id))&&!this.allowDuplicates||e(t)}.bind(this),Autocomplete.prototype.createSearcher.call(this)},selectItem:function(e){"number"==typeof e&&(e=this.getItemByIndex(e)),this.createEntry(JSON.parse(e.getAttribute("data"))),Autocomplete.prototype.selectItem.call(this,e),this.setValueTo(""),this.element.focus()},addToList:function(e){Array.isArray(e)?e.each(this.createEntry.bind(this)):this.createEntry(e)},clearList:function(){this.listed=[],this.list.update(),this.searcher.createOptimizedData()},createEntry:function(e){this.listed.push(e.id),this.searcher.createOptimizedData();var t=this.applyTemplate(this.entryTemplate,e),i=document.createElement("li");i.innerHTML=t,i.entry=e,this.list.appendChild(i)},removeEntry:function(e){e.entry?(this.listed=this.listed.filter(t=>t!=e.entry.id),e.remove(),this.searcher.createOptimizedData(),this.panel.setPosition(),this.onRemove&&this.onRemove(e.entry)):e.remove()},setOptions:function(e){Autocomplete.prototype.setOptions.call(this,e);e=jQuery.extend({allowDuplicates:!1,entryTemplate:null,selectFirstItem:!0},e||{});Object.assign(this,e)}}),Autocomplete.TextboxList=function(e,t,i){this.initialize(e,t,i)},Autocomplete.TextboxList.prototype=Object.create(Autocomplete.List.prototype),Autocomplete.TextboxList.prototype.constructor=Autocomplete.TextboxList,Object.assign(Autocomplete.TextboxList.prototype,{initialize:function(e,t,i){this.list=asElement(e),this.input_element=jQuery(this.list).find("li.input")[0],this.element=jQuery(this.input_element).find("input")[0],this.data=t,this.listed=[],this.setOptions(i),this.createPanel(),this.panel.positionRelativeTo=this.list,this.createSearcher(),this.registerEvents()},registerEvents:function(){Autocomplete.List.prototype.registerEvents.call(this),jQuery(this.element).on("keydown",this.handleKeyDown.bind(this)),jQuery(this.list).on("click",this.entryClickEvent.bind(this))},createSearcher:function(){var e=this.searchOptions.exceptions||function(){return!1};this.searchOptions.exceptions=function(t){return e(t)}.bind(this),Autocomplete.List.prototype.createSearcher.call(this)},entryClickEvent:function(e){var t=jQuery(e.target).closest("li")[0];t&&(this.setSelectedEntry(t),e.stopPropagation(),e.preventDefault()),this.element.focus()},createEntry:function(e){this.listed.push(e.id),this.searcher.createOptimizedData();var t=this.applyTemplate(this.entryTemplate,e);t=t.replace(/&amp;/g,"&").replace(/&quot;/g,'"');var i=document.createElement("li");i.innerHTML=t,i.entry=e;var n=e[this.inputValue]||Geni.values(e).join(","),a=document.createElement("input");a.setAttribute("type","hidden"),a.setAttribute("name",this.inputName),a.setAttribute("value",n),i.appendChild(a),this.input_element.parentElement.insertBefore(i,this.input_element)},handleKeyDown:function(e){switch(e.code){case"Backspace":this.handleBackspace();break;case"Delete":this.handleDelete(e);break;case"ArrowLeft":if(0==!this.getCaretPosition())return;var t=this.current?this.current.previous():this.input_element.previous();this.setSelectedEntry(t),e.stopPropagation(),e.preventDefault();break;case"ArrowRight":if(!this.current)return;this.setSelectedEntry(this.current.next()),e.stopPropagation(),e.preventDefault()}},handleDelete:function(e){if(this.current){var t=this.current.next();this.removeEntry(this.current),this.setSelectedEntry(t),e.stopPropagation(),e.preventDefault()}},handleBackspace:function(){if(0!=!this.getCaretPosition())if(this.current){var e=this.current.previousElementSibling;this.removeEntry(this.current),this.setSelectedEntry(e)}else this.setSelectedEntry(this.input_element.previousElementSibling)},setSelectedEntry:function(e){if(e){if(e.classList.contains("input"))return this.clearSelected();this.clearSelected(),this.current=e,this.current.classList.add("selected")}},clearSelected:function(){jQuery(this.list).find(".selected").removeClass("selected"),this.current=null},getCaretPosition:function(){if(this.element.createTextRange){var e=document.selection.createRange().duplicate(),t=asElement(this.element).value;return e.moveEnd("character",t.length),""===e.text?t.value.length:t.value.lastIndexOf(e.text)}return this.element.selectionStart},setOptions:function(e){Autocomplete.List.prototype.setOptions.call(this,e);e=jQuery.extend(!0,{inputName:"item[]",inputValue:null,allowDuplicates:!1,entryTemplate:null,panelOptions:{positionRelativeTo:this.list}},this||{});Object.assign(this,e)}}),Autocomplete.InlineAutocomplete=function(e,t){this.initialize(e,t)},Autocomplete.InlineAutocomplete.prototype=Object.create(Autocomplete.prototype),Autocomplete.InlineAutocomplete.prototype.constructor=Autocomplete.InlineAutocomplete,Object.assign(Autocomplete.InlineAutocomplete.prototype,{initialize:function(e,t){this.element=asElement(e),this.element.setAttribute("autocomplete","off"),this.triggers=[],this.setOptions(t),this.createPanel(),this.registerEvents()},updateChoices:function(){if(this.caret_pos=this.element.selectionEnd,this.update_text=asElement(this.element).value,this.current_trigger=this.triggers.find(function(e){var t=this.update_text.substring(0,this.caret_pos).match(new RegExp(e.start)),i=this.caret_pos<this.update_text.length?this.update_text.substring(this.caret_pos,this.update_text.length).match(new RegExp(e.end)):[""];return t&&i&&(this.search_string=t[0]+i[0]),t&&i}.bind(this)),this.current_trigger){this.listTemplate=this.current_trigger.listTemplate,this.inputTemplate=this.current_trigger.inputTemplate,this.currentSearchTerm=this.search_string.replace(new RegExp(this.current_trigger.parse),"$1").strip();var e=this.applyTemplate(this.current_trigger.queryTemplate,{input:this.currentSearchTerm});if(e.blank())return void(this.current_trigger.tipText?this.showMessage("tip",this.current_trigger.tipText):this.closePanel());this.current_trigger.data_provider.find(e,this.handleSearchResults.bind(this))}else this.closePanel()},handleSearchResults:function(e){this.itemIndex=-1,0==e.length?this.noResultsText?this.showMessage("no_matches",this.noResultsText):this.closePanel():(this.buildList(e),this.selectFirstItem&&this.markItem(0))},selectItem:function(e){if("number"==typeof e&&(e=this.getItemByIndex(e)),e&&!e.classList.contains("ignore")){this.closePanel();var t=JSON.parse(e.getAttribute("data"));this.setValueTo(this.clearAfterSelection?"":this.applyTemplate(this.inputTemplate,t)),this.onSelect&&this.onSelect(t)}},setValueTo:function(e){if(this.current_trigger){var t=this.update_text.substring(0,this.caret_pos).replace(new RegExp(this.current_trigger.start),""),i=this.search_string.replace(this.currentSearchTerm,e),n=this.update_text.substring(this.caret_pos,this.update_text.length).replace(new RegExp(this.current_trigger.end),"");return this.element.value=t+i+n,this.element.selectionEnd=t.length+this.search_string.search(this.currentSearchTerm)+e.length,this.element.focus(),!0}return!!e&&(this.element.value=e,!0)},addTrigger:function(e){this.triggers.push(e)}}),AutoCompleteCache=[],AutoCompleteSearch=function(e,t){this.initialize(e,t)},AutoCompleteSearch.prototype={initialize:function(e,t){this.data=e,this.setOptions(t),this.initData()},initData:function(){this.data_array=[],"string"!=typeof this.data?(this.createOptimizedData(),this.local_data=!0):(this.local_data=!1,this.request_timer=null)},createOptimizedData:function(e){e=e||this.data||[];return this.data_array=[],
e.forEach(function(e){if(!this.exceptions||!this.exceptions(e)){var t=[];this.search_properties?this.search_properties.forEach(function(i){t.push(e[i])}):t=Geni.values(e),this.data_array.push([t.join(" "),e])}}.bind(this)),this.data_array},accentFold:function(e){if(!e)return"";for(var t="",i=0,n=e.length;i<n;i++)t+=Autocomplete_Accent_Map[e.charAt(i)]||e.charAt(i);return t},getMatches:function(e){return this.ignore_prefix&&(e=e.replace(this.ignore_prefix,"")),this.data_array.map(function(t){const i=jQuery.ui.autocomplete.escapeRegex(e);return this.accentFold(t[0]).match(new RegExp("(^| )"+i,"i"))?t[1]:null}.bind(this)).filter(function(e){return null!=e})},searchFor:function(e,t){if((!(e=(e=e.replace(/<\w+(\s+("[^"]*"|'[^']*'|[^>])+)?>|<\/\w+>/gi,"")).replace(/[()*/\|]|\[|\]/g,""))||e.blank())&&t)return t([]);if(AutoCompleteCache["cache_"+e]&&t)return t(AutoCompleteCache["cache_"+e]);if(this.local_data||this.data_array.length<this.max_results&&e.match(new RegExp("^"+this.previous_search_term,"i"))){var i=this.getMatches(e).slice(0,this.limit_choices);if(t)return t(i)}this.local_data||(clearTimeout(this.request_timer),this.request_timer=setTimeout(function(){this.previous_search_term=e;var i=this.searchParams||{};i[this.query_param]=e,new Ajax.Request(this.data,{method:"get",parameters:i,evalJSON:!0,onComplete:this.processJSON.bind(this,t)}),this.request_timer=null}.bind(this),this.delay_request))},find:function(e,t){this.searchFor(e,t)},processJSON:function(e,t){var i=this.processData?this.processData(e.responseJSON):e.responseJSON;if(AutoCompleteCache["cache_"+e.request.parameters[this.query_param]]=i,this.createOptimizedData(i),t)return t(i)},setOptions:function(e){e=Object.assign({searchParams:{},search_properties:null,exceptions:null,processData:null,max_results:50,limit_choices:10,query_param:"query",delay_request:300,ignore_prefix:null},e||{});Object.assign(this,e)}},TabControl=function(element,current){this.initialize=function(e,t){this.element=e,this.current=t,jQuery(this.element+" ul.tabs li").each(function(e,t){this.initTab(t)}.bind(this))},this.initTab=function(e){var t=e.getAttribute("rel")||null;t&&(t="#"+t),jQuery(e).on("mouseover",function(){jQuery(e).addClass("onhover")}.bind(this)),jQuery(e).on("mouseout",function(){jQuery(e).removeClass("onhover")}.bind(this)),jQuery(t).length&&(t!=this.current?jQuery(t).hide():jQuery(e).addClass("selected"),jQuery(e).on("click",function(i){this.selectTab(i,e,t)}.bind(this)))},this.selectTab=function(e,tab,page){tab.blur(),jQuery(this.element+" ul.tabs li.selected").each(function(e,t){jQuery(t).removeClass("selected")}),jQuery(this.current).length&&jQuery(this.current).hide(),this.current=page,jQuery(tab).addClass("selected"),jQuery(page).show();var showFunc=jQuery(page).attr("onshow");showFunc!=undefined&&eval(showFunc),e.preventDefault()},this.initialize(element,current)},MultilingualTabber=function(e){this.initialize=function(e){this.tab_id=e},this.changeLocale=function(e){this.localeTab(e).click()},this.quickAdd=function(e,t,i,n){this.addLocaleDiv(e,i,n),this.addLocaleTab(e,t),this.tabs("refresh")},this.quickAddClicked=function(e,t,i,n){this.quickAdd(e,t,i,n),this.changeLocale(e)},this.localeClicked=function(e,t,i,n){this.closeLanguageLightbox(),this.tabExists(e)?this.changeLocale(e):(this.rememberChosenLocale(e),this.quickAddClicked(e,t,i,n))},this.addLocaleTab=function(e,t){var i="<a id='tab-"+e+"' href='#tabc-"+e+"'>"+t+"</a>";this.tabExists(e)?this.localeTab(e).replaceWith(i):this.tabs().find("li[role=tab]").last().after("<li>"+i+"</li>")},this.addLocaleDiv=function(e,t,i){var n="en-US",a=this.localeDiv(n).clone().wrap("<p/>").parent().html(),r=new RegExp(n,"g");a=(a=(a=a.replace(r,e)).replace(/value=('[^']*'|"[^"]*")/g,"")).replace(/dir=('[^']*'|"[^"]*")/g,'dir="'+i+'"'),this.tabs().find("div.ui-tabs-panel").last().after(a),a.search("wikitext")>-1&&jQuery("textarea.wikitext").each(function(){jQuery(this).parent().addClass("multi-language"),addWikiFormattingToolbar(this)}),this.tabs().find("div.ui-tabs-panel").last().data("localeLabel",t),LabelMaker.init_labels(),bindInlineEventHandlers()},this.rememberChosenLocale=function(e){var t=jQuery("#already_added_locales");t.length>0&&(""==t.val()?t.val(e):t.val(t.val()+","+e))},this.localeDiv=function(e){return this.tabs().find("#tabc-"+e)},this.localeTab=function(e){return this.tabs().find("#tab-"+e)},this.tabExists=function(e){return this.localeTab(e).length>0},this.closeLanguageLightbox=function(){jQuery("div#lightbox-language")[0].panel.close()},this.tabElement=function(){return jQuery("#"+this.tab_id)},this.tabs=function(){return this.tabElement().tabs.apply(this.tabElement(),Array.prototype.slice.call(arguments))},this.initialize(e)},Timeline=function(e,t,i){this.initialize(e,t,i)},Timeline.prototype={initialize:function(e,t,i){this.timeline=document.getElementById(e),this.profileId=t,this.openedEventArray=[],this.passSortParam=!1,this.setOptions(i),this.sort="asc",this.options.filterForm&&document.getElementById(this.options.filterForm).reset(),this.setHeight(),this.registerTimelineBehaviors(),this.registerButtons()},registerButtons:function(){var e=document.getElementById(this.options.reverseTimelineButton);e&&e.addEventListener("click",this.reverseSort.bind(this))},registerTimelineBehaviors:function(){if(this.registered||(this.registered=!0,this.options.useHover&&this.setHovers(),this.timeline.addEventListener("click",function(e){var t=jQuery(e.target);this.options.allowEditableYear&&this.setEditableYear(t),this.options.showMoreDetails&&this.setEventDetails(t),this.options.allowHideEvent&&this.setHideEvent(t),this.options.allowAddAttendee&&this.setAddAttendee(t)}.bind(this))),this.options.eventsNumberElement){var e=parseInt(document.getElementById("timeline_size").value),t=parseInt(document.getElementById("timeline_count").value);e!=t&&(e=e+" of "+t),document.getElementById(this.options.eventsNumberElement).innerHTML=e}},setHideEvent:function(e){var t=e.closest("a");if(t&&t.hasClass("event_hide_link")){var i=t.closest("tr"),n=i.getAttribute("eventid");this.toggleHideEvent(t,i,n)}},toggleHideEvent:function(e,t,i){t.hasClass("hidden")?(t.classList.add("loading"),new Geni.Request("/events/"+i+"/unhide?profile_id="+this.profileId,{method:"post",onSuccess:function(){t.classList.remove("hidden"),t.classList.remove("loading"),e.innerHTML=tr("Hide from my timeline")}.bind(this)})):(t.classList.add("loading"),new Geni.Request("/events/"+i+"/hide?profile_id="+this.profileId,{method:"post",onComplete:function(){t.classList.add("hidden"),t.classList.remove("loading"),hideLinkinnerHTML=tr("Show on my timeline")}.bind(this)}))},setAddAttendee:function(e){var t=e.closest("a");if(t&&t.hasClass("event_attendee_link")){var i=t.closest("tr").getAttribute("eventid");this.toggleAttendeeEvent(e,t,t.closest("tr"),i)}},toggleAttendeeEvent:function(e,t,i,n){Event.stop(e),i.classList.add("loading"),new Ajax.Request(t.href,{method:"get",evalScripts:!0,onComplete:function(){this.loadDetails(i,n)}.bind(this)})},setEventDetails:function(e){var t=e.closest("a");if(t&&t.hasClass("event_details_link")){var i=t.closest("tr").getAttribute("eventid");this.currentEvent&&this.currentEvent[2]!=i&&this.toggleEventDetails(this.currentEvent[0],this.currentEvent[1],this.currentEvent[2]),this.toggleEventDetails(t,t.closest("tr"),i)}},toggleEventDetails:function(e,t,i){t.hasClass("selected")?(t.classList.remove("selected"),jQuery("#event_details_"+i).slideUp({duration:.2}),showLinkinnerHTML="more",this.currentEvent=null):-1!=this.openedEventArray.indexOf(i)?this.openDetails(t,i):this.loadDetails(t,i)},loadDetails:function(e,t){e.classList.add("loading"),new Ajax.Updater("event_details_"+t,"/timeline/details/"+t,{evalScripts:!0,onComplete:function(){e.classList.remove("loading"),-1==this.openedEventArray.indexOf(t)&&(this.openDetails(e,t),this.openedEventArray.push(t)),this.options.allowHideEvent&&this.setHideEvent(e,t),this.options.allowAddAttendee&&this.setAddAttendee(e,t)}.bind(this)})},openDetails:function(e,t){var i=e.down(".event_details_link");e.classList.remove("loading"),e.classList.add("selected"),i.classList.add("selected"),jQuery("#event_details_"+t).slideDown({duration:.2}),i.innerHTML=tr("less"),this.currentEvent=[i,e,t]},setHovers:function(){this.timeline.addEventListener("mouseover",function(e){var t=e.closest("tr");t&&t.classList.add("hover")}),this.timeline.addEventListener("mouseout",function(e){var t=e.closest("tr");t&&t.classList.remove("hover")})},setEditableYear:function(e){var t=e.closest("span");if(t&&t.hasClass("unknown_year")){var i=t.closest("tr").getAttribute("eventid"),n=new Ajax.InPlaceEditor(t,"/events/set_event_year/?profile_id="+this.profileId+"&id="+i,{okButton:!1,cancelLink:!1,submitOnBlur:!0,highlightcolor:"#ffffe0",formClassName:"unknown_year_form",savingClassName:"unknown_year_save"});Event.stopObserving(t,"click",n.onclickListener),new Ajax.Request("/events/can_edit_metadata/?profile_id="+this.profileId+"&id="+i,{parameters:{id:i},onComplete:function(e){"success"==e.responseText&&n.enterEditMode(),t.previous(".unknown_year_form").addEventListener("submit",function(e){Event.stop(e)})}})}},reverseSort:function(){return this.sort="asc"==this.sort?"desc":"asc",this.passSortParam=!0,this.updateTimeline(),!1},updateTimeline:function(e){e=e||{};this.options.loadingContainer.classList.add("loading"),this.options.filterForm&&Object.assign(e,jQuery(document.getElementById(this.options.filterForm)).serializeObject()),this.passSortParam&&(e[this.options.sortParam]=this.sort,this.passSortParam=!1),e.profile_id=this.profileId,this.timelineAjax&&(this.timelineAjax.options.onComplete=function(){},this.timelineAjax=null),this.timelineAjax=new Geni.Updater(this.timeline,this.options.updateTimelineUrl,{method:"get",parameters:e,evalScripts:!0,onComplete:function(){this.openedEventArray=[],this.options.loadingContainer.classList.remove("loading"),this.setHeight(),this.options.onUpdate&&this.options.onUpdate(e),this.registerTimelineBehaviors(),this.options.reRegisterButtons&&this.registerButtons(),this.options.reverseTimelineButton&&document.getElementById(this.options.reverseTimelineButton)&&(document.getElementById(this.options.reverseTimelineButton).classList.remove("asc"),document.getElementById(this.options.reverseTimelineButton).classList.add(this.sort))}.bind(this)})},setHeight:function(){if(this.options.maximumHeight){var e=this.options.timelineContainer?document.getElementById(this.options.timelineContainer):this.timeline;e.setStyle({height:"auto"});var t=e.getHeight(),i=t>this.options.maximumHeight?this.options.maximumHeight+"px":t<this.options.minimumHeight?this.options.minimumHeight+"px":t+"px";e.setStyle({height:i})}},setOptions:function(e){this.options=jQuery.extend({maximumHeight:335,minimumHeight:35,useHover:!0,allowEditableYear:!0,updateTimelineUrl:"/events",eventsNumberElement:null,reverseTimelineButton:null,allowHideEvent:!0,allowAddAttendee:!0,showMoreDetails:!0,loadingContainer:this.timeline,timelineContainer:null,filterForm:null,reRegisterButtons:!0,onUpdate:null,sortParam:"timeline_sort"},e||{})}};var DateData=function(e,t){this.format=e||0,this.months=t||[["January","February","March","April","May","June","July","August","September","October","November","December"]],this.parts=[]};DateData.prototype={isPartial:function(){return!this.month||!this.day||this.year},isEmpty:function(){return!this.month&&!this.day&&!this.year},toDate:function(){var e=new Date;return e.setFullYear(this.year,this.month?this.month-1:0,this.day),e},toLabel:function(e){switch("number"!=typeof e&&(e=parseInt(e||this.format)),e){case 1:return trl("DD MM YYYY");case 2:return trl("YYYY MM DD");default:return trl("MM DD YYYY")}},invalidDateError:function(){return trl("Invalid Date (Format: {format})").replace(/\{format\}/,this.toLabel())},toString:function(e,t){var i=[];switch("number"!=typeof e&&(e=parseInt(e)),this.month&&1==this.month.length&&(this.month="0"+this.month),this.day&&1==this.day.length&&(this.day="0"+this.day),e){case 1:i=[this.day,this.month,this.year];break;case 2:i=[this.year,this.month,this.day];break;default:i=[this.month,this.day,this.year]}if(!this.regex){var n=(t+t).replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&");this.regex=new RegExp("^"+n+"|"+n+"$","g")}return i.join(t).replace(this.regex,"")},toPreview:function(){if(!this._validate())return!1;labels=[],this.month&&labels.push("{month_name}"),this.month&&(this.day||this.year)&&labels.push(" "),this.day&&labels.push("{days}"),this.day&&this.year&&labels.push(", "),this.year&&labels.push("{years}");var e=this.month?this.month-1:0;return trl(labels.join(""),"Partial Date",{month_name:Geni.User.preferences.date.months[0][e],days:this.day,years:this.year})},_validate:function(){return(!this.month||this.month>=1&&this.month<=12)&&((!this.day||this.day>=1&&this.day<=31)&&(!this.year||this.year>=Geni.MIN_YEAR&&this.year<=Geni.MAX_YEAR))},_monthNum:function(e){if(0==e.length)return-1;for(var t=-1,i=e.toLowerCase(),n=-1;++t<this.months.length;){var a=-1;if((n=this.months[t].map(e=>e.toLowerCase()).indexOf(i))>=0)return n+1}for(t=-1;++t<this.months.length;)for(a=-1;++a<this.months[t].length;)if(-1!=this.months[t][a].toLowerCase().indexOf(i))return a+1;return-1},_stripOrdinal:function(e){return/[0-9]+[a-z]+/.exec(e)?/[0-9]+/.exec(e):e},_maxDaysInMonth:function(e,t){var i=parseInt(e),n=parseInt(t)||2020;return i&&n?new Date(n,i,0).getDate():31},_isYear:function(e){return!!e&&0==e.search(/^-?\d+$/)},_isMonth:function(e){return!!e&&(0==e.search(/^\d+$/)&&(e>0&&e<13))},_hasMonth:function(){return null!=this.month},_isDay:function(e,t,i){return!!e&&(-1!=e.search(/^-?\d+$/)&&(t||(t=this.month),i||(i=this.year),e>0&&e<=this._maxDaysInMonth(t,i)))},_compactDelimiters:function(e){if(-1==e.search(/[^\w\-]{2}/))return e;var t=e.split(""),i=null;return t.filter(function(e){return 0==e.search(/\w|\-/)?(i=null,!0):null==i?(i=e,!0):i===e||(i=e,!1)}).join("")},_trimSpaces:function(e){var t=e.trim();return t==e?e:(t.match(/\W(?!\W)/g)||[]).length>1?t:e},_innerSplit:function(e,t){if(-1==e.join("").indexOf("-"))return!1;t==undefined&&(t=3);var i=[];return e.forEach(function(e){if(e.indexOf("--")>-1){var t=e.indexOf("--");i.push(e.slice(0,t)),i.push(e.slice(t+1))}else if(e.indexOf("-")>-1){t=e.lastIndexOf("-");i.push(e.slice(0,t)),i.push(e.slice(t+1))}else i.push(e)}),!(i.length>t)&&(i.length==t?i:-1==i.join("").indexOf("-")?i:(e=i,this.format<2?e[0].indexOf("-")>-1?(i=this._innerSplit([e[0]],t-1)).push(e[1]):(i=this._innerSplit([e[1]],t-1)).unshift(e[0]):e[1].lastIndexOf("-")>-1?(i=this._innerSplit([e[1]],t-1)).unshift(e[0]):e[0].lastIndexOf("-")>0&&(i=this._innerSplit([e[0]],t-1)).push(e[1]),i))},parseDateString:function(e,t){if(this.day=this.month=this.year=null,e=this._compactDelimiters(e),e=(e=this._trimSpaces(e)).replace(/[^\w-]/g,"_"),this.parts=e.split(/_+/).filter(function(e){return"-"!=e.replace(/-+/g,"-")}),this.parts.length<3&&(this.parts=e.split(/_/).filter(function(e){return"-"!=e.replace(/-+/g,"-")}),this.parts.length<3&&e.indexOf("-"))){var i=this.parts.length,n=(e.match(/-/g)||[]).length,a=0;for(2==this.format&&e.match(/^-\d/)&&i+n>2&&(a=1);a<e.length&&!("-"==e[a]&&(e=e.substring(0,a)+"_"+e.substring(a+1),(i+=1)>2));)a+=1;this.parts=e.split(/_/).filter(function(e){return"-"!=e.replace(/-+/g,"-")})}for(;this.parts.length>3;){var r=!1,s=this;if(this.parts.forEach(function(e,t){0==e.replace(/-/g,"").length&&(s.parts.splice(t,1),r=!0)}),!r)break}s=this;for(this.parts.forEach(function(e,t){e.match(/^-\d/)||(e=e.replace(/^-/,"")),e=e.replace(/-$/,""),s.parts[t]=e});this.parts.length>0&&""==this.parts[this.parts.length-1];)this.parts=this.parts.splice(0,this.parts.length-1);for(;;){if(this.parts.length>3)return this;var o=!1;switch(this.format){case 0:o=this.parse_us_date(this.parts);break;case 1:o=this.parse_euro_date(this.parts);break;default:o=this.parse_yyyy_date(this.parts)}if(o)break;if(this.parts=this._innerSplit(this.parts),!this.parts)break}if("string"==typeof this.month&&(this.month=this.month.replace(/^0+/,"")),"string"==typeof this.day&&(this.day=this.day.replace(/^0+/,"")),!this.parts){if(e.endsWith(" "))return this.parseDateString(e.trimRight(),t);if(e.startsWith(" "))return this.parseDateString(e.trimLeft(),t)}return this},parse_us_date:function(e){if(e.length<1)return!1;var t=this._monthNum(e[0]);if(-1!=t&&(this.month=t),e.length>1&&!this._hasMonth()&&-1!=(t=this._monthNum(e[1]))){if(this.month=t,this._isDay(e[0]))this.day=e[0];else if(e[0].length>0)return!1;if(e[2])if(this._isYear(e[2]))this.year=e[2];else if(e[2].length>0)return!1;return!0}switch(e.length){case 1:if(this._hasMonth())return!0;if(this._isYear(e[0]))return this.year=e[0],!0;if(e[0].length>0)return!1;break;case 2:if(!this._hasMonth())if(this._isMonth(e[0]))this.month=e[0];else if(e[0].length>0)return!1;if(this._isDay(e[1]))this.day=e[1];else if(this._isYear(e[1]))this.year=e[1];else if(e[1].length>0)return!1;break;case 3:if(!this._hasMonth())if(this._isMonth(e[0]))this.month=e[0];else if(e[0].length>0)return!1;if(this._isDay(e[1]))this.day=e[1];else if(e[1].length>0)return!1;if(this._isYear(e[2]))this.year=e[2];else if(e[2].length>0)return!1;break;default:return!1}return!0},parse_euro_date:function(e){if(e.length<1)return!1;var t=this._monthNum(e[0]);if(-1!=t&&(this.month=t,e[0]=t.toString(),e.length>=2&&(e[0]=e[1],e[1]=t.toString())),e.length>1&&-1!=(t=this._monthNum(e[1]))){if(this.month=t,this._isDay(e[0]))this.day=e[0];else if(this._isYear(e[0]))this.year=e[0];else if(e[0].length>0)return!1;if(2==e.length)return!0}switch(e.length){case 1:if(this._hasMonth())return!0;if(this._isYear(e[0]))return this.year=e[0],!0;if(e[0].length>0)return!1;break;case 2:if(this._isMonth(e[1])&&this._isDay(e[0],e[1]))this.day=e[0],this.month=e[1];else if(this._isMonth(e[0])&&this._isYear(e[1]))this.month=e[0],this.year=e[1];else if(this._isYear(e[0])&&this._isMonth(e[1]))this.year=e[0],this.month=e[1];else if(e[0].length>0||e[1].length>0)return!1;break;case 3:if(!this._hasMonth())if(this._isMonth(e[1]))this.month=e[1];else if(e[1].length>0)return!1;if(this._isDay(e[0]))this.day=e[0];else if(e[0].length>0)return!1;if(this._isYear(e[2]))this.year=e[2];else if(e[2].length>0)return!1;break;default:return!1}return!0},parse_yyyy_date:function(e){if(e.length<1)return!1;var t=this._monthNum(e[0]);if(-1!=t&&(this.month=t,e[0]=t.toString(),e.length>2&&this._isYear(e[2])&&this._isDay(e[1],e[2])&&(e[0]=e[2],e[2]=e[1],e[1]=t.toString())),e.length>1&&""!=e[1]&&-1!=(t=this._monthNum(e[1]))&&(this.month=t,e[1]=t.toString(),this._isYear(e[0])&&(this.year=e[0]),2==e.length))return!0;switch(e.length){case 1:if(this._hasMonth())break;if(this._isYear(e[0]))return this.year=e[0],!0;if(e[0].length>0)return!1;break;case 2:if(this._isMonth(e[0])&&this._isDay(e[1]))this._hasMonth()||(this.month=e[0]),this.day=e[1];else if(this._isMonth(e[0])&&this._isYear(e[1]))this._hasMonth()||(this.month=e[0]),this.year=e[1];else{if(this._isYear(e[0]))this.year=e[0];else if(e[0].length>0)return!1;if(!this._hasMonth())if(this._isMonth(e[1]))this.month=e[1];else if(e[1].length>0)return!1}break;case 3:if(this._isYear(e[0]))this.year=e[0];else if(e[0].length>0)return!1;if(!this._hasMonth())if(this._isMonth(e[1]))this.month=e[1];else if(e[1].length>0)return this.year=this.day=null,!1;if(this._isDay(e[2]))this.day=e[2];else if(e[2].length>0)return this.year=this.month=this.day=null,!1;break;default:return!1}return!0}},DateData.getInstance=function(){return this.instance=this.instance||new DateData,this.instance};var DateFields=function(){this.dateData=DateData.getInstance(),this.setup()};DateFields.prototype={setup:function(){if(this.is_setup)Geni.User.preferences.date.format_set||Geni.UI.DateFields.askUserToChooseFormat(),Geni.J.TippedTip.makeTippedTip();else{var e=this;jQuery("body").on("keyup paste",function(t){if(jQuery(t.target).hasClass("date_input")&&"undefined"!=typeof t.target.value){var i=t.target.value.length>0?500:10;t.target.dateInputTimeout&&clearTimeout(t.target.dateInputTimeout),t.target.dateInputTimeout=setTimeout(function(){e.checkDateField(t,t.target)},i)}}),jQuery("body").on("submit",function(t){jQuery(t.target).find(".date_input").each(function(i,n){e.checkDateField(t,n)})}),jQuery("body").on("change",function(t){jQuery(t.target).hasClass("date_range_selector")&&e.rangeSel(t,t.target)}),this.is_setup=!0}},rangeSel:function(e,t){var i=jQuery(t).closest(".date_field").find(".end_date_field"),n=jQuery(".end_date_field").prev();i&&("between"==t.value?(n.show(),i.show()):(n.hide(),i.hide()))},renderDateField:function(e){var t=jQuery(e).parent(),i=t.find(".date_preview")[0];this.dateData.year=t.find(".date_year")[0].value,this.dateData.month=t.find(".date_month")[0].value,this.dateData.day=t.find(".date_day")[0].value;var n=Geni.User.preferences.date;e.setAttribute("label",this.dateData.toLabel(n.format)),this.dateData.isEmpty()||(e.style.color="",e.value=this.dateData.toString(n.format,n.separator),i.innerText=this.dateData.parseDateString(e.value).toPreview())},checkDateField:function(e,t){var i=this.dateData.parseDateString(t.value),n=jQuery(t).closest(".date_field"),a=jQuery(t).hasClass("validate_birth"),r=n.find(".date_preview")[0],s=n.find(".date_month")[0],o=n.find(".date_day")[0],l=n.find(".date_year")[0];if(""==t.value)return this.toggleSubmission(t,r,!1),r&&(r.innerHTML=""),void(s.value=o.value=l.value="");var u=null,c=!1;"undefined"==typeof i.toPreview().length?(u=i.invalidDateError(),c=!0):0==i.toPreview().length&&t.value.length>0?(u=i.invalidDateError(),c=!0):a&&i.year<Geni.MIN_LIVING_YEAR?(c=!0,i.year&&2==i.year.length?u=tr("Please enter a 4-digit year.","Date validation error message"):i.year&&(u=tr("This profile is too old to be alive.","Date validation error message"))):t.classList.contains("self-service-input")&&2==i.year.length&&(c=!0,u=tr("Please enter a 4-digit year.","Date validation error message")),u||(u=i.toPreview()),t.value==t.getAttribute("label")?(r&&(r.innerHTML=""),s&&(s.value=""),o&&(o.value=""),l&&(l.value="")):(r&&this.toggleSubmission(t,r,c),r&&(r.innerHTML=u),s&&(s.value=i.month),o&&(o.value=i.day),l&&(l.value=i.year))},setMonths:function(e){Array.isArray(e[0])?this.dateData.months=e:this.dateData.months=[e]},setFormat:function(e){this.dateData.format=parseInt(e)},toggleSubmission:function(e,t,i){i?(e.classList.add("warning_msg"),t.classList.add("txt_red"),jQuery(t).closest("form").find("button").prop("disabled",!0)):(e.classList.remove("warning_msg"),t.classList.remove("txt_red"),jQuery(t).closest("form").find("button").prop("disabled",!1))},renderAll:function(){var e=this;jQuery(".date_input").each(function(){e.renderDateField(this)})},rangeSelAll:function(){var e=this;jQuery(".date_range_selector").each(function(){e.rangeSel(null,this)})},askUserToChooseFormat:function(){0!=jQuery(".date_input").length&&(jQuery(".date_input").addClass("tipped-tip").attr({"data-show-on":"focus","data-hide-on":"click-outside","data-element-id":"set-date-format"}),jQuery.ajax("/account_settings/date_format_tooltip").done(function(e){var t=jQuery(e);t.attr({id:"set-date-format"}).hide(),jQuery("body").append(t);var i=t.children("form");i.on("submit",function(e){e.preventDefault(),jQuery.ajax({url:i.attr("action"),method:"POST",data:i.serialize()}).done(function(e){Geni.Tipped.remove(jQuery("input.date_input")),LabelMaker.clearFormLabels(),Geni.User.preferences.date.format_set=e.success;var t=i[0]["preferences[date_format]"].value;Geni.User.preferences.date.format=t,Geni.UI.DateFields.setFormat(t),Geni.UI.DateFields.renderAll(),LabelMaker.init_labels(),bindInlineEventHandlers()})})}))}},GeniLoader.ready(init_date_fields),MultifactorAuthentication=function(e){this.initialize=function(e){this.formSelector=e,this.emailElement=jQuery(e+" [name=username]"),this.pwElement=jQuery(e+" [name=password]"),this.mfaEmails=[],this.nonmfaEmails=[],this.checking=null,0==this.emailElement.length&&(this.emailElement=jQuery(e+" [name=profile\\[username\\]]")),0==this.pwElement.length&&(this.pwElement=jQuery(e+" [name=profile\\[password\\]]")),this.parseCookie(),this.bindEvents(),this.checkEmail()},this.parseCookie=function(){var e=this;Cookie.get_raw("mfaEmails").split(",").forEach(function(t){"undefined"!==t&&e.mfaEmails.push(t)})},this.bindEvents=function(){this.emailElement.on("change",this.checkEmail.bind(this)),this.pwElement.on("focus",this.checkEmail.bind(this))},this.checkEmail=function(){var e=this.emailElement.val();e&&e.length>0&&(this.mfaEmails.indexOf("+"+MD5(e))>-1?this.showSecurityCode():this.mfaEmails.indexOf("+"+e)>-1?this.showSecurityCode():this.mfaEmails.indexOf("-"+MD5(e))>-1?this.hideSecurityCode():this.mfaEmails.indexOf("-"+e)>-1?this.hideSecurityCode():this.checkUser(e))},this.checkUser=function(e){if(e!=this.checking&&isValidEmail(e)){this.checking=e;var t=this;new Geni.Request("/login/mfa_allowed",{method:"post",parameters:{email:e},onSuccess:function(i){"true"==i.responseText?(t.addEmailToCookie(e,!0),t.showSecurityCode(),t.hideFacebookLogin()):(t.addEmailToCookie(e,!1),t.hideSecurityCode(),t.showFacebookLogin())},onDone:function(){t.checking==e&&(t.checking=null)}})}},this.addEmailToCookie=function(e,t){e&&"undefined"!==e&&(this.mfaEmails=this.mfaEmails.filter(function(t){return t!=="+"+MD5(e)}),this.mfaEmails=this.mfaEmails.filter(function(t){return t!=="-"+MD5(e)}),this.mfaEmails=this.mfaEmails.filter(function(t){return t!=="+"+e}),this.mfaEmails=this.mfaEmails.filter(function(t){return t!=="-"+e}),this.mfaEmails.push((t?"+":"-")+MD5(e)),Cookie.set_raw("mfaEmails",this.mfaEmails.slice(-3).join(",")))},this.showSecurityCode=function(){jQuery(this.formSelector+" .mfaInput").show(),jQuery(this.formSelector+" #mfa_open").val("1")},this.hideSecurityCode=function(){jQuery(this.formSelector+" .mfaInput").hide(),jQuery(this.formSelector+" #mfa_open").val("0")},this.hideFacebookLogin=function(){jQuery(".extLogin").hide()},this.showFacebookLogin=function(){jQuery(".extLogin").show()},this.initialize(e)},window.Modernizr=function(e,t,i){function n(e){b.cssText=e}function a(e,t){return n(w.join(e+";")+(t||""))}function r(e,t){return typeof e===t}function s(e,t){return!!~(""+e).indexOf(t)}function o(e,t){for(var n in e){var a=e[n];if(!s(a,"-")&&b[a]!==i)return"pfx"!=t||a}return!1}function l(e,t,n){for(var a in e){var s=t[e[a]];if(s!==i)return!1===n?e[a]:r(s,"function")?s.bind(n||t):s}return!1}function u(e,t,i){var n=e.charAt(0).toUpperCase()+e.slice(1),a=(e+" "+C.join(n+" ")+n).split(" ");return r(t,"string")||r(t,"undefined")?o(a,t):l(a=(e+" "+F.join(n+" ")+n).split(" "),t,i)}function c(){f.input=function(i){for(var n=0,a=i.length;n<a;n++)S[i[n]]=i[n]in _;return S.list&&(S.list=!!t.createElement("datalist")&&!!e.HTMLDataListElement),S}("autocomplete autofocus list placeholder max min multiple pattern required step".split(" ")),f.inputtypes=function(e){for(var n,a,r,s=0,o=e.length;s<o;s++)_.setAttribute("type",a=e[s]),(n="text"!==_.type)&&(_.value=x,_.style.cssText="position:absolute;visibility:hidden;",/^range$/.test(a)&&_.style.WebkitAppearance!==i?(g.appendChild(_),n=(r=t.defaultView).getComputedStyle&&"textfield"!==r.getComputedStyle(_,null).WebkitAppearance&&0!==_.offsetHeight,g.removeChild(_)):/^(search|tel)$/.test(a)||(n=/^(url|email)$/.test(a)?_.checkValidity&&!1===_.checkValidity():_.value!=x)),k[e[s]]=!!n;return k}("search tel url email datetime date month week time datetime-local number range color".split(" "))}var h,d,p="2.6.1",f={},m=!0,g=t.documentElement,v="modernizr",y=t.createElement(v),b=y.style,_=t.createElement("input"),x=":)",E={}.toString,w=" -webkit- -moz- -o- -ms- ".split(" "),A="Webkit Moz O ms",C=A.split(" "),F=A.toLowerCase().split(" "),T={svg:"http://www.w3.org/2000/svg"},j={},k={},S={},D=[],O=D.slice,L=function(e,i,n,a){var r,s,o,l=t.createElement("div"),u=t.body,c=u||t.createElement("body");if(parseInt(n,10))for(;n--;)(o=t.createElement("div")).id=a?a[n]:v+(n+1),l.appendChild(o);return r=["&#173;",'<style id="s',v,'">',e,"</style>"].join(""),l.id=v,(u?l:c).innerHTML+=r,c.appendChild(l),u||(c.style.background="",g.appendChild(c)),s=i(l,e),u?l.parentNode.removeChild(l):c.parentNode.removeChild(c),!!s},P=function(){function e(e,a){a=a||t.createElement(n[e]||"div");var s=(e="on"+e)in a;return s||(a.setAttribute||(a=t.createElement("div")),a.setAttribute&&a.removeAttribute&&(a.setAttribute(e,""),s=r(a[e],"function"),r(a[e],"undefined")||(a[e]=i),a.removeAttribute(e))),a=null,s}var n={select:"input",change:"input",submit:"form",reset:"form",error:"img",load:"img",abort:"img"};return e}(),I={}.hasOwnProperty;for(var B in d=r(I,"undefined")||r(I.call,"undefined")?function(e,t){return t in e&&r(e.constructor.prototype[t],"undefined")}:function(e,t){return I.call(e,t)},Function.prototype.bind||(Function.prototype.bind=function(e){var t=this;if("function"!=typeof t)throw new TypeError;var i=O.call(arguments,1),n=function(){if(this instanceof n){var a=function(){};a.prototype=t.prototype;var r=new a,s=t.apply(r,i.concat(O.call(arguments)));return Object(s)===s?s:r}return t.apply(e,i.concat(O.call(arguments)))};return n}),j.flexbox=function(){return u("flexWrap")},j.canvas=function(){var e=t.createElement("canvas");return!!e.getContext&&!!e.getContext("2d")},j.canvastext=function(){return!!f.canvas&&!!r(t.createElement("canvas").getContext("2d").fillText,"function")},j.webgl=function(){return!!e.WebGLRenderingContext},j.touch=function(){var i;return"ontouchstart"in e||e.DocumentTouch&&t instanceof DocumentTouch?i=!0:L(["@media (",w.join("touch-enabled),("),v,")","{#modernizr{top:9px;position:absolute}}"].join(""),function(e){i=9===e.offsetTop}),i},j.geolocation=function(){return"geolocation"in navigator},j.postmessage=function(){return!!e.postMessage},j.websqldatabase=function(){return!!e.openDatabase},j.indexedDB=function(){return!!u("indexedDB",e)},j.hashchange=function(){return P("hashchange",e)&&(t.documentMode===i||t.documentMode>7)},j.history=function(){return!!e.history&&!!history.pushState},j.draganddrop=function(){var e=t.createElement("div");return"draggable"in e||"ondragstart"in e&&"ondrop"in e},j.websockets=function(){return"WebSocket"in e||"MozWebSocket"in e},j.rgba=function(){return n("background-color:rgba(150,255,150,.5)"),s(b.backgroundColor,"rgba")},j.hsla=function(){return n("background-color:hsla(120,40%,100%,.5)"),s(b.backgroundColor,"rgba")||s(b.backgroundColor,"hsla")},j.multiplebgs=function(){return n("background:url(https://),url(https://),red url(https://)"),/(url\s*\(.*?){3}/.test(b.background)},j.backgroundsize=function(){return u("backgroundSize")},j.borderimage=function(){return u("borderImage")},j.borderradius=function(){return u("borderRadius")},j.boxshadow=function(){return u("boxShadow")},j.textshadow=function(){return""===t.createElement("div").style.textShadow},j.opacity=function(){return a("opacity:.55"),/^0.55$/.test(b.opacity)},j.cssanimations=function(){return u("animationName")},j.csscolumns=function(){return u("columnCount")},j.cssgradients=function(){var e="background-image:",t="gradient(linear,left top,right bottom,from(#9f9),to(white));",i="linear-gradient(left top,#9f9, white);";return n((e+"-webkit- ".split(" ").join(t+e)+w.join(i+e)).slice(0,-e.length)),s(b.backgroundImage,"gradient")},j.cssreflections=function(){return u("boxReflect")},j.csstransforms=function(){return!!u("transform")},j.csstransforms3d=function(){var e=!!u("perspective");return e&&"webkitPerspective"in g.style&&L("@media (transform-3d),(-webkit-transform-3d){#modernizr{left:9px;position:absolute;height:3px;}}",function(t){e=9===t.offsetLeft&&3===t.offsetHeight}),e},j.csstransitions=function(){return u("transition")},j.fontface=function(){var e;return L('@font-face {font-family:"font";src:url("https://")}',function(i,n){var a=t.getElementById("smodernizr"),r=a.sheet||a.styleSheet,s=r?r.cssRules&&r.cssRules[0]?r.cssRules[0].cssText:r.cssText||"":"";e=/src/i.test(s)&&0===s.indexOf(n.split(" ")[0])}),e},j.generatedcontent=function(){var e;return L(['#modernizr:after{content:"',x,'";visibility:hidden}'].join(""),function(t){e=t.offsetHeight>=1}),e},j.video=function(){var e=t.createElement("video"),i=!1;try{(i=!!e.canPlayType)&&((i=new Boolean(i)).ogg=e.canPlayType('video/ogg; codecs="theora"').replace(/^no$/,""),i.h264=e.canPlayType('video/mp4; codecs="avc1.42E01E"').replace(/^no$/,""),i.webm=e.canPlayType('video/webm; codecs="vp8, vorbis"').replace(/^no$/,""))}catch(p){}return i},j.audio=function(){var e=t.createElement("audio"),i=!1;try{(i=!!e.canPlayType)&&((i=new Boolean(i)).ogg=e.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),i.mp3=e.canPlayType("audio/mpeg;").replace(/^no$/,""),i.wav=e.canPlayType('audio/wav; codecs="1"').replace(/^no$/,""),
i.m4a=(e.canPlayType("audio/x-m4a;")||e.canPlayType("audio/aac;")).replace(/^no$/,""))}catch(p){}return i},j.localstorage=function(){try{return localStorage.setItem(v,v),localStorage.removeItem(v),!0}catch(e){return!1}},j.sessionstorage=function(){try{return sessionStorage.setItem(v,v),sessionStorage.removeItem(v),!0}catch(e){return!1}},j.webworkers=function(){return!!e.Worker},j.applicationcache=function(){return!!e.applicationCache},j.svg=function(){return!!t.createElementNS&&!!t.createElementNS(T.svg,"svg").createSVGRect},j.inlinesvg=function(){var e=t.createElement("div");return e.innerHTML="<svg/>",(e.firstChild&&e.firstChild.namespaceURI)==T.svg},j.smil=function(){return!!t.createElementNS&&/SVGAnimate/.test(E.call(t.createElementNS(T.svg,"animate")))},j.svgclippaths=function(){return!!t.createElementNS&&/SVGClipPath/.test(E.call(t.createElementNS(T.svg,"clipPath")))},j)d(j,B)&&(h=B.toLowerCase(),f[h]=j[B](),D.push((f[h]?"":"no-")+h));return f.input||c(),f.addTest=function(e,t){if("object"==typeof e)for(var n in e)d(e,n)&&f.addTest(n,e[n]);else{if(e=e.toLowerCase(),f[e]!==i)return f;t="function"==typeof t?t():t,m&&(g.className+=" "+(t?"":"no-")+e),f[e]=t}return f},n(""),y=_=null,function(e,t){function i(e,t){var i=e.createElement("p"),n=e.getElementsByTagName("head")[0]||e.documentElement;return i.innerHTML="x<style>"+t+"</style>",n.insertBefore(i.lastChild,n.firstChild)}function n(){var e=v.elements;return"string"==typeof e?e.split(" "):e}function a(e){var t=g[e[f]];return t||(t={},m++,e[f]=m,g[m]=t),t}function r(e,i,n){return i||(i=t),c?i.createElement(e):(n||(n=a(i)),(r=n.cache[e]?n.cache[e].cloneNode():p.test(e)?(n.cache[e]=n.createElem(e)).cloneNode():n.createElem(e)).canHaveChildren&&!d.test(e)?n.frag.appendChild(r):r);var r}function s(e,i){if(e||(e=t),c)return e.createDocumentFragment();for(var r=(i=i||a(e)).frag.cloneNode(),s=0,o=n(),l=o.length;s<l;s++)r.createElement(o[s]);return r}function o(e,t){t.cache||(t.cache={},t.createElem=e.createElement,t.createFrag=e.createDocumentFragment,t.frag=t.createFrag()),e.createElement=function(i){return v.shivMethods?r(i,e,t):t.createElem(i)},e.createDocumentFragment=Function("h,f","return function(){var n=f.cloneNode(),c=n.createElement;h.shivMethods&&("+n().join().replace(/\w+/g,function(e){return t.createElem(e),t.frag.createElement(e),'c("'+e+'")'})+");return n}")(v,t.frag)}function l(e){e||(e=t);var n=a(e);return v.shivCSS&&!u&&!n.hasCSS&&(n.hasCSS=!!i(e,"article,aside,figcaption,figure,footer,header,hgroup,nav,section{display:block}mark{background:#FF0;color:#000}")),c||o(e,n),e}var u,c,h=e.html5||{},d=/^<|^(?:button|map|select|textarea|object|iframe|option|optgroup)$/i,p=/^<|^(?:a|b|button|code|div|fieldset|form|h1|h2|h3|h4|h5|h6|i|iframe|img|input|label|li|link|ol|option|p|param|q|script|select|span|strong|style|table|tbody|td|textarea|tfoot|th|thead|tr|ul)$/i,f="_html5shiv",m=0,g={};!function(){try{var e=t.createElement("a");e.innerHTML="<xyz></xyz>",u="hidden"in e,c=1==e.childNodes.length||function(){t.createElement("a");var e=t.createDocumentFragment();return"undefined"==typeof e.cloneNode||"undefined"==typeof e.createDocumentFragment||"undefined"==typeof e.createElement}()}catch(h){u=!0,c=!0}}();var v={elements:h.elements||"abbr article aside audio bdi canvas data datalist details figcaption figure footer header hgroup mark meter nav output progress section summary time video",shivCSS:!1!==h.shivCSS,supportsUnknownElements:c,shivMethods:!1!==h.shivMethods,type:"default",shivDocument:l,createElement:r,createDocumentFragment:s};e.html5=v,l(t)}(this,t),f._version=p,f._prefixes=w,f._domPrefixes=F,f._cssomPrefixes=C,f.hasEvent=P,f.testProp=function(e){return o([e])},f.testAllProps=u,f.testStyles=L,g.className=g.className.replace(/(^|\s)no-js(\s|$)/,"$1$2")+(m?" js "+D.join(" "):""),f}(this,this.document),function(){function e(t,i,n){if(t===i)return 0!==t||1/t==1/i;if(null==t||null==i)return t===i;if(t._chain&&(t=t._wrapped),i._chain&&(i=i._wrapped),t.isEqual&&w.isFunction(t.isEqual))return t.isEqual(i);if(i.isEqual&&w.isFunction(i.isEqual))return i.isEqual(t);var a=u.call(t);if(a!=u.call(i))return!1;switch(a){case"[object String]":return t==String(i);case"[object Number]":return t!=+t?i!=+i:0==t?1/t==1/i:t==+i;case"[object Date]":case"[object Boolean]":return+t==+i;case"[object RegExp]":return t.source==i.source&&t.global==i.global&&t.multiline==i.multiline&&t.ignoreCase==i.ignoreCase}if("object"!=typeof t||"object"!=typeof i)return!1;for(var r=n.length;r--;)if(n[r]==t)return!0;n.push(t);var s=0,o=!0;if("[object Array]"==a){if(o=(s=t.length)==i.length)for(;s--&&(o=s in t==s in i&&e(t[s],i[s],n)););}else{if("constructor"in t!="constructor"in i||t.constructor!=i.constructor)return!1;for(var l in t)if(w.has(t,l)&&(s++,!(o=w.has(i,l)&&e(t[l],i[l],n))))break;if(o){for(l in i)if(w.has(i,l)&&!s--)break;o=!s}}return n.pop(),o}var t=this,i=t._,n={},a=Array.prototype,r=Object.prototype,s=Function.prototype,o=a.slice,l=a.unshift,u=r.toString,c=r.hasOwnProperty,h=a.forEach,d=a.map,p=a.reduce,f=a.reduceRight,m=a.filter,g=a.every,v=a.some,y=a.indexOf,b=a.lastIndexOf,_=Array.isArray,x=Object.keys,E=s.bind,w=function(e){return new P(e)};"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=w),exports._=w):t._=w,w.VERSION="1.3.3";var A=w.each=w.forEach=function(e,t,i){if(null!=e)if(h&&e.forEach===h)e.forEach(t,i);else if(e.length===+e.length){for(var a=0,r=e.length;a<r;a++)if(a in e&&t.call(i,e[a],a,e)===n)return}else for(var s in e)if(w.has(e,s)&&t.call(i,e[s],s,e)===n)return};w.map=w.collect=function(e,t,i){var n=[];return null==e?n:d&&e.map===d?e.map(t,i):(A(e,function(e,a,r){n[n.length]=t.call(i,e,a,r)}),e.length===+e.length&&(n.length=e.length),n)},w.reduce=w.foldl=w.inject=function(e,t,i,n){var a=arguments.length>2;if(null==e&&(e=[]),p&&e.reduce===p)return n&&(t=w.bind(t,n)),a?e.reduce(t,i):e.reduce(t);if(A(e,function(e,r,s){a?i=t.call(n,i,e,r,s):(i=e,a=!0)}),!a)throw new TypeError("Reduce of empty array with no initial value");return i},w.reduceRight=w.foldr=function(e,t,i,n){var a=arguments.length>2;if(null==e&&(e=[]),f&&e.reduceRight===f)return n&&(t=w.bind(t,n)),a?e.reduceRight(t,i):e.reduceRight(t);var r=w.toArray(e).reverse();return n&&!a&&(t=w.bind(t,n)),a?w.reduce(r,t,i,n):w.reduce(r,t)},w.find=w.detect=function(e,t,i){var n;return C(e,function(e,a,r){if(t.call(i,e,a,r))return n=e,!0}),n},w.filter=w.select=function(e,t,i){var n=[];return null==e?n:m&&e.filter===m?e.filter(t,i):(A(e,function(e,a,r){t.call(i,e,a,r)&&(n[n.length]=e)}),n)},w.reject=function(e,t,i){var n=[];return null==e?n:(A(e,function(e,a,r){t.call(i,e,a,r)||(n[n.length]=e)}),n)},w.every=w.all=function(e,t,i){var a=!0;return null==e?a:g&&e.every===g?e.every(t,i):(A(e,function(e,r,s){if(!(a=a&&t.call(i,e,r,s)))return n}),!!a)};var C=w.some=w.any=function(e,t,i){t||(t=w.identity);var a=!1;return null==e?a:v&&e.some===v?e.some(t,i):(A(e,function(e,r,s){if(a||(a=t.call(i,e,r,s)))return n}),!!a)};w.include=w.contains=function(e,t){var i=!1;return null==e?i:y&&e.indexOf===y?-1!=e.indexOf(t):i=C(e,function(e){return e===t})},w.invoke=function(e,t){var i=o.call(arguments,2);return w.map(e,function(e){return(w.isFunction(t)?t||e:e[t]).apply(e,i)})},w.pluck=function(e,t){return w.map(e,function(e){return e[t]})},w.max=function(e,t,i){if(!t&&w.isArray(e)&&e[0]===+e[0])return Math.max.apply(Math,e);if(!t&&w.isEmpty(e))return-Infinity;var n={computed:-Infinity};return A(e,function(e,a,r){var s=t?t.call(i,e,a,r):e;s>=n.computed&&(n={value:e,computed:s})}),n.value},w.min=function(e,t,i){if(!t&&w.isArray(e)&&e[0]===+e[0])return Math.min.apply(Math,e);if(!t&&w.isEmpty(e))return Infinity;var n={computed:Infinity};return A(e,function(e,a,r){var s=t?t.call(i,e,a,r):e;s<n.computed&&(n={value:e,computed:s})}),n.value},w.shuffle=function(e){var t,i=[];return A(e,function(e,n){t=Math.floor(Math.random()*(n+1)),i[n]=i[t],i[t]=e}),i},w.sortBy=function(e,t,i){var n=w.isFunction(t)?t:function(e){return e[t]};return w.pluck(w.map(e,function(e,t,a){return{value:e,criteria:n.call(i,e,t,a)}}).sort(function(e,t){var i=e.criteria,n=t.criteria;return void 0===i?1:void 0===n?-1:i<n?-1:i>n?1:0}),"value")},w.groupBy=function(e,t){var i={},n=w.isFunction(t)?t:function(e){return e[t]};return A(e,function(e,t){var a=n(e,t);(i[a]||(i[a]=[])).push(e)}),i},w.sortedIndex=function(e,t,i){i||(i=w.identity);for(var n=0,a=e.length;n<a;){var r=n+a>>1;i(e[r])<i(t)?n=r+1:a=r}return n},w.toArray=function(e){return e?w.isArray(e)?o.call(e):w.isArguments(e)?o.call(e):e.toArray&&w.isFunction(e.toArray)?e.toArray():w.values(e):[]},w.size=function(e){return w.isArray(e)?e.length:w.keys(e).length},w.first=w.head=w.take=function(e,t,i){return null==t||i?e[0]:o.call(e,0,t)},w.initial=function(e,t,i){return o.call(e,0,e.length-(null==t||i?1:t))},w.last=function(e,t,i){return null==t||i?e[e.length-1]:o.call(e,Math.max(e.length-t,0))},w.rest=w.tail=function(e,t,i){return o.call(e,null==t||i?1:t)},w.compact=function(e){return w.filter(e,function(e){return!!e})},w.flatten=function(e,t){return w.reduce(e,function(e,i){return w.isArray(i)?e.concat(t?i:w.flatten(i)):(e[e.length]=i,e)},[])},w.without=function(e){return w.difference(e,o.call(arguments,1))},w.uniq=w.unique=function(e,t,i){var n=i?w.map(e,i):e,a=[];return e.length<3&&(t=!0),w.reduce(n,function(i,n,r){return(t?w.last(i)===n&&i.length:w.include(i,n))||(i.push(n),a.push(e[r])),i},[]),a},w.union=function(){return w.uniq(w.flatten(arguments,!0))},w.intersection=w.intersect=function(e){var t=o.call(arguments,1);return w.filter(w.uniq(e),function(e){return w.every(t,function(t){return w.indexOf(t,e)>=0})})},w.difference=function(e){var t=w.flatten(o.call(arguments,1),!0);return w.filter(e,function(e){return!w.include(t,e)})},w.zip=function(){for(var e=o.call(arguments),t=w.max(w.pluck(e,"length")),i=new Array(t),n=0;n<t;n++)i[n]=w.pluck(e,""+n);return i},w.indexOf=function(e,t,i){if(null==e)return-1;var n,a;if(i)return e[n=w.sortedIndex(e,t)]===t?n:-1;if(y&&e.indexOf===y)return e.indexOf(t);for(n=0,a=e.length;n<a;n++)if(n in e&&e[n]===t)return n;return-1},w.lastIndexOf=function(e,t){if(null==e)return-1;if(b&&e.lastIndexOf===b)return e.lastIndexOf(t);for(var i=e.length;i--;)if(i in e&&e[i]===t)return i;return-1},w.range=function(e,t,i){arguments.length<=1&&(t=e||0,e=0),i=arguments[2]||1;for(var n=Math.max(Math.ceil((t-e)/i),0),a=0,r=new Array(n);a<n;)r[a++]=e,e+=i;return r};var F=function(){};w.bind=function(e,t){var i,n;if(e.bind===E&&E)return E.apply(e,o.call(arguments,1));if(!w.isFunction(e))throw new TypeError;return n=o.call(arguments,2),i=function(){if(!(this instanceof i))return e.apply(t,n.concat(o.call(arguments)));F.prototype=e.prototype;var a=new F,r=e.apply(a,n.concat(o.call(arguments)));return Object(r)===r?r:a}},w.bindAll=function(e){var t=o.call(arguments,1);return 0==t.length&&(t=w.functions(e)),A(t,function(t){e[t]=w.bind(e[t],e)}),e},w.memoize=function(e,t){var i={};return t||(t=w.identity),function(){var n=t.apply(this,arguments);return w.has(i,n)?i[n]:i[n]=e.apply(this,arguments)}},w.delay=function(e,t){var i=o.call(arguments,2);return setTimeout(function(){return e.apply(null,i)},t)},w.defer=function(e){return w.delay.apply(w,[e,1].concat(o.call(arguments,1)))},w.throttle=function(e,t){var i,n,a,r,s,o,l=w.debounce(function(){s=r=!1},t);return function(){i=this,n=arguments;var u=function(){a=null,s&&e.apply(i,n),l()};return a||(a=setTimeout(u,t)),r?s=!0:o=e.apply(i,n),l(),r=!0,o}},w.debounce=function(e,t,i){var n;return function(){var a=this,r=arguments,s=function(){n=null,i||e.apply(a,r)};i&&!n&&e.apply(a,r),clearTimeout(n),n=setTimeout(s,t)}},w.once=function(e){var t,i=!1;return function(){return i?t:(i=!0,t=e.apply(this,arguments))}},w.wrap=function(e,t){return function(){var i=[e].concat(o.call(arguments,0));return t.apply(this,i)}},w.compose=function(){var e=arguments;return function(){for(var t=arguments,i=e.length-1;i>=0;i--)t=[e[i].apply(this,t)];return t[0]}},w.after=function(e,t){return e<=0?t():function(){if(--e<1)return t.apply(this,arguments)}},w.keys=x||function(e){if(e!==Object(e))throw new TypeError("Invalid object");var t=[];for(var i in e)w.has(e,i)&&(t[t.length]=i);return t},w.values=function(e){return w.map(e,w.identity)},w.functions=w.methods=function(e){var t=[];for(var i in e)w.isFunction(e[i])&&t.push(i);return t.sort()},w.extend=function(e){return A(o.call(arguments,1),function(t){for(var i in t)e[i]=t[i]}),e},w.pick=function(e){var t={};return A(w.flatten(o.call(arguments,1)),function(i){i in e&&(t[i]=e[i])}),t},w.defaults=function(e){return A(o.call(arguments,1),function(t){for(var i in t)null==e[i]&&(e[i]=t[i])}),e},w.clone=function(e){return w.isObject(e)?w.isArray(e)?e.slice():w.extend({},e):e},w.tap=function(e,t){return t(e),e},w.isEqual=function(t,i){return e(t,i,[])},w.isEmpty=function(e){if(null==e)return!0;if(w.isArray(e)||w.isString(e))return 0===e.length;for(var t in e)if(w.has(e,t))return!1;return!0},w.isElement=function(e){return!(!e||1!=e.nodeType)},w.isArray=_||function(e){return"[object Array]"==u.call(e)},w.isObject=function(e){return e===Object(e)},w.isArguments=function(e){return"[object Arguments]"==u.call(e)},w.isArguments(arguments)||(w.isArguments=function(e){return!(!e||!w.has(e,"callee"))}),w.isFunction=function(e){return"[object Function]"==u.call(e)},w.isString=function(e){return"[object String]"==u.call(e)},w.isNumber=function(e){return"[object Number]"==u.call(e)},w.isFinite=function(e){return w.isNumber(e)&&isFinite(e)},w.isNaN=function(e){return e!=e},w.isBoolean=function(e){return!0===e||!1===e||"[object Boolean]"==u.call(e)},w.isDate=function(e){return"[object Date]"==u.call(e)},w.isRegExp=function(e){return"[object RegExp]"==u.call(e)},w.isNull=function(e){return null===e},w.isUndefined=function(e){return void 0===e},w.has=function(e,t){return c.call(e,t)},w.noConflict=function(){return t._=i,this},w.identity=function(e){return e},w.times=function(e,t,i){for(var n=0;n<e;n++)t.call(i,n)},w.escape=function(e){return(""+e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;")},w.result=function(e,t){if(null==e)return null;var i=e[t];return w.isFunction(i)?i.call(e):i},w.mixin=function(e){A(w.functions(e),function(t){B(t,w[t]=e[t])})};var T=0;w.uniqueId=function(e){var t=T++;return e?e+t:t},w.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var j=/.^/,k={"\\":"\\","'":"'",r:"\r",n:"\n",t:"\t",u2028:"\u2028",u2029:"\u2029"};for(var S in k)k[k[S]]=S;var D=/\\|'|\r|\n|\t|\u2028|\u2029/g,O=/\\(\\|'|r|n|t|u2028|u2029)/g,L=function(e){return e.replace(O,function(e,t){return k[t]})};w.template=function(e,t,i){i=w.defaults(i||{},w.templateSettings);var n="__p+='"+e.replace(D,function(e){return"\\"+k[e]}).replace(i.escape||j,function(e,t){return"'+\n_.escape("+L(t)+")+\n'"}).replace(i.interpolate||j,function(e,t){return"'+\n("+L(t)+")+\n'"}).replace(i.evaluate||j,function(e,t){return"';\n"+L(t)+"\n;__p+='"})+"';\n";i.variable||(n="with(obj||{}){\n"+n+"}\n"),n="var __p='';var print=function(){__p+=Array.prototype.join.call(arguments, '')};\n"+n+"return __p;\n";var a=new Function(i.variable||"obj","_",n);if(t)return a(t,w);var r=function(e){return a.call(this,e,w)};return r.source="function("+(i.variable||"obj")+"){\n"+n+"}",r},w.chain=function(e){return w(e).chain()};var P=function(e){this._wrapped=e};w.prototype=P.prototype;var I=function(e,t){return t?w(e).chain():e},B=function(e,t){P.prototype[e]=function(){var e=o.call(arguments);return l.call(e,this._wrapped),I(t.apply(w,e),this._chain)}};w.mixin(w),A(["pop","push","reverse","shift","sort","splice","unshift"],function(e){var t=a[e];P.prototype[e]=function(){var i=this._wrapped;t.apply(i,arguments);var n=i.length;return"shift"!=e&&"splice"!=e||0!==n||delete i[0],I(i,this._chain)}}),A(["concat","join","slice"],function(e){var t=a[e];P.prototype[e]=function(){return I(t.apply(this._wrapped,arguments),this._chain)}}),P.prototype.chain=function(){return this._chain=!0,this},P.prototype.value=function(){return this._wrapped}}.call(this),function(){var e,t=this,i=t.Backbone,n=Array.prototype.slice,a=Array.prototype.splice;(e="undefined"!=typeof exports?exports:t.Backbone={}).VERSION="0.9.1";var r=t._;r||"undefined"==typeof require||(r=require("underscore"));t.jQuery||t.Zepto||t.ender;e.setDomLibrary=function(e){e},e.noConflict=function(){return t.Backbone=i,this},e.emulateHTTP=!1,e.emulateJSON=!1,e.Events={on:function(e,t,i){var n;e=e.split(/\s+/);for(var a=this._callbacks||(this._callbacks={});n=e.shift();){var r=a[n]||(a[n]={}),s=r.tail||(r.tail=r.next={});s.callback=t,s.context=i,r.tail=s.next={}}return this},off:function(e,t,i){var n,a,r;if(e){if(a=this._callbacks)for(e=e.split(/\s+/);n=e.shift();)if(r=a[n],delete a[n],t&&r)for(;(r=r.next)&&r.next;)(r.callback!==t||i&&r.context!==i)&&this.on(n,r.callback,r.context)}else delete this._callbacks;return this},trigger:function(e){var t,i,a,r,s,o,l;if(!(a=this._callbacks))return this;for(o=a.all,(e=e.split(/\s+/)).push(null);t=e.shift();)o&&e.push({next:o.next,tail:o.tail,event:t}),(i=a[t])&&e.push({next:i.next,tail:i.tail});for(l=n.call(arguments,1);i=e.pop();)for(r=i.tail,s=i.event?[i.event].concat(l):l;(i=i.next)!==r;)i.callback.apply(i.context||this,s);return this}},e.Events.bind=e.Events.on,e.Events.unbind=e.Events.off,e.Model=function(e,t){var i;if(e||(e={}),t&&t.parse&&(e=this.parse(e)),(i=b(this,"defaults"))&&(e=r.extend({},i,e)),t&&t.collection&&(this.collection=t.collection),this.attributes={},this._escapedAttributes={},this.cid=r.uniqueId("c"),!this.set(e,{silent:!0}))throw new Error("Can't create an invalid model");delete this._changed,this._previousAttributes=r.clone(this.attributes),this.initialize.apply(this,arguments)},r.extend(e.Model.prototype,e.Events,{idAttribute:"id",initialize:function(){},toJSON:function(){return r.clone(this.attributes)},get:function(e){return this.attributes[e]},escape:function(e){var t;if(t=this._escapedAttributes[e])return t;var i=this.attributes[e];return this._escapedAttributes[e]=r.escape(null==i?"":""+i)},has:function(e){return null!=this.attributes[e]},set:function(t,i,n){var a,s,o;if(r.isObject(t)||null==t?(a=t,n=i):(a={})[t]=i,n||(n={}),!a)return this;if(a instanceof e.Model&&(a=a.attributes),n.unset)for(s in a)a[s]=void 0;if(!this._validate(a,n))return!1;this.idAttribute in a&&(this.id=a[this.idAttribute]);var l=this.attributes,u=this._escapedAttributes,c=this._previousAttributes||{},h=this._setting;for(s in this._changed||(this._changed={}),this._setting=!0,a)o=a[s],r.isEqual(l[s],o)||delete u[s],n.unset?delete l[s]:l[s]=o,this._changing&&!r.isEqual(this._changed[s],o)&&(this.trigger("change:"+s,this,o,n),this._moreChanges=!0),delete this._changed[s],r.isEqual(c[s],o)&&r.has(l,s)==r.has(c,s)||(this._changed[s]=o);return h||(!n.silent&&this.hasChanged()&&this.change(n),this._setting=!1),this},unset:function(e,t){return(t||(t={})).unset=!0,this.set(e,null,t)},clear:function(e){return(e||(e={})).unset=!0,this.set(r.clone(this.attributes),e)},fetch:function(t){t=t?r.clone(t):{};var i=this,n=t.success;return t.success=function(e,a,r){if(!i.set(i.parse(e,r),t))return!1;n&&n(i,e)},t.error=e.wrapError(t.error,i,t),(this.sync||e.sync).call(this,"read",this,t)},save:function(t,i,n){var a,s;r.isObject(t)||null==t?(a=t,n=i):(a={})[t]=i,(n=n?r.clone(n):{}).wait&&(s=r.clone(this.attributes));var o=r.extend({},n,{silent:!0});if(a&&!this.set(a,n.wait?o:n))return!1;var l=this,u=n.success;n.success=function(e,t,i){var s=l.parse(e,i);if(n.wait&&(s=r.extend(a||{},s)),!l.set(s,n))return!1;u?u(l,e):l.trigger("sync",l,e,n)},n.error=e.wrapError(n.error,l,n);var c=this.isNew()?"create":"update",h=(this.sync||e.sync).call(this,c,this,n);return n.wait&&this.set(s,o),h},destroy:function(t){t=t?r.clone(t):{};var i=this,n=t.success,a=function(){i.trigger("destroy",i,i.collection,t)};if(this.isNew())return a();t.success=function(e){t.wait&&a(),n?n(i,e):i.trigger("sync",i,e,t)},t.error=e.wrapError(t.error,i,t);var s=(this.sync||e.sync).call(this,"delete",this,t);return t.wait||a(),s},url:function(){var e=b(this.collection,"url")||b(this,"urlRoot")||_();return this.isNew()?e:e+("/"==e.charAt(e.length-1)?"":"/")+encodeURIComponent(this.id)},parse:function(e){return e},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return null==this.id},change:function(e){if(this._changing||!this.hasChanged())return this;for(var t in this._changing=!0,this._moreChanges=!0,this._changed)this.trigger("change:"+t,this,this._changed[t],e);for(;this._moreChanges;)this._moreChanges=!1,this.trigger("change",this,e);return this._previousAttributes=r.clone(this.attributes),delete this._changed,this._changing=!1,this},hasChanged:function(e){return arguments.length?this._changed&&r.has(this._changed,e):!r.isEmpty(this._changed)},changedAttributes:function(e){if(!e)return!!this.hasChanged()&&r.clone(this._changed);var t,i=!1,n=this._previousAttributes;for(var a in e)r.isEqual(n[a],t=e[a])||((i||(i={}))[a]=t);return i},previous:function(e){return arguments.length&&this._previousAttributes?this._previousAttributes[e]:null},previousAttributes:function(){return r.clone(this._previousAttributes)},isValid:function(){return!this.validate(this.attributes)},_validate:function(e,t){if(t.silent||!this.validate)return!0;e=r.extend({},this.attributes,e);var i=this.validate(e,t);return!i||(t&&t.error?t.error(this,i,t):this.trigger("error",this,i,t),!1)}}),e.Collection=function(e,t){t||(t={}),t.comparator&&(this.comparator=t.comparator),this._reset(),this.initialize.apply(this,arguments),e&&this.reset(e,{silent:!0,parse:t.parse})},r.extend(e.Collection.prototype,e.Events,{model:e.Model,initialize:function(){},toJSON:function(){return this.map(function(e){return e.toJSON()})},add:function(e,t){var i,n,s,o,l,u,c={},h={};for(t||(t={}),i=0,s=(e=r.isArray(e)?e.slice():[e]).length;i<s;i++){if(!(o=e[i]=this._prepareModel(e[i],t)))throw new Error("Can't add an invalid model to a collection");if(c[l=o.cid]||this._byCid[l]||null!=(u=o.id)&&(h[u]||this._byId[u]))throw new Error("Can't add the same model to a collection twice");c[l]=h[u]=o}for(i=0;i<s;i++)(o=e[i]).on("all",this._onModelEvent,this),this._byCid[o.cid]=o,null!=o.id&&(this._byId[o.id]=o);if(this.length+=s,n=null!=t.at?t.at:this.models.length,a.apply(this.models,[n,0].concat(e)),this.comparator&&this.sort({silent:!0}),t.silent)return this;for(i=0,s=this.models.length;i<s;i++)c[(o=this.models[i]).cid]&&(t.index=i,o.trigger("add",o,this,t));return this},remove:function(e,t){var i,n,a,s;for(t||(t={}),i=0,n=(e=r.isArray(e)?e.slice():[e]).length;i<n;i++)(s=this.getByCid(e[i])||this.get(e[i]))&&(delete this._byId[s.id],delete this._byCid[s.cid],a=this.indexOf(s),this.models.splice(a,1),this.length--,t.silent||(t.index=a,s.trigger("remove",s,this,t)),this._removeReference(s));return this},get:function(e){return null==e?null:this._byId[null!=e.id?e.id:e]},getByCid:function(e){return e&&this._byCid[e.cid||e]},at:function(e){return this.models[e]},sort:function(e){if(e||(e={}),!this.comparator)throw new Error("Cannot sort a set without a comparator");var t=r.bind(this.comparator,this);return 1==this.comparator.length?this.models=this.sortBy(t):this.models.sort(t),e.silent||this.trigger("reset",this,e),this},pluck:function(e){return r.map(this.models,function(t){return t.get(e)})},reset:function(e,t){e||(e=[]),t||(t={});for(var i=0,n=this.models.length;i<n;i++)this._removeReference(this.models[i]);return this._reset(),this.add(e,{silent:!0,parse:t.parse}),t.silent||this.trigger("reset",this,t),this},fetch:function(t){(t=t?r.clone(t):{}).parse===undefined&&(t.parse=!0);var i=this,n=t.success;return t.success=function(e,a,r){i[t.add?"add":"reset"](i.parse(e,r),t),n&&n(i,e)},t.error=e.wrapError(t.error,i,t),(this.sync||e.sync).call(this,"read",this,t)},create:function(e,t){var i=this;if(t=t?r.clone(t):{},!(e=this._prepareModel(e,t)))return!1;t.wait||i.add(e,t);var n=t.success;return t.success=function(a,r){t.wait&&i.add(a,t),n?n(a,r):a.trigger("sync",e,r,t)},e.save(null,t),e},parse:function(e){return e},chain:function(){return r(this.models).chain()},_reset:function(){this.length=0,this.models=[],this._byId={},this._byCid={}},_prepareModel:function(t,i){if(t instanceof e.Model)t.collection||(t.collection=this);else{var n=t;i.collection=this,(t=new this.model(n,i))._validate(t.attributes,i)||(t=!1)}return t},_removeReference:function(e){this==e.collection&&delete e.collection,e.off("all",this._onModelEvent,this)},_onModelEvent:function(e,t,i,n){("add"!=e&&"remove"!=e||i==this)&&("destroy"==e&&this.remove(t,n),t&&e==="change:"+t.idAttribute&&(delete this._byId[t.previous(t.idAttribute)],this._byId[t.id]=t),this.trigger.apply(this,arguments))}});var s=["forEach","each","map","reduce","reduceRight","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","max","min","sortBy","sortedIndex","toArray","size","first","initial","rest","last","without","indexOf","shuffle","lastIndexOf","isEmpty","groupBy"];r.each(s,function(t){e.Collection.prototype[t]=function(){return r[t].apply(r,[this.models].concat(r.toArray(arguments)))}}),e.Router=function(e){e||(e={}),e.routes&&(this.routes=e.routes),this._bindRoutes(),this.initialize.apply(this,arguments)};var o=/:\w+/g,l=/\*\w+/g,u=/[-[\]{}()+?.,\\^$|#\s]/g;r.extend(e.Router.prototype,e.Events,{initialize:function(){},route:function(t,i,n){return e.history||(e.history=new e.History),r.isRegExp(t)||(t=this._routeToRegExp(t)),n||(n=this[i]),e.history.route(t,r.bind(function(a){var r=this._extractParameters(t,a);n&&n.apply(this,r),this.trigger.apply(this,["route:"+i].concat(r)),e.history.trigger("route",this,i,r)},this)),this},navigate:function(t,i){e.history.navigate(t,i)},_bindRoutes:function(){if(this.routes){var e=[];for(var t in this.routes)e.unshift([t,this.routes[t]]);for(var i=0,n=e.length;i<n;i++)this.route(e[i][0],e[i][1],this[e[i][1]])}},_routeToRegExp:function(e){return e=e.replace(u,"\\$&").replace(o,"([^/]+)").replace(l,"(.*?)"),new RegExp("^"+e+"$")},_extractParameters:function(e,t){return e.exec(t).slice(1)}}),e.History=function(){this.handlers=[],r.bindAll(this,"checkUrl")};var c=/^[#\/]/,h=/msie [\w.]+/,d=!1;r.extend(e.History.prototype,e.Events,{interval:50,getFragment:function(e,t){if(null==e)if(this._hasPushState||t){e=window.location.pathname;var i=window.location.search;i&&(e+=i)}else e=window.location.hash;return(e=decodeURIComponent(e)).indexOf(this.options.root)||(e=e.substr(this.options.root.length)),e.replace(c,"")},start:function(e){if(d)throw new Error("Backbone.history has already been started");this.options=r.extend({},{root:"/"},this.options,e),this._wantsHashChange=!1!==this.options.hashChange,this._wantsPushState=!!this.options.pushState,this._hasPushState=!!(this.options.pushState&&window.history&&window.history.pushState);var t=this.getFragment(),i=document.documentMode,n=h.exec(navigator.userAgent.toLowerCase())&&(!i||i<=7);n&&(this.iframe=jQuery('<iframe src="javascript:0" tabindex="-1" />').hide().appendTo("body")[0].contentWindow,this.navigate(t)),this._hasPushState?jQuery(window).bind("popstate",this.checkUrl):this._wantsHashChange&&"onhashchange"in window&&!n?jQuery(window).bind("hashchange",this.checkUrl):this._wantsHashChange&&(this._checkUrlInterval=setInterval(this.checkUrl,this.interval)),this.fragment=t,d=!0;var a=window.location,s=a.pathname==this.options.root;return this._wantsHashChange&&this._wantsPushState&&!this._hasPushState&&!s?(this.fragment=this.getFragment(null,!0),window.location.replace(this.options.root+"#"+this.fragment),!0):(this._wantsPushState&&this._hasPushState&&s&&a.hash&&(this.fragment=a.hash.replace(c,""),window.history.replaceState({},document.title,a.protocol+"//"+a.host+this.options.root+this.fragment)),this.options.silent?void 0:this.loadUrl())},stop:function(){jQuery(window).unbind("popstate",this.checkUrl).unbind("hashchange",this.checkUrl),clearInterval(this._checkUrlInterval),d=!1},route:function(e,t){this.handlers.unshift({route:e,callback:t})},checkUrl:function(){var e=this.getFragment();if(e==this.fragment&&this.iframe&&(e=this.getFragment(this.iframe.location.hash)),e==this.fragment||e==decodeURIComponent(this.fragment))return!1;this.iframe&&this.navigate(e),this.loadUrl()||this.loadUrl(window.location.hash)},loadUrl:function(e){var t=this.fragment=this.getFragment(e);return r.any(this.handlers,function(e){if(e.route.test(t))return e.callback(t),!0})},navigate:function(e,t){if(!d)return!1;t&&!0!==t||(t={trigger:t});var i=(e||"").replace(c,"");this.fragment!=i&&this.fragment!=decodeURIComponent(i)&&(this._hasPushState?(0!=i.indexOf(this.options.root)&&(i=this.options.root+i),this.fragment=i,window.history[t.replace?"replaceState":"pushState"]({},document.title,i)):this._wantsHashChange?(this.fragment=i,this._updateHash(window.location,i,t.replace),this.iframe&&i!=this.getFragment(this.iframe.location.hash)&&(t.replace||this.iframe.document.open().close(),this._updateHash(this.iframe.location,i,t.replace))):window.location.assign(this.options.root+e),t.trigger&&this.loadUrl(e))},_updateHash:function(e,t,i){i?e.replace(e.toString().replace(/(javascript:|#).*$/,"")+"#"+t):e.hash=t}}),e.View=function(e){this.cid=r.uniqueId("view"),this._configure(e||{}),this._ensureElement(),this.initialize.apply(this,arguments),this.delegateEvents()};var p=/^(\S+)\s*(.*)$/,f=["model","collection","el","id","attributes","className","tagName"];r.extend(e.View.prototype,e.Events,{tagName:"div",$:function(e){return this.$el.find(e)},initialize:function(){},render:function(){return this},remove:function(){return this.$el.remove(),this},make:function(e,t,i){var n=document.createElement(e);return t&&jQuery(n).attr(t),i&&jQuery(n).html(i),n},setElement:function(e,t){return this.$el=jQuery(e),this.el=this.$el[0],!1!==t&&this.delegateEvents(),this},delegateEvents:function(e){if(e||(e=b(this,"events")))for(var t in this.undelegateEvents(),e){var i=e[t];if(r.isFunction(i)||(i=this[e[t]]),!i)throw new Error('Event "'+e[t]+'" does not exist');var n=t.match(p),a=n[1],s=n[2];i=r.bind(i,this),a+=".delegateEvents"+this.cid,""===s?this.$el.bind(a,i):this.$el.on(a,s,i)}},undelegateEvents:function(){this.$el.off(".delegateEvents"+this.cid)},_configure:function(e){this.options&&(e=r.extend({},this.options,e));for(var t=0,i=f.length;t<i;t++){var n=f[t];e[n]&&(this[n]=e[n])}this.options=e},_ensureElement:function(){if(this.el)this.setElement(this.el,!1);else{var e=b(this,"attributes")||{};this.id&&(e.id=this.id),this.className&&(e["class"]=this.className),this.setElement(this.make(this.tagName,e),!1)}}});var m=function(e,t){var i=y(this,e,t);return i.extend=this.extend,i};e.Model.extend=e.Collection.extend=e.Router.extend=e.View.extend=m;var g={create:"POST",update:"PUT","delete":"DELETE",read:"GET"};e.sync=function(t,i,n){var a=g[t],s={type:a,dataType:"json"};return n.url||(s.url=b(i,"url")||_()),n.data||!i||"create"!=t&&"update"!=t||(s.contentType="application/json",s.data=JSON.stringify(i.toJSON())),e.emulateJSON&&(s.contentType="application/x-www-form-urlencoded",s.data=s.data?{model:s.data}:{}),e.emulateHTTP&&("PUT"!==a&&"DELETE"!==a||(e.emulateJSON&&(s.data._method=a),s.type="POST",s.beforeSend=function(e){e.setRequestHeader("X-HTTP-Method-Override",a)})),"GET"===s.type||e.emulateJSON||(s.processData=!1),jQuery.ajax(r.extend(s,n))},e.wrapError=function(e,t,i){return function(n,a){a=n===t?a:n,e?e(t,a,i):t.trigger("error",t,a,i)}};var v=function(){},y=function(e,t,i){var n;return n=t&&t.hasOwnProperty("constructor")?t.constructor:function(){e.apply(this,arguments)},r.extend(n,e),v.prototype=e.prototype,n.prototype=new v,t&&r.extend(n.prototype,t),i&&r.extend(n,i),n.prototype.constructor=n,n.__super__=e.prototype,n},b=function(e,t){return e&&e[t]?r.isFunction(e[t])?e[t]():e[t]:null},_=function(){throw new Error('A "url" property or function must be specified')}}.call(this),
/******************************************
 * Websanova.com
 *
 * Resources for web entrepreneurs
 *
 * @author          Websanova
 * @copyright       Copyright (c) 2012 Websanova.
 * @license         This websanova JavaScript url is dual licensed under the MIT and GPL licenses.
 * @link            http://www.websanova.com
 * @github          http://github.com/websanova/js-url
 * @version			1.7.2
 *
 ******************************************/
window.url=function(){function e(e){return!isNaN(parseFloat(e))&&isFinite(e)}return function(t,i){var n=i||window.location.toString();"//"===n.substring(0,2)?n="http:"+n:1===n.split("://").length&&(n="http://"+n),i=n.split("/");var a={auth:""},r=i[2].split("@");1===r.length?r=r[0].split(":"):(a.auth=r[0],r=r[1].split(":")),a.protocol=i[0],a.hostname=r[0],a.port=r[1]||"80",a.pathname="/"+i.slice(3,i.length).join("/").split("?")[0].split("#")[0];var s=a.pathname;1===s.split(".").length&&"/"!==s[s.length-1]&&(s+="/");var o=a.hostname,l=o.split("."),u=s.split("/");if(!t)return n;if("hostname"===t)return o;if("domain"===t)return l.slice(-2).join(".");if("tld"===t)return l.slice(-1).join(".");if("sub"===t)return l.slice(0,l.length-2).join(".");if("port"===t)return a.port||"80";if("protocol"===t)return a.protocol.split(":")[0];if("auth"===t)return a.auth;if("user"===t)return a.auth.split(":")[0];if("pass"===t)return a.auth.split(":")[1]||"";if("path"===t)return s;if("."===t[0]){if(e(t=t.substring(1)))return l[(t=parseInt(t))<0?l.length+t:t-1]||""}else{if(e(t))return u[(t=parseInt(t))<0?u.length-1+t:t]||"";if("file"===t)return u.slice(-1)[0];if("filename"===t)return u.slice(-1)[0].split(".")[0];if("fileext"===t)return u.slice(-1)[0].split(".")[1]||"";if("?"===t[0]||"#"===t[0]){var c=n,h=null;if("?"===t[0]?c=(c.split("?")[1]||"").split("#")[0]:"#"===t[0]&&(c=c.split("#")[1]||""),!t[1])return c;t=t.substring(1);for(var d=0,p=(c=c.split("&")).length;d<p;d++)if((h=c[d].split("="))[0]===t)return h[1]}}return""}}();var fb_session_ready_url=null,fb_status=null,fb_session=null,fb_last_clicked_time=0,fb_user_session_activated=null,Cookie={lookup_hash:null,get:function(t){value=Cookie.get_raw(t);try{return JSON.parse(value)}catch(e){return null}},get_raw:function(t){try{return decodeURIComponent(Cookie.lookup().get(t))}catch(e){return unescape(Cookie.lookup()[t])}},set:function(e,t,i,n){Cookie.set_raw(e,JSON.stringify(t),i,n)},set_raw:function(e,t,i,n){null==i&&(i=new Date).setYear(i.getFullYear()+20),null==n&&(n="/"),Cookie.lookup()[e]=t,document.cookie=e+"="+encodeURIComponent(t)+"; expires="+i.toGMTString()+"; path="+n},clear:function(e){Cookie.set_raw(e,"",new Date)},keys:function(){return Object.keys(Cookie.lookup())},lookup:function(){return null==Cookie.lookup_hash&&(Cookie.lookup_hash={},document.cookie.split(";").forEach(function(e){var t=(e=e.replace(/^\s+/,"").replace(/\s+$/,"")).substring(0,e.indexOf("=")),i=e.substring(e.indexOf("=")+1);Cookie.lookup_hash[t]=i})),Cookie.lookup_hash},prune:function(e){Cookie.keys().forEach(function(t){e.forEach(function(e){t.match(e)&&(document.cookie=t+"=; Max-Age=0; path=/;",document.cookie=t+"=; Max-Age=0; domain=.geni.com; path=/;")})})}},Remember={profile_id:null,prefix:"",key:function(){return null==Remember.profile_id?"r_hsh":"r_hsh_"+Remember.profile_id},value:function(e,t){if(cookie=Remember.cookie(),null==t)return cookie[Remember.prefix+e];cookie[Remember.prefix+e]=t,Cookie.set(Remember.key(),cookie)},cookie:function(){return Cookie.get(Remember.key())||{}}};!function(e){e.fn.validationEngineLanguage=function(){},e.validationEngineLanguage={newLang:function(){e.validationEngineLanguage.allRules={required:{regex:"none",alertText:"* This field is required",alertTextCheckboxMultiple:"* Please select an option",alertTextCheckboxe:"* This checkbox is required",alertTextDateRange:"* Both date range fields are required"},requiredInFunction:{func:function(e){return"test"==e.val()},alertText:"* Field must equal test"},dateRange:{regex:"none",alertText:"* Invalid ",alertText2:"Date Range"},dateTimeRange:{regex:"none",alertText:"* Invalid ",alertText2:"Date Time Range"},minSize:{regex:"none",alertText:"* Minimum ",alertText2:" characters required"},maxSize:{regex:"none",alertText:"* Maximum ",alertText2:" characters allowed"},groupRequired:{regex:"none",alertText:"* You must fill one of the following fields"},min:{regex:"none",alertText:"* Minimum value is "},max:{regex:"none",alertText:"* Maximum value is "},past:{regex:"none",alertText:"* Date prior to "},future:{regex:"none",alertText:"* Date past "},maxCheckbox:{regex:"none",alertText:"* Maximum ",alertText2:" options allowed"},minCheckbox:{regex:"none",alertText:"* Please select ",alertText2:" options"},equals:{regex:"none",alertText:"* Fields do not match"},creditCard:{regex:"none",alertText:"* Invalid credit card number"},phone:{regex:/^([\+][0-9]{1,3}[\ \.\-])?([\(]{1}[0-9]{2,6}[\)])?([0-9\ \.\-\/]{3,20})((x|ext|extension)[\ ]?[0-9]{1,4})?$/,alertText:"* Invalid phone number"},email:{regex:/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/,alertText:"* Invalid email address"},integer:{regex:/^[\-\+]?\d+$/,alertText:"* Not a valid integer"},number:{regex:/^[\-\+]?((([0-9]{1,3})([,][0-9]{3})*)|([0-9]+))?([\.]([0-9]+))?$/,alertText:"* Invalid floating decimal number"},date:{func:function(e){var t=new RegExp(/^(\d{4})[\/\-\.](0?[1-9]|1[012])[\/\-\.](0?[1-9]|[12][0-9]|3[01])$/).exec(e.val());if(null==t)return!1;var i=t[1],n=1*t[2],a=1*t[3],r=new Date(i,n-1,a);return r.getFullYear()==i&&r.getMonth()==n-1&&r.getDate()==a},alertText:"* Invalid date, must be in YYYY-MM-DD format"},ipv4:{regex:/^((([01]?[0-9]{1,2})|(2[0-4][0-9])|(25[0-5]))[.]){3}(([0-1]?[0-9]{1,2})|(2[0-4][0-9])|(25[0-5]))$/,alertText:"* Invalid IP address"},url:{regex:/^(https?|ftp):\/\/(((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:)*@)?(((\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5]))|((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?)(:\d*)?)(\/((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)+(\/(([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)*)*)?)?(\?((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|[\uE000-\uF8FF]|\/|\?)*)?(\#((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|\/|\?)*)?$/i,alertText:"* Invalid URL"},onlyNumberSp:{regex:/^[0-9\ ]+$/,alertText:"* Numbers only"},onlyLetterSp:{regex:/^[a-zA-Z\ \']+$/,alertText:"* Letters only"},onlyLetterNumber:{regex:/^[0-9a-zA-Z]+$/,alertText:"* No special characters allowed"},ajaxUserCall:{url:"ajaxValidateFieldUser",extraData:"name=eric",alertText:"* This user is already taken",alertTextLoad:"* Validating, please wait"},ajaxUserCallPhp:{url:"phpajax/ajaxValidateFieldUser.php",extraData:"name=eric",alertTextOk:"* This username is available",alertText:"* This user is already taken",alertTextLoad:"* Validating, please wait"},ajaxNameCall:{url:"ajaxValidateFieldName",alertText:"* This name is already taken",alertTextOk:"* This name is available",alertTextLoad:"* Validating, please wait"},ajaxNameCallPhp:{url:"phpajax/ajaxValidateFieldName.php",alertText:"* This name is already taken",alertTextLoad:"* Validating, please wait"},validate2fields:{alertText:"* Please input HELLO"},dateFormat:{regex:/^\d{4}[\/\-](0?[1-9]|1[012])[\/\-](0?[1-9]|[12][0-9]|3[01])$|^(?:(?:(?:0?[13578]|1[02])(\/|-)31)|(?:(?:0?[1,3-9]|1[0-2])(\/|-)(?:29|30)))(\/|-)(?:[1-9]\d\d\d|\d[1-9]\d\d|\d\d[1-9]\d|\d\d\d[1-9])$|^(?:(?:0?[1-9]|1[0-2])(\/|-)(?:0?[1-9]|1\d|2[0-8]))(\/|-)(?:[1-9]\d\d\d|\d[1-9]\d\d|\d\d[1-9]\d|\d\d\d[1-9])$|^(0?2(\/|-)29)(\/|-)(?:(?:0[48]00|[13579][26]00|[2468][048]00)|(?:\d\d)?(?:0[48]|[2468][048]|[13579][26]))$/,alertText:"* Invalid Date"},dateTimeFormat:{regex:/^\d{4}[\/\-](0?[1-9]|1[012])[\/\-](0?[1-9]|[12][0-9]|3[01])\s+(1[012]|0?[1-9]){1}:(0?[1-5]|[0-6][0-9]){1}:(0?[0-6]|[0-6][0-9]){1}\s+(am|pm|AM|PM){1}$|^(?:(?:(?:0?[13578]|1[02])(\/|-)31)|(?:(?:0?[1,3-9]|1[0-2])(\/|-)(?:29|30)))(\/|-)(?:[1-9]\d\d\d|\d[1-9]\d\d|\d\d[1-9]\d|\d\d\d[1-9])$|^((1[012]|0?[1-9]){1}\/(0?[1-9]|[12][0-9]|3[01]){1}\/\d{2,4}\s+(1[012]|0?[1-9]){1}:(0?[1-5]|[0-6][0-9]){1}:(0?[0-6]|[0-6][0-9]){1}\s+(am|pm|AM|PM){1})$/,alertText:"* Invalid Date or Date Format",alertText2:"Expected Format: ",alertText3:"mm/dd/yyyy hh:mm:ss AM|PM or ",alertText4:"yyyy-mm-dd hh:mm:ss AM|PM"},blank:{regex:/^$/,alertText:"This field must be blank"},defaultTitle:{func:function(e){var t="",i=/page_profile\[names\]\[([a-z]{2,3})/i,n=e.attr("name").match(i);if(n)switch(n[1]){case"en":t=/^((mr\.?)|(mister)|(miss)|(misses)|(mrs\.?)|(ms\.?)|(mx\.?))$/i;break;case"es":t=/^((sr\.?)|(se[n\xf1]or)|(sra\.?)|(se[n\xf1]ora)|(srta\.?)|(se[n\xf1]orita)|(don)|(do[n\xf1]a)|(d\.?))$/i;break;case"pt":t=/^((senhor)|(sr\.?)|(senhora)|(sra\.?)|(senhorita)|(srta\.?)|(dom)|(dona)|(d\.?))$/i;break;case"ar":t=/^((\u0627\u0644\u0633\u064a\u062f)|(\u0633\u064a\u062f)|(\u0645\u0633\u062a\u0631)|(\u0627\u0644\u0633\u064a\u062f\u0629)|(\u0645\u062f\u0627\u0645)|(\u0627\u0644\u0622\u0646\u0633\u0629)|(\u0622\u0646\u0633\u0629))$/i}return!!t.blank||!t.exec(e.val())},alertText:"Please do not enter default titles"}}}},e.validationEngineLanguage.newLang()}(jQuery),function(e){"use strict";var t={init:function(i){var n=this;return n.data("jqv")&&null!=n.data("jqv")||(i=t._saveOptions(n,i),e(document).on("click",".formError",function(){e(this).fadeOut(150,function(){e(this).parent(".formErrorOuter").remove(),e(this).remove()})})),this},attach:function(i){var n,a=this;return(n=i?t._saveOptions(a,i):a.data("jqv")).validateAttribute=a.find("[data-validation-engine*=validate]").length?"data-validation-engine":"class",n.binded&&(a.on(n.validationEventTrigger,"["+n.validateAttribute+"*=validate]:not([type=checkbox]):not([type=radio]):not(.datepicker)",t._onFieldEvent),a.on("click","["+n.validateAttribute+"*=validate][type=checkbox],["+n.validateAttribute+"*=validate][type=radio]",t._onFieldEvent),a.on(n.validationEventTrigger,"["+n.validateAttribute+"*=validate][class*=datepicker]",{delay:300},t._onFieldEvent)),n.autoPositionUpdate&&e(window).bind("resize",{noAnimation:!0,formElem:a},t.updatePromptsPosition),a.on("click","a[data-validation-engine-skip], a[class*='validate-skip'], button[data-validation-engine-skip], button[class*='validate-skip'], input[data-validation-engine-skip], input[class*='validate-skip']",t._submitButtonClick),a.removeData("jqv_submitButton"),a.on("submit",t._onSubmitEvent),this},detach:function(){var i=this,n=i.data("jqv");return i.find("["+n.validateAttribute+"*=validate]").not("[type=checkbox]").off(n.validationEventTrigger,t._onFieldEvent),i.find("["+n.validateAttribute+"*=validate][type=checkbox],[class*=validate][type=radio]").off("click",t._onFieldEvent),i.off("submit",t.onAjaxFormComplete),i.off("submit",t.onAjaxFormComplete),i.removeData("jqv"),i.off("click","a[data-validation-engine-skip], a[class*='validate-skip'], button[data-validation-engine-skip], button[class*='validate-skip'], input[data-validation-engine-skip], input[class*='validate-skip']",t._submitButtonClick),i.removeData("jqv_submitButton"),n.autoPositionUpdate&&e(window).unbind("resize",t.updatePromptsPosition),this},validate:function(){var i=e(this),n=null;if(!i.is("form")&&!i.hasClass("validationEngineContainer")||i.hasClass("validating"))if(i.is("form")||i.hasClass("validationEngineContainer"))i.removeClass("validating");else{var a=i.closest("form, .validationEngineContainer");r=a.data("jqv")?a.data("jqv"):e.validationEngine.defaults;(n=t._validateField(i,r))&&r.onFieldSuccess?r.onFieldSuccess():r.onFieldFailure&&r.InvalidFields.length>0&&r.onFieldFailure()}else{i.addClass("validating");var r=i.data("jqv"),n=t._validateFields(this);setTimeout(function(){i.removeClass("validating")},100),n&&r.onSuccess?r.onSuccess():!n&&r.onFailure&&r.onFailure()}return r.onValidationComplete?!!r.onValidationComplete(a,n):n},updatePromptsPosition:function(i){if(i&&this==window)var n=i.data.formElem,a=i.data.noAnimation;else n=e(this.closest("form, .validationEngineContainer"));var r=n.data("jqv");return n.find("["+r.validateAttribute+"*=validate]").not(":disabled").each(function(){var i=e(this);r.prettySelect&&i.is(":hidden")&&(i=n.find("#"+r.usePrefix+i.attr("id")+r.useSuffix));var s=t._getPrompt(i),o=e(s).find(".formErrorContent").html();s&&t._updatePrompt(i,e(s),o,undefined,!1,r,a)}),this},showPrompt:function(e,i,n,a){var r=this.closest("form, .validationEngineContainer").data("jqv");return r||(r=t._saveOptions(this,r)),n&&(r.promptPosition=n),r.showArrow=1==a,t._showPrompt(this,e,i,!1,r),this},hide:function(){var i,n=e(this).closest("form, .validationEngineContainer").data("jqv"),a=n&&n.fadeDuration?n.fadeDuration:.3;return i=e(this).is("form")||e(this).hasClass("validationEngineContainer")?"parentForm"+t._getClassName(e(this).attr("id")):t._getClassName(e(this).attr("id"))+"formError",e("."+i).fadeTo(a,.3,function(){e(this).parent(".formErrorOuter").remove(),e(this).remove()}),this},hideAll:function(){var t=this.data("jqv"),i=t?t.fadeDuration:300;return e(".formError").fadeTo(i,300,function(){e(this).parent(".formErrorOuter").remove(),e(this).remove()}),this},_onFieldEvent:function(i){var n=e(this),a=n.closest("form, .validationEngineContainer").data("jqv");a.eventTrigger="field",window.setTimeout(function(){t._validateField(n,a),0==a.InvalidFields.length&&a.onFieldSuccess?a.onFieldSuccess():a.InvalidFields.length>0&&a.onFieldFailure&&a.onFieldFailure()},i.data?i.data.delay:0)},_onSubmitEvent:function(){var i=e(this),n=i.data("jqv");if(i.data("jqv_submitButton")){var a=e("#"+i.data("jqv_submitButton"));if(a&&a.length>0&&(a.hasClass("validate-skip")||"true"==a.attr("data-validation-engine-skip")))return!0}n.eventTrigger="submit";var r=t._validateFields(i);return r&&n.ajaxFormValidation?(t._validateFormWithAjax(i,n),!1):n.onValidationComplete?!!n.onValidationComplete(i,r):r},_checkAjaxStatus:function(t){var i=!0;return e.each(t.ajaxValidCache,function(e,t){if(!t)return i=!1,!1}),i},_checkAjaxFieldStatus:function(e,t){return 1==t.ajaxValidCache[e]},_validateFields:function(i){var n=i.data("jqv"),a=!1;i.trigger("jqv.form.validating");var r=null;if(i.find("["+n.validateAttribute+"*=validate]").not(":disabled").each(function(){var s=e(this),o=[];if(e.inArray(s.attr("name"),o)<0){if((a|=t._validateField(s,n))&&null==r&&(r=s.is(":hidden")&&n.prettySelect?s=i.find("#"+n.usePrefix+t._jqSelector(s.attr("id"))+n.useSuffix):s),n.doNotShowAllErrosOnSubmit)return!1;if(o.push(s.attr("name")),1==n.showOneMessage&&a)return!1}}),i.trigger("jqv.form.result",[a]),a){if(n.scroll){var s=r.offset().top,o=r.offset().left,l=n.promptPosition;if("string"==typeof l&&-1!=l.indexOf(":")&&(l=l.substring(0,l.indexOf(":"))),"bottomRight"!=l&&"bottomLeft"!=l){var u=t._getPrompt(r);u&&(s=u.offset().top)}if(n.scrollOffset&&(s-=n.scrollOffset),n.isOverflown){var c=e(n.overflownDIV);if(!c.length)return!1;s+=c.scrollTop()+-parseInt(c.offset().top)-5,e(n.overflownDIV+":not(:animated)").animate({scrollTop:s},1100,function(){n.focusFirstField&&r.focus()})}else e("html, body").animate({scrollTop:s},1100,function(){n.focusFirstField&&r.focus()}),e("html, body").animate({scrollLeft:o},1100)}else n.focusFirstField&&r.focus();return!1}return!0},_validateFormWithAjax:function(i,n){var a=i.serialize(),r=n.ajaxFormValidationMethod?n.ajaxFormValidationMethod:"GET",s=n.ajaxFormValidationURL?n.ajaxFormValidationURL:i.attr("action"),o=n.dataType?n.dataType:"json";e.ajax({type:r,url:s,cache:!1,dataType:o,data:a,form:i,methods:t,options:n,beforeSend:function(){return n.onBeforeAjaxFormValidation(i,n)},error:function(e,i){t._ajaxError(e,i)},success:function(a){if("json"==o&&!0!==a){for(var r=!1,s=0;s<a.length;s++){var l=a[s],u=l[0],c=e(e("#"+u)[0]);if(1==c.length){var h=l[2];if(1==l[1])if(""!=h&&h){if(n.allrules[h])(d=n.allrules[h].alertTextOk)&&(h=d);n.showPrompts&&t._showPrompt(c,h,"pass",!1,n,!0)}else t._closePrompt(c);else{var d;if(r|=!0,n.allrules[h])(d=n.allrules[h].alertText)&&(h=d);n.showPrompts&&t._showPrompt(c,h,"",!1,n,!0)}}}n.onAjaxFormComplete(!r,i,a,n)}else n.onAjaxFormComplete(!0,i,a,n)}})},_validateField:function(i,n,a){if(i.attr("id")||(i.attr("id","form-validation-field-"+e.validationEngine.fieldIdCounter),++e.validationEngine.fieldIdCounter),!n.validateNonVisibleFields&&(i.is(":hidden")&&!n.prettySelect||i.parent().is(":hidden")))return!1;var r=i.attr(n.validateAttribute),s=/validate\[(.*)\]/.exec(r);if(!s)return!1;var o=s[1].split(/\[|,|\]/),l=!1,u=i.attr("name"),c="",h="",d=!1,p=!1;n.isError=!1,n.showArrow=!0,n.maxErrorsPerField>0&&(p=!0);for(var f=e(i.closest("form, .validationEngineContainer")),m=0;m<o.length;m++)o[m]=o[m].replace(" ",""),""===o[m]&&delete o[m];m=0;for(var g=0;m<o.length;m++){if(p&&g>=n.maxErrorsPerField){if(!d){var v=e.inArray("required",o);d=-1!=v&&v>=m}break}var y=undefined;switch(o[m]){case"required":d=!0,y=t._getErrorMessage(f,i,o[m],o,m,n,t._required);break;case"custom":y=t._getErrorMessage(f,i,o[m],o,m,n,t._custom);break;case"groupRequired":var b="["+n.validateAttribute+"*="+o[m+1]+"]",_=f.find(b).eq(0);_[0]!=i[0]&&(t._validateField(_,n,a),n.showArrow=!0),(y=t._getErrorMessage(f,i,o[m],o,m,n,t._groupRequired))&&(d=!0),n.showArrow=!1;break;case"ajax":(y=t._ajax(i,o,m,n))&&(h="load");break;case"minSize":y=t._getErrorMessage(f,i,o[m],o,m,n,t._minSize);break;case"maxSize":y=t._getErrorMessage(f,i,o[m],o,m,n,t._maxSize);break;case"min":y=t._getErrorMessage(f,i,o[m],o,m,n,t._min);break;case"max":y=t._getErrorMessage(f,i,o[m],o,m,n,t._max);break;case"past":y=t._getErrorMessage(f,i,o[m],o,m,n,t._past);break;case"future":y=t._getErrorMessage(f,i,o[m],o,m,n,t._future);break;case"dateRange":b="["+n.validateAttribute+"*="+o[m+1]+"]";n.firstOfGroup=f.find(b).eq(0),n.secondOfGroup=f.find(b).eq(1),(n.firstOfGroup[0].value||n.secondOfGroup[0].value)&&(y=t._getErrorMessage(f,i,o[m],o,m,n,t._dateRange)),y&&(d=!0),n.showArrow=!1;break;case"dateTimeRange":b="["+n.validateAttribute+"*="+o[m+1]+"]";n.firstOfGroup=f.find(b).eq(0),n.secondOfGroup=f.find(b).eq(1),(n.firstOfGroup[0].value||n.secondOfGroup[0].value)&&(y=t._getErrorMessage(f,i,o[m],o,m,n,t._dateTimeRange)),y&&(d=!0),n.showArrow=!1;break;case"maxCheckbox":i=e(f.find("input[name='"+u+"']")),y=t._getErrorMessage(f,i,o[m],o,m,n,t._maxCheckbox);break;case"minCheckbox":i=e(f.find("input[name='"+u+"']")),y=t._getErrorMessage(f,i,o[m],o,m,n,t._minCheckbox);break;case"equals":y=t._getErrorMessage(f,i,o[m],o,m,n,t._equals);break;case"funcCall":y=t._getErrorMessage(f,i,o[m],o,m,n,t._funcCall);break;case"creditCard":y=t._getErrorMessage(f,i,o[m],o,m,n,t._creditCard);break;case"condRequired":(y=t._getErrorMessage(f,i,o[m],o,m,n,t._condRequired))!==undefined&&(d=!0)}var x=!1;if("object"==typeof y)switch(y.status){case"_break":x=!0;break;case"_error":y=y.message;break;case"_error_no_prompt":return!0}if(x)break;"string"==typeof y&&(c+=y+"<br/>",n.isError=!0,g++)}!d&&!i.val()&&i.val().length<1&&(n.isError=!1);var E=i.prop("type"),w=i.data("promptPosition")||n.promptPosition;("radio"==E||"checkbox"==E)&&f.find("input[name='"+u+"']").length>1&&(i=e("inline"===w?f.find("input[name='"+u+"'][type!=hidden]:last"):f.find("input[name='"+u+"'][type!=hidden]:first")),n.showArrow=!1),i.is(":hidden")&&n.prettySelect&&(i=f.find("#"+n.usePrefix+t._jqSelector(i.attr("id"))+n.useSuffix)),n.isError&&n.showPrompts?t._showPrompt(i,c,h,!1,n):l||t._closePrompt(i),l||i.trigger("jqv.field.result",[i,n.isError,c]);var A=e.inArray(i[0],n.InvalidFields);return-1==A?n.isError&&n.InvalidFields.push(i[0]):n.isError||n.InvalidFields.splice(A,1),t._handleStatusCssClasses(i,n),n.isError&&n.onFieldFailure&&n.onFieldFailure(i),!n.isError&&n.onFieldSuccess&&n.onFieldSuccess(i),n.isError},_handleStatusCssClasses:function(e,t){t.addSuccessCssClassToField&&e.removeClass(t.addSuccessCssClassToField),t.addFailureCssClassToField&&e.removeClass(t.addFailureCssClassToField),t.addSuccessCssClassToField&&!t.isError&&e.addClass(t.addSuccessCssClassToField),t.addFailureCssClassToField&&t.isError&&e.addClass(t.addFailureCssClassToField)},_getErrorMessage:function(i,n,a,r,s,o,l){var u=jQuery.inArray(a,r);"custom"!==a&&"funcCall"!==a||(a=a+"["+r[u+1]+"]",delete r[u]);var c,h=a,d=(n.attr("data-validation-engine")?n.attr("data-validation-engine"):n.attr("class")).split(" ");if((c="future"==a||"past"==a||"maxCheckbox"==a||"minCheckbox"==a?l(i,n,r,s,o):l(n,r,s,o))!=undefined){var p=t._getCustomErrorMessage(e(n),d,h,o);p&&(c=p)}return c},_getCustomErrorMessage:function(e,i,n,a){var r=!1,s=t._validityProp[n];if(s!=undefined&&(r=e.attr("data-errormessage-"+s))!=undefined)return r;if((r=e.attr("data-errormessage"))!=undefined)return r;var o="#"+e.attr("id");if("undefined"!=typeof a.custom_error_messages[o]&&"undefined"!=typeof a.custom_error_messages[o][n])r=a.custom_error_messages[o][n].message;else if(i.length>0)for(var l=0;l<i.length&&i.length>0;l++){var u="."+i[l];if("undefined"!=typeof a.custom_error_messages[u]&&"undefined"!=typeof a.custom_error_messages[u][n]){r=a.custom_error_messages[u][n].message;break}}return r||"undefined"==typeof a.custom_error_messages[n]||"undefined"==typeof a.custom_error_messages[n].message||(r=a.custom_error_messages[n].message),r},_validityProp:{required:"value-missing",custom:"custom-error",groupRequired:"value-missing",ajax:"custom-error",minSize:"range-underflow",maxSize:"range-overflow",min:"range-underflow",max:"range-overflow",past:"type-mismatch",future:"type-mismatch",dateRange:"type-mismatch",dateTimeRange:"type-mismatch",maxCheckbox:"range-overflow",minCheckbox:"range-underflow",equals:"pattern-mismatch",funcCall:"custom-error",creditCard:"pattern-mismatch",condRequired:"value-missing"},_required:function(t,i,n,a,r){switch(t.prop("type")){case"text":case"password":case"textarea":case"file":case"select-one":case"select-multiple":default:var s=e.trim(t.val()),o=e.trim(t.attr("data-validation-placeholder")),l=e.trim(t.attr("placeholder"));if(!s||o&&s==o||l&&s==l)return a.allrules[i[n]].alertText;break;case"radio":case"checkbox":if(r){if(!t.attr("checked"))return a.allrules[i[n]].alertTextCheckboxMultiple;break}var u=t.closest("form, .validationEngineContainer"),c=t.attr("name");if(0==u.find("input[name='"+c+"']:checked").length)return 1==u.find("input[name='"+c+"']:visible").length?a.allrules[i[n]].alertTextCheckboxe:a.allrules[i[n]].alertTextCheckboxMultiple}},_groupRequired:function(i,n,a,r){var s="["+r.validateAttribute+"*="+n[a+1]+"]",o=!1;if(i.closest("form, .validationEngineContainer").find(s).each(function(){if(!t._required(e(this),n,a,r))return o=!0,!1}),!o)return r.allrules[n[a]].alertText},_custom:function(e,t,i,n){var a,r=t[i+1],s=n.allrules[r];if(s)if(s.regex){var o=s.regex;if(!o)return void alert("jqv:custom regex not found - "+r);if(!new RegExp(o).test(e.val()))return n.allrules[r].alertText}else{if(!s.func)return void alert("jqv:custom type not allowed "+r);if("function"!=typeof(a=s.func))return void alert("jqv:custom parameter 'function' is no function - "+r);if(!a(e,t,i,n))return n.allrules[r].alertText}else alert("jqv:custom rule not found - "+r)},_funcCall:function(e,t,i,n){var a,r=t[i+1];if(r.indexOf(".")>-1){for(var s=r.split("."),o=window;s.length;)o=o[s.shift()];a=o}else a=window[r]||n.customFunctions[r];if("function"==typeof a)return a(e,t,i,n)},_equals:function(t,i,n,a){var r=i[n+1];if(t.val()!=e("#"+r).val())return a.allrules.equals.alertText},_maxSize:function(e,t,i,n){var a=t[i+1];if(e.val().length>a){var r=n.allrules.maxSize;return r.alertText+a+r.alertText2}},_minSize:function(e,t,i,n){var a=t[i+1];if(e.val().length<a){var r=n.allrules.minSize;return r.alertText+a+r.alertText2}},_min:function(e,t,i,n){var a=parseFloat(t[i+1]);if(parseFloat(e.val())<a){var r=n.allrules.min;return r.alertText2?r.alertText+a+r.alertText2:r.alertText+a}},_max:function(e,t,i,n){var a=parseFloat(t[i+1]);if(parseFloat(e.val())>a){var r=n.allrules.max;return r.alertText2?r.alertText+a+r.alertText2:r.alertText+a}},_past:function(i,n,a,r,s){var o,l=a[r+1],u=e(i.find("input[name='"+l.replace(/^#+/,"")+"']"));if("now"==l.toLowerCase())o=new Date;else if(undefined!=u.val()){if(u.is(":disabled"))return;o=t._parseDate(u.val())}else o=t._parseDate(l);if(t._parseDate(n.val())>o){var c=s.allrules.past;return c.alertText2?c.alertText+t._dateToString(o)+c.alertText2:c.alertText+t._dateToString(o)}},_future:function(i,n,a,r,s){var o,l=a[r+1],u=e(i.find("input[name='"+l.replace(/^#+/,"")+"']"));if("now"==l.toLowerCase())o=new Date;else if(undefined!=u.val()){if(u.is(":disabled"))return;o=t._parseDate(u.val())}else o=t._parseDate(l);if(t._parseDate(n.val())<o){var c=s.allrules.future;return c.alertText2?c.alertText+t._dateToString(o)+c.alertText2:c.alertText+t._dateToString(o)}},_isDate:function(e){return new RegExp(/^\d{4}[\/\-](0?[1-9]|1[012])[\/\-](0?[1-9]|[12][0-9]|3[01])$|^(?:(?:(?:0?[13578]|1[02])(\/|-)31)|(?:(?:0?[1,3-9]|1[0-2])(\/|-)(?:29|30)))(\/|-)(?:[1-9]\d\d\d|\d[1-9]\d\d|\d\d[1-9]\d|\d\d\d[1-9])$|^(?:(?:0?[1-9]|1[0-2])(\/|-)(?:0?[1-9]|1\d|2[0-8]))(\/|-)(?:[1-9]\d\d\d|\d[1-9]\d\d|\d\d[1-9]\d|\d\d\d[1-9])$|^(0?2(\/|-)29)(\/|-)(?:(?:0[48]00|[13579][26]00|[2468][048]00)|(?:\d\d)?(?:0[48]|[2468][048]|[13579][26]))$/).test(e)},_isDateTime:function(e){return new RegExp(/^\d{4}[\/\-](0?[1-9]|1[012])[\/\-](0?[1-9]|[12][0-9]|3[01])\s+(1[012]|0?[1-9]){1}:(0?[1-5]|[0-6][0-9]){1}:(0?[0-6]|[0-6][0-9]){1}\s+(am|pm|AM|PM){1}$|^(?:(?:(?:0?[13578]|1[02])(\/|-)31)|(?:(?:0?[1,3-9]|1[0-2])(\/|-)(?:29|30)))(\/|-)(?:[1-9]\d\d\d|\d[1-9]\d\d|\d\d[1-9]\d|\d\d\d[1-9])$|^((1[012]|0?[1-9]){1}\/(0?[1-9]|[12][0-9]|3[01]){1}\/\d{2,4}\s+(1[012]|0?[1-9]){1}:(0?[1-5]|[0-6][0-9]){1}:(0?[0-6]|[0-6][0-9]){1}\s+(am|pm|AM|PM){1})$/).test(e)},_dateCompare:function(e,t){return new Date(e.toString())<new Date(t.toString())},_dateRange:function(e,i,n,a){return!a.firstOfGroup[0].value&&a.secondOfGroup[0].value||a.firstOfGroup[0].value&&!a.secondOfGroup[0].value?a.allrules[i[n]].alertText+a.allrules[i[n]].alertText2:t._isDate(a.firstOfGroup[0].value)&&t._isDate(a.secondOfGroup[0].value)&&t._dateCompare(a.firstOfGroup[0].value,a.secondOfGroup[0].value)?void 0:a.allrules[i[n]].alertText+a.allrules[i[n]].alertText2},_dateTimeRange:function(e,i,n,a){return!a.firstOfGroup[0].value&&a.secondOfGroup[0].value||a.firstOfGroup[0].value&&!a.secondOfGroup[0].value?a.allrules[i[n]].alertText+a.allrules[i[n]].alertText2:t._isDateTime(a.firstOfGroup[0].value)&&t._isDateTime(a.secondOfGroup[0].value)&&t._dateCompare(a.firstOfGroup[0].value,a.secondOfGroup[0].value)?void 0:a.allrules[i[n]].alertText+a.allrules[i[n]].alertText2},_maxCheckbox:function(e,t,i,n,a){var r=i[n+1],s=t.attr("name");if(e.find("input[name='"+s+"']:checked").length>r)return a.showArrow=!1,a.allrules.maxCheckbox.alertText2?a.allrules.maxCheckbox.alertText+" "+r+" "+a.allrules.maxCheckbox.alertText2:a.allrules.maxCheckbox.alertText},_minCheckbox:function(e,t,i,n,a){var r=i[n+1],s=t.attr("name");if(e.find("input[name='"+s+"']:checked").length<r)return a.showArrow=!1,a.allrules.minCheckbox.alertText+" "+r+" "+a.allrules.minCheckbox.alertText2},_creditCard:function(e,t,i,n){var a=!1,r=e.val().replace(/ +/g,"").replace(/-+/g,""),s=r.length;if(s>=14&&s<=16&&parseInt(r)>0){var o,l=0,u=(i=s-1,1),c=new String;do{o=parseInt(r.charAt(i)),c+=u++%2==0?2*o:o}while(--i>=0);for(i=0;i<c.length;i++)l+=parseInt(c.charAt(i));a=l%10==0}if(!a)return n.allrules.creditCard.alertText},_ajax:function(i,n,a,r){var s=n[a+1],o=r.allrules[s],l=o.extraData,u=o.extraDataDynamic,c={fieldId:i.attr("id"),fieldValue:i.val()};if("object"==typeof l)e.extend(c,l);else if("string"==typeof l){var h=l.split("&");for(a=0;a<h.length;a++){var d=h[a].split("=");d[0]&&d[0]&&(c[d[0]]=d[1])}}if(u){var p=String(u).split(",");for(a=0;a<p.length;a++){var f=p[a];if(e(f).length){var m=i.closest("form, .validationEngineContainer").find(f).val();f.replace("#",""),escape(m);c[f.replace("#","")]=m}}}if("field"==r.eventTrigger&&delete r.ajaxValidCache[i.attr("id")],!r.isError&&!t._checkAjaxFieldStatus(i.attr("id"),r))return e.ajax({type:r.ajaxFormValidationMethod,url:o.url,cache:!1,dataType:"json",data:c,field:i,rule:o,methods:t,options:r,beforeSend:function(){},error:function(e,i){t._ajaxError(e,i)},success:function(n){var a=n[0],s=e("#"+a).eq(0);if(1==s.length){var l=n[1],u=n[2];if(l){if(r.ajaxValidCache[a]=!0,u){if(r.allrules[u])(c=r.allrules[u].alertTextOk)&&(u=c)}else u=o.alertTextOk;r.showPrompts&&(u?t._showPrompt(s,u,"pass",!0,r):t._closePrompt(s)),"submit"==r.eventTrigger&&i.closest("form").submit()}else{var c;if(r.ajaxValidCache[a]=!1,r.isError=!0,u){if(r.allrules[u])(c=r.allrules[u].alertText)&&(u=c)}else u=o.alertText;r.showPrompts&&t._showPrompt(s,u,"",!0,r)}}s.trigger("jqv.field.result",[s,r.isError,u])}}),o.alertTextLoad},_ajaxError:function(e,t){0==e.status&&null==t?alert("The page is not served from a server! ajax call failed"):"undefined"!=typeof console&&console.log("Ajax error: "+e.status+" "+t)},_dateToString:function(e){return e.getFullYear()+"-"+(e.getMonth()+1)+"-"+e.getDate()},_parseDate:function(e){var t=e.split("-");return t==e&&(t=e.split("/")),t==e?(t=e.split("."),new Date(t[2],t[1]-1,t[0])):new Date(t[0],t[1]-1,t[2])},_showPrompt:function(i,n,a,r,s,o){var l=t._getPrompt(i);o&&(l=!1),e.trim(n)&&(l?t._updatePrompt(i,l,n,a,r,s):t._buildPrompt(i,n,a,r,s))},_buildPrompt:function(i,n,a,r,s){var o=e("<div>");switch(o.addClass(t._getClassName(i.attr("id"))+"formError"),o.addClass("parentForm"+t._getClassName(i.closest("form, .validationEngineContainer").attr("id"))),o.addClass("formError"),a){case"pass":o.addClass("greenPopup");break;case"load":o.addClass("blackPopup")}r&&o.addClass("ajaxed");e("<div>").addClass("formErrorContent").html(n).appendTo(o);var l=i.data("promptPosition")||s.promptPosition;if(s.showArrow){var u=e("<div>").addClass("formErrorArrow");if("string"==typeof l)-1!=(d=l.indexOf(":"))&&(l=l.substring(0,d));switch(l){case"bottomLeft":case"bottomRight":o.find(".formErrorContent").before(u),u.addClass("formErrorArrowBottom").html('<div class="line1"><!-- --></div><div class="line2"><!-- --></div><div class="line3"><!-- --></div><div class="line4"><!-- --></div><div class="line5"><!-- --></div><div class="line6"><!-- --></div><div class="line7"><!-- --></div><div class="line8"><!-- --></div><div class="line9"><!-- --></div><div class="line10"><!-- --></div>');break;case"topLeft":case"topRight":u.html('<div class="line10"><!-- --></div><div class="line9"><!-- --></div><div class="line8"><!-- --></div><div class="line7"><!-- --></div><div class="line6"><!-- --></div><div class="line5"><!-- --></div><div class="line4"><!-- --></div><div class="line3"><!-- --></div><div class="line2"><!-- --></div><div class="line1"><!-- --></div>'),o.append(u)}}s.addPromptClass&&o.addClass(s.addPromptClass);var c=i.attr("data-required-class");if(c!==undefined)o.addClass(c);else if(s.prettySelect&&e("#"+i.attr("id")).next().is("select")){var h=e("#"+i.attr("id").substr(s.usePrefix.length).substring(s.useSuffix.length)).attr("data-required-class");h!==undefined&&o.addClass(h)}o.css({opacity:0}),"inline"===l?(o.addClass("inline"),void 0!==i.attr("data-prompt-target")&&e("#"+i.attr("data-prompt-target")).length>0?o.appendTo(e("#"+i.attr("data-prompt-target"))):i.after(o)):i.before(o);var d=t._calculatePosition(i,o,s);return o.css({position:"inline"===l?"relative":"absolute",top:d.callerTopPosition,left:d.callerleftPosition,marginTop:0,opacity:0}).data("callerField",i),s.autoHidePrompt&&setTimeout(function(){o.animate({opacity:0},function(){o.closest(".formErrorOuter").remove(),o.remove()})},s.autoHideDelay),o.animate({opacity:1})},_updatePrompt:function(e,i,n,a,r,s,o){if(i){void 0!==a&&("pass"==a?i.addClass("greenPopup"):i.removeClass("greenPopup"),"load"==a?i.addClass("blackPopup"):i.removeClass("blackPopup")),r?i.addClass("ajaxed"):i.removeClass("ajaxed"),i.find(".formErrorContent").html(n);var l=t._calculatePosition(e,i,s),u={top:l.callerTopPosition,left:l.callerleftPosition,marginTop:l.marginTopSize};o?i.css(u):i.animate(u)}},_closePrompt:function(e){var i=t._getPrompt(e);i&&i.fadeTo("fast",0,function(){i.parent(".formErrorOuter").remove(),i.remove()})},closePrompt:function(e){return t._closePrompt(e)},_getPrompt:function(i){var n=e(i).closest("form, .validationEngineContainer").attr("id"),a=t._getClassName(i.attr("id"))+"formError",r=e("."+t._escapeExpression(a)+".parentForm"+n)[0];if(r)return e(r)},_escapeExpression:function(e){return e.replace(/([#;&,\.\+\*\~':"\!\^$\[\]\(\)=>\|])/g,"\\$1")},isRTL:function(t){
var i=e(document),n=e("body"),a=t&&t.hasClass("rtl")||t&&"rtl"===(t.attr("dir")||"").toLowerCase()||i.hasClass("rtl")||"rtl"===(i.attr("dir")||"").toLowerCase()||n.hasClass("rtl")||"rtl"===(n.attr("dir")||"").toLowerCase();return Boolean(a)},_calculatePosition:function(e,t,i){var n,a,r,s=e.width(),o=e.position().left,l=e.position().top;e.height();n=a=0,r=-t.height();var u=e.data("promptPosition")||i.promptPosition,c="",h="",d=0,p=0;switch("string"==typeof u&&-1!=u.indexOf(":")&&(c=u.substring(u.indexOf(":")+1),u=u.substring(0,u.indexOf(":")),-1!=c.indexOf(",")&&(h=c.substring(c.indexOf(",")+1),c=c.substring(0,c.indexOf(",")),p=parseInt(h),isNaN(p)&&(p=0)),d=parseInt(c),isNaN(c)&&(c=0)),u){default:case"topRight":a+=o+s-30,n+=l;break;case"topLeft":n+=l,a+=o;break;case"centerRight":n=l+4,r=0,a=o+e.outerWidth(!0)+5;break;case"centerLeft":a=o-(t.width()+2),n=l+4,r=0;break;case"bottomLeft":n=l+e.height()+5,r=0,a=o;break;case"bottomRight":a=o+s-30,n=l+e.height()+5,r=0;break;case"inline":a=0,n=0,r=0}return{callerTopPosition:(n+=p)+"px",callerleftPosition:(a+=d)+"px",marginTopSize:r+"px"}},_saveOptions:function(t,i){if(e.validationEngineLanguage)var n=e.validationEngineLanguage.allRules;else e.error("jQuery.validationEngine rules are not loaded, plz add localization files to the page");e.validationEngine.defaults.allrules=n;var a=e.extend(!0,{},e.validationEngine.defaults,i);return t.data("jqv",a),a},_getClassName:function(e){if(e)return e.replace(/:/g,"_").replace(/\./g,"_")},_jqSelector:function(e){return e.replace(/([;&,\.\+\*\~':"\!\^#$%@\[\]\(\)=>\|])/g,"\\$1")},_condRequired:function(e,i,n,a){var r,s;for(r=n+1;r<i.length;r++)if((s=jQuery("#"+i[r]).first()).length&&t._required(s,["required"],0,a,!0)==undefined)return t._required(e,["required"],0,a)},_submitButtonClick:function(){var t=e(this);t.closest("form, .validationEngineContainer").data("jqv_submitButton",t.attr("id"))}};e.fn.validationEngine=function(i){var n=e(this);return n[0]?"string"==typeof i&&"_"!=i.charAt(0)&&t[i]?("showPrompt"!=i&&"hide"!=i&&"hideAll"!=i&&t.init.apply(n),t[i].apply(n,Array.prototype.slice.call(arguments,1))):"object"!=typeof i&&i?void e.error("Method "+i+" does not exist in jQuery.validationEngine"):(t.init.apply(n,arguments),t.attach.apply(n)):n},e.validationEngine={fieldIdCounter:0,defaults:{validationEventTrigger:"blur",scroll:!0,focusFirstField:!0,showPrompts:!0,validateNonVisibleFields:!1,promptPosition:"topRight",bindMethod:"bind",inlineAjax:!1,ajaxFormValidation:!1,ajaxFormValidationURL:!1,ajaxFormValidationMethod:"get",onAjaxFormComplete:e.noop,onBeforeAjaxFormValidation:e.noop,onValidationComplete:!1,doNotShowAllErrosOnSubmit:!1,custom_error_messages:{},binded:!0,showArrow:!0,isError:!1,maxErrorsPerField:!1,ajaxValidCache:{},autoPositionUpdate:!1,InvalidFields:[],onFieldSuccess:!1,onFieldFailure:!1,onSuccess:!1,onFailure:!1,validateAttribute:"class",addSuccessCssClassToField:"",addFailureCssClassToField:"",autoHidePrompt:!1,autoHideDelay:1e4,fadeDuration:.3,prettySelect:!1,addPromptClass:"",usePrefix:"",useSuffix:"",showOneMessage:!1}},e(function(){e.validationEngine.defaults.promptPosition=t.isRTL()?"topLeft":"topRight"})}(jQuery),
/*! matchMedia() polyfill - Test a CSS media type/query in JS. Authors & copyright (c) 2012: Scott Jehl, Paul Irish, Nicholas Zakas. Dual MIT/BSD license */
/*! NOTE: If you're already including a window.matchMedia polyfill via Modernizr or otherwise, you don't need this part */
window.matchMedia=window.matchMedia||function(e){var t,i=e.documentElement,n=i.firstElementChild||i.firstChild,a=e.createElement("body"),r=e.createElement("div");return r.id="mq-test-1",r.style.cssText="position:absolute;top:-100em",a.style.background="none",a.appendChild(r),function(e){return r.innerHTML='&shy;<style media="'+e+'"> #mq-test-1 { width: 42px; }</style>',i.insertBefore(a,n),t=42==r.offsetWidth,i.removeChild(a),{matches:t,media:e}}}(document),
/*! Respond.js v1.1.0: min/max-width media query polyfill. (c) Scott Jehl. MIT/GPLv2 Lic. j.mp/respondjs  */
function(t){function i(){x(!0)}if(t.respond={},respond.update=function(){},respond.mediaQueriesSupported=t.matchMedia&&t.matchMedia("only all").matches,!respond.mediaQueriesSupported){var n,a,r,s=t.document,o=s.documentElement,l=[],u=[],c=[],h={},d=30,p=s.getElementsByTagName("head")[0]||o,f=s.getElementsByTagName("base")[0],m=p.getElementsByTagName("link"),g=[],v=function(){for(var e,i,n,a,r=m,s=r.length,o=0;o<s;o++)i=(e=r[o]).href,n=e.media,a=e.rel&&"stylesheet"===e.rel.toLowerCase(),i&&a&&!h[i]&&(e.styleSheet&&e.styleSheet.rawCssText?(b(e.styleSheet.rawCssText,i,n),h[i]=!0):(/^([a-zA-Z:]*\/\/)/.test(i)||f)&&i.replace(RegExp.$1,"").split("/")[0]!==t.location.host||g.push({href:i,media:n}));y()},y=function(){if(g.length){var e=g.shift();E(e.href,function(t){b(t,e.href,e.media),h[e.href]=!0,y()})}},b=function(e,t,i){var n,a,r,s,o,c=e.match(/@media[^\{]+\{([^\{\}]*\{[^\}\{]*\})+/gi),h=c&&c.length||0,d=function(e){return e.replace(/(url\()['"]?([^\/\)'"][^:\)'"]+)['"]?(\))/g,"$1"+t+"$2$3")},p=!h&&i,f=0;for((t=t.substring(0,t.lastIndexOf("/"))).length&&(t+="/"),p&&(h=1);f<h;f++)for(n=0,p?(a=i,u.push(d(e))):(a=c[f].match(/@media *([^\{]+)\{([\S\s]+?)$/)&&RegExp.$1,u.push(RegExp.$2&&d(RegExp.$2))),o=(s=a.split(",")).length;n<o;n++)r=s[n],l.push({media:r.split("(")[0].match(/(only\s+)?([a-zA-Z]+)\s?/)&&RegExp.$2||"all",rules:u.length-1,hasquery:r.indexOf("(")>-1,minw:r.match(/\(min\-width:[\s]*([\s]*[0-9\.]+)(px|em)[\s]*\)/)&&parseFloat(RegExp.$1)+(RegExp.$2||""),maxw:r.match(/\(max\-width:[\s]*([\s]*[0-9\.]+)(px|em)[\s]*\)/)&&parseFloat(RegExp.$1)+(RegExp.$2||"")});x()},_=function(){var e,t=s.createElement("div"),i=s.body,n=!1;return t.style.cssText="position:absolute;font-size:1em;width:1em",i||((i=n=s.createElement("body")).style.background="none"),i.appendChild(t),o.insertBefore(i,o.firstChild),e=t.offsetWidth,n?o.removeChild(i):i.removeChild(t),e=r=parseFloat(e)},x=function(e){var t="clientWidth",i=o[t],h="CSS1Compat"===s.compatMode&&i||s.body[t]||i,f={},g=m[m.length-1],v=(new Date).getTime();if(e&&n&&v-n<d)return clearTimeout(a),void(a=setTimeout(x,d));for(var y in n=v,l){var b=l[y],E=b.minw,w=b.maxw,A=null===E,C=null===w,F="em";E&&(E=parseFloat(E)*(E.indexOf(F)>-1?r||_():1)),w&&(w=parseFloat(w)*(w.indexOf(F)>-1?r||_():1)),b.hasquery&&(A&&C||!(A||h>=E)||!(C||h<=w))||(f[b.media]||(f[b.media]=[]),f[b.media].push(u[b.rules]))}for(var y in c)c[y]&&c[y].parentNode===p&&p.removeChild(c[y]);for(var y in f){var T=s.createElement("style"),j=f[y].join("\n");T.type="text/css",T.media=y,p.insertBefore(T,g.nextSibling),T.styleSheet?T.styleSheet.cssText=j:T.appendChild(s.createTextNode(j)),c.push(T)}},E=function(e,t){var i=w();i&&(i.open("GET",e,!0),i.onreadystatechange=function(){4!=i.readyState||200!=i.status&&304!=i.status||t(i.responseText)},4!=i.readyState&&i.send(null))},w=function(){var t=!1;try{t=new XMLHttpRequest}catch(e){t=new ActiveXObject("Microsoft.XMLHTTP")}return function(){return t}}();v(),respond.update=v,t.addEventListener?t.addEventListener("resize",i,!1):t.attachEvent&&t.attachEvent("onresize",i)}}(this),
/*!

    Copyright (c) 2011 Peter van der Spek

    Permission is hereby granted, free of charge, to any person obtaining a copy
    of this software and associated documentation files (the "Software"), to deal
    in the Software without restriction, including without limitation the rights
    to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
    copies of the Software, and to permit persons to whom the Software is
    furnished to do so, subject to the following conditions:

    The above copyright notice and this permission notice shall be included in
    all copies or substantial portions of the Software.

    THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
    IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
    FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
    AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
    LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
    OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
    THE SOFTWARE.
    
 */
function(e){function t(t,r){var s=t.data("jqae");s||(s={});var o=s.wrapperElement;o||(o=t.wrapInner("<div/>").find(">div")).css({margin:0,padding:0,border:0});var l=o.data("jqae");l||(l={});var u=l.originalContent;u?o=l.originalContent.clone(!0).data("jqae",{originalContent:u}).replaceAll(o):o.data("jqae",{originalContent:o.clone(!0)}),t.data("jqae",{wrapperElement:o,containerWidth:t.width(),containerHeight:t.height()});var c=t.height(),h=(parseInt(t.css("padding-top"),10)||0)+(parseInt(t.css("border-top-width"),10)||0)-(o.offset().top-t.offset().top),d=!1,p=o;r.selector&&(p=e(o.find(r.selector).get().reverse())),p.each(function(){var t=e(this),s=t.text(),l=!1;if(o.innerHeight()-t.innerHeight()>c+h)t.remove();else if(a(t),t.contents().length){for(d&&(n(t).get(0).nodeValue+=r.ellipsis,d=!1);o.innerHeight()>c+h;){if(!(l=i(t))){d=!0,t.remove();break}if(a(t),!t.contents().length){d=!0,t.remove();break}n(t).get(0).nodeValue+=r.ellipsis}"onEllipsis"==r.setTitle&&l||"always"==r.setTitle?t.attr("title",s):"never"!=r.setTitle&&t.removeAttr("title")}})}function i(t){var i=n(t);if(i.length){var a=i.get(0).nodeValue,r=a.lastIndexOf(" ");return r>-1?(a=e.trim(a.substring(0,r)),i.get(0).nodeValue=a):i.get(0).nodeValue="",!0}return!1}function n(e){if(e.contents().length){var t=(i=e.contents()).eq(i.length-1);return t.filter(r).length?t:n(t)}var i;return e.append(""),(i=e.contents()).eq(i.length-1)}function a(t){if(t.contents().length){var i=t.contents(),n=i.eq(i.length-1);if(n.filter(r).length){var s=n.get(0).nodeValue;return""==(s=e.trim(s))&&(n.remove(),!0)}for(;a(n););return!n.contents().length&&(n.remove(),!0)}return!1}function r(){return 3===this.nodeType}function s(e,t){c[e]=t,u||(u=window.setInterval(function(){l()},200))}function o(e){c[e]&&(delete c[e],c.length||u&&(window.clearInterval(u),u=undefined))}function l(){if(!h){for(var i in h=!0,c)e(i).each(function(){var n,a;(a=(n=e(this)).data("jqae")).containerWidth==n.width()&&a.containerHeight==n.height()||t(n,c[i])});h=!1}}var u,c={},h=!1,d={ellipsis:"...",setTitle:"never",live:!1};e.fn.ellipsis=function(i,n){var a,r;return a=e(this),"string"!=typeof i&&(n=i,i=undefined),(r=e.extend({},d,n)).selector=i,a.each(function(){t(e(this),r)}),r.live?s(a.selector,r):o(a.selector),this}}(jQuery),
/*
 * jQuery Iframe Transport Plugin 1.5
 * https://github.com/blueimp/jQuery-File-Upload
 *
 * Copyright 2011, Sebastian Tschan
 * https://blueimp.net
 *
 * Licensed under the MIT license:
 * http://www.opensource.org/licenses/MIT
 */
function(e){"use strict";"function"==typeof define&&define.amd?define(["jquery"],e):e(window.jQuery)}(function(t){"use strict";var i=0;t.ajaxTransport("iframe",function(n){var a,r;if(n.async&&("POST"===n.type||"GET"===n.type))return{send:function(s,o){(a=t('<form style="display:none;"></form>')).attr("accept-charset",n.formAcceptCharset),r=t('<iframe src="javascript:false;" name="iframe-transport-'+(i+=1)+'"></iframe>').bind("load",function(){var i,s=t.isArray(n.paramName)?n.paramName:[n.paramName];r.unbind("load").bind("load",function(){var i;try{if(!(i=r.contents()).length||!i[0].firstChild)throw new Error}catch(e){i=undefined}o(200,"success",{iframe:i}),t('<iframe src="javascript:false;"></iframe>').appendTo(a),a.remove()}),a.prop("target",r.prop("name")).prop("action",n.url).prop("method",n.type),n.formData&&t.each(n.formData,function(e,i){t('<input type="hidden"/>').prop("name",i.name).val(i.value).appendTo(a)}),n.fileInput&&n.fileInput.length&&"POST"===n.type&&(i=n.fileInput.clone(),n.fileInput.after(function(e){return i[e]}),n.paramName&&n.fileInput.each(function(e){t(this).prop("name",s[e]||n.paramName)}),a.append(n.fileInput).prop("enctype","multipart/form-data").prop("encoding","multipart/form-data")),a.submit(),i&&i.length&&n.fileInput.each(function(e,n){var a=t(i[e]);t(n).prop("name",a.prop("name")),a.replaceWith(n)})}),a.append(r).appendTo(document.body)},abort:function(){r&&r.unbind("load").prop("src","javascript".concat(":false;")),a&&a.remove()}}}),t.ajaxSetup({converters:{"iframe text":function(e){return t(e[0].body).text()},"iframe json":function(e){return JSON.parse(t(e[0].body).text())},"iframe html":function(e){return t(e[0].body).html()},"iframe script":function(e){return t.globalEval(t(e[0].body).text())}}})});
</script>

</body>
</html>
