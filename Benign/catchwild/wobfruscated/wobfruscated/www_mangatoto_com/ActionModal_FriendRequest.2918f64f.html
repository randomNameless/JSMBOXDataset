<!DOCTYPE html>

<html lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>ActionModal_FriendRequest.2918f64f.html</title>
</head>
<body>
<script>import{R as h}from"./index.8365acb2.js";import{c as R}from"./index.6a5a335b.js";import{g as l,p as i}from"./reavars.660bacce.js";import{f as C}from"./func_toggle_body_modal_mode.eb14cd83.js";import{u as p}from"./useReavar.8d1e1e12.js";import{j as e}from"./jsx-runtime.7d759e48.js";import{F as M}from"./FontIcon_FontAwesome.5dcf1038.js";import{A as w}from"./ActionButton_FriendAccept.0bd84c51.js";import{A}from"./ActionButton_FriendIgnore.7a433bd0.js";import{u as q}from"./ReactProviders.242c2151.js";import{g as k}from"./index.f5993dad.js";import{c as I}from"./client.56225896.js";import{u as F}from"./useMutation.bcca56b6.js";function _(t){return e.jsxs("div",{className:"collapse collapse-arrow border border-info bg-info text-info-content rounded-box",children:[e.jsx("input",{type:"checkbox",className:"peer"}),e.jsx("div",{className:"collapse-title text-xl font-medium",children:"Instructions"}),e.jsxs("div",{className:"collapse-content",children:[e.jsx("div",{children:"Need the consent of the other party to become your friend."}),e.jsx("div",{children:"Requests automatically expire after 30 days."}),e.jsx("div",{children:"And you can submit up to 100 friend requests within 30 days"})]})]})}function $(t){const n=p(l),{userNode:s,rqKeys:r}=n||{},{id:d,sser_friend_user:c,user_friend_sser:m}=s,u=q();function f(){if(r?.length)for(const o of r)u.invalidateQueries(o)}function x(){if(r?.length)for(const o of r)u.invalidateQueries(o)}return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"modal-body",children:e.jsxs("div",{className:"py-3 space-y-3",children:[e.jsx(_,{}),e.jsx("div",{children:"This user sent you a friend request."})]})}),e.jsxs("div",{className:"modal-footer",children:[e.jsx(w,{thatId:d,onSuccess:f,text:"Accept Friend Request"}),e.jsx(A,{thatId:d,onSuccess:x,text:"Ignore Friend Request"})]})]})}async function B(t={},n=null){const s=k`
  mutation mut_member_friend_remove($thatId: ID!) {
    mut_member_friend_remove(thatId: $thatId) {
      err tof
    }
  }
  `;return(await I().rawRequest(s,t)).data.mut_member_friend_remove}function Q(t){const[n,s]=h.useState(!1),r=p(l),{userNode:d,rqKeys:c}=r||{},{id:m,sser_friend_user:u,user_friend_sser:f}=d,[x,o]=h.useState(!0),b=q(),j=F(B,{onSuccess:a=>{if(c?.length)for(const N of c)b.invalidateQueries(N);const{err:y,str:S}=a;if(y){i({style:"error",content:"System error, try again later please."}),s(!1);return}i({style:"success",content:"Done!"}),s(!1),l(null)},onError:a=>{s(!1)}});function v(){s(!0),j.mutate({mutual:x,thatId:m})}function g(a){o(!!a.target.checked)}return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"modal-body",children:e.jsxs("div",{className:"py-3 space-y-3",children:[e.jsx(_,{}),f!==1&&e.jsx("div",{children:"You are not in the friend list of this user."}),e.jsx("div",{className:"form-control",children:e.jsxs("label",{className:"label cursor-pointer justify-start space-x-1",children:[e.jsx("input",{type:"checkbox",className:"checkbox checkbox-primary",checked:x,onChange:g}),e.jsx("span",{className:"label-text",children:"Removed me from his/her friend list too, and the other party will not be notified"})]})})]})}),e.jsx("div",{className:"modal-footer",children:e.jsxs("button",{className:"btn btn-sm btn-error",onClick:v,children:[!!n&&e.jsx("span",{className:"loading loading-spinner loading-xs"}),"Remove him/her from my friends list"]})})]})}async function D(t={},n=null){const s=k`
  mutation mut_member_friend_request($thatId: ID!, $remark:String, $message: String) {
    mut_member_friend_request(thatId: $thatId, remark: $remark, message: $message) {
      err tof int
    }
  }
  `;return(await I().rawRequest(s,t)).data.mut_member_friend_request}function E(t){const n=p(l),{userNode:s,rqKeys:r}=n||{},{id:d,sser_friend_user:c,user_friend_sser:m}=s,[u,f]=h.useState(""),[x,o]=h.useState(!1);h.useEffect(()=>{f("")},[n]);const b=q(),j=F(D,{onSuccess:a=>{if(r?.length)for(const N of r)b.invalidateQueries(N);const{err:y,str:S}=a;if(y){switch(y){case"request_exists":i({style:"error",content:"Same friend request exists."});break;case"friend_exists":i({style:"error",content:"You are already friends."});break;case"blocked_by_thatId":i({style:"error",content:"Him/her blocked you."});break;case"in_your_block_list":i({style:"error",content:"You blocked him/her."});break;case"quota_exceeded":i({style:"error",content:"Quota exceeded, max 100 friend requests every 30 days."});break;default:i({style:"error",content:"System error, try again later please."});break}o(!1);return}i({style:"success",content:"Done!"}),o(!1),l(null)},onError:a=>{o(!1)}});function v(a){f(a.target.value)}function g(){o(!0),j.mutate({thatId:d,message:u})}return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"modal-body",children:e.jsxs("div",{className:"py-3 space-y-3",children:[e.jsx(_,{}),e.jsxs("div",{className:"form-control",children:[e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text",children:"Greeting Message"})}),e.jsx("textarea",{className:"textarea textarea-bordered h-24",value:u,onChange:v})]})]})}),e.jsx("div",{className:"modal-footer",children:e.jsxs("button",{className:"btn btn-sm btn-primary",onClick:g,children:[!!x&&e.jsx("span",{className:"loading loading-spinner loading-xs"}),"Submit Friend Request"]})})]})}function K(t){const n=p(l),{userNode:s,rqKeys:r}=n||{},{id:d,sser_friend_user:c,user_friend_sser:m}=s;return m===2?e.jsx("div",{className:"modal-body",children:e.jsxs("div",{className:"py-3 space-y-3",children:[e.jsx(_,{}),e.jsx("div",{children:"This user blocked you."})]})}):c===2?e.jsx("div",{className:"modal-body",children:e.jsxs("div",{className:"py-3 space-y-3",children:[e.jsx(_,{}),e.jsx("div",{children:"You blocked this user."})]})}):c===3?e.jsx("div",{className:"modal-body",children:e.jsxs("div",{className:"py-3 space-y-3",children:[e.jsx(_,{}),e.jsx("div",{children:"Friend request sent."})]})}):m===3?e.jsx($,{}):c===1?e.jsx(Q,{}):e.jsx(E,{})}function Y(t){const s=!!p(l);return h.useEffect(()=>{C(s)},[s]),e.jsx("div",{className:R("modal",{"modal-open":s}),children:s&&e.jsx("div",{className:"modal-dialog modal-dialog-scrollable max-w-screen-md",children:e.jsxs("div",{className:"modal-content",children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h5",{className:"text-lg font-bold",children:"Friend Manage"}),e.jsx("button",{className:"btn btn-xs btn-square btn-error",onClick:()=>l(null),children:e.jsx(M,{name:"close",size:20})})]}),e.jsx(K,{})]})})})}function ee(t){return e.jsx(Y,{...t})}export{ee as A};</script>
</body>
</html>
