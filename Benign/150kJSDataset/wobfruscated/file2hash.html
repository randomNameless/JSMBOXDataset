<!DOCTYPE html>

<html lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>file2hash.html</title>
</head>
<body>
<script>ï»¿function file2hash ( filepath )
{
	var hash = new ActiveXObject( 'Scripting.Dictionary' );
	var dom = new ActiveXObject( 'MSXML2.DOMDocument' );
	dom.async = false;
	dom.resolveExternals = false;
	dom.load( filepath );
	if ( dom.documentElement == null )
		return false;
	var children = dom.documentElement.childNodes;
	for ( var j = 0; j < children.length; ++j )
	{
		var tag = children.item( j );
		if ( hash.Exists( tag.tagName ) )
			hash.Item( tag.tagName ) = tag.text;
		else
			hash.Add( tag.tagName, tag.text );
	}
	return hash;
}</script>
</body>
</html>
