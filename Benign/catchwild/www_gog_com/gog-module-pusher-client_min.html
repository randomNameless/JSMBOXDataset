<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>gog-module-pusher-client_min.html</title>
</head>
<body>

<script>
!function(modules){var installedModules={};function __webpack_require__(moduleId){if(installedModules[moduleId])return installedModules[moduleId].exports;var module=installedModules[moduleId]={i:moduleId,l:!1,exports:{}};return modules[moduleId].call(module.exports,module,module.exports,__webpack_require__),module.l=!0,module.exports}__webpack_require__.m=modules,__webpack_require__.c=installedModules,__webpack_require__.d=function(exports,name,getter){__webpack_require__.o(exports,name)||Object.defineProperty(exports,name,{configurable:!1,enumerable:!0,get:getter})},__webpack_require__.n=function(module){var getter=module&&module.__esModule?function(){return module.default}:function(){return module};return __webpack_require__.d(getter,"a",getter),getter},__webpack_require__.o=function(object,property){return Object.prototype.hasOwnProperty.call(object,property)},__webpack_require__.p="/assets/",__webpack_require__(__webpack_require__.s=166)}({166:function(module,exports,__webpack_require__){var require,f;f=function(){return function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){if(!u&&("function"==typeof require&&require))return require(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){return s(t[o][1][e]||e)},l,l.exports,e,t,n,r)}return n[o].exports}for(var i="function"==typeof require&&require,o=0;o<r.length;o++)s(r[o]);return s}({1:[function(_dereq_,module,exports){},{}],2:[function(_dereq_,module,exports){var global,factory;global=this,factory=function(Long){"use strict";function stringSource(s){var i=0;return function(){return i<s.length?s.charCodeAt(i++):null}}function stringDestination(){var cs=[],ps=[];return function(){if(0===arguments.length)return ps.join("")+stringFromCharCode.apply(String,cs);cs.length+arguments.length>1024&&(ps.push(stringFromCharCode.apply(String,cs)),cs.length=0),Array.prototype.push.apply(cs,arguments)}}function ieee754_read(buffer,offset,isLE,mLen,nBytes){var e,m,eLen=8*nBytes-mLen-1,eMax=(1<<eLen)-1,eBias=eMax>>1,nBits=-7,i=isLE?nBytes-1:0,d=isLE?-1:1,s=buffer[offset+i];for(i+=d,e=s&(1<<-nBits)-1,s>>=-nBits,nBits+=eLen;nBits>0;e=256*e+buffer[offset+i],i+=d,nBits-=8);for(m=e&(1<<-nBits)-1,e>>=-nBits,nBits+=mLen;nBits>0;m=256*m+buffer[offset+i],i+=d,nBits-=8);if(0===e)e=1-eBias;else{if(e===eMax)return m?NaN:1/0*(s?-1:1);m+=Math.pow(2,mLen),e-=eBias}return(s?-1:1)*m*Math.pow(2,e-mLen)}function ieee754_write(buffer,value,offset,isLE,mLen,nBytes){var e,m,c,eLen=8*nBytes-mLen-1,eMax=(1<<eLen)-1,eBias=eMax>>1,rt=23===mLen?Math.pow(2,-24)-Math.pow(2,-77):0,i=isLE?0:nBytes-1,d=isLE?1:-1,s=value<0||0===value&&1/value<0?1:0;for(value=Math.abs(value),isNaN(value)||value===1/0?(m=isNaN(value)?1:0,e=eMax):(e=Math.floor(Math.log(value)/Math.LN2),value*(c=Math.pow(2,-e))<1&&(e--,c*=2),(value+=e+eBias>=1?rt/c:rt*Math.pow(2,1-eBias))*c>=2&&(e++,c/=2),e+eBias>=eMax?(m=0,e=eMax):e+eBias>=1?(m=(value*c-1)*Math.pow(2,mLen),e+=eBias):(m=value*Math.pow(2,eBias-1)*Math.pow(2,mLen),e=0));mLen>=8;buffer[offset+i]=255&m,i+=d,m/=256,mLen-=8);for(e=e<<mLen|m,eLen+=mLen;eLen>0;buffer[offset+i]=255&e,i+=d,e/=256,eLen-=8);buffer[offset+i-d]|=128*s}var ByteBuffer=function(capacity,littleEndian,noAssert){if(void 0===capacity&&(capacity=ByteBuffer.DEFAULT_CAPACITY),void 0===littleEndian&&(littleEndian=ByteBuffer.DEFAULT_ENDIAN),void 0===noAssert&&(noAssert=ByteBuffer.DEFAULT_NOASSERT),!noAssert){if((capacity|=0)<0)throw RangeError("Illegal capacity");littleEndian=!!littleEndian,noAssert=!!noAssert}this.buffer=0===capacity?EMPTY_BUFFER:new ArrayBuffer(capacity),this.view=0===capacity?null:new Uint8Array(this.buffer),this.offset=0,this.markedOffset=-1,this.limit=capacity,this.littleEndian=littleEndian,this.noAssert=noAssert};ByteBuffer.VERSION="5.0.1",ByteBuffer.LITTLE_ENDIAN=!0,ByteBuffer.BIG_ENDIAN=!1,ByteBuffer.DEFAULT_CAPACITY=16,ByteBuffer.DEFAULT_ENDIAN=ByteBuffer.BIG_ENDIAN,ByteBuffer.DEFAULT_NOASSERT=!1,ByteBuffer.Long=Long||null;var ByteBufferPrototype=ByteBuffer.prototype;ByteBufferPrototype.__isByteBuffer__,Object.defineProperty(ByteBufferPrototype,"__isByteBuffer__",{value:!0,enumerable:!1,configurable:!1});var EMPTY_BUFFER=new ArrayBuffer(0),stringFromCharCode=String.fromCharCode;ByteBuffer.accessor=function(){return Uint8Array},ByteBuffer.allocate=function(capacity,littleEndian,noAssert){return new ByteBuffer(capacity,littleEndian,noAssert)},ByteBuffer.concat=function(buffers,encoding,littleEndian,noAssert){"boolean"!=typeof encoding&&"string"==typeof encoding||(noAssert=littleEndian,littleEndian=encoding,encoding=void 0);for(var length,capacity=0,i=0,k=buffers.length;i<k;++i)ByteBuffer.isByteBuffer(buffers[i])||(buffers[i]=ByteBuffer.wrap(buffers[i],encoding)),(length=buffers[i].limit-buffers[i].offset)>0&&(capacity+=length);if(0===capacity)return new ByteBuffer(0,littleEndian,noAssert);var bi,bb=new ByteBuffer(capacity,littleEndian,noAssert);for(i=0;i<k;)(length=(bi=buffers[i++]).limit-bi.offset)<=0||(bb.view.set(bi.view.subarray(bi.offset,bi.limit),bb.offset),bb.offset+=length);return bb.limit=bb.offset,bb.offset=0,bb},ByteBuffer.isByteBuffer=function(bb){return!0===(bb&&bb.__isByteBuffer__)},ByteBuffer.type=function(){return ArrayBuffer},ByteBuffer.wrap=function(buffer,encoding,littleEndian,noAssert){if("string"!=typeof encoding&&(noAssert=littleEndian,littleEndian=encoding,encoding=void 0),"string"==typeof buffer)switch(void 0===encoding&&(encoding="utf8"),encoding){case"base64":return ByteBuffer.fromBase64(buffer,littleEndian);case"hex":return ByteBuffer.fromHex(buffer,littleEndian);case"binary":return ByteBuffer.fromBinary(buffer,littleEndian);case"utf8":return ByteBuffer.fromUTF8(buffer,littleEndian);case"debug":return ByteBuffer.fromDebug(buffer,littleEndian);default:throw Error("Unsupported encoding: "+encoding)}if(null===buffer||"object"!=typeof buffer)throw TypeError("Illegal buffer");var bb;if(ByteBuffer.isByteBuffer(buffer))return(bb=ByteBufferPrototype.clone.call(buffer)).markedOffset=-1,bb;if(buffer instanceof Uint8Array)bb=new ByteBuffer(0,littleEndian,noAssert),buffer.length>0&&(bb.buffer=buffer.buffer,bb.offset=buffer.byteOffset,bb.limit=buffer.byteOffset+buffer.byteLength,bb.view=new Uint8Array(buffer.buffer));else if(buffer instanceof ArrayBuffer)bb=new ByteBuffer(0,littleEndian,noAssert),buffer.byteLength>0&&(bb.buffer=buffer,bb.offset=0,bb.limit=buffer.byteLength,bb.view=buffer.byteLength>0?new Uint8Array(buffer):null);else{if("[object Array]"!==Object.prototype.toString.call(buffer))throw TypeError("Illegal buffer");(bb=new ByteBuffer(buffer.length,littleEndian,noAssert)).limit=buffer.length;for(var i=0;i<buffer.length;++i)bb.view[i]=buffer[i]}return bb},ByteBufferPrototype.writeBitSet=function(value,offset){var relative=void 0===offset;if(relative&&(offset=this.offset),!this.noAssert){if(!(value instanceof Array))throw TypeError("Illegal BitSet: Not an array");if("number"!=typeof offset||offset%1!=0)throw TypeError("Illegal offset: "+offset+" (not an integer)");if((offset>>>=0)<0||offset+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+offset+" (+0) <= "+this.buffer.byteLength)}var k,start=offset,bits=value.length,bytes=bits>>3,bit=0;for(offset+=this.writeVarint32(bits,offset);bytes--;)k=1&!!value[bit++]|(1&!!value[bit++])<<1|(1&!!value[bit++])<<2|(1&!!value[bit++])<<3|(1&!!value[bit++])<<4|(1&!!value[bit++])<<5|(1&!!value[bit++])<<6|(1&!!value[bit++])<<7,this.writeByte(k,offset++);if(bit<bits){var m=0;for(k=0;bit<bits;)k|=(1&!!value[bit++])<<m++;this.writeByte(k,offset++)}return relative?(this.offset=offset,this):offset-start},ByteBufferPrototype.readBitSet=function(offset){var relative=void 0===offset;relative&&(offset=this.offset);var k,ret=this.readVarint32(offset),bits=ret.value,bytes=bits>>3,bit=0,value=[];for(offset+=ret.length;bytes--;)k=this.readByte(offset++),value[bit++]=!!(1&k),value[bit++]=!!(2&k),value[bit++]=!!(4&k),value[bit++]=!!(8&k),value[bit++]=!!(16&k),value[bit++]=!!(32&k),value[bit++]=!!(64&k),value[bit++]=!!(128&k);if(bit<bits){var m=0;for(k=this.readByte(offset++);bit<bits;)value[bit++]=!!(k>>m++&1)}return relative&&(this.offset=offset),value},ByteBufferPrototype.readBytes=function(length,offset){var relative=void 0===offset;if(relative&&(offset=this.offset),!this.noAssert){if("number"!=typeof offset||offset%1!=0)throw TypeError("Illegal offset: "+offset+" (not an integer)");if((offset>>>=0)<0||offset+length>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+offset+" (+"+length+") <= "+this.buffer.byteLength)}var slice=this.slice(offset,offset+length);return relative&&(this.offset+=length),slice},ByteBufferPrototype.writeBytes=ByteBufferPrototype.append,ByteBufferPrototype.writeInt8=function(value,offset){var relative=void 0===offset;if(relative&&(offset=this.offset),!this.noAssert){if("number"!=typeof value||value%1!=0)throw TypeError("Illegal value: "+value+" (not an integer)");if(value|=0,"number"!=typeof offset||offset%1!=0)throw TypeError("Illegal offset: "+offset+" (not an integer)");if((offset>>>=0)<0||offset+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+offset+" (+0) <= "+this.buffer.byteLength)}offset+=1;var capacity0=this.buffer.byteLength;return offset>capacity0&&this.resize((capacity0*=2)>offset?capacity0:offset),offset-=1,this.view[offset]=value,relative&&(this.offset+=1),this},ByteBufferPrototype.writeByte=ByteBufferPrototype.writeInt8,ByteBufferPrototype.readInt8=function(offset){var relative=void 0===offset;if(relative&&(offset=this.offset),!this.noAssert){if("number"!=typeof offset||offset%1!=0)throw TypeError("Illegal offset: "+offset+" (not an integer)");if((offset>>>=0)<0||offset+1>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+offset+" (+1) <= "+this.buffer.byteLength)}var value=this.view[offset];return 128==(128&value)&&(value=-(255-value+1)),relative&&(this.offset+=1),value},ByteBufferPrototype.readByte=ByteBufferPrototype.readInt8,ByteBufferPrototype.writeUint8=function(value,offset){var relative=void 0===offset;if(relative&&(offset=this.offset),!this.noAssert){if("number"!=typeof value||value%1!=0)throw TypeError("Illegal value: "+value+" (not an integer)");if(value>>>=0,"number"!=typeof offset||offset%1!=0)throw TypeError("Illegal offset: "+offset+" (not an integer)");if((offset>>>=0)<0||offset+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+offset+" (+0) <= "+this.buffer.byteLength)}offset+=1;var capacity1=this.buffer.byteLength;return offset>capacity1&&this.resize((capacity1*=2)>offset?capacity1:offset),offset-=1,this.view[offset]=value,relative&&(this.offset+=1),this},ByteBufferPrototype.writeUInt8=ByteBufferPrototype.writeUint8,ByteBufferPrototype.readUint8=function(offset){var relative=void 0===offset;if(relative&&(offset=this.offset),!this.noAssert){if("number"!=typeof offset||offset%1!=0)throw TypeError("Illegal offset: "+offset+" (not an integer)");if((offset>>>=0)<0||offset+1>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+offset+" (+1) <= "+this.buffer.byteLength)}var value=this.view[offset];return relative&&(this.offset+=1),value},ByteBufferPrototype.readUInt8=ByteBufferPrototype.readUint8,ByteBufferPrototype.writeInt16=function(value,offset){var relative=void 0===offset;if(relative&&(offset=this.offset),!this.noAssert){if("number"!=typeof value||value%1!=0)throw TypeError("Illegal value: "+value+" (not an integer)");if(value|=0,"number"!=typeof offset||offset%1!=0)throw TypeError("Illegal offset: "+offset+" (not an integer)");if((offset>>>=0)<0||offset+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+offset+" (+0) <= "+this.buffer.byteLength)}offset+=2;var capacity2=this.buffer.byteLength;return offset>capacity2&&this.resize((capacity2*=2)>offset?capacity2:offset),offset-=2,this.littleEndian?(this.view[offset+1]=(65280&value)>>>8,this.view[offset]=255&value):(this.view[offset]=(65280&value)>>>8,this.view[offset+1]=255&value),relative&&(this.offset+=2),this},ByteBufferPrototype.writeShort=ByteBufferPrototype.writeInt16,ByteBufferPrototype.readInt16=function(offset){var relative=void 0===offset;if(relative&&(offset=this.offset),!this.noAssert){if("number"!=typeof offset||offset%1!=0)throw TypeError("Illegal offset: "+offset+" (not an integer)");if((offset>>>=0)<0||offset+2>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+offset+" (+2) <= "+this.buffer.byteLength)}var value=0;return this.littleEndian?(value=this.view[offset],value|=this.view[offset+1]<<8):(value=this.view[offset]<<8,value|=this.view[offset+1]),32768==(32768&value)&&(value=-(65535-value+1)),relative&&(this.offset+=2),value},ByteBufferPrototype.readShort=ByteBufferPrototype.readInt16,ByteBufferPrototype.writeUint16=function(value,offset){var relative=void 0===offset;if(relative&&(offset=this.offset),!this.noAssert){if("number"!=typeof value||value%1!=0)throw TypeError("Illegal value: "+value+" (not an integer)");if(value>>>=0,"number"!=typeof offset||offset%1!=0)throw TypeError("Illegal offset: "+offset+" (not an integer)");if((offset>>>=0)<0||offset+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+offset+" (+0) <= "+this.buffer.byteLength)}offset+=2;var capacity3=this.buffer.byteLength;return offset>capacity3&&this.resize((capacity3*=2)>offset?capacity3:offset),offset-=2,this.littleEndian?(this.view[offset+1]=(65280&value)>>>8,this.view[offset]=255&value):(this.view[offset]=(65280&value)>>>8,this.view[offset+1]=255&value),relative&&(this.offset+=2),this},ByteBufferPrototype.writeUInt16=ByteBufferPrototype.writeUint16,ByteBufferPrototype.readUint16=function(offset){var relative=void 0===offset;if(relative&&(offset=this.offset),!this.noAssert){if("number"!=typeof offset||offset%1!=0)throw TypeError("Illegal offset: "+offset+" (not an integer)");if((offset>>>=0)<0||offset+2>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+offset+" (+2) <= "+this.buffer.byteLength)}var value=0;return this.littleEndian?(value=this.view[offset],value|=this.view[offset+1]<<8):(value=this.view[offset]<<8,value|=this.view[offset+1]),relative&&(this.offset+=2),value},ByteBufferPrototype.readUInt16=ByteBufferPrototype.readUint16,ByteBufferPrototype.writeInt32=function(value,offset){var relative=void 0===offset;if(relative&&(offset=this.offset),!this.noAssert){if("number"!=typeof value||value%1!=0)throw TypeError("Illegal value: "+value+" (not an integer)");if(value|=0,"number"!=typeof offset||offset%1!=0)throw TypeError("Illegal offset: "+offset+" (not an integer)");if((offset>>>=0)<0||offset+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+offset+" (+0) <= "+this.buffer.byteLength)}offset+=4;var capacity4=this.buffer.byteLength;return offset>capacity4&&this.resize((capacity4*=2)>offset?capacity4:offset),offset-=4,this.littleEndian?(this.view[offset+3]=value>>>24&255,this.view[offset+2]=value>>>16&255,this.view[offset+1]=value>>>8&255,this.view[offset]=255&value):(this.view[offset]=value>>>24&255,this.view[offset+1]=value>>>16&255,this.view[offset+2]=value>>>8&255,this.view[offset+3]=255&value),relative&&(this.offset+=4),this},ByteBufferPrototype.writeInt=ByteBufferPrototype.writeInt32,ByteBufferPrototype.readInt32=function(offset){var relative=void 0===offset;if(relative&&(offset=this.offset),!this.noAssert){if("number"!=typeof offset||offset%1!=0)throw TypeError("Illegal offset: "+offset+" (not an integer)");if((offset>>>=0)<0||offset+4>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+offset+" (+4) <= "+this.buffer.byteLength)}var value=0;return this.littleEndian?(value=this.view[offset+2]<<16,value|=this.view[offset+1]<<8,value|=this.view[offset],value+=this.view[offset+3]<<24>>>0):(value=this.view[offset+1]<<16,value|=this.view[offset+2]<<8,value|=this.view[offset+3],value+=this.view[offset]<<24>>>0),value|=0,relative&&(this.offset+=4),value},ByteBufferPrototype.readInt=ByteBufferPrototype.readInt32,ByteBufferPrototype.writeUint32=function(value,offset){var relative=void 0===offset;if(relative&&(offset=this.offset),!this.noAssert){if("number"!=typeof value||value%1!=0)throw TypeError("Illegal value: "+value+" (not an integer)");if(value>>>=0,"number"!=typeof offset||offset%1!=0)throw TypeError("Illegal offset: "+offset+" (not an integer)");if((offset>>>=0)<0||offset+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+offset+" (+0) <= "+this.buffer.byteLength)}offset+=4;var capacity5=this.buffer.byteLength;return offset>capacity5&&this.resize((capacity5*=2)>offset?capacity5:offset),offset-=4,this.littleEndian?(this.view[offset+3]=value>>>24&255,this.view[offset+2]=value>>>16&255,this.view[offset+1]=value>>>8&255,this.view[offset]=255&value):(this.view[offset]=value>>>24&255,this.view[offset+1]=value>>>16&255,this.view[offset+2]=value>>>8&255,this.view[offset+3]=255&value),relative&&(this.offset+=4),this},ByteBufferPrototype.writeUInt32=ByteBufferPrototype.writeUint32,ByteBufferPrototype.readUint32=function(offset){var relative=void 0===offset;if(relative&&(offset=this.offset),!this.noAssert){if("number"!=typeof offset||offset%1!=0)throw TypeError("Illegal offset: "+offset+" (not an integer)");if((offset>>>=0)<0||offset+4>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+offset+" (+4) <= "+this.buffer.byteLength)}var value=0;return this.littleEndian?(value=this.view[offset+2]<<16,value|=this.view[offset+1]<<8,value|=this.view[offset],value+=this.view[offset+3]<<24>>>0):(value=this.view[offset+1]<<16,value|=this.view[offset+2]<<8,value|=this.view[offset+3],value+=this.view[offset]<<24>>>0),relative&&(this.offset+=4),value},ByteBufferPrototype.readUInt32=ByteBufferPrototype.readUint32,Long&&(ByteBufferPrototype.writeInt64=function(value,offset){var relative=void 0===offset;if(relative&&(offset=this.offset),!this.noAssert){if("number"==typeof value)value=Long.fromNumber(value);else if("string"==typeof value)value=Long.fromString(value);else if(!(value&&value instanceof Long))throw TypeError("Illegal value: "+value+" (not an integer or Long)");if("number"!=typeof offset||offset%1!=0)throw TypeError("Illegal offset: "+offset+" (not an integer)");if((offset>>>=0)<0||offset+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+offset+" (+0) <= "+this.buffer.byteLength)}"number"==typeof value?value=Long.fromNumber(value):"string"==typeof value&&(value=Long.fromString(value)),offset+=8;var capacity6=this.buffer.byteLength;offset>capacity6&&this.resize((capacity6*=2)>offset?capacity6:offset),offset-=8;var lo=value.low,hi=value.high;return this.littleEndian?(this.view[offset+3]=lo>>>24&255,this.view[offset+2]=lo>>>16&255,this.view[offset+1]=lo>>>8&255,this.view[offset]=255&lo,offset+=4,this.view[offset+3]=hi>>>24&255,this.view[offset+2]=hi>>>16&255,this.view[offset+1]=hi>>>8&255,this.view[offset]=255&hi):(this.view[offset]=hi>>>24&255,this.view[offset+1]=hi>>>16&255,this.view[offset+2]=hi>>>8&255,this.view[offset+3]=255&hi,offset+=4,this.view[offset]=lo>>>24&255,this.view[offset+1]=lo>>>16&255,this.view[offset+2]=lo>>>8&255,this.view[offset+3]=255&lo),relative&&(this.offset+=8),this},ByteBufferPrototype.writeLong=ByteBufferPrototype.writeInt64,ByteBufferPrototype.readInt64=function(offset){var relative=void 0===offset;if(relative&&(offset=this.offset),!this.noAssert){if("number"!=typeof offset||offset%1!=0)throw TypeError("Illegal offset: "+offset+" (not an integer)");if((offset>>>=0)<0||offset+8>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+offset+" (+8) <= "+this.buffer.byteLength)}var lo=0,hi=0;this.littleEndian?(lo=this.view[offset+2]<<16,lo|=this.view[offset+1]<<8,lo|=this.view[offset],lo+=this.view[offset+3]<<24>>>0,offset+=4,hi=this.view[offset+2]<<16,hi|=this.view[offset+1]<<8,hi|=this.view[offset],hi+=this.view[offset+3]<<24>>>0):(hi=this.view[offset+1]<<16,hi|=this.view[offset+2]<<8,hi|=this.view[offset+3],hi+=this.view[offset]<<24>>>0,offset+=4,lo=this.view[offset+1]<<16,lo|=this.view[offset+2]<<8,lo|=this.view[offset+3],lo+=this.view[offset]<<24>>>0);var value=new Long(lo,hi,!1);return relative&&(this.offset+=8),value},ByteBufferPrototype.readLong=ByteBufferPrototype.readInt64,ByteBufferPrototype.writeUint64=function(value,offset){var relative=void 0===offset;if(relative&&(offset=this.offset),!this.noAssert){if("number"==typeof value)value=Long.fromNumber(value);else if("string"==typeof value)value=Long.fromString(value);else if(!(value&&value instanceof Long))throw TypeError("Illegal value: "+value+" (not an integer or Long)");if("number"!=typeof offset||offset%1!=0)throw TypeError("Illegal offset: "+offset+" (not an integer)");if((offset>>>=0)<0||offset+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+offset+" (+0) <= "+this.buffer.byteLength)}"number"==typeof value?value=Long.fromNumber(value):"string"==typeof value&&(value=Long.fromString(value)),offset+=8;var capacity7=this.buffer.byteLength;offset>capacity7&&this.resize((capacity7*=2)>offset?capacity7:offset),offset-=8;var lo=value.low,hi=value.high;return this.littleEndian?(this.view[offset+3]=lo>>>24&255,this.view[offset+2]=lo>>>16&255,this.view[offset+1]=lo>>>8&255,this.view[offset]=255&lo,offset+=4,this.view[offset+3]=hi>>>24&255,this.view[offset+2]=hi>>>16&255,this.view[offset+1]=hi>>>8&255,this.view[offset]=255&hi):(this.view[offset]=hi>>>24&255,this.view[offset+1]=hi>>>16&255,this.view[offset+2]=hi>>>8&255,this.view[offset+3]=255&hi,offset+=4,this.view[offset]=lo>>>24&255,this.view[offset+1]=lo>>>16&255,this.view[offset+2]=lo>>>8&255,this.view[offset+3]=255&lo),relative&&(this.offset+=8),this},ByteBufferPrototype.writeUInt64=ByteBufferPrototype.writeUint64,ByteBufferPrototype.readUint64=function(offset){var relative=void 0===offset;if(relative&&(offset=this.offset),!this.noAssert){if("number"!=typeof offset||offset%1!=0)throw TypeError("Illegal offset: "+offset+" (not an integer)");if((offset>>>=0)<0||offset+8>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+offset+" (+8) <= "+this.buffer.byteLength)}var lo=0,hi=0;this.littleEndian?(lo=this.view[offset+2]<<16,lo|=this.view[offset+1]<<8,lo|=this.view[offset],lo+=this.view[offset+3]<<24>>>0,offset+=4,hi=this.view[offset+2]<<16,hi|=this.view[offset+1]<<8,hi|=this.view[offset],hi+=this.view[offset+3]<<24>>>0):(hi=this.view[offset+1]<<16,hi|=this.view[offset+2]<<8,hi|=this.view[offset+3],hi+=this.view[offset]<<24>>>0,offset+=4,lo=this.view[offset+1]<<16,lo|=this.view[offset+2]<<8,lo|=this.view[offset+3],lo+=this.view[offset]<<24>>>0);var value=new Long(lo,hi,!0);return relative&&(this.offset+=8),value},ByteBufferPrototype.readUInt64=ByteBufferPrototype.readUint64),ByteBufferPrototype.writeFloat32=function(value,offset){var relative=void 0===offset;if(relative&&(offset=this.offset),!this.noAssert){if("number"!=typeof value)throw TypeError("Illegal value: "+value+" (not a number)");if("number"!=typeof offset||offset%1!=0)throw TypeError("Illegal offset: "+offset+" (not an integer)");if((offset>>>=0)<0||offset+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+offset+" (+0) <= "+this.buffer.byteLength)}offset+=4;var capacity8=this.buffer.byteLength;return offset>capacity8&&this.resize((capacity8*=2)>offset?capacity8:offset),offset-=4,ieee754_write(this.view,value,offset,this.littleEndian,23,4),relative&&(this.offset+=4),this},ByteBufferPrototype.writeFloat=ByteBufferPrototype.writeFloat32,ByteBufferPrototype.readFloat32=function(offset){var relative=void 0===offset;if(relative&&(offset=this.offset),!this.noAssert){if("number"!=typeof offset||offset%1!=0)throw TypeError("Illegal offset: "+offset+" (not an integer)");if((offset>>>=0)<0||offset+4>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+offset+" (+4) <= "+this.buffer.byteLength)}var value=ieee754_read(this.view,offset,this.littleEndian,23,4);return relative&&(this.offset+=4),value},ByteBufferPrototype.readFloat=ByteBufferPrototype.readFloat32,ByteBufferPrototype.writeFloat64=function(value,offset){var relative=void 0===offset;if(relative&&(offset=this.offset),!this.noAssert){if("number"!=typeof value)throw TypeError("Illegal value: "+value+" (not a number)");if("number"!=typeof offset||offset%1!=0)throw TypeError("Illegal offset: "+offset+" (not an integer)");if((offset>>>=0)<0||offset+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+offset+" (+0) <= "+this.buffer.byteLength)}offset+=8;var capacity9=this.buffer.byteLength;return offset>capacity9&&this.resize((capacity9*=2)>offset?capacity9:offset),offset-=8,ieee754_write(this.view,value,offset,this.littleEndian,52,8),relative&&(this.offset+=8),this},ByteBufferPrototype.writeDouble=ByteBufferPrototype.writeFloat64,ByteBufferPrototype.readFloat64=function(offset){var relative=void 0===offset;if(relative&&(offset=this.offset),!this.noAssert){if("number"!=typeof offset||offset%1!=0)throw TypeError("Illegal offset: "+offset+" (not an integer)");if((offset>>>=0)<0||offset+8>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+offset+" (+8) <= "+this.buffer.byteLength)}var value=ieee754_read(this.view,offset,this.littleEndian,52,8);return relative&&(this.offset+=8),value},ByteBufferPrototype.readDouble=ByteBufferPrototype.readFloat64,ByteBuffer.MAX_VARINT32_BYTES=5,ByteBuffer.calculateVarint32=function(value){return(value>>>=0)<128?1:value<16384?2:value<1<<21?3:value<1<<28?4:5},ByteBuffer.zigZagEncode32=function(n){return((n|=0)<<1^n>>31)>>>0},ByteBuffer.zigZagDecode32=function(n){return n>>>1^-(1&n)|0},ByteBufferPrototype.writeVarint32=function(value,offset){var relative=void 0===offset;if(relative&&(offset=this.offset),!this.noAssert){if("number"!=typeof value||value%1!=0)throw TypeError("Illegal value: "+value+" (not an integer)");if(value|=0,"number"!=typeof offset||offset%1!=0)throw TypeError("Illegal offset: "+offset+" (not an integer)");if((offset>>>=0)<0||offset+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+offset+" (+0) <= "+this.buffer.byteLength)}var b,size=ByteBuffer.calculateVarint32(value);offset+=size;var capacity10=this.buffer.byteLength;for(offset>capacity10&&this.resize((capacity10*=2)>offset?capacity10:offset),offset-=size,value>>>=0;value>=128;)b=127&value|128,this.view[offset++]=b,value>>>=7;return this.view[offset++]=value,relative?(this.offset=offset,this):size},ByteBufferPrototype.writeVarint32ZigZag=function(value,offset){return this.writeVarint32(ByteBuffer.zigZagEncode32(value),offset)},ByteBufferPrototype.readVarint32=function(offset){var relative=void 0===offset;if(relative&&(offset=this.offset),!this.noAssert){if("number"!=typeof offset||offset%1!=0)throw TypeError("Illegal offset: "+offset+" (not an integer)");if((offset>>>=0)<0||offset+1>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+offset+" (+1) <= "+this.buffer.byteLength)}var b,c=0,value=0;do{if(!this.noAssert&&offset>this.limit){var err=Error("Truncated");throw err.truncated=!0,err}b=this.view[offset++],c<5&&(value|=(127&b)<<7*c),++c}while(0!=(128&b));return value|=0,relative?(this.offset=offset,value):{value:value,length:c}},ByteBufferPrototype.readVarint32ZigZag=function(offset){var val=this.readVarint32(offset);return"object"==typeof val?val.value=ByteBuffer.zigZagDecode32(val.value):val=ByteBuffer.zigZagDecode32(val),val},Long&&(ByteBuffer.MAX_VARINT64_BYTES=10,ByteBuffer.calculateVarint64=function(value){"number"==typeof value?value=Long.fromNumber(value):"string"==typeof value&&(value=Long.fromString(value));var part0=value.toInt()>>>0,part1=value.shiftRightUnsigned(28).toInt()>>>0,part2=value.shiftRightUnsigned(56).toInt()>>>0;return 0==part2?0==part1?part0<16384?part0<128?1:2:part0<1<<21?3:4:part1<16384?part1<128?5:6:part1<1<<21?7:8:part2<128?9:10},ByteBuffer.zigZagEncode64=function(value){return"number"==typeof value?value=Long.fromNumber(value,!1):"string"==typeof value?value=Long.fromString(value,!1):!1!==value.unsigned&&(value=value.toSigned()),value.shiftLeft(1).xor(value.shiftRight(63)).toUnsigned()},ByteBuffer.zigZagDecode64=function(value){return"number"==typeof value?value=Long.fromNumber(value,!1):"string"==typeof value?value=Long.fromString(value,!1):!1!==value.unsigned&&(value=value.toSigned()),value.shiftRightUnsigned(1).xor(value.and(Long.ONE).toSigned().negate()).toSigned()},ByteBufferPrototype.writeVarint64=function(value,offset){var relative=void 0===offset;if(relative&&(offset=this.offset),!this.noAssert){if("number"==typeof value)value=Long.fromNumber(value);else if("string"==typeof value)value=Long.fromString(value);else if(!(value&&value instanceof Long))throw TypeError("Illegal value: "+value+" (not an integer or Long)");if("number"!=typeof offset||offset%1!=0)throw TypeError("Illegal offset: "+offset+" (not an integer)");if((offset>>>=0)<0||offset+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+offset+" (+0) <= "+this.buffer.byteLength)}"number"==typeof value?value=Long.fromNumber(value,!1):"string"==typeof value?value=Long.fromString(value,!1):!1!==value.unsigned&&(value=value.toSigned());var size=ByteBuffer.calculateVarint64(value),part0=value.toInt()>>>0,part1=value.shiftRightUnsigned(28).toInt()>>>0,part2=value.shiftRightUnsigned(56).toInt()>>>0;offset+=size;var capacity11=this.buffer.byteLength;switch(offset>capacity11&&this.resize((capacity11*=2)>offset?capacity11:offset),offset-=size,size){case 10:this.view[offset+9]=part2>>>7&1;case 9:this.view[offset+8]=9!==size?128|part2:127&part2;case 8:this.view[offset+7]=8!==size?part1>>>21|128:part1>>>21&127;case 7:this.view[offset+6]=7!==size?part1>>>14|128:part1>>>14&127;case 6:this.view[offset+5]=6!==size?part1>>>7|128:part1>>>7&127;case 5:this.view[offset+4]=5!==size?128|part1:127&part1;case 4:this.view[offset+3]=4!==size?part0>>>21|128:part0>>>21&127;case 3:this.view[offset+2]=3!==size?part0>>>14|128:part0>>>14&127;case 2:this.view[offset+1]=2!==size?part0>>>7|128:part0>>>7&127;case 1:this.view[offset]=1!==size?128|part0:127&part0}return relative?(this.offset+=size,this):size},ByteBufferPrototype.writeVarint64ZigZag=function(value,offset){return this.writeVarint64(ByteBuffer.zigZagEncode64(value),offset)},ByteBufferPrototype.readVarint64=function(offset){var relative=void 0===offset;if(relative&&(offset=this.offset),!this.noAssert){if("number"!=typeof offset||offset%1!=0)throw TypeError("Illegal offset: "+offset+" (not an integer)");if((offset>>>=0)<0||offset+1>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+offset+" (+1) <= "+this.buffer.byteLength)}var start=offset,part0=0,part1=0,part2=0,b=0;if(part0=127&(b=this.view[offset++]),128&b&&(part0|=(127&(b=this.view[offset++]))<<7,(128&b||this.noAssert&&void 0===b)&&(part0|=(127&(b=this.view[offset++]))<<14,(128&b||this.noAssert&&void 0===b)&&(part0|=(127&(b=this.view[offset++]))<<21,(128&b||this.noAssert&&void 0===b)&&(part1=127&(b=this.view[offset++]),(128&b||this.noAssert&&void 0===b)&&(part1|=(127&(b=this.view[offset++]))<<7,(128&b||this.noAssert&&void 0===b)&&(part1|=(127&(b=this.view[offset++]))<<14,(128&b||this.noAssert&&void 0===b)&&(part1|=(127&(b=this.view[offset++]))<<21,(128&b||this.noAssert&&void 0===b)&&(part2=127&(b=this.view[offset++]),(128&b||this.noAssert&&void 0===b)&&(part2|=(127&(b=this.view[offset++]))<<7,128&b||this.noAssert&&void 0===b))))))))))throw Error("Buffer overrun");var value=Long.fromBits(part0|part1<<28,part1>>>4|part2<<24,!1);return relative?(this.offset=offset,value):{value:value,length:offset-start}},ByteBufferPrototype.readVarint64ZigZag=function(offset){var val=this.readVarint64(offset);return val&&val.value instanceof Long?val.value=ByteBuffer.zigZagDecode64(val.value):val=ByteBuffer.zigZagDecode64(val),val}),ByteBufferPrototype.writeCString=function(str,offset){var relative=void 0===offset;relative&&(offset=this.offset);var i,k=str.length;if(!this.noAssert){if("string"!=typeof str)throw TypeError("Illegal str: Not a string");for(i=0;i<k;++i)if(0===str.charCodeAt(i))throw RangeError("Illegal str: Contains NULL-characters");if("number"!=typeof offset||offset%1!=0)throw TypeError("Illegal offset: "+offset+" (not an integer)");if((offset>>>=0)<0||offset+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+offset+" (+0) <= "+this.buffer.byteLength)}k=utfx.calculateUTF16asUTF8(stringSource(str))[1],offset+=k+1;var capacity12=this.buffer.byteLength;return offset>capacity12&&this.resize((capacity12*=2)>offset?capacity12:offset),offset-=k+1,utfx.encodeUTF16toUTF8(stringSource(str),function(b){this.view[offset++]=b}.bind(this)),this.view[offset++]=0,relative?(this.offset=offset,this):k},ByteBufferPrototype.readCString=function(offset){var relative=void 0===offset;if(relative&&(offset=this.offset),!this.noAssert){if("number"!=typeof offset||offset%1!=0)throw TypeError("Illegal offset: "+offset+" (not an integer)");if((offset>>>=0)<0||offset+1>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+offset+" (+1) <= "+this.buffer.byteLength)}var sd,start=offset,b=-1;return utfx.decodeUTF8toUTF16(function(){if(0===b)return null;if(offset>=this.limit)throw RangeError("Illegal range: Truncated data, "+offset+" < "+this.limit);return 0===(b=this.view[offset++])?null:b}.bind(this),sd=stringDestination(),!0),relative?(this.offset=offset,sd()):{string:sd(),length:offset-start}},ByteBufferPrototype.writeIString=function(str,offset){var relative=void 0===offset;if(relative&&(offset=this.offset),!this.noAssert){if("string"!=typeof str)throw TypeError("Illegal str: Not a string");if("number"!=typeof offset||offset%1!=0)throw TypeError("Illegal offset: "+offset+" (not an integer)");if((offset>>>=0)<0||offset+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+offset+" (+0) <= "+this.buffer.byteLength)}var k,start=offset;k=utfx.calculateUTF16asUTF8(stringSource(str),this.noAssert)[1],offset+=4+k;var capacity13=this.buffer.byteLength;if(offset>capacity13&&this.resize((capacity13*=2)>offset?capacity13:offset),offset-=4+k,this.littleEndian?(this.view[offset+3]=k>>>24&255,this.view[offset+2]=k>>>16&255,this.view[offset+1]=k>>>8&255,this.view[offset]=255&k):(this.view[offset]=k>>>24&255,this.view[offset+1]=k>>>16&255,this.view[offset+2]=k>>>8&255,this.view[offset+3]=255&k),offset+=4,utfx.encodeUTF16toUTF8(stringSource(str),function(b){this.view[offset++]=b}.bind(this)),offset!==start+4+k)throw RangeError("Illegal range: Truncated data, "+offset+" == "+(offset+4+k));return relative?(this.offset=offset,this):offset-start},ByteBufferPrototype.readIString=function(offset){var relative=void 0===offset;if(relative&&(offset=this.offset),!this.noAssert){if("number"!=typeof offset||offset%1!=0)throw TypeError("Illegal offset: "+offset+" (not an integer)");if((offset>>>=0)<0||offset+4>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+offset+" (+4) <= "+this.buffer.byteLength)}var start=offset,len=this.readUint32(offset),str=this.readUTF8String(len,ByteBuffer.METRICS_BYTES,offset+=4);return offset+=str.length,relative?(this.offset=offset,str.string):{string:str.string,length:offset-start}},ByteBuffer.METRICS_CHARS="c",ByteBuffer.METRICS_BYTES="b",ByteBufferPrototype.writeUTF8String=function(str,offset){var relative=void 0===offset;if(relative&&(offset=this.offset),!this.noAssert){if("number"!=typeof offset||offset%1!=0)throw TypeError("Illegal offset: "+offset+" (not an integer)");if((offset>>>=0)<0||offset+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+offset+" (+0) <= "+this.buffer.byteLength)}var k,start=offset;k=utfx.calculateUTF16asUTF8(stringSource(str))[1],offset+=k;var capacity14=this.buffer.byteLength;return offset>capacity14&&this.resize((capacity14*=2)>offset?capacity14:offset),offset-=k,utfx.encodeUTF16toUTF8(stringSource(str),function(b){this.view[offset++]=b}.bind(this)),relative?(this.offset=offset,this):offset-start},ByteBufferPrototype.writeString=ByteBufferPrototype.writeUTF8String,ByteBuffer.calculateUTF8Chars=function(str){return utfx.calculateUTF16asUTF8(stringSource(str))[0]},ByteBuffer.calculateUTF8Bytes=function(str){return utfx.calculateUTF16asUTF8(stringSource(str))[1]},ByteBuffer.calculateString=ByteBuffer.calculateUTF8Bytes,ByteBufferPrototype.readUTF8String=function(length,metrics,offset){"number"==typeof metrics&&(offset=metrics,metrics=void 0);var relative=void 0===offset;if(relative&&(offset=this.offset),void 0===metrics&&(metrics=ByteBuffer.METRICS_CHARS),!this.noAssert){if("number"!=typeof length||length%1!=0)throw TypeError("Illegal length: "+length+" (not an integer)");if(length|=0,"number"!=typeof offset||offset%1!=0)throw TypeError("Illegal offset: "+offset+" (not an integer)");if((offset>>>=0)<0||offset+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+offset+" (+0) <= "+this.buffer.byteLength)}var sd,i=0,start=offset;if(metrics===ByteBuffer.METRICS_CHARS){if(sd=stringDestination(),utfx.decodeUTF8(function(){return i<length&&offset<this.limit?this.view[offset++]:null}.bind(this),function(cp){++i,utfx.UTF8toUTF16(cp,sd)}),i!==length)throw RangeError("Illegal range: Truncated data, "+i+" == "+length);return relative?(this.offset=offset,sd()):{string:sd(),length:offset-start}}if(metrics===ByteBuffer.METRICS_BYTES){if(!this.noAssert){if("number"!=typeof offset||offset%1!=0)throw TypeError("Illegal offset: "+offset+" (not an integer)");if((offset>>>=0)<0||offset+length>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+offset+" (+"+length+") <= "+this.buffer.byteLength)}var k=offset+length;if(utfx.decodeUTF8toUTF16(function(){return offset<k?this.view[offset++]:null}.bind(this),sd=stringDestination(),this.noAssert),offset!==k)throw RangeError("Illegal range: Truncated data, "+offset+" == "+k);return relative?(this.offset=offset,sd()):{string:sd(),length:offset-start}}throw TypeError("Unsupported metrics: "+metrics)},ByteBufferPrototype.readString=ByteBufferPrototype.readUTF8String,ByteBufferPrototype.writeVString=function(str,offset){var relative=void 0===offset;if(relative&&(offset=this.offset),!this.noAssert){if("string"!=typeof str)throw TypeError("Illegal str: Not a string");if("number"!=typeof offset||offset%1!=0)throw TypeError("Illegal offset: "+offset+" (not an integer)");if((offset>>>=0)<0||offset+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+offset+" (+0) <= "+this.buffer.byteLength)}var k,l,start=offset;k=utfx.calculateUTF16asUTF8(stringSource(str),this.noAssert)[1],l=ByteBuffer.calculateVarint32(k),offset+=l+k;var capacity15=this.buffer.byteLength;if(offset>capacity15&&this.resize((capacity15*=2)>offset?capacity15:offset),offset-=l+k,offset+=this.writeVarint32(k,offset),utfx.encodeUTF16toUTF8(stringSource(str),function(b){this.view[offset++]=b}.bind(this)),offset!==start+k+l)throw RangeError("Illegal range: Truncated data, "+offset+" == "+(offset+k+l));return relative?(this.offset=offset,this):offset-start},ByteBufferPrototype.readVString=function(offset){var relative=void 0===offset;if(relative&&(offset=this.offset),!this.noAssert){if("number"!=typeof offset||offset%1!=0)throw TypeError("Illegal offset: "+offset+" (not an integer)");if((offset>>>=0)<0||offset+1>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+offset+" (+1) <= "+this.buffer.byteLength)}var start=offset,len=this.readVarint32(offset),str=this.readUTF8String(len.value,ByteBuffer.METRICS_BYTES,offset+=len.length);return offset+=str.length,relative?(this.offset=offset,str.string):{string:str.string,length:offset-start}},ByteBufferPrototype.append=function(source,encoding,offset){"number"!=typeof encoding&&"string"==typeof encoding||(offset=encoding,encoding=void 0);var relative=void 0===offset;if(relative&&(offset=this.offset),!this.noAssert){if("number"!=typeof offset||offset%1!=0)throw TypeError("Illegal offset: "+offset+" (not an integer)");if((offset>>>=0)<0||offset+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+offset+" (+0) <= "+this.buffer.byteLength)}source instanceof ByteBuffer||(source=ByteBuffer.wrap(source,encoding));var length=source.limit-source.offset;if(length<=0)return this;offset+=length;var capacity16=this.buffer.byteLength;return offset>capacity16&&this.resize((capacity16*=2)>offset?capacity16:offset),offset-=length,this.view.set(source.view.subarray(source.offset,source.limit),offset),source.offset+=length,relative&&(this.offset+=length),this},ByteBufferPrototype.appendTo=function(target,offset){return target.append(this,offset),this},ByteBufferPrototype.assert=function(assert){return this.noAssert=!assert,this},ByteBufferPrototype.capacity=function(){return this.buffer.byteLength},ByteBufferPrototype.clear=function(){return this.offset=0,this.limit=this.buffer.byteLength,this.markedOffset=-1,this},ByteBufferPrototype.clone=function(copy){var bb=new ByteBuffer(0,this.littleEndian,this.noAssert);return copy?(bb.buffer=new ArrayBuffer(this.buffer.byteLength),bb.view=new Uint8Array(bb.buffer)):(bb.buffer=this.buffer,bb.view=this.view),bb.offset=this.offset,bb.markedOffset=this.markedOffset,bb.limit=this.limit,bb},ByteBufferPrototype.compact=function(begin,end){if(void 0===begin&&(begin=this.offset),void 0===end&&(end=this.limit),!this.noAssert){if("number"!=typeof begin||begin%1!=0)throw TypeError("Illegal begin: Not an integer");if(begin>>>=0,"number"!=typeof end||end%1!=0)throw TypeError("Illegal end: Not an integer");if(end>>>=0,begin<0||begin>end||end>this.buffer.byteLength)throw RangeError("Illegal range: 0 <= "+begin+" <= "+end+" <= "+this.buffer.byteLength)}if(0===begin&&end===this.buffer.byteLength)return this;var len=end-begin;if(0===len)return this.buffer=EMPTY_BUFFER,this.view=null,this.markedOffset>=0&&(this.markedOffset-=begin),this.offset=0,this.limit=0,this;var buffer=new ArrayBuffer(len),view=new Uint8Array(buffer);return view.set(this.view.subarray(begin,end)),this.buffer=buffer,this.view=view,this.markedOffset>=0&&(this.markedOffset-=begin),this.offset=0,this.limit=len,this},ByteBufferPrototype.copy=function(begin,end){if(void 0===begin&&(begin=this.offset),void 0===end&&(end=this.limit),!this.noAssert){if("number"!=typeof begin||begin%1!=0)throw TypeError("Illegal begin: Not an integer");if(begin>>>=0,"number"!=typeof end||end%1!=0)throw TypeError("Illegal end: Not an integer");if(end>>>=0,begin<0||begin>end||end>this.buffer.byteLength)throw RangeError("Illegal range: 0 <= "+begin+" <= "+end+" <= "+this.buffer.byteLength)}if(begin===end)return new ByteBuffer(0,this.littleEndian,this.noAssert);var capacity=end-begin,bb=new ByteBuffer(capacity,this.littleEndian,this.noAssert);return bb.offset=0,bb.limit=capacity,bb.markedOffset>=0&&(bb.markedOffset-=begin),this.copyTo(bb,0,begin,end),bb},ByteBufferPrototype.copyTo=function(target,targetOffset,sourceOffset,sourceLimit){var relative,targetRelative;if(!this.noAssert&&!ByteBuffer.isByteBuffer(target))throw TypeError("Illegal target: Not a ByteBuffer");if(targetOffset=(targetRelative=void 0===targetOffset)?target.offset:0|targetOffset,sourceOffset=(relative=void 0===sourceOffset)?this.offset:0|sourceOffset,sourceLimit=void 0===sourceLimit?this.limit:0|sourceLimit,targetOffset<0||targetOffset>target.buffer.byteLength)throw RangeError("Illegal target range: 0 <= "+targetOffset+" <= "+target.buffer.byteLength);if(sourceOffset<0||sourceLimit>this.buffer.byteLength)throw RangeError("Illegal source range: 0 <= "+sourceOffset+" <= "+this.buffer.byteLength);var len=sourceLimit-sourceOffset;return 0===len?target:(target.ensureCapacity(targetOffset+len),target.view.set(this.view.subarray(sourceOffset,sourceLimit),targetOffset),relative&&(this.offset+=len),targetRelative&&(target.offset+=len),this)},ByteBufferPrototype.ensureCapacity=function(capacity){var current=this.buffer.byteLength;return current<capacity?this.resize((current*=2)>capacity?current:capacity):this},ByteBufferPrototype.fill=function(value,begin,end){var relative=void 0===begin;if(relative&&(begin=this.offset),"string"==typeof value&&value.length>0&&(value=value.charCodeAt(0)),void 0===begin&&(begin=this.offset),void 0===end&&(end=this.limit),!this.noAssert){if("number"!=typeof value||value%1!=0)throw TypeError("Illegal value: "+value+" (not an integer)");if(value|=0,"number"!=typeof begin||begin%1!=0)throw TypeError("Illegal begin: Not an integer");if(begin>>>=0,"number"!=typeof end||end%1!=0)throw TypeError("Illegal end: Not an integer");if(end>>>=0,begin<0||begin>end||end>this.buffer.byteLength)throw RangeError("Illegal range: 0 <= "+begin+" <= "+end+" <= "+this.buffer.byteLength)}if(begin>=end)return this;for(;begin<end;)this.view[begin++]=value;return relative&&(this.offset=begin),this},ByteBufferPrototype.flip=function(){return this.limit=this.offset,this.offset=0,this},ByteBufferPrototype.mark=function(offset){if(offset=void 0===offset?this.offset:offset,!this.noAssert){if("number"!=typeof offset||offset%1!=0)throw TypeError("Illegal offset: "+offset+" (not an integer)");if((offset>>>=0)<0||offset+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+offset+" (+0) <= "+this.buffer.byteLength)}return this.markedOffset=offset,this},ByteBufferPrototype.order=function(littleEndian){if(!this.noAssert&&"boolean"!=typeof littleEndian)throw TypeError("Illegal littleEndian: Not a boolean");return this.littleEndian=!!littleEndian,this},ByteBufferPrototype.LE=function(littleEndian){return this.littleEndian=void 0===littleEndian||!!littleEndian,this},ByteBufferPrototype.BE=function(bigEndian){return this.littleEndian=void 0!==bigEndian&&!bigEndian,this},ByteBufferPrototype.prepend=function(source,encoding,offset){"number"!=typeof encoding&&"string"==typeof encoding||(offset=encoding,encoding=void 0);var relative=void 0===offset;if(relative&&(offset=this.offset),!this.noAssert){if("number"!=typeof offset||offset%1!=0)throw TypeError("Illegal offset: "+offset+" (not an integer)");if((offset>>>=0)<0||offset+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+offset+" (+0) <= "+this.buffer.byteLength)}source instanceof ByteBuffer||(source=ByteBuffer.wrap(source,encoding));var len=source.limit-source.offset;if(len<=0)return this;var diff=len-offset;if(diff>0){var buffer=new ArrayBuffer(this.buffer.byteLength+diff),view=new Uint8Array(buffer);view.set(this.view.subarray(offset,this.buffer.byteLength),len),this.buffer=buffer,this.view=view,this.offset+=diff,this.markedOffset>=0&&(this.markedOffset+=diff),this.limit+=diff,offset+=diff}else new Uint8Array(this.buffer);return this.view.set(source.view.subarray(source.offset,source.limit),offset-len),source.offset=source.limit,relative&&(this.offset-=len),this},ByteBufferPrototype.prependTo=function(target,offset){return target.prepend(this,offset),this},ByteBufferPrototype.printDebug=function(out){"function"!=typeof out&&(out=console.log.bind(console)),out(this.toString()+"\n-------------------------------------------------------------------\n"+this.toDebug(!0))},ByteBufferPrototype.remaining=function(){return this.limit-this.offset},ByteBufferPrototype.reset=function(){return this.markedOffset>=0?(this.offset=this.markedOffset,this.markedOffset=-1):this.offset=0,this},ByteBufferPrototype.resize=function(capacity){if(!this.noAssert){if("number"!=typeof capacity||capacity%1!=0)throw TypeError("Illegal capacity: "+capacity+" (not an integer)");if((capacity|=0)<0)throw RangeError("Illegal capacity: 0 <= "+capacity)}if(this.buffer.byteLength<capacity){var buffer=new ArrayBuffer(capacity),view=new Uint8Array(buffer);view.set(this.view),this.buffer=buffer,this.view=view}return this},ByteBufferPrototype.reverse=function(begin,end){if(void 0===begin&&(begin=this.offset),void 0===end&&(end=this.limit),!this.noAssert){if("number"!=typeof begin||begin%1!=0)throw TypeError("Illegal begin: Not an integer");if(begin>>>=0,"number"!=typeof end||end%1!=0)throw TypeError("Illegal end: Not an integer");if(end>>>=0,begin<0||begin>end||end>this.buffer.byteLength)throw RangeError("Illegal range: 0 <= "+begin+" <= "+end+" <= "+this.buffer.byteLength)}return begin===end?this:(Array.prototype.reverse.call(this.view.subarray(begin,end)),this)},ByteBufferPrototype.skip=function(length){if(!this.noAssert){if("number"!=typeof length||length%1!=0)throw TypeError("Illegal length: "+length+" (not an integer)");length|=0}var offset=this.offset+length;if(!this.noAssert&&(offset<0||offset>this.buffer.byteLength))throw RangeError("Illegal length: 0 <= "+this.offset+" + "+length+" <= "+this.buffer.byteLength);return this.offset=offset,this},ByteBufferPrototype.slice=function(begin,end){if(void 0===begin&&(begin=this.offset),void 0===end&&(end=this.limit),!this.noAssert){if("number"!=typeof begin||begin%1!=0)throw TypeError("Illegal begin: Not an integer");if(begin>>>=0,"number"!=typeof end||end%1!=0)throw TypeError("Illegal end: Not an integer");if(end>>>=0,begin<0||begin>end||end>this.buffer.byteLength)throw RangeError("Illegal range: 0 <= "+begin+" <= "+end+" <= "+this.buffer.byteLength)}var bb=this.clone();return bb.offset=begin,bb.limit=end,bb},ByteBufferPrototype.toBuffer=function(forceCopy){var offset=this.offset,limit=this.limit;if(!this.noAssert){if("number"!=typeof offset||offset%1!=0)throw TypeError("Illegal offset: Not an integer");if(offset>>>=0,"number"!=typeof limit||limit%1!=0)throw TypeError("Illegal limit: Not an integer");if(limit>>>=0,offset<0||offset>limit||limit>this.buffer.byteLength)throw RangeError("Illegal range: 0 <= "+offset+" <= "+limit+" <= "+this.buffer.byteLength)}if(!forceCopy&&0===offset&&limit===this.buffer.byteLength)return this.buffer;if(offset===limit)return EMPTY_BUFFER;var buffer=new ArrayBuffer(limit-offset);return new Uint8Array(buffer).set(new Uint8Array(this.buffer).subarray(offset,limit),0),buffer},ByteBufferPrototype.toArrayBuffer=ByteBufferPrototype.toBuffer,ByteBufferPrototype.toString=function(encoding,begin,end){if(void 0===encoding)return"ByteBufferAB(offset="+this.offset+",markedOffset="+this.markedOffset+",limit="+this.limit+",capacity="+this.capacity()+")";switch("number"==typeof encoding&&(end=begin=encoding="utf8"),encoding){case"utf8":return this.toUTF8(begin,end);case"base64":return this.toBase64(begin,end);case"hex":return this.toHex(begin,end);case"binary":return this.toBinary(begin,end);case"debug":return this.toDebug();case"columns":return this.toColumns();default:throw Error("Unsupported encoding: "+encoding)}};var lxiv=function(){for(var lxiv={},aout=[65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,48,49,50,51,52,53,54,55,56,57,43,47],ain=[],i=0,k=aout.length;i<k;++i)ain[aout[i]]=i;return lxiv.encode=function(src,dst){for(var b,t;null!==(b=src());)dst(aout[b>>2&63]),t=(3&b)<<4,null!==(b=src())?(dst(aout[63&((t|=b>>4&15)|b>>4&15)]),t=(15&b)<<2,null!==(b=src())?(dst(aout[63&(t|b>>6&3)]),dst(aout[63&b])):(dst(aout[63&t]),dst(61))):(dst(aout[63&t]),dst(61),dst(61))},lxiv.decode=function(src,dst){function fail(c){throw Error("Illegal character code: "+c)}for(var c,t1,t2;null!==(c=src());)if(void 0===(t1=ain[c])&&fail(c),null!==(c=src())&&(void 0===(t2=ain[c])&&fail(c),dst(t1<<2>>>0|(48&t2)>>4),null!==(c=src()))){if(void 0===(t1=ain[c])){if(61===c)break;fail(c)}if(dst((15&t2)<<4>>>0|(60&t1)>>2),null!==(c=src())){if(void 0===(t2=ain[c])){if(61===c)break;fail(c)}dst((3&t1)<<6>>>0|t2)}}},lxiv.test=function(str){return/^(?:[A-Za-z0-9+\/]{4})*(?:[A-Za-z0-9+\/]{2}==|[A-Za-z0-9+\/]{3}=)?$/.test(str)},lxiv}();ByteBufferPrototype.toBase64=function(begin,end){if(void 0===begin&&(begin=this.offset),void 0===end&&(end=this.limit),end|=0,(begin|=0)<0||end>this.capacity||begin>end)throw RangeError("begin, end");var sd;return lxiv.encode(function(){return begin<end?this.view[begin++]:null}.bind(this),sd=stringDestination()),sd()},ByteBuffer.fromBase64=function(str,littleEndian){if("string"!=typeof str)throw TypeError("str");var bb=new ByteBuffer(str.length/4*3,littleEndian),i=0;return lxiv.decode(stringSource(str),function(b){bb.view[i++]=b}),bb.limit=i,bb},ByteBuffer.btoa=function(str){return ByteBuffer.fromBinary(str).toBase64()},ByteBuffer.atob=function(b64){return ByteBuffer.fromBase64(b64).toBinary()},ByteBufferPrototype.toBinary=function(begin,end){if(void 0===begin&&(begin=this.offset),void 0===end&&(end=this.limit),end|=0,(begin|=0)<0||end>this.capacity()||begin>end)throw RangeError("begin, end");if(begin===end)return"";for(var chars=[],parts=[];begin<end;)chars.push(this.view[begin++]),chars.length>=1024&&(parts.push(String.fromCharCode.apply(String,chars)),chars=[]);return parts.join("")+String.fromCharCode.apply(String,chars)},ByteBuffer.fromBinary=function(str,littleEndian){if("string"!=typeof str)throw TypeError("str");for(var charCode,i=0,k=str.length,bb=new ByteBuffer(k,littleEndian);i<k;){if((charCode=str.charCodeAt(i))>255)throw RangeError("illegal char code: "+charCode);bb.view[i++]=charCode}return bb.limit=k,bb},ByteBufferPrototype.toDebug=function(columns){for(var b,i=-1,k=this.buffer.byteLength,hex="",asc="",out="";i<k;){if(-1!==i&&(hex+=(b=this.view[i])<16?"0"+b.toString(16).toUpperCase():b.toString(16).toUpperCase(),columns&&(asc+=b>32&&b<127?String.fromCharCode(b):".")),++i,columns&&i>0&&i%16==0&&i!==k){for(;hex.length<51;)hex+=" ";out+=hex+asc+"\n",hex=asc=""}i===this.offset&&i===this.limit?hex+=i===this.markedOffset?"!":"|":i===this.offset?hex+=i===this.markedOffset?"[":"<":i===this.limit?hex+=i===this.markedOffset?"]":">":hex+=i===this.markedOffset?"'":columns||0!==i&&i!==k?" ":""}if(columns&&" "!==hex){for(;hex.length<51;)hex+=" ";out+=hex+asc+"\n"}return columns?out:hex},ByteBuffer.fromDebug=function(str,littleEndian,noAssert){for(var ch,b,k=str.length,bb=new ByteBuffer((k+1)/3|0,littleEndian,noAssert),i=0,j=0,rs=!1,ho=!1,hm=!1,hl=!1,fail=!1;i<k;){switch(ch=str.charAt(i++)){case"!":if(!noAssert){if(ho||hm||hl){fail=!0;break}ho=hm=hl=!0}bb.offset=bb.markedOffset=bb.limit=j,rs=!1;break;case"|":if(!noAssert){if(ho||hl){fail=!0;break}ho=hl=!0}bb.offset=bb.limit=j,rs=!1;break;case"[":if(!noAssert){if(ho||hm){fail=!0;break}ho=hm=!0}bb.offset=bb.markedOffset=j,rs=!1;break;case"<":if(!noAssert){if(ho){fail=!0;break}ho=!0}bb.offset=j,rs=!1;break;case"]":if(!noAssert){if(hl||hm){fail=!0;break}hl=hm=!0}bb.limit=bb.markedOffset=j,rs=!1;break;case">":if(!noAssert){if(hl){fail=!0;break}hl=!0}bb.limit=j,rs=!1;break;case"'":if(!noAssert){if(hm){fail=!0;break}hm=!0}bb.markedOffset=j,rs=!1;break;case" ":rs=!1;break;default:if(!noAssert&&rs){fail=!0;break}if(b=parseInt(ch+str.charAt(i++),16),!noAssert&&(isNaN(b)||b<0||b>255))throw TypeError("Illegal str: Not a debug encoded string");bb.view[j++]=b,rs=!0}if(fail)throw TypeError("Illegal str: Invalid symbol at "+i)}if(!noAssert){if(!ho||!hl)throw TypeError("Illegal str: Missing offset or limit");if(j<bb.buffer.byteLength)throw TypeError("Illegal str: Not a debug encoded string (is it hex?) "+j+" < "+k)}return bb},ByteBufferPrototype.toHex=function(begin,end){if(begin=void 0===begin?this.offset:begin,end=void 0===end?this.limit:end,!this.noAssert){if("number"!=typeof begin||begin%1!=0)throw TypeError("Illegal begin: Not an integer");if(begin>>>=0,"number"!=typeof end||end%1!=0)throw TypeError("Illegal end: Not an integer");if(end>>>=0,begin<0||begin>end||end>this.buffer.byteLength)throw RangeError("Illegal range: 0 <= "+begin+" <= "+end+" <= "+this.buffer.byteLength)}for(var b,out=new Array(end-begin);begin<end;)(b=this.view[begin++])<16?out.push("0",b.toString(16)):out.push(b.toString(16));return out.join("")},ByteBuffer.fromHex=function(str,littleEndian,noAssert){if(!noAssert){if("string"!=typeof str)throw TypeError("Illegal str: Not a string");if(str.length%2!=0)throw TypeError("Illegal str: Length not a multiple of 2")}for(var b,k=str.length,bb=new ByteBuffer(k/2|0,littleEndian),i=0,j=0;i<k;i+=2){if(b=parseInt(str.substring(i,i+2),16),!noAssert&&(!isFinite(b)||b<0||b>255))throw TypeError("Illegal str: Contains non-hex characters");bb.view[j++]=b}return bb.limit=j,bb};var utfx=function(){var utfx={MAX_CODEPOINT:1114111,encodeUTF8:function(src,dst){var cp=null;for("number"==typeof src&&(cp=src,src=function(){return null});null!==cp||null!==(cp=src());)cp<128?dst(127&cp):cp<2048?(dst(cp>>6&31|192),dst(63&cp|128)):cp<65536?(dst(cp>>12&15|224),dst(cp>>6&63|128),dst(63&cp|128)):(dst(cp>>18&7|240),dst(cp>>12&63|128),dst(cp>>6&63|128),dst(63&cp|128)),cp=null},decodeUTF8:function(src,dst){for(var a,b,c,d,fail=function(b){b=b.slice(0,b.indexOf(null));var err=Error(b.toString());throw err.name="TruncatedError",err.bytes=b,err};null!==(a=src());)if(0==(128&a))dst(a);else if(192==(224&a))null===(b=src())&&fail([a,b]),dst((31&a)<<6|63&b);else if(224==(240&a))(null===(b=src())||null===(c=src()))&&fail([a,b,c]),dst((15&a)<<12|(63&b)<<6|63&c);else{if(240!=(248&a))throw RangeError("Illegal starting byte: "+a);(null===(b=src())||null===(c=src())||null===(d=src()))&&fail([a,b,c,d]),dst((7&a)<<18|(63&b)<<12|(63&c)<<6|63&d)}},UTF16toUTF8:function(src,dst){for(var c1,c2=null;null!==(c1=null!==c2?c2:src());)c1>=55296&&c1<=57343&&null!==(c2=src())&&c2>=56320&&c2<=57343?(dst(1024*(c1-55296)+c2-56320+65536),c2=null):dst(c1);null!==c2&&dst(c2)},UTF8toUTF16:function(src,dst){var cp=null;for("number"==typeof src&&(cp=src,src=function(){return null});null!==cp||null!==(cp=src());)cp<=65535?dst(cp):(dst(55296+((cp-=65536)>>10)),dst(cp%1024+56320)),cp=null},encodeUTF16toUTF8:function(src,dst){utfx.UTF16toUTF8(src,function(cp){utfx.encodeUTF8(cp,dst)})},decodeUTF8toUTF16:function(src,dst){utfx.decodeUTF8(src,function(cp){utfx.UTF8toUTF16(cp,dst)})},calculateCodePoint:function(cp){return cp<128?1:cp<2048?2:cp<65536?3:4},calculateUTF8:function(src){for(var cp,l=0;null!==(cp=src());)l+=cp<128?1:cp<2048?2:cp<65536?3:4;return l},calculateUTF16asUTF8:function(src){var n=0,l=0;return utfx.UTF16toUTF8(src,function(cp){++n,l+=cp<128?1:cp<2048?2:cp<65536?3:4}),[n,l]}};return utfx}();return ByteBufferPrototype.toUTF8=function(begin,end){if(void 0===begin&&(begin=this.offset),void 0===end&&(end=this.limit),!this.noAssert){if("number"!=typeof begin||begin%1!=0)throw TypeError("Illegal begin: Not an integer");if(begin>>>=0,"number"!=typeof end||end%1!=0)throw TypeError("Illegal end: Not an integer");if(end>>>=0,begin<0||begin>end||end>this.buffer.byteLength)throw RangeError("Illegal range: 0 <= "+begin+" <= "+end+" <= "+this.buffer.byteLength)}var sd;try{utfx.decodeUTF8toUTF16(function(){return begin<end?this.view[begin++]:null}.bind(this),sd=stringDestination())}catch(e){if(begin!==end)throw RangeError("Illegal range: Truncated data, "+begin+" != "+end)}return sd()},ByteBuffer.fromUTF8=function(str,littleEndian,noAssert){if(!noAssert&&"string"!=typeof str)throw TypeError("Illegal str: Not a string");var bb=new ByteBuffer(utfx.calculateUTF16asUTF8(stringSource(str),!0)[1],littleEndian,noAssert),i=0;return utfx.encodeUTF16toUTF8(stringSource(str),function(b){bb.view[i++]=b}),bb.limit=i,bb},ByteBuffer},"function"==typeof _dereq_&&"object"==typeof module&&module&&module.exports?module.exports=function(){var Long;try{Long=_dereq_("long")}catch(e){}return factory(Long)}():(global.dcodeIO=global.dcodeIO||{}).ByteBuffer=factory(global.dcodeIO.Long)},{long:3}],3:[function(_dereq_,module,exports){var global,factory;global=this,factory=function(){"use strict";function Long(low,high,unsigned){this.low=0|low,this.high=0|high,this.unsigned=!!unsigned}function isLong(obj){return!0===(obj&&obj.__isLong__)}function fromInt(value,unsigned){var obj,cachedObj,cache;return unsigned?(cache=0<=(value>>>=0)&&value<256)&&(cachedObj=UINT_CACHE[value])?cachedObj:(obj=fromBits(value,(0|value)<0?-1:0,!0),cache&&(UINT_CACHE[value]=obj),obj):(cache=-128<=(value|=0)&&value<128)&&(cachedObj=INT_CACHE[value])?cachedObj:(obj=fromBits(value,value<0?-1:0,!1),cache&&(INT_CACHE[value]=obj),obj)}function fromNumber(value,unsigned){if(isNaN(value)||!isFinite(value))return unsigned?UZERO:ZERO;if(unsigned){if(value<0)return UZERO;if(value>=TWO_PWR_64_DBL)return MAX_UNSIGNED_VALUE}else{if(value<=-TWO_PWR_63_DBL)return MIN_VALUE;if(value+1>=TWO_PWR_63_DBL)return MAX_VALUE}return value<0?fromNumber(-value,unsigned).neg():fromBits(value%TWO_PWR_32_DBL|0,value/TWO_PWR_32_DBL|0,unsigned)}function fromBits(lowBits,highBits,unsigned){return new Long(lowBits,highBits,unsigned)}function fromString(str,unsigned,radix){if(0===str.length)throw Error("empty string");if("NaN"===str||"Infinity"===str||"+Infinity"===str||"-Infinity"===str)return ZERO;if("number"==typeof unsigned?(radix=unsigned,unsigned=!1):unsigned=!!unsigned,(radix=radix||10)<2||36<radix)throw RangeError("radix");var p;if((p=str.indexOf("-"))>0)throw Error("interior hyphen");if(0===p)return fromString(str.substring(1),unsigned,radix).neg();for(var radixToPower=fromNumber(pow_dbl(radix,8)),result=ZERO,i=0;i<str.length;i+=8){var size=Math.min(8,str.length-i),value=parseInt(str.substring(i,i+size),radix);if(size<8){var power=fromNumber(pow_dbl(radix,size));result=result.mul(power).add(fromNumber(value))}else result=(result=result.mul(radixToPower)).add(fromNumber(value))}return result.unsigned=unsigned,result}function fromValue(val){return val instanceof Long?val:"number"==typeof val?fromNumber(val):"string"==typeof val?fromString(val):fromBits(val.low,val.high,val.unsigned)}Long.prototype.__isLong__,Object.defineProperty(Long.prototype,"__isLong__",{value:!0,enumerable:!1,configurable:!1}),Long.isLong=isLong;var INT_CACHE={},UINT_CACHE={};Long.fromInt=fromInt,Long.fromNumber=fromNumber,Long.fromBits=fromBits;var pow_dbl=Math.pow;Long.fromString=fromString,Long.fromValue=fromValue;var TWO_PWR_32_DBL=4294967296,TWO_PWR_64_DBL=TWO_PWR_32_DBL*TWO_PWR_32_DBL,TWO_PWR_63_DBL=TWO_PWR_64_DBL/2,TWO_PWR_24=fromInt(1<<24),ZERO=fromInt(0);Long.ZERO=ZERO;var UZERO=fromInt(0,!0);Long.UZERO=UZERO;var ONE=fromInt(1);Long.ONE=ONE;var UONE=fromInt(1,!0);Long.UONE=UONE;var NEG_ONE=fromInt(-1);Long.NEG_ONE=NEG_ONE;var MAX_VALUE=fromBits(-1,2147483647,!1);Long.MAX_VALUE=MAX_VALUE;var MAX_UNSIGNED_VALUE=fromBits(-1,-1,!0);Long.MAX_UNSIGNED_VALUE=MAX_UNSIGNED_VALUE;var MIN_VALUE=fromBits(0,-2147483648,!1);Long.MIN_VALUE=MIN_VALUE;var LongPrototype=Long.prototype;return LongPrototype.toInt=function(){return this.unsigned?this.low>>>0:this.low},LongPrototype.toNumber=function(){return this.unsigned?(this.high>>>0)*TWO_PWR_32_DBL+(this.low>>>0):this.high*TWO_PWR_32_DBL+(this.low>>>0)},LongPrototype.toString=function(radix){if((radix=radix||10)<2||36<radix)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative()){if(this.eq(MIN_VALUE)){var radixLong=fromNumber(radix),div=this.div(radixLong),rem1=div.mul(radixLong).sub(this);return div.toString(radix)+rem1.toInt().toString(radix)}return"-"+this.neg().toString(radix)}for(var radixToPower=fromNumber(pow_dbl(radix,6),this.unsigned),rem=this,result="";;){var remDiv=rem.div(radixToPower),digits=(rem.sub(remDiv.mul(radixToPower)).toInt()>>>0).toString(radix);if((rem=remDiv).isZero())return digits+result;for(;digits.length<6;)digits="0"+digits;result=""+digits+result}},LongPrototype.getHighBits=function(){return this.high},LongPrototype.getHighBitsUnsigned=function(){return this.high>>>0},LongPrototype.getLowBits=function(){return this.low},LongPrototype.getLowBitsUnsigned=function(){return this.low>>>0},LongPrototype.getNumBitsAbs=function(){if(this.isNegative())return this.eq(MIN_VALUE)?64:this.neg().getNumBitsAbs();for(var val=0!=this.high?this.high:this.low,bit=31;bit>0&&0==(val&1<<bit);bit--);return 0!=this.high?bit+33:bit+1},LongPrototype.isZero=function(){return 0===this.high&&0===this.low},LongPrototype.isNegative=function(){return!this.unsigned&&this.high<0},LongPrototype.isPositive=function(){return this.unsigned||this.high>=0},LongPrototype.isOdd=function(){return 1==(1&this.low)},LongPrototype.isEven=function(){return 0==(1&this.low)},LongPrototype.equals=function(other){return isLong(other)||(other=fromValue(other)),(this.unsigned===other.unsigned||this.high>>>31!=1||other.high>>>31!=1)&&this.high===other.high&&this.low===other.low},LongPrototype.eq=LongPrototype.equals,LongPrototype.notEquals=function(other){return!this.eq(other)},LongPrototype.neq=LongPrototype.notEquals,LongPrototype.lessThan=function(other){return this.comp(other)<0},LongPrototype.lt=LongPrototype.lessThan,LongPrototype.lessThanOrEqual=function(other){return this.comp(other)<=0},LongPrototype.lte=LongPrototype.lessThanOrEqual,LongPrototype.greaterThan=function(other){return this.comp(other)>0},LongPrototype.gt=LongPrototype.greaterThan,LongPrototype.greaterThanOrEqual=function(other){return this.comp(other)>=0},LongPrototype.gte=LongPrototype.greaterThanOrEqual,LongPrototype.compare=function(other){if(isLong(other)||(other=fromValue(other)),this.eq(other))return 0;var thisNeg=this.isNegative(),otherNeg=other.isNegative();return thisNeg&&!otherNeg?-1:!thisNeg&&otherNeg?1:this.unsigned?other.high>>>0>this.high>>>0||other.high===this.high&&other.low>>>0>this.low>>>0?-1:1:this.sub(other).isNegative()?-1:1},LongPrototype.comp=LongPrototype.compare,LongPrototype.negate=function(){return!this.unsigned&&this.eq(MIN_VALUE)?MIN_VALUE:this.not().add(ONE)},LongPrototype.neg=LongPrototype.negate,LongPrototype.add=function(addend){isLong(addend)||(addend=fromValue(addend));var a48=this.high>>>16,a32=65535&this.high,a16=this.low>>>16,a00=65535&this.low,b48=addend.high>>>16,b32=65535&addend.high,b16=addend.low>>>16,c48=0,c32=0,c16=0,c00=0;return c16+=(c00+=a00+(65535&addend.low))>>>16,c32+=(c16+=a16+b16)>>>16,c48+=(c32+=a32+b32)>>>16,c48+=a48+b48,fromBits((c16&=65535)<<16|(c00&=65535),(c48&=65535)<<16|(c32&=65535),this.unsigned)},LongPrototype.subtract=function(subtrahend){return isLong(subtrahend)||(subtrahend=fromValue(subtrahend)),this.add(subtrahend.neg())},LongPrototype.sub=LongPrototype.subtract,LongPrototype.multiply=function(multiplier){if(this.isZero())return ZERO;if(isLong(multiplier)||(multiplier=fromValue(multiplier)),multiplier.isZero())return ZERO;if(this.eq(MIN_VALUE))return multiplier.isOdd()?MIN_VALUE:ZERO;if(multiplier.eq(MIN_VALUE))return this.isOdd()?MIN_VALUE:ZERO;if(this.isNegative())return multiplier.isNegative()?this.neg().mul(multiplier.neg()):this.neg().mul(multiplier).neg();if(multiplier.isNegative())return this.mul(multiplier.neg()).neg();if(this.lt(TWO_PWR_24)&&multiplier.lt(TWO_PWR_24))return fromNumber(this.toNumber()*multiplier.toNumber(),this.unsigned);var a48=this.high>>>16,a32=65535&this.high,a16=this.low>>>16,a00=65535&this.low,b48=multiplier.high>>>16,b32=65535&multiplier.high,b16=multiplier.low>>>16,b00=65535&multiplier.low,c48=0,c32=0,c16=0,c00=0;return c16+=(c00+=a00*b00)>>>16,c32+=(c16+=a16*b00)>>>16,c16&=65535,c32+=(c16+=a00*b16)>>>16,c48+=(c32+=a32*b00)>>>16,c32&=65535,c48+=(c32+=a16*b16)>>>16,c32&=65535,c48+=(c32+=a00*b32)>>>16,c48+=a48*b00+a32*b16+a16*b32+a00*b48,fromBits((c16&=65535)<<16|(c00&=65535),(c48&=65535)<<16|(c32&=65535),this.unsigned)},LongPrototype.mul=LongPrototype.multiply,LongPrototype.divide=function(divisor){if(isLong(divisor)||(divisor=fromValue(divisor)),divisor.isZero())throw Error("division by zero");if(this.isZero())return this.unsigned?UZERO:ZERO;var approx,rem,res;if(this.unsigned){if(divisor.unsigned||(divisor=divisor.toUnsigned()),divisor.gt(this))return UZERO;if(divisor.gt(this.shru(1)))return UONE;res=UZERO}else{if(this.eq(MIN_VALUE))return divisor.eq(ONE)||divisor.eq(NEG_ONE)?MIN_VALUE:divisor.eq(MIN_VALUE)?ONE:(approx=this.shr(1).div(divisor).shl(1)).eq(ZERO)?divisor.isNegative()?ONE:NEG_ONE:(rem=this.sub(divisor.mul(approx)),res=approx.add(rem.div(divisor)));if(divisor.eq(MIN_VALUE))return this.unsigned?UZERO:ZERO;if(this.isNegative())return divisor.isNegative()?this.neg().div(divisor.neg()):this.neg().div(divisor).neg();if(divisor.isNegative())return this.div(divisor.neg()).neg();res=ZERO}for(rem=this;rem.gte(divisor);){approx=Math.max(1,Math.floor(rem.toNumber()/divisor.toNumber()));for(var log2=Math.ceil(Math.log(approx)/Math.LN2),delta=log2<=48?1:pow_dbl(2,log2-48),approxRes=fromNumber(approx),approxRem=approxRes.mul(divisor);approxRem.isNegative()||approxRem.gt(rem);)approxRem=(approxRes=fromNumber(approx-=delta,this.unsigned)).mul(divisor);approxRes.isZero()&&(approxRes=ONE),res=res.add(approxRes),rem=rem.sub(approxRem)}return res},LongPrototype.div=LongPrototype.divide,LongPrototype.modulo=function(divisor){return isLong(divisor)||(divisor=fromValue(divisor)),this.sub(this.div(divisor).mul(divisor))},LongPrototype.mod=LongPrototype.modulo,LongPrototype.not=function(){return fromBits(~this.low,~this.high,this.unsigned)},LongPrototype.and=function(other){return isLong(other)||(other=fromValue(other)),fromBits(this.low&other.low,this.high&other.high,this.unsigned)},LongPrototype.or=function(other){return isLong(other)||(other=fromValue(other)),fromBits(this.low|other.low,this.high|other.high,this.unsigned)},LongPrototype.xor=function(other){return isLong(other)||(other=fromValue(other)),fromBits(this.low^other.low,this.high^other.high,this.unsigned)},LongPrototype.shiftLeft=function(numBits){return isLong(numBits)&&(numBits=numBits.toInt()),0==(numBits&=63)?this:numBits<32?fromBits(this.low<<numBits,this.high<<numBits|this.low>>>32-numBits,this.unsigned):fromBits(0,this.low<<numBits-32,this.unsigned)},LongPrototype.shl=LongPrototype.shiftLeft,LongPrototype.shiftRight=function(numBits){return isLong(numBits)&&(numBits=numBits.toInt()),0==(numBits&=63)?this:numBits<32?fromBits(this.low>>>numBits|this.high<<32-numBits,this.high>>numBits,this.unsigned):fromBits(this.high>>numBits-32,this.high>=0?0:-1,this.unsigned)},LongPrototype.shr=LongPrototype.shiftRight,LongPrototype.shiftRightUnsigned=function(numBits){if(isLong(numBits)&&(numBits=numBits.toInt()),0==(numBits&=63))return this;var high=this.high;return numBits<32?fromBits(this.low>>>numBits|high<<32-numBits,high>>>numBits,this.unsigned):fromBits(32===numBits?high:high>>>numBits-32,0,this.unsigned)},LongPrototype.shru=LongPrototype.shiftRightUnsigned,LongPrototype.toSigned=function(){return this.unsigned?fromBits(this.low,this.high,!1):this},LongPrototype.toUnsigned=function(){return this.unsigned?this:fromBits(this.low,this.high,!0)},LongPrototype.toBytes=function(le){return le?this.toBytesLE():this.toBytesBE()},LongPrototype.toBytesLE=function(){var hi=this.high,lo=this.low;return[255&lo,lo>>>8&255,lo>>>16&255,lo>>>24&255,255&hi,hi>>>8&255,hi>>>16&255,hi>>>24&255]},LongPrototype.toBytesBE=function(){var hi=this.high,lo=this.low;return[hi>>>24&255,hi>>>16&255,hi>>>8&255,255&hi,lo>>>24&255,lo>>>16&255,lo>>>8&255,255&lo]},Long},"function"==typeof _dereq_&&"object"==typeof module&&module&&module.exports?module.exports=factory():(global.dcodeIO=global.dcodeIO||{}).Long=factory()},{}],4:[function(_dereq_,module,exports){function defaultSetTimout(){throw new Error("setTimeout has not been defined")}function defaultClearTimeout(){throw new Error("clearTimeout has not been defined")}function runTimeout(fun){if(cachedSetTimeout===setTimeout)return setTimeout(fun,0);if((cachedSetTimeout===defaultSetTimout||!cachedSetTimeout)&&setTimeout)return cachedSetTimeout=setTimeout,setTimeout(fun,0);try{return cachedSetTimeout(fun,0)}catch(e){try{return cachedSetTimeout.call(null,fun,0)}catch(e){return cachedSetTimeout.call(this,fun,0)}}}function cleanUpNextTick(){draining&&currentQueue&&(draining=!1,currentQueue.length?queue=currentQueue.concat(queue):queueIndex=-1,queue.length&&drainQueue())}function drainQueue(){if(!draining){var timeout=runTimeout(cleanUpNextTick);draining=!0;for(var len=queue.length;len;){for(currentQueue=queue,queue=[];++queueIndex<len;)currentQueue&&currentQueue[queueIndex].run();queueIndex=-1,len=queue.length}currentQueue=null,draining=!1,function(marker){if(cachedClearTimeout===clearTimeout)return clearTimeout(marker);if((cachedClearTimeout===defaultClearTimeout||!cachedClearTimeout)&&clearTimeout)return cachedClearTimeout=clearTimeout,clearTimeout(marker);try{cachedClearTimeout(marker)}catch(e){try{return cachedClearTimeout.call(null,marker)}catch(e){return cachedClearTimeout.call(this,marker)}}}(timeout)}}function Item(fun,array){this.fun=fun,this.array=array}function noop(){}var cachedSetTimeout,cachedClearTimeout,process=module.exports={};!function(){try{cachedSetTimeout="function"==typeof setTimeout?setTimeout:defaultSetTimout}catch(e){cachedSetTimeout=defaultSetTimout}try{cachedClearTimeout="function"==typeof clearTimeout?clearTimeout:defaultClearTimeout}catch(e){cachedClearTimeout=defaultClearTimeout}}();var currentQueue,queue=[],draining=!1,queueIndex=-1;process.nextTick=function(fun){var args=new Array(arguments.length-1);if(arguments.length>1)for(var i=1;i<arguments.length;i++)args[i-1]=arguments[i];queue.push(new Item(fun,args)),1!==queue.length||draining||runTimeout(drainQueue)},Item.prototype.run=function(){this.fun.apply(null,this.array)},process.title="browser",process.browser=!0,process.env={},process.argv=[],process.version="",process.versions={},process.on=noop,process.addListener=noop,process.once=noop,process.off=noop,process.removeListener=noop,process.removeAllListeners=noop,process.emit=noop,process.prependListener=noop,process.prependOnceListener=noop,process.listeners=function(name){return[]},process.binding=function(name){throw new Error("process.binding is not supported")},process.cwd=function(){return"/"},process.chdir=function(dir){throw new Error("process.chdir is not supported")},process.umask=function(){return 0}},{}],5:[function(_dereq_,module,exports){(function(process){var global,factory;global=this,factory=function(ByteBuffer,isCommonJS){"use strict";var Util,ProtoBuf={};return ProtoBuf.ByteBuffer=ByteBuffer,ProtoBuf.Long=ByteBuffer.Long||null,ProtoBuf.VERSION="5.0.2",ProtoBuf.WIRE_TYPES={},ProtoBuf.WIRE_TYPES.VARINT=0,ProtoBuf.WIRE_TYPES.BITS64=1,ProtoBuf.WIRE_TYPES.LDELIM=2,ProtoBuf.WIRE_TYPES.STARTGROUP=3,ProtoBuf.WIRE_TYPES.ENDGROUP=4,ProtoBuf.WIRE_TYPES.BITS32=5,ProtoBuf.PACKABLE_WIRE_TYPES=[ProtoBuf.WIRE_TYPES.VARINT,ProtoBuf.WIRE_TYPES.BITS64,ProtoBuf.WIRE_TYPES.BITS32],ProtoBuf.TYPES={int32:{name:"int32",wireType:ProtoBuf.WIRE_TYPES.VARINT,defaultValue:0},uint32:{name:"uint32",wireType:ProtoBuf.WIRE_TYPES.VARINT,defaultValue:0},sint32:{name:"sint32",wireType:ProtoBuf.WIRE_TYPES.VARINT,defaultValue:0},int64:{name:"int64",wireType:ProtoBuf.WIRE_TYPES.VARINT,defaultValue:ProtoBuf.Long?ProtoBuf.Long.ZERO:void 0},uint64:{name:"uint64",wireType:ProtoBuf.WIRE_TYPES.VARINT,defaultValue:ProtoBuf.Long?ProtoBuf.Long.UZERO:void 0},sint64:{name:"sint64",wireType:ProtoBuf.WIRE_TYPES.VARINT,defaultValue:ProtoBuf.Long?ProtoBuf.Long.ZERO:void 0},bool:{name:"bool",wireType:ProtoBuf.WIRE_TYPES.VARINT,defaultValue:!1},double:{name:"double",wireType:ProtoBuf.WIRE_TYPES.BITS64,defaultValue:0},string:{name:"string",wireType:ProtoBuf.WIRE_TYPES.LDELIM,defaultValue:""},bytes:{name:"bytes",wireType:ProtoBuf.WIRE_TYPES.LDELIM,defaultValue:null},fixed32:{name:"fixed32",wireType:ProtoBuf.WIRE_TYPES.BITS32,defaultValue:0},sfixed32:{name:"sfixed32",wireType:ProtoBuf.WIRE_TYPES.BITS32,defaultValue:0},fixed64:{name:"fixed64",wireType:ProtoBuf.WIRE_TYPES.BITS64,defaultValue:ProtoBuf.Long?ProtoBuf.Long.UZERO:void 0},sfixed64:{name:"sfixed64",wireType:ProtoBuf.WIRE_TYPES.BITS64,defaultValue:ProtoBuf.Long?ProtoBuf.Long.ZERO:void 0},float:{name:"float",wireType:ProtoBuf.WIRE_TYPES.BITS32,defaultValue:0},enum:{name:"enum",wireType:ProtoBuf.WIRE_TYPES.VARINT,defaultValue:0},message:{name:"message",wireType:ProtoBuf.WIRE_TYPES.LDELIM,defaultValue:null},group:{name:"group",wireType:ProtoBuf.WIRE_TYPES.STARTGROUP,defaultValue:null}},ProtoBuf.MAP_KEY_TYPES=[ProtoBuf.TYPES.int32,ProtoBuf.TYPES.sint32,ProtoBuf.TYPES.sfixed32,ProtoBuf.TYPES.uint32,ProtoBuf.TYPES.fixed32,ProtoBuf.TYPES.int64,ProtoBuf.TYPES.sint64,ProtoBuf.TYPES.sfixed64,ProtoBuf.TYPES.uint64,ProtoBuf.TYPES.fixed64,ProtoBuf.TYPES.bool,ProtoBuf.TYPES.string,ProtoBuf.TYPES.bytes],ProtoBuf.ID_MIN=1,ProtoBuf.ID_MAX=536870911,ProtoBuf.convertFieldsToCamelCase=!1,ProtoBuf.populateAccessors=!0,ProtoBuf.populateDefaults=!0,ProtoBuf.Util=((Util={}).IS_NODE=!("object"!=typeof process||process+""!="[object process]"||process.browser),Util.XHR=function(){for(var XMLHttpFactories=[function(){return new XMLHttpRequest},function(){return new ActiveXObject("Msxml2.XMLHTTP")},function(){return new ActiveXObject("Msxml3.XMLHTTP")},function(){return new ActiveXObject("Microsoft.XMLHTTP")}],xhr=null,i=0;i<XMLHttpFactories.length;i++){try{xhr=XMLHttpFactories[i]()}catch(e){continue}break}if(!xhr)throw Error("XMLHttpRequest is not supported");return xhr},Util.fetch=function(path,callback){if(callback&&"function"!=typeof callback&&(callback=null),Util.IS_NODE){var fs=_dereq_("fs");if(callback)fs.readFile(path,function(err,data){callback(err?null:""+data)});else try{return fs.readFileSync(path)}catch(e){return null}}else{var xhr=Util.XHR();if(xhr.open("GET",path,!!callback),xhr.setRequestHeader("Accept","text/plain"),"function"==typeof xhr.overrideMimeType&&xhr.overrideMimeType("text/plain"),!callback)return xhr.send(null),200==xhr.status||0==xhr.status&&"string"==typeof xhr.responseText?xhr.responseText:null;if(xhr.onreadystatechange=function(){4==xhr.readyState&&callback(200==xhr.status||0==xhr.status&&"string"==typeof xhr.responseText?xhr.responseText:null)},4==xhr.readyState)return;xhr.send(null)}},Util.toCamelCase=function(str){return str.replace(/_([a-zA-Z])/g,function($0,$1){return $1.toUpperCase()})},Util),ProtoBuf.Lang={DELIM:/[\s\{\}=;:\[\],'"\(\)<>]/g,RULE:/^(?:required|optional|repeated|map)$/,TYPE:/^(?:double|float|int32|uint32|sint32|int64|uint64|sint64|fixed32|sfixed32|fixed64|sfixed64|bool|string|bytes)$/,NAME:/^[a-zA-Z_][a-zA-Z_0-9]*$/,TYPEDEF:/^[a-zA-Z][a-zA-Z_0-9]*$/,TYPEREF:/^(?:\.?[a-zA-Z_][a-zA-Z_0-9]*)+$/,FQTYPEREF:/^(?:\.[a-zA-Z][a-zA-Z_0-9]*)+$/,NUMBER:/^-?(?:[1-9][0-9]*|0|0[xX][0-9a-fA-F]+|0[0-7]+|([0-9]*(\.[0-9]*)?([Ee][+-]?[0-9]+)?)|inf|nan)$/,NUMBER_DEC:/^(?:[1-9][0-9]*|0)$/,NUMBER_HEX:/^0[xX][0-9a-fA-F]+$/,NUMBER_OCT:/^0[0-7]+$/,NUMBER_FLT:/^([0-9]*(\.[0-9]*)?([Ee][+-]?[0-9]+)?|inf|nan)$/,BOOL:/^(?:true|false)$/i,ID:/^(?:[1-9][0-9]*|0|0[xX][0-9a-fA-F]+|0[0-7]+)$/,NEGID:/^\-?(?:[1-9][0-9]*|0|0[xX][0-9a-fA-F]+|0[0-7]+)$/,WHITESPACE:/\s/,STRING:/(?:"([^"\\]*(?:\\.[^"\\]*)*)")|(?:'([^'\\]*(?:\\.[^'\\]*)*)')/g,STRING_DQ:/(?:"([^"\\]*(?:\\.[^"\\]*)*)")/g,STRING_SQ:/(?:'([^'\\]*(?:\\.[^'\\]*)*)')/g},ProtoBuf.DotProto=function(ProtoBuf,Lang){function mkId(value,mayBeNegative){var id=-1,sign=1;if("-"==value.charAt(0)&&(sign=-1,value=value.substring(1)),Lang.NUMBER_DEC.test(value))id=parseInt(value);else if(Lang.NUMBER_HEX.test(value))id=parseInt(value.substring(2),16);else{if(!Lang.NUMBER_OCT.test(value))throw Error("illegal id value: "+(sign<0?"-":"")+value);id=parseInt(value.substring(1),8)}if(id=sign*id|0,!mayBeNegative&&id<0)throw Error("illegal id value: "+(sign<0?"-":"")+value);return id}function mkNumber(val){var sign=1;if("-"==val.charAt(0)&&(sign=-1,val=val.substring(1)),Lang.NUMBER_DEC.test(val))return sign*parseInt(val,10);if(Lang.NUMBER_HEX.test(val))return sign*parseInt(val.substring(2),16);if(Lang.NUMBER_OCT.test(val))return sign*parseInt(val.substring(1),8);if("inf"===val)return sign*(1/0);if("nan"===val)return NaN;if(Lang.NUMBER_FLT.test(val))return sign*parseFloat(val);throw Error("illegal number value: "+(sign<0?"-":"")+val)}function setOption(options,name,value){void 0===options[name]?options[name]=value:(Array.isArray(options[name])||(options[name]=[options[name]]),options[name].push(value))}var DotProto={},Tokenizer=function(proto){this.source=proto+"",this.index=0,this.line=1,this.stack=[],this._stringOpen=null},TokenizerPrototype=Tokenizer.prototype;TokenizerPrototype._readString=function(){var re='"'===this._stringOpen?Lang.STRING_DQ:Lang.STRING_SQ;re.lastIndex=this.index-1;var match=re.exec(this.source);if(!match)throw Error("unterminated string");return this.index=re.lastIndex,this.stack.push(this._stringOpen),this._stringOpen=null,match[1]},TokenizerPrototype.next=function(){if(this.stack.length>0)return this.stack.shift();if(this.index>=this.source.length)return null;if(null!==this._stringOpen)return this._readString();var repeat,prev,next;do{for(repeat=!1;Lang.WHITESPACE.test(next=this.source.charAt(this.index));)if("\n"===next&&++this.line,++this.index===this.source.length)return null;if("/"===this.source.charAt(this.index))if(++this.index,"/"===this.source.charAt(this.index)){for(;"\n"!==this.source.charAt(++this.index);)if(this.index==this.source.length)return null;++this.index,++this.line,repeat=!0}else{if("*"!==(next=this.source.charAt(this.index)))return"/";do{if("\n"===next&&++this.line,++this.index===this.source.length)return null;prev=next,next=this.source.charAt(this.index)}while("*"!==prev||"/"!==next);++this.index,repeat=!0}}while(repeat);if(this.index===this.source.length)return null;var end=this.index;if(Lang.DELIM.lastIndex=0,!Lang.DELIM.test(this.source.charAt(end++)))for(;end<this.source.length&&!Lang.DELIM.test(this.source.charAt(end));)++end;var token=this.source.substring(this.index,this.index=end);return'"'!==token&&"'"!==token||(this._stringOpen=token),token},TokenizerPrototype.peek=function(){if(0===this.stack.length){var token=this.next();if(null===token)return null;this.stack.push(token)}return this.stack[0]},TokenizerPrototype.skip=function(expected){var actual=this.next();if(actual!==expected)throw Error("illegal '"+actual+"', '"+expected+"' expected")},TokenizerPrototype.omit=function(expected){return this.peek()===expected&&(this.next(),!0)},TokenizerPrototype.toString=function(){return"Tokenizer ("+this.index+"/"+this.source.length+" at line "+this.line+")"},DotProto.Tokenizer=Tokenizer;var Parser=function(source){this.tn=new Tokenizer(source),this.proto3=!1},ParserPrototype=Parser.prototype;return ParserPrototype.parse=function(){var token,weak,topLevel={name:"[ROOT]",package:null,messages:[],enums:[],imports:[],options:{},services:[]},head=!0;try{for(;token=this.tn.next();)switch(token){case"package":if(!head||null!==topLevel.package)throw Error("unexpected 'package'");if(token=this.tn.next(),!Lang.TYPEREF.test(token))throw Error("illegal package name: "+token);this.tn.skip(";"),topLevel.package=token;break;case"import":if(!head)throw Error("unexpected 'import'");("public"===(token=this.tn.peek())||(weak="weak"===token))&&this.tn.next(),token=this._readString(),this.tn.skip(";"),weak||topLevel.imports.push(token);break;case"syntax":if(!head)throw Error("unexpected 'syntax'");this.tn.skip("="),"proto3"===(topLevel.syntax=this._readString())&&(this.proto3=!0),this.tn.skip(";");break;case"message":this._parseMessage(topLevel,null),head=!1;break;case"enum":this._parseEnum(topLevel),head=!1;break;case"option":this._parseOption(topLevel);break;case"service":this._parseService(topLevel);break;case"extend":this._parseExtend(topLevel);break;default:throw Error("unexpected '"+token+"'")}}catch(e){throw e.message="Parse error at line "+this.tn.line+": "+e.message,e}return delete topLevel.name,topLevel},Parser.parse=function(source){return new Parser(source).parse()},ParserPrototype._readString=function(){var token,delim,value="";do{if("'"!==(delim=this.tn.next())&&'"'!==delim)throw Error("illegal string delimiter: "+delim);value+=this.tn.next(),this.tn.skip(delim),token=this.tn.peek()}while('"'===token||'"'===token);return value},ParserPrototype._readValue=function(mayBeTypeRef){var token=this.tn.peek();if('"'===token||"'"===token)return this._readString();if(this.tn.next(),Lang.NUMBER.test(token))return mkNumber(token);if(Lang.BOOL.test(token))return"true"===token.toLowerCase();if(mayBeTypeRef&&Lang.TYPEREF.test(token))return token;throw Error("illegal value: "+token)},ParserPrototype._parseOption=function(parent,isList){var token=this.tn.next(),custom=!1;if("("===token&&(custom=!0,token=this.tn.next()),!Lang.TYPEREF.test(token))throw Error("illegal option name: "+token);var name=token;custom&&(this.tn.skip(")"),name="("+name+")",token=this.tn.peek(),Lang.FQTYPEREF.test(token)&&(name+=token,this.tn.next())),this.tn.skip("="),this._parseOptionValue(parent,name),isList||this.tn.skip(";")},ParserPrototype._parseOptionValue=function(parent,name){var token=this.tn.peek();if("{"!==token)setOption(parent.options,name,this._readValue(!0));else for(this.tn.skip("{");"}"!==(token=this.tn.next());){if(!Lang.NAME.test(token))throw Error("illegal option name: "+name+"."+token);this.tn.omit(":")?setOption(parent.options,name+"."+token,this._readValue(!0)):this._parseOptionValue(parent,name+"."+token)}},ParserPrototype._parseService=function(parent){var token=this.tn.next();if(!Lang.NAME.test(token))throw Error("illegal service name at line "+this.tn.line+": "+token);var svc={name:token,rpc:{},options:{}};for(this.tn.skip("{");"}"!==(token=this.tn.next());)if("option"===token)this._parseOption(svc);else{if("rpc"!==token)throw Error("illegal service token: "+token);this._parseServiceRPC(svc)}this.tn.omit(";"),parent.services.push(svc)},ParserPrototype._parseServiceRPC=function(svc){var token=this.tn.next();if(!Lang.NAME.test(token))throw Error("illegal rpc service method name: "+token);var name=token,method={request:null,response:null,request_stream:!1,response_stream:!1,options:{}};if(this.tn.skip("("),"stream"===(token=this.tn.next()).toLowerCase()&&(method.request_stream=!0,token=this.tn.next()),!Lang.TYPEREF.test(token))throw Error("illegal rpc service request type: "+token);if(method.request=token,this.tn.skip(")"),"returns"!==(token=this.tn.next()).toLowerCase())throw Error("illegal rpc service request type delimiter: "+token);if(this.tn.skip("("),"stream"===(token=this.tn.next()).toLowerCase()&&(method.response_stream=!0,token=this.tn.next()),method.response=token,this.tn.skip(")"),"{"===(token=this.tn.peek())){for(this.tn.next();"}"!==(token=this.tn.next());){if("option"!==token)throw Error("illegal rpc service token: "+token);this._parseOption(method)}this.tn.omit(";")}else this.tn.skip(";");void 0===svc.rpc&&(svc.rpc={}),svc.rpc[name]=method},ParserPrototype._parseMessage=function(parent,fld){var isGroup=!!fld,token=this.tn.next(),msg={name:"",fields:[],enums:[],messages:[],options:{},services:[],oneofs:{}};if(!Lang.NAME.test(token))throw Error("illegal "+(isGroup?"group":"message")+" name: "+token);for(msg.name=token,isGroup&&(this.tn.skip("="),fld.id=mkId(this.tn.next()),msg.isGroup=!0),"["===(token=this.tn.peek())&&fld&&this._parseFieldOptions(fld),this.tn.skip("{");"}"!==(token=this.tn.next());)if(Lang.RULE.test(token))this._parseMessageField(msg,token);else if("oneof"===token)this._parseMessageOneOf(msg);else if("enum"===token)this._parseEnum(msg);else if("message"===token)this._parseMessage(msg);else if("option"===token)this._parseOption(msg);else if("service"===token)this._parseService(msg);else if("extensions"===token)msg.hasOwnProperty("extensions")?msg.extensions=msg.extensions.concat(this._parseExtensionRanges()):msg.extensions=this._parseExtensionRanges();else if("reserved"===token)this._parseIgnored();else if("extend"===token)this._parseExtend(msg);else{if(!Lang.TYPEREF.test(token))throw Error("illegal message token: "+token);if(!this.proto3)throw Error("illegal field rule: "+token);this._parseMessageField(msg,"optional",token)}return this.tn.omit(";"),parent.messages.push(msg),msg},ParserPrototype._parseIgnored=function(){for(;";"!==this.tn.peek();)this.tn.next();this.tn.skip(";")},ParserPrototype._parseMessageField=function(msg,rule,type){if(!Lang.RULE.test(rule))throw Error("illegal message field rule: "+rule);var token,fld={rule:rule,type:"",name:"",options:{},id:0};if("map"===rule){if(type)throw Error("illegal type: "+type);if(this.tn.skip("<"),token=this.tn.next(),!Lang.TYPE.test(token)&&!Lang.TYPEREF.test(token))throw Error("illegal message field type: "+token);if(fld.keytype=token,this.tn.skip(","),token=this.tn.next(),!Lang.TYPE.test(token)&&!Lang.TYPEREF.test(token))throw Error("illegal message field: "+token);if(fld.type=token,this.tn.skip(">"),token=this.tn.next(),!Lang.NAME.test(token))throw Error("illegal message field name: "+token);fld.name=token,this.tn.skip("="),fld.id=mkId(this.tn.next()),"["===(token=this.tn.peek())&&this._parseFieldOptions(fld),this.tn.skip(";")}else if("group"===(type=void 0!==type?type:this.tn.next())){var grp=this._parseMessage(msg,fld);if(!/^[A-Z]/.test(grp.name))throw Error("illegal group name: "+grp.name);fld.type=grp.name,fld.name=grp.name.toLowerCase(),this.tn.omit(";")}else{if(!Lang.TYPE.test(type)&&!Lang.TYPEREF.test(type))throw Error("illegal message field type: "+type);if(fld.type=type,token=this.tn.next(),!Lang.NAME.test(token))throw Error("illegal message field name: "+token);fld.name=token,this.tn.skip("="),fld.id=mkId(this.tn.next()),"["===(token=this.tn.peek())&&this._parseFieldOptions(fld),this.tn.skip(";")}return msg.fields.push(fld),fld},ParserPrototype._parseMessageOneOf=function(msg){var token=this.tn.next();if(!Lang.NAME.test(token))throw Error("illegal oneof name: "+token);var fld,name=token,fields=[];for(this.tn.skip("{");"}"!==(token=this.tn.next());)(fld=this._parseMessageField(msg,"optional",token)).oneof=name,fields.push(fld.id);this.tn.omit(";"),msg.oneofs[name]=fields},ParserPrototype._parseFieldOptions=function(fld){this.tn.skip("[");for(var first=!0;"]"!==this.tn.peek();)first||this.tn.skip(","),this._parseOption(fld,!0),first=!1;this.tn.next()},ParserPrototype._parseEnum=function(msg){var enm={name:"",values:[],options:{}},token=this.tn.next();if(!Lang.NAME.test(token))throw Error("illegal name: "+token);for(enm.name=token,this.tn.skip("{");"}"!==(token=this.tn.next());)if("option"===token)this._parseOption(enm);else{if(!Lang.NAME.test(token))throw Error("illegal name: "+token);this.tn.skip("=");var val={name:token,id:mkId(this.tn.next(),!0)};"["===(token=this.tn.peek())&&this._parseFieldOptions({options:{}}),this.tn.skip(";"),enm.values.push(val)}this.tn.omit(";"),msg.enums.push(enm)},ParserPrototype._parseExtensionRanges=function(){var token,range,value,ranges=[];do{for(range=[];;){switch(token=this.tn.next()){case"min":value=ProtoBuf.ID_MIN;break;case"max":value=ProtoBuf.ID_MAX;break;default:value=mkNumber(token)}if(range.push(value),2===range.length)break;if("to"!==this.tn.peek()){range.push(value);break}this.tn.next()}ranges.push(range)}while(this.tn.omit(","));return this.tn.skip(";"),ranges},ParserPrototype._parseExtend=function(parent){var token=this.tn.next();if(!Lang.TYPEREF.test(token))throw Error("illegal extend reference: "+token);var ext={ref:token,fields:[]};for(this.tn.skip("{");"}"!==(token=this.tn.next());)if(Lang.RULE.test(token))this._parseMessageField(ext,token);else{if(!Lang.TYPEREF.test(token))throw Error("illegal extend token: "+token);if(!this.proto3)throw Error("illegal field rule: "+token);this._parseMessageField(ext,"optional",token)}return this.tn.omit(";"),parent.messages.push(ext),ext},ParserPrototype.toString=function(){return"Parser at line "+this.tn.line},DotProto.Parser=Parser,DotProto}(ProtoBuf,ProtoBuf.Lang),ProtoBuf.Reflect=function(ProtoBuf){function mkLong(value,unsigned){if(value&&"number"==typeof value.low&&"number"==typeof value.high&&"boolean"==typeof value.unsigned&&value.low==value.low&&value.high==value.high)return new ProtoBuf.Long(value.low,value.high,void 0===unsigned?value.unsigned:unsigned);if("string"==typeof value)return ProtoBuf.Long.fromString(value,unsigned||!1,10);if("number"==typeof value)return ProtoBuf.Long.fromNumber(value,unsigned||!1);throw Error("not convertible to Long")}function skipTillGroupEnd(expectedId,buf){var tag=buf.readVarint32(),wireType=7&tag,id=tag>>>3;switch(wireType){case ProtoBuf.WIRE_TYPES.VARINT:do{tag=buf.readUint8()}while(128==(128&tag));break;case ProtoBuf.WIRE_TYPES.BITS64:buf.offset+=8;break;case ProtoBuf.WIRE_TYPES.LDELIM:tag=buf.readVarint32(),buf.offset+=tag;break;case ProtoBuf.WIRE_TYPES.STARTGROUP:skipTillGroupEnd(id,buf);break;case ProtoBuf.WIRE_TYPES.ENDGROUP:if(id===expectedId)return!1;throw Error("Illegal GROUPEND after unknown group: "+id+" ("+expectedId+" expected)");case ProtoBuf.WIRE_TYPES.BITS32:buf.offset+=4;break;default:throw Error("Illegal wire type in unknown group "+expectedId+": "+wireType)}return!0}var Reflect={},T=function(builder,parent,name){this.builder=builder,this.parent=parent,this.name=name,this.className},TPrototype=T.prototype;TPrototype.fqn=function(){for(var name=this.name,ptr=this;null!=(ptr=ptr.parent);)name=ptr.name+"."+name;return name},TPrototype.toString=function(includeClass){return(includeClass?this.className+" ":"")+this.fqn()},TPrototype.build=function(){throw Error(this.toString(!0)+" cannot be built directly")},Reflect.T=T;var Namespace=function(builder,parent,name,options,syntax){T.call(this,builder,parent,name),this.className="Namespace",this.children=[],this.options=options||{},this.syntax=syntax||"proto2"},NamespacePrototype=Namespace.prototype=Object.create(T.prototype);NamespacePrototype.getChildren=function(type){if(null==(type=type||null))return this.children.slice();for(var children=[],i=0,k=this.children.length;i<k;++i)this.children[i]instanceof type&&children.push(this.children[i]);return children},NamespacePrototype.addChild=function(child){var other;if(other=this.getChild(child.name))if(other instanceof Message.Field&&other.name!==other.originalName&&null===this.getChild(other.originalName))other.name=other.originalName;else{if(!(child instanceof Message.Field&&child.name!==child.originalName&&null===this.getChild(child.originalName)))throw Error("Duplicate name in namespace "+this.toString(!0)+": "+child.name);child.name=child.originalName}this.children.push(child)},NamespacePrototype.getChild=function(nameOrId){for(var key="number"==typeof nameOrId?"id":"name",i=0,k=this.children.length;i<k;++i)if(this.children[i][key]===nameOrId)return this.children[i];return null},NamespacePrototype.resolve=function(qn,excludeNonNamespace){var child,part="string"==typeof qn?qn.split("."):qn,ptr=this,i=0;if(""===part[i]){for(;null!==ptr.parent;)ptr=ptr.parent;i++}do{do{if(!(ptr instanceof Reflect.Namespace)){ptr=null;break}if(!(child=ptr.getChild(part[i]))||!(child instanceof Reflect.T)||excludeNonNamespace&&!(child instanceof Reflect.Namespace)){ptr=null;break}ptr=child,i++}while(i<part.length);if(null!=ptr)break;if(null!==this.parent)return this.parent.resolve(qn,excludeNonNamespace)}while(null!=ptr);return ptr},NamespacePrototype.qn=function(t){var part=[],ptr=t;do{part.unshift(ptr.name),ptr=ptr.parent}while(null!==ptr);for(var len=1;len<=part.length;len++){var qn=part.slice(part.length-len);if(t===this.resolve(qn,t instanceof Reflect.Namespace))return qn.join(".")}return t.fqn()},NamespacePrototype.build=function(){for(var child,ns={},children=this.children,i=0,k=children.length;i<k;++i)(child=children[i])instanceof Namespace&&(ns[child.name]=child.build());return Object.defineProperty&&Object.defineProperty(ns,"$options",{value:this.buildOpt()}),ns},NamespacePrototype.buildOpt=function(){for(var opt={},keys=Object.keys(this.options),i=0,k=keys.length;i<k;++i){var key=keys[i],val=this.options[keys[i]];opt[key]=val}return opt},NamespacePrototype.getOption=function(name){return void 0===name?this.options:void 0!==this.options[name]?this.options[name]:null},Reflect.Namespace=Namespace;var Element=function(type,resolvedType,isMapKey,syntax,name){if(this.type=type,this.resolvedType=resolvedType,this.isMapKey=isMapKey,this.syntax=syntax,this.name=name,isMapKey&&ProtoBuf.MAP_KEY_TYPES.indexOf(type)<0)throw Error("Invalid map key type: "+type.name)},ElementPrototype=Element.prototype;Element.defaultFieldValue=function(type){if("string"==typeof type&&(type=ProtoBuf.TYPES[type]),void 0===type.defaultValue)throw Error("default value for type "+type.name+" is not supported");return type==ProtoBuf.TYPES.bytes?new ByteBuffer(0):type.defaultValue},ElementPrototype.toString=function(){return(this.name||"")+(this.isMapKey?"map":"value")+" element"},ElementPrototype.verifyValue=function(value){function fail(val,msg){throw Error("Illegal value for "+self.toString(!0)+" of type "+self.type.name+": "+val+" ("+msg+")")}var self=this;switch(this.type){case ProtoBuf.TYPES.int32:case ProtoBuf.TYPES.sint32:case ProtoBuf.TYPES.sfixed32:return("number"!=typeof value||value==value&&value%1!=0)&&fail(typeof value,"not an integer"),value>4294967295?0|value:value;case ProtoBuf.TYPES.uint32:case ProtoBuf.TYPES.fixed32:return("number"!=typeof value||value==value&&value%1!=0)&&fail(typeof value,"not an integer"),value<0?value>>>0:value;case ProtoBuf.TYPES.int64:case ProtoBuf.TYPES.sint64:case ProtoBuf.TYPES.sfixed64:if(ProtoBuf.Long)try{return mkLong(value,!1)}catch(e){fail(typeof value,e.message)}else fail(typeof value,"requires Long.js");case ProtoBuf.TYPES.uint64:case ProtoBuf.TYPES.fixed64:if(ProtoBuf.Long)try{return mkLong(value,!0)}catch(e){fail(typeof value,e.message)}else fail(typeof value,"requires Long.js");case ProtoBuf.TYPES.bool:return"boolean"!=typeof value&&fail(typeof value,"not a boolean"),value;case ProtoBuf.TYPES.float:case ProtoBuf.TYPES.double:return"number"!=typeof value&&fail(typeof value,"not a number"),value;case ProtoBuf.TYPES.string:return"string"==typeof value||value&&value instanceof String||fail(typeof value,"not a string"),""+value;case ProtoBuf.TYPES.bytes:return ByteBuffer.isByteBuffer(value)?value:ByteBuffer.wrap(value,"base64");case ProtoBuf.TYPES.enum:var values=this.resolvedType.getChildren(ProtoBuf.Reflect.Enum.Value);for(i=0;i<values.length;i++){if(values[i].name==value)return values[i].id;if(values[i].id==value)return values[i].id}if("proto3"===this.syntax)return("number"!=typeof value||value==value&&value%1!=0)&&fail(typeof value,"not an integer"),(value>4294967295||value<0)&&fail(typeof value,"not in range for uint32"),value;fail(value,"not a valid enum value");case ProtoBuf.TYPES.group:case ProtoBuf.TYPES.message:if(value&&"object"==typeof value||fail(typeof value,"object expected"),value instanceof this.resolvedType.clazz)return value;if(value instanceof ProtoBuf.Builder.Message){var obj={};for(var i in value)value.hasOwnProperty(i)&&(obj[i]=value[i]);value=obj}return new this.resolvedType.clazz(value)}throw Error("[INTERNAL] Illegal value for "+this.toString(!0)+": "+value+" (undefined type "+this.type+")")},ElementPrototype.calculateLength=function(id,value){if(null===value)return 0;var n;switch(this.type){case ProtoBuf.TYPES.int32:return value<0?ByteBuffer.calculateVarint64(value):ByteBuffer.calculateVarint32(value);case ProtoBuf.TYPES.uint32:return ByteBuffer.calculateVarint32(value);case ProtoBuf.TYPES.sint32:return ByteBuffer.calculateVarint32(ByteBuffer.zigZagEncode32(value));case ProtoBuf.TYPES.fixed32:case ProtoBuf.TYPES.sfixed32:case ProtoBuf.TYPES.float:return 4;case ProtoBuf.TYPES.int64:case ProtoBuf.TYPES.uint64:return ByteBuffer.calculateVarint64(value);case ProtoBuf.TYPES.sint64:return ByteBuffer.calculateVarint64(ByteBuffer.zigZagEncode64(value));case ProtoBuf.TYPES.fixed64:case ProtoBuf.TYPES.sfixed64:return 8;case ProtoBuf.TYPES.bool:return 1;case ProtoBuf.TYPES.enum:return ByteBuffer.calculateVarint32(value);case ProtoBuf.TYPES.double:return 8;case ProtoBuf.TYPES.string:return n=ByteBuffer.calculateUTF8Bytes(value),ByteBuffer.calculateVarint32(n)+n;case ProtoBuf.TYPES.bytes:if(value.remaining()<0)throw Error("Illegal value for "+this.toString(!0)+": "+value.remaining()+" bytes remaining");return ByteBuffer.calculateVarint32(value.remaining())+value.remaining();case ProtoBuf.TYPES.message:return n=this.resolvedType.calculate(value),ByteBuffer.calculateVarint32(n)+n;case ProtoBuf.TYPES.group:return(n=this.resolvedType.calculate(value))+ByteBuffer.calculateVarint32(id<<3|ProtoBuf.WIRE_TYPES.ENDGROUP)}throw Error("[INTERNAL] Illegal value to encode in "+this.toString(!0)+": "+value+" (unknown type)")},ElementPrototype.encodeValue=function(id,value,buffer){if(null===value)return buffer;switch(this.type){case ProtoBuf.TYPES.int32:value<0?buffer.writeVarint64(value):buffer.writeVarint32(value);break;case ProtoBuf.TYPES.uint32:buffer.writeVarint32(value);break;case ProtoBuf.TYPES.sint32:buffer.writeVarint32ZigZag(value);break;case ProtoBuf.TYPES.fixed32:buffer.writeUint32(value);break;case ProtoBuf.TYPES.sfixed32:buffer.writeInt32(value);break;case ProtoBuf.TYPES.int64:case ProtoBuf.TYPES.uint64:buffer.writeVarint64(value);break;case ProtoBuf.TYPES.sint64:buffer.writeVarint64ZigZag(value);break;case ProtoBuf.TYPES.fixed64:buffer.writeUint64(value);break;case ProtoBuf.TYPES.sfixed64:buffer.writeInt64(value);break;case ProtoBuf.TYPES.bool:"string"==typeof value?buffer.writeVarint32("false"===value.toLowerCase()?0:!!value):buffer.writeVarint32(value?1:0);break;case ProtoBuf.TYPES.enum:buffer.writeVarint32(value);break;case ProtoBuf.TYPES.float:buffer.writeFloat32(value);break;case ProtoBuf.TYPES.double:buffer.writeFloat64(value);break;case ProtoBuf.TYPES.string:buffer.writeVString(value);break;case ProtoBuf.TYPES.bytes:if(value.remaining()<0)throw Error("Illegal value for "+this.toString(!0)+": "+value.remaining()+" bytes remaining");var prevOffset=value.offset;buffer.writeVarint32(value.remaining()),buffer.append(value),value.offset=prevOffset;break;case ProtoBuf.TYPES.message:var bb=(new ByteBuffer).LE();this.resolvedType.encode(value,bb),buffer.writeVarint32(bb.offset),buffer.append(bb.flip());break;case ProtoBuf.TYPES.group:this.resolvedType.encode(value,buffer),buffer.writeVarint32(id<<3|ProtoBuf.WIRE_TYPES.ENDGROUP);break;default:throw Error("[INTERNAL] Illegal value to encode in "+this.toString(!0)+": "+value+" (unknown type)")}return buffer},ElementPrototype.decode=function(buffer,wireType,id){if(wireType!=this.type.wireType)throw Error("Unexpected wire type for element");var value,nBytes;switch(this.type){case ProtoBuf.TYPES.int32:return 0|buffer.readVarint32();case ProtoBuf.TYPES.uint32:return buffer.readVarint32()>>>0;case ProtoBuf.TYPES.sint32:return 0|buffer.readVarint32ZigZag();case ProtoBuf.TYPES.fixed32:return buffer.readUint32()>>>0;case ProtoBuf.TYPES.sfixed32:return 0|buffer.readInt32();case ProtoBuf.TYPES.int64:return buffer.readVarint64();case ProtoBuf.TYPES.uint64:return buffer.readVarint64().toUnsigned();case ProtoBuf.TYPES.sint64:return buffer.readVarint64ZigZag();case ProtoBuf.TYPES.fixed64:return buffer.readUint64();case ProtoBuf.TYPES.sfixed64:return buffer.readInt64();case ProtoBuf.TYPES.bool:return!!buffer.readVarint32();case ProtoBuf.TYPES.enum:return buffer.readVarint32();case ProtoBuf.TYPES.float:return buffer.readFloat();case ProtoBuf.TYPES.double:return buffer.readDouble();case ProtoBuf.TYPES.string:return buffer.readVString();case ProtoBuf.TYPES.bytes:if(nBytes=buffer.readVarint32(),buffer.remaining()<nBytes)throw Error("Illegal number of bytes for "+this.toString(!0)+": "+nBytes+" required but got only "+buffer.remaining());return(value=buffer.clone()).limit=value.offset+nBytes,buffer.offset+=nBytes,value;case ProtoBuf.TYPES.message:return nBytes=buffer.readVarint32(),this.resolvedType.decode(buffer,nBytes);case ProtoBuf.TYPES.group:return this.resolvedType.decode(buffer,-1,id)}throw Error("[INTERNAL] Illegal decode type")},ElementPrototype.valueFromString=function(str){if(!this.isMapKey)throw Error("valueFromString() called on non-map-key element");switch(this.type){case ProtoBuf.TYPES.int32:case ProtoBuf.TYPES.sint32:case ProtoBuf.TYPES.sfixed32:case ProtoBuf.TYPES.uint32:case ProtoBuf.TYPES.fixed32:return this.verifyValue(parseInt(str));case ProtoBuf.TYPES.int64:case ProtoBuf.TYPES.sint64:case ProtoBuf.TYPES.sfixed64:case ProtoBuf.TYPES.uint64:case ProtoBuf.TYPES.fixed64:return this.verifyValue(str);case ProtoBuf.TYPES.bool:return"true"===str;case ProtoBuf.TYPES.string:return this.verifyValue(str);case ProtoBuf.TYPES.bytes:return ByteBuffer.fromBinary(str)}},ElementPrototype.valueToString=function(value){if(!this.isMapKey)throw Error("valueToString() called on non-map-key element");return this.type===ProtoBuf.TYPES.bytes?value.toString("binary"):value.toString()},Reflect.Element=Element;var Message=function(builder,parent,name,options,isGroup,syntax){Namespace.call(this,builder,parent,name,options,syntax),this.className="Message",this.extensions=void 0,this.clazz=null,this.isGroup=!!isGroup,this._fields=null,this._fieldsById=null,this._fieldsByName=null},MessagePrototype=Message.prototype=Object.create(Namespace.prototype);MessagePrototype.build=function(rebuild){if(this.clazz&&!rebuild)return this.clazz;var clazz=function(ProtoBuf,T){function cloneRaw(obj,binaryAsBase64,longsAsStrings,resolvedType){if(null===obj||"object"!=typeof obj){if(resolvedType&&resolvedType instanceof ProtoBuf.Reflect.Enum){var name=ProtoBuf.Reflect.Enum.getName(resolvedType.object,obj);if(null!==name)return name}return obj}if(ByteBuffer.isByteBuffer(obj))return binaryAsBase64?obj.toBase64():obj.toBuffer();if(ProtoBuf.Long.isLong(obj))return longsAsStrings?obj.toString():ProtoBuf.Long.fromValue(obj);var clone;if(Array.isArray(obj))return clone=[],obj.forEach(function(v,k){clone[k]=cloneRaw(v,binaryAsBase64,longsAsStrings,resolvedType)}),clone;if(clone={},obj instanceof ProtoBuf.Map){for(var it=obj.entries(),e=it.next();!e.done;e=it.next())clone[obj.keyElem.valueToString(e.value[0])]=cloneRaw(e.value[1],binaryAsBase64,longsAsStrings,obj.valueElem.resolvedType);return clone}var type=obj.$type,field=void 0;for(var i in obj)obj.hasOwnProperty(i)&&(type&&(field=type.getChild(i))?clone[i]=cloneRaw(obj[i],binaryAsBase64,longsAsStrings,field.resolvedType):clone[i]=cloneRaw(obj[i],binaryAsBase64,longsAsStrings));return clone}var fields=T.getChildren(ProtoBuf.Reflect.Message.Field),oneofs=T.getChildren(ProtoBuf.Reflect.Message.OneOf),Message=function(values,var_args){ProtoBuf.Builder.Message.call(this);for(var i=0,k=oneofs.length;i<k;++i)this[oneofs[i].name]=null;for(i=0,k=fields.length;i<k;++i){var field=fields[i];this[field.name]=field.repeated?[]:field.map?new ProtoBuf.Map(field):null,!field.required&&"proto3"!==T.syntax||null===field.defaultValue||(this[field.name]=field.defaultValue)}var value;if(arguments.length>0)if(1!==arguments.length||null===values||"object"!=typeof values||!("function"!=typeof values.encode||values instanceof Message)||Array.isArray(values)||values instanceof ProtoBuf.Map||ByteBuffer.isByteBuffer(values)||values instanceof ArrayBuffer||ProtoBuf.Long&&values instanceof ProtoBuf.Long)for(i=0,k=arguments.length;i<k;++i)void 0!==(value=arguments[i])&&this.$set(fields[i].name,value);else this.$set(values)},MessagePrototype=Message.prototype=Object.create(ProtoBuf.Builder.Message.prototype);MessagePrototype.add=function(key,value,noAssert){var field=T._fieldsByName[key];if(!noAssert){if(!field)throw Error(this+"#"+key+" is undefined");if(!(field instanceof ProtoBuf.Reflect.Message.Field))throw Error(this+"#"+key+" is not a field: "+field.toString(!0));if(!field.repeated)throw Error(this+"#"+key+" is not a repeated field");value=field.verifyValue(value,!0)}return null===this[key]&&(this[key]=[]),this[key].push(value),this},MessagePrototype.$add=MessagePrototype.add,MessagePrototype.set=function(keyOrObj,value,noAssert){if(keyOrObj&&"object"==typeof keyOrObj){for(var ikey in noAssert=value,keyOrObj)keyOrObj.hasOwnProperty(ikey)&&void 0!==(value=keyOrObj[ikey])&&void 0===T._oneofsByName[ikey]&&this.$set(ikey,value,noAssert);return this}var field=T._fieldsByName[keyOrObj];if(noAssert)this[keyOrObj]=value;else{if(!field)throw Error(this+"#"+keyOrObj+" is not a field: undefined");if(!(field instanceof ProtoBuf.Reflect.Message.Field))throw Error(this+"#"+keyOrObj+" is not a field: "+field.toString(!0));this[field.name]=value=field.verifyValue(value)}if(field&&field.oneof){var currentField=this[field.oneof.name];null!==value?(null!==currentField&&currentField!==field.name&&(this[currentField]=null),this[field.oneof.name]=field.name):currentField===keyOrObj&&(this[field.oneof.name]=null)}return this},MessagePrototype.$set=MessagePrototype.set,MessagePrototype.get=function(key,noAssert){if(noAssert)return this[key];var field=T._fieldsByName[key];if(!(field&&field instanceof ProtoBuf.Reflect.Message.Field))throw Error(this+"#"+key+" is not a field: undefined");if(!(field instanceof ProtoBuf.Reflect.Message.Field))throw Error(this+"#"+key+" is not a field: "+field.toString(!0));return this[field.name]},MessagePrototype.$get=MessagePrototype.get;for(var i=0;i<fields.length;i++){var field=fields[i];field instanceof ProtoBuf.Reflect.Message.ExtensionField||T.builder.options.populateAccessors&&function(field){var Name=field.originalName.replace(/(_[a-zA-Z])/g,function(match){return match.toUpperCase().replace("_","")});Name=Name.substring(0,1).toUpperCase()+Name.substring(1);var name=field.originalName.replace(/([A-Z])/g,function(match){return"_"+match}),setter=function(value,noAssert){return this[field.name]=noAssert?value:field.verifyValue(value),this},getter=function(){return this[field.name]};null===T.getChild("set"+Name)&&(MessagePrototype["set"+Name]=setter),null===T.getChild("set_"+name)&&(MessagePrototype["set_"+name]=setter),null===T.getChild("get"+Name)&&(MessagePrototype["get"+Name]=getter),null===T.getChild("get_"+name)&&(MessagePrototype["get_"+name]=getter)}(field)}return MessagePrototype.encode=function(buffer,noVerify){"boolean"==typeof buffer&&(noVerify=buffer,buffer=void 0);var isNew=!1;buffer||(buffer=new ByteBuffer,isNew=!0);var le=buffer.littleEndian;try{return T.encode(this,buffer.LE(),noVerify),(isNew?buffer.flip():buffer).LE(le)}catch(e){throw buffer.LE(le),e}},Message.encode=function(data,buffer,noVerify){return new Message(data).encode(buffer,noVerify)},MessagePrototype.calculate=function(){return T.calculate(this)},MessagePrototype.encodeDelimited=function(buffer,noVerify){var isNew=!1;buffer||(buffer=new ByteBuffer,isNew=!0);var enc=(new ByteBuffer).LE();return T.encode(this,enc,noVerify).flip(),buffer.writeVarint32(enc.remaining()),buffer.append(enc),isNew?buffer.flip():buffer},MessagePrototype.encodeAB=function(){try{return this.encode().toArrayBuffer()}catch(e){throw e.encoded&&(e.encoded=e.encoded.toArrayBuffer()),e}},MessagePrototype.toArrayBuffer=MessagePrototype.encodeAB,MessagePrototype.encodeNB=function(){try{return this.encode().toBuffer()}catch(e){throw e.encoded&&(e.encoded=e.encoded.toBuffer()),e}},MessagePrototype.toBuffer=MessagePrototype.encodeNB,MessagePrototype.encode64=function(){try{return this.encode().toBase64()}catch(e){throw e.encoded&&(e.encoded=e.encoded.toBase64()),e}},MessagePrototype.toBase64=MessagePrototype.encode64,MessagePrototype.encodeHex=function(){try{return this.encode().toHex()}catch(e){throw e.encoded&&(e.encoded=e.encoded.toHex()),e}},MessagePrototype.toHex=MessagePrototype.encodeHex,MessagePrototype.toRaw=function(binaryAsBase64,longsAsStrings){return cloneRaw(this,!!binaryAsBase64,!!longsAsStrings,this.$type)},MessagePrototype.encodeJSON=function(){return JSON.stringify(cloneRaw(this,!0,!0,this.$type))},Message.decode=function(buffer,length,enc){"string"==typeof length&&(enc=length,length=-1),"string"==typeof buffer?buffer=ByteBuffer.wrap(buffer,enc||"base64"):ByteBuffer.isByteBuffer(buffer)||(buffer=ByteBuffer.wrap(buffer));var le=buffer.littleEndian;try{var msg=T.decode(buffer.LE(),length);return buffer.LE(le),msg}catch(e){throw buffer.LE(le),e}},Message.decodeDelimited=function(buffer,enc){if("string"==typeof buffer?buffer=ByteBuffer.wrap(buffer,enc||"base64"):ByteBuffer.isByteBuffer(buffer)||(buffer=ByteBuffer.wrap(buffer)),buffer.remaining()<1)return null;var off=buffer.offset,len=buffer.readVarint32();if(buffer.remaining()<len)return buffer.offset=off,null;try{var msg=T.decode(buffer.slice(buffer.offset,buffer.offset+len).LE());return buffer.offset+=len,msg}catch(err){throw buffer.offset+=len,err}},Message.decode64=function(str){return Message.decode(str,"base64")},Message.decodeHex=function(str){return Message.decode(str,"hex")},Message.decodeJSON=function(str){return new Message(JSON.parse(str))},MessagePrototype.toString=function(){return T.toString()},Object.defineProperty&&(Object.defineProperty(Message,"$options",{value:T.buildOpt()}),Object.defineProperty(MessagePrototype,"$options",{value:Message.$options}),Object.defineProperty(Message,"$type",{value:T}),Object.defineProperty(MessagePrototype,"$type",{value:T})),Message}(ProtoBuf,this);this._fields=[],this._fieldsById={},this._fieldsByName={},this._oneofsByName={};for(var child,i=0,k=this.children.length;i<k;i++)if((child=this.children[i])instanceof Enum||child instanceof Message||child instanceof Service){if(clazz.hasOwnProperty(child.name))throw Error("Illegal reflect child of "+this.toString(!0)+": "+child.toString(!0)+" cannot override static property '"+child.name+"'");clazz[child.name]=child.build()}else if(child instanceof Message.Field)child.build(),this._fields.push(child),this._fieldsById[child.id]=child,this._fieldsByName[child.name]=child;else if(child instanceof Message.OneOf)this._oneofsByName[child.name]=child;else if(!(child instanceof Message.OneOf||child instanceof Extension))throw Error("Illegal reflect child of "+this.toString(!0)+": "+this.children[i].toString(!0));return this.clazz=clazz},MessagePrototype.encode=function(message,buffer,noVerify){for(var field,val,fieldMissing=null,i=0,k=this._fields.length;i<k;++i)val=message[(field=this._fields[i]).name],field.required&&null===val?null===fieldMissing&&(fieldMissing=field):field.encode(noVerify?val:field.verifyValue(val),buffer,message);if(null!==fieldMissing){var err=Error("Missing at least one required field for "+this.toString(!0)+": "+fieldMissing);throw err.encoded=buffer,err}return buffer},MessagePrototype.calculate=function(message){for(var field,val,n=0,i=0,k=this._fields.length;i<k;++i){if(val=message[(field=this._fields[i]).name],field.required&&null===val)throw Error("Missing at least one required field for "+this.toString(!0)+": "+field);n+=field.calculate(val,message)}return n},MessagePrototype.decode=function(buffer,length,expectedGroupEndId){"number"!=typeof length&&(length=-1);for(var tag,wireType,id,field,start=buffer.offset,msg=new this.clazz;buffer.offset<start+length||-1===length&&buffer.remaining()>0;){if(id=(tag=buffer.readVarint32())>>>3,(wireType=7&tag)===ProtoBuf.WIRE_TYPES.ENDGROUP){if(id!==expectedGroupEndId)throw Error("Illegal group end indicator for "+this.toString(!0)+": "+id+" ("+(expectedGroupEndId?expectedGroupEndId+" expected":"not a group")+")");break}if(field=this._fieldsById[id]){if(field.repeated&&!field.options.packed)msg[field.name].push(field.decode(wireType,buffer));else if(field.map){var keyval=field.decode(wireType,buffer);msg[field.name].set(keyval[0],keyval[1])}else if(msg[field.name]=field.decode(wireType,buffer),field.oneof){var currentField=msg[field.oneof.name];null!==currentField&&currentField!==field.name&&(msg[currentField]=null),msg[field.oneof.name]=field.name}}else switch(wireType){case ProtoBuf.WIRE_TYPES.VARINT:buffer.readVarint32();break;case ProtoBuf.WIRE_TYPES.BITS32:buffer.offset+=4;break;case ProtoBuf.WIRE_TYPES.BITS64:buffer.offset+=8;break;case ProtoBuf.WIRE_TYPES.LDELIM:var len=buffer.readVarint32();buffer.offset+=len;break;case ProtoBuf.WIRE_TYPES.STARTGROUP:for(;skipTillGroupEnd(id,buffer););break;default:throw Error("Illegal wire type for unknown field "+id+" in "+this.toString(!0)+"#decode: "+wireType)}}for(var i=0,k=this._fields.length;i<k;++i)if(null===msg[(field=this._fields[i]).name])if("proto3"===this.syntax)msg[field.name]=field.defaultValue;else{if(field.required){var err=Error("Missing at least one required field for "+this.toString(!0)+": "+field.name);throw err.decoded=msg,err}ProtoBuf.populateDefaults&&null!==field.defaultValue&&(msg[field.name]=field.defaultValue)}return msg},Reflect.Message=Message;var Field=function(builder,message,rule,keytype,type,name,id,options,oneof,syntax){T.call(this,builder,message,name),this.className="Message.Field",this.required="required"===rule,this.repeated="repeated"===rule,this.map="map"===rule,this.keyType=keytype||null,this.type=type,this.resolvedType=null,this.id=id,this.options=options||{},this.defaultValue=null,this.oneof=oneof||null,this.syntax=syntax||"proto2",this.originalName=this.name,this.element=null,this.keyElement=null,!this.builder.options.convertFieldsToCamelCase||this instanceof Message.ExtensionField||(this.name=ProtoBuf.Util.toCamelCase(this.name))},FieldPrototype=Field.prototype=Object.create(T.prototype);FieldPrototype.build=function(){this.element=new Element(this.type,this.resolvedType,!1,this.syntax,this.name),this.map&&(this.keyElement=new Element(this.keyType,void 0,!0,this.syntax,this.name)),"proto3"!==this.syntax||this.repeated||this.map?void 0!==this.options.default&&(this.defaultValue=this.verifyValue(this.options.default)):this.defaultValue=Element.defaultFieldValue(this.type)},FieldPrototype.verifyValue=function(value,skipRepeated){function fail(val,msg){throw Error("Illegal value for "+self.toString(!0)+" of type "+self.type.name+": "+val+" ("+msg+")")}skipRepeated=skipRepeated||!1;var i,self=this;if(null===value)return this.required&&fail(typeof value,"required"),"proto3"===this.syntax&&this.type!==ProtoBuf.TYPES.message&&fail(typeof value,"proto3 field without field presence cannot be null"),null;if(this.repeated&&!skipRepeated){Array.isArray(value)||(value=[value]);var res=[];for(i=0;i<value.length;i++)res.push(this.element.verifyValue(value[i]));return res}return this.map&&!skipRepeated?value instanceof ProtoBuf.Map?value:(value instanceof Object||fail(typeof value,"expected ProtoBuf.Map or raw object for map field"),new ProtoBuf.Map(this,value)):(!this.repeated&&Array.isArray(value)&&fail(typeof value,"no array expected"),this.element.verifyValue(value))},FieldPrototype.hasWirePresence=function(value,message){if("proto3"!==this.syntax)return null!==value;if(this.oneof&&message[this.oneof.name]===this.name)return!0;switch(this.type){case ProtoBuf.TYPES.int32:case ProtoBuf.TYPES.sint32:case ProtoBuf.TYPES.sfixed32:case ProtoBuf.TYPES.uint32:case ProtoBuf.TYPES.fixed32:return 0!==value;case ProtoBuf.TYPES.int64:case ProtoBuf.TYPES.sint64:case ProtoBuf.TYPES.sfixed64:case ProtoBuf.TYPES.uint64:case ProtoBuf.TYPES.fixed64:return 0!==value.low||0!==value.high;case ProtoBuf.TYPES.bool:return value;case ProtoBuf.TYPES.float:case ProtoBuf.TYPES.double:return 0!==value;case ProtoBuf.TYPES.string:return value.length>0;case ProtoBuf.TYPES.bytes:return value.remaining()>0;case ProtoBuf.TYPES.enum:return 0!==value;case ProtoBuf.TYPES.message:return null!==value;default:return!0}},FieldPrototype.encode=function(value,buffer,message){if(null===this.type||"object"!=typeof this.type)throw Error("[INTERNAL] Unresolved type in "+this.toString(!0)+": "+this.type);if(null===value||this.repeated&&0==value.length)return buffer;try{var i;if(this.repeated)if(this.options.packed&&ProtoBuf.PACKABLE_WIRE_TYPES.indexOf(this.type.wireType)>=0){buffer.writeVarint32(this.id<<3|ProtoBuf.WIRE_TYPES.LDELIM),buffer.ensureCapacity(buffer.offset+=1);var start=buffer.offset;for(i=0;i<value.length;i++)this.element.encodeValue(this.id,value[i],buffer);var len=buffer.offset-start,varintLen=ByteBuffer.calculateVarint32(len);if(varintLen>1){var contents=buffer.slice(start,buffer.offset);start+=varintLen-1,buffer.offset=start,buffer.append(contents)}buffer.writeVarint32(len,start-varintLen)}else for(i=0;i<value.length;i++)buffer.writeVarint32(this.id<<3|this.type.wireType),this.element.encodeValue(this.id,value[i],buffer);else this.map?value.forEach(function(val,key,m){var length=ByteBuffer.calculateVarint32(8|this.keyType.wireType)+this.keyElement.calculateLength(1,key)+ByteBuffer.calculateVarint32(16|this.type.wireType)+this.element.calculateLength(2,val);buffer.writeVarint32(this.id<<3|ProtoBuf.WIRE_TYPES.LDELIM),buffer.writeVarint32(length),buffer.writeVarint32(8|this.keyType.wireType),this.keyElement.encodeValue(1,key,buffer),buffer.writeVarint32(16|this.type.wireType),this.element.encodeValue(2,val,buffer)},this):this.hasWirePresence(value,message)&&(buffer.writeVarint32(this.id<<3|this.type.wireType),this.element.encodeValue(this.id,value,buffer))}catch(e){throw Error("Illegal value for "+this.toString(!0)+": "+value+" ("+e+")")}return buffer},FieldPrototype.calculate=function(value,message){if(value=this.verifyValue(value),null===this.type||"object"!=typeof this.type)throw Error("[INTERNAL] Unresolved type in "+this.toString(!0)+": "+this.type);if(null===value||this.repeated&&0==value.length)return 0;var n=0;try{var i,ni;if(this.repeated)if(this.options.packed&&ProtoBuf.PACKABLE_WIRE_TYPES.indexOf(this.type.wireType)>=0){for(n+=ByteBuffer.calculateVarint32(this.id<<3|ProtoBuf.WIRE_TYPES.LDELIM),ni=0,i=0;i<value.length;i++)ni+=this.element.calculateLength(this.id,value[i]);n+=ByteBuffer.calculateVarint32(ni),n+=ni}else for(i=0;i<value.length;i++)n+=ByteBuffer.calculateVarint32(this.id<<3|this.type.wireType),n+=this.element.calculateLength(this.id,value[i]);else this.map?value.forEach(function(val,key,m){var length=ByteBuffer.calculateVarint32(8|this.keyType.wireType)+this.keyElement.calculateLength(1,key)+ByteBuffer.calculateVarint32(16|this.type.wireType)+this.element.calculateLength(2,val);n+=ByteBuffer.calculateVarint32(this.id<<3|ProtoBuf.WIRE_TYPES.LDELIM),n+=ByteBuffer.calculateVarint32(length),n+=length},this):this.hasWirePresence(value,message)&&(n+=ByteBuffer.calculateVarint32(this.id<<3|this.type.wireType),n+=this.element.calculateLength(this.id,value))}catch(e){throw Error("Illegal value for "+this.toString(!0)+": "+value+" ("+e+")")}return n},FieldPrototype.decode=function(wireType,buffer,skipRepeated){var value,nBytes;if(!(!this.map&&wireType==this.type.wireType||!skipRepeated&&this.repeated&&this.options.packed&&wireType==ProtoBuf.WIRE_TYPES.LDELIM||this.map&&wireType==ProtoBuf.WIRE_TYPES.LDELIM))throw Error("Illegal wire type for field "+this.toString(!0)+": "+wireType+" ("+this.type.wireType+" expected)");if(wireType==ProtoBuf.WIRE_TYPES.LDELIM&&this.repeated&&this.options.packed&&ProtoBuf.PACKABLE_WIRE_TYPES.indexOf(this.type.wireType)>=0&&!skipRepeated){nBytes=buffer.readVarint32(),nBytes=buffer.offset+nBytes;for(var values=[];buffer.offset<nBytes;)values.push(this.decode(this.type.wireType,buffer,!0));return values}if(this.map){var key=Element.defaultFieldValue(this.keyType);if(value=Element.defaultFieldValue(this.type),nBytes=buffer.readVarint32(),buffer.remaining()<nBytes)throw Error("Illegal number of bytes for "+this.toString(!0)+": "+nBytes+" required but got only "+buffer.remaining());var msgbuf=buffer.clone();for(msgbuf.limit=msgbuf.offset+nBytes,buffer.offset+=nBytes;msgbuf.remaining()>0;){var tag=msgbuf.readVarint32();wireType=7&tag;var id=tag>>>3;if(1===id)key=this.keyElement.decode(msgbuf,wireType,id);else{if(2!==id)throw Error("Unexpected tag in map field key/value submessage");value=this.element.decode(msgbuf,wireType,id)}}return[key,value]}return this.element.decode(buffer,wireType,this.id)},Reflect.Message.Field=Field;var ExtensionField=function(builder,message,rule,type,name,id,options){Field.call(this,builder,message,rule,null,type,name,id,options),this.extension};ExtensionField.prototype=Object.create(Field.prototype),Reflect.Message.ExtensionField=ExtensionField;Reflect.Message.OneOf=function(builder,message,name){T.call(this,builder,message,name),this.fields=[]};var Enum=function(builder,parent,name,options,syntax){Namespace.call(this,builder,parent,name,options,syntax),this.className="Enum",this.object=null};Enum.getName=function(enm,value){for(var key,keys=Object.keys(enm),i=0;i<keys.length;++i)if(enm[key=keys[i]]===value)return key;return null},(Enum.prototype=Object.create(Namespace.prototype)).build=function(rebuild){if(this.object&&!rebuild)return this.object;for(var enm=new ProtoBuf.Builder.Enum,values=this.getChildren(Enum.Value),i=0,k=values.length;i<k;++i)enm[values[i].name]=values[i].id;return Object.defineProperty&&Object.defineProperty(enm,"$options",{value:this.buildOpt(),enumerable:!1}),this.object=enm},Reflect.Enum=Enum;var Value=function(builder,enm,name,id){T.call(this,builder,enm,name),this.className="Enum.Value",this.id=id};Value.prototype=Object.create(T.prototype),Reflect.Enum.Value=Value;var Extension=function(builder,parent,name,field){T.call(this,builder,parent,name),this.field=field};Extension.prototype=Object.create(T.prototype),Reflect.Extension=Extension;var Service=function(builder,root,name,options){Namespace.call(this,builder,root,name,options),this.className="Service",this.clazz=null};(Service.prototype=Object.create(Namespace.prototype)).build=function(rebuild){return this.clazz&&!rebuild?this.clazz:this.clazz=function(ProtoBuf,T){for(var Service=function(rpcImpl){ProtoBuf.Builder.Service.call(this),this.rpcImpl=rpcImpl||function(name,msg,callback){setTimeout(callback.bind(this,Error("Not implemented, see: https://github.com/dcodeIO/ProtoBuf.js/wiki/Services")),0)}},ServicePrototype=Service.prototype=Object.create(ProtoBuf.Builder.Service.prototype),rpc=T.getChildren(ProtoBuf.Reflect.Service.RPCMethod),i=0;i<rpc.length;i++)!function(method){ServicePrototype[method.name]=function(req,callback){try{try{req=method.resolvedRequestType.clazz.decode(ByteBuffer.wrap(req))}catch(err){if(!(err instanceof TypeError))throw err}if(null===req||"object"!=typeof req)throw Error("Illegal arguments");req instanceof method.resolvedRequestType.clazz||(req=new method.resolvedRequestType.clazz(req)),this.rpcImpl(method.fqn(),req,function(err,res){if(err)callback(err);else{null===res&&(res="");try{res=method.resolvedResponseType.clazz.decode(res)}catch(notABuffer){}res&&res instanceof method.resolvedResponseType.clazz?callback(null,res):callback(Error("Illegal response type received in service method "+T.name+"#"+method.name))}})}catch(err){setTimeout(callback.bind(this,err),0)}},Service[method.name]=function(rpcImpl,req,callback){new Service(rpcImpl)[method.name](req,callback)},Object.defineProperty&&(Object.defineProperty(Service[method.name],"$options",{value:method.buildOpt()}),Object.defineProperty(ServicePrototype[method.name],"$options",{value:Service[method.name].$options}))}(rpc[i]);return Object.defineProperty&&(Object.defineProperty(Service,"$options",{value:T.buildOpt()}),Object.defineProperty(ServicePrototype,"$options",{value:Service.$options}),Object.defineProperty(Service,"$type",{value:T}),Object.defineProperty(ServicePrototype,"$type",{value:T})),Service}(ProtoBuf,this)},Reflect.Service=Service;var Method=function(builder,svc,name,options){T.call(this,builder,svc,name),this.className="Service.Method",this.options=options||{}};(Method.prototype=Object.create(T.prototype)).buildOpt=NamespacePrototype.buildOpt,Reflect.Service.Method=Method;var RPCMethod=function(builder,svc,name,request,response,request_stream,response_stream,options){Method.call(this,builder,svc,name,options),this.className="Service.RPCMethod",this.requestName=request,this.responseName=response,this.requestStream=request_stream,this.responseStream=response_stream,this.resolvedRequestType=null,this.resolvedResponseType=null};return RPCMethod.prototype=Object.create(Method.prototype),Reflect.Service.RPCMethod=RPCMethod,Reflect}(ProtoBuf),ProtoBuf.Builder=function(ProtoBuf,Lang,Reflect){var Builder=function(options){this.ns=new Reflect.Namespace(this,null,""),this.ptr=this.ns,this.resolved=!1,this.result=null,this.files={},this.importRoot=null,this.options=options||{}},BuilderPrototype=Builder.prototype;return Builder.isMessage=function(def){return"string"==typeof def.name&&void 0===def.values&&void 0===def.rpc},Builder.isMessageField=function(def){return"string"==typeof def.rule&&"string"==typeof def.name&&"string"==typeof def.type&&void 0!==def.id},Builder.isEnum=function(def){return"string"==typeof def.name&&!(void 0===def.values||!Array.isArray(def.values)||0===def.values.length)},Builder.isService=function(def){return!("string"!=typeof def.name||"object"!=typeof def.rpc||!def.rpc)},Builder.isExtend=function(def){return"string"==typeof def.ref},BuilderPrototype.reset=function(){return this.ptr=this.ns,this},BuilderPrototype.define=function(namespace){if("string"!=typeof namespace||!Lang.TYPEREF.test(namespace))throw Error("illegal namespace: "+namespace);return namespace.split(".").forEach(function(part){var ns=this.ptr.getChild(part);null===ns&&this.ptr.addChild(ns=new Reflect.Namespace(this,this.ptr,part)),this.ptr=ns},this),this},BuilderPrototype.create=function(defs){if(!defs)return this;if(Array.isArray(defs)){if(0===defs.length)return this;defs=defs.slice()}else defs=[defs];for(var stack=[defs];stack.length>0;){if(defs=stack.pop(),!Array.isArray(defs))throw Error("not a valid namespace: "+JSON.stringify(defs));for(;defs.length>0;){var def=defs.shift();if(Builder.isMessage(def)){var obj=new Reflect.Message(this,this.ptr,def.name,def.options,def.isGroup,def.syntax),oneofs={};def.oneofs&&Object.keys(def.oneofs).forEach(function(name){obj.addChild(oneofs[name]=new Reflect.Message.OneOf(this,obj,name))},this),def.fields&&def.fields.forEach(function(fld){if(null!==obj.getChild(0|fld.id))throw Error("duplicate or invalid field id in "+obj.name+": "+fld.id);if(fld.options&&"object"!=typeof fld.options)throw Error("illegal field options in "+obj.name+"#"+fld.name);var oneof=null;if("string"==typeof fld.oneof&&!(oneof=oneofs[fld.oneof]))throw Error("illegal oneof in "+obj.name+"#"+fld.name+": "+fld.oneof);fld=new Reflect.Message.Field(this,obj,fld.rule,fld.keytype,fld.type,fld.name,fld.id,fld.options,oneof,def.syntax),oneof&&oneof.fields.push(fld),obj.addChild(fld)},this);var subObj=[];if(def.enums&&def.enums.forEach(function(enm){subObj.push(enm)}),def.messages&&def.messages.forEach(function(msg){subObj.push(msg)}),def.services&&def.services.forEach(function(svc){subObj.push(svc)}),def.extensions&&("number"==typeof def.extensions[0]?obj.extensions=[def.extensions]:obj.extensions=def.extensions),this.ptr.addChild(obj),subObj.length>0){stack.push(defs),defs=subObj,subObj=null,this.ptr=obj,obj=null;continue}subObj=null}else if(Builder.isEnum(def))obj=new Reflect.Enum(this,this.ptr,def.name,def.options,def.syntax),def.values.forEach(function(val){obj.addChild(new Reflect.Enum.Value(this,obj,val.name,val.id))},this),this.ptr.addChild(obj);else if(Builder.isService(def))obj=new Reflect.Service(this,this.ptr,def.name,def.options),Object.keys(def.rpc).forEach(function(name){var mtd=def.rpc[name];obj.addChild(new Reflect.Service.RPCMethod(this,obj,name,mtd.request,mtd.response,!!mtd.request_stream,!!mtd.response_stream,mtd.options))},this),this.ptr.addChild(obj);else{if(!Builder.isExtend(def))throw Error("not a valid definition: "+JSON.stringify(def));if(obj=this.ptr.resolve(def.ref,!0))def.fields.forEach(function(fld){if(null!==obj.getChild(0|fld.id))throw Error("duplicate extended field id in "+obj.name+": "+fld.id);if(obj.extensions){var valid=!1;if(obj.extensions.forEach(function(range){fld.id>=range[0]&&fld.id<=range[1]&&(valid=!0)}),!valid)throw Error("illegal extended field id in "+obj.name+": "+fld.id+" (not within valid ranges)")}var name=fld.name;this.options.convertFieldsToCamelCase&&(name=ProtoBuf.Util.toCamelCase(name));var field=new Reflect.Message.ExtensionField(this,obj,fld.rule,fld.type,this.ptr.fqn()+"."+name,fld.id,fld.options),ext=new Reflect.Extension(this,this.ptr,fld.name,field);field.extension=ext,this.ptr.addChild(ext),obj.addChild(field)},this);else if(!/\.?google\.protobuf\./.test(def.ref))throw Error("extended message "+def.ref+" is not defined")}def=null,obj=null}defs=null,this.ptr=this.ptr.parent}return this.resolved=!1,this.result=null,this},BuilderPrototype.import=function(json,filename){var delim="/";if("string"==typeof filename){if(ProtoBuf.Util.IS_NODE&&(filename=_dereq_("path").resolve(filename)),!0===this.files[filename])return this.reset();this.files[filename]=!0}else if("object"==typeof filename){var fname,root=filename.root;if(ProtoBuf.Util.IS_NODE&&(root=_dereq_("path").resolve(root)),(root.indexOf("\\")>=0||filename.file.indexOf("\\")>=0)&&(delim="\\"),fname=ProtoBuf.Util.IS_NODE?_dereq_("path").join(root,filename.file):root+delim+filename.file,!0===this.files[fname])return this.reset();this.files[fname]=!0}if(json.imports&&json.imports.length>0){var importRoot,resetRoot=!1;"object"==typeof filename?(this.importRoot=filename.root,resetRoot=!0,importRoot=this.importRoot,filename=filename.file,(importRoot.indexOf("\\")>=0||filename.indexOf("\\")>=0)&&(delim="\\")):"string"==typeof filename?this.importRoot?importRoot=this.importRoot:filename.indexOf("/")>=0?""===(importRoot=filename.replace(/\/[^\/]*$/,""))&&(importRoot="/"):filename.indexOf("\\")>=0?(importRoot=filename.replace(/\\[^\\]*$/,""),delim="\\"):importRoot=".":importRoot=null;for(var i=0;i<json.imports.length;i++)if("string"==typeof json.imports[i]){if(!importRoot)throw Error("cannot determine import root");var importFilename=json.imports[i];if("google/protobuf/descriptor.proto"===importFilename)continue;if(importFilename=ProtoBuf.Util.IS_NODE?_dereq_("path").join(importRoot,importFilename):importRoot+delim+importFilename,!0===this.files[importFilename])continue;/\.proto$/i.test(importFilename)&&!ProtoBuf.DotProto&&(importFilename=importFilename.replace(/\.proto$/,".json"));var contents=ProtoBuf.Util.fetch(importFilename);if(null===contents)throw Error("failed to import '"+importFilename+"' in '"+filename+"': file not found");/\.json$/i.test(importFilename)?this.import(JSON.parse(contents+""),importFilename):this.import(ProtoBuf.DotProto.Parser.parse(contents),importFilename)}else filename?/\.(\w+)$/.test(filename)?this.import(json.imports[i],filename.replace(/^(.+)\.(\w+)$/,function($0,$1,$2){return $1+"_import"+i+"."+$2})):this.import(json.imports[i],filename+"_import"+i):this.import(json.imports[i]);resetRoot&&(this.importRoot=null)}json.package&&this.define(json.package),json.syntax&&function propagateSyntax(parent){parent.messages&&parent.messages.forEach(function(child){child.syntax=parent.syntax,propagateSyntax(child)}),parent.enums&&parent.enums.forEach(function(child){child.syntax=parent.syntax})}(json);var base=this.ptr;return json.options&&Object.keys(json.options).forEach(function(key){base.options[key]=json.options[key]}),json.messages&&(this.create(json.messages),this.ptr=base),json.enums&&(this.create(json.enums),this.ptr=base),json.services&&(this.create(json.services),this.ptr=base),json.extends&&this.create(json.extends),this.reset()},BuilderPrototype.resolveAll=function(){var res;if(null==this.ptr||"object"==typeof this.ptr.type)return this;if(this.ptr instanceof Reflect.Namespace)this.ptr.children.forEach(function(child){this.ptr=child,this.resolveAll()},this);else if(this.ptr instanceof Reflect.Message.Field){if(Lang.TYPE.test(this.ptr.type))this.ptr.type=ProtoBuf.TYPES[this.ptr.type];else{if(!Lang.TYPEREF.test(this.ptr.type))throw Error("illegal type reference in "+this.ptr.toString(!0)+": "+this.ptr.type);if(!(res=(this.ptr instanceof Reflect.Message.ExtensionField?this.ptr.extension.parent:this.ptr.parent).resolve(this.ptr.type,!0)))throw Error("unresolvable type reference in "+this.ptr.toString(!0)+": "+this.ptr.type);if(this.ptr.resolvedType=res,res instanceof Reflect.Enum){if(this.ptr.type=ProtoBuf.TYPES.enum,"proto3"===this.ptr.syntax&&"proto3"!==res.syntax)throw Error("proto3 message cannot reference proto2 enum")}else{if(!(res instanceof Reflect.Message))throw Error("illegal type reference in "+this.ptr.toString(!0)+": "+this.ptr.type);this.ptr.type=res.isGroup?ProtoBuf.TYPES.group:ProtoBuf.TYPES.message}}if(this.ptr.map){if(!Lang.TYPE.test(this.ptr.keyType))throw Error("illegal key type for map field in "+this.ptr.toString(!0)+": "+this.ptr.keyType);this.ptr.keyType=ProtoBuf.TYPES[this.ptr.keyType]}"proto3"===this.ptr.syntax&&this.ptr.repeated&&void 0===this.ptr.options.packed&&-1!==ProtoBuf.PACKABLE_WIRE_TYPES.indexOf(this.ptr.type.wireType)&&(this.ptr.options.packed=!0)}else if(this.ptr instanceof ProtoBuf.Reflect.Service.Method){if(!(this.ptr instanceof ProtoBuf.Reflect.Service.RPCMethod))throw Error("illegal service type in "+this.ptr.toString(!0));if(!((res=this.ptr.parent.resolve(this.ptr.requestName,!0))&&res instanceof ProtoBuf.Reflect.Message))throw Error("Illegal type reference in "+this.ptr.toString(!0)+": "+this.ptr.requestName);if(this.ptr.resolvedRequestType=res,!((res=this.ptr.parent.resolve(this.ptr.responseName,!0))&&res instanceof ProtoBuf.Reflect.Message))throw Error("Illegal type reference in "+this.ptr.toString(!0)+": "+this.ptr.responseName);this.ptr.resolvedResponseType=res}else if(!(this.ptr instanceof ProtoBuf.Reflect.Message.OneOf||this.ptr instanceof ProtoBuf.Reflect.Extension||this.ptr instanceof ProtoBuf.Reflect.Enum.Value))throw Error("illegal object in namespace: "+typeof this.ptr+": "+this.ptr);return this.reset()},BuilderPrototype.build=function(path){if(this.reset(),this.resolved||(this.resolveAll(),this.resolved=!0,this.result=null),null===this.result&&(this.result=this.ns.build()),!path)return this.result;for(var part="string"==typeof path?path.split("."):path,ptr=this.result,i=0;i<part.length;i++){if(!ptr[part[i]]){ptr=null;break}ptr=ptr[part[i]]}return ptr},BuilderPrototype.lookup=function(path,excludeNonNamespace){return path?this.ns.resolve(path,excludeNonNamespace):this.ns},BuilderPrototype.toString=function(){return"Builder"},Builder.Message=function(){},Builder.Enum=function(){},Builder.Service=function(){},Builder}(ProtoBuf,ProtoBuf.Lang,ProtoBuf.Reflect),ProtoBuf.Map=function(ProtoBuf,Reflect){function arrayIterator(arr){var idx=0;return{next:function(){return idx<arr.length?{done:!1,value:arr[idx++]}:{done:!0}}}}var Map=function(field,contents){if(!field.map)throw Error("field is not a map");if(this.field=field,this.keyElem=new Reflect.Element(field.keyType,null,!0,field.syntax),this.valueElem=new Reflect.Element(field.type,field.resolvedType,!1,field.syntax),this.map={},Object.defineProperty(this,"size",{get:function(){return Object.keys(this.map).length}}),contents)for(var keys=Object.keys(contents),i=0;i<keys.length;i++){var key=this.keyElem.valueFromString(keys[i]),val=this.valueElem.verifyValue(contents[keys[i]]);this.map[this.keyElem.valueToString(key)]={key:key,value:val}}},MapPrototype=Map.prototype;return MapPrototype.clear=function(){this.map={}},MapPrototype.delete=function(key){var keyValue=this.keyElem.valueToString(this.keyElem.verifyValue(key)),hadKey=keyValue in this.map;return delete this.map[keyValue],hadKey},MapPrototype.entries=function(){for(var entry,entries=[],strKeys=Object.keys(this.map),i=0;i<strKeys.length;i++)entries.push([(entry=this.map[strKeys[i]]).key,entry.value]);return arrayIterator(entries)},MapPrototype.keys=function(){for(var keys=[],strKeys=Object.keys(this.map),i=0;i<strKeys.length;i++)keys.push(this.map[strKeys[i]].key);return arrayIterator(keys)},MapPrototype.values=function(){for(var values=[],strKeys=Object.keys(this.map),i=0;i<strKeys.length;i++)values.push(this.map[strKeys[i]].value);return arrayIterator(values)},MapPrototype.forEach=function(cb,thisArg){for(var entry,strKeys=Object.keys(this.map),i=0;i<strKeys.length;i++)cb.call(thisArg,(entry=this.map[strKeys[i]]).value,entry.key,this)},MapPrototype.set=function(key,value){var keyValue=this.keyElem.verifyValue(key),valValue=this.valueElem.verifyValue(value);return this.map[this.keyElem.valueToString(keyValue)]={key:keyValue,value:valValue},this},MapPrototype.get=function(key){var keyValue=this.keyElem.valueToString(this.keyElem.verifyValue(key));if(keyValue in this.map)return this.map[keyValue].value},MapPrototype.has=function(key){return this.keyElem.valueToString(this.keyElem.verifyValue(key))in this.map},Map}(0,ProtoBuf.Reflect),ProtoBuf.loadProto=function(proto,builder,filename){return("string"==typeof builder||builder&&"string"==typeof builder.file&&"string"==typeof builder.root)&&(filename=builder,builder=void 0),ProtoBuf.loadJson(ProtoBuf.DotProto.Parser.parse(proto),builder,filename)},ProtoBuf.protoFromString=ProtoBuf.loadProto,ProtoBuf.loadProtoFile=function(filename,callback,builder){if(callback&&"object"==typeof callback?(builder=callback,callback=null):callback&&"function"==typeof callback||(callback=null),callback)return ProtoBuf.Util.fetch("string"==typeof filename?filename:filename.root+"/"+filename.file,function(contents){if(null!==contents)try{callback(null,ProtoBuf.loadProto(contents,builder,filename))}catch(e){callback(e)}else callback(Error("Failed to fetch file"))});var contents=ProtoBuf.Util.fetch("object"==typeof filename?filename.root+"/"+filename.file:filename);return null===contents?null:ProtoBuf.loadProto(contents,builder,filename)},ProtoBuf.protoFromFile=ProtoBuf.loadProtoFile,ProtoBuf.newBuilder=function(options){return void 0===(options=options||{}).convertFieldsToCamelCase&&(options.convertFieldsToCamelCase=ProtoBuf.convertFieldsToCamelCase),void 0===options.populateAccessors&&(options.populateAccessors=ProtoBuf.populateAccessors),new ProtoBuf.Builder(options)},ProtoBuf.loadJson=function(json,builder,filename){return("string"==typeof builder||builder&&"string"==typeof builder.file&&"string"==typeof builder.root)&&(filename=builder,builder=null),builder&&"object"==typeof builder||(builder=ProtoBuf.newBuilder()),"string"==typeof json&&(json=JSON.parse(json)),builder.import(json,filename),builder.resolveAll(),builder},ProtoBuf.loadJsonFile=function(filename,callback,builder){if(callback&&"object"==typeof callback?(builder=callback,callback=null):callback&&"function"==typeof callback||(callback=null),callback)return ProtoBuf.Util.fetch("string"==typeof filename?filename:filename.root+"/"+filename.file,function(contents){if(null!==contents)try{callback(null,ProtoBuf.loadJson(JSON.parse(contents),builder,filename))}catch(e){callback(e)}else callback(Error("Failed to fetch file"))});var contents=ProtoBuf.Util.fetch("object"==typeof filename?filename.root+"/"+filename.file:filename);return null===contents?null:ProtoBuf.loadJson(JSON.parse(contents),builder,filename)},ProtoBuf},"function"==typeof _dereq_&&"object"==typeof module&&module&&module.exports?module.exports=factory(_dereq_("bytebuffer")):(global.dcodeIO=global.dcodeIO||{}).ProtoBuf=factory(global.dcodeIO.ByteBuffer)}).call(this,_dereq_("_process"))},{_process:4,bytebuffer:2,fs:1,path:1}],6:[function(_dereq_,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var _pusherClient=_dereq_("./pusherClient");Object.keys(_pusherClient).forEach(function(key){"default"!==key&&"__esModule"!==key&&Object.defineProperty(exports,key,{enumerable:!0,get:function(){return _pusherClient[key]}})});var _pusherInterface=_dereq_("./pusherInterface");Object.keys(_pusherInterface).forEach(function(key){"default"!==key&&"__esModule"!==key&&Object.defineProperty(exports,key,{enumerable:!0,get:function(){return _pusherInterface[key]}})})},{"./pusherClient":7,"./pusherInterface":8}],7:[function(_dereq_,module,exports){"use strict";function Pusher(){this.topicsMessageConsumers={},this.connectionOpenHandlers=[],this.authToken="",this.url="",this.infoLogger=function(info){console.log(info)},this.errorLogger=function(error){console.log(error)},this.reconnectionDelayMin=1e4,this.reconnectionDelayMax=3e4,this.socket=null,this.authorized=!1,this.callback=function(){},this.duringConnection=!1,this.managedDisconnect=!1}Object.defineProperty(exports,"__esModule",{value:!0}),exports.PusherFactory=void 0;var obj,ProtoBuf=function(obj){if(obj&&obj.__esModule)return obj;var newObj={};if(null!=obj)for(var key in obj)Object.prototype.hasOwnProperty.call(obj,key)&&(newObj[key]=obj[key]);return newObj.default=obj,newObj}(_dereq_("protobufjs")),_bytebuffer=_dereq_("bytebuffer"),_bytebuffer2=(obj=_bytebuffer)&&obj.__esModule?obj:{default:obj},socket=void 0,gogPbProto=ProtoBuf.newBuilder({}).import({package:"gog.protocols.pb",messages:[{name:"Header",fields:[{rule:"required",type:"uint32",name:"sort",id:1},{rule:"required",type:"uint32",name:"type",id:2},{rule:"optional",type:"uint32",name:"size",id:3,options:{default:0}},{rule:"optional",type:"uint32",name:"oseq",id:4}],extensions:[[100,536870911]]},{name:"Response",fields:[],messages:[{ref:"Header",fields:[{rule:"optional",type:"uint32",name:"rseq",id:100},{rule:"optional",type:"Response.Code",name:"code",id:101,options:{default:"OK"}},{rule:"optional",type:"string",name:"description",id:102},{rule:"optional",type:"uint32",name:"retry_after",id:103}]}],enums:[{name:"Code",values:[{name:"UNKNOWN_RESPONSE",id:0},{name:"OK",id:200},{name:"ACCEPTED",id:202},{name:"BAD_REQUEST",id:400},{name:"UNAUTHORIZED",id:401},{name:"FORBIDDEN",id:403},{name:"NOT_FOUND",id:404},{name:"CONFLICT",id:409},{name:"INTERNAL_ERROR",id:500},{name:"NOT_IMPLEMENTED",id:501},{name:"UNAVAILABLE",id:503}]}]}]}).build(),pusherPbProto=ProtoBuf.newBuilder({}).import({package:"galaxy.protocols.pusher_service",options:{optimize_for:"LITE_RUNTIME"},messages:[{name:"AuthRequest",fields:[{rule:"required",type:"string",name:"auth_token",id:1}]},{name:"SubscribeTopicRequest",fields:[{rule:"required",type:"string",name:"topic",id:1}]},{name:"SubscribeTopicResponse",fields:[{rule:"required",type:"string",name:"topic",id:1}]},{name:"MessageFromTopic",fields:[{rule:"required",type:"string",name:"topic",id:1},{rule:"required",type:"string",name:"content",id:2},{rule:"optional",type:"uint64",name:"id",id:3}]}],enums:[{name:"MessageSort",values:[{name:"MESSAGE_SORT",id:2}]},{name:"MessageType",values:[{name:"UNKNOWN_MESSAGE",id:0},{name:"AUTH_REQUEST",id:1},{name:"AUTH_RESPONSE",id:2},{name:"SUBSCRIBE_TOPIC_REQUEST",id:3},{name:"SUBSCRIBE_TOPIC_RESPONSE",id:4},{name:"MESSAGE_FROM_TOPIC",id:5}]}]}).build(),gogPb=gogPbProto.gog.protocols.pb,pusherPb=pusherPbProto.galaxy.protocols.pusher_service,messagesHandler={decodeResponse:function(responseBuffer){if(!(responseBuffer instanceof ArrayBuffer))throw new Error("Wrong responseBuffer data",responseBuffer);var result={header:null,message:null},dataSize=responseBuffer.byteLength;if(dataSize<2)throw new Error("Message is too small",responseBuffer);var headerSize=(responseBuffer=_bytebuffer2.default.wrap(responseBuffer)).readUint16();if(dataSize<2+headerSize)throw new Error("Message is too small",responseBuffer);var header=void 0;try{(header=gogPb.Header.decode(responseBuffer.slice(2,2+headerSize)))[".gog.protocols.pb.Response.code"]&&(header.code=header[".gog.protocols.pb.Response.code"]),header[".gog.protocols.pb.Response.rseq"]&&(header.rseq=header[".gog.protocols.pb.Response.rseq"]),header[".gog.protocols.pb.Response.description"]&&(header.description=header[".gog.protocols.pb.Response.description"]),result.header=header}catch(e){throw new Error("Can`t decode header from response.")}if(header.sort!==pusherPb.MessageSort.MESSAGE_SORT)throw new Error("Invalid subprotocol",header.sort);if(0===header.size||dataSize<2+headerSize+header.size)return result;var messageType=this.resolveMessageClass(header.type);if(!messageType)throw new Error("Wrong message type");var messageStart=2+headerSize,messageEnd=messageStart+header.size;try{var message=pusherPb[messageType].decode(responseBuffer.slice(messageStart,messageEnd));result.message=message}catch(e){throw new Error("Can`t decode message from response")}return result},resolveMessageClass:function(messageType){switch(messageType){case pusherPb.MessageType.SUBSCRIBE_TOPIC_RESPONSE:return"SubscribeTopicResponse";case pusherPb.MessageType.MESSAGE_FROM_TOPIC:return"MessageFromTopic"}},createMessage:function(type,messageData){switch(type){case this.messageTypes.AUTH_REQUEST:return new pusherPb.AuthRequest(messageData);case this.messageTypes.SUBSCRIBE_TOPIC_REQUEST:return new pusherPb.SubscribeTopicRequest(messageData)}throw new Error("Wrong message type: "+type)},generateRequestSequenceNo:function(){return Math.floor(-8999999*Math.random()+9999999)},createRequest:function(type,messageData){var message=this.createMessage(type,messageData),header=new gogPb.Header({sort:pusherPb.MessageSort.MESSAGE_SORT,type:type,size:message.toArrayBuffer().byteLength,oseq:this.generateRequestSequenceNo()}),request=new _bytebuffer2.default;return request.writeUint16(header.toArrayBuffer().byteLength),request.append(header.toArrayBuffer()),request.append(message.toArrayBuffer()),request.clear(),request.toBuffer()},messageTypes:pusherPb.MessageType};Pusher.prototype.setReconnectionDelayBounds=function(minMs,maxMs){this.reconnectionDelayMin=minMs,this.reconnectionDelayMax=maxMs},Pusher.prototype.getReconnectionDelay=function(){return Math.floor(Math.random()*(this.reconnectionDelayMax-this.reconnectionDelayMin)+this.reconnectionDelayMin)},Pusher.prototype.logInfo=function(info){this.infoLogger(info)},Pusher.prototype.logError=function(error){this.errorLogger(error)},Pusher.prototype.addInfoLogger=function(logger){return this.infoLogger=logger,this},Pusher.prototype.addErrorLogger=function(logger){return this.errorLogger=logger,this},Pusher.prototype.addMessagesConsumerForTopic=function(topic,consumer){return this.topicsMessageConsumers[topic]=consumer,this._subscribeTopic(topic),this},Pusher.prototype._subscribeTopic=function(topic){this.authorized&&this.socket.send(messagesHandler.createRequest(messagesHandler.messageTypes.SUBSCRIBE_TOPIC_REQUEST,{topic:topic}))},Pusher.prototype.addConnectionOpenHandler=function(consumer){return this.connectionOpenHandlers.push(consumer),this},Pusher.prototype.reconnect=function(token){this.authToken=token,this.managedDisconnect=!1,this.logInfo({subject:"Pusher",message:"Try to reconnect"}),this.run.call(this,this.callback)},Pusher.prototype.disconnect=function(){this.authToken=null,this.managedDisconnect=!0,this.logInfo({subject:"Pusher",message:"Disconnect"}),this.socket&&this.socket.close()},Pusher.prototype.disconnectClient=function(){console.log("Disconnecting"),this.logInfo({subject:"Pusher",message:"Disconnect "}),this.socket&&this.socket.close()},Pusher.prototype.run=function(callback){function resolveAction(response){if(response.header){switch(response.header.type){case messagesHandler.messageTypes.AUTH_RESPONSE:return void function(response){if(200!==response.header.code)return callback(new Error("Can`t subscribe topic")),self.authorized=!1,void self.logError({subject:"Pusher",message:"Can`t authorize"});self.authorized=!0,Object.keys(self.topicsMessageConsumers).forEach(self._subscribeTopic.bind(self)),self.connectionOpenHandlers.forEach(function(handler){handler()})}(response);case messagesHandler.messageTypes.SUBSCRIBE_TOPIC_RESPONSE:return void function(response){200!==response.header.code?(callback(new Error("Can`t subscribe topic")),self.logError({subject:"Pusher",message:"Can`t subscribe topic"})):callback(null,!0)}(response);case messagesHandler.messageTypes.MESSAGE_FROM_TOPIC:return void function(response){200===response.header.code?(response.message.id=response.message.id.toString(),self.topicsMessageConsumers[response.message.topic](response.message)):self.logError({subject:"Pusher",message:"Problem with message coming from topic"})}(response)}self.logError({subject:"Pusher",message:"Can`t resolve received response"})}else self.logError({subject:"Pusher",message:"Incorrect response",data:response})}var self=this;!self.duringConnection&&self.authToken&&((socket=new WebSocket(this.url)).binaryType="arraybuffer",self.managedDisconnect=!1,self.socket=socket,self.duringConnection=!0,self.callback=callback,self.logInfo({subject:"Pusher",message:"Connected"}),socket.onopen=function(){var authRequest;self.duringConnection=!0,authRequest=messagesHandler.createRequest(messagesHandler.messageTypes.AUTH_REQUEST,{auth_token:self.authToken}),socket.send(authRequest)},socket.onmessage=function(msg){resolveAction(messagesHandler.decodeResponse(msg.data))},socket.onclose=function(){self.duringConnection=!1,self.socket=null,self.authorized=!1,callback(new Error("Pusher Disconnected")),self.logInfo({subject:"Pusher",message:"Disconnected"}),self.managedDisconnect?self.managedDisconnect=!1:window.setTimeout(function(){self.logInfo({subject:"Pusher",message:"Try to reconnect"}),self.run.call(self,callback)},self.getReconnectionDelay())},socket.onerror=function(error){self.duringConnection=!1,self.socket=null,self.authorized=!1,callback(new Error("Pusher Error")),self.logInfo({subject:"Pusher",message:error}),self.managedDisconnect?self.managedDisconnect=!1:window.setTimeout(function(){self.logInfo({subject:"Pusher",message:"Try to reconnect"}),self.run.call(self,callback)},self.getReconnectionDelay())})},exports.PusherFactory={createPusher:function(url,authToken){var pusher=new Pusher;return pusher.url=url,pusher.authToken=authToken,pusher}}},{bytebuffer:2,protobufjs:5}],8:[function(_dereq_,module,exports){"use strict";function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_pusherClient=_dereq_("./pusherClient"),PusherInterfaceProvider=function(){function PusherInterfaceProvider(){_classCallCheck(this,PusherInterfaceProvider),this.$get=["$rootScope","listenersManager",function(){for(var _len=arguments.length,args=Array(_len),_key=0;_key<_len;_key++)args[_key]=arguments[_key];return new(Function.prototype.bind.apply(PusherInterfaceService,[null].concat(args)))}]}return _createClass(PusherInterfaceProvider,[{key:"setLogger",value:function(serviceName){this.$get=["$rootScope","listenersManager",serviceName,function(){for(var _len2=arguments.length,args=Array(_len2),_key2=0;_key2<_len2;_key2++)args[_key2]=arguments[_key2];return new(Function.prototype.bind.apply(PusherInterfaceService,[null].concat(args)))}]}}]),PusherInterfaceProvider}(),PusherInterfaceService=function(){function PusherInterfaceService($rootScope,listenersManager){var loggerService=arguments.length>2&&void 0!==arguments[2]?arguments[2]:console;_classCallCheck(this,PusherInterfaceService),this._$rootScope=$rootScope,this._pusher=null,this._loggerService=loggerService,this._isHealthy=null,this._topicConsumers={},this._queuedTopicsForRegistration=[],this._connectionStatusListenersManager=listenersManager.getManager()}return _createClass(PusherInterfaceService,[{key:"connect",value:function(path,accessToken){var bearerAccessToken="Bearer "+accessToken;null===this._pusher?(this._pusher=_pusherClient.PusherFactory.createPusher(path,bearerAccessToken),this._pusher.addInfoLogger(angular.noop),this._pusher.addErrorLogger(angular.noop),this._pusher.run(this._monitorPusherConnection.bind(this)),this._registerQueuedTopics()):this._pusher.reconnect(bearerAccessToken)}},{key:"disconnect",value:function(){null!==this._pusher&&this._pusher.disconnect()}},{key:"setReconnectionDelayBounds",value:function(minMs,maxMs){this._pusher.setReconnectionDelayBounds(minMs,maxMs)}},{key:"getConnectionStatus",value:function(){return this._isHealthy}},{key:"registerConnectionStatusListener",value:function(listener){return this._connectionStatusListenersManager.addListener(listener)}},{key:"_monitorPusherConnection",value:function(pusherError){pusherError?this._setPusherHealth(!1):this._setPusherHealth(!0)}},{key:"_setPusherHealth",value:function(isPusherHealthy){this._isHealthy!==isPusherHealthy&&(this._isHealthy=isPusherHealthy,this._connectionStatusListenersManager.callListeners(this._isHealthy))}},{key:"registerTopicConsumer",value:function(topic,consumer){this._verifyTopicConsumer(topic),this._topicConsumers[topic].push(consumer)}},{key:"_verifyTopicConsumer",value:function(topic){Array.isArray(this._topicConsumers[topic])||(this._topicConsumers[topic]=[],this._registerTopicInPusher(topic))}},{key:"_getTopicConsumer",value:function(topic){return function(message){var _this=this;Array.isArray(this._topicConsumers[topic])&&this._$rootScope.$applyAsync(function(){for(var messageConsumerIndex in _this._topicConsumers[topic])try{_this._topicConsumers[topic][messageConsumerIndex](message)}catch(err){_this._loggerService.error(err)}})}.bind(this)}},{key:"_registerTopicInPusher",value:function(topic){null!==this._pusher?this._pusher.addMessagesConsumerForTopic(topic,this._getTopicConsumer(topic)):this._queuedTopicsForRegistration.push(topic)}},{key:"_registerQueuedTopics",value:function(){if(0!==this._queuedTopicsForRegistration.length){for(var topicIndex in this._queuedTopicsForRegistration)this._registerTopicInPusher(this._queuedTopicsForRegistration[topicIndex]);this._queuedTopicsForRegistration.length=0}}}]),PusherInterfaceService}();angular.module("gogModulePusherClient",[]).provider("pusherInterface",PusherInterfaceProvider)},{"./pusherClient":7}]},{},[6])(6)},module.exports=f()}});
</script>

</body>
</html>
