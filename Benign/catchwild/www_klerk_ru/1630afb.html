<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>1630afb.html</title>
</head>
<body>

<script>
(window.webpackJsonp=window.webpackJsonp||[]).push([[230,371],{1311:function(e,t,n){"use strict";function r(e){var t,n=!1;return function(){return n||(n=!0,t=e.apply(this,arguments),e=null),t}}n.d(t,"a",(function(){return r}))},2127:function(e,t,n){"use strict";n.r(t);var r=n(9),o=n(0),l=n(1),c=n(6),f=(n(17),n(26),n(16),n(27),n(75),n(5),n(1311)),d=Object(o.defineComponent)({name:"BaseSocialWidgetsLikes",inheritAttrs:!1,props:{likes:{type:Number,default:null},amILike:{type:Boolean,default:null},docId:{type:Number,default:null},topic:{type:Number,default:null},entityId:{type:Number,default:null},iconClasses:{type:String,default:null},counterClasses:{type:String,default:null}},setup:function(e,t){var n=t.emit,d=Object(r.d)(),v=d.$auth,k=d.$axios,h=Object(o.ref)(e.amILike),m=Object(o.ref)(!1),x=Object(o.ref)(),C=Object(o.ref)([]);Object(o.watch)((function(){return e.amILike}),(function(e){return h.value=e}));var y=function(){if(m.value)if(!m.value||h.value){var e={displayName:v.user.name,url:v.user.url,avatar:v.user.avatar,id:v.user.id};C.value=[].concat(Object(c.a)(C.value),[e])}else C.value=C.value.filter((function(e){return e.id!==v.user.id}))},w=Object(o.ref)(e.amILike&&!e.likes?1:e.likes),O=Object(f.a)(Object(l.a)(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,e.likes){t.next=3;break}return t.abrupt("return");case 3:return n={params:{entityId:e.entityId}},t.next=6,k.$get("/v4/entity-list/likes",n);case 6:C.value=t.sent,t.next=12;break;case 9:t.prev=9,t.t0=t.catch(0),console.log(t.t0);case 12:case"end":return t.stop()}}),t,null,[[0,9]])})))),S=function(){null!==w.value&&(h.value?w.value--:w.value++,h.value=!h.value)},j=function(){var t=Object(l.a)(regeneratorRuntime.mark((function t(){var r,data;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,v.user.confirm.email){t.next=4;break}return n("confirm-email"),t.abrupt("return");case 4:return S(),m.value||(m.value=!0),y(),r=h.value?"addvote":"delvote",data={action:r,doc_id:e.docId,topic:e.topic},t.next=11,k({baseURL:"/",url:"/poll_ajax/likejson/",method:"post",data:data});case 11:t.next=17;break;case 13:t.prev=13,t.t0=t.catch(0),S(),console.error(t.t0);case 17:case"end":return t.stop()}}),t,null,[[0,13]])})));return function(){return t.apply(this,arguments)}}();return{BASIC_ICON_CLASSES:"text-grey-300 group-hover:text-grey-400 group-focus-visible:text-grey-400",users:C,liked:h,likesCount:w,likeWidget:x,toggleLike:j,getLikedUsers:O}}}),v=d,k=n(59),component=Object(k.a)(v,(function(){var e=this,t=e._self._c;e._self._setupProxy;return t("CoreAuthRequired",{attrs:{"login-data":{title:"Войдите, чтобы поставить лайк"}},scopedSlots:e._u([{key:"default",fn:function(n){var r,o=n.withAuth;return[t("button",{directives:[{name:"tooltip",rawName:"v-tooltip",value:{content:"Нравится",duration:[300,50],onShow:function(){return!e.likesCount}},expression:"{\n      content: 'Нравится',\n      duration: [300, 50],\n      onShow: () => !likesCount,\n    }"}],ref:"likeWidget",staticClass:"flex group items-center gap-x-2 text-text-3 relative focus-visible:outline-none focus-visible:before:block focus-visible:before:bg-grey-200 focus-visible:before:opacity-30 focus-visible:before:-left-1.45 focus-visible:before:size-7 focus-visible:before:top-1/2 focus-visible:before:-translate-y-1/2 focus-visible:before:absolute focus-visible:before:rounded-full",attrs:{"aria-label":"Нравится","aria-expanded":"".concat(null!==(r=e.liked)&&void 0!==r&&r)},on:{click:function(t){return o(e.toggleLike,t)}}},[t("FontAwesomeIcon",{staticClass:"text-text-2 size-4",class:e.liked?"text-red-500":e.iconClasses||e.BASIC_ICON_CLASSES,attrs:{icon:"fa-solid fa-heart"}}),e._v(" "),e.likesCount?t("span",{class:e.counterClasses},[e._v(e._s(e.likesCount))]):e._e(),e._v(" "),e.likesCount&&e.likeWidget?t("ClientOnly",[t("BaseSocialWidgetsLikesDropdown",{attrs:{users:e.users,likes:e.likesCount,element:e.likeWidget,options:{interactive:!0,theme:"menu",onShow:e.getLikedUsers},"with-skeleton":""}})],1):e._e()],1)]}}])})}),[],!1,null,null,null);t.default=component.exports;installComponents(component,{BaseSocialWidgetsLikesDropdown:n(1618).default,CoreAuthRequired:n(628).default})},628:function(e,t,n){"use strict";n.r(t);var r={name:"CoreAuthRequired",props:{loginData:{type:Object,default:function(){}}},methods:{openAuthPage:function(e){e.preventDefault(),e.stopPropagation(),this.$auth.open.login(this.loginData)}},render:function(){var e=this;return this.$scopedSlots.default({withAuth:function(t,n){return e.$auth.loggedIn?t():e.openAuthPage(n)}})}},o=n(59),component=Object(o.a)(r,undefined,undefined,!1,null,null,null);t.default=component.exports}}]);
</script>

</body>
</html>
