<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SignUpForm.3b0b0ba0.html</title>
</head>
<body>

<script>
import"./index.6a5a335b.js";import{R as s}from"./index.8365acb2.js";import{g as W}from"./index.f5993dad.js";import{c as P}from"./client.56225896.js";import{a as _,d as R,b as T,c as M}from"./account_system.78c736b4.js";import{F as I}from"./Field_Addr.d2272776.js";import{j as e}from"./jsx-runtime.7d759e48.js";import{F as b,a as z}from"./Field_TPWD.1c1b3f95.js";import{f as D}from"./func_is_bad_account_username.d9223e73.js";import{u as Z}from"./useMutation.bcca56b6.js";async function G(c={},n=null){const r=W`
  mutation mut_account_signUp($email: String, $uname: String, $pass0: String, $passt: String) {
    mut_account_signUp(
      email: $email,
      uname: $uname,
      pass0: $pass0,
      passt: $passt,
    ) {
      err tof int
    }
  }
  `;return(await P().rawRequest(r,c)).data.mut_account_signUp}const v=R;function H(c){const{title:n="Username",errorCode:r=0,onBack_data:o=i=>{}}=c,d=`username-${s.useId()}`,[x,l]=s.useState(()=>"");s.useEffect(()=>{o(x)},[x]);function h(i){let u=i.target.value;u&&String(u).length>v&&(u=String(u).substring(0,v)),l(u)}return e.jsxs("div",{className:"form-control w-full space-y-1",children:[e.jsx("label",{htmlFor:d,className:"label",children:e.jsx("span",{className:"label-text text-base font-bold",children:n})}),e.jsx("input",{id:d,type:"text",className:"input input-bordered !outline-0",value:x,onChange:h}),r===11&&e.jsx("div",{className:"text-xs text-error",children:"username required"}),r===12&&e.jsxs("div",{className:"text-xs text-error",children:[_.len1.min_len,"-",_.len1.max_len," characters in length"]}),r===13&&e.jsx("div",{className:"text-xs text-error",children:"contain A-Z a-z 0-9 _ only"}),r===14&&e.jsx("div",{className:"text-xs text-error",children:"no continuous underscores"}),r===15&&e.jsxs("div",{className:"text-xs text-error",children:["maximum up to ",_.max_underscore," underscores"]}),r===16&&e.jsx("div",{className:"text-xs text-error",children:"cannot be a number"}),r===19&&e.jsx("div",{className:"text-xs text-error",children:"username is already taken"})]})}const J=_.len1.min_len,K=_.len1.max_len,O=T,Q=M;function ce(c){const[n,r]=s.useState(()=>"email");return e.jsx("fieldset",{className:"py-3 flex flex-col select-none space-y-5",children:e.jsx(V,{...c,byWhat:n})})}function V(c){const{byWhat:n,onBack_status:r=()=>{}}=c,[o,t]=s.useState(0),[d,x]=s.useState(""),[l,h]=s.useState(""),[i,u]=s.useState(""),[f,k]=s.useState(""),[j,w]=s.useState(""),[m,S]=s.useState(!0),[g,p]=s.useState("initial");s.useEffect(()=>{r(g)},[g]),s.useEffect(()=>{N()},[l]),s.useEffect(()=>{y()},[i,f]);function N(){if(n!=="uname"||!l)return t(0),!0;const a=D({str:l,minLen:J,maxLen:K,maxUnd:_.max_underscore});return a?(t(10+a),!1):(t(0),!0)}function y(){return n==="email"&&m||!i?(t(0),!0):String(i).length<O||String(i).length>Q?(t(124),!1):String(i).includes(" ")?(t(125),!1):f&&f!==i?(t(223),!1):(t(0),!0)}const B=Z(G,{onSuccess:a=>{if(a.err){switch(a.err){case"in_session":window.location.reload();return;case"email_registered":t(14);break;case"account_deleted":t(19);break;case"tempoary_password_incorrect":t(m?22:322);break;case"username_registered":t(19);break;case"email_empty":case"invalid_username":case"invalid_password":case"password_empty":case"bad_request":case"system_error":default:t(99);break}p("initial");return}if(a.tof===!0){p("success"),window.location.reload();return}t(99),p("initial")},onError:a=>{t(99),p("initial")}});function C(){if(n==="email"&&!d){t(11);return}if(n==="uname"&&!l){t(11);return}if(n==="uname"||!m){if(!i){t(121);return}if(!f){t(221);return}}if(n==="email"&&!j){t(321);return}if(!y())return;t(0),p("loading");const a={email:n==="email"?d:"",uname:n==="uname"?l:"",pass0:i,passt:n==="email"?j:""};B.mutate(a)}function F(a){x(a),t(0)}function $(a){h(a),t(0)}function U(a){u(a),t(0)}function A(a){k(a),t(0)}function E(a){w(a),t(0)}function q(a){t(a)}function L(a){S(!m)}return e.jsxs(e.Fragment,{children:[n==="uname"&&e.jsxs("div",{className:"px-2 py-1 bg-info text-info-content rounded",children:["Shadow user, only bookmarks and reading history functions are available, but can be converted to a fully functional account later via email verification.",e.jsx("div",{children:e.jsx("b",{children:"This type of account will be automatically deleted by the system if it is inactive for more than 365 days."})})]}),n==="email"?e.jsx(I,{errorCode:o,onBack_data:F}):e.jsx(H,{errorCode:o,onBack_data:$}),(n==="uname"||!m)&&e.jsxs(e.Fragment,{children:[e.jsx(b,{sn:1,errorCode:o,onBack_data:U,title:"Password"}),e.jsx(b,{sn:2,errorCode:o,onBack_data:A,title:"Password again"})]}),n==="email"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx(b,{sn:m?0:3,errorCode:o,onBack_data:E,title:"Temporary password",inputType:"text"}),e.jsx("div",{className:"form-control",children:e.jsxs("label",{className:"label justify-start space-x-1 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:m,className:"checkbox checkbox-xs",onChange:L}),e.jsx("span",{className:"label-text",children:"also set as my long-term password"})]})})]}),e.jsx(z,{addr:d,spread:!0,onBack_error:q})]}),o===99&&e.jsx("div",{className:"text-xs text-error",children:"System error, plase try again later."}),e.jsxs("button",{className:"btn btn-block btn-primary",onClick:C,children:[g==="loading"&&e.jsx("span",{className:"loading loading-spinner loading-xs"}),"Create My Account"]})]})}export{ce as S};

</script>

</body>
</html>
