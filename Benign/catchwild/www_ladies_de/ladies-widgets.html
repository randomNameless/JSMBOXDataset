<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ladies-widgets.html</title>
</head>
<body>

<script>
function Autocomplete(config){this.initConfig(config)}
Autocomplete.prototype={initConfig:function(config){this.config=config;if(this.config.elementsInput===undefined){throw 'Autocompletes elementsInput Variable muss in der Konfiguration definiert werden und auf ein Input-Feld verweisen'}
if(this.config.delay===undefined)
this.config.delay=600;if(this.config.minLength===undefined)
this.config.minLength=0;if(this.config.autoFocus===undefined)
this.config.autoFocus=!0;this.autocompleteInstance=null;this.exactTrefferFound=!1;this.inputSelected=!1;this.actualInputValue=null;this.currentSearchText='';this.focusedItem='';this.enterPressed=!1;this.showAlleRegionenList=!1},init:function(){this.initAutocomplete();this.registerEvents()},initAutocomplete:function(){var _this=this,autocompleteElements=$(this.config.elementsInput);if(!autocompleteElements.length||!autocompleteElements.autocomplete){return}
this.autocompleteInstance=autocompleteElements.autocomplete({delay:_this.config.delay,minLength:_this.config.minLength,autoFocus:_this.config.autoFocus,select:_this.select.bind(_this),source:_this.source.bind(_this),close:_this.close.bind(_this),change:_this.change.bind(_this),open:_this.open.bind(_this),search:_this.search.bind(_this),focus:_this.focus.bind(_this)});if(this.autocompleteInstance.data("autocomplete")){this.autocompleteInstance.data("autocomplete")._renderItem=this._renderItem.bind(this);this.autocompleteInstance.data("autocomplete")._renderMenu=this._renderMenu.bind(this)}
this.initSavedSuggestions()},initSavedSuggestions:function(){if(!siteConfig.locationSuggestions){siteConfig.locationSuggestions=[]}
if(siteConfig.locationSuggestions.constructor!==Array){var newSuggestionsArray=[];$.each(siteConfig.locationSuggestions,function(index,option){newSuggestionsArray.push(option)});siteConfig.locationSuggestions=newSuggestionsArray}},sourceLazy:function(request,response){return response(siteConfig.locationSuggestions)},source:function(request,response){console.error('Überschreibe source-Methode!');return response([])},select:function(event,ui){$(this.config.elementsInput).removeClass('autocomplete-open');console.error('Überschreibe select-Methode!')},close:function(event,ui){$(this.config.elementsInput).removeClass('autocomplete-open')},change:function(event,ui){},open:function(event,ui){},search:function(event,ui){},focus:function(event,ui){this.focusedItem=ui.item},_renderMenu:function(ul,items){var _this=this;$.each(items,function(index,item){_this._renderItem(ul,item)});$('.ui-autocomplete').addClass('active')},_renderItem:function(ul,item){var _this=this;if(_this.config.resultsElement){ul.appendTo($(_this.config.resultsElement))}
return $("<li></li>").data("item.autocomplete",item).append("<a>"+item.label+"</a>").appendTo(ul)},_updateRegioUrl:function(url,data){if(!data){data={}}
if(SiteInfo.isMobileVersion){$(document).trigger('updated.regio:Autocomplete',[data]);if('index'!==SiteInfo.controller){return}}
var _this=this;url=url.replace(/(\/)+/g,'$1');if('einzelansicht'===SiteInfo.controller&&!('filterUrl' in SiteInfo)){url=url.substr(0,url.lastIndexOf('/'))}
var controllerName='';if(typeof SiteInfo!='undefined'){controllerName=SiteInfo.controller||''}
if('anzeigenmarkt'===controllerName){url=_this.clearUrl(url)}
$(".regio-form").addClass('submit-disabled');location.href=url},registerEvents:function(){var _this=this;this._eventInputClicked();this._eventInputBlurred();this._eventInputChanged();this._eventFormSubmitted();this._eventEnterPressed()},_eventInputClicked:function(){var _this=this;$(this.config.elementsInput).click(function(e){if(SiteInfo.isMobileVersion&&SiteInfo.controller==='index'){Ladies.Main.jumpToScrollPoint($('.scrollpoint'))}
if(_this.inputSelected==!1){$(this).select();_this.inputSelected=!0}
$(this).autocomplete({source:_this.sourceLazy.bind(_this),autoFocus:!0,minLength:0,});$(this).autocomplete('search','')})},_eventInputBlurred:function(){var _this=this;$(this.config.elementsInput).blur(function(){_this.inputSelected=!1})},_eventInputChanged:function(){_this=this;$(this.config.elementsInput).bind('paste',function(e){_this._inputDataPasted(e)});$(this.config.elementsInput).on('keyup change propertychange paste input',this._inputDataChanged.bind(this))},_eventFormSubmitted:function(){if($(this.config.elementsForm).length){$(this.config.elementsForm).on('submit',this._formSubmitted.bind(this))}},_eventEnterPressed:function(){var _this=this;$('#regiosuche').keyup(function(e){if(e.keyCode==13||e.keyCode==108){_this._enterPressed(e)}})},_inputDataPasted:function(e){var _this=this;setTimeout(function(){$(_this.config.elementsInput).autocomplete('search',$(_this.config.elementsInput).val())},50)},_inputDataChanged:function(keyEvent){var _this=this,regioSearchElement=$(this.config.elementsInput);$(keyEvent.currentTarget).autocomplete({source:_this.source.bind(_this),minLength:2,autoFocus:!0,});if(regioSearchElement.val()===''){regioSearchElement.data('regioSlug',regioSearchElement.val());if(SiteInfo.isMobileVersion){$(document).trigger('updated.regio:Autocomplete',[{plz:'',slug:'',type:'overall',cleared:!0}])}}},_formSubmitted:function(keyEvent){keyEvent.preventDefault()},_enterPressed:function(keyEvent){},clearUrl:function(urlComplete){return urlComplete}};function AutocompleteLds(config){Autocomplete.call(this,config);this.filterDataCookie=new Cookie('clearFilterData',{path:'/',domain:SiteInfo.baseUri})}
AutocompleteLds.prototype=Object.create(Autocomplete.prototype);AutocompleteLds.prototype.constructor=AutocompleteLds;AutocompleteLds.prototype=$.extend(AutocompleteLds.prototype,{locationAjaxRequest:null,sourceLazy:function(request,response){if(!request.term){return response([])}
this.source(request,response)},source:function(request,response){var _this=this;this.cancelRequest();this.locationAjaxRequest=$.ajax({url:"/api/location/",data:{searchString:request.term,searchAddAlleRegionen:this.showAlleRegionenList},dataType:"json",error:function(){response([])},success:function(data){var locationForm=$('.regio-form');_this.currentSearchText=request.term;if(data.length==0){$(_this.config.elementsInput).removeClass('autocomplete-open')}
siteConfig.locationSuggestions=data;_this.initSavedSuggestions();if(data.length>0){locationForm.remove('submit-disabled')}
else{locationForm.addClass('submit-disabled')}
return response(siteConfig.locationSuggestions)}})},open:function(event){$('#regiosuche').trigger('change.value:Autocomplete',{instance:this,item:this.focusedItem,event:event,value:$("#regiosuche").val(),autoFocus:!0})},change:function(event,ui){$('#regiosuche').trigger('close.value:Autocomplete',{instance:this,event:event,item:this.focusedItem})},select:function(event,ui){var regioSearchElement=$("#regiosuche"),searchText=regioSearchElement.val(),fieldItem=ui.item,locationForm=$('.regio-form'),_this=this,exactMatchFound=!1;if(null!==this.focusedItem){Widgets.LocationSelector.regioSearchInput.val(fieldItem.value).data('regioSelected',fieldItem.value||'').data('regioSlug',fieldItem.slug.replace(' ','-').toLowerCase()||'').data('regioPostal',fieldItem.plz||'').data('regioLand',fieldItem.land||'').data('regioType',fieldItem.Type||'');locationForm.removeClass('submit-disabled');$(".ui-autocomplete").hide();regioSearchElement.removeClass('autocomplete-open');regioSearchElement.trigger('selected.item:Autocomplete',{instance:this,event:event,item:fieldItem});locationForm.submit()}
else{_this.enterPressed=!0;exactMatchFound=_this._redirectIfExactMatch(searchText,fieldItem.Name,fieldItem.Slug,fieldItem.Plz,fieldItem.Type,fieldItem.Land||null);if(!0===exactMatchFound){event.preventDefault();$(_this.config.elementsInput).data('regioSlug',fieldItem.Slug);$('.ui-autocomplete').hide();return!1}
else{$(_this.config.elementsInput).val(searchText);$(_this.config.elementsInput).autocomplete('search',searchText);event.preventDefault()}}},cancelRequest:function(){if(this.locationAjaxRequest&&'abort' in this.locationAjaxRequest){this.locationAjaxRequest.abort();this.locationAjaxRequest=null}},_redirectIfExactMatch:function(searchText,name,slug,plz,type,land){var _this=this,redirectUrl='',filterPath='',pageSlug=SiteInfo.redirectToPageSlug;if('index'===SiteInfo.controller){if(slug in SiteInfo.redirectToPageSlugSpecial){pageSlug=SiteInfo.redirectToPageSlugSpecial[slug]}
else if(type in SiteInfo.redirectToPageSlugSpecial){pageSlug=SiteInfo.redirectToPageSlugSpecial[type]}}
if('sex-anzeigen'===pageSlug){filterPath=this.buildFilterPart();if(filterPath.substring(0,1)!=='/'){filterPath='/'+filterPath}}
if(plz&&searchText===plz){_this.enterPressed=!1;if(SiteInfo.controller==='index'){this.filterDataCookie.expires=Cookie.prototype.getExpireDate(3600*24);this.filterDataCookie.value=1}
if(pageSlug&&pageSlug!=='home'){redirectUrl='/'+plz+'-'+slug+'/'+pageSlug+filterPath;_this._updateRegioUrl(redirectUrl,{plz:plz,slug:slug,type:type,land:land})}
else{redirectUrl='/'+plz+'-'+slug+filterPath;_this._updateRegioUrl(redirectUrl,{plz:plz,slug:slug,type:type,land:land})}
return!0}
else if(searchText===name.toLowerCase().trim()){_this.enterPressed=!1;if(SiteInfo.controller=='index'){this.filterDataCookie.expires=Cookie.prototype.getExpireDate(3600*24);this.filterDataCookie.value=1}
if(pageSlug&&pageSlug!=='home'){redirectUrl='/'+slug+'/'+pageSlug+filterPath;_this._updateRegioUrl(redirectUrl,{plz:'',slug:slug,type:type,land:land})}
else{redirectUrl='/'+slug+filterPath;_this._updateRegioUrl(redirectUrl,{plz:'',slug:slug,type:type,land:land})}
return!0}},_renderMenu:function(ul,items){var _this=this,currentCategory="",searchText=$(this.config.elementsInput).val().toLowerCase(),exactMatchFound=!1;$(_this.config.elementsInput).addClass('autocomplete-open');if(!0===_this.enterPressed){$.each(items,function(index,item){exactMatchFound=_this._redirectIfExactMatch(searchText,item.Name,item.Slug,item.Plz,item.Type);if(!0===exactMatchFound){$(_this.config.elementsInput).data('regioSlug',item.Slug);return!1}})}
if(!0===exactMatchFound){$('.ui-autocomplete').removeClass('active');return!1}
$.each(items,function(index,item){var li;items[index].label=item.Name;items[index].value=item.Name;items[index].slug=item.Slug;items[index].plz=item.Plz;items[index].land=item.Land;items[index].searchTerm=_this.currentSearchText;if(item.Category!=currentCategory){ul.append("<li class='ui-autocomplete-category'>"+item.Category+"</li>");currentCategory=item.Category}
li=_this._renderItem(ul,item);if(item.Category){li.attr("aria-label",item.Category+" : "+item.Name)}});$('.ui-autocomplete').addClass('active')},_renderItem:function(ul,item){var link=$("<a>"+item.Name+"</a>"),flag=$('<span class="location-flag '+item.Land+'"></span>');link.prepend(flag);return $("<li></li>").data("item.autocomplete",item).append(link).appendTo(ul)},_inputDataChanged:function(keyEvent){var locationForm=$('.regio-form'),disableSubmission=!0,regioSearchElement=$(this.config.elementsInput),searchText=regioSearchElement.val(),_this=this;if(/^[a-z0-9 \-äöüß]$/i.test(keyEvent.originalEvent.key)){this.focusedItem=null}
this.actualInputValue=searchText.toLowerCase();$('#regiosuche').trigger('change.value:Autocomplete',{instance:this,item:this.focusedItem,event:keyEvent,value:searchText,autoFocus:!1});$(keyEvent.currentTarget).autocomplete({source:_this.source.bind(_this),minLength:2,autoFocus:!0,value:regioSearchElement.val()});if(regioSearchElement.val()===''){regioSearchElement.data('regioSlug',regioSearchElement.val());if(SiteInfo.isMobileVersion){$(document).trigger('updated.regio:Autocomplete',[{plz:'',slug:'',type:'overall',cleared:!0}])}}
$(keyEvent.currentTarget).removeClass('current-location');$('#regio-vorschlaege').removeClass('keep-open');locationForm.removeClass('submit-disabled');if(''!==regioSearchElement.val()&&this.actualLocationName!==regioSearchElement.val()){$.each(siteConfig.locationSuggestions,function(index,option){if(searchText.toLowerCase()==option.Name.toLowerCase()){disableSubmission=!1;return!1}});if(disableSubmission){locationForm.addClass('submit-disabled')}}},_formSubmitted:function(keyEvent){var _this=this,formElement=$(keyEvent.currentTarget),searchText=$(this.config.elementsInput).val().toLowerCase(),selectedRegion=$(this.config.elementsInput).data('regioSelected'),exactMatchFound=!1;keyEvent.stopPropagation();keyEvent.preventDefault();if(formElement.hasClass('submit-disabled')){return}
var slug=$(this.config.elementsInput).data('regioSlug')||'',postalCode=$(this.config.elementsInput).data('regioPostal')||'',locationType=$(this.config.elementsInput).data('regioType')||'',locationLand=$(this.config.elementsInput).data('regioLand')||null,urlComplete='',pageSlug=SiteInfo.redirectToPageSlug,filterPath='';if('index'===SiteInfo.controller){if(slug in SiteInfo.redirectToPageSlugSpecial){pageSlug=SiteInfo.redirectToPageSlugSpecial[slug]}
else if(locationType in SiteInfo.redirectToPageSlugSpecial){pageSlug=SiteInfo.redirectToPageSlugSpecial[locationType]}}
$(this.config.elementsInput).removeClass('autocomplete-open');$(".ui-autocomplete").hide();if(_this.actualInputValue===''&&siteConfig.geoLocation!==''){urlComplete='/'+pageSlug;window.setTimeout(function(){$('#regiosuche').val('')},1);if(SiteInfo.controller==='index'){this.filterDataCookie.expires=Cookie.prototype.getExpireDate(3600*24);this.filterDataCookie.value=1}
if('sex-anzeigen'===pageSlug){filterPath=this.buildFilterPart();if(filterPath.substring(0,1)!=='/'){filterPath='/'+filterPath}
urlComplete+=filterPath;urlComplete=_this.clearUrl(urlComplete)}
_this._updateRegioUrl(urlComplete,{plz:postalCode,slug:slug,type:locationType,land:null});return}
if(''!==slug&&''!==$(this.config.elementsInput).val()){urlComplete='/';if(''!==postalCode){urlComplete+=postalCode+'-'}
urlComplete+=slug}
if('home'!==pageSlug||''===slug){urlComplete+='/'+pageSlug}
if(SiteInfo.controller==='index'){this.filterDataCookie.expires=Cookie.prototype.getExpireDate(3600*24);this.filterDataCookie.value=1}
if('sex-anzeigen'===pageSlug){filterPath=this.buildFilterPart();if(filterPath.substring(0,1)!=='/'){filterPath='/'+filterPath}
urlComplete+=filterPath;urlComplete=_this.clearUrl(urlComplete)}
_this._updateRegioUrl(urlComplete,{plz:postalCode,slug:slug,type:locationType,land:locationLand})},clearUrl:function(urlComplete){var queryString=urlComplete.split('?'),elements=[],newQueryStringArr=[];if(queryString[1]&&queryString[1]!==''){urlComplete=queryString[0];elements=queryString[1].split('&');for(var i in elements){var getElementArr=elements[i].split('='),getKey=getElementArr[0],getVal=getElementArr[1];if('suchtext'===getKey&&SearchConfig&&SearchConfig.filteredSearchText!=null){if(SearchConfig.filteredSearchText!==''){getVal=decodeURIComponent(SearchConfig.filteredSearchText);SearchConfig.filteredSearchText=null;newQueryStringArr.push(getKey+'='+getVal)}
else{continue}}
else if(['umkreis','page','strasse','hausnr','adresse'].indexOf(getKey)<0){newQueryStringArr.push(getKey+'='+getVal)}}}
if(newQueryStringArr.length>0){urlComplete=urlComplete+'?'+newQueryStringArr.join('&')}
return urlComplete},buildFilterPart:function(){var replaceSpecial,locationPlz;if('filterUrl' in SiteInfo){return SiteInfo.filterUrl}
replaceSpecial=new RegExp('('+Object.keys(SiteInfo.redirectToPageSlugSpecial).map(function(index){return SiteInfo.redirectToPageSlugSpecial[index]}).join('|')+')');locationPlz=''!==siteConfig.locationPlz?siteConfig.locationPlz+'-':'';return SiteInfo.requestUri.replace(SiteInfo.url,'').replace(SiteInfo.redirectToPageSlug,'').replace(replaceSpecial,'').replace('/'+locationPlz+siteConfig.locationSlug,'')},_enterPressed:function(keyEvent){$('.ui-autocomplete').removeClass('active');this.enterPressed=!0}});function AutocompleteVorschlagswerteLds(config){Autocomplete.call(this,config);this.config.anzeigenView.filterSearchTextChanged.attach(this.suchTextSubmitted.bind(this));this.config.abortAutocomplete=!1;this.results=[]}
AutocompleteVorschlagswerteLds.prototype=Object.create(Autocomplete.prototype);AutocompleteVorschlagswerteLds.prototype.constructor=AutocompleteVorschlagswerteLds;AutocompleteVorschlagswerteLds.prototype=$.extend(AutocompleteVorschlagswerteLds.prototype,{source:function(request,response){var _this=this;$.ajax({url:"/api/vorschlagswerte/",data:{searchString:request.term,slug:siteConfig.locationSlug},dataType:"json",error:function(){_this.results=[]
response(_this.results)},success:function(data){_this.results=data;return response(_this.results)}})},select:function(event,ui){var searchText=$(this.config.elementsInput).val(),fieldItem=ui.item,_this=this,exactMatchFound=!1,merkmalAdded=!1;$('#filter-freitext-button').attr('disabled',!0);if(fieldItem.F_Merkmal){merkmalAdded=_this.config.anzeigenView.setMerkmal(fieldItem)}
else if(fieldItem.F_Rubrik){var merkmalAdded=_this.config.anzeigenView.setRubrik(fieldItem)}
if(fieldItem.F_Name){var merkmalAdded=_this.config.anzeigenView.setName(fieldItem)}
if(fieldItem.F_Strasse){var merkmalAdded=_this.config.anzeigenView.setStrasse(fieldItem)}
if(fieldItem.F_Hausnr){var merkmalAdded=_this.config.anzeigenView.setHausnr(fieldItem)}
if(fieldItem.F_Tel){var merkmalAdded=_this.config.anzeigenView.setTelephone(fieldItem)}
_this.results=[];$(_this.config.elementsInput).val('').focus();return!1},initSavedSuggestions:function(){return},sourceLazy:function(request,response){return response(_this.results)},_renderMenu:function(ul,items){var _this=this,currentCategory="",searchText=$(this.config.elementsInput).val().toLowerCase(),exactMatchFound=!1;$(_this.config.elementsInput).addClass('autocomplete-open');$.each(items,function(index,item){var li;items[index].label=item.Label;li=_this._renderItem(ul,item)})},suchTextSubmitted:function(sender,args){$(_this.config.elementsInput).blur().focus()},_renderItem:function(ul,item){var _this=this;if(_this.config.resultsElement){ul.appendTo($(_this.config.resultsElement))}
return $("<li></li>").data("item.autocomplete",item).append("<a class='cut-text'>"+item.label+"</a>").appendTo(ul)},_inputDataChanged:function(keyEvent){var _this=this;$(keyEvent.currentTarget).autocomplete({source:_this.source.bind(_this),minLength:2,autoFocus:!0,});var keycode=(keyEvent.keyCode?keyEvent.keyCode:keyEvent.which);if(keycode=='13'&&!$('.vorschlagswerte-results .ui-autocomplete').is(':visible')){$('#filter-freitext-button').trigger("click")}},_formSubmitted:function(keyEvent){}});var PositionError=function(code,message){this.code=code||null;this.message=message||''};PositionError.prototype.PERMISSION_DENIED=PositionError.PERMISSION_DENIED=1;PositionError.prototype.POSITION_UNAVAILABLE=PositionError.POSITION_UNAVAILABLE=2;PositionError.prototype.TIMEOUT=PositionError.TIMEOUT=3;PositionError.prototype.REQUEST_TIMEOUT=PositionError.REQUEST_TIMEOUT=101;PositionError.prototype.GEOLOCATION_UNAVAILABLE=PositionError.GEOLOCATION_UNAVAILABLE=102;var GeoLocation=navigator.geolocation=navigator.geolocation||{};GeoLocation.isAvailable=function(){return(this['watchPosition']instanceof Function)};GeoLocation.getCurrentPositionUntil=function(timeout,success,error,options){var geoLocationTimeoutId,geoLocationWatchId,successCallback=success.bind(this),errorCallback=(function(){}).bind(this),positionError,watchAttempt=0;if(undefined!==error){errorCallback=error.bind(this)}
if(undefined!==options){options={}}
if(!this.isAvailable()){positionError=new PositionError(PositionError.GEOLOCATION_UNAVAILABLE,'The Geolocation API is unavailable in this browser');errorCallback(positionError)}
geoLocationTimeoutId=window.setTimeout(function(){positionError=new PositionError(PositionError.REQUEST_TIMEOUT,'The location request times out without user input');positionError.watchId=geoLocationWatchId;errorCallback(positionError)},timeout);geoLocationWatchId=navigator.geolocation.watchPosition(function(position){window.clearTimeout(geoLocationTimeoutId);position.attempt=++watchAttempt;position.watchId=geoLocationWatchId;successCallback(position)},function(positionError){window.clearTimeout(geoLocationTimeoutId);navigator.geolocation.clearWatch(geoLocationWatchId);errorCallback(positionError)},options)};var Widgets=Widgets||{};Widgets.LocationSelector=(function($,viewport)
{"use strict";function LocationSelector(){var init=this.init.bind(this);$(init)}
LocationSelector.prototype={selectedLocation:'',locationButton:null,lastWasAutoFocus:!1,disableLocationButton:function(){if(''===this.regioSearchInput.val()||''!==this.selectedLocation){return void this.enableLocationButton()}
this.locationButton.attr('disabled',!0)},enableLocationButton:function(){this.locationButton.prop('disabled',!1)},redirectOnValidAutocomplete:function(autocompleteEvent,eventData){if(!eventData){return}
var item=eventData.item||{},autocomplete=eventData.instance,locationType='ort',plz=!!item.Plz?item.Plz+'-':'',pageSlug='/'+SiteInfo.redirectToPageSlug,keepEnabled=eventData&&'change'===eventData.event.type&&this.lastWasAutoFocus;if(!keepEnabled&&''!==eventData.value&&autocomplete.actualInputValue===eventData.value&&!eventData.autoFocus){this.lastWasAutoFocus=!1;this.selectedLocation='';return void this.disableLocationButton()}
this.lastWasAutoFocus=eventData.autoFocus;if(!eventData.autoFocus&&''!==eventData.value&&item.value!==eventData.value){return}
if(''===eventData.value){this.selectedLocation='';return void this.enableLocationButton()}
if(''!==item.GebietsID){locationType='region'}
if(item.slug in SiteInfo.redirectToPageSlugSpecial){pageSlug='/'+SiteInfo.redirectToPageSlugSpecial[item.slug]}
if(locationType in SiteInfo.redirectToPageSlugSpecial){pageSlug='/'+SiteInfo.redirectToPageSlugSpecial[locationType]}
if('/home'===pageSlug){pageSlug=''}
this.selectedLocation=plz+item.slug+pageSlug;this.enableLocationButton()},changeSearchTextToActiveOption:function(autocompleteEvent,eventData){if(''===this.selectedLocation||!eventData.item){return}
this.regioSearchInput.val(eventData.item.label)},openLocationButtonLink:function(clickEvent){var buttonElement=$(clickEvent.currentTarget);clickEvent.stopImmediatePropagation();clickEvent.preventDefault();if(buttonElement.is('[disabled]')){return}
location.href=(''!==this.selectedLocation?SiteInfo.baseLink+this.selectedLocation:buttonElement.data('href'))}};LocationSelector.prototype.toggleElements=null;LocationSelector.prototype.regioSearchInput=null;LocationSelector.prototype.autoDenyTimer=0;LocationSelector.prototype.autoDenied=!1;LocationSelector.prototype.explicitlyDenied=!1;LocationSelector.prototype.requestUri='/api/location/';LocationSelector.prototype.retryHash='#geoRetry';LocationSelector.prototype.animationDuration='400';LocationSelector.prototype.regioSlideTimer=0;LocationSelector.prototype.inputSelected=!1;LocationSelector.prototype.actualLocationName='';LocationSelector.prototype.sourceData=function(request,response){var _this=this;$.ajax({url:"/api/location/",data:{searchString:request.term},dataType:"json",error:function(){response([])},success:function(data){if(data.length===0){$("#regiosuche").removeClass('autocomplete-open')}
siteConfig.locationSuggestions=data;if(siteConfig.locationSuggestions.constructor!==Array){var newSuggestionsArray=[];$.each(siteConfig.locationSuggestions,function(index,option){newSuggestionsArray.push(option)});siteConfig.locationSuggestions=newSuggestionsArray}
$('.regio-form').removeClass('submit-disabled');return response(siteConfig.locationSuggestions)}})};LocationSelector.prototype.sourceDataSuggested=function(request,response){return response(siteConfig.locationSuggestions)};LocationSelector.prototype.onSelect=function(event,ui){var fieldItem=ui.item,locationForm=$('.regio-form');Widgets.LocationSelector.regioSearchInput.val(fieldItem.value).data('regioSelected',fieldItem.value||'').data('regioSlug',fieldItem.slug.replace(' ','-').toLowerCase()||'').data('regioPostal',fieldItem.plz||'').data('regioLand',fieldItem.land||'');locationForm.removeClass('submit-disabled');$(".ui-autocomplete").hide();$("#regiosuche").removeClass('autocomplete-open');locationForm.submit()};LocationSelector.prototype.init=function(){$(window).on('open.regio-selector',this.togglePageContainer.bind(this));var _this=this,autocomplete=new AutocompleteLds({elementsInput:'#regiosuche',elementsForm:'.regio-form',});autocomplete.init();this.regioSearchInput=$('#regiosuche');this.locationButton=$('#button-search');this.emptySearchInput=$('#button-empty-location');this.actualLocationName=this.regioSearchInput.val();if('index'===SiteInfo.controller){this.locationButton.on('click',this.openLocationButtonLink.bind(this));this.regioSearchInput.on('input change focusout paste',this.disableLocationButton.bind(this)).on('change.value:Autocomplete',this.redirectOnValidAutocomplete.bind(this)).on('close.value:Autocomplete',this.changeSearchTextToActiveOption.bind(this))}
if(''!==this.actualLocationName){this.disableLocationButton()}
var modal=$('#fltRegio'),coordinatesButton=$('#button-get-coordinates'),reloadButtonSelector='#button-reload-site',toggleElements=['#regioauswahl','#regioclose'],_this=this;if(this.siteInfo().isIndex){toggleElements.unshift('#regiosuche')}
this.toggleElements=$(toggleElements.join(','));this.regionCallback=this.toggleLocationSelectorContainer.bind(this);this.locationCallback=this.requestGeoLocationInfo.bind(this);modal.on('hide.bs.modal',function(){autocomplete.cancelRequest();_this.regioSearchInput.val(SearchConfig&&'options' in SearchConfig&&SearchConfig.options.locationType!=='overall'?SearchConfig.locationName||'':'')});this.toggleElements.click(this.regionCallback);coordinatesButton.click(this.locationCallback);$(document).on('click',reloadButtonSelector,this.reloadPage.bind(this,!1));if(!!siteConfig.redirectToGeoLocation){Ladies.Main.changeUrl(history.state||{},'',location.href.replace('standort/',''));this.locationCallback()}
this.emptySearchInput.click(function(){_this.regioSearchInput.val('');_this.regioSearchInput.focus();setTimeout(function(){_this.enableLocationButton();if(SiteInfo.isMobileVersion){_this.regioSearchInput.data('regioSlug',_this.regioSearchInput.val());$(document).trigger('updated.regio:Autocomplete',[{plz:'',slug:'',type:'overall',cleared:!0}]);return}
autocomplete.showAlleRegionenList=!0;_this.regioSearchInput.autocomplete('search','alle regionen');autocomplete.showAlleRegionenList=!1},50)});this.toggleOverlayCallback=this.toggleLocationSuggestionOverlay.bind(this);this.regioSearchInput.on('focus',this.toggleOverlayCallback);$('#button-my-location').click(function(){$('#button-get-coordinates').click()});if(this.retryHash===location.hash){this.regionCallback();coordinatesButton.click()}
if(!_this.regioSearchInput.val()||'index'!==SiteInfo.controller){return}
_this.regioSearchInput.select();_this.regioSearchInput.autocomplete('search',_this.regioSearchInput.val())};LocationSelector.prototype.toggleLocationSuggestionOverlay=function(toggleEvent){var vorschlagCollapse=$('#ort-vorschlag'),doc=$(document);switch(toggleEvent.type){case 'focus':if(vorschlagCollapse.is('.collapse.in')){return}
doc.on('click',this.toggleOverlayCallback);vorschlagCollapse.collapse('show');break;default:var clickElement=$(toggleEvent.target);if(clickElement.closest('#page-regio-container').length>0){return}
doc.off('click',this.toggleOverlayCallback);if('undefined'!==typeof SearchConfig&&SearchConfig.filteredSearchText!=null){SearchConfig.filteredSearchText=null;Ladies.Anzeigenmarkt.controller.removeOptionsFromUrl(SearchConfig.options.suchTextOhneOrte)}
vorschlagCollapse.collapse('hide');break}};LocationSelector.prototype.toggleLocationSelectorContainer=function(clickEvent){if(this.siteInfo().isIndex){this.toggleIndexContainer.call(this,clickEvent)}
else{this.togglePageContainer.call(this,clickEvent)}};LocationSelector.prototype.toggleIndexContainer=function(clickEvent){if(!SiteInfo.isMobileVersion){var caller=$(clickEvent.currentTarget),clickElement=$(clickEvent.target),animationContainer=$('#regio-vorschlaege'),autoCompleteElement=$('.ui-autocomplete'),keepOpen=!1;this.stopEventBubbling(clickEvent);if(this.toggleElements.is(caller)){this.containerAnimation(animationContainer);this.clearToggleHandlers.call(this);$(document).on('click',this.regionCallback);caller.select()}
else{keepOpen=(this.toggleElements.is(clickElement)||animationContainer.is(clickElement)||animationContainer.has(clickElement).length>0||$('#button-get-coordinates').is(clickElement)||autoCompleteElement.is(clickElement)||autoCompleteElement.has(clickElement).length>0||animationContainer.hasClass('keep-open'));if(keepOpen){return}
this.containerAnimation(animationContainer,'hide','400');this.clearToggleHandlers.call(this);this.toggleElements.on('click',this.regionCallback)}}};LocationSelector.prototype.containerAnimation=function(element,type,speed){if(!element){return}
type=type||'show';speed=speed||'400';if(viewport.is('>=md')){element.stop().animate({width:type},speed,"swing")}
else{element.stop().animate({height:type},speed,"swing")
var indexBanner=$('.index-banner');if(indexBanner.length>0){if(type=='show'){indexBanner.stop().animate({opacity:0.05},speed)}
else{indexBanner.stop().animate({opacity:1},speed)}}}};LocationSelector.prototype.togglePageContainer=function(){var regioContainer=$("#page-regio-container"),regioMenu=$("#page-regio-toggle");if(!regioMenu.hasClass('active')){regioMenu.addClass("active");regioMenu.find("> .btn > span").addClass("flaticon-collapse3").removeClass("flaticon-expand22");regioContainer.stop().slideDown(this.animationDuration,null,function(){this.regioSearchInput.focus();this.regioSearchInput.select()}.bind(this));$('html, body').animate({scrollTop:regioContainer.offset().top},this.animationDuration)}
else{regioMenu.removeClass("active");regioMenu.find("> .btn > span").addClass("flaticon-expand22").removeClass("flaticon-collapse3");regioContainer.stop().slideUp(this.animationDuration);$('html, body').animate({scrollTop:0},this.animationDuration)}};LocationSelector.prototype.requestGeoLocationInfo=function(event,newFilterUrl){newFilterUrl=newFilterUrl||'';this.autoDenyTimer=new Date().getTime();var success=this.requestGeoLocationSuccess.bind(this,newFilterUrl),failure=event instanceof Function?event.bind(null,this.requestGeoLocationError.bind(this,!0),this.autoDenyTimer):this.requestGeoLocationError.bind(this,(undefined!==event)),options=this.geoLocationOptions();if(navigator.geolocation){if(this.siteInfo.isMobileDevice){options.enableHighAccuracy=!0}
navigator.geolocation.getCurrentPositionUntil(10000,success,failure,options)}};LocationSelector.prototype.requestGeoLocationSuccess=function(newFilterUrl,position){var minimumAccuracy=5,maxAttempts=5,latitude,longitude,redirectPage;if(undefined===window.keepModalOpen||!window.keepModalOpen){$('.modal:visible').modal('hide')}
if('pushState' in history){Ladies.Main.changeUrl("",document.title,location.pathname+location.search)}
if(this.siteInfo.isMobileDevice&&position.coords.accuracy>minimumAccuracy&&maxAttempts>position.attempt){return}
navigator.geolocation.clearWatch(position.watchId);$(document).trigger('location.request:geoLocation',{position:position});latitude=(position.coords.latitude).toFixed(8);longitude=(position.coords.longitude).toFixed(8);if(SiteInfo.isMobileVersion){redirectPage='redirectToPageSlug' in SiteInfo?SiteInfo.redirectToPageSlug:'anzeigenmarkt';location.href='/standort/setzen/?lat='+latitude+'&lon='+longitude+'&redirect='+redirectPage+'&filter-url='+encodeURIComponent(newFilterUrl)}
else{$.getJSON(this.requestUri+(latitude+','+longitude),{},this.applyNewLocationInformation.bind(this,newFilterUrl))}};LocationSelector.prototype.applyNewLocationInformation=function(newFilterUrl,data,status){var newLocation,filterUrl='',newLocationUrl,positionError,pageSlug;if('success'!==status){$(document).trigger('location.error:geoLocation',{status:status,data:data});return}
$(document).trigger('location.success:geoLocation',{status:status,data:data});if('object'!==typeof data['regio-staedte']||!data['regio-staedte'].length){positionError=new PositionError(PositionError.POSITION_UNAVAILABLE);this.requestGeoLocationError(null,positionError)}
newLocation=data['regio-staedte'][0];pageSlug=SiteInfo.redirectToPageSlug;if('string'===typeof newFilterUrl&&''!==newFilterUrl){filterUrl=newFilterUrl}
else if(SiteInfo.requestUri.indexOf(pageSlug)>=0){filterUrl=SiteInfo.requestUri.replace(SiteInfo.url,'')}
if('index'===SiteInfo.controller&&newLocation.Slug in SiteInfo.redirectToPageSlugSpecial){pageSlug=SiteInfo.redirectToPageSlugSpecial[newLocation.Slug]}
newLocationUrl='/'+newLocation.Slug+'/'+pageSlug+filterUrl;location.href=this.clearUrl(newLocationUrl)};LocationSelector.prototype.clearUrl=function(urlComplete){var queryString=urlComplete.split('?'),elements=[],newQueryStringArr=[],keepUmkreis=!1;if(queryString[1]&&queryString[1]!==''){urlComplete=queryString[0];elements=queryString[1].split('&');for(var i in elements){var getElementArr=elements[i].split('='),getKey=getElementArr[0],getVal=getElementArr[1];if('umkreis'===getKey&&'undefined'!==typeof SearchConfig){if(!SearchConfig.options){SearchConfig.options={}}
keepUmkreis=('umkreisLoaded' in SearchConfig.options&&!0===SearchConfig.options.umkreisLoaded);}
if(keepUmkreis||['umkreis','page','suchtext'].indexOf(getKey)<0){newQueryStringArr.push(getKey+'='+getVal)}}}
if(newQueryStringArr.length>0){urlComplete=urlComplete+'?'+newQueryStringArr.join('&')}
return urlComplete};LocationSelector.prototype.requestGeoLocationError=function(withTrigger,positionError){var geoCodeModal=$('#coordinates-modal').removeClass(this.removeGeoClasses),openModal;$(document).trigger('location.error:geoLocation',{error:positionError});switch(positionError.code){case positionError.PERMISSION_DENIED:var denyTimeTaken=new Date().getTime()-this.autoDenyTimer;if(!this.autoDenied&&denyTimeTaken<500){this.autoDenied=!0;if(!withTrigger){return}}
if(this.autoDenied||this.explicitlyDenied||this.retryHash===location.hash){Ladies.Main.openDialogModal('Für diese Funktion benötigst du die Standorterkennung oder den Ortungsdienst deines Gerätes! '+'<br/><br/>Bitte aktiviere diesen in deinen Einstellungen und versuche es noch einmal.'+'<br/><br/>Genauere Informationen zur Standorterkennung erhältst du von deinem Gerätehersteller.'+'<br/><br/><button type="button" class="btn btn-default col-xs-4 col-xs-offset-4" id="button-reload-site">Neu versuchen</button>','Problem bei Standorterkennung');if(undefined===history.replaceState){location.hash=this.retryHash}
else{Ladies.Main.changeUrl({},$(document).find("title").text(),this.retryHash)}
return}
this.explicitlyDenied=!0;this.infoPanel().displayMessage('Ihre Geo-Koordinaten wurden unterdrückt. Verwenden Sie zur Bestimmung\
					 Ihres Standortes bitte das Suchfeld für Ort oder Region.',this.infoPanel().Type.Info,7.5*1000);break;case positionError.POSITION_UNAVAILABLE:geoCodeModal.addClass('geo-unavailable').modal('show');break;case positionError.TIMEOUT:geoCodeModal.addClass('geo-gps-timeout').modal('show');break;case positionError.REQUEST_TIMEOUT:this.infoPanel().displayMessage('Bitte treffen Sie eine Auswahl, ob Sie mit der Ermittlung und\
					 Verwendung Ihres aktuellen Aufenthaltsort einverstanden sind.',this.infoPanel().Type.Info,7.5*1000);break;case positionError.GEOLOCATION_UNAVAILABLE:console.info('Error:','Unavailable');break;default:console.info('Error:','Unexpected');break}};LocationSelector.prototype.reloadPage=function(requiresPageReload){if(!requiresPageReload){this.requestGeoLocationInfo(this.reloadPage.bind(this,!0));return}
location.reload()};LocationSelector.prototype.stopEventBubbling=function(event){event.stopPropagation()};LocationSelector.prototype.clearToggleHandlers=function(){this.toggleElements.off('click',this.regionCallback);$(document).off('click',this.regionCallback)};LocationSelector.prototype.infoPanel=function(){return Widgets.InfoPanel};LocationSelector.prototype.removeGeoClasses=function(index,classes){return(classes.match(/geo-\S+/g)||[]).join(' ')};LocationSelector.prototype.siteInfo=function(){return SiteInfo};LocationSelector.prototype.label=function(){return label};LocationSelector.prototype.currentLocationSlug=function(){return currentLocationSlug};LocationSelector.prototype.geoLocationOptions=function(){return geoLocationOptions};return new LocationSelector()})(jQuery,ResponsiveBootstrapToolkit);var Widgets=Widgets||{};Widgets.StripeCore=(function($)
{"use strict";function StripeCore(){$(this.init.bind(this))}
StripeCore.prototype={moreButtonRootSelector:'.page-stripe',moreButtonBaseRowSelector:'.base-row',moreContainerSelector:'.more-container',moreButtonSelector:'.more-button',sessionStorageId:'',moreContainer:new Map(),moreStates:{},resetAllMoreStates:function(){try{window.sessionStorage.setItem(this.localStorageId,JSON.stringify({}))}
catch(e){return!1}},init:function(){this.sessionStorageId='states.stripe:page'+SiteInfo.requestUri;this.findMoreButtonsAndContainers();this.moreContainer.forEach(this.addMorePreSetContent.bind(this));this.initializeMoreStates();this.regenerateMoreStates()},findMoreButtonsAndContainers:function(){var moreButtons=$(this.moreButtonSelector),buttonCount=moreButtons.length,buttonIndex=0;if(!buttonCount){return}
for(;buttonIndex<buttonCount;buttonIndex++){var moreButton=$(moreButtons.get(buttonIndex)),moreButtonData=moreButton.data(),stripeRoot=moreButton.closest(this.moreButtonRootSelector),stripeBaseRow=stripeRoot.find(this.moreButtonBaseRowSelector),moreContainerElement=stripeRoot.find(this.moreContainerSelector),brokenButtonWarning=this.displayBrokenWarning.bind(this),moreContainer;if(!moreButtonData.ajaxUrl&&!moreContainerElement.length){this.moreContainer.set(moreButton,brokenButtonWarning);continue}
moreContainer=new this.MoreContainer();if(!moreContainerElement.length){moreContainer.bindToContainer(this.generateMoreContainer(stripeBaseRow)).addButtonEvent(moreButton);moreContainerElement=stripeRoot.find(this.moreContainerSelector)}
else{moreContainer.bindToContainer(moreContainerElement).addButtonEvent(moreButton)}
moreContainerElement.data('instance',moreContainer);this.moreContainer.set(moreButton.get(0),moreContainer);if(moreButton.data('allowSaveState')=='1'){moreContainer.container().on('show.more:transition',this.saveSectionIdToMoreStates.bind(this,moreContainer));moreContainer.container().on('close.more:transition',this.saveSectionIdToMoreStates.bind(this,moreContainer))}
moreContainer.container().on('close.more:transition',this.scrollToContainerTop.bind(this,moreContainer))}},generateMoreContainer:function(baseContainer){var moreContainer=$('<div />');moreContainer.addClass(this.moreContainerSelector.substr(1)).appendTo(baseContainer).addClass('col-xs-12');return moreContainer},addMorePreSetContent:function(more){if(!(more instanceof this.MoreContainer)){return}
var moreContainer=more.container(),moreContent=moreContainer.html().trim();if(''===moreContent){return}
if(!moreContainer.find('section.more-content').length){moreContainer.empty();more.addSection(moreContent,moreContainer.data('showSection')||!1)}},regenerateMoreStates:function(){for(var stateId in this.moreStates){if(!this.moreStates.hasOwnProperty(stateId)){continue}
var state=this.moreStates[stateId],stripe=$('#'+stateId),moreKey=stripe.find(this.moreButtonSelector),moreContainer=this.moreContainer.get(moreKey.get(0));if(typeof moreContainer!=='undefined'){moreContainer.openTo(state)}}},initializeMoreStates:function(){var moreStates=JSON.parse(window.sessionStorage.getItem(this.sessionStorageId));if(null===moreStates){moreStates={}}
this.moreStates=moreStates;$(document).on('click',this.moreButtonRootSelector+' > a',this.checkResetMoreStates.bind(this))},saveSectionIdToMoreStates:function(more,transitionEvent,lastSectionId){var stripeRoot=more.container().closest(this.moreButtonRootSelector);if(undefined!==lastSectionId){this.moreStates[stripeRoot.prop('id')]=lastSectionId}
else if(stripeRoot.prop('id')in this.moreStates){delete this.moreStates[stripeRoot.prop('id')]}
try{window.sessionStorage.setItem(this.sessionStorageId,JSON.stringify(this.moreStates))}
catch(e){return!1}},checkResetMoreStates:function(clickEvent){var moreStates=JSON.parse(window.sessionStorage.getItem(this.localStorageId)),clickElement=clickEvent.currentTarget,path=clickElement.pathname;if(null===moreStates||''===path||!$(clickElement).closest('nav').length){return!0}
if(undefined!==moreStates[path]){moreStates[path]={};try{window.sessionStorage.setItem(this.localStorageId,JSON.stringify(moreStates))}
catch(e){return!1}}
return!0},resetSingleState:function(path){var localStorageId='states.stripe:page'+location.pathname;var moreStates=JSON.parse(window.sessionStorage.getItem(localStorageId));if(null===moreStates){return!1}
if(undefined!==moreStates[path]){moreStates[path]={};try{window.sessionStorage.setItem(localStorageId,JSON.stringify(moreStates))}
catch(e){return!1}}
return!0},scrollToContainerTop:function(more){var scrollTo=more.container().closest(this.moreButtonRootSelector).offset().top;$('html, body').stop().animate({scrollTop:scrollTo},400,'easeOutCubic')},displayBrokenWarning:function(clickEvent){var clickElement=$(clickEvent.currentTarget);console.error('%cMore-Buttons [%c%s%c]:%c dieser Button hat keine hinterlegte Funktionalität, '+'oder es wurden keine weiteren Daten gefunden','color: #c00; font-weight: bold','color: #46e; font-style: italic',clickElement.data('id'),'color: #c00; font-style: normal','color: initial; font-weight: normal')}};return new StripeCore()})(jQuery);var Widgets=Widgets||{};Widgets.StripeCore.MoreContainer=(function($){"use strict";function MoreContainer(container){this.sectionData=[];this.moreAjaxCount=0;if(undefined!==container){this.bindToContainer(container)}}
MoreContainer.prototype={containerElement:null,buttonElement:null,sectionData:null,rootSelector:'.page-stripe',sectionSelector:'.more-content',openSectionRootClass:'more-is-open',displaySectionClass:'show',moreAjaxCount:0,ajaxUrl:'',ajaxParams:null,bindToContainer:function(container){if(null!==this.containerElement&&this.sectionData.length>0){this.removeSectionsFromOldContainer(this.containerElement)}
this.containerElement=container;if(this.sectionData.length>0){this.appendSectionsToContainer()}
return this},container:function(){return this.containerElement},updateAjaxParams:function(){this.ajaxParams=this.buttonElement.data('ajaxParams');if(this.ajaxParams.moreCount>0){this.moreAjaxCount=this.ajaxParams.moreCount}},addButtonEvent:function(buttonElement){if(null!==this.buttonElement){this.buttonElement.off('click',this.showNextContentSectionOrClose.bind(this,1))}
this.buttonElement=buttonElement;this.buttonElement.on('click',this.showNextContentSectionOrClose.bind(this,1));if(this.buttonElement.data('ajaxUrl')){this.ajaxUrl=this.buttonElement.data('ajaxUrl');this.updateAjaxParams()}
return this},button:function(){return this.buttonElement},addSection:function(sectionContent,showSection){var sectionFragment=document.createDocumentFragment(),content=$('<section />'),sectionCount=this.sectionData.length;content.addClass(this.sectionSelector.substr(1)+' row section-'+(++sectionCount)).html(sectionContent);if(showSection=='1'){content.addClass('show')}
content.appendTo(sectionFragment);this.sectionData.push(sectionFragment);if(null!==this.containerElement){this.containerElement.append(sectionFragment)}
$(document).trigger('added.more:section',[this]);return this},openTo:function(step){this.showNextContentSectionOrClose(step)},removeSectionsFromOldContainer:function(oldContainer){for(var section in this.sectionData){if(!this.sectionData.hasOwnProperty(section)){continue}
oldContainer.find(section).remove()}},appendSectionsToContainer:function(){for(var section in this.sectionData){if(!this.sectionData.hasOwnProperty(section)){continue}
this.containerElement.append(section)}},showNextContentSectionOrClose:function(amount,clickEvent){if(undefined!==clickEvent){clickEvent.preventDefault()}
if(!amount){amount=1}
var openInstant=!clickEvent,sections=this.containerElement.find('section'+this.sectionSelector),hiddenSections=sections.filter(':hidden');if(!this.moreAjaxCount&&!hiddenSections.length){this.closeContainerAndHideSections(sections);return}
if(this.moreAjaxCount>0){this.fetchMoreAjaxData(amount,openInstant)}
else{this.showSectionsAndCalculateHeight(hiddenSections.slice(0,amount),openInstant)}},showSectionsAndCalculateHeight:function(sections,instant,ajaxData){var currentHeight=this.containerElement.height(),newHeight,sectionCount,sectionIndex=0;if(ajaxData){ajaxData.wasAjaxRequest=!1}
if(!sections.length){return}
this.containerElement.removeClass('quick-open');if(!instant){this.containerElement.css('height',currentHeight)}
newHeight=(0+currentHeight);sections.addClass(this.displaySectionClass);for(sectionCount=sections.length;sectionIndex<sectionCount;sectionIndex++){newHeight+=$(sections.get(sectionIndex)).outerHeight()}
var lastSectionId=sections.last().prop('class').match(/section-(\d+)/i).pop();window.setTimeout(function(){if(!instant){this.containerElement.off('transitionend');this.containerElement.one('transitionend',function(sectionId){window.setTimeout(function(){$(document).trigger('shown.more:transition',[this]);this.containerElement.trigger('shown.more:transition',[parseInt(sectionId,10)]).addClass('quick-open').css('height','auto')}.bind(this),15)}.bind(this,lastSectionId))}
else{newHeight='auto'}
$(document).trigger('show.more:transition',[this,ajaxData]);this.containerElement.trigger('show.more:transition',[parseInt(lastSectionId,10),ajaxData]).css('height',newHeight);if(!this.containerElement.find('section'+this.sectionSelector+':hidden').length&&!this.moreAjaxCount){this.containerElement.closest(this.rootSelector).addClass(this.openSectionRootClass)}}.bind(this),15)},closeContainerAndHideSections:function(sections){var currentHeight=this.containerElement.height();if(this.ajaxParams){this.ajaxParams.wasAjaxRequest=!1}
this.containerElement.removeClass('quick-open');this.containerElement.css('height',currentHeight);this.containerElement.closest(this.rootSelector).removeClass(this.openSectionRootClass);window.setTimeout(function(){this.containerElement.off('transitionend');this.containerElement.one('transitionend',function(sectionsToHide){var sectionCount,sectionIndex=0;for(sectionCount=sectionsToHide.length;sectionIndex<sectionCount;sectionIndex++){$(sectionsToHide.get(sectionIndex)).removeClass(this.displaySectionClass)}
$(document).trigger('closed.more:transition',[this]);this.containerElement.trigger('closed.more:transition')}.bind(this,sections));$(document).trigger('close.more:transition',[this]);this.containerElement.trigger('close.more:transition').css('height',0)}.bind(this),15)},fetchMoreAjaxData:function(fetchCount,instant){this.buttonElement.addClass('loading');this.ajaxParams.jumpTo=fetchCount;this.ajaxParams.wasAjaxRequest=!0;$.get(this.ajaxUrl,this.ajaxParams).done(this.addAjaxSectionDataOnSuccess.bind(this,fetchCount,instant)).error(this.displayAjaxErrorWarning.bind(this))},addAjaxSectionDataOnSuccess:function(fetchCount,instant,moreData,ajaxStatus,xhr){this.buttonElement.removeClass('loading');if('success'!==ajaxStatus||200!==xhr.status){this.displayAjaxErrorWarning();return}
var ajaxData=JSON.parse(moreData),ajaxDataIndex=0,ajaxDataCount,sections,hiddenSections,sectionData=[];for(var dataKey in ajaxData){if(!ajaxData.hasOwnProperty(dataKey)||isNaN(dataKey)){continue}
sectionData.push(ajaxData[dataKey])}
ajaxDataCount=sectionData.length;this.moreAjaxCount-=fetchCount;this.ajaxParams.moreCount=this.moreAjaxCount;for(;ajaxDataIndex<ajaxDataCount;ajaxDataIndex++){this.addSection(sectionData[ajaxDataIndex])}
sections=this.containerElement.find('section'+this.sectionSelector);hiddenSections=sections.filter(':hidden');this.showSectionsAndCalculateHeight(hiddenSections.slice(0,fetchCount),instant,ajaxData)},displayAjaxErrorWarning:function(){console.error('%cMore-Buttons [%c%s%c] - AJAX:%c die Anfrage konnte nicht '+'erfolgreich abgeschlossen werden','color: #c00; font-weight: bold','color: #46e; font-style: italic',this.containerElement.closest(this.rootSelector).prop('id'),'color: #c00; font-style: normal','color: initial; font-weight: normal')}};return MoreContainer})(jQuery);var Utilities=Utilities||{};Utilities.InfoPanel=Utilities.InfoPanel||{};Utilities.InfoPanel.Message=(function($)
{"use strict";function Message(type,title,message,duration){this.type=type;this.title=title;this.duration=duration;this.messages=[{message:message,added:!1}]}
Message.prototype={type:null,title:null,messages:[],duration:null,wrapper:'<span class="message-line" />',addMessage:function(message){this.messages.unshift({message:message,added:!1})},message:function(){var notShownMessages=[],index;for(index=0;index<this.messages.length;++index){if(!0===this.messages[index].added){continue}
this.messages[index].added=!0;notShownMessages.unshift($(this.wrapper).prop('id',this.type+'-line-'+(this.messages.length-index)).html(this.messages[index].message).prop('outerHTML'))}
return notShownMessages.join('\n')},messageList:function(){return this.messages.slice(0)}};return Message})(jQuery);var Utilities=Utilities||{};Utilities.InfoPanel=Utilities.InfoPanel||{};Utilities.InfoPanel.MessageQueue=(function()
{"use strict";function MessageQueue(){}
MessageQueue.prototype={items:[],addMessage:function(type,title,message,duration){this.items.push(new Utilities.InfoPanel.Message(type,title,message,duration))},alterMessage:function(index,message){this.items[index].addMessage(message)},popMessage:function(){return(this.isEmpty()?undefined:this.items.shift())},peekNextMessage:function(){return(this.isEmpty()?undefined:this.items[0])},emptyItems:function(){this.items=[]},countItems:function(){return this.items.length},findItem:function(type,title,duration){var index=!1;if(undefined===type||undefined===title||undefined===duration){return!1}
this.items.forEach(function(item,itemNumber){if(type!==item.type||title!==item.title||duration!==item.duration){return}
index=itemNumber});return index},isEmpty:function(){return!this.countItems()},itemExists:function(index){return undefined!==this.items[index]}};return MessageQueue})();var Widgets=Widgets||{};Widgets.InfoPanel=(function($)
{"use strict";function InfoPanel(){$(this.init.bind(this))}
InfoPanel.prototype={Type:{Info:'info',Warning:'warning',Error:'danger',Success:'success',Star:'star',},base:null,container:null,circleTimer:null,title:null,content:null,progressBar:null,hideMessageTimeout:null,isWindowFocused:!0,maxDisplayMessagesCount:1,queue:{instance:null,running:!1},timer:{id:-1,defaultRunTime:3000,currentRunTime:0,displayUntil:0},displayMessage:function(message,type,duration,title){var messageType=type||this.Type.Info,messageTitle=title||'',messageDuration=duration||this.timer.defaultRunTime,existingMessageKey;existingMessageKey=this.queue.instance.findItem(messageType,messageTitle,messageDuration);if(!1!==existingMessageKey){this.queue.instance.alterMessage(existingMessageKey,message);if(0===existingMessageKey&&this.queue.running){this.restartMessageQueue()}}
else{this.queue.instance.addMessage(messageType,messageTitle,message,messageDuration)}
if(!this.queue.running){this.runMessageQueue()}},init:function(){this.queue.instance=new Utilities.InfoPanel.MessageQueue();this.base=$('#info-panel');this.container=this.base.find('.panel');this.content=this.container.find('.panel-body');this.progressBar=this.container.find('.timer-bar');this.circleTimer=new Utilities.CircularTimer('info-panel-timer');if('hasFocus' in document&&!document.hasFocus()){this.isWindowFocused=!1}
this.base.on('click','.panel-close',this.hideMessage.bind(this));this.base.on('mouseenter',this.pauseMessageQueue.bind(this));this.base.on('mouseleave',this.runMessageQueue.bind(this));$(window).focus(this.windowGainsFocus.bind(this));$(window).blur(this.windowLosesFocus.bind(this));window.setTimeout(this.checkForSessionMessage.bind(this),100)},runMessageQueue:function(){var currentMessage;if(this.queue.instance.isEmpty()){return}
this.queue.running=!0;currentMessage=this.queue.instance.peekNextMessage();this.timer.currentRunTime=currentMessage.duration;this.circleTimer.animationDuration(currentMessage.duration/1000);this.container.queue('messageQueue',[this.showMessage.bind(this,currentMessage),this.runQueueTimer.bind(this),this.runMessageQueue.bind(this)]);this.container.dequeue('messageQueue')},pauseMessageQueue:function(){if(Utilities.canAnimate){this.circleTimer.stopTimer()}
this.content.find('.message-line').each(function(){if(undefined!==$(this).data('timerId')){$(this).removeClass('fading');window.clearTimeout($(this).data('timerId'))}});if(this.timer.id>=0){this.clearProgressTimer()}
this.queue.running=!1},restartMessageQueue:function(){this.container.clearQueue('messageQueue');if(Utilities.canAnimate){this.circleTimer.stopTimer();window.setTimeout(this.runMessageQueue.bind(this),100);return}
if(this.timer.id>=0){this.clearProgressTimer()}
this.queue.running=!1},runQueueTimer:function(){if(this.isWindowFocused){if(!Utilities.canAnimate){this.timer.displayUntil=new Date().getTime()+this.timer.currentRunTime;this.timer.id=window.setInterval(this.updateProgress.bind(this),10);$('#info-panel-timer').addClass('no-animation');return}
if(this.content.find('.message-line').length>1){this.circleTimer.stopTimer();this.fadeOutMessageLine();return}
this.circleTimer.startTimer(function(){this.clearProgressTimer();this.hideMessage()}.bind(this));return}
window.setTimeout(this.runQueueTimer.bind(this),50)},updateProgress:function(){var currentTime=new Date().getTime(),timeDifference=(this.timer.displayUntil-currentTime),progress=100-(timeDifference/this.timer.currentRunTime*100);if(this.content.find('.message-line').length>1){this.fadeOutMessageLine();return}
if(progress>100){progress=100}
this.changeProgressDisplay(progress);if(100===progress){this.clearProgressTimer();this.hideMessage()}},fadeOutMessageLine:function(){var multiLines,lineIndex=0,lineCount,currentLine,fadeTime=this.timer.currentRunTime/2,fadeDelay;if(!this.progressBar.data('fading')){this.progressBar.data('fading',!0);this.resetProgressDisplay()}
multiLines=this.content.find('.message-line').slice(1).not('.fading');lineCount=multiLines.length;for(;lineIndex<lineCount;++lineIndex){fadeDelay=(lineCount-lineIndex-1)*(fadeTime-this.timer.currentRunTime/10);currentLine=$(multiLines[lineIndex]);currentLine.addClass('fading');currentLine.data('timerId',window.setTimeout(this.hideLine.bind(this,currentLine),fadeTime+fadeDelay))}},changeProgressDisplay:function(progress){this.progressBar.css({width:(progress+'%'),opacity:1})},resetProgressDisplay:function(){this.progressBar.animate({opacity:0},250,function(){this.changeProgressDisplay.bind(this,0);this.progressBar.data('fading',!1)}.bind(this))},clearProgressTimer:function(){window.clearInterval(this.timer.id);this.timer.id=-1},showMessage:function(messageData){if(null!==this.hideMessageTimeout){window.clearTimeout(this.hideMessageTimeout);this.hideMessageTimeout=null}
this.container.removeClass(this.removeIconClasses).addClass('icon-'+messageData.type);this.content.prepend(messageData.message());if(this.content.find('.message-line').length>this.maxDisplayMessagesCount){this.content.find('.message-line').slice(this.maxDisplayMessagesCount).remove()}
this.base.addClass('in inner');this.container.dequeue('messageQueue')},checkForSessionMessage:function(){var message=window.sessionStorage.getItem('displayInfoPanel'),messageData;if('string'!==typeof message){return}
messageData=JSON.parse(message);window.sessionStorage.removeItem('displayInfoPanel');if(!messageData.type){messageData.type=this.Type.Info}
if(!messageData.duration){messageData.duration=this.timer.defaultRunTime}
if(!messageData.title){messageData.title=null}
this.displayMessage(messageData.message,messageData.type,messageData.duration,messageData.title)},hideMessage:function(){let currentMessage=this.queue.instance.peekNextMessage();if(''!==currentMessage.title){$(document).trigger('hide.InfoPanel:Message',[currentMessage.title])}
this.queue.instance.popMessage();this.base.removeClass('inner');if(this.queue.instance.isEmpty()){this.queue.running=!1;this.base.removeClass('in')}
this.hideMessageTimeout=window.setTimeout(this.nextQueueItem.bind(this),500)},hideLine:function(line){line.stop().animate({opacity:0},250,function(){this.timer.displayUntil=new Date().getTime()+this.timer.currentRunTime;line.remove();if(this.timer.id<0&&this.queue.running){window.setTimeout(this.runQueueTimer.bind(this),1)}}.bind(this))},nextQueueItem:function(){this.changeProgressDisplay(0);this.content.empty();this.container.dequeue('messageQueue')},windowGainsFocus:function(){this.isWindowFocused=!0;this.runMessageQueue()},windowLosesFocus:function(){this.pauseMessageQueue();this.isWindowFocused=!1},removeIconClasses:function(index,classes){return(classes.match(/icon-\S+/g)||[]).join(' ')}};return new InfoPanel()})(jQuery)
</script>

</body>
</html>
