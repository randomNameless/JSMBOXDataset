<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>bmwusa-globalnav-primary-find-dealer.html</title>
</head>
<body>

<script>
/*! BMWUSA Vite Build 1731603678170 */
import{C as n}from"/etc.clientlibs/bmwusa/clientlibs/clientlib-site/bmwusa-clientlibs/bmwusa-chunks/resources/component.js";import{V as d}from"/etc.clientlibs/bmwusa/clientlibs/clientlib-site/bmwusa-clientlibs/bmwusa-chunks/resources/validator.js";import{h as a}from"/etc.clientlibs/bmwusa/clientlibs/clientlib-site/bmwusa-clientlibs/bmwusa-measurement-data.js";import"/etc.clientlibs/bmwusa/clientlibs/clientlib-site/bmwusa-clientlibs/bmwusa-chunks/resources/index.js";import"/etc.clientlibs/bmwusa/clientlibs/clientlib-site/bmwusa-clientlibs/bmwusa-chunks/resources/index.esm.js";import"/etc.clientlibs/bmwusa/clientlibs/clientlib-site/bmwusa-clientlibs/bmwusa-chunks/resources/is-author.js";import"/etc.clientlibs/bmwusa/clientlibs/clientlib-site/bmwusa-clientlibs/bmwusa-chunks/resources/baseDomain.js";import"/etc.clientlibs/bmwusa/clientlibs/clientlib-site/bmwusa-clientlibs/bmwusa-chunks/resources/getbyourl.js";import"/etc.clientlibs/bmwusa/clientlibs/clientlib-site/bmwusa-clientlibs/bmwusa-chunks/resources/scroll-to.js";import"/etc.clientlibs/bmwusa/clientlibs/clientlib-site/bmwusa-clientlibs/bmwusa-chunks/resources/uid.js";import"/etc.clientlibs/bmwusa/clientlibs/clientlib-site/bmwusa-clientlibs/bmwusa-chunks/resources/zipcode.js";new n({el:".globalnav-primary-find-dealer",name:"globalnav-primary-find-dealer Component",currentBreakpoint:window.innerWidth<768?"mobile":window.innerWidth>960?"desktop":"tablet",baseStr:"globalnav-primary-find-dealer",subscriptions:{"window.resizeEnd":"resizeEvt","nav.toggleMyBMW":"toggleMyBMW","fill.clicked":"closeZip","zip.update":"dealerUpdate","my-bmw.open":"closeZip"},dealerIsSet:!1,changeCopy:!1,mobileHasRun:!1,logoStr:"globalnav-primary__BMW-logo-holder",init(){this.dealerData=a.getDealerInfo(),this.dealer=this.element.querySelector(`${this.el}__find-dealer`),this.dealerBar=this.element.querySelector(`${this.el}__bar`),this.findDealer=this.element.querySelector(`${this.el}__set-dealer`),this.dealerInfo=this.element.querySelector(`${this.el}__dealer-set`),this.editBtn=this.element.querySelector(`${this.el}__zip-change`),this.zip=this.element.querySelector(`${this.el}__zip-holder`),this.cancel=this.element.querySelector(`${this.el}__zip-cancel`),this.zipForm=this.element.querySelector(`${this.el}__zip`),this.zipInput=this.zipForm.querySelector("input"),this.error=this.element.querySelector(`${this.el}__zip-error`),this.dealerLocation=this.element.querySelector(`${this.el}__location`),this.dealerName=this.element.querySelector(`${this.el}__name`),this.dealerData=a.isDealerSet(),this.loader=this.element.querySelector(`${this.el}__loader`),this.errorIcon=this.element.querySelector(`${this.el}__zip-error-icon`),this.editBtnMobile=this.element.querySelector(`${this.el}__mobile-arrow`),this.logo=document.querySelector(`.${this.logoStr}`),this.showZip=this.showZip.bind(this),this.closeZip=this.closeZip.bind(this),this.submitForm=this.submitForm.bind(this),this.toggleZip=this.toggleZip.bind(this),this.dealerUpdate=this.dealerUpdate.bind(this),this.zipForm.addEventListener("submit",this.submitForm),this.cancel.addEventListener("click",this.closeZip),this.currentBreakpoint!=="desktop"?(this.mobileHasRun=!0,this.mobileEvt()):(this.setOffSet(),this.desktopEvt()),this.dealerData&&(this.dealerData.pageLoad=!0,this.displayDealerInfo(!0),PubSub.publish("nav.dealerSet",this.dealerData))},desktopEvt(){this.findDealer.addEventListener("click",this.showZip),this.editBtn.addEventListener("click",this.showZip)},mobileEvt(){this.findDealer.addEventListener("click",this.toggleZip),this.editBtnMobile.addEventListener("click",this.toggleZip)},killDesktopEvt(){this.findDealer.removeEventListener("click",this.showZip),this.editBtn.removeEventListener("click",this.showZip)},killMobileEvt(){this.findDealer.removeEventListener("click",this.toggleZip),this.editBtnMobile.removeEventListener("click",this.toggleZip)},setOffSet(){this.offset||(this.offset=getComputedStyle(this.zip,null).getPropertyValue("right"))},toggleMyBMW(e){this.currentBreakpoint!=="desktop"&&(this.dealer.classList.toggle(`${this.baseStr}__find-dealer--inactive`),this.toggleZip("close"),this.toggleFill(!0))},toggleZip(e){const t=`${this.baseStr}__zip-holder--active`,i=this.zip.classList.contains(t);e==="close"?(this.zip.classList.remove(t),this.toggleIcon(!0),document.body.classList.remove("globalnav-primary--kill-scroll")):(this.zip.classList.toggle(t),this.toggleIcon(),this.dealerBar.classList.add("overflow__visible")),i?(PubSub.publish("local.nav.close"),this.closeErrorMessage(),setTimeout(()=>{this.dealerBar.classList.remove("overflow__visible")},750),document.body.classList.remove("globalnav-primary--kill-scroll")):document.body.classList.add("globalnav-primary--kill-scroll"),this.toggleFill()},toggleFill(e=!1,t=!1){const i={className:"globalnav-primary-fill--active-dealer",close:e,open:t};PubSub.publish("nav.toggleFill",i)},toggleIcon(e=!1){const t=`${this.baseStr}__find-dealer--open`;e?this.dealer.classList.remove(t):this.dealer.classList.toggle(t)},trackSatellite(e){window.GlobalMessage&&window.GlobalMessage("measure.dtm.track",e)},showZip(e){this.dealerIsSet&&this.dealerInfo.classList.remove(`${this.baseStr}__dealer-set--active`),PubSub.publish("dealer.open",!0),this.toggleFill(!1,!0),this.logo.classList.add(`${this.logoStr}--fill`),this.zip.classList.add(`${this.baseStr}__zip-holder--active`),window.addEventListener("scroll",this.closeZip)},submitForm(e){e.preventDefault();const t=this.zipInput.value;d.validateZipCode(t)?(this.closeErrorMessage(),this.loader.classList.add(`${this.baseStr}__loader--loading`),a.updateFromZip(t).then(s=>{this.dealerData=s,this.displayDealerInfo(),this.closeZip()}).reject(s=>{this.showErrorMessage(),this.debug("error",s)}),this.zipInput.blur(),this.trackSatellite("dtmMACOZipSubmission")):(this.showErrorMessage(),this.trackSatellite("dtmMACOZipError"))},showErrorMessage(){let e=null,t=null;this.killLoader(),this.errorIcon.classList.add(`${this.baseStr}__zip-error-icon--active`),this.currentBreakpoint==="desktop"&&(e=getComputedStyle(this.zip,null).getPropertyValue("width"),t=parseInt(e,10)+parseInt(this.offset,10),this.error.style.width=`${t}px`),this.error.classList.add(`${this.baseStr}__zip-error--active`)},closeErrorMessage(){this.error.classList.remove(`${this.baseStr}__zip-error--active`),this.errorIcon.classList.remove(`${this.baseStr}__zip-error-icon--active`),setTimeout(()=>{this.error.style.width=""},300)},dealerUpdate(e,t){this.dealerData=t,this.displayDealerInfo(!0)},displayDealerInfo(e=!1){const{dealer:t,maco:i}=this.dealerData,s=h=>h.toLowerCase().split(" ").join("-"),r=`<span>${this.dealerName.dataset.dealerCopy}</span>
                          <a
                            href="${t.Url}"
                            analytics-on=""
                            analytics-event="topnav.tier3.${s(t.Name)}.link">
                              ${this.ellipsis(t.Name,"dealer")}
                          </a>`,o=`<a href="${i.Url}"
                            analytics-on=""
                            analytics-event="topnav.tier2.${s(i.Display)}.link">
                              ${this.ellipsis(i.Display,"maco")}
                          </a>`;this.dealerIsSet=!0,this.dealerLocation.innerHTML=o,this.dealerName.innerHTML=r,this.currentBreakpoint!=="desktop"||e?(this.findDealer.classList.add(`${this.baseStr}__set-dealer--fade`),e&&setTimeout(()=>{this.hideFindDealer(),this.toggleCopy(),setTimeout(()=>{this.showDealer()},100)},305)):this.hideFindDealer()},ellipsis(e,t){const i=window.innerWidth,s=t==="maco"?[32,45,15]:[0,15,18],l=r=>`${e.substring(0,r)}...`;return i<768&&e.length>s[2]?l(s[2]):i>=768&&i<960&&e.length>s[1]?l(s[1]):t!=="dealer"&&e.length>s[0]?l(s[0]):e},killLoader(){this.loader.classList.remove(`${this.baseStr}__loader--loading`)},closeZip(e){this.zip.classList.contains(`${this.baseStr}__zip-holder--active`)&&(this.zip.classList.remove(`${this.baseStr}__zip-holder--active`),this.killLoader(),this.closeErrorMessage(),this.dealerIsSet?setTimeout(()=>{this.showDealer(),this.currentBreakpoint!=="desktop"&&(this.toggleIcon(),this.hideFindDealer()),this.changeCopy||this.toggleCopy()},301):this.currentBreakpoint!=="desktop"&&this.toggleIcon(!0),this.currentBreakpoint==="desktop"&&window.removeEventListener("scroll",this.closeZip),e!=="my-bmw.open"&&this.logo.classList.remove(`${this.logoStr}--fill`),this.toggleFill(!0))},hideFindDealer(){this.dealerInfo.classList.remove(`${this.baseStr}__dealer-set--hide`),this.findDealer.classList.add(`${this.baseStr}__set-dealer--hide`)},toggleCopy(){this.changeCopy=!0;const e=document.createTextNode(this.zip.dataset.updateCopy.trim()),t=this.zip.querySelector("label span");t.textContent="",t.appendChild(e)},showDealer(){this.dealerInfo.classList.add(`${this.baseStr}__dealer-set--active`)},checkEvtSettings(){this.mobileHasRun||(this.mobileHasRun=!0,this.killDesktopEvt(),this.mobileEvt())},resizeEvt(e,t){const i=t.width;i<768&&this.currentBreakpoint!=="mobile"?(this.currentBreakpoint="mobile",this.checkEvtSettings(),this.dealerData&&this.displayDealerInfo()):i<960&&i>=768&&this.currentBreakpoint!=="tablet"?(this.currentBreakpoint="tablet",this.checkEvtSettings(),this.dealerData&&this.displayDealerInfo()):i>=960&&this.currentBreakpoint!=="desktop"&&(this.mobileHasRun=!1,this.currentBreakpoint="desktop",this.killMobileEvt(),this.desktopEvt(),this.setOffSet(),this.dealerData&&this.displayDealerInfo(),this.dealer.classList.remove(`${this.baseStr}__find-dealer--inactive`))}});

</script>

</body>
</html>
