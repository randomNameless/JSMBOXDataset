<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>jquery-accessibleMegaMenu.min.html</title>
</head>
<body>

<script>
!function($,window,document){"use strict";function AccessibleMegaMenu(element,options){this.element=element,this.settings=$.extend({},defaults,options),this._defaults=defaults,this._name=pluginName,this.mouseTimeoutID=null,this.focusTimeoutID=null,this.mouseFocused=!1,this.justFocused=!1,this.init()}function visible(element){return $.expr.filters.visible(element)&&!$(element).parents().addBack().filter(function(){return"hidden"===$.css(this,"visibility")}).length}function focusable(element,isTabIndexNotNaN){var map,mapName,img,nodeName=element.nodeName.toLowerCase();return"area"===nodeName?(map=element.parentNode,mapName=map.name,!(!element.href||!mapName||"map"!==map.nodeName.toLowerCase())&&(!!(img=$("img[usemap=#"+mapName+"]")[0])&&visible(img))):(/input|select|textarea|button|object/.test(nodeName)?!element.disabled:"a"===nodeName?element.href||isTabIndexNotNaN:isTabIndexNotNaN)&&visible(element)}var pluginName="accessibleMegaMenu",defaults={uuidPrefix:"accessible-megamenu",menuClass:"accessible-megamenu",topNavItemClass:"accessible-megamenu-top-nav-item",panelClass:"accessible-megamenu-panel",panelGroupClass:"accessible-megamenu-panel-group",hoverClass:"hover",focusClass:"focus",openClass:"open",toggleButtonClass:"accessible-megamenu-toggle",openDelay:0,closeDelay:250,openOnMouseover:!1},Keyboard={BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,LEFT:37,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SPACE:32,TAB:9,UP:38,keyMap:{48:"0",49:"1",50:"2",51:"3",52:"4",53:"5",54:"6",55:"7",56:"8",57:"9",59:";",65:"a",66:"b",67:"c",68:"d",69:"e",70:"f",71:"g",72:"h",73:"i",74:"j",75:"k",76:"l",77:"m",78:"n",79:"o",80:"p",81:"q",82:"r",83:"s",84:"t",85:"u",86:"v",87:"w",88:"x",89:"y",90:"z",96:"0",97:"1",98:"2",99:"3",100:"4",101:"5",102:"6",103:"7",104:"8",105:"9",190:"."}},clearTimeout=window.clearTimeout,setTimeout=window.setTimeout,isOpera=window.opera&&"[object Opera]"===window.opera.toString();AccessibleMegaMenu.prototype=function(){var _getPlugin,_addUniqueId,_togglePanel,_clickHandler,_touchmoveHandler,_clickOutsideHandler,_DOMAttrModifiedHandler,_focusInHandler,_focusOutHandler,_keyDownHandler,_mouseDownHandler,_mouseOverHandler,_mouseOutHandler,_clickToggleHandler,_toggleExpandedEventHandlers,_addEventHandlers,_removeEventHandlers,uuid=0,keydownSearchString="",isTouch="ontouchstart"in window||window.navigator.msMaxTouchPoints;return _getPlugin=function(element){return $(element).closest(":data(plugin_"+pluginName+")").data("plugin_"+pluginName)},_addUniqueId=function(element){element=$(element);var settings=this.settings;element.attr("id")||element.attr("id",settings.uuidPrefix+"-"+(new Date).getTime()+"-"+ ++uuid)},_togglePanel=function(event,hide){var newfocus,target=$(event.target),that=this,settings=this.settings,menu=this.menu,topli=target.closest("."+settings.topNavItemClass),panel=target.hasClass(settings.panelClass)?target:target.closest("."+settings.panelClass);if(_toggleExpandedEventHandlers.call(this,!0),hide)if((topli=menu.find("."+settings.topNavItemClass+" ."+settings.openClass+":first").closest("."+settings.topNavItemClass)).is(event.relatedTarget)||topli.has(event.relatedTarget).length>0)0===topli.length&&menu.find("[aria-expanded=true]").attr("aria-expanded","false").removeClass(settings.openClass).filter("."+settings.panelClass).attr("aria-hidden","true");else{if(("mouseout"===event.type||"focusout"===event.type)&&topli.has(document.activeElement).length>0)return;topli.find("[aria-expanded]").attr("aria-expanded","false").removeClass(settings.openClass).filter("."+settings.panelClass).attr("aria-hidden","true"),("keydown"===event.type&&event.keyCode===Keyboard.ESCAPE||"DOMAttrModified"===event.type)&&(newfocus=topli.find(":tabbable:first"),setTimeout(function(){menu.find("[aria-expanded]."+that.settings.panelClass).off("DOMAttrModified.accessible-megamenu"),newfocus.focus(),that.justFocused=!1},99))}else{clearTimeout(that.focusTimeoutID),topli.siblings().find("[aria-expanded]").attr("aria-expanded","false").removeClass(settings.openClass).filter("."+settings.panelClass).attr("aria-hidden","true"),topli.find("[aria-expanded]").attr("aria-expanded","true").addClass(settings.openClass).filter("."+settings.panelClass).attr("aria-hidden","false");var pageScrollPosition=$("html")[0].scrollTop,openPanelTopPosition=40;$("."+settings.panelClass+"."+settings.openClass).parent().length&&(openPanelTopPosition=$("."+settings.panelClass+"."+settings.openClass).parent().offset().top),pageScrollPosition>openPanelTopPosition&&($("html")[0].scrollTop=openPanelTopPosition),"mouseover"===event.type&&target.is(":tabbable")&&1===topli.length&&0===panel.length&&menu.has(document.activeElement).length>0&&(target.focus(),that.justFocused=!1),_toggleExpandedEventHandlers.call(that)}},_clickHandler=function(event){var target=$(event.target).closest(":tabbable"),topli=target.closest("."+this.settings.topNavItemClass),panel=target.closest("."+this.settings.panelClass);1===topli.length&&0===panel.length&&1===topli.find("."+this.settings.panelClass).length&&(target.hasClass(this.settings.openClass)?this.justFocused?(event.preventDefault(),event.stopPropagation(),this.justFocused=!1):(isTouch||!isTouch&&!this.settings.openOnMouseover)&&(event.preventDefault(),event.stopPropagation(),_togglePanel.call(this,event,target.hasClass(this.settings.openClass))):(event.preventDefault(),event.stopPropagation(),_togglePanel.call(this,event),this.justFocused=!1))},_touchmoveHandler=function(){this.justMoved=!0},_clickOutsideHandler=function(event){0===$(event.target).closest(this.menu).length&&(event.preventDefault(),event.stopPropagation(),_togglePanel.call(this,event,!0))},_DOMAttrModifiedHandler=function(event){"aria-expanded"===event.originalEvent.attrName&&"false"===event.originalEvent.newValue&&$(event.target).hasClass(this.settings.openClass)&&(event.preventDefault(),event.stopPropagation(),_togglePanel.call(this,event,!0))},_focusInHandler=function(event){clearTimeout(this.focusTimeoutID);var target=$(event.target),panel=target.closest("."+this.settings.panelClass);target.addClass(this.settings.focusClass),this.justFocused=!this.mouseFocused||!this.settings.openOnMouseover&&this.mouseFocused,this.mouseFocused=!1,this.justFocused&&this.panels.not(panel).filter("."+this.settings.openClass).length&&_togglePanel.call(this,event)},_focusOutHandler=function(event){this.justFocused=!1;var that=this,target=$(event.target),topli=target.closest("."+this.settings.topNavItemClass);target.removeClass(this.settings.focusClass),window.cvox?that.focusTimeoutID=setTimeout(function(){window.cvox.Api.getCurrentNode(function(node){topli.has(node).length?clearTimeout(that.focusTimeoutID):that.focusTimeoutID=setTimeout(function(scope,event,hide){_togglePanel.call(scope,event,hide)},275,that,event,!0)})},25):that.focusTimeoutID=setTimeout(function(){that.mouseFocused&&null===event.relatedTarget||_togglePanel.call(that,event,!0)},300)},_keyDownHandler=function(event){var next,start,i,o,label,regex,that=this.constructor===AccessibleMegaMenu?this:_getPlugin(this),settings=that.settings,target=$($(this).is("."+settings.hoverClass+":tabbable")?this:event.target),menu=that.menu,topnavitems=that.topnavitems,topli=target.closest("."+settings.topNavItemClass),tabbables=menu.find(":tabbable"),panel=target.hasClass(settings.panelClass)?target:target.closest("."+settings.panelClass),panelGroups=panel.find("."+settings.panelGroupClass),currentPanelGroup=target.closest("."+settings.panelGroupClass),keycode=event.keyCode||event.which,found=!1,newString=Keyboard.keyMap[event.keyCode]||"",isTopNavItem=1===topli.length&&0===panel.length;if(!target.is("input:focus, select:focus, textarea:focus, button:focus")){switch(target.is("."+settings.hoverClass+":tabbable")&&$("html").off("keydown.accessible-megamenu"),keycode){case Keyboard.ESCAPE:this.mouseFocused=!1,_togglePanel.call(that,event,!0);break;case Keyboard.DOWN:event.preventDefault(),this.mouseFocused=!1,isTopNavItem?(_togglePanel.call(that,event),found=1===topli.find("."+settings.panelClass+" :tabbable:first").focus().length):found=1===tabbables.filter(":gt("+tabbables.index(target)+"):first").focus().length,!found&&isOpera&&(event.ctrlKey||event.metaKey)&&(i=(tabbables=$(":tabbable")).index(target),found=1===$(":tabbable:gt("+$(":tabbable").index(target)+"):first").focus().length);break;case Keyboard.UP:event.preventDefault(),this.mouseFocused=!1,isTopNavItem&&target.hasClass(settings.openClass)?(_togglePanel.call(that,event,!0),(next=topnavitems.filter(":lt("+topnavitems.index(topli)+"):last")).children("."+settings.panelClass).length&&(found=1===next.find("[aria-expanded]").attr("aria-expanded","true").addClass(settings.openClass).filter("."+settings.panelClass).attr("aria-hidden","false").find(":tabbable:last").focus())):isTopNavItem||(found=1===tabbables.filter(":lt("+tabbables.index(target)+"):last").focus().length),!found&&isOpera&&(event.ctrlKey||event.metaKey)&&(i=(tabbables=$(":tabbable")).index(target),found=1===$(":tabbable:lt("+$(":tabbable").index(target)+"):first").focus().length);break;case Keyboard.RIGHT:event.preventDefault(),this.mouseFocused=!1,isTopNavItem?found=1===topnavitems.filter(":gt("+topnavitems.index(topli)+"):first").find(":tabbable:first").focus().length:(panelGroups.length&&currentPanelGroup.length&&(found=1===panelGroups.filter(":gt("+panelGroups.index(currentPanelGroup)+"):first").find(":tabbable:first").focus().length),found||(found=1===topli.find(":tabbable:first").focus().length));break;case Keyboard.LEFT:event.preventDefault(),this.mouseFocused=!1,isTopNavItem?found=1===topnavitems.filter(":lt("+topnavitems.index(topli)+"):last").find(":tabbable:first").focus().length:(panelGroups.length&&currentPanelGroup.length&&(found=1===panelGroups.filter(":lt("+panelGroups.index(currentPanelGroup)+"):last").find(":tabbable:first").focus().length),found||(found=1===topli.find(":tabbable:first").focus().length));break;case Keyboard.TAB:this.mouseFocused=!1,i=tabbables.index(target),event.shiftKey&&isTopNavItem&&target.hasClass(settings.openClass)?(_togglePanel.call(that,event,!0),(next=topnavitems.filter(":lt("+topnavitems.index(topli)+"):last")).children("."+settings.panelClass).length&&(found=next.children().attr("aria-expanded","true").addClass(settings.openClass).filter("."+settings.panelClass).attr("aria-hidden","false").find(":tabbable:last").focus())):event.shiftKey&&i>0?found=1===tabbables.filter(":lt("+i+"):last").focus().length:!event.shiftKey&&i<tabbables.length-1?found=1===tabbables.filter(":gt("+i+"):first").focus().length:isOpera&&(i=(tabbables=$(":tabbable")).index(target),found=event.shiftKey?1===$(":tabbable:lt("+$(":tabbable").index(target)+"):last").focus().length:1===$(":tabbable:gt("+$(":tabbable").index(target)+"):first").focus().length),found&&event.preventDefault();break;case Keyboard.SPACE:case Keyboard.ENTER:if(!isTopNavItem)return!0;event.preventDefault(),_clickHandler.call(that,event);break;default:if(clearTimeout(this.keydownTimeoutID),0===(keydownSearchString+=newString!==keydownSearchString?newString:"").length)return;for(this.keydownTimeoutID=setTimeout(function(){keydownSearchString=""},1e3),tabbables=isTopNavItem&&!target.hasClass(settings.openClass)?tabbables.filter(":not(."+settings.panelClass+" :tabbable)"):topli.find(":tabbable"),event.shiftKey&&(tabbables=$(tabbables.get().reverse())),i=0;i<tabbables.length;i++)if((o=tabbables.eq(i)).is(target)){start=1===keydownSearchString.length?i+1:i;break}for(regex=new RegExp("^"+keydownSearchString.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&"),"i"),i=start;i<tabbables.length;i++)if(o=tabbables.eq(i),label=$.trim(o.text()),regex.test(label)){found=!0,o.focus();break}if(!found)for(i=0;i<start;i++)if(o=tabbables.eq(i),label=$.trim(o.text()),regex.test(label)){o.focus();break}}that.justFocused=!1}},_mouseDownHandler=function(event){($(event.target).closest(this.settings.panelClass)||$(event.target).closest(":focusable").length)&&(this.mouseFocused=!0,$(event.target).closest(this.settings.menuClass)&&$("html").on("keydown.accessible-megamenu",$.proxy(_keyDownHandler,event.target))),clearTimeout(this.mouseTimeoutID),this.mouseTimeoutID=setTimeout(function(){clearTimeout(this.focusTimeoutID)},1)},_mouseOverHandler=function(event){clearTimeout(this.mouseTimeoutID);var that=this;that.settings.openOnMouseover&&(this.mouseTimeoutID=setTimeout(function(){$(event.target).addClass(that.settings.hoverClass),_togglePanel.call(that,event),$(event.target).closest(that.settings.menuClass)&&$("html").on("keydown.accessible-megamenu",$.proxy(_keyDownHandler,event.target))},this.settings.openDelay))},_mouseOutHandler=function(event){clearTimeout(this.mouseTimeoutID);var that=this;that.settings.openOnMouseover&&($(event.target).removeClass(that.settings.hoverClass),that.mouseTimeoutID=setTimeout(function(){_togglePanel.call(that,event,!0)},this.settings.closeDelay),$(event.target).is(":tabbable")&&$("html").off("keydown.accessible-megamenu"))},_clickToggleHandler=function(){var isExpanded="true"===this.toggleButton.attr("aria-expanded");this.toggleButton.attr({"aria-expanded":!isExpanded,"aria-pressed":!isExpanded})},_toggleExpandedEventHandlers=function(hide){var menu=this.menu;hide?($("html").off("mouseup.outside-accessible-megamenu, touchend.outside-accessible-megamenu, mspointerup.outside-accessible-megamenu,  pointerup.outside-accessible-megamenu"),menu.find("[aria-expanded]."+this.settings.panelClass).off("DOMAttrModified.accessible-megamenu")):($("html").on("mouseup.outside-accessible-megamenu, touchend.outside-accessible-megamenu, mspointerup.outside-accessible-megamenu,  pointerup.outside-accessible-megamenu",$.proxy(_clickOutsideHandler,this)),menu.find("[aria-expanded=true]."+this.settings.panelClass).on("DOMAttrModified.accessible-megamenu",$.proxy(_DOMAttrModifiedHandler,this)))},_addEventHandlers=function(){var menu=this.menu,toggleButton=this.toggleButton;menu.on("focusin.accessible-megamenu",":focusable, ."+this.settings.panelClass,$.proxy(_focusInHandler,this)).on("focusout.accessible-megamenu",":focusable, ."+this.settings.panelClass,$.proxy(_focusOutHandler,this)).on("keydown.accessible-megamenu",$.proxy(_keyDownHandler,this)).on("mouseover.accessible-megamenu",$.proxy(_mouseOverHandler,this)).on("mouseout.accessible-megamenu",$.proxy(_mouseOutHandler,this)).on("mousedown.accessible-megamenu",$.proxy(_mouseDownHandler,this)).on("click.accessible-megamenu",$.proxy(_clickHandler,this)),toggleButton.on("click.accessible-megamenu",$.proxy(_clickToggleHandler,this)),isTouch&&menu.on("touchmove.accessible-megamenu",$.proxy(_touchmoveHandler,this)),$(document.activeElement).closest(menu).length&&$(document.activeElement).trigger("focusin.accessible-megamenu")},_removeEventHandlers=function(){var menu=this.menu,toggleButton=this.toggleButton;menu.off(".accessible-megamenu"),menu.find("[aria-expanded=true]."+this.settings.panelClass).length&&_toggleExpandedEventHandlers.call(this,!0),toggleButton.off(".accessible-megamenu")},{constructor:AccessibleMegaMenu,init:function(){var settings=this.settings,nav=$(this.element),menu=nav.children("ol,ul").first(),topnavitems=menu.children(),toggleButton=nav.children("button").first();this.start(settings,nav,menu,topnavitems,toggleButton)},start:function(settings,nav,menu,topnavitems,toggleButton){var that=this;this.settings=settings,this.menu=menu,this.topnavitems=topnavitems,this.toggleButton=toggleButton,nav.attr("role","navigation"),_addUniqueId.call(that,menu),menu.addClass(settings.menuClass),menu.addClass(["js",settings.menuClass].join("-")),topnavitems.each(function(i,topnavitem){var topnavitemlink,topnavitempanel;(topnavitem=$(topnavitem)).addClass(settings.topNavItemClass),topnavitemlink=topnavitem.find(":tabbable:first"),topnavitempanel=topnavitem.children(":not(:tabbable):last"),_addUniqueId.call(that,topnavitemlink),topnavitempanel.length&&(_addUniqueId.call(that,topnavitempanel),topnavitemlink.attr({role:"button","aria-controls":topnavitempanel.attr("id"),"aria-expanded":!1,tabindex:0}),topnavitempanel.attr({role:"region","aria-expanded":!1,"aria-hidden":!0}).addClass(settings.panelClass).not("[aria-labelledby]").attr("aria-labelledby",topnavitemlink.attr("id")))}),this.panels=menu.find("."+settings.panelClass),menu.find("hr").attr("role","separator"),toggleButton.addClass(settings.toggleButtonClass),toggleButton.attr({"aria-expanded":!1,"aria-pressed":!1,"aria-controls":menu.attr("id")}),_addEventHandlers.call(this)},destroy:function(){this.menu.removeClass(["js",this.settings.menuClass].join("-")),_removeEventHandlers.call(this,!0)},getDefaults:function(){return this._defaults},getOption:function(opt){return this.settings[opt]},getAllOptions:function(){return this.settings},setOption:function(opt,value,reinitialize){this.settings[opt]=value,reinitialize&&this.init()}}}(),$.fn[pluginName]=function(options){return this.each(function(){var pluginInstance=$.data(this,"plugin_"+pluginName);pluginInstance?"function"==typeof pluginInstance[options]&&pluginInstance[options].apply(pluginInstance,Array.prototype.slice.call(arguments,1)):$.data(this,"plugin_"+pluginName,new $.fn[pluginName].AccessibleMegaMenu(this,options))})},$.fn[pluginName].AccessibleMegaMenu=AccessibleMegaMenu,$.extend($.expr[":"],{data:$.expr.createPseudo?$.expr.createPseudo(function(dataName){return function(elem){return!!$.data(elem,dataName)}}):function(elem,i,match){return!!$.data(elem,match[3])},focusable:function(element){return focusable(element,!isNaN($.attr(element,"tabindex")))},tabbable:function(element){var tabIndex=$.attr(element,"tabindex"),isTabIndexNaN=isNaN(tabIndex);return(isTabIndexNaN||tabIndex>=0)&&focusable(element,!isTabIndexNaN)}})}(jQuery,window,document);
</script>

</body>
</html>
