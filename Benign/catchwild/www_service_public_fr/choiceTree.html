<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>choiceTree.html</title>
</head>
<body>

<script>
define(["jquery","mustache","text!choice-tree/choiceTreeTemplate.html","text!choice-tree/choiceTreeAideTemplate.html","global","vddTooltip","persoGeo"],function(e,t,i,n,a,o,c){function r(){function a(t){e(t).find("[id]").removeAttr("id"),e(t).find("[data-application]").removeAttr("data-application")}function o(a){function l(e){if(0===e.children(p).length)return"";var i={aideId:e.children(p).children("button").attr("aria-controls"),aideTitle:e.children(p).children("button").attr("title"),aideText:e.children(b).html()};return t.render(n,i)}function s(e){return t.render(i,e)}function E(e,t){0!==t.length?e.$toSelectChoices=t.children(u):e.$toSelectChoices=e.$immutableChoiceTree.children(u)}function A(t,i){var n=i.parents(u).toArray().reverse();0!==i.length&&n.push(i),t.$recapChoices=e(n)}function k(t,i){if(0!==i.length){var n="";i.children(u).each(function(){n+=e(this).html()}),t.printableContent=n}else t.printableContent=e(t.$immutableChoiceTree).html()}a=function(t){function i(t){var i=[];return t.each(function(t,n){var a={id:t,title:e(n).children(f).text(),notice:e(n).children(m).html(),noticeIsNotBlank:0!==e(n).children(m).text().trim().length,listNumber:t+1,aideBloc:l(e(n)),content:function(){var t=e(n).children("[data-immutable-choice-tree=title]").attr("data-condition");if(t){var i="requirejs(['jquery', 'domReady'], function ($, domReady) { domReady(function () { $('body').trigger('agenda', '"+t+"');});});",a='<div class="schedule"><ul id="agenda" class="schedule-list-day"></ul><script>'+i+"<\/script></div>",o=e(n).children("div.choice-tree-item-content");return e(o).children("p:eq(0)").hide(),a=a+"<br>"+e(o).html()}return e(n).children("div.choice-tree-item-content").html()}};i.push(a)}),i}return t.toSelectChoicesNodes=i(t.$toSelectChoices),t.recapChoicesNodes=i(t.$recapChoices),t.ghostNumber=t.recapChoicesNodes.length+1,t.content=function(e){if(0===e.toSelectChoicesNodes.length){return e.recapChoicesNodes[e.recapChoicesNodes.length-1].content}return null}(t),t}(a),function(e){var t=e.$parentElement;t.find(v).remove(),e.$choiceTreeNextSibling.length>0?e.$choiceTreeNextSibling.before(s(e)):t.append(s(e))}(a),function(t){t.$parentElement.find(x).each(function(i,n){e(n).on("click",function(){var i=e(t.$toSelectChoices.get(e(n).data("nodeId")));E(t,i),A(t,i),k(t,i),o(t),t.$parentElement.find(g).remove(),e(T).removeAttr("tabindex");var a=t.$parentElement.find($).find(T);a.last().attr("tabindex","-1"),a.last().focus(),0===t.$parentElement.find(x).length&&t.$parentElement.find(y).attr("hidden","hidden")})})}(a),function(t){var i=t.$parentElement;i.find(N).each(function(n,a){e(a).on("click",function(){var n=e(t.$recapChoices.get(e(a).data("nodeId")));t.isNotModifyAction=!1;var c=i.find(N);E(t,n.parent(u)),A(t,n.parent(u)),k(t,n.parent(u)),o(t);var r;c[0]===a?r=t.$parentElement.find(y).children(S):(c=e(N),r=e(c).last()),r.attr("tabindex","0"),r.focus()})})}(a),function(t){t.find("[data-application=geoSearchForm]").each(function(t,i){c.execute(e(i))})}(a.$parentElement),function(){var t=e(v+":eq("+a.choiceTreeId+")");0===e("[data-id=rdv_gendarmerie]").length&&t.find(g).last().focus(),r(t.find(y)),r(t.find($)),r(t.find(C)),d(t.find(y)),d(t.find($)),d(t.find(C)),h(t.find(C))}()}function r(t){t.find("abbr[data-sigle]").each(function(){var t=e(this).data().sigle,i=this,n=e("div[data-sigle="+t+"]"),a=n.text();i.setAttribute("data-original-title",a),e(i).children("span.fr-sr-only").text(" : "+a),l(e(i))}),t.find("abbr[data-acronyme]").each(function(){var t=e(this).data().acronyme,i=this,n=e("div[data-acronyme="+t+"]"),a=n.text();i.setAttribute("data-original-title",a),e(i).children("span.fr-sr-only").text(" : "+a),l(e(i))})}function d(t){t.find("span[data-definition]").each(function(t,i){var n=e(this).data().definition,a=this,o=e("div[data-definition="+n+"]"),c=o.text();a.setAttribute("data-original-title",c),e(a).children("span.fr-sr-only").text(c),l(e(a))})}function l(t){t.tooltip({trigger:"focus",placement:"bottom",html:!0}).on("mouseenter",function(){var t=this;e(this).tooltip("show"),e(".tooltip").on("mouseleave",function(){e(t).tooltip("hide")})}).on("mouseleave",function(){var t=this;setTimeout(function(){e(".tooltip:hover").length||e(t).tooltip("hide")},300)}),e(document).on("keyup",function(t){"Escape"!==t.key&&27!==t.keyCode||e(".tooltip.show").remove()})}function h(t){t.find(".collapse").on("shown.bs.collapse",function(t){e(this).attr("aria-hidden",!1)}),t.find(".collapse").on("hidden.bs.collapse",function(t){e(this).attr("aria-hidden",!0)})}var s,u="[data-immutable-choice-tree=item]",f="[data-immutable-choice-tree=title]",m="[data-immutable-choice-tree=notice]",p="[data-immutable-choice-tree=aide-button]",b="[data-immutable-choice-tree=aide-texte]",v="[data-dynamic-choice-tree=root]",g="[data-dynamic-choice-tree=focus]",y="[data-dynamic-choice-tree=to-select]",$="[data-dynamic-choice-tree=recap]",C="[data-dynamic-choice-tree=result]",x="[data-dynamic-choice-tree=select-action]",N="[data-dynamic-choice-tree=modify-action]",T="[data-dynamic-tree=title]",S="[data-dynamic-choice-tree=choisir-cas]",E=e("[data-immutable-choice-tree=root]");E.each(function(t,i){s=e(i).clone(!0,!0);var n={$toSelectChoices:s.children(u),toSelectChoicesNodes:[],$recapChoices:e(),recapChoicesNodes:[],$parentElement:e(i).parent("div"),choiceTreeId:t,$immutableChoiceTree:s,$choiceTreeNextSibling:e(i).next(),ghostNumber:0,content:null,printableContent:null,isNotModifyAction:!0};n.$toSelectChoices.length>1&&(e(i).attr("hidden",!0),a(i),n.printableContent=e(i).html(),o(n))}),e("body").on("shown.bs.modal",function(t){var i=e(t.relatedTarget).attr("data-target-hashcode");i&&e("#btn-fermer-"+i).focus()})}return{transform:r}});
</script>

</body>
</html>
