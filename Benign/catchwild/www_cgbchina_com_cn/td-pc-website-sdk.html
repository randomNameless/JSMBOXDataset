<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>td-pc-website-sdk.html</title>
</head>
<body>

<script>
(function(){
	//SDK run params ...
	var TD_SDK_CONFIG = {
		APPKEY:"1A361007DA1A5AD32000152A24AAAAAA",  //APPKEY
		REQUEST_ASYN: true, // 配置参数REQUEST_ASYN为true时为异步上报数据，未配置或者为false时候为同步上报数据。单页面前端系统，建议使用异步上报数据方式。
		REQUEST_URL:'https://cbae.cgbchina.com.cn:8080/g/w', // receive data server url
		REQUEST_CONF: '',//可视化采数拉取配置的服务url
		AUTO_SEND_EVENT : true, 	// true or false, The custom event trigger automatically sent data
		LOOP_SEND_DATA : false, 	// false or numbers(60) ,according to the time of you to set the cycle to send data, the unit is seconds, not less than 60 seconds
		TDID_POLICY : 'UUID', 	// UUID or FINGER, TDID generation strategy, It is recommended to use UUID
		TDID_SAVED_IN_COOKIE :false, //是否保存tdid到cookie中，默认为false，即不保存到cookie
		SDK_VERSION : 'WEB+APP+v5.0.25', // Do not modify
		PAGE_TITLE:true,//是否自动采集页面title
		PAGE_TIME_OPTIMIZE:true,//是否采用优化后的页面时长计算方法，默认为false
		EVENT_BY_ELEMENT : true, //是否允许通过元素属性td-event进行事件埋点
		USER_CLICK_MAP : true, //是否采集用户点击图数据,
		USER_CLICK_MAP_REQURL : "https://cbae.cgbchina.com.cn/sdk/userClickMap",  //获取配置热力图页面URL  
		WEB_VIEW_FLAG_UA:'', //用于验证是否webview环境
		AUTO_TRACK_URL: true, // 是否自动追踪 url 作为 page_name
	};
	
	/*解决在ie7及以下版本浏览器下，防止事件埋点出错*/
	window['TDAPP'] = window['TDAPP'] || {};
	function delaySetTDAPPEvent(eventId,eventLabel,eventParams){
		eventId = eventId || "";
		eventLabel = eventLabel || "";
		eventParams = eventParams || {};
		var checkTDAPP = setInterval(function() {
			if(typeof(TDAPP) != "undefined" && TDAPP.onEvent){
				clearInterval(checkTDAPP);
				TDAPP.onEvent(eventId, eventLabel,eventParams);
			}
		}, 100);
	}
	window['TDAPP'].onEvent = delaySetTDAPPEvent;
	window['TDAPP'].send = window['TDAPP'].send || function(){};
	window['TDAPP'].onCustomPage = window['TDAPP'].onCustomPage || function(){};
	window['TDAPP'].getDeviceId = window['TDAPP'].getDeviceId || function(){};
	window['TDAPP'].onEventWithLabel = window['TDAPP'].onEventWithLabel || function(){};
	window['TDAPP'].onEventWithParameters = window['TDAPP'].onEventWithParameters || function(){};
	window['TDAPP'].setLocation = window['TDAPP'].setLocation || function(){};
	/*解决在ie7及以下版本浏览器下，防止事件埋点出错*/
	
	if(navigator.userAgent.indexOf("MSIE")>0){
	      if(navigator.userAgent.indexOf("MSIE 6.0")>0){
	      	return
	      }   
	      else if(navigator.userAgent.indexOf("MSIE 7.0")>0){
	      	return
	      }
	}
"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};window.neumedias=window.neumedias||{},neumedias.platform=function(){var t=window.navigator.userAgent,e=window.navigator.platform,a={};return e.match(/win32/gi)?(a.os="windows",t.match(/windows\s+nt\s+5\.1/gi)?(a.type="desktop",a.code="xp"):t.match(/windows\s+nt\s+6\.0/gi)?(a.type="desktop",a.code="vista"):t.match(/windows\s+nt\s+6\.1/gi)?(a.type="desktop",a.code="7"):t.match(/windows\s+nt\s+6\.2/gi)?(a.type="desktop",a.code="8"):t.match(/windows\s+nt\s+6\.3/gi)?(a.type="desktop",a.code="8.1"):t.match(/windows\s+phone\s+7/gi)?(a.type="phone",a.code="7"):t.match(/windows\s+phone\s+8/gi)&&(a.type="phone",a.code="8")):e.match(/macintel/gi)?a.os="macosx":e.match(/iphone/gi)?(a.os="ios",a.type="phone",a.code="8"):e.match(/ipad/gi)?(a.os="ios",a.type="tablet",a.code="8"):e.match(/linux/gi)&&(t.match(/android/gi)?(a.os="android",a.type="mobile"):(t.match(/cros/gi)?a.os="chromeos":t.match(/ubuntu/gi)?a.os="ubuntu":a.os="linux",a.type="desktop")),a},neumedias.isIOS=function(){return"ios"==neumedias.platform().os},neumedias.isAndroid=function(){return"android"==neumedias.platform().os},neumedias.isMobile=function(){var t=neumedias.platform();return console.log(),"mobile"==t.type||"phone"==t.type||"tablet"==t.type},window.TDJSON={},function(){function f(t){return t<10?"0"+t:t}function this_value(){return this.valueOf()}var cx,escapable,gap,indent,meta,rep;function quote(t){return escapable.lastIndex=0,escapable.test(t)?'"'+t.replace(escapable,function(t){var e=meta[t];return"string"==typeof e?e:"\\u"+("0000"+t.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+t+'"'}function str(t,e){var a,n,i,r,o,s=gap,l=e[t];switch(l&&"object"===(void 0===l?"undefined":_typeof(l))&&l.toJSON,"function"==typeof rep&&(l=rep.call(e,t,l)),void 0===l?"undefined":_typeof(l)){case"string":return quote(l);case"number":return isFinite(l)?String(l):"null";case"boolean":case"null":return String(l);case"object":if(!l)return"null";if(gap+=indent,o=[],"[object Array]"===Object.prototype.toString.apply(l)){for(r=l.length,a=0;a<r;a+=1)o[a]=str(a,l)||"null";return i=0===o.length?"[]":gap?"[\n"+gap+o.join(",\n"+gap)+"\n"+s+"]":"["+o.join(",")+"]",gap=s,i}if(rep&&"object"===(void 0===rep?"undefined":_typeof(rep)))for(r=rep.length,a=0;a<r;a+=1)"string"==typeof rep[a]&&(i=str(n=rep[a],l))&&o.push(quote(n)+(gap?": ":":")+i);else for(n in l)Object.prototype.hasOwnProperty.call(l,n)&&(i=str(n,l))&&o.push(quote(n)+(gap?": ":":")+i);return i=0===o.length?"{}":gap?"{\n"+gap+o.join(",\n"+gap)+"\n"+s+"}":"{"+o.join(",")+"}",gap=s,i}}"function"!=typeof Date.prototype.toJSON&&(Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null},Boolean.prototype.toJSON=this_value,Number.prototype.toJSON=this_value,String.prototype.toJSON=this_value),"function"!=typeof TDJSON.stringify&&(escapable=/[\\\"\u0000-\u001f\u007f-\u009f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,meta={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},TDJSON.stringify=function(t,e,a){var n;if(indent=gap="","number"==typeof a)for(n=0;n<a;n+=1)indent+=" ";else"string"==typeof a&&(indent=a);if((rep=e)&&"function"!=typeof e&&("object"!==(void 0===e?"undefined":_typeof(e))||"number"!=typeof e.length))throw new Error("TDJSON.stringify");return str("",{"":t})}),"function"!=typeof TDJSON.parse&&(cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,TDJSON.parse=function(text,reviver){var j;function walk(t,e){var a,n,i=t[e];if(i&&"object"===(void 0===i?"undefined":_typeof(i)))for(a in i)Object.prototype.hasOwnProperty.call(i,a)&&(void 0!==(n=walk(i,a))?i[a]=n:delete i[a]);return reviver.call(t,e,i)}if(text=String(text),cx.lastIndex=0,cx.test(text)&&(text=text.replace(cx,function(t){return"\\u"+("0000"+t.charCodeAt(0).toString(16)).slice(-4)})),/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return j=eval("("+text+")"),"function"==typeof reviver?walk({"":j},""):j;throw new SyntaxError("TDJSON.parse")})}();var $$=function(u){var g,p,o=0,s=u.document,f=/^(?:text|application)\/javascript/i,h=/^(?:text|application)\/xml/i,v="application/json",D="text/html",m=/^\s*$/,_=function t(e){var a=I({},e||{});for(g in t.settings)void 0===a[g]&&(a[g]=t.settings[g]);!function(t){t.global&&0==_.active++&&T(t,null,"ajaxStart")}(a),a.crossDomain||(a.crossDomain=/^([\w-]+:)?\/\/([^\/]+)/.test(a.url)&&RegExp.$2!=u.location.host);var n=a.dataType,i=/=\?/.test(a.url);if("jsonp"==n||i)return i||(a.url=E(a.url,"callback=?")),t.JSONP(a);a.url||(a.url=u.location.toString()),A(a);var r,o=a.accepts[n],s={},l=/^([\w-]+:)\/\//.test(a.url)?RegExp.$1:u.location.protocol,d=t.settings.xhr();a.crossDomain||(s["X-Requested-With"]="XMLHttpRequest"),o&&(-1<(s.Accept=o).indexOf(",")&&(o=o.split(",",2)[0]),d.overrideMimeType&&d.overrideMimeType(o)),(a.contentType||a.data&&"GET"!=a.type.toUpperCase())&&(s["Content-Type"]=a.contentType||"application/x-www-form-urlencoded"),a.headers=I(s,a.headers||{}),d.onreadystatechange=function(){if(4==d.readyState){clearTimeout(r);var t,e=!1;if(200<=d.status&&d.status<300||304==d.status||0==d.status&&"file:"==l){n=n||function(t){return t&&(t==D?"html":t==v?"json":f.test(t)?"script":h.test(t)&&"xml")||"text"}(d.getResponseHeader("content-type")),t=d.responseText;try{"script"==n?(0,eval)(t):"xml"==n?t=d.responseXML:"json"==n&&(t=m.test(t)?null:TDJSON.parse(t))}catch(t){e=t}e?y(e,"parsererror",d,a):S(t,d,a)}else y(null,"error",d,a)}};var c=!("async"in a)||a.async;for(p in d.open(a.type,a.url,c),a.headers)d.setRequestHeader(p,a.headers[p]);return!1===function(t,e){var a=e.context;if(!1===e.beforeSend.call(a,t,e)||!1===T(e,a,"ajaxBeforeSend",[t,e]))return!1;T(e,a,"ajaxSend",[t,e])}(d,a)?(d.abort(),!1):(0<a.timeout&&(r=setTimeout(function(){d.onreadystatechange=b,d.abort(),y(null,"timeout",d,a)},a.timeout)),d.send(a.data?a.data:null),d)};function T(t,e,a,n){if(t.global)return!0}function S(t,e,a){var n=a.context,i="success";a.success.call(n,t,i,e),T(a),l(i,e,a)}function y(t,e,a,n){var i=n.context;n.error.call(i,a,e,t),T(n),l(e,a,n)}function l(t,e,a){var n=a.context;a.complete.call(n,e,t),T(a),function(t){t.global&&!--_.active&&T(t)}(a)}function b(){}function E(t,e){return(t+"&"+e).replace(/[&?]{1,2}/,"?")}function A(t){"object"===_typeof(t.data)&&(t.data=function(t,e){var a=[];return a.add=function(t,e){this.push(n(t)+"="+n(e))},function t(e,a,n,i){var r="array"==typeof a;for(var o in a){var s=a[o];i&&(o=n?i:i+"["+(r?"":o)+"]"),!i&&r?e.add(s.name,s.value):(n?"array"==typeof s:"object"===(void 0===s?"undefined":_typeof(s)))?t(e,s,n,o):e.add(o,s)}}(a,t,e),a.join("&").replace("%20","+")}(t.data)),!t.data||t.type&&"GET"!=t.type.toUpperCase()||(t.url=E(t.url,t.data))}_.active=0,_.JSONP=function(e){if(!("type"in e))return _(e);var a,n="jsonp"+ ++o,t=s.createElement("script"),i={abort:function(){n in u&&(u[n]=b),l("abort",i,e)}},r=s.getElementsByTagName("head")[0]||s.documentElement;return e.error&&(t.onerror=function(){i.abort(),e.error()}),u[n]=function(t){clearTimeout(a),delete u[n],S(t,i,e)},A(e),t.src=e.url.replace(/=\?/,"="+n),r.insertBefore(t,r.firstChild),0<e.timeout&&(a=setTimeout(function(){i.abort(),l("timeout",i,e)},e.timeout)),i},_.settings={type:"GET",beforeSend:b,success:b,error:b,complete:b,context:null,global:!0,xhr:function(){return new u.XMLHttpRequest},accepts:{script:"text/javascript, application/javascript",json:v,xml:"application/xml, text/xml",html:D,text:"text/plain"},crossDomain:!1,timeout:0},_.get=function(t,e){return _({url:t,success:e})},_.post=function(t,e,a,n){return"function"==typeof e&&(n=n||a,a=e,e=null),_({type:"POST",url:t,data:e,success:a,dataType:n})},_.getJSON=function(t,e){return _({url:t,success:e,dataType:"json"})};var n=encodeURIComponent;function I(t){for(var e=Array.prototype.slice.call(arguments,1),a=0;a<e.length;a++)for(g in e[a])void 0!==e[a][g]&&(t[g]=e[a][g]);return t}return{ajax:_}}(window);function trim(t){return t.replace(/^\s*|\s*$/g,"")}var cookie=function(t,e,a){if(void 0===e){var n=null;if(document.cookie&&""!=document.cookie)for(var i=document.cookie.split(";"),r=0;r<i.length;r++){var o=trim(i[r]);if(o.substring(0,t.length+1)==t+"="){n=decodeURIComponent(o.substring(t.length+1));break}}return n}a=a||{},null===e&&(e="",a.expires=-1);var s,l="";a.expires&&("number"==typeof a.expires||a.expires.toUTCString)&&("number"==typeof a.expires?(s=new Date).setTime(s.getTime()+24*a.expires*60*60*1e3):s=a.expires,l="; expires="+s.toUTCString());var d=a.path?"; path="+a.path:"",c=a.domain?"; domain="+a.domain:"",u=a.secure?"; secure":"";document.cookie=[t,"=",encodeURIComponent(e),l,d,c,u].join("")},TDIsWebviewFlag=!1;-1<TD_SDK_CONFIG.SDK_VERSION.indexOf("H5+APP+")||-1<TD_SDK_CONFIG.SDK_VERSION.indexOf("WEB+APP+")||(neumedias.isMobile()?TD_SDK_CONFIG.SDK_VERSION="H5+APP+"+TD_SDK_CONFIG.SDK_VERSION:TD_SDK_CONFIG.SDK_VERSION="WEB+APP+"+TD_SDK_CONFIG.SDK_VERSION);var DTGlobal={deviceId:"",appkey:"",appProfile:{versionName:"",versionCode:"",initTime:"",sdkVersion:TD_SDK_CONFIG.SDK_VERSION,partner:""},deviceProfile:{pixel:"",language:navigator.language,timezone:(new Date).getTimezoneOffset()/60*-1},msgs:[]};function setWebViewFlag(){TDIsWebviewFlag=!0}!function(){var e;TDIsWebviewFlag=function(){var t=!1,e=[],a=TD_SDK_CONFIG.WEB_VIEW_FLAG_UA;if(a){e.push(a);for(var n=navigator.userAgent,i=0;i<e.length;i++)if(n&&-1!=n.indexOf(e[i])){t=!0;break}"bridge"==TD_SDK_CONFIG.HYBIRD_TYPE&&t&&(t=!(null!=__TDIsIos__&&!__TDIosWebkit__&&!__TDIsAndroid__))}if(!t)for(var r=window.location.search.substring(1).split("&"),o=0,s=r.length;o<s;o++)if("tdhybridflag=1"===r[o]){t=!0;break}return t}(),e=null,function(t,e){var a;if(t)for(a=0;a<t.length&&(!t[a]||!e(t[a],a,t));a+=1);}(document.getElementsByTagName("script"),function(t){if(t.getAttribute("td-appid")||t.getAttribute("td-hybrid-flag"))return e=t,!0}),e&&e.getAttribute("td-hybrid-flag")||TDIsWebviewFlag?(TDIsWebviewFlag=!0,window.TD_SDK_CONFIG=window.TD_SDK_CONFIG||{},TD_SDK_CONFIG.AUTO_SEND_EVENT=!0):function(t){if(DTGlobal.appkey=TD_SDK_CONFIG.APPKEY,DTGlobal.appProfile.versionName="",DTGlobal.appProfile.versionCode="",t){DTGlobal.appkey=t.getAttribute("td-appid")||DTGlobal.appkey;var e=t.getAttribute("post-url"),a=t.getAttribute("td-loop");e&&(TD_SDK_CONFIG.REQUEST_URL=e),a&&(TD_SDK_CONFIG.LOOP_SEND_DATA=a),-1<TD_SDK_CONFIG.SDK_VERSION.indexOf("H5+APP+")||-1<TD_SDK_CONFIG.SDK_VERSION.indexOf("WEB+APP+")||(neumedias.isMobile()?TD_SDK_CONFIG.SDK_VERSION="H5+APP+"+TD_SDK_CONFIG.SDK_VERSION:TD_SDK_CONFIG.SDK_VERSION="WEB+APP+"+TD_SDK_CONFIG.SDK_VERSION),DTGlobal.appProfile.sdkVersion=TD_SDK_CONFIG.SDK_VERSION}}(e)}(),function(t){!function(){var e=null,a=null;if(function(t,e){var a;if(t)for(a=0;a<t.length&&(!t[a]||!e(t[a],a,t));a+=1);}(document.getElementsByTagName("script"),function(t){if(t.getAttribute("td-appid"))return a=t.getAttribute("td-appid"),e=t,!0}),a=null!=a?a:TD_SDK_CONFIG.APPKEY,DTGlobal.appkey=a,DTGlobal.appProfile.versionName="",DTGlobal.appProfile.versionCode="",e){var t=e.getAttribute("post-url"),n=e.getAttribute("td-loop");t&&(TD_SDK_CONFIG.REQUEST_URL=t),n&&(TD_SDK_CONFIG.LOOP_SEND_DATA=n)}}();var e={extend:function(){for(var t={},e=0,a=arguments.length;e<a;e++){var n=arguments[e];if("[object Object]"==Object.prototype.toString.call(n))for(var i in n)t[i]=n[i]}return t},getAjax:function(t){$$.ajax({url:TD_SDK_CONFIG.REQUEST_URL,data:TDJSON.stringify(t),type:"post",dataType:"text",success:function(t){console.log(t)}})},getParam:function(){var t,e=TDJSON.parse(TDJSON.stringify(DTGlobal)),a={appkey:localStorage.__TD_appkey||"",deviceId:cookie("__TD_deviceId")||localStorage.__TD_deviceId||"",deviceProfile:{pixel:(t=[window.screen.width,window.screen.height],window.devicePixelRatio&&t.push(window.devicePixelRatio),t.join("*"))},msgs:function(){if(!(t=localStorage.__TD_sessionMsg))return[];var t=TDJSON.parse(t).msg,e=sessionStorage.getItem("__TD_SessionStart");!e&&localStorage.__TD_lastSession&&(e=TDJSON.parse(localStorage.__TD_lastSession).start);var a=sessionStorage.getItem("__TD_sessionId"),n=(new Date).getTime(),i=0;e&&(i=parseInt((n-parseInt(e))/1e3));var r={type:2,data:{id:a,start:e,status:3,duration:i,pages:[],events:[]}};return t[t.length]=r,t}()};return this.extend(e,a)},del:function(){var t=window.localStorage;if(t&&t.__TD_appkey&&DTGlobal.appkey!==t.__TD_appkey){var e=this.getParam();for(var a in this.getAjax(e),t)-1<a.indexOf("__TD_")&&"__TD_deviceId"!=a&&delete window.localStorage[a];window.sessionStorage.removeItem("__TD_SessionStart"),window.sessionStorage.removeItem("__TD_sessionId")}}};try{e.del()}catch(t){}}(window);var AppSession={type:2,data:{id:"",start:0,duration:0}},appPages=[],appEvents=[],TalkingData={},WebappStart=(new Date).getTime(),eventState=!0,H5Event={addEventListener:function(t,e,a){t.addEventListener?t.addEventListener(e,a,!1):t.attachEvent?t.attachEvent("on"+e,a):t["on"+e]=a},getIeVersion:function(){var t=!1;-1!=navigator.userAgent.indexOf("MSIE")&&(1<(t=navigator.appVersion.split(";")).length&&(t=parseInt(t[1].replace(/[ ]/g,"").replace(/MSIE/g,""))));return t},getUrlParam:function(t){var e=window.location.search;if(-1==e.indexOf(t))return"";var a=e.indexOf(t)+t.length,n=-1==e.indexOf("&",a)?e.length:e.indexOf("&",a);return e.substring(a,n)}};function pageLogout(t){if(-1!=window.location.href.indexOf("tdTimecc"))return!1;if(!DTGlobal.appkey)return!1;if(eventState){var e=(new Date).getTime();TDBASE.lealSet(e),SDKPage.onPageEnd(),eventState=!1}}function tdvisibilitichanged(){if(-1!=window.location.href.indexOf("tdTimecc"))return!1;if(!DTGlobal.appkey)return!1;var t=document.visibilityState,e=(new Date).getTime();if(TDBASE.lealSet(e),TD_SDK_CONFIG.PAGE_TIME_OPTIMIZE||!eventState){if("hidden"===t)SDKPage.onPageInvisible();else if("visible"===t){if(!TD_SDK_CONFIG.PAGE_TIME_OPTIMIZE)return;SDKPage.onPageVisible()}}else"hidden"===t&&SDKPage.onPageHideAsEnd()}TDIsWebviewFlag||(H5Event.addEventListener(window,"pagehide",pageLogout),H5Event.addEventListener(window,"beforeunload",pageLogout),H5Event.addEventListener(document,"visibilitychange",tdvisibilitichanged)),function(t,e,a){"undefined"!=typeof module&&module.exports?module.exports=a():"function"==typeof define&&define.amd?define(a):e.Fingerprint=a()}(0,TalkingData,function(){function t(t){var o,e;o=Array.prototype.forEach,e=Array.prototype.map,this.each=function(t,e,a){if(null!==t)if(o&&t.forEach===o)t.forEach(e,a);else if(t.length===+t.length){for(var n=0,i=t.length;n<i;n++)if(e.call(a,t[n],n,t)==={})return}else for(var r in t)if(t.hasOwnProperty(r)&&e.call(a,t[r],r,t)==={})return},this.map=function(t,n,i){var r=[];return null==t?r:e&&t.map===e?t.map(n,i):(this.each(t,function(t,e,a){r[r.length]=n.call(i,t,e,a)}),r)},"object"==(void 0===t?"undefined":_typeof(t))?(this.hasher=t.hasher,this.screen_resolution=t.screen_resolution,this.screen_orientation=t.screen_orientation,this.canvas=t.canvas,this.ie_activex=t.ie_activex):"function"==typeof t&&(this.hasher=t)}return t.prototype={get:function(){var t=[];(t.push(navigator.userAgent),t.push(navigator.language),t.push(screen.colorDepth),this.screen_resolution)&&(void 0!==this.getScreenResolution()&&t.push(this.getScreenResolution().join("x")));return t.push((new Date).getTimezoneOffset()),t.push(this.hasSessionStorage()),t.push(this.hasLocalStorage()),t.push(!!window.indexedDB),document.body?t.push(_typeof(document.body.addBehavior)):t.push("undefined"),t.push(_typeof(window.openDatabase)),t.push(navigator.cpuClass),t.push(navigator.platform),t.push(navigator.doNotTrack),t.push(this.getPluginsString()),this.canvas&&this.isCanvasSupported()&&t.push(this.getCanvasFingerprint()),this.hasher?this.hasher(t.join("###"),31):this.murmurhash3_32_gc(t.join("###"),31)},murmurhash3_32_gc:function(t,e){var a,n,i,r,o,s,l,d;for(a=3&t.length,n=t.length-a,i=e,o=3432918353,s=461845907,d=0;d<n;)l=255&t.charCodeAt(d)|(255&t.charCodeAt(++d))<<8|(255&t.charCodeAt(++d))<<16|(255&t.charCodeAt(++d))<<24,++d,i=27492+(65535&(r=5*(65535&(i=(i^=l=(65535&(l=(l=(65535&l)*o+(((l>>>16)*o&65535)<<16)&4294967295)<<15|l>>>17))*s+(((l>>>16)*s&65535)<<16)&4294967295)<<13|i>>>19))+((5*(i>>>16)&65535)<<16)&4294967295))+((58964+(r>>>16)&65535)<<16);switch(l=0,a){case 3:l^=(255&t.charCodeAt(d+2))<<16;case 2:l^=(255&t.charCodeAt(d+1))<<8;case 1:i^=l=(65535&(l=(l=(65535&(l^=255&t.charCodeAt(d)))*o+(((l>>>16)*o&65535)<<16)&4294967295)<<15|l>>>17))*s+(((l>>>16)*s&65535)<<16)&4294967295}return i^=t.length,i=2246822507*(65535&(i^=i>>>16))+((2246822507*(i>>>16)&65535)<<16)&4294967295,i=3266489909*(65535&(i^=i>>>13))+((3266489909*(i>>>16)&65535)<<16)&4294967295,(i^=i>>>16)>>>0},hasLocalStorage:function(){try{return!!window.localStorage}catch(t){return!0}},hasSessionStorage:function(){try{return!!window.sessionStorage}catch(t){return!0}},isCanvasSupported:function(){var t=document.createElement("canvas");return!(!t.getContext||!t.getContext("2d"))},isIE:function(){return"Microsoft Internet Explorer"===navigator.appName||!("Netscape"!==navigator.appName||!/Trident/.test(navigator.userAgent))},getPluginsString:function(){return this.isIE()&&this.ie_activex?this.getIEPluginsString():this.getRegularPluginsString()},getRegularPluginsString:function(){return this.map(navigator.plugins,function(t){var e=this.map(t,function(t){return[t.type,t.suffixes].join("~")}).join(",");return[t.name,t.description,e].join("::")},this).join(";")},getIEPluginsString:function(){if(window.ActiveXObject){return this.map(["ShockwaveFlash.ShockwaveFlash","AcroPDF.PDF","PDF.PdfCtrl","QuickTime.QuickTime","rmocx.RealPlayer G2 Control","rmocx.RealPlayer G2 Control.1","RealPlayer.RealPlayer(tm) ActiveX Control (32-bit)","RealVideo.RealVideo(tm) ActiveX Control (32-bit)","RealPlayer","SWCtl.SWCtl","WMPlayer.OCX","AgControl.AgControl","Skype.Detection"],function(t){try{return new ActiveXObject(t),t}catch(t){return null}}).join(";")}return""},getScreenResolution:function(){return this.screen_orientation?screen.height>screen.width?[screen.height,screen.width]:[screen.width,screen.height]:[screen.height,screen.width]},getCanvasFingerprint:function(){var t=document.createElement("canvas"),e=t.getContext("2d"),a="https://www.talkingdata.com";return e.textBaseline="top",e.font="14px 'Arial'",e.textBaseline="alphabetic",e.fillStyle="#f60",e.fillRect(125,1,62,20),e.fillStyle="#069",e.fillText(a,2,15),e.fillStyle="rgba(102, 204, 0, 0.7)",e.fillText(a,4,17),t.toDataURL()}},t}),TalkingData.localStorage={add:function(t,e){this.addLocalStorage(t,e),"sessionId"!=t&&this.addCookie(t,e)},get:function(t){var e=this.getLocalStorage(t);return e||this._getCookie(t)},create:function(){cookie("__TD_LOCAL")||(this._addCookie(""),window.localStorage)},addCookie:function(t,e){if(!window.localStorage){this.create();var a=this.cookieList();a[t]=e;var n=[];for(var i in a)n.push(i+"="+a[i]);this._addCookie(n.join(";"))}},_setCookie:function(){this.cookieList();cookie("__TD_LOCAL","",{expires:1095,path:"/",domain:location.hostname})},_addCookie:function(t){cookie("__TD_LOCAL",t,{expires:1095,path:"/",domain:location.hostname})},_getCookie:function(t){var e=this.cookieList();if(e&&e[t])return e[t]},saveTID2Cookie:function(t){var e=document.domain.split("."),a=[];a.unshift(e.pop());var n=new Date;n.setTime(n.getTime()+31536e6);for(var i="; expires="+n.toUTCString();e.length;){a.unshift(e.pop());var r="__TD_deviceId="+t+";domain="+a.join(".")+";path=/"+i;if(document.cookie=r,-1!==document.cookie.indexOf("__TD_deviceId="+t))break}},getTIDFromCookie:function(){return cookie("__TD_deviceId")},delCookie:function(t){},cookieList:function(){var t=cookie("__TD_LOCAL");return this.format(t)},addLocalStorage:function(t,e){window.localStorage&&("sessionId"==t&&window.sessionStorage?sessionStorage.setItem("__TD_"+t,e):localStorage["__TD_"+t]=e)},delLocalStorage:function(t){window.localStorage&&localStorage.removeItem("__TD_"+t)},getLocalStorage:function(t){if(window.localStorage)return"sessionId"==t&&window.sessionStorage?sessionStorage.getItem("__TD_"+t):localStorage["__TD_"+t]},format:function(t){var e={};if(!t)return e;for(var a=t.split(";"),n=a.length,i=0;i<n;i++){var r=a[i].split("=");2==r.length&&(e[r[0]]=r[1])}return e}},TalkingData.sessionStorage={add:function(t,e){window.sessionStorage&&sessionStorage.setItem("__TD_"+t,e)},get:function(t){return sessionStorage.getItem("__TD_"+t)},remove:function(t){sessionStorage.removeItem("__TD_"+t)}};var TDXHR,TDONOFF=!0,HEATMAP_TDXHR,SMART_TDXHR,TDNUMBER=!1;function UrlRequest(){this.url=TD_SDK_CONFIG.REQUEST_URL,this.opts={},this.requestArray=new Array}UrlRequest.prototype={getAjax:function(n,i,r,o,s,l){if(!TDIsWebviewFlag){var d=this;(function(t){if(0<navigator.userAgent.indexOf("MSIE")){var e=navigator.appVersion.split(";")[1].replace(/[ ]/g,"");if("MSIE6.0"==e||"MSIE7.0"==e)return;if(window.XDomainRequest){var a=new XDomainRequest;a&&(t.error&&"function"==typeof t.error&&(a.onerror=function(){t.error()}),t.timeout&&"function"==typeof t.timeout&&(a.ontimeout=function(){t.timeout()}),t.success&&"function"==typeof t.success&&(a.onload=function(){t.dataType?"json"==t.dataType.toLowerCase()&&t.success(TDJSON.parse(a.responseText)):t.success(a.responseText)}),a.open(t.type,i),a.send(t.param))}}else"HEATMAP"==l?d.sendHeatMapMsg(n,i,r,o,s):"SMART"==l?d.sendSmartMsg(n,i,r,o,s):d.sendMsg(n,i,r,o,s)})({url:i,type:n,param:TDJSON.stringify(r),success:o})}},set:function(t,e,a,n,i,r){this.opts=t,this.send(e,a,n,i,r)},send:function(t,e,a,n,i){a=a||this.url,n=n||"post",this.getAjax(n,a,this.opts,t,e,i)},sendHeatMapMsg:function(t,e,a,n,i){if(HEATMAP_TDXHR)return!1;var r="json";"post"!=t&&"POST"!=t||(a=TDJSON.stringify(a),r="text"),HEATMAP_TDXHR=$$.ajax({type:t,url:e,data:a,dataType:r,success:n,error:i,complete:function(){HEATMAP_TDXHR=void 0}})},sendSmartMsg:function(t,e,a,n,i){if(SMART_TDXHR)return!1;var r="json";"post"!=t&&"POST"!=t||(a=TDJSON.stringify(a),r="text"),SMART_TDXHR=$$.ajax({type:t,url:e,data:a,dataType:r,success:n,error:i,complete:function(){SMART_TDXHR=void 0}})},sendMsg:function(t,e,a,n,i){TDONOFF=!1;var r="json";if("post"!=t&&"POST"!=t||(a=TDJSON.stringify(a),r="text"),localData.get("td-sending-data"))return setTimeout(function(){localData.delLocalStorage("td-sending-data")},3e3),!1;localData.add("td-sending-data","true");var o=!1;TD_SDK_CONFIG&&TD_SDK_CONFIG.REQUEST_ASYN&&(o=TD_SDK_CONFIG.REQUEST_ASYN),TDXHR=$$.ajax({type:t,url:e,data:a,dataType:r,success:n,error:i,async:o,timeout:3e3,complete:function(){TDONOFF=!(TDXHR=void 0),TDNUMBER&&(DTMgr.getAjax(),TDNUMBER=!1),localData.delLocalStorage("td-sending-data"),localData.delLocalStorage("td-unique"),DTMgr.hasNewData&&TD_SDK_CONFIG.AUTO_SEND_EVENT&&(DTMgr.getAjax(),DTMgr.hasNewData=!1)}})}},function(d){d.TDBASE=d.TDBASE||{},TDIsWebviewFlag||(TDBASE.cacheName="cacheList",TDBASE.unique=function(t){t.sort();for(var e=[t[0]],a=1;a<t.length;a++)t[a]!==e[e.length-1]&&e.push(t[a]);return e},TDBASE.getArgs=function(){var t=new Object,e=d.location.search.substring(1);if(!e){var a=d.location.href,n=a.indexOf("?");0<(e=a.substring(n+1)).indexOf("#")&&(e=e.substring(0,e.indexOf("#")))}for(var i=e.split("&"),r=0;r<i.length;r++){var o=i[r].indexOf("=");if(-1!=o){var s=i[r].substring(0,o),l=i[r].substring(o+1);l=decodeURIComponent(l),t[s]=l}}return t},TDBASE.getCommon=function(t){var e;e=localData.get("appkey")?localData.get("appkey"):DTGlobal.appkey;var a,n=t.msg,i={deviceId:DTGlobal.deviceId,appkey:e,appProfile:DTGlobal.appProfile,deviceProfile:DTGlobal.deviceProfile,msgs:n};return DTGlobal.appContext&&DTGlobal.appContext.account&&DTGlobal.appContext.account.accountId?a=DTGlobal.appContext.account.accountId:(d.localStorage&&(a=localStorage.getItem("__TD_customAccountId")),"undefinde"!=typeof a&&null!==a&&(DTGlobal.appContext=DTGlobal.appContext||{},DTGlobal.appContext.account=DTGlobal.appContext.account||{},DTGlobal.appContext.account.accountId=a)),null!=a&&(i.appContext={account:{accountId:a}}),i},TDBASE.getCommonMsg=function(t,e,a,n,i){return{type:2,data:{id:t,start:e,status:a,duration:n||0,pages:[],events:i||[]}}},TDBASE.addSessionStart=function(t,e){var a;localData.add("lastSession",TDJSON.stringify({id:AppSession.data.id,start:AppSession.data.start})),(a=localData.get("td-hold-event"))&&(a=TDJSON.parse(a));var n=TDBASE.getCommonMsg(AppSession.data.id,AppSession.data.start,e,t,a);TDBASE.addMsg(n),localData.delLocalStorage("td-hold-event")},TDBASE.equal=function(t,e){if((void 0===t?"undefined":_typeof(t))!=(void 0===e?"undefined":_typeof(e)))return!1;if(_typeof(t.length)!=_typeof(e.length))return!1;var a=!0,n=[],i=[];for(var r in t)"count"===r||"start"===r||n.push(r);for(var r in e)"count"===r||"start"===r||i.push(r);if(n.length!=i.length)return!1;r=0;for(var o=i.length;r<o;r++)n.push(i[r]);var s=TDBASE.unique(n);for(r=0,o=s.length;r<o;r++){if(!(s[r]in t&&s[r]in e))return!1;if("object"==_typeof(t[s[r]])&&"object"==_typeof(e[s[r]]))a=TDBASE.equal(t[s[r]],e[s[r]]);else if(t[s[r]]!==e[s[r]])return!1}return a},TDBASE.checkIsNeedCollectData=function(t){var e=!0;if(TD_SDK_CONFIG.LIMIT_DATA_MAX_SIZE){var a=parseFloat(TD_SDK_CONFIG.LIMIT_DATA_MAX_SIZE),n=localData.get("sessionMsg");if(n&&t){var i=n.replace(/[^\x00-\xff]/g,"xx").length/1024,r=(i+t.replace(/[^\x00-\xff]/g,"xx").length/1024).toFixed(2);parseFloat(r)>a&&(e=!1,a<i&&(e=!0,localData.delLocalStorage("lastSession"),DTMgr.addlastSession()))}}return e},TDBASE.addGenre=function(t,e,a,n,i,r){if(localData.get("sessionMsg")){if(!TDBASE.checkIsNeedCollectData(TDJSON.stringify(t)))return!1;a&&a(t);var o=sessionStorage.getItem("__TD_curLandUrl");o&&"undefined"!=o&&(t.landUrl=o,t.curLandUrl=[o]);var s=TDJSON.parse(localData.get("sessionMsg")),l=s.msg[s.msg.length-1].data[e];if("events"===e){if(0!=l.length){for(var d=!1,c=0;c<l.length;c++)if(TDBASE.equal(l[c],t)){d=!0,l[c].count+=1,l[c].start=t.start;break}d||l.push(t)}else l.push(t);return void localData.add("sessionMsg",TDJSON.stringify(s))}if("pages"===e){var u=TalkingData.sessionStorage;if(n){var g=u.get("lastPageName"),p=TDBASE.getLastPage();if(p){var f=TDJSON.parse(TDJSON.stringify(p)),h=f.start;f.duration=TDBASE.getDurationSecond(h,t.start),l.push(f)}t.refer=g||"",i||(l.push(t),TDBASE.addLastPage(t),u.add("lastPageName",t.name),u.add("lastPageStartTime",t.start)),localData.add("sessionMsg",TDJSON.stringify(s)),TD_SDK_CONFIG.REQUEST_ASYN||r||TDAPP.send()}else l.push(t),TDBASE.addLastPage(t),localData.add("sessionMsg",TDJSON.stringify(s)),u.add("lastPageName",t.name),u.add("lastPageStartTime",t.start)}else l.push(t),localData.add("sessionMsg",TDJSON.stringify(s))}},TDBASE.getDurationSecond=function(t,e){var a=0;if(t&&e){var n=e-t;a=Math.ceil(n/1e3)}return a},TDBASE.lealSet=function(t){localData.add("leavetime",t);var e=sessionStorage.getItem("__TD_SessionStart");!e&&localStorage.__TD_lastSession&&(e=TDJSON.parse(localStorage.__TD_lastSession).start);var a=0;e&&(a=parseInt((t-e)/1e3)),localData.add("leaveSession",a)},TDBASE.addMsg=function(t){if(localData.get("sessionMsg")){var e=TDJSON.parse(localData.get("sessionMsg"));e.msg.push(t),localData.add("sessionMsg",TDJSON.stringify(e))}else localData.add("sessionMsg",TDJSON.stringify({msg:[t]}))},TDBASE.getLastPage=function(){var t=TalkingData.sessionStorage,e=t.get("lastPageName"),a=1*t.get("lastPageStartTime"),n=localData.get("lastPage");if(n){if(n=TDJSON.parse(n),!Array.isArray(n))return n;for(var i=n.length-1;0<=i;i--){var r=n[i];if(r.name===e&&r.start===a)return r}}},TDBASE.deleteLastPage=function(t,e){var a=localData.get("lastPage");if(a)if(a=TDJSON.parse(a),Array.isArray(a))for(var n=a.length-1;0<=n;n--){var i=a[n];if(t===i.name&&e==i.start){a.splice(n,1),localData.add("lastPage",TDJSON.stringify(a));break}}else localData.delete("lastPage")},TDBASE.addLastPage=function(t){var e=localData.get("lastPage");e?(e=TDJSON.parse(e),Array.isArray(e)&&e.push(t)):e=[t],localData.add("lastPage",TDJSON.stringify(e))},TDBASE.replaceLastPageStartTime=function(t){var e=TalkingData.sessionStorage,a=e.get("lastPageName"),n=1*e.get("lastPageStartTime"),i=localData.get("lastPage"),r=!1;if(i)if(i=TDJSON.parse(i),Array.isArray(i))for(var o=i.length-1;0<=o;o--){var s=i[o];s.name===a&&s.start===n&&(s.start=t,r=!0)}else i.start=t,i=[i],r=!0;return!!r&&(localData.add("lastPage",JSON.stringify(i)),!0)})}(window),function(){if(!DTGlobal.appkey)return console.log("请配置APPKEY");if(!TDIsWebviewFlag){window.localData=TalkingData.localStorage;var r=TalkingData.sessionStorage,a=TD_SDK_CONFIG.LOOP_SEND_DATA?60<=TD_SDK_CONFIG.LOOP_SEND_DATA?TD_SDK_CONFIG.LOOP_SEND_DATA:60:void 0,u={timedif:void 0,state:1,deviceId:0,sessionId:0,local:[],hasNewData:!1,set:function(){var t=this;try{this.setDeviceId(),this.setSession(),this.setSessionTime(),this.setInitTime(),this.setPartner(),this.setResolution(),this.setLanguage(),this.addlastSession(),this.setLandUrl(),this.setPageInfo(),a&&setInterval(function(){t.getAjax()},1e3*a)}catch(t){}try{if(localStorage.__TD_sessionMsg){var e=TDJSON.parse(localData.get("sessionMsg"));1===e.msg[e.msg.length-1].data.status&&TDBASE.addSessionStart(0,2)}else TDBASE.addSessionStart(0,2);this.getAjax()}catch(t){console.log(t)}},setLandUrl:function(){var t=document.referrer,e=r.get("lastPage");t&&e&&"undefinde"!=e&&t==e||r.add("curLandUrl",document.URL),r.add("lastPage",document.URL)},setPageInfo:function(){if(TD_SDK_CONFIG.AUTO_TRACK_URL){if(TD_SDK_CONFIG.PAGE_TITLE){var t=window.location.href;"undefined"!=typeof _TD_PAGE_NAME&&(t=_TD_PAGE_NAME);var e=window.document.title;"undefined"!=typeof _TD_PAGE_TITLE&&(e=_TD_PAGE_TITLE),TDBASE.addGenre({name:t,title:e,start:WebappStart,duration:0,refer:r.get("lastPageName")||(document.referrer?document.referrer:"")},"pages")}else{t=window.location.href;"undefined"!=typeof _TD_PAGE_NAME&&(t=_TD_PAGE_NAME),TDBASE.addGenre({name:t,start:WebappStart,duration:0,refer:r.get("lastPageName")||(document.referrer?document.referrer:"")},"pages")}TD_SDK_CONFIG.PAGE_TIME_OPTIMIZE&&("hidden"===document.visibilityState?r.add("initInvisible","true"):r.remove("initInvisible"))}},setDeviceId:function(){var t="";if(TD_SDK_CONFIG.TDID_SAVED_IN_COOKIE&&(t=localData.getTIDFromCookie())&&localData.add("deviceId",t),t||(t=localData.get("deviceId"))&&TD_SDK_CONFIG.TDID_SAVED_IN_COOKIE&&localData.saveTID2Cookie(t),t)this.deviceId=t;else{if("FINGER"==TD_SDK_CONFIG.TDID_POLICY){var e=new TalkingData.Fingerprint,a=new TalkingData.Fingerprint({screen_resolution:!0}),n=e.get()+""+a.get();NaN==parseInt(n)?this.deviceId=n:this.deviceId=parseInt(n).toString(16),this.deviceId=this.deviceId.replace(/\.|\+|\(|\)/g,"")}else this.deviceId=this.uuid(16,32);localData.add("deviceId",this.deviceId),TD_SDK_CONFIG.TDID_SAVED_IN_COOKIE&&localData.saveTID2Cookie(this.deviceId)}DTGlobal.deviceId=this.deviceId},uuid:function(t,e){var a,n,i="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split(""),r=[];if(e=e||i.length,t)for(a=0;a<t;a++)r[a]=i[0|Math.random()*e];else for(r[8]=r[13]=r[18]=r[23]="-",r[14]="4",a=0;a<36;a++)r[a]||(n=0|16*Math.random(),r[a]=i[19==a?3&n|8:n]);return r.join("")},setSession:function(){var t,e=this.deviceId,a=(parseInt(e,16),(new Date).getTime());-1<this.deviceId.indexOf("-")?t=this.deviceId.split("-")[0]+a:t=this.deviceId+a;if(0<32-t.length)for(var n=0,i=32-t.length;n<i;n++)t+="0";32-t.length<0&&(t=t.substring(0,32)),r.get("sessionId")?t=r.get("sessionId"):(r.add("sessionId",t),DTGlobal.appProfile.partner=document.referrer),AppSession.data.id=this.sessionId=t},setSessionTime:function(){var t;t=(new Date).getTime(),r.get("SessionStart")?t=r.get("SessionStart"):r.add("SessionStart",t),AppSession.data.start=parseInt(t)},setInitTime:function(){localData.get("initTime")?DTGlobal.appProfile.initTime=parseInt(localData.get("initTime")):(DTGlobal.appProfile.initTime=WebappStart,localData.add("initTime",WebappStart))},setPartner:function(){var t=TDBASE.getArgs().td_channelid;null!=t&&(DTGlobal.appProfile.partner=t)},setResolution:function(){var t=[window.screen.width,window.screen.height];DTGlobal.deviceProfile.pixel=t.join("*")},setLanguage:function(){DTGlobal.deviceProfile.language||navigator.userLanguage&&(DTGlobal.deviceProfile.language=navigator.userLanguage)},addlastSession:function(){var t=localData.get("lastSession");if(void 0===t&&(localData.delLocalStorage("sessionMsg"),localData.delLocalStorage("lastSession")),t){var e=TDJSON.parse(t);if(e.id!=AppSession.data.id){var a=localData.get("lastAccessPageData");if(a){localData.delLocalStorage("lastAccessPageData"),a=TDJSON.parse(a);var n=TDBASE.getCommonMsg(e.id,e.start,2);n.data.pages=a,TDBASE.addMsg(n)}var i=TDBASE.getCommonMsg(e.id,e.start,3,parseInt(localData.get("leaveSession")));return TDBASE.addMsg(i),this.timedif=parseInt(((new Date).getTime()-localData.get("leavetime"))/1e3),localData.add("T-%%%-T","{"+new Date(parseInt(localData.get("leavetime"))).toLocaleString().replace(/年|月/g,"-").replace(/日/g," ")+","+new Date(parseInt(AppSession.data.start)).toLocaleString().replace(/年|月/g,"-").replace(/日/g," ")+"}"),void(localData.get("appkey")?localData.get("appkey")==DTGlobal.appkey&&TDBASE.addSessionStart(this.timedif,1):TDBASE.addSessionStart(this.timedif,1))}}else TDBASE.addSessionStart(0,1)},_checkItemIsIn:function(t,e,a){var n=!1;if(a&&t&&e&&0<e.length)for(var i=0;i<e.length;i++){var r=e[i].data[a];if(r&&0<r.length)for(var o=0;o<r.length;o++){var s=r[o];if("events"==a){if(t.id==s.id&&t.start==s.start&&t.count==s.count){n=!0;break}}else if("pages"==a&&t.name==s.name&&t.start==s.start&&t.duration==s.duration){n=!0;break}}}return n},_buildNewList:function(t,e,a){var n=[];if(t&&0<t.length)for(var i=0;i<t.length;i++){var r=t[i];u._checkItemIsIn(r,e,a)||n.push(r)}return n},removeUploadData:function(t){var e=t.msgs,a=[];if(e&&0<e.length&&localData.get("sessionMsg")&&TDJSON.parse(localData.get("sessionMsg")).msg){var n=TDJSON.parse(localData.get("sessionMsg")).msg;if(n&&0<n.length)for(var i=0;i<n.length;i++){var r=n[i],o=r.data.events,s=r.data.pages,l=u._buildNewList(o,e,"events"),d=u._buildNewList(s,e,"pages");r.data.events=l,r.data.pages=d,(0<l.length||0<d.length)&&a.push(r)}}var c={msg:a};localData.add("sessionMsg",TDJSON.stringify(c))},getAjax:function(){var e=this,t=new UrlRequest;localStorage.__TD_sessionMsg||TDBASE.addSessionStart(0,2);var a=TDJSON.parse(localData.get("sessionMsg")),n=TDBASE.getCommon(a),i=localStorage["__TD_td-init-event"];if(i){var r=n.msgs[n.msgs.length-1];if(r){var o=r.data.events;r.data.events=o.concat(TDJSON.parse(i))}}localData.delLocalStorage("td-init-event");for(var s=[],l=0;l<n.msgs.length;l++){var d=n.msgs[l];(2!==d.data.status||d.data.pages&&0!==d.data.pages.length||d.data.events&&0!==d.data.events.length)&&s.push(d)}0!==s.length&&(n.msgs=s,localData.get("appkey")?localData.get("appkey")!=DTGlobal.appkey?t.set(n,function(t){u.removeUploadData(n),localData.delLocalStorage("td-hold-event"),TDBASE.addSessionStart(0,1),e.getAjax()},function(t){console.log(t)}):t.set(n,function(t){u.removeUploadData(n),localData.delLocalStorage("td-hold-event"),TDBASE.addSessionStart(0,2)},function(t){console.log(t)}):t.set(n,function(t){u.removeUploadData(n),localData.delLocalStorage("td-hold-event"),TDBASE.addSessionStart(0,2)},function(t){console.log(t)}),localData.add("appkey",DTGlobal.appkey))},setAccountId:function(t){if(void 0===t)return localData.delLocalStorage("customAccountId"),void(DTGlobal.appContext&&DTGlobal.appContext.account&&delete DTGlobal.appContext.account.accountId);DTGlobal.appContext=DTGlobal.appContext||{},DTGlobal.appContext.account=DTGlobal.appContext.account||{},DTGlobal.appContext.account.accountId=t,localData.add("customAccountId",t)}};window.DTMgr=u,-1==window.location.href.indexOf("tdTimecc")&&(localData.delLocalStorage("td-sending-data"),u.set())}}();var SDKEvent={set:function(t,e,a){if(0<arguments.length)try{var n={count:1,start:(new Date).getTime()};if(null!=t&&(n.id="string"!=typeof t?TDJSON.stringify(t):t),n.label=null!=e?"string"!=typeof e?TDJSON.stringify(e):e:"",null!=a){"object"!=(void 0===(i=a)?"undefined":_typeof(i))||"[object object]"!=Object.prototype.toString.call(i).toLowerCase()||i.length?n.params={params:""}:n.params=a}TDIsWebviewFlag?SDKEvent.hybridEventUpload(n):SDKEvent.webUpload(n)}catch(t){}var i},webUpload:function(t){TDXHR?TDBASE.addGenre(t,"events",function(t){var e=localData.get("td-hold-event"),a=[];if(a.push(t),e){e=TDJSON.parse(e);for(var n=!1,i=0;i<e.length;i++)if(TDBASE.equal(e[i],t)){e[i].count+=1,e[i].start=t.start,n=!0;break}n||e.push(t),localData.add("td-hold-event",TDJSON.stringify(e))}else localData.add("td-hold-event",TDJSON.stringify(a))}):TDBASE.addGenre(t,"events"),DTMgr.hasNewData=!0,TD_SDK_CONFIG.AUTO_SEND_EVENT&&DTMgr.getAjax()},hybridEventUpload:function(t){if(hybridEvent.send&&TDIsWebviewFlag){var e="",a=[];t.id&&(a=[t.id],e="onEvent",t.label&&(a.push(t.label),e="onEventWithLabel"),t.params&&(t.label&&""!=t.label||a.push(""),a.push(t.params),e="onEventWithParameters")),hybridEvent.send(e,a)}},hybridGetDeviceId:function(t){hybridEvent.send("getDeviceId",[t.name])},hybridSetLocation:function(t,e){hybridEvent.send("setLocation",[t,e])},req:function(){try{DTMgr.getAjax()}catch(t){}},setAccountId:function(t){TDIsWebviewFlag?hybridEvent.send("setAccountId",[t]):DTMgr.setAccountId(t)}};if(window.TDAPP=window.TDAPP||{},window.TDAPP.send=SDKEvent.req,window.TDAPP.onEvent=SDKEvent.set,window.TDAPP.setAccountId=SDKEvent.setAccountId,TDIsWebviewFlag?(TDAPP.getDeviceId=SDKEvent.hybridGetDeviceId,TDAPP.onEventWithLabel=SDKEvent.set,TDAPP.onEventWithParameters=SDKEvent.set,TDAPP.setLocation=SDKEvent.hybridSetLocation):(TDAPP.onEventWithLabel=function(){},TDAPP.onEventWithParameters=function(){},TDAPP.getDeviceId=function(){},TDAPP.setLocation=function(){}),!TDIsWebviewFlag){var SDKPage={onPageStart:function(t,e,a,n,i){if(0<arguments.length){try{TD_SDK_CONFIG.PAGE_TITLE||(e="");var r=t||window.location.href;TD_SDK_CONFIG.PAGE_URL_REPLACE_QUESTION_MARK&&-1!=r.indexOf("?")&&(r=r.replace("?","!"));var o={name:r,title:e||"",start:(new Date).getTime(),duration:0,refer:a||document.referrer||""};TDBASE.addGenre(o,"pages",null,!0,n,i)}catch(t){}TD_SDK_CONFIG.AUTO_TRACK_URL||DTMgr.getAjax()}},onPageEnd:function(t){var e=TDBASE.getLastPage(),a=TalkingData.sessionStorage;localData.delLocalStorage("lastAccessPageData"),e&&(TD_SDK_CONFIG.PAGE_TIME_OPTIMIZE&&a.get("initInvisible")||SDKPage.onPageStart(e.name,e.title,e.refer,!0,t),TDBASE.deleteLastPage(e.name,e.start))},onPageInvisible:function(){var t=TDBASE.getLastPage(),e=TalkingData.sessionStorage;if(t){var a=TDJSON.parse(TDJSON.stringify(t));a.duration=TDBASE.getDurationSecond(a.start,(new Date).getTime());var n=TDJSON.parse(localData.get("sessionMsg"));n.msg[n.msg.length-1].data.pages.push(a),localData.add("sessionMsg",TDJSON.stringify(n)),e.add("invisible",TDJSON.stringify(t)),TDBASE.deleteLastPage(t.name,t.start)}},onPageVisible:function(){var t=(new Date).getTime(),e=TalkingData.sessionStorage;e.remove("initInvisible");var a=TDBASE.replaceLastPageStartTime(t);if(e.add("lastPageStartTime",t),!a){var n=e.get("invisible");n&&((n=TDJSON.parse(n)).start=t,TDBASE.addLastPage(n))}e.remove("invisible")},onPageHideAsEnd:function(){var t=TDBASE.getLastPage();if(t){var e=TDJSON.parse(TDJSON.stringify(t));e.duration=TDBASE.getDurationSecond(e.start,(new Date).getTime());var a=localData.get("lastAccessPageData");if(a){a=TDJSON.parse(a);for(var n=0;n<a.length;n++){var i=a[n];if(i.name==e.name&&i.start==e.start){i.duration=e.duration,!0;break}}a.push(e)}else a=[e];localData.add("lastAccessPageData",TDJSON.stringify(a))}}};window.TDAPP=window.TDAPP||{},window.TDAPP.onCustomPage=SDKPage.onPageStart}var TdHeatMap=function(){var t,i={defaultRadius:40,defaultRenderer:"canvas2d",defaultGradient:{.25:"rgb(0,0,255)",.55:"rgb(0,255,0)",.85:"yellow","1.0":"rgb(255,0,0)"},defaultMaxOpacity:1,defaultMinOpacity:0,defaultBlur:.85,defaultXField:"x",defaultYField:"y",defaultValueField:"value",plugins:{}},r=function(){function t(t){this._coordinator={},this._data=[],this._radi=[],this._min=10,this._max=1,this._xField=t.xField||t.defaultXField,this._yField=t.yField||t.defaultYField,this._valueField=t.valueField||t.defaultValueField,t.radius&&(this._cfgRadius=t.radius)}var u=i.defaultRadius;return t.prototype={_organiseData:function(t,e){var a=t[this._xField],n=t[this._yField],i=this._radi,r=this._data,o=this._max,s=this._min,l=t[this._valueField]||1,d=t.radius||this._cfgRadius||u;r[a]||(r[a]=[],i[a]=[]),r[a][n]?r[a][n]+=l:(r[a][n]=l,i[a][n]=d);var c=r[a][n];return o<c?(e?this.setDataMax(c):this._max=c,!1):c<s?(e?this.setDataMin(c):this._min=c,!1):{x:a,y:n,value:l,radius:d,min:s,max:o}},_unOrganizeData:function(){var t=[],e=this._data,a=this._radi;for(var n in e)for(var i in e[n])t.push({x:n,y:i,radius:a[n][i],value:e[n][i]});return{min:this._min,max:this._max,data:t}},_onExtremaChange:function(){this._coordinator.emit("extremachange",{min:this._min,max:this._max})},addData:function(){if(0<arguments[0].length)for(var t=arguments[0],e=t.length;e--;)this.addData.call(this,t[e]);else{var a=this._organiseData(arguments[0],!0);a&&(0===this._data.length&&(this._min=this._max=a.value),this._coordinator.emit("renderpartial",{min:this._min,max:this._max,data:[a]}))}return this},setData:function(t){var e=t.data,a=e.length;this._data=[],this._radi=[];for(var n=0;n<a;n++)this._organiseData(e[n],!1);return this._max=t.max,this._min=t.min||0,this._onExtremaChange(),this._coordinator.emit("renderall",this._getInternalData()),this},removeData:function(){},setDataMax:function(t){return this._max=t,this._onExtremaChange(),this._coordinator.emit("renderall",this._getInternalData()),this},setDataMin:function(t){return this._min=t,this._onExtremaChange(),this._coordinator.emit("renderall",this._getInternalData()),this},setCoordinator:function(t){this._coordinator=t},_getInternalData:function(){return{max:this._max,min:this._min,data:this._data,radi:this._radi}},getData:function(){return this._unOrganizeData()}},t}(),e=function(){function r(t){var e=t.gradient||t.defaultGradient,a=document.createElement("canvas"),n=a.getContext("2d");a.width=256,a.height=1;var i=n.createLinearGradient(0,0,256,1);for(var r in e)i.addColorStop(r,e[r]);return n.fillStyle=i,n.fillRect(0,0,256,1),n.getImageData(0,0,256,1).data}function h(t,e){var a=document.createElement("canvas"),n=a.getContext("2d"),i=t,r=t;if(a.width=a.height=2*t,1==e)n.beginPath(),n.arc(i,r,t,0,2*Math.PI,!1),n.fillStyle="rgba(0,0,0,1)",n.fill();else{var o=n.createRadialGradient(i,r,t*e,i,r,t);o.addColorStop(0,"rgba(0,0,0,1)"),o.addColorStop(1,"rgba(0,0,0,0)"),n.fillStyle=o,n.fillRect(0,0,2*t,2*t)}return a}function p(t){var e=[];if(t&&0<t.length)for(var a in t)isNaN(a)||e.push(a);return e}function t(t){var e=t.container,a=this.shadowCanvas=document.createElement("canvas"),n=this.canvas=t.canvas||document.createElement("canvas"),i=(this._renderBoundaries=[1e4,1e4,0,0],getComputedStyle(t.container)||{});n.className="heatmap-canvas",this._width=n.width=a.width=t.width||+i.width.replace(/px/,""),this._height=n.height=a.height=t.height||+i.height.replace(/px/,""),this.shadowCtx=a.getContext("2d"),this.ctx=n.getContext("2d"),n.style.cssText=a.style.cssText="position:absolute;left:0;top:0;",e.style.position="relative",e.appendChild(n),this._palette=r(t),this._templates={},this._setStyles(t)}return t.prototype={renderPartial:function(t){0<t.data.length&&(this._drawAlpha(t),this._colorize())},renderAll:function(t){this._clear(),0<t.data.length&&(this._drawAlpha(function(t){for(var e=[],a=t.min,n=t.max,i=t.radi,r=(t=t.data,p(t)),o=r.length;o--;)for(var s=r[o],l=p(t[s]),d=l.length;d--;){var c=l[d],u=t[s][c],g=i[s][c];e.push({x:s,y:c,value:u,radius:g})}return{min:a,max:n,data:e}}(t)),this._colorize())},_updateGradient:function(t){this._palette=r(t)},updateConfig:function(t){t.gradient&&this._updateGradient(t),this._setStyles(t)},setDimensions:function(t,e){this._width=t,this._height=e,this.canvas.width=this.shadowCanvas.width=t,this.canvas.height=this.shadowCanvas.height=e},_clear:function(){this.shadowCtx.clearRect(0,0,this._width,this._height),this.ctx.clearRect(0,0,this._width,this._height)},_setStyles:function(t){this._blur=0==t.blur?0:t.blur||t.defaultBlur,t.backgroundColor&&(this.canvas.style.backgroundColor=t.backgroundColor),this._width=this.canvas.width=this.shadowCanvas.width=t.width||this._width,this._height=this.canvas.height=this.shadowCanvas.height=t.height||this._height,this._opacity=255*(t.opacity||0),this._maxOpacity=255*(t.maxOpacity||t.defaultMaxOpacity),this._minOpacity=255*(t.minOpacity||t.defaultMinOpacity),this._useGradientOpacity=!!t.useGradientOpacity},_drawAlpha:function(t){for(var e=this._min=t.min,a=this._max=t.max,n=(t=t.data||[]).length,i=1-this._blur;n--;){var r,o=t[n],s=o.x,l=o.y,d=o.radius,c=Math.min(o.value,a),u=s-d,g=l-d,p=this.shadowCtx;this._templates[d]?r=this._templates[d]:this._templates[d]=r=h(d,i);var f=(c-e)/(a-e);p.globalAlpha=f<.01?.01:f,p.drawImage(r,u,g),u<this._renderBoundaries[0]&&(this._renderBoundaries[0]=u),g<this._renderBoundaries[1]&&(this._renderBoundaries[1]=g),u+2*d>this._renderBoundaries[2]&&(this._renderBoundaries[2]=u+2*d),g+2*d>this._renderBoundaries[3]&&(this._renderBoundaries[3]=g+2*d)}},_colorize:function(){var t=this._renderBoundaries[0],e=this._renderBoundaries[1],a=this._renderBoundaries[2]-t,n=this._renderBoundaries[3]-e,i=this._width,r=this._height,o=this._opacity,s=this._maxOpacity,l=this._minOpacity,d=this._useGradientOpacity;t<0&&(t=0),e<0&&(e=0),i<t+a&&(a=i-t),r<e+n&&(n=r-e);for(var c=this.shadowCtx.getImageData(t,e,a,n),u=c.data,g=u.length,p=this._palette,f=3;f<g;f+=4){var h,v=u[f],D=4*v;if(D)h=0<o?o:v<s?v<l?l:v:s,u[f-3]=p[D],u[f-2]=p[1+D],u[f-1]=p[2+D],u[f]=d?p[3+D]:h}c.data=u,this.ctx.putImageData(c,t,e),this._renderBoundaries=[1e3,1e3,0,0]},getValueAt:function(t){var e=this.shadowCtx.getImageData(t.x,t.y,1,1).data[3],a=this._max,n=this._min;return Math.abs(a-n)*(e/255)>>0},getDataURL:function(){return this.canvas.toDataURL()}},t}(),o=(t=!1,"canvas2d"===i.defaultRenderer&&(t=e),t),s=function(){for(var t={},e=arguments.length,a=0;a<e;a++){var n=arguments[a];for(var i in n)t[i]=n[i]}return t},a=function(){var n=function(){function t(){this.cStore={}}return t.prototype={on:function(t,e,a){var n=this.cStore;n[t]||(n[t]=[]),n[t].push(function(t){return e.call(a,t)})},emit:function(t,e){var a=this.cStore;if(a[t])for(var n=a[t].length,i=0;i<n;i++){(0,a[t][i])(e)}}},t}();function t(){var t=this._config=s(i,arguments[0]||{});if(this._coordinator=new n,t.plugin){var e=t.plugin;if(!i.plugins[e])throw new Error("Plugin '"+e+"' not found. Maybe it was not registered.");var a=i.plugins[e];this._renderer=new a.renderer(t),this._store=new a.store(t)}else this._renderer=new o(t),this._store=new r(t);!function(e){var t=e._renderer,a=e._coordinator,n=e._store;a.on("renderpartial",t.renderPartial,t),a.on("renderall",t.renderAll,t),a.on("extremachange",function(t){e._config.onExtremaChange&&e._config.onExtremaChange({min:t.min,max:t.max,gradient:e._config.gradient||e._config.defaultGradient})}),n.setCoordinator(a)}(this)}return t.prototype={addData:function(){return this._store.addData.apply(this._store,arguments),this},removeData:function(){return this._store.removeData&&this._store.removeData.apply(this._store,arguments),this},setData:function(){return this._store.setData.apply(this._store,arguments),this},setDataMax:function(){return this._store.setDataMax.apply(this._store,arguments),this},setDataMin:function(){return this._store.setDataMin.apply(this._store,arguments),this},configure:function(t){return this._config=s(this._config,t),this._renderer.updateConfig(this._config),this._coordinator.emit("renderall",this._store._getInternalData()),this},repaint:function(){return this._coordinator.emit("renderall",this._store._getInternalData()),this},getData:function(){return this._store.getData()},getDataURL:function(){return this._renderer.getDataURL()},getValueAt:function(t){return this._store.getValueAt?this._store.getValueAt(t):this._renderer.getValueAt?this._renderer.getValueAt(t):null}},t}();return{create:function(t){return new a(t)},register:function(t,e){i.plugins[t]=e}}}();!function(){var v={pageId:"",tdPageFlag:"",tdHeatMapData:{},blockPixel:10,calPageLoadDuration:function(){var t=(new Date).getTime()-WebappStart,e={pageName:window.location.href,pageDuration:t};TDAPP.onEvent("_td_page_load_duration","_td_page_load_duration",e)},getElementPath:function(t){var e=this,l=t.path||e.buildElementPath(t),d=l.length,c="";if((e=this).build=function(){for(var t=0;t<d;t++){var e=l[d-1-t],a=e.nodeName;if(a&&"#document"!=a)if(a=a.toLowerCase(),e.id&&c&&-1==c.indexOf("#"))c+="#"+e.id+">";else if(e.previousSibling&&"html"!=a&&"body"!=a){for(var n=e.parentNode,i=n.children||n.childNodes,r=0,o=0;o<i.length;o++){var s=i[o];if(s==e)break;1==s.nodeType&&r++}c+=0!=r?a+"["+r+"]>":a+">"}else c+=a+">"}},e.build(),-1!=c.indexOf("#")){var a=c.split("#");c="#"+a[a.length-1]}return c=c.substring(0,c.length-1)},buildPointByEvent:function(t){var e=t.clientX+document.body.scrollLeft+document.documentElement.scrollLeft,a=t.clientY+document.body.scrollTop+document.documentElement.scrollTop,n=v.blockPixel,i=t.target||t.srcElement,r=v.getTop(i),o=v.getLeft(i),s=i.offsetWidth,l=i.offsetHeight,d=v.getPointCenter(e-o,n),c=v.getPointCenter(a-r,n);return{x:Math.min(s,d),y:Math.min(l,c)}},getPointCenter:function(t,e){var a=t;if(t&&e&&e<t){var n=t/e;a=((n.toString().indexOf("."),Math.floor(n))-1)*e+e/2}return a},buildElementPath:function(t){var e=this,a=[],n=t.target||t.srcElement;return a.push(n),e.build=function(t){t.parentNode&&(a.push(t.parentNode),e.build(t.parentNode))},e.build(n),a},getElementUrl:function(t){for(var e=t.path||this.buildElementPath(t),a=e.length,n="",i=0;i<a;i++){var r=e[a-1-i],o=r.nodeName;if(o&&"a"==(o=o.toLowerCase())){var s=r.getAttribute("href");if(s&&-1==s.indexOf("javascript")&&"#"!=s){n=s;break}}}return n},getElementAttribute:function(t){var e=t.target||t.srcElement,a=v.buildPointByEvent(t);return{path:v.getElementPath(t),url:v.getElementUrl(t),point:{x:v.toDecimal(a.x/e.offsetWidth,3),y:v.toDecimal(a.y/e.offsetHeight,3)}}},onEventByElems:function(t){var e={pageId:v.pageId,elem:v.getElementAttribute(t)};TDAPP.onEvent("_td_heat_map_click","",e),TDAPP.send()},listenerEvent:function(t){v.onEventByElems(t)},getOnEventByElem:function(t){if("body"!=t.tagName&&"BODY"!=t.tagName&&"html"!=t.tagName&&"HTML"!=t.tagName)if(t.hasAttribute("td-event")){var e=t.getAttribute("td-event");v.onEventByValue(e)}else t.parentNode&&v.getOnEventByElem(t.parentNode)},onEventByValue:function(t){if(t){var e=t.split(","),a=e.length,n="",i="";1==a?n=e[0]:2==a&&(n=e[0],i=e[1]),TDAPP.onEvent(n,i)}},onEventByElemAttr:function(t){var e=t.target||t.srcElement;v.getOnEventByElem(e)},getAllAttrElements:function(t){for(var e,a=document.all,n=0;n<a.length;n++){if("body"==(o=a[n].tagName)||"BODY"==o){e=n+1;break}}var i=new Array;if(t)for(var r=e;r<a.length;r++){(o=a[r]).getAttribute(t)&&i.push(o)}else for(r=e;r<a.length;r++){var o=a[r];i.push(o)}return i},bindEventForTdEventElement:function(){var t=document.body||document;H5Event.addEventListener(t,"click",v.onEventByElemAttr)},createHeatMapHtml:function(){v.tdPageFlag;var t=document.getElementById("td-heat-map-panel");t&&t.parentNode.removeChild(t);var e=document.body;e.style.height="auto";var a=v.getWindowsWH(),n=document.createElement("div");n.style.cssText="position: absolute;width: 100%;height: 100%;top: 0;left: 0;z-index:9999;",n.setAttribute("class","td-heat-map-panel"),n.setAttribute("id","td-heat-map-panel"),n.style.height=a.height+"px",n.style.minHeight=a.minHeight+"px";n.innerHTML='<div class="heat-map-bg" style="position: fixed;top: 0;left: 0;width: 100%;height: 100%;background-color: #000;opacity: .3;filter: alpha(opacity=30);-moz-opacity: .3;-khtml-opacity: .3;"></div><div class="heat-map-content" style="position: absolute; top: 0;left: 0;width: 100%;height: 100%;color: #fff;"><div class="heat-map-cavans" id="td-heat-map-cavans" style="height:100%;width:100%;"></div></div>',e.appendChild(n)},changePageStyle:function(){var t=document.getElementsByTagName("*");if(t&&0<t.length)for(var e=0;e<t.length;e++){var a=t[e],n=a.nodeName;n&&"html"!=(n=n.toLowerCase())&&"head"!=n&&"meta"!=n&&"title"!=n&&"link"!=n&&"style"!=n&&"script"!=n&&"textarea"!=n&&"select"!=n&&"input"!=n&&"img"!=n&&"br"!=n&&(a.style.position="relative")}},rendHeatMap:function(){TD_SDK_CONFIG&&TD_SDK_CONFIG.USER_CLICK_MAP_PAGE_AUTO&&v.changePageStyle();var t=v.tdPageFlag;v.createHeatMapHtml(),setTimeout(function(){"tdHeatMap"==t&&v.createHeatMap(),v.createPathHtmlByPath()},200)},filterHeatMapDataByElem:function(t){var e=[];if(t&&0<t.length)for(var a=0;a<t.length;a++){var n=t[a];n.url&&e.push(n)}return e},getHeatMapData:function(){var t=v.tdHeatMapData.elems;return"tdHeatMapLink"==v.tdPageFlag&&(t=v.filterHeatMapDataByElem(t)),t},getObjectByPath:function(t){var e=document.body;if(t)if(-1!=t.indexOf(">")){var a=2,n=t.split(">");if(-1!=t.indexOf("#")){var i=n[0],r=i.substring(1,i.length);e=document.getElementById(r),a=1}for(var o=a;o<n.length;o++){var s=n[o],l=s.indexOf("[")+1,d=s.indexOf("]"),c=0;if(l&&d&&(c=s.substring(l,d)),!(e&&parseInt(c)<e.children.length)){e=null;break}e=e.children[c];var u=s;if(-1!=s.indexOf("[")&&(u=s.substring(0,l-1)),u!=e.nodeName.toLowerCase()){e=null;break}}}else if(-1!=t.indexOf("#")){r=t.substring(1,t.length);e=document.getElementById(r)}return e},transPointByObject:function(t,e){var a=v.getTop(e),n=v.getLeft(e),i=parseInt(parseFloat(t.x)*e.offsetWidth+n),r=parseInt(parseFloat(t.y)*e.offsetHeight+a);return{clickNum:t.clickNum,x:i,y:r}},getPointsByElem:function(t){var e=[],a=v.getObjectByPath(t.path);if(a&&t&&t.points&&0<t.points.length)for(var n=0;n<t.points.length;n++){var i=v.transPointByObject(t.points[n],a);e.push({x:i.x,y:i.y,value:i.clickNum})}return e},rebuildHeatMapData:function(t){var e=[];if((t=t||[])&&0<t.length)for(var a=0;a<t.length;a++){var n=t[a];if(v.getObjectByPath(n.path))for(var i=v.getPointsByElem(n),r=0;r<i.length;r++){var o=i[r];o&&e.push({x:o.x,y:o.y,value:o.value})}}return e},getHeatMapMax:function(t){var e=0;if((t=t||[])&&0<t.length)for(var a=0;a<t.length;a++){var n=t[a];e=Math.max(e,n.value)}return e},createHeatMap:function(){var t=document.querySelector("#td-heat-map-cavans");t.innerHTML="";var e=TdHeatMap.create({container:t,gradient:{.45:"rgb(0,0,255)",.65:"rgb(60,179,113)",.85:"rgb(255,215,0)","1.0":"rgb(205,38,38)"},opacity:0,radius:30}),a=v.getHeatMapData(),n=v.rebuildHeatMapData(a),i={max:v.getHeatMapMax(n),data:n};e.setData(i)},buildHeatMapDataZindex:function(t){var e=0;if((t=t||[])&&0<t.length){e=t.length;for(var a=0;a<t.length;a++){var n=t[a];n.path&&-1!=n.path.indexOf("#")?n.zIndex=e+a+1:n.zIndex=a}}return t},getTop:function(t){var e=t.offsetTop;return null!=t.offsetParent&&(e+=v.getTop(t.offsetParent)),e},getLeft:function(t){var e=t.offsetLeft;return null!=t.offsetParent&&(e+=v.getLeft(t.offsetParent)),e},createPathHtmlByPath:function(){var t=v.getPointsSum(),e=(v.getWindowsWH(),v.tdPageFlag),a=document.querySelector("#td-heat-map-cavans"),n=v.getHeatMapData();if((n=v.buildHeatMapDataZindex(n))&&0<n.length)for(var i=0;i<n.length;i++){var r=n[i];if("html"!=r.path&&"html>body"!=r.path){var o=v.getObjectByPath(r.path);if(o){var s=o.offsetHeight,l=o.offsetWidth,d=v.getTop(o),c=v.getLeft(o);l-=10;var u=document.createElement("div");u.style.position="absolute","tdHeatMapLink"==e?(u.style.background="rgb(110, 172, 249)",u.style.opacity="0.5"):u.style.background="rgba(0,0,0,0)",u.style.zIndex=r.zIndex,u.style.width=l+"px",u.style.height=s+"px",u.style.textAlign="center",u.style.top=d+"px",u.style.left=c+"px",u.style.padding="0 5px",u.style.borderRadius="3px";var g=v.calElementValueBySamePath(r.path),p=0;0<t&&(p=g/t*100,p=v.toDecimal(p,2));var f=g+"（"+p+"%）";if(u.setAttribute("td-heat-map-text",f),u.setAttribute("td-heat-map-value",g),u.setAttribute("td-heat-map-percent",p),u.setAttribute("path",r.path),"tdHeatMapLink"==e){var h=r.uv||"";u.setAttribute("td-heat-map-uv",h),u.style.lineHeight=s+"px",u.style.overflow="hidden",u.style.textOverflow="ellipsis",u.style.whiteSpace="nowrap",u.innerHTML=f,u.setAttribute("title",f)}H5Event.addEventListener(u,"click",v.pathHtmlMouseClick),H5Event.addEventListener(u,"mouseenter",v.pathHtmlMouseEnter),H5Event.addEventListener(u,"mouseleave",v.pathHtmlMouseLeave),a.appendChild(u)}}}},getPointsSum:function(){var t=0,e=v.getHeatMapData();if(e&&0<e.length)for(var a=0;a<e.length;a++)t+=e[a].clickNum;return t},toDecimal:function(t,e){var a=parseFloat(t);if(isNaN(a))return!1;for(var n="1",i=0;i<e;i++)n+="0";var r=(a=Math.floor(t*n)/n).toString(),o=r.indexOf(".");for(0<e&&o<0&&(o=r.length,r+=".");r.length<=o+e;)r+="0";return r},calElementValueBySamePath:function(t){var e=0,a=v.getHeatMapData();if(a&&0<a.length)for(var n=0;n<a.length;n++){var i=a[n];t==i.path&&(e+=i.clickNum)}return e},createTooptipHtml:function(t){var e=v.getWindowsWH(),a=v.tdPageFlag;v.removeToolTipPanel();var n=document.body,i=t.target||t.srcElement,r=v.getTop(i),o=v.getLeft(i),s=r+i.offsetHeight,l=o,d=document.createElement("div");d.setAttribute("id","td-heat-map-tooltip-panel"),d.style.position="absolute",d.style.zIndex="999999",d.style.top=s+"px",d.style.left=o+"px",d.style.padding="8px",d.style.display="inline-block",d.style.background="rgba(0,0,0,0.8)",d.style.color="#fff",d.style.fontSize="12px",d.style.whiteSpace="nowrap",d.style.lineHeight="22px",d.style.borderRadius="3px";var c="",u=i.getAttribute("td-heat-map-text")||0,g=i.getAttribute("td-heat-map-uv")||0,p=i.getAttribute("td-heat-map-value")||0,f=i.getAttribute("td-heat-map-percent")||0;"tdHeatMapLink"==a?(d.style.background="rgba(0,0,0,1)",c+="<div><span>访客数：</span><span>"+g+"</span></div>",c+="<div><span>点击数：</span><span>"+p+"</span></div>",c+="<div><span>点击占比：</span><span>"+f+"%</span></div>"):c+="<div><span>点击数：</span><span>"+u+"</span></div>",d.innerHTML=c,n.appendChild(d),s+d.offsetHeight>=e.minHeight&&s+d.offsetHeight>=e.height&&((s=r-d.offsetHeight)<0&&(s=0),d.style.top=s+"px"),l+d.offsetWidth>=e.width&&((l=e.width-d.offsetWidth)<0&&(l=0),d.style.left=l+"px")},removeToolTipPanel:function(){var t=document.getElementById("td-heat-map-tooltip-panel");if(t){var e=t.parentNode;e&&e.removeChild(t)}},pathHtmlMouseLeave:function(t){v.removeToolTipPanel();var e=v.tdPageFlag,a=t.target||t.srcElement;a.style.border="none",a.style.cursor="default","tdHeatMapLink"==e&&(a.style.background="rgb(110, 172, 249)",a.style.opacity="0.85")},pathHtmlMouseClick:function(t){},pathHtmlMouseEnter:function(t){var e=v.tdPageFlag,a=t.target||t.srcElement;a.style.cursor="pointer","tdHeatMapLink"==e?(a.style.background="rgb(18, 120, 246)",a.style.opacity="0.95"):a.style.border="1px solid #fff",v.createTooptipHtml(t)},getWindowsWH:function(){var t={};return t.width=document.body.clientWidth,t.height=document.body.clientHeight,t.minHeight=window.innerHeight,t},initHeatMapData:function(t){var e=TDJSON.parse(t.data);v.tdPageFlag=e.tdPageFlag||"",v.tdHeatMapData=e.data,v.initHeatMap()},getSourceId:function(){var t="",e=TD_SDK_CONFIG.SDK_VERSION||"";if(e&&-1!=e.indexOf("+")){var a=e.split("+")[0];"WEB"==a?t="1":"H5"==a&&(t="2")}return t},checkIsCollectHeatMapData:function(){var t=DTGlobal.appkey||"",e=v.getSourceId();if(!t||!e||!TD_SDK_CONFIG.USER_CLICK_MAP_REQURL)return!1;var a={appkey:t,sourceid:e,url:window.location.href};(new UrlRequest).set(a,function(t){if((t=TDJSON.parse(t))&&t.page){var e=t.page;v.pageId=e.id;var a={pageId:e.id};TDAPP.onEvent("_td_heat_map_pv","",a),v.listenerPageClick()}},function(t){console.log(t)},TD_SDK_CONFIG.USER_CLICK_MAP_REQURL,"post","HEATMAP")},initHeatMap:function(){var t=v.tdPageFlag;"tdHeatMap"==t||"tdHeatMapLink"==t?(v.rendHeatMap(),window.onresize=function(){v.rendHeatMap()}):v.checkIsCollectHeatMapData()},listenerPageClick:function(){var t=document.body||document;H5Event.addEventListener(t,"click",v.listenerEvent)},postMsgToParentWindow:function(){window.parent.postMessage("iframeDomHasLoaded","*")},listenerPageLoaded:function(){if(document.addEventListener)document.addEventListener("DOMContentLoaded",function(){v.postMsgToParentWindow()},!1);else if(document.all&&!window.opera&&H5Event.getIeVersion()<9){document.write('<script type="text/javascript" id="tdContentLoadTag" defer="defer" src="javascript:void(0)"><\/script>'),document.getElementById("tdContentLoadTag").onreadystatechange=function(){"complete"==this.readyState&&v.postMsgToParentWindow()}}},init:function(){TD_SDK_CONFIG.EVENT_BY_ELEMENT&&v.bindEventForTdEventElement(),TD_SDK_CONFIG.PAGE_LOAD_DURATION&&v.calPageLoadDuration(),TDIsWebviewFlag||TD_SDK_CONFIG.USER_CLICK_MAP&&(window.frames.length!=parent.frames.length?(v.listenerPageLoaded(),H5Event.addEventListener(window,"message",v.initHeatMapData)):v.initHeatMap())}};v.init()}();})();
</script>

</body>
</html>
