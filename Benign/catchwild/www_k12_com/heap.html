<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>heap.html</title>
</head>
<body>

<script>
/*! For license information please see heap.js.LICENSE.txt */
!function(){var e={984:function(e,t,n){e=n.nmd(e),function(t){var n,r=null,i=4096,a=i,o=null,s=function e(t,n){return n||0===n||(n=16),e.generator(t=t||128,n)()};"exports"in e?e.exports=s:("undefined"!=typeof globalThis&&(t=globalThis),t.cryptohat=s),"subtle"in globalThis.crypto?n=globalThis.crypto:"webcrypto"in globalThis.crypto&&(n=globalThis.crypto.webcrypto),"function"==typeof(n||{}).getRandomValues?(i/=4,r=new Uint32Array(i),a=i,o=function(){a===i&&(a=0,n.getRandomValues(r));var e=r[a];return a+=1,e},s._engine="window.crypto.getRandomValues()"):(o=function(){return Math.floor(4294967296*Math.random())},s._engine="Math.random()");var u={};s.generator=function(e,t){var n=t?e.toString()+"."+t.toString():e.toString(),r=u[n];return r||(r=t?p(e,t):c(e),u[n]=r),r};var c=function(e){if(e>53)throw RangeError("JavaScript numbers can accurately represent at most 53 bits");if(e<32){var t=(1<<e)-1;return function(){return o()&t}}if(e>32){t=Math.pow(2,e-32)-1;return function(){return o()+4294967296*(o()&t)}}return o},l="0123456789abcdefghijklmnopqrstuvwxyz".split(""),f=function(e,t,n){for(var r=n.length,i=e.length,a=r-1;a>=0;--a){for(var o=0,s=0;s<i;++s)o=4294967296*o+e[s],e[s]=Math.floor(o/t),o%=t;n[a]=l[o]}return n.join("")};s._array32ToString=f;var d=null;d="function"==typeof String.prototype.repeat?function(e){return"0".repeat(e)}:function(e){for(var t="",n=0;n<e;++n)t+="0";return t},s._zeroRepeat=d;var h=function(e,t){var n=t-e.length;return n>0&&(e=d(n)+e),e};s._zeroPad=h;var v=function(e,t,n){for(var r="",i=0;i<e.length;++i)r+=h(e[i].toString(16),8);var a=r.length-n.length;return a>0&&(r=r.substring(a)),r};s._array32ToHexString=v;var p=function(e,t){if(t<2||t>36)throw RangeError("The base argument must be between 2 and 36");var n=function(e,t){return Math.ceil(e*Math.LN2/Math.log(t))}(e,t);if(e<=53){var r=s.generator(e,0);return function(){return h(r().toString(t),n)}}for(var i=[],a=0;a<n;++a)i[a]="0";var u=Math.floor((e+31)/32),c=[];for(a=0;a<u;++a)c[a]=0;var l=16===t?v:f;return e%32==0?function(){for(var e=0;e<u;++e)c[e]=o();return l(c,t,i)}:(mask=Math.pow(2,e%32)-1,function(){c[0]=o()&mask;for(var e=1;e<u;++e)c[e]=o();return l(c,t,i)})}}(this)},948:function(e,t,n){var r=n(635).default;function i(){"use strict";e.exports=i=function(){return t},e.exports.__esModule=!0,e.exports.default=e.exports;var t={},n=Object.prototype,a=n.hasOwnProperty,o=Object.defineProperty||function(e,t,n){e[t]=n.value},s="function"==typeof Symbol?Symbol:{},u=s.iterator||"@@iterator",c=s.asyncIterator||"@@asyncIterator",l=s.toStringTag||"@@toStringTag";function f(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{f({},"")}catch(e){f=function(e,t,n){return e[t]=n}}function d(e,t,n,r){var i=t&&t.prototype instanceof p?t:p,a=Object.create(i.prototype),s=new A(r||[]);return o(a,"_invoke",{value:S(e,n,s)}),a}function h(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}t.wrap=d;var v={};function p(){}function g(){}function m(){}var y={};f(y,u,(function(){return this}));var w=Object.getPrototypeOf,b=w&&w(w(P([])));b&&b!==n&&a.call(b,u)&&(y=b);var _=m.prototype=p.prototype=Object.create(y);function k(e){["next","throw","return"].forEach((function(t){f(e,t,(function(e){return this._invoke(t,e)}))}))}function I(e,t){function n(i,o,s,u){var c=h(e[i],e,o);if("throw"!==c.type){var l=c.arg,f=l.value;return f&&"object"==r(f)&&a.call(f,"__await")?t.resolve(f.__await).then((function(e){n("next",e,s,u)}),(function(e){n("throw",e,s,u)})):t.resolve(f).then((function(e){l.value=e,s(l)}),(function(e){return n("throw",e,s,u)}))}u(c.arg)}var i;o(this,"_invoke",{value:function(e,r){function a(){return new t((function(t,i){n(e,r,t,i)}))}return i=i?i.then(a,a):a()}})}function S(e,t,n){var r="suspendedStart";return function(i,a){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===i)throw a;return N()}for(n.method=i,n.arg=a;;){var o=n.delegate;if(o){var s=E(o,n);if(s){if(s===v)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var u=h(e,t,n);if("normal"===u.type){if(r=n.done?"completed":"suspendedYield",u.arg===v)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(r="completed",n.method="throw",n.arg=u.arg)}}}function E(e,t){var n=t.method,r=e.iterator[n];if(void 0===r)return t.delegate=null,"throw"===n&&e.iterator.return&&(t.method="return",t.arg=void 0,E(e,t),"throw"===t.method)||"return"!==n&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+n+"' method")),v;var i=h(r,e.iterator,t.arg);if("throw"===i.type)return t.method="throw",t.arg=i.arg,t.delegate=null,v;var a=i.arg;return a?a.done?(t[e.resultName]=a.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,v):a:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,v)}function T(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function O(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function A(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(T,this),this.reset(!0)}function P(e){if(e){var t=e[u];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,r=function t(){for(;++n<e.length;)if(a.call(e,n))return t.value=e[n],t.done=!1,t;return t.value=void 0,t.done=!0,t};return r.next=r}}return{next:N}}function N(){return{value:void 0,done:!0}}return g.prototype=m,o(_,"constructor",{value:m,configurable:!0}),o(m,"constructor",{value:g,configurable:!0}),g.displayName=f(m,l,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===g||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,m):(e.__proto__=m,f(e,l,"GeneratorFunction")),e.prototype=Object.create(_),e},t.awrap=function(e){return{__await:e}},k(I.prototype),f(I.prototype,c,(function(){return this})),t.AsyncIterator=I,t.async=function(e,n,r,i,a){void 0===a&&(a=Promise);var o=new I(d(e,n,r,i),a);return t.isGeneratorFunction(n)?o:o.next().then((function(e){return e.done?e.value:o.next()}))},k(_),f(_,l,"Generator"),f(_,u,(function(){return this})),f(_,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},t.values=P,A.prototype={constructor:A,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(O),!e)for(var t in this)"t"===t.charAt(0)&&a.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function n(n,r){return o.type="throw",o.arg=e,t.next=n,r&&(t.method="next",t.arg=void 0),!!r}for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r],o=i.completion;if("root"===i.tryLoc)return n("end");if(i.tryLoc<=this.prev){var s=a.call(i,"catchLoc"),u=a.call(i,"finallyLoc");if(s&&u){if(this.prev<i.catchLoc)return n(i.catchLoc,!0);if(this.prev<i.finallyLoc)return n(i.finallyLoc)}else if(s){if(this.prev<i.catchLoc)return n(i.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return n(i.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&a.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var i=r;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var o=i?i.completion:{};return o.type=e,o.arg=t,i?(this.method="next",this.next=i.finallyLoc,v):this.complete(o)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),v},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),O(n),v}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var i=r.arg;O(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:P(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),v}},t}e.exports=i,e.exports.__esModule=!0,e.exports.default=e.exports},635:function(e){function t(n){return e.exports=t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e.exports.__esModule=!0,e.exports.default=e.exports,t(n)}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports},275:function(e,t,n){var r=n(635),i=n(948)();e.exports=i;try{regeneratorRuntime=i}catch(e){"object"===("undefined"==typeof globalThis?"undefined":r(globalThis))?globalThis.regeneratorRuntime=i:Function("r","regeneratorRuntime = r")(i)}}},t={};function n(r){var i=t[r];if(void 0!==i)return i.exports;var a=t[r]={id:r,loaded:!1,exports:{}};return e[r].call(a.exports,a,a.exports,n),a.loaded=!0,a.exports}n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,{a:t}),t},n.d=function(e,t){for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.nmd=function(e){return e.paths=[],e.children||(e.children=[]),e},function(){"use strict";function e(e,t,n,r,i,a,o){try{var s=e[a](o),u=s.value}catch(e){return void n(e)}s.done?t(u):Promise.resolve(u).then(r,i)}function t(t){return function(){var n=this,r=arguments;return new Promise((function(i,a){var o=t.apply(n,r);function s(t){e(o,i,a,s,u,"next",t)}function u(t){e(o,i,a,s,u,"throw",t)}s(void 0)}))}}function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}function i(e){var t=function(e,t){if("object"!==r(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t||"default");if("object"!==r(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===r(t)?t:String(t)}function a(e,t,n){return(t=i(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var o=n(275),s=n.n(o);function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function c(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,i(r.key),r)}}function l(e,t,n){return t&&c(e.prototype,t),n&&c(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function f(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function d(e){return d=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},d(e)}function h(){return h="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=d(e)););return e}(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(arguments.length<3?e:n):i.value}},h.apply(this,arguments)}function v(e,t){return v=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},v(e,t)}function p(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&v(e,t)}function g(e,t){if(t&&("object"===r(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return f(e)}function m(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function y(e,t){if(e){if("string"==typeof e)return m(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?m(e,t):void 0}}function w(e){return function(e){if(Array.isArray(e))return m(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||y(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var b=function(e){return e.NONE="none",e.ERROR="error",e.WARN="warn",e.INFO="info",e.DEBUG="debug",e.TRACE="trace",e}({}),_=function(e){return e.METADATA_USER="meta_user",e.METADATA_SESSION="meta_session",e.METADATA_PAGEVIEW="meta_pageview",e}({}),k=function(e){return e.CORE_TRACK="core_track",e.CORE_IDENTIFY_v3="core_identify_v3",e.CORE_ADD_USER_PROPERTIES="core_aup",e}({}),I=function(e){return e.COOKIES="cookies",e.LOCAL_STORAGE="localstorage",e}({}),S=l((function e(){u(this,e),a(this,"setItem",(function(e,t){sessionStorage.setItem(e,JSON.stringify(t))})),a(this,"getItem",(function(e){var t=sessionStorage.getItem(e);if(!t)return null;try{return JSON.parse(t)}catch(e){return t}})),a(this,"removeItem",(function(e){sessionStorage.removeItem(e)}))})),E="_hp5_logger",T=function(){function e(t){var n=this;u(this,e),a(this,"persistentStorage",new S),a(this,"getLogLevelFromStorage",(function(e){return n.persistentStorage.getItem("".concat(E,".").concat(e))})),a(this,"setLogLevel",(function(e,t){n.logLevel=e,t&&n.persistentStorage.setItem("".concat(E,".").concat(t),e)})),this.logLevel=null!=t?t:b.NONE}return l(e,[{key:"log",value:function(e,t,n){if(this.logLevel!==b.NONE){var i=Array.isArray(t)||"object"===r(t)&&null!==t?t:{context:t};console.log(e,t?i:"")}}},{key:"error",value:function(e,t){[b.TRACE,b.DEBUG,b.INFO,b.WARN,b.ERROR].includes(this.logLevel)&&this.log(e,t,b.ERROR)}},{key:"warn",value:function(e,t){[b.TRACE,b.DEBUG,b.INFO,b.WARN].includes(this.logLevel)&&this.log(e,t,b.DEBUG)}},{key:"info",value:function(e,t){[b.TRACE,b.DEBUG,b.INFO].includes(this.logLevel)&&this.log(e,t,b.DEBUG)}},{key:"debug",value:function(e,t){[b.TRACE,b.DEBUG].includes(this.logLevel)&&this.log(e,t,b.DEBUG)}},{key:"trace",value:function(e,t){this.logLevel===b.TRACE&&this.log(e,t,b.TRACE)}}],[{key:"getInstance",value:function(){return e.instance||(e.instance=new e(b.NONE)),e.instance}}]),e}(),O=T.getInstance();function A(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,a,o,s=[],u=!0,c=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;u=!1}else for(;!(u=(r=a.call(n)).done)&&(s.push(r.value),s.length!==t);u=!0);}catch(e){c=!0,i=e}finally{try{if(!u&&null!=n.return&&(o=n.return(),Object(o)!==o))return}finally{if(c)throw i}}return s}}(e,t)||y(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var P=n(984),N=function(){return String((0,P.generator)(53)())},R=604800,x=255,C=1024,B=340776e5,D=18e5,j=["data-heap-redact-text","data-cs-mask"],M=function(e){return"[object String]"===Object.prototype.toString.call(e)},U=function(e){return"[object Number]"===Object.prototype.toString.call(e)},L=function(e){return"[object Boolean]"===Object.prototype.toString.call(e)},F=function(e){return"[object Object]"===Object.prototype.toString.call(e)},z=function(e){return"function"==typeof e},V=function(e,t){return(new n.g.TextEncoder).encode(e).length<=t},J=function(e){return/^\d+$/.test(e)};function q(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return H(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return H(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}function H(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var K=function(e,t){var n,r="",i=0,a=q(e);try{for(a.s();!(n=a.n()).done;){var o=n.value,s=o.codePointAt(0),u=s&&s>65535?2:1;if(!(i+u<=t))break;r+=o,i+=u}}catch(e){a.e(e)}finally{a.f()}return r},Q=function(e,t){var n={};return Object.entries(e).forEach((function(e){var r=A(e,2),i=r[0],a=r[1];if(t)n[i]=a;else if(V(i,512))if(null!=a&&""!==a)if(M(a)||U(a)||L(a)){var o=a;if(M(o)&&!V(o,C))o=K(o,C),O.warn("Property ".concat(i," exceeded ").concat(C," UTF-16 code units and was truncated."));n[i]=o}else O.warn("Property ".concat(i," was omitted because its value is not a string, number or boolean."));else O.warn("Property ".concat(i," was omitted because its value is blank."));else O.warn("Property ".concat(i," was omitted because its name exceeds ").concat(512," UTF-16 code units."))})),O.trace("Sanitized properties",{before:e,after:n}),n},Z=function(e){return Object.fromEntries(Object.entries(e).filter((function(e){var t=A(e,2);t[0];return void 0!==t[1]})))},G=/[a-zA-Z0-9._%+-]+(?:@|%40|%2540)[a-zA-Z0-9.%-_]+((?:\.|%2[eE])[a-zA-Z0-9-]+)+/g,Y=/[a-zA-Z0-9+_-](?:@|%40|%2540)/,W="([-A-Za-z0-9+/=_]|=[^=]|={3,})+",X=new RegExp("(ey".concat(W,"\\.ey").concat(W,"\\.").concat(W,")"),"g"),$=/[0-9]{4}/,ee=/(^|[^a-zA-Z0-9*.,-])([45*][0-9*]{3}([ -]?)[0-9*]{4}\3[0-9*]{4}\3[0-9*]{4})($|[^a-zA-Z0-9*.,-])/g,te=function(){function e(){u(this,e)}return l(e,[{key:"anonymizePII",value:function(e){return"string"==typeof e&&(e=this.anonymizeEmail(e)),e}},{key:"anonymizeEmail",value:function(e){return Y.test(e)?e.replace(G,"CS_ANONYMIZED_EMAIL"):e}},{key:"anonymizeCreditCard",value:function(e){var t=this;return $.test(e)?e.replace(ee,(function(e,n,r,i,a){if(-1===r.indexOf("*")){var o=i.length?r.split(i).join(""):r;if(!t.checkLuhn(o))return e}return"".concat(n).concat("CS_ANONYMIZED_PII").concat(a)})):e}},{key:"checkLuhn",value:function(e){for(var t=parseInt(e[e.length-1],10),n=0,r=e.length-2;r>=0;r--){var i=parseInt(e[r],10);r%2==0&&(i*=2),n+=Math.floor(i/10)+i%10}return 10-n%10===t}},{key:"anonymizeJwt",value:function(e){return e.replace(X,"CS_ANONYMIZED_JWT")}},{key:"anonymizeFields",value:function(e,t){var n=this;return t.forEach((function(t){e[t]=n.anonymizeEmail(e[t])})),e}}]),e}(),ne=function(e){return e.HeapSideloadsCS="heap_sideloads_cs",e.CsSideloadsHeap="cs_sideloads_heap",e.HeapDrivesCS="heap_drives_cs",e.MappingOnly="mapping_only",e.CsCrossWritesHeap="cs_crosswrites_heap",e}({}),re=[ne.HeapSideloadsCS,ne.HeapDrivesCS],ie=function(){if(ae())return!1;var e=He.getInstance().getCsHeapTagStatus();return e&&re.includes(e)},ae=function(){return!("236035469"!==Is.getInstance().getEnvironmentId()||!window.location.hostname.includes("contentsquare.com"))},oe=[ne.CsSideloadsHeap],se=[ne.CsSideloadsHeap,ne.HeapSideloadsCS],ue=function(){var e=He.getInstance().getCsHeapTagStatus();return e&&oe.includes(e)},ce=function(e){return e.OnNextPageviewOnly="onNextPageviewOnly",e.UserSession="userSession",e}({}),le=function(){var e=He.getInstance().getCsSettings();if(e&&e.csHashedProjId)return"//t.contentsquare.net/uxa/".concat(e.csHashedProjId,".js")},fe=function(){var e=t(s().mark((function e(){var t,n,r;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=le()){e.next=3;break}return e.abrupt("return",!1);case 3:return e.prev=3,e.next=6,fetch(t);case 6:if((n=e.sent).ok){e.next=9;break}return e.abrupt("return",!1);case 9:return e.next=11,n.text();case 11:return r=e.sent,e.abrupt("return",!r.trim());case 15:return e.prev=15,e.t0=e.catch(3),O.trace("Error checking cs tag"),e.abrupt("return",!1);case 19:case"end":return e.stop()}}),e,null,[[3,15]])})));return function(){return e.apply(this,arguments)}}(),de=["id_token","access_token","refresh_token","auth_token"].map((function(e){return new RegExp(e+"(=|%3D).*?(?=%26|&|$)","gi")})),he=function(e){var t;(t=function(e){if(!e||!M(e))return e;var t=e;return de.forEach((function(e){t=t.replace(e,(function(e){var t=-1===e.indexOf("=")?"%3D":"=";return e.split(t)[0]+t+"heap_redacted"}))})),t}(e),ue())&&(t=(new te).anonymizeJwt(t));return t},ve=l((function e(){var t=this;u(this,e),a(this,"setItem",(function(e,t,n){var r={value:t};if(null!=n&&n.expires){var i=new Date;r.expires=i.getTime()+ +(null==n?void 0:n.expires)}localStorage.setItem(e,JSON.stringify(r))})),a(this,"getItem",(function(e){var n=localStorage.getItem(e);if(!n)return null;var r=JSON.parse(n);return r.expires&&t.hasExpired(r.expires)?(t.removeItem(e),null):r.value})),a(this,"hasExpired",(function(e){return(new Date).getTime()>=e})),a(this,"removeItem",(function(e){localStorage.removeItem(e)}))})),pe="props",ge="id",me="ses_props";function ye(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function we(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ye(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ye(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var be=function(e){var t=Is.getInstance().getEnvironmentId();return"".concat("_hp2_").concat(e,".").concat(t)},_e=function(e){var t=new Ei,n=be(e);return t.getItem(n)},ke=function(){var e=_e(ge);if(e){var t=null,n=e.userId,r=e.identity,i=e.sessionId,a={userId:n,identity:r};i!==Is.getInstance().getSessionId()&&(t=function(e){var t,n,r,i,a,o,s,u,c,l,f,d,h=_e(me);if(!h)return null;var v=(new Date).getTime();return{sessionId:e,sessionProperties:{id:e,time:null!==(t=h.ts)&&void 0!==t?t:v,referrer:null!==(n=h.r)&&void 0!==n?n:"",utm:{source:null!==(r=h.us)&&void 0!==r?r:"",medium:null!==(i=h.um)&&void 0!==i?i:"",term:null!==(a=h.ut)&&void 0!==a?a:"",content:null!==(o=h.uc)&&void 0!==o?o:"",campaign:null!==(s=h.ua)&&void 0!==s?s:""},initial_pageview_info:{time:null!==(u=h.ts)&&void 0!==u?u:v,id:"",url:{domain:null!==(c=h.d)&&void 0!==c?c:"",path:null!==(l=h.h)&&void 0!==l?l:"",query:null!==(f=h.q)&&void 0!==f?f:"",hash:null!==(d=h.g)&&void 0!==d?d:""}}},lastEventTime:e?(new Date).getTime():void 0}}(i));var o,s=we(we({},a),t);O.debug("Migration -- updating metadata",{metadata:s}),o=s,Is.getInstance().setMetadata(o)}},Ie=function(){var e;ke(),(e=_e(pe))&&(O.debug("Migration -- updating event properties",{properties:e}),window.heap.clearEventProperties(),window.heap.addEventProperties(e)),(new Se).removeClassicCookiesIfNeeded()},Se=function(){function e(){var t=this;u(this,e),a(this,"_storage",new Ei),a(this,"_idCookie",be(ge)),a(this,"_sessionPropertiesCookie",be(me)),a(this,"_eventPropertiesCookie",be(pe)),a(this,"shouldWriteToV4",(function(){var e;return null!==(e=He.getInstance().getConfig().classicSDKCompatibility&&t.classicCookiesExist())&&void 0!==e&&e})),a(this,"classicCookiesExist",(function(){return t._storage.getItem(t._idCookie)||t._storage.getItem(t._sessionPropertiesCookie)||t._storage.getItem(t._eventPropertiesCookie)})),a(this,"updateIdCookie",(function(e){t._storage.setItem(t._idCookie,JSON.stringify(e),{expires:B}),O.trace("Updated v4 cookie id ".concat(t._idCookie),e)})),a(this,"updateSessionPropertiesCookie",(function(e){var n,r,i,a,o,s,u,c,l,f,d,h,v;if(e){var p={ts:e.time,r:e.referrer,us:null===(n=e.utm)||void 0===n?void 0:n.source,um:null===(r=e.utm)||void 0===r?void 0:r.medium,ut:null===(i=e.utm)||void 0===i?void 0:i.term,uc:null===(a=e.utm)||void 0===a?void 0:a.content,ua:null===(o=e.utm)||void 0===o?void 0:o.campaign,d:null===(s=e.initial_pageview_info)||void 0===s||null===(u=s.url)||void 0===u?void 0:u.domain,h:null===(c=e.initial_pageview_info)||void 0===c||null===(l=c.url)||void 0===l?void 0:l.path,q:null===(f=e.initial_pageview_info)||void 0===f||null===(d=f.url)||void 0===d?void 0:d.query,g:null===(h=e.initial_pageview_info)||void 0===h||null===(v=h.url)||void 0===v?void 0:v.hash},g=t._removeEmptyValues(p);t._storage.setItem(t._sessionPropertiesCookie,JSON.stringify(g),{expires:D}),O.trace("Updated v4 session properties ".concat(t._sessionPropertiesCookie),g)}else t._storage.removeItem(t._sessionPropertiesCookie)})),a(this,"updateMetadata",(function(e){var n={userId:e.userId,sessionId:e.sessionId,identity:e.identity},r=e.sessionProperties;t.updateIdCookie(n),t.updateSessionPropertiesCookie(r)})),a(this,"updateEventProperties",(function(e){t._storage.setItem(t._eventPropertiesCookie,JSON.stringify(e),{expires:B}),O.trace("Updated v4 event properties ".concat(t._eventPropertiesCookie),e)})),a(this,"updateSessionPropsExpiration",(function(e){var n=t._storage.getItem(t._sessionPropertiesCookie);n&&(t._storage.setItem(t._sessionPropertiesCookie,n,{expires:e}),O.trace("Updated v4 session properties ".concat(t._sessionPropertiesCookie," expiration"),e))})),a(this,"removeClassicCookiesIfNeeded",(function(){t.shouldWriteToV4()||(t._storage.removeItem(t._idCookie),t._storage.removeItem(t._sessionPropertiesCookie),t._storage.removeItem(t._eventPropertiesCookie))}))}return l(e,[{key:"_removeEmptyValues",value:function(e){return Object.fromEntries(Object.entries(e).filter((function(e){var t=A(e,2);t[0];return""!==t[1]})))}}],[{key:"deleteV4Cookies",value:function(){var e=be(ge),t=be(me),n=be(pe),r=new Ei;r.removeItem(e),r.removeItem(t),r.removeItem(n)}}]),e}();function Ee(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Te(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ee(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ee(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Oe=function(){function e(t){u(this,e),a(this,"_dualWriteToV4",new Se),this.storageType=t,this._storage=this._getStorageType()}return l(e,[{key:"_isStorageBlocked",value:function(){return He.getInstance().getShouldStopTracking()}},{key:"_getStorageType",value:function(){var e=He.getInstance().getConfig(),t=this.storageType||e.eventPropertiesStorage;return(null==t?void 0:t.toLowerCase())===I.LOCAL_STORAGE?new ve:new Ei}},{key:"_getStorageKey",value:function(){var e=Is.getInstance();return"".concat("_hp5_event_props",".").concat(e.getEnvironmentId())}},{key:"clearProperties",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this._storage.removeItem(this._getStorageKey()),O.debug("Cleared event properties in persistent storage"),e&&this._dualWriteToV4.shouldWriteToV4()&&this._dualWriteToV4.updateEventProperties({})}},{key:"addProperties",value:function(e){if(!this._isStorageBlocked()){var t=this.getProperties(),n=Te(Te({},t),e);this._storage.setItem(this._getStorageKey(),n,{expires:B}),O.debug("Updated event property values in persistent storage",{before:t,after:n}),this._dualWriteToV4.shouldWriteToV4()&&this._dualWriteToV4.updateEventProperties(n)}}},{key:"getProperties",value:function(){return this._storage.getItem(this._getStorageKey())||{}}},{key:"removeEventProperty",value:function(e){var t=Te({},this.getProperties());delete t[e],O.debug("Removed event property ".concat(e," from persistent storage"),{before:this.getProperties(),after:t}),this._storage.setItem(this._getStorageKey(),t,{expires:B}),this._dualWriteToV4.shouldWriteToV4()&&this._dualWriteToV4.updateEventProperties(t)}}],[{key:"getInstance",value:function(){return e.instance||(e.instance=new e),e.instance}}]),e}(),Ae=function(){function e(){u(this,e)}return l(e,[{key:"setUserAgentClientHints",value:function(e){this.userAgentClientHints=e}},{key:"getUserAgentClientHints",value:function(){return this.userAgentClientHints}}],[{key:"getInstance",value:function(){return e.instance||(e.instance=new e),e.instance}}]),e}();function Pe(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ne(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Pe(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Pe(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Re=function(e){var t=new RegExp("#.*");return e.replace(t,"")},xe=function(e,t){t=t||window.location.search,e=e.replace(/[[]/,"\\[").replace(/[\]]/,"\\]");var n=new RegExp("[\\?&]"+e+"=([^&#]*)").exec(t);if(null===n)return"";try{return decodeURIComponent(n[1].replace(/\+/g," "))}catch(e){return""}},Ce=function(e){if(!e)return e;var t=new RegExp("^(?:(?:https?|ftp):)/*(?:[^@]+@)?([^:/#]+)").exec(e);return t?t[1]:e},Be=function(){var e,t=null===(e=Is.getInstance().getMetadata().sessionProperties)||void 0===e?void 0:e.referrer;return Re(t||document.referrer)},De=function(e){var t,n=Ce(e);if(!n)return"";var r=e.slice(e.indexOf("?"));if(n.search("google.([^/?]*)$")>=0||n.search("bing.com$")>=0)t="q";else{if(!(n.search("yahoo.com$")>=0))return"";t="p"}return window.decodeURIComponent(xe(t,r))},je=function(){return{source:xe("utm_source"),medium:xe("utm_medium"),term:xe("utm_term"),content:xe("utm_content"),campaign:xe("utm_campaign")}},Me=function(){var e,t,n,r,i;if(!(arguments.length>0&&void 0!==arguments[0])||arguments[0]){var a,o,s,u=Is.getInstance();n=null===(a=u.getMetadata().setPath)||void 0===a?void 0:a.path,r=null===(o=u.getMetadata().setPath)||void 0===o?void 0:o.query,i=null===(s=u.getMetadata().setPath)||void 0===s?void 0:s.hash}return{domain:window.location.hostname,path:n||window.location.pathname,query:null!==(e=r)&&void 0!==e?e:he(window.location.search),hash:null!==(t=i)&&void 0!==t?t:he(window.location.hash)}},Ue=function(){var e=Ae.getInstance().getUserAgentClientHints();return Ne({user_agent:navigator.userAgent},e&&{uach:e})},Le=function(){var e=He.getInstance();return{name:"web",version:e.getSdkVersion(),platform:"web",properties:{library_domain:e.getLibraryDomain()}}},Fe=function(e){var t=null!=e?e:{},n=Ne(Ne({},ze()),t);return n&&Object.keys(n).length>0?{properties:n}:null},ze=function(){return Oe.getInstance().getProperties()};function Ve(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Je(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ve(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ve(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var qe=function(e){return e.PRIVACY="privacy",e.INGEST_SERVER="ingestServer",e.METADATA_STORAGE="metadataStorage",e.EVENT_PROPERTIES_STORAGE="eventPropertiesStorage",e.CUSTOM_EVENTS="customEvents",e.DISABLE_INTERACTION_EVENTS="disableInteractionEvents",e.CLASSIC_SDK_COMPATIBILITY="classicSDKCompatibility",e.SUPPORTED_DOMAINS="supportedDomains",e.SALESFORCE_AURA="salesforceAura",e.DISABLE_SESSION_REPLAY="disableSessionReplay",e.CLEAR_EVENT_PROPERTIES_ON_NEW_USER="clearEventPropertiesOnNewUser",e.DISABLE_PAGEVIEW_AUTOCAPTURE="disablePageviewAutocapture",e.SDK="sdk",e.CS_SETTINGS="csSettings",e.COMPRESS_COOKIES="compressCookies",e}(qe||{}),He=function(){function e(){u(this,e),a(this,"shouldStopTracking",!1),a(this,"safestSettings",{privacy:{enableSecureCookies:!0,disableTextCapture:!0}}),a(this,"config",{})}return l(e,[{key:"setShouldStopTracking",value:function(e){this.shouldStopTracking=e}},{key:"getShouldStopTracking",value:function(){return this.shouldStopTracking}},{key:"_getEnableSecureCookiesFromClientSideConfig",value:function(e){return L(null==e?void 0:e.enableSecureCookies)?null==e?void 0:e.enableSecureCookies:L(null==e?void 0:e.secureCookie)?null==e?void 0:e.secureCookie:void 0}},{key:"normalizeClientSideConfigToHeapConfig",value:function(e){if(!e)return{};var t={disableTextCapture:e.disableTextCapture,enableSecureCookies:this._getEnableSecureCookiesFromClientSideConfig(e)},n=e.ingestServer||e.trackingServer,r=e.metadataStorage,i=e.eventPropertiesStorage,a=e.customEvents,o=e.disableInteractionEvents,s=e.classicSDKCompatibility,u=e.supportedDomains,c=e.salesforceAura,l=e.disableSessionReplay,f=e.clearEventPropertiesOnNewUser,d=e.disablePageviewAutocapture,h=e.sdk,v=e.csSettings,p=e.compressCookies;return Z({ingestServer:n,privacy:Z(t),metadataStorage:r,eventPropertiesStorage:i,customEvents:a,disableInteractionEvents:o,classicSDKCompatibility:s,supportedDomains:u,salesforceAura:c,disableSessionReplay:l,clearEventPropertiesOnNewUser:f,disablePageviewAutocapture:d,sdk:h,csSettings:v,compressCookies:p})}},{key:"_resolveToClientConfigIfAvailable",value:function(e,t){return e||t}},{key:"_resolveSdk",value:function(e,t){return{domain:(null==e?void 0:e.domain)||(null==t?void 0:t.domain),version:(null==e?void 0:e.version)||(null==t?void 0:t.version),isExperimentalVersion:(null==t?void 0:t.isExperimentalVersion)||!1,plugins:null==t?void 0:t.plugins}}},{key:"_resolvePrivacyConfig",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=Je({},t),r=this.safestSettings.privacy;return Object.keys(e).forEach((function(i){var a,o=e[i];i in r&&i in t&&t[i]!==o?(a=r[i],O.debug("ConfigStore -- Disagreement between client & server-side configs: Using value ".concat(a," for ").concat(i," as safest value"))):a=o,n[i]=a})),n}},{key:"_resolveStorageConfig",value:function(e){return!e||!M(e)||e.toLowerCase()!==I.LOCAL_STORAGE&&e.toLowerCase()!==I.COOKIES?I.COOKIES:e.toLowerCase()}},{key:"_resolveBoolean",value:function(e){return!!L(e)&&e}},{key:"_isValidClientCsSettings",value:function(e){return!(null==e||!e.csProjectId||null==e||!e.heapTagStatus)&&!(null!=e&&e.heapTagStatus&&![ne.CsSideloadsHeap,ne.MappingOnly].includes(e.heapTagStatus))}},{key:"_resolveCsSettings",value:function(e,t){if(t)return this._isValidClientCsSettings(e)?e:(null==t?void 0:t.heapTagStatus)===ne.CsSideloadsHeap&&(null==e?void 0:e.heapTagStatus)!==ne.CsSideloadsHeap?(O.debug("ConfigStore -- _resolveCsSettings -- Disagreement between client & server-side configs for ".concat(ne.CsSideloadsHeap,": Using value ").concat(ne.MappingOnly)),{heapTagStatus:ne.MappingOnly}):t}},{key:"resolveConfig",value:function(e,t){var n,r=(a(n={},qe.PRIVACY,this._resolvePrivacyConfig.bind(this)),a(n,qe.INGEST_SERVER,this._resolveToClientConfigIfAvailable.bind(this)),a(n,qe.METADATA_STORAGE,this._resolveStorageConfig.bind(this)),a(n,qe.EVENT_PROPERTIES_STORAGE,this._resolveStorageConfig.bind(this)),a(n,qe.CUSTOM_EVENTS,this._resolveToClientConfigIfAvailable.bind(this)),a(n,qe.DISABLE_INTERACTION_EVENTS,this._resolveToClientConfigIfAvailable.bind(this)),a(n,qe.CLASSIC_SDK_COMPATIBILITY,this._resolveBoolean.bind(this)),a(n,qe.SUPPORTED_DOMAINS,this._resolveToClientConfigIfAvailable.bind(this)),a(n,qe.SALESFORCE_AURA,this._resolveToClientConfigIfAvailable.bind(this)),a(n,qe.DISABLE_SESSION_REPLAY,this._resolveBoolean.bind(this)),a(n,qe.CLEAR_EVENT_PROPERTIES_ON_NEW_USER,this._resolveBoolean.bind(this)),a(n,qe.DISABLE_PAGEVIEW_AUTOCAPTURE,this._resolveBoolean.bind(this)),a(n,qe.SDK,this._resolveSdk.bind(this)),a(n,qe.CS_SETTINGS,this._resolveCsSettings.bind(this)),a(n,qe.COMPRESS_COOKIES,this._resolveBoolean.bind(this)),n),i=this.normalizeClientSideConfigToHeapConfig(e),o=Je({},t);return Object.keys(r).forEach((function(e){var n=r[e](null==i?void 0:i[e],null==t?void 0:t[e]);o[e]=n})),O.trace("ConfigStore -- resolved config",{clientSideConfig:e,normalizedClientSideConfig:i,serverSideConfig:t,resolvedConfig:o}),o}},{key:"setConfig",value:function(e){this.config=e}},{key:"getConfig",value:function(){return this.config}},{key:"getEnableSecureCookies",value:function(){var e;return!(null===(e=this.config.privacy)||void 0===e||!e.enableSecureCookies)}},{key:"getIntegrations",value:function(){return this.config.integrations||[]}},{key:"getIngestServer",value:function(){return this.getConfig().ingestServer||"https://c.us.heap-api.com"}},{key:"getSdkVersion",value:function(){var e,t=null!==(e=this.getConfig().sdk)&&void 0!==e?e:{},n=t.version,r=t.isExperimentalVersion;return void 0===n?"Unknown version (v5)":r?"".concat(n," (v5 experiment)"):n}},{key:"getLibraryDomain",value:function(){var e,t;return null!==(e=Ce(null===(t=this.getConfig().sdk)||void 0===t?void 0:t.domain))&&void 0!==e?e:"Unknown"}},{key:"getMetadataStorageType",value:function(){return this.config.metadataStorage||I.COOKIES}},{key:"getEventPropertiesStorageType",value:function(){return this.config.eventPropertiesStorage||I.COOKIES}},{key:"isSessionReplayDisabled",value:function(){return this.config.disableSessionReplay}},{key:"getClearEventPropertiesOnNewUser",value:function(){return this.config.clearEventPropertiesOnNewUser}},{key:"getDisablePageviewAutocapture",value:function(){return this.config.disablePageviewAutocapture}},{key:"getCsHeapTagStatus",value:function(){var e,t;return null===(e=this.config)||void 0===e||null===(t=e.csSettings)||void 0===t?void 0:t.heapTagStatus}},{key:"getCsSettings",value:function(){var e;return null===(e=this.config)||void 0===e?void 0:e.csSettings}},{key:"getShouldCompressCookies",value:function(){var e;return!this.config.classicSDKCompatibility&&!(null===(e=this.config)||void 0===e||!e.compressCookies)}}],[{key:"getInstance",value:function(){return e.instance||(e.instance=new e),e.instance}}]),e}(),Ke=function(e){return e.None="None",e.Lax="Lax",e}({}),Qe=function(){return navigator.userAgent},Ze=function(){return e=12,!!(t=Qe().match(/\(iP.+; CPU .*OS (\d+)[_\d]*.*\) AppleWebKit\//))&&parseInt(t[0],10)===e||function(e,t){var n=Qe().match(/\(Macintosh;.*Mac OS X (\d+)_(\d+)[_\d]*.*\) AppleWebKit\//);if(!n)return!1;var r=parseInt(n[0],10),i=parseInt(n[1],10);return r===e&&i===t}(10,14)&&(/Version\/.* Safari/.test(Qe())&&!Ye()||Ge());var e,t},Ge=function(){return/^Mozilla\/[.\d]+ \(Macintosh;.*Mac OS X [_\d]+\) AppleWebKit\/[.\d]+ \(KHTML, like Gecko\)$/.test(Qe())},Ye=function(){return/Chrom(e|ium)/.test(Qe())},We=function(e){var t=Qe().match(/Chrom[^ /]+\/(\d+)[.\d]* /),n=0;return t&&(n=parseInt(t[0],10)),n>=e},Xe=function(){return/UCBrowser\//.test(Qe())?!function(e,t,n){var r=Qe().match(/UCBrowser\/(\d+)\.(\d+)\.(\d+)[.\d]* /);if(!r)return!1;if(0===r.length)return!1;var i=parseInt(r[0],10),a=parseInt(r[1],10),o=parseInt(r[2],10);return i!==e?i>e:a!==t?a>t:o>=n}(12,13,2):Ye()&&We(51)&&!We(67)},$e=function(e){return Ze()||Xe()?null:e?Ke.None:Ke.Lax};function et(e){let t=e.length;for(;--t>=0;)e[t]=0}const tt=256,nt=286,rt=30,it=15,at=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0]),ot=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),st=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7]),ut=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),ct=new Array(576);et(ct);const lt=new Array(60);et(lt);const ft=new Array(512);et(ft);const dt=new Array(256);et(dt);const ht=new Array(29);et(ht);const vt=new Array(rt);function pt(e,t,n,r,i){this.static_tree=e,this.extra_bits=t,this.extra_base=n,this.elems=r,this.max_length=i,this.has_stree=e&&e.length}let gt,mt,yt;function wt(e,t){this.dyn_tree=e,this.max_code=0,this.stat_desc=t}et(vt);const bt=e=>e<256?ft[e]:ft[256+(e>>>7)],_t=(e,t)=>{e.pending_buf[e.pending++]=255&t,e.pending_buf[e.pending++]=t>>>8&255},kt=(e,t,n)=>{e.bi_valid>16-n?(e.bi_buf|=t<<e.bi_valid&65535,_t(e,e.bi_buf),e.bi_buf=t>>16-e.bi_valid,e.bi_valid+=n-16):(e.bi_buf|=t<<e.bi_valid&65535,e.bi_valid+=n)},It=(e,t,n)=>{kt(e,n[2*t],n[2*t+1])},St=(e,t)=>{let n=0;do{n|=1&e,e>>>=1,n<<=1}while(--t>0);return n>>>1},Et=(e,t,n)=>{const r=new Array(16);let i,a,o=0;for(i=1;i<=it;i++)o=o+n[i-1]<<1,r[i]=o;for(a=0;a<=t;a++){let t=e[2*a+1];0!==t&&(e[2*a]=St(r[t]++,t))}},Tt=e=>{let t;for(t=0;t<nt;t++)e.dyn_ltree[2*t]=0;for(t=0;t<rt;t++)e.dyn_dtree[2*t]=0;for(t=0;t<19;t++)e.bl_tree[2*t]=0;e.dyn_ltree[512]=1,e.opt_len=e.static_len=0,e.sym_next=e.matches=0},Ot=e=>{e.bi_valid>8?_t(e,e.bi_buf):e.bi_valid>0&&(e.pending_buf[e.pending++]=e.bi_buf),e.bi_buf=0,e.bi_valid=0},At=(e,t,n,r)=>{const i=2*t,a=2*n;return e[i]<e[a]||e[i]===e[a]&&r[t]<=r[n]},Pt=(e,t,n)=>{const r=e.heap[n];let i=n<<1;for(;i<=e.heap_len&&(i<e.heap_len&&At(t,e.heap[i+1],e.heap[i],e.depth)&&i++,!At(t,r,e.heap[i],e.depth));)e.heap[n]=e.heap[i],n=i,i<<=1;e.heap[n]=r},Nt=(e,t,n)=>{let r,i,a,o,s=0;if(0!==e.sym_next)do{r=255&e.pending_buf[e.sym_buf+s++],r+=(255&e.pending_buf[e.sym_buf+s++])<<8,i=e.pending_buf[e.sym_buf+s++],0===r?It(e,i,t):(a=dt[i],It(e,a+tt+1,t),o=at[a],0!==o&&(i-=ht[a],kt(e,i,o)),r--,a=bt(r),It(e,a,n),o=ot[a],0!==o&&(r-=vt[a],kt(e,r,o)))}while(s<e.sym_next);It(e,256,t)},Rt=(e,t)=>{const n=t.dyn_tree,r=t.stat_desc.static_tree,i=t.stat_desc.has_stree,a=t.stat_desc.elems;let o,s,u,c=-1;for(e.heap_len=0,e.heap_max=573,o=0;o<a;o++)0!==n[2*o]?(e.heap[++e.heap_len]=c=o,e.depth[o]=0):n[2*o+1]=0;for(;e.heap_len<2;)u=e.heap[++e.heap_len]=c<2?++c:0,n[2*u]=1,e.depth[u]=0,e.opt_len--,i&&(e.static_len-=r[2*u+1]);for(t.max_code=c,o=e.heap_len>>1;o>=1;o--)Pt(e,n,o);u=a;do{o=e.heap[1],e.heap[1]=e.heap[e.heap_len--],Pt(e,n,1),s=e.heap[1],e.heap[--e.heap_max]=o,e.heap[--e.heap_max]=s,n[2*u]=n[2*o]+n[2*s],e.depth[u]=(e.depth[o]>=e.depth[s]?e.depth[o]:e.depth[s])+1,n[2*o+1]=n[2*s+1]=u,e.heap[1]=u++,Pt(e,n,1)}while(e.heap_len>=2);e.heap[--e.heap_max]=e.heap[1],((e,t)=>{const n=t.dyn_tree,r=t.max_code,i=t.stat_desc.static_tree,a=t.stat_desc.has_stree,o=t.stat_desc.extra_bits,s=t.stat_desc.extra_base,u=t.stat_desc.max_length;let c,l,f,d,h,v,p=0;for(d=0;d<=it;d++)e.bl_count[d]=0;for(n[2*e.heap[e.heap_max]+1]=0,c=e.heap_max+1;c<573;c++)l=e.heap[c],d=n[2*n[2*l+1]+1]+1,d>u&&(d=u,p++),n[2*l+1]=d,l>r||(e.bl_count[d]++,h=0,l>=s&&(h=o[l-s]),v=n[2*l],e.opt_len+=v*(d+h),a&&(e.static_len+=v*(i[2*l+1]+h)));if(0!==p){do{for(d=u-1;0===e.bl_count[d];)d--;e.bl_count[d]--,e.bl_count[d+1]+=2,e.bl_count[u]--,p-=2}while(p>0);for(d=u;0!==d;d--)for(l=e.bl_count[d];0!==l;)f=e.heap[--c],f>r||(n[2*f+1]!==d&&(e.opt_len+=(d-n[2*f+1])*n[2*f],n[2*f+1]=d),l--)}})(e,t),Et(n,c,e.bl_count)},xt=(e,t,n)=>{let r,i,a=-1,o=t[1],s=0,u=7,c=4;for(0===o&&(u=138,c=3),t[2*(n+1)+1]=65535,r=0;r<=n;r++)i=o,o=t[2*(r+1)+1],++s<u&&i===o||(s<c?e.bl_tree[2*i]+=s:0!==i?(i!==a&&e.bl_tree[2*i]++,e.bl_tree[32]++):s<=10?e.bl_tree[34]++:e.bl_tree[36]++,s=0,a=i,0===o?(u=138,c=3):i===o?(u=6,c=3):(u=7,c=4))},Ct=(e,t,n)=>{let r,i,a=-1,o=t[1],s=0,u=7,c=4;for(0===o&&(u=138,c=3),r=0;r<=n;r++)if(i=o,o=t[2*(r+1)+1],!(++s<u&&i===o)){if(s<c)do{It(e,i,e.bl_tree)}while(0!=--s);else 0!==i?(i!==a&&(It(e,i,e.bl_tree),s--),It(e,16,e.bl_tree),kt(e,s-3,2)):s<=10?(It(e,17,e.bl_tree),kt(e,s-3,3)):(It(e,18,e.bl_tree),kt(e,s-11,7));s=0,a=i,0===o?(u=138,c=3):i===o?(u=6,c=3):(u=7,c=4)}};let Bt=!1;const Dt=(e,t,n,r)=>{kt(e,0+(r?1:0),3),Ot(e),_t(e,n),_t(e,~n),n&&e.pending_buf.set(e.window.subarray(t,t+n),e.pending),e.pending+=n};var jt=(e,t,n,r)=>{let i,a,o=0;e.level>0?(2===e.strm.data_type&&(e.strm.data_type=(e=>{let t,n=4093624447;for(t=0;t<=31;t++,n>>>=1)if(1&n&&0!==e.dyn_ltree[2*t])return 0;if(0!==e.dyn_ltree[18]||0!==e.dyn_ltree[20]||0!==e.dyn_ltree[26])return 1;for(t=32;t<tt;t++)if(0!==e.dyn_ltree[2*t])return 1;return 0})(e)),Rt(e,e.l_desc),Rt(e,e.d_desc),o=(e=>{let t;for(xt(e,e.dyn_ltree,e.l_desc.max_code),xt(e,e.dyn_dtree,e.d_desc.max_code),Rt(e,e.bl_desc),t=18;t>=3&&0===e.bl_tree[2*ut[t]+1];t--);return e.opt_len+=3*(t+1)+5+5+4,t})(e),i=e.opt_len+3+7>>>3,a=e.static_len+3+7>>>3,a<=i&&(i=a)):i=a=n+5,n+4<=i&&-1!==t?Dt(e,t,n,r):4===e.strategy||a===i?(kt(e,2+(r?1:0),3),Nt(e,ct,lt)):(kt(e,4+(r?1:0),3),((e,t,n,r)=>{let i;for(kt(e,t-257,5),kt(e,n-1,5),kt(e,r-4,4),i=0;i<r;i++)kt(e,e.bl_tree[2*ut[i]+1],3);Ct(e,e.dyn_ltree,t-1),Ct(e,e.dyn_dtree,n-1)})(e,e.l_desc.max_code+1,e.d_desc.max_code+1,o+1),Nt(e,e.dyn_ltree,e.dyn_dtree)),Tt(e),r&&Ot(e)},Mt={_tr_init:e=>{Bt||((()=>{let e,t,n,r,i;const a=new Array(16);for(n=0,r=0;r<28;r++)for(ht[r]=n,e=0;e<1<<at[r];e++)dt[n++]=r;for(dt[n-1]=r,i=0,r=0;r<16;r++)for(vt[r]=i,e=0;e<1<<ot[r];e++)ft[i++]=r;for(i>>=7;r<rt;r++)for(vt[r]=i<<7,e=0;e<1<<ot[r]-7;e++)ft[256+i++]=r;for(t=0;t<=it;t++)a[t]=0;for(e=0;e<=143;)ct[2*e+1]=8,e++,a[8]++;for(;e<=255;)ct[2*e+1]=9,e++,a[9]++;for(;e<=279;)ct[2*e+1]=7,e++,a[7]++;for(;e<=287;)ct[2*e+1]=8,e++,a[8]++;for(Et(ct,287,a),e=0;e<rt;e++)lt[2*e+1]=5,lt[2*e]=St(e,5);gt=new pt(ct,at,257,nt,it),mt=new pt(lt,ot,0,rt,it),yt=new pt(new Array(0),st,0,19,7)})(),Bt=!0),e.l_desc=new wt(e.dyn_ltree,gt),e.d_desc=new wt(e.dyn_dtree,mt),e.bl_desc=new wt(e.bl_tree,yt),e.bi_buf=0,e.bi_valid=0,Tt(e)},_tr_stored_block:Dt,_tr_flush_block:jt,_tr_tally:(e,t,n)=>(e.pending_buf[e.sym_buf+e.sym_next++]=t,e.pending_buf[e.sym_buf+e.sym_next++]=t>>8,e.pending_buf[e.sym_buf+e.sym_next++]=n,0===t?e.dyn_ltree[2*n]++:(e.matches++,t--,e.dyn_ltree[2*(dt[n]+tt+1)]++,e.dyn_dtree[2*bt(t)]++),e.sym_next===e.sym_end),_tr_align:e=>{kt(e,2,3),It(e,256,ct),(e=>{16===e.bi_valid?(_t(e,e.bi_buf),e.bi_buf=0,e.bi_valid=0):e.bi_valid>=8&&(e.pending_buf[e.pending++]=255&e.bi_buf,e.bi_buf>>=8,e.bi_valid-=8)})(e)}};var Ut=(e,t,n,r)=>{let i=65535&e,a=e>>>16&65535,o=0;for(;0!==n;){o=n>2e3?2e3:n,n-=o;do{i=i+t[r++]|0,a=a+i|0}while(--o);i%=65521,a%=65521}return i|a<<16};const Lt=new Uint32Array((()=>{let e,t=[];for(var n=0;n<256;n++){e=n;for(var r=0;r<8;r++)e=1&e?3988292384^e>>>1:e>>>1;t[n]=e}return t})());var Ft=(e,t,n,r)=>{const i=Lt,a=r+n;e^=-1;for(let n=r;n<a;n++)e=e>>>8^i[255&(e^t[n])];return~e},zt={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},Vt={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8};const{_tr_init:Jt,_tr_stored_block:qt,_tr_flush_block:Ht,_tr_tally:Kt,_tr_align:Qt}=Mt,{Z_NO_FLUSH:Zt,Z_PARTIAL_FLUSH:Gt,Z_FULL_FLUSH:Yt,Z_FINISH:Wt,Z_BLOCK:Xt,Z_OK:$t,Z_STREAM_END:en,Z_STREAM_ERROR:tn,Z_DATA_ERROR:nn,Z_BUF_ERROR:rn,Z_DEFAULT_COMPRESSION:an,Z_FILTERED:on,Z_HUFFMAN_ONLY:sn,Z_RLE:un,Z_FIXED:cn,Z_DEFAULT_STRATEGY:ln,Z_UNKNOWN:fn,Z_DEFLATED:dn}=Vt,hn=258,vn=262,pn=42,gn=113,mn=666,yn=(e,t)=>(e.msg=zt[t],t),wn=e=>2*e-(e>4?9:0),bn=e=>{let t=e.length;for(;--t>=0;)e[t]=0},_n=e=>{let t,n,r,i=e.w_size;t=e.hash_size,r=t;do{n=e.head[--r],e.head[r]=n>=i?n-i:0}while(--t);t=i,r=t;do{n=e.prev[--r],e.prev[r]=n>=i?n-i:0}while(--t)};let kn=(e,t,n)=>(t<<e.hash_shift^n)&e.hash_mask;const In=e=>{const t=e.state;let n=t.pending;n>e.avail_out&&(n=e.avail_out),0!==n&&(e.output.set(t.pending_buf.subarray(t.pending_out,t.pending_out+n),e.next_out),e.next_out+=n,t.pending_out+=n,e.total_out+=n,e.avail_out-=n,t.pending-=n,0===t.pending&&(t.pending_out=0))},Sn=(e,t)=>{Ht(e,e.block_start>=0?e.block_start:-1,e.strstart-e.block_start,t),e.block_start=e.strstart,In(e.strm)},En=(e,t)=>{e.pending_buf[e.pending++]=t},Tn=(e,t)=>{e.pending_buf[e.pending++]=t>>>8&255,e.pending_buf[e.pending++]=255&t},On=(e,t,n,r)=>{let i=e.avail_in;return i>r&&(i=r),0===i?0:(e.avail_in-=i,t.set(e.input.subarray(e.next_in,e.next_in+i),n),1===e.state.wrap?e.adler=Ut(e.adler,t,i,n):2===e.state.wrap&&(e.adler=Ft(e.adler,t,i,n)),e.next_in+=i,e.total_in+=i,i)},An=(e,t)=>{let n,r,i=e.max_chain_length,a=e.strstart,o=e.prev_length,s=e.nice_match;const u=e.strstart>e.w_size-vn?e.strstart-(e.w_size-vn):0,c=e.window,l=e.w_mask,f=e.prev,d=e.strstart+hn;let h=c[a+o-1],v=c[a+o];e.prev_length>=e.good_match&&(i>>=2),s>e.lookahead&&(s=e.lookahead);do{if(n=t,c[n+o]===v&&c[n+o-1]===h&&c[n]===c[a]&&c[++n]===c[a+1]){a+=2,n++;do{}while(c[++a]===c[++n]&&c[++a]===c[++n]&&c[++a]===c[++n]&&c[++a]===c[++n]&&c[++a]===c[++n]&&c[++a]===c[++n]&&c[++a]===c[++n]&&c[++a]===c[++n]&&a<d);if(r=hn-(d-a),a=d-hn,r>o){if(e.match_start=t,o=r,r>=s)break;h=c[a+o-1],v=c[a+o]}}}while((t=f[t&l])>u&&0!=--i);return o<=e.lookahead?o:e.lookahead},Pn=e=>{const t=e.w_size;let n,r,i;do{if(r=e.window_size-e.lookahead-e.strstart,e.strstart>=t+(t-vn)&&(e.window.set(e.window.subarray(t,t+t-r),0),e.match_start-=t,e.strstart-=t,e.block_start-=t,e.insert>e.strstart&&(e.insert=e.strstart),_n(e),r+=t),0===e.strm.avail_in)break;if(n=On(e.strm,e.window,e.strstart+e.lookahead,r),e.lookahead+=n,e.lookahead+e.insert>=3)for(i=e.strstart-e.insert,e.ins_h=e.window[i],e.ins_h=kn(e,e.ins_h,e.window[i+1]);e.insert&&(e.ins_h=kn(e,e.ins_h,e.window[i+3-1]),e.prev[i&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=i,i++,e.insert--,!(e.lookahead+e.insert<3)););}while(e.lookahead<vn&&0!==e.strm.avail_in)},Nn=(e,t)=>{let n,r,i,a=e.pending_buf_size-5>e.w_size?e.w_size:e.pending_buf_size-5,o=0,s=e.strm.avail_in;do{if(n=65535,i=e.bi_valid+42>>3,e.strm.avail_out<i)break;if(i=e.strm.avail_out-i,r=e.strstart-e.block_start,n>r+e.strm.avail_in&&(n=r+e.strm.avail_in),n>i&&(n=i),n<a&&(0===n&&t!==Wt||t===Zt||n!==r+e.strm.avail_in))break;o=t===Wt&&n===r+e.strm.avail_in?1:0,qt(e,0,0,o),e.pending_buf[e.pending-4]=n,e.pending_buf[e.pending-3]=n>>8,e.pending_buf[e.pending-2]=~n,e.pending_buf[e.pending-1]=~n>>8,In(e.strm),r&&(r>n&&(r=n),e.strm.output.set(e.window.subarray(e.block_start,e.block_start+r),e.strm.next_out),e.strm.next_out+=r,e.strm.avail_out-=r,e.strm.total_out+=r,e.block_start+=r,n-=r),n&&(On(e.strm,e.strm.output,e.strm.next_out,n),e.strm.next_out+=n,e.strm.avail_out-=n,e.strm.total_out+=n)}while(0===o);return s-=e.strm.avail_in,s&&(s>=e.w_size?(e.matches=2,e.window.set(e.strm.input.subarray(e.strm.next_in-e.w_size,e.strm.next_in),0),e.strstart=e.w_size,e.insert=e.strstart):(e.window_size-e.strstart<=s&&(e.strstart-=e.w_size,e.window.set(e.window.subarray(e.w_size,e.w_size+e.strstart),0),e.matches<2&&e.matches++,e.insert>e.strstart&&(e.insert=e.strstart)),e.window.set(e.strm.input.subarray(e.strm.next_in-s,e.strm.next_in),e.strstart),e.strstart+=s,e.insert+=s>e.w_size-e.insert?e.w_size-e.insert:s),e.block_start=e.strstart),e.high_water<e.strstart&&(e.high_water=e.strstart),o?4:t!==Zt&&t!==Wt&&0===e.strm.avail_in&&e.strstart===e.block_start?2:(i=e.window_size-e.strstart,e.strm.avail_in>i&&e.block_start>=e.w_size&&(e.block_start-=e.w_size,e.strstart-=e.w_size,e.window.set(e.window.subarray(e.w_size,e.w_size+e.strstart),0),e.matches<2&&e.matches++,i+=e.w_size,e.insert>e.strstart&&(e.insert=e.strstart)),i>e.strm.avail_in&&(i=e.strm.avail_in),i&&(On(e.strm,e.window,e.strstart,i),e.strstart+=i,e.insert+=i>e.w_size-e.insert?e.w_size-e.insert:i),e.high_water<e.strstart&&(e.high_water=e.strstart),i=e.bi_valid+42>>3,i=e.pending_buf_size-i>65535?65535:e.pending_buf_size-i,a=i>e.w_size?e.w_size:i,r=e.strstart-e.block_start,(r>=a||(r||t===Wt)&&t!==Zt&&0===e.strm.avail_in&&r<=i)&&(n=r>i?i:r,o=t===Wt&&0===e.strm.avail_in&&n===r?1:0,qt(e,e.block_start,n,o),e.block_start+=n,In(e.strm)),o?3:1)},Rn=(e,t)=>{let n,r;for(;;){if(e.lookahead<vn){if(Pn(e),e.lookahead<vn&&t===Zt)return 1;if(0===e.lookahead)break}if(n=0,e.lookahead>=3&&(e.ins_h=kn(e,e.ins_h,e.window[e.strstart+3-1]),n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),0!==n&&e.strstart-n<=e.w_size-vn&&(e.match_length=An(e,n)),e.match_length>=3)if(r=Kt(e,e.strstart-e.match_start,e.match_length-3),e.lookahead-=e.match_length,e.match_length<=e.max_lazy_match&&e.lookahead>=3){e.match_length--;do{e.strstart++,e.ins_h=kn(e,e.ins_h,e.window[e.strstart+3-1]),n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart}while(0!=--e.match_length);e.strstart++}else e.strstart+=e.match_length,e.match_length=0,e.ins_h=e.window[e.strstart],e.ins_h=kn(e,e.ins_h,e.window[e.strstart+1]);else r=Kt(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++;if(r&&(Sn(e,!1),0===e.strm.avail_out))return 1}return e.insert=e.strstart<2?e.strstart:2,t===Wt?(Sn(e,!0),0===e.strm.avail_out?3:4):e.sym_next&&(Sn(e,!1),0===e.strm.avail_out)?1:2},xn=(e,t)=>{let n,r,i;for(;;){if(e.lookahead<vn){if(Pn(e),e.lookahead<vn&&t===Zt)return 1;if(0===e.lookahead)break}if(n=0,e.lookahead>=3&&(e.ins_h=kn(e,e.ins_h,e.window[e.strstart+3-1]),n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),e.prev_length=e.match_length,e.prev_match=e.match_start,e.match_length=2,0!==n&&e.prev_length<e.max_lazy_match&&e.strstart-n<=e.w_size-vn&&(e.match_length=An(e,n),e.match_length<=5&&(e.strategy===on||3===e.match_length&&e.strstart-e.match_start>4096)&&(e.match_length=2)),e.prev_length>=3&&e.match_length<=e.prev_length){i=e.strstart+e.lookahead-3,r=Kt(e,e.strstart-1-e.prev_match,e.prev_length-3),e.lookahead-=e.prev_length-1,e.prev_length-=2;do{++e.strstart<=i&&(e.ins_h=kn(e,e.ins_h,e.window[e.strstart+3-1]),n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart)}while(0!=--e.prev_length);if(e.match_available=0,e.match_length=2,e.strstart++,r&&(Sn(e,!1),0===e.strm.avail_out))return 1}else if(e.match_available){if(r=Kt(e,0,e.window[e.strstart-1]),r&&Sn(e,!1),e.strstart++,e.lookahead--,0===e.strm.avail_out)return 1}else e.match_available=1,e.strstart++,e.lookahead--}return e.match_available&&(r=Kt(e,0,e.window[e.strstart-1]),e.match_available=0),e.insert=e.strstart<2?e.strstart:2,t===Wt?(Sn(e,!0),0===e.strm.avail_out?3:4):e.sym_next&&(Sn(e,!1),0===e.strm.avail_out)?1:2};function Cn(e,t,n,r,i){this.good_length=e,this.max_lazy=t,this.nice_length=n,this.max_chain=r,this.func=i}const Bn=[new Cn(0,0,0,0,Nn),new Cn(4,4,8,4,Rn),new Cn(4,5,16,8,Rn),new Cn(4,6,32,32,Rn),new Cn(4,4,16,16,xn),new Cn(8,16,32,32,xn),new Cn(8,16,128,128,xn),new Cn(8,32,128,256,xn),new Cn(32,128,258,1024,xn),new Cn(32,258,258,4096,xn)];function Dn(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=dn,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Uint16Array(1146),this.dyn_dtree=new Uint16Array(122),this.bl_tree=new Uint16Array(78),bn(this.dyn_ltree),bn(this.dyn_dtree),bn(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Uint16Array(16),this.heap=new Uint16Array(573),bn(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Uint16Array(573),bn(this.depth),this.sym_buf=0,this.lit_bufsize=0,this.sym_next=0,this.sym_end=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}const jn=e=>{if(!e)return 1;const t=e.state;return!t||t.strm!==e||t.status!==pn&&57!==t.status&&69!==t.status&&73!==t.status&&91!==t.status&&103!==t.status&&t.status!==gn&&t.status!==mn?1:0},Mn=e=>{if(jn(e))return yn(e,tn);e.total_in=e.total_out=0,e.data_type=fn;const t=e.state;return t.pending=0,t.pending_out=0,t.wrap<0&&(t.wrap=-t.wrap),t.status=2===t.wrap?57:t.wrap?pn:gn,e.adler=2===t.wrap?0:1,t.last_flush=-2,Jt(t),$t},Un=e=>{const t=Mn(e);var n;return t===$t&&((n=e.state).window_size=2*n.w_size,bn(n.head),n.max_lazy_match=Bn[n.level].max_lazy,n.good_match=Bn[n.level].good_length,n.nice_match=Bn[n.level].nice_length,n.max_chain_length=Bn[n.level].max_chain,n.strstart=0,n.block_start=0,n.lookahead=0,n.insert=0,n.match_length=n.prev_length=2,n.match_available=0,n.ins_h=0),t},Ln=(e,t,n,r,i,a)=>{if(!e)return tn;let o=1;if(t===an&&(t=6),r<0?(o=0,r=-r):r>15&&(o=2,r-=16),i<1||i>9||n!==dn||r<8||r>15||t<0||t>9||a<0||a>cn||8===r&&1!==o)return yn(e,tn);8===r&&(r=9);const s=new Dn;return e.state=s,s.strm=e,s.status=pn,s.wrap=o,s.gzhead=null,s.w_bits=r,s.w_size=1<<s.w_bits,s.w_mask=s.w_size-1,s.hash_bits=i+7,s.hash_size=1<<s.hash_bits,s.hash_mask=s.hash_size-1,s.hash_shift=~~((s.hash_bits+3-1)/3),s.window=new Uint8Array(2*s.w_size),s.head=new Uint16Array(s.hash_size),s.prev=new Uint16Array(s.w_size),s.lit_bufsize=1<<i+6,s.pending_buf_size=4*s.lit_bufsize,s.pending_buf=new Uint8Array(s.pending_buf_size),s.sym_buf=s.lit_bufsize,s.sym_end=3*(s.lit_bufsize-1),s.level=t,s.strategy=a,s.method=n,Un(e)};var Fn={deflateInit:(e,t)=>Ln(e,t,dn,15,8,ln),deflateInit2:Ln,deflateReset:Un,deflateResetKeep:Mn,deflateSetHeader:(e,t)=>jn(e)||2!==e.state.wrap?tn:(e.state.gzhead=t,$t),deflate:(e,t)=>{if(jn(e)||t>Xt||t<0)return e?yn(e,tn):tn;const n=e.state;if(!e.output||0!==e.avail_in&&!e.input||n.status===mn&&t!==Wt)return yn(e,0===e.avail_out?rn:tn);const r=n.last_flush;if(n.last_flush=t,0!==n.pending){if(In(e),0===e.avail_out)return n.last_flush=-1,$t}else if(0===e.avail_in&&wn(t)<=wn(r)&&t!==Wt)return yn(e,rn);if(n.status===mn&&0!==e.avail_in)return yn(e,rn);if(n.status===pn&&0===n.wrap&&(n.status=gn),n.status===pn){let t=dn+(n.w_bits-8<<4)<<8,r=-1;if(r=n.strategy>=sn||n.level<2?0:n.level<6?1:6===n.level?2:3,t|=r<<6,0!==n.strstart&&(t|=32),t+=31-t%31,Tn(n,t),0!==n.strstart&&(Tn(n,e.adler>>>16),Tn(n,65535&e.adler)),e.adler=1,n.status=gn,In(e),0!==n.pending)return n.last_flush=-1,$t}if(57===n.status)if(e.adler=0,En(n,31),En(n,139),En(n,8),n.gzhead)En(n,(n.gzhead.text?1:0)+(n.gzhead.hcrc?2:0)+(n.gzhead.extra?4:0)+(n.gzhead.name?8:0)+(n.gzhead.comment?16:0)),En(n,255&n.gzhead.time),En(n,n.gzhead.time>>8&255),En(n,n.gzhead.time>>16&255),En(n,n.gzhead.time>>24&255),En(n,9===n.level?2:n.strategy>=sn||n.level<2?4:0),En(n,255&n.gzhead.os),n.gzhead.extra&&n.gzhead.extra.length&&(En(n,255&n.gzhead.extra.length),En(n,n.gzhead.extra.length>>8&255)),n.gzhead.hcrc&&(e.adler=Ft(e.adler,n.pending_buf,n.pending,0)),n.gzindex=0,n.status=69;else if(En(n,0),En(n,0),En(n,0),En(n,0),En(n,0),En(n,9===n.level?2:n.strategy>=sn||n.level<2?4:0),En(n,3),n.status=gn,In(e),0!==n.pending)return n.last_flush=-1,$t;if(69===n.status){if(n.gzhead.extra){let t=n.pending,r=(65535&n.gzhead.extra.length)-n.gzindex;for(;n.pending+r>n.pending_buf_size;){let i=n.pending_buf_size-n.pending;if(n.pending_buf.set(n.gzhead.extra.subarray(n.gzindex,n.gzindex+i),n.pending),n.pending=n.pending_buf_size,n.gzhead.hcrc&&n.pending>t&&(e.adler=Ft(e.adler,n.pending_buf,n.pending-t,t)),n.gzindex+=i,In(e),0!==n.pending)return n.last_flush=-1,$t;t=0,r-=i}let i=new Uint8Array(n.gzhead.extra);n.pending_buf.set(i.subarray(n.gzindex,n.gzindex+r),n.pending),n.pending+=r,n.gzhead.hcrc&&n.pending>t&&(e.adler=Ft(e.adler,n.pending_buf,n.pending-t,t)),n.gzindex=0}n.status=73}if(73===n.status){if(n.gzhead.name){let t,r=n.pending;do{if(n.pending===n.pending_buf_size){if(n.gzhead.hcrc&&n.pending>r&&(e.adler=Ft(e.adler,n.pending_buf,n.pending-r,r)),In(e),0!==n.pending)return n.last_flush=-1,$t;r=0}t=n.gzindex<n.gzhead.name.length?255&n.gzhead.name.charCodeAt(n.gzindex++):0,En(n,t)}while(0!==t);n.gzhead.hcrc&&n.pending>r&&(e.adler=Ft(e.adler,n.pending_buf,n.pending-r,r)),n.gzindex=0}n.status=91}if(91===n.status){if(n.gzhead.comment){let t,r=n.pending;do{if(n.pending===n.pending_buf_size){if(n.gzhead.hcrc&&n.pending>r&&(e.adler=Ft(e.adler,n.pending_buf,n.pending-r,r)),In(e),0!==n.pending)return n.last_flush=-1,$t;r=0}t=n.gzindex<n.gzhead.comment.length?255&n.gzhead.comment.charCodeAt(n.gzindex++):0,En(n,t)}while(0!==t);n.gzhead.hcrc&&n.pending>r&&(e.adler=Ft(e.adler,n.pending_buf,n.pending-r,r))}n.status=103}if(103===n.status){if(n.gzhead.hcrc){if(n.pending+2>n.pending_buf_size&&(In(e),0!==n.pending))return n.last_flush=-1,$t;En(n,255&e.adler),En(n,e.adler>>8&255),e.adler=0}if(n.status=gn,In(e),0!==n.pending)return n.last_flush=-1,$t}if(0!==e.avail_in||0!==n.lookahead||t!==Zt&&n.status!==mn){let r=0===n.level?Nn(n,t):n.strategy===sn?((e,t)=>{let n;for(;;){if(0===e.lookahead&&(Pn(e),0===e.lookahead)){if(t===Zt)return 1;break}if(e.match_length=0,n=Kt(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++,n&&(Sn(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,t===Wt?(Sn(e,!0),0===e.strm.avail_out?3:4):e.sym_next&&(Sn(e,!1),0===e.strm.avail_out)?1:2})(n,t):n.strategy===un?((e,t)=>{let n,r,i,a;const o=e.window;for(;;){if(e.lookahead<=hn){if(Pn(e),e.lookahead<=hn&&t===Zt)return 1;if(0===e.lookahead)break}if(e.match_length=0,e.lookahead>=3&&e.strstart>0&&(i=e.strstart-1,r=o[i],r===o[++i]&&r===o[++i]&&r===o[++i])){a=e.strstart+hn;do{}while(r===o[++i]&&r===o[++i]&&r===o[++i]&&r===o[++i]&&r===o[++i]&&r===o[++i]&&r===o[++i]&&r===o[++i]&&i<a);e.match_length=hn-(a-i),e.match_length>e.lookahead&&(e.match_length=e.lookahead)}if(e.match_length>=3?(n=Kt(e,1,e.match_length-3),e.lookahead-=e.match_length,e.strstart+=e.match_length,e.match_length=0):(n=Kt(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++),n&&(Sn(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,t===Wt?(Sn(e,!0),0===e.strm.avail_out?3:4):e.sym_next&&(Sn(e,!1),0===e.strm.avail_out)?1:2})(n,t):Bn[n.level].func(n,t);if(3!==r&&4!==r||(n.status=mn),1===r||3===r)return 0===e.avail_out&&(n.last_flush=-1),$t;if(2===r&&(t===Gt?Qt(n):t!==Xt&&(qt(n,0,0,!1),t===Yt&&(bn(n.head),0===n.lookahead&&(n.strstart=0,n.block_start=0,n.insert=0))),In(e),0===e.avail_out))return n.last_flush=-1,$t}return t!==Wt?$t:n.wrap<=0?en:(2===n.wrap?(En(n,255&e.adler),En(n,e.adler>>8&255),En(n,e.adler>>16&255),En(n,e.adler>>24&255),En(n,255&e.total_in),En(n,e.total_in>>8&255),En(n,e.total_in>>16&255),En(n,e.total_in>>24&255)):(Tn(n,e.adler>>>16),Tn(n,65535&e.adler)),In(e),n.wrap>0&&(n.wrap=-n.wrap),0!==n.pending?$t:en)},deflateEnd:e=>{if(jn(e))return tn;const t=e.state.status;return e.state=null,t===gn?yn(e,nn):$t},deflateSetDictionary:(e,t)=>{let n=t.length;if(jn(e))return tn;const r=e.state,i=r.wrap;if(2===i||1===i&&r.status!==pn||r.lookahead)return tn;if(1===i&&(e.adler=Ut(e.adler,t,n,0)),r.wrap=0,n>=r.w_size){0===i&&(bn(r.head),r.strstart=0,r.block_start=0,r.insert=0);let e=new Uint8Array(r.w_size);e.set(t.subarray(n-r.w_size,n),0),t=e,n=r.w_size}const a=e.avail_in,o=e.next_in,s=e.input;for(e.avail_in=n,e.next_in=0,e.input=t,Pn(r);r.lookahead>=3;){let e=r.strstart,t=r.lookahead-2;do{r.ins_h=kn(r,r.ins_h,r.window[e+3-1]),r.prev[e&r.w_mask]=r.head[r.ins_h],r.head[r.ins_h]=e,e++}while(--t);r.strstart=e,r.lookahead=2,Pn(r)}return r.strstart+=r.lookahead,r.block_start=r.strstart,r.insert=r.lookahead,r.lookahead=0,r.match_length=r.prev_length=2,r.match_available=0,e.next_in=o,e.input=s,e.avail_in=a,r.wrap=i,$t},deflateInfo:"pako deflate (from Nodeca project)"};const zn=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);var Vn=function(e){const t=Array.prototype.slice.call(arguments,1);for(;t.length;){const n=t.shift();if(n){if("object"!=typeof n)throw new TypeError(n+"must be non-object");for(const t in n)zn(n,t)&&(e[t]=n[t])}}return e},Jn=e=>{let t=0;for(let n=0,r=e.length;n<r;n++)t+=e[n].length;const n=new Uint8Array(t);for(let t=0,r=0,i=e.length;t<i;t++){let i=e[t];n.set(i,r),r+=i.length}return n};let qn=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(e){qn=!1}const Hn=new Uint8Array(256);for(let e=0;e<256;e++)Hn[e]=e>=252?6:e>=248?5:e>=240?4:e>=224?3:e>=192?2:1;Hn[254]=Hn[254]=1;var Kn=e=>{if("function"==typeof TextEncoder&&TextEncoder.prototype.encode)return(new TextEncoder).encode(e);let t,n,r,i,a,o=e.length,s=0;for(i=0;i<o;i++)n=e.charCodeAt(i),55296==(64512&n)&&i+1<o&&(r=e.charCodeAt(i+1),56320==(64512&r)&&(n=65536+(n-55296<<10)+(r-56320),i++)),s+=n<128?1:n<2048?2:n<65536?3:4;for(t=new Uint8Array(s),a=0,i=0;a<s;i++)n=e.charCodeAt(i),55296==(64512&n)&&i+1<o&&(r=e.charCodeAt(i+1),56320==(64512&r)&&(n=65536+(n-55296<<10)+(r-56320),i++)),n<128?t[a++]=n:n<2048?(t[a++]=192|n>>>6,t[a++]=128|63&n):n<65536?(t[a++]=224|n>>>12,t[a++]=128|n>>>6&63,t[a++]=128|63&n):(t[a++]=240|n>>>18,t[a++]=128|n>>>12&63,t[a++]=128|n>>>6&63,t[a++]=128|63&n);return t},Qn=(e,t)=>{const n=t||e.length;if("function"==typeof TextDecoder&&TextDecoder.prototype.decode)return(new TextDecoder).decode(e.subarray(0,t));let r,i;const a=new Array(2*n);for(i=0,r=0;r<n;){let t=e[r++];if(t<128){a[i++]=t;continue}let o=Hn[t];if(o>4)a[i++]=65533,r+=o-1;else{for(t&=2===o?31:3===o?15:7;o>1&&r<n;)t=t<<6|63&e[r++],o--;o>1?a[i++]=65533:t<65536?a[i++]=t:(t-=65536,a[i++]=55296|t>>10&1023,a[i++]=56320|1023&t)}}return((e,t)=>{if(t<65534&&e.subarray&&qn)return String.fromCharCode.apply(null,e.length===t?e:e.subarray(0,t));let n="";for(let r=0;r<t;r++)n+=String.fromCharCode(e[r]);return n})(a,i)},Zn=(e,t)=>{(t=t||e.length)>e.length&&(t=e.length);let n=t-1;for(;n>=0&&128==(192&e[n]);)n--;return n<0||0===n?t:n+Hn[e[n]]>t?n:t};var Gn=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0};const Yn=Object.prototype.toString,{Z_NO_FLUSH:Wn,Z_SYNC_FLUSH:Xn,Z_FULL_FLUSH:$n,Z_FINISH:er,Z_OK:tr,Z_STREAM_END:nr,Z_DEFAULT_COMPRESSION:rr,Z_DEFAULT_STRATEGY:ir,Z_DEFLATED:ar}=Vt;function or(e){this.options=Vn({level:rr,method:ar,chunkSize:16384,windowBits:15,memLevel:8,strategy:ir},e||{});let t=this.options;t.raw&&t.windowBits>0?t.windowBits=-t.windowBits:t.gzip&&t.windowBits>0&&t.windowBits<16&&(t.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new Gn,this.strm.avail_out=0;let n=Fn.deflateInit2(this.strm,t.level,t.method,t.windowBits,t.memLevel,t.strategy);if(n!==tr)throw new Error(zt[n]);if(t.header&&Fn.deflateSetHeader(this.strm,t.header),t.dictionary){let e;if(e="string"==typeof t.dictionary?Kn(t.dictionary):"[object ArrayBuffer]"===Yn.call(t.dictionary)?new Uint8Array(t.dictionary):t.dictionary,n=Fn.deflateSetDictionary(this.strm,e),n!==tr)throw new Error(zt[n]);this._dict_set=!0}}function sr(e,t){const n=new or(t);if(n.push(e,!0),n.err)throw n.msg||zt[n.err];return n.result}or.prototype.push=function(e,t){const n=this.strm,r=this.options.chunkSize;let i,a;if(this.ended)return!1;for(a=t===~~t?t:!0===t?er:Wn,"string"==typeof e?n.input=Kn(e):"[object ArrayBuffer]"===Yn.call(e)?n.input=new Uint8Array(e):n.input=e,n.next_in=0,n.avail_in=n.input.length;;)if(0===n.avail_out&&(n.output=new Uint8Array(r),n.next_out=0,n.avail_out=r),(a===Xn||a===$n)&&n.avail_out<=6)this.onData(n.output.subarray(0,n.next_out)),n.avail_out=0;else{if(i=Fn.deflate(n,a),i===nr)return n.next_out>0&&this.onData(n.output.subarray(0,n.next_out)),i=Fn.deflateEnd(this.strm),this.onEnd(i),this.ended=!0,i===tr;if(0!==n.avail_out){if(a>0&&n.next_out>0)this.onData(n.output.subarray(0,n.next_out)),n.avail_out=0;else if(0===n.avail_in)break}else this.onData(n.output)}return!0},or.prototype.onData=function(e){this.chunks.push(e)},or.prototype.onEnd=function(e){e===tr&&(this.result=Jn(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};var ur={Deflate:or,deflate:sr,deflateRaw:function(e,t){return(t=t||{}).raw=!0,sr(e,t)},gzip:function(e,t){return(t=t||{}).gzip=!0,sr(e,t)},constants:Vt};const cr=16209;var lr=function(e,t){let n,r,i,a,o,s,u,c,l,f,d,h,v,p,g,m,y,w,b,_,k,I,S,E;const T=e.state;n=e.next_in,S=e.input,r=n+(e.avail_in-5),i=e.next_out,E=e.output,a=i-(t-e.avail_out),o=i+(e.avail_out-257),s=T.dmax,u=T.wsize,c=T.whave,l=T.wnext,f=T.window,d=T.hold,h=T.bits,v=T.lencode,p=T.distcode,g=(1<<T.lenbits)-1,m=(1<<T.distbits)-1;e:do{h<15&&(d+=S[n++]<<h,h+=8,d+=S[n++]<<h,h+=8),y=v[d&g];t:for(;;){if(w=y>>>24,d>>>=w,h-=w,w=y>>>16&255,0===w)E[i++]=65535&y;else{if(!(16&w)){if(64&w){if(32&w){T.mode=16191;break e}e.msg="invalid literal/length code",T.mode=cr;break e}y=v[(65535&y)+(d&(1<<w)-1)];continue t}for(b=65535&y,w&=15,w&&(h<w&&(d+=S[n++]<<h,h+=8),b+=d&(1<<w)-1,d>>>=w,h-=w),h<15&&(d+=S[n++]<<h,h+=8,d+=S[n++]<<h,h+=8),y=p[d&m];;){if(w=y>>>24,d>>>=w,h-=w,w=y>>>16&255,16&w){if(_=65535&y,w&=15,h<w&&(d+=S[n++]<<h,h+=8,h<w&&(d+=S[n++]<<h,h+=8)),_+=d&(1<<w)-1,_>s){e.msg="invalid distance too far back",T.mode=cr;break e}if(d>>>=w,h-=w,w=i-a,_>w){if(w=_-w,w>c&&T.sane){e.msg="invalid distance too far back",T.mode=cr;break e}if(k=0,I=f,0===l){if(k+=u-w,w<b){b-=w;do{E[i++]=f[k++]}while(--w);k=i-_,I=E}}else if(l<w){if(k+=u+l-w,w-=l,w<b){b-=w;do{E[i++]=f[k++]}while(--w);if(k=0,l<b){w=l,b-=w;do{E[i++]=f[k++]}while(--w);k=i-_,I=E}}}else if(k+=l-w,w<b){b-=w;do{E[i++]=f[k++]}while(--w);k=i-_,I=E}for(;b>2;)E[i++]=I[k++],E[i++]=I[k++],E[i++]=I[k++],b-=3;b&&(E[i++]=I[k++],b>1&&(E[i++]=I[k++]))}else{k=i-_;do{E[i++]=E[k++],E[i++]=E[k++],E[i++]=E[k++],b-=3}while(b>2);b&&(E[i++]=E[k++],b>1&&(E[i++]=E[k++]))}break}if(64&w){e.msg="invalid distance code",T.mode=cr;break e}y=p[(65535&y)+(d&(1<<w)-1)]}}break}}while(n<r&&i<o);b=h>>3,n-=b,h-=b<<3,d&=(1<<h)-1,e.next_in=n,e.next_out=i,e.avail_in=n<r?r-n+5:5-(n-r),e.avail_out=i<o?o-i+257:257-(i-o),T.hold=d,T.bits=h};const fr=15,dr=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),hr=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),vr=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),pr=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]);var gr=(e,t,n,r,i,a,o,s)=>{const u=s.bits;let c,l,f,d,h,v,p=0,g=0,m=0,y=0,w=0,b=0,_=0,k=0,I=0,S=0,E=null;const T=new Uint16Array(16),O=new Uint16Array(16);let A,P,N,R=null;for(p=0;p<=fr;p++)T[p]=0;for(g=0;g<r;g++)T[t[n+g]]++;for(w=u,y=fr;y>=1&&0===T[y];y--);if(w>y&&(w=y),0===y)return i[a++]=20971520,i[a++]=20971520,s.bits=1,0;for(m=1;m<y&&0===T[m];m++);for(w<m&&(w=m),k=1,p=1;p<=fr;p++)if(k<<=1,k-=T[p],k<0)return-1;if(k>0&&(0===e||1!==y))return-1;for(O[1]=0,p=1;p<fr;p++)O[p+1]=O[p]+T[p];for(g=0;g<r;g++)0!==t[n+g]&&(o[O[t[n+g]]++]=g);if(0===e?(E=R=o,v=20):1===e?(E=dr,R=hr,v=257):(E=vr,R=pr,v=0),S=0,g=0,p=m,h=a,b=w,_=0,f=-1,I=1<<w,d=I-1,1===e&&I>852||2===e&&I>592)return 1;for(;;){A=p-_,o[g]+1<v?(P=0,N=o[g]):o[g]>=v?(P=R[o[g]-v],N=E[o[g]-v]):(P=96,N=0),c=1<<p-_,l=1<<b,m=l;do{l-=c,i[h+(S>>_)+l]=A<<24|P<<16|N}while(0!==l);for(c=1<<p-1;S&c;)c>>=1;if(0!==c?(S&=c-1,S+=c):S=0,g++,0==--T[p]){if(p===y)break;p=t[n+o[g]]}if(p>w&&(S&d)!==f){for(0===_&&(_=w),h+=m,b=p-_,k=1<<b;b+_<y&&(k-=T[b+_],!(k<=0));)b++,k<<=1;if(I+=1<<b,1===e&&I>852||2===e&&I>592)return 1;f=S&d,i[f]=w<<24|b<<16|h-a}}return 0!==S&&(i[h+S]=p-_<<24|64<<16),s.bits=w,0};const{Z_FINISH:mr,Z_BLOCK:yr,Z_TREES:wr,Z_OK:br,Z_STREAM_END:_r,Z_NEED_DICT:kr,Z_STREAM_ERROR:Ir,Z_DATA_ERROR:Sr,Z_MEM_ERROR:Er,Z_BUF_ERROR:Tr,Z_DEFLATED:Or}=Vt,Ar=16180,Pr=16190,Nr=16191,Rr=16192,xr=16194,Cr=16199,Br=16200,Dr=16206,jr=16209,Mr=e=>(e>>>24&255)+(e>>>8&65280)+((65280&e)<<8)+((255&e)<<24);function Ur(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const Lr=e=>{if(!e)return 1;const t=e.state;return!t||t.strm!==e||t.mode<Ar||t.mode>16211?1:0},Fr=e=>{if(Lr(e))return Ir;const t=e.state;return e.total_in=e.total_out=t.total=0,e.msg="",t.wrap&&(e.adler=1&t.wrap),t.mode=Ar,t.last=0,t.havedict=0,t.flags=-1,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new Int32Array(852),t.distcode=t.distdyn=new Int32Array(592),t.sane=1,t.back=-1,br},zr=e=>{if(Lr(e))return Ir;const t=e.state;return t.wsize=0,t.whave=0,t.wnext=0,Fr(e)},Vr=(e,t)=>{let n;if(Lr(e))return Ir;const r=e.state;return t<0?(n=0,t=-t):(n=5+(t>>4),t<48&&(t&=15)),t&&(t<8||t>15)?Ir:(null!==r.window&&r.wbits!==t&&(r.window=null),r.wrap=n,r.wbits=t,zr(e))},Jr=(e,t)=>{if(!e)return Ir;const n=new Ur;e.state=n,n.strm=e,n.window=null,n.mode=Ar;const r=Vr(e,t);return r!==br&&(e.state=null),r};let qr,Hr,Kr=!0;const Qr=e=>{if(Kr){qr=new Int32Array(512),Hr=new Int32Array(32);let t=0;for(;t<144;)e.lens[t++]=8;for(;t<256;)e.lens[t++]=9;for(;t<280;)e.lens[t++]=7;for(;t<288;)e.lens[t++]=8;for(gr(1,e.lens,0,288,qr,0,e.work,{bits:9}),t=0;t<32;)e.lens[t++]=5;gr(2,e.lens,0,32,Hr,0,e.work,{bits:5}),Kr=!1}e.lencode=qr,e.lenbits=9,e.distcode=Hr,e.distbits=5},Zr=(e,t,n,r)=>{let i;const a=e.state;return null===a.window&&(a.wsize=1<<a.wbits,a.wnext=0,a.whave=0,a.window=new Uint8Array(a.wsize)),r>=a.wsize?(a.window.set(t.subarray(n-a.wsize,n),0),a.wnext=0,a.whave=a.wsize):(i=a.wsize-a.wnext,i>r&&(i=r),a.window.set(t.subarray(n-r,n-r+i),a.wnext),(r-=i)?(a.window.set(t.subarray(n-r,n),0),a.wnext=r,a.whave=a.wsize):(a.wnext+=i,a.wnext===a.wsize&&(a.wnext=0),a.whave<a.wsize&&(a.whave+=i))),0};var Gr={inflateReset:zr,inflateReset2:Vr,inflateResetKeep:Fr,inflateInit:e=>Jr(e,15),inflateInit2:Jr,inflate:(e,t)=>{let n,r,i,a,o,s,u,c,l,f,d,h,v,p,g,m,y,w,b,_,k,I,S=0;const E=new Uint8Array(4);let T,O;const A=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(Lr(e)||!e.output||!e.input&&0!==e.avail_in)return Ir;n=e.state,n.mode===Nr&&(n.mode=Rr),o=e.next_out,i=e.output,u=e.avail_out,a=e.next_in,r=e.input,s=e.avail_in,c=n.hold,l=n.bits,f=s,d=u,I=br;e:for(;;)switch(n.mode){case Ar:if(0===n.wrap){n.mode=Rr;break}for(;l<16;){if(0===s)break e;s--,c+=r[a++]<<l,l+=8}if(2&n.wrap&&35615===c){0===n.wbits&&(n.wbits=15),n.check=0,E[0]=255&c,E[1]=c>>>8&255,n.check=Ft(n.check,E,2,0),c=0,l=0,n.mode=16181;break}if(n.head&&(n.head.done=!1),!(1&n.wrap)||(((255&c)<<8)+(c>>8))%31){e.msg="incorrect header check",n.mode=jr;break}if((15&c)!==Or){e.msg="unknown compression method",n.mode=jr;break}if(c>>>=4,l-=4,k=8+(15&c),0===n.wbits&&(n.wbits=k),k>15||k>n.wbits){e.msg="invalid window size",n.mode=jr;break}n.dmax=1<<n.wbits,n.flags=0,e.adler=n.check=1,n.mode=512&c?16189:Nr,c=0,l=0;break;case 16181:for(;l<16;){if(0===s)break e;s--,c+=r[a++]<<l,l+=8}if(n.flags=c,(255&n.flags)!==Or){e.msg="unknown compression method",n.mode=jr;break}if(57344&n.flags){e.msg="unknown header flags set",n.mode=jr;break}n.head&&(n.head.text=c>>8&1),512&n.flags&&4&n.wrap&&(E[0]=255&c,E[1]=c>>>8&255,n.check=Ft(n.check,E,2,0)),c=0,l=0,n.mode=16182;case 16182:for(;l<32;){if(0===s)break e;s--,c+=r[a++]<<l,l+=8}n.head&&(n.head.time=c),512&n.flags&&4&n.wrap&&(E[0]=255&c,E[1]=c>>>8&255,E[2]=c>>>16&255,E[3]=c>>>24&255,n.check=Ft(n.check,E,4,0)),c=0,l=0,n.mode=16183;case 16183:for(;l<16;){if(0===s)break e;s--,c+=r[a++]<<l,l+=8}n.head&&(n.head.xflags=255&c,n.head.os=c>>8),512&n.flags&&4&n.wrap&&(E[0]=255&c,E[1]=c>>>8&255,n.check=Ft(n.check,E,2,0)),c=0,l=0,n.mode=16184;case 16184:if(1024&n.flags){for(;l<16;){if(0===s)break e;s--,c+=r[a++]<<l,l+=8}n.length=c,n.head&&(n.head.extra_len=c),512&n.flags&&4&n.wrap&&(E[0]=255&c,E[1]=c>>>8&255,n.check=Ft(n.check,E,2,0)),c=0,l=0}else n.head&&(n.head.extra=null);n.mode=16185;case 16185:if(1024&n.flags&&(h=n.length,h>s&&(h=s),h&&(n.head&&(k=n.head.extra_len-n.length,n.head.extra||(n.head.extra=new Uint8Array(n.head.extra_len)),n.head.extra.set(r.subarray(a,a+h),k)),512&n.flags&&4&n.wrap&&(n.check=Ft(n.check,r,h,a)),s-=h,a+=h,n.length-=h),n.length))break e;n.length=0,n.mode=16186;case 16186:if(2048&n.flags){if(0===s)break e;h=0;do{k=r[a+h++],n.head&&k&&n.length<65536&&(n.head.name+=String.fromCharCode(k))}while(k&&h<s);if(512&n.flags&&4&n.wrap&&(n.check=Ft(n.check,r,h,a)),s-=h,a+=h,k)break e}else n.head&&(n.head.name=null);n.length=0,n.mode=16187;case 16187:if(4096&n.flags){if(0===s)break e;h=0;do{k=r[a+h++],n.head&&k&&n.length<65536&&(n.head.comment+=String.fromCharCode(k))}while(k&&h<s);if(512&n.flags&&4&n.wrap&&(n.check=Ft(n.check,r,h,a)),s-=h,a+=h,k)break e}else n.head&&(n.head.comment=null);n.mode=16188;case 16188:if(512&n.flags){for(;l<16;){if(0===s)break e;s--,c+=r[a++]<<l,l+=8}if(4&n.wrap&&c!==(65535&n.check)){e.msg="header crc mismatch",n.mode=jr;break}c=0,l=0}n.head&&(n.head.hcrc=n.flags>>9&1,n.head.done=!0),e.adler=n.check=0,n.mode=Nr;break;case 16189:for(;l<32;){if(0===s)break e;s--,c+=r[a++]<<l,l+=8}e.adler=n.check=Mr(c),c=0,l=0,n.mode=Pr;case Pr:if(0===n.havedict)return e.next_out=o,e.avail_out=u,e.next_in=a,e.avail_in=s,n.hold=c,n.bits=l,kr;e.adler=n.check=1,n.mode=Nr;case Nr:if(t===yr||t===wr)break e;case Rr:if(n.last){c>>>=7&l,l-=7&l,n.mode=Dr;break}for(;l<3;){if(0===s)break e;s--,c+=r[a++]<<l,l+=8}switch(n.last=1&c,c>>>=1,l-=1,3&c){case 0:n.mode=16193;break;case 1:if(Qr(n),n.mode=Cr,t===wr){c>>>=2,l-=2;break e}break;case 2:n.mode=16196;break;case 3:e.msg="invalid block type",n.mode=jr}c>>>=2,l-=2;break;case 16193:for(c>>>=7&l,l-=7&l;l<32;){if(0===s)break e;s--,c+=r[a++]<<l,l+=8}if((65535&c)!=(c>>>16^65535)){e.msg="invalid stored block lengths",n.mode=jr;break}if(n.length=65535&c,c=0,l=0,n.mode=xr,t===wr)break e;case xr:n.mode=16195;case 16195:if(h=n.length,h){if(h>s&&(h=s),h>u&&(h=u),0===h)break e;i.set(r.subarray(a,a+h),o),s-=h,a+=h,u-=h,o+=h,n.length-=h;break}n.mode=Nr;break;case 16196:for(;l<14;){if(0===s)break e;s--,c+=r[a++]<<l,l+=8}if(n.nlen=257+(31&c),c>>>=5,l-=5,n.ndist=1+(31&c),c>>>=5,l-=5,n.ncode=4+(15&c),c>>>=4,l-=4,n.nlen>286||n.ndist>30){e.msg="too many length or distance symbols",n.mode=jr;break}n.have=0,n.mode=16197;case 16197:for(;n.have<n.ncode;){for(;l<3;){if(0===s)break e;s--,c+=r[a++]<<l,l+=8}n.lens[A[n.have++]]=7&c,c>>>=3,l-=3}for(;n.have<19;)n.lens[A[n.have++]]=0;if(n.lencode=n.lendyn,n.lenbits=7,T={bits:n.lenbits},I=gr(0,n.lens,0,19,n.lencode,0,n.work,T),n.lenbits=T.bits,I){e.msg="invalid code lengths set",n.mode=jr;break}n.have=0,n.mode=16198;case 16198:for(;n.have<n.nlen+n.ndist;){for(;S=n.lencode[c&(1<<n.lenbits)-1],g=S>>>24,m=S>>>16&255,y=65535&S,!(g<=l);){if(0===s)break e;s--,c+=r[a++]<<l,l+=8}if(y<16)c>>>=g,l-=g,n.lens[n.have++]=y;else{if(16===y){for(O=g+2;l<O;){if(0===s)break e;s--,c+=r[a++]<<l,l+=8}if(c>>>=g,l-=g,0===n.have){e.msg="invalid bit length repeat",n.mode=jr;break}k=n.lens[n.have-1],h=3+(3&c),c>>>=2,l-=2}else if(17===y){for(O=g+3;l<O;){if(0===s)break e;s--,c+=r[a++]<<l,l+=8}c>>>=g,l-=g,k=0,h=3+(7&c),c>>>=3,l-=3}else{for(O=g+7;l<O;){if(0===s)break e;s--,c+=r[a++]<<l,l+=8}c>>>=g,l-=g,k=0,h=11+(127&c),c>>>=7,l-=7}if(n.have+h>n.nlen+n.ndist){e.msg="invalid bit length repeat",n.mode=jr;break}for(;h--;)n.lens[n.have++]=k}}if(n.mode===jr)break;if(0===n.lens[256]){e.msg="invalid code -- missing end-of-block",n.mode=jr;break}if(n.lenbits=9,T={bits:n.lenbits},I=gr(1,n.lens,0,n.nlen,n.lencode,0,n.work,T),n.lenbits=T.bits,I){e.msg="invalid literal/lengths set",n.mode=jr;break}if(n.distbits=6,n.distcode=n.distdyn,T={bits:n.distbits},I=gr(2,n.lens,n.nlen,n.ndist,n.distcode,0,n.work,T),n.distbits=T.bits,I){e.msg="invalid distances set",n.mode=jr;break}if(n.mode=Cr,t===wr)break e;case Cr:n.mode=Br;case Br:if(s>=6&&u>=258){e.next_out=o,e.avail_out=u,e.next_in=a,e.avail_in=s,n.hold=c,n.bits=l,lr(e,d),o=e.next_out,i=e.output,u=e.avail_out,a=e.next_in,r=e.input,s=e.avail_in,c=n.hold,l=n.bits,n.mode===Nr&&(n.back=-1);break}for(n.back=0;S=n.lencode[c&(1<<n.lenbits)-1],g=S>>>24,m=S>>>16&255,y=65535&S,!(g<=l);){if(0===s)break e;s--,c+=r[a++]<<l,l+=8}if(m&&!(240&m)){for(w=g,b=m,_=y;S=n.lencode[_+((c&(1<<w+b)-1)>>w)],g=S>>>24,m=S>>>16&255,y=65535&S,!(w+g<=l);){if(0===s)break e;s--,c+=r[a++]<<l,l+=8}c>>>=w,l-=w,n.back+=w}if(c>>>=g,l-=g,n.back+=g,n.length=y,0===m){n.mode=16205;break}if(32&m){n.back=-1,n.mode=Nr;break}if(64&m){e.msg="invalid literal/length code",n.mode=jr;break}n.extra=15&m,n.mode=16201;case 16201:if(n.extra){for(O=n.extra;l<O;){if(0===s)break e;s--,c+=r[a++]<<l,l+=8}n.length+=c&(1<<n.extra)-1,c>>>=n.extra,l-=n.extra,n.back+=n.extra}n.was=n.length,n.mode=16202;case 16202:for(;S=n.distcode[c&(1<<n.distbits)-1],g=S>>>24,m=S>>>16&255,y=65535&S,!(g<=l);){if(0===s)break e;s--,c+=r[a++]<<l,l+=8}if(!(240&m)){for(w=g,b=m,_=y;S=n.distcode[_+((c&(1<<w+b)-1)>>w)],g=S>>>24,m=S>>>16&255,y=65535&S,!(w+g<=l);){if(0===s)break e;s--,c+=r[a++]<<l,l+=8}c>>>=w,l-=w,n.back+=w}if(c>>>=g,l-=g,n.back+=g,64&m){e.msg="invalid distance code",n.mode=jr;break}n.offset=y,n.extra=15&m,n.mode=16203;case 16203:if(n.extra){for(O=n.extra;l<O;){if(0===s)break e;s--,c+=r[a++]<<l,l+=8}n.offset+=c&(1<<n.extra)-1,c>>>=n.extra,l-=n.extra,n.back+=n.extra}if(n.offset>n.dmax){e.msg="invalid distance too far back",n.mode=jr;break}n.mode=16204;case 16204:if(0===u)break e;if(h=d-u,n.offset>h){if(h=n.offset-h,h>n.whave&&n.sane){e.msg="invalid distance too far back",n.mode=jr;break}h>n.wnext?(h-=n.wnext,v=n.wsize-h):v=n.wnext-h,h>n.length&&(h=n.length),p=n.window}else p=i,v=o-n.offset,h=n.length;h>u&&(h=u),u-=h,n.length-=h;do{i[o++]=p[v++]}while(--h);0===n.length&&(n.mode=Br);break;case 16205:if(0===u)break e;i[o++]=n.length,u--,n.mode=Br;break;case Dr:if(n.wrap){for(;l<32;){if(0===s)break e;s--,c|=r[a++]<<l,l+=8}if(d-=u,e.total_out+=d,n.total+=d,4&n.wrap&&d&&(e.adler=n.check=n.flags?Ft(n.check,i,d,o-d):Ut(n.check,i,d,o-d)),d=u,4&n.wrap&&(n.flags?c:Mr(c))!==n.check){e.msg="incorrect data check",n.mode=jr;break}c=0,l=0}n.mode=16207;case 16207:if(n.wrap&&n.flags){for(;l<32;){if(0===s)break e;s--,c+=r[a++]<<l,l+=8}if(4&n.wrap&&c!==(4294967295&n.total)){e.msg="incorrect length check",n.mode=jr;break}c=0,l=0}n.mode=16208;case 16208:I=_r;break e;case jr:I=Sr;break e;case 16210:return Er;default:return Ir}return e.next_out=o,e.avail_out=u,e.next_in=a,e.avail_in=s,n.hold=c,n.bits=l,(n.wsize||d!==e.avail_out&&n.mode<jr&&(n.mode<Dr||t!==mr))&&Zr(e,e.output,e.next_out,d-e.avail_out),f-=e.avail_in,d-=e.avail_out,e.total_in+=f,e.total_out+=d,n.total+=d,4&n.wrap&&d&&(e.adler=n.check=n.flags?Ft(n.check,i,d,e.next_out-d):Ut(n.check,i,d,e.next_out-d)),e.data_type=n.bits+(n.last?64:0)+(n.mode===Nr?128:0)+(n.mode===Cr||n.mode===xr?256:0),(0===f&&0===d||t===mr)&&I===br&&(I=Tr),I},inflateEnd:e=>{if(Lr(e))return Ir;let t=e.state;return t.window&&(t.window=null),e.state=null,br},inflateGetHeader:(e,t)=>{if(Lr(e))return Ir;const n=e.state;return 2&n.wrap?(n.head=t,t.done=!1,br):Ir},inflateSetDictionary:(e,t)=>{const n=t.length;let r,i,a;return Lr(e)?Ir:(r=e.state,0!==r.wrap&&r.mode!==Pr?Ir:r.mode===Pr&&(i=1,i=Ut(i,t,n,0),i!==r.check)?Sr:(a=Zr(e,t,n,n),a?(r.mode=16210,Er):(r.havedict=1,br)))},inflateInfo:"pako inflate (from Nodeca project)"};var Yr=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1};const Wr=Object.prototype.toString,{Z_NO_FLUSH:Xr,Z_FINISH:$r,Z_OK:ei,Z_STREAM_END:ti,Z_NEED_DICT:ni,Z_STREAM_ERROR:ri,Z_DATA_ERROR:ii,Z_MEM_ERROR:ai}=Vt;function oi(e){this.options=Vn({chunkSize:65536,windowBits:15,to:""},e||{});const t=this.options;t.raw&&t.windowBits>=0&&t.windowBits<16&&(t.windowBits=-t.windowBits,0===t.windowBits&&(t.windowBits=-15)),!(t.windowBits>=0&&t.windowBits<16)||e&&e.windowBits||(t.windowBits+=32),t.windowBits>15&&t.windowBits<48&&(15&t.windowBits||(t.windowBits|=15)),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new Gn,this.strm.avail_out=0;let n=Gr.inflateInit2(this.strm,t.windowBits);if(n!==ei)throw new Error(zt[n]);if(this.header=new Yr,Gr.inflateGetHeader(this.strm,this.header),t.dictionary&&("string"==typeof t.dictionary?t.dictionary=Kn(t.dictionary):"[object ArrayBuffer]"===Wr.call(t.dictionary)&&(t.dictionary=new Uint8Array(t.dictionary)),t.raw&&(n=Gr.inflateSetDictionary(this.strm,t.dictionary),n!==ei)))throw new Error(zt[n])}function si(e,t){const n=new oi(t);if(n.push(e),n.err)throw n.msg||zt[n.err];return n.result}oi.prototype.push=function(e,t){const n=this.strm,r=this.options.chunkSize,i=this.options.dictionary;let a,o,s;if(this.ended)return!1;for(o=t===~~t?t:!0===t?$r:Xr,"[object ArrayBuffer]"===Wr.call(e)?n.input=new Uint8Array(e):n.input=e,n.next_in=0,n.avail_in=n.input.length;;){for(0===n.avail_out&&(n.output=new Uint8Array(r),n.next_out=0,n.avail_out=r),a=Gr.inflate(n,o),a===ni&&i&&(a=Gr.inflateSetDictionary(n,i),a===ei?a=Gr.inflate(n,o):a===ii&&(a=ni));n.avail_in>0&&a===ti&&n.state.wrap>0&&0!==e[n.next_in];)Gr.inflateReset(n),a=Gr.inflate(n,o);switch(a){case ri:case ii:case ni:case ai:return this.onEnd(a),this.ended=!0,!1}if(s=n.avail_out,n.next_out&&(0===n.avail_out||a===ti))if("string"===this.options.to){let e=Zn(n.output,n.next_out),t=n.next_out-e,i=Qn(n.output,e);n.next_out=t,n.avail_out=r-t,t&&n.output.set(n.output.subarray(e,e+t),0),this.onData(i)}else this.onData(n.output.length===n.next_out?n.output:n.output.subarray(0,n.next_out));if(a!==ei||0!==s){if(a===ti)return a=Gr.inflateEnd(this.strm),this.onEnd(a),this.ended=!0,!0;if(0===n.avail_in)break}}return!0},oi.prototype.onData=function(e){this.chunks.push(e)},oi.prototype.onEnd=function(e){e===ei&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=Jn(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};var ui={Inflate:oi,inflate:si,inflateRaw:function(e,t){return(t=t||{}).raw=!0,si(e,t)},ungzip:si,constants:Vt};const{Deflate:ci,deflate:li,deflateRaw:fi,gzip:di}=ur,{Inflate:hi,inflate:vi,inflateRaw:pi,ungzip:gi}=ui;var mi=di,yi=gi,wi={userId:"u",sessionId:"s",lastEventTime:"let",sessionProperties:"sp",pageviewProperties:"pp",time:"ts",referrer:"r",id:"id",search_keyword:"e",utm:"utm",source:"us",medium:"um",term:"ut",content:"uc",campaign:"ua",initial_pageview_info:"ipi",title:"t",url:"url",domain:"d",path:"h",query:"q",hash:"g",source_properties:"spx",screen_height:"sch",screen_width:"scw",identity:"i"},bi=function e(t){var n={};return Object.entries(t).forEach((function(t){var i=A(t,2),a=i[0],o=i[1];n[wi[a]||a]="object"===r(o)&&null!==o?e(o):o})),n},_i=function e(t){if("string"==typeof t)return t;var n={};return Object.entries(t).forEach((function(t){var i=A(t,2),a=i[0],o=i[1],s=Object.keys(wi).find((function(e){return wi[e]===a}))||a;n[s]="object"===r(o)&&null!==o?e(o):o})),n};function ki(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ii(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ki(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ki(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Si=function(e){return e.BASE_64="base64",e.URI="uri",e.UNKNOWN="unknown",e}(Si||{}),Ei=l((function e(){var t=this;u(this,e),a(this,"_findHighestLevelDomain",(function(){for(var e="",n=window.location.hostname||"localhost",r="hld"+N(),i="_hp2_".concat(r),a=n.split("."),o=a.length-1;o>=0;o--)t.getItem(i)!==r&&(e=a.slice(o,a.length).join("."),t.setItem(i,r,{expires:15e4,domain:e}));t.setItem(i,r,{expires:-1,domain:e});var s=!e.match(/[a-zA-Z]/),u=e.indexOf(".")<0;return(s||u)&&(e=null),e})),a(this,"setItem",(function(e,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=t.encodeValue(n),o=function(e){try{return(new TextEncoder).encode(e).length}catch(e){return 0}}(i);if(o>3500)return"Cookie size of ".concat(o," bytes is larger than ").concat(3500," bytes");var s,u="".concat(encodeURIComponent(e),"=").concat(i),c=!1;r&&r.domain||(s=t._findHighestLevelDomain());var l="https:"===document.location.protocol&&He.getInstance().getEnableSecureCookies(),f=$e(l);f&&(r=Ii(Ii({},r),{},a({},"SameSite",f))),r&&Object.keys(r).map((function(e){var t=r[e];if("expires"===e){var n=new Date,i=n.getTime()+ +r.expires;n.setTime(i),t=n.toUTCString()}t&&(u+="; ".concat(e,"=").concat(t)),"path"===e&&(c=!0),"domain"===e&&(s=t)})),c||(u+="; path=/"),s&&(u+="; domain=.".concat(s)),l&&(u+="; secure"),document.cookie=u})),a(this,"getAllCookiesMatching",(function(e,t){for(var n=new RegExp("(^|;)[ ]*"+e+"=([^;]*)","g"),r=[],i=n.exec(t);i;)r.push(i[2]),i=n.exec(t);return r})),a(this,"getItem",(function(e){var n=t.getAllCookiesMatching(e,document.cookie),r=t.decodeValue(n[0]);if(n.length>1&&window.heap.loaded){t.setItem(e,"delete",{expires:-1});var i=t.getAllCookiesMatching(e,document.cookie),a=n.filter((function(e){return!i.includes(e)}));a.length>0&&(r=t.decodeValue(a[0])),r&&t.setItem(e,r)}if(!r)return null;try{var o=JSON.parse(r);return _i(o)}catch(e){return r}})),a(this,"hasExpired",(function(e){return new Date>=e})),a(this,"removeItem",(function(e){t.setItem(e,"",{expires:"-60000"})})),a(this,"getShouldCompressCookies",(function(){He.getInstance().getShouldCompressCookies()})),a(this,"encodeValue",(function(e){var t,n,r,i,a=He.getInstance().getShouldCompressCookies();if("string"==typeof e)t=e;else{var o=a?bi(e):e;t=JSON.stringify(o)}return a?(n=t,r=(new TextEncoder).encode(n),i=mi(r),btoa(String.fromCharCode.apply(String,w(i)))):encodeURIComponent(t)})),a(this,"decodeValue",(function(e){if(e)return t.detectEncodingType(e)===Si.BASE_64?function(e){try{for(var t=atob(e),n=new Uint8Array(t.length),r=0;r<t.length;r++)n[r]=t.charCodeAt(r);return yi(n,{to:"string"})}catch(t){if("incorrect header check"===t)return e;throw t}}(e):decodeURIComponent(e)})),a(this,"detectEncodingType",(function(e){return e?/%[0-9A-Fa-f]{2}/.test(e)?Si.URI:/^[A-Za-z0-9+/=]+$/.test(e)&&e.length%4==0?Si.BASE_64:Si.UNKNOWN:Si.UNKNOWN}))})),Ti=function(){function e(){var t=this;u(this,e),a(this,"storage",{}),a(this,"setItem",(function(e,n,r){t.storage[e]=n})),a(this,"getItem",(function(e){return t.storage[e]})),a(this,"removeItem",(function(e){delete t.storage[e]}))}return l(e,null,[{key:"getInstance",value:function(){return e.instance||(e.instance=new e),e.instance}}]),e}(),Oi="uach_adapter",Ai=function(){var e=t(s().mark((function e(){var t,n,r,i,a,o,u,c;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=["fullVersionList","platformVersion","model"],e.next=3,null===(t=navigator.userAgentData)||void 0===t?void 0:t.getHighEntropyValues(r);case 3:if(i=e.sent){e.next=6;break}return e.abrupt("return");case 6:return a=i.model,o=i.platformVersion,u="",c=/Chromium/.test(navigator.userAgent)?"Chromium":"Chrome",null===(n=i.fullVersionList)||void 0===n||n.forEach((function(e){var t;(null===(t=e.brand)||void 0===t?void 0:t.indexOf(c))>-1&&(u=e.version)})),e.abrupt("return",{model:a,platform_version:o,browser_version:u});case 12:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Pi={name:Oi,fn:function(){var e;null!==(e=navigator.userAgentData)&&void 0!==e&&e.getHighEntropyValues||(O.trace("UACH Adapter -- Browser does not contain UACH APIs, resolving adapter"),Uf.markAdapterAsResolved(Oi));try{Ai().then((function(e){O.trace("UACH Adapter -- Setting UACH on store",{uach:e}),Ae.getInstance().setUserAgentClientHints(e)})).finally((function(){Uf.markAdapterAsResolved(Oi)}))}catch(e){O.error("UACH Adapter -- exception occurred while getting UACH data, resolving adapter",{error:e}),Uf.markAdapterAsResolved(Oi)}}},Ni=function(){function e(){u(this,e)}return l(e,[{key:"setAPIDependencies",value:function(e){this.coreAPIs=e}}],[{key:"getInstance",value:function(){return e.instance||(e.instance=new e),e.instance}}]),e}(),Ri="_hp_ved",xi="https://heapanalytics.com",Ci=function(e){return e.Telemetry="telemetry",e.StatusUpdate="status",e}({}),Bi=function(e){return e.ReceivedInitMessage="received_init_message",e.PreFetchMetadata="pre_fetch_metadata",e.PostFetchMetadata="post_fetch_metadata",e}({});function Di(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}var ji=function(e,t){var n=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Di(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Di(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},e);for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=t(e[r]));return n},Mi=function(){function e(){u(this,e),a(this,"_hasInitialized",!1),this._coreApis=Ni.getInstance().coreAPIs,this._storage=new Ei,this._metadataStore=Is.getInstance()}return l(e,[{key:"_noopHeap",value:function(){var e;null===(e=this._coreApis)||void 0===e||e.logger.trace("Visual Labeler - No-oping window.heap"),window.heap=ji(window.heap,(function(e){return z(e)?function(){}:e}))}},{key:"_loadVLScript",value:function(){var e,t=document.createElement("script");t.type="text/javascript",t.src="https://heapanalytics.com/js/ved.js",document.head.appendChild(t),null===(e=this._coreApis)||void 0===e||e.logger.trace("Visual Labeler - VL Script has been loaded")}},{key:"_loadVLStyles",value:function(){var e;["https://heapanalytics.com/css/ved.css","https://heapanalytics.com/js/ved.css"].forEach((function(e){var t=document.createElement("link");t.rel="stylesheet",t.href=e,document.head.appendChild(t)})),null===(e=this._coreApis)||void 0===e||e.logger.trace("Visual Labeler - VL Styles have been loaded")}},{key:"_setVLCookie",value:function(){var e,t;null===(e=this._coreApis)||void 0===e||e.logger.trace("Visual Labeler - Setting VL cookie"),this._storage.setItem(Ri,"on",{expires:18e5}),null===(t=this._coreApis)||void 0===t||t.logger.trace("VisualLabeler - Cookie has been set",a({},Ri,this._storage.getItem(Ri)))}},{key:"_overrideEnvironmentId",value:function(){var e,t=this._metadataStore.getEnvironmentId();this._metadataStore.setEnvironmentId("3407116132"),Lf.appid=this._metadataStore.getEnvironmentId(),null===(e=this._coreApis)||void 0===e||e.logger.trace("Visual Labeler - Overriding App ID",{before:{appId:t},after:{appId:Lf.appid}})}},{key:"_initializeHeapV",value:function(e){var t;null===(t=this._coreApis)||void 0===t||t.logger.trace("Visual Labeler - Initializing window.heapV for use in the VL"),window.heapV=Object.assign({},window.heap,{source:null==e?void 0:e.source,uri:xi,loadArgs:null==e?void 0:e.data.args})}},{key:"initialize",value:function(e){var t,n,r,i,a;this._hasInitialized?null===(i=this._coreApis)||void 0===i||i.logger.trace("Visual Labeler - VL has already been initialized. Exiting"):(null===(t=this._coreApis)||void 0===t||t.logger.trace("Visual Labeler - Intializing"),this._hasInitialized=!0,this._setVLCookie(),this._overrideEnvironmentId(),null===(n=this._coreApis)||void 0===n||n.logger.trace("Visual Labeler - Flushing event queue"),null===(r=this._coreApis)||void 0===r||r.flushEventQueue(),this._initializeHeapV(e),window.heapV?(this._loadVLScript(),this._loadVLStyles(),this._noopHeap()):null===(a=this._coreApis)||void 0===a||a.logger.trace("Visual Labeler - heapV not initialized. Exiting"))}}],[{key:"getInstance",value:function(){return e.instance||(e.instance=new e),e.instance}}]),e}();function Ui(e){var t,n=null===(t=Ni.getInstance().coreAPIs)||void 0===t?void 0:t.logger;e.origin===xi&&("object"===r(e.data)?"init"===e.data.message?e.source?(null==n||n.trace("Visual Labeler - Init message received"),Li(e.source),Mi.getInstance().initialize(e)):null==n||n.trace("Visual Labeler - Post message `source` not provided. Exiting",{event:e}):null==n||n.trace('Visual Labeler - Disregarding non "init" post message',{event:e}):null==n||n.trace("Visual Labeler - Post message `data` is not an object. Exiting",{event:e}))}var Li=function(e){e.postMessage({type:Ci.StatusUpdate,value:Bi.ReceivedInitMessage},{targetOrigin:"*"})},Fi=[{adapter:Pi,config:{isBlocking:!0,blockDurationInMs:1e3}},{adapter:{name:"visualLabeler",fn:function(e){var t,n,r;Ni.getInstance().setAPIDependencies(e),null==(n=null===(t=Ni.getInstance().coreAPIs)||void 0===t?void 0:t.logger)||n.trace("Visual Labeler - Listening for postmessage"),window.addEventListener("message",Ui),r=new Ei,window.top===window.self&&r.getItem(Ri)&&Mi.getInstance().initialize()}},config:{isBlocking:!1}}],zi="contentsquare",Vi="hoh-contentsquare",Ji=[zi,Vi],qi=["auryc","session_replay",zi,Vi];function Hi(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ki(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Hi(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Hi(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Qi=5e3,Zi=function(){function e(){u(this,e),a(this,"startProcessingTime",Number.MAX_SAFE_INTEGER),a(this,"adapters",[]),a(this,"hasProcessingBeenCalled",!1),a(this,"adapterResolvedState",{})}return l(e,[{key:"registerAdapter",value:function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{isBlocking:!1};this.hasProcessingBeenCalled||this.adapters.find((function(t){return t.name===e.name}))||(this.adapters.push({name:e.name,adapterFn:e.fn,config:Ki(Ki({},n),{},{blockDurationInMs:n.blockDurationInMs&&n.blockDurationInMs<Qi?n.blockDurationInMs:Qi,rerunOnNewPageview:null!==(t=n.rerunOnNewPageview)&&void 0!==t&&t})}),this.adapterResolvedState[e.name]=!n.isBlocking)}},{key:"markAdapterAsResolved",value:function(e){this.adapterResolvedState[e]?O.trace("AdapterRegistry -- adapter has already been resolved, skipping: ".concat(e)):O.trace("AdapterRegistry -- adapter has been resolved: ".concat(e)),this.adapterResolvedState[e]=!0,this.shouldBlockEventProcessing()||ps.getInstance().flushTemporaryMetadataQueue()}},{key:"_registerIntegrationAdapters",value:function(){var e=this,t=He.getInstance(),n=t.getIntegrations(),r=t.isSessionReplayDisabled(),i=t.getCsHeapTagStatus();n.forEach((function(t){var n=t.name,a=t.fn,o=t.config;r&&qi.includes(n)?O.debug("AdapterRegistry -- Session replay is disabled, skipping adapter: ",{name:n}):i!==ne.HeapSideloadsCS&&Ji.includes(n)?O.debug("AdapterRegistry -- Client config override server config: ",{name:n,heapTagStatus:i}):e.registerAdapter({name:n,fn:a},o)}))}},{key:"_registerDefaultClientsideAdapters",value:function(){var e=this;Fi.forEach((function(t){var n=t.adapter,r=t.config;e.registerAdapter(n,r)}))}},{key:"initializeAdapters",value:function(e){var t=this;this.dependencies=Ki(Ki({},e),{},{markAdapterAsResolved:this.markAdapterAsResolved.bind(this)}),this.hasProcessingBeenCalled?O.trace("AdapterRegistry - initializeAdapters has already been called, skipping"):(O.trace("AdapterRegistry -- begin adapter initialization"),this._registerIntegrationAdapters(),this._registerDefaultClientsideAdapters(),this.hasProcessingBeenCalled=!0,this.startProcessingTime=Date.now(),this.adapters.forEach((function(e){var r=e.name,i=e.adapterFn,a=e.config;O.trace("AdapterRegistry -- Processing adapter: ",{name:r,adapterFn:i,config:a}),i(t.dependencies),n.g.setTimeout((function(){t.markAdapterAsResolved(r)}),a.blockDurationInMs)})))}},{key:"shouldBlockEventProcessing",value:function(){return!!this.adapters.length&&(!(this.startProcessingTime+Qi<Date.now())&&(!this.hasProcessingBeenCalled||Object.values(this.adapterResolvedState).some((function(e){return!e}))))}},{key:"getAdaptersToRerunOnNewPageview",value:function(){return this.adapters.filter((function(e){return e.config.rerunOnNewPageview}))}}],[{key:"getInstance",value:function(){return e.instance||(e.instance=new e),e.instance}}]),e}(),Gi=function(){function e(){u(this,e),a(this,"shouldIgnoreBlockingTransformers",!1)}return l(e,[{key:"setShouldIgnoreBlockingTransformers",value:function(e){this.shouldIgnoreBlockingTransformers=e}},{key:"getShouldIgnoreBlockingTransformers",value:function(){return this.shouldIgnoreBlockingTransformers}}],[{key:"getInstance",value:function(){return e.instance||(e.instance=new e),e.instance}}]),e}(),Yi=function(){function e(){u(this,e),a(this,"isAsync",!1)}return l(e,[{key:"transformAsync",value:function(e){return Promise.resolve(this.transform(e))}},{key:"relay",value:function(e,t){var n=this.getTarget(t);O.trace("Transformer ".concat(this.name," -- relaying messages to ").concat(n.name)),n.transformAndRelay(e,t)}},{key:"transformAndRelay",value:function(e,t){var r,i,a=this,o=e,s=Gi.getInstance().getShouldIgnoreBlockingTransformers();if(this.isAsync&&this.transformAsync){if(s)return O.trace("Transformer ".concat(this.name," -- async and unloading, so skipping this transformer")),void this.relay(o,t);Promise.race([this.transformAsync(e),(r=5e3,i=e,new Promise((function(e){n.g.setTimeout((function(){e(i)}),r)})))]).then((function(e){a.relay(e,t)}))}else o=this.transform(e),this.relay(o,t)}}]),e}(),Wi=function(e){return e.TRACK_EVENT_CONSTRUCTION="TRACK_EVENT_CONSTRUCTION",e.ENTRY="ENTRY",e.EVENT_METADATA_ENRICHMENT="EVENT_METADATA_ENRICHMENT",e.REDACTION="REDACTION",e.PROPERTY_SANITIZATION="PROPERTY_SANITIZATION",e.EXIT="EXIT",e.ERROR="ERROR",e.SESSION_REPLAY_ENRICHMENT="SESSION_REPLAY_ENRICHMENT",e}({}),Xi=function(e){return e.METADATA_EVENT_CREATION="META_EVENT_CREATION",e.BLOCK_UNTIL_CS_METADATA_IS_AVAILABLE="BLOCK_UNTIL_CS_METADATA_IS_AVAILABLE",e.METADATA_EXIT="META_EXIT",e}({}),$i=function(e){return e.IDENTITY_EVENT_CREATION="IDENTITY_EVENT_CREATION",e.IDENTITY_EXIT="IDENTITY_EXIT",e}({}),ea=function(e){return e.ENTRY="ENTRY",e.PROPERTY_SANITIZATION="PROPERTY_SANITIZATION",e.USER_PROPERTIES_EVENT_CREATION="USER_PROPERTIES_EVENT_CREATION",e}({}),ta=function(e){return e.GENERAL="general",e.METADATA="metadata",e.IDENTITY="identity",e.ADD_USER_PROPERTIES="addUserProperties",e}({}),na=function(e){if(e&&e.length){var t=function(e){var t=0;return e.forEach((function(e){var n=e.data.time;n&&(!t||n>t)&&(t=n)})),t}(e);if(t)Is.getInstance().updateLastEventTime(t);else O.trace("updateLastEventTimeHook -- Unable to find most recent event time.",{messages:e})}else O.trace("updateLastEventTimeHook -- No events to update last event time against")},ra=function(e){var t=Is.getInstance();na(e),t.setIdentity(e[0].data.identity)};function ia(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=d(e);if(t){var i=d(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return g(this,n)}}var aa=function(e){p(n,e);var t=ia(n);function n(){var e;u(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return a(f(e=t.call.apply(t,[this].concat(i))),"name",Wi.EXIT),e}return l(n,[{key:"getTarget",value:function(e){return ss(e,this.name)}},{key:"relay",value:function(e,t){Il(e,na)}},{key:"transform",value:function(e){return e}}],[{key:"getInstance",value:function(){return n.instance||(n.instance=new n),n.instance}}]),n}(Yi),oa=function(){function e(){u(this,e),a(this,"apiQueue",[]),a(this,"onReadyQueue",[]),a(this,"onReadyQueueHasBeenFlushed",!1)}return l(e,[{key:"enqueueHeapApi",value:function(e){O.debug("enqueuing API function",e),this.apiQueue.push(e)}},{key:"enqueueOnReady",value:function(e){O.debug("enqueuing onReady function",e),this.onReadyQueue.push(e)}},{key:"dequeueHeapApi",value:function(){return this.apiQueue.shift()}},{key:"dequeueOnReady",value:function(){return this.onReadyQueue.shift()}},{key:"executeHeapApiQueue",value:function(){for(;this.apiQueue.length>0;){var e=this.dequeueHeapApi();try{var t;null==e||null===(t=e.fn)||void 0===t||t.call(e)}catch(t){O.warn("FunctionQueue -- exception thrown when executing API callback, ignoring and continuing",{fn:e})}}}},{key:"executeStopTrackingAndStopRecording",value:function(){var e=[];this.apiQueue=this.apiQueue.filter((function(t){return!["stopTracking","stopRecording"].includes(t.name)||(e.push(t),!1)})),e.forEach((function(e){try{e.fn()}catch(t){O.warn("FunctionQueue -- exception thrown when executing stopTracking/stopRecording API callback, ignoring and continuing",{fn:e})}}))}},{key:"executeOnReadyQueue",value:function(){var e=w(this.onReadyQueue);for(O.debug("executeOnReadyQueue -- executing onReady function queue",{queue:e});this.onReadyQueue.length>0;){var t=this.dequeueOnReady();try{var n;null==t||null===(n=t.fn)||void 0===n||n.call(t)}catch(e){O.warn("FunctionQueue -- exception thrown when executing onReady callback, ignoring and continuing",{fn:t})}}this.onReadyQueueHasBeenFlushed=!0}},{key:"getApiQueue",value:function(){return this.apiQueue}},{key:"getOnReadyQueue",value:function(){return this.onReadyQueue}},{key:"getOnReadyQueueHasBeenFlushed",value:function(){return this.onReadyQueueHasBeenFlushed}}],[{key:"getInstance",value:function(){return e.instance||(e.instance=new e),e.instance}}]),e}(),sa=function(){var e=ua();return O.debug("Webview -- checking webview contents",e),!!e},ua=function(){var e,t,n=new Ei,r=(e="wv_id",t=Is.getInstance().getEnvironmentId(),"_hp2_".concat(e,".").concat(t)),i=n.getItem(r);if(!i)return null;try{return ca(i)?i:null}catch(e){return null}},ca=function(e){return"sessionId"in e&&"userId"in e&&("string"==typeof e.sessionId&&!isNaN(+e.sessionId)&&"string"==typeof e.userId&&!isNaN(+e.userId))},la=function(){function e(){u(this,e),a(this,"queue",[])}return l(e,[{key:"flushTemporaryIdentifyQueue",value:function(){this.queue.length&&(O.debug("IdentifyMessageQueue -- flushing the temporary identify queue",{queue:this.queue}),this.queue.forEach((function(e){var t=e.identity,n=e.user_id;hs(t,n)})),this.queue=[])}},{key:"queueIdentityEvent",value:function(e,t){Is.getInstance().getHasMetadataBeenSentToNetwork()?hs(e,t):(O.trace("IdentifyMessageQueue -- blocking identify event until metadata has been sent to network"),this.queue.push({identity:e,user_id:t}))}}],[{key:"getInstance",value:function(){return e.instance||(e.instance=new e),e.instance}}]),e}();function fa(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=d(e);if(t){var i=d(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return g(this,n)}}function da(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ha(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?da(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):da(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var va=function(e){var t=Is.getInstance();if(!t.hasQueuedMetadataEvents()){var n,r,i,a={};e.forEach((function(e){var t=e.id,o=e.type,s=e.data,u=s.time||0;o===_.METADATA_USER?(n=t,a=ha(ha({},a),{},{userId:t})):o===_.METADATA_SESSION?(r=t,a=ha(ha({},a),{},{sessionId:t,lastEventTime:u,sessionProperties:s.session_info})):o===_.METADATA_PAGEVIEW&&(i=t,a=ha(ha({},a),{},{pageviewId:t,pageviewProperties:s.pageview_info,lastEventTime:u}))})),t.setMetadata(a),n&&(O.trace("Metadata Request -- User event has been enqueued."),t.setHasUserBeenQueued(!0)),r&&(O.trace("Metadata Request -- Session event has been enqueued."),t.setHasSessionBeenQueued(!0)),i&&(O.trace("Metadata Request -- Pageview event has been enqueued."),t.setHasPageviewBeenQueued(!0))}},pa=function(e){var t,n,r,i,a,o,s,u=Is.getInstance();va(e),sa()&&(t=(new Date).getTime()+D,n=u.getSessionId(),s={type:"heapjs-extend-session",sessionId:n,expirationDate:t},null===(r=window.HeapAndroidBridge)||void 0===r||r.postMessage(JSON.stringify(s)),null===(i=window.webkit)||void 0===i||null===(a=i.messageHandlers)||void 0===a||null===(o=a.HeapSwiftBridge)||void 0===o||o.postMessage(s)),u.setHasMetadataBeenSentToNetwork(!0),oa.getInstance().executeOnReadyQueue(),la.getInstance().flushTemporaryIdentifyQueue()},ga=function(e){p(n,e);var t=fa(n);function n(){var e;u(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return a(f(e=t.call.apply(t,[this].concat(i))),"name",Xi.METADATA_EXIT),e}return l(n,[{key:"getTarget",value:function(e){return ss(e,this.name)}},{key:"relay",value:function(e,t){Il(e,pa)}},{key:"transform",value:function(e){return e}}],[{key:"getInstance",value:function(){return n.instance||(n.instance=new n),n.instance}}]),n}(Yi);function ma(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ya(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ma(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ma(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function wa(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=d(e);if(t){var i=d(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return g(this,n)}}var ba=function(e){p(n,e);var t=wa(n);function n(){var e;u(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return a(f(e=t.call.apply(t,[this].concat(i))),"name",Wi.EVENT_METADATA_ENRICHMENT),a(f(e),"_normalizeEventTimeAgainstPageviewTime",(function(t,n){var r=t.reduce((function(e,t){return t.data.time<e?t.data.time:e}),t[0].data.time);if(r>n)return t;var i=n-r,a=t.map((function(e){var t=e.data.time+i,n=ya(ya({},e.data),{},{time:t});return ya(ya({},e),{},{data:n})}));return O.trace("Transformer ".concat(e.name," -- normalized event time against pageview time"),{before:t,after:a,pageviewTime:n}),a})),e}return l(n,[{key:"getTarget",value:function(e){return ss(e,this.name)}},{key:"_enrichMessageWithMetadataContext",value:function(e){var t=Is.getInstance(),n=t.getMetadata(),r=n.userId,i=n.pageviewId,a=n.pageviewProperties,o=n.sessionProperties,s=n.identity,u=Ue(),c=Le(),l={env_id:t.getEnvironmentId(),user_id:r,identity:s,base_library:c,device:u,session_info:o,pageview_info:ya(ya({},a),{},{id:i})};return ya(ya({},e),{},{data:ya(ya({},e.data),l)})}},{key:"transform",value:function(e){var t=this,n=Is.getInstance();if(!n._canAccessStorage())return O.debug("Transformer ".concat(this.name," -- cannot access storage")),[];if(n.createNewUserIfNeeded(),n.createNewSessionIfNeeded(),n.createNewPageviewIfNeeded(),!n.hasQueuedMetadataEvents())return[];var r=n.getMetadata().pageviewProperties.time,i=this._normalizeEventTimeAgainstPageviewTime(e,r).map((function(e){return t._enrichMessageWithMetadataContext(e)}));return O.trace("Transformer ".concat(this.name," - added metadata context to event messages"),{before:e,after:i}),i}}],[{key:"getInstance",value:function(){return n.instance||(n.instance=new n),n.instance}}]),n}(Yi);function _a(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=d(e);if(t){var i=d(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return g(this,n)}}var ka=function(e){p(n,e);var t=_a(n);function n(){var e;u(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return a(f(e=t.call.apply(t,[this].concat(i))),"name",Wi.EXIT),e}return l(n,[{key:"getTarget",value:function(e){return ss(e,this.name)}},{key:"relay",value:function(e,t){Il(e,ra)}},{key:"transform",value:function(e){return e}}],[{key:"getInstance",value:function(){return n.instance||(n.instance=new n),n.instance}}]),n}(Yi);function Ia(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Sa(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ia(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ia(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Ea(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=d(e);if(t){var i=d(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return g(this,n)}}var Ta=function(e){p(n,e);var t=Ea(n);function n(){var e;u(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return a(f(e=t.call.apply(t,[this].concat(i))),"name",ea.USER_PROPERTIES_EVENT_CREATION),e}return l(n,[{key:"getTarget",value:function(e){return ss(e,this.name)}},{key:"_constructUserPropertiesMessage",value:function(e){var t=Is.getInstance();return Sa(Sa({},e),{},{data:{time:e.info.time,env_id:t.getEnvironmentId(),user_id:t.getUserId(),properties:e.info.properties,device:Ue(),library:Le()}})}},{key:"transform",value:function(e){if(!e.length||e.length>1)return O.trace("Transformer ".concat(this.name," -- Invalid number of AUP event messages sent, should always expect 1 message"),{messages:e}),[];var t=e[0];if(0===Object.keys(t.info.properties).length)return O.trace("Transformer ".concat(this.name," -- Invalid properties")),[];var n=this._constructUserPropertiesMessage(t);return O.trace("Transformer ".concat(this.name," -- creating aup event message"),{before:t,after:n}),[n]}}],[{key:"getInstance",value:function(){return n.instance||(n.instance=new n),n.instance}}]),n}(Yi);function Oa(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Aa(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Oa(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Oa(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Pa(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=d(e);if(t){var i=d(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return g(this,n)}}var Na=function(e){p(n,e);var t=Pa(n);function n(){var e;u(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return a(f(e=t.call.apply(t,[this].concat(i))),"name",Wi.PROPERTY_SANITIZATION),e}return l(n,[{key:"getTarget",value:function(e){return ss(e,this.name)}},{key:"_sanitizeMessages",value:function(e){var t=e.info.properties;if(!t)return e;var n=e;if(t){var r=Q(t,e.info.isAutotrack);n=Aa(Aa({},e),{},{info:Aa(Aa({},e.info),{},{properties:r})})}return n}},{key:"transform",value:function(e){var t=this,n=e.map((function(e){return t._sanitizeMessages(e)}));return O.trace("Transformer ".concat(this.name," -- sanitized event messages"),{before:e,after:n}),n}}],[{key:"getInstance",value:function(){return n.instance||(n.instance=new n),n.instance}}]),n}(Yi);function Ra(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function xa(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ra(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ra(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Ca(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=d(e);if(t){var i=d(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return g(this,n)}}var Ba=function(e){return e.APPCUES="appcues",e.CHAMELEON="chameleon",e.SEGMENT="segment",e.CONTENTSQUARE="contentsquare",e}({}),Da=function(e){p(n,e);var t=Ca(n);function n(){var e;u(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return a(f(e=t.call.apply(t,[this].concat(i))),"name",Wi.TRACK_EVENT_CONSTRUCTION),e}return l(n,[{key:"getTarget",value:function(e){return ss(e,this.name)}},{key:"_constructSourceName",value:function(e,t){return-1!==e.toLocaleLowerCase().indexOf(Ba.CHAMELEON)?Ba.CHAMELEON:t}},{key:"constructCustomTrackPayload",value:function(e,t){var n=t?{source_properties:e.info.properties}:{properties:e.info.properties};return{custom:xa({name:e.info.event},e.info.properties&&n)}}},{key:"constructInteractionTrackPayload",value:function(e){return{interaction:xa({},e.info.properties)}}},{key:"_isSupportedSource",value:function(e){return!!e&&Object.values(Ba).includes(e.toLowerCase())}},{key:"_constructSourceLibrary",value:function(e,t){var n,r,i,a;return{source_library:xa(xa({},e.info.source),{},{name:t,version:null!==(n=null===(r=e.info.source)||void 0===r?void 0:r.version)&&void 0!==n?n:"0.0.0",platform:null!==(i=null===(a=e.info.source)||void 0===a?void 0:a.platform)&&void 0!==i?i:"web"})}}},{key:"_getSourceInformation",value:function(e){var t,n={isSupported:!1};return n.name=this._constructSourceName(e.info.event,null===(t=e.info.source)||void 0===t?void 0:t.name),n.isSupported=this._isSupportedSource(n.name),n}},{key:"transform",value:function(e){var t=this,n=e.map((function(e){var n,r=e.info.isAutotrack,i=t._getSourceInformation(e);return xa(xa({},e),{},{data:xa(xa(xa({},e.data),Fe(null===(n=e.info.properties)||void 0===n?void 0:n.snapshotProperties)),{},{event:r?t.constructInteractionTrackPayload(e):t.constructCustomTrackPayload(e,i.isSupported)},i.isSupported&&i.name&&t._constructSourceLibrary(e,i.name))})}));return O.trace("Transformer ".concat(this.name," -- populated track event data"),{before:e,after:n}),n}}],[{key:"getInstance",value:function(){return n.instance||(n.instance=new n),n.instance}}]),n}(Yi);function ja(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=d(e);if(t){var i=d(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return g(this,n)}}var Ma=function(e){p(i,e);var n,r=ja(i);function i(){return u(this,i),r.apply(this,arguments)}return l(i,[{key:"transformAsync",value:(n=t(s().mark((function e(t){var n,r;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=JSON.parse(JSON.stringify(t)),e.prev=1,e.next=4,this.transformFnAsync(n);case 4:return r=e.sent,O.debug("CustomTransformer ".concat(this.name," -- transformed messages with async call"),{before:t,after:r}),e.abrupt("return",r);case 9:return e.prev=9,e.t0=e.catch(1),O.warn("CustomTransformer ".concat(this.name," -- failed to transform message asynchronously, defaulting to original messages"),{error:e.t0}),e.abrupt("return",t);case 13:case"end":return e.stop()}}),e,this,[[1,9]])}))),function(e){return n.apply(this,arguments)})},{key:"transform",value:function(e){var t=JSON.parse(JSON.stringify(e));try{var n=this.transformFn(t);return O.debug("CustomTransformer ".concat(this.name," -- transformed messages"),{before:e,after:n}),n}catch(t){return O.warn("CustomTransformer ".concat(this.name," -- failed to transform message, defaulting to original messages"),{error:t}),e}}},{key:"getTarget",value:function(e){return ss(e,this.name)}}]),i}(Yi);function Ua(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=d(e);if(t){var i=d(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return g(this,n)}}var La=function(){function e(){var t;u(this,e),a(this,"pipelineToTransformers",(a(t={},ta.GENERAL,[]),a(t,ta.ADD_USER_PROPERTIES,[]),a(t,ta.IDENTITY,[]),a(t,ta.METADATA,[]),t))}return l(e,[{key:"registerTransformer",value:function(e,t){var n=t||ta.GENERAL;this.pipelineToTransformers[n].find((function(t){return t.name===e.name}))?O.debug("TransformerRegistry -- Transformer already registered",{transformer:e,pipeline:t}):this.pipelineToTransformers[n].push(e)}},{key:"registerTransformerFn",value:function(e,t,n){var r=function(n){p(i,n);var r=Ua(i);function i(){var t;return u(this,i),a(f(t=r.call(this)),"name",e),t}return l(i,[{key:"transformFnAsync",value:function(e){throw new Error("Transformer ".concat(this.name," -- only synchronous method should be called"))}},{key:"transformFn",value:function(e){return t(e)}}]),i}(Ma);this.registerTransformer(new r,n)}},{key:"registerTransformerFnAsync",value:function(e,n,r){var i=function(r){p(c,r);var i,o=Ua(c);function c(){var t;return u(this,c),a(f(t=o.call(this)),"name",e),a(f(t),"isAsync",!0),t}return l(c,[{key:"transformFnAsync",value:(i=t(s().mark((function e(t){return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n(t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))),function(e){return i.apply(this,arguments)})},{key:"transformFn",value:function(e){throw new Error("Transformer ".concat(this.name," -- only async method should be called"))}}]),c}(Ma);this.registerTransformer(new i,r)}},{key:"removeTransformer",value:function(e,t){var n=t||ta.GENERAL,r=this.pipelineToTransformers[n].filter((function(t){return t.name!==e||(O.debug("TransformerRegistry -- Transformer removed",{transformerName:e,targetPipeline:n}),!1)}));this.pipelineToTransformers[n]=r}},{key:"resetTransformers",value:function(){var e;this.pipelineToTransformers=(a(e={},ta.GENERAL,[]),a(e,ta.ADD_USER_PROPERTIES,[]),a(e,ta.IDENTITY,[]),a(e,ta.METADATA,[]),e)}},{key:"getCustomTransformers",value:function(e){return this.pipelineToTransformers[e]}}],[{key:"getInstance",value:function(){return e.instance||(e.instance=new e),e.instance}}]),e}();function Fa(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}var za=function(e){var t=document.createElement("a");if(t.href=e,""===t.host){var n=t.href;t.href=n}var r=t.pathname;if(M(r))return function(e){return M(e)?e.length>0&&"/"===e[0]?e:"/"+e:e}(r)},Va=function(){var e=document.referrer;if(e)return Ce(e)===window.location.hostname?za(e):void 0},Ja=function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:x,n=(e=j.map((function(e){return"head title[".concat(e,"]")})).join(", "),!!document.querySelector(e)),r=document.title;return n?"****":K(r,t)},qa=function(e){return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Fa(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Fa(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({screen_height:window.innerHeight||0,screen_width:window.innerWidth||0},null==e?void 0:e.source_properties)},Ha=function(e){return e.Click="click",e.Change="change",e.Submit="submit",e.Pageview="pageview",e}({}),Ka=function(e){return e.Selector="s",e.TextInNearestElement="t",e.JavaScript="j",e.Form="f",e.Attribute="a",e}({}),Qa=/([\^$*]=)/,Za=/^\[(\S+)=(.*)\]$/,Ga=/^\[([^=*]*)\]$/,Ya=function(e,t){return 0===e.length?null:0===t.length?"[".concat(e,"=*]"):"[".concat(e,"=").concat(t,"]")},Wa=function(e){try{var t,n,r,i;if(a=e,Ga.test(a))return(t=Ga.exec(e))&&null!==(n=Ya(t[1],"*"))&&void 0!==n?n:e;if(function(e){return Qa.test(e)}(e))return null!==(r=function(e){var t=Qa.exec(e);if(!t)return e;var n=t[0],r=new RegExp("\\[(\\S+)\\"+n+"(.*)\\]").exec(e);if(!r)return e;var i=r[1],a=r[2];switch(n){case"^=":return Ya(i,"".concat(a,"*"));case"$=":return Ya(i,"*".concat(a));case"*=":return Ya(i,"*".concat(a,"*"));default:return e}}(e))&&void 0!==r?r:e;if(function(e){return Za.test(e)}(e))return(t=Za.exec(e))&&null!==(i=Ya(t[1],t[2]))&&void 0!==i?i:e}catch(t){return e}var a;return e},Xa=/^([^#.[].*?)?(#.+?)?((?:\..+?)*)((?:\[.*?\])*)$/,$a=/\s+(?=(?:(?:[^[\]]*[[\]]){2})*[^[\]]*$)/,eo=/,+(?=(?:(?:[^[\]]*[[\]]){2})*[^[\]]*$)/,to=/.*@.*;.*/,no=function(){function e(){u(this,e),a(this,"_parsedHierarchyParts",{}),a(this,"_parsedSelectorParts",{})}return l(e,[{key:"max",value:function(e){return e.length?Math.max.apply(Math,w(e)):0}},{key:"size",value:function(e){return e.constructor===Object?Object.keys(e).length:e.length}},{key:"_isSubsetOfSuperset",value:function(e,t){if(!Array.isArray(e)||!Array.isArray(t))return!1;for(var n=0;n<e.length;n++)if(!this.wildcardMatchesAny(e[n],t))return!1;return!0}},{key:"_cssScore",value:function(e){var t=0;return e.tag&&(t+=1),e.id&&(t+=1),t+=e.classes.length+e.attrs.length}},{key:"parseCss",value:function(e){return e.indexOf("[")<0?e.trim().split(/\s+/g):e.split($a).map((function(e){return e.trim()})).filter(Boolean)}},{key:"cssToObj",value:function(e){var t=A((e.match(Xa)||[]).slice(1),4),n=t[0],r=t[1],i=t[2],a=t[3];return{tag:n,id:r,classes:(i||"").split(".").filter(Boolean).sort(),attrs:(a||"").split("[").filter(Boolean).sort().map((function(e){return"["+e.replace(/"/g,"")})).map(Wa)}}},{key:"wildcardCanShortcut",value:function(e,t){return!e||!t||-1===e.indexOf("*")}},{key:"convertWildcardStringToRegex",value:function(e){return new RegExp("^"+e.replace(/[-[\]{}()+?.,\\^$|#\s]/g,"\\$&").replace(/\*/g,".*")+"$")}},{key:"wildcardMatchesAny",value:function(e,t){if(t&&!Array.isArray(t))return this.wildcardMatch(e,t);for(var n=0;n<t.length;n++)if(this.wildcardMatch(e,t[n]))return!0;return!1}},{key:"wildcardMatch",value:function(e,t){if(this.wildcardCanShortcut(e,t))return e===t;var n=this.convertWildcardStringToRegex(e);return null!==t.match(n)}},{key:"_singleHierarchyMatchesSelector",value:function(e,t){if("*"===(e=e.replace("**","*").trim()))try{return to.exec(t)?1:0}catch(e){return 0}if(!t)return 0;var n=this._parsedSelectorParts[e];if(!n){var r=(n=this._parsedSelectorParts[e]=this.parseCss(e).map(this.cssToObj)).map(this._cssScore);n._score=r.reduce((function(e,t){return e+=t}),0),this.size(this._parsedSelectorParts)>1e4&&(this._parsedSelectorParts={})}var i=this._parsedHierarchyParts[t];i||(i=this._parsedHierarchyParts[t]=t.split("|").map((function(e){return e.split(";").join("").slice(1)})).map(this.cssToObj),this.size(this._parsedHierarchyParts)>1e4&&(this._parsedHierarchyParts={}));for(var a=0,o=i.length,s=n.length,u=0;u<o;u++){var c=i[u];if(a===s)break;var l=n[a],f=!l.tag||this.wildcardMatch(l.tag,c.tag),d=!l.id||this.wildcardMatch(l.id,c.id),h=!l.classes.length||this._isSubsetOfSuperset(l.classes,c.classes),v=!l.attrs.length||this._isSubsetOfSuperset(l.attrs,c.attrs);f&&d&&h&&v&&a++}return a===n.length&&n._score||0}},{key:"splitComboSelector",value:function(e){return e.split(eo)}},{key:"hierarchyMatchesSelector",value:function(e,t){var n=this;return e.indexOf(",")<0?this._singleHierarchyMatchesSelector(e,t):this.max(this.splitComboSelector(e).map((function(e){return n._singleHierarchyMatchesSelector(e,t)})))}}],[{key:"getInstance",value:function(){return e.instance||(e.instance=new e),e.instance}}]),e}(),ro=function(e){var t=e.target;"composed"in e&&"function"==typeof e.composedPath&&(t=e.composedPath()[0]);return t},io=function(e){try{return!(!e||"function"!=typeof e.toString)&&"[object ShadowRoot]"===e.toString()}catch(e){return!1}},ao=function(e){return"[object String]"===Object.prototype.toString.call(e)},oo=function(e){return!so(e)},so=function(e){return 1===e.nodeType&&"http://www.w3.org/2000/svg"===e.namespaceURI},uo=/(.+):nth-of-type\((\d+)\)$/,co=/^\w+(\.[-_\w][-_\w\d]+)*(#[-_\w][-_\w\d]+)?$/,lo=function(e,t){var n=[];e=function(e){if(!e)return null;for(var t=e,n=0;t&&n<200;)oo(t)&&(e=t),t=t.previousElementSibling||t.previousSibling,n+=1;return e}(e);for(var r=0,i=!co.test(t);e&&r<200;)oo(e)&&e.matches&&e.matches(t)&&(i||fo(e)===t)&&n.push(e),e=e.nextElementSibling||e.nextSibling,r+=1;return n},fo=function(e){if(!e||!e.tagName)return null;var t=[e.tagName.toLowerCase()];if(e.classList.length>0)for(var n=Array.from(e.classList),r=0;r<n.length;++r){var i=n[r];t.push("."+i)}return e.type&&"select"!==e.tagName.toLowerCase()&&t.push('[type="'+e.type+'"]'),e.name&&t.push('[name="'+e.name+'"]'),""!==e.id&&"radio"!==e.type&&"checkbox"!==e.type&&t.push("#"+e.id),t.join("")},ho=function(e){return uo.test(e)?e.replace(uo,"$1"):e},vo=function(e){if(!e||!e.tagName)return null;var t=e.tagName.toLowerCase();if("input"===t){var n=e;switch(n.type){case"checkbox":case"radio":return n.checked;default:return n.value}}else if("select"===t){var r=e;return r.options[r.selectedIndex].text}return yo(e)},po=function(e){var t=[],n=function n(r,i){i>=50||(r.querySelectorAll(e).forEach((function(e){return t.push(e)})),r.querySelectorAll("*").forEach((function(e){e.shadowRoot&&n(e.shadowRoot,i+1)})))};return document.querySelectorAll(e).forEach((function(e){return t.push(e)})),document.querySelectorAll("*").forEach((function(e){e.shadowRoot&&n(e.shadowRoot,1)})),t},go=function(e,t){for(var n,r,i=t?t.target:document,a=ho(e),o=function(e){if(uo.test(e)){var t=e.replace(uo,"$2");return parseInt(t,10)}return 1}(e),s=0;s<50;){if(r=[],null!==(n=i instanceof HTMLElement&&i.shadowRoot?i.shadowRoot.querySelectorAll(a):i instanceof Document?po(a):i.querySelectorAll(a))&&n.length>0&&(r=lo(n[0],a)),1===r.length)return r[0];if(r.length>=o)return r[o-1];if(null===(i=io(i.parentNode)?i.parentNode.host:i.parentElement))return null;s+=1}return null},mo=function e(t,n){return t&&"BODY"!==t.tagName&&"HTML"!==t.tagName?n(t)?t:io(t.parentNode)?e(t.parentNode.host,n):null===t.parentElement?null:e(t.parentElement,n):null},yo=function(e){return e.innerText||e.textContent||""},wo=function(e){return e&&e.form||bo(e)},bo=function(e){for(;e&&"tagName"in e&&(void 0===e.tagName||"form"!==e.tagName.toLowerCase());)e=io(e.parentNode)?e.parentNode.host:e.parentNode;return e},_o="heap_redacted",ko=1024,Io="****",So=["heap-ignore","data-cs-encrypt"],Eo=["data-heap-redact-text","data-cs-mask"],To=["class","data-com.agilebits.onepassword.initial-value","data-com.onepassword.iv","data-ember-action","data-initial-value","data-previous-value","data-react-checksum","data-reactid","id","maxlength","onclick","onsubmit","style"];function Oo(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}var Ao=function(e,t){return so(e)?(Po(e)||[]).filter((function(e){return e.name.length<t&&(e.name.includes("data-")||"aria-label"===e.name)})):(Po(e)||[]).filter((function(n){return n.name.length<t&&!("INPUT"===e.tagName&&"value"===n.name)}))},Po=function(e){for(var t=[],n=0;n<e.attributes.length;n++){var r=e.attributes[n],i=r.name,a=r.value;e.value&&a===e.value&&"value"!==i&&(a=_o),t.push({name:i,value:a})}return t},No=function(e){var t=e.getAttribute("data-heap-redact-attributes");return t?t.split(","):[]},Ro=function(e){var t;return((null===(t=window.UXAnalytics)||void 0===t?void 0:t.Sensitive.getSensitiveAttributes(e))||[]).map((function(e){return e.name}))},xo=function(e){var t=w(To);return e.map((function(e){var n=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Oo(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Oo(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},e);return t.push.apply(t,w(e.heapRedactedAttributes)),n.attributes=e.attributes.filter((function(e){return-1===t.indexOf(e.name)})),n}))};function Co(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return Bo(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Bo(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}function Bo(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Do=function(){return document},jo=function(e){if(""!==e.id){var t=Do().querySelector("label#".concat(e.id)),n=null==t?void 0:t.textContent;if(n)return n}return e.value},Mo=function(e){switch(e.tagName.toLowerCase()){case"input":var t=e;switch(t.type){case"date":case"email":return function(e){return e.validity.valid?e.value:null}(t);case"password":return"****";case"checkbox":return function(e){var t="input[type=checkbox][name=".concat(e.name,"]"),n=Do().querySelectorAll(t),r=Array.from(n);if(r.length>1){var i,a=[],o=Co(r);try{for(o.s();!(i=o.n()).done;){var s=i.value;s instanceof HTMLInputElement&&s.checked&&a.push(s.value)}}catch(e){o.e(e)}finally{o.f()}return a.join(",")}return e.checked?"true":"false"}(t);case"radio":return function(e){for(var t=Do().querySelectorAll("input[type=radio][name=".concat(e.name,"]")),n=0;n<t.length;n++){var r=t[n];if(r.checked)return jo(r)}return e.checked?"true":"false"}(t);default:return function(e){return e.value}(t)}case"textarea":return function(e){var t=e.value;return t.length>64?t.slice(0,64):t}(e);case"select":return function(e){var t=e.options[e.selectedIndex];return t.value?new RegExp(/^[^\w]/).test(t.value)&&t.value===t.innerHTML?null:t.value:null}(e);default:return"N/A"}},Uo=new Map,Lo=function(e,t){var n,r=null===(n=He.getInstance().getConfig().snapshots)||void 0===n?void 0:n[e];if(r){var i,a,o=(i=function(e,t){var n=[];for(var i in r)if("pageview"===e)Fo(i,t)&&n.push(r[i]);else{var a=ho(i);no.getInstance().hierarchyMatchesSelector(a,t)>0&&n.push(r[i])}return n},a=function(e,t){return e+"."+t},function(){var e=a?a.apply(void 0,arguments):arguments.length<=0?void 0:arguments[0];if(Uo.has(e))return Uo.get(e);var t=i.apply(void 0,arguments);return Uo.set(e,t),t})(e,t);return O.debug("Snapshots -- ".concat(e," definitions for ").concat(t),{snapshotConfig:r,eventType:e,capturedElement:t,snapshots:o}),o}O.debug("Snapshots -- no config found for ".concat(e," snapshots"))},Fo=function(e,t){var n;if(""!==e){try{n=encodeURIComponent(t)}catch(e){return O.warn("Snapshots - error encoding pageview path",e),!1}var r=new RegExp("^"+e.replace(/\*/g,".*")+"$");return r.test(t)||r.test(n)}return!1},zo=function(e){return M(e)?K(e.trim(),x):e},Vo=function(e,t){if(e){t=t||window.event;var n={f:function(e){var n=go(e,t);if(!n)return"N/A";var r=Mo(n);return zo(r)},t:function(e){var n,r=(n=go(e,t),vo(n));return zo(r)},s:function(e){var t=po(e);if(t){var n=vo(t[0]);return zo(n)}},j:function(e){try{var t=e();return zo(t)}catch(e){return void O.warn("Snapshots -- error running javascript snapshot",{err:e})}},a:function(e){var n,r=go(e.target,t),i=null==r?void 0:r.getAttribute(e.attribute);return i?function(e,t,n,r){if(e&&(null==e?void 0:e.value)===r||(null==t?void 0:t.value)===r)return _o;var i=No(t),a=["value"].concat(w(i),w(To.filter((function(e){return"id"!==e&&"class"!==e}))));return ue()&&a.push.apply(a,w(Ro(t))),a.includes(n)?_o:r.length>x?K(r,x):r}(null===(n=t)||void 0===n?void 0:n.target,r,e.attribute,i):"N/A"}},r=Object.values(Ka).map((function(t){var r=n[t];if(r){var i=e.map((function(e){return e[t]})).map((function(e){var t={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n))try{var i=e[n],a=r(i);void 0!==a&&(t[n]=a)}catch(e){O.warn("Snapshots -- Error extracting ".concat(n),{e:e})}return t})).filter((function(e){return 0!==Object.keys(e).length}));return i}})).flat(),i=r.reduce((function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}),{}),a=i?Q(i):{};return O.trace("Snapshots -- properties",{snapshotProperties:a}),a}};function Jo(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function qo(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Jo(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Jo(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Ho(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=d(e);if(t){var i=d(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return g(this,n)}}var Ko=function(e){p(n,e);var t=Ho(n);function n(){var e;u(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return a(f(e=t.call.apply(t,[this].concat(i))),"name",Xi.METADATA_EVENT_CREATION),e}return l(n,[{key:"getTarget",value:function(e){return ss(e,this.name)}},{key:"_createUserEventMessage",value:function(e){var t,n=e.time,r=e.userId,i=e.sessionId,a=e.pageviewId,o=Is.getInstance(),s=Be(),u=Ue(),c=Le();return{time:n,id:r,user_id:r,identity:o.getIdentity()||"",base_library:c,device:u,env_id:o.getEnvironmentId(),user:{time:n,id:r,identity:o.getIdentity(),initial_session_info:{referrer:s,time:n,id:i,search_keyword:De(s),utm:je(),initial_pageview_info:{time:n,id:a,url:Me(),source_properties:qa(),properties:null===(t=o.getMetadata().pageviewProperties)||void 0===t?void 0:t.properties}}}}}},{key:"_createSessionEventMessage",value:function(e){var t,n=e.time,r=e.sessionId,i=e.userId,a=e.pageviewId,o=Is.getInstance(),s=Be(),u=Ue(),c=Le(),l=null!=i?i:o.getUserId();return{time:n,id:r,env_id:o.getEnvironmentId(),user_id:l,identity:o.getIdentity()||"",base_library:c,device:u,session_info:{time:n,referrer:s,id:r,search_keyword:De(s),utm:je(),initial_pageview_info:{time:n,id:a,title:Ja(),previous_page:Va(),url:Me(),source_properties:qa(),properties:null===(t=o.getMetadata().pageviewProperties)||void 0===t?void 0:t.properties}},session:{}}}},{key:"_createPageviewEventMessage",value:function(e){var t,n=e.time,r=e.pageviewId,i=e.sessionMessage,a=e.userId,o=e.overridePageviewInfo,s=Is.getInstance(),u=null!=a?a:s.getUserId(),c=i?i.session_info:s.getMetadata().sessionProperties,l=Ue(),f=Le(),d=Me(),h=Lo(Ha.Pageview,d.path),v=Vo(h);return qo({time:n,id:r,env_id:s.getEnvironmentId(),user_id:u,identity:s.getIdentity()||"",base_library:f,device:l,session_info:c,pageview_info:qo({time:n,id:r,url:d,title:Ja(),previous_page:Va(),source_properties:qa(o),properties:null===(t=s.getMetadata().pageviewProperties)||void 0===t?void 0:t.properties},o),pageview:{}},Fe(v))}},{key:"transform",value:function(e){if(!e.length||e.length>1)return O.trace("Transformer ".concat(this.name," -- Invalid number of metadata event messages sent, should always expect 1 message"),{messages:e}),[];var t=[],n=e[0],r=n.type,i=n.id,a=n.overrideProps,o=(new Date).getTime();if(r===_.METADATA_USER){O.debug("Transformer ".concat(this.name," -- Creating user + session + pageview message."));var s=i,u=N(),c=N(),l={type:_.METADATA_USER,id:s,data:this._createUserEventMessage({time:o,userId:s,sessionId:u,pageviewId:c})},f=this._createSessionEventMessage({time:o,sessionId:u,userId:s,pageviewId:c});t=[l,{type:_.METADATA_SESSION,id:u,data:f},{type:_.METADATA_PAGEVIEW,id:c,data:this._createPageviewEventMessage({time:o,pageviewId:c,sessionMessage:f,userId:s,overridePageviewInfo:null==a?void 0:a.pageviewInfo})}]}else if(r===_.METADATA_SESSION){O.debug("Transformer ".concat(this.name," -- Creating session + pageview message."));var d=i,h=N(),v=this._createSessionEventMessage({time:o,sessionId:d,pageviewId:h});t=[{type:_.METADATA_SESSION,id:d,data:v},{type:_.METADATA_PAGEVIEW,id:h,data:this._createPageviewEventMessage({time:o,pageviewId:h,sessionMessage:v,overridePageviewInfo:null==a?void 0:a.pageviewInfo})}]}else if(r===_.METADATA_PAGEVIEW){O.debug("Transformer ".concat(this.name," -- Creating pageview message"));var p=i;t=[{type:_.METADATA_PAGEVIEW,id:p,data:this._createPageviewEventMessage({time:o,pageviewId:p,overridePageviewInfo:null==a?void 0:a.pageviewInfo})}]}return Is.getInstance().deleteSetPathIfExpired(),O.trace("Transformer ".concat(this.name," -- creating metadata events"),{before:e,after:t}),t}}],[{key:"getInstance",value:function(){return n.instance||(n.instance=new n),n.instance}}]),n}(Yi);function Qo(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Zo(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Qo(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Qo(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Go(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=d(e);if(t){var i=d(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return g(this,n)}}var Yo=function(e){p(n,e);var t=Go(n);function n(){var e;u(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return a(f(e=t.call.apply(t,[this].concat(i))),"name",$i.IDENTITY_EVENT_CREATION),e}return l(n,[{key:"getTarget",value:function(e){return ss(e,this.name)}},{key:"_constructIdentityMessage",value:function(e){var t=Is.getInstance();return Zo(Zo({},e),{},{data:{time:e.info.time,identity:e.info.identity,env_id:t.getEnvironmentId(),user_id:e.info.user_id||t.getUserId(),library:Le()}})}},{key:"transform",value:function(e){if(!e.length||e.length>1)return O.trace("Transformer ".concat(this.name," -- Invalid number of identity event messages sent, should always expect 1 message"),{messages:e}),[];var t=e[0],n=this._constructIdentityMessage(t);return O.trace("Transformer ".concat(this.name," -- creating identity event message"),{before:t,after:n}),[n]}}],[{key:"getInstance",value:function(){return n.instance||(n.instance=new n),n.instance}}]),n}(Yi);function Wo(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=d(e);if(t){var i=d(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return g(this,n)}}var Xo=function(e){p(n,e);var t=Wo(n);function n(){var e;u(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return a(f(e=t.call.apply(t,[this].concat(i))),"name",Wi.ERROR),e}return l(n,[{key:"getTarget",value:function(e){return aa.getInstance()}},{key:"relay",value:function(e,t){O.error("Transformer ".concat(this.name," --  Error transformer reached."),{messages:e,pipeline:t})}},{key:"transform",value:function(e){return[]}}],[{key:"getInstance",value:function(){return n.instance||(n.instance=new n),n.instance}}]),n}(Yi),$o=function(e){try{var t="";return window._lr_surl_cb&&window._lr_surl_cb((function(e){return t=e})),t?"logrocket:".concat(function(e,t){var n=za(e);if(!n)throw new Error("No path present on Logrocket session URL");var r=n.split("/"),i=r[1],a=r[2],o=r[4],s=r[5];if(!(i&&a&&o&&s))throw new Error("Invalid path on Logrocket session URL");return encodeURIComponent("".concat(i,"/").concat(a,"/").concat(o,"/").concat(s,"/").concat(t))}(t,e)):void 0}catch(e){return void O.warn("SessionReplay -- failed to parse logrocket string - ".concat(e))}},es=function(){try{var e,t,n=null===(e=window._uxa)||void 0===e||null===(t=e.push)||void 0===t?void 0:t.call(e,["getSessionData"]);if(!n)return;var r=n.projectId,i=n.userId,a=n.sessionNumber,o=n.pageNumber,s=n.relativeTimestamp;if(!(r&&i&&a&&o))return;return{cs_pid:r.toString(),cs_pvid:o.toString(),cs_sn:a.toString(),cs_ts:null==s?void 0:s.toString(),cs_uu:i.toString()}}catch(e){return}};function ts(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ns(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ts(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ts(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function rs(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=d(e);if(t){var i=d(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return g(this,n)}}var is=function(e){p(n,e);var t=rs(n);function n(){var e;u(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return a(f(e=t.call.apply(t,[this].concat(i))),"name",Wi.SESSION_REPLAY_ENRICHMENT),e}return l(n,[{key:"getTarget",value:function(e){return ss(e,this.name)}},{key:"_getSessionReplayString",value:function(e){return[function(e){try{if(window.auryc){var t=window.auryc.getSessionMetadata(),n=t.siteId,r=t.sessionId,i=t.sampled,a=t.isOver;if(i&&!a){var o=encodeURIComponent("".concat(n,"/").concat(r,"/").concat(e));return"auryc:".concat(o)}}return}catch(e){return}}(e.data.time),$o(e.data.time),function(){try{var e="",t=es();if(t){var n=t.cs_pid,r=t.cs_pvid,i=t.cs_sn,a=t.cs_ts,o=t.cs_uu,s=encodeURIComponent("".concat(n,"/").concat(o,"/").concat(i,"/").concat(r,"/").concat(a));e="cs:".concat(s)}return e}catch(e){return""}}()].filter((function(e){return e})).join(";")||void 0}},{key:"_enrichMessageWithSessionReplayContext",value:function(e){var t=this._getSessionReplayString(e),n=es()||{};return t?ns(ns({},e),{},{data:ns(ns({},e.data),{},{session_replay:t,cs_properties:n})}):e}},{key:"transform",value:function(e){var t=this,n=e.map((function(e){return t._enrichMessageWithSessionReplayContext(e)}));return O.trace("Transformer ".concat(this.name," - added session replay context to event messages"),{before:e,after:n}),n}}],[{key:"getInstance",value:function(){return n.instance||(n.instance=new n),n.instance}}]),n}(Yi);function as(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=d(e);if(t){var i=d(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return g(this,n)}}var os=function(e){p(o,e);var r,i=as(o);function o(){var e;u(this,o);for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return a(f(e=i.call.apply(i,[this].concat(n))),"name",Xi.BLOCK_UNTIL_CS_METADATA_IS_AVAILABLE),a(f(e),"isCsMetadataAvailable",!1),a(f(e),"isAsync",!0),a(f(e),"csHasBeenInitialized",!1),a(f(e),"csHasBeenStopped",void 0),e}return l(o,[{key:"getTarget",value:function(e){return ss(e,this.name)}},{key:"waitForAfterPageviewWithTimeout",value:function(){var e=this;return new Promise((function(t,r){var i,a,o=!1,s=n.g.setTimeout((function(){r(new Error("cant find cs metadata after 2 seconds, proceeding"))}),2e3),u=Date.now();null===(i=window._uxa)||void 0===i||null===(a=i.push)||void 0===a||a.call(i,["afterPageView",function(r){if(!o&&(n.g.clearTimeout(s),r)){o=!0;var i=Date.now()-u;O.trace("Transformer ".concat(e.name," -- cs metadata is available after ").concat(i," ms, proceeding"),{data:r}),t(r)}}])}))}},{key:"setCsHasBeenInitialized",value:function(e){this.csHasBeenInitialized=e}},{key:"getCsHasBeenInitialized",value:function(){return this.csHasBeenInitialized}},{key:"setIsCsProjectStopped",value:function(e){this.csHasBeenStopped=e}},{key:"getIsCsProjectStopped",value:function(){return this.csHasBeenStopped}},{key:"transformAsync",value:(r=t(s().mark((function e(t){var n,r,i,a;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=void 0,(o=He.getInstance().getCsHeapTagStatus())&&se.includes(o)){e.next=3;break}return O.trace("Transformer ".concat(this.name," -- no sideloading with cs, proceeding")),e.abrupt("return",t);case 3:if(!this.getCsHasBeenInitialized()){e.next=6;break}return O.trace("Transformer ".concat(this.name," -- cs has already been initialized, proceeding")),e.abrupt("return",t);case 6:if(null===(n=this.getIsCsProjectStopped())||void 0===n){e.next=10;break}e.t0=n,e.next=13;break;case 10:return e.next=12,fe();case 12:e.t0=e.sent;case 13:if(r=e.t0,this.setIsCsProjectStopped(r),!this.getIsCsProjectStopped()){e.next=18;break}return O.trace("Transformer ".concat(this.name," -- cs project has been stopped, proceeding")),e.abrupt("return",t);case 18:return O.trace("Transformer ".concat(this.name," -- blocking queue until cs metadata is available")),va(t),e.prev=20,null===(i=window._uxa)||void 0===i||null===(a=i.push)||void 0===a||a.call(i,["startDataCollection"]),e.next=24,this.waitForAfterPageviewWithTimeout();case 24:e.next=29;break;case 26:e.prev=26,e.t1=e.catch(20),O.warn("Transformer ".concat(this.name," -- error on afterPageView callback"),{e:e.t1});case 29:return e.prev=29,this.setCsHasBeenInitialized(!0),e.finish(29);case 32:return e.abrupt("return",t);case 33:case"end":return e.stop()}var o}),e,this,[[20,26,29,32]])}))),function(e){return r.apply(this,arguments)})},{key:"transform",value:function(e){return e}}],[{key:"getInstance",value:function(){return o.instance||(o.instance=new o),o.instance}}]),o}(Yi),ss=function(e,t){var n=function(e){var t=[ls.getInstance(),ba.getInstance(),is.getInstance(),Na.getInstance(),Da.getInstance()],n=[aa.getInstance()],r=[Ko.getInstance(),os.getInstance(),is.getInstance()],i=[ga.getInstance()],a=[Yo.getInstance()],o=[ka.getInstance()],s=[ls.getInstance(),Na.getInstance(),Ta.getInstance()],u=[aa.getInstance()],c=[],l=[],f=La.getInstance().getCustomTransformers(e);return e===ta.GENERAL?(c=t,l=n):e===ta.METADATA?(c=r,l=i):e===ta.IDENTITY?(c=a,l=o):e===ta.ADD_USER_PROPERTIES&&(c=s,l=u),[].concat(w(c),w(f),w(l))}(e),r=n.findIndex((function(e){return e.name===t}));return-1===r?(O.trace("Source transformer not found.",{sourceTransformerName:t,pipeline:e}),Xo.getInstance()):r===n.length-1?aa.getInstance():n[r+1]};function us(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=d(e);if(t){var i=d(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return g(this,n)}}var cs,ls=function(e){p(n,e);var t=us(n);function n(){var e;u(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return a(f(e=t.call.apply(t,[this].concat(i))),"name",Wi.ENTRY),e}return l(n,[{key:"getTarget",value:function(e){return ss(e,this.name)}},{key:"transform",value:function(e){return e}}],[{key:"getInstance",value:function(){return n.instance||(n.instance=new n),n.instance}}]),n}(Yi),fs=function(){if(!He.getInstance().getShouldStopTracking()){O.trace("Begin flushing all messages for processing"),ps.getInstance().flushTemporaryMetadataQueue();var e=kl();e&&e.length?(O.debug("Flushing the following messages into general event pipeline",e),ls.getInstance().transformAndRelay(e,ta.GENERAL)):O.debug("No messages queued in the EPQ - terminating")}},ds=function(e,t,n){if(!He.getInstance().getShouldStopTracking()){var r=null!=t?t:N();Ko.getInstance().transformAndRelay([{overrideProps:n,type:e,id:r}],ta.METADATA)}},hs=function(e,t){He.getInstance().getShouldStopTracking()||Yo.getInstance().transformAndRelay([{type:k.CORE_IDENTIFY_v3,id:N(),info:{identity:e,user_id:t,time:(new Date).getTime()}}],ta.IDENTITY)},vs=function(){He.getInstance().getShouldStopTracking()||(cs=n.g.setInterval((function(){var e=_l();e.length&&(O.debug("Sending events from the event processing queue to transformers",{messages:e}),ls.getInstance().transformAndRelay(e,ta.GENERAL))}),2e3))},ps=function(){function e(){u(this,e),a(this,"queue",[])}return l(e,[{key:"flushTemporaryMetadataQueue",value:function(){this.queue.length&&(O.debug("MetadataMessageQueue -- flushing the temporary metadata queue",{queue:this.queue}),this.queue.forEach((function(e){var t=e.type,n=e.id,r=e.overrideProps;ds(t,n,r)})),this.queue=[])}},{key:"queueMetadataEvent",value:function(e,t,r){var i=this;Zi.getInstance().shouldBlockEventProcessing()?(O.trace("MetadataMessageQueue -- blocking metadata event until adapters are resolved",{type:e}),this.queue.push({type:e,id:t,overrideProps:r}),n.g.setTimeout((function(){O.trace("MetadataMessageQueue -- 5 seconds has passed, flushing regardless of adapter state"),i.flushTemporaryMetadataQueue()}),Qi)):ds(e,t,r)}}],[{key:"getInstance",value:function(){return e.instance||(e.instance=new e),e.instance}}]),e}(),gs=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];try{var n=function(){var n,r;t&&(null===(r=window.auryc)||void 0===r||r.clearUserCookie(!1));null===(n=window.auryc)||void 0===n||n.addUserProperties({heap_user_id:e})},r=function(){window.clearInterval(a)},i=function(){return!!(window.auryc&&window.auryc.addUserProperties&&window.auryc.clearUserCookie)};if(i())return void n();var a=window.setInterval((function(){i()&&(r(),n())}),500);window.setTimeout(r,5e3)}catch(e){return}},ms=function(e){gs(e)},ys=function(e){var t=ie();(t||!t&&e)&&(O.debug("Contentsquare -- creating new cs user"),function(){try{var e=function(){var e;null===(e=window._uxa)||void 0===e||e.push(["session:start:newVisitor"])},t=function(){window.clearInterval(r)},n=function(){var e,t,n=null===(e=window._uxa)||void 0===e||null===(t=e.push)||void 0===t?void 0:t.call(e,["getSessionData"]);return n&&n.projectId&&n.userId};if(n())return void e();var r=window.setInterval((function(){n()&&(t(),e())}),250);window.setTimeout(t,5e3)}catch(e){return}}())};function ws(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function bs(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ws(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ws(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var _s=["pageviewId","pageviewProperties"],ks=["userId","sessionId","identity","lastEventTime","sessionProperties","setPath"],Is=function(){function e(t,n){u(this,e),a(this,"envId",""),a(this,"_sessionExpirationTime",D),a(this,"_ephemeralStorage",Ti.getInstance()),a(this,"_metadataMessageQueue",ps.getInstance()),a(this,"hasUserBeenQueued",!1),a(this,"hasSessionBeenQueued",!1),a(this,"hasPageviewBeenQueued",!1),a(this,"hasCheckedCrossDomainContext",!1),a(this,"hasMetadataBeenSentToNetwork",!1),a(this,"truncateLargeCookie",(function(e){var t,n,r,i,a,o,s,u,c,l,f,d,h,v,p,g;return bs(bs({},e),{},{sessionProperties:bs(bs({},e.sessionProperties),{},{referrer:K(null!==(t=null===(n=e.sessionProperties)||void 0===n?void 0:n.referrer)&&void 0!==t?t:"",C),search_keyword:K(null!==(r=null===(i=e.sessionProperties)||void 0===i?void 0:i.search_keyword)&&void 0!==r?r:"",C),utm:Q(null!==(a=null===(o=e.sessionProperties)||void 0===o?void 0:o.utm)&&void 0!==a?a:{}),initial_pageview_info:bs(bs({},null===(s=e.sessionProperties)||void 0===s?void 0:s.initial_pageview_info),{},{title:K(null!==(u=null===(c=e.sessionProperties)||void 0===c||null===(l=c.initial_pageview_info)||void 0===l?void 0:l.title)&&void 0!==u?u:"",C),url:Q(null!==(f=null===(d=e.sessionProperties)||void 0===d||null===(h=d.initial_pageview_info)||void 0===h?void 0:h.url)&&void 0!==f?f:{}),previous_page:K(null!==(v=null===(p=e.sessionProperties)||void 0===p||null===(g=p.initial_pageview_info)||void 0===g?void 0:g.previous_page)&&void 0!==v?v:"",C)})})})})),a(this,"reduceToIdMetadataVals",(function(e){var t,n,r,i,a,o;return bs(bs({},e),{},{sessionProperties:{id:null===(t=e.sessionProperties)||void 0===t?void 0:t.id,time:null===(n=e.sessionProperties)||void 0===n?void 0:n.time,initial_pageview_info:{id:null===(r=e.sessionProperties)||void 0===r||null===(i=r.initial_pageview_info)||void 0===i?void 0:i.id,time:null===(a=e.sessionProperties)||void 0===a||null===(o=a.initial_pageview_info)||void 0===o?void 0:o.time}}})})),t&&(this.envId=t),n&&(this.storageType=n),this._persistentStorage=this._getStorageType()}return l(e,[{key:"_canAccessStorage",value:function(){var e="hld"+N(),t="_hp2_".concat(e);return this._persistentStorage.setItem(t,"test"),!!this._persistentStorage.getItem(t)&&(this._persistentStorage.removeItem(t),!0)}},{key:"_isStorageBlocked",value:function(){return He.getInstance().getShouldStopTracking()}},{key:"_getStorageType",value:function(){var e=He.getInstance().getMetadataStorageType(),t=this.storageType||e;return(null==t?void 0:t.toLowerCase())===I.LOCAL_STORAGE?new ve:new Ei}},{key:"_getStorageKey",value:function(){return"".concat("_hp5_meta",".").concat(this.getEnvironmentId())}},{key:"_extractPersistentMetadata",value:function(e){var t={};return Object.entries(e).forEach((function(e){var n=A(e,2),r=n[0],i=n[1];ks.includes(r)&&i&&(t[r]=i)})),t}},{key:"_extractEphemeralMetadata",value:function(e){var t={};return Object.entries(e).forEach((function(e){var n=A(e,2),r=n[0],i=n[1];_s.includes(r)&&i&&(t[r]=i)})),t}},{key:"hasQueuedMetadataEvents",value:function(){return this.hasPageviewBeenQueued&&this.hasSessionBeenQueued&&this.hasUserBeenQueued}},{key:"setMetadata",value:function(e){if(!this._isStorageBlocked()){var t,n=this.getMetadata(),r=this._extractEphemeralMetadata(n),i=this._extractPersistentMetadata(n),a=this._extractEphemeralMetadata(e),o=this._extractPersistentMetadata(e),s=bs(bs({},i),o),u=bs(bs({},r),a);if(O.trace("MetadataStore -- attempting to update metadata values without alterations"),t=this._persistentStorage.setItem(this._getStorageKey(),s,{expires:B})){O.debug("MetadataStore -- persistent values larger than max cookie size, attempting truncation");var c=this.truncateLargeCookie(s);if(t=this._persistentStorage.setItem(this._getStorageKey(),c,{expires:B})){O.debug("MetadataStore -- truncated values larger than max cookie size, setting ids");var l=this.reduceToIdMetadataVals(s);t=this._persistentStorage.setItem(this._getStorageKey(),l,{expires:B})}}t?O.error("MetadataStore -- Unable to update persistent values after truncation and reducing to ids"):O.trace("Updated metadata values in persistent storage",{before:i,after:s}),this._ephemeralStorage.setItem(this._getStorageKey(),u,{expires:B}),O.trace("Updated metadata values in ephemeral storage",{before:r,after:u});var f=new Se;f.shouldWriteToV4()&&f.updateMetadata(s)}}},{key:"getMetadata",value:function(){var e=this._getStorageKey(),t=this._persistentStorage.getItem(e),n=this._ephemeralStorage.getItem(e);return bs(bs({},t),n)}},{key:"deleteMetadata",value:function(){var e=this._getStorageKey();this._persistentStorage.removeItem(e)}},{key:"clearPageviewMetadata",value:function(){var e=this._getStorageKey();this._ephemeralStorage.removeItem(e),this.setHasPageviewBeenQueued(!1)}},{key:"clearMetadata",value:function(){var e=this._getStorageKey();this._persistentStorage.removeItem(e),this._ephemeralStorage.removeItem(e),this.setHasSessionBeenQueued(!1),this.setHasUserBeenQueued(!1),O.debug("Cleared metadata values in persistent storage")}},{key:"updateLastEventTime",value:function(e){if(e){O.trace("Updating lastEventTime to ".concat(e)),this.setMetadata({lastEventTime:e});var t,n,r=new Se;r.shouldWriteToV4()&&r.updateSessionPropsExpiration(e),ie()&&(O.debug("Contentsquare -- extending cs session"),null===(t=window._uxa)||void 0===t||null===(n=t.push)||void 0===n||n.call(t,["extendSessionV2"]))}else O.warn("Invalid lastEventTime passed to metadata store")}},{key:"getSessionId",value:function(){var e;return null===(e=this.getMetadata())||void 0===e?void 0:e.sessionId}},{key:"getUserId",value:function(){var e;return null===(e=this.getMetadata())||void 0===e?void 0:e.userId}},{key:"getIdentity",value:function(){var e;return null===(e=this.getMetadata())||void 0===e?void 0:e.identity}},{key:"setIdentity",value:function(e){this.setMetadata({identity:e})}},{key:"setEnvironmentId",value:function(e){this.envId="".concat(e)}},{key:"getEnvironmentId",value:function(){if(!this.envId)throw O.error("Environment ID is missing"),new Error("heap environment id is missing");return this.envId}},{key:"getHasUserBeenQueued",value:function(){return this.hasUserBeenQueued}},{key:"getHasSessionBeenQueued",value:function(){return this.hasSessionBeenQueued}},{key:"setHasUserBeenQueued",value:function(e){this.hasUserBeenQueued=e}},{key:"setHasSessionBeenQueued",value:function(e){this.hasSessionBeenQueued=e}},{key:"setHasPageviewBeenQueued",value:function(e){this.hasPageviewBeenQueued=e}},{key:"setMetadataStateFromCrossDomainContextIfPresent",value:function(){if(!this._isStorageBlocked()&&!this.hasCheckedCrossDomainContext){this.hasCheckedCrossDomainContext=!0;var e=function(){try{var e=new URL(window.location.href).searchParams.get("_hp5_cdc");if(!e)return{};var t=A(e.split(";"),5);return{envId:t[0],userId:t[1],sessionId:t[2],sessionStartTime:t[3],identity:t[4]}}catch(e){return O.error("getCrossDomainMetadata -- failed to parse metadata from URL, defaulting to normal logic"),{}}}(),t=e.envId,n=e.userId,r=e.sessionId,i=e.identity,a=e.sessionStartTime;if(this.getEnvironmentId()===t&&n&&r)return O.debug("MetadataStore -- cross domain userid found, overriding current user"),this.setMetadata({userId:n,sessionId:r,identity:i,sessionProperties:{id:r,time:parseInt(a,10)},lastEventTime:(new Date).getTime()}),this.hasUserBeenQueued=!0,this.hasSessionBeenQueued=!0,void ms(n)}}},{key:"setMetadataStateFromWebviewIfPresent",value:function(){if(!this._isStorageBlocked()&&sa()){var e,t=null!==(e=ua())&&void 0!==e?e:{},n=t.userId,r=t.sessionId,i=t.identity;if(n&&r)return O.debug("MetadataStore -- webview userid found, overriding current user"),this.setMetadata({userId:n,sessionId:r,identity:i,sessionProperties:{id:r,time:(new Date).getTime()},lastEventTime:(new Date).getTime()}),this.hasUserBeenQueued=!0,this.hasSessionBeenQueued=!0,void ms(n)}}},{key:"getPageviewProperties",value:function(){var e;return null===(e=this.getMetadata())||void 0===e?void 0:e.pageviewProperties}},{key:"getCustomPageviewProperties",value:function(){var e;return null===(e=this.getMetadata())||void 0===e?void 0:e.pageviewProperties.properties}},{key:"addCustomPageviewProperties",value:function(e){var t=this.getPageviewProperties(),n=bs(bs({},null==t?void 0:t.properties),e);this.setMetadata({pageviewProperties:bs(bs({},t),{},{properties:n})})}},{key:"removeCustomPageviewProperty",value:function(e){var t=bs({},this.getCustomPageviewProperties());delete t[e],O.debug("Removed custom pageview property ".concat(e," from storage"),{before:this.getCustomPageviewProperties(),after:t});var n=this.getPageviewProperties();this.setMetadata({pageviewProperties:bs(bs({},n),{},{properties:t})})}},{key:"clearCustomPageviewProperties",value:function(){var e=this.getPageviewProperties();O.debug("MetadataStore -- clearing custom pageview properties"),this.setMetadata({pageviewProperties:bs(bs({},e),{},{properties:{}})})}},{key:"clearEventPropertiesIfNeeded",value:function(){var e=He.getInstance().getClearEventPropertiesOnNewUser(),t=Oe.getInstance();e&&(O.debug("MetadataStore -- Clearing event properties"),t.clearProperties())}},{key:"createNewUserIfNeeded",value:function(e){var t=this.getMetadata().userId;if(!t||null!=e&&e.newUserId&&t!==e.newUserId||!J(t)){var n;this.clearEventPropertiesIfNeeded(),this.hasUserBeenQueued=!1,this.hasSessionBeenQueued=!1,this.hasPageviewBeenQueued=!1;var r=null!==(n=null==e?void 0:e.newUserId)&&void 0!==n?n:N();null!=e&&e.identity&&hs(e.identity,r),this._metadataMessageQueue.queueMetadataEvent(_.METADATA_USER,r),Sl(),function(e){gs(e,!0)}(r),ys(null==e?void 0:e.heapDrives)}else this.hasUserBeenQueued=!0,ms(t)}},{key:"createNewSessionIfNeeded",value:function(e){if(this.hasUserBeenQueued){var t,n,r,i,a=this.getMetadata(),o=a.sessionId,s=a.sessionProperties,u=!1;this.hasSessionExpired()?(O.debug("MetadataStore -- session has expired, creating new session"),u=!0):o?J(o)?o!==(null==s?void 0:s.id)?(O.debug("MetadataStore -- session id and session properties don't match, creating new session",{sessionId:o,sessionProperties:s}),u=!0):s.time||(O.debug("MetadataStore -- malformed session, creating new session",{sessionId:o,sessionProperties:s}),u=!0):(O.debug("MetadataStore -- session id is not a number, creating new session"),u=!0):(O.debug("MetadataStore -- missing session id, creating new session"),u=!0),u?(this.hasSessionBeenQueued=!1,this._metadataMessageQueue.queueMetadataEvent(_.METADATA_SESSION,N()),Sl(),t=null==e?void 0:e.heapDrives,((i=ie())||!i&&t)&&(O.debug("Contentsquare -- starting cs session"),null===(n=window._uxa)||void 0===n||null===(r=n.push)||void 0===r||r.call(n,["clearSession"]))):this.hasSessionBeenQueued=!0}}},{key:"createNewPageviewIfNeeded",value:function(e){if(this.hasUserBeenQueued&&this.hasSessionBeenQueued){var t=this.getMetadata().pageviewId;t&&J(t)?this.hasPageviewBeenQueued=!0:(this.hasPageviewBeenQueued=!1,this._metadataMessageQueue.queueMetadataEvent(_.METADATA_PAGEVIEW,N(),e))}}},{key:"hasSessionExpired",value:function(){if(sa())return!1;var e=this.getMetadata().lastEventTime;return!e||e+this._sessionExpirationTime<(new Date).getTime()}},{key:"deleteSetPathIfExpired",value:function(){var e;(null===(e=this.getMetadata().setPath)||void 0===e?void 0:e.lifespan)===ce.OnNextPageviewOnly&&this.setMetadata({setPath:{path:void 0,query:void 0,hash:void 0,lifespan:void 0}})}},{key:"setHasMetadataBeenSentToNetwork",value:function(e){this.hasMetadataBeenSentToNetwork=e}},{key:"getHasMetadataBeenSentToNetwork",value:function(){return this.hasMetadataBeenSentToNetwork}}],[{key:"getInstance",value:function(){return e.instance||(e.instance=new e),e.instance}}]),e}(),Ss=function(e){return e.EVENT_PROCESSING_QUEUE="_hp5_epq",e}({}),Es=function(){function e(){u(this,e),a(this,"_replacerFunc",(function(){var e=new WeakSet;return function(t,n){if("object"===r(n)&&null!==n){if(e.has(n))return;e.add(n)}return n}}))}return l(e,[{key:"_getQueueIdentifier",value:function(){return"".concat(this.queueName,".").concat(Is.getInstance().getEnvironmentId())}},{key:"_getQueuedMessages",value:function(){var e,t;return JSON.parse(null!==(e=null===(t=this.storage)||void 0===t?void 0:t.getItem(this._getQueueIdentifier()))&&void 0!==e?e:"[]")}},{key:"_getMessageIds",value:function(e){return e.map((function(e){return e.id}))}},{key:"_syncPersistentStorage",value:function(e){this.storage&&this.storage.setItem(this._getQueueIdentifier(),JSON.stringify(e,this._replacerFunc()))}},{key:"enqueueMessages",value:function(e){var t=this._getQueuedMessages(),n=this._getMessageIds(t),r=e.filter((function(e){var t=e.id;return!n.includes(t)}));t=[].concat(w(t),w(r)),this._syncPersistentStorage(t)}},{key:"dequeueMessages",value:function(e){var t=this._getQueuedMessages(),n=this._getMessageIds(e);this.bufferedIds=this.bufferedIds.filter((function(e){return!n.includes(e)})),t=t.filter((function(e){var t=e.id;return!n.includes(t)})),this._syncPersistentStorage(t)}},{key:"clearStorage",value:function(){var e;null===(e=this.storage)||void 0===e||e.removeItem(this._getQueueIdentifier())}},{key:"clearBuffer",value:function(){this.bufferedIds=[]}},{key:"getMessagesToProcess",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:20,n=this._getQueuedMessages().filter((function(t){var n=t.id;return!e.bufferedIds.includes(n)})).slice(0,t);return this.bufferedIds=[].concat(w(this.bufferedIds),w(this._getMessageIds(n))),n.length&&O.trace("".concat(this.queueName," - getting messages for processing"),n),n}}]),e}();function Ts(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=d(e);if(t){var i=d(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return g(this,n)}}var Os=function(e){p(n,e);var t=Ts(n);function n(){var e;u(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return a(f(e=t.call.apply(t,[this].concat(i))),"queueName",Ss.EVENT_PROCESSING_QUEUE),a(f(e),"bufferedIds",[]),a(f(e),"storage",Ti.getInstance()),e}return l(n,[{key:"_isQueueBlocked",value:function(){var e=Is.getInstance(),t=Zi.getInstance();try{e.getEnvironmentId()}catch(e){return!0}return He.getInstance().getShouldStopTracking()?(O.debug("EventProcessingQueue - blocked, shouldStopTracking is true"),!0):e.getHasMetadataBeenSentToNetwork()?!!t.shouldBlockEventProcessing()&&(O.debug("EventProcessingQueue - blocked, waiting for adapter initialization to complete"),!0):(O.debug("EventProcessingQueue - blocked, waiting for metadata events to be queued"),!0)}},{key:"getMessagesToProcess",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:20;return this._isQueueBlocked()?(O.debug("".concat(this.queueName," - blocked, waiting for unblock before processing")),[]):h(d(n.prototype),"getMessagesToProcess",this).call(this,e)}},{key:"getAndClearAllMessages",value:function(){var e=h(d(n.prototype),"getMessagesToProcess",this).call(this,Number.MAX_SAFE_INTEGER);return this.clearStorage(),this.clearBuffer(),e}}],[{key:"getInstance",value:function(){return n.instance||(n.instance=new n),n.instance}}]),n}(Es),As=function(){function e(){u(this,e)}return l(e,[{key:"equals",value:function(e){return this.getType().runtime.util.equals(this.getType(),this,e)}},{key:"clone",value:function(){return this.getType().runtime.util.clone(this)}},{key:"fromBinary",value:function(e,t){var n=this.getType().runtime.bin,r=n.makeReadOptions(t);return n.readMessage(this,r.readerFactory(e),e.byteLength,r),this}},{key:"fromJson",value:function(e,t){var n=this.getType(),r=n.runtime.json,i=r.makeReadOptions(t);return r.readMessage(n,e,i,this),this}},{key:"fromJsonString",value:function(e,t){var n;try{n=JSON.parse(e)}catch(e){throw new Error("cannot decode ".concat(this.getType().typeName," from JSON: ").concat(e instanceof Error?e.message:String(e)))}return this.fromJson(n,t)}},{key:"toBinary",value:function(e){var t=this.getType().runtime.bin,n=t.makeWriteOptions(e),r=n.writerFactory();return t.writeMessage(this,r,n),r.finish()}},{key:"toJson",value:function(e){var t=this.getType().runtime.json,n=t.makeWriteOptions(e);return t.writeMessage(this,n)}},{key:"toJsonString",value:function(e){var t,n=this.toJson(e);return JSON.stringify(n,null,null!==(t=null==e?void 0:e.prettySpaces)&&void 0!==t?t:0)}},{key:"toJSON",value:function(){return this.toJson({emitDefaultValues:!0})}},{key:"getType",value:function(){return Object.getPrototypeOf(this).constructor}}]),e}();function Ps(e,t){if(!e)throw new Error(t)}function Ns(e){if("number"!=typeof e)throw new Error("invalid int 32: "+r(e));if(!Number.isInteger(e)||e>2147483647||e<-2147483648)throw new Error("invalid int 32: "+e)}function Rs(e){if("number"!=typeof e)throw new Error("invalid uint 32: "+r(e));if(!Number.isInteger(e)||e>4294967295||e<0)throw new Error("invalid uint 32: "+e)}function xs(e){if("number"!=typeof e)throw new Error("invalid float 32: "+r(e));if(Number.isFinite(e)&&(e>34028234663852886e22||e<-34028234663852886e22))throw new Error("invalid float 32: "+e)}function Cs(){for(var e=0,t=0,n=0;n<28;n+=7){var r=this.buf[this.pos++];if(e|=(127&r)<<n,!(128&r))return this.assertBounds(),[e,t]}var i=this.buf[this.pos++];if(e|=(15&i)<<28,t=(112&i)>>4,!(128&i))return this.assertBounds(),[e,t];for(var a=3;a<=31;a+=7){var o=this.buf[this.pos++];if(t|=(127&o)<<a,!(128&o))return this.assertBounds(),[e,t]}throw new Error("invalid varint")}function Bs(e,t,n){for(var r=0;r<28;r+=7){var i=e>>>r,a=!(i>>>7==0&&0==t),o=255&(a?128|i:i);if(n.push(o),!a)return}var s=e>>>28&15|(7&t)<<4,u=!!(t>>3);if(n.push(255&(u?128|s:s)),u){for(var c=3;c<31;c+=7){var l=t>>>c,f=!(l>>>7==0),d=255&(f?128|l:l);if(n.push(d),!f)return}n.push(t>>>31&1)}}var Ds=4294967296;function js(e){var t="-"===e[0];t&&(e=e.slice(1));var n=1e6,r=0,i=0;function a(t,a){var o=Number(e.slice(t,a));i*=n,(r=r*n+o)>=Ds&&(i+=r/Ds|0,r%=Ds)}return a(-24,-18),a(-18,-12),a(-12,-6),a(-6),t?Ls(r,i):Us(r,i)}function Ms(e,t){var n=function(e,t){return{lo:e>>>0,hi:t>>>0}}(e,t);if(e=n.lo,(t=n.hi)<=2097151)return String(Ds*t+e);var r=16777215&(e>>>24|t<<8),i=t>>16&65535,a=(16777215&e)+6777216*r+6710656*i,o=r+8147497*i,s=2*i,u=1e7;return a>=u&&(o+=Math.floor(a/u),a%=u),o>=u&&(s+=Math.floor(o/u),o%=u),s.toString()+Fs(o)+Fs(a)}function Us(e,t){return{lo:0|e,hi:0|t}}function Ls(e,t){return t=~t,e?e=1+~e:t+=1,Us(e,t)}var Fs=function(e){var t=String(e);return"0000000".slice(t.length)+t};function zs(e,t){if(e>=0){for(;e>127;)t.push(127&e|128),e>>>=7;t.push(e)}else{for(var n=0;n<9;n++)t.push(127&e|128),e>>=7;t.push(1)}}function Vs(){var e=this.buf[this.pos++],t=127&e;if(!(128&e))return this.assertBounds(),t;if(t|=(127&(e=this.buf[this.pos++]))<<7,!(128&e))return this.assertBounds(),t;if(t|=(127&(e=this.buf[this.pos++]))<<14,!(128&e))return this.assertBounds(),t;if(t|=(127&(e=this.buf[this.pos++]))<<21,!(128&e))return this.assertBounds(),t;t|=(15&(e=this.buf[this.pos++]))<<28;for(var n=5;128&e&&n<10;n++)e=this.buf[this.pos++];if(128&e)throw new Error("invalid varint");return this.assertBounds(),t>>>0}var Js=function(){var e=new DataView(new ArrayBuffer(8));if(void 0!==globalThis.BigInt&&"function"==typeof e.getBigInt64&&"function"==typeof e.getBigUint64&&"function"==typeof e.setBigInt64&&"function"==typeof e.setBigUint64&&("object"!=("undefined"==typeof process?"undefined":r(process))||"object"!=r(process.env)||"1"!==process.env.BUF_BIGINT_DISABLE)){var t=BigInt("-9223372036854775808"),n=BigInt("9223372036854775807"),i=BigInt("0"),a=BigInt("18446744073709551615");return{zero:BigInt(0),supported:!0,parse:function(e){var r="bigint"==typeof e?e:BigInt(e);if(r>n||r<t)throw new Error("int64 invalid: ".concat(e));return r},uParse:function(e){var t="bigint"==typeof e?e:BigInt(e);if(t>a||t<i)throw new Error("uint64 invalid: ".concat(e));return t},enc:function(t){return e.setBigInt64(0,this.parse(t),!0),{lo:e.getInt32(0,!0),hi:e.getInt32(4,!0)}},uEnc:function(t){return e.setBigInt64(0,this.uParse(t),!0),{lo:e.getInt32(0,!0),hi:e.getInt32(4,!0)}},dec:function(t,n){return e.setInt32(0,t,!0),e.setInt32(4,n,!0),e.getBigInt64(0,!0)},uDec:function(t,n){return e.setInt32(0,t,!0),e.setInt32(4,n,!0),e.getBigUint64(0,!0)}}}var o=function(e){return Ps(/^-?[0-9]+$/.test(e),"int64 invalid: ".concat(e))},s=function(e){return Ps(/^[0-9]+$/.test(e),"uint64 invalid: ".concat(e))};return{zero:"0",supported:!1,parse:function(e){return"string"!=typeof e&&(e=e.toString()),o(e),e},uParse:function(e){return"string"!=typeof e&&(e=e.toString()),s(e),e},enc:function(e){return"string"!=typeof e&&(e=e.toString()),o(e),js(e)},uEnc:function(e){return"string"!=typeof e&&(e=e.toString()),s(e),js(e)},dec:function(e,t){return function(e,t){var n=Us(e,t),r=2147483648&n.hi;r&&(n=Ls(n.lo,n.hi));var i=Ms(n.lo,n.hi);return r?"-"+i:i}(e,t)},uDec:function(e,t){return Ms(e,t)}}}();function qs(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return Hs(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Hs(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}function Hs(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Ks,Qs,Zs=Symbol("@bufbuild/protobuf/enum-type");function Gs(e){var t=e[Zs];return Ps(t,"missing enum type on enum object"),t}function Ys(e,t,n,r){e[Zs]=Ws(t,n.map((function(t){return{no:t.no,name:t.name,localName:e[t.no]}})),r)}function Ws(e,t,n){var r,i=Object.create(null),a=Object.create(null),o=[],s=qs(t);try{for(s.s();!(r=s.n()).done;){var u=r.value,c=$s(u);o.push(c),i[u.name]=c,a[u.no]=c}}catch(e){s.e(e)}finally{s.f()}return{typeName:e,values:o,findName:function(e){return i[e]},findNumber:function(e){return a[e]}}}function Xs(e,t,n){var r,i={},a=qs(t);try{for(a.s();!(r=a.n()).done;){var o=$s(r.value);i[o.localName]=o.no,i[o.no]=o.localName}}catch(e){a.e(e)}finally{a.f()}return Ys(i,e,t,n),i}function $s(e){return"localName"in e?e:Object.assign(Object.assign({},e),{localName:e.name})}!function(e){e[e.DOUBLE=1]="DOUBLE",e[e.FLOAT=2]="FLOAT",e[e.INT64=3]="INT64",e[e.UINT64=4]="UINT64",e[e.INT32=5]="INT32",e[e.FIXED64=6]="FIXED64",e[e.FIXED32=7]="FIXED32",e[e.BOOL=8]="BOOL",e[e.STRING=9]="STRING",e[e.BYTES=12]="BYTES",e[e.UINT32=13]="UINT32",e[e.SFIXED32=15]="SFIXED32",e[e.SFIXED64=16]="SFIXED64",e[e.SINT32=17]="SINT32",e[e.SINT64=18]="SINT64"}(Ks||(Ks={})),function(e){e[e.Varint=0]="Varint",e[e.Bit64=1]="Bit64",e[e.LengthDelimited=2]="LengthDelimited",e[e.StartGroup=3]="StartGroup",e[e.EndGroup=4]="EndGroup",e[e.Bit32=5]="Bit32"}(Qs||(Qs={}));var eu=function(){function e(t){u(this,e),this.stack=[],this.textEncoder=null!=t?t:new TextEncoder,this.chunks=[],this.buf=[]}return l(e,[{key:"finish",value:function(){this.chunks.push(new Uint8Array(this.buf));for(var e=0,t=0;t<this.chunks.length;t++)e+=this.chunks[t].length;for(var n=new Uint8Array(e),r=0,i=0;i<this.chunks.length;i++)n.set(this.chunks[i],r),r+=this.chunks[i].length;return this.chunks=[],n}},{key:"fork",value:function(){return this.stack.push({chunks:this.chunks,buf:this.buf}),this.chunks=[],this.buf=[],this}},{key:"join",value:function(){var e=this.finish(),t=this.stack.pop();if(!t)throw new Error("invalid state, fork stack empty");return this.chunks=t.chunks,this.buf=t.buf,this.uint32(e.byteLength),this.raw(e)}},{key:"tag",value:function(e,t){return this.uint32((e<<3|t)>>>0)}},{key:"raw",value:function(e){return this.buf.length&&(this.chunks.push(new Uint8Array(this.buf)),this.buf=[]),this.chunks.push(e),this}},{key:"uint32",value:function(e){for(Rs(e);e>127;)this.buf.push(127&e|128),e>>>=7;return this.buf.push(e),this}},{key:"int32",value:function(e){return Ns(e),zs(e,this.buf),this}},{key:"bool",value:function(e){return this.buf.push(e?1:0),this}},{key:"bytes",value:function(e){return this.uint32(e.byteLength),this.raw(e)}},{key:"string",value:function(e){var t=this.textEncoder.encode(e);return this.uint32(t.byteLength),this.raw(t)}},{key:"float",value:function(e){xs(e);var t=new Uint8Array(4);return new DataView(t.buffer).setFloat32(0,e,!0),this.raw(t)}},{key:"double",value:function(e){var t=new Uint8Array(8);return new DataView(t.buffer).setFloat64(0,e,!0),this.raw(t)}},{key:"fixed32",value:function(e){Rs(e);var t=new Uint8Array(4);return new DataView(t.buffer).setUint32(0,e,!0),this.raw(t)}},{key:"sfixed32",value:function(e){Ns(e);var t=new Uint8Array(4);return new DataView(t.buffer).setInt32(0,e,!0),this.raw(t)}},{key:"sint32",value:function(e){return Ns(e),zs(e=(e<<1^e>>31)>>>0,this.buf),this}},{key:"sfixed64",value:function(e){var t=new Uint8Array(8),n=new DataView(t.buffer),r=Js.enc(e);return n.setInt32(0,r.lo,!0),n.setInt32(4,r.hi,!0),this.raw(t)}},{key:"fixed64",value:function(e){var t=new Uint8Array(8),n=new DataView(t.buffer),r=Js.uEnc(e);return n.setInt32(0,r.lo,!0),n.setInt32(4,r.hi,!0),this.raw(t)}},{key:"int64",value:function(e){var t=Js.enc(e);return Bs(t.lo,t.hi,this.buf),this}},{key:"sint64",value:function(e){var t=Js.enc(e),n=t.hi>>31;return Bs(t.lo<<1^n,(t.hi<<1|t.lo>>>31)^n,this.buf),this}},{key:"uint64",value:function(e){var t=Js.uEnc(e);return Bs(t.lo,t.hi,this.buf),this}}]),e}(),tu=function(){function e(t,n){u(this,e),this.varint64=Cs,this.uint32=Vs,this.buf=t,this.len=t.length,this.pos=0,this.view=new DataView(t.buffer,t.byteOffset,t.byteLength),this.textDecoder=null!=n?n:new TextDecoder}return l(e,[{key:"tag",value:function(){var e=this.uint32(),t=e>>>3,n=7&e;if(t<=0||n<0||n>5)throw new Error("illegal tag: field no "+t+" wire type "+n);return[t,n]}},{key:"skip",value:function(e){var t=this.pos;switch(e){case Qs.Varint:for(;128&this.buf[this.pos++];);break;case Qs.Bit64:this.pos+=4;case Qs.Bit32:this.pos+=4;break;case Qs.LengthDelimited:var n=this.uint32();this.pos+=n;break;case Qs.StartGroup:for(var r;(r=this.tag()[1])!==Qs.EndGroup;)this.skip(r);break;default:throw new Error("cant skip wire type "+e)}return this.assertBounds(),this.buf.subarray(t,this.pos)}},{key:"assertBounds",value:function(){if(this.pos>this.len)throw new RangeError("premature EOF")}},{key:"int32",value:function(){return 0|this.uint32()}},{key:"sint32",value:function(){var e=this.uint32();return e>>>1^-(1&e)}},{key:"int64",value:function(){return Js.dec.apply(Js,w(this.varint64()))}},{key:"uint64",value:function(){return Js.uDec.apply(Js,w(this.varint64()))}},{key:"sint64",value:function(){var e=A(this.varint64(),2),t=e[0],n=e[1],r=-(1&t);return t=(t>>>1|(1&n)<<31)^r,n=n>>>1^r,Js.dec(t,n)}},{key:"bool",value:function(){var e=A(this.varint64(),2),t=e[0],n=e[1];return 0!==t||0!==n}},{key:"fixed32",value:function(){return this.view.getUint32((this.pos+=4)-4,!0)}},{key:"sfixed32",value:function(){return this.view.getInt32((this.pos+=4)-4,!0)}},{key:"fixed64",value:function(){return Js.uDec(this.sfixed32(),this.sfixed32())}},{key:"sfixed64",value:function(){return Js.dec(this.sfixed32(),this.sfixed32())}},{key:"float",value:function(){return this.view.getFloat32((this.pos+=4)-4,!0)}},{key:"double",value:function(){return this.view.getFloat64((this.pos+=8)-8,!0)}},{key:"bytes",value:function(){var e=this.uint32(),t=this.pos;return this.pos+=e,this.assertBounds(),this.buf.subarray(t,t+e)}},{key:"string",value:function(){return this.textDecoder.decode(this.bytes())}}]),e}();function nu(e,t){return t instanceof As||!e.fieldWrapper?t:e.fieldWrapper.wrapField(t)}Ks.DOUBLE,Ks.FLOAT,Ks.INT64,Ks.UINT64,Ks.INT32,Ks.UINT32,Ks.BOOL,Ks.STRING,Ks.BYTES;function ru(e,t,n){if(t===n)return!0;if(e==Ks.BYTES){if(!(t instanceof Uint8Array&&n instanceof Uint8Array))return!1;if(t.length!==n.length)return!1;for(var r=0;r<t.length;r++)if(t[r]!==n[r])return!1;return!0}switch(e){case Ks.UINT64:case Ks.FIXED64:case Ks.INT64:case Ks.SFIXED64:case Ks.SINT64:return t==n}return!1}function iu(e){switch(e){case Ks.BOOL:return!1;case Ks.UINT64:case Ks.FIXED64:case Ks.INT64:case Ks.SFIXED64:case Ks.SINT64:return Js.zero;case Ks.DOUBLE:case Ks.FLOAT:return 0;case Ks.BYTES:return new Uint8Array(0);case Ks.STRING:return"";default:return 0}}function au(e,t){var n=void 0===t,r=Qs.Varint,i=0===t;switch(e){case Ks.STRING:i=n||!t.length,r=Qs.LengthDelimited;break;case Ks.BOOL:i=!1===t;break;case Ks.DOUBLE:r=Qs.Bit64;break;case Ks.FLOAT:r=Qs.Bit32;break;case Ks.INT64:case Ks.UINT64:i=n||0==t;break;case Ks.FIXED64:i=n||0==t,r=Qs.Bit64;break;case Ks.BYTES:i=n||!t.byteLength,r=Qs.LengthDelimited;break;case Ks.FIXED32:case Ks.SFIXED32:r=Qs.Bit32;break;case Ks.SFIXED64:i=n||0==t,r=Qs.Bit64;break;case Ks.SINT64:i=n||0==t}return[r,Ks[e].toLowerCase(),n||i]}function ou(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return su(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return su(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}function su(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var uu=Symbol("@bufbuild/protobuf/unknown-fields"),cu={readUnknownFields:!0,readerFactory:function(e){return new tu(e)}},lu={writeUnknownFields:!0,writerFactory:function(){return new eu}};function fu(e){return e?Object.assign(Object.assign({},cu),e):cu}function du(e){return e?Object.assign(Object.assign({},lu),e):lu}function hu(e,t,n){for(var r,i,a=t.uint32(),o=t.pos+a;t.pos<o;){switch(A(t.tag(),1)[0]){case 1:r=vu(t,e.K);break;case 2:switch(e.V.kind){case"scalar":i=vu(t,e.V.T);break;case"enum":i=t.int32();break;case"message":i=e.V.T.fromBinary(t.bytes(),n)}}}if(void 0===r){var s=iu(e.K);r=e.K==Ks.BOOL?s.toString():s}if("string"!=typeof r&&"number"!=typeof r&&(r=r.toString()),void 0===i)switch(e.V.kind){case"scalar":i=iu(e.V.T);break;case"enum":i=0;break;case"message":i=new e.V.T}return[r,i]}function vu(e,t){return e[A(au(t),2)[1]]()}function pu(e,t,n,r,i){e.tag(n.no,Qs.LengthDelimited),e.fork();var a=r;switch(n.K){case Ks.INT32:case Ks.FIXED32:case Ks.UINT32:case Ks.SFIXED32:case Ks.SINT32:a=Number.parseInt(r);break;case Ks.BOOL:Ps("true"==r||"false"==r),a="true"==r}switch(mu(e,n.K,1,a,!0),n.V.kind){case"scalar":mu(e,n.V.T,2,i,!0);break;case"enum":mu(e,Ks.INT32,2,i,!0);break;case"message":gu(e,t,n.V.T,2,i)}e.join()}function gu(e,t,n,r,i){if(void 0!==i){var a=nu(n,i);e.tag(r,Qs.LengthDelimited).bytes(a.toBinary(t))}}function mu(e,t,n,r,i){var a=A(au(t,r),3),o=a[0],s=a[1];a[2]&&!i||e.tag(n,o)[s](r)}function yu(e,t,n,r){if(r.length){e.tag(n,Qs.LengthDelimited).fork();for(var i=A(au(t),2)[1],a=0;a<r.length;a++)e[i](r[a]);e.join()}}function wu(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return bu(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return bu(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}function bu(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}for(var _u="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".split(""),ku=[],Iu=0;Iu<_u.length;Iu++)ku[_u[Iu].charCodeAt(0)]=Iu;ku["-".charCodeAt(0)]=_u.indexOf("+"),ku["_".charCodeAt(0)]=_u.indexOf("/");var Su=function(e){var t=3*e.length/4;"="==e[e.length-2]?t-=2:"="==e[e.length-1]&&(t-=1);for(var n,r=new Uint8Array(t),i=0,a=0,o=0,s=0;s<e.length;s++){if(void 0===(n=ku[e.charCodeAt(s)]))switch(e[s]){case"=":a=0;case"\n":case"\r":case"\t":case" ":continue;default:throw Error("invalid base64 string.")}switch(a){case 0:o=n,a=1;break;case 1:r[i++]=o<<2|(48&n)>>4,o=n,a=2;break;case 2:r[i++]=(15&o)<<4|(60&n)>>2,o=n,a=3;break;case 3:r[i++]=(3&o)<<6|n,a=0}}if(1==a)throw Error("invalid base64 string.");return r.subarray(0,i)},Eu=function(e){for(var t,n="",r=0,i=0,a=0;a<e.length;a++)switch(t=e[a],r){case 0:n+=_u[t>>2],i=(3&t)<<4,r=1;break;case 1:n+=_u[i|t>>4],i=(15&t)<<2,r=2;break;case 2:n+=_u[i|t>>6],n+=_u[63&t],r=0}return r&&(n+=_u[i],n+="=",1==r&&(n+="=")),n};function Tu(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return Ou(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Ou(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}function Ou(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Au={ignoreUnknownFields:!1},Pu={emitDefaultValues:!1,enumAsInteger:!1,useProtoFieldName:!1,prettySpaces:0};function Nu(e){return e?Object.assign(Object.assign({},Au),e):Au}function Ru(e){return e?Object.assign(Object.assign({},Pu),e):Pu}function xu(e){if(null===e)return"null";switch(r(e)){case"object":return Array.isArray(e)?"array":"object";case"string":return e.length>100?"string":'"'.concat(e.split('"').join('\\"'),'"');default:return e.toString()}}function Cu(e,t){switch(e){case Ks.DOUBLE:case Ks.FLOAT:if(null===t)return 0;if("NaN"===t)return Number.NaN;if("Infinity"===t)return Number.POSITIVE_INFINITY;if("-Infinity"===t)return Number.NEGATIVE_INFINITY;if(""===t)break;if("string"==typeof t&&t.trim().length!==t.length)break;if("string"!=typeof t&&"number"!=typeof t)break;var n=Number(t);if(Number.isNaN(n))break;if(!Number.isFinite(n))break;return e==Ks.FLOAT&&xs(n),n;case Ks.INT32:case Ks.FIXED32:case Ks.SFIXED32:case Ks.SINT32:case Ks.UINT32:if(null===t)return 0;var r;if("number"==typeof t?r=t:"string"==typeof t&&t.length>0&&t.trim().length===t.length&&(r=Number(t)),void 0===r)break;return e==Ks.UINT32?Rs(r):Ns(r),r;case Ks.INT64:case Ks.SFIXED64:case Ks.SINT64:if(null===t)return Js.zero;if("number"!=typeof t&&"string"!=typeof t)break;return Js.parse(t);case Ks.FIXED64:case Ks.UINT64:if(null===t)return Js.zero;if("number"!=typeof t&&"string"!=typeof t)break;return Js.uParse(t);case Ks.BOOL:if(null===t)return!1;if("boolean"!=typeof t)break;return t;case Ks.STRING:if(null===t)return"";if("string"!=typeof t)break;try{encodeURIComponent(t)}catch(e){throw new Error("invalid UTF8")}return t;case Ks.BYTES:if(null===t||""===t)return new Uint8Array(0);if("string"!=typeof t)break;return Su(t)}throw new Error}function Bu(e,t,n){if(null===t)return 0;switch(r(t)){case"number":if(Number.isInteger(t))return t;break;case"string":var i=e.findName(t);if(i||n)return null==i?void 0:i.no}throw new Error("cannot decode enum ".concat(e.typeName," from JSON: ").concat(xu(t)))}function Du(e,t,n,r){var i;if(void 0===t)return t;if(0!==t||n){if(r)return t;if("google.protobuf.NullValue"==e.typeName)return null;var a=e.findNumber(t);return null!==(i=null==a?void 0:a.name)&&void 0!==i?i:t}}function ju(e,t,n){if(void 0!==t)switch(e){case Ks.INT32:case Ks.SFIXED32:case Ks.SINT32:case Ks.FIXED32:case Ks.UINT32:return Ps("number"==typeof t),0!=t||n?t:void 0;case Ks.FLOAT:case Ks.DOUBLE:return Ps("number"==typeof t),Number.isNaN(t)?"NaN":t===Number.POSITIVE_INFINITY?"Infinity":t===Number.NEGATIVE_INFINITY?"-Infinity":0!==t||n?t:void 0;case Ks.STRING:return Ps("string"==typeof t),t.length>0||n?t:void 0;case Ks.BOOL:return Ps("boolean"==typeof t),t||n?t:void 0;case Ks.UINT64:case Ks.FIXED64:case Ks.INT64:case Ks.SFIXED64:case Ks.SINT64:return Ps("bigint"==typeof t||"string"==typeof t||"number"==typeof t),n||0!=t?t.toString(10):void 0;case Ks.BYTES:return Ps(t instanceof Uint8Array),n||t.byteLength>0?Eu(t):void 0}}function Mu(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return Uu(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Uu(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}function Uu(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Lu(e,t){if(void 0===t)return t;if(t instanceof As)return t.clone();if(t instanceof Uint8Array){var n=new Uint8Array(t.byteLength);return n.set(t),n}return t}function Fu(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return zu(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return zu(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}function zu(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Vu=function(){function e(t,n){u(this,e),this._fields=t,this._normalizer=n}return l(e,[{key:"findJsonName",value:function(e){if(!this.jsonNames){var t,n={},r=Fu(this.list());try{for(r.s();!(t=r.n()).done;){var i=t.value;n[i.jsonName]=n[i.name]=i}}catch(e){r.e(e)}finally{r.f()}this.jsonNames=n}return this.jsonNames[e]}},{key:"find",value:function(e){if(!this.numbers){var t,n={},r=Fu(this.list());try{for(r.s();!(t=r.n()).done;){var i=t.value;n[i.no]=i}}catch(e){r.e(e)}finally{r.f()}this.numbers=n}return this.numbers[e]}},{key:"list",value:function(){return this.all||(this.all=this._normalizer(this._fields)),this.all}},{key:"byNumber",value:function(){return this.numbersAsc||(this.numbersAsc=this.list().concat().sort((function(e,t){return e.no-t.no}))),this.numbersAsc}},{key:"byMember",value:function(){if(!this.members){this.members=[];var e,t,n=this.members,r=Fu(this.list());try{for(r.s();!(t=r.n()).done;){var i=t.value;i.oneof?i.oneof!==e&&(e=i.oneof,n.push(e)):n.push(i)}}catch(e){r.e(e)}finally{r.f()}}return this.members}}]),e}();function Ju(e,t){var n=Ku(e);return t?n:Wu(Yu(n))}function qu(e){return Ju(e,!1)}var Hu=Ku;function Ku(e){for(var t=!1,n=[],r=0;r<e.length;r++){var i=e.charAt(r);switch(i){case"_":t=!0;break;case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":n.push(i),t=!1;break;default:t&&(t=!1,i=i.toUpperCase()),n.push(i)}}return n.join("")}new Set(["break","case","catch","class","const","continue","debugger","default","delete","do","else","export","extends","false","finally","for","function","if","import","in","instanceof","new","null","return","super","switch","this","throw","true","try","typeof","var","void","while","with","yield","enum","implements","interface","let","package","private","protected","public","static","Object","bigint","number","boolean","string","object","globalThis","Uint8Array","Partial"]);var Qu=new Set(["constructor","toString","toJSON","valueOf"]),Zu=new Set(["getType","clone","equals","fromBinary","fromJson","fromJsonString","toBinary","toJson","toJsonString","toObject"]),Gu=function(e){return"".concat(e,"$")},Yu=function(e){return Zu.has(e)?Gu(e):e},Wu=function(e){return Qu.has(e)?Gu(e):e},Xu=function(){function e(t){u(this,e),this.kind="oneof",this.repeated=!1,this.packed=!1,this.opt=!1,this.default=void 0,this.fields=[],this.name=t,this.localName=qu(t)}return l(e,[{key:"addField",value:function(e){Ps(e.oneof===this,"field ".concat(e.name," not one of ").concat(this.name)),this.fields.push(e)}},{key:"findField",value:function(e){if(!this._lookup){this._lookup=Object.create(null);for(var t=0;t<this.fields.length;t++)this._lookup[this.fields[t].localName]=this.fields[t]}return this._lookup[e]}}]),e}();function $u(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return ec(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ec(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}function ec(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var tc,nc,rc,ic,ac,oc,sc=(tc="proto3",ac=function(e,t){return function(n,r,i){if("map"==n.kind){var a={};switch(n.V.kind){case"scalar":for(var o=0,s=Object.entries(r);o<s.length;o++){var u=A(s[o],2),c=u[0],l=u[1],f=t(n.V.T,l,!0);Ps(void 0!==f),a[c.toString()]=f}break;case"message":for(var d=0,h=Object.entries(r);d<h.length;d++){var v=A(h[d],2),p=v[0],g=v[1];a[p.toString()]=g.toJson(i)}break;case"enum":for(var m=n.V.T,y=0,w=Object.entries(r);y<w.length;y++){var b=A(w[y],2),_=b[0],k=b[1];Ps(void 0===k||"number"==typeof k);var I=e(m,k,!0,i.enumAsInteger);Ps(void 0!==I),a[_.toString()]=I}}return i.emitDefaultValues||Object.keys(a).length>0?a:void 0}if(n.repeated){var S=[];switch(n.kind){case"scalar":for(var E=0;E<r.length;E++)S.push(t(n.T,r[E],!0));break;case"enum":for(var T=0;T<r.length;T++)S.push(e(n.T,r[T],!0,i.enumAsInteger));break;case"message":for(var O=0;O<r.length;O++)S.push(nu(n.T,r[O]).toJson(i))}return i.emitDefaultValues||S.length>0?S:void 0}switch(n.kind){case"scalar":return t(n.T,r,!!n.oneof||n.opt||i.emitDefaultValues);case"enum":return e(n.T,r,!!n.oneof||n.opt||i.emitDefaultValues,i.enumAsInteger);case"message":return void 0!==r?nu(n.T,r).toJson(i):void 0}}},oc=ac(Du,ju),nc={makeReadOptions:Nu,makeWriteOptions:Ru,readMessage:function(e,t,n,i){if(null==t||Array.isArray(t)||"object"!=r(t))throw new Error("cannot decode message ".concat(e.typeName," from JSON: ").concat(this.debug(t)));i=null!=i?i:new e;for(var a={},o=0,s=Object.entries(t);o<s.length;o++){var u=A(s[o],2),c=u[0],l=u[1],f=e.fields.findJsonName(c);if(f){var d=f.localName,h=i;if(f.oneof){if(null===l&&"scalar"==f.kind)continue;var v=a[f.oneof.localName];if(v)throw new Error("cannot decode message ".concat(e.typeName,' from JSON: multiple keys for oneof "').concat(f.oneof.name,'" present: "').concat(v,'", "').concat(c,'"'));a[f.oneof.localName]=c,h=h[f.oneof.localName]={case:d},d="value"}if(f.repeated){if(null===l)continue;if(!Array.isArray(l))throw new Error("cannot decode field ".concat(e.typeName,".").concat(f.name," from JSON: ").concat(this.debug(l)));var p,g=h[d],m=Tu(l);try{for(m.s();!(p=m.n()).done;){var y=p.value;if(null===y)throw new Error("cannot decode field ".concat(e.typeName,".").concat(f.name," from JSON: ").concat(this.debug(y)));var w=void 0;switch(f.kind){case"message":w=f.T.fromJson(y,n);break;case"enum":if(void 0===(w=Bu(f.T,y,n.ignoreUnknownFields)))continue;break;case"scalar":try{w=Cu(f.T,y)}catch(t){var b="cannot decode field ".concat(e.typeName,".").concat(f.name," from JSON: ").concat(this.debug(y));throw t instanceof Error&&t.message.length>0&&(b+=": ".concat(t.message)),new Error(b)}}g.push(w)}}catch(e){m.e(e)}finally{m.f()}}else if("map"==f.kind){if(null===l)continue;if(Array.isArray(l)||"object"!=r(l))throw new Error("cannot decode field ".concat(e.typeName,".").concat(f.name," from JSON: ").concat(this.debug(l)));for(var _=h[d],k=0,I=Object.entries(l);k<I.length;k++){var S=A(I[k],2),E=S[0],T=S[1];if(null===T)throw new Error("cannot decode field ".concat(e.typeName,".").concat(f.name," from JSON: map value null"));var O=void 0;switch(f.V.kind){case"message":O=f.V.T.fromJson(T,n);break;case"enum":if(void 0===(O=Bu(f.V.T,T,n.ignoreUnknownFields)))continue;break;case"scalar":try{O=Cu(f.V.T,T)}catch(t){var P="cannot decode map value for field ".concat(e.typeName,".").concat(f.name," from JSON: ").concat(this.debug(l));throw t instanceof Error&&t.message.length>0&&(P+=": ".concat(t.message)),new Error(P)}}try{_[Cu(f.K,f.K==Ks.BOOL?"true"==E||"false"!=E&&E:E).toString()]=O}catch(t){var N="cannot decode map key for field ".concat(e.typeName,".").concat(f.name," from JSON: ").concat(this.debug(l));throw t instanceof Error&&t.message.length>0&&(N+=": ".concat(t.message)),new Error(N)}}}else switch(f.kind){case"message":var R=f.T;if(null===l&&"google.protobuf.Value"!=R.typeName){if(f.oneof)throw new Error("cannot decode field ".concat(e.typeName,".").concat(f.name,' from JSON: null is invalid for oneof field "').concat(c,'"'));continue}h[d]instanceof As?h[d].fromJson(l,n):(h[d]=R.fromJson(l,n),R.fieldWrapper&&!f.oneof&&(h[d]=R.fieldWrapper.unwrapField(h[d])));break;case"enum":var x=Bu(f.T,l,n.ignoreUnknownFields);void 0!==x&&(h[d]=x);break;case"scalar":try{h[d]=Cu(f.T,l)}catch(t){var C="cannot decode field ".concat(e.typeName,".").concat(f.name," from JSON: ").concat(this.debug(l));throw t instanceof Error&&t.message.length>0&&(C+=": ".concat(t.message)),new Error(C)}}}else if(!n.ignoreUnknownFields)throw new Error("cannot decode message ".concat(e.typeName,' from JSON: key "').concat(c,'" is unknown'))}return i},writeMessage:function(e,t){var n,r=e.getType(),i={};try{var a,o=Tu(r.fields.byMember());try{for(o.s();!(a=o.n()).done;){var s=a.value,u=void 0;if("oneof"==s.kind){var c=e[s.localName];if(void 0===c.value)continue;if(!(n=s.findField(c.case)))throw"oneof case not found: "+c.case;u=oc(n,c.value,t)}else u=oc(n=s,e[n.localName],t);void 0!==u&&(i[t.useProtoFieldName?n.name:n.jsonName]=u)}}catch(e){o.e(e)}finally{o.f()}}catch(e){var l=n?"cannot encode field ".concat(r.typeName,".").concat(n.name," to JSON"):"cannot encode message ".concat(r.typeName," to JSON"),f=e instanceof Error?e.message:String(e);throw new Error(l+(f.length>0?": ".concat(f):""))}return i},readScalar:Cu,writeScalar:ju,debug:xu},rc=Object.assign(Object.assign({},{makeReadOptions:fu,makeWriteOptions:du,listUnknownFields:function(e){var t;return null!==(t=e[uu])&&void 0!==t?t:[]},discardUnknownFields:function(e){delete e[uu]},writeUnknownFields:function(e,t){var n=e[uu];if(n){var r,i=ou(n);try{for(i.s();!(r=i.n()).done;){var a=r.value;t.tag(a.no,a.wireType).raw(a.data)}}catch(e){i.e(e)}finally{i.f()}}},onUnknownField:function(e,t,n,r){var i=e;Array.isArray(i[uu])||(i[uu]=[]),i[uu].push({no:t,wireType:n,data:r})},readMessage:function(e,t,n,r){for(var i=e.getType(),a=void 0===n?t.len:t.pos+n;t.pos<a;){var o=A(t.tag(),2),s=o[0],u=o[1],c=i.fields.find(s);if(c){var l=e,f=c.repeated,d=c.localName;switch(c.oneof&&((l=l[c.oneof.localName]).case!=d&&delete l.value,l.case=d,d="value"),c.kind){case"scalar":case"enum":var h="enum"==c.kind?Ks.INT32:c.T;if(f){var v=l[d];if(u==Qs.LengthDelimited&&h!=Ks.STRING&&h!=Ks.BYTES)for(var p=t.uint32()+t.pos;t.pos<p;)v.push(vu(t,h));else v.push(vu(t,h))}else l[d]=vu(t,h);break;case"message":var g=c.T;f?l[d].push(g.fromBinary(t.bytes(),r)):l[d]instanceof As?l[d].fromBinary(t.bytes(),r):(l[d]=g.fromBinary(t.bytes(),r),!g.fieldWrapper||c.oneof||c.repeated||(l[d]=g.fieldWrapper.unwrapField(l[d])));break;case"map":var m=A(hu(c,t,r),2),y=m[0],w=m[1];l[d][y]=w}}else{var b=t.skip(u);r.readUnknownFields&&this.onUnknownField(e,s,u,b)}}}}),{writeMessage:function(e,t,n){var r,i=wu(e.getType().fields.byNumber());try{for(i.s();!(r=i.n()).done;){var a=r.value,o=void 0,s=a.repeated,u=a.localName;if(a.oneof){var c=e[a.oneof.localName];if(c.case!==u)continue;o=c.value}else o=e[u];switch(a.kind){case"scalar":case"enum":var l="enum"==a.kind?Ks.INT32:a.T;if(s)if(a.packed)yu(t,l,a.no,o);else{var f,d=wu(o);try{for(d.s();!(f=d.n()).done;){var h=f.value;mu(t,l,a.no,h,!0)}}catch(e){d.e(e)}finally{d.f()}}else void 0!==o&&mu(t,l,a.no,o,!!a.oneof||a.opt);break;case"message":if(s){var v,p=wu(o);try{for(p.s();!(v=p.n()).done;){var g=v.value;gu(t,n,a.T,a.no,g)}}catch(e){p.e(e)}finally{p.f()}}else gu(t,n,a.T,a.no,o);break;case"map":for(var m=0,y=Object.entries(o);m<y.length;m++){var w=A(y[m],2);pu(t,n,a,w[0],w[1])}}}}catch(e){i.e(e)}finally{i.f()}return n.writeUnknownFields&&this.writeUnknownFields(e,t),t}}),ic=Object.assign(Object.assign({},{setEnumType:Ys,initPartial:function(e,t){if(void 0!==e){var n,r=Mu(t.getType().fields.byMember());try{var i=function(){var r=n.value,i=r.localName,a=t,o=e;if(void 0===o[i])return"continue";switch(r.kind){case"oneof":var s=o[i].case;if(void 0===s)return"continue";var u=r.findField(s),c=o[i].value;!u||"message"!=u.kind||c instanceof u.T||(c=new u.T(c)),a[i]={case:s,value:c};break;case"scalar":case"enum":a[i]=o[i];break;case"map":switch(r.V.kind){case"scalar":case"enum":Object.assign(a[i],o[i]);break;case"message":for(var l=r.V.T,f=0,d=Object.keys(o[i]);f<d.length;f++){var h=d[f],v=o[i][h];l.fieldWrapper||(v=new l(v)),a[i][h]=v}}break;case"message":var p=r.T;if(r.repeated)a[i]=o[i].map((function(e){return e instanceof p?e:new p(e)}));else if(void 0!==o[i]){var g=o[i];p.fieldWrapper?a[i]=g:a[i]=g instanceof p?g:new p(g)}}};for(r.s();!(n=r.n()).done;)i()}catch(e){r.e(e)}finally{r.f()}}},equals:function(e,t,n){return t===n||!(!t||!n)&&e.fields.byMember().every((function(e){var r=t[e.localName],i=n[e.localName];if(e.repeated){if(r.length!==i.length)return!1;switch(e.kind){case"message":return r.every((function(t,n){return e.T.equals(t,i[n])}));case"scalar":return r.every((function(t,n){return ru(e.T,t,i[n])}));case"enum":return r.every((function(e,t){return ru(Ks.INT32,e,i[t])}))}throw new Error("repeated cannot contain ".concat(e.kind))}switch(e.kind){case"message":return e.T.equals(r,i);case"enum":return ru(Ks.INT32,r,i);case"scalar":return ru(e.T,r,i);case"oneof":if(r.case!==i.case)return!1;var a=e.findField(r.case);if(void 0===a)return!0;switch(a.kind){case"message":return a.T.equals(r.value,i.value);case"enum":return ru(Ks.INT32,r.value,i.value);case"scalar":return ru(a.T,r.value,i.value)}throw new Error("oneof cannot contain ".concat(a.kind));case"map":var o=Object.keys(r).concat(Object.keys(i));switch(e.V.kind){case"message":var s=e.V.T;return o.every((function(e){return s.equals(r[e],i[e])}));case"enum":return o.every((function(e){return ru(Ks.INT32,r[e],i[e])}));case"scalar":var u=e.V.T;return o.every((function(e){return ru(u,r[e],i[e])}))}}}))},clone:function(e){var t,n=e.getType(),r=new n,i=r,a=Mu(n.fields.byMember());try{var o=function(){var n,r=t.value,a=e[r.localName];if(r.repeated)n=a.map((function(e){return Lu(0,e)}));else if("map"==r.kind){n=i[r.localName];for(var o=0,s=Object.entries(a);o<s.length;o++){var u=A(s[o],2),c=u[0],l=u[1];n[c]=Lu(r.V,l)}}else if("oneof"==r.kind){var f=r.findField(a.case);n=f?{case:a.case,value:Lu(0,a.value)}:{case:void 0}}else n=Lu(0,a);i[r.localName]=n};for(a.s();!(t=a.n()).done;)o()}catch(e){a.e(e)}finally{a.f()}return r}}),{newFieldList:function(e){return new Vu(e,uc)},initFields:function(e){var t,n=$u(e.getType().fields.byMember());try{for(n.s();!(t=n.n()).done;){var r=t.value;if(!r.opt){var i=r.localName,a=e;if(r.repeated)a[i]=[];else switch(r.kind){case"oneof":a[i]={case:void 0};break;case"enum":a[i]=0;break;case"map":a[i]={};break;case"scalar":a[i]=iu(r.T)}}}}catch(e){n.e(e)}finally{n.f()}}}),{syntax:tc,json:nc,bin:rc,util:ic,makeMessageType:function(e,t,n){return function(e,t,n,r){var i,o=null!==(i=null==r?void 0:r.localName)&&void 0!==i?i:t.substring(t.lastIndexOf(".")+1),s=a({},o,(function(t){e.util.initFields(this),e.util.initPartial(t,this)}))[o];return Object.setPrototypeOf(s.prototype,new As),Object.assign(s,{runtime:e,typeName:t,fields:e.util.newFieldList(n),fromBinary:function(e,t){return(new s).fromBinary(e,t)},fromJson:function(e,t){return(new s).fromJson(e,t)},fromJsonString:function(e,t){return(new s).fromJsonString(e,t)},equals:function(t,n){return e.util.equals(s,t,n)}}),s}(this,e,t,n)},makeEnum:Xs,makeEnumType:Ws,getEnumType:Gs});function uc(e){var t,n,r,i,a,o=[],s=$u("function"==typeof e?e():e);try{for(s.s();!(a=s.n()).done;){var u=a.value,c=u;if(c.localName=Ju(u.name,void 0!==u.oneof),c.jsonName=null!==(t=u.jsonName)&&void 0!==t?t:Hu(u.name),c.repeated=null!==(n=u.repeated)&&void 0!==n&&n,c.packed=null!==(r=u.packed)&&void 0!==r?r:"enum"==u.kind||"scalar"==u.kind&&u.T!=Ks.BYTES&&u.T!=Ks.STRING,void 0!==u.oneof){var l="string"==typeof u.oneof?u.oneof:u.oneof.name;i&&i.name==l||(i=new Xu(l)),c.oneof=i,i.addField(c)}o.push(c)}}catch(e){s.e(e)}finally{s.f()}return o}function cc(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=d(e);if(t){var i=d(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return g(this,n)}}var lc=function(e){p(n,e);var t=cc(n);function n(e){var r;return u(this,n),(r=t.call(this)).seconds=Js.zero,r.nanos=0,sc.util.initPartial(e,f(r)),r}return l(n,[{key:"fromJson",value:function(e,t){if("string"!=typeof e)throw new Error("cannot decode google.protobuf.Timestamp from JSON: ".concat(sc.json.debug(e)));var n=e.match(/^([0-9]{4})-([0-9]{2})-([0-9]{2})T([0-9]{2}):([0-9]{2}):([0-9]{2})(?:Z|\.([0-9]{3,9})Z|([+-][0-9][0-9]:[0-9][0-9]))$/);if(!n)throw new Error("cannot decode google.protobuf.Timestamp from JSON: invalid RFC 3339 string");var r=Date.parse(n[1]+"-"+n[2]+"-"+n[3]+"T"+n[4]+":"+n[5]+":"+n[6]+(n[8]?n[8]:"Z"));if(Number.isNaN(r))throw new Error("cannot decode google.protobuf.Timestamp from JSON: invalid RFC 3339 string");if(r<Date.parse("0001-01-01T00:00:00Z")||r>Date.parse("9999-12-31T23:59:59Z"))throw new Error("cannot decode message google.protobuf.Timestamp from JSON: must be from 0001-01-01T00:00:00Z to 9999-12-31T23:59:59Z inclusive");return this.seconds=Js.parse(r/1e3),this.nanos=0,n[7]&&(this.nanos=parseInt("1"+n[7]+"0".repeat(9-n[7].length))-1e9),this}},{key:"toJson",value:function(e){var t=1e3*Number(this.seconds);if(t<Date.parse("0001-01-01T00:00:00Z")||t>Date.parse("9999-12-31T23:59:59Z"))throw new Error("cannot encode google.protobuf.Timestamp to JSON: must be from 0001-01-01T00:00:00Z to 9999-12-31T23:59:59Z inclusive");if(this.nanos<0)throw new Error("cannot encode google.protobuf.Timestamp to JSON: nanos must not be negative");var n="Z";if(this.nanos>0){var r=(this.nanos+1e9).toString().substring(1);n="000000"===r.substring(3)?"."+r.substring(0,3)+"Z":"000"===r.substring(6)?"."+r.substring(0,6)+"Z":"."+r+"Z"}return new Date(t).toISOString().replace(".000Z",n)}},{key:"toDate",value:function(){return new Date(1e3*Number(this.seconds)+Math.ceil(this.nanos/1e6))}}],[{key:"now",value:function(){return n.fromDate(new Date)}},{key:"fromDate",value:function(e){var t=e.getTime();return new n({seconds:Js.parse(Math.floor(t/1e3)),nanos:t%1e3*1e6})}},{key:"fromBinary",value:function(e,t){return(new n).fromBinary(e,t)}},{key:"fromJson",value:function(e,t){return(new n).fromJson(e,t)}},{key:"fromJsonString",value:function(e,t){return(new n).fromJsonString(e,t)}},{key:"equals",value:function(e,t){return sc.util.equals(n,e,t)}}]),n}(As);function fc(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=d(e);if(t){var i=d(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return g(this,n)}}lc.runtime=sc,lc.typeName="google.protobuf.Timestamp",lc.fields=sc.util.newFieldList((function(){return[{no:1,name:"seconds",kind:"scalar",T:3},{no:2,name:"nanos",kind:"scalar",T:5}]}));var dc=function(e){p(n,e);var t=fc(n);function n(e){var r;return u(this,n),r=t.call(this),sc.util.initPartial(e,f(r)),r}return l(n,null,[{key:"fromBinary",value:function(e,t){return(new n).fromBinary(e,t)}},{key:"fromJson",value:function(e,t){return(new n).fromJson(e,t)}},{key:"fromJsonString",value:function(e,t){return(new n).fromJsonString(e,t)}},{key:"equals",value:function(e,t){return sc.util.equals(n,e,t)}}]),n}(As);function hc(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=d(e);if(t){var i=d(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return g(this,n)}}dc.runtime=sc,dc.typeName="google.protobuf.Empty",dc.fields=sc.util.newFieldList((function(){return[]}));var vc=function(e){p(n,e);var t=hc(n);function n(e){var r;return u(this,n),a(f(r=t.call(this)),"string",""),sc.util.initPartial(e,f(r)),r}return l(n,null,[{key:"fromBinary",value:function(e,t){return(new n).fromBinary(e,t)}},{key:"fromJson",value:function(e,t){return(new n).fromJson(e,t)}},{key:"fromJsonString",value:function(e,t){return(new n).fromJsonString(e,t)}},{key:"equals",value:function(e,t){return sc.util.equals(n,e,t)}}]),n}(As);a(vc,"runtime",sc),a(vc,"typeName","core_sdk.v1.Value"),a(vc,"fields",sc.util.newFieldList((function(){return[{no:1,name:"string",kind:"scalar",T:9}]})));var pc=function(e){p(n,e);var t=hc(n);function n(e){var r;return u(this,n),a(f(r=t.call(this)),"name",""),a(f(r),"version",""),a(f(r),"platform",""),a(f(r),"properties",{}),sc.util.initPartial(e,f(r)),r}return l(n,null,[{key:"fromBinary",value:function(e,t){return(new n).fromBinary(e,t)}},{key:"fromJson",value:function(e,t){return(new n).fromJson(e,t)}},{key:"fromJsonString",value:function(e,t){return(new n).fromJsonString(e,t)}},{key:"equals",value:function(e,t){return sc.util.equals(n,e,t)}}]),n}(As);a(pc,"runtime",sc),a(pc,"typeName","core_sdk.v1.LibraryInfo"),a(pc,"fields",sc.util.newFieldList((function(){return[{no:1,name:"name",kind:"scalar",T:9},{no:2,name:"version",kind:"scalar",T:9},{no:3,name:"platform",kind:"scalar",T:9},{no:4,name:"properties",kind:"map",K:9,V:{kind:"message",T:vc}}]})));var gc=function(e){p(n,e);var t=hc(n);function n(e){var r;return u(this,n),r=t.call(this),sc.util.initPartial(e,f(r)),r}return l(n,null,[{key:"fromBinary",value:function(e,t){return(new n).fromBinary(e,t)}},{key:"fromJson",value:function(e,t){return(new n).fromJson(e,t)}},{key:"fromJsonString",value:function(e,t){return(new n).fromJsonString(e,t)}},{key:"equals",value:function(e,t){return sc.util.equals(n,e,t)}}]),n}(As);a(gc,"runtime",sc),a(gc,"typeName","core_sdk.v1.ApplicationInfo"),a(gc,"fields",sc.util.newFieldList((function(){return[{no:1,name:"name",kind:"scalar",T:9,opt:!0},{no:2,name:"identifier",kind:"scalar",T:9,opt:!0},{no:3,name:"version_string",kind:"scalar",T:9,opt:!0}]})));var mc=function(e){p(n,e);var t=hc(n);function n(e){var r;return u(this,n),a(f(r=t.call(this)),"platformVersion",""),a(f(r),"browserVersion",""),sc.util.initPartial(e,f(r)),r}return l(n,null,[{key:"fromBinary",value:function(e,t){return(new n).fromBinary(e,t)}},{key:"fromJson",value:function(e,t){return(new n).fromJson(e,t)}},{key:"fromJsonString",value:function(e,t){return(new n).fromJsonString(e,t)}},{key:"equals",value:function(e,t){return sc.util.equals(n,e,t)}}]),n}(As);a(mc,"runtime",sc),a(mc,"typeName","core_sdk.v1.UserAgentClientHintsInfo"),a(mc,"fields",sc.util.newFieldList((function(){return[{no:1,name:"platform_version",kind:"scalar",T:9},{no:2,name:"browser_version",kind:"scalar",T:9},{no:3,name:"model",kind:"scalar",T:9,opt:!0}]})));var yc=function(e){p(n,e);var t=hc(n);function n(e){var r;return u(this,n),a(f(r=t.call(this)),"model",""),a(f(r),"platform",""),a(f(r),"type",wc.UNKNOWN_UNSPECIFIED),sc.util.initPartial(e,f(r)),r}return l(n,null,[{key:"fromBinary",value:function(e,t){return(new n).fromBinary(e,t)}},{key:"fromJson",value:function(e,t){return(new n).fromJson(e,t)}},{key:"fromJsonString",value:function(e,t){return(new n).fromJsonString(e,t)}},{key:"equals",value:function(e,t){return sc.util.equals(n,e,t)}}]),n}(As);a(yc,"runtime",sc),a(yc,"typeName","core_sdk.v1.DeviceInfo"),a(yc,"fields",sc.util.newFieldList((function(){return[{no:1,name:"model",kind:"scalar",T:9},{no:2,name:"platform",kind:"scalar",T:9},{no:3,name:"user_agent",kind:"scalar",T:9,opt:!0},{no:4,name:"type",kind:"enum",T:sc.getEnumType(wc)},{no:5,name:"carrier",kind:"scalar",T:9,opt:!0},{no:6,name:"vendor_id",kind:"scalar",T:9,opt:!0},{no:7,name:"advertiser_id",kind:"scalar",T:9,opt:!0},{no:13,name:"uach",kind:"message",T:mc,opt:!0}]})));var wc=function(e){return e[e.UNKNOWN_UNSPECIFIED=0]="UNKNOWN_UNSPECIFIED",e[e.MOBILE=1]="MOBILE",e[e.TABLET=2]="TABLET",e[e.DESKTOP=3]="DESKTOP",e[e.TV=4]="TV",e[e.WATCH=5]="WATCH",e[e.AUTOMOTIVE=6]="AUTOMOTIVE",e}({});sc.util.setEnumType(wc,"core_sdk.v1.DeviceInfo.DeviceType",[{no:0,name:"DEVICE_TYPE_UNKNOWN_UNSPECIFIED"},{no:1,name:"DEVICE_TYPE_MOBILE"},{no:2,name:"DEVICE_TYPE_TABLET"},{no:3,name:"DEVICE_TYPE_DESKTOP"},{no:4,name:"DEVICE_TYPE_TV"},{no:5,name:"DEVICE_TYPE_WATCH"},{no:6,name:"DEVICE_TYPE_AUTOMOTIVE"}]);var bc=function(e){p(n,e);var t=hc(n);function n(e){var r;return u(this,n),a(f(r=t.call(this)),"id",""),sc.util.initPartial(e,f(r)),r}return l(n,null,[{key:"fromBinary",value:function(e,t){return(new n).fromBinary(e,t)}},{key:"fromJson",value:function(e,t){return(new n).fromJson(e,t)}},{key:"fromJsonString",value:function(e,t){return(new n).fromJsonString(e,t)}},{key:"equals",value:function(e,t){return sc.util.equals(n,e,t)}}]),n}(As);a(bc,"runtime",sc),a(bc,"typeName","core_sdk.v1.SessionInfo"),a(bc,"fields",sc.util.newFieldList((function(){return[{no:1,name:"id",kind:"scalar",T:9},{no:2,name:"time",kind:"message",T:lc},{no:3,name:"referrer",kind:"scalar",T:9,opt:!0},{no:4,name:"search_keyword",kind:"scalar",T:9,opt:!0},{no:5,name:"utm",kind:"message",T:Ic,opt:!0},{no:6,name:"initial_pageview_info",kind:"message",T:_c,opt:!0}]})));var _c=function(e){p(n,e);var t=hc(n);function n(e){var r;return u(this,n),a(f(r=t.call(this)),"id",""),a(f(r),"sourceProperties",{}),a(f(r),"properties",{}),sc.util.initPartial(e,f(r)),r}return l(n,null,[{key:"fromBinary",value:function(e,t){return(new n).fromBinary(e,t)}},{key:"fromJson",value:function(e,t){return(new n).fromJson(e,t)}},{key:"fromJsonString",value:function(e,t){return(new n).fromJsonString(e,t)}},{key:"equals",value:function(e,t){return sc.util.equals(n,e,t)}}]),n}(As);a(_c,"runtime",sc),a(_c,"typeName","core_sdk.v1.PageviewInfo"),a(_c,"fields",sc.util.newFieldList((function(){return[{no:1,name:"id",kind:"scalar",T:9},{no:2,name:"time",kind:"message",T:lc},{no:3,name:"component_or_class_name",kind:"scalar",T:9,opt:!0},{no:4,name:"title",kind:"scalar",T:9,opt:!0},{no:5,name:"url",kind:"message",T:kc,opt:!0},{no:6,name:"source_properties",kind:"map",K:9,V:{kind:"message",T:vc}},{no:7,name:"previous_page",kind:"scalar",T:9,opt:!0},{no:8,name:"properties",kind:"map",K:9,V:{kind:"message",T:vc}}]})));var kc=function(e){p(n,e);var t=hc(n);function n(e){var r;return u(this,n),a(f(r=t.call(this)),"domain",""),a(f(r),"path",""),a(f(r),"query",""),a(f(r),"hash",""),sc.util.initPartial(e,f(r)),r}return l(n,null,[{key:"fromBinary",value:function(e,t){return(new n).fromBinary(e,t)}},{key:"fromJson",value:function(e,t){return(new n).fromJson(e,t)}},{key:"fromJsonString",value:function(e,t){return(new n).fromJsonString(e,t)}},{key:"equals",value:function(e,t){return sc.util.equals(n,e,t)}}]),n}(As);a(kc,"runtime",sc),a(kc,"typeName","core_sdk.v1.PageviewInfo.Url"),a(kc,"fields",sc.util.newFieldList((function(){return[{no:1,name:"domain",kind:"scalar",T:9},{no:2,name:"path",kind:"scalar",T:9},{no:3,name:"query",kind:"scalar",T:9},{no:4,name:"hash",kind:"scalar",T:9}]})));var Ic=function(e){p(n,e);var t=hc(n);function n(e){var r;return u(this,n),a(f(r=t.call(this)),"source",""),a(f(r),"medium",""),a(f(r),"term",""),a(f(r),"content",""),a(f(r),"campaign",""),sc.util.initPartial(e,f(r)),r}return l(n,null,[{key:"fromBinary",value:function(e,t){return(new n).fromBinary(e,t)}},{key:"fromJson",value:function(e,t){return(new n).fromJson(e,t)}},{key:"fromJsonString",value:function(e,t){return(new n).fromJsonString(e,t)}},{key:"equals",value:function(e,t){return sc.util.equals(n,e,t)}}]),n}(As);function Sc(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=d(e);if(t){var i=d(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return g(this,n)}}a(Ic,"runtime",sc),a(Ic,"typeName","core_sdk.v1.Utm"),a(Ic,"fields",sc.util.newFieldList((function(){return[{no:1,name:"source",kind:"scalar",T:9},{no:2,name:"medium",kind:"scalar",T:9},{no:3,name:"term",kind:"scalar",T:9},{no:4,name:"content",kind:"scalar",T:9},{no:5,name:"campaign",kind:"scalar",T:9}]})));var Ec=function(e){p(n,e);var t=Sc(n);function n(e){var r;return u(this,n),a(f(r=t.call(this)),"envId",""),a(f(r),"userId",""),a(f(r),"properties",{}),a(f(r),"sessionReplay",""),sc.util.initPartial(e,f(r)),r}return l(n,null,[{key:"fromBinary",value:function(e,t){return(new n).fromBinary(e,t)}},{key:"fromJson",value:function(e,t){return(new n).fromJson(e,t)}},{key:"fromJsonString",value:function(e,t){return(new n).fromJsonString(e,t)}},{key:"equals",value:function(e,t){return sc.util.equals(n,e,t)}}]),n}(As);a(Ec,"runtime",sc),a(Ec,"typeName","core_sdk.v1.UserProperties"),a(Ec,"fields",sc.util.newFieldList((function(){return[{no:1,name:"env_id",kind:"scalar",T:9},{no:2,name:"user_id",kind:"scalar",T:9},{no:3,name:"properties",kind:"map",K:9,V:{kind:"message",T:vc}},{no:4,name:"initial_device",kind:"message",T:yc},{no:5,name:"initial_application",kind:"message",T:gc},{no:6,name:"library",kind:"message",T:pc},{no:7,name:"initial_session_info",kind:"message",T:bc},{no:8,name:"session_replay",kind:"scalar",T:9}]})));var Tc=function(e){p(n,e);var t=Sc(n);function n(e){var r;return u(this,n),r=t.call(this),sc.util.initPartial(e,f(r)),r}return l(n,null,[{key:"fromBinary",value:function(e,t){return(new n).fromBinary(e,t)}},{key:"fromJson",value:function(e,t){return(new n).fromJson(e,t)}},{key:"fromJsonString",value:function(e,t){return(new n).fromJsonString(e,t)}},{key:"equals",value:function(e,t){return sc.util.equals(n,e,t)}}]),n}(As);a(Tc,"runtime",sc),a(Tc,"typeName","core_sdk.v1.PostMobileAddUserPropertiesRequest"),a(Tc,"fields",sc.util.newFieldList((function(){return[{no:1,name:"user_properties",kind:"message",T:Ec}]})));var Oc=function(e){p(n,e);var t=Sc(n);function n(e){var r;return u(this,n),a(f(r=t.call(this)),"status",""),sc.util.initPartial(e,f(r)),r}return l(n,null,[{key:"fromBinary",value:function(e,t){return(new n).fromBinary(e,t)}},{key:"fromJson",value:function(e,t){return(new n).fromJson(e,t)}},{key:"fromJsonString",value:function(e,t){return(new n).fromJsonString(e,t)}},{key:"equals",value:function(e,t){return sc.util.equals(n,e,t)}}]),n}(As);function Ac(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=d(e);if(t){var i=d(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return g(this,n)}}a(Oc,"runtime",sc),a(Oc,"typeName","core_sdk.v1.PostMobileAddUserPropertiesResponse"),a(Oc,"fields",sc.util.newFieldList((function(){return[{no:2,name:"status",kind:"scalar",T:9}]})));var Pc=function(e){p(n,e);var t=Ac(n);function n(e){var r;return u(this,n),a(f(r=t.call(this)),"envId",""),a(f(r),"userId",""),a(f(r),"identity",""),sc.util.initPartial(e,f(r)),r}return l(n,null,[{key:"fromBinary",value:function(e,t){return(new n).fromBinary(e,t)}},{key:"fromJson",value:function(e,t){return(new n).fromJson(e,t)}},{key:"fromJsonString",value:function(e,t){return(new n).fromJsonString(e,t)}},{key:"equals",value:function(e,t){return sc.util.equals(n,e,t)}}]),n}(As);function Nc(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=d(e);if(t){var i=d(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return g(this,n)}}a(Pc,"runtime",sc),a(Pc,"typeName","core_sdk.v1.UserIdentification"),a(Pc,"fields",sc.util.newFieldList((function(){return[{no:1,name:"env_id",kind:"scalar",T:9},{no:2,name:"user_id",kind:"scalar",T:9},{no:3,name:"identity",kind:"scalar",T:9},{no:4,name:"time",kind:"message",T:lc},{no:5,name:"library",kind:"message",T:pc}]})));var Rc=function(e){p(n,e);var t=Nc(n);function n(e){var r;return u(this,n),a(f(r=t.call(this)),"csPid",""),a(f(r),"csPvid",""),a(f(r),"csSn",""),a(f(r),"csTs",""),a(f(r),"csUu",""),sc.util.initPartial(e,f(r)),r}return l(n,null,[{key:"fromBinary",value:function(e,t){return(new n).fromBinary(e,t)}},{key:"fromJson",value:function(e,t){return(new n).fromJson(e,t)}},{key:"fromJsonString",value:function(e,t){return(new n).fromJsonString(e,t)}},{key:"equals",value:function(e,t){return sc.util.equals(n,e,t)}}]),n}(As);a(Rc,"runtime",sc),a(Rc,"typeName","core_sdk.v1.CSProperties"),a(Rc,"fields",sc.util.newFieldList((function(){return[{no:1,name:"cs_pid",kind:"scalar",T:9},{no:2,name:"cs_pvid",kind:"scalar",T:9},{no:3,name:"cs_sn",kind:"scalar",T:9},{no:4,name:"cs_ts",kind:"scalar",T:9},{no:5,name:"cs_uu",kind:"scalar",T:9}]})));var xc=function(e){p(n,e);var t=Nc(n);function n(e){var r;return u(this,n),a(f(r=t.call(this)),"platform",Cc.UNSPECIFIED),a(f(r),"urlMetadata",{}),sc.util.initPartial(e,f(r)),r}return l(n,null,[{key:"fromBinary",value:function(e,t){return(new n).fromBinary(e,t)}},{key:"fromJson",value:function(e,t){return(new n).fromJson(e,t)}},{key:"fromJsonString",value:function(e,t){return(new n).fromJsonString(e,t)}},{key:"equals",value:function(e,t){return sc.util.equals(n,e,t)}}]),n}(As);a(xc,"runtime",sc),a(xc,"typeName","core_sdk.v1.SessionReplayInfo"),a(xc,"fields",sc.util.newFieldList((function(){return[{no:1,name:"platform",kind:"enum",T:sc.getEnumType(Cc)},{no:2,name:"time",kind:"message",T:lc},{no:3,name:"url_metadata",kind:"map",K:9,V:{kind:"message",T:vc}}]})));var Cc=function(e){return e[e.UNSPECIFIED=0]="UNSPECIFIED",e[e.AURYC=1]="AURYC",e[e.LOGROCKET=2]="LOGROCKET",e}({});sc.util.setEnumType(Cc,"core_sdk.v1.SessionReplayInfo.SessionReplayPlatform",[{no:0,name:"SESSION_REPLAY_PLATFORM_UNSPECIFIED"},{no:1,name:"SESSION_REPLAY_PLATFORM_AURYC"},{no:2,name:"SESSION_REPLAY_PLATFORM_LOGROCKET"}]);var Bc=function(e){p(n,e);var t=Nc(n);function n(e){var r;return u(this,n),a(f(r=t.call(this)),"id",""),a(f(r),"identity",""),a(f(r),"properties",{}),sc.util.initPartial(e,f(r)),r}return l(n,null,[{key:"fromBinary",value:function(e,t){return(new n).fromBinary(e,t)}},{key:"fromJson",value:function(e,t){return(new n).fromJson(e,t)}},{key:"fromJsonString",value:function(e,t){return(new n).fromJsonString(e,t)}},{key:"equals",value:function(e,t){return sc.util.equals(n,e,t)}}]),n}(As);a(Bc,"runtime",sc),a(Bc,"typeName","core_sdk.v1.User"),a(Bc,"fields",sc.util.newFieldList((function(){return[{no:1,name:"id",kind:"scalar",T:9},{no:2,name:"identity",kind:"scalar",T:9},{no:3,name:"initial_referrer",kind:"scalar",T:9,opt:!0},{no:4,name:"initial_search_keyword",kind:"scalar",T:9,opt:!0},{no:5,name:"initial_utm",kind:"message",T:Ic,opt:!0},{no:6,name:"initial_pageview_info",kind:"message",T:_c},{no:7,name:"properties",kind:"map",K:9,V:{kind:"message",T:vc}}]})));var Dc=function(e){p(n,e);var t=Nc(n);function n(e){var r;return u(this,n),a(f(r=t.call(this)),"attributes",{}),sc.util.initPartial(e,f(r)),r}return l(n,null,[{key:"fromBinary",value:function(e,t){return(new n).fromBinary(e,t)}},{key:"fromJson",value:function(e,t){return(new n).fromJson(e,t)}},{key:"fromJsonString",value:function(e,t){return(new n).fromJsonString(e,t)}},{key:"equals",value:function(e,t){return sc.util.equals(n,e,t)}}]),n}(As);a(Dc,"runtime",sc),a(Dc,"typeName","core_sdk.v1.ElementNode"),a(Dc,"fields",sc.util.newFieldList((function(){return[{no:1,name:"node_name",kind:"scalar",T:9,opt:!0},{no:2,name:"node_html_class",kind:"scalar",T:9,opt:!0},{no:3,name:"node_id",kind:"scalar",T:9,opt:!0},{no:4,name:"node_text",kind:"scalar",T:9,opt:!0},{no:5,name:"href",kind:"scalar",T:9,opt:!0},{no:6,name:"accessibility_label",kind:"scalar",T:9,opt:!0},{no:7,name:"referencing_property_name",kind:"scalar",T:9,opt:!0},{no:8,name:"attributes",kind:"map",K:9,V:{kind:"message",T:vc}}]})));var jc=function(e){p(n,e);var t=Nc(n);function n(e){var r;return u(this,n),a(f(r=t.call(this)),"kind",{case:void 0}),a(f(r),"nodes",[]),a(f(r),"sourceProperties",{}),sc.util.initPartial(e,f(r)),r}return l(n,null,[{key:"fromBinary",value:function(e,t){return(new n).fromBinary(e,t)}},{key:"fromJson",value:function(e,t){return(new n).fromJson(e,t)}},{key:"fromJsonString",value:function(e,t){return(new n).fromJsonString(e,t)}},{key:"equals",value:function(e,t){return sc.util.equals(n,e,t)}}]),n}(As);a(jc,"runtime",sc),a(jc,"typeName","core_sdk.v1.Interaction"),a(jc,"fields",sc.util.newFieldList((function(){return[{no:1,name:"callback_name",kind:"scalar",T:9,opt:!0},{no:2,name:"custom",kind:"scalar",T:9,oneof:"kind"},{no:3,name:"builtin",kind:"enum",T:sc.getEnumType(Mc),oneof:"kind"},{no:4,name:"hierarchy",kind:"scalar",T:9,opt:!0},{no:5,name:"nodes",kind:"message",T:Dc,repeated:!0},{no:6,name:"source_properties",kind:"map",K:9,V:{kind:"message",T:vc}}]})));var Mc=function(e){return e[e.UNSPECIFIED=0]="UNSPECIFIED",e[e.CLICK=1]="CLICK",e[e.TOUCH=2]="TOUCH",e[e.CHANGE=3]="CHANGE",e[e.SUBMIT=4]="SUBMIT",e}({});sc.util.setEnumType(Mc,"core_sdk.v1.Interaction.BuiltinKind",[{no:0,name:"BUILTIN_KIND_UNSPECIFIED"},{no:1,name:"BUILTIN_KIND_CLICK"},{no:2,name:"BUILTIN_KIND_TOUCH"},{no:3,name:"BUILTIN_KIND_CHANGE"},{no:4,name:"BUILTIN_KIND_SUBMIT"}]);var Uc=function(e){p(n,e);var t=Nc(n);function n(e){var r;return u(this,n),r=t.call(this),sc.util.initPartial(e,f(r)),r}return l(n,null,[{key:"fromBinary",value:function(e,t){return(new n).fromBinary(e,t)}},{key:"fromJson",value:function(e,t){return(new n).fromJson(e,t)}},{key:"fromJsonString",value:function(e,t){return(new n).fromJsonString(e,t)}},{key:"equals",value:function(e,t){return sc.util.equals(n,e,t)}}]),n}(As);a(Uc,"runtime",sc),a(Uc,"typeName","core_sdk.v1.VersionChange"),a(Uc,"fields",sc.util.newFieldList((function(){return[{no:1,name:"previous_version",kind:"message",T:gc,opt:!0},{no:2,name:"current_version",kind:"message",T:gc}]})));var Lc=function(e){p(n,e);var t=Nc(n);function n(e){var r;return u(this,n),a(f(r=t.call(this)),"invisibleToVisible",[]),a(f(r),"visibleToInvisible",[]),sc.util.initPartial(e,f(r)),r}return l(n,null,[{key:"fromBinary",value:function(e,t){return(new n).fromBinary(e,t)}},{key:"fromJson",value:function(e,t){return(new n).fromJson(e,t)}},{key:"fromJsonString",value:function(e,t){return(new n).fromJsonString(e,t)}},{key:"equals",value:function(e,t){return sc.util.equals(n,e,t)}}]),n}(As);a(Lc,"runtime",sc),a(Lc,"typeName","core_sdk.v1.ComponentTransition"),a(Lc,"fields",sc.util.newFieldList((function(){return[{no:1,name:"invisible_to_visible",kind:"message",T:Dc,repeated:!0},{no:2,name:"visible_to_invisible",kind:"message",T:Dc,repeated:!0}]})));var Fc=function(e){p(n,e);var t=Nc(n);function n(e){var r;return u(this,n),a(f(r=t.call(this)),"kind",{case:void 0}),sc.util.initPartial(e,f(r)),r}return l(n,null,[{key:"fromBinary",value:function(e,t){return(new n).fromBinary(e,t)}},{key:"fromJson",value:function(e,t){return(new n).fromJson(e,t)}},{key:"fromJsonString",value:function(e,t){return(new n).fromJsonString(e,t)}},{key:"equals",value:function(e,t){return sc.util.equals(n,e,t)}}]),n}(As);a(Fc,"runtime",sc),a(Fc,"typeName","core_sdk.v1.Event"),a(Fc,"fields",sc.util.newFieldList((function(){return[{no:1,name:"custom",kind:"message",T:Vc,oneof:"kind"},{no:2,name:"interaction",kind:"message",T:jc,oneof:"kind"},{no:3,name:"version_change",kind:"message",T:Uc,oneof:"kind"},{no:4,name:"component_transition",kind:"message",T:Lc,oneof:"kind"},{no:20,name:"app_visibility_state",kind:"enum",T:sc.getEnumType(zc),opt:!0}]})));var zc=function(e){return e[e.UNKNOWN_UNSPECIFIED=0]="UNKNOWN_UNSPECIFIED",e[e.BACKGROUNDED=1]="BACKGROUNDED",e[e.FOREGROUNDED=2]="FOREGROUNDED",e}({});sc.util.setEnumType(zc,"core_sdk.v1.Event.AppVisibility",[{no:0,name:"APP_VISIBILITY_UNKNOWN_UNSPECIFIED"},{no:1,name:"APP_VISIBILITY_BACKGROUNDED"},{no:2,name:"APP_VISIBILITY_FOREGROUNDED"}]);var Vc=function(e){p(n,e);var t=Nc(n);function n(e){var r;return u(this,n),a(f(r=t.call(this)),"name",""),a(f(r),"properties",{}),a(f(r),"sourceProperties",{}),sc.util.initPartial(e,f(r)),r}return l(n,null,[{key:"fromBinary",value:function(e,t){return(new n).fromBinary(e,t)}},{key:"fromJson",value:function(e,t){return(new n).fromJson(e,t)}},{key:"fromJsonString",value:function(e,t){return(new n).fromJsonString(e,t)}},{key:"equals",value:function(e,t){return sc.util.equals(n,e,t)}}]),n}(As);a(Vc,"runtime",sc),a(Vc,"typeName","core_sdk.v1.Event.Custom"),a(Vc,"fields",sc.util.newFieldList((function(){return[{no:1,name:"name",kind:"scalar",T:9},{no:2,name:"properties",kind:"map",K:9,V:{kind:"message",T:vc}},{no:3,name:"source_properties",kind:"map",K:9,V:{kind:"message",T:vc}}]})));var Jc=function(e){p(n,e);var t=Nc(n);function n(e){var r;return u(this,n),a(f(r=t.call(this)),"id",""),a(f(r),"envId",""),a(f(r),"userId",""),a(f(r),"identity",""),a(f(r),"properties",{}),a(f(r),"kind",{case:void 0}),a(f(r),"activeContexts",[]),sc.util.initPartial(e,f(r)),r}return l(n,null,[{key:"fromBinary",value:function(e,t){return(new n).fromBinary(e,t)}},{key:"fromJson",value:function(e,t){return(new n).fromJson(e,t)}},{key:"fromJsonString",value:function(e,t){return(new n).fromJsonString(e,t)}},{key:"equals",value:function(e,t){return sc.util.equals(n,e,t)}}]),n}(As);a(Jc,"runtime",sc),a(Jc,"typeName","core_sdk.v1.Message"),a(Jc,"fields",sc.util.newFieldList((function(){return[{no:1,name:"id",kind:"scalar",T:9},{no:2,name:"env_id",kind:"scalar",T:9},{no:3,name:"user_id",kind:"scalar",T:9},{no:19,name:"identity",kind:"scalar",T:9},{no:4,name:"time",kind:"message",T:lc},{no:5,name:"base_library",kind:"message",T:pc},{no:6,name:"source_library",kind:"message",T:pc,opt:!0},{no:7,name:"application",kind:"message",T:gc,opt:!0},{no:8,name:"device",kind:"message",T:yc},{no:9,name:"session_info",kind:"message",T:bc},{no:10,name:"pageview_info",kind:"message",T:_c,opt:!0},{no:11,name:"properties",kind:"map",K:9,V:{kind:"message",T:vc}},{no:12,name:"session",kind:"message",T:dc,oneof:"kind"},{no:13,name:"pageview",kind:"message",T:dc,oneof:"kind"},{no:14,name:"event",kind:"message",T:Fc,oneof:"kind"},{no:15,name:"user",kind:"message",T:Bc,oneof:"kind"},{no:16,name:"session_replay_info",kind:"message",T:xc,opt:!0},{no:17,name:"session_replay",kind:"scalar",T:9,opt:!0},{no:18,name:"active_contexts",kind:"message",T:Dc,repeated:!0},{no:20,name:"cs_properties",kind:"message",T:Rc}]})));var qc=function(e){p(n,e);var t=Nc(n);function n(e){var r;return u(this,n),a(f(r=t.call(this)),"events",[]),a(f(r),"ipOverride",""),a(f(r),"timeOverride",!1),sc.util.initPartial(e,f(r)),r}return l(n,null,[{key:"fromBinary",value:function(e,t){return(new n).fromBinary(e,t)}},{key:"fromJson",value:function(e,t){return(new n).fromJson(e,t)}},{key:"fromJsonString",value:function(e,t){return(new n).fromJsonString(e,t)}},{key:"equals",value:function(e,t){return sc.util.equals(n,e,t)}}]),n}(As);a(qc,"runtime",sc),a(qc,"typeName","core_sdk.v1.MessageBatch"),a(qc,"fields",sc.util.newFieldList((function(){return[{no:1,name:"events",kind:"message",T:Jc,repeated:!0},{no:2,name:"ip_override",kind:"scalar",T:9},{no:3,name:"time_override",kind:"scalar",T:8}]})));var Hc=function(e){p(n,e);var t=Nc(n);function n(e){var r;return u(this,n),r=t.call(this),sc.util.initPartial(e,f(r)),r}return l(n,null,[{key:"fromBinary",value:function(e,t){return(new n).fromBinary(e,t)}},{key:"fromJson",value:function(e,t){return(new n).fromJson(e,t)}},{key:"fromJsonString",value:function(e,t){return(new n).fromJsonString(e,t)}},{key:"equals",value:function(e,t){return sc.util.equals(n,e,t)}}]),n}(As);a(Hc,"runtime",sc),a(Hc,"typeName","core_sdk.v1.PostMobileTrackRequest"),a(Hc,"fields",sc.util.newFieldList((function(){return[{no:1,name:"message_batch",kind:"message",T:qc}]})));var Kc=function(e){p(n,e);var t=Nc(n);function n(e){var r;return u(this,n),a(f(r=t.call(this)),"status",""),sc.util.initPartial(e,f(r)),r}return l(n,null,[{key:"fromBinary",value:function(e,t){return(new n).fromBinary(e,t)}},{key:"fromJson",value:function(e,t){return(new n).fromJson(e,t)}},{key:"fromJsonString",value:function(e,t){return(new n).fromJsonString(e,t)}},{key:"equals",value:function(e,t){return sc.util.equals(n,e,t)}}]),n}(As);function Qc(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Zc(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Qc(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Qc(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}a(Kc,"runtime",sc),a(Kc,"typeName","core_sdk.v1.PostMobileTrackResponse"),a(Kc,"fields",sc.util.newFieldList((function(){return[{no:1,name:"status",kind:"scalar",T:9}]})));var Gc,Yc=function(e){return e[e.Track=0]="Track",e[e.Identify=1]="Identify",e[e.AUP=2]="AUP",e}({}),Wc=function(e){return e[e.Event=0]="Event",e[e.Meta=1]="Meta",e}({}),Xc=function(e){try{switch(e.type){case k.CORE_TRACK:return fl(e);case _.METADATA_SESSION:case _.METADATA_PAGEVIEW:return ul(e);case _.METADATA_USER:case k.CORE_ADD_USER_PROPERTIES:return ol(e);case k.CORE_IDENTIFY_v3:return sl(e);default:return O.error("Schematizers -- Found invalid message type"),null}}catch(t){return O.error("Schematizers -- Failed to verify message",e),null}},$c=function(e){if(void 0!==e){var t=Math.floor(e/1e3),n=1e6*(e-1e3*t);return new lc({seconds:Js.parse(t),nanos:n})}},el=function(e){if(null!=e)return Object.entries(e).reduce((function(e,t){var n=A(t,2),r=n[0],i=n[1];return e[r]=new vc({string:null==i?void 0:i.toString()}),e}),{})},tl=function(e){return new pc({name:null==e?void 0:e.name,version:null==e?void 0:e.version,platform:null==e?void 0:e.platform,properties:el(null==e?void 0:e.properties)})},nl=function(e){var t,n,r;return new yc({userAgent:null==e?void 0:e.user_agent,uach:new mc({browserVersion:null==e||null===(t=e.uach)||void 0===t?void 0:t.browser_version,platformVersion:null==e||null===(n=e.uach)||void 0===n?void 0:n.platform_version,model:null==e||null===(r=e.uach)||void 0===r?void 0:r.model})})},rl=function(e){return new _c(Zc(Zc({},e),{},{id:null==e?void 0:e.id,url:(t=null==e?void 0:e.url,t?new kc(t):void 0),previousPage:null==e?void 0:e.previous_page,time:$c(null==e?void 0:e.time),properties:el(null==e?void 0:e.properties),sourceProperties:el(null==e?void 0:e.source_properties)}));var t},il=function(e){return new bc(Zc(Zc({},e),{},{utm:new Ic(Zc({},null==e?void 0:e.utm)),time:$c(null==e?void 0:e.time),initialPageviewInfo:rl(null==e?void 0:e.initial_pageview_info)}))},al=function(e){return new Rc({csPid:null==e?void 0:e.cs_pid,csPvid:null==e?void 0:e.cs_pvid,csSn:null==e?void 0:e.cs_sn,csTs:null==e?void 0:e.cs_ts,csUu:null==e?void 0:e.cs_uu})},ol=function(e){var t=e.type,n=e.data;return{payload:new Ec(Zc({envId:n.env_id,userId:n.user_id,initialDevice:nl(n.device)},t===_.METADATA_USER?{library:tl(n.base_library),initialApplication:new gc(n.application),initialSessionInfo:il(n.user.initial_session_info),sessionReplay:n.session_replay}:{library:tl(n.library),properties:el(n.properties)})),type:Yc.AUP,timestamp:+new Date}},sl=function(e){var t=e.data;return{payload:new Pc({envId:t.env_id,userId:t.user_id,identity:t.identity,library:tl(t.library),time:$c(t.time)}),type:Yc.Identify,timestamp:+new Date}},ul=function(e){var t=e.data,n={id:t.id,envId:Is.getInstance().getEnvironmentId(),userId:t.user_id,identity:t.identity,time:$c(t.time),baseLibrary:tl(t.base_library),sessionInfo:il(t.session_info),application:new gc(Zc({},t.application)),device:nl(t.device),sessionReplay:t.session_replay,csProperties:al(t.cs_properties)};switch(e.type){case _.METADATA_PAGEVIEW:n.pageviewInfo=rl(t.pageview_info),n.kind={case:"pageview",value:new dc},n.properties=el(t.properties);break;case _.METADATA_SESSION:n.kind={case:"session",value:new dc}}return{payload:new Jc(n),type:Yc.Track,kind:Wc.Meta,timestamp:+new Date}},cl={BUILTIN_KIND_UNSPECIFIED:Mc.UNSPECIFIED,BUILTIN_KIND_CLICK:Mc.CLICK,BUILTIN_KIND_TOUCH:Mc.TOUCH,BUILTIN_KIND_CHANGE:Mc.CHANGE,BUILTIN_KIND_SUBMIT:Mc.SUBMIT},ll=function(e){return"interaction"in e?function(e){return new Fc({kind:{case:"interaction",value:new jc({kind:{case:"builtin",value:cl[e.interaction.kind]},hierarchy:e.interaction.hierarchy,nodes:(t=e.interaction.nodes,t.map((function(e){var t=function(e){return e.reduce((function(e,t){var n=t.name,r=t.value;return e[n]=r,e}),{})}(e.attributes);return{nodeName:e.tagName||"",nodeHtmlClass:e.classes?e.classes.join(" "):"",nodeId:e.id||"",nodeText:e.targetText||"",href:e.href||"",attributes:el(t)}}))),sourceProperties:el(e.interaction.source_properties)})}});var t}(e):function(e){return new Fc({kind:{case:"custom",value:new Vc({name:e.custom.name,properties:el(e.custom.properties),sourceProperties:el(e.custom.source_properties)})}})}(e)},fl=function(e){var t=e.data;return{payload:new Jc(Zc(Zc(Zc({id:t.id,envId:Is.getInstance().getEnvironmentId(),userId:t.user_id,identity:t.identity,time:$c(t.time),baseLibrary:tl(t.base_library)},t.source_library&&{sourceLibrary:tl(t.source_library)}),{},{application:Zc({},t.application),device:nl(t.device),sessionInfo:il(t.session_info),pageviewInfo:rl(t.pageview_info),sessionReplayInfo:t.session_replay_info,sessionReplay:t.session_replay,properties:el(t.properties)},t.event&&{kind:{case:"event",value:ll(t.event)}}),{},{csProperties:al(t.cs_properties)})),type:Yc.Track,kind:Wc.Event,timestamp:+new Date}},dl=function(e,t){return e<+new Date-1e3*t},hl=function(e){return null!==e&&(!(!e.payload.envId||!e.payload.userId)&&(e.type!==Yc.Track||!!(t=e.payload.sessionInfo)&&!!t.id&&!!t.time));var t},vl=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:2e6,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5e7,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new ve;u(this,e),this.maxLocalStorageBufferSize=t,this.maxOverflowBufferSize=n,this.storage=r;var i=Is.getInstance().getEnvironmentId();this.bufferKey="_hp5_network_buffer.".concat(i),this.overflowBuffer=[],this.storage.getItem(this.bufferKey)||(O.trace("MessageBatcherBuffer -- there are no queued items in the buffer, creating empty buffer"),this.storage.setItem(this.bufferKey,JSON.stringify([])))}return l(e,[{key:"addMessages",value:function(e){O.trace("MessageBatcherBuffer -- Adding events to buffer",e),this.appendBuffer(e)}},{key:"peakBuffer",value:function(e){return this.getFullBuffer().slice(0,e)}},{key:"commitPop",value:function(e){var t=this.getPrimaryBuffer().primaryBuffer,n=Math.min(this.overflowBuffer.length,e);this.overflowBuffer.splice(0,n);var r=e-n;t.splice(0,r),this.storage.setItem(this.bufferKey,JSON.stringify(t))}},{key:"getBufferSize",value:function(){var e=this.getPrimaryBuffer().primaryBuffer;return this.overflowBuffer.length+e.length}},{key:"getFullBuffer",value:function(){var e,t=JSON.parse(null!==(e=this.storage.getItem(this.bufferKey))&&void 0!==e?e:"[]"),n=[],r=t.map((function(e){try{if(dl(e.timestamp,R))throw new Error("Message is older than 7 days, discarding");switch(e.type){case Yc.Track:return{type:Yc.Track,payload:Jc.fromJson(e.payload),kind:e.kind,timestamp:e.timestamp};case Yc.AUP:return{type:Yc.AUP,payload:Ec.fromJson(e.payload),timestamp:e.timestamp};case Yc.Identify:return{type:Yc.Identify,payload:Pc.fromJson(e.payload),timestamp:e.timestamp};default:throw new Error("Unsupported message type")}}catch(t){return O.warn("MessageBatcherBuffer -- invalid message for network flush, removing from buffer",{message:e,error:t.message}),n.push(e),null}})).filter((function(e){return null!==e})),i=t.filter((function(e){return!n.includes(e)}));if(i.length!==t.length){O.warn("MessageBatcherBuffer -- failed to parse messages, removing from primary buffer");var a=JSON.stringify(i);this.storage.setItem(this.bufferKey,a)}return r.concat(this.overflowBuffer)}},{key:"getPrimaryBuffer",value:function(){var e,t,n=(null!==(e=this.storage.getItem(this.bufferKey))&&void 0!==e?e:"").length;return{primaryBuffer:JSON.parse(null!==(t=this.storage.getItem(this.bufferKey))&&void 0!==t?t:"[]"),primaryBufferSizeInBytes:n}}},{key:"appendOverflowBuffer",value:function(e,t){var n;t+JSON.stringify(this.overflowBuffer).length>this.maxOverflowBufferSize?O.warn("MessageBatcherBuffer -- overflow buffer is too large, dropping messages",e):(n=this.overflowBuffer).push.apply(n,w(e))}},{key:"appendBuffer",value:function(e){var t=this.getPrimaryBuffer(),n=t.primaryBuffer,r=t.primaryBufferSizeInBytes,i=JSON.stringify(e);if(r+i.length>this.maxLocalStorageBufferSize)O.trace("MessageBatcherBuffer -- using overflow buffer",e),this.appendOverflowBuffer(e,i.length);else{n.push.apply(n,w(e));var a=JSON.stringify(n);O.trace("MessageBatcherBuffer -- Saving primary buffer",a);try{this.storage.setItem(this.bufferKey,a)}catch(t){O.error("MessageBatcherBuffer -- Failed to save to primary buffer, using overflow buffer",{e:t}),this.appendOverflowBuffer(e,i.length)}}}}],[{key:"deleteQueue",value:function(){var e=Is.getInstance();(new ve).removeItem("_hp5_network_buffer.".concat(e.getEnvironmentId()))}}]),e}(),pl=vl,gl=function(e){var t=e.map((function(e){return new Jc(e.payload)}));return new qc({events:t}).toBinary()},ml=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:2e6,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new ve;u(this,e),this.maxLocalStorageBufferSize=t,this.storage=n;var r=Is.getInstance().getEnvironmentId();this.bufferKey="_hp5_retry_buffer.".concat(r),this.storage.getItem(this.bufferKey)||this.storage.setItem(this.bufferKey,JSON.stringify([]))}return l(e,[{key:"addMessages",value:function(e){var t=e.filter((function(e){return hl(e)}));O.debug("RetryMessageBuffer -- Adding events to buffer after failed retries",{before:e,after:t}),this.appendBuffer(t)}},{key:"commitPop",value:function(e){var t=this.getPrimaryBuffer().primaryBuffer,n=t.splice(0,e);O.trace("RetryMessageBuffer -- removing messages from the buffer",{removedMessages:n}),this.storage.setItem(this.bufferKey,JSON.stringify(t))}},{key:"peakBuffer",value:function(e){var t=this.getPrimaryBuffer().primaryBuffer,n=t.splice(0,e),r=[],i=n.map((function(e){try{switch(e.type){case Yc.Track:return{type:Yc.Track,payload:Jc.fromJson(e.payload),kind:e.kind,timestamp:e.timestamp};case Yc.AUP:return{type:Yc.AUP,payload:Ec.fromJson(e.payload),timestamp:e.timestamp};case Yc.Identify:return{type:Yc.Identify,payload:Pc.fromJson(e.payload),timestamp:e.timestamp};default:throw new Error("Unsupported message type")}}catch(t){return O.error("RetryMessageBatcher -- Failed to parse the following message for network flush, dropping the message",{message:e,error:t.message}),r.push(e),null}})).filter((function(e){return null!==e})),a=t.filter((function(e){return!r.includes(e)}));if(a.length!==t.length){O.trace("RetryMessageBatcher -- failed to parse messages, removing from primary buffer");var o=JSON.stringify(a);this.storage.setItem(this.bufferKey,o)}return i}},{key:"getBufferSize",value:function(){return this.getPrimaryBuffer().primaryBuffer.length}},{key:"getPrimaryBuffer",value:function(){var e,t,n=(null!==(e=this.storage.getItem(this.bufferKey))&&void 0!==e?e:"").length;return{primaryBuffer:JSON.parse(null!==(t=this.storage.getItem(this.bufferKey))&&void 0!==t?t:"[]"),primaryBufferSizeInBytes:n}}},{key:"appendBuffer",value:function(e){var t=this,n=this.getPrimaryBuffer(),r=n.primaryBuffer,i=n.primaryBufferSizeInBytes;e.forEach((function(e){var n=JSON.stringify(e),a=i+n.length;a>t.maxLocalStorageBufferSize?O.debug("RetryMessageBuffer -- capped out on failed messages, no longer adding"):(r.push(e),i=a)}));var a=JSON.stringify(r);O.trace("RetryMessageBuffer -- Saving primary buffer",a);try{this.storage.setItem(this.bufferKey,a)}catch(e){O.warn("RetryMessageBuffer -- Failed to save to primary buffer",{e:e})}}}],[{key:"deleteQueue",value:function(){var e=Is.getInstance();(new ve).removeItem("_hp5_retry_buffer.".concat(e.getEnvironmentId()))}}]),e}(),yl=ml,wl=function(){function e(t){var n=this,r=t.client,i=t.flushInterval,o=void 0===i?3e3:i,s=t.maxBufferSize,c=void 0===s?10:s,l=t.initialRetryDelay,f=void 0===l?2e3:l,d=t.maxRetryDelay,h=void 0===d?5e3:d,v=t.maxRetries,p=void 0===v?3:v,g=t.maxLifetimeOfRequestsInSeconds,m=void 0===g?R:g,y=t.maxBatchSize,w=void 0===y?10:y;u(this,e),a(this,"backlogFailedRequests",(function(e){var t=e.originalBufferedMessages.filter((function(e){return!dl(e.timestamp,n.maxLifetimeOfRequestsInSeconds)}));n.retryBuffer.addMessages(t)})),O.trace("Creating network."),e.instance=this,this.client=r,this.batchBuffer=new pl,this.retryBuffer=new yl,this.flushInterval=o,this.maxBufferSize=c,this.flushTimeout=null,this.maxRetryDelay=h,this.initialRetryDelay=f,this.maxRetries=p,this.maxLifetimeOfRequestsInSeconds=m,this.maxBatchSize=w,this.sendStatus={isSending:!1,numMessagesSending:null},this.flushRetryBuffer(),this.flushBufferOnInterval(),O.trace("Initialized network")}var r,i,o,c,f;return l(e,[{key:"getBufferSize",value:function(){return this.batchBuffer.getBufferSize()}},{key:"addMessages",value:function(e){var t=e.map(Xc).filter((function(e){return hl(e)}));O.trace("Network -- schematized messages",{before:e,after:t}),t.length>0&&this.batchBuffer.addMessages(t);var n=e.some((function(e){return e.type===_.METADATA_SESSION||e.type===_.METADATA_USER||e.type===_.METADATA_PAGEVIEW}));(this.batchBuffer.getBufferSize()>=this.maxBufferSize&&!this.sendStatus.isSending||n)&&this.flushBuffer()}},{key:"flushBuffer",value:(f=t(s().mark((function e(){var t,n;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,0!==this.batchBuffer.getBufferSize()&&!this.sendStatus.isSending){e.next=5;break}return this.flushBufferOnInterval(),e.abrupt("return");case 5:return this.sendStatus={isSending:!0,numMessagesSending:null},this.flushTimeout&&window.clearTimeout(this.flushTimeout),this.sendStatus.numMessagesSending=this.batchBuffer.getBufferSize(),t=this.batchBuffer.peakBuffer(this.sendStatus.numMessagesSending),O.trace("Network -- flushing buffer",t),n=this.formRequests(t),e.next=13,this.retryAllRequestsUntilSuccess(n);case 13:this.batchBuffer.commitPop(this.sendStatus.numMessagesSending),this.sendStatus={isSending:!1,numMessagesSending:null},O.trace("Network -- removing ".concat(this.sendStatus.numMessagesSending," messages, ").concat(this.batchBuffer.getBufferSize()," messages remaining")),e.next=21;break;case 18:e.prev=18,e.t0=e.catch(0),O.error("Network -- error flushing buffer",{exception:e.t0});case 21:return e.prev=21,this.flushBufferOnInterval(),e.finish(21);case 24:case"end":return e.stop()}}),e,this,[[0,18,21,24]])}))),function(){return f.apply(this,arguments)})},{key:"flushRetryBuffer",value:(c=t(s().mark((function e(){var t,n,r,i=this;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,0!==(t=this.retryBuffer.getBufferSize())){e.next=4;break}return e.abrupt("return");case 4:return n=this.retryBuffer.peakBuffer(t),O.debug("Network -- flushing retry buffer on initial page load",n),r=this.formRequests(n),e.next=9,Promise.all(r.map((function(e){return i.sendSingleRequestWithBackoff(e,i.initialRetryDelay,Number.MAX_VALUE)})));case 9:O.trace("Network -- successfully flushed "),this.retryBuffer.commitPop(t),e.next=16;break;case 13:e.prev=13,e.t0=e.catch(0),O.error("Network -- error flushing retry buffer, discarding messages",{exception:e.t0});case 16:case"end":return e.stop()}}),e,this,[[0,13]])}))),function(){return c.apply(this,arguments)})},{key:"flushBufferOnUnload",value:function(){try{var e=this.batchBuffer.getBufferSize();if(0===e)return void O.trace("Network -- no messages to flush on unload");var t=this.batchBuffer.peakBuffer(e);this.formRequests(t).map((function(e){return(0,e.sendFunction)(e.payload,!0)})),O.debug("Network -- attempted to send requests on unload")}catch(e){O.warn("Network -- error flushing buffer on unload",{exception:e})}}},{key:"retryAllRequestsUntilSuccess",value:(o=t(s().mark((function e(t){var n=this;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all(t.map((function(e){return n.sendSingleRequestWithBackoff(e,n.initialRetryDelay,0)})));case 2:case"end":return e.stop()}}),e)}))),function(e){return o.apply(this,arguments)})},{key:"sendSingleRequestWithBackoff",value:(i=t(s().mark((function e(t,n,r){var i;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.sendSingleRequest(t);case 3:e.next=15;break;case 5:if(e.prev=5,e.t0=e.catch(0),!(r>=this.maxRetries)){e.next=10;break}return this.backlogFailedRequests(t),e.abrupt("return");case 10:return e.next=12,new Promise((function(e){return window.setTimeout(e,n)}));case 12:return i=Math.min(Math.pow(n,2),this.maxRetryDelay),O.error("Network -- Retrying request",{exception:e.t0}),e.abrupt("return",this.sendSingleRequestWithBackoff(t,i,r+1));case 15:case"end":return e.stop()}}),e,this,[[0,5]])}))),function(e,t,n){return i.apply(this,arguments)})},{key:"sendSingleRequest",value:(r=t(s().mark((function e(t){var n,r,i,a,o;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.payload,r=t.sendFunction,e.next=3,r(n);case 3:if(i=e.sent,a=i.ok,o=i.statusCode,a){e.next=8;break}throw new Error("Request failed with status code ".concat(o));case 8:case"end":return e.stop()}}),e)}))),function(e){return r.apply(this,arguments)})},{key:"formRequests",value:function(t){var n,r=this,i=e.groupByMessageType(t);O.info("Network -- Messages being sent to server",t);var o=function(e,t){return e.reduce((function(e,n,r){var i=Math.floor(r/t);return e[i]||(e[i]=[]),e[i].push(n),e}),[])}(i[Yc.Track],this.maxBatchSize),s=(a(n={},Yc.Track,o.map((function(e){return{payload:gl(e),sendFunction:r.client.sendEvent,originalBufferedMessages:e}}))),a(n,Yc.AUP,i[Yc.AUP].map((function(e){return{payload:(t=e,n=t.payload,new Ec(n).toBinary()),sendFunction:r.client.sendAUP,originalBufferedMessages:[e]};var t,n}))),a(n,Yc.Identify,i[Yc.Identify].map((function(e){return{payload:(t=e,n=t.payload,new Pc(n).toBinary()),sendFunction:r.client.sendIdentify,originalBufferedMessages:[e]};var t,n}))),n),u=[].concat(w(s[Yc.AUP]),w(s[Yc.Track]),w(s[Yc.Identify]));return O.trace("Network -- Formed requests",u),u}},{key:"flushBufferOnInterval",value:function(){var e=this;this.flushTimeout&&window.clearTimeout(this.flushTimeout),He.getInstance().getShouldStopTracking()||(this.flushTimeout=n.g.setTimeout(t(s().mark((function t(){return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.flushBuffer();case 2:case"end":return t.stop()}}),t)}))),this.flushInterval))}}],[{key:"getInstance",value:function(t){if(!t&&!e.instance)throw new Error("Network instance not initialized");return e.instance?e.instance:new e(t)}},{key:"groupByMessageType",value:function(e){var t;return e.reduce((function(e,t){var n=t.type;return e[n]||(e[n]=[]),e[n].push(t),e}),(a(t={},Yc.Track,[]),a(t,Yc.AUP,[]),a(t,Yc.Identify,[]),t))}}]),e}(),bl=wl,_l=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:20;return Os.getInstance().getMessagesToProcess(e)},kl=function(){return Os.getInstance().getAndClearAllMessages()},Il=function(e,t){if(e&&e.length){O.debug("Queue - enqueueing messages for networking and dequeueing from event processing after transformation",e);var n=bl.getInstance();Os.getInstance().dequeueMessages(e),n.addMessages(e),t&&t(e)}},Sl=function(){Os.getInstance().clearBuffer()},El=function(e){return Array.from(new Uint8Array(e)).map((function(e){return e.toString(16).padStart(2,"0")})).join("")},Tl=function(){var e=t(s().mark((function e(t,n){return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=El,e.next=3,crypto.subtle.digest(t,n);case 3:return e.t1=e.sent,e.abrupt("return",(0,e.t0)(e.t1));case 5:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),Ol=["undefined","anonymous","true","false","not_authenticated","NaN","NA","Na","unique_identifier","0","",'""',"[object Object]","{{ customer.email }}","{{ email }}",/^email$/i,/^none$/i,/^unknown$/i,/^guest$/i,/^null$/i],Al=function(e){return!(!e||!M(e)&&!U(e)||U(e)&&!isFinite(e)||function(e){for(var t=0,n=Ol;t<n.length;t++){var r=n[t];if("string"==typeof r&&e===r)return!0;if(r instanceof RegExp&&r.test(e))return!0}return!1}("".concat(e)))},Pl=function(){var e=t(s().mark((function e(t){var n;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Tl("SHA-256",(new TextEncoder).encode("".concat(t)));case 2:return n=e.sent,e.abrupt("return",n);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Nl=function(e,t){return"heap_autotrack"===e&&!M(t)&&"autotrack"===(null==t?void 0:t.name)},Rl=function(e,t,n){return!!Nl(e,n)||!(e&&!function(e){return!(!M(e)||!V(e,C))}(e)||t&&!function(e){return!!F(e)}(t)||n&&!function(e){return M(e)?!!V(e,C):!(!M(e.name)||!V(e.name,C)||e.version&&!M(e.version)||e.version&&!V(e.version,C)||e.platform&&!M(e.platform)||e.platform&&!V(e.platform,C))}(n))},xl=(a(Gc={},Yc.Identify,"/api/capture/v2/identify"),a(Gc,Yc.Track,"/api/capture/v2/track"),a(Gc,Yc.AUP,"/api/capture/v2/add_user_properties"),Gc),Cl=function(){function e(n){var r=this;u(this,e),a(this,"sendEvent",(function(e,t){return r.sendRequest(e,r.fullUrlPath(xl[Yc.Track]),t)})),a(this,"sendAUP",(function(e,t){return r.sendRequest(e,r.fullUrlPath(xl[Yc.AUP]),t)})),a(this,"sendIdentify",(function(e,t){return r.sendRequest(e,r.fullUrlPath(xl[Yc.Identify]),t)})),a(this,"sendRequest",function(){var e=t(s().mark((function e(t,n,r){var i,a,o;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(O.trace("CollectorNetworkClient -- Attempting send to ".concat(n)),e.prev=1,!r){e.next=6;break}return fetch(n,{method:"POST",headers:{"Content-Type":"application/octet-stream"},body:t}),O.debug("CollectorNetworkClient -- Fired off a request before unload",{payload:t}),e.abrupt("return",{ok:!1,statusCode:null});case 6:return e.next=8,fetch(n,{method:"POST",headers:{"Content-Type":"application/octet-stream"},body:t});case 8:return i=e.sent,a=i.ok,400===i.status&&(O.warn("CollectorNetworkClient -- Bad request to ".concat(n),{payload:t}),a=!0),o={ok:a,statusCode:i.status},O.trace("CollectorNetworkClient -- Response for send to ".concat(n),o),e.abrupt("return",o);case 16:return e.prev=16,e.t0=e.catch(1),e.abrupt("return",{ok:!1,statusCode:null});case 19:case"end":return e.stop()}}),e,null,[[1,16]])})));return function(t,n,r){return e.apply(this,arguments)}}()),this.apiUrl=n}return l(e,[{key:"fullUrlPath",value:function(e){return"".concat(this.apiUrl).concat(e)}}]),e}(),Bl=Cl,Dl=function(e,t){O.debug("enqueueing Heap API call because heap is not loaded");var n={name:e,fn:t};oa.getInstance().enqueueHeapApi(n)},jl=function(e,t){O.debug("enqueueing onReady callback because heap is not loaded");var n={name:e,fn:t};oa.getInstance().enqueueOnReady(n)},Ml=function(){var e;!function(){var e=He.getInstance(),t=e.getIntegrations(),n=e.isSessionReplayDisabled();if(t&&0!==t.length){O.trace("Integrations -- loading");var r=Zi.getInstance().dependencies;t.forEach((function(e){try{if(n&&qi.includes(e.name))return void O.trace("Integrations -- Skipping session replay adapter: ",{integration:e.name});e.fn(r),O.trace("Integrations -- executed ".concat(e.name))}catch(t){O.trace("Integrations -- Error executing ".concat(e.name))}}))}}(),(e=Zi.getInstance()).getAdaptersToRerunOnNewPageview().forEach((function(t){try{t.adapterFn(e.dependencies),O.trace("Adapters -- executed ".concat(t.name))}catch(e){O.trace("Adapters -- Error executing ".concat(t.name))}}))};function Ul(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ll(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ul(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ul(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Fl=function(){Lf.loaded&&fs()},zl=function(){Is.getInstance().createNewSessionIfNeeded()},Vl=function(){var e,t,n,r,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=Is.getInstance();a.clearPageviewMetadata(),Ml(),a.createNewPageviewIfNeeded({pageviewInfo:i}),t=null==i||null===(e=i.url)||void 0===e?void 0:e.path,ie()&&(O.debug("Contentsquare -- tracking cs pageview"),null===(n=window._uxa)||void 0===n||null===(r=n.push)||void 0===r||r.call(n,["trackPageview",t].filter(Boolean)))},Jl=function(){var e=Is.getInstance();return Ll({envId:e.getEnvironmentId()},e.getMetadata())},ql=function(){Lf.loaded&&(Gi.getInstance().setShouldIgnoreBlockingTransformers(!0),Fl(),Yl(!0))},Hl=function(e){if(Lf.loaded){var t=Is.getInstance();t.getMetadata().lastEventTime+D<(new Date).getTime()?O.trace("updateLastEventTime -- session expired, ignoring"):t.updateLastEventTime(e)}},Kl=function(e){var t=Is.getInstance(),n=Q(e);n&&t.addCustomPageviewProperties(n)},Ql=function(e){var t=Is.getInstance(),n=t.getMetadata();t.setMetadata(Ll(Ll({},n),{},{sessionProperties:Ll(Ll({},n.sessionProperties),{},{referrer:e})}))},Zl=!1,Gl=function(){var e=function(){Lf.loaded&&!Zl&&(O.debug("Unload -- processing all messages in event processing queue"),ql())};document.addEventListener("beforeunload",e,!0),document.addEventListener("visibilitychange",e,!0),document.addEventListener("pagehide",e,!0)},Yl=function(e){var t=bl.getInstance();if(O.trace("flushNetworkQueue -- number of buffered network events is ".concat(t.getBufferSize())),t.flushBufferOnUnload(),e&&(Zl=!0,t.getBufferSize())){var n=(new Date).getTime(),r=n;do{r=(new Date).getTime()}while(r<n+60)}};function Wl(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Xl(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Wl(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Wl(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var $l=function(e){try{var t=new URL(e);return{domain:t.hostname,path:t.pathname,query:he(t.search),hash:he(t.hash)}}catch(t){return void O.warn("Error parsing URL ".concat(e,":"),t)}},ef="_cs_optout",tf=function(){return(new Ei).getItem(ef)?(O.debug("".concat(ef," was found in cookies")),!0):new URLSearchParams(window.location.search).has(ef)?(O.debug("".concat(ef," was found in query")),!0):!!window.location.hash.includes(ef)&&(O.debug("".concat(ef," was found in hash")),!0)},nf=function(e){return e?e.replace(/[[\];|\n]/g,""):e},rf=function(e,t){return e.map((function(e){return{name:nf(e.name),value:e.value&&e.value.length<=t?nf(e.value):""}}))};function af(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return of(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return of(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}function of(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var sf=function(e,t){if(!ao(e)||(n=t,"[object Number]"!==Object.prototype.toString.call(n)))return e;var n,r,i="",a=0,o=af(e);try{for(o.s();!(r=o.n()).done;){var s=r.value,u=s.codePointAt(0),c=u&&u>65535?2:1;if(!(a+c<=t))break;i+=s,a+=c}}catch(e){o.e(e)}finally{o.f()}return i},uf=function(e,t){if(ff(e)||ue()&&function(e){var t;return null===(t=window.UXAnalytics)||void 0===t?void 0:t.Sensitive.isNodeSensitive(e)}(e))return Io;var n=yo(e),r=cf(e),i=lf(r);return df(n,i,t)},cf=function(e){var t=So.map((function(e){return"[".concat(e,"]")})),n=Array.prototype.slice.call(e.querySelectorAll(t.join(","))),r=Eo.map((function(e){return"[".concat(e,"]")})),i=Array.prototype.slice.call(e.querySelectorAll(r.join(",")));return n.concat(i)},lf=function(e){return e.map(yo)},ff=function(e){return!!mo(e,(function(e){return Eo.some((function(t){return e.hasAttribute(t)}))}))},df=function(e,t,n){var r=function(e){return e.sort((function(e,t){return e.length>=t.length?-1:1}))}(t.map((function(e){return e.trim()}))),i=e;if(r.forEach((function(e){var t;e&&(i=(t={originalText:i,substringToReplace:e,replacementText:Io}).originalText.replace(new RegExp(t.substringToReplace.replace(/[.*+\-?^${}()|[\]\\]/g,"\\$&"),"g"),t.replacementText))})),ue()){var a=new te,o=a.anonymizePII(i);i=a.anonymizeCreditCard(o)}return i=function(e,t){return ao(e)?e=sf(e.trim(),t):e}(i,n),i},hf=function(e,t){return e.findIndex((function(e){return e.name===t}))};function vf(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return pf(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return pf(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}function pf(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var gf=function(e){var t;return e.length>1?(null===(t=Ni.getInstance().coreAPIs)||void 0===t||t.logger.trace("Autocapture -- removing BODY node"),e.filter((function(e){return"body"!==e.tagName.toLowerCase()}))):e},mf=function(e,t,n){var r=gf(e);if(0===r.length)return r;var i=function(e){for(var t=-1,n=-1,r=0;r<e.length;r++){var i=e[r],a=hf(i.attributes,"href")>-1;if(-1===t&&a&&(t=r),(n=i.heapRedactedAttributes.indexOf("href")>-1?r:-1)>-1)break}return function(){if(-1!==t){if(n>=t)return Io;var r=e[t].attributes;return r[hf(r,"href")].value}}()}(r);r[0].href=sf(i,ko);var a=function(e,t){var n,r,i=e,a=null===(n=Ni.getInstance().coreAPIs)||void 0===n?void 0:n.getConfig();return!(null!=a&&null!==(r=a.privacy)&&void 0!==r&&r.disableTextCapture)&&"change"!==t&&!i.isContentEditable&&"textarea"!==i.tagName.toLowerCase()&&ao(yo(i))}(t,n);return r[0].targetText=a?uf(t,64):"",r},yf=function(e){for(var t,n=e.maxAttributeLength,r=e.targetElement,i=[];r&&"HTML"!==r.tagName;){var a=oo(t=r)||so(t)?Ao(r,n):[],o=wf(r),s=bf(r),u=No(r);if(ue()){var c,l=null!==(c=Ro(r))&&void 0!==c?c:[];u=[].concat(w(u),w(l))}var f={tagName:r.tagName.toLowerCase(),id:nf(o),classes:s.map(nf),attributes:rf(a,n),heapRedactedAttributes:u};i.push(f),r=io(r.parentNode)?r.parentNode.host:r.parentElement}return i.reverse()},wf=function(e){return If(e,"id")||null},bf=function(e){return kf(e)?kf(e).split(/\s+/):[]},_f=function(e){var t,n=e.topFirstDecomposedHierarchy,r=e.maxHierarchyLength,i="",a=vf(gf(n).reverse());try{for(a.s();!(t=a.n()).done;){var o=t.value,s="";s="@".concat(o.tagName,";"),s+=o.id?"#".concat(o.id,";"):"",s+=o.classes.length>0?".".concat(o.classes.sort().join(";."),";"):"";var u=o.attributes.map((function(e){return"[".concat(e.name,"=").concat(e.value,"]")})).sort();if(s+=u.length>0?"".concat(u.join(";"),";"):"",(s+="|").length+i.length>r){var c;null===(c=Ni.getInstance().coreAPIs)||void 0===c||c.logger.debug("Autocapture -- truncating hierarchy string as it exceeds ".concat(r));break}i=s+i}}catch(e){a.e(e)}finally{a.f()}return i},kf=function(e){return((so(e)?e.className?e.className.baseVal:e.getAttribute("class"):e.className)||"").trim()},If=function(e,t){return"form"===e.tagName.toLowerCase()?e.getAttribute(t)||"":e[t]},Sf=function(e){return e.BUILTIN_KIND_CLICK="BUILTIN_KIND_CLICK",e.BUILTIN_KIND_CHANGE="BUILTIN_KIND_CHANGE",e.BUILTIN_KIND_SUBMIT="BUILTIN_KIND_SUBMIT",e}({}),Ef=function(){function e(){u(this,e),a(this,"eventHistory",[]),a(this,"clickEventHistory",[])}return l(e,[{key:"addClickEvent",value:function(t){e.isClickEvent(t)&&(this.clickEventHistory.length>e.MAX_CLICK_HISTORY_SIZE&&this.clickEventHistory.shift(),this.clickEventHistory.push({coordinates:{X:t.clientX,Y:t.clientY},time:t.timeStamp}))}},{key:"addEvent",value:function(t){this.eventHistory.length>e.MAX_HISTORY_SIZE&&this.eventHistory.shift(),this.eventHistory.push(t),this.addClickEvent(t)}},{key:"hasMatchingEvent",value:function(e){return this.eventHistory.includes(e)}}],[{key:"getInstance",value:function(){return e.instance||(e.instance=new e),e.instance}},{key:"resetEventHistory",value:function(){e.instance=new e}},{key:"isClickEvent",value:function(e){return e instanceof MouseEvent}}]),e}();a(Ef,"MAX_HISTORY_SIZE",20),a(Ef,"MAX_CLICK_HISTORY_SIZE",5);var Tf=function(){var e=Ef.getInstance().clickEventHistory,t=e[e.length-1],n=e[0];return!(t.time-n.time>3e3)},Of=function(){for(var e=Ef.getInstance().clickEventHistory,t=0,n=0;n<e.length-1;n++)for(var r=n+1;r<=e.length-1;r++){var i=Math.round(Math.sqrt(Math.pow(e[n].coordinates.X-e[r].coordinates.X,2)+Math.pow(e[n].coordinates.Y-e[r].coordinates.Y,2)));if(i>t&&(t=i),i>100)return!1}return!0},Af=function(e){var t=Ef.getInstance().clickEventHistory;return!!(Ef.isClickEvent(e)&&t.length>=5)&&(Tf()&&Of())},Pf=function(e){return{click:Sf.BUILTIN_KIND_CLICK,change:Sf.BUILTIN_KIND_CHANGE,submit:Sf.BUILTIN_KIND_SUBMIT}[e]},Nf=function(e){var t={};return Af(e)&&(t.rage_click=!0),t},Rf=function(e){var t,n,r=ro(e),i="mouseup"===e.type?"click":e.type,a=function(e){var t=e.targetElement,n=e.type,r=e.maxAttributeLength,i=e.maxHierarchyLength,a=yf({targetElement:t,maxAttributeLength:r}),o=JSON.parse(JSON.stringify(a)),s=xo(a),u=_f({topFirstDecomposedHierarchy:s,maxHierarchyLength:i}),c=mf(o.reverse(),t,n);return{hierarchyString:u,topFirstNodes:xo(c.reverse())}}({targetElement:r,type:i,maxAttributeLength:255,maxHierarchyLength:ko}),o=a.hierarchyString,s=a.topFirstNodes,u=null===(t=Ni.getInstance().coreAPIs)||void 0===t?void 0:t.getSnapshotDefinitions(i,o),c=null===(n=Ni.getInstance().coreAPIs)||void 0===n?void 0:n.getSnapshotProperties(u,e),l=function(e,t){if(JSON.stringify(e).length<=t)return e;for(var n=[],r="",i=0;i<e.length;i++){var a=e[i],o=JSON.stringify(a);if(r.length+o.length>t)break;n.push(a),r+=o}return n}(s.reverse(),2048);return{kind:Pf(i),hierarchy:o,nodes:l,source_properties:Nf(e),snapshotProperties:c}},xf=function(e){var t,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=null===(t=Ni.getInstance().coreAPIs)||void 0===t?void 0:t.logger,i=e.target;if(("mousedown"===e.type||"mousemove"===e.type)&&!n)return!0;if(!i)return null==r||r.trace("Autocapture -- event missing a target, ignoring",{event:e}),!0;if(!i.tagName)return null==r||r.trace("Autocapture -- event target is missing a tagName, ignoring",{event:e}),!0;if(3===i.nodeType)return null==r||r.trace("Autocapture -- event target is a text node, ignoring",{event:e}),!0;var a,o,s;return ue()&&((a=i).firstChild&&(null===(o=window.UXAnalytics)||void 0===o||null===(s=o.Encryption)||void 0===s?void 0:s.shouldEncrypt(a.firstChild)))?(null==r||r.trace("Autocapture -- event target is encrypted, ignoring",{event:e}),!0):!!mo(i,(function(e){return So.some((function(t){return e.hasAttribute(t)}))}))&&(null==r||r.trace("Autocapture -- event is under an ignored attribute element, ignoring",{event:e}),!0)},Cf=function(e){var t,n,r=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=null===(t=Ni.getInstance().coreAPIs)||void 0===t?void 0:t.logger;if(!xf(e,r)){var a=Ef.getInstance();if(a.hasMatchingEvent(e)){var o;null==i||null===(o=i.trace)||void 0===o||o.call(i,"".concat(e.type," event has already been seen, ignoring"),{event:e,clickEventHistory:a.eventHistory})}else{a.addEvent(e);var s,u=Rf(e);if(r)return null===(s=Ni.getInstance().coreAPIs)||void 0===s?void 0:s.track(e.type,u);u.hierarchy||u.nodes&&0!==u.nodes.length?(null===(n=Ni.getInstance().coreAPIs)||void 0===n||n.logger.trace("Autocapture -- queuing event",{event:e,props:u}),function(e){var t;null===(t=Ni.getInstance().coreAPIs)||void 0===t||t.track("heap_autotrack",e,{name:"autotrack"})}(u)):null==i||i.debug("Autocapture -- discarding event, missing hierarchy",{event:e,props:u})}}},Bf=function(e){Cf(e,!0)};function Df(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function jf(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Df(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Df(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Mf,Uf={addAdapter:function(e,t){!function(e){return!!e&&!(!M(e.name)||!z(e.fn))}(e)?O.warn("addAdapter called with an invalid adapter",{adapter:e}):!t||F(t)?(O.trace("Adding adapter to registry",{adapter:e,config:t}),Zi.getInstance().registerAdapter(e,t)):O.warn("addAdapter called with an invalid configuration",{config:t})},markAdapterAsResolved:function(e){e&&M(e)?Zi.getInstance().markAdapterAsResolved(e):O.warn("markAdapterAsResolved called with an invalid adapterName",{adapterName:e})},addTransformer:function(e,t){!function(e){return!!e&&!!(M(e.name)&&z(e.getTarget)&&z(e.transform)&&z(e.transformFn))}(e)?O.warn("addTransformer called with an invalid transformer",{transformer:e}):!t||[ta.GENERAL,ta.METADATA].includes(t)?(O.trace("Adding transformer to registry",{transformer:e,pipelineName:t}),La.getInstance().registerTransformer(e,t)):O.warn("addTransformer called with an invalid pipeline, can only be general or metadata",{pipelineName:t})},addTransformerFn:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:ta.GENERAL,r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];e&&t&&M(e)&&z(t)?!n||[ta.GENERAL,ta.METADATA].includes(n)?(O.trace("Adding transformer function to registry",{name:e,transformerFn:t,pipelineName:n}),r?La.getInstance().registerTransformerFnAsync(e,t,n):La.getInstance().registerTransformerFn(e,t,n)):O.warn("addTransformerFn called with an invalid pipeline, can only be general or metadata",{pipelineName:n}):O.warn("Transformer function must have a valid name and a function",{name:e,transformerFn:t})},removeTransformer:function(e){e&&M(e)?La.getInstance().removeTransformer(e):O.warn("removeTransformer called with an invalid transformer name",{transformerName:e})},resetTransformers:function(){La.getInstance().resetTransformers()},addNetworkClient:function(e){}},Lf=jf(jf({appid:"",loaded:!1,config:{}},Uf),{},{init:function(e,t,n){try{if(Lf.loaded)return void O.debug("heap.init was called multiple times. duplicate calls will have no effect");var r=O.getLogLevelFromStorage(e);if(r?O.setLogLevel(r):null!=t&&t.logLevel&&O.setLogLevel(t.logLevel),O.trace("Initializing heap"),!e||!M(e))return void O.error("heap.init was called with an invalid environment ID: ".concat(e));var i=He.getInstance();i.setConfig(i.resolveConfig(t,n));var a=Is.getInstance();a.setEnvironmentId(e);var o=oa.getInstance();if(o.executeStopTrackingAndStopRecording(),He.getInstance().getShouldStopTracking())return void O.warn("Heap has been disabled for this client, preventing initialization");if(tf())return void O.debug("Terminating heap initialization");Lf.loaded=!0,Lf.appid=e,Lf.config=i.getConfig(),function(){O.trace("Initializing Network");var e,t=He.getInstance().getIngestServer(),n=new Bl((e=t).startsWith("http://")||e.startsWith("https://")?e:"https://".concat(e));new bl({client:n})}(),vs(),Ie(),function(){var e=Is.getInstance(),t=e.getEnvironmentId(),n=He.getInstance().getMetadataStorageType()===I.COOKIES?I.LOCAL_STORAGE:I.COOKIES,r=new Is(t,n),i=e.getMetadata(),a=r.getMetadata(),o=i.lastEventTime,s=a.lastEventTime;o&&s?s>o&&e.setMetadata(a):s&&e.setMetadata(a),r.deleteMetadata()}(),s=Oe.getInstance(),u=He.getInstance().getEventPropertiesStorageType()===I.COOKIES?I.LOCAL_STORAGE:I.COOKIES,c=new Oe(u),l=s.getProperties(),f=Xl(Xl({},c.getProperties()),l),s.addProperties(f),c.clearProperties(!1),o.executeHeapApiQueue(),a.setMetadataStateFromCrossDomainContextIfPresent(),a.setMetadataStateFromWebviewIfPresent(),a.createNewUserIfNeeded(),a.createNewSessionIfNeeded(),a.createNewPageviewIfNeeded(),Zi.getInstance().initializeAdapters({getSnapshotProperties:Vo,getSnapshotDefinitions:Lo,track:Lf.track,logger:O,getConfig:Lf.getConfig,getSessionMetadata:Jl,createNewSessionIfNeeded:zl,createNewPageview:Vl,flushQueueOnUnload:ql,flushEventQueue:Fl,addTransformerFn:Uf.addTransformerFn,addPageviewProperties:Kl,setReferrer:Ql,updateLastEventTime:Hl,onReady:Lf.onReady,queueCustomEvent:Bf}),O.debug("Heap initialization is complete"),Gl()}catch(e){Lf.loaded=!1,O.error("Failed to initialize heap",e)}var s,u,c,l,f},startRecording:function(e,t){},stopRecording:function(){},stopTracking:function(e){O.debug("heap.stopTracking was called"),Lf.loaded=!1,He.getInstance().setShouldStopTracking(!0),n.g.clearInterval(cs),e&&(O.debug("heap.stopTracking -- clearing state"),Is.getInstance().clearMetadata(),Oe.getInstance().clearProperties(),pl.deleteQueue(),yl.deleteQueue(),Se.deleteV4Cookies())},track:function(e,t,n){if(Rl(e,t,n))if(Lf.loaded){var r=N(),i=M(n)?{name:n,version:"0.0.0",platform:"web"}:n;!function(e){e&&e.length&&(O.debug("".concat(Ss.EVENT_PROCESSING_QUEUE," - enqueueing messages from adapters to EPQ"),e),Os.getInstance().enqueueMessages(e))}([{id:r,type:k.CORE_TRACK,info:{event:e,properties:t,source:i,isAutotrack:Nl(e,i)},data:{id:r,time:(new Date).getTime()}}])}else Dl("track",(function(){Lf.track(e,t,n)}));else O.debug("heap.track was called with bad arguments.",{event:e,properties:t,sourceInfo:n})},trackPageview:function(e){if(Lf.loaded){fs();var t=function(e){if(e){var t,n,r,i,a;e.url&&M(e.url)&&(t=$l(e.url)),e.properties&&(n=Q(e.properties)),e.source_properties&&(r=Q(e.source_properties)),e.previous_page&&M(e.previous_page)&&(i=e.previous_page),e.title&&(a=K(e.title,x));var o=Z({title:a,url:t,source_properties:r,properties:n,previous_page:i});return O.info("Validating pageview properties -- ",{before:e,after:o}),o}}(e);Vl(t)}else Dl("trackPageview",(function(){Lf.trackPageview(e)}))},identify:function(e){if(!sa())if(Al(e))if(O.debug("heap.identify was called with",{identity:e}),Lf.loaded){var t=Is.getInstance(),n=t.getIdentity(),r=K("".concat(e),x);n!==r&&n?(fs(),O.trace("Clearing current identity ".concat(n," and creating a new user")),t.clearMetadata(),t.createNewUserIfNeeded({identity:r,heapDrives:!0})):(t.createNewSessionIfNeeded({heapDrives:!0}),la.getInstance().queueIdentityEvent(r))}else jl("identify",(function(){Lf.identify(e)}));else O.warn("heap.identify was called with a bad identity",{identity:e})},identifyHashed:(Mf=t(s().mark((function e(t){var n;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Al(t)){e.next=3;break}return O.warn("heap.identifyHashed was called with a bad identity",{identity:t}),e.abrupt("return");case 3:return e.prev=3,e.next=6,Pl(t);case 6:n=e.sent,Lf.identify(n),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(3),O.error("heap.identifyHashed -- error hashing identity",{e:e.t0});case 13:case"end":return e.stop()}}),e,null,[[3,10]])}))),function(e){return Mf.apply(this,arguments)}),resetIdentity:function(){if(!sa())if(Lf.loaded){var e=Is.getInstance(),t=e.getIdentity();t?(fs(),O.trace("Clearing current identity ".concat(t," and creating a new user")),e.clearMetadata(),e.createNewUserIfNeeded({heapDrives:!0})):O.debug("heap.resetIdentity called on an anonymous user - no action")}else jl("resetIdentity",(function(){Lf.resetIdentity()}))},addUserProperties:function(e){if(function(e){return!(!F(e)||0===Object.keys(e).length)}(e)){var t=Is.getInstance().getUserId();Lf.loaded&&t?function(e){He.getInstance().getShouldStopTracking()||ls.getInstance().transformAndRelay([{type:k.CORE_ADD_USER_PROPERTIES,id:N(),info:{properties:e,time:(new Date).getTime()}}],ta.ADD_USER_PROPERTIES)}(e):jl("addUserProperties",(function(){Lf.addUserProperties(e)}))}else O.warn("heap.addUserProperties was called with bad properties: ".concat(e))},addEventProperties:function(e){if(F(e))if(Lf.loaded){var t=Q(e);Oe.getInstance().addProperties(t)}else Dl("addEventProperties",(function(){Lf.addEventProperties(e)}));else O.warn("heap.addEventProperties was called with bad properties: ".concat(e))},removeEventProperty:function(e){M(e)?Lf.loaded?Oe.getInstance().removeEventProperty(e):Dl("removeEventProperty",(function(){Lf.removeEventProperty(e)})):O.warn("heap.removeEventProperty was called with a bad value: ".concat(e))},clearEventProperties:function(){Lf.loaded?Oe.getInstance().clearProperties():Dl("clearEventProperties",(function(){Lf.clearEventProperties()}))},addPageviewProperties:function(e){if(F(e))if(Lf.loaded){var t=Is.getInstance(),n=Q(e);n&&t.addCustomPageviewProperties(n)}else Dl("addPageviewProperties",(function(){Lf.addPageviewProperties(e)}));else O.warn("heap.addPageviewProperties was called with bad properties: ".concat(e))},removePageviewProperty:function(e){M(e)?Lf.loaded?Is.getInstance().removeCustomPageviewProperty(e):Dl("removePageviewProperty",(function(){Lf.removePageviewProperty(e)})):O.warn("heap.removePageviewProperty was called with a bad value: ".concat(e))},clearPageviewProperties:function(){Lf.loaded?Is.getInstance().clearCustomPageviewProperties():Dl("clearPageviewProperties",(function(){Lf.clearPageviewProperties()}))},getSessionId:function(e){var t=Is.getInstance();if(t.hasSessionExpired())return O.debug("heap.getSessionId - session has expired"),e&&e(null),null;if(t.getHasSessionBeenQueued()){var r=t.getSessionId();return e&&e(r),r}if(O.debug("heap.getSessionId - session has not been instantiated"),e){var i=n.g.setInterval((function(){if(O.trace("heap.getSessionId - checking if session has been created"),t.getHasSessionBeenQueued()){n.g.clearInterval(i);var r=t.getSessionId();e(r)}}),200);n.g.setTimeout((function(){n.g.clearInterval(i)}),3e3)}return null},getUserId:function(e){var t=Is.getInstance();if(t.getHasUserBeenQueued()){var r=t.getUserId();return e&&e(r),r}if(O.debug("heap.getUserId - user has not been instantiated"),e){var i=n.g.setInterval((function(){if(O.trace("heap.getUserId - checking if user has been created"),t.getHasUserBeenQueued()){n.g.clearInterval(i);var r=t.getUserId();e(r)}}),200);n.g.setTimeout((function(){n.g.clearInterval(i)}),3e3)}return null},getIdentity:function(e){var t=Is.getInstance().getIdentity()||null;return e&&e(t),t},getConfig:function(){return He.getInstance().getConfig()},setLogLevel:function(e){Object.values(b).includes(e)&&O.setLogLevel(e,Lf.appid)},onReady:function(e){!Lf.loaded||Zi.getInstance().shouldBlockEventProcessing()?jl("onReady",e):(O.debug("heap.onReady -- heap is already loaded, executing function",{callback:e}),e())},getReplayId:function(){return function(){if(!window.auryc)return"Auryc object is not present in this window";var e=window.auryc.getSessionMetadata(),t=e.replayUrl,n=e.siteId,r=e.sessionId,i=e.sampled,a=e.isOver;return i&&!a?{aurycParams:encodeURIComponent("".concat(n,"/").concat(r,"/").concat((new Date).getTime())),replayUrl:t}:"Session Replay is not active or is over for this session."}()},setPath:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:ce.UserSession;if(M(e)&&Object.values(ce).includes(t))if(Lf.loaded){var n=window.location.origin+e,r=$l(n);if(r&&r.path)Is.getInstance().setMetadata({setPath:{path:r.path,query:null==r?void 0:r.query,hash:null==r?void 0:r.hash,lifespan:t}})}else Dl("setPath",(function(){Lf.setPath(e,t)}));else O.warn("heap.setPath was called with a bad value:",{path:e,lifespan:t})}}),Ff=function(e){var t,n,r=((null===(t=Ni.getInstance().coreAPIs)||void 0===t?void 0:t.getConfig().disableInteractionEvents)||[]).includes(e);r&&(null===(n=Ni.getInstance().coreAPIs)||void 0===n||n.logger.info("Autocapture -- ".concat(e," capture has been disabled")));return r},zf="change",Vf=function(){return navigator.appVersion},Jf=function(){return Vf().indexOf("Safari")>-1},qf=function(){var e=navigator.userAgent,t=e.match(/iPad/i)||e.match(/iPhone/i),n=e.match(/WebKit/i);return t&&n&&!e.match(/CriOS/i)},Hf=function(e){var t=e.tagName.toLowerCase(),n=ao(e.type)?e.type.toLowerCase():e.type;return null!==wo(e)&&("input"===t&&["submit","image"].includes(n)||"button"===t&&!["reset","button"].includes(n))},Kf=function(e){return Qf(e)?e.animVal:e},Qf=function(e){return"string"==typeof e.animVal},Zf=function(e,t){return e.hasAttribute?e.hasAttribute(t):function(e,t){var n=e.getAttributeNode(t);return!(!n||!n.specified&&!n.nodeValue)}(e,t)},Gf=function(e){if(!e||!e.href)return!1;if(function(e){return Zf(e,"data-turbo-frame")||Zf(e,"data-heap-turbo")}(e))return!1;var t=Kf(e.href),n=Zf(e,"download"),r=new RegExp("^\\s*("+window.location.href.split(window.location.hash||"#")[0].replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&")+")?#").test(t),i=/^\s*javascript:/.test(t),a=/^\s*(mailto|tel):/.test(t)&&Jf(),o="ar"===e.rel&&/\.usdz/i.test(t)&&Jf();return!(e.isContentEditable||n||r||i||a||o)},Yf=function(e,t){window.addEventListener(e.type,(function n(r){window.removeEventListener(r.type,n),r!==e||r.defaultPrevented||t(r)}))},Wf=function(e,t){var r,i;null===(r=Ni.getInstance().coreAPIs)||void 0===r||r.logger.debug("Autocapture -- flushing queue before leaving page",{event:e});var a,o,s=(a=t,o=!1,function(){if(!o){o=!0;for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return a.apply(void 0,t)}});!function(e){e.preventDefault?e.preventDefault():e.returnValue=!1}(e),n.g.setTimeout(s,300),null===(i=Ni.getInstance().coreAPIs)||void 0===i||i.flushQueueOnUnload()},Xf=function(){function e(){u(this,e),this.clickedSubmitEventElements=[]}return l(e,[{key:"addEvent",value:function(e){this.clickedSubmitEventElements.push(e)}},{key:"getEvents",value:function(){return this.clickedSubmitEventElements}},{key:"clearEvents",value:function(){this.clickedSubmitEventElements=[]}},{key:"findLast",value:function(e){for(var t=this.clickedSubmitEventElements.length-1;t>=0;t--){var n=this.clickedSubmitEventElements[t];if(e(n))return n}}}],[{key:"getInstance",value:function(){return e.instance||(e.instance=new e),e.instance}}]),e}(),$f="click",ed=function(e){var t,n,r,i=null===(t=Ni.getInstance().coreAPIs)||void 0===t?void 0:t.logger;if(null==i||i.trace("Autocapture -- click event",{event:e}),"click"===e.type){var a=Xf.getInstance();if(Cf(e),r=1&(n=e).button?1:0,1===(n.which||void 0===n.button?n.which:r)){var o=ro(e),s=mo(o,Hf),u=null!==s,c="__impl4cf1e782hg__"in e&&void 0!==e.__impl4cf1e782hg__;u?(a.addEvent([e,s]),null==i||i.trace("Autocapture -- clicked event is form submit click",{event:e,clickedSubmitEventElements:a.getEvents()})):!c&&function(e){return!(e.metaKey||e.shiftKey||e.ctrlKey||e.altKey)}(e)&&Yf(e,(function(){null==i||i.trace("Autocapture -- event fully propagated");var t=function(e){for(;e&&(void 0===e.tagName||"a"!==e.tagName.toLowerCase()||!e.href);)e=e.parentNode;return e}(o);try{!function(e){var t,n,r,i,a=null===(t=Ni.getInstance().coreAPIs)||void 0===t?void 0:t.logger,o=(null===(n=Ni.getInstance().coreAPIs)||void 0===n?void 0:n.getConfig().supportedDomains)||[];if(e&&e.href){var s=new URL(document.location.href),u=new URL(e.href);if(s.hostname!==u.hostname)if(o.some((function(e){return u.hostname.includes(e)}))){null===(r=Ni.getInstance().coreAPIs)||void 0===r||r.createNewSessionIfNeeded();var c=null===(i=Ni.getInstance().coreAPIs)||void 0===i?void 0:i.getSessionMetadata();if(c){var l=c.envId,f=c.userId,d=c.sessionId,h=c.identity,v=c.sessionProperties.time,p="".concat(l,";").concat(f,";").concat(d,";").concat(null!=v?v:"",";").concat(null!=h?h:""),g=new URL(e.href);g.searchParams.set("_hp5_cdc",p),e.href=g.toString()}else null==a||a.error("decorateLink -- Unable to receive metadata from core API dependencies on decorator")}else null==a||a.trace("decorateLink -- Redirecting to unsupported domain, no need to decorate");else null==a||a.trace("decorateLink -- Redirecting to the same domain, no need to decorate")}}(t)}catch(e){null==i||i.trace("Autocapture CDT -- Failed to decorate link for CDT, continuing",{error:e})}if(Gf(t)){var n=Kf(t.href),r=t.target||(document.getElementsByTagName("base")[0]||{}).target;null==i||i.trace("Autocapture -- should intercept href",{target:r}),r&&"_self"!==Kf(r).toLowerCase()?r.match(/^_(parent|top)$/i)&&Wf(e,(function(){window.open(n,r)})):Wf(e,(function(){document.location.href=n}))}}))}}},td="submit",nd=function(e){var t,i=null===(t=Ni.getInstance().coreAPIs)||void 0===t?void 0:t.logger,a=e||window.event;if(null==i||i.trace("Autocapture -- submit event",{event:a}),Cf(a),o=Vf(),s=null,o&&(o.indexOf("MSIE 6.")>-1?s=6:o.indexOf("MSIE 7.")>-1?s=7:o.indexOf("MSIE 8.")>-1?s=8:o.indexOf("MSIE 9.")>-1&&(s=9)),!s){var o,s,u,c,l=a.target,f=Xf.getInstance(),d=f.findLast((function(e){var t=e[1];return wo(t)===l}));f.clearEvents(),d&&(u=d[0],c=d[1]),Yf(a,(function(){var e,t=(e=c)?["formAction","formEnctype","formMethod","formNoValidate","formTarget","name","type","value"].reduce((function(t,n){return Zf(e,n)&&(t[n]=e[n]),t}),{}):{},o=(c||{}).tagName;"_blank"!==(null==l?void 0:l.target)&&Wf(a,(function(){try{var e,a,s,f={};try{var d=(Array.from(l.querySelectorAll("input"))||[]).filter((function(e){if(!e.inputmask)return!1;var t=e.inputmask._valueSet&&e.inputmask._valueGet&&e.inputmask.unmaskedvalue,n=e.inputmask.userOptions&&e.inputmask.userOptions.removeMaskOnSubmit||e.inputmask.opts&&e.inputmask.opts.removeMaskOnSubmit;return t&&n})),h=d.map((function(e){return e.inputmask._valueGet()}));d.forEach((function(e){e.inputmask._valueSet(e.inputmask.unmaskedvalue())})),n.g.setTimeout((function(){d.forEach((function(e,t){e.inputmask._valueSet(h[t])}))}),0)}catch(e){null==i||i.error("Autocapture -- Error extracting values from form submission",{event:e})}if(c){var v=t.type,p=ao(v)?v.toLowerCase():v;if("input"===o.toLowerCase()&&"image"===p){var g=t.name,m=function(e){var t=e,n=t.target||t.srcElement;if(0===t.screenX&&0===t.screenY||!n)return[0,0];var r=n instanceof Element&&n.getBoundingClientRect();if(!r)return[0,0];var i=Math.floor(t.clientX-r.left),a=Math.floor(t.clientY-r.top),o=!(void 0===t.offsetX&&void 0===t.offsetY||0===t.offsetX&&0===t.offsetY);return[o?t.offsetX:i,o?t.offsetY:a]}(u);(a=document.createElement("input")).type="hidden",a.name=g?g+".x":"x",a.value=m[0].toString(),(s=document.createElement("input")).type="hidden",s.name=g?g+".y":"y",s.value=m[1].toString(),l.appendChild(a),l.appendChild(s)}else{(e=document.createElement("input")).type="hidden","name"in t&&(e.name=t.name);var y=t.value;null!=y&&""!==y&&(e.value=t.value),l.appendChild(e)}["action","enctype","method","noValidate","target"].forEach((function(e){var n,r="form"+(0===(n=e).length?n:n.charAt(0).toUpperCase()+n.slice(1).toLowerCase());r in t&&(f[e]=l[e],l[e]=t[r])}))}if("dialog"===l.method)try{var w=mo(l,(function(e){return"dialog"===e.tagName.toLowerCase()})),b=u.target,_=u.target&&b.value;w&&w.close&&_&&w.close(_)}catch(e){null==i||i.warn("Failed to close dialog for a form submission with method=dialog")}var k=document.createElement("form");document.body.appendChild(k),k.submit.apply(l),document.body.removeChild(k),function(e){for(var t=0;t<(arguments.length<=1?0:arguments.length-1);t++){var n=t+1<1||arguments.length<=t+1?void 0:arguments[t+1];if(n&&"object"===r(n))for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}}(l,f),e&&l.removeChild(e),a&&s&&(l.removeChild(a),l.removeChild(s))}catch(e){null==i||i.error("Autocapture -- Error preventing form submission",{event:e})}}))}))}},rd=function(e){var t;if(e&&e.querySelectorAll){var n=(null===(t=Ni.getInstance().coreAPIs)||void 0===t?void 0:t.flushQueueOnUnload)||function(){};e.querySelectorAll("a").forEach((function(e){e.addEventListener("click",n)})),e.querySelectorAll("form").forEach((function(e){e.addEventListener("submit",n)})),e.querySelectorAll("[onClick]").forEach((function(e){e.addEventListener("click",n)}))}};function id(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}var ad=function(){return window.location.pathname+window.location.hash+window.location.search},od=ad(),sd=function(){var e,t=Ni.getInstance(),r=null===(e=t.coreAPIs)||void 0===e?void 0:e.logger,i=ad();if(od!==i){var o;null==r||r.trace("recordPageview -- current path differs from last path",{lastPageviewPath:od,currentPageviewPath:i}),null===(o=t.coreAPIs)||void 0===o||o.flushEventQueue();var s=od;od=i;var u=s&&za(s),c=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?id(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):id(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({url:Me(!1)},u&&{previous_page:u});n.g.setTimeout((function(){var e;null===(e=t.coreAPIs)||void 0===e||e.createNewPageview(c)}),0)}},ud=function(){var e;(null===(e=Ni.getInstance().coreAPIs)||void 0===e?void 0:e.getConfig().disablePageviewAutocapture)||(!function(){if(history.heappushstate=history.heapreplacestate=sd,"pushState"in window.history){var e=function(e,t,n){var r=e[t];e[t]=function(){var t=r.apply(e,arguments);return z(e[n])&&e[n](),t}};e(window.history,"pushState","heappushstate"),e(window.history,"replaceState","heapreplacestate")}}(),window.addEventListener("popstate",sd,!0),window.addEventListener("hashchange",sd,!0))},cd=function(){var e,t=null===(e=Ni.getInstance().coreAPIs)||void 0===e?void 0:e.getConfig();return((null==t?void 0:t.customEvents)||[]).filter((function(e){return e&&!["click","change","submit"].includes(e)}))};function ld(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return fd(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return fd(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}function fd(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var dd,hd,vd=function e(t){var n=[];if(t.shadowRoot){n.push(t.shadowRoot);var r,i=ld(t.shadowRoot.children);try{for(i.s();!(r=i.n()).done;){var a=r.value;n=n.concat(e(a))}}catch(e){i.e(e)}finally{i.f()}}var o,s=ld(t.children);try{for(s.s();!(o=s.n()).done;){var u=o.value;n=n.concat(e(u))}}catch(e){s.e(e)}finally{s.f()}return n},pd=function(e){try{if(!e)return!0;for(var t=e;t;){if("BODY"===t.tagName||"HTML"===t.tagName)return!1;if(io(t.parentNode)){if("open"!==t.parentNode.mode)return!0;t=t.parentNode.host}else t=t.parentElement}return!0}catch(e){var n,r;return null===(n=Ni.getInstance().coreAPIs)||void 0===n||null===(r=n.logger)||void 0===r||r.error("Failed to determine closed context, defaulting to no capture"),!0}},gd=function(){var e,t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],r=Ff("change"),i=Ff("submit"),a=Ff("click"),o=vd(document.body).filter((function(e){return!n.includes(e)}));null===(e=Ni.getInstance().coreAPIs)||void 0===e||null===(t=e.logger)||void 0===t||t.trace("attaching event listeners on shadow roots",{openShadowRoots:o});var s=cd();return o.forEach((function(e){try{r||e.addEventListener("change",Cf,!0),i||e.addEventListener("submit",nd,!0),a||e.addEventListener("click",ed,!0),s.forEach((function(t){e.addEventListener(t,Bf,!0)}))}catch(e){var t,n;null===(t=Ni.getInstance().coreAPIs)||void 0===t||null===(n=t.logger)||void 0===n||n.error("Shadow DOM error attaching event listeners",{e:e})}})),o},md=function(){var e,t=Ff("change"),n=Ff("submit"),r=Ff("click"),i=cd(),a=function(){var e=HTMLElement.prototype.attachShadow;HTMLElement.prototype.attachShadow=function(){for(var a=this,o=arguments.length,s=new Array(o),u=0;u<o;u++)s[u]=arguments[u];var c=e.apply(this,s);if(this.shadowRoot&&"open"===this.shadowRoot.mode){var l=function(e){var t,n;pd(e.target)?null===(t=Ni.getInstance().coreAPIs)||void 0===t||null===(n=t.logger)||void 0===n||n.trace("Shadow DOM is in an closed context, nooping custom ".concat(e.type," event listener")):Bf(e)};try{t||this.shadowRoot.addEventListener("change",(function(e){var t,n;pd(e.target)?null===(t=Ni.getInstance().coreAPIs)||void 0===t||null===(n=t.logger)||void 0===n||n.trace("Shadow DOM is in an closed context, nooping change event listener"):Cf(e)}),!0),n||this.shadowRoot.addEventListener("submit",(function(e){var t,n;pd(e.target)?null===(t=Ni.getInstance().coreAPIs)||void 0===t||null===(n=t.logger)||void 0===n||n.trace("Shadow DOM is in an closed context, nooping submit event listener"):nd(e)}),!0),r||this.shadowRoot.addEventListener("click",(function(e){var t,n;pd(e.target)?null===(t=Ni.getInstance().coreAPIs)||void 0===t||null===(n=t.logger)||void 0===n||n.trace("Shadow DOM is in an closed context, nooping click event listener"):ed(e)}),!0),i.forEach((function(e){a.shadowRoot.addEventListener(e,l,!0)}))}catch(e){var f,d;null===(f=Ni.getInstance().coreAPIs)||void 0===f||null===(d=f.logger)||void 0===d||d.error("Shadow DOM error attaching event listeners",{e:e})}}return c}};if(null===(e=Ni.getInstance().coreAPIs)||void 0===e?void 0:e.getConfig().salesforceAura){var o=[],s=!1,u=function(){var e=gd(o);o=[].concat(w(o),w(e))},c=window.setInterval((function(){var e,t;HTMLElement.prototype.attachShadow.toString().includes("[native code]")||(null===(e=Ni.getInstance().coreAPIs)||void 0===e||null===(t=e.logger)||void 0===t||t.trace("SFAura -- attachShadow overwritten for SFAura, overriding with heap handlers"),window.clearInterval(l),window.clearInterval(c),u(),a(),s=!0)}),200),l=window.setInterval(u,400);window.setTimeout((function(){var e,t,n,r;(window.clearInterval(l),window.clearInterval(c),s)?null===(e=Ni.getInstance().coreAPIs)||void 0===e||null===(t=e.logger)||void 0===t||t.trace("SFAura -- 7 seconds passed but handler has been attached, nooping"):(null===(n=Ni.getInstance().coreAPIs)||void 0===n||null===(r=n.logger)||void 0===r||r.trace("SFAura -- 7 seconds passed, clearing interval and attaching heap handler"),u(),a())}),7e3)}else gd(),a()},yd=function(){if(window.auryc&&!window._uxa){var e,t=(new Date).getTime();null===(e=Ni.getInstance().coreAPIs)||void 0===e||e.updateLastEventTime(t)}},wd=function(){["mousemove","mouseup","mousedown","keydown","keypress","keyup","mouseenter","scroll","resize","dblclick","touchstart","touchmove","touchend","touchcancel","pointerover","pointerenter","pointerdown","pointermove","pointerup","pointercancel","pointerout","pointerleave"].forEach((function(e){try{window.addEventListener(e,(n=yd,r=3e4,i=!1,function(){if(!i){for(var e=arguments.length,t=new Array(e),a=0;a<e;a++)t[a]=arguments[a];n.apply(void 0,t),i=!0,window.setTimeout((function(){i=!1}),r)}}),!0)}catch(n){var t;null===(t=Ni.getInstance().coreAPIs)||void 0===t||t.logger.warn("Autocapture -- Adding session replay event listener failed for ".concat(e))}var n,r,i}))},bd=function(e){var t=Ni.getInstance();t.setAPIDependencies(e),Ff(zf)||window.addEventListener(zf,Cf,!0),Ff($f)||window.addEventListener($f,ed,!0),Ff(td)||window.addEventListener(td,nd,!0),function(){if(qf()){var e,t=(null===(e=Ni.getInstance().coreAPIs)||void 0===e?void 0:e.flushQueueOnUnload)||function(){};addEventListener("blur",t,!0),addEventListener("pagehide",t,!0),rd(document),new MutationObserver((function(e){return e.filter((function(e){return"childList"===e.type})).forEach((function(e){e.addedNodes.forEach((function(e){rd(e)}))}))})).observe(document,{childList:!0,subtree:!0})}}(),ud(),cd().forEach((function(e){window.addEventListener(e,Bf,!0)}));try{md()}catch(e){var n,r;null===(n=t.coreAPIs)||void 0===n||null===(r=n.logger)||void 0===r||r.trace("Autocapture -- error adding shadowdom handler",{e:e})}wd()},_d=["onReady","identify","addUserProperties"];null!==(dd=window)&&void 0!==dd&&null!==(hd=dd.heap)&&void 0!==hd&&hd.appid||(window.heap=Lf,window.heap.addAdapter({name:"autocapture",fn:bd},{isBlocking:!1}),function(){var e=window.heapReadyCb;if(e){var t=e.find((function(e){return"init"===e.name}));if(t&&e.splice(e.indexOf(t),1),e.length>0){var n=oa.getInstance();e.forEach((function(e){_d.includes(e.name)?n.enqueueOnReady(e):n.enqueueHeapApi(e)})),window.heapReadyCb=[]}t&&t.fn()}}())}()}();
</script>

</body>
</html>
