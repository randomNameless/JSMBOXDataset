<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>arf-app-dEX11142024-220.html</title>
</head>
<body>

<script>
var enableNews = false,
  _html = {
    'bookmarked' : '<div class="status-box bookmarked"><div class="status-content text-smooth"><i class="si si-heart fa-3x"></i><div class="font-w600 push-5-t">{bookmark-text}</div></div></div>',
    'bookmarked2' : '<div class="ribbon red"><span><i class="fa fa-bookmark"></i> FAVE</span></div>',
    'visited' : '<div class="status-box visited"><div class="status-content text-white"><i class="si si-notebook fa-3x"></i><div class="font-w600 push-5-t">Visited</div></div></div>',
    'visited2' : '<div class="ribbon blue"><span><i class="si si-book-open"></i> VISITED</span></div>',
    'blacklisted' : '<div class="status-box blacklisted"><div class="status-content text-danger"><i class="si si-ban fa-3x"></i><div class="font-w600 push-5-t">Blacklisted</div></div></div>',
    'blacklisted2' : '<div class="ribbon dark"><span><i class="si si-ban"></i> HATE</span></div><div class="hate-overlay"></div>',
    'unread' : '<i class="fa fa-circle text-success" data-toggle="tooltip" data-placement="bottom" title="Unread"></i>',
    'hasread' : '<i class="fa fa-circle text-primary-dark" data-toggle="tooltip" data-placement="bottom" title="Read Before"></i>'
  },
  _today = Math.floor(Math.random() * 9),
  _nutaku = {
    0: 'https://hive.arf.dev/pJMyU',
    1: 'https://hive.arf.dev/PoHmK',
    2: 'https://hive.arf.dev/hyyCN',
    3: 'https://hive.arf.dev/pJMyU',
    4: 'https://hive.arf.dev/PoHmK',
    5: 'https://hive.arf.dev/hyyCN',
    6: 'https://hive.arf.dev/uSHqo',
    7: 'https://hive.arf.dev/mpcTC',
    8: 'https://hive.arf.dev/DYGat'
  },
  _keywords = (document.getElementsByName('keywords').length > 0) ? document.getElementsByName('keywords')[0].getAttribute('content') : '',
  _frame = {
    't-stella' : {
      100 : '<ins class="eas6a97888e38" data-zoneid="5160182" data-keywords="' + _keywords + '"></ins>',
      300 : '<ins class="eas6a97888e38" data-zoneid="5160182" data-keywords="' + _keywords + '"></ins>',
      728 : '<ins class="eas6a97888e38" data-zoneid="5160218" data-keywords="' + _keywords + '"></ins>',
      900 : '<ins class="eas6a97888e38" data-zoneid="5160210" data-keywords="' + _keywords + '"></ins>',
      1300 : '<ins class="eas6a97888e38" data-zoneid="5176534" data-keywords="' + _keywords + '"></ins>'
    },
    'b-stella' : {
      100 : '<ins class="eas6a97888e38" data-zoneid="5160192" data-keywords="' + _keywords + '"></ins>',
      300 : '<ins class="eas6a97888e38" data-zoneid="5160192" data-keywords="' + _keywords + '"></ins>',
      728 : '<ins class="eas6a97888e38" data-zoneid="5174648" data-keywords="' + _keywords + '"></ins>',
      900 : '<ins class="eas6a97888e38" data-zoneid="5174646" data-keywords="' + _keywords + '"></ins>',
      1300 : '<ins class="eas6a97888e38" data-zoneid="5176536" data-keywords="' + _keywords + '"></ins>'
    },
    's-stella' : {
      100 : '<ins class="eas6a97888e38" data-zoneid="5160200" data-keywords="' + _keywords + '"></ins>',
      300 : '<ins class="eas6a97888e38" data-zoneid="5160200" data-keywords="' + _keywords + '"></ins>',
      728 : '<ins class="eas6a97888e38" data-zoneid="5176538" data-keywords="' + _keywords + '"></ins>',
      900 : '<ins class="eas6a97888e38" data-zoneid="5176538" data-keywords="' + _keywords + '"></ins>',
      1300 : '<ins class="eas6a97888e38" data-zoneid="5176538" data-keywords="' + _keywords + '"></ins>'
    },
    'h-stella' : {
      100 : '<ins class="eas6a97888e38" data-zoneid="5160192" data-keywords="' + _keywords + '"></ins>',
      300 : '<ins class="eas6a97888e38" data-zoneid="5160192" data-keywords="' + _keywords + '"></ins>',
      728 : '<ins class="eas6a97888e38" data-zoneid="5174648" data-keywords="' + _keywords + '"></ins>',
      900 : '<ins class="eas6a97888e38" data-zoneid="5174646" data-keywords="' + _keywords + '"></ins>',
      1300 : '<ins class="eas6a97888e38" data-zoneid="5176536" data-keywords="' + _keywords + '"></ins>'
    },
    'blocked-image' : {
      100 : '<a href="' + _nutaku[_today] + '" target="_blank"><img src="//hentaicdn.com/cdn/v2.assets/09152020/' + _today +'_3SQU.jpg"></a>',
      300 : '<a href="' + _nutaku[_today] + '" target="_blank"><img src="//hentaicdn.com/cdn/v2.assets/09152020/' + _today +'_3SQU.jpg"></a>',
      728 : '<a href="' + _nutaku[_today] + '" target="_blank"><img src="//hentaicdn.com/cdn/v2.assets/09152020/' + _today +'_7LEA.jpg"></a>',
      900 : '<a href="' + _nutaku[_today] + '" target="_blank"><img src="//hentaicdn.com/cdn/v2.assets/09152020/' + _today +'_9LEA.jpg"></a>',
      1300 : '<a href="' + _nutaku[_today] + '" target="_blank"><img src="//hentaicdn.com/cdn/v2.assets/09152020/' + _today +'_9LEA.jpg"></a>'
    },
    'blocked-image-s' : {
      100 : '<a href="' + _nutaku[_today] + '" target="_blank"><img class="push-5-t" src="//hentaicdn.com/cdn/v2.assets/09152020/' + _today +'_3SQU.jpg"></a>',
      300 : '<a href="' + _nutaku[_today] + '" target="_blank"><img class="push-5-t" src="//hentaicdn.com/cdn/v2.assets/09152020/' + _today +'_3SQU.jpg"></a>',
      728 : '<a href="' + _nutaku[_today] + '" target="_blank"><img class="push-5-t" src="//hentaicdn.com/cdn/v2.assets/09152020/' + _today +'_3SQU.jpg"></a>',
      900 : '<a href="' + _nutaku[_today] + '" target="_blank"><img class="push-5-t" src="//hentaicdn.com/cdn/v2.assets/09152020/' + _today +'_3SQU.jpg"></a>',
      1300 : '<a href="' + _nutaku[_today] + '" target="_blank"><img class="push-5-t" src="//hentaicdn.com/cdn/v2.assets/09152020/' + _today +'_3SQU.jpg"></a>'
    },
    'blocked-image-h' : {
      100 : '<a href="' + _nutaku[_today] + '" target="_blank"><img src="//hentaicdn.com/cdn/v2.assets/09152020/' + _today +'_3SQU.jpg"></a>',
      300 : '<a href="' + _nutaku[_today] + '" target="_blank"><img src="//hentaicdn.com/cdn/v2.assets/09152020/' + _today +'_3SQU.jpg"></a>',
      728 : '<a href="' + _nutaku[_today] + '" target="_blank"><img src="//hentaicdn.com/cdn/v2.assets/09152020/' + _today +'_7LEA.jpg"></a>',
      900 : '<a href="' + _nutaku[_today] + '" target="_blank"><img src="//hentaicdn.com/cdn/v2.assets/09152020/' + _today +'_10LEA.jpg" style="width:100%;height:auto;"></a>',
      1300 : '<a href="' + _nutaku[_today] + '" target="_blank"><img src="//hentaicdn.com/cdn/v2.assets/09152020/' + _today +'_10LEA.jpg" style="width:100%;height:auto;"></a>'
    },
    'ark-VHbSBF': {
      'default': 'h-stella',
      'blocked': 'blocked-image-h'
    },
    'ark-ZLDfuN': {
      'default': 't-stella',
      'blocked': 'blocked-image'
    },
    'ark-ZkObxr': {
      'default': 'b-stella',
      'blocked': 'blocked-image'
    },
    'ark-yqWxSH': {
      'default': 's-stella',
      'blocked': 'blocked-image-s'
    }
  },
  ARFfwk = ARFfwk || {};
(function($) {
  ARFfwk.doAjax = {
    call: function (data, callBack, failCallback) {
      var self = this;
      $.post('/api', data, function(response) {
        if (self.checkResponse(response)) {
          if ($.isFunction(callBack))
            callBack(response);
        } else {
          if ($.isFunction(failCallback))
            failCallback(response);
        }
      }, 'json');
    },
    checkResponse: function(data) {
      if (data && data.status) {
        if (data.status === 1)
          return true;
        else if (data.status === 2) {
          if (data.message) {
            ARFfwk.doMessage.error(data.message, 'danger');
            return false;
          }
        }
      }
      ARFfwk.doMessage.error('Something went wrong, please notify Administrators if problem persists.', 'danger');
      return false;
     },
     formify: function(inputType) {
       var formData = {};
       $.each($('input:not([type="checkbox"]):not([type="radio"]), input[type="checkbox"]:checked, input[type="radio"]:checked, textarea, select', inputType), function() {
         formData[$(this).attr('name')] = $(this).val();
       });
       return formData;
     },
     getCheckboxes: function(className) {
       var checkedVals = $(className+':checkbox:checked').map(function() {
         return this.value;
       }).get().join(',');
       return checkedVals;
     }
  };
}(jQuery));
(function($) {
  ARFfwk.doMessage = {
    error: function(message, type) {
      this.showMessageBox('Notice: ' + message, type);
    },
    showMessageBox: function(message, type) {
      $.notify({
        message: message
      },{
        type: type,
        delay: 2000,
        animate: {
          enter: 'animated fadeInDown',
          exit: 'animated fadeOutUp'
        }
      });
    }
  };
}(jQuery));
(function($) {
  ARFfwk.storeData = {
    lssv: null,
    get: function(key) {
      return this.lss() ? localStorage.getItem(key) : Cookies.get(key);
    },
    set: function(key, value) {
      this.lss() ? localStorage.setItem(key, value) : Cookies.set(key, value, {
        expires: 365,
        path: '/'
      });
    },
    del: function(key) {
      this.lss() ? localStorage.removeItem(key) : Cookies.remove(key);
    },
    lss: function() {
      if (this.lssv === null) {
        if (ARFfwk.savePrefs.get('uselocalStorage') === 1) {
          try {
            if (typeof(localStorage) != 'undefined') {
              var temp_key = 'PDS_LS_SUPTEST_' + new Date().getTime();
              var temp_val = 'PDS_LS_SUPTESTV_' + new Date().getTime();
              localStorage.setItem(temp_key, temp_val);
              this.lssv = localStorage.getItem(temp_key) === temp_val;
              localStorage.removeItem(temp_key);
            } else
              this.lssv = false;
          } catch (err) {
            this.lssv = false;
          }
        } else {
          this.lssv = false;
        }
      }
      return this.lssv;
    }
  };
}(jQuery));
(function($) {
  ARFfwk.savePrefs = {
    settings: false,
    defaultSettings: function() {
      return {
        version: 1,
        preloadImages: 1,
        uselocalStorage: 1,
        userReaderMode: 0,
        userMangaHover: 1,
        userMangaHoverMobile: 1,
        userShowVisited: 0,
        userHideBlacklisted: 0,
        userNightMode: 1,
        userThumbnailMode: 0,
        userHoverMenu: 0
      };
    },
    parseSettings: function() {
      var settings = this.defaultSettings();
      var cookie = Cookies.get('pfs');
      if (cookie) {
        var vals = cookie.split('');
        if (vals[0] == settings.version) {
          var i = 0;
          $.each(settings, function(k) {
            settings[k] = parseInt(vals[i]);
            i++;
          });
        }
      }
      return settings;
    },
    getSettings: function() {
      if (!this.settings)
        this.settings = this.parseSettings();
      return this.settings;
    },
    saveSettings: function(values) {
      values.version = this.defaultSettings().version;
      this.settings = values;
      var cookie = $.map(this.settings, function(v) {
        return v;
      }).join('');
      Cookies.set('pfs', cookie, {
        expires: 365,
        path: '/'
      });
    },
    get: function(key) {
      var settings = this.getSettings();
      return settings[key];
    },
    saveHandler: function() {
      var settings = this.getSettings();
      $.each(settings, function(k) {
        var s = $('.settings-' + k);
        if (s.length > 0)
          settings[k] = s.is(':checked') ? 1 : 0;
      });
      this.saveSettings(settings);
      ARFfwk.doMessage.error('Your preferences have been saved!', 'info');
      location.reload();
    },
    loadHandler: function() {
      $.each(this.getSettings(), function(k, v) {
        var ele = $('.settings-' + k);
        if (v == 1)
          ele.attr('checked', 'checked');
        else
          ele.removeAttr('checked');
      });
    },
    applySettings: function() {
      var settings = this.getSettings(), isReader = $('#js-viewer'), isMainContainer = $('#main-container');
      if (isReader.length) {
        if (settings.userReaderMode == 1) {
          ARFfwk.doReader.init('infinite');
	  $('#goFullscreen').parent().hide();
        } else
          ARFfwk.doReader.init('page');
      } else {
         if (settings.userHideBlacklisted == 1)
           ARFfwk.List.init();
         if (settings.userShowVisited == 1)
           ARFfwk.List.init();
         if (settings.userHoverMenu == 1)
           $('#page-container').removeClass('side-overlay-hover');
         else
          $('#page-container').addClass('side-overlay-hover');   
      }
      if (settings.userNightMode == 1) {
        if (isMainContainer.hasClass('bg-black') == false) {
          isMainContainer.addClass('bg-black');
          $('#page-container').addClass('bg-black');
        }
      } else
        isMainContainer.removeClass('bg-black');
      if (settings.userMangaHover == 1) {
        var isMobile = {
          Android: function() {
            return navigator.userAgent.match(/Android/i);
          },
          BlackBerry: function() {
            return navigator.userAgent.match(/BlackBerry/i);
          },
          iOS: function() {
            return navigator.userAgent.match(/iPhone|iPad|iPod/i);
          },
          Opera: function() {
            return navigator.userAgent.match(/Opera Mini/i);
          },
          Windows: function() {
            return navigator.userAgent.match(/IEMobile/i);
          },
          any: function() {
            return (isMobile.Android() || isMobile.BlackBerry() || isMobile.iOS() || isMobile.Opera() || isMobile.Windows());
          }
        };
        if (!isMobile.any())
          ARFfwk.createTooltip.init();
        else {
          if (settings.userMangaHoverMobile == 1)
            ARFfwk.createTooltip.init(true);
        }
      }
    }
  };
  $(function() {
    ARFfwk.savePrefs.applySettings();
    var ss = $('.settings-save');
    if (ss.length > 0) {
      ARFfwk.savePrefs.loadHandler();
      ss.click(function() {
        ARFfwk.savePrefs.saveHandler();
        ARFfwk.savePrefs.applySettings();
      });
    }
  });
}(jQuery));
(function($) {
  ARFfwk.User = {
    init: function() {
      var self = this;
      if (ARFfwk.storeData.get('hst') == undefined)
        ARFfwk.doHistory.create();
      if (ARFfwk.storeData.get('tags') == undefined)
        ARFfwk.Tag.populate();
      $('#js-syncData').click(function() {
        self.syncData();
        return false;
      });
      // User Email
      $('#btn-setUserEmail').click(function() {
        $('.userInputs').removeClass('has-error');
        var newEmail = $('#newEmail').val(),
            oldEmail = $('#oldEmail').val();
        if (newEmail.length < 1 || !ARFfwk.doReport.checkEmail(newEmail)) {
          $('#userEmail-err').addClass('has-error');
          ARFfwk.doMessage.error('Please enter a valid email.', 'danger');
          return false;
        } else {
          if (newEmail == oldEmail) {
            ARFfwk.doMessage.error('Same as current email.', 'danger');
            return false;
          } else {
            ARFfwk.doAjax.call({
              controller: 'user', action: 'changeEmail', email: newEmail
            }, function(r) {
              if (r.code) ARFfwk.doMessage.error(r.message, r.code);
            });
          }
        }
      });
      // User Password
      $('#btn-setUserPassword').click(function() {
        $('.userInputs').removeClass('has-error');
        var cur = $('#currentPass').val(),
            newPass = $('#newPass').val(),
            conPass = $('#confirmPass').val();
        if (cur.length < 1) {
          $('#userPassword-err1').addClass('has-error');
          ARFfwk.doMessage.error('Please enter your current password.', 'danger');
          return false;
        }
        if (newPass.length <= 8 || conPass.length <= 8) {
          $('#userPassword-err2').addClass('has-error');
          $('#userPassword-err3').addClass('has-error');
          ARFfwk.doMessage.error('New password must be longer than 8 characters!', 'danger');
        } else {
          if (newPass == conPass) {
            ARFfwk.doAjax.call({
              controller: 'user', action: 'changePassword', cur: cur, new: newPass, con: conPass
            }, function(r) {
              if (r.code) ARFfwk.doMessage.error(r.message, r.code);
              setTimeout(function(){
                location.href = '/login';
              }, 2000);
            });
          } else {
            $('#userPassword-err2').addClass('has-error');
            $('#userPassword-err3').addClass('has-error');
            ARFfwk.doMessage.error('New Password and Confirm Password do not match!', 'danger');
          }
        }
      });
    },
    requireUser: function() {
      var userEle = $('#page-container');
      if (!userEle.length || userEle.data('userid') === 0)
        return false;
      else
        return true;
    },
    syncData: function() {
      ARFfwk.doAjax.call({
        controller: 'sync',
        action: 'userData',
        key: 'true'
      }, function (r) {
        if (r.hst.length) ARFfwk.doHistory.setHistory(r.hst);
        if (r.tags.length) {
          ARFfwk.Tag.setTagList(r.tags);
          ARFfwk.Tag.updateDom();
        }
        if (r.rts != null) ARFfwk.storeData.set('rts', JSON.stringify(r.rts));
        ARFfwk.doMessage.error(r.message, r.code);
      });
    }
  };
  $(function() {
    if (ARFfwk.User.requireUser()) {
      ARFfwk.User.init();
    } else {
      if (ARFfwk.storeData.get('tags'))
        ARFfwk.storeData.del('tags');
    }
    if(Cookies.get('pfs') == undefined) {
      ARFfwk.savePrefs.saveSettings(ARFfwk.savePrefs.defaultSettings());
    }
  });
}(jQuery));
(function($) {
  ARFfwk.doRating = {
    init: function() {
      var self = this, jsRaty = $('.js-raty');
      if (jsRaty.length) {
        var mid = jsRaty.data("manga-id");
        if (mid && self.getRating(mid))
          jsRaty.next('small').append('<b class="text-danger"> Your rating: '+ self.getRating(mid) + '</b>');
        jsRaty.raty({
          score: jsRaty.data("score") ? jsRaty.data("score"): 0,
          number: jsRaty.data("number") ? jsRaty.data("number"): 5,
          cancel: jsRaty.data("cancel") ? jsRaty.data("cancel"): !1,
          target: jsRaty.data("target") ? jsRaty.data("target"): !1,
          targetScore: jsRaty.data("target-score") ? jsRaty.data("target-score"): !1,
          precision: jsRaty.data("precision") ? jsRaty.data("precision"): !1,
          cancelOff: jsRaty.data("cancel-off") ? jsRaty.data("cancel-off"): "fa fa-fw fa-times text-danger",
          cancelOn: jsRaty.data("cancel-on") ? jsRaty.data("cancel-on"): "fa fa-fw fa-times",
          starHalf: jsRaty.data("star-half") ? jsRaty.data("star-half"): "fa fa-fw fa-heart-half text-danger",
          starOff: jsRaty.data("star-off") ? jsRaty.data("star-off"): "fa fa-fw fa-star text-gray",
          starOn: jsRaty.data("star-on") ? jsRaty.data("star-on"): "fa fa-fw fa-star text-warning",
          starType: 'i',
          click: function(score, evt) {
            if (self.getRating(mid) == undefined) {
              self.submit(mid, score);
              jsRaty.next('small').append('<b class="text-danger"> Your rating:' + score + '</b>');
            } else
              ARFfwk.doMessage.error('You have rated this manga before!', 'warning');
          }
        });
      } else return false;
    },
    submit: function (mangaId, score) {
      var self = this;
      ARFfwk.doAjax.call({
        controller: 'manga',
        action: 'rating',
        mid: mangaId,
        score: score
      }, function (reponse) {
        ARFfwk.doMessage.error(reponse.message, 'success');
        self.storeRating(mangaId, score);
      });
    },
    storeRating: function(mid, score) {
      if (ARFfwk.storeData.lss()) {
        mid = parseInt(mid);
        score = parseInt(score);
        var r = this.getRatings();
        r[mid] = score;
        ARFfwk.storeData.set('rts', JSON.stringify(r));
      }
    },
    getRatings: function() {
      return JSON.parse(ARFfwk.storeData.get('rts')) || {};
    },
    getRating: function(mid) {
      mid = parseInt(mid);
      var r = this.getRatings();
      return r[mid];
    },
    add: function(mid) {
      if (mid) {
        if (ARFfwk.storeData.get('rcm') == undefined)
          ARFfwk.storeData.set('rcm', mid);
        else {
          if (this.isRecommend(mid)) return false;
          else {
            var data = this.getRecommend();
            data.push(mid);
            this.setRecommend(data);
          }
        }
      }
    },
    checkRecomend: function () {
      var mid = $('.js-raty').data('manga-id');
      if (this.isRecommend(mid)) $('#js-recContent').html('<b class="text-danger">Thanks for the feedback!</b>');
      return false;
    },
    isRecommend: function(mid) {
      return $.inArray(parseInt(mid), this.getRecommend()) >= 0;
    },
    getRecommend: function() {
      var f = ARFfwk.storeData.get('rcm');
      return f ? f.split('-').map(function(n) {
        return parseInt(n, 10);
      }) : [];
    },
    setRecommend: function(rec) {
      ARFfwk.storeData.set('rcm', rec.sort(function(a, b) {
        return a - b;
      }).join('-'));
    },
    recommend: function (mangaId, vote) {
      ARFfwk.doAjax.call({
        controller: 'manga',
        action: 'recommendation',
        mid: mangaId,
        vote: vote
      }, function (reponse) {
        ARFfwk.doMessage.error(reponse.message, 'success');
        ARFfwk.doRating.add(mangaId);
        ARFfwk.doRating.checkRecomend();
      });
    },
    recommendInit: function () {
      var self = this;
      if ($('#js-recContent').length) {
        ARFfwk.doRating.checkRecomend();
        $('.js-rdrRcm').click(function() {
          var mangaId = $('.js-raty').data('manga-id');
          var ele = $(this);
          var vote = ele.hasClass('down') ? 'down': 'up';
          self.recommend(mangaId, vote);
        });
      } else return false;
    }
  };
  $(function() {
    ARFfwk.doRating.init();
    ARFfwk.doRating.recommendInit();
  });
}(jQuery));
(function($) {
  ARFfwk.doBookmark = {
    init: function() {
      if (ARFfwk.storeData.get('bms'))
        ARFfwk.storeData.del('bms');
      $('#bmkDelete').click(function() {
        var data = ARFfwk.doAjax.getCheckboxes('.chk');
        if (data.length > 0) {
          ARFfwk.doBookmark.delete(data);
          $('.chk:checkbox:checked').closest('.col-lg-2b').hide('slow');
        } else {
          ARFfwk.doMessage.error('You didnt select any series!', 'danger');
          return false;
        }
      });
      $('.bmkMove').click(function(){
        var bmkMode = $(this).data('bmk'), data = ARFfwk.doAjax.getCheckboxes('.chk');
        if (data.length > 0 && bmkMode != undefined) {
          ARFfwk.doBookmark.move(data, bmkMode);
          $('.chk:checkbox:checked').closest('.col-lg-2b').hide('slow');
        } else {
          ARFfwk.doMessage.error('You didnt select any series!', 'danger');
          return false;
        }
      });
      $('.usrBookmark').click(function() {
        var bmkMode = $(this).data('bmk'), mid = $('.js-addBookmark').data('mid');
        if (bmkMode != undefined && mid != undefined) {
          ARFfwk.doBookmark.create(mid, bmkMode);
        }
      });
      $('.js-usrOption').click(function() {
        var bmkMode = $(this).data('bmk'), mid = $(this).parents('ul').siblings('a').data('mid');
        if (bmkMode != undefined && mid != undefined) {
          ARFfwk.doBookmark.create(mid, bmkMode);
        }
      });
    },
    delete: function (delData) {
      ARFfwk.doAjax.call({controller: 'manga', action: 'bmkDelete', data: delData}, function(data) {
        ARFfwk.doMessage.error(data.response + ' series have been deleted!', 'success');
      });
    },
    move: function (movData, bmkMode) {
      ARFfwk.doAjax.call({controller: 'manga', action: 'bmkMove', data: movData, mode: bmkMode}, function(data) {
        ARFfwk.doMessage.error(data.response[0] + ' series have been move to [' + data.response[1] + '].', 'success');
        location.reload();
      });
    },
    create: function (mid, bmkMode) {
      mid = parseInt(mid);
      var self = this;
      if (ARFfwk.User.requireUser()) {
        if (mid) {
          ARFfwk.doAjax.call({controller: 'manga', action: 'bookmark', mid: mid, mode: bmkMode}, function(data) {
            self.setBookmarks(data.response);
            self.updateDom(true);
            ARFfwk.doMessage.error(data.message, data.code);
          });
        }
      } else
        ARFfwk.doMessage.error('Please login to use bookmark!', 'danger');
    },
    updateDom: function(isNew) {
      var self = this, mid, bookmarkType;
      if ($('.js-addBookmark').length) {
        $('.js-addBookmark').each(function() {
          mid = $(this).data('mid');
          var animated = isNew ? 'bg-danger text-white animated flash' : 'bg-danger text-white';
          if (self.isBookmark(mid)) {
            bookmarkType = self.getBookmarkType(mid);
            $(this).addClass(animated).html('<i class="fa fa-bookmark"></i><span class="hidden-xs"> Bookmarked: ' + bookmarkType.text + ' <b class="caret"></b></span>');
            $('.usrBookmark[data-bmk="' + bookmarkType.type + '"]').parent().addClass('bg-info');
            $('.usrBookmark.hide').removeClass('hide');
          } else {
            $(this).removeClass('bg-danger text-white').html('<i class="fa fa-bookmark-o"></i><span class="hidden-xs"> Bookmark <b class="caret"></b></span>');
          }
        });
      }
      if ($('.js-usrOptions').length) {
        $('.js-usrOptions').each(function() {
          if (self.isBookmark($(this).data('mid'))) {
            $(this).addClass('animated flash').html('<i class="fa fa-fw fa-heart-o"></i>');
            $(this).parent().find('.js-usrOption.hide').removeClass('hide');
          } else
            $(this).html('<i class="fa fa-fw fa-ellipsis-h"></i>');
        });
        ARFfwk.List.init();
      }
    },
    isBookmark: function(mid) {
      var f = this.getBookmarks();
      return f[mid] ? true : false;
    },
    getBookmarks: function() {
      return JSON.parse(ARFfwk.storeData.get('bmsr')) || {};
    },
    setBookmarks: function(bookmarks) {
      ARFfwk.storeData.set('bmsr', JSON.stringify(bookmarks));
    },
    getBookmarkType: function (mid) {
      var bookmarkTypes = this.getBookmarks(), text,
          type = parseInt(bookmarkTypes[mid], 10);
      switch(type) {
        case 1: text = 'On-Hold'; break;
        case 2: text = 'Plan to Read'; break;
        case 3: text = 'Completed'; break;
        case 4: text = 'Favorite'; break;
        case 5: text = 'Reading'; break;
        default:
          text = 'Undefined';
      }
      return {'type' : type, 'text' : text};
    }
  };
  $(function() {
    ARFfwk.doBookmark.init();
    ARFfwk.doBookmark.updateDom();
  });
}(jQuery));
(function($) {
  ARFfwk.doFavorite = {
    init: function() {
      var self = this;
      $('#js-doFavorite').click(function() {
        var pid = $(this).data('pid'), fvrMode = $(this).data('ptype');
        if (pid != undefined && fvrMode != undefined) {
          self.create(pid, fvrMode);
        }
      });
      $('#fvrDelete').click(function() {
        var data = ARFfwk.doAjax.getCheckboxes('.chk');
        if (data.length > 0)
          self.delete(data);
        else {
          ARFfwk.doMessage.error('You didnt select any series!', 'danger');
          return false;
        }
      });
    },
    delete: function (delData) {
      ARFfwk.doAjax.call({controller: 'tag', action: 'fvrDelete', data: delData}, function(data) {
        ARFfwk.doMessage.error(data.response + ' records have been deleted!', 'success');
        setTimeout(function(){
          location.reload();
        }, 2000);
      });
    },
    create: function (pid, fvrMode) {
      pid = parseInt(pid);
      var self = this;
      if (ARFfwk.User.requireUser()) {
        if (pid) {
          var add = self.isFavorite(pid) ? 0 : 1;
          var fid = add ? pid: - pid;
          ARFfwk.doAjax.call({controller: 'tag', action: 'favorite', pid: fid, mode: fvrMode}, function(data) {
            self.setFavorites(data.response);
            self.updateDom(true);
            ARFfwk.doMessage.error(data.message, data.code);
          });
        }
      } else
        ARFfwk.doMessage.error('Please login to use bookmark!', 'danger');
    },
    updateDom: function(isNew) {
      var self = this;
      if ($('#js-doFavorite').length) {
        $('#js-doFavorite').each(function() {
          var animated = isNew ? 'bg-danger text-white animated flash' : 'bg-danger text-white';
          if (self.isFavorite($(this).data('pid'))) {
            $(this).addClass(animated).html('<i class="fa fa-heart"></i> Bookmarked');
          } else {
            $(this).removeClass('bg-danger text-white').html('<i class="fa fa-heart"></i> Bookmark');
          }
        });
      }
    },
    isFavorite: function(pid) {
      return $.inArray(parseInt(pid), this.getFavorites()) >= 0;
    },
    getFavorites: function() {
      var f = ARFfwk.storeData.get('fvr');
      return f ? f.split('-').map(function(n) {
        return parseInt(n, 10);
      }) : [];
    },
    setFavorites: function(favorites) {
      ARFfwk.storeData.set('fvr', favorites.sort(function(a, b) {
        return a - b;
      }).join('-'));
    }
  };
  $(function() {
    ARFfwk.doFavorite.init();
    ARFfwk.doFavorite.updateDom();
  });
}(jQuery));
(function($) {
  ARFfwk.doHistory = {
    add: function(mid) {
      if (mid) {
        if (ARFfwk.storeData.get('hst') == undefined)
          ARFfwk.storeData.set('hst', mid);
        else {
          if (this.isHistory(mid)) return false;
          else {
            var data = this.getHistories();
            data.push(mid);
            this.setHistory(data);
          }
        }
      }
    },
    isHistory: function(mid) {
      return $.inArray(parseInt(mid), this.getHistories()) >= 0;
    },
    getHistories: function() {
      var f = ARFfwk.storeData.get('hst');
      return f ? f.split('-').map(function(n) {
        return parseInt(n, 10);
      }) : [];
    },
    create: function() {
      var self = this;
      if (ARFfwk.User.requireUser()) {
        ARFfwk.doAjax.call({controller: 'manga', action: 'history', mode: 'all'}, function(data) {
          self.setHistory(data.response);
        });
      }
    },
    setHistory: function(history) {
      ARFfwk.storeData.set('hst', history.sort(function(a, b) {
        return a - b;
      }).join('-'));
    }
  };
}(jQuery));
(function($) {
  ARFfwk.doUnread = {
    init: function () {
      var target = $('.chapter-row');
      if (target.length) {
        $.each(target, function() {
          var ele = $(this), cid = ele.data('cid');
          if (!ARFfwk.doUnread.isUnread(cid))
            ele.prepend(_html.unread);
          else
            ele.prepend(_html.hasread);
        });
      }
    },
    add: function(cid) {
      if (cid) {
        if (ARFfwk.storeData.get('urd') == undefined)
          ARFfwk.storeData.set('urd', cid);
        else {
          if (this.isUnread(cid)) return false;
          else {
            var data = this.getUnread();
            data.push(cid);
            this.setUnread(data);
          }
        }
      }
    },
    isUnread: function(cid) {
      return $.inArray(parseInt(cid), this.getUnread()) >= 0;
    },
    getUnread: function() {
      var f = ARFfwk.storeData.get('urd');
      return f ? f.split('-').map(function(n) {
        return parseInt(n, 10);
      }) : [];
    },
    setUnread: function(unread) {
      ARFfwk.storeData.set('urd', unread.sort(function(a, b) {
        return a - b;
      }).join('-'));
    }
  };
}(jQuery));
(function ($) {
  ARFfwk.List = {
    init: function() {
      this.run($('.book-grid-item-container'), true);
      if ($('#lts-grp').length)
        this.run($('.js-lts-grp'), false);
    },
    run: function(obj, has_parent) {
      var showVisitText = ARFfwk.savePrefs.get('userShowVisited') == 1,
          hideBlacklist = ARFfwk.savePrefs.get('userHideBlacklisted') == 1;
      $.each(obj, function() {
        var currentObject = $(this),
            data = currentObject.data(),
            mid = data.mid,
            checkBlacklist = false,
            checkBookmark = false;
        if (has_parent) {
            $('div.ribbon', currentObject).remove();
            $('div.hate-overlay', currentObject).remove();
            var appendTarget = currentObject.children('.book-grid-item'),
                bookmarkedAppend = _html.bookmarked2,
                blacklistedAppend = _html.blacklisted2,
                visitedAppend = _html.visited2;
        } else {
            $('div.status-box', currentObject).remove();
            var appendTarget = currentObject,
                bookmarkedAppend = _html.bookmarked,
                blacklistedAppend = _html.blacklisted,
                visitedAppend = _html.visited;
        }
        appendTarget.removeClass('bookmarked').removeClass('blacklisted').removeClass('visited');
        if (ARFfwk.doBookmark.isBookmark(mid)) {
          var bookmarkType = ARFfwk.doBookmark.getBookmarkType(mid);
          if (has_parent) {
              appendTarget.append(bookmarkedAppend);
          } else {
              appendTarget.append(bookmarkedAppend.replace('{bookmark-text}', 'Bookmarked: ' + bookmarkType.text));
          }
          appendTarget.addClass('bookmarked');
          checkBookmark = true;
        }
        if (!checkBookmark) {
          if (data.tags) {
            var tags = data.tags.split('-');
            $.each(tags, function(i, v) {
              v = parseInt(v, 10);
              if (ARFfwk.Tag.isInBlacklist(v)) {
                if (hideBlacklist) {
                  if (has_parent)
                    appendTarget.parent().remove();
                  else
                    appendTarget.remove();
                }
                appendTarget.append(blacklistedAppend);
                appendTarget.addClass('blacklisted');
                checkBlacklist = true;
              }
            });
          }
          if (showVisitText && !checkBlacklist) {
            if (ARFfwk.doHistory.isHistory(mid)) {
              appendTarget.append(visitedAppend);
              currentObject.addClass('visited');
            }
          }
        }
      });
    }
  };
  $(function() {
    ARFfwk.List.init();
  });
}(jQuery));
(function($) {
  ARFfwk.tagSelect = {
    _tagType: null,
    _mode: null,
    init: function() {
      var self = this, selectType = $('#js-selectType'), selectMode = $('#js-selectMode'), selectTag = $('#js-selectTag');
      if (selectType.length) {
        self._tagType = $('#js-selectType option:selected').val();
        selectType.select2({ minimumResultsForSearch: '-1', width: '100%' });
        selectType.change(function() {
          self._tagType = $('#js-selectType option:selected').val();
          self.loadData(self._tagType);
        });
      }
      if (selectMode.length) {
        self._mode = ($('#js-selectMode option:selected').val() == '+') ? '#filterIn' : '#filterOut';
        selectMode.select2({ minimumResultsForSearch: '-1', width: '100%' });
        selectMode.change(function() {
          self._mode = ($('#js-selectMode option:selected').val() == '+') ? '#filterIn' : '#filterOut';
        });
      }
      if (selectTag.length) {
        self.loadData(8);
        selectTag.change(function() {
          var data = selectTag.select2('data');
          if (self.isExist(data[0].id))
            ARFfwk.doMessage.error('Duplicate... Please check?', 'warning');
          else {
            self.add(data[0].id, data[0].text);
            ARFfwk.doMessage.error(data[0].text + ' added!', 'success');
          }
        });
      }
      $('body').on('click touchstart', '.js-removeTag', function(){
        $(this).remove();
        ARFfwk.doMessage.error($(this).text() + ' removed!', 'success');
        self.delete($(this).data('tid'));
      });
      $('#reset-blacklist').click(function() {
        if (ARFfwk.storeData.get('tags') != undefined) {
          ARFfwk.storeData.del('tags');
        }
        ARFfwk.Tag.populate();
        ARFfwk.doMessage.error('Tags data have been refreshed!', 'success');
      });
    },
    add: function(tagID, tagName) {
      var v = $(this._mode).val(),
        arr = (v) ? JSON.parse(v) : [],
        bg = 'bg-danger',
        name = '+ ' + tagName;
      if (this._mode == '#filterOut') {
        name = '- ' + tagName;
        bg = 'bg-black';
        ARFfwk.Tag.blacklist(tagID, tagName);
      } else
        ARFfwk.Tag.whitelist(tagID, tagName);
      arr.push(tagID);
      $(this._mode).val(JSON.stringify(arr));
      $(this._mode + 'Container').append('<b class="tagButton2 ' + bg + ' js-removeTag" data-tid="'+ tagID +'">' + name + '  <span><i class="fa fa-times"></i></span></b>');
    },
    isExist: function(tagID) {	  
      return (ARFfwk.Tag.isInWhitelist(tagID) || ARFfwk.Tag.isInBlacklist(tagID)) ? true : false;
    },
    delete: function(tagID) {
      var v = $(this._mode).val(),
        arr = JSON.parse(v);
      arr.splice($.inArray(tagID, arr),1);
      ARFfwk.Tag.removelist(tagID);
      $(this._mode).val(JSON.stringify(arr));
    },
    loadData: function(tagType) {
      $('#js-selectTag').select2({
        ajax: {
          url: '/api?controller=manga&action=userTag&type=' + tagType,
          delay: 250,
          data: function (params) {
            return {
              search: params.term,
              current: params.page || 1
            };
          }
        },
        cache: true,
        escapeMarkup: function (markup) { return markup; },
        placeholder: 'Select a Tag!!',
        width: '100%'
      });
    }
  };
}(jQuery));
(function($) {
  ARFfwk.Tag = {
    lc: null,
    populate: function() {
      var self = this;
      ARFfwk.doAjax.call({controller:'tag', action:'populate'}, function(r) {
        self.setTagList(r.response);
        self.updateDom();
      });
    },
    blacklist: function(tid, tname) {
      if (this.isInBlacklist(tid)) {
        this.removelist(tid);
      } else {
        var self = this;
        if (ARFfwk.User.requireUser()) {
          ARFfwk.doAjax.call({controller:'tag', action:'blacklist', tid: tid, tname: tname}, function(r) {
            self.setTagList(r.response);
            self.updateDom();
          });
        }
      }
    },
    whitelist: function(tid, tname) {
      if (this.isInWhitelist(tid)) {
        this.removelist(tid);
      } else {
        var self = this;
        if (ARFfwk.User.requireUser()) {
          ARFfwk.doAjax.call({controller:'tag', action:'whitelist', tid: tid, tname: tname}, function(r) {
            self.setTagList(r.response);
            self.updateDom();
          });
        }
      }
    },
    removelist: function(tid) {
      var self = this;
      if (ARFfwk.User.requireUser()) {
        ARFfwk.doAjax.call({controller:'tag', action:'nolist', tid: tid}, function(r) {
          self.setTagList(r.response);
          self.updateDom();
        });
      }
    },
    getTagList: function() {
      var f = ARFfwk.storeData.get('tags');
      if (f) {
        var s = f.split('|');
        return {
          blackList: this.parseList(s[0]),
          whiteList: this.parseList(s[1])
        };
      } else {
        return false;
      }
    },
    setTagList: function(list) {
      ARFfwk.storeData.set('tags', list.blackList.sort(function(a, b) {
        return a - b;
      }).join('-') + '|' + list.whiteList.sort(function(a, b) {
        return a - b;
      }).join('-'));
    },
    isInBlacklist: function(tid) {
      return this.isInList(tid, 0);
    },
    isInWhitelist: function(tid) {
      return this.isInList(tid, 1);
    },
    isInList: function(tid, n) {
      tid = parseInt(tid);
      if (this.lc === null) {
        this.lc = this.getTagList();
      }
      if (this.lc) {
        var l = n ? this.lc.whiteList: this.lc.blackList;
        return $.inArray(tid, l) >= 0;
      } else {
        return false;
      }
      this.getTagList();
    },
    parseList: function(list) {
      return list.split('-').map(function(n) {
        return parseInt(n, 10);
      });
    },
    updateDom: function() {
      this.lc = null;
      ARFfwk.List.init();
    }
  };
}(jQuery));
(function($) {
  ARFfwk.doHotkeys = {
    loading: false,
    keyDownCode: null,
    holdAction: null,
    scrollSpeed: 5,
    bind: function() {
      var ieOffsetFix = navigator.userAgent.match(/msie|trident/i) ? 20 : 0,
          self = this;
      $(document).keyup(function(e) {
        self.keyDownCode = false;
      });
      $(document).keydown(function(e) {
        if ($('input:focus, textarea:focus').length == 0) {
          if (e.altKey || e.ctrlKey || e.shiftKey)
            return;
          var key = e.keyCode ? e.keyCode : e.which;
          self.keyDownCode = key;
          switch (key) {
            case 37:
            case 65:
              e.preventDefault();
              if (key === 65) {
                self.smoothScrollKey(-1, 0);
              }
              if (!self.loading) {
                if ($(window).scrollLeft() === 0) {
                  self.keyBack();
                }
              }
            break;
            case 39:
            case 68:
              e.preventDefault();
              if (key === 68) {
                self.smoothScrollKey(1, 0);
              }
              if (!self.loading) {
                if (($(window).width() + $(window).scrollLeft() + ieOffsetFix) >= $(document).width()) {
                  self.keyForward();
                }
              }
            break;
            case 38:
            case 87:
              e.preventDefault();
              if ($(window).scrollTop() !== 0)
                self.smoothScrollKey(0, - 1);
            break;
            case 40:
            case 83:
              e.preventDefault();
              if (($(window).height() + $(window).scrollTop()) < $(document).height())
                self.smoothScrollKey(0, 1);
            break;
            default: return;
          }
          e.preventDefault();
        }
      });
    },
    keyForward: function() {
      if ($('#js-linkNext').length) {
        var href = $('#js-linkNext').attr('href');
        if (href) {
          window.location.href = href;
          this.loading = true;
        }
      }
    },
    keyBack: function() {
      if ($('#js-linkPrevious').length) {
        var href = $('#js-linkPrevious').attr('href');
        if (href) {
          window.location.href = href;
          this.loading = true;
        }
      }
    },
    smoothScrollKey: function(scrollX, scrollY) {
      if (!this.holdAction) { 
        var self = this,
            ldkc = this.keyDownCode;
        self.holdAction = setInterval(function() {
          window.scrollBy(scrollX * self.scrollSpeed, scrollY * self.scrollSpeed);
          if (self.keyDownCode !== ldkc) {
            clearInterval(self.holdAction);
            self.holdAction = null;
          }
        }, 5);
      }
    }
  };
  $(function() {
    ARFfwk.doHotkeys.bind();
  });
}(jQuery));
(function($) {
  ARFfwk.doReader = {
    data: null,
    evLoading: null,
    statePushed: false,
    init: function(mode) {
      if (window.gData && window.gData.images) {
        this.data = window.gData;
      } else
        return;
      var self = this;
      $('.js-reader_chapters').click(function() {
        var selected = $(this).data('cslug');
        self.loadUrl(self.data.mainURL + selected + '/1/');
        $(this).parent().dropdown('toggle');
        return false;
      });
      $('.js-reader_pages').click(function() {
        var index = $(this).data('pagid');
        self.pushProperties(parseInt(index, 10));
        $(this).parent().dropdown('toggle');
        return false;
      });
      if (mode == 'page') {
        self.initPageByPageRead();
      } else {
        $('#js-viewer').addClass('infinite-reader');
        $('.js-page_next').click(function() {
          self.goToNextPage();
          return false;
        });
        $('.js-page_previous').click(function() {
          self.goToPreviousPage();
          return false;
        });
        $(window).bind('statechange', function(e) {
          var state = History.getState();
          self.loadUrl(state.url);
        });
        self.initInfiniteRead();
      }
      self.updateDom(self.data.index);
      self.preLoad(self.data.index);
    },
    initInfiniteRead: function() {
      var self = this,
          ele = $('#js-reader'),
          currentIndex = parseInt(self.data.index),
          imageList = self.data.images;
      for (var i = currentIndex; i < imageList.length; i++) {
        ele.append('<img class="cycle-reader lazyLoad" data-src="' + self.getImageUrl(imageList[i]) + '" />');
      }
      $('.lazyLoad').lazy({
        enableThrottle: true,
        throttle: 500,
        beforeLoad: function(element){
          currentIndex++;
          element.before('<h3 class="text-center">Page ' + currentIndex + ' of ' + imageList.length + '</h3>');
          $('#js-wait').show();
        },
        afterLoad: function(element) {
          $('#js-wait').hide();
          $('[data-reader="page-progress"]').html(currentIndex + ' of ' + imageList.length);
          window.document.title = 'Page ' + currentIndex + ' | ' + self.data.title;
          self.updateDom(currentIndex);
          self.preLoad(currentIndex);
          if (currentIndex % 5 == 0)
            self.rla();
        }
      });
      self.autoScroll();
    },
    autoScroll: function () {
      var mySpeed = 0, myTimer = false, self = this, clicked;
      function startTimer (mySpeed) {
        clearInterval(myTimer);
        var myInterval = 40 - (mySpeed * 5);
        myTimer = setInterval(function () {
          var top = $(window).scrollTop();
          if (top + $(window).height() == $(document).height()) {
            clearInterval(myTimer);
            self.goToNextPage();
          } else {
            top = top + 5;
            $('html, body').animate({
              scrollTop: top
            }, myInterval - 10);
          }
        }, myInterval);
      }
      $('[data-reader="infinite-activate"]').click(function(){
        if(clicked){
          clearInterval(myTimer);
          $(this).html('<i class="si si-control-play"></i>');
          clicked  = false;
        } else {
          startTimer(mySpeed);
          $(this).html('<i class="si si-control-pause"></i>');
          clicked  = true;
        }   
      });
      $('[data-reader="infinite-speed"]').click(function () {
        clearInterval(myTimer);
        clicked = false;
        if (mySpeed < 2)
          mySpeed++;
        else
          mySpeed = 0;
        $(this).html('<i class="si si-control-forward"></i> +' + mySpeed);
        $('[data-reader="infinite-activate"]').html('<i class="si si-control-play"></i>');
      });
      $('[data-reader="infinite-previous"]').click(function () {
        self.goToPreviousPage();
        return false;
      });
      $('[data-reader="infinite-next"]').click(function () {
        self.goToNextPage();
        return false;
      });
    },
    initPageByPageRead: function() {
      var self = this;
      $('.js-page_next, #js-reader img').click(function() {
        self.nextPage();
        return false;
      });
      ARFfwk.doHotkeys.keyForward = function() {
        self.nextPage();
      };
      $('.js-page_previous').click(function() {
        self.previousPage();
        return false;
      });
      ARFfwk.doHotkeys.keyBack = function() {
        self.previousPage();
      };
      $(window).bind('statechange', function(e) {
        var state = History.getState(),
            index = self.getViewProperties(state.url);
        self.showPage(index);
      });
    },
    nextPage: function() {
      var currentIndex = parseInt(this.data.index),
          nextImage = this.data.images[currentIndex];
      if (nextImage) {
        this.pushProperties(this.data.index + 1);
      } else {
        this.goToNextPage();
      }
    },
    previousPage: function() {
      var currentIndex = parseInt(this.data.index),
          previousImage = this.data.images[currentIndex - 2];
      if (previousImage && currentIndex > 1) {
        this.pushProperties(this.data.index - 1);
      } else {
        this.goToPreviousPage();
      }
    },
    pushProperties: function(index) {
      this.statePushed = true;
      var url = this.getPageUrl(index);
      History.pushState(null, window.document.title, url);
    },
    getViewProperties: function(url) {
      var index = url.split('/')[5];
      return parseInt(index);
    },
    showPage: function(index) {
      var self = this, image = this.data.images[index - 1];
      if (!self.evLoading) {
        self.evLoading = setTimeout(function() {
          $('#js-wait').show();
        }, 100);
      }
      if (image) {
        var temp = new Image();
        temp.src = this.getImageUrl(image);
        temp.onload = function() {
          $('#arf-reader').attr('src', temp.src);
          self.updatePage(index);
        };
      } else
        ARFfwk.doMessage.error('Nothing to show.. :(', 'danger');
    },
    updatePage: function(index) {
      this.data.index = index;
      window.document.title = 'Page ' + index + ' | ' + this.data.title;
      this.updateDom(index);
      this.preLoad(index);

      if (index % 5 == 0) {
        this.rla();
      }

      $('#js-wait').hide();
      clearTimeout(this.evLoading);
      this.evLoading = null;
      this.statePushed = false;
      $('html, body').animate({
        scrollTop: $('#js-reader').offset().top
      }, 300);
    },
    rla: function() {
      ARFfwk.Brackets.assign();
    },
    preLoad: function(index) {
      var self = this;
      if (ARFfwk.savePrefs.get('preloadImages') == 1) {
        var image, i = 0;
        while (i < self.data.preloadLimit) {
          image = self.data.images[index];
          if (image)
            (new Image()).src = self.getImageUrl(image);
          index++;
          i++;
        }
      }
    },
    getImageUrl: function(image) {
      if (this.data.mangaID % 2 == 0)
        return 'https://static.hentai.direct/hentai' + image;
      else
        return 'https://static.hentaicdn.com/hentai' + image;
    },
    getPageUrl: function(index) {
      return this.data.currentURL + index + '/';
    },
    goToNextPage: function() {
      if (this.isEmpty(this.data.nextURL))
        this.loadUrl(this.data.mainURL + 'coming-soon/1/');
      else
        this.loadUrl(this.data.nextURL);
    },
    goToPreviousPage: function() {
      if (this.isEmpty(this.data.previousURL))
        this.loadUrl(this.data.mainURL);
      else
        this.loadUrl(this.data.previousURL);
    },
    loadUrl: function(url) {
      ARFfwk.doHotkeys.loading = true;
      window.location = url;
    },
    isEmpty: function(str) {
      return (!str || 0 === str.length);
    },
    updateDom: function(index) {
      var self = this, imagesCount = self.data['images'].length;
      $('[data-reader="page-progress"]').html(index + ' of ' + imagesCount);
      if (index == 1) {
        if (self.isEmpty(self.data.previousURL))
          $('.js-page_previous').attr('disabled','disabled');
        else
          $('.js-page_previous').removeAttr('disabled');
      } else {
        $('.js-page_previous').removeAttr('disabled');
      $('.js-reader_pages').each(function() {
        if ($(this).data('pagid') == index)
          $(this).addClass('bg-info');
        else if ($(this).hasClass('bg-info'))
          $(this).removeClass('bg-info');
      });
      }
      if (index == imagesCount) {
        if (self.isEmpty(self.data.nextURL))
          $('.js-page_next').attr('disabled','disabled');
        else
          $('.js-page_next').removeAttr('disabled');
      } else
        $('.js-page_next').removeAttr('disabled');
    }
  };
}(jQuery));
(function($) {
  ARFfwk.createTooltip = {
    init: function(isMobile) {
      var self = this,
          series_cache = (self.isExist('ttps')) ? self.isExist('ttps') : {},
          mangaID = 0;
      $('.mangaPopover').qtip({
        content: {
          title: function() { return $(this).data('title'); },
          text: function(event, api) {
            mangaID = $(this).data('mid');
            if (mangaID in series_cache) {
              return self.create(series_cache[mangaID]);
            } else {
              ARFfwk.doAjax.call({controller: 'manga', action: 'tooltip', mid: mangaID}, function(data) {
                series_cache[mangaID] = data.response;
                self.save(series_cache);
                api.set('content.text', self.create(series_cache[mangaID]));
              });
            }
            return '<i class="fa fa-circle-o-notch fa-spin"></i> Loading...';
          }
        },
        show: (isMobile ? {} : {delay: 500}),
        hide: 'unfocus mouseleave',
        position: {
          my: 'top center',
          at: 'bottom center',
          viewport: $(window)
        },
        style: 'qtip-light'
      }); 
    },
    create: function(data) {
      var html = '';
      if (!data)
        html = '<div class="col-xs-12"><div class="bg-black text-white">Information Not Available</div></div>';
      else {
        html = '<div class="row">';
        html += '<div class="col-xs-4 popover-cover">';
        html += '<div class="img-container ribbon ribbon-modern ribbon-danger ribbon-left">';
        html += '<img src="' + data.cvr + '" class="img-responsive border-black-op">';
        html += '<div class="ribbon-box font-w600"><i class="si fa-fw si-fire"></i>' + (data.rnk ? data.rnk : '-') + '</div></div></div>';
        html += '<div class="col-xs-8 popover-info">';
        html += '<ul class="list">';
        if (data.alt)
          html += '<li><p class="text-muted">' + (data.alt ? data.alt : '-') + '</p></li>';
        html += '<li>Artist: <b class="tagButton">' + (data.ats ? data.ats : '-') + '</b></li>';
        html += '<li>Status: <b class="tagButton">' + data.sts + '</b></li>';
        html += '<li>Read: <b class="tagButton">' + data.vws + ' times</b></li>';
        html += '<li>Page: <b class="tagButton">' + data.pge + ' pages';
        if (data.chp > 1)
          html += ' / ' + data.chp + ' chapters';
        html += '</b></li>';
        if (data.yer)
          html += '<li>Release in: <b class="tagButton">' + (data.yer ? data.yer : '-') + '</b></li>';
        html += '<li>Category: ' + data.ctt[8] + '</li>';
        html += '<li>Content: ' + data.ctt[5] + '</li>';
        if (data.ctt[3])
          html += '<li>Parody: ' + data.ctt[3] + '</li>';
        if (data.dsc.length > 0 && data.dsc != 'Nothing yet!')
          html += '<li>Storyline: <p class="text-muted">' + data.dsc + '</p></li>';
        html += '</ul></div>';
        html += '</div>';
      }
      return html;
    },
    reset: function() {
      var today =  (new Date().getTime() / 1000).toFixed(0);
      if (ARFfwk.storeData.get('isReset') == undefined)
        ARFfwk.storeData.set('isReset', today);
      else if (today >= (parseInt(ARFfwk.storeData.get('isReset')) + 72*3600)) {
        ARFfwk.storeData.del('ttps');
        ARFfwk.storeData.set('isReset', today);
      } else
        return false;
    },
    isExist: function() {
      if (ARFfwk.storeData.get('ttps') == undefined)
        return false;
      else 
        return JSON.parse(ARFfwk.storeData.get('ttps'));
    },
    save: function(data) {
      ARFfwk.storeData.set('ttps', JSON.stringify(data));
    }
  };
  $(function() {
    ARFfwk.createTooltip.reset('ttps');
  });
}(jQuery));
(function($) {
  ARFfwk.doSearch = {
    search: function() {
      $('.rf-search').autocomplete({
        lookup: function (query, done) {
          ARFfwk.doAjax.call({controller: 'search', action: 'all', query: query}, function(data) {
            done(data.response);
          });
        },
        onSelect: function (suggestion) {
          window.location.href= suggestion.slug;
        },
        groupBy: 'category',
        minChars: 3
      });
    }
  };
  $(function() {
    ARFfwk.doSearch.search();
  });
}(jQuery));
(function($) {
  ARFfwk.doReport = {
    init: function () {
      var self = this;
      $('#rp-submit').click(function() {
        if (self.checkEmail($('#report-email').val())) {
          var emailTo = $('#report-email').val(),
              reason = $('#report-reason option:selected').text(),
              rcomment = $('#report-message').val(),
              thisURL = window.location.href;
          if (reason == 'Select One')
            $('#rptForm-err2').addClass('has-error');
          else {
            ARFfwk.doAjax.call({controller: 'manga', action: 'report', report_email: emailTo, report_reason: reason, report_comment: rcomment, report_page: thisURL},
              function(r) {
              ARFfwk.doMessage.error(r.message, r.code);
              $('#rf-report').modal('hide');
            });
          }
        } else
          $('#rptForm-err1').addClass('has-error');
      });
    },
    checkEmail: function (email) {
      var pattern = /^([a-z\d!#$%&'*+\-\/=?^_`{|}~\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+(\.[a-z\d!#$%&'*+\-\/=?^_`{|}~\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+)*|"((([ \t]*\r\n)?[ \t]+)?([\x01-\x08\x0b\x0c\x0e-\x1f\x7f\x21\x23-\x5b\x5d-\x7e\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]|\\[\x01-\x09\x0b\x0c\x0d-\x7f\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))*(([ \t]*\r\n)?[ \t]+)?")@(([a-z\d\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]|[a-z\d\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF][a-z\d\-._~\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]*[a-z\d\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])\.)+([a-z\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]|[a-z\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF][a-z\d\-._~\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]*[a-z\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])\.?$/i;
      return pattern.test(email);
    }
  };
  $(function() {
    ARFfwk.doReport.init();
  });
}(jQuery));
(function ($) {
  ARFfwk.Brackets = {
    _zones: null,
    _hasAb: null,
    _targetClass: null,
    init: function (zones, target, hasAb) {
      this._targetClass = target;
      this._hasAb = hasAb;
      this._zones = zones;
      this.assign();
    },
    assign: function () {
      let self = this,
        zones = self._zones,
        t = +new Date();
      if (this._hasAb)
        this.loadNVB();
      else {
        $(self._targetClass).each(function () {
          let zone = $(this),
            d = zone.data();
          if (!d.time || d.time + d.refresh * 1000 < t) {
            if (zones[d.type]) {
              let selection = self._hasAb ? "blocked" : "default",
                selected = zones[d.type][selection];
              if (selected) {
                let size = self.screenSize();
                zone.attr("data-time", t);
                zone.html(zones[selected][size]);
              }
            }
          }
        });
	(AdProvider = window.AdProvider || []).push({"serve": {}});
      }
    },
    loadNVB: function () {
      let self = this,
        http = new XMLHttpRequest();
      http.onreadystatechange = function () {
        if (http.readyState === 4 && http.status === 200) {
          const nvb = JSON.parse(http.responseText);
          $(self._targetClass).each(function () {
            if ($(this).data('type') == 'ark-lilith')
              $(this).html(nvb[300]);
            else
              $(this).html(nvb[self.screenSize()]);
          });
        }
      };
      http.open("GET", "https://hentai2read.com/ark/arkAPI.php");
      http.send();
    },
    screenSize: function () {
      if ($(document).width() > 1313)
        return 1300;
      else if ($(document).width() > 908)
        return 900;
      else if ($(document).width() > 736)
        return 728;
      else {
        if (_today <= 4)
            return 100;
        else
            return 300;
      }
    },
    isMobile: function () {
      return /Mobi/i.test(window.navigator.userAgent);
    }
  };
})(jQuery);

$(document).ready(function(){
  // Browser Accept Cookies
  if (!cookiesEnabled()) ARFfwk.doMessage.error('This site require cookie to operate properly, please enable cookie on your browser!', 'danger');
  // Surprise Button on Left side
  $('#hmeSurprise').click(function() {
    ARFfwk.doAjax.call({controller: 'manga', action: 'surprise'}, function(data) {
    	window.location.href = data.response;
    });
  });
  // Get & Store Announcement
  if (enableNews) {
    if (Cookies.get('news') == undefined) {
      $.getScript('//forum.hentai2read.com/external.php?type=js&forumids=2')
        .done(function() {
          var news = {'name' : 'Invalid'};
          if (threads.length > 0) {
            news.url = '//forum.hentai2read.com/showthread.php?t=' + threads[0].threadid;
            news.name = threads[0].title;
            news.date = ' [' + threads[0].threaddate + ' ' + threads[0].threadtime + ']';
            $('#announcement')
              .append('<a class="link-effect" href="' + news.url + '">' + news.name + '</a><small>' + news.date + '</small>')
              .removeClass('hide');
          }
          Cookies.set('news', JSON.stringify(news), {expires: 1, path: '/'});
        });
    } else {
      var news = JSON.parse(Cookies.get('news'));
      if (news.name !== 'Invalid') {
        $('#announcement')
          .append('<a class="link-effect" href="' + news.url + '">' + news.name + '</a><small>' + news.date + '</small>')
          .removeClass('hide');
      }
    }
  }
});
function cookiesEnabled() {
  var check = Cookies.set('check', 'valid', { expires: 1 }) && Cookies.get('check') == 'valid';
  Cookies.remove('check');
  return check;
}
</script>

</body>
</html>
