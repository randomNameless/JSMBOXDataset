<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>mpb_portada.html</title>
</head>
<body>

<script>
var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.findInternal=function(b,c,d){b instanceof String&&(b=String(b));for(var e=b.length,f=0;f<e;f++){var h=b[f];if(c.call(d,h,f,b))return{i:f,v:h}}return{i:-1,v:void 0}};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;
$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(b,c,d){b!=Array.prototype&&b!=Object.prototype&&(b[c]=d.value)};$jscomp.getGlobal=function(b){return"undefined"!=typeof window&&window===b?b:"undefined"!=typeof global&&null!=global?global:b};$jscomp.global=$jscomp.getGlobal(this);
$jscomp.polyfill=function(b,c,d,e){if(c){d=$jscomp.global;b=b.split(".");for(e=0;e<b.length-1;e++){var f=b[e];f in d||(d[f]={});d=d[f]}b=b[b.length-1];e=d[b];c=c(e);c!=e&&null!=c&&$jscomp.defineProperty(d,b,{configurable:!0,writable:!0,value:c})}};$jscomp.polyfill("Array.prototype.find",function(b){return b?b:function(b,d){return $jscomp.findInternal(this,b,d).v}},"es6","es3");
$(document).ready(function(){var b=new Mediator,c=new Mediator,d=new Mediator,e=$('#tabs-mapa-prediccion li[data-mostrar-datos-pr="PB"]').attr("data-fecha-pr"),f=$('#tabs-mapa-prediccion li[data-mostrar-datos-pr="CAN"]').attr("data-fecha-pr"),h={fireAction:function(a,c){var d=b.getState().param,e=b.getState().ambito,f=b.getState().zoom,q=b.getState().resumen,g=b.getState().fecha,h=b.getState().dia,k=b.getState().intervalo;"param"in a&&d!=a.param||"ambito"in a&&e!=a.ambito?b.setState({param:"param"in
a?a.param:d,ambito:"ambito"in a?a.ambito:e,zoom:"zoom"in a?a.zoom:f,resumen:"resumen"in a?a.resumen:q,dia:"dia"in a?a.dia:h,fecha:"fecha"in a?a.fecha:g,intervalo:"intervalo"in a?a.intervalo:k},c):b.setState(a,c)}},m={fireAction:function(a,b){var d=c.getState().ambito,e=c.getState().zoom,f=c.getState().resumen,g=c.getState().fecha,h=c.getState().dia;"ambito"in a&&d!=a.ambito?c.setState({ambito:"ambito"in a?a.ambito:d,zoom:"zoom"in a?a.zoom:e,resumen:"resumen"in a?a.resumen:f,dia:"dia"in a?a.dia:h,
fecha:"fecha"in a?a.fecha:g},b):c.setState(a,b)}},p={fireAction:function(a,b){n.getTimeline(a).then(function(c){c=c[0];0<c.length&&(c=c[0].Elementos.sort(function(a,b){a=new Date(a.Fecha);return(new Date(b.Fecha)).getTime()-a.getTime()})[0],a.fecha=c.Fecha,a.fichero=c["Nombre fichero"]);d.setState(a,b)}).fail(function(a,b){console.log(b)})}},k=new PrediccionService,l=new AvisosService,n=new RadarService;MapComponent.include(ShowLines);MapComponent.include(ShowVariables);MapComponent.include(ShowNames);
MapComponent.include(ShowAvisos);MapComponent.include(ShowRadar);var r=(new MapComponent("mapa_prediccion",[L.penBalTileLayer("PB","Tiles_sa_epsg4326_verde","mapa_prediccion"),L.canariasTileLayer("CAN","Tiles_sa_epsg3857_verde","mapa_prediccion")],{removeZoom:!0,zoomDelta:.1,zoomSnap:0,doubleClickZoom:!1,scrollWheelZoom:!1,draggable:!1})).addLimitLines(k,{interactive:!0,opacity:.65,weight:.65,color:"#677e76",fillColor:"#9dbbb1",fillOpacity:0,fillColorSelected:"#677e76",fillOpacitySelected:.6,weightSelected:.8}).addVariablesLayer(k,
{},{showPopups:!1,iconSize:"21"});l=(new MapComponent("mapa_avisos",[L.penBalTileLayer("PB","Tiles_sa_epsg4326_gris","mapa_avisos"),L.canariasTileLayer("CAN","Tiles_sa_epsg3857_hillshade","mapa_avisos")],{removeZoom:!0,zoomDelta:.1,zoomSnap:0,doubleClickZoom:!1,scrollWheelZoom:!1,draggable:!1})).addLimitLines(k,{interactive:!0,opacity:.5,weight:.6,color:"#696767",fillColor:"#696767",fillOpacity:0,fillColorSelected:"#ffffff",fillOpacitySelected:.2,weightSelected:2.5}).addAvisosLayer("#pestana-tipo-aviso",
l,{},{showPopups:!1,scrollWheelZoom:!1});var t=(new MapComponent("mapa_radar",[L.penBalPaisesTileLayer("PB","Tiles_sa_epsg4326_gris","mapa"),L.canariasTileLayer("CAN","Tiles_sa_epsg3857_hillshade","mapa")],{useStateZoom:!0,zoomSnap:0,removeZoom:!0,doubleClickZoom:!1,scrollWheelZoom:!1,draggable:!1})).addLimitLines(k,{interactive:!0,opacity:.65,weight:.65,color:"#677e76",fillColor:"#9dbbb1",fillOpacity:0,fillColorSelected:"#677e76",fillOpacitySelected:.6,weightSelected:.8},{enableLocation:!1,showPaises:!0,
zoomLinea:{4:7,5:7,6:7,7:8,8:8,9:8}}).addRadarLayer(void 0,n);b.addComponent(r);c.addComponent(l);d.addComponent(t);var g=void 0;k.getTimeLine({param:"eCielo",ambito:"PB"}).then(function(a){a=a[0];g={PB:seleccionarRango(a,"PNB",e),CAN:seleccionarRango(a,"CAN",f)};h.fireAction({ambito:"PB",param:"eCielo",zoom:6,dia:g.PB.dia,intervalo:g.PB.interval_utc,fecha:g.PB.F_ini});var b=new Date(g.PB.F_ini);a=$(".subtitulo_pred_espana div:first-child").html();var c=$(".subtitulo_pred_espana").first().attr("data-locale");
"va"==c&&(c="ca");b=b.toLocaleDateString(c,{weekday:"long",year:"numeric",month:"long",day:"numeric"});a="{{prediccion}} {{fecha}} ({{ini}}-{{fin}} h.)".replace("{{prediccion}}",a).replace("{{fecha}}",b).replace("{{ini}}",g.PB.F_ini.substring(11,13)).replace("{{fin}}",g.PB.F_fin.substring(11,13));$(".subtitulo_pred_espana div:first-child").html(a);$(".subtitulo_pred_espana").attr("title",a)}).fail(function(a){});m.fireAction({ambito:"PB",zoom:6,dia:"D+0",fecha:e,resumen:!0});p.fireAction({ambito:"PB",
param:"compo"});$("div").find("[data-mostrar-datos-pr]").on("click",function(a){$("div").find("[data-mostrar-datos-pr]").removeClass("ambito-selected");$(this).addClass("ambito-selected");a=$(this).attr("data-mostrar-datos-pr");h.fireAction({ambito:a,param:"eCielo",zoom:"CAN"!=a?6:7,resumen:!0,fecha:g[a].F_ini})});$("div").find("[data-mostrar-datos-av]").on("click",function(a){$("div").find("[data-mostrar-datos-av]").removeClass("ambito-selected");$(this).addClass("ambito-selected");a=$(this).attr("data-mostrar-datos-av");
m.fireAction({ambito:a,zoom:"CAN"!=a?6:7,fecha:"CAN"!=a?e:f,resumen:!0})});$("div").find("[data-mostrar-datos-rd]").on("click",function(a){$("div").find("[data-mostrar-datos-rd]").removeClass("ambito-selected");$(this).addClass("ambito-selected");a=$(this).attr("data-mostrar-datos-rd");p.fireAction({ambito:a,param:"CAN"==a?"PPI":"compo",radar:"CAN"==a?"LPA":void 0})})});
function seleccionarRango(b,c,d){if(void 0==d||!$.trim(d))return b[c].resumen[0];var e=void 0;d=new Date(d);b=b[c].resumen;for(c=0;c<b.length;c++){var f=b[c],h=new Date(f.F_fin);if(new Date(f.F_ini)<=d&&d<=h){e=f;break}}return e};

</script>

</body>
</html>
