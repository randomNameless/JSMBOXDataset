<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>icyveins-content-ebca7b9b0935ee0fb796192264797d3d.html</title>
</head>
<body>

<script>
jQuery.noConflict();

function transmogrification_hover_enter_function() {
  thumbnails = jQuery(this).parent().children();
  if (typeof thumbnails_source_length == "undefined") {
    if (thumbnails.length != 0) {
      thumbnails_source_length = - thumbnails.first().offset().left + 135 + 
      Math.max.apply(Math, thumbnails.map(function() {
        return jQuery(this).offset().left;
      }));
    }
  }
  thumbnails_el = thumbnails.first();
  source_el =  jQuery(this).children(".transmogrification_thumbnail_source").first();
  top_position = jQuery(this).offset().top - thumbnails_el.offset().top + 135;
  source_el.css("width", thumbnails_source_length);
  source_el.css("top", top_position + "px");
  source_el.css("left", "0px");
  source_el.show();
}
function transmogrification_hover_exit_function() {
  source_el = jQuery(this).children(".transmogrification_thumbnail_source").first();
  source_el.hide();
}

jQuery(document).ready(function(){

  // TABLE OF CONTENT
  jQuery("ul.toc>li.toc_expandable>span, ul.toc>li.toc_expanded>span").click(function () {
    if (jQuery(this).parent().hasClass("toc_expanded")) {
      jQuery(this).parent().addClass("toc_expandable");
      jQuery(this).parent().removeClass("toc_expanded");
      jQuery(this).html("+");
      jQuery(this).parent().children().last().hide();
    } else {
      jQuery(this).parent().addClass("toc_expanded");
      jQuery(this).parent().removeClass("toc_expandable");
      jQuery(this).html("&#215;");
      jQuery(this).parent().children().last().show();
    }
  });

  // TABLE PARTS TO HIDE
  jQuery(".table_hide_anchor").nextUntil(".table_hide_anchor").hide();
  jQuery(".table_hide_anchor").each(function() {
    jQuery(this).children().append("<span class=\"table_hide_anchor_display_button\" style=\"margin-left:20px; color:#ffe366;cursor:pointer; font-size:14px; font-weight:normal;\">+ display</span>");
    jQuery(this).children().append("<span class=\"table_hide_anchor_hide_button\" style=\"display:none; margin-left:20px; color:#ffe366;cursor:pointer; font-size:14px; font-weight:normal;\">- hide</span>");
  });
  jQuery(".table_hide_anchor_display_button").click(function() {
    jQuery(this).next().show();
    jQuery(this).hide();
    jQuery(this).parent().parent().nextUntil(".table_hide_anchor").show();
  });
  jQuery(".table_hide_anchor_hide_button").click(function() {
    jQuery(this).parent().parent().nextUntil(".table_hide_anchor").hide();
    jQuery(this).hide();
    jQuery(this).prev().show();
  });

//  // Top Button - disable for the forums and root
//  if (window.location.pathname.match(/forums/) == null && window.location.pathname.match(/\/$/) == null) {
//    var page_top_container = jQuery('#page_top_container');
//    var page_top = jQuery('#page_top');
//    var center_bottom = jQuery("#center").offset().top + jQuery("#center").height();
//    var right_bottom = jQuery("#right").offset().top + jQuery("#right").height();
//    if (center_bottom > right_bottom) {
//      jQuery(window).scroll(function (event) {
//        var bottom_container = page_top_container.offset().top + 37 + 20; // page_top_container + height + margin
//        var bottom = page_top.offset().top + 37; // page_top + height
//        var window_bottom = jQuery(this).scrollTop() + jQuery(window).height();
//        center_bottom = jQuery("#center").offset().top + jQuery("#center").height();
//        //alert("bottom: " + bottom + " / window_bottom: " + window_bottom + " / center_bottom: " + center_bottom);
//        // In initial position
//        if (page_top.css('position') == "static" && (window_bottom > bottom_container)) {
//          page_top.css("position", "fixed");
//          page_top.css("bottom", "20px");
//          page_top.css("display", "block");
//        } else if (page_top.css('position') == 'fixed' && !(window_bottom > bottom_container)) {
//          page_top.css("display", "none");
//          page_top.css("position", "static");
//          page_top.css("bottom", "auto");
//        } else if (page_top.css('position') == 'fixed' && window_bottom - 20 > center_bottom) {
//          page_top.css("position", "absolute");
//          page_top.css("bottom", "-" + (center_bottom - bottom + 37 + 20) + "px");
//        } else if (page_top.css('position') == 'absolute' && !(window_bottom - 20 > center_bottom)) {
//          page_top.css("position", "fixed");
//          page_top.css("bottom", "20px");
//        }
//      });
//    }
//  }

  jQuery(".transmogrification_thumbnail").hover(transmogrification_hover_enter_function,
      transmogrification_hover_exit_function);

  const getContentOffset = () => {
    return 50 /* minified header */
           + (window.icyveins?.layout?.minifiedNavHeight /* set in Page#javascript_data */ ?? 36 /* default minified nav size */)
           + 4 /* to have some spacing between nav and content */;
  }
  // Links / Anchors
  for (const anchor of document.getElementsByTagName("a")) {
    anchor.addEventListener("click", function(event) {
      const href = this.href;

      // Link without the href attributes
      if (!href) return;

      // We are navigating within this page
      const isSamePage = this.hostname === location.hostname && this.pathname === location.pathname && (!this.search || this.search === location.search);
      if (/^#/.test(href) || isSamePage) {
        event.preventDefault();
        // If on desktop, then account for the minified header when following the anchor
        const isDesktop = document.documentElement.clientWidth >= 1070;
        const offsetChange = isDesktop ? getContentOffset() : 0;
        window.scroll(0, document.getElementById(this.hash.slice(1)).offsetTop - offsetChange);
        // Change the window history to lead to this href
        history.replaceState(history.state, null, href);
        return;
      }

      // Link to another page, we let other onclick listeners handle it
      return;
    });
  }
  if (window.location && window.location.hash != "" && !window.location.pathname.match(/calculator/)) {
    setTimeout(function() {
      window.scrollTo(0, jQuery(window.location.hash).offset().top - getContentOffset());
    }, 250);
  }

  jQuery(".local_date").each(function() {
    current_time = new Date();
    date_to_change = new Date(jQuery(this).attr("data-time") * 1000);
    jQuery(this).find(".local_date_hour").text(("0" + date_to_change.getHours()).slice(-2) + ":" +
        ("0" + date_to_change.getMinutes()).slice(-2));
    if (current_time.getFullYear() == date_to_change.getFullYear() &&
        current_time.getMonth() == date_to_change.getMonth() &&
        current_time.getDate() == date_to_change.getDate()) {
      jQuery(this).find(".local_date_date").text("Today");
    } else {
      yesterday = new Date(current_time - 86400000);
      if (yesterday.getFullYear() == date_to_change.getFullYear() &&
          yesterday.getMonth() == date_to_change.getMonth() &&
          yesterday.getDate() == date_to_change.getDate()) {
        jQuery(this).find(".local_date_date").text("Yesterday");
      } else {
        month_short_names = ["Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec"];
        jQuery(this).find(".local_date_date").text(month_short_names[date_to_change.getMonth()] + " " +
            ("0" + date_to_change.getDate()).slice(-2) + ", " + date_to_change.getFullYear());
      }
    }
  });

  center_proper_rectangle = function() {
    jQuery(".page_content .proper-ad-unit").each(function(index) {
      if (jQuery(this).height() > 130 && jQuery(this).width() > 350) {
        jQuery(this).css("width", "300px");
      }
    });
    setTimeout(center_proper_rectangle, 5000);
  }
  center_proper_rectangle();

  jQuery("#changelog_show_all").click(function() {
    jQuery("#changelog_show_all").hide();
    jQuery("#changelog_show_only_2").show();
    jQuery(".changelog>li:nth-child(n+3)").show();
  });
  jQuery("#changelog_show_only_2").click(function() {
    jQuery("#changelog_show_only_2").hide();
    jQuery("#changelog_show_all").show();
    jQuery(".changelog>li:nth-child(n+3)").hide();
  });
  if (jQuery(".changelog>li").length <= 2) {
    jQuery("#changelog_show_all").hide();
  }

  if (getCookie('ips4_member_premium')) {
    jQuery("div[id^=div-gpt-ad]").remove();
    jQuery("div.proper-ad-unit").remove();
    jQuery("div.rectangle_container").remove();
  }

  jQuery(".icyveins_tabs").each(function() {
    var icyveins_tabs_div = this;
    var header_count = [0, 0, 0];
    jQuery(this).children().each(function() {
      if (this.tagName == "H2") {
        header_count[0] = 1;
      } else if (this.tagName == "H3") {
        header_count[1] = 1;
      } else if (this.tagName == "H4") {
        header_count[2] = 1;
      }
      if (header_count[0] + header_count[1] + header_count[2] == 1) {
        jQuery(icyveins_tabs_div).addClass("icyveins_tabs_activated");
        jQuery(icyveins_tabs_div).children(":header").first().addClass("icyveins_tabs_header_active");
      }
      console.log(this.tagName);
    });
  });
});


document.addEventListener("DOMContentLoaded", function(event) {
  document.querySelectorAll("div.spoiler>span").forEach(function(span, index) {
    span.addEventListener("click", function(event) {
      span.parentElement.querySelectorAll("blockquote").forEach(function(blockquote, index) {
        if (blockquote.style.display == "none" || blockquote.style.display == "") {
          blockquote.style.display = "block";
        } else {
          blockquote.style.display = "none";
        }
      });
    });
  });

  let scroll_options = {
    root: null,
    rootMargin: "0px",
    threshold: 1.0
  }

  let already_seen = [];

  let scroll_callback = (entries, observer) => {
    entries.forEach(entry => {
      if (entry.isIntersecting) {
        if (!already_seen.includes(entry.target.textContent)) {
          dataLayer.push({'event': 'visibility', 'content': entry.target.textContent});
        }
      }
    });
  };

  let observer = new IntersectionObserver(scroll_callback, scroll_options)

  document.querySelectorAll(".heading_container.heading_number_2").forEach(function(div, index) {
    observer.observe(div);
  });
}); 



</script>

</body>
</html>
