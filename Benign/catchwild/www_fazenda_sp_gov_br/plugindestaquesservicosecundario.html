<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>plugindestaquesservicosecundario.html</title>
</head>
<body>

<script>
var numeroDestaques,PST=PST||{};PST.DestaquesServicoSecundario={ctx:void 0,collListItem:void 0,Buscar:function(){PST.DestaquesServicoSecundario.ctx=new SP.ClientContext;var e=(PST.DestaquesServicoSecundario.ctx.get_web(),PST.DestaquesServicoSecundario.ctx.get_web().get_lists().getByTitle("Destaque de Serviços Secundários"));PST.DestaquesServicoSecundario.ctx.load(e);var t=new SP.CamlQuery;t.set_viewXml("<View><Query><OrderBy><FieldRef Name='Ordem' Ascending='True' /></OrderBy></Query><RowLimit>10</RowLimit></View>"),PST.DestaquesServicoSecundario.collListItem=e.getItems(t),PST.DestaquesServicoSecundario.ctx.load(PST.DestaquesServicoSecundario.collListItem),PST.DestaquesServicoSecundario.ctx.executeQueryAsync(Function.createDelegate(this,PST.DestaquesServicoSecundario.onQuerySucceeded),Function.createDelegate(this,PST.DestaquesServicoSecundario.onQueryFailed))},GetItems:function(){for(var e,t=[],i=[],o=PST.DestaquesServicoSecundario.collListItem.getEnumerator();o.moveNext();)t={Titulo:(e=o.get_current()).get_item("Title"),Icone:e.get_item("Icone"),Link:e.get_item("Link").get_url(),Ordem:e.get_item("Ordem"),AbrirLink:e.get_item("AbrirLink")},i.push(t);PST.DestaquesServicoSecundario.MontarAviso(i),numeroDestaques=i.length},MontarAviso:function(e){$.get("/BibliotecaDeScripts/TemplateHTML/TemplateDestaquesServicoSecundario.html",function(t){var i=_.template(t)({Conteudo:e});$("#theCarousel").append(i)})},onQuerySucceeded:function(e,t){PST.DestaquesServicoSecundario.GetItems()},onQueryFailed:function(e,t){console.log("Não foi possível recuperar os dados de avisos")}},$(document).ready(function(){_.templateSettings={interpolate:/\{\{(.+?)\}\}/g,evaluate:/\{%([\s\S]+?)%\}/g,escape:/\{%-([\s\S]+?)%\}/g},SP.SOD.loadMultiple(["SP.Runtime.js","SP.js"],function(){PST.DestaquesServicoSecundario.Buscar()})});
</script>

</body>
</html>
