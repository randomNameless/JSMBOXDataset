<!DOCTYPE html>

<html lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>hsm-creative-manager.563.html</title>
</head>
<body>
<script>(()=>{"use strict";var e,t,i,s,r={397:(e,t,i)=>{i.d(t,{fH:()=>Ce,yg:()=>ye,iJ:()=>Te});var s,r=i(655),n=i(448);class o{constructor(){this.eventListeners={}}on(e,t){this.eventListeners[e]=this.eventListeners[e]||[],this.eventListeners[e].push(t)}once(e,t){const i=s=>{t(s),this.off(e,i)};this.on(e,i)}off(e,t){var i;this.eventListeners[e]=t?null===(i=this.eventListeners[e])||void 0===i?void 0:i.filter((e=>e!==t)):[]}emit(e,t){var i;null===(i=this.eventListeners[e])||void 0===i||i.forEach((e=>e(t)))}}function a({timeout:e=0}={}){let t=!1;const i={},s=new Promise(((e,s)=>{i.done=i=>{t||(t=!0,e(i))},i.abort=e=>{t||(t=!0,s(e))}}));return e&&setTimeout((()=>{t||i.abort(`Timeout ${e}ms exceeded`)}),e),i.ready=s,i}class d{constructor(e,t,i,s){var r;this.adserver=e,this.element=t,this.config=i,this.params=s,this.name=n.Vc.ADFOX,this.events=new o,this.hadStub=!1,this.events.on("render",(()=>this.events.emit("bannerSize",{x:this.element.offsetWidth,y:this.element.offsetHeight}))),this.hasPrebid=!!(null===(r=this.params.adfox)||void 0===r?void 0:r.prebidAdUnit)}get debugLog(){return Object.assign({},this.params.adfox)}display({getTargetings:e}){var t,i,s,n,o,a,d,l,h;return(0,r.mG)(this,void 0,void 0,(function*(){yield this.adserver.sdk.ready;const c={};Object.entries(e()).forEach((([e,t])=>{const i=this.adserver.sdk.mapTargeting({key:e,value:t});c[i.key]=i.value}));const{pk:u="",blockAdv:f,puid52:g="",puid51:v=""}=c,m=[u,g.replace(":"," "),v.replace(":"," ")];f&&m.push(f);const p=this.config.adfoxConfig,{type:E,zIndex:S,platform:A,shrinkWrapper:b,creativeConfig:T}=p,C=(0,r._T)(p,["type","zIndex","platform","shrinkWrapper","creativeConfig"]),y=Object.assign(Object.assign(Object.assign({},c),C),{pk:m.join(" "),pke:"1"}),I=(null===(t=this.params)||void 0===t?void 0:t.type)||(null===(i=this.config)||void 0===i?void 0:i.type)||E||(null==T?void 0:T.type),w=(null===(s=this.params)||void 0===s?void 0:s.fullscreenBannerBlacklist)||(null===(n=this.config)||void 0===n?void 0:n.fullscreenBannerBlacklist)||(null==T?void 0:T.fullscreenBannerBlacklist),R=(null===(o=this.config)||void 0===o?void 0:o.zIndex)||S,D=(null===(a=this.params)||void 0===a?void 0:a.platform)||(null===(d=this.config)||void 0===d?void 0:d.platform)||A||(null==T?void 0:T.platform),_=(null===(l=this.params)||void 0===l?void 0:l.shrinkWrapper)||(null===(h=this.config)||void 0===h?void 0:h.shrinkWrapper)||b;this.hasPrebid&&(yield this.adserver.sdk.addPrebidAdunit(this.element.id,this.params.adfox.prebidAdUnit));const k={params:y,containerId:this.element.id,onLoad:e=>{this.events.emit("data",e)},onRender:e=>{this.events.emit("render",e)},onError:e=>this.events.emit("error",e),onStub:()=>this.events.emit("stub"),onClose:()=>this.events.emit("close")};return I&&(k.type=I),R&&(k.zIndex=R),D&&(k.platform=D),w&&w instanceof Array&&w.length>0&&(k.fullscreenBannerBlacklist=w),_&&(k.shrinkWrapper=_),this.events.emit("request",k),this.nativeSlot=yield this.adserver.sdk.createSlot(k),this.waitForDisplay()}))}destroy(){var e;return(0,r.mG)(this,void 0,void 0,(function*(){null===(e=this.nativeSlot)||void 0===e||e.destroy()}))}refresh(){return this.hadStub?this.nativeSlot.reload({onlyIfWasVisible:!1}):this.nativeSlot.reload(),this.waitForDisplay()}setTargeting(){}waitForDisplay(){const e=a();return this.events.once("render",(()=>{this.hadStub=!1,e.done()})),this.events.once("error",(()=>e.abort())),this.events.once("stub",(()=>{this.hadStub=!0,e.abort()})),e.ready}}class l{constructor(e,t,i,s){var r;this.adserver=e,this.element=t,this.config=i,this.params=s,this.name=n.Vc.GPT,this.events=new o,this.hasBeenDisplayed=!1,this.hasPrebid=!!(null===(r=this.params.gpt)||void 0===r?void 0:r.prebidAdUnit)}get debugLog(){return Object.assign({},this.params.gpt)}display({getTargetings:e}){var t,i;return(0,r.mG)(this,void 0,void 0,(function*(){try{yield this.adserver.sdk.ready}catch(e){return void this.events.emit("error",e)}const{adUnitPath:s,sizes:r}=this.config.gptConfig,n={adUnitPath:(null===(t=this.params.gpt)||void 0===t?void 0:t.adUnitPath)||s,elementId:this.element.id,sizes:{"0x0":r.sizes0x0,"336x0":[...r.sizes0x0,...r.sizes336x0]}};return this.events.emit("request",n),this.nativeSlot=this.adserver.sdk.createSlot(n),this.nativeSlot._hsmCallSlotRenderEnded=e=>this.events.emit("slotRenderEnded",e),this.hasPrebid&&(yield null===(i=this.adserver.sdk.prebid)||void 0===i?void 0:i.applyToSlot(this.params.gpt.prebidAdUnit,n)),Object.entries(e()).forEach((([e,t])=>{this.setTargeting({key:e,value:t})})),this.refresh()}))}refresh(){var e;return(0,r.mG)(this,void 0,void 0,(function*(){return this.hasPrebid&&(yield null===(e=this.adserver.sdk.prebid)||void 0===e?void 0:e.requestBids(this)),this.refreshGoogletagSlot()}))}destroy(){return(0,r.mG)(this,void 0,void 0,(function*(){this.adserver.sdk.destroySlot(this.nativeSlot)}))}refreshGoogletagSlot(e){return this.events.once("slotRenderEnded",(t=>{this.hasBeenDisplayed=!0;const[i,s]=t.size?t.size:[0,0];this.events.emit("bannerSize",{x:i,y:s});const r=null==e?void 0:e();this.events.emit(t.isEmpty?"stub":"render",{event:t,additionalData:r})})),this.adserver.sdk.refreshSlot(this),this.waitForDisplay()}setTargeting(e){var t;const i=this.adserver.sdk.mapTargeting(e);null===(t=this.nativeSlot)||void 0===t||t.setTargeting(i.key,i.value)}waitForDisplay(){const e=a(),t=setTimeout((()=>{this.events.emit("error",{message:"GPT Render Timeout"}),e.abort()}),4e3);return this.events.once("render",(()=>{clearTimeout(t),e.done()})),this.events.once("error",(()=>{clearTimeout(t),e.abort()})),this.events.once("stub",(()=>{clearTimeout(t),e.abort()})),e.ready}}class h{constructor(e,t,i,s){this.adserver=e,this.element=t,this.config=i,this.params=s,this.name=n.Vc.RTB,this.events=new o,this.bannerSize={x:0,y:0},this.events.on("render",(()=>this.events.emit("bannerSize",{x:this.element.offsetWidth,y:this.element.offsetHeight})))}get debugLog(){return Object.assign({},this.params.rtb)}display(){return(0,r.mG)(this,void 0,void 0,(function*(){return this.refresh()}))}refresh(){var e,t,i,s;return(0,r.mG)(this,void 0,void 0,(function*(){yield this.adserver.sdk.ready,this.clearSlot();const{type:r,platform:n}=this.config.rtbConfig,o=(null===(e=this.params)||void 0===e?void 0:e.type)||(null===(t=this.config)||void 0===t?void 0:t.type)||r,a=(null===(i=this.params)||void 0===i?void 0:i.platform)||(null===(s=this.config)||void 0===s?void 0:s.platform)||n,d={adunit:this.config.placement,elementId:this.element.id,blockId:this.config.rtbConfig.id,targetings:[]};o&&(d.type=o),a&&(d.platform=a),this.events.emit("request",d);const l=this.adserver.sdk.createSlot(d);return l.then((()=>this.events.emit("render"))).catch((()=>this.events.emit("error"))),l}))}destroy(){return(0,r.mG)(this,void 0,void 0,(function*(){this.clearSlot()}))}setTargeting(){}clearSlot(){this.element.innerHTML=""}}class c{constructor(e,t,i,s){this.adserver=e,this.element=t,this.config=i,this.params=s,this.name=n.Vc.SCROOGE,this.events=new o,this.events.on("render",(()=>this.events.emit("bannerSize",{x:this.element.offsetWidth,y:this.element.offsetHeight})))}get debugLog(){return Object.assign({},this.params.scrooge)}display(){var e;return(0,r.mG)(this,void 0,void 0,(function*(){yield null===(e=this.slot)||void 0===e?void 0:e.destroy();const t={elementId:this.element.id,adunitId:this.config.id,placement:this.config.placement,advInfoPosition:this.config.advInfoPosition,fill:this.config.scroogeConfig.fill};this.events.emit("request",t);const i=yield this.adserver.sdk.createSlot(t);if(!i)throw"не удалось создать слот";return this.slot=i,this.refresh()}))}refresh(){return(0,r.mG)(this,void 0,void 0,(function*(){return this.slot.once("error",(e=>this.events.emit("error",e))),this.slot.once("stub",(()=>this.events.emit("stub"))),this.slot.once("render",(e=>{this.events.emit("render",e),this.events.emit("data",e)})),this.slot.refresh(),this.waitForDisplay()}))}destroy(){var e;return(0,r.mG)(this,void 0,void 0,(function*(){return null===(e=this.slot)||void 0===e?void 0:e.destroy()}))}setTargeting(){}waitForDisplay(){const e=a();return this.events.once("render",e.done),this.events.once("error",(()=>e.abort())),this.events.once("stub",(()=>e.abort())),e.ready}}!function(e){e.FONTANKA="fontanka.ru"}(s||(s={}));class u{constructor(e){this.title=e,this.isEnabled=!1,this.buffer=[]}get coloredTitle(){return`%c${this.title}`}get enabled(){return this.isEnabled}set enabled(e){if(e!==this.isEnabled&&(this.isEnabled=e,e)){const e=this.buffer;this.buffer=[],e.forEach((e=>this.message(e.type,e.data)))}}info(...e){this.message("info",e)}warn(...e){this.message("warn",e)}error(...e){this.message("error",e)}time(e){this.message("time",e)}timeEnd(e){this.message("timeEnd",e)}errorToSentry(e,t){return(0,r.mG)(this,void 0,void 0,(function*(){try{const i=yield function(e,t,i){return(0,r.mG)(this,void 0,void 0,(function*(){const r=(()=>{const e=Object.values(s).find((e=>window.location.host.includes(e)));if(!e)return!1;const t=window;return e===s.FONTANKA&&{release:t.fntRelease,envType:t.fntConfig.envType}})();if(!r)throw"Вызов sendSentryError с неверным проектом";const n=`${window.location.protocol}//@${window.location.host}/_report/api/35/store/?35`,{release:o,envType:a}=r,d=`${e.title}: ${t}`,l={timestamp:(new Date).toISOString(),platform:"javascript",message:d,release:o,environment:""===a?"production":"development",tags:{envType:a,host:window.location.host},extra:i,request:{url:location.href,headers:{referrer:document.referrer,"user-agent":navigator.userAgent},cookies:document.cookie}},h=yield fetch(n,{body:JSON.stringify(l),method:"POST",headers:{"Content-Type":"application/json",Authorization:"Basic ffe756ced6be49f4b87f30b70d20294d",referrer:"origin"}});if(200===h.status)return h;throw`Unable to report sentry error ${h.status}, ${h.statusText}`}))}(this,e,t);this.info("Отправлен запрос до sentry",i)}catch(e){this.error(e)}}))}message(e,t){this.enabled?"time"!==e&&"timeEnd"!==e?console[e](this.coloredTitle,u.titleStyle,...t):console[e](t):this.buffer.push({type:e,data:t})}}u.titleStyle="background: #343cc9; color: #fff; padding: 0 2px";const f=window.scroogeLogger=new u("[HSM-Creative-Manager]");var g;!function(e){e[e.CREATED=0]="CREATED",e[e.READY=1]="READY",e[e.IN_PROGRESS=2]="IN_PROGRESS",e[e.DESTROYED=3]="DESTROYED",e[e.STUB=4]="STUB",e[e.ERROR=5]="ERROR"}(g||(g={}));class v extends o{constructor(e,t,i,s,r){super(),this.adserver=e,this.adapter=t,this.waitForQueue=i,this.$el=s,this.config=r,this._targetings={},this.status=g.CREATED,this.slotRefreshStartedTime=0,this.bannerSize={x:0,y:0},this.adunit=r.placement,this._logPrefix=`[${this.adapter.name}]: Баннер ${this.$el.id}:`,this.adapter.events.on("request",(e=>{this.emit("request",e),f.info(this._logPrefix,"вызыван код вставки с параметрами:",e)})),this.adapter.events.on("data",(e=>{this.emit("data",e)})),this.adapter.events.on("render",(e=>{this.status=g.READY,this.emit("render",e),f.info(this._logPrefix,`отрисован за ${this.timeSinceLastRefresh} сек.`,e)})),this.adapter.events.on("error",(e=>{this.status=g.ERROR,this.emit("error",e),f.error(this._logPrefix,"ошибка отрисовки слота",e)})),this.adapter.events.on("stub",(e=>{this.status=g.STUB,this.emit("stub",e),f.warn(this._logPrefix,"заглушка")})),this.adapter.events.on("close",(()=>{this.emit("closed"),f.warn(this._logPrefix,"закрыт")})),this.adapter.events.on("bannerSize",(e=>{this.bannerSize=e}))}get targetings(){return Object.assign(Object.assign({},this.adserver.targetings),this._targetings)}get debugLog(){return Object.assign({element:this.$el,adUnit:this.config.placement,config:this.config,bannerSize:this.bannerSize,isDestroyed:this.isDestroyed,targetings:this.targetings,status:this.status},this.adapter.debugLog)}get isDestroyed(){return this.status===g.DESTROYED}get timeSinceLastRefresh(){return(Date.now()-this.slotRefreshStartedTime)/1e3}display(){return(0,r.mG)(this,void 0,void 0,(function*(){this.resetBannerSize(),this.checkRequest("refresh"),this.emit("beforeDisplay"),f.info(this._logPrefix,"начинаем показ"),yield this.adapter.display({getTargetings:()=>this.targetings}),[g.ERROR,g.STUB,g.DESTROYED].includes(this.status)||this.emit("display")}))}refresh(){return(0,r.mG)(this,void 0,void 0,(function*(){if(this.slotRefreshStartedTime=Date.now(),yield this.waitForQueue(),f.info(this._logPrefix,`прождал в очереди приоритетов ${this.timeSinceLastRefresh} сек.`),this.status===g.CREATED)return this.display();this.resetBannerSize(),this.checkRequest("refresh"),this.emit("beforeRefresh"),f.info(this._logPrefix,"начинаем рефреш"),yield this.adapter.refresh(),this.emit("refresh")}))}destroy(){return(0,r.mG)(this,void 0,void 0,(function*(){this.checkDestroyed("destroy"),this.status=g.DESTROYED,this.emit("beforeDestroy"),f.info(this._logPrefix,"начинаем уничтожение"),this.adserver.isReady&&(yield this.adapter.destroy()),this.status=g.DESTROYED,this.resetBannerSize(),this.emit("destroy")}))}setTargeting(...e){e.forEach((e=>this._targetings[e.key]=e.value)),f.info(this._logPrefix,"Проставлены таргетинги",...e),this.checkDestroyed("setTargeting"),e.forEach((e=>this.adapter.setTargeting(e)))}resetBannerSize(){this.bannerSize={x:0,y:0}}throwError(e){const t=new Error(e);return f.warn(this._logPrefix,t,this.debugLog),t}checkRequest(e){if(this.status===g.IN_PROGRESS)throw this.throwError(`${this._logPrefix} слот находится в ожидании ответа`);this.checkDestroyed(e)}checkDestroyed(e){if(this.isDestroyed)throw this.throwError(`${this._logPrefix} слот был уничтожен до запуска ${e}`)}}class m{constructor(e){this.adapter=e,this.targetings={},this.isReady=!1,e.ready.then((()=>{this.isReady=!0,Object.entries(this.targetings).forEach((([e,t])=>{this.adapter.setTargeting({key:e,value:t})}))}))}setTargeting(...e){e.forEach((e=>this.targetings[e.key]=e.value)),this.isReady&&e.forEach((e=>this.adapter.setTargeting(e)))}createSlot(e,t,i,s){const r=this.adapter.createSlot(e,t,i);return new v(this,r,s,e,t)}clearSession(){this.adapter.clearSession()}}const p={};function E(e,t,i){const{src:s}=t;return new Promise(((r,n)=>{const o=e.document.body;if(!o)return void e.document.addEventListener("DOMContentLoaded",(()=>{r(E(e,t,i))}));const a=e.document.createElement("script");a.src=s,a.onload=()=>r({already:!1}),a.onerror=()=>{o.removeChild(a),i>0?r(E(e,t,i-1)):(p[s]=void 0,n(new Error(`Ошибка при загрузке скрипта по URL: ${s}`)))},o.appendChild(a)}))}const S=function(e,t){const{src:i,retries:s=0}=t;return p[i]?p[i].then((()=>({already:!0}))):(p[i]=E(e,t,s),p[i])};function A({name:e,callback:t,attempts:i=20,interval:s=20}){return new Promise(((r,n)=>{!function i(o){t()?r():o<=0?n(new Error(`Превышен лимит попыток при ожидании ${e}.`)):setTimeout((()=>i(o-1)),s)}(i)}))}var b;function T(e,t,i=[]){if(i&&i.indexOf(e)>-1)throw new Error(`Размер экрана ${e} ссылается сам на себя.`);if(!(e in t))throw new Error(`Размер экрана ${e} не указан в списке всех размеров, но используется в списке значений.`);return t[e].reduce(((s,r)=>"string"==typeof r?"fluid"===r?(s.push(r),s):s.concat(T(r,t,[...i,e])):(s.push([...r]),s)),[])}function C(e,t=0){return Object.keys(e).map((i=>{const s=i.match(/(\d+)x(\d+)/);if(!s)throw new Error('Название размера экрана не соответствует формату "d+xd+".');let r=parseInt(s[1],10)-t;return r<0&&(r=0),[[r,parseInt(s[2],10)],T(i,e)]})).sort((([[e,t]],[[i,s]])=>i-e?i-e:s-t))}b=new WeakMap;const y={buckets:[{precision:2,max:4.5,increment:.01},{max:13.5,increment:.02},{max:36,increment:.05},{max:81,increment:.1}]},I=["criteo","between","rubicon","adpone","otm","adriver"];class w{constructor(e,{scriptUrl:t,bidderSettings:i,bidCpmAdjustmentMultiplier:s,priceGranularity:r,allowedBidders:n}){this.window=e,this.name="[GPT Prebid]",this.sizeConfig=[],this.requestBidsTimeoutId=null,this.requestBidsQueue=new Set,f.info(this.name,"начинаем инициализацию");const o=a();this.ready=o.ready,this.allowedBidders=n||I,Object.entries(s).forEach((([e,t])=>{i[e]=Object.assign(Object.assign({},i[e]||{}),{bidCpmAdjustment:e=>e*t})})),this.window.pbjs=this.window.pbjs||{bidderSettings:i,que:[]},this.pbjs.que.push((()=>{const e={priceGranularity:r||y};f.info(this.name,"Задана кастомная грануляция пребида.",e),this.pbjs.setConfig(e)})),this.pbjs.que.push(o.done),o.ready.then((()=>f.info(this.name,"готов к работе"))),S(this.window,{src:t}).catch(o.abort)}get pbjs(){return this.window.pbjs}updateSizeConfig(e){return(0,r.mG)(this,void 0,void 0,(function*(){e.forEach((e=>{const t=this.sizeConfig.find((t=>t.mediaQuery===e.mediaQuery));t?e.sizesSupported.forEach((([e,i])=>{t.sizesSupported.some((([t,s])=>e===t&&i===s))||t.sizesSupported.push([e,i])})):this.sizeConfig.push(e)})),f.info("Обновлен sizeConfig пребида.",this.sizeConfig),yield this.ready,this.pbjs.setConfig({sizeConfig:this.sizeConfig})}))}applyToSlot(e,t){return(0,r.mG)(this,void 0,void 0,(function*(){yield this.ready;const i=Object.assign(Object.assign({},e),{code:t.elementId});i.bids=i.bids.filter((e=>this.allowedBidders.includes(e.bidder))),this.updateSizeConfig(C(t.sizes).reduce(((e,[[t,i],s])=>"string"==typeof s||1===s.length&&"string"==typeof s[0]?e:2!==s.length||Array.isArray(s[0])||Array.isArray(s[1])?(e.push({mediaQuery:`(min-width: ${t}px) and (min-height: ${i}px)`,sizesSupported:s.filter((e=>"string"!=typeof e&&"string"!=typeof e[0]))}),e):("number"==typeof s[0]&&"number"==typeof s[1]&&e.push({mediaQuery:`(min-width: ${t}px) and (min-height: ${i}px)`,sizesSupported:[[s[0],s[1]]]}),e)),[])),this.pbjs.addAdUnits(i),f.info(this.name,"подключен prebid для слота",t.elementId,e)}))}requestBidsInQueue(e){return(0,r.mG)(this,void 0,void 0,(function*(){if(this.requestBidsQueue.add(e),this.requestBidsTimeoutId)return;const t=a();this.requestBidsTimeoutId=window.setTimeout(t.done,w.queueFillingTimeout),yield t.ready,yield this.ready;const i=Array.from(this.requestBidsQueue),s=i.map((e=>e.slot.element.id)),r=a();f.info(this.name,"запрос ставок у биддеров",s),this.pbjs.requestBids({timeout:700,adUnitCodes:s,bidsBackHandler:e=>e&&Object.keys(e).length>0?r.done(e):r.abort()});try{yield r.ready.then((e=>f.info(this.name,"пришел ответ от биддеров",e)))}catch(e){return i.forEach((e=>e.transaction.done(!1))),f.info(this.name,"биддеры не ответили, либо нет доступных ставок",e),this.requestBidsQueue.clear(),void(this.requestBidsTimeoutId=null)}this.pbjs.setTargetingForGPTAsync(s),i.forEach((({slot:e,transaction:t})=>{const i=t=>f.info(this.name,e.element.id,"выиграла ставка пребида",t);t.done(!0),this.pbjs.onEvent("bidWon",i,e.element.id),e.events.once("slotRenderEnded",(()=>{this.pbjs.offEvent("bidWon",i,e.element.id)}))})),this.requestBidsQueue.clear(),this.requestBidsTimeoutId=null}))}requestBids(e){return(0,r.mG)(this,void 0,void 0,(function*(){f.info(this.name,"запрашиваем prebid для слота",e.element.id);const t=a();return this.requestBidsInQueue({slot:e,transaction:t}),t.ready}))}}var R,D,_,k;function O(){return(0,r.mG)(this,void 0,void 0,(function*(){return new Promise((e=>{const t=document.createElement("div");t.innerHTML="&nbsp;",t.className=["adsbox","advertisement","pub_300x250","pub_300x250m","pub_728x90","text-ad textAd","text_ad","text_ads","text-ads","text-ad-links"].join(" "),t.id="text_ad",t.style.padding="1px 0 0 0",document.body?(document.body.appendChild(t),setTimeout((()=>{e(0===t.offsetHeight),document.body.removeChild(t)}),10)):e(!1)}))}))}w.queueFillingTimeout=100,R=new WeakMap,D=new WeakMap,_=new WeakMap;class P{constructor(){this.eventListeners={}}on(e,t){this.eventListeners[e]=this.eventListeners[e]||[],this.eventListeners[e].push(t)}once(e,t){const i=s=>{t(s),this.off(e,i)};this.on(e,i)}off(e,t){var i;this.eventListeners[e]=t?null===(i=this.eventListeners[e])||void 0===i?void 0:i.filter((e=>e!==t)):[]}emit(e,t){var i;null===(i=this.eventListeners[e])||void 0===i||i.forEach((e=>e(t)))}}function M({mountTo:e,creativeData:t,isMobile:s}){return(0,r.mG)(this,void 0,void 0,(function*(){const{advInfoPosition:r,hasCustomAdvertiserDesign:o,AdvertiserInfo:a}=t,d=e.querySelector(".adv-mark-template");if(!(null==a?void 0:a.advertiserEnabled)||r===n.Nk.DISABLED||o&&!d)return;const{AdvertiserMark:l,INSIDE_TEMPLATE:h}=yield Promise.resolve().then(i.bind(i,711));customElements.get("advertiser-mark")||customElements.define("advertiser-mark",l);const c=document.createElement("advertiser-mark"),u=(f=`${a.company||""} Erid:&nbsp;${a.token||""}`,f.replace(/(?:(?:https?|ftp|file):\/\/|www\.|ftp\.)(?:\([-A-Z0-9+&@#\/%=~_|$?!:,.]*\)|[-A-Z0-9+&@#\/%=~_|$?!:,.])*(?:\([-A-Z0-9+&@#\/%=~_|$?!:,.]*\)|[A-Z0-9+&@#\/%=~_|$])/gim,(e=>`<a href="${e}" target="_blank">${e}</a>`))).trim().replace(/<a/g,'<a style="color:inherit; text-decoration: none;"');var f;const g=document.createElement("div");g.innerHTML=u,c.appendChild(g);const v=o&&d?h:r,m=""===(null==d?void 0:d.getAttribute("data-hide-popup"));v&&c.setAttribute("mark-position",v),m&&c.setAttribute("show-info","false"),s&&c.setAttribute("is-mobile","");const p=o&&d||e;"allowInfoWindowUnderMark"in p.dataset&&c.setAttribute("allow-info-window-under-mark","true"),p.appendChild(c)}))}class L{constructor(e,t,i){this.logger=e,this.statisticsClient=t,this.slotData=i,this.isVisible=!1,this.isIntersecting=!1,this.TIME_TO_VISIBLE=2e3,this.STEP=200,this.onClick=()=>this.sendVisibility(),this.onDocumentVisibilityChange=()=>this.browserTabChangeHandler()}log(e){this.logger.info(`[Видимость ${this.slotData.placement}] ${e}`)}get creative(){return this.slotData.creative}observe(){this.watchCreativeIntersect(),this.watchCreativeClick(),this.watchForBrowserTabChange()}watchCreativeIntersect(){this.observer=new IntersectionObserver((([e])=>{this.onIntersect(e)}),{threshold:[0,.5]}),this.observer.observe(this.creative)}watchCreativeClick(){var e;null===(e=this.creative.firstChild)||void 0===e||e.addEventListener("click",this.onClick,{once:!0})}watchForBrowserTabChange(){document.addEventListener("visibilitychange",this.onDocumentVisibilityChange)}onIntersect(e){e.isIntersecting?this.visibilityInterval||(this.checkVisibility(),this.visibilityInterval=setInterval(this.checkVisibility.bind(this),this.STEP)):(clearInterval(this.visibilityInterval),this.visibilityInterval=void 0),(e.intersectionRatio>.3||0===e.intersectionRatio)&&(this.isIntersecting!==e.isIntersecting&&(this.checkVisibility(!0),this.manageVisibility(e.isIntersecting,this.isVisible)),this.isIntersecting=e.isIntersecting)}checkVisibility(e=!1){const t=function(e){const{left:t,top:i,width:s,height:r}=e.getBoundingClientRect(),n=t+s/2,o=i+r/2,a=document.elementFromPoint(n,o);return e.contains(a)}(this.creative);this.isVisible===t||e||this.manageVisibility(this.isIntersecting,t),this.isVisible=t}browserTabChangeHandler(){document.hidden?(this.log("вкладка браузера перестала быть активной"),clearTimeout(this.visibilityTimeout),this.visibilityTimeout=void 0):(this.log("вкладка браузера стала активной"),this.manageVisibility(this.isIntersecting,this.isVisible))}manageVisibility(e,t){if(this.log(`во вьюпорте: ${e}, видимость: ${t}`),e&&t){if(this.visibilityTimeout)return;this.visibilityTimeout=setTimeout(this.sendVisibility.bind(this),this.TIME_TO_VISIBLE)}else clearTimeout(this.visibilityTimeout),this.visibilityTimeout=void 0}sendVisibility(){this.statisticsClient.sendVisibility(this.slotData.trackingData).catch((e=>{this.logger.error(`[Видимость ${this.slotData.placement}]: ошибка отправки видимости`,e)})).then((()=>{this.log("засчитана видимость")})),this.destroy()}destroy(){var e,t;null===(e=this.creative.firstChild)||void 0===e||e.removeEventListener("click",this.onClick),document.removeEventListener("visibilitychange",this.onDocumentVisibilityChange),null===(t=this.observer)||void 0===t||t.unobserve(this.creative),this.observer=void 0,clearInterval(this.visibilityInterval),this.visibilityInterval=void 0,clearTimeout(this.visibilityTimeout),this.visibilityTimeout=void 0}}class N{constructor(e,t,i){this.logger=e,this.statisticsClient=t,this.slotData=i,this.statisticsVisibility=new L(this.logger,this.statisticsClient,this.slotData)}aggregateStatistics(){this.statisticsVisibility.observe()}destroy(){this.statisticsVisibility.destroy()}}!function(e){e.LOAD="load",e.RENDER="render",e.STUB="stub",e.ERROR="error"}(k||(k={}));class x extends P{constructor(e,t,i,s){super(),this.requestCreative=e,this.logger=t,this.statistics=i,this.isDestroyed=!1,this.currentRequestPromise=null,this.requestCreative=e,this.logger=t,this.creativeParams=s}get projectKey(){return this.creativeParams.projectKey}get isMobile(){return this.creativeParams.isMobile}get placement(){return this.creativeParams.placement}get elementId(){return this.creativeParams.elementId}refresh(){return(0,r.mG)(this,void 0,void 0,(function*(){if(this.isDestroyed)this.logger.error(`Scrooge slot for #${this.elementId} has been destroyed before refresh`,this.creativeParams);else if(this.logger.info(`Requested ad for #${this.elementId}`,this.creativeParams),null===this.currentRequestPromise)return this.currentRequestPromise=this.requestCreative().then((e=>{if(this.isDestroyed)return;const t={html:e.html,creativeId:e.creative.id,campaignId:e.campaign.id,debug:e.debug,placement:e.placement,hasCustomAdvertiserDesign:e.hasCustomAdvertiserDesign,advInfoPosition:this.creativeParams.advInfoPosition,AdvertiserInfo:e.creative.advertiser};this.logger.info(`Receiving ad for the slot #${this.elementId}`,this.creativeParams,t),this.emit(k.LOAD,t),this.render(t)})).catch((e=>{if("empty"===e)return this.logger.warn(`No ad for the slot #${this.elementId}`,this.creativeParams),void this.emit(k.STUB,null);this.logger.error(`Unknown error while requesting ad for the slot #${this.elementId}`,this.creativeParams,e),this.emit(k.ERROR,`Unknown error: ${e}`)})),this.currentRequestPromise}))}destroy(){var e;if(this.isDestroyed)return;const t=document.getElementById(this.elementId);t&&(null===(e=this.slotStatistics)||void 0===e||e.destroy(),requestAnimationFrame((()=>t.innerHTML=""))),this.logger.info(`Slot #${this.elementId} has been destroyed`,this.creativeParams),this.isDestroyed=!0}render(e){if(this.isDestroyed)return;const t=document.getElementById(this.elementId);if(!t)return this.emit(k.ERROR,`Element id ${this.elementId} is not found.`),void this.logger.error(`Element for the slot #${this.elementId} is not found`,this.creativeParams);if(this.statistics.useStatistics&&("hb-top"===this.placement||"hb-low"===this.placement||"hb-top-scrooge"===this.placement)){const{campaignId:i,creativeId:s}=e;this.slotStatistics=new N(this.logger,this.statistics.client,{creative:t,placement:this.placement,trackingData:{adunitId:this.creativeParams.adunitId,campaignId:i,creativeId:s}});const r=new ResizeObserver((([e])=>{var t;const i=null===(t=e.borderBoxSize)||void 0===t?void 0:t[0];(null==i?void 0:i.inlineSize)>0&&(null==i?void 0:i.blockSize)>0&&(this.slotStatistics.aggregateStatistics(),r.disconnect())}));r.observe(t)}requestAnimationFrame((()=>{t.appendChild(document.createRange().createContextualFragment(e.html)),this.emit(k.RENDER,e),this.logger.info(`Ad for the slot #${this.elementId} has been rendered`,this.creativeParams,e),M({mountTo:t,creativeData:e,isMobile:this.isMobile})}))}}const U="scrooge_tr";class B{constructor(e){this.dataBuffer=[],this.freeBufferTimeout=null,this.host=e.host,this.logger=e.logger,this.isRequestsAllowed=e.isRequestsAllowed,this.hideImageURL=e.hideImageURL,this.projectKey=e.projectKey,this.isMobile=e.isMobile,this.isDebug=e.isDebug,this.previewCreativeIds=e.previewCreativeIds,this.statistics=e.statistics}static sendRequest(e,t){const i={query:"query getCreativeHtmls ($filter: CreativeHtmlsFilterInput! $track: String!) {\n    result: creativeHtmls (filter: $filter track: $track) {\n      __typename\n      ... on InternalErrorProblem { message }\n      ... on CreativeHtmlList {\n        items {\n          placement\n          html\n          creative {\n            id\n            advertiser {\n                advertiserEnabled\n                company\n                token\n            }\n          }\n          campaign { id }\n          debug {\n            rolledValue\n            allRolledAds {\n              creativeId\n              trafficPercent\n              rollInterval\n            }\n          }\n          hasCustomAdvertiserDesign\n        }\n        track\n      }\n    }\n  }\n",variables:{filter:t,track:""}},s=localStorage.getItem(U);return s&&(i.variables.track=s),new Promise(((t,s)=>(0,r.mG)(this,void 0,void 0,(function*(){const r=new XMLHttpRequest;r.open("POST",e,!0),r.setRequestHeader("Content-Type","application/json"),r.setRequestHeader("Accept","application/json"),r.setRequestHeader("X-Time-Zone",Intl.DateTimeFormat().resolvedOptions().timeZone),r.onreadystatechange=()=>{if(r.readyState===r.DONE)if(200===r.status)try{const e=JSON.parse(r.response).data.result;if("InternalErrorProblem"===e.__typename)throw e.message;"CreativeHtmlList"===e.__typename&&e.track&&localStorage.setItem(U,e.track),t(e)}catch(e){s(e)}else s(r.statusText)},r.send(JSON.stringify(i))}))))}createSlot(e,t,i,s,r){return new x((()=>this.addRequestToBuffer(e,!!s)),this.logger,this.statistics,{elementId:t,adunitId:i,placement:e,advInfoPosition:r,projectKey:this.projectKey,isMobile:this.isMobile})}allowRequests(){this.isRequestsAllowed=!0,this.freeBufferTimeout=window.setTimeout((()=>this.singleRequest()),0)}setHiddenImagesUrls(e){this.hideImageURL=e}addRequestToBuffer(e,t){const i=new Promise(((i,s)=>this.dataBuffer.push({placement:e,fill:t,onLoad:i,onError:s})));return this.isRequestsAllowed&&null===this.freeBufferTimeout&&(this.freeBufferTimeout=window.setTimeout((()=>this.singleRequest()),0)),i}singleRequest(){return(0,r.mG)(this,void 0,void 0,(function*(){const e=this.dataBuffer.reduce(((e,t)=>{var{placement:i}=t,s=(0,r._T)(t,["placement"]);return Object.assign(Object.assign({},e),{[i]:[...e[i]||[],s]})}),{});this.dataBuffer=[],this.freeBufferTimeout=null;const t=Object.keys(e).reduce(((t,i)=>[...t,{placement:i,limit:e[i].length,fill:e[i].some((e=>e.fill))}]),[]);try{(yield B.sendRequest(this.host,{placements:t,isDebug:this.isDebug,projectKey:this.projectKey,isMobile:this.isMobile,hideImageURL:this.hideImageURL,previewCreativeIds:this.previewCreativeIds})).items.forEach((t=>{const[i,...s]=e[t.placement];e[t.placement]=s,i.onLoad(t)})),Object.keys(e).forEach((t=>e[t].forEach((e=>e.onError("empty")))))}catch(t){Object.keys(e).forEach((i=>e[i].forEach((e=>e.onError(`${t}`)))))}}))}}var G=i(711);class V{init(){const e=window;e.placesForAdvertisementMark instanceof Array&&e.placesForAdvertisementMark.forEach((e=>{if(void 0===e.mountTo||void 0===e.isMobile||void 0===e.isMobile||void 0===(null==e?void 0:e.creativeData.advInfoPosition)||void 0===(null==e?void 0:e.creativeData.hasCustomAdvertiserDesign)||void 0===(null==e?void 0:e.creativeData.AdvertiserInfo))throw"Ошибка в параметрах placesForAdvertisementMark";M(e)})),e.appendAdvertisementMark=M}}class j{constructor(){this.STATS_API_URL="/gm-api/bff/v1/stats/send-creative-visible-view"}sendVisibility({adunitId:e,campaignId:t,creativeId:i}){const s={adunitID:e,campaignID:t,creativeID:i};return(r=this.STATS_API_URL,n=s,fetch(r,{method:"POST",mode:"cors",cache:"no-cache",credentials:"same-origin",headers:Object.assign(Object.assign({},undefined),{"content-type":"application/json"}),redirect:"follow",referrerPolicy:"no-referrer",body:JSON.stringify(n)}).then((e=>{if(!e.ok)throw new Error(e.statusText);return e.json()}))).then((e=>!!e.data));var r,n}}class H{constructor(e,t=!1,i=!1){var s;this.host=e,this.useStatistics=t,this.isDebug=i,this.slots=[],this.events={LOAD:k.LOAD,RENDER:k.RENDER,ERROR:k.ERROR,STUB:k.STUB},this.isAdblockEnabled=!1,this.isInited=!1,this.mobileClients={},this.desktopClients={},this.isRequestsAllowed=!1,this.previewCreativeIds=[],this.logger=new u("[SCROOGE]"),this.statisticsClient=new j;const{searchParams:r}=new URL(window.location.href);this.previewCreativeIds=(null===(s=r.get("scroogePreview_creativeId"))||void 0===s?void 0:s.split(",").map(Number))||[],customElements.define("advertiser-mark",G.AdvertiserMark),(new V).init()}static isCreateSlotParams(e){if("object"!=typeof e||null===e)return!1;const t=e;return"string"==typeof t.projectKey&&"boolean"==typeof t.isMobile&&"string"==typeof t.placement&&"string"==typeof t.elementId&&"number"==typeof t.adunitId}createSlot(e,t,i,s,r,n=0){return"string"==typeof e?this.getNewSlot({isMobile:t,placement:i,elementId:s,fill:r,projectKey:e,adunitId:n}):this.getNewSlot(e)}init(){return(0,r.mG)(this,void 0,void 0,(function*(){this.isInited||(this.isInited=!0,this.isAdblockEnabled=(yield O().catch(this.logger.error))||!1,this.isRequestsAllowed=!0,Object.keys(this.mobileClients).forEach((e=>{this.mobileClients[e].setHiddenImagesUrls(this.isAdblockEnabled),this.mobileClients[e].allowRequests()})),Object.keys(this.desktopClients).forEach((e=>{this.desktopClients[e].setHiddenImagesUrls(this.isAdblockEnabled),this.desktopClients[e].allowRequests()})))}))}showLogs(){this.logger.enabled=!0}hideLogs(){this.logger.enabled=!1}getNewSlot(e){if(!H.isCreateSlotParams(e))return this.logger.error("Wrong type for createSlot attributes",e),null;const{projectKey:t,isMobile:i,placement:s,elementId:r,adunitId:n,fill:o=!0,advInfoPosition:a}=e,d=i?this.mobileClients:this.desktopClients;d[t]||(d[t]=new B({projectKey:t,isMobile:i,isRequestsAllowed:this.isRequestsAllowed,hideImageURL:this.isAdblockEnabled,logger:this.logger,host:this.host,isDebug:this.isDebug,previewCreativeIds:this.previewCreativeIds,statistics:{client:this.statisticsClient,useStatistics:this.useStatistics}}));const l=d[t].createSlot(s,r,n,o,a);return this.slots.push(l),l}}const F={[n.Vc.ADFOX]:class{constructor(e){this.sdk=e}get ready(){return this.sdk.ready}createSlot(e,t,i){return new d(this,e,t,i)}setTargeting(){}clearSession(){this.sdk.clearSession()}},[n.Vc.GPT]:class{constructor(e){this.sdk=e}get ready(){return this.sdk.ready}createSlot(e,t,i){return new l(this,e,t,i)}setTargeting(e){this.sdk.setTargeting(e)}clearSession(){}},[n.Vc.SCROOGE]:class{constructor(e){this.sdk=e}get ready(){return Promise.resolve()}createSlot(e,t,i){return new c(this,e,t,i)}setTargeting(){}clearSession(){}},[n.Vc.RTB]:class{constructor(e){this.sdk=e}get ready(){return this.sdk.ready}createSlot(e,t,i){return new h(this,e,t,i)}setTargeting(){}clearSession(){}}},Y={[n.Vc.ADFOX]:class{constructor(e,{ownerId:t,headerBiddings:i,targetingsMap:s={}}){var n;this.window=e,this.scriptUrl="https://yandex.ru/ads/system/context.js",this.scriptFallbackUrl="https://an.yandex.ru/system/context.js",this.scriptUrlHB="https://yandex.ru/ads/system/header-bidding.js",this.scriptUrlHBFallback="https://yastatic.net/pcode/adfox/header-bidding.js",b.set(this,void 0);const o=a();this.ready=o.ready,(0,r.YH)(this,b,o.done,"f"),this.ownerId=t,this.mapTargeting=({key:e,value:t})=>({value:Array.isArray(t)?t.join("pk"===s[e]?" ":":"):t,key:e in s?s[e]:e}),this.headerBiddings=i?Object.assign(Object.assign({adUnits:[]},i),{callbacks:{onBidsReceived:t=>{e._cmDebugOnAdfoxBidsRecieve&&e._cmDebugOnAdfoxBidsRecieve(t),f.info("Пришел ответ от HeaderBidding-а AdFox: ",t)}}}):i,this.allowedBidders=Object.keys((null===(n=this.headerBiddings)||void 0===n?void 0:n.biddersMap)||{})}init(){return(0,r.mG)(this,void 0,void 0,(function*(){this.headerBiddings&&(this.window.YaHeaderBiddingSettings=this.headerBiddings),f.info("Начата загрузка и инициализация скрипта AdFox."),yield Promise.all([this.loadHeaderBidding(),S(this.window,{src:this.scriptUrl}).catch((()=>S(this.window,{src:this.scriptFallbackUrl})))]),yield A({name:"AdFox Code",callback:()=>{var e,t;return Boolean(null===(t=null===(e=this.window)||void 0===e?void 0:e.Ya)||void 0===t?void 0:t.adfoxCode)}}),this.adfox=this.window.Ya.adfoxCode,f.info("Скрипт AdFox был инициализирован."),(0,r.Q_)(this,b,"f").call(this)}))}loadHeaderBidding(){return(0,r.mG)(this,void 0,void 0,(function*(){this.headerBiddings&&(f.info("Начата загрузка HeaderBiddings для AdFox."),yield S(this.window,{src:this.scriptUrlHB}).catch((()=>S(this.window,{src:this.scriptUrlHBFallback}))),f.info("Скрипт AdFox HeaderBiddings для AdFox загружен."))}))}createSlot(e){return(0,r.mG)(this,void 0,void 0,(function*(){return yield A({name:"AdFox Code createSlot",callback:()=>{var e,t,i;return Boolean(null===(i=null===(t=null===(e=this.window)||void 0===e?void 0:e.Ya)||void 0===t?void 0:t.adfoxCode)||void 0===i?void 0:i.create)},attempts:50,interval:100}).catch((e=>(0,r.mG)(this,void 0,void 0,(function*(){var t,i;console.error("[HSM Creative Manager]: нет create в window.Ya через пять секунд ожидания",null===(t=this.window)||void 0===t?void 0:t.Ya,e),f.errorToSentry("Нет create в window.Ya через пять секунд ожидания",{payload:[null===(i=this.window)||void 0===i?void 0:i.Ya,e]})})))),this.adfox.create(Object.assign({ownerId:this.ownerId},e))}))}addPrebidAdunit(e,t){var i;return(0,r.mG)(this,void 0,void 0,(function*(){if(!this.headerBiddings)return;const s=a(),r=JSON.parse(JSON.stringify(t));return r.sizes=r.mediaTypes.banner.sizes,r.code=e,r.bids=(null===(i=r.bids)||void 0===i?void 0:i.filter((e=>this.allowedBidders.includes(e.bidder))))||[],delete r.mediaTypes,this.window.Ya.adfoxCode.hbCallbacks.push((()=>{this.window.Ya.headerBidding.pushAdUnits([r]),f.info("[ADFOX] Добавлен конфиг пребида для",r.code,r),s.done()})),s.ready}))}clearSession(){this.adfox.clearSession()}},[n.Vc.GPT]:class{constructor(e,{namespace:t,targetingsMap:i,prebid:s,allowGptFallback:n}){this.window=e,this.scriptUrl="https://securepubads.g.doubleclick.net/tag/js/gpt.js",R.set(this,void 0),D.set(this,void 0),this.refreshTimeoutId=null,this.queueFillingTimeout=100,this.refreshQueue=new Set;const o=a();this.ready=o.ready,(0,r.YH)(this,R,o.done,"f"),(0,r.YH)(this,D,o.abort,"f"),this.namespace=t,this.mapTargeting=function(e={}){return({key:t,value:i})=>({value:Array.isArray(i)?i.join(","):i,key:t in e?e[t]:t})}(i),this.allowGptFallback=null==n||n,s&&(this.prebid=new w(e,s))}get googletag(){return this.window.googletag}get isGoogletagServicesEnabled(){return Boolean(this.window.__GMGptInlineInitialization)}set isGoogletagServicesEnabled(e){this.window.__GMGptInlineInitialization=e}init(){return(0,r.mG)(this,void 0,void 0,(function*(){f.info("Начата загрузка и инициализация скрипта GPT.");try{const e=[Promise.all([S(this.window,{src:this.scriptUrl}),new Promise((e=>this.googletag.cmd.push((()=>e()))))])];if(this.allowGptFallback){const t=new Promise((e=>setTimeout(e,4e3,"sdk timeout")));e.push(t)}const t=yield Promise.race(e);if("string"==typeof t&&"sdk timeout"===t)throw new Error("прождали SDK 4 секунды")}catch(e){return f.error(e),void(0,r.Q_)(this,D,"f").call(this,e)}this.enableServices(),(0,r.Q_)(this,R,"f").call(this)}))}enableServices(){this.googletag.pubads().addEventListener("slotRenderEnded",(e=>{e.slot._hsmCallSlotRenderEnded(e)})),this.isGoogletagServicesEnabled||(this.googletag.pubads().disableInitialLoad(),this.googletag.pubads().enableSingleRequest(),this.googletag.pubads().collapseEmptyDivs(),this.googletag.pubads().enableAsyncRendering(),this.googletag.enableServices(),this.isGoogletagServicesEnabled=!0)}createSlot(e){const t=e.adUnitPath.startsWith("/")?e.adUnitPath:`${this.namespace}${e.adUnitPath}`,i=this.googletag.defineSlot(t,e.sizes["0x0"],e.elementId);return i.defineSizeMapping(C(e.sizes)),i.addService(googletag.pubads()),i}refreshSlot(e){return(0,r.mG)(this,void 0,void 0,(function*(){if(!e.nativeSlot)return void f.error("Вызван googletag.refresh до создания слота",e);if(this.refreshQueue.add(e),this.refreshTimeoutId)return;yield new Promise((e=>{this.refreshTimeoutId=setTimeout(e,this.queueFillingTimeout)}));const t=Array.from(this.refreshQueue),i=t.map((e=>{const t=e.nativeSlot.getSlotElementId();return e.hasBeenDisplayed||(f.info("Вызван googletag.display для баннера",t),this.googletag.display(t)),t}));f.info("Вызван googletag.refresh для списка баннеров",i),this.googletag.pubads().refresh(t.map((e=>e.nativeSlot))),this.refreshQueue.clear(),this.refreshTimeoutId=null}))}destroySlot(e){const t=this.googletag.destroySlots([e]),i=document.getElementById((null==e?void 0:e.getSlotElementId())||"");return i&&(null==i?void 0:i.getAttribute("data-google-query-id"))&&(i.setAttribute("style",""),i.innerHTML=""),t}setTargeting(e){const t=this.mapTargeting(e);this.googletag.pubads().setTargeting(t.key,t.value)}},[n.Vc.SCROOGE]:class{constructor(e,{host:t,projectKey:i,isMobile:s,debug:r,useStatistics:n}){this.scrooge=new H(t,n,r),this.projectKey=i,this.isMobile=s,r&&this.scrooge.showLogs()}init(){return(0,r.mG)(this,void 0,void 0,(function*(){this.scrooge.init(),f.info("Скрипт Scrooge был инициализирован.")}))}createSlot(e){return this.scrooge.createSlot(Object.assign({projectKey:this.projectKey,isMobile:this.isMobile},e))}},[n.Vc.RTB]:class{constructor(e){this.window=e,this.scriptLegacyUrl="https://an.yandex.ru/system/context.js",this.scriptUrl="https://yandex.ru/ads/system/context.js",this.adunitsCount={},this.globalNoAdv=!1,_.set(this,void 0),this.targetings=[],this.window=e;const t=a();this.ready=t.ready,(0,r.YH)(this,_,t.done,"f")}init(){return(0,r.mG)(this,void 0,void 0,(function*(){f.info("Начата загрузка и инициализация скрипта RTB."),yield S(this.window,{src:this.scriptUrl}).catch((()=>S(this.window,{src:this.scriptLegacyUrl}))),yield A({name:"Yandex RTB",callback:()=>"Ya"in this.window&&"Context"in this.window.Ya&&"AdvManager"in this.window.Ya.Context}),f.info("Скрипт RTB был инициализирован."),(0,r.Q_)(this,_,"f").call(this)}))}createSlot(e){var t,i,s,r;const n=a();this.adunitsCount[e.adunit]=(this.adunitsCount[e.adunit]||0)+1;const o=this.adunitsCount[e.adunit],d=null===(i=null===(t=e.targetings)||void 0===t?void 0:t.find((e=>["experiment","partner-stat-id"].includes(e.key))))||void 0===i?void 0:i.value;if((null===(r=null===(s=e.targetings)||void 0===s?void 0:s.find((e=>["tags","pk"].includes(e.key))))||void 0===r?void 0:r.value.includes("no-adv"))||this.globalNoAdv)return n.abort(),n.ready;const l={blockId:e.blockId,statId:null!=d?d:this.globalStatId,renderTo:e.elementId,pageNumber:this.adunitsCount[e.adunit],async:!0,onError:n.abort,onRender:n.done};return e.type&&(l.type=e.type),e.platform&&(l.platform=e.platform),this.command((t=>{o==this.adunitsCount[e.adunit]?t.render(l,n.abort):n.abort()})),n.ready}setGlobalTargeting({key:e,value:t}){["experiment","partner-stat-id"].includes(e)?this.globalStatId=t:["tags","pk"].includes(e)&&(this.globalNoAdv=t.includes("no-adv"))}command(e){return(0,r.mG)(this,void 0,void 0,(function*(){this.window.yaContextCb.push((()=>e(this.window.Ya.Context.AdvManager)))}))}}};class q{constructor(e){this.configs=e,this.adservers={},this.sdks={}}getAdserver(e){if(this.adservers[e])return this.adservers[e];const t=this.getAdapter(e),i=new m(t);return this.adservers[e]=i,i}forEachAdserver(e){return Object.values(this.adservers).forEach(e)}getSdk(e){if(this.sdks[e])return this.sdks[e];const t=this.configs[e.toLowerCase()],i=new Y[e](window,t);return this.sdks[e]=i,i.init(),i}getAdapter(e){return new F[e](this.getSdk(e))}setBidders(e){var t,i,s,r,o;const a={biddersMap:Object.assign({},(null===(t=this.configs.adfox.headerBiddings)||void 0===t?void 0:t.biddersMap)||{}),timeout:(null===(i=this.configs.adfox.headerBiddings)||void 0===i?void 0:i.timeout)||1e3,biddersCpmAdjustmentMap:(null===(s=this.configs.adfox.headerBiddings)||void 0===s?void 0:s.biddersCpmAdjustmentMap)||{}},d=null===(r=this.configs.adfox.headerBiddings)||void 0===r?void 0:r.syncPixels;d&&(a.syncPixels=[...d]);const l=[...(null===(o=this.configs.gpt.prebid)||void 0===o?void 0:o.allowedBidders)||[]];e.forEach((e=>{switch(e.adserver){case n.Vc.ADFOX:e.adserverBidderId?a.biddersMap[e.key]=e.adserverBidderId:f.warn(`[Header Bidding] Не указан ID биддера ${e.key} на площадке ${e.adserver}"`),e.bidCpmAdjustment&&(a.biddersCpmAdjustmentMap[e.key]=e.bidCpmAdjustment);break;case n.Vc.GPT:l.push(e.key)}})),0===Object.keys(a.biddersMap).length?delete this.configs.adfox.headerBiddings:this.configs.adfox.headerBiddings=a,this.configs.gpt.prebid&&(this.configs.gpt.prebid.allowedBidders=l)}}class ${constructor(e){this.baseUrl=e}fetch(e,t){return fetch(this.baseUrl,{method:"POST",headers:{"Content-Type":"application/json;charset=utf-8"},body:JSON.stringify({query:e,variables:t})}).then((e=>e.json())).then((e=>e.data.result))}}class z{constructor(e){this.apiClient=e,this.layout=n.Ar.STANDART,this.bidders=[],this.adunitsBidders=[],this.adserversBidders=W(),this.adunits={[n.Ar.STANDART]:{},[n.Ar.AMP]:{},[n.Ar.ADBLOCK_PLUS]:{},[n.Ar.INTERNATIONAL]:{}},this.adfoxAdditionalParams={}}findAdunit(e){return this.adunits[this.layout][e]}findAdunitAdditionalParams(e){return this.adfoxAdditionalParams[e]}load(e){var t,i;return(0,r.mG)(this,void 0,void 0,(function*(){let s=this.getLocalConfig();(function(e){return!(!e||!e.adunits)&&(!!(e.adunits instanceof Array&&e.adunits.length)||e.adunits instanceof Object&&Object.keys(e.adunits).length>0)})(s)||(s=yield this.getRemoteConfig(e));const{layout:r,adunits:o,bidders:a,adunitsBidders:d}=s,l=this.getCustomProjectParams();if(l){const e=null===(i=null===(t=null==l?void 0:l.creativeParams)||void 0===t?void 0:t.adfox)||void 0===i?void 0:i.creativeConfig;"object"==typeof e&&(this.adfoxAdditionalParams=e)}r&&(this.layout=r),this.adunits=function(e){const t=Object.values(n.Ar).reduce(((e,t)=>(e[t]={},e)),{});let i=e;return i instanceof Object&&(i=Object.values(e)),i.forEach((e=>{t[e.layout][e.placement]=e})),t}(o),this.bidders=a||[],this.adunitsBidders=d||[],this.adserversBidders=function(e,t){return t.reduce(((t,i)=>{const s=e.find((e=>i.id===e.id));return s?(t[s.adserver].push({bidder:s,adunitBidder:i}),t):t}),W())}(a,d)}))}getLocalConfig(){return window.__ADS_CONFIG__||null}getCustomProjectParams(){return window.__ADS_CUSTOM_PARAMS__||null}getRemoteConfig(e){return(0,r.mG)(this,void 0,void 0,(function*(){const{adunits:t,bidders:i,adunitsBidders:s}=yield this.apiClient.fetch("\nfragment adunit on Adunit {\n    adserver\n    placement\n    layout\n    placeholderEnabled\n    advInfoPosition\n    placeholderConfig {\n        height\n        backgroundEnabled\n        bordersEnabled\n        advMarkEnabled\n    }\n    refreshEnabled\n    refreshConfig { loadTime viewportTime }\n    adfoxConfig { p1 p2 }\n    rtbConfig { id }\n    gptConfig {\n        adUnitPath\n        sizes { sizes0x0 sizes336x0 }\n    }\n    scroogeConfig { fill }\n}\n\nquery getAdsConfig($filter: AdsConfigFilterInput!) {\n    result: adsConfig(filter: $filter) {\n        __typename\n        ...on AdsConfig {\n            adunits { ...adunit }\n            bidders {\n                id\n                key\n                adserver\n                adserverBidderId\n                params { key type }\n            }\n            adunitsBidders {\n                id\n                placement\n                params { key value }\n            }\n        }\n        ...on ProblemInterface { message }\n    }\n}\n",{filter:e});return{adunits:t,bidders:i,adunitsBidders:s,layout:this.layout}}))}}function W(){return Object.values(n.Vc).reduce(((e,t)=>(e[t]=[],e)),{})}const K=[1600,1440,1366,980,540,1];class Q{constructor(e=5e3){this.actionsQueue=[],this.priorityPromises=[],this.findPromisesToResolveTimeout=0,this.actionResolveTimeout=e}waitForMyQueue(e){return(0,r.mG)(this,void 0,void 0,(function*(){if(e<1||isNaN(e)||e%1!=0)throw new RangeError("Приоритет должен быть целым числом не меньше 1");let t;const i=new Promise((e=>{t=e}));return 0===this.actionResolveTimeout||(this.addToQueue(e,i),yield this.waitForPriority(e),setTimeout(t,this.actionResolveTimeout)),t}))}addToQueue(e,t){this.actionsQueue.push({priority:e,promise:t}),t.then((()=>this.removeFromQueue(t))),this.findPromiseToResolve()}removeFromQueue(e){this.actionsQueue=this.actionsQueue.filter((t=>t.promise!==e)),this.findPromiseToResolve()}findPromiseToResolve(){var e;const t=Math.min(...this.actionsQueue.map((({priority:e})=>e)));null===(e=this.priorityPromises[t])||void 0===e||e.resolver()}waitForPriority(e){if(1===e)return Promise.resolve();if(this.priorityPromises[e])return this.priorityPromises[e].promise;let t;const i=new Promise((e=>{t=e}));return i.then((()=>{this.priorityPromises[e]=null})),this.priorityPromises[e]={promise:i,resolver:t},clearTimeout(this.findPromisesToResolveTimeout),this.findPromisesToResolveTimeout=window.setTimeout(this.findPromiseToResolve.bind(this),10),this.priorityPromises[e].promise}}class J{constructor(){this.isEnabled=!1,this.isAdblockPlus=!1,this.ready=O().catch(f.error).then((e=>{this.isEnabled=!!e}))}}const X="__saved_referrer__",Z={zen:["zen.yandex."],"yandex-news":["yxnews"],yandex:["yandex."],msn:["msn.com"],lentainform:["lentainform.com"],instagram:["instagram.com","qlid.ru"],"google-discover":["discover.google."],google:["google."],facebook:["facebook.com"],"wday.ru":["wday.ru"],"woman.ru":["woman.ru"],"elle.ru":["elle.ru"],"starhit.ru":["starhit.ru"],"marieclaire.ru":["marieclaire.ru"],"ellegirl.ru":["ellegirl.ru"],"elledecoration.ru":["elledecoration.ru"],"psychologies.ru":["psychologies.ru"],"vokrugsveta.ru":["vokrugsveta.ru"],pulse:["pulse.mail.ru"],odnoklassniki:["ok.ru"],vk:["vk.com"],flipboard:["flipboard.com"],viber:["trts.io"],"mail.ru":["go.mail.ru"]};function ee(e,t){for(let i=0;i<t.length;i++)for(let s=0;s<e.length;s++)if(e[s].indexOf(t[i])>-1)return!0;return!1}const te="__first_visited_page__";function ie(e){const t=window.location.search;return new URLSearchParams(t).get(e)}const se="RU",re=[se,"TM","00"];function ne(e=!0){return(0,r.mG)(this,void 0,void 0,(function*(){if(!e)return se;const t=yield Promise.resolve(ie("geo"));if(t)return t.toUpperCase();try{const e=yield fetch("/geo-context");if(!e.ok)throw new Error(`checkGeo error: ${e.status}`);return e.headers.get("x-geo-country")||se}catch(e){return f.error("Не удалось получить гео",e),f.errorToSentry("Не удалось получить гео",{payload:[e]}),se}}))}function oe(e,t,i){const s={prebidAdUnit:{code:e.placement,codeType:(e.biddersConfig.codeType||"").toLowerCase(),mediaTypes:{banner:{sizes:e.biddersConfig.sizes}},bids:t[i].filter((t=>t.adunitBidder.placement===e.placement)).map((e=>{return{bidder:e.bidder.key,params:(t=e,t.bidder.params.reduce(((e,i)=>{const s=t.adunitBidder.params.find((e=>e.key===i.key));if(s){let t=s.value;i.type===n.zB.NUMBER&&(t=Number(t)||0),t&&(e[i.key]=t)}return e}),{}))};var t}),[])}};return!s.prebidAdUnit||""!==s.prebidAdUnit.codeType&&s.prebidAdUnit.codeType!==n.PV.EMPTY.toLowerCase()||delete s.prebidAdUnit.codeType,s}class ae{constructor(e){this.styleProperty=e,this.value=""}update(e){e.style[this.styleProperty]=this.value}}class de{constructor(e){this.rootElement=e,this.creativeParams={},this.style={zIndex:new ae("zIndex"),bottomOffset:new ae("bottom"),leftOffset:new ae("left")}}get parentElement(){var e;return null===(e=this.rootElement)||void 0===e?void 0:e.parentElement}get childElement(){var e;return null===(e=this.rootElement)||void 0===e?void 0:e.firstChild}get propertiesToUpdate(){return Object.values(this.style).filter((e=>!!e.value))}setProperty(e,t){e.value=t,this.parentElement&&e.update(this.parentElement)}setRootElement(e){this.rootElement=e;const{parentElement:t}=this;t?this.propertiesToUpdate.forEach((e=>e.update(t))):f.error("[STICKY RSYA] У селектора стики отсутствует parentElement")}setzIndex(e){this.setProperty(this.style.zIndex,`${e}`),this.creativeParams.zIndex=e}setBottomOffset(e){this.setProperty(this.style.bottomOffset,`${e}px`),this.creativeParams.offset=e}setLeftOffset(e){this.setProperty(this.style.leftOffset,`${e}px`)}setMaxHeight(e){this.childElement&&(this.childElement.style.maxHeight=`${e}px`)}}class le{constructor(){this.slotCallbacks={},this.promises={},this.resolves={}}setBeforeCreate(e,t){var i,s;this.slotCallbacks[e]=t,null===(s=(i=this.resolves)[e])||void 0===s||s.call(i,t)}getBeforeCreate(e){if(this.slotCallbacks[e])return this.slotCallbacks[e];const t=new Promise((t=>this.resolves[e]=t));return this.promises[e]=t,t}}var he,ce,ue,fe,ge,ve,me,pe,Ee,Se;const Ae="HSM_blockedAdunits",be="HSMCMLogLevel",Te="HSMCMDevtools",Ce="CMDebuggerData";class ye extends o{constructor(){super(),this.slots=[],he.set(this,void 0),ce.set(this,void 0),ue.set(this,void 0),this.isDebug=!1,this.beforeSlotCreateHandler=new le,this.adblock=new J,fe.set(this,void 0),ge.set(this,void 0),ve.set(this,{}),me.set(this,!0),pe.set(this,[]),Ee.set(this,[]),this.targetings={},Se.set(this,!0),this.blockAdunits=(...e)=>{"all"===this.blockedAdunits||e.includes("all")?this.blockedAdunits="all":this.blockedAdunits=[...this.blockedAdunits,...e]};const e=window;e.Ya||(e.Ya={}),e.yaContextCb=e.yaContextCb||[],e.Ya.adfoxCode||(e.Ya.adfoxCode={}),e.Ya.adfoxCode.hbCallbacks||(e.Ya.adfoxCode.hbCallbacks=[]),e.googletag=e.googletag||{cmd:[]};const t=a();(0,r.YH)(this,he,t.done,"f"),this.ready=t.ready;const i=a();(0,r.YH)(this,ce,i.done,"f"),this.staticSlotsReady=i.ready;const s=a();(0,r.YH)(this,ue,s.done,"f"),this.geoReady=s.ready}get brandingSlots(){return(0,r.Q_)(this,pe,"f").reduce(((e,t)=>e.concat(this.findSlots(t))),[])}get blockedAdunits(){return(0,r.Q_)(this,Ee,"f")}set blockedAdunits(e){(0,r.YH)(this,Ee,e,"f"),localStorage.setItem(Ae,JSON.stringify(e))}init(e){var t,i;return(0,r.mG)(this,void 0,void 0,(function*(){f.info("инициализация с параметрами",e);const{projectKey:s,scroogeEndpoint:o,isMobile:a,debug:d,adfox:l,gpt:h,branding:c,priorityQueueResolveMaxTime:u=3e3,isNoAdvInitial:g,useGeo:v=!0,useScroogeSlotStatistics:m=!1}=e;(0,r.YH)(this,me,null===(t=e.allowIncrementalSlotID)||void 0===t||t,"f"),(0,r.YH)(this,Se,null===(i=e.allowGptFallback)||void 0===i||i,"f"),this.projectKey=s,this.isMobile=a,this.isDebug=d||"TRUE"===localStorage.getItem(be)||"TRUE"===localStorage.getItem(Te),this.isDebug&&(f.enabled=!0),(0,r.YH)(this,ge,new Q(u),"f"),o&&(0,r.YH)(this,fe,new $(o),"f"),this.configManager=new z((0,r.Q_)(this,fe,"f")),this.adserverManager=new q({adfox:l,gpt:h,scrooge:{isMobile:a,projectKey:s,debug:this.isDebug,host:o,useStatistics:m}}),this.stickyRsya=new de,this.adserverManager.configs.gpt.allowGptFallback=(0,r.Q_)(this,Se,"f");try{(0,r.YH)(this,Ee,JSON.parse(localStorage.getItem(Ae))||[],"f");const e=new URLSearchParams(location.search).get("blockedAdunits");null!==e&&(0,r.YH)(this,Ee,"all"===e?"all":e.split(","),"f")}catch(e){(0,r.YH)(this,Ee,[],"f")}const p=[n.Vc.ADFOX,n.Vc.SCROOGE,n.Vc.RTB];yield Promise.all([ne(v||!!ie("test_geo")).then((t=>(v&&!re.includes(t)&&e.allowInternationalLayout&&(f.info("изменяем сетку на dfp"),this.configManager.layout=n.Ar.INTERNATIONAL,p.push(n.Vc.GPT)),(0,r.Q_)(this,ue,"f").call(this),t))),this.configManager.load({projectKey:s,isMobile:a}),this.adblock.ready]),this.adblock.isEnabled&&f.info("обнаружен Adblock"),this.adblock.isAdblockPlus&&(f.info("обнаружен Adblock Plus, изменяем сетку"),this.configManager.layout=n.Ar.ADBLOCK_PLUS,this.adserverManager.configs.adfox.headerBiddings=l.headerBiddingsAdblockPlus||l.headerBiddings),this.adserverManager.setBidders(this.configManager.bidders),p.forEach((e=>this.adserverManager.getAdserver(e))),Object.entries(this.targetings).forEach((([e,t])=>{this.adserverManager.forEachAdserver((i=>i.setTargeting({key:e,value:t})))}));const E=function(){Object.keys(Z).forEach((function(e){location.host.indexOf(e)>-1&&delete Z[e]}));const e=function(){const e=document.referrer,t=location.search.match(/utm_referrer=([^\\&]+)/),i=t?t[1]:"",s=location.search.match(/utm_source=([^\\&]+)/),r=s?s[1]:"",n=[];if(e&&n.push(e),i&&n.push(i),r&&n.push(r),!n.length)return"no-referrer";const o=Object.keys(Z);for(let e=0;e<o.length;e++)if(ee(n,Z[o[e]]))return o[e];return"other"}(),t=("no-referrer"===e||"other"===e)&&function(){const e=sessionStorage.getItem(X);if(!e)return null;try{const t=JSON.parse(e);return t.timestamp+18e5>Date.now()?t.referrer:null}catch(e){}return null}()||e;return sessionStorage.setItem(X,JSON.stringify({timestamp:Date.now(),referrer:t})),t}(),S=function(){const e="/"===document.location.pathname?"main":"other",t=function(){const e=sessionStorage.getItem(te);if(!e)return null;try{const t=JSON.parse(e);return t.timestamp+18e5>Date.now()?t.firstVisitedPage:null}catch(e){}return null}()||e;return sessionStorage.setItem(te,JSON.stringify({firstVisitedPage:t,timestamp:Date.now()})),t}(),A=[{key:"screenWidth",value:(b=window.innerWidth,(K.find((e=>b>=e))||1).toString())},{key:"random",value:Math.floor(100*Math.random()).toString()},{key:"referrer",value:E},{key:"ru-landing-page",value:S}];var b;"boolean"==typeof g&&A.push({key:"blockAdv",value:g?"no-adv":""}),this.setTargeting(...A),yield function(e){return(0,r.mG)(this,void 0,void 0,(function*(){const t=new URL(location.href).searchParams.get("ads_console");"0"===t&&localStorage.removeItem(Te);const i="TRUE"===localStorage.getItem(Te);(null!==t&&"0"!==t||i)&&(yield e.toggleConsole(),localStorage.getItem(Ce)||localStorage.setItem(Ce,JSON.stringify({noAdv:!1})));let s="";window.addEventListener("input",(t=>{if("string"!=typeof t.data)return;const i=t.data.toLowerCase();s+=i,s.includes("adsconsole")&&(e.toggleConsole(),s="")}),!0)}))}(this).catch(f.warn),(0,r.Q_)(this,he,"f").call(this),c&&(0,r.YH)(this,pe,function(e,t){const i=t.adunits||[];if(0===i.length)return f.warn("[Branging]: не указаны слоты",t),[];const s=i.reduce(((t,i)=>{const s=e.configManager.findAdunit(i);if(!s)return t;const r=s.refreshEnabled&&s.refreshConfig.refreshInterval||0;return r>t?r:t}),0);if(f.info("[Branging]: брендинг установлен для ",i),f.info("[Branging]: время рефреша",s),!s)return i;let r=0;const n=()=>{window.removeEventListener("focus",n),window.addEventListener("blur",o),r=window.setInterval((()=>{window.removeEventListener("blur",o),e.refreshBranding()}),1e3*s)},o=()=>{window.removeEventListener("blur",o),clearInterval(r),window.addEventListener("focus",n)};return n(),i}(this,c),"f");const T="[HSM-Creative-Manager]: Ожидал загрузки DOM";f.time(T),yield function(e){return(0,r.mG)(this,void 0,void 0,(function*(){return"loading"!==e.readyState||new Promise((t=>{e.addEventListener("readystatechange",(()=>{"loading"!==e.readyState&&t(!0)})),setTimeout((()=>t(!1)),500)}))}))}(document),f.timeEnd(T),yield function(e,t,i){const s=Array.from(document.querySelectorAll("[data-hsm-adunit]")),o=(null==i?void 0:i.adunits.reduce(((e,t)=>{const i=s.find((e=>e.getAttribute("data-hsm-adunit")===t));return i&&e.push(i),e}),[]))||[],a=s.filter((e=>!o.includes(e))),d=[...o,...a].map((i=>function({container:e,creativeManager:t,allowGptFallback:i}){return(0,r.mG)(this,void 0,void 0,(function*(){const s=e.getAttribute("data-hsm-adunit");if(!s)return;if(f.info(`Начало создания ssr слота ${s}`),e.getAttribute("data-has-before-create")){f.time(`Слот ${s} ожидал хук beforeCreate в течение`);const e=yield function(e,t){return(0,r.mG)(this,void 0,void 0,(function*(){const i=yield t.beforeSlotCreateHandler.getBeforeCreate(e);return i instanceof Function?i():(f.error(`${e} обработчик beforeCreate пропущен т.к. не является функцией`),!0)}))}(s,t);if(f.timeEnd(`Слот ${s} ожидал хук beforeCreate в течение`),!1===e)return void f.info(`Создание слота ${s} отменено в beforeCreate`);f.info(`Создание слота ${s} успешно продолжено после beforeCreate`)}const o=t.createSlot({container:e,adunit:s,params:{priority:1}});return o.then((o=>{if("true"===e.getAttribute("data-hsm-no-adv")&&(null==o||o.setTargeting({key:"blockAdv",value:"no-adv"})),t.emit("slotCreated",o),!i)return void(null==o||o.refresh().catch((e=>{f.warn(e)})));let a=!1;const d=()=>(0,r.mG)(this,void 0,void 0,(function*(){if(o&&!a&&(a=!0,o.config.adserver===n.Vc.GPT)){o.off("error",d),o.off("stub",d),yield o.destroy();const i=yield t.createSlot({container:e,adunit:s,params:{priority:1,adserver:n.Vc.ADFOX}});null==i||i.refresh().catch((e=>f.warn(e)))}}));null==o||o.on("error",d),null==o||o.on("stub",d),null==o||o.refresh().catch((e=>{f.warn(e),d()}))})).catch((e=>f.warn(e))),o}))}({container:i,creativeManager:e,allowGptFallback:t})));return Promise.all(d).catch((e=>f.warn(e)))}(this,(0,r.Q_)(this,Se,"f"),c),(0,r.Q_)(this,ce,"f").call(this),f.info("инициализация завершена")}))}createSlot({container:e,adunit:t,params:i={}}){var s;return(0,r.mG)(this,void 0,void 0,(function*(){if("all"===this.blockedAdunits||this.blockedAdunits.includes(t))return f.error(`Адюнит ${t} был заблокирован пользователем`),null;if(yield this.ready,!e)return f.warn(t,"контейнер не найден"),null;const o=function(e,t,i){const s=e.configManager.findAdunit(t);if(!s)return null;e.adblock.isEnabled?e.adblock.isAdblockPlus?s.refreshEnabled=!1:s.adserver=n.Vc.SCROOGE:(null==i?void 0:i.adserver)&&(s.adserver=i.adserver);const r=e.configManager.findAdunitAdditionalParams(t)||{};return Object.assign(Object.assign({},s),r)}(this,t,i);if(!o)return f.warn(t,"конфиг не найден"),null;const a=(0,r.Q_)(this,ve,"f")[t]||0;(0,r.Q_)(this,ve,"f")[t]=a+1,(0,r.Q_)(this,me,"f")&&(e.id=`${t}_${a}`);const d=(0,r.Q_)(this,ge,"f").waitForMyQueue.bind((0,r.Q_)(this,ge,"f"),null!==(s=i.priority)&&void 0!==s?s:2),l=this.adserverManager.getAdserver(o.adserver);let h=function(e,t,i){if(0===t[n.Vc.ADFOX].length&&0===t[n.Vc.GPT].length)return i;const s=Object.assign(Object.assign({},i.gpt),oe(e,t,n.Vc.GPT)),r=Object.assign(Object.assign({},i.adfox),oe(e,t,n.Vc.ADFOX));return r.prebidAdUnit.bids.length>0&&r.prebidAdUnit.bids.map((t=>{var i,s,r,o;"adriver"===t.bidder&&null!==localStorage.getItem("adrcid")&&(t.params=Object.assign(Object.assign({},t.params),{additional:{ext:{query:`cid=${localStorage.getItem("adrcid")}`}}})),"adfox_yandex_LayerCV"===t.bidder&&window.saluteAdSdk&&Array.isArray(window.saluteAdSdk.categories)&&(t.params=Object.assign(Object.assign({},t.params),{puid8:null===(s=null===(i=window.saluteAdSdk)||void 0===i?void 0:i.categories)||void 0===s?void 0:s.join(":")}),t.customDomain="ads-hb.sberdevices.ru/hb/prod/api/v0"),"myTarget"===t.bidder&&(null===(o=null===(r=window)||void 0===r?void 0:r.rb_sync)||void 0===o?void 0:o.id)&&(t.params=Object.assign(Object.assign({},t.params),{sendTargetRef:!0,additional:{fpid:window.rb_sync.id||""}})),"buzzoola"===t.bidder&&window.Buzzoola&&(t.params=Object.assign(Object.assign({},t.params),{additional:{fpuids:function(){try{return window.Buzzoola.User.getAllData()}catch(e){return{}}}()}})),e.projectKey===n.Xu.WOMAN&&"videonow"===t.bidder&&null!==localStorage.getItem("videonow-stableid")&&(t.params=Object.assign(Object.assign({},t.params),{additional:{stableid:localStorage.getItem("videonow-stableid")}}))})),0===s.prebidAdUnit.bids.length&&(delete s.adUnitPath,delete s.prebidAdUnit),0===r.prebidAdUnit.bids.length&&(delete r.adUnitPath,delete r.prebidAdUnit),Object.assign(Object.assign({},i),{gpt:s,adfox:r})}(o,this.configManager.adserversBidders,i);const c=function(e,t){var i,s;return"floorAd"===t.type||"floorAd"===(null===(s=null===(i=e.adfoxConfig)||void 0===i?void 0:i.creativeConfig)||void 0===s?void 0:s.type)}(o,i);c&&(h=Object.assign(Object.assign({},h),this.stickyRsya.creativeParams));const u=l.createSlot(e,o,h,d);return c&&u.on("render",(e=>{const t=null==e?void 0:e.stickyAdNode;t?this.stickyRsya.setRootElement(t):f.error("[STICKY RSYA] Нет селектора стики в ответе slot.on('render')")})),u.setTargeting({key:"bunN",value:a.toString()},{key:"GMBunN",value:a.toString()},{key:"puid1",value:a.toString()}),this.slots.push(u),u}))}destroySlot(e){return(0,r.mG)(this,void 0,void 0,(function*(){yield e.destroy();const t=this.slots.indexOf(e);-1!==t&&this.slots.splice(t,1)}))}setTargeting(...e){this.setGlobalTargetings(...e),this.slots.forEach((t=>t.setTargeting(...e)))}setGlobalTargetings(...e){e.forEach((e=>this.targetings[e.key]=e.value)),this.adserverManager.forEachAdserver((t=>t.setTargeting(...e))),f.info("Проставлены глобальные таргетинги",e)}findSlots(e){return this.slots.filter((t=>t.config.placement===e))}refreshBranding(){f.info("[Branging]: начинаем рефреш"),this.brandingSlots.forEach((e=>e.refresh()))}beforeSlotCreate(e,t){this.beforeSlotCreateHandler.setBeforeCreate(e,t)}unblockAdunits(){this.blockedAdunits=[]}clearSession(){this.adserverManager.forEachAdserver((e=>e.clearSession()))}enableLogs(){f.enabled=!0,localStorage.setItem(be,"TRUE")}disableLogs(){f.enabled=!1,localStorage.removeItem(be)}toggleConsole(){return(0,r.mG)(this,void 0,void 0,(function*(){const e=document.querySelector("#hsm-creative-manager-devtools");if(e)return localStorage.removeItem(Te),void e.remove();yield Promise.all([i.e(851),i.e(897)]).then(i.bind(i,58)).then((e=>e.default())),localStorage.setItem(Te,"TRUE")}))}appendAdvertisementMark(e){M(e)}}he=new WeakMap,ce=new WeakMap,ue=new WeakMap,fe=new WeakMap,ge=new WeakMap,ve=new WeakMap,me=new WeakMap,pe=new WeakMap,Ee=new WeakMap,Se=new WeakMap},448:(e,t,i)=>{var s,r,n,o,a,d,l,h,c,u,f,g,v,m,p,E,S,A,b,T,C,y,I,w,R,D,_,k,O,P,M,L,N,x,U,B,G,V,j,H,F,Y,q,$,z,W,K,Q,J;i.d(t,{Vc:()=>n,Nk:()=>c,PV:()=>g,zB:()=>v,Ar:()=>k,Xu:()=>B}),function(e){e.SEARCH="search",e.CREATE="create",e.UPDATE="update",e.EDIT="edit",e.DELETE="delete",e.ATTACH="attach"}(s||(s={})),function(e){e.CAMPAIGN="CAMPAIGN",e.CREATIVE="CREATIVE"}(r||(r={})),function(e){e.SCROOGE="SCROOGE",e.ADFOX="ADFOX",e.RTB="RTB",e.GPT="GPT"}(n||(n={})),function(e){e.ACTIVE="ACTIVE",e.INACTIVE="INACTIVE",e.DELETED="DELETED"}(o||(o={})),function(e){e.ID_ASC="ID_ASC",e.ID_DESC="ID_DESC",e.STATUS_ASC="STATUS_ASC",e.STATUS_DESC="STATUS_DESC",e.PLACEMENT_ASC="PLACEMENT_ASC",e.PLACEMENT_DESC="PLACEMENT_DESC",e.PROJECT_ASC="PROJECT_ASC",e.PROJECT_DESC="PROJECT_DESC",e.ADSERVER_ASC="ADSERVER_ASC",e.ADSERVER_DESC="ADSERVER_DESC",e.LAYOUT_ASC="LAYOUT_ASC",e.LAYOUT_DESC="LAYOUT_DESC"}(a||(a={})),function(e){e.ID_ASC="ID_ASC",e.ID_DESC="ID_DESC",e.DISPLAY_NAME_ASC="DISPLAY_NAME_ASC",e.DISPLAY_NAME_DESC="DISPLAY_NAME_DESC"}(d||(d={})),function(e){e.ADV="ADV",e.INFO="INFO"}(l||(l={})),function(e){e.ID_ASC="ID_ASC",e.ID_DESC="ID_DESC",e.PROJECT_ASC="PROJECT_ASC",e.PROJECT_DESC="PROJECT_DESC",e.STATUS_ASC="STATUS_ASC",e.STATUS_DESC="STATUS_DESC",e.DATE_FROM_ASC="DATE_FROM_ASC",e.DATE_FROM_DESC="DATE_FROM_DESC",e.DATE_TO_ASC="DATE_TO_ASC",e.DATE_TO_DESC="DATE_TO_DESC"}(h||(h={})),function(e){e.INNER="INNER",e.OUTER_BOTTOM="OUTER_BOTTOM",e.DISABLED="DISABLED"}(c||(c={})),function(e){e.ID_ASC="ID_ASC",e.ID_DESC="ID_DESC",e.DISPLAY_NAME_ASC="DISPLAY_NAME_ASC",e.DISPLAY_NAME_DESC="DISPLAY_NAME_DESC",e.CREATED_AT_ASC="CREATED_AT_ASC",e.CREATED_AT_DESC="CREATED_AT_DESC"}(u||(u={})),function(e){e.DATE="DATE",e.ADUNIT="ADUNIT",e.PROJECT="PROJECT",e.IS_MOBILE="IS_MOBILE",e.CAMPAIGN="CAMPAIGN",e.CREATIVE="CREATIVE"}(f||(f={})),function(e){e.COMBO="COMBO",e.INPAGE="INPAGE",e.INSTREAM="INSTREAM",e.EMPTY="EMPTY"}(g||(g={})),function(e){e.STRING="STRING",e.NUMBER="NUMBER"}(v||(v={})),function(e){e.ACTIVE="ACTIVE",e.INACTIVE="INACTIVE",e.DELETED="DELETED"}(m||(m={})),function(e){e.ID_ASC="ID_ASC",e.ID_DESC="ID_DESC",e.STATUS_ASC="STATUS_ASC",e.STATUS_DESC="STATUS_DESC",e.ADSERVER_ASC="ADSERVER_ASC",e.ADSERVER_DESC="ADSERVER_DESC",e.TITLE_ASC="TITLE_ASC",e.TITLE_DESC="TITLE_DESC"}(p||(p={})),function(e){e.RUBRIC="RUBRIC",e.THEME="THEME"}(E||(E={})),function(e){e.ID_ASC="ID_ASC",e.ID_DESC="ID_DESC",e.PROJECT_ASC="PROJECT_ASC",e.PROJECT_DESC="PROJECT_DESC",e.RUBRIC_ASC="RUBRIC_ASC",e.RUBRIC_DESC="RUBRIC_DESC",e.STATUS_ASC="STATUS_ASC",e.STATUS_DESC="STATUS_DESC",e.DATE_FROM_ASC="DATE_FROM_ASC",e.DATE_FROM_DESC="DATE_FROM_DESC",e.DATE_TO_ASC="DATE_TO_ASC",e.DATE_TO_DESC="DATE_TO_DESC"}(S||(S={})),function(e){e.TOTAL="TOTAL",e.HOUR="HOUR",e.DAY="DAY"}(A||(A={})),function(e){e.ACTIVE="ACTIVE",e.INACTIVE="INACTIVE",e.DELETED="DELETED"}(b||(b={})),function(e){e.ID_ASC="ID_ASC",e.ID_DESC="ID_DESC",e.CREATED_AT_ASC="CREATED_AT_ASC",e.CREATED_AT_DESC="CREATED_AT_DESC",e.MODIFIED_AT_ASC="MODIFIED_AT_ASC",e.MODIFIED_AT_DESC="MODIFIED_AT_DESC",e.START_AT_ASC="START_AT_ASC",e.START_AT_DESC="START_AT_DESC",e.END_AT_ASC="END_AT_ASC",e.END_AT_DESC="END_AT_DESC",e.STATUS_ASC="STATUS_ASC",e.STATUS_DESC="STATUS_DESC",e.TITLE_ASC="TITLE_ASC",e.TITLE_DESC="TITLE_DESC"}(T||(T={})),function(e){e.ADUNIT="ADUNIT",e.PROJECT="PROJECT",e.IS_MOBILE="IS_MOBILE",e.CAMPAIGN="CAMPAIGN",e.CREATIVE="CREATIVE"}(C||(C={})),function(e){e.ALL="ALL",e.RU="RU",e.KZ="KZ",e.NOT_RU="NOT_RU"}(y||(y={})),function(e){e.DATE="DATE",e.ADUNIT="ADUNIT",e.PROJECT="PROJECT",e.IS_MOBILE="IS_MOBILE",e.CAMPAIGN="CAMPAIGN",e.CREATIVE="CREATIVE"}(I||(I={})),function(e){e.ACTIVE="ACTIVE",e.INACTIVE="INACTIVE",e.DELETED="DELETED"}(w||(w={})),function(e){e.ID_ASC="ID_ASC",e.ID_DESC="ID_DESC",e.STATUS_ASC="STATUS_ASC",e.STATUS_DESC="STATUS_DESC",e.CAMPAIGN_ASC="CAMPAIGN_ASC",e.CAMPAIGN_DESC="CAMPAIGN_DESC",e.TITLE_ASC="TITLE_ASC",e.TITLE_DESC="TITLE_DESC"}(R||(R={})),function(e){e.MOBILE="MOBILE",e.DESKTOP="DESKTOP"}(D||(D={})),function(e){e.ADUNIT="ADUNIT",e.PROJECT="PROJECT",e.IS_MOBILE="IS_MOBILE"}(_||(_={})),function(e){e.STANDART="STANDART",e.ADBLOCK_PLUS="ADBLOCK_PLUS",e.INTERNATIONAL="INTERNATIONAL",e.AMP="AMP"}(k||(k={})),function(e){e.CREATE="CREATE",e.UPDATE="UPDATE",e.DELETE="DELETE"}(O||(O={})),function(e){e.ADUNIT="ADUNIT",e.CAMPAIGN="CAMPAIGN",e.CREATIVE="CREATIVE",e.TEMPLATE="TEMPLATE",e.TEMPLATE_TO_ADUNIT="TEMPLATE_TO_ADUNIT",e.REPORT="REPORT",e.BIDDER="BIDDER"}(P||(P={})),function(e){e.ID_ASC="ID_ASC",e.ID_DESC="ID_DESC"}(M||(M={})),function(e){e.STATIC="STATIC",e.DYNAMIC="DYNAMIC"}(L||(L={})),function(e){e.ALIEXPRESS="aliexpress",e.YANDEX_MARKET="yandex_market",e.ADMITAD="admitad",e.DIRECT_SALES="direct_sales"}(N||(N={})),function(e){e.ID_ASC="ID_ASC",e.ID_DESC="ID_DESC",e.TITLE_ASC="TITLE_ASC",e.TITLE_DESC="TITLE_DESC",e.COMMISSION_ASC="COMMISSION_ASC",e.COMMISSION_DESC="COMMISSION_DESC",e.RATING_ASC="RATING_ASC",e.RATING_DESC="RATING_DESC"}(x||(x={})),function(e){e.ID_ASC="ID_ASC",e.ID_DESC="ID_DESC",e.TITLE_ASC="TITLE_ASC",e.TITLE_DESC="TITLE_DESC",e.PARTNER_ASC="PARTNER_ASC",e.PARTNER_DESC="PARTNER_DESC",e.PROJECT_ASC="PROJECT_ASC",e.PROJECT_DESC="PROJECT_DESC",e.COMMISSION_ASC="COMMISSION_ASC",e.COMMISSION_DESC="COMMISSION_DESC",e.CTR_ASC="CTR_ASC",e.CTR_DESC="CTR_DESC",e.ARTICLES_ASC="ARTICLES_ASC",e.ARTICLES_DESC="ARTICLES_DESC",e.CLICKS_ASC="CLICKS_ASC",e.CLICKS_DESC="CLICKS_DESC",e.VIEWS_ASC="VIEWS_ASC",e.VIEWS_DESC="VIEWS_DESC"}(U||(U={})),function(e){e.NGS="NGS",e.NGS24="NGS24",e.NGS55="NGS55",e.NGS22="NGS22",e.NGS42="NGS42",e.NGS70="NGS70",e.IRCITY="IRCITY",e.NN="NN",e.RU59="RU59",e.RU93="RU93",e.RU72="RU72",e.RU76="RU76",e.SOCHI1="SOCHI1",e.E1="E1",e.RU63="RU63",e.RU45="RU45",e.RU74="RU74",e.RU29="RU29",e.RU178="RU178",e.RU56="RU56",e.RU71="RU71",e.RU48="RU48",e.RU62="RU62",e.RU161="RU161",e.UFA1="UFA1",e.PROVORONEZH="PROVORONEZH",e.STERLITAMAK1="STERLITAMAK1",e.RU14="RU14",e.RU116="RU116",e.MGORSK="MGORSK",e.PROIZHEVSK="PROIZHEVSK",e.RU26="RU26",e.VLADIVOSTOK1="VLADIVOSTOK1",e.RU35="RU35",e.RU43="RU43",e.RU51="RU51",e.RU53="RU53",e.RU60="RU60",e.RU164="RU164",e.CHITA="CHITA",e.RU86="RU86",e.RU89="RU89",e.RU68="RU68",e.RU173="RU173",e.MSK1="MSK1",e.V1="V1",e.TOLYATTY="TOLYATTY",e.FONTANKA="FONTANKA",e.WDAY="WDAY",e.WOMAN="WOMAN",e.WOMANFORUM="WOMANFORUM",e.MAXIM="MAXIM",e.MISSMAXIM="MISSMAXIM",e.MARIECLAIRE="MARIECLAIRE",e.MARIECLAIREKZ="MARIECLAIREKZ",e.ELLEGIRL="ELLEGIRL",e.GM="GM",e.ELLE="ELLE",e.ELLEDECORATION="ELLEDECORATION",e.PARENTS="PARENTS",e.PSYCHOLOGIES="PSYCHOLOGIES",e.VOKRUGSVETA="VOKRUGSVETA",e.DOCTORPITER="DOCTORPITER",e.LEGIONMEDIA="LEGIONMEDIA",e.PORTAL="PORTAL",e.PORTAL_PHOTO_ARCHIVE="PORTAL_PHOTO_ARCHIVE",e.STARHIT="STARHIT"}(B||(B={})),function(e){e.CP="CP",e.GM="GM"}(G||(G={})),function(e){e.NEW="NEW",e.PENDING="PENDING",e.FAILED="FAILED",e.DONE="DONE"}(V||(V={})),function(e){e.CSV="CSV",e.XLSX="XLSX"}(j||(j={})),function(e){e.ID_ASC="ID_ASC",e.ID_DESC="ID_DESC",e.CREATED_AT_ASC="CREATED_AT_ASC",e.CREATED_AT_DESC="CREATED_AT_DESC"}(H||(H={})),function(e){e.ID_ASC="ID_ASC",e.ID_DESC="ID_DESC",e.NAME_ASC="NAME_ASC",e.NAME_DESC="NAME_DESC"}(F||(F={})),function(e){e.ADUNIT="adunit",e.BRANDING="branding",e.ADUNITSTATUS="adunitStatus",e.CAMPAIGN="campaign",e.CREATIVE="creative",e.PRODUCT="product",e.MARKETPLACE="marketplace",e.REPORT="report",e.SCROOGEREPORT="scroogeReport",e.PARTNERSREPORT="partnersReport",e.PREBIDREPORT="prebidReport",e.PRODUCTREPORT="productReport",e.TEMPLATE="template",e.TEMPLATEADUNITLINK="templateAdunitLink",e.BIDDER="bidder",e.ADVERTISER="advertiser",e.COMMERCIALARTICLE="commercialArticle",e.ADVLOGO="advLogo",e.ADVLABEL="advLabel"}(Y||(Y={})),function(e){e.SCROOGE="SCROOGE",e.PARTNERS="PARTNERS",e.PREBID="PREBID",e.PRODUCTS="PRODUCTS"}(q||(q={})),function(e){e.EMPTY_PROJECT="EMPTY_PROJECT",e.EMPTY_DEVICE="EMPTY_DEVICE",e.EMPTY_PLACEMENT="EMPTY_PLACEMENT",e.EMPTY_PARAM="EMPTY_PARAM",e.INVALID_PROJECT="INVALID_PROJECT",e.INVALID_DEVICE="INVALID_DEVICE",e.INVALID_PLACEMENT="INVALID_PLACEMENT",e.INVALID_PARAM="INVALID_PARAM"}($||($={})),function(e){e.ACTIVE="ACTIVE",e.INACTIVE="INACTIVE",e.DELETED="DELETED"}(z||(z={})),function(e){e.ID_ASC="ID_ASC",e.ID_DESC="ID_DESC"}(W||(W={})),function(e){e.ADUNIT="ADUNIT",e.PROJECT="PROJECT",e.IS_MOBILE="IS_MOBILE",e.CAMPAIGN="CAMPAIGN",e.CREATIVE="CREATIVE"}(K||(K={})),function(e){e.ADUNIT="ADUNIT",e.PROJECT="PROJECT",e.IS_MOBILE="IS_MOBILE",e.CAMPAIGN="CAMPAIGN",e.CREATIVE="CREATIVE"}(Q||(Q={})),function(e){e.PARTNERS="PARTNERS",e.DIRECT_SALES="DIRECT_SALES"}(J||(J={}))},711:(e,t,i)=>{i.r(t),i.d(t,{AdvertiserMark:()=>l,INSIDE_TEMPLATE:()=>o,LEFT:()=>d,STATIC:()=>a});var s=i(123),r=i(259),n=i(448);const o="INSIDE_TEMPLATE",a="STATIC",d="LEFT";class l extends HTMLElement{constructor(){var e;super(),this.wrapper=null,this.infoBlock=null,this.infoText=null,this.mark=null,this.markSvg=null,this.markClickArea=null,this.cross=null,this.isInfoBlockVisible=!1,this.shouldShowInfoBlock=!0,this.isMobile=!1,this.allowInfoWindowUnderMark=!1,this.markPosition=o,this.markPositionClassName={[n.Nk.INNER]:"_inner",[n.Nk.OUTER_BOTTOM]:"_outer-bottom",[a]:"_static",[d]:"_left",[o]:""},this.infoWidthDesktop=380,this.infoWidthMobile=343,this.infoBlockMargin=16,this.infoTextHeight=72,this.infoTextStep=24,this.handleScroll=()=>{this.isInfoBlockVisible&&this.toggleInfoVisibility(!1)};const t=document.createElement("style");t.innerHTML=r.Z.toString(),this.attachShadow({mode:"open"}),this.shadowRoot.innerHTML='<div class="advertiser-mark-wrapper"> <div class="advertiser-mark"> <div class="advertiser-mark-svg _absolute-center"></div> <div class="advertiser-mark-click-area _absolute-center"></div> <div class="advertiser-info"> <div class="advertiser-info-text"><slot></slot></div> <div class="advertiser-info-cross"></div> </div> <div class="advertiser-mark-triangle _absolute-center"> </div> </div> </div>',this.shadowRoot.appendChild(t),this.wrapper=this.shadowRoot.querySelector(".advertiser-mark-wrapper"),this.infoBlock=this.shadowRoot.querySelector(".advertiser-info"),this.infoText=this.shadowRoot.querySelector(".advertiser-info-text"),this.mark=this.shadowRoot.querySelector(".advertiser-mark"),this.markClickArea=this.shadowRoot.querySelector(".advertiser-mark-click-area"),this.markSvg=this.shadowRoot.querySelector(".advertiser-mark-svg"),this.cross=this.shadowRoot.querySelector(".advertiser-info-cross"),this.markClickArea&&(this.markClickArea.addEventListener("click",(e=>{e.preventDefault(),this.toggleInfoVisibility()})),window.addEventListener("scroll",this.handleScroll)),this.cross&&this.cross.addEventListener("click",(e=>{e.preventDefault(),this.toggleInfoVisibility(!1)})),this.markSvg.innerHTML=s,null===(e=this.infoBlock)||void 0===e||e.style.setProperty("--lineheight",`${this.infoTextStep}px`)}toggleInfoVisibility(e){var t,i;this.shouldShowInfoBlock||(e=!1),this.recalulateInfoBlockPosition(),this.isInfoBlockVisible=(null===(t=this.wrapper)||void 0===t?void 0:t.classList.toggle("_advertiser-info-visible",e))||!1,this.isInfoBlockVisible&&this.checkTopOffset(),null===(i=this.wrapper)||void 0===i||i.dispatchEvent(new CustomEvent("scrooge-advertiser-mark-visibility-change",{bubbles:!0,composed:!0,detail:{isVisible:this.isInfoBlockVisible}}))}recalulateInfoBlockPosition(){var e,t;const{left:i,width:s}=this.mark.getBoundingClientRect();null===(e=this.infoBlock)||void 0===e||e.style.setProperty("--width",`${this.infoWidth}px`);let r=0;if(this.markPosition===n.Nk.INNER){const{width:e}=this.mark.getBoundingClientRect();r=-(this.infoWidth-e)/2}const o=s/2+i-this.infoBlockMargin,a=document.body.offsetWidth-(s/2+i)-this.infoBlockMargin,d=this.infoWidth/2-o;d>0&&(r=d);const l=this.infoWidth/2-a;l>0&&(r=-l),null===(t=this.infoBlock)||void 0===t||t.style.setProperty("--offset",`${r}px`)}checkTopOffset(){var e,t;if(this.drawInfoWindowUnderMark(!1),null===(e=this.infoText)||void 0===e||e.style.setProperty("--maxheight",`${this.infoTextHeight}px`),!this.infoBlock)return;const{top:i}=this.infoBlock.getBoundingClientRect(),s=i+window.scrollY;if(this.drawInfoWindowUnderMark(this.allowInfoWindowUnderMark),this.allowInfoWindowUnderMark)return;if(s>=0)return;const r=Math.abs(s),n=Math.floor((this.infoTextHeight-r)/this.infoTextStep)*this.infoTextStep;null===(t=this.infoText)||void 0===t||t.style.setProperty("--maxheight",`${Math.max(n,this.infoTextStep)}px`)}setPosition(e){if(this.markPosition===e)return;this.markPosition=e;const t=this.markPositionClassName[this.markPosition];this.classList.remove(...this.allMarkClasses),this.markPosition===a&&this.classList.add(t),this.markPosition===d&&this.classList.add(t),this.wrapper.classList.remove(...this.allMarkClasses),this.wrapper.classList.add(t)}setIsMobile(){this.isMobile=!0}setAllowInfoWindowUnderMark(){this.allowInfoWindowUnderMark=!0}drawInfoWindowUnderMark(e){var t;null===(t=this.wrapper)||void 0===t||t.classList.toggle("_info-window-under-mark",e)}setShowInfo(e){var t;this.shouldShowInfoBlock="false"!==e,null===(t=this.wrapper)||void 0===t||t.classList.toggle("_disabled",!this.shouldShowInfoBlock)}get allMarkClasses(){return Object.values(this.markPositionClassName).filter(Boolean)}get infoWidth(){var e;const t=this.isMobile?this.infoWidthMobile:this.infoWidthDesktop;if(this.markPosition===n.Nk.INNER){const i=null===(e=this.closest("div[data-adv-mark-info-window-bounding]"))||void 0===e?void 0:e.offsetWidth;return i?Math.min(i-4,t):t}return t}static get observedAttributes(){return["mark-position","show-info","is-mobile","allow-info-window-under-mark"]}attributeChangedCallback(e,t,i){switch(e){case"mark-position":this.setPosition(i);break;case"is-mobile":this.setIsMobile();break;case"allow-info-window-under-mark":this.setAllowInfoWindowUnderMark();break;case"show-info":this.setShowInfo(i)}}}},259:(e,t,i)=>{i.d(t,{Z:()=>u});var s=i(81),r=i.n(s),n=i(645),o=i.n(n),a=i(667),d=i.n(a),l=new URL(i(52),i.b),h=o()(r()),c=d()(l);h.push([e.id,'@font-face{font-family:"Inter-Regular";font-style:normal;font-weight:400;font-display:swap;src:url('+c+') format("woff")}:host{display:block;position:relative}.advertiser-mark-wrapper{position:absolute;left:0;bottom:0;width:100%}.advertiser-mark-wrapper._disabled{pointer-events:none}.advertiser-mark{position:absolute;height:12px;width:64px;top:0;left:0}.advertiser-mark-svg{line-height:0}.advertiser-mark-click-area{position:absolute;z-index:1;top:-4px;left:-4px;height:20px;width:72px;user-select:none;cursor:pointer}.advertiser-mark-triangle{display:none;position:absolute;bottom:100%;width:0;height:0;border-style:solid;border-width:6px 6px 0 6px;border-color:#fff transparent transparent transparent;z-index:1}.advertiser-mark-svg._absolute-center,.advertiser-mark-triangle._absolute-center{left:0;right:0;margin:0 auto}.advertiser-info{--offset: 0px;--width: 356px;position:absolute;display:none;bottom:18px;left:var(--offset);transform:translateX(calc(-50% + 32px));width:var(--width);box-sizing:border-box;background-color:#fff;padding:16px 32px 16px 16px;font-family:"Inter-Regular",sans-serif;font-size:16px;line-height:var(--lineheight, 24px);text-align:left;color:#37404d;filter:drop-shadow(0px 0px 8px rgba(0, 0, 0, 0.16))}.advertiser-info-text{max-height:var(--maxheight, 72px);overflow:auto}.advertiser-info-cross{position:absolute;right:8px;top:8px;width:16px;height:16px;cursor:pointer;user-select:none}.advertiser-info-cross:before,.advertiser-info-cross:after{content:"";position:absolute;width:12px;height:1px;top:50%;left:2px;border-radius:25%;background-color:#ababab;transform-origin:50% 50%}.advertiser-info-cross:before{transform:rotate(45deg)}.advertiser-info-cross:after{transform:rotate(-45deg)}slot{color:#37404d;font-weight:normal}._advertiser-info-visible .advertiser-mark-triangle,._advertiser-info-visible .advertiser-info{display:block}.advertiser-mark-wrapper._inner{bottom:14px}.advertiser-mark-wrapper._inner .advertiser-mark{margin:0;left:auto;right:2px;bottom:2px}.advertiser-mark-wrapper._outer-bottom .advertiser-mark{bottom:-12px;left:0;right:0;margin:0 auto}:host(._static){width:64px;height:12px}:host(._left){width:64px;height:12px;left:-10px}.advertiser-mark-wrapper._static{position:static;left:auto;top:auto}.advertiser-mark-wrapper._static .advertiser-mark{position:static;left:auto;top:auto}.advertiser-mark-wrapper._left{position:static;left:auto;top:auto}.advertiser-mark-wrapper._left .advertiser-mark{position:static;left:auto;top:auto}.advertiser-mark-wrapper._info-window-under-mark .advertiser-info{bottom:auto;top:18px}.advertiser-mark-wrapper._info-window-under-mark .advertiser-mark-triangle{top:100%;bottom:auto;transform:rotate(180deg);transform-origin:center center}',""]);const u=h},645:e=>{e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var i="",s=void 0!==t[5];return t[4]&&(i+="@supports (".concat(t[4],") {")),t[2]&&(i+="@media ".concat(t[2]," {")),s&&(i+="@layer".concat(t[5].length>0?" ".concat(t[5]):""," {")),i+=e(t),s&&(i+="}"),t[2]&&(i+="}"),t[4]&&(i+="}"),i})).join("")},t.i=function(e,i,s,r,n){"string"==typeof e&&(e=[[null,e,void 0]]);var o={};if(s)for(var a=0;a<this.length;a++){var d=this[a][0];null!=d&&(o[d]=!0)}for(var l=0;l<e.length;l++){var h=[].concat(e[l]);s&&o[h[0]]||(void 0!==n&&(void 0===h[5]||(h[1]="@layer".concat(h[5].length>0?" ".concat(h[5]):""," {").concat(h[1],"}")),h[5]=n),i&&(h[2]?(h[1]="@media ".concat(h[2]," {").concat(h[1],"}"),h[2]=i):h[2]=i),r&&(h[4]?(h[1]="@supports (".concat(h[4],") {").concat(h[1],"}"),h[4]=r):h[4]="".concat(r)),t.push(h))}},t}},667:e=>{e.exports=function(e,t){return t||(t={}),e?(e=String(e.__esModule?e.default:e),/^['"].*['"]$/.test(e)&&(e=e.slice(1,-1)),t.hash&&(e+=t.hash),/["'() \t\n]|(%20)/.test(e)||t.needQuotes?'"'.concat(e.replace(/"/g,'\\"').replace(/\n/g,"\\n"),'"'):e):e}},81:e=>{e.exports=function(e){return e[1]}},655:(e,t,i)=>{function s(e,t){var i={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&t.indexOf(s)<0&&(i[s]=e[s]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(s=Object.getOwnPropertySymbols(e);r<s.length;r++)t.indexOf(s[r])<0&&Object.prototype.propertyIsEnumerable.call(e,s[r])&&(i[s[r]]=e[s[r]])}return i}function r(e,t,i,s){return new(i||(i=Promise))((function(r,n){function o(e){try{d(s.next(e))}catch(e){n(e)}}function a(e){try{d(s.throw(e))}catch(e){n(e)}}function d(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}d((s=s.apply(e,t||[])).next())}))}function n(e,t,i,s){if("a"===i&&!s)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!s:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===i?s:"a"===i?s.call(e):s?s.value:t.get(e)}function o(e,t,i,s,r){if("m"===s)throw new TypeError("Private method is not writable");if("a"===s&&!r)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===s?r.call(e,i):r?r.value=i:t.set(e,i),i}i.d(t,{_T:()=>s,mG:()=>r,Q_:()=>n,YH:()=>o}),Object.create,Object.create},52:(e,t,i)=>{e.exports=i.p+"4142cf2e29adc01c89f4.woff"},123:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" width="64" height="12" fill="none"><rect width="64" height="8" y="2" fill="#fff" fill-opacity=".6" rx="4"/><path fill="#000" fill-opacity=".6" d="M10.815 8.182V3.818h1.721c.331 0 .613.063.846.19.233.125.41.299.533.522.123.221.185.477.185.767 0 .29-.063.545-.188.767a1.293 1.293 0 0 1-.543.518c-.236.123-.521.185-.856.185h-1.098v-.74h.949c.177 0 .323-.03.438-.09a.607.607 0 0 0 .26-.259.807.807 0 0 0 .088-.381.786.786 0 0 0-.088-.38.583.583 0 0 0-.26-.253.95.95 0 0 0-.443-.092h-.622v3.61h-.922ZM16.74 8.182V3.818h2.94v.76h-2.018v1.04h1.866v.761h-1.866v1.042h2.026v.76H16.74ZM25.093 8.182l-1.402-1.86h-.315v1.86h-.923V3.818h.923v1.743h.185l1.449-1.743h1.148l-1.702 2.024 1.781 2.34h-1.144ZM28.505 8.182V7.44l.123-.01a.56.56 0 0 0 .386-.181c.098-.11.171-.284.22-.522.049-.24.081-.563.095-.968l.073-1.94h2.961v4.363h-.897V4.558h-1.208l-.068 1.519c-.023.488-.081.887-.175 1.197-.092.31-.24.538-.443.686-.202.148-.478.222-.829.222h-.238ZM35.916 8.182h-.989l1.507-4.364h1.189l1.504 4.364h-.989l-1.093-3.367h-.034l-1.095 3.367Zm-.062-1.715h2.336v.72h-2.336v-.72ZM41.692 3.818h1.138l1.202 2.932h.05l1.203-2.932h1.137v4.364h-.895v-2.84h-.036l-1.13 2.819h-.608l-1.13-2.83h-.036v2.85h-.895V3.819ZM49.975 8.182h-.99l1.507-4.364h1.19l1.503 4.364h-.988l-1.093-3.367h-.034l-1.095 3.367Zm-.062-1.715h2.335v.72h-2.335v-.72Z"/></svg>'}},n={};function o(e){var t=n[e];if(void 0!==t)return t.exports;var i=n[e]={id:e,exports:{}};return r[e](i,i.exports,o),i.exports}o.m=r,o.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return o.d(t,{a:t}),t},o.d=(e,t)=>{for(var i in t)o.o(t,i)&&!o.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},o.f={},o.e=e=>Promise.all(Object.keys(o.f).reduce(((t,i)=>(o.f[i](e,t),t)),[])),o.u=e=>(897===e?"hsm-cm-console":e)+"."+o.h()+".js",o.miniCssF=e=>e+".style."+o.h()+".css",o.h=()=>"d6be478b1d6050b28a21",o.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),o.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),e={},t="@smh/monetization-scrooge-client:",o.l=(i,s,r,n)=>{if(e[i])e[i].push(s);else{var a,d;if(void 0!==r)for(var l=document.getElementsByTagName("script"),h=0;h<l.length;h++){var c=l[h];if(c.getAttribute("src")==i||c.getAttribute("data-webpack")==t+r){a=c;break}}a||(d=!0,(a=document.createElement("script")).charset="utf-8",a.timeout=120,o.nc&&a.setAttribute("nonce",o.nc),a.setAttribute("data-webpack",t+r),a.src=i),e[i]=[s];var u=(t,s)=>{a.onerror=a.onload=null,clearTimeout(f);var r=e[i];if(delete e[i],a.parentNode&&a.parentNode.removeChild(a),r&&r.forEach((e=>e(s))),t)return t(s)},f=setTimeout(u.bind(null,void 0,{type:"timeout",target:a}),12e4);a.onerror=u.bind(null,a.onerror),a.onload=u.bind(null,a.onload),d&&document.head.appendChild(a)}},o.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{var e;o.g.importScripts&&(e=o.g.location+"");var t=o.g.document;if(!e&&t&&(t.currentScript&&(e=t.currentScript.src),!e)){var i=t.getElementsByTagName("script");i.length&&(e=i[i.length-1].src)}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),o.p=e})(),i=e=>new Promise(((t,i)=>{var s=o.miniCssF(e),r=o.p+s;if(((e,t)=>{for(var i=document.getElementsByTagName("link"),s=0;s<i.length;s++){var r=(o=i[s]).getAttribute("data-href")||o.getAttribute("href");if("stylesheet"===o.rel&&(r===e||r===t))return o}var n=document.getElementsByTagName("style");for(s=0;s<n.length;s++){var o;if((r=(o=n[s]).getAttribute("data-href"))===e||r===t)return o}})(s,r))return t();((e,t,i,s)=>{var r=document.createElement("link");r.rel="stylesheet",r.type="text/css",r.onerror=r.onload=n=>{if(r.onerror=r.onload=null,"load"===n.type)i();else{var o=n&&("load"===n.type?"missing":n.type),a=n&&n.target&&n.target.href||t,d=new Error("Loading CSS chunk "+e+" failed.\n("+a+")");d.code="CSS_CHUNK_LOAD_FAILED",d.type=o,d.request=a,r.parentNode.removeChild(r),s(d)}},r.href=t,document.head.appendChild(r)})(e,r,t,i)})),s={69:0},o.f.miniCss=(e,t)=>{s[e]?t.push(s[e]):0!==s[e]&&{897:1}[e]&&t.push(s[e]=i(e).then((()=>{s[e]=0}),(t=>{throw delete s[e],t})))},(()=>{o.b=document.baseURI||self.location.href;var e={69:0};o.f.j=(t,i)=>{var s=o.o(e,t)?e[t]:void 0;if(0!==s)if(s)i.push(s[2]);else{var r=new Promise(((i,r)=>s=e[t]=[i,r]));i.push(s[2]=r);var n=o.p+o.u(t),a=new Error;o.l(n,(i=>{if(o.o(e,t)&&(0!==(s=e[t])&&(e[t]=void 0),s)){var r=i&&("load"===i.type?"missing":i.type),n=i&&i.target&&i.target.src;a.message="Loading chunk "+t+" failed.\n("+r+": "+n+")",a.name="ChunkLoadError",a.type=r,a.request=n,s[1](a)}}),"chunk-"+t,t)}};var t=(t,i)=>{var s,r,[n,a,d]=i,l=0;if(n.some((t=>0!==e[t]))){for(s in a)o.o(a,s)&&(o.m[s]=a[s]);d&&d(o)}for(t&&t(i);l<n.length;l++)r=n[l],o.o(e,r)&&e[r]&&e[r][0](),e[r]=0},i=self.webpackChunk_smh_monetization_scrooge_client=self.webpackChunk_smh_monetization_scrooge_client||[];i.forEach(t.bind(null,0)),i.push=t.bind(null,i.push.bind(i))})(),(()=>{var e=o(397);const t=window.HSMCreativeManager=new e.yg,{onHSMCreativeManagerReady:i}=window,s=Array.isArray(i)?i:[];window.onHSMCreativeManagerReady={push(e){e(t)}},s.forEach((e=>e(t)))})()})();</script>
</body>
</html>
