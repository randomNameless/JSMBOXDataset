<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RetailAnalytics.min.html</title>
</head>
<body>

<script>
"undefined"!=typeof analyticsJS&&analyticsJS&&analyticsJS.topicNamespace||(analyticsJS={storeId:0,catalogId:0,urlPath:null,miniShopCartTitle:"MiniShoppingCart",jsonPageView:"AnalyticsPageView",jsonProductView:"AnalyticsProductView",jsonElementView:"AnalyticsElementView",jsonShopcartView:"AnalyticsShopcartView",jsonShopcartViewGTM:"AnalyticsShopcartViewGtm",jsonRegistrationView:"AnalyticsRegistrationView",jsonConversionEventView:"AnalyticsConversionEventView",topicNamespace:"/wc/analytics/",pageView:"pageview",productView:"productview",cartView:"cartview",cartViewGTM:"cartviewGTM",element:"element",registration:"registration",conversionEvent:"conversionevent",pageViewControl:!1,incTaxInUnitPriceForCart:"F",plusQuantityClickAction:!1,cartViewTrigger:"View basket & checkout",cartViewActionIdList:["AjaxAddOrderItem","AjaxDeleteOrderItem","AjaxUpdateOrderItem","AjaxAddOrderItemWithShipingInfo","AjaxEmptyBasket"],myAccountPageIdList:["UserRegistrationUpdate","updateAddressBook","profileUpdate"],myAddressBookPageIdList:["updateAddress","AddressDelete"],wishlistPageIdList:["AjaxInterestItemAdd","InterestItemDelete","AjaxGiftListServiceAddItem","AjaxGiftListServiceRemoveItem","ShoppingListServiceAddItem"],conversionEventList:["AjaxGiftListServiceAddItem","ShoppingListServiceAddItem","AnalyticsConversionEvent"],registrationViewIdList:["UserRegistrationUpdate"],fastFinderEvents:[["filterResultsWithOrderBy","orderby",function(e){var t="";return t=e&&null!=e&&null!=e.options?e.options[e.selectedIndex].text:t}],["filterResultsWithPrice","price slider range",function(e){e=e.getFormattedValues();return["[",e.lower," - ",e.upper,"]"].join("")}],["filterResultsWithView","view change"]],fastFinderCheckboxForms:[["BrandsForm","brands"],["FeatureNamesForm","features"]],getPageId:function(){var e="";return e=null==(e=null!=dojo.byId("cm_pageView_information")&&null!=dojo.getAttr(dojo.byId("cm_pageView_information"),"data-page-view")?JSON.parse(dojo.getAttr(dojo.byId("cm_pageView_information"),"data-page-view")).pageId:e)||""==e?document.title:e},publishAnalyticsView:function(e,t,o){var n=this,t={url:getAbsoluteURL()+e,encoding:"utf-8",handleAs:"json",content:dojo.mixin({storeId:n.storeId,catalogId:n.catalogId},t),error:function(e,t){dojo.publish("ajaxRequestCompleted")},load:function(e,t){o.call(n,e),dojo.publish("ajaxRequestCompleted")}};dojo.publish("ajaxRequestInitiated"),dojo.xhrGet(t)},publishTopic:function(e,t){e=this.makeTopic(e);dojo.publish(e,t)},publishPageView:function(e){var t=this;this.publishAnalyticsView(t.jsonPageView,e,function(e){t.publishTopic(t.pageView,e)})},publishConversionEventView:function(){var e,t=this,o="R"==getCookie("UserType")?"Y":"N";dojo.byId("cm_product")&&(e=dojo.byId("cm_product").value);var n="PLP";dojo.byId("s7viewerAsset")&&(n="PDP"),this.publishAnalyticsView(t.jsonConversionEventView,{eventId:"AddToWishlist",cat:"Wishlist",loggedIn:o,cmProduct:e,routeToProduct:n},function(e){t.publishTopic(t.conversionEvent,e)})},publishCartView:function(){var t=this;this.publishAnalyticsView(t.jsonShopcartView,{storeId:t.storeId,incTaxInPrice:t.incTaxInUnitPriceForCart},function(e){t.publishTopic(t.cartView,e)}),t.publishCartViewAjaxGtm()},addProductData:function(e,t,o,n){var i=JSON.parse(sessionStorage.getItem("DataLayerEventBasketSessionVar"))||{};i[e]||(i[e]={}),!0!==n&&i[e][t]||(i[e][t]=o),sessionStorage.setItem("DataLayerEventBasketSessionVar",JSON.stringify(i))},getProductData:function(e,t){var o=JSON.parse(sessionStorage.getItem("DataLayerEventBasketSessionVar"))||{};return o[e]=o[e]||{},t?o[e][t]:o[e]},applyProductData:function(e,r,a){var t=this;null!=e&&0<e.length&&e.forEach(function(o){var n,i;null!=o&&""!=o&&(n=t.getProductData(o.id),i=new Array,n&&["productBreadcrumbs","categoryTree","cartSourcePageNumber","cartSourcePageID","routeToCart","cartedQuantity","basePrice","discountTotal","coupon","couponType"].forEach(function(e){var t;"productBreadcrumbs"!=e||null!=(t=n[e])&&(t.split("|").forEach(function(e){""!=e&&i.push(e)}),o[e]=i,i=null),"cartedQuantity"===e?!0===r&&(o.quantity=n.cartedQuantity||0):("basePrice"!==e&&"discountTotal"!==e&&"coupon"!==e&&"couponType"!==e||"decreaseCartQuantity"===a)&&(o[e]=n[e]||"")}))})},removeProductData:function(e){var t=JSON.parse(sessionStorage.getItem("DataLayerEventBasketSessionVar"))||{};t[e]&&delete t[e],sessionStorage.setItem("DataLayerEventBasketSessionVar",JSON.stringify(t))},gtmPush:function(e,t){var o=(new Date).getTime(),o=Math.round(o/1e3);"undefined"!=typeof Storage&&(void 0!==sessionStorage.orginalReference&&(sessionObj.originalReferral=sessionStorage.orginalReference),void 0!==sessionStorage.pdpViewed&&(sessionObj.pdpViewed=sessionStorage.pdpViewed),void 0!==sessionStorage.globalNavValue&&(sessionObj.globalNavUsed=sessionStorage.globalNavValue),void 0!==sessionStorage.productCarted&&(sessionObj.productCarted=sessionStorage.productCarted)),(e=e||{})["event.timestamp"]=o,e.session=null!=t?t:sessionObj,e.user=userObj,window.dataLayer=window.dataLayer||[],dataLayer.push(e)},publishCartViewAjaxGtm:function(){var t,e;null!=document.getElementById("gtm_switch")&&("true"!=document.getElementById("gtm_switch").value||null!=(e=getCookie("DataLayerEventBasket"))&&""!=e&&(3<(e=e.split("_")).length?(t=e[0],e[1],this.publishAnalyticsView(this.jsonShopcartViewGTM,{storeId:this.storeId,incTaxInPrice:this.incTaxInUnitPriceForCart},function(e){this.handleCartViewGtmAjaxEvent(e,t)})):1<e.length&&null!=(t=e[0])&&"promoCodeAppliedEvent"==t&&(e=e[1],this.publishApplyPromoCode(e,t))))},handleCartViewGtmAjaxEvent:function(e,t){var o,n;null!=e&&(o=e.cart.products,delete(n=e.cart).products,"increaseCartQuantity"==t&&(this.plusQuantityClickAction?(this.applyProductData(o,!0),this.plusQuantityClickAction=!1):this.applyProductData(o,!1),"undefined"!=typeof Storage&&(sessionObj=sessionObj||{},sessionObj.productCarted=!0,sessionStorage.productCarted=!0),this.gtmPush({event:"addToCart",page:{id:"Shopping Cart"},"session.productCarted":"TRUE",ecommerce:{currencyCode:e.currencyCode,cart:n,add:{products:o}}})),"decreaseCartQuantity"==t&&(this.applyProductData(o,!1,t),this.gtmPush({event:"removeFromCart",ecommerce:{remove:{basketID:n.basketID,products:o}}})))},publishApplyPromoCode:function(e,t){this.gtmPush({event:"applyOfferCode",eventCategory:"Offer Codes",eventAction:"Apply",eventLabel:e}),removeCookie("DataLayerEventBasket")},publishCartViewGtm:function(){var t=this;this.publishAnalyticsView(t.jsonShopcartViewGTM,{storeId:t.storeId,incTaxInPrice:t.incTaxInUnitPriceForCart},function(e){null!=e&&(this.applyProductData(e.cart.products),this.gtmPush({event:"cartView",page:{id:"Shopping Cart",viewTrigger:t.cartViewTrigger},ecommerce:{currencyCode:e.currencyCode,cart:e.cart}}))})},publishCheckoutViewGtm:function(e,t){var o,n=this;null!=document.getElementById("gtm_switch")&&"true"==document.getElementById("gtm_switch").value&&(null!=e&&"true"==e&&(null!=(e=getCookie("DataLayerLoginOption"))&&"Registered"==e&&t?(this.publishAnalyticsView(n.jsonShopcartViewGTM,{storeId:n.storeId,incTaxInPrice:n.incTaxInUnitPriceForCart},function(e){this.applyProductData(e.cart.products),this.gtmPush({event:"checkoutRegistered",ecommerce:{cart:e.cart,checkout:{step:"1",loginOption:"Registered"}}})}),dojo.cookie("DataLayerLoginOption","Registered",{path:"/"})):null!=e&&"Logged in: at checkout"==e?(this.publishAnalyticsView(n.jsonShopcartViewGTM,{storeId:n.storeId,incTaxInPrice:n.incTaxInUnitPriceForCart},function(e){this.gtmPush({event:"checkoutLoggedIn",ecommerce:{checkout:{step:"1",loginOption:"Logged in: at checkout"}}})}),dojo.cookie("DataLayerLoginOption","Logged in: at checkout",{path:"/"})):(o="",e=getCookie("DataLayerLoginOption"),o=null!=e&&"Registered"==e?(dojo.cookie("DataLayerLoginOption","Registered",{path:"/"}),"Registered"):(dojo.cookie("DataLayerLoginOption","Logged in: before checkout",{path:"/"}),"Logged in: before checkout"),this.publishAnalyticsView(n.jsonShopcartViewGTM,{storeId:n.storeId,incTaxInPrice:n.incTaxInUnitPriceForCart},function(e){this.gtmPush({event:"checkoutLoggedIn",ecommerce:{checkout:{step:"1",loginOption:o}}})}))),this.gtmPush({event:"checkout",ecommerce:{checkout:{step:"1"}}}))},publishcheckoutLoginRegisterClickGtm:function(e){this.gtmPush({event:"loginClick",eventCategory:"LoginRegister",eventAction:"Click login",eventLabel:"Remember me: "+e})},publishforgotPasswordGtmTab:function(){this.gtmPush({event:"forgotPasswordClick",eventCategory:"LoginRegister",eventAction:"Click forgot password",eventLabel:"ForgotPassword",ecommerce:{checkout:{type:"Retail"}}})},publishcheckoutLoginRegisterGtmTab:function(e){"checkoutLoginOptionTabLogin"==e?this.gtmPush({event:"checkoutLoginOptionTabLogin",eventCategory:"Checkout login options",eventAction:"Click login tab",eventLabel:"Login tab"}):this.gtmPush({event:"checkoutLoginOptionTabGuest",eventCategory:"Checkout login options",eventAction:"Click guest tab",eventLabel:"Guest Tab"})},publishcheckoutLoginRegisterGtm:function(e){null!=document.getElementById("gtm_switch")&&"true"==document.getElementById("gtm_switch").value&&(null!=e&&"true"==e?(this.publishCheckoutViewGtm("false",!1),this.gtmPush({event:"checkoutLoginRegister",eventCategory:"Popups",eventAction:"View",eventLabel:"Checkout login popup",eventTrigger:"Retail Checkout"})):(null!=e&&"Guest"==e?this.gtmPush({event:"checkoutGuest",ecommerce:{checkout:{step:"1",loginOption:"Guest"}}}):this.gtmPush({event:"checkoutLoginRegisterPopupClose",eventCategory:"Popups",eventAction:"Close",eventLabel:"Checkout login popup"}),dojo.cookie("DataLayerLoginOption","Guest",{path:"/"})))},publishWishlistViewGtm:function(){var t=this;null!=document.getElementById("gtm_switch")&&"true"==document.getElementById("gtm_switch").value&&this.publishAnalyticsView(t.jsonShopcartViewGTM,{storeId:t.storeId,incTaxInPrice:t.incTaxInUnitPriceForCart},function(e){null!=e&&0<e.length&&(e[0].quantity=1,e[0].hasGWP="false",t.applyProductData(e),this.gtmPush({event:"saveForLater",eventLabel:"Save for later",eventCategory:"Shopping basket",eventAction:"Click",ecommerce:{saveForLater:{products:e}}}))})},publishRemoveFromSaveForLaterGtm:function(e,t){null!=document.getElementById("gtm_switch")&&"true"==document.getElementById("gtm_switch").value&&this.gtmPush({event:"removeFromSaveForLater",eventLabel:"Save for later",eventCategory:"Shopping basket",eventAction:"Remove",ecommerce:{saved:{products:[{id:e,name:t}]}}})},publishRegistrationView:function(){var t=this;this.publishAnalyticsView(t.jsonRegistrationView,{storeId:t.storeId},function(e){t.publishTopic(t.registration,e)})},makeTopic:function(e){return[this.topicNamespace,e].join("")},getMiniShopCartPageCategory:function(){return"MiniShoppingCart"},getMiniShopCartPageName:function(){return this.getPageId()},getMiniShopCartPageViewData:function(e){return{pagename:"MiniShoppingCart",category:this.getMiniShopCartPageCategory()}},getPageViewData:function(){var e,t,o=this.getPageId();return null!=dojo.byId("cm_pageView_information")&&null!=dojo.getAttr(dojo.byId("cm_pageView_information"),"data-page-view")&&(e=(t=JSON.parse(dojo.getAttr(dojo.byId("cm_pageView_information"),"data-page-view"))).category,t=t.attributes),{pagename:o,category:e,attributes:t}},registerMiniShopCartPageView:function(e){var t=this;dojo.connect(null,"showMiniShopCartDropDown",function(){e=null==e||""==e?t.getMiniShopCartPageName():e})},publishMiniShopCartPageView:function(e){this.pageViewControl||(this.lockPageView(),e=this.getMiniShopCartPageViewData(e),this.publishPageView(e))},firePageView:function(){var e;this.pageViewControl||(this.lockPageView(),e=this.getPageViewData(),this.publishPageView(e))},lockPageView:function(){this.pageViewControl=!0,setTimeout("analyticsJS.pageViewControl = false;",3e3)},registerMiniShopCartCartView:function(){var t=this;dojo.forEach(this.cartViewActionIdList,function(e){dojo.subscribe("modelChanged/"+e,function(){t.publishCartView()})}),dojo.subscribe("CMAddToCart",function(){t.publishCartView()})},loadShopCartHandler:function(e){1==e&&(this.incTaxInUnitPriceForCart="T"),this.registerMiniShopCartCartView(),this.registerShopCartPaginationPageView(),this.registerShippingBillingAddressEditPageView()},loadShopCartPaginationHandler:function(){this.registerShopCartPaginationPageView()},registerShopCartPaginationPageView:function(){var t=this;dojo.subscribe("ShopCartPaginationDisplay_Context/RenderContextChanged",function(){var e={pagename:t.getPageId()};t.publishPageView(e)}),dojo.subscribe("OrderItemPaginationDisplay_Context/RenderContextChanged",function(){var e={pagename:t.getPageId()};t.publishPageView(e)}),dojo.subscribe("traditionalShipmentDetailsContext/RenderContextChanged",function(){var e={pagename:t.getPageId()};t.publishPageView(e)}),dojo.subscribe("MSOrderItemPaginationDisplay_Context/RenderContextChanged",function(){var e={pagename:t.getPageId()};t.publishPageView(e)})},registerShippingBillingAddressEditPageView:function(){var t=this;dojo.subscribe("editShippingAddressContext/RenderContextChanged",function(){var e={pagename:t.getPageId(),category:"Shipping and biling address"};t.publishPageView(e)})},registerStoreLocatorPageViews:function(){var t=this;dojo.subscribe("selectedStoreListContext/RenderContextChanged",function(){var e={pagename:t.getPageId(),category:"Store locator"};t.publishPageView(e)}),dojo.subscribe("storeLocatorResultsContext/RenderContextChanged",function(){var e={pagename:t.getPageId(),category:"Store locator"};t.publishPageView(e)})},loadStoreLocatorPageViews:function(){var e=this;dojo.addOnLoad(function(){e.registerStoreLocatorPageViews()})},registerFastFinderEventHandlers:function(i){var r=this;dojo.forEach(r.fastFinderEvents,function(e){var t=e[0],o=e[1],n=e[2];dojo.connect(fastFinderJS,t,function(e){r.publishAnalyticsView(r.jsonElementView,{elementId:n?n(e):e,category:["Fast Finder:",o].join(""),pageId:r.getPageId(),pageCategory:i},function(e){r.publishTopic(r.element,e)})})})},registerFastFinderFormHandlers:function(){var n=this;dojo.forEach(n.fastFinderCheckboxForms,function(e){var t=e[0],o=e[1];dojo.forEach(document.forms[t].elements,function(e){n.connectFastFinderInputs(e,o)})})},connectFastFinderInputs:function(e,t){var o=this;dojo.connect(e,"onclick",function(){o.publishAnalyticsView(o.jsonElementView,{elementId:e.value,category:["Fast Finder: ",t].join(""),pageId:o.getPageId(),pageCategory:"Fast Finder",state:e.checked?"checked":"unchecked"},function(e){o.publishTopic(o.element,e)})})},loadFastFinderHandlers:function(e){var t=this;dojo.addOnLoad(function(){t.registerFastFinderEventHandlers(e),t.registerFastFinderFormHandlers()})},registerUserRegUpdateHandler:function(){var t=this,o={pagename:"My Account:"+t.getPageId(),category:"MyAccountPage"};dojo.forEach(this.registrationViewIdList,function(e){dojo.subscribe("modelChanged/"+e,function(){t.publishRegistrationView()})}),dojo.forEach(this.myAccountPageIdList,function(e){dojo.subscribe("modelChanged/"+e,function(){t.publishPageView(o)})})},publishMyAccountPageView:function(e){var t=this,o=wc.render.getContextById(e).properties.workAreaMode,e="";"myAccountMain"==o?e="My Account:"+t.getPageId():"personalInformation"==o?e="Personal Information:"+t.getPageId():"addressBook"==o?e="My Address Book:"+t.getPageId():"trackOrderStatus"==o?e="My Orders:"+t.getPageId():"checkoutProfile"==o?e="Quick checkout profile:"+t.getPageId():"wishList"==o?e="Personal Wishlist:"+t.getPageId():"couponWallet"==o&&(e="My Coupons:"+t.getPageId()),t.publishPageView({pagename:e,category:"MyAccountPage"})},registerMyAccountPageHandler:function(e){var t=this;dojo.connect(MyAccountDisplay,"loadContentFromURL",function(){t.publishMyAccountPageView(e)}),dojo.connect(wc.render.getRefreshControllerById("MyAccountCenterLinkDisplay_Controller"),"postRefreshHandler",function(){cX("onload")})},registerMyAddressBookHandler:function(){var t=this,o={pagename:"My Address Book:"+t.getPageId(),category:"MyAccountPage"};dojo.forEach(this.myAddressBookPageIdList,function(e){dojo.subscribe("modelChanged/"+e,function(){t.publishPageView(o)})}),dojo.subscribe("addressBookContext/RenderContextChanged",function(){t.publishPageView(o)})},registerWishlistHandler:function(){var t=this;t.getPageId();dojo.forEach(this.conversionEventList,function(e){dojo.subscribe("modelChanged/"+e,function(){t.publishConversionEventView()})})},loadWishlistHandler:function(){var e=this;dojo.addOnLoad(function(){e.registerWishlistHandler()})},loadMyAccountPageHandlers:function(){var e=this;dojo.addOnLoad(function(){e.registerUserRegUpdateHandler(),e.registerMyAccountPageHandler("MyAccountCenterLinkDisplay_Context"),e.registerMyAddressBookHandler()})},publishShopCartLoginTags:function(){var e=this;dojo.addOnLoad(function(){e.publishRegistrationView(),e.publishCartView()})},registerProductQuickInfoView:function(e){var t=this;"undefined"!=typeof QuickInfoJS&&dojo.connect(QuickInfoJS,"showDetails",function(){var e;dojo.byId("productInfoId")?e=dojo.byId("productInfoId").innerHTML:dojo.byId("catEntryParamsForJS")&&(e=dojo.fromJson(dojo.byId("catEntryParamsForJS").value).id),t.publishAnalyticsView(t.jsonProductView,{productId:e,storeId:t.storeId},function(e){t.publishTopic(t.productView,e)})})},loadProductQuickInfoHandler:function(e){var t=this;dojo.addOnLoad(function(){t.registerProductQuickInfoView(e)})},loadPagingHandler:function(){var i=this;dojo.addOnLoad(function(){var e="page forward",t="page backward";dojo.forEach([["CatalogSearchDisplayJS","goBack",t],["CatalogSearchDisplayJS","goForward",e],["CatalogSearchDisplayJS.HistoryTracker.prototype","back",t],["CatalogSearchDisplayJS.HistoryTracker.prototype","forward",e],["fastFinderJS","goBack",t],["fastFinderJS","goForward",e],["fastFinderJS","filterResultsWithPrevIndex",t],["fastFinderJS","filterResultsWithNextIndex",e],["fastFinderJS.HistoryTracker.prototype","back",t],["fastFinderJS.HistoryTracker.prototype","forward",e],["MyAccountDisplay","goBack",t],["MyAccountDisplay","goForward",e],["MyAccountDisplay.HistoryTracker.prototype","back",t],["MyAccountDisplay.HistoryTracker.prototype","forward",e],["Common","goBack",t],["Common","goForard",e],["Common.HistoryTracker.prototype","back",t],["Common.HistoryTracker.prototype","forward",e],["categoryDisplayJS","loadContentURL","view change"]],function(e){var t=dojo.getObject(e[0]),o=e[1],n=e[2];dojo.connect(t,o,function(){i.publishPageView({pagename:i.getPageId(),category:n})})})})},registerSearchResultPageView:function(refreshControllerId,resultInfoDivId,registerPageViewNow,advSearchFormDivId){var realSearch=!0,scope=this,resultInfo,pageViewData,exploreAttrVal,index,index1,exploreAttrVal;registerPageViewNow&&null!=dojo.byId(resultInfoDivId)&&(resultInfo=eval("("+dojo.byId(resultInfoDivId).innerHTML+")").searchResult,pageViewData={pagename:scope.getPageId()},""!=resultInfo.searchTerms&&(pageViewData="0"!=resultInfo.totalResultCount?{pagename:"Search Successful:"+resultInfo.currentPageNumber}:null!=resultInfo.pageId&&"DidYouMean"==resultInfo.pageId?{pagename:"Search Successful: Did you mean"}:{pagename:"Search Results: Unsuccessful"},pageViewData.searchTerms=resultInfo.searchTerms,pageViewData.searchCount=resultInfo.totalResultCount,pageViewData.category="Search Results",null!=document.getElementById("cmBrand")&&""!=document.getElementById("cmBrand").value&&(pageViewData.category=document.getElementById("cmBrand").value)),null!=document.getElementById("brandName")?(brandName=document.getElementById("brandName").value,pageViewData.category="AZBrandDirectory",null!=document.getElementById("cmBrand")&&document.getElementById("cmBrand").value&&(pageViewData.category=document.getElementById("cmBrand").value),exploreAttrVal=resultInfo.attributes,null!=exploreAttrVal&&(index=exploreAttrVal.split("-_-",6),index1=exploreAttrVal.split("-_-",6).join("-_-").length,exploreAttrVal=exploreAttrVal.substr(0,index1)+brandName+exploreAttrVal.substr(index1),pageViewData.attributes=exploreAttrVal)):pageViewData.attributes=resultInfo.attributes.replace("&gt;",">"),scope.publishPageView(pageViewData)),dojo.connect(wc.render.getRefreshControllerById(refreshControllerId),"postRefreshHandler",function(){var resultInfo=eval("("+dojo.byId(resultInfoDivId).innerHTML+")").searchResult,pageViewData={pagename:scope.getPageId()},exploreAttrVal,index,index1,exploreAttrVal;""!=resultInfo.searchTerms&&(pageViewData="0"!=resultInfo.totalResultCount?{pagename:"Search Successful:"+resultInfo.currentPageNumber}:null!=resultInfo.pageId&&"DidYouMean"==resultInfo.pageId?{pagename:"Search Results: Did you mean"}:{pagename:"Search Results: Unsuccessful"},realSearch&&(0<resultInfo.searchTerms.length&&1==resultInfo.currentPageNumber&&(pageViewData.searchTerms=resultInfo.searchTerms,pageViewData.searchCount=resultInfo.totalResultCount),pageViewData.category="Search Results")),null!=document.getElementById("brandName")?(brandName=document.getElementById("brandName").value,pageViewData.category="AZBrandDirectory",null!=document.getElementById("cmBrand")&&document.getElementById("cmBrand").value&&(pageViewData.category=document.getElementById("cmBrand").value),exploreAttrVal=resultInfo.attributes,null!=exploreAttrVal&&(index=exploreAttrVal.split("-_-",6),index1=exploreAttrVal.split("-_-",6).join("-_-").length,exploreAttrVal=exploreAttrVal.substr(0,index1)+brandName+exploreAttrVal.substr(index1),pageViewData.attributes=exploreAttrVal)):pageViewData.attributes=resultInfo.attributes,scope.publishPageView(pageViewData)})},registerCategorySearchResultPageView:function(refreshControllerId,resultInfoDivId,registerPageViewNow,advSearchFormDivId){var realSearch=!0,scope=this,resultInfo,pageViewData;registerPageViewNow&&null!=dojo.byId(resultInfoDivId)&&(resultInfo=eval("("+dojo.byId(resultInfoDivId).innerHTML+")").searchResult,pageViewData={pagename:scope.getPageId()},""!=resultInfo.searchTerms&&(pageViewData=(resultInfo.totalResultCount,{pagename:resultInfo.pageId}),0<resultInfo.searchTerms.length&&1==resultInfo.currentPageNumber&&(pageViewData.searchCount=resultInfo.totalResultCount),pageViewData.category=resultInfo.categoryId),pageViewData.attributes=resultInfo.attributes,scope.publishPageView(pageViewData)),dojo.connect(wc.render.getRefreshControllerById(refreshControllerId),"postRefreshHandler",function(){var resultInfo=eval("("+dojo.byId(resultInfoDivId).innerHTML+")").searchResult,pageViewData={pagename:scope.getPageId()};""!=resultInfo.searchTerms&&(pageViewData=(resultInfo.totalResultCount,{pagename:resultInfo.pageId}),realSearch&&(0<resultInfo.searchTerms.length&&1==resultInfo.currentPageNumber&&(pageViewData.searchCount=resultInfo.totalResultCount),pageViewData.category=resultInfo.categoryId)),pageViewData.attributes=resultInfo.attributes,scope.publishPageView(pageViewData)})},loadSearchResultHandler:function(e,t,o,n){var i=this;dojo.subscribe("CMPageRefreshEvent",function(){i.registerSearchResultPageView(e,t,o,n)})},loadCategorySearchResultHandler:function(e,t,o,n){var i=this;dojo.subscribe("CMPageRefreshEvent",function(){i.registerCategorySearchResultPageView(e,t,o,n)})},registerPaymentPageView:function(e){var n=this;dojo.connect(e,"setNumberOfPaymentMethods",function(e,t,o){n.publishPageView({pagename:t.value,category:"payment method"})})},loadPaymentPageView:function(e){var t=this;dojo.addOnLoad(function(){t.registerPaymentPageView(e)})},loadCheckoutHandler:function(){dojo.addOnLoad(function(){dojo.forEach([["shipModeDetailsController","postRefreshHandler","Checkout:Delivery Options","CHECKOUT","exAttrDelOpt"],["deliverySummaryController","postRefreshHandler","Checkout:Delivery Contact Details Home","CHECKOUT","exAttrDelSum"],["CheckoutStoreLocatorSummaryController","postRefreshHandler","Checkout:Delivery Contact Details CFS","CHECKOUT","exAttrDelSumCFS"],["CheckoutStoreLocatorController","postRefreshHandler","Checkout:Delivery Select Store CFS","CHECKOUT","exAttrSelStoreCFS"],["collectNamedDayController","postRefreshHandler","Checkout:Delivery Date Selection CFS","CHECKOUT","exAttrNDDelOpt"],["redeemOnlineController","postRefreshHandler","Checkout:Payment ACP","CHECKOUT","exAttrACPOpt"],["findPOAreaController","postRefreshHandler","Checkout:Delivery Select Store CFPO","CHECKOUT","exAttrSelStorePO"],["checkoutPostOfficeSummaryController","postRefreshHandler","Checkout:Delivery Contact Details CFPO","CHECKOUT","exAttrDelSumCFPO"],["paymentDetailsController","postRefreshHandler","Checkout:Payment Details","CHECKOUT","exAttrPaymentDetais"],["billingAddressOPCController","postRefreshHandler","Checkout:Billing Address","CHECKOUT","exAttrBillingDelAddr"]],function(e){var t=e[0],o=e[1],n=e[2],i=(e[3],e[4]);dojo.connect(wc.render.getRefreshControllerById(t),o,function(){var e=null;null!=document.getElementById(i)&&(e=document.getElementById(i).value),"none"!=dojo.byId("delivery_option_and_content_container").style.display&&("shipModeDetailsController"==t&&0!=dojo.byId("shipmodeDetails").offsetHeight||"deliverySummaryController"==t&&0!=dojo.byId("deliverySummary").offsetHeight||"CheckoutStoreLocatorSummaryController"==t&&0!=dojo.byId("checkoutStoreSummary").offsetHeight||"CheckoutStoreLocatorController"==t&&0!=dojo.byId("checkoutStoreAddress").offsetHeight||"collectNamedDayController"==t&&0!=dojo.byId("collectNamedDay").offsetHeight||"collectNamedDayController"==t&&0!=dojo.byId("collectNamedDay").offsetHeight||"redeemOnlineController"==t&&0!=dojo.byId("redeemOnline").offsetHeight||"findPOAreaController"==t&&0!=dojo.byId("checkoutPostOfficeAddress").offsetHeight||"checkoutPostOfficeSummaryController"==t&&0!=dojo.byId("checkoutPostOfficeSummary").offsetHeight||"billingAddressOPCController"==t&&0!=dojo.byId("billingAddressOPC").offsetHeight)&&"undefined"!=typeof RetailCoreMetricsHelper&&(RetailCoreMetricsHelper.setPreviousSectionId(RetailCoreMetricsHelper.getCurrentSectionId()),RetailCoreMetricsHelper.setCurrentSectionId(n),RetailCoreMetricsHelper.fireCheckoutSectionPageViewTag(e))})})})},loadPaymentHandler:function(){var r=this;dojo.addOnLoad(function(){dojo.forEach(["card_option_button","paypal_option","masterpass_option","redeem_option"],function(o){var e=dojo.byId(o),n=o,t=o.indexOf("_"),i="Checkout:Payment "+(n="redeem"==(n=-1!=t?o.substr(0,t):n)?"ACP":n).charAt(0).toUpperCase()+n.slice(1);null!=e&&dojo.connect(e,"onclick",function(){var e,t=null;null!=document.getElementById("exAttrDelSum")&&((t=document.getElementById("exAttrDelSum").value).split("-_-",4),e=t.split("-_-",4).join("-_-").length,t=t.substr(0,e)+n+t.substr(e)),"undefined"!=typeof RetailCoreMetricsHelper&&(RetailCoreMetricsHelper.setPreviousSectionId(RetailCoreMetricsHelper.getCurrentSectionId()),RetailCoreMetricsHelper.setCurrentSectionId(i),RetailCoreMetricsHelper.fireCheckoutSectionPageViewTag(t)),"redeem_option"!=o||null!=(t=document.getElementById("cmACPErrMsg"))&&null!=t.value&&r.publishAnalyticsView(r.jsonElementView,{elementId:t.value,category:"Error",pageId:r.getPageId(),pageCategory:"CHECKOUT",attributes:t},function(e){r.publishTopic(r.element,e)})})})})},loadAddressHandler:function(){dojo.addOnLoad(function(){dojo.forEach(["collect_in_store_option_button","home_delivery_option_button","postoffice_option_button"],function(e){var n,i,t=dojo.byId(e),r="";null!=t&&(r="collect_in_store_option_button"==e?(n="Collection from Store",i="Checkout:Delivery Address CFS",null!=document.getElementById("showSummaryPageForCFS")&&(i="Checkout:Delivery Summary CFS"),"exAttrDelSumCFS"):"home_delivery_option_button"==e?(n="Home Delivery",null!=document.getElementById("homedeliveryServiceName")&&(deliveryService=document.getElementById("homedeliveryServiceName").value),n=n+"|"+deliveryService,i="Checkout:Delivery Address Home",null!=document.getElementById("showSummaryPageForHome")&&(i="Checkout:Delivery Summary Home"),"exAttrDelSum"):(n="Collect from Post Office",i="Checkout:Delivery Address CFPO",null!=document.getElementById("showSummaryPageForPO")&&(i="Checkout:Delivery Summary CFPO"),"exAttrDelSumCFPO"),dojo.connect(t,"onclick",function(){var e,t=null,o=dojo.byId("isPharmacy");void 0!==o&&null!=o&&"Y"==o.value?t=(null!=document.getElementById(r)&&null!=document.getElementById(r)&&((t=document.getElementById(r).value).split("-_-",2),e=t.split("-_-",2).join("-_-").length),"-_-"+n+"-_--_--_--_--_--_--_--_--_-Registered"):null!=document.getElementById("exAttrDelSum")&&null!=document.getElementById("exAttr")&&((t=document.getElementById("exAttr").value).split("-_-",2),e=t.split("-_-",2).join("-_-").length,t=t.substr(0,e)+n+t.substr(e)),"undefined"!=typeof RetailCoreMetricsHelper&&(RetailCoreMetricsHelper.setPreviousSectionId(RetailCoreMetricsHelper.getCurrentSectionId()),RetailCoreMetricsHelper.setCurrentSectionId(i),RetailCoreMetricsHelper.fireCheckoutSectionPageViewTag(t))}))})})},loadErrorServiceHandlers:function(){var i=this;dojo.addOnLoad(function(){dojo.forEach([["AjaxPAFFindAddress","CHECKOUT_PAF_GENERIC_ERROR"],["AddShippingAddress","CHECKOUT_DELIVERY_ADDRESS_GENERIC_ERROR"],["OrderItemAddressShipMethodUpdate","CHECKOUT_DELIVERY_OPTION_GENERIC_ERROR"],["OrderItemAddressShipMethodUpdate2","CHECKOUT_DELIVERY_OPTION_GENERIC_ERROR"],["AjaxUpdatePhoneForPersonAndUpdateOrder","CHECKOUT_CONTACT_DETAILS_GENERIC_ERROR"],["AjaxUpdatePhoneForPersonNamedDay","CHECKOUT_CONTACT_DETAILS_GENERIC_ERROR"],["AjaxUpdatePhoneForPerson","CHECKOUT_CONTACT_DETAILS_GENERIC_ERROR"],["AjaxSetAddressIdOfOrderItems","CHECKOUT_ORDER_SHIP_ADDR_ADD_GENERIC_ERROR"],["AddBillingAddress1","CHECKOUT_BILLING_ADDRESS_GENERIC_ERROR"]],function(e){var t=e[0],o=e[1],n=null;dojo.connect(wc.service.getServiceById(t),"failureHandler",function(e){n=null!=storeNLS[e.errorMessageKey]?storeNLS[e.errorMessageKey]:storeNLS[o],i.publishAnalyticsView(i.jsonElementView,{elementId:n,category:"Error",pageId:i.getPageId(),pageCategory:"CHECKOUT",attributes:e.errorMessageKey},function(e){i.publishTopic(i.element,e)})})})})},loadContinuePaymentHandler:function(){dojo.connect(null,"continuePayment",function(){var e,t,o,n,i,r,a="Card",s=null;null!=document.getElementById("continuePaymentFlow")&&("HOME"==(e=document.getElementById("continuePaymentFlow").value)&&null!=document.getElementById("exAttrDelSum")&&(s=document.getElementById("exAttrDelSum").value,o="",(t=dojo.byId("homeDeliveryOption_2"))&&null!=t&&"letterboxDelivery"==t.value?(dojo.byId("homeDeliveryOption1")&&null!=dojo.byId("homeDeliveryOption1")&&"undefined"!=(n=dojo.byId("homedeliveryServiceName"))&&null!=n&&(o=n.value),r=s.split("-_-",2).join("-_-").length,i="Home Delivery|Letterbox Delivery",s="-_-"+(i=""!=o?-1!=o.indexOf("Letterbox")?"Home Delivery|"+o:"Home Delivery|"+o+":Letterbox":i)+s.substr(r)):t&&null!=t&&"letterboxDelivery"!=t.value&&dojo.byId("homeDeliveryOption1")&&null!=dojo.byId("homeDeliveryOption1")&&"undefined"!=(n=dojo.byId("homedeliveryServiceName"))&&null!=n&&(r=s.split("-_-",2).join("-_-").length,s="-_-"+(i="Home Delivery|"+n.value)+s.substr(r)),s.split("-_-",4),r=s.split("-_-",4).join("-_-").length,s=s.substr(0,r)+a+s.substr(r)),"CFS"==e&&null!=document.getElementById("exAttrDelSumCFS")&&((s=document.getElementById("exAttrDelSumCFS").value).split("-_-",4),r=s.split("-_-",4).join("-_-").length,s=s.substr(0,r)+a+s.substr(r)),"CFPO"==e&&null!=document.getElementById("exAttrDelSumCFPO")&&((s=document.getElementById("exAttrDelSumCFPO").value).split("-_-",4),r=s.split("-_-",4).join("-_-").length,s=s.substr(0,r)+a+s.substr(r)),"undefined"!=typeof RetailCoreMetricsHelper&&(RetailCoreMetricsHelper.setPreviousSectionId(RetailCoreMetricsHelper.getCurrentSectionId()),RetailCoreMetricsHelper.setCurrentSectionId("Checkout:Payment Card"),RetailCoreMetricsHelper.fireCheckoutSectionPageViewTag(s)))})},loadErrorHandler:function(e){var i=this;dojo.connect(e,"buildErrormsg",function(e,t,o,n){i.publishAnalyticsView(i.jsonElementView,{elementId:null==n?o:o+n,category:"Error",pageId:i.getPageId(),pageCategory:"CHECKOUT"},function(e){i.publishTopic(i.element,e)})})},loginHandler:function(){var t=this;dojo.addOnLoad(function(){dojo.forEach(["AjaxCustomLogon"],function(e){dojo.connect(wc.service.getServiceById(e),"successHandler",function(e){t.publishAnalyticsView(t.jsonRegistrationView,{storeId:t.storeId},function(e){t.publishTopic(t.registration,e)})})})})},publishLogonScenario:function(e){var t,o=this;null!=document.getElementById("gtm_switch")&&"true"==document.getElementById("gtm_switch").value&&(t=null,e.statusMessage?("Invalid LoginID"==e.statusMessage&&(t=e.errorMessage.replace(/^<div[^>]*>|<\/div>$/g,"")),this.gtmPush({event:"loginFail",eventCategory:"LoginRegister",eventAction:"Fail",eventLabel:"Login",ecommerce:{checkout:{type:"retail"}}}),this.gtmPush({event:"message",eventCategory:"Messages",eventAction:"View",eventLabel:t,page:{id:o.getPageId()},component:{message:{messageType:"Error"}}})):null!=(t=JSON.parse(sessionStorage.getItem("DataCart")))?(this.applyProductData(t.products),this.gtmPush({event:"checkoutLogin",ecommerce:{cart:t,checkout:{step:"1",loginOption:"Logged in: at checkout"}}}),dojo.cookie("DataLayerLoginOption","Logged in: at checkout",{path:"/"}),sessionStorage.setItem("DataCart",null)):(o.publishAnalyticsView(o.jsonShopcartViewGTM,{storeId:o.storeId,incTaxInPrice:o.incTaxInUnitPriceForCart},function(e){this.applyProductData(e.cart.products),this.gtmPush({event:"checkoutLogin",ecommerce:{cart:e.cart,checkout:{step:"1",loginOption:"Logged in: at checkout"}}})}),dojo.cookie("DataLayerLoginOption","Logged in: at checkout",{path:"/"})))},publishCheckoutShippingBillingViewGtm:function(e){var t=e.returningCustomer,o="",n="",i="",r=dojo.byId("shippingFlow"),a=!1;void 0!==r&&null!=r&&"CFS"==r.value?(o="Collect in store",a=!0):void 0!==r&&null!=r&&"HOME"==r.value&&(o="Home delivery",n=null!=(n=jQuery(".delivery_option_name"))&&null!=n.text()?n.text().trim():"",i=null!=(i=jQuery("#deliveryoptionhome_date_gtm"))&&null!=i.val()?i.val().trim():""),this.applyProductData(e.cart.products),t?(this.gtmPush({event:"checkoutReviewBillingAddress",page:{id:"Checkout:Review billing address"}}),this.gtmPush({event:"checkoutPayment",page:{id:"Checkout:Payment Details"},ecommerce:{checkout:{loginOption:e.loginOption,fulfilmentType:o,homeDeliveryType:n,deliveryDate:i,step:"5"},cart:{products:e.cart.products}}})):a?this.gtmPush({event:"checkoutCollectInStore",page:{id:"Checkout:Collect in store"},ecommerce:{checkout:{loginOption:e.loginOption,fulfilmentType:o,step:"2"},cart:{products:e.cart.products}}}):this.gtmPush({event:"checkoutHomeDelivery",page:{id:"Checkout: Delivery Address"},ecommerce:{checkout:{loginOption:e.loginOption,fulfilmentType:o,step:"2"},cart:{products:e.cart.products}}})},publishCheckoutHomeDeliveryEventsGtm:function(e,t){var o,n,i;null!=document.getElementById("gtm_switch")&&"true"==document.getElementById("gtm_switch").value&&(n=o="",void 0!==(i=checkoutDataDL)&&null!=i&&(n=i.loginOption,o=i.cart.products),this.applyProductData(i.cart.products),void 0!==(i=dojo.byId("shippingFlow"))&&null!=i&&"HOME"==i.value&&(null!=e&&"findAddress"==e&&null!=t&&"delivery"==t&&this.gtmPush({event:"checkoutHomeDeliveryFindAddress",eventCategory:"Checkout",eventAction:"Find address",eventLabel:"Home delivery address"}),null!=e&&"confirmAddress"==e&&null!=t&&"delivery"==t&&("undefined"!=typeof Storage&&(sessionStorage.fulfilmentTypeObj="Home delivery"),this.gtmPush({event:"checkoutHomeDeliveryConfirmAddress",eventCategory:"Checkout",eventAction:"Confirm address",eventLabel:"Home delivery address"})),null!=e&&"loadHomeDeliveryOptions"==e&&this.gtmPush({event:"checkoutHomeDeliveryOption",page:{id:"Checkout: Delivery option"},ecommerce:{checkout:{loginOption:n,fulfilmentType:"Home delivery",step:"3"},cart:{products:o}}}),null!=e&&"loadReviewHomeDeliveryDetails"==e&&(t=null!=(t=jQuery("#deliverypromisehome_name_gtm"))&&null!=t.val()?t.val().trim():"",e=null!=(e=jQuery("#deliverypromisehome_Date_gtm"))&&null!=e.val()?e.val().trim():"",this.gtmPush({event:"checkoutReviewHomeDeliveryDetails",page:{id:"Checkout: Review delivery details"},ecommerce:{checkout:{loginOption:n,fulfilmentType:"Home delivery",homeDeliveryType:t,deliveryDate:e,step:"4"},cart:{products:o}}}))))},publishCheckoutShippingBillingViewCFsGtm:function(){var e;null!=document.getElementById("gtm_switch")&&"true"==document.getElementById("gtm_switch").value&&(e=checkoutDataDL,this.applyProductData(e.cart.products),this.gtmPush({event:"checkoutCollectInStore",page:{id:"Checkout:Collect in store"},ecommerce:{checkout:{loginOption:e.loginOption,fulfilmentType:"Collect in store",step:"2"},cart:{products:e.cart.products}}}))},storeResultViewClickCfsGTM:function(e){null!=document.getElementById("gtm_switch")&&"true"==document.getElementById("gtm_switch").value&&(checkoutDataDL,null!=e&&"map"==e?this.gtmPush({event:"checkoutCollectInStoreMap",eventCategory:"Checkout",eventAction:"Click",eventLabel:"Collect in store: map view",page:{id:"Checkout:Store results:Map view"}}):this.gtmPush({event:"checkoutCollectInStoreList",eventCategory:"Checkout",eventAction:"Click",eventLabel:"Collect in store: list view",page:{id:"Checkout:Store results:List view"}}))},storeDetailstViewClickCfsGTM:function(){null!=document.getElementById("gtm_switch")&&"true"==document.getElementById("gtm_switch").value&&(checkoutDataDL,this.gtmPush({event:"checkoutStoreDetails",eventCategory:"Checkout",eventAction:"Click",eventLabel:"Collect in store: Store details"}))},storeDetailstMapViewClickCfsGTM:function(){null!=document.getElementById("gtm_switch")&&"true"==document.getElementById("gtm_switch").value&&(checkoutDataDL,this.gtmPush({event:"checkoutViewStoreOnMap",eventCategory:"Checkout",eventAction:"Click",eventLabel:"Collect in store: View on map"}))},storemoreResultViewClickCfsGTM:function(){null!=document.getElementById("gtm_switch")&&"true"==document.getElementById("gtm_switch").value&&(checkoutDataDL,this.gtmPush({event:"checkoutStoreResultsShowMore",eventCategory:"Checkout",eventAction:"Click",eventLabel:"Collect in store: Show more"}))},storeCfsCollectionDateConfirmationGTM:function(e){var t;null!=document.getElementById("gtm_switch")&&"true"==document.getElementById("gtm_switch").value&&(t=checkoutDataDL,this.applyProductData(t.cart.products),this.gtmPush({event:"checkoutCollectInStoreReview",page:{id:"Checkout:Review Collection Details"},ecommerce:{checkout:{loginOption:t.loginOption,fulfilmentType:"Collect in store",step:"4",deliveryDate:e},cart:{products:t.cart.products}}}))},storeCfsCollectionDateDetailsGTM:function(){var e;null!=document.getElementById("gtm_switch")&&"true"==document.getElementById("gtm_switch").value&&("undefined"!=typeof Storage&&(sessionStorage.fulfilmentTypeObj="Collect in store"),e=checkoutDataDL,this.applyProductData(e.cart.products),this.gtmPush({event:"checkoutCollectionDate",page:{id:"Checkout:Collection date"},ecommerce:{checkout:{loginOption:e.loginOption,fulfilmentType:"Collect in store",step:"3"},cart:{products:e.cart.products}}}))},postCodeFinderCfsGTM:function(){var e;null!=document.getElementById("gtm_switch")&&"true"==document.getElementById("gtm_switch").value&&(e=checkoutDataDL,this.gtmPush({event:"checkoutStoreResults",page:{id:"Checkout:Store results"},ecommerce:{checkout:{loginOption:e.loginOption,fulfilmentType:"Collect in store"}}}))},publishCheckoutBillingEventsGtm:function(e,t,o){var n,i,r,a,s,c,l;null!=document.getElementById("gtm_switch")&&"true"==document.getElementById("gtm_switch").value&&(c=s=a=r=i="",void 0!==(n=checkoutDataDL)&&null!=n&&(r=n.loginOption,i=n.cart.products),l=dojo.byId("shippingFlow"),this.applyProductData(n.cart.products),void 0!==l&&null!=l&&"HOME"==l.value?(c="Home delivery",a=null!=(a=jQuery("#deliverypromisehome_name_gtm"))&&null!=a.val()?a.val().trim():"",s=null!=(s=jQuery("#deliverypromisehome_Date_gtm"))&&null!=s.val()?s.val().trim():""):void 0!==l&&null!=l&&"CFS"==l.value&&(c="Collect in store",s=null!=(s=jQuery("#deliverypromisecollect_Date_gtm"))&&null!=s.val()?s.val().trim():""),null!=e&&"findAddress"==e&&null!=t&&"billing"==t&&this.gtmPush({event:"checkoutBillingAddressFind",eventCategory:"Checkout:payment:find-address",eventAction:"Click",eventLabel:"Billing address: Find address"}),null!=e&&"confirmAddress"==e&&null!=t&&"billing"==t&&this.gtmPush({event:"checkoutBillingAddressConfirm",ecommerce:{checkout:{loginOption:r,fulfilmentType:c,homeDeliveryType:a,step:"6",paymentType:"Card",deliveryDate:s},cart:{products:i}}}),null!=e&&"SelectPaymentType"==e&&this.gtmPush({event:"checkoutSelectPaymentType",eventCategory:"Checkout:Payment Types",eventAction:"Click",eventLabel:o,ecommerce:{checkout:{step:"6"}}}))},publishListPageProductClickEventGTM:function(e,t){var o,n;null!=document.getElementById("gtm_switch")&&"true"==document.getElementById("gtm_switch").value&&(o="",n=new Array,null!=e&&(delete e.list,n.push(e)),null!=dojo.byId("listPageType")&&(o=dojo.byId("listPageType").value),this.gtmPush({event:"productClick",ecommerce:{click:{actionField:{list:t?o+": Add to Cart":o},products:n}}}))},publishAdd2CartEventListPageGTM:function(e,t){var o=getCookie("DataLayerEventBasket");this.storeId=e,this.catalogId=t,null!=o&&""!=o&&((o=o.split("_")).length=2,"listPageAdd2cart"==o[0]&&this.publishAnalyticsView(this.jsonShopcartViewGTM,{storeId:this.storeId},function(e){var t,o,n;null!=e&&null!=e.cart.products&&0<e.cart.products.length&&(t=e.cart.products,delete(o=e.cart).products,quickBuyBtnEvent=dojo.byId("listPageTypeEvent"),null!=quickBuyBtnEvent&&null!=quickBuyBtnEvent&&"quickBuyEvent"==quickBuyBtnEvent.value?(t[0].quickBuy="Y",quickBuyBtnEvent.value=""):t[0].quickBuy="N",this.applyProductData(t),"undefined"!=typeof Storage&&(sessionObj=sessionObj||{},sessionObj.productCarted=!0,sessionStorage.productCarted=!0),n="Listing: "+document.title,"undefined"!=typeof gtm_slpPageId&&null!=gtm_slpPageId&&gtm_slpPageId.trim()&&(n=gtm_slpPageId),this.gtmPush({event:"addToCart",page:{id:n},ecommerce:{currencyCode:e.currencyCode,cart:o,add:{products:t}}}))}))},publishPlpViewGtm:function(e,t){var o,n;getCookie("analyticsFacetAttributes");n=null!=byId("facetFilterList")?(o=(n=this.searchfacetSetGTM()).productNameObj,n.productValueObj):o="",this.gtmPush({event:"plpView",page:{id:t.id,category:t.category,facetsApplied:o,facetValuesSelected:n,sortOption:t.sortOption,listFormat:t.listFormat,viewTrigger:t.viewTrigger,pageNumber:t.pageNumber},ecommerce:{impressions:{products:e}}})},publishPDPViewGtm:function(e,t,o){var n,i=dojo.byId("gtmProdId").value,r=dojo.byId("gtmProdName").value,a=dojo.byId("gtmProdcategory").value,s=dojo.byId("gtmProdHasColourOptions").value,c=dojo.byId("gtmProdHasSizeOptions").value,l=dojo.byId("gtmProdInStockClickAndCollect").value,u=dojo.byId("gtmProdInStockHomeDelivery").value,d=dojo.byId("gtmProdIsAgeRestricted").value,g=dojo.byId("gtmProdIsAdvCardPointsCollectable").value,m=dojo.byId("gtmProdIsVATExempt").value,p=dojo.byId("gtmProdIsDropship").value,h=dojo.byId("gtmProdBundle").value,y=dojo.byId("gtmProdBrand").value,v=dojo.byId("gtmProdPrice").value,f=dojo.byId("gtmProdIsFreeGift").value;null!=o&&1<o.length&&(n=o);var C=!1,o="";"undefined"!=typeof Storage&&(C=sessionStorage.pdpViewed=!0,null!=(o=sessionStorage.getItem("SearchRedirect"))&&""!=o?sessionStorage.removeItem("SearchRedirect"):o=""),sessionObj=sessionObj||{},sessionObj.pdpViewed=C;C=[];C.push({id:i,name:r,category:a,categoryTree:n,hasColourOptions:s,hasSizeOptions:c,inStockClickAndCollect:l,inStockHomeDelivery:u,isAgeRestricted:d,isAdvCardPointsCollectable:g,isVATExempt:m,isDropShip:p,bundle:h,brand:y,price:v,isGWP:f}),this.gtmPush({event:"pdpView",page:{id:e.id,breadcrumb:e.breadcrumb,searchRedirectTerm:o},"ecommerce.detail":{actionField:{list:new Array(t.list)},viewType:t.viewType,trigger:t.trigger,cta:t.cta,promoBadgeCount:t.promoCount,products:C}})},publishPDPVariantSelectEvent:function(e,t,o){this.gtmPush({event:e,eventCategory:"PDP",eventAction:"Select",eventLabel:t,ecommerce:o})},publishPDPClickOfferOverlayEvent:function(e,t,o){if(null!=document.getElementById("gtm_switch")){var n=document.getElementById("gtm_switch").value;if("true"==n)if(null!=document.getElementById("gtm_pdp_switch"))if("true"==document.getElementById("gtm_pdp_switch").value){for(var i=e.split("::"),r=new Array,a=0;a<i.length;a++)""!=i[a]&&null!=i[a]&&r.push({id:i[a]});e=new Array;e.push({id:t,name:o}),this.gtmPush({event:"pdpClickOfferOverlay",eventCategory:"PDP offers",eventAction:"Click",eventLabel:"Offer popup","ecommerce.promoClick.promotions":r,"ecommerce.detail.products":e})}}},publishPDPOfferOverlayCloseEvent:function(e,t,o,n){if(null!=document.getElementById("gtm_switch")){var i=document.getElementById("gtm_switch").value;if("true"==i)if(null!=document.getElementById("gtm_pdp_switch"))if("true"==document.getElementById("gtm_pdp_switch").value){for(var r=t.split("::"),a=new Array,s=0;s<r.length;s++)""!=r[s]&&null!=r[s]&&a.push({id:r[s]});t=new Array;t.push({id:o,name:n});n="";"x_click"==e?n="Offer popup - Close(Close button)":"outside_click"==e?n="Offer popup - Close(click off)":"escape"==e&&(n="Offer popup - Close(esc)"),this.gtmPush({event:"pdpCloseOfferOverlay",eventCategory:"PDP offers",eventAction:"Click",eventLabel:n,"ecommerce.promoClick.promotions":a,"ecommerce.detail.products":t})}}},searchfacetSetGTM:function(){var e=SearchBasedNavigationDisplayJS.facetIdsArray,t=SearchBasedNavigationDisplayJS.facetIdsParentArray,o=[],n=[],i=[];if($("#facetFilterListWrapper ul li").each(function(){i.push($(this).attr("id").slice(7))}),null!=i&&null!=i.length)for(var r=0;r<i.length;r++){var a=e.indexOf(i[r]);"lter"==i[r]?o.push("price"):o.push(t[a])}var s=o.join("|");return $("#facetFilterListWrapper ul li").each(function(){n.push($(this).find("div").text())}),{productNameObj:s,productValueObj:n.join("|")}},publishFilterViewPLPGtm:function(e){var t;null!=document.getElementById("gtm_switch")&&"true"==document.getElementById("gtm_switch").value&&(t=this.searchfacetSetGTM(),this.gtmPush({event:e,page:{id:"Listing: "+document.title,facetsApplied:t.productNameObj,facetValuesSelected:t.productValueObj}}))},publishFilterViewSLPGtm:function(e,t){var o;null!=document.getElementById("gtm_switch")&&"true"==document.getElementById("gtm_switch").value&&(o=this.searchfacetSetGTM(),this.gtmPush({event:e,page:{id:t,facetsApplied:o.productNameObj,facetValuesSelected:o.productValueObj}}))},publishListPageOfferOverlayClickEventGTM:function(e,t,o){if(null!=document.getElementById("gtm_switch")&&"true"==document.getElementById("gtm_switch").value){for(var n=e.split("::"),i=new Array,r=0;r<n.length;r++)i.push({id:n[r]});e=new Array;e.push({id:t,name:o}),this.gtmPush({event:"plpClickOfferOverlay",eventCategory:"PLP offers",eventAction:"Click",eventLabel:"Offer popup","ecommerce.promoClick.promotions":i,"ecommerce.detail.products":e})}},publishListPageOfferOverlayCloseEventGTM:function(e,t,o,n){if(null!=document.getElementById("gtm_switch")&&"true"==document.getElementById("gtm_switch").value){for(var i=t.split("::"),r=new Array,a=0;a<i.length;a++)r.push({id:i[a]});t=new Array;t.push({id:o,name:n});n="";"x_click"==e?n="Offer popup - Close(Close button)":"outside_click"==e?n="Offer popup - Close(click off)":"escape"==e&&(n="Offer popup - Close(esc)"),this.gtmPush({event:"plpCloseOfferOverlay",eventCategory:"PLP offers",eventAction:"Click",eventLabel:n,"ecommerce.promoClick.promotions":r,"ecommerce.detail.products":t})}},commonPageDetailsGtm:function(e){var t,o,n,i,r;null!=document.getElementById("gtm_switch")&&"true"==document.getElementById("gtm_switch").value&&(t="",null!=(n=getCookie("DataLayerLoginOption"))&&(t=n),o="",void 0!==(n=dojo.byId("shippingFlow"))&&null!=n&&"CFS"==n.value?"undefined"!=typeof Storage&&(o=sessionStorage.fulfilmentTypeObj="Collect in store"):void 0!==n&&null!=n&&"HOME"==n.value?"undefined"!=typeof Storage&&(o=sessionStorage.fulfilmentTypeObj="Home delivery"):"undefined"==typeof Storage||null!=(i=sessionStorage.getItem("fulfilmentTypeObj"))&&""!=i&&(o=i),n=!1,i=document.getElementById("checkoutLogin_Switch").value,null!=e.eventName||""!=e.eventName||null!=e.eventName?"defaultPageView"==e.eventName&&("undefined"==typeof Storage||null!=(r=sessionStorage.getItem("SearchRedirect"))&&""!=r&&(n=!0),n?null!=i&&"ON"===i?this.gtmPush({event:e.eventName,page:{id:e.id,category:e.category,breadcrumb:e.categoryBreadcrumbobj,categoryTree:e.categoryTree,templateID:e.templateID,previousPageID:e.previousPageID,type:e.type,templateType:e.templateType,isPageView:e.isPageView,searchRedirectTerm:r},ecommerce:{checkout:{loginOption:t,fulfilmentType:o}}}):this.gtmPush({event:e.eventName,page:{id:e.id,category:e.category,breadcrumb:e.categoryBreadcrumbobj,categoryTree:e.categoryTree,templateID:e.templateID,previousPageID:e.previousPageID,type:e.type,templateType:e.templateType,isPageView:e.isPageView,searchRedirectTerm:r}}):null!=i&&"ON"===i?this.gtmPush({event:e.eventName,page:{id:e.id,category:e.category,breadcrumb:e.categoryBreadcrumbobj,categoryTree:e.categoryTree,templateID:e.templateID,previousPageID:e.previousPageID,type:e.type,templateType:e.templateType,isPageView:e.isPageView},ecommerce:{checkout:{loginOption:t,fulfilmentType:o}}}):this.gtmPush({event:e.eventName,page:{id:e.id,category:e.category,breadcrumb:e.categoryBreadcrumbobj,categoryTree:e.categoryTree,templateID:e.templateID,previousPageID:e.previousPageID,type:e.type,templateType:e.templateType,isPageView:e.isPageView}})):null!=i&&"ON"===i?this.gtmPush({page:{id:e.id,category:e.category,breadcrumb:e.categoryBreadcrumbobj,categoryTree:e.categoryTree,templateID:e.templateID,previousPageID:e.previousPageID,type:e.type,templateType:e.templateType,isPageView:e.isPageView},ecommerce:{checkout:{loginOption:t,fulfilmentType:o}}}):this.gtmPush({page:{id:e.id,category:e.category,breadcrumb:e.categoryBreadcrumbobj,categoryTree:e.categoryTree,templateID:e.templateID,previousPageID:e.previousPageID,type:e.type,templateType:e.templateType,isPageView:e.isPageView}}))},publishAdd2CartErrorEventGTM:function(e){var t=new Array;null!=e&&t.push({id:e.id,name:e.name}),this.gtmPush({event:"limitedStockAvailabilityExceededMessage",eventCategory:"Errors",eventAction:"View",eventLabel:"Add to basket quantity exceeds limited stock availability",ecommerce:{detail:{products:t}}})},publishListPageAddMoreThanMaxQtyEventGTM:function(e){var t=new Array;null!=e&&t.push({id:e.id,name:e.name}),this.gtmPush({event:"maximumQuantityThresholdMessage",eventCategory:"Errors",eventAction:"View",eventLabel:"Add to basket quantity exceeds maximum quantity threshold","ecommerce.detail.products":t})},publishListPageAddToFavouritesEventGTM:function(e){var t,o,n="PLP",i="";"PDP"===(n="undefined"!=typeof favouriteflow&&null!=favouriteflow?"PDP"===favouriteflow?favouriteflow:"SLP":n)&&(r=dojo.byId("gtmProdHasColourOptions").value,a=dojo.byId("gtmProdHasSizeOptions").value,t="",dojo.byId("gtmProdColourAttrValue")&&(t=dojo.byId("gtmProdColourAttrValue").value),o="",dojo.byId("gtmProdSizeAttrValue")&&(o=dojo.byId("gtmProdSizeAttrValue").value),"true"!==r&&"true"!==a||null!=document.getElementById("productId")&&(i=document.getElementById("productId").textContent));var r="",a="";dojo.byId("cmFavName_"+e)&&(s=(r=dojo.byId("cmFavName_"+e).value).indexOf("("),e=r.indexOf(")"),a=r.substring(s+1,e),r=r.substring(0,s-1));var s=new Array;s.push({id:a,name:r,variant:i,routeToWishlist:n,size:o,colour:t}),this.gtmPush({event:"addToWishlist",eventCategory:"Wishlist",eventAction:"Add",eventLabel:"AddToWishlist","wishlist.products":s})},publishCheckoutDeliverySectionViewGtm:function(e){null!=document.getElementById("gtm_switch")&&"true"==document.getElementById("gtm_switch").value&&(null!=e&&"checkoutReviewHomeDeliveryAddress"==e?this.gtmPush({event:"checkoutReviewHomeDeliveryAddress",page:{id:"Checkout: Review home delivery address"}}):null!=e&&"checkoutReviewCollectInStoreDetails"==e&&this.gtmPush({event:"checkoutReviewCollectInStoreDetails",page:{id:"Checkout: Review collect in store details"}}))},publishOrderConfirmationRetailEventGTM:function(e){if(null!=e){var t=e.id,o=e.pointsRedeemedTotal;delete e.pointsRedeemedTotal,delete e.id,e.checkout={type:"Retail"};var n=e.purchase.paymentType,i=e.purchase.orderStatus;null==n||"Boots advantage card points"!=n&&-1==n.toUpperCase().indexOf("POINTS")?e.purchase.pointsRedeemedTotal="":e.purchase.pointsRedeemedTotal=o;for(var r=sessionStorage.getItem("quickBuyProduct"),a=e.purchase.products.length,s=sessionStorage.getItem("quickBuyOrderItemId"),c=0;c<a;c++)null!=r&&"Y"==r&&e.purchase.products[c].quickBuy==s?e.purchase.products[c].quickBuy="Y":e.purchase.products[c].quickBuy="N";sessionStorage.removeItem("quickBuyProduct"),sessionStorage.removeItem("quickBuyOrderItemId"),this.applyProductData(e.purchase.products),this.gtmPush({event:"purchase",page:{id:t},ecommerce:e}),null==i||"Order cancelled due to bulk buying"!==i&&"Order cancelled due to fraud"!==i||this.orderFailedRTF(i)}},publishOrderCancelledEventGTM:function(e){var t,o;null!=e&&(t=e.id,delete e.id,null==(o=e.purchase.orderStatus)||"Order cancelled due to bulk buying"!==o&&"Order cancelled due to fraud"!==o||this.gtmPush({event:"orderCancelled",page:{id:t},ecommerce:{cart:{basketID:e.purchase.basketID},checkout:{loginOption:e.purchase.loginOption,fulfilmentType:e.purchase.fulfilmentType},purchase:{orderStatus:"Order cancelled"}}}))},publishOrderConfirmationRetailEventGTMPlusGSPA:function(e,t,o,n,i,r){var a,s,c,l;null!=e&&(a=e.id,s=e.pointsRedeemedTotal,delete e.pointsRedeemedTotal,delete e.id,e.checkout={type:"Retail"},c=e.purchase.paymentType,l=e.purchase.orderStatus,null==c||"Boots advantage card points"!=c&&-1==c.toUpperCase().indexOf("POINTS")?e.purchase.pointsRedeemedTotal="":e.purchase.pointsRedeemedTotal=s,this.applyProductData(e.purchase.products),this.gtmPush({event:"purchase",page:{id:a},ecommerce:e,discount:t,aw_merchant_id:o,aw_feed_country:n,aw_feed_language:i,items:r}),null==l||"Order cancelled due to bulk buying"!==l&&"Order cancelled due to fraud"!==l||this.orderFailedRTF(l))},orderFailedRTF:function(e){this.gtmPush({event:"orderFailed",eventCategory:"Orders",eventAction:"Failed",eventLabel:e})},publishAdd2CartPDPPageGTM:function(){var e,t;null!=document.getElementById("gtm_switch")&&(e=document.getElementById("gtm_switch").value,null!=document.getElementById("gtm_pdp_switch")&&(t=document.getElementById("gtm_pdp_switch").value,"true"==e&&"true"==t&&this.publishAnalyticsView(this.jsonShopcartViewGTM,{storeId:this.storeId},function(e){if(null!=e&&null!=e.cart.products&&0<e.cart.products.length){for(var t=e.cart.products,o=e.cart,n=e.cart.products.length,i=0;i<n;i++)e.cart.products[i].routeToCart="PDP";"undefined"!=typeof Storage&&(sessionObj=sessionObj||{},sessionObj.productCarted=!0,sessionStorage.productCarted=!0),delete o.products,quickBuyBtnEvent=dojo.byId("PDPPageTypeEvent"),null!=quickBuyBtnEvent&&null!=quickBuyBtnEvent&&"quickBuyEvent"==quickBuyBtnEvent.value?(t[0].quickBuy="Y",quickBuyBtnEvent.value=""):t[0].quickBuy="N",this.applyProductData(t,!0),this.gtmPush({event:"addToCart",page:{id:"Product: "+document.title},"session.productCarted":"TRUE",ecommerce:{currencyCode:e.currencyCode,cart:o,add:{products:t}}})}})))},publishRemoveFromCartPLPPageGTM:function(a,e,t){var o,n;null!=document.getElementById("gtm_switch")&&(o=document.getElementById("gtm_switch").value,n=document.getElementById("gtm_pdp_switch").value,this.storeId=e,this.catalogId=t,"true"==o&&"true"==n&&this.publishAnalyticsView(this.jsonShopcartViewGTM,{storeId:this.storeId},function(e){if(null!=e&&null!=e.cart.products&&0<e.cart.products.length){for(var t=e.cart.products,o=e.cart,n=e.cart.products.length,i=0,r=0;r<n;r++)if(a==t[r].id){i=r;break}delete o.products,this.applyProductData(t),this.gtmPush({event:"removeFromCart",ecommerce:{remove:{basketID:o.basketID,products:t[i]}}})}}))},publishRemoveFromCartPDPPageGTM:function(a){var e,t;null!=document.getElementById("gtm_switch")&&(e=document.getElementById("gtm_switch").value,null!=document.getElementById("gtm_pdp_switch")&&(t=document.getElementById("gtm_pdp_switch").value,"true"==e&&"true"==t&&this.publishAnalyticsView(this.jsonShopcartViewGTM,{storeId:this.storeId},function(e){if(null!=e&&null!=e.cart.products&&0<e.cart.products.length){for(var t=e.cart.products,o=e.cart,n=e.cart.products.length,i=0,r=0;r<n;r++)if(a==t[r].id){i=r;break}delete o.products,this.applyProductData(t),this.gtmPush({event:"removeFromCart",ecommerce:{remove:{basketID:o.basketID,products:t[i]}}})}})))},publishRemoveFromCartPDPPageGTMCEPHSwitch:function(a,e,t){var o,n;null!=document.getElementById("gtm_switch")&&(o=document.getElementById("gtm_switch").value,null!=document.getElementById("gtm_pdp_switch")&&(n=document.getElementById("gtm_pdp_switch").value,this.storeId=e,this.catalogId=t,"true"==o&&"true"==n&&this.publishAnalyticsView(this.jsonShopcartViewGTM,{storeId:this.storeId},function(e){if(null!=e&&null!=e.cart.products&&0<e.cart.products.length){for(var t=e.cart.products,o=e.cart,n=e.cart.products.length,i=0,r=0;r<n;r++)if(a==t[r].id){i=r;break}delete o.products,this.applyProductData(t),this.gtmPush({event:"removeFromCart",ecommerce:{remove:{basketID:o.basketID,products:t[i]}}})}})))},publishListAddToCartGTM:function(e,t){var o,n;null!=document.getElementById("gtm_switch")&&(o=document.getElementById("gtm_switch").value,null!=document.getElementById("gtm_pdp_switch")&&(n=document.getElementById("gtm_pdp_switch").value,"true"==o&&"true"==n&&null!=e&&null!=e.cart.products&&0<e.cart.products.length&&(o=e.cart.products,delete(n=e.cart).products,this.applyProductData(o,!0),"undefined"!=typeof Storage&&(sessionObj=sessionObj||{},sessionObj.productCarted=!0,sessionStorage.productCarted=!0),this.gtmPush({event:"addToCart",page:{id:"Listing: "+document.title},"session.productCarted":"TRUE",ecommerce:{currencyCode:e.currencyCode,cart:n,add:{products:o[t]}}}))))},publishAdd2CartPDPPageVATGTM:function(e,t){var o,n;null!=document.getElementById("gtm_switch")&&(o=document.getElementById("gtm_switch").value,null!=document.getElementById("gtm_pdp_switch")&&(n=document.getElementById("gtm_pdp_switch").value,"true"==o&&"true"==n&&analyticsJS.gtmPush({event:"vatBackPromptOverlay",eventCategory:"Overlays",eventAction:"View",eventLabel:"Will you be claiming VAT back?",ecommerce:{products:[{id:e,name:t}]}})))},publishPDPScene7ImageWidgetGTM:function(e,t,o,n,i,r){var a,s;null!=document.getElementById("gtm_switch")&&(a=document.getElementById("gtm_switch").value,null!=document.getElementById("gtm_pdp_switch")&&(s=document.getElementById("gtm_pdp_switch").value,"true"==a&&"true"==s&&this.gtmPush({event:o,eventCategory:n,eventAction:i,eventLabel:r,ecommerce:{detail:{products:[{id:e,name:t}]}}})))},publishPDPStockCheckWidgetGTM:function(e,t,o,n,i,r,a,s,c){var l,u;null!=document.getElementById("gtm_switch")&&(l=document.getElementById("gtm_switch").value,null!=document.getElementById("gtm_pdp_switch")&&(u=document.getElementById("gtm_pdp_switch").value,"true"==l&&"true"==u&&this.gtmPush({event:o,eventCategory:n,eventAction:i,eventLabel:r,ecommerce:{detail:{products:[{id:e,name:t,size:a,colour:s,variant:c}]}}})))},publishPDPStockCheckResultsWidgetGTM:function(e,t,o,n,i,r,a,s,c,l,u,d){var g,m;null!=document.getElementById("gtm_switch")&&(g=document.getElementById("gtm_switch").value,null!=document.getElementById("gtm_pdp_switch")&&(m=document.getElementById("gtm_pdp_switch").value,"true"==g&&"true"==m&&this.gtmPush({event:o,eventCategory:n,eventAction:i,eventLabel:r,ecommerce:{detail:{products:[{id:e,name:t,size:a,colour:s,variant:c}]}},cvosSearch:{term:l,resultCount:u,stores:d}})))},publisheSpotDeliveryMessageGTM:function(e,t,o,n,i){var r,a;null!=document.getElementById("gtm_switch")&&(r=document.getElementById("gtm_switch").value,null!=document.getElementById("gtm_pdp_switch")&&(a=document.getElementById("gtm_pdp_switch").value,"true"==r&&"true"==a&&this.gtmPush({event:e,"data-promoid":t,"data-promoname":o,"data-promocreative":n,"data-promoposition":i})))},publishOrderConfirmationPHGTM:function(e){var t=e.patientGender,o="1",n=e.customerDOB,i="";null!=n&&(i=n.split("/")[2]);o="Male"===t?"1":"2",n=e.fulfilmentType,t="";null!=n&&"Home Delivery"===n&&(t=e.deliveryOption),this.applyProductData(e.products),this.gtmPush({event:"pharmacyCheckoutPurchase",page:{id:"Checkout: Order Confirmation"},ecommerce:{purchase:{actionField:{id:e.orderId,revenue:e.revenue,shipping:e.shipping,coupon:e.coupon,couponType:e.couponType,tax:e.tax},orderStatus:e.ordStatus,loginOption:"Logged in:before checkout",deliverySameAsGPAddress:"N",fulfilmentType:e.fulfilmentType,homeDeliveryType:t,deliverySignature:e.deliverySignature,paymentType:e.paymentType,cardType:e.cardType,deliveryDate:e.deliveryDate,currencyCode:e.currency,isEPSOptIn:e.epsoptGTM,pointsAwardTotal:e.pointsAwardTotal,pointsRedeemedTotal:e.pointRedeemTotal,products:e.products},checkout:{type:"Pharmacy"}},prescription:{recipient:{prescriptionFor:"Myself",type:o,hasMedicalConditions:"",medicalConditions:"",payForPrescriptions:"",DOBYear:i,relationshipType:"",exemptions:""},type:""}})},searchResultTabGTM:function(e){null!=document.getElementById("gtm_switch")&&"true"==document.getElementById("gtm_switch").value&&this.gtmPush({event:"searchResultsTabClick",eventCategory:"Search lister",eventAction:"Click",eventLabel:null!=e?"tab1"===e?"Products":"Prescriptions":""})},publishSlpViewGtm:function(e,t,o){var n,i;"true"==document.getElementById("gtm_switch").value&&(getCookie("analyticsFacetAttributes"),i=null!=byId("facetFilterList")?(n=(i=this.searchfacetSetGTM()).productNameObj,i.productValueObj):n="",this.gtmPush({event:"searchResultsView",page:{id:o.pageID,category:t.category,facetsApplied:n,facetValuesSelected:i,sortOption:t.sortOption,listFormat:t.listFormat,viewTrigger:t.viewTrigger,pageNumber:t.pageNumber},onsiteSearch:{term:o.term,resultCount:o.resultCount,articleResultCount:o.articleResultCount,prescriptionResultCount:o.prescriptionResultCount},ecommerce:{impressions:{products:e}}}))},publishSlpNoResultGtm:function(e,t){"true"==document.getElementById("gtm_switch").value&&this.gtmPush({event:"searchNoResultsView",page:{id:t.pageID,category:e.category,viewTrigger:e.viewTrigger},onsiteSearch:{term:t.term,resultCount:t.resultCount}})},publishSlpDYMGtm:function(e,t,o){var n,i;"true"==document.getElementById("gtm_switch").value&&(getCookie("analyticsFacetAttributes"),i=null!=byId("facetFilterList")?(n=(i=this.searchfacetSetGTM()).productNameObj,i.productValueObj):n="",this.gtmPush({event:"searchDYMResultsView",page:{id:o.pageID,category:t.category,facetsApplied:n,facetValuesSelected:i,sortOption:t.sortOption,listFormat:t.listFormat,viewTrigger:t.viewTrigger,pageNumber:t.pageNumber},onsiteSearch:{term:o.term,resultCount:o.resultCount,articleResultCount:o.articleResultCount,prescriptionResultCount:o.prescriptionResultCount,dymSuggestion:o.dymSuggestion,dymResultCount:o.dymResultCount},ecommerce:{impressions:{products:e}}}))},headObjectEventGtm:function(e){var t;null!=e&&(t=e.split(":"));"true"==document.getElementById("gtm_switch").value&&("undefined"!=typeof Storage&&(sessionStorage.globalNavValue=!0,globalNavval=!0),sessionObj=sessionObj||{},sessionObj.globalNavUsed=globalNavval,this.gtmPush({event:"meganavClick",eventCategory:"Mega nav",eventAction:"Click",eventLabel:t}))},headObjectTopEventGtm:function(e){"true"==document.getElementById("gtm_switch").value&&this.gtmPush({event:"headerNavClick",eventCategory:"Header nav",eventAction:"Click",eventLabel:e})},footerObjectEventGtm:function(e){var t;null!=e&&(t=e.split(":"));"true"==document.getElementById("gtm_switch").value&&this.gtmPush({event:"footerNavClick",eventCategory:"Footer nav",eventAction:"Click",eventLabel:t})},showCategorySelectedEventgtm:function(e){"true"==document.getElementById("gtm_switch").value&&this.gtmPush({event:"categoryNavClick",eventCategory:"Category Nav",eventAction:"Click",eventLabel:e})},publishClickSocialMediaWidget:function(e,t,o){"true"==document.getElementById("gtm_switch").value&&(sessionObj=sessionObj||{},sessionObj.globalNavUsed=!0,this.gtmPush({event:"socialClick",eventCategory:"Social",eventAction:"Click",eventLabel:e,ecommerce:{detail:{products:[{id:t,name:o}]}}}))},publishMinibasketEvent:function(e){var t=document.title;"undefined"!=typeof pageId&&null!=pageId&&pageId.trim()&&(t=pageId),"undefined"!=typeof gtm_slpPageId&&null!=gtm_slpPageId&&gtm_slpPageId.trim()&&(t=gtm_slpPageId),"ViewMiniBasket"==e&&this.gtmPush({event:"miniBasketView",eventCategory:"Checkout",eventAction:"Click",eventLabel:"MiniShoppingCart"}),"clickViewBasket"==e&&this.gtmPush({event:"miniBasketClickViewBasket",eventCategory:"Mini Basket Options",eventAction:"Click",eventLabel:"View basket & checkout",page:{id:t}}),"clickContinueShopping"==e&&this.gtmPush({event:"miniBasketClickContinueShopping",eventCategory:"Mini Basket Options",eventAction:"Click",eventLabel:"Continue shopping",page:{id:t}})},emailLiteGuestCheckout:function(){"true"==document.getElementById("gtm_switch").value&&(sessionObj=sessionObj||{},sessionObj.globalNavUsed=!0,this.gtmPush({event:"guestCheckoutMarkPermiss",eventCategory:"Checkout",eventAction:"Opt in",eventLabel:"Guest Marketing Permissions"}))},publishPsd2PaymentDefaultViewGtm:function(e){var t;null!=e&&(console.log("PSD2 payment default view gtm data: "+JSON.stringify(e)),t={loginOption:e.checkout.loginOption,fulfilmentType:e.checkout.fulfilmentType,homeDeliveryType:e.checkout.homeDeliveryType,deliveryDate:e.checkout.deliveryDate,paymentAuthenticationAttempt:e.checkout.paymentAuthenticationAttempt},this.gtmPush({event:e.event,page:e.page,ecommerce:{checkout:t}}))},publishPsd2PaymentProcessingErrorGtm:function(e,t){console.log("publishPsd2PaymentProcessingErrorGtm - Error Code: "+e+"  Error message: "+t);dataLayer.push({event:"paymentProcessingError",eventCategory:"Checkout",eventAction:"Payment processing error",eventLabel:e,ecommerce:{checkout:{paymentProcessingError:t}}})},publishregisterCompleteGtm:function(e){null!=document.getElementById("gtm_switch")&&(document.getElementById("gtm_switch").value,this.gtmPush({event:"registerComplete",eventCategory:"Registration",eventAction:"Complete",eventLabel:"Registration Process",ecommerce:{checkout:{loginOption:"Registered"}},eventTrigger:e}))},publishAdd2CartREORDERPageGTM:function(){null!=document.getElementById("gtm_switch")&&"true"==document.getElementById("gtm_switch").value&&this.publishAnalyticsView(this.jsonShopcartViewGTM,{storeId:this.storeId},function(e){var t,o;null!=e&&null!=e.cart.products&&0<e.cart.products.length&&(t=e.cart.products,o=e.cart,"undefined"!=typeof Storage&&(sessionObj=sessionObj||{},sessionObj.productCarted=!0,sessionStorage.productCarted=!0),delete o.products,this.applyProductData(t,!0),this.gtmPush({event:"addToCart",page:{id:"Product: "+document.title},"session.productCarted":"TRUE",ecommerce:{currencyCode:e.currencyCode,cart:o,add:{products:t}}}))})},publishAdd2CartFavouritePageGTM:function(i){null!=document.getElementById("gtm_switch")&&"true"==document.getElementById("gtm_switch").value&&this.publishAnalyticsView(this.jsonShopcartViewGTM,{storeId:this.storeId},function(e){if(null!=e&&null!=e.cart.products&&0<e.cart.products.length){var t=e.cart.products,o=e.cart;if("undefined"!=typeof Storage&&(sessionObj=sessionObj||{},sessionObj.productCarted=!0,sessionStorage.productCarted=!0),delete o.products,void 0!==i&&null!=i&&0<i.length)for(var n=0;n<i.length;n++){i[n];null==document.getElementById("dlProductId_"+i[n])&&null==document.getElementById("dlProductId_"+i[n])||(partNumber=document.getElementById("dlProductId_"+i[n]).value,analyticsJS.addProductData(partNumber,"routeToCart","WISHLIST",!0),analyticsJS.addProductData(partNumber,"cartedQuantity","1",!0))}this.applyProductData(t,!0),this.gtmPush({event:"addToCart",page:{id:"Product: "+document.title},"session.productCarted":"TRUE",ecommerce:{currencyCode:e.currencyCode,cart:o,add:{products:t}}})}})},publishPaypalPayOptionClickedEventGtm:function(e){dataLayer.push({event:"promotionClick",ecommerce:{promoClick:{"promotions[]":{id:e}}}})},publishEmptyCartPageGTM:function(){var e,t;null!=document.getElementById("gtm_switch")&&(e=document.getElementById("gtm_switch").value,null!=document.getElementById("gtm_pdp_switch")&&(t=document.getElementById("gtm_pdp_switch").value,"true"==e&&"true"==t&&this.publishAnalyticsView(this.jsonShopcartViewGTM,{storeId:this.storeId},function(e){var t;null!=e&&null!=e.cart.products&&0<e.cart.products.length&&(t=e.cart.products,delete(e=e.cart).products,this.applyProductData(t),this.gtmPush({event:"removeFromCart",ecommerce:{remove:{basketID:e.basketID,products:t}}}))})))},publishHeaderLoginEventGTM:function(){null!=document.getElementById("gtm_switch")&&"true"==document.getElementById("gtm_switch").value&&dataLayer.push({event:"login",user:userObjLogIn,ecommerce:{checkout:{loginOption:"Logged in: before checkout"}}})},publishLogonScenarioWithStoreId:function(e,t,o){this.storeId=t,this.catalogId=o;t=this;null!=document.getElementById("gtm_switch")&&"true"==document.getElementById("gtm_switch").value&&(o=null,e.statusMessage?("Invalid LoginID"==e.statusMessage&&(o=e.errorMessage.replace(/^<div[^>]*>|<\/div>$/g,"")),this.gtmPush({event:"loginFail",eventCategory:"LoginRegister",eventAction:"Fail",eventLabel:"Login",ecommerce:{checkout:{type:"retail"}}}),this.gtmPush({event:"message",eventCategory:"Messages",eventAction:"View",eventLabel:o,page:{id:t.getPageId()},component:{message:{messageType:"Error"}}})):null!=(o=JSON.parse(sessionStorage.getItem("DataCart")))?(this.applyProductData(o.products),this.gtmPush({event:"checkoutLogin",ecommerce:{cart:o,checkout:{step:"1",loginOption:"Logged in: at checkout"}}}),dojo.cookie("DataLayerLoginOption","Logged in: at checkout",{path:"/"}),sessionStorage.setItem("DataCart",null)):(t.publishAnalyticsView(t.jsonShopcartViewGTM,{storeId:t.storeId,incTaxInPrice:t.incTaxInUnitPriceForCart},function(e){this.applyProductData(e.cart.products),this.gtmPush({event:"checkoutLogin",ecommerce:{cart:e.cart,checkout:{step:"1",loginOption:"Logged in: at checkout"}}})}),dojo.cookie("DataLayerLoginOption","Logged in: at checkout",{path:"/"})))},publishMergeAddtoCartGTM:function(e){var t,o,n;null!=document.getElementById("orderId")&&(t=document.getElementById("orderId").value),null!=document.getElementById("currency")&&(o=document.getElementById("currency").value),null!=document.getElementById("gtm_switch")&&(n=document.getElementById("gtm_switch").value);var i=e.length;if("true"==n){for(var r=new Array,a=0;a<i;a++)r.push({basePrice:e[a].dl_basePrice,brand:e[a].dl_brand,category:e[a].dl_category,categoryTree:e[a].dl_categoryTree,colour:e[a].dl_colour,coupon:e[a].dl_coupon,couponType:e[a].dl_couponType,cvosChecked:e[a].dl_cvosChecked,discountTotal:e[a].dl_discountTotal,hasColourOptions:e[a].dl_hasColourOptions,hasGWP:e[a].dl_hasGWP,hasSizeOptions:e[a].dl_hasSizeOptions,id:e[a].dl_partnumber,name:e[a].dl_name,offersAvailable:e[a].dl_offersAvailable,price:e[a].dl_price,productBreadcrumbs:e[a].dl_productBreadcrumbs,productImageURL:e[a].dl_productImageURL,quantity:e[a].dl_quantity,quickBuy:e[a].dl_quickBuy,routeToCart:e[a].dl_routeToCart,size:e[a].dl_size,variant:e[a].dl_variant});dataLayer.push({event:"addToCart",page:{id:"Accman"},"session.productCarted":"TRUE",ecommerce:{add:{products:r},Cart:{basketID:t,coupon:"",couponType:"",deliveryTracker:"Cart delivery tracker: Free click and collect: Y|Free standard delivery: Y",discountTotal:"0",revenue:dojo.byId("revenue").value,shipping:"0"},currencyCode:o}})}}}),RetailCoreMetricsHelper={currentSectionId:"",previousSectionId:"",fireElementTag:function(e,t){},fireManualLinkClickTag:function(e,t){},fireManualPageViewTag:function(e,t,o,n,i,r,a,s){},fireStoreLocatorTabElementTag:function(e){1==e||"tab1"==e?e="List":2!=e&&"tab2"!=e||(e="Map"),this.fireElementTag(e,"Store Locator")},fireListerTabElementTag:function(e,t){1==t||"tab1"==t?t="Products":2!=t&&"tab2"!=t||(t="Prescriptions"),this.fireElementTag(t,e)},fireDeliveryTabSelectedPageViewTag:function(e,t){var o;"CFS"==e?void 0!==(o=dojo.byId("hasSavedAddressForRegCFS"))&&null!=o&&"true"==o.value?this.currentSectionId="Checkout:Delivery Summary CFS":this.currentSectionId="Checkout:Delivery Address CFS":"HOME"==e?void 0!==(o=dojo.byId("hasSavedAddressForRegDelHome"))&&null!=o&&"true"==o.value?this.currentSectionId="Checkout:Delivery Summary Home":this.currentSectionId="Checkout:Delivery Address Home":"PO"==e?void 0!==(e=dojo.byId("hasSavedAddressForRegPO"))&&null!=e&&"true"==e.value?this.currentSectionId="Checkout:Delivery Summary CFPO":this.currentSectionId="Checkout:Delivery Address CFPO":"R"==t&&(this.currentSectionId="Checkout:Delivery Address - REG BEGIN"),null!=document.getElementById("cmInitialLoad")&&"true"==document.getElementById("cmInitialLoad").value&&(this.currentSectionId="R"==t?"Checkout:Delivery Address - REG BEGIN":"Checkout:Delivery Address - GUEST BEGIN",document.getElementById("cmInitialLoad").value="false"),this.fireCheckoutSectionPageViewTag("")},fireMiniBasketTabElementTag:function(e){tabName=-1<e.indexOf("Product")?"Shop":"Prescription",this.fireElementTag(tabName,"Mini Basket Options")},fireCheckoutSectionPageViewTag:function(e){var t="CHECKOUT";null!=document.getElementById("ctaParentName")&&(t=document.getElementById("ctaParentName").value),this.fireManualPageViewTag(this.getCurrentSectionId(),t,this.getCurrentSectionId(),this.getPreviousSectionId(),this.getAttributes(e),"","","")},firePaymentViewedPageViewTag:function(e){var t="CHECKOUT";null!=document.getElementById("ctaParentName")&&(t=document.getElementById("ctaParentName").value),this.fireManualPageViewTag("Checkout:Payment Details",t,"Checkout:Payment Details",this.getPreviousSectionId(),this.getAttributes(e),"","","")},setPreviousSectionId:function(e){this.previousSectionId=e},setCurrentSectionId:function(e){this.currentSectionId=e},getPreviousSectionId:function(e){return""==this.previousSectionId?window.location.href:this.previousSectionId},getCurrentSectionId:function(e){return""==this.currentSectionId?"Checkout:Delivery Address - GUEST BEGIN":this.currentSectionId},getAttributes:function(e){var t=dojo.byId("checkoutExtraParms");return null==e||""==e&&void 0!==t&&null!=t?dojo.byId("checkoutExtraParms").value:e}};
</script>

</body>
</html>
