<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>bmwusa-globalnav-map-popup.html</title>
</head>
<body>

<script>
/*! BMWUSA Vite Build 1731603678170 */
import{C as o}from"/etc.clientlibs/bmwusa/clientlibs/clientlib-site/bmwusa-clientlibs/bmwusa-chunks/resources/component.js";import{A as t}from"/etc.clientlibs/bmwusa/clientlibs/clientlib-site/bmwusa-clientlibs/bmwusa-chunks/resources/ada-utils.js";import{$ as s,h as l}from"/etc.clientlibs/bmwusa/clientlibs/clientlib-site/bmwusa-clientlibs/bmwusa-measurement-data.js";import"/etc.clientlibs/bmwusa/clientlibs/clientlib-site/bmwusa-clientlibs/bmwusa-chunks/resources/index.js";import"/etc.clientlibs/bmwusa/clientlibs/clientlib-site/bmwusa-clientlibs/bmwusa-chunks/resources/index.esm.js";import"/etc.clientlibs/bmwusa/clientlibs/clientlib-site/bmwusa-clientlibs/bmwusa-chunks/resources/is-author.js";import"/etc.clientlibs/bmwusa/clientlibs/clientlib-site/bmwusa-clientlibs/bmwusa-chunks/resources/baseDomain.js";import"/etc.clientlibs/bmwusa/clientlibs/clientlib-site/bmwusa-clientlibs/bmwusa-chunks/resources/getbyourl.js";import"/etc.clientlibs/bmwusa/clientlibs/clientlib-site/bmwusa-clientlibs/bmwusa-chunks/resources/scroll-to.js";import"/etc.clientlibs/bmwusa/clientlibs/clientlib-site/bmwusa-clientlibs/bmwusa-chunks/resources/uid.js";import"/etc.clientlibs/bmwusa/clientlibs/clientlib-site/bmwusa-clientlibs/bmwusa-chunks/resources/zipcode.js";new o({el:".globalnav-map-popup",name:"globalnav-map-popup Component",baseStr:"globalnav-map-popup",subscriptions:{"dealermap.popover-open":"openMap","dealermap.dealer-selected":"storeDealer","map.set-trap-focus":"setTrapFocus","map.remove-trap-focus":"removeTrapFocus","fill.clicked":"closeMap","map.close-map":"closeMap","window.resizeEnd":"resizeEvt",dealerUpdate:"storeDealer"},adaFocusableItems:[".google-map a"],adaSearchPageFocusableItems:[".dealer-map-location-search__input-holder input",".dealer-map-location-search__search-btn"],dynamicContent:[".globalnav-map-popup--active"],currentBreakpoint:window.innerWidth>=960?"desktop":"mobile",events:{"click .globalnav-map-popup":"closeMap"},beforeInit(){this.closeBtn=this.element.querySelector(`${this.el}__close-btn`),this.body=document.body,this.isEmbedded=this.element.parentNode.classList.contains("standalone-dealer-map"),this.closeMap=this.closeMap.bind(this),this.keyCheck=this.keyCheck.bind(this),this.openMap=this.openMap.bind(this),this.isExternalOpen=!1},init(){s.qs(".globalnav")&&(s.qs(".globalnav").dataset.mapsKey="AIzaSyCahsmc9ueMU-kn1Yp4E7sa0b7CLjIi6Xg"),this.closeBtn.addEventListener("click",this.closeMap),this.trapFocus,t.restrictFocus({container:this.element})},openMap(a,e){this.isEmbedded||(PubSub.publish("dealermap.render"),this.isExternalOpen=typeof e<"u",this.element.classList.add(`${this.baseStr}--active`),window.addEventListener("keyup",this.keyCheck),this.currentBreakpoint!=="mobile"&&this.toggleFill(!1,!0),this.isExternalOpen||(this.body.classList.add("globalnav-primary__map--kill-scroll"),setTimeout(()=>{document.querySelector(".dealer-map__top-nav-new-search").focus()},500)),t.restrictFocus({container:this.element,toggleOpen:!0}),t.restrictFocus({container:s.qs(".filterable-list-view__map-toggle",this.element)}),this.setTrapFocus(),PubSub.publish("dealer.open"),GlobalMessage("measure.dtm.track","dtmDealerLocatorModalOpen"))},toggleFill(a=!1,e=!1){const i={className:"globalnav-primary-fill--active-map",close:a,open:e};PubSub.publish("nav.toggleFill",i)},closeMap(a){this.element.classList.remove(`${this.baseStr}--active`),this.toggleFill(!0),this.body.classList.remove("globalnav-primary__map--kill-scroll"),window.removeEventListener("keyup",this.keyCheck),PubSub.publish("dealer.list-reset"),PubSub.publish("filter.reset-list-view"),PubSub.publish("map.close-modal"),PubSub.publish("filter.toggleDisplay"),this.isExternalOpen||setTimeout(()=>{document.querySelectorAll(".globalnav-primary-location-bar__flex-holder button").forEach(e=>e.focus())},500),!l.isDealerSet()&&l.getDealerList()&&l.setLocalDealer(l.getDealerList()[0].UniqueID,l.getMaco()),t.restrictFocus({container:this.element,focusableItems:this.adaFocusableItems}),this.removeTrapFocus(),GlobalMessage("measure.dtm.track","dtmDealerLocatorModalClose")},storeDealer(a,e){this.selectedDealership=e},setTrapFocus(a,e){const i=s.qs(".dealer-map__outter-shell",this.element);this.removeTrapFocus(),e==="search"&&t.restrictFocus({container:s.qs(".dealer-map-location-search",this.element),focusableItems:this.adaSearchPageFocusableItems}),e==="result"&&t.restrictFocus({container:s.qs(".dealer-map-location-search",this.element)}),e==="detail"&&(t.restrictFocus({container:s.qs(".filterable-list-view__dealer-list",this.element)}),t.restrictFocus({container:s.qs(".dealer-map-location-search",this.element)})),i&&(this.trapFocus=t.trapFocus(i),this.trapFocus.addTrapFocus())},removeTrapFocus(a,e){const i=s.qs(".filterable-list-view__dealer-list",this.element);this.trapFocus&&this.trapFocus.removeTrapEventListener(),e==="result"&&(i&&i.childNodes.length>0&&(i.innerHTML=""),t.restrictFocus({container:s.qs(".dealer-map-location-search",this.element),focusableItems:this.adaSearchPageFocusableItems})),e==="detail"&&t.restrictFocus({container:s.qs(".filterable-list-view__dealer-details",this.element)})},keyCheck(a){a.which===27&&this.closeMap()},isMapOpen(a){this.element.classList.contains(`${this.baseStr}--active`)&&this.toggleFill(!1,!0)},resizeEvt(a,e){this.currentBreakpoint==="desktop"&&(e==null?void 0:e.width)<960?(this.currentBreakpoint="mobile",this.toggleFill(!0)):this.currentBreakpoint==="mobile"&&(e==null?void 0:e.width)>=960&&(this.currentBreakpoint="desktop",this.isMapOpen())}});

</script>

</body>
</html>
