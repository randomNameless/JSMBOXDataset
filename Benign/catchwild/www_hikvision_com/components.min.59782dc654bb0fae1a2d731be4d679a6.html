<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>components.min.59782dc654bb0fae1a2d731be4d679a6.html</title>
</head>
<body>

<script>
;
$(function () {
    if($(".banner-btn-link").hasClass("video-btn")){
        $(".banner-btn-link.video-btn").addClass("hik-video-trigger")
    }
    function initClickAt() {
        $('.new-banner-full').each(function(){
            (function(self){
                var transitionInterval = $(self).attr('data-transition-interval')
                var bannerId = $(self).attr("id")
                var animationCss = "#" + bannerId +" .swiper-pagination-bullet.swiper-pagination-bullet-active .swiper-carousel-div span {animation: banner-active " + transitionInterval / 1000 + "s linear 1 forwards;}"
                $("style").append(animationCss)
                var $firstSwiperSlide = $(self).find(".swiper-slide").eq(1)
                if ($($firstSwiperSlide).attr("data-color") === 'text-color-white') {
                        $(self).find('.swiper-carousel-div').removeClass('text-color-grey')
                        $(self).find('.swiper-carousel-div').addClass('text-color-white')
                    } else if ($($firstSwiperSlide).attr("data-color") === 'text-color-grey') {
                        $(self).find('.swiper-carousel-div').removeClass('text-color-white')
                        $(self).find('.swiper-carousel-div').addClass('text-color-grey')
                    }
            })(this)
        })
        $.each($('.swiper-pagination-bullet'), function (elem, index) {
            $(this).unbind('click').on('click', function (e) {
                var atModule = 'new_banner_carousel::banner_progress::' + $(this).data('title') + "::new-banner-carousel"
                atModel.doAtEvent(atModule, 'action', e)
            })
        })
    }
    initClickAt();
});

$(document).ready(function () {
  $.each($(".hik-video-trigger"), function(){
    if($(this).attr("data-mobile") == "true" && $(this).attr("data-video-path").indexOf("youtu")==-1){
      $(this).attr("data-internal-video", "true")
    }
  })
  if(getCurrentBreakPoint() == 'MOBILE'){
    $.each($(".super-big-banner-full").find(".text-wrapper, .video-title-cta"),function(){
      if($(this).hasClass("middle-center")){
        $(this).removeClass("middle-center").addClass("left-center")
      }
    })
  }
  // publish模式或者生产环境---解决vh在editor模式下无限计算高度导致高度无限拉长的问题
  if(window.location.href.indexOf("editor.html") > -1){
    $(".super-big-banner-full .swiper-wrapper").css({
      "height": "760px"
    })
  } else {
    if(getCurrentBreakPoint() == 'MOBILE'){
      $(".super-big-banner-full .swiper-wrapper").css({
      "height": "100%"
      })
    } else {
      if($(".super-big-banner-full").find(".banner-carousel-fullscreen").length){
        $(".super-big-banner-full .swiper-wrapper").css({
          "height": "100vh"
        })
      } else {
        $(".super-big-banner-full .swiper-wrapper").css({
          "height": "calc( 100vh - 120px )"
          })
      }
    }
  }
  $(".video-plyer").on("click", function(){
      var player = document.getElementById("mob-play")
      if(player.paused){
        $(this).hide()
        player.play()
       // $(this).hide()
      } else{
        player.pause()
      }
  })
var $loginBanner = $("[data-login-video=true]");
var randomNo;

   $loginBanner.each(function(){
  var _this = $(this);
    randomNo = _this.attr("data-randomNo");
    var id = _this.attr("id");
    var baseUrl = _this.attr("data-baseUrl");
        var ticket = getLoginCookie("ticket");
        if(ticket && ticket!="123"){
            loginUtil.checkLogin(function(){
                $.ajax({
                    type : "GET",
                    url : baseUrl+".json",
                    dataType : "json",
                    success : function(data) {
                        data.randomNo = randomNo;
                        // $("#banner-login-video").html(tmpl("tmpl-login-video",data));

                        var banners = data.banners;
                        for(var i=0; i < banners.length; i++){
                            if(banners[i].isVideo === 'true'){
                                $("#hero-banner-"+randomNo+" .hik-video-trigger[data-index="+i+"][data-mobile='false']").attr("data-video-path", banners[i].videoPath);
                            }
                            if(banners[i].isVideoMobile === 'true'){
                                $("#hero-banner-mobile-"+randomNo+" .hik-video-trigger[data-index="+i+"][data-mobile='true']").attr("data-video-path", banners[i].videoPathMobile);
                            } else if(banners[i].isVideoMobile === 'false' && banners[i].isVideo === 'true'){
                                $("#hero-banner-mobile-"+randomNo+" .hik-video-trigger[data-index="+i+"]").attr("data-video-path", banners[i].videoPath);
                            }
                        }
                    },
                    error : function() {
                        console.log("Banner Video info get failed");
                    }
                });
            });
        }
        //未登录情况下，桌面/移动端播放视频按钮点击事件监听
        $("#"+_this.attr("id")+",#hero-banner-mobile-"+randomNo).find(".explore-btn-link.explore-video-link").on("click",function(){
            var index = $(this).attr("data-index");
            var ticket = getLoginCookie("ticket");
            if(ticket && ticket!="123"){
                loginUtil.checkLogin();
            }else{
                loginUtil.popupLoginConfirmModal();
            }
        });
    })
    if ($('.banner-carousel-wrapper .carousel-inner a[href].explore-btn-link').length > 0
    && $('.banner-carousel-wrapper .carousel-inner a[href].explore-btn-link').attr('href').indexOf('/all-forms/') >= 0) {
    $(".banner-carousel-wrapper .carousel-inner a[href].explore-btn-link").on("click", function () {
        setSubmittedPageUrlCookie("contactUsUrl");
    });
    }
  });

$(document).ready(function() {
    initMultiTabsComp();
});

var initMultiTabsComp = function(){
    var counts = []
    var breakpoint = getCurrentBreakpoint();
    var borderColor = $("body").css('background-color');
    var sWidth = $(".slick-slide").width()
    function bindEvent($comp) {
        var lastScrollLeft = $('.tab-container').scrollLeft(); //
        $('.tab-container').scroll(function() {
            var currentScrollLeft = $(this).scrollLeft(); // Current scroll position
            var self = this
            var $element = $(this);
            var scrollLeft = $element.scrollLeft();
            var scrollWidth = $element[0].scrollWidth;
            var clientWidth = $element.outerWidth();
            if (currentScrollLeft > lastScrollLeft) {
                console.log('Scrolling right');
            } else {
               $(self).addClass('default')
            }
            if (scrollLeft + clientWidth >= scrollWidth) {
                $(self).removeClass('default')
              }
            lastScrollLeft = currentScrollLeft; // Update lastScrollLeft to the current position
          });
        $.each($comp.find('.tabs-wrapper .tab-item'),function(index, elem){
            $(this).find('.content').off().on('click', function(e) {
                initHandleMobileScroll($(elem),$(this).parent().parent().parent())
               // initHandleMultiTabMobile($(elem),$(this).parent().parent(),$(this).parent().parent().parent())
                var $tabItem = $(this).parent();
                var index = $tabItem.index();
                var $contentItem = $comp.find('.tabs-content-wrapper .content-detail-section').eq(index);
               // var leftOffset = $(this).parent().offset().left
                $tabItem.addClass('active');
                $tabItem.siblings().removeClass('active');
                $contentItem.siblings().removeClass('active');
                $contentItem.addClass('active');
                $(this).trigger('multi-tabs-change');
                initBorderBottomColor($comp);
                // productshowcase
                if($contentItem.find(".product-showcase").length){
                    initProductShowCaseCarousel(true)
                }
              // multi-scenario
                if($contentItem.find(".multi-scenario-switching-wrapper").length){
                    initMultiScenario($contentItem.find(".multi-scenario-switching-wrapper"), true);
                }
                if($contentItem.find(".interactive-banner-carousel").length){
                    $contentItem.find(".interactive-banner-carousel").each(function () {
                        const $that = $(this);
                       if(window.initSwiper){
                        initSwiper($that);
                       }
                       if(window.toggeleVideo){
                        toggeleVideo($that);
                       }
                    });
                }     
                // // media wrapper
                // if($contentItem.find(".media-wrapper.section").length){
                //     initMediaWrapper(true);
                // }
                // if($(this).parent().parent().width() - leftOffset<200){
                //     $(this).parent().parent().parent().removeClass("default")
                // } else {
                //     $(this).parent().parent().parent().addClass("default")
                // }
                var item = $(this).parent()
                var container = $(this).parent().parent().parent()
                var itemoffset = item.offset()
                var itemOffsetLeft = itemoffset.left +  container.scrollLeft();
                var centerLeft =  ($(window).width() - item.width()) /2
                // $(this).parent().parent().parent().animate({
                //     "scrollLeft": itemOffsetLeft-centerLeft
                // }, 500)
                // var lastOffsetW = $(this).parent().parent().find(".tab-item").eq(-1).offset().left - $(this).parent().parent().parent().parent().offset().left + $(this).parent().parent().find(".tab-item").eq(-1).width()
                // if(breakpoint === 'DESKTOP' && lastOffsetW>container.width()) {
                //     if(index >=  $(this).parent().parent().find(".tab-item").length -3){
                //         $(".next-btn").hide()
                //     } else {
                //         $(".next-btn").show()
                //     }
                    
                //    // if(index <= 4){
                //  if(itemOffsetLeft-centerLeft<0){
                //         $(".pre-btn").hide().removeClass("show")
                //     } else {
                //         $(".pre-btn").show().addClass("show")
                //     }
                // } else {
                //     $(".pre-btn").hide()
                //     $(".next-btn").hide()
                // }
                if(breakpoint === 'MOBILE'){
                    if(index >=  $(this).parent().parent().find(".tab-item").length -2){
                        $(this).parent().parent().parent().removeClass("default")
                    } else {
                         $(this).parent().parent().parent().addClass("default")
                     }
                }
                if($(".slick-track").length){
                    $.each($(".slick-track"), function(index){
                          var len = $(this).find(".slick-slide").length;
                          var wid = $(this).find(".slick-slide").width();
                          $(this).find(".slick-slide").css({
                            "width": sWidth
                          })
                          $(this).css({
                            "width":  sWidth * len
                         })
                       
                  
                        // var len = $(this).find(".slick-slide").length;
                        // var wid = $(this).find(".slick-slide").width();
                        // var continerWidth = $(window).width()
                        // var cw=313
                        // console.log("widlen",$(window).width())
                        // $(this).css({
                        //     "width":  wid * len
                        // })
                        // if(continerWidth<=1680 && continerWidth>1280){
                        //     cw = 293
                        // } else if(continerWidth<=1280 && continerWidth>992){
                        //     cw = 250
                        // } else if(continerWidth>=1680){
                        //     cw = 313
                        // }
                        // $(this).find(".slick-slide").css({
                        //     "width": 313
                        // })
                    })
                }
                var parentElementElement = $(this).parent().parent().parent().parent().parent().find(".tabs-content-wrapper").find(".content-detail-section.active").find(".swiper-container")
                webpLazyload(true, parentElementElement);
                initCarsouel(parentElementElement);
                initSingleImageLoad($(this).parent().parent().parent().parent().parent().find(".tabs-content-wrapper").find(".content-detail-section.active"));
                 var self = this
                $(window).on('scroll', function () {
                    initSingleImageLoad($(self).parent().parent().parent().parent().parent().find(".tabs-content-wrapper").find(".content-detail-section.active"));
                 })
            });
        })
        var timeout;
        $comp.find('.tabs-wrapper .pre-btn').unbind('click').on('click', function(e) {
            e.stopPropagation();
            clearTimeout(timeout);
            var _this = this
            timeout = setTimeout(function() {
                if (!$comp.find('.tabs-wrapper .pre-btn').hasClass('show')) return;
                var $tabs = $comp.find('.tabs-section');
                var num = $tabs.find('.tab-item').length;
                var tabW = $tabs[0].scrollWidth;
                var step = tabW / num;
                var tabX = $tabs.css("transform").replace(/[^0-9\-,]/g, '').split(',')[4];
                tabX = Math.round(tabX) + step;
                if (tabX > 0) tabX = 0;
                if(tabX === 0) $(this).hide().removeClass('show')
                $tabs.css({ 'transform': 'translateX(' + Math.round(tabX) + 'px)' });
            }, 180);
        });

        $comp.find('.tabs-wrapper .next-btn').unbind('click').on('click', function(e) {
            e.stopPropagation();
            if(!$(this).hasClass('show')) return;
            var $tabs = $comp.find('.tabs-section');
            var num = $tabs.find('.tab-item').length;
            var tabW = $tabs[0].scrollWidth;
            var step = tabW / num;
            var tabX = $tabs.css("transform").replace(/[^0-9\-,]/g,'').split(',')[4];
            var containerW = $comp.find('.tab-container').width();
            tabX = tabX - step;
            if (Math.abs(tabX) > (tabW - containerW)) tabX = containerW - tabW;
            $tabs.css({'transform':'translateX('+Math.round(tabX)+'px)'});
        });

        $comp.find('.tabs-section').on('transitionend', function() {
            initTabArrowBtn($comp);
        })
    }
    function initTabArrowBtn($comp) {
        var containerW = $comp.find('.tab-container').width();
        var $tabs = $comp.find('.tabs-section');
        var $preBtn = $comp.find('.tabs-wrapper .pre-btn');
        var $nextBtn = $comp.find('.tabs-wrapper .next-btn');
        var tabW = $tabs[0].scrollWidth;
        var tabX = $tabs.css("transform").replace(/[^0-9\-,]/g,'').split(',')[4];
        if (tabX == 0) {
            $preBtn.removeClass('show');
        } else {
            if(breakpoint === 'DESKTOP') {
                $preBtn.addClass('show');
            }
        }
        if ((Math.abs(tabX) + 1) >= Math.round(tabW - containerW)) {
            $nextBtn.removeClass('show');
        } else {
            if(breakpoint === 'DESKTOP') {
                $nextBtn.addClass('show');
            }
        }

        if(breakpoint === 'MOBILE') {
            $preBtn.removeClass('show');
            $nextBtn.removeClass('show');
        }
    }

    function initTabPosition($comp) {
        var tabW = 0;
        var $tabs = $comp.find('.tabs-section');
        var containerW = $comp.find('.tab-container').width();
        // ensure that section is there
        if(!$tabs.length) {
          return;
        }
        tabW = $tabs[0].scrollWidth;
        $tabs.css({'transform':'translateX(0)'});

        if (tabW > containerW) {
            setTimeout(function() {
                initTabArrowBtn($comp);
            }, 200);
        }
    }

    function initBorderBottomColor($comp) {
        var $activeTab = $comp.find('.tabs-wrapper .tab-container .tabs-section .tab-item.active');
        if($comp.parent().hasClass('background-color-black')){
            $activeTab.css('border-bottom-color',  '#000');
        } else {
            $activeTab.css('border-bottom-color',  borderColor);
        }
        
    }
    $(".mult-mob-tabs-container-comp").each(function(){
        if($(this).hasClass("background-color-black")){
            $(this).parent().addClass("background-color-black")
        }
        $.each($(this).find(".tabs-section li"), function(i,e){
            $(this).on("click", function(){
                var hrefUrl = ''
                var hrefTarget = ''
                var multiTab = $(this).attr("data-multi-tab")
                if(multiTab.indexOf(" ") == -1){
                    hrefUrl = $(".multi-link-" + $(this).attr("data-multi-tab")).attr("href")
                    hrefTarget = $(".multi-link-" + $(this).attr("data-multi-tab")).attr("target")
                } else {
                  var mutils =  multiTab.split(" ")
                  var allClassNames = ''
                  $.each(mutils, function(i, e){
                    allClassNames+="."+e
                  })
                  hrefUrl = $(allClassNames).attr("href")
                  hrefTarget = $(allClassNames).attr("target")
                }
                setTimeout(function(){
                    window.open(hrefUrl, hrefTarget)
                }, 200)
                //$(".multi-link-" + $(this).attr("data-multi-tab")).trigger("click")
            })
        })
    })
    $('.mult-tabs-container-comp').each(function() {
        var $comp = $(this);
        bindEvent($comp);
        setTimeout(function(){
           $comp.find('.tabs-wrapper .tab-item').eq(0).find(".content").click()  
        })
        initTabPosition($comp);
        initBorderBottomColor($comp);

        var resizeTimer;
        $(window).on('resize', function() {
            if (resizeTimer) {
                clearTimeout(resizeTimer);
            }

            resizeTimer = setTimeout(function() {
                breakpoint = getCurrentBreakpoint();
                initTabPosition($comp);
                initBorderBottomColor($comp);
            }, 50);
        })
    });
};

//multi 轮播处理
function initCarsouel(parentElement){
    $.each($(parentElement), function(){
        $(this).find(".swiper-carousel-div").removeClass("text-color-grey text-color-white").addClass($(this).find(".first-slide").attr("data-color"))
        var self = this
        var bannerId = $(self).attr("id")
        //console.log("this", $(this.$el).find(".swiper-loop-div span").length)
        var newBannerSwiper = new Swiper(this, {
          watchOverflow: true,
          disableScroll: true,
          preloadImages: false,
          loop: $(this).find(".swiper-loop-div span").length>1?true:false,
          noSwiping:  getCurrentBreakPoint() == 'MOBILE' ? false : true,
          autoplay: {
              disableOnInteraction: false
            },
          pagination: {
              clickable :true,
              el: '.swiper-pagination',
              bulletElement : 'li',
              renderBullet: function (index, className) {
                  return '<div class="' + className + '"><div class="swiper-carousel-div"><span class="swiper-carousel-span"></span></div></div>';
              },
          },
          on: {
            transitionStart: function(){
              if(isInViewPort($(self).get(0))){
                  var _self = $(this.$el).find(".swiper-slide-active")
                  var imgSrc = $(_self).find("picture").attr("data-src")
                  var mobImgSrc = $(_self).find("picture").attr("data-mob-src")
                  var imageAltText =  $(_self).find(".banner-info-wrapper .title").find("pre").html() || 'Banner Image Text'
                  console.log("data-color", _self.attr("data-color"))
                  $(this.$el).find(".swiper-carousel-div").removeClass("text-color-grey text-color-white").addClass(_self.attr("data-color"))
                  $.each(_self, function(i,e){
                      $.each($(this).find("source"), function(index,ele){
                        if(!$(this).attr("srcset")){
                          $(this).attr("srcset", $(this).attr("data-srcset"))
                        }  
                      })
                    })
                  if(!$(_self).find("picture").find("img").length){
                    if(getCurrentBreakpoint()!== "MOBILE"){
                        // find("img").attr("src", $(this).find("img").attr("data-src"))
                        if(imgSrc){
                         $(_self).find("picture").append("<img decoding='async' src='"+imgSrc+"' alt='"+imageAltText+"' /> ")
                        }
                      }else{
                          if(mobImgSrc){
                           $(_self).find("picture").append("<img decoding='async' src='"+mobImgSrc+"' alt='"+imageAltText+"' /> ")
                          }
                    }
                  }   
              }    
            }
          },
      });
      $(this).hover(function(){
          newBannerSwiper.autoplay.stop();
          $("#" + bannerId).find(".swiper-pagination-bullet.swiper-pagination-bullet-active .swiper-carousel-div span").addClass("slow")
      },function(){
          newBannerSwiper.autoplay.start();
          $("#" + bannerId).find(".swiper-pagination-bullet.swiper-pagination-bullet-active .swiper-carousel-div span").removeClass("slow")
          $("#" + bannerId).find(".swiper-pagination-bullet.swiper-pagination-bullet-active .swiper-carousel-div span").on("animationend", function(){
           newBannerSwiper.slideNext();
       })
      });
  })
}
// 处理图片加载
function initSingleImageLoad(parentElement){
   $.each($(parentElement).find(".lazy-image-single"), function(){
    if (isInViewPort($(this).get(0))) {
        if(getCurrentBreakPoint() == 'DESKTOP'){
            if($(this).attr("data-src")){
              $(this).attr('src',$(this).attr("data-src"));
             }
            if($(this).attr("data-original")){
                $(this).css('background-image', 'url("' + $(this).attr("data-original") + '")');
            }
        } else {
            if($(this).attr("data-mob-src")){
                $(this).attr('src',$(this).attr("data-mob-src"));
               } else {
                $(this).attr('src',$(this).attr("data-src"));
               }
               if($(this).attr("data-original-mobile")){
                $(this).css('background-image', 'url("' + $(this).attr("data-original-mobile") + '")');
             }
        }
    }
   }) 
}
var productCarousel = (function ($) {
  var productCarousel = {};
  productCarousel.init = function () {
    $(document)
      .ready(
        function () {
          if(isCN){
            $(".product-carousel-wrap .slide-image").addClass("lazy-product").find("picture").remove()
          }
          if($('.product-carousel-wrap .swiper-slide').length <= 1) {
            $('.product-carousel-wrap .carousel-control').hide()
          }else{
            $('.product-carousel-wrap .carousel-control').show()
          }
          if(getCurrentBreakpoint() == 'MOBILE'){
            var $slideThumb = $('.product-carousel-thumb .swiper-wrapper .swiper-slide');
            if($slideThumb.length > 6){
              $slideThumb.addClass('more-slide');
            }
          }
          if($(".product-carousel-wrap").length) {
            var productCarouselSwiper;
            $.each($(".product-carousel-wrap"), function(){
              productCarouselSwiper = new Swiper( this, {
                slidesPerView: 1,
                direction: 'horizontal',
                speed:0,
                loop: $(this).find(".swiper-slide").length > 1 ? true : false,
                navigation: {
                  nextEl: '.carousel-control-next',
                  prevEl: '.carousel-control-prev',
                },
                on:{
                  slideChangeTransitionStart:function(e){
                    $(this.$el).siblings('.product-carousel-thumb').find('.swiper-slide').eq(this.realIndex).addClass('active').siblings().removeClass('active')
                    var _self = $(this.$el).find(".swiper-slide-active")
                    var imgSrc = $(_self).find("picture").attr("data-src")
                    var mobImgSrc = $(_self).find("picture").attr("data-mob-src")
                    $.each(_self, function(i,e){
                      $(e).find("source").attr("srcset", $(e).attr("data-srcset"))
                    })
                    if(!$(_self).find("picture").find("img").length){
                      if(getCurrentBreakpoint()!== "MOBILE"){
                          $(_self).find("picture").append("<img decoding='async' src='"+imgSrc+"' alt='"+$(".prod_name-content").text()+"'/> ")
                        }else{
                          $(_self).find("picture").append("<img decoding='async' src='"+mobImgSrc+"' alt='"+$(".prod_name-content").text()+"' /> ")
                      }
                    }
                    $(_self).find(".lazy-product").lazyload();
                  },
                  init: function(){
                    if($(this.$el).find(".swiper-slide").length <= 1){
                      $(this.$el).find('.swiper-wrapper').css('transform','unset')
                    }
                  }, 
                }
              });
            })
          }

          function preventDefault(e) {
            e.preventDefault()
          }

          //禁止滚动条滚动
          function disableScroll(element) {
            element.style.overflowPosition = element.style.overflow
            element.style.overflowY = 'scroll'
            element.addEventListener('wheel', preventDefault, { passive: false })
            element.addEventListener('touchmove', preventDefault, { passive: false })
            return preventDefault
        }
        //恢复滚动条滚动
        function enableScroll(element) {
            element.style.overflow = element.style.overflowPosition
            delete element.style.overflowPosition
            element.removeEventListener('wheel', preventDefault)
            element.removeEventListener('touchmove', preventDefault)
        }
      
          $('.product-carousel-wrap .swiper-wrapper .swiper-slide:not(.has-video)').on('click', function(e) {
            var isDesktop = getCurrentBreakpoint()
            if(!isCN){
              window.scrollTo(0,0);
              stickyDescription.stickyProductDescription(false);
            }
            $('.product-preview-wrap').show()
            $('.product-preview-wrap').find('.swiper-wrapper').css('transform','unset')
            var $videoCard = $(this).parent().find('.swiper-slide.has-video')
            var realIndex = $(this).index()
            var htmlElement = document.getElementsByTagName('html')[0]
            $.each($('.product-preview'),function(){
              var $previewWrap = $(this)
              var $downloadBtn = $previewWrap.find('.download-wrap .download-btn')
              var previewWrapSwiper = new Swiper(this, {
                slidesPerView: 1,
                speed: isDesktop ? 0 : 300,
                loop: $(this).find(".swiper-slide").length > 1 ? true : false,
                pagination: {
                  el: isDesktop == 'DESKTOP' ? '' : '.swiper-pagination',
                  type: isDesktop == 'DESKTOP' ? '' : 'fraction',
                },
                navigation: {
                  nextEl: '.carousel-control-next',
                  prevEl: '.carousel-control-prev',
                },
                on: {
                  init: function() {
                    var dataHref = $previewWrap.find('.swiper-slide-active').find('.product-preview-item').attr('data-original');
                    $downloadBtn.attr('href', dataHref)
                    var index = Number($previewWrap.find('.swiper-slide-active').find('.product-preview-item').parent().attr('data-index'))+1
                    if($previewWrap.find('.swiper-slide-active').find('.product-preview-item').parent().attr('data-swiper-slide-index')){
                       index = Number($previewWrap.find('.swiper-slide-active').find('.product-preview-item').parent().attr('data-swiper-slide-index'))+1
                    }
                    var filename = $('.product_description_title .title').text()
                    if($('.sub_product_container').length){
                       filename = $('.sub_product_container').find('.current_selected').find('span').text().trim()
                    } 
                    var downloadname = ''
                    if($previewWrap.find('.swiper-slide').length <=1){
                      downloadname = filename +'_image_1.'+getFileExtension(dataHref)
                    } else {
                      downloadname = filename +'_image_'+index+'.'+getFileExtension(dataHref)
                    }
                    
                    $downloadBtn.attr('download', downloadname)
                    if($previewWrap.find(".swiper-slide").length <= 1) {
                      $previewWrap.find('.carousel-control').hide()
                    }else {
                      $previewWrap.find('.carousel-control').show()
                    }
                  },
                  slideChangeTransitionEnd: function() {
                    var dataHref = $previewWrap.find('.swiper-slide-active').find('.product-preview-item').attr('data-original');
                    $downloadBtn.attr('href', dataHref)
                    var index = Number($previewWrap.find('.swiper-slide-active').find('.product-preview-item').parent().attr('data-swiper-slide-index'))+1
                    var filename = $('.product_description_title .title').text()
                    if($('.sub_product_container').length){
                       filename = $('.sub_product_container').find('.current_selected').find('span').text().trim()
                    } 
                    var downloadname = ''
                    if($previewWrap.find('.swiper-slide').length <=1){
                      downloadname = filename +'_image_1.'+getFileExtension(dataHref)
                    } else {
                      downloadname = filename +'_image_'+index+'.'+getFileExtension(dataHref)
                    }
                   $downloadBtn.attr('download', downloadname)
                  }
                }
              })
              if($videoCard.index() < realIndex && $videoCard.length > 0 &&  $videoCard.length <= 1 ) {
                previewWrapSwiper.slideTo(realIndex - 1)
              } else {
                previewWrapSwiper.slideTo(realIndex)
              }  
              disableScroll(htmlElement);
            })
            $('.product-preview .close-btn').on('click',function(){
              $('.product-preview-wrap').hide()
              enableScroll(htmlElement)
            })
            $.each($('.product-preview .swiper-slide .product-preview-item'),function(){
              $(this).css('background-image','url("' + $(this).attr('data-original') + '")')
            })
          })

          $('.product-preview-wrap .download-wrap .download-btn').unbind("click").on('click',function(e){
            var productId = $('.tab_stick_bar_container .product_title .product_title_item').text();
            var module = "product_carousel::image_download::" + productId;
            atModel.doAtEvent(module, 'download', e);
          });

          $('#productCarouselThumb .swiper-slide').click(function () {
            $(this).addClass('active').siblings().removeClass('active')
            var imageIndex= $(this).find('.slide-image').data('index-number')
            productCarouselSwiper.slideTo(imageIndex + 1)
          });

          var activeThumbnail = function () {
            $("#productCarouselThumb .swiper-slide .slide-image").each(function () {
              var $this = $(this);
              var imgIndex = $this.data("index-number");
              if (imgIndex === $('#productCarouselComp .swiper-slide.active .show-image').data('index')) {
                $this.parent('.swiper-slide').addClass('active');
              } else {
                $this.parent('.swiper-slide').removeClass('active');
              }
            });
          }
          activeThumbnail();
          // 轮播图片处理
          var productCarouselImage = function(){
            setTimeout(function(){
            var $fistLazyImage = $(".lazy-carousel .swiper-slide.active").find(".lazy-product")
              $fistLazyImage.lazyload();
              }, 1000)
          }
          productCarouselImage();

          // var $productCarousel = $(".product-carousel-wrap");
          // var $productCarouselThumb = $("#productCarouselThumb");
          var mainSlideCount = $('#productCarouselComp .swiper-slide').length;
          if (mainSlideCount <= 1) {
            $('.product-carousel-wrap').addClass('bot');
          } else {
            $('.product-carousel-wrap').removeClass('bot');
          }




          // Thumbnail carousel
          // var thumbCount = $('#productCarouselThumb .swiper-slide').length;


          // var isMobile = $(window).width() < 768;
          // var isTablet = $(window).width() >= 768 && $(window).width() <= 1024;
          // var thumbCount = $('.product-carousel-thumb .swiper-slide').length;

         // 视频如果没有封面取第一个banner做封面
        //  var firstBanner = $('.show-image').find(function(item, index){
        //    console.log('item',$(item), index)
        //    // return $(item).attr('data-original')
        //  })
        var firstBanner =  Array.prototype.slice.call($('.show-image')).find(function(item, index){
          return $(item).attr('data-original')
        })
        var firstNBanner = Array.prototype.slice.call($('.number-image')).find(function(item, index){
          return $(item).attr('data-original')
        })
        $.each(Array.prototype.slice.call($('.show-image')), function(index, item){
           if($(item).parent().parent().attr('data-video') === 'true' && !$(item).attr('data-original')){
            $(item).parent().parent('.swiper-slide').next().addClass('hide-image')
            $(item).attr('data-original', $(firstBanner).attr('data-original'))
            $(firstBanner).parent().parent().remove()
           }
         })
         $.each(Array.prototype.slice.call($('.number-image')), function(index, item){
          if($('.show-image').length === 1){
            $(item).parent().parent().hide()
          }
          if($(item).parent().parent().attr('data-video') === 'true'){
            if(!$(item).attr('data-original')){
              $(item).attr('data-original', $(firstBanner).attr('data-original'))
              $(firstNBanner).parent().parent().remove()
            }
          }
        })
      })   
  };

  return productCarousel;
}($));

productCarousel.init();

$(document).ready(function(){
    function addScriptData(){
        if(!$('#productCarouselComp') || $('#productCarouselComp').length <1){
          return;
        }
        var $carouselSlides = $('#productCarouselComp').find('.swiper-slide');
        var mainSlideUrl = null;
        if($carouselSlides.length > 1){
          $.each($carouselSlides, function(index, value){
            if($(value).attr('data-swiper-slide-index') == 0){
              mainSlideUrl = $(value).attr('data-original');
              return false;
            }
          });
        }else{
          mainSlideUrl = $carouselSlides.eq(0).attr('data-original');
        }
        var script = document.createElement('script');
        script.type = 'application/ld+json';
        script.text = JSON.stringify({
          "@context": "https://schema.org",
          "@type": "ImageObject",
          "contentUrl": mainSlideUrl,
          "license": "https://www.hikvision.com/en/policies/website-image-copyright-statement",
          "acquireLicensePage": "https://www.hikvision.com/en/how-to-use-our-images",
          "creditText": "Hikvision",
          "creator": {
            "@type": "Organization",
            "name": "Hikvision"
          }
        });
        document.querySelector('head').appendChild(script);
    }
    addScriptData();
})
var productSpotlight = (function ($) {
  var productSpotlight = {};

  productSpotlight.productSelector = function (selectedCategory, productSpotlightCarousel) {
    var $productSpotlightCarousel = productSpotlightCarousel;
    var productItems = [];

    var filteredProducts = productItems.filter(function (val) {
      return val.category.toString().toLowerCase() == selectedCategory.toLowerCase();
    });

    $.each(filteredProducts, function (i, val) {
      var $productItemWrapperElement = $('<div class="product-item-wrapper"/>');
      var $productItemElement = $('<div class="product-item"/>');
      var $productImageWrapper = $('<div class="product-item-img-wrapper"/>');
      var $productTag = $('<div class="tag"/>');
      var $productImage = $('<img/>');
      var $productItemInfo = $('<div class="product-item-info"/>');
      var $productTitle = $('<div class="title"/>');
      var $productDescription = $('<div class="description"/>');
      var $addToCompareWrapper = $('<div class="add-to-compare"/>');
      var $addToCompareInput = $('<input type="checkbox" name="addToCompare"/>');
      var $addToCompareLabel = $('<label for="addToCompare"/>');
      var $btnGo = $('<div class="btn-go"/>');

      $productImage.attr('src', val.imageSrc);
      $productTag.text(val.tag);
      $productTag.appendTo($productImageWrapper);
      $productImage.appendTo($productImageWrapper);
      $productTitle.text(val.name).appendTo($productItemInfo);
      $productDescription.text(val.description).appendTo($productItemInfo);
      $addToCompareInput.appendTo($addToCompareWrapper);
      $addToCompareLabel.text('Compare');
      $addToCompareLabel.appendTo($addToCompareWrapper);
      $addToCompareWrapper.appendTo($productItemInfo);
      $btnGo.appendTo($productItemInfo);
      $productImageWrapper.appendTo($productItemElement);
      $productItemInfo.appendTo($productItemElement);
      $productItemElement.appendTo($productItemWrapperElement);
      $productItemWrapperElement.appendTo($productSpotlightCarousel.find('.slideshow'));
    });

    productSpotlight.initCarousel();

  };

  productSpotlight.initCarousel = function (productSpotlightCarousel) {
    var $productSpotlightCarousel = $(productSpotlightCarousel);
    if (!$productSpotlightCarousel) {
      return;
    }
    var interval = $productSpotlightCarousel.attr('data-interval');
    var $dotsContainer = $productSpotlightCarousel.find('.product-carousel-dots');
    var ITEM_COUNT_IN_VIEW = 4;
    var MOBILE_WIDTH = 991;
    var clientWidth = document.body.width || window.innerWidth;
    if (clientWidth > MOBILE_WIDTH) {
      $productSpotlightCarousel.find('.slideshow').slick({
        autoplay: true,
        infinite: true,
        autoplaySpeed: interval,
        dots: true,
        appendDots: $dotsContainer,
        prevArrow: '<div class="product-carousel-pre-btn slick-pre"></div>',
        nextArrow: '<div class="product-carousel-next-btn slick-next"></div>',
        slidesToShow: ITEM_COUNT_IN_VIEW,
        slidesToScroll: 4
      })
    }
  };

  productSpotlight.initCategorySelector = function (productSpotlightCarousel) {
    var $categorySelector = $('.product-spotlight-wrapper .product-category-dropdown-wrapper');
    var $categoryDropdown = $categorySelector.find('.dropdown');
    var $categorySelectedOption = $categorySelector.find('.selected-option-wrapper .selected-option');

    $categorySelector.find('.dropdown li').on('click', function (e) {
      e.stopPropagation();
      $categorySelectedOption.text($(this).text());
      $categoryDropdown.removeClass('show remove-border');
      $categorySelector.removeClass('remove-border').find('.arrow-icon').removeClass('arrow-up');
      productSpotlight.productSelector($(this).text(), productSpotlightCarousel);
    });

    $categorySelectedOption.on('click', function (e) {
      e.stopPropagation();
      $categoryDropdown.toggleClass('show remove-border');
      $categorySelector.toggleClass('remove-border');
      $categorySelector.find('.arrow-icon').toggleClass('arrow-up');
    });

    $('body').on('click', function () {
      $categoryDropdown.removeClass('show remove-border');
      $categorySelector.removeClass('remove-border').find('.arrow-icon').removeClass('arrow-up');
    });
  };

  productSpotlight.init = function () {
    $(document).ready(function () {
      var $productSpotlightCarousel = $('.product-spotlight-wrapper');

      $.each($productSpotlightCarousel, function (key, val) {
        productSpotlight.initCarousel(val);
        productSpotlight.initCategorySelector(val);
      });

      $(".product-spotlight-container .feature-tag").click(function(e){
        var link = $(this).attr("data-href");
        if(link){
            window.open(link);
        }
        return false;
      });
    });
  };

  return productSpotlight;
}($));

productSpotlight.init();
//use hiknow-v2 new-split-banner.js
;(function ($) {
    /**
     * 2a: 70-30
     * 3: 33-33-33
     * 2b: 30-70
     * 1: 50-50
     * */
    var LAYOUT_CLASS_LIST = ['layout2a', 'layout3', 'layout2b', 'layout1']
    var PROPOSED_WIDTH = 1370
    var MOBILE_WIDTH = 992
    var BASIC_HEIGHT = 400
    var FONT_MIN_RATIO = 12 / 18
    var PADDING_SPACE = 30 * 2
    var MARGIN_SPACE = 25 * 2

    var setSplitBannerSize = function () {
        // 用window.innerWidth会把滚动条的宽度一并计算进来，导致问题，因此这里用document.body.client
        // document.body.clientWidth 有些情况下会报错
        var screenWidth = $('body').width()
        if(document.body&&document.body.clientWidth){
            screenWidth = document.body.clientWidth
        }
        var ratio = screenWidth / PROPOSED_WIDTH
        var respectiveWidth = (screenWidth - PADDING_SPACE - MARGIN_SPACE) / 3
        LAYOUT_CLASS_LIST.forEach(function (cls) {
            $('.split-banner-wrapper').find('.' + cls).each(function () {
                var $carouselWrapper1 = $(this).find('.split-banner-wrapper.carousel1')
                var $carouselWrapper2 = $(this).find('.split-banner-wrapper.carousel2')
                var $carouselWrapper3 = $(this).find('.split-banner-wrapper.carousel3')
                if (screenWidth <= MOBILE_WIDTH || screenWidth >= PROPOSED_WIDTH) {
                    $carouselWrapper1.removeAttr('style')
                    $carouselWrapper2.removeAttr('style')
                    $carouselWrapper3.removeAttr('style')
                    $(this).removeAttr('style')
                    $(this).find('.split-banner-wrapper').each(function () {
                        $(this).find('.split-banner-content__header').removeAttr('style')
                        $(this).find('.split-banner-content__subheader').removeAttr('style')
                        $(this).find('.split-banner-content__item-detail').removeAttr('style')
                    })
                } else {
                    // 992-1370之间不同布局随比例调整宽高
                    $(this).css('height', BASIC_HEIGHT * ratio)
                    $(this).find('.split-banner-wrapper').each(function () {
                        $(this).find('.split-banner-content__header').css('font-size', 24 * Math.max(ratio, FONT_MIN_RATIO))
                        $(this).find('.split-banner-content__subheader').css('font-size', 18 * Math.max(ratio, FONT_MIN_RATIO))
                        $(this).find('.split-banner-content__item-detail').css('font-size', 18 * Math.max(ratio, FONT_MIN_RATIO))
                    })
                    if (cls === 'layout2a') {
                        $carouselWrapper2.css('width', respectiveWidth)
                    }
                    if (cls === 'layout3') {
                        $carouselWrapper1.css('width', respectiveWidth)
                        $carouselWrapper2.css('width', respectiveWidth)
                        $carouselWrapper3.css('width', respectiveWidth)
                    }
                    if (cls === 'layout2b') {
                        $carouselWrapper1.css('width', respectiveWidth)
                    }
                }
            })
        })
    }

    setSplitBannerSize()
    $(window).resize(setSplitBannerSize)
    function BuryingPointFn(element, preModule) {
        var href = $(element).attr('href')
        var lastHrefIndex = lastNode(href);
        $(element).attr('data-at-module', preModule + lastHrefIndex);
    }

    $.each($('.split-banner-carousel'),function(){
        if($(this).prev().hasClass('split-banner-carousel')){
            $(this).css('padding-top','0px');
            window.innerWidth > 991 ? $(this).prev().css('padding-bottom','25px') : false ;
        }
    })

    $('.split-banner-carousel .at-navigation:not(.hik-video-trigger)').on('click',function(){
        var analyticsStr=$(this).attr('data-analytics')
        HiAnalyticsCn.clickDown(analyticsStr)
    })
    if($('.carousel-mob .new-banner-full').length){
        $.each($('.carousel-mob .new-banner-full'), function(){
            new Swiper(this, {
                slidesPerView: 1,
                loop: $(this).find(".swiper-slide").length > 1 ? true : false,
                direction: 'horizontal',
                pagination: {
                    el: '.swiper-pagination',
                    clickable :true
                }
            });
        })
    }
    if($('.split-banner-wrapper').length){
        $.each($('.swiper-wrapper.split-banner .swiper-slide a.at-navigation'), function (index, item) {
            if ($(this).attr('href')) {
                var preModule = $(this).attr('data-at-module')
                BuryingPointFn(item, preModule)
                var ahref = $(this).attr('href')
                var target = $(this).attr('target')
                $(this).on('click', function (e) {
                    e.preventDefault()
                    setTimeout(function () {
                        window.open(ahref, target || '_self')
                    }, 500)
                })
            }
        })
        $.each($('.swiper-wrapper.split-banner .swiper-slide .video-play-btn-center a'), function (index, item) {
            if ($(this).attr('data-video-path')) {
                var preModule = $(this).attr('data-at-module')
                var path = $(this).attr('data-video-path')
                var lastHrefIndex = lastNode(path);
                $(this).attr('data-at-module', preModule + lastHrefIndex);
            }
        })
    }

    // if($('.split-banner-wrapper').length){
    //     $.ajax({
    //         type:"get",
    //         url:"./css/split-banner-css.html", //需要获取的页面内容
    //         async:true,
    //         success:function(data){
    //         console.log('data666', data)
    //         $('head').append(data);
    //       }
    //    })
    // }
})($);
var textGrids = (function ($) {
  var textGrids = {};


  textGrids.init = function () {
    $(document).ready(function () {
      //category-wrapper  category-content为空的时候 隐藏common title
      // var contentsWarp = $('.title-wrapper')
      // $.each(contentsWarp, function(index, item){
      //   var contents = $(this).parent().parent().siblings('.text-link-wrap').find('.main-category')
      //   if(!contents.length){
      //     $(this).hide()
      //   }
      // })
      //Main Category
      var btns = $('.text-link .category-wrapper .category-content .icon-right-arrow .main-category-link');
      $.each(btns, function (key, val) {
        var btnUrlOrg = $(val).attr('href');
        if(!$(val).attr('href')){
            btnUrlOrg = $(val).data('href');
        }else {
           $(val).removeAttr('href')
        }
        if(btnUrlOrg){
            var btnUrl = btnUrlOrg;

            var paths = btnUrlOrg.split('.');
            if (paths > 1) {
              var extension = paths[1];
              if (extension.toLowerCase() != 'html') {
                $(val).removeClass('at-navigation');
                $(val).addClass('at-download');
              }
            }

            btnUrl =  header.checkLoginStatusForDownload(btnUrl, val);
            if(btnUrl !== 'javascript:;'){
              $(val).attr('href', btnUrl);
            } else {
              $(val).removeAttr('href');
            }
            if (btnUrl !== '#download-agreement') {
              $(val).removeAttr('data-toggle');
              $(val).removeClass('at-action');
              if (btnUrl == btnUrlOrg) {
                $(val).removeClass('at-exit');
                $(val).addClass('at-download');
              }else if (btnUrl.toLowerCase().indexOf("javascript")>=0) {
                  $(val).removeClass('at-exit');
                  $(val).addClass('at-download');
              }else{
                  $(val).removeClass('at-download');
                  $(val).addClass('at-exit');
              }
            }
        }
      });

      // Sub Category
      var downloadBtns = $('.text-link .category-wrapper .category-content .icon-right-arrow .text-grid-sub-category-list li a');
      $.each(downloadBtns, function (key, val) {
        var btnUrlOrg = $(val).attr('href');
        if(!$(val).attr('href')){
            btnUrlOrg = $(val).data('href');
        }
          if(btnUrlOrg) {
              var btnUrl = btnUrlOrg;

              var paths = btnUrlOrg.split('.');
              if (paths > 1) {
                  var extension = paths[1];
                  if (extension.toLowerCase() != 'html') {
                      $(val).removeClass('at-navigation');
                      $(val).addClass('at-download');
                  }
              }
              btnUrl = header.checkLoginStatusForDownload(btnUrl, val);
              if(btnUrl !== 'javascript:;'){
                $(val).attr('href', btnUrl);
              } else {
                $(val).removeAttr('href')
              }
              if (btnUrl !== '#download-agreement') {
                  $(val).removeAttr('data-toggle');
                  $(val).removeClass('at-action');
                  if (btnUrl == btnUrlOrg) {
                      $(val).removeClass('at-exit');
                      $(val).addClass('at-download');
                  } else if (btnUrl.toLowerCase().indexOf("javascript") >= 0) {
                      $(val).removeClass('at-exit');
                      $(val).addClass('at-download');
                  } else {
                      $(val).removeClass('at-download');
                      $(val).addClass('at-exit');
                  }
              }
          }
      });
    });
  };

  return textGrids;
}($));
textGrids.init();
$(document).ready(function () {
    HiAnalyticsCn.clickDownLazy('.text-grid-container  a',isCnAnalytics);
});



var textGrid = (function ($) {
    var site = $('meta[name="locale"]').attr('content');
    var textGrid = {};
    textGrid.random = "";
    textGrid.downloadUrl = "";
    textGrid.textGridFormModal;
    textGrid.init = function () {
        $(document).ready(function () {
            var hasInit = {};
            $(".text-grid-form").not('.documentt-form').unbind('click').on("click", function(e){
                var linkPath = $(this).attr("href") || $(this).attr('data-href') || $(this).attr('data-mark');
                if(linkPath && linkPath.indexOf('youtu') !== -1){
                    return
                }
                atDataAnalytic($(this), e);
                var hasForm = $(this).attr("data-has-form");
                var random = $(this).attr("data-randomNo");
                var formTarget =  $(this).attr('data-target')
                textGrid.downloadUrl = $(this).attr("href") || $(this).attr('data-href') || $(this).attr('data-mark');
                textGrid.random = random;
                if (hasForm == "true") {
                    e.stopPropagation();
                    e.preventDefault();
                    $(this).removeAttr('data-href')
                    textGrid.popupInit(random, $(this), formTarget, hasInit[random]);
                    if(!hasInit[random]) {
                        hasInit[random] = true
                    }
                    $('body').addClass('hideScroll');
                } else {
                    if(!isCN && $(this).attr('data-download-checklogin')&&$(this).attr('data-download-checklogin') == "true"){
                        header.checkLoginStatusForDownload(textGrid.downloadUrl, $(this), $(this), "text-grid");
                     } else {
                         if (textGrid.downloadUrl !== '#download-agreement' && hasForm != "true") {
                            e.stopPropagation();
                            e.preventDefault();
                            if(textGrid.downloadUrl){
                                window.open(textGrid.downloadUrl, '_blank')
                            }
                         }
                     } 
                }
            });
            $.each($(".text-grid-form"),function(){
                var linkPath = $(this).attr("href") || $(this).attr('data-href') || $(this).attr('data-mark');
                if(linkPath && linkPath.indexOf('youtu') !== -1){
                    $(this).attr('data-video-path', linkPath)
                    $(this).addClass("hik-video-trigger")
                }
            })
            //仅对于国际站产品详情页,对有空格URL进行处理
            $.each($(".text-grid-pdp-link"),function(){
                var itemLink = $(this).attr('data-item-href');
                if(itemLink){
                    $(this).attr('href', itemLink);
                    if(itemLink.indexOf('youtu') !== -1){
                        $(this).attr('data-video-path', itemLink);
                        $(this).addClass("hik-video-trigger");
                    }
                }
            });

            //国际站agreement埋点处理
            $('.text-grid-pdp-link').unbind('click').on("click", function(e){
                var itemHref = $(this).attr('href');
                var compnentName = 'text-grid';
                var itemLink = $(this).attr('data-link');
                if(itemHref !== '#download-agreement'){
                    return;
                }
                window.compnentName = compnentName;
                var atModule = compnentName + "::" + $(this).data('pre-module') + '::' + lastNode(itemLink).replace('&', '') + atModel.atSpliter + window.location.href.replace('#download-agreement', '')
                atModel.doAtEvent(atModule, 'download', e);
            });

            var userType = $(".needLogin").attr("data-userType");
            var $textGrid = $(".text-grid-wrapper-check");

            if ($textGrid.length > 0 && $(".needLogin").length > 0 && userType != undefined) {
                var runMode = getLoginCookie("wcmmode");
                if (runMode == "edit" || runMode == "preview") {
                    return;
                }
                var hikId = $.cookie("HIKID");
                try {
                    hikId = atob(hikId);
                } catch (error) {
                    console.log("Login Error:" + error);
                }

                $textGrid.each(function () {
                    var mainCategory = $(this).attr("data-mainCategory");
                    var currentPagePath = $(this).attr("data-page-path");
                    var verifyUrl = $(this).attr("data-text-grid");
                    var showTextGridUrl = verifyUrl + ".usertype.json";

                    if (verifyUrl && mainCategory) {

                        $.ajax({
                            type: "GET",
                            url: showTextGridUrl,
                            data: {
                                hikId: hikId,
                                currentPagePath: currentPagePath
                            },
                            success: function (data) {
                                var jsonData = typeof data == "string" ? JSON.parse(data) : data;
                                if (jsonData.code == 200) {
                                    $("[data-text-grid='" + verifyUrl + "']").append($(jsonData.protectedComponent));
                                    // textGrid.init();
                                }
                            }
                        });
                    }

                })
            }

        });
    };

    textGrid.popupInit = function (random, $ele, target, hasInit) {
        var textGridFormModal = $("#text-grid-form-modal-" + random);
        var textGridFormFooter = textGridFormModal.find(".text-grid-form-footer");
        textGrid.textGridFormModal = textGridFormModal;
        var $textGridFormSubmit = textGridFormModal.find('.text-grid-form-submit');
        $textGridFormSubmit.attr("disabled", "disabled");
        var shadowBg = textGridFormModal.next();

        $(".verification img").attr("src", "/bin/hikvision/kaptcha.jpg?site=" + site + "&k=" + new Date().getTime());

        var textGridFormThanksMessage = textGridFormModal.find(".text-grid-form-thanks-message");
        var form = textGridFormModal.find(".text-grid-form-body");
        var textGridFormErrorMessage = textGridFormModal.find(".text-grid-form-error-message");
        var linkHref =  $ele.attr("href") || $ele.attr('data-href') || $ele.attr('data-mark');
        textGridFormModal.find("#text-grid-form-resource-url-" + random).val(document.location.origin + linkHref);

        textGridFormModal.parent().addClass('active');
        shadowBg.addClass("active");


        textGrid.addFormValidation(form);
        
        if(!hasInit) {
            textGrid.initOutlinedInputs(form);
            var countrySelect = textGrid.initCountrySelect(form);
            
            textGrid.autoFillUserInfo($ele, countrySelect);
    
            textGrid.initResetBtn(textGridFormFooter, textGridFormModal, countrySelect);
    
            initCloseBtn(textGridFormModal, textGridFormThanksMessage, textGridFormErrorMessage, shadowBg, random, countrySelect);
        }
        textGrid.validateRequiredMsg(form, textGridFormModal);

        //已登录用户自动填充用户信�

        $textGridFormSubmit.off('click').on('click', function (e) {
            if (form.valid()) {
                showVerifyModal(form, target)
            }
        })
    }

    textGrid.initCountrySelect = function (form) {
        var option = {
            onSelected: function ($ele, $input) {
                var val = $input.data('value');
                var code = $input.data('countryCode');
                $ele.find('input[name="countryCode"]').val(code).trigger('change').trigger('blur');
                $ele.find('input[name="Country"]').val(val).trigger('change').trigger('blur');
            }
        }

        return form.find('.hik-outlined-select').hikSelect(option);
    }

    textGrid.initOutlinedInputs = function (form) {
        form.outlinedFormLabelShrink();
    }

    function requiredCheckboxGroup(form) {
        var findInput = $(form).find(".text-grid-form-check:required");
        var result = true;
        findInput.each(function (key, item) {
            result = ($(item).find("input[type='checkbox']:checked").length > 0);
            if (!result) {
                return false;
            }
        });
        return result;
    }

    function checkRequired(form, submitBtn) {
        var requiredInputs = form.find('input:required');
        var isRequiredInputsFilled = true;
        for (var i = 0; i < requiredInputs.length; i++) {
            if ($(requiredInputs[i]).prop("type") === "checkbox") {
                if ($(requiredInputs[i]).is(":checked") === false) {
                    isRequiredInputsFilled = false;
                }
            } else {
                if ($(requiredInputs[i]).val() == "" || $(requiredInputs[i]).next('.error:visible').length) {
                    isRequiredInputsFilled = false;
                }
            }
        }
        var isRequiredCheckboxFilled = requiredCheckboxGroup(form);
        if (isRequiredInputsFilled && isRequiredCheckboxFilled) {
            submitBtn.removeAttr('disabled');
        } else {
            submitBtn.attr("disabled", "disabled");
        }
    }

    textGrid.validateRequiredMsg = function (form, textGridFormModal) {
        var $requiredInputElements = form.find('input:required');
        var $textGridFormSubmit = textGridFormModal.find('.text-grid-form-submit');

        $requiredInputElements.off('input change keyup').on('input change keyup', function () {
            setTimeout(function () {
                checkRequired(form, $textGridFormSubmit);
            }, 0)
        });

        form.off('change', '.text-grid-form-check input[type="checkbox"]').on('change', '.text-grid-form-check input[type="checkbox"]', function () {
            setTimeout(function () {
                checkRequired(form, $textGridFormSubmit);
            }, 0)
        });
    }

    textGrid.addFormValidation = function (form) {
        $.extend($.validator.messages, {
            required: Granite.I18n.get("This field is required."),
        });

        form.validate({
            focusInvalid: true,
            submitHandler: function (form, evt) {
                console.log('submit');
            },
            invalidHandler: function (event, validator) {
                console.log('invalid');
            },
            errorElement: "em",
            errorPlacement: function (error, element) {
                element.after(error)
            },
            highlight: function (element, errorClass, validClass) {
                if ($(element).parent().hasClass('hik-select-input')) {
                    $(element).parent().parent().parent().addClass('err')
                }
                $(element).siblings('label').addClass('err-lbl');
                $(element).parent().addClass('err');
            },
            unhighlight: function (element, errorClass, validClass) {
                if ($(element).parent().hasClass('hik-select-input')) {
                    $(element).parent().parent().parent().removeClass('err')
                    $(element).siblings('em').hide();
                }
                $(element).siblings('label').removeClass('err-lbl');
                $(element).parent().removeClass('err');
            },
            rules: {
                Email: {
                    required: true,
                    regex: /^([a-zA-Z0-9_.+-])+\@(([a-zA-Z0-9-])+\.)+([a-zA-Z0-9]{2,4})+$/,
                },
            },
            messages: {
                Email: {
                    regex: Granite.I18n.get("Please enter valid email address.")
                }
            }
        });
    }

    textGrid.submitForm = function (form, target) {
        //提交表单
        var currentUrl = window.location.href;
        $("input[name='Submitted_Page__c']").val(currentUrl);
        var action = form[0].action;
        var formData = new FormData(form[0]);
        var headers = getFormHeader(form);
        $.ajax({
            type: 'POST',
            url: action,
            data: formData,
            processData: false,
            contentType: false,
            beforeSend: function (request) {
                if (headers) {
                    $(headers).each(function (index, item) {
                        request.setRequestHeader(item.key, item.value);
                    });
                }
                request.setRequestHeader("KAPTCHA_SESSION_KEY", storeManager.cookie.get("KAPTCHA_SESSION_KEY"));
            }
        }).done(function (data) {
            $(".verification img").attr("src", "/bin/hikvision/kaptcha.jpg?site=" + site + "&k=" + new Date().getTime());
            form.next().find(".text-grid-form-submit").removeClass("loading");
            if (checkResultSuccess(data)) {
                textGrid.submitSuccess(target);
            } else {
                textGrid.showErrorMsg(data.message);
            }
        }).fail(function (resData) {
            $(".verification img").attr("src", "/bin/hikvision/kaptcha.jpg?site=" + site + "&k=" + new Date().getTime());
            form.next().find(".text-grid-form-submit").removeClass("loading");
            var resultBean = null;
            try {
                resultBean = JSON.parse(resData.responseText);
            } catch (error) {
                console.error(error.toString());
            }
            if (resultBean) {
                textGrid.showErrorMsg(resultBean.message);
            } else {
                textGrid.showErrorMsg("Unknown Error occurred!");
            }
        }).complete(function (XMLHttpRequest, status) {
            // for at event
            var module = "text_grid_form::Submit" + atModel.atSpliter + window.location.href;
            atModel.doAtEvent(module, 'action', event);
        });

        // form.find('input[type="submit"]').addClass("loading");
    }

    textGrid.submitSuccess = function (target) {
        var textGridFormModal = $("#text-grid-form-modal-" + textGrid.random);
        var shadowBg = textGridFormModal.next();
        var textGridFormThanksMessage = textGridFormModal.find(".text-grid-form-thanks-message");
        textGridFormModal.find(".text-grid-form-header").hide();
        textGridFormModal.find(".text-grid-form-body").hide();
        textGridFormModal.find(".text-grid-form-footer").hide();
        textGridFormThanksMessage.addClass("active");
        shadowBg.addClass("active");
        setTimeout(function(){
            textGridFormThanksMessage.removeClass("active");
            shadowBg.removeClass("active");
            $("body").removeClass("hideScroll")
            $(".text-grid-form-close").trigger("click")
        }, 1500)
        //表单提交成功后下�
        window.open(textGrid.downloadUrl, target)
        //window.location.href = textGrid.downloadUrl;
    }

    textGrid.autoFillUserInfo = function ($ele, countrySelect) {
        loginUtil.autoFillUserInfoInForm(textGrid.renderUserInfo, $ele, countrySelect);
    }

    textGrid.initResetBtn = function (textGridFormFooter, textGridFormModal, countrySelect) {
        textGridFormFooter.find(".text-grid-form-reset").off('click').on("click", function () {
            resetForm(textGridFormModal, countrySelect);
        });
    }

    textGrid.showErrorMsg = function (text) {
        var content = Granite.I18n.get(text);
        textGrid.textGridFormModal.find(".text-grid-form-error-message").addClass("active");
        textGrid.textGridFormModal.find(".text-grid-form-error-message-text").empty().html(content);
        textGrid.textGridFormModal.next().addClass("active");
    }

    textGrid.renderUserInfo = function (userInfo, $ele, countrySelect) {
        var $textGridContainer = $ele.parents('.text-grid-container');
        $textGridContainer.find('#text-grid-form-first-name-' + textGrid.random).val(userInfo.firstName)
        $textGridContainer.find('#text-grid-form-last-name-' + textGrid.random).val(userInfo.lastName)
        $textGridContainer.find('#text-grid-form-email-' + textGrid.random).val(userInfo.email);
        $textGridContainer.find('#text-grid-form-company-' + textGrid.random).val(userInfo.company);
        $textGridContainer.find('#text-grid-form-post-code-' + textGrid.random).val(userInfo.postcode);
        $textGridContainer.find('#text-grid-form-additional-details-' + textGrid.random).val(userInfo.address);
        countrySelect.changeSelectedVal(userInfo.country);
    }
     
    function atDataAnalytic($this, e) {
        //处理掉 #download-agreement
        var splitCompnent = $this.parent().parent().attr('class').split('-');
        var compnentName = splitCompnent[0] === 'offering' ? splitCompnent[0] : splitCompnent[0] + '-' + splitCompnent[1];
        var linkHref = $this.attr('data-href') || $this.attr('data-link') || $this.attr('data-mark');
        if(!linkHref)
            return;
        window.compnentName = compnentName;
        var atModule = compnentName + '::' + $this.data('pre-module') + '::' + lastNode(linkHref).replace('&', '') + atModel.atSpliter + window.location.href.replace('#download-agreement', '')
        atModel.doAtEvent(atModule, 'download', e);
    }



    function initPuzzleVerification(form, imageData, timer1, target) {
        $("#mpanel4").slideVerify({
            canvasImage: imageData.canvasImage,
            blockImage: imageData.blockImage,
            blockY: imageData.blockY,
            type: 2,
            vOffset: 5,
            vSpace: 5,
            blockSize: {
                width: "40px",
                height: "40px",
            },
            success: function (positionX) {
                createVerification(form,positionX)
                $('.verifyModalWrap').first().hide()
                textGrid.submitForm(form, target)
                clearTimeout(timer1)
            },
        });
        $('.verifyModalWrap .close-Verification').click(function () {
            $('.verifyModalWrap').first().hide()
            clearTimeout(timer1)
        })
    }

    function createVerification(form,val){
        $(form).find('input[name="positionVerification"]').remove()
        var positionVerification = document.createElement('input')
        $(positionVerification).attr('name','positionVerification')
        $(positionVerification).val(val).css('display','none')
        form.append(positionVerification);
    }

    /*
     * show verifyModalWrap
     */
    function showVerifyModal(form, target) {
        var type = getCurrentBreakPoint() =='DESKTOP' ? 'pc': 'mobile'
        var site = $('meta[name="locale"]').attr('content');
        $.ajax({
            type: "get",
            url: "/bin/hikvision/form-secure.image.json?size="+ type + "&site=" + site + "&t=" + new Date().getTime(),
            async: false,
            success: function (res) {
                if (res.code == 0) {
                    $('.verifyModalWrap').first().show();
                    var imageData = res.data
                    var timer1 = setTimeout(function () {
                        $('.verifyModalWrap').first().hide();
                        clearTimeout(timer1)
                    }, 50000)

                    initPuzzleVerification(form, imageData, timer1, target);
                }
            },
        });
    }

    function initCloseBtn(textGridFormModal, textGridFormThanksMessage, textGridFormErrorMessage, shadowBg, random, countrySelect) {
        textGridFormModal.find(".text-grid-form-close").unbind("click").on("click", function () {
            $("#text-grid-form-modal-" + random).parent().removeClass('active');
            textGridFormThanksMessage.removeClass("active");
            textGridFormErrorMessage.removeClass("active");

            resetForm(textGridFormModal, countrySelect);
            activeFormModal();
        });

        textGridFormThanksMessage.find(".text-grid-form-thanks-message-close").unbind("click").on("click", function () {
            $("#text-grid-form-modal-" + random).parent().removeClass('active');
            textGridFormThanksMessage.removeClass("active");

            activeFormModal();
        });


        textGridFormErrorMessage.find(".text-grid-form-error-message-close").unbind("click").on("click", function () {
            textGridFormErrorMessage.removeClass("active");
        });

        function activeFormModal() {
            textGridFormModal.find(".text-grid-form-body").show();
            textGridFormModal.find(".text-grid-form-footer").show();
            textGridFormModal.find(".text-grid-form-header").show();
            shadowBg.removeClass("active");
            $('body').removeClass("hideScroll");
        }
    }

    function resetForm(textGridFormModal, countrySelect) {
        textGridFormModal.find(".text-grid-form-field input[type='text']").val("");
        textGridFormModal.find(".text-grid-form-check input[type='checkbox']").prop("checked", false);
        textGridFormModal.find('.hasVal').removeClass('hasVal');
        textGridFormModal.find('.text-grid-form-submit').attr("disabled", "disabled");
        countrySelect.reset();
    }

    $.each($('.main-category-link'), function (index, item) {
        var atModule = $(this).data('pre-module')
        var $href = $(this).data('link') || $(this).data('href') || $(this).data('item-href') 
        if ($href) {
            $(this).attr('data-at-module', atModule)
            $(this).addClass('cursor')
        }
    })
    return textGrid;
})($);

textGrid.init();

(function (document, $) {
    var inMobile = false;
    var $bannerWrapper = $(".new-split-banner-wrapper");
    var isIpad = true
    

    var isIpadFn = function () {
        isIpad = navigator.appVersion.indexOf('iPad') > -1
    }
    isIpadFn()

    var initClick = function () {
        $bannerWrapper.find(".new-split-banner-col-des-mobile").on("click", function () {
            clickMobile($(this).prev())
        })
    };
    var clickMobile = function (mobile) {
        mobile[0].click()
    };

    var initIEHover = function () {
        var bgIE = $bannerWrapper.find(".public-style") 
        // bgIE.each(function () {
        //     $(this).find("a").css({"background-size":"100%"})
        // })
        if (window.innerWidth > 768) {
            bgIE.each(function () {
                $(this).hover(function(){
                    $(this).find("a").stop().animate({backgroundSize:"115%"})
                },function(){
                    $(this).find("a").stop().animate({backgroundSize:"105%"})
                })
            })
        }else {
            bgIE.each(function () {
                $(this).find("a").css({"background-size":"100%"})
                $(this).unbind('mouseover').unbind('mouseout')
                $(this).hover(function(){
                    $(this).find("a").stop().animate({backgroundSize:"100%"})
                })
            })
        }
        
    }
    $(document).ready(function () {
        initClick();
        initIEHover()
        var publicHover = $bannerWrapper.find(".public-style")
        if(isIpad){
            publicHover.each(function () {
                $(this).hover(function () {
                    $(this).find(".new-split-banner-col-des").css({
                        '-webkit-transform':'translate(0%, 35%)',
                        '-moz-transform': 'translate(0%, 35%)',
                        'transform': 'translate(0%, 35%)',
                        'transition': 'none'
                    })
                    $(this).find("a").css({
                        'background-size':'cover',
                        'transition': 'none'
                    })
                })
            })
        }
        $(window).resize(function () {
            var $bannerWrapper = $(".new-split-banner-wrapper");
            var $newSplitBanners = $bannerWrapper.find(".public-style");
            if (window.innerWidth > 768) {
                initIEHover();
                if (inMobile) {
                    inMobile = false;
                    $newSplitBanners.each(function () {
                        var $banner = $(this);
                        var $this = $banner.find(".bg-box");
                        var originalImage = $this.data('original');
                        replaceWebpOriginal($this)
                       // $this.css('background-image', 'url("' + originalImage + '")');
                    });
                }
            } else {
                initIEHover();
                if (!inMobile) {
                    inMobile = true;
                    $newSplitBanners.each(function () {
                        var $banner = $(this);
                        var $this = $banner.find(".bg-box");
                        var originalImageMobile = $this.data('original-mobile');
                        replaceWebpOriginal($this)
                       // $this.css('background-image', 'url("' + originalImageMobile + '")');
                    });
                }
            }
        });
        $bannerWrapper.find('a.lazy-banner').on('click',function(){
            var analyticsStr=$(this).attr('data-analytics')
            HiAnalyticsCn.clickDown(analyticsStr)         
        })
    });
})(document, $);
var buttonEvents = (function ($) {
  var buttonEvents = {};
  var getUrlRelativePath = function () {
    var url = $('.header-wrapper').attr('data-product-select');
    var arrUrl = url.split("//");

    var start = arrUrl[0].indexOf("/");
    var relUrl = arrUrl[0].substring(start);

    if (relUrl.indexOf("?") != -1) {
      relUrl = relUrl.split("?")[0];
    }
    return relUrl.replace(".html", "");
  };

  function redirect(url) {
    $.ajax({
      type: 'GET',
      url: url,
      data: {
        path: encodeURI(getUrlRelativePath())
      },
    }).done(function (data) {
      if (data && data.path) {
        window.location = data.path;
      } else {
        window.alert("Email confirm has an error, please contact the support!");
      }
    }).fail(function (result) {
      window.alert("Email confirm has an error, please contact the support!");
    });
  }

  buttonEvents.init = function () {
    $(document).ready(function () {
      var emailConfirm = $('.button-cmp').data('emailconfirm');
      var showAgreement = $('.button-cmp').data('showagreement');
      $('.download-agreement-link').on('click',function(e){
        var link=$(this).attr('data-link')
        var pageTitle=$('#header').attr('data-page-title')
        var dataLable= $(this).text();
        if(window.location.href.indexOf('/cn/support/Downloads') > -1){
          var analyticsStr='下载::button::跳出弹窗::[file-link]'+link+'::'+pageTitle
          HiAnalyticsCn.clickDown(analyticsStr)
        } else {
          var atButton = $(this).parent().parent().attr('class').split('-')
          var compnentName = atButton[0] === 'offering'? atButton[0] : atButton[0] + '-' + atButton[1]
          window.compnentName = compnentName
          var atModule = $(this).data('pre-module')+'::' + lastNode($(this).attr('data-href')) + atModel.atSpliter + window.location.href.replace('#download-agreement','')
          atModel.doAtEvent(atModule , 'download', e); 

          var analyticsStr = dataLable+'::button::跳出弹窗::'+lastNode(link)+'::'+pageTitle
          HiAnalyticsCn.clickDown(analyticsStr)
        }
      })
      $('.button-cmp .hiknow-button a:not(.download-agreement-link), .button-cmp .hiknow-view a').on('click',function(){
        var link=$(this).attr('data-href') || $(this).attr('href')
        var pageTitle=$('#header').attr('data-page-title')
        var dataLable= $(this).text();
        var analyticsStr = dataLable+'::button::跳转页面::'+lastNode(link)+'::'+pageTitle
        HiAnalyticsCn.clickDown(analyticsStr);
      })
      if (emailConfirm) {
        var query = window.location.search.substring(1);
        var btnUrl = $('.button-cmp .hiknow-button a').data('href');
        var viewUrl = $('.button-cmp .hiknow-view a').data('href');
        if (btnUrl) {
          if (btnUrl.indexOf('?') >= 0) {
            btnUrl += '&' + query;
          } else {
            btnUrl += '?' + query;
          }
        }
        if (viewUrl) {
          if (viewUrl.indexOf('?') >= 0) {
            viewUrl += '&' + query;
          } else {
            viewUrl += '?' + query;
          }
        }
        $('.button-cmp .hiknow-button a').on('click', function () {
            setSubmittedPageUrlCookie("NewsLetterUrl");
            setSubmittedPageUrlCookie("contactUsUrl");
            $(this).attr('disabled', 'disabled');
            redirect(btnUrl);
        });
        $('.button-cmp .hiknow-view a').on('click', function () {
            setSubmittedPageUrlCookie("NewsLetterUrl");
            setSubmittedPageUrlCookie("contactUsUrl");
          $(this).attr('disabled', 'disabled');
          redirect(viewUrl);
        });

      } else {
        $('.button-cmp .hiknow-button a').on('click', function () {
            setSubmittedPageUrlCookie("NewsLetterUrl");
            setSubmittedPageUrlCookie("contactUsUrl");
        });
        $('.button-cmp .hiknow-view a').on('click', function () {
            setSubmittedPageUrlCookie("NewsLetterUrl");
            setSubmittedPageUrlCookie("contactUsUrl");
        });
        var btns = $('.button-cmp .hiknow-button a, .button-cmp .hiknow-view a');
        $.each(btns, function (key, val) {
          var checkLogin = $(val).data('download-checklogin');
          var checkLoginCn = $(val).data('download-checklogin-cn');
          var btnUrlOrg = $(val).attr('href');
          if (showAgreement || checkLogin || checkLoginCn) {
            var btnUrl = btnUrlOrg;
            btnUrl = header.checkLoginStatusForDownload(btnUrl, val);
            $(val).attr('href', btnUrl);
            if (btnUrl !== '#download-agreement') {
              $(val).removeAttr('data-toggle');
              $(val).removeClass('at-action');
              if (btnUrl == btnUrlOrg) {
                $(val).removeClass('at-exit');
                $(val).addClass('at-download');
              } else if (btnUrl.toLowerCase().indexOf("javascript")>=0) {
                  $(val).removeClass('at-exit');
                  $(val).addClass('at-download');
              } else {
                  $(val).removeClass('at-download');
                  $(val).addClass('at-exit');
              }
            }
          } else {
            var paths = btnUrlOrg.split('.');
            if (paths > 1) {
              var extension = paths[1];
              if (extension.toLowerCase() != 'html') {
                $(val).removeClass('at-navigation');
                $(val).addClass('at-download');
              }
            }
          }
        });
      }
    });
  };
  return buttonEvents;
}($));
buttonEvents.init();

$(document).ready(function() {
  $('.title-wrapper .title-capitalize').each(function() {
      var text = $(this).text().toLowerCase();
      $(this).text(text);
  });
});
var windowWidth = $(window).width();
$(document).ready(function() {
  if ($(window).width() >= 768) {
      initCardCarousel();
      var livePreviewWrapper = $(".live-preview-wrapper")
      livePreviewWrapper.each(function(){
          var tabItems = $(this).find(".live-preview-nav .live-preview-nav-item");
          tabItems.on("click",function(){
              tabItemClick(this);
          });
         if(tabItems.length < 3) {
              $(this).find(".live-preview-nav").addClass("justify-content-center");
         }
      });
  }else {
      initTabCarousel();
  }
  globalSettings.init();
});

var getMatchCarousel = function(dataCarousel) {
    var matchedCarousel;
    $(".live-preview-list .live-preview-item").each(function(){
        if($(this).attr("data-carousel") == dataCarousel) {
            matchedCarousel = $(this);
        }
    });
    return matchedCarousel;
}

var initCardCarousel = function() {

  var activeCardCarousel = $(".live-preview-item.active .live-preview-carousel");
  activeCardCarousel.each(function(){
      var length = $(this).find(".live-preview-carousel-card").length
      if(length > 4){
          if(!$(this).hasClass("slick-slider")) {
              $(this).find(".live-preview-carousel-card").removeClass("col-3");
              toggleCardCarouselSlick($(this), true);
          }
      }
  })
}

var toggleCardCarouselSlick = function(activeCardCarousel,arrows) {

    activeCardCarousel.slick({
        dots: false,
        slidesToShow: 4,
        slidesToScroll: 4,
        arrows: arrows,
        accessibility: true,
        prevArrow: "<button class='slick-prev slick-arrow live-preview-btn' type='button' style=''><span></span></button>",
        nextArrow: "<button class='slick-next slick-arrow live-preview-btn' type='button' style=''><span></span></button>",
        useCss: true,
        lazyload: "ondemand",
        unslick: true
    });
}

var initTabCarousel = function() {
  $(".live-preview-wrapper").each(function(){
      var livePreviewNav = $(this).find(".live-preview-tab .live-preview-nav");
      var livePreviewNavItems = livePreviewNav.find(".live-preview-nav-item");
      livePreviewNavItems.each(function(){
          var dataCarousel = $(this).attr("data-carousel");
          var matchedCarousel = getMatchCarousel(dataCarousel);
          matchedCarousel.find(".live-preview-carousel-card").removeClass("col-3");
          $(this).find(".live-preview-nav-item-inner").append(matchedCarousel);
      });
      if(livePreviewNavItems.length >1){
          toggleTabCarouselSlick(livePreviewNav);
      }
  });
  var slickSlides = $(".slick-slide");
  slickSlides.each(function(){
    $(this).attr("data-slide-height",$(this).height());
  });
  setTabCarouselHeightForMobile();
}

var toggleTabCarouselSlick = function(livePreviewNav) {
  livePreviewNav.slick({
      dots: false,
      slidesToShow: 1,
      slidesToScroll: 1,
      arrows: true,
      accessibility: true,
      useCss: true,
      prevArrow: "<button class='slick-prev slick-arrow btn live-preview-btn' type='button' style=''><img src='/etc/clientlibs/it/resources/icons/icon-prev.png' alt=''></button>",
      nextArrow: "<button class='slick-next slick-arrow btn live-preview-btn' type='button' style=''><img src='/etc/clientlibs/it/resources/icons/icon-next.png' alt=''></button>",
      lazyload: "ondemand"
  });

  livePreviewNav.on('afterChange', function() {
      var slickCurrentHeight = livePreviewNav.find(".slick-current").attr("data-slide-height");
      livePreviewNav.find(".slick-track").height(slickCurrentHeight);
  });
}

var tabItemClick = function(item){
  var livePreviewTab = $(item).parents(".live-preview-tab");
  var activeLivePreviewNavItem = livePreviewTab.find(".live-preview-nav .live-preview-nav-item.active");
  if (!$(item).is(activeLivePreviewNavItem)){
      activeLivePreviewNavItem.removeClass("active");
      $(item).addClass("active");
      var dataCarousel = $(item).attr("data-carousel");
      var activeItem = livePreviewTab.next().find(".live-preview-item.active");
      activeItem.removeClass("active");
      activeItem.find(".live-preview-carousel.slick-initialized").each(function(){
          $(this).slick("unslick");
      });
      var matchedCarousel = getMatchCarousel(dataCarousel);
      if (matchedCarousel) {
          matchedCarousel.addClass("active");
          initCardCarousel();
      }
  }
}

var setTabCarouselHeightForMobile = function() {
    $(".live-preview-wrapper").each(function(){
        $(this).find(".slick-track").height($(this).find(".slick-current").attr("data-slide-height"));
    });
}

$(window).resize(function(){
    if($(window).width() >= 768 && windowWidth < 768) {
        $(".live-preview-tab .live-preview-nav.slick-initialized").slick("unslick");
        $(".live-preview-nav-item .live-preview-nav-item-inner .live-preview-item").each(function(){
            $(this).parents(".live-preview-tab").next().append($(this));
            $(this).find(".live-preview-carousel-card").addClass("col-3");
        });
        $(".live-preview-nav .live-preview-nav-item").on("click", function(){
            tabItemClick(this);
        });
        initCardCarousel();
    }

    if($(window).width() < 768 && windowWidth >= 768) {
        $(".live-preview-item.active .live-preview-carousel.slick-initialized").slick("unslick");
        $(".live-preview-nav .live-preview-nav-item").unbind();
        initTabCarousel();
    }
    windowWidth = $(window).width();
})
$(document).ready(function() {
    $('.grid-list-wrapper a').unbind('click').click(function(){
        var target = $(this).attr('target')
        var href= $(this).attr('data-href')
        window.open(href,target)
    })
});

(function (document, $) {
    function initPaddingTop(){
        $.each($('.card-gallery'),function(){
            if($(this).prev().hasClass('card-gallery')){
             //   $(this).find('.card-gallery-wrapper').css('margin-top','0px')
            }
        })
    };
    function addClassforCn(){
        if(JudgeWebLanguage('cn')){
            $('.card-gallery').addClass('cn-card-gallery');
        }
    };
    function openLink(){
        $(".card-gallery-content .hik-video-trigger").click(function (e) {
            e.stopPropagation();
        })
        $(".card-gallery-content").click(function(e){
           if($(e.target).is('video') || $(e.target).hasClass('hik-video-trigger') || $(e.target).hasClass('hik-video-wrapper') || $(e.target).hasClass('plyr__control') || $(e.target).hasClass('plyr__controls__item') || !$(e.target).attr('class')) {
            return false;
           } else {
            if(!($(e.target).attr("data-is-jump"))){
                $(this).parent().find(".btn-link").click()
                var hasVideo = $(this).find(".icon-play").length > 0;
                //有链接有视频，点击图片打开视频；有链接无视频，点击图片打开链接
                if(!(hasVideo && (e.target == $(this).find(".icon-play")[0] || e.target == $(this).find(".content-img")[0]))){
                    var link = $(this).attr("data-href");
                    var target = $(this).attr("data-target");
                    if(link){
                        var title = atModel.getTitle(event.currentTarget);
                      //  atModel.doAtEvent(title, 'navigation', e);
                        if (target=="_blank") {
                            window.open(link);
                        } else {
                            window.location.href = link;
                        }
                    }
                }
            }
           }
        });
    }

    $(window).resize(function () {
        $(".card-gallery").each(function(){
            $(this).find(".card-gallery-content").each(function(){
                $(this).removeAttr("style");
            });
        });
        // setCardHeight();
    });
    var pageTitle=$("#header").attr('data-page-title')
    $('.card-gallery .card-gallery-content-desc a').unbind().on('click',function(e){
            e.stopPropagation()
            e.preventDefault()
            var ahref = $(this).data('href') || $(this).attr('href')
            if(ahref && !_.startsWith(ahref ,'http') && $(this).attr('target') != '_blank'){
              setTimeout(function() {
                window.open(ahref, '_self')
              }, 500)
            } else if(ahref) {
              setTimeout(function() {
                window.open(ahref, '_blank')
              }, 500)
            }
            var analyticsData=$(this).text()+"::Card Gallery::跳转页面::[complete-link]"+$(this).attr('href')+"::"+pageTitle
            HiAnalyticsCn.clickDown( analyticsData)
    })
    $('.card-gallery .card-gallery-content').unbind('click').on('click',function(){
            var href=$(this).attr('data-href')
            var analyticsStr=$(this).attr('data-analytics')
            href ? HiAnalyticsCn.clickDown( analyticsStr) : false;
    })

    //统一每行card gallery的高度
    // function setCardHeight(){
    //     $(".card-gallery").each(function(){
    //         var height;
    //         $(this).find(".card-gallery-content").each(function(){
    //             $(this).height('auto');
    //             var h = $(this).height();
    //             if(height){
    //                 height = height > h ? height :h;

    //             }else{
    //                 height = h;
    //             }
    //         });
            
    //         $(this).find(".card-gallery-content").each(function(){
    //             $(this).height(height);
    //         });
    //     });
    // }
    
    //无链接无交互
    function initCATHover() {
        $.each($('.card-gallery-wrapper-check'),function(){
          $.each($(this).find('.card-gallery-content'), function(){
            if(!$(this).attr('data-href')){
                $(this).addClass('no-link');
                $(this).find('.card-gallery-content-img').addClass('no-link')
            } else {
                var currentHref = $(this).attr("data-href")
                if(currentHref && currentHref.indexOf("http") > -1 && currentHref.indexOf(window.location.host) < 0){
                   $(this).attr("rel", "nofollow")
                }
            }
            if($(this).find(".card-gallery-content-img") && $(this).find(".card-gallery-content-img").find("a").hasClass("hik-video-trigger")){
                var currentHref =$(this).find(".card-gallery-content-img").find("a").attr("data-video-path")
                if(currentHref && currentHref.indexOf("http") > -1 && currentHref.indexOf(window.location.host) < 0){
                    $(this).find(".card-gallery-content-img").find("a").attr("rel", "nofollow")
                 }
            }
            // 点击按钮弹出视频弹窗播放视频
            $('.player-btn').off().on('click', function(e){
                e.stopPropagation();
                var video = $(this).attr('data-video-path')
                var isYoutube = $(this).attr('data-internal-video') === 'false'
                $('html').addClass('overflow-prevent')
                initVideoModal(video, isYoutube, )
            })
          })
        })  
    }
    function initLazyImage(){
        $.each($(".card-gallery").find(".lazy-image-single"), function(){
           if(!$(this).closest(".content-detail-section").length){
            if($(this).is('div')){
                $(this).css('background-image', 'url("' + $(this).attr("data-original") + '")');
            } else {
                if(getCurrentBreakPoint() != "MOBILE"){
                    $(this).attr('src', $(this).attr("data-src"));
                } else {
                    var mobImage = $(this).attr("data-src") || $(this).attr("data-mob-src")
                    $(this).attr('src', mobImage);
                }
            }
           }
        })
      }
    function initMouseHideCardBorder(){
        $.each($('.card-gallery-content.hide-card-border'), function(){
            var self = this
            $(this).find('.card-gallery-content-img,.card-gallery-content-title,.card-gallery-content-desc').hover(function(){
               $(self).addClass('active_black') 
            },function(){
                $(self).removeClass('active_black') 
            })
        })
         $.each($('.card-gallery-content'), function(){
            var maxLength = 0;
            var longestLi = null;
            var textLength = $(this).text().length;

                // 比较并更新最大长度和对应li元素
                if (textLength > maxLength) {
                    maxLength = textLength;
                    longestLi = $(this);
                }
         })
    }  
    $(document).ready(function(){
        initPaddingTop();
        addClassforCn();
        // setTimeout(setCardHeight, 1000);
        // hoverLearnMore()
        openLink();
        initCATHover();
        initMouseHideCardBorder();
        initLazyImage();
        // $('.mult-tabs-container-comp').on('multi-tabs-change', function() {
        //     setCardHeight();
        // });
        $('.card-gallery-modal').on('show.bs.modal', function (e) {
            e.stopPropagation();
        })
        var userType = $(".needLogin").attr("data-userType");
        var cardGallery = $(".card-gallery-wrapper-check");
        if(cardGallery.length > 0 && $(".needLogin").length > 0 && userType != undefined){
            var runMode = getLoginCookie("wcmmode");
            if(runMode == "edit" || runMode =="preview"){
                return;
            }
            var hikId = $.cookie("HIKID");
            try {
                hikId = atob(hikId);
            } catch (error) {
                console.log("Login Error:" + error);
            }
            cardGallery.each(function(){
                var thisCardPath = $(this).attr("data-card-gallery");
                var currentPagePath = $(this).attr("data-page-path");
                var showCardGalleryUrl = thisCardPath + ".usertype.json";
                if(thisCardPath){
                    $.ajax({
                        type: "GET",
                        url: showCardGalleryUrl,
                        data: {
                            hikId: hikId,
                            currentPagePath: currentPagePath
                        },
                        success: function(data){
                            var jsonData = typeof data=="string" ? JSON.parse(data):data;
                            if(jsonData.code == 200){
                                $("[data-card-gallery='"+thisCardPath+"']").append($(unescape(jsonData.protectedComponent)));
                                openLink();
                            }
                        }
                    });
                }

            })

        }
    })
})(document, $);

var productComparisonBottom = (function ($) {
  var productComparisonBottom = {};
  var compareContBox =  '<div class="compare-contbox"></div>';
  $('body').append(compareContBox);
  productComparisonBottom.getCurrentBreakpoint = function () {
    var contentValue = window.getComputedStyle(
      document.querySelector('.compare-contbox'),'::before'
    ).getPropertyValue('content');
    return contentValue.replace(/\"/g, '');
  };

  productComparisonBottom.addProductToCompare = Granite.I18n.get("Up to 4 products")
  productComparisonBottom.closeCompareBar = function () {
    $(".compare-cont").slideUp();
    var compareArrary = productComparisonBottom.getCompareArray();
    if(compareArrary.length > 0) {
      $("#compareBtm-2").show(800);
    } else {
      $("#compareBtm-2").css("display", "none");
    }
  };
  productComparisonBottom.clearCompareData = function () {
    $('html').removeClass('overflow-prevent');
    productComparisonBottom.setCompareArray([]);
    
    var emptyDesktop = '<div class="empty-cont active-compare-cont"><div class="add-item">' + productComparisonBottom.addProductToCompare + '</div></div>';
    var emptyMobile = '<div class="add-item">' + productComparisonBottom.addProductToCompare + '</div>';
    var html = productComparisonBottom.getCurrentBreakpoint() == 'DESKTOP' ? emptyDesktop : emptyMobile;
    var itemParentNode = productComparisonBottom.getCurrentBreakpoint() == 'DESKTOP' ? '.compare-content > .compare-items-cont' : '.compare-cont > .compare-items-cont';

    $(itemParentNode).empty();
    $(itemParentNode).append('<div class="compare-item" id="item-1">'+ html +'</div>');
    $(itemParentNode).append('<div class="compare-item" id="item-2">'+ html +'</div>');
    $(itemParentNode).append('<div class="compare-item" id="item-3">'+ html +'</div>');
    $(itemParentNode).append('<div class="compare-item" id="item-4">'+ html +'</div>');
    $(".comp-count").text(0);

    $('.compare-btn').addClass('disabled');
    $('.compare-btn').attr('data-at-module', "compare");

    compareTriggers.forEach(function (value) {
      if ($(value).is("input") && ($(value).attr('type') === 'checkbox')) {
        $(value + ':checked').trigger('click');
        $(value + ':checked').prop('checked', false);
        if(!$(".product_description_compare .add-to-compare-chk").is(":checked")){
          $(".product_add_compare-btn").show();
          $(".product_added_compare-btn").hide();
        }
      }
    });
    
    if(productComparisonBottom.getCurrentBreakpoint() == 'MOBILE'){
      $('.compare-cont .compare-items-cont').css('display', 'none');
      productComparisonBottom.removeLayout();
      $(".compare-cont").slideToggle('slow');
    }
  };
  productComparisonBottom.setCompareArray = function (compareArrary) {
    if (window.localStorage) {
      localStorage.setItem('compare-products', JSON.stringify(compareArrary));
    }
  };
  productComparisonBottom.getCompareArray = function () {
    if (window.localStorage) {
      var compareArrary = JSON.parse(localStorage.getItem('compare-products'));
      if (!compareArrary)
        compareArrary = [];
      return compareArrary;
    }
    return [];
  };
  var oHtml = "<div id='toast-to' ><img src='/etc/clientlibs/it/resources/icons/toast.png'/>Exceeds the maximum number of options</div>"
  productComparisonBottom.addCompareDataItem = function (productUrl, event) {
    var compareArrary = productComparisonBottom.getCompareArray();
    var title = $(event.currentTarget).data('at-module');
    if (!isNull(title)) {
      title = title.split(' ').join('_');
      title = title + atModel.atSpliter + window.location.href;
    } else {
      var titles = productUrl.replace(/\.html/, '').split('/');
      title = titles.pop();
      if (isNull(title)) {
        title = titles.pop();
      }
      title = "product spotlight::compare::" + title + atModel.atSpliter + window.location.href;
    }
    // at event
    atModel.doAtEvent(title, 'action', event);

    // todo max length of compare array should add to a config
    if (compareArrary.length == 4) {
      // pop message max compare count
      var parentBody = $(window.parent.document.body);
      $(parentBody).append(oHtml);
      setTimeout(function () {
        parentBody.find("#toast-to").remove();
      }, 3000);
      // $(this).prop('checked', false);
      $(event.target).prop('checked', false); 

      return;
    }
    var index = compareArrary.findIndex(function (item) {
      return item.productUrl === productUrl;
    });
    // get product properties form pis system into local storage for compare
    $.getJSON(productUrl.replace(".html", ".model.json"), function (json) {
      json.productUrl = productUrl;
      if (index >= 0) {
        compareArrary[index] = json;
      } else {
        compareArrary.push(json);
      }
      productComparisonBottom.setCompareArray(compareArrary);
      productComparisonBottom.renderCompareDataItem(compareArrary.length, json, index);
      var module = $('.compare-btn').attr('data-at-module');
      if (compareArrary.length === 1) {
        $('.compare-btn').attr('data-at-module', module + atModel.atSpliter + json.productNo);
      } else {
        $('.compare-btn').attr('data-at-module', module + "|" + json.productNo);
      }
    });
  };
  productComparisonBottom.renderCompareDataItem = function (index, productModel, isSame) {
    var same = isSame + 1;
    if (isSame >= 0) {
      $(".compare-cont #item-" + same).empty();
    } else {
      $(".compare-cont #item-" + index).empty();
    }
    // 图片大小转换pc用319x319 mobile用140x100
    var pImage = productModel.productImage
    if(productModel.productImage){
      if(getCurrentBreakpoint()== 'DESKTOP'){
        pImage = productModel.productImage.replace(/1280.1280/g, '319.319')
      } else {
        pImage = productModel.productImage.replace(/1280.1280/g, '140.100')
      }
    }
    var itemDesktop = 
      '<div class="item-cont" style="background: #FFF url(\'' + pImage + '\') no-repeat center;background-size: auto 88px;">' + 
        '<div class="item-title">' + productModel.productNo + '</div>' +
        '<div class="close-item" data-product-url="' + productModel.productUrl + '">' +
          '<div  class="remove-items" id="remove-item-1" data-at-module="compare_bottom::compare::remove' + productModel.productNo + '" >' +
            '<img src="/etc/clientlibs/it/resources/icons/close-defaults-1.svg" alt="Close">' +
          '</div >' +
        '</div>' +
     '</div>';

    var itemMobile = 
      '<div class="item-cont" style="background: #FFF url(\'' + pImage + '\') no-repeat center;background-size: contain;"></div>' +
      '<div class="item-title">' + productModel.productNo + '</div>' +
      '<div class="close-item" data-product-url="' + productModel.productUrl + '">' +
        '<div  class="remove-items" id="remove-item-1" data-at-module="compare_bottom::compare::remove' + productModel.productNo + '" >' +
          '<img src="/etc/clientlibs/it/resources/icons/close-defaults-1.svg" alt="Close">' +
        '</div >' +
      '</div>';


      if (isSame >= 0) {
        $(".compare-cont #item-" + same).append(getCurrentBreakpoint() == 'DESKTOP' ? itemDesktop : itemMobile);
      } else {
        $(".compare-cont #item-" + index).append(getCurrentBreakpoint() == 'DESKTOP' ? itemDesktop : itemMobile);
      }


    $('.comp-count').text(index);
    $('.compare-btn').removeClass('disabled');
  };

  productComparisonBottom.removeCompareDataItem = function (productKey, event) {

    var title = $(event.currentTarget).data('at-module');
    if (!isNull(title)) {
      title = title.split(' ').join('_');
      title = title + "::remove::" + window.location.href;
    } else {
      var titles = productKey.replace(/\.html/, '').split('/');
      title = titles.pop();
      if (isNull(title)) {
        title = titles.pop();
      }
      title = "product spotlight::compare::remove" + title + atModel.atSpliter + window.location.href;
    }
    // at event
    atModel.doAtEvent(title, 'action', event);

    // product key is pis url
    var compareArrary = productComparisonBottom.getCompareArray();
    var index = compareArrary.findIndex(function (item) {
      return item.productUrl === productKey;
    });
    if (index >= 0) {
      var module = $('.compare-btn').attr('data-at-module');
      $('.compare-btn').attr('data-at-module', module.replace("|" + compareArrary[index].productNo, ""));

      compareArrary.splice(index, 1);
      productComparisonBottom.setCompareArray(compareArrary);
      productComparisonBottom.initCompareData();
    }
  };
  productComparisonBottom.initCompareData = function () {
    var compareData = productComparisonBottom.getCompareArray();
    compareData.forEach(function (value, index) {
      productComparisonBottom.renderCompareDataItem(index + 1, value);
      $('input[data-product-url="' + value.productUrl + '"]').prop('checked', true);
      if($(".product_description_compare .add-to-compare-chk").is(":checked")){
          $(".product_add_compare-btn").hide();
          $(".product_added_compare-btn").show();
      }

      var module = $('.compare-btn').attr('data-at-module');
      if (index === 0) {
        $('.compare-btn').attr('data-at-module', module + atModel.atSpliter + compareData[index].productNo);
      } else {
        $('.compare-btn').attr('data-at-module', module + "|" + compareData[index].productNo);
      }
    });
    for ((i = compareData.length + 1); i <= 4; i++) {
      $(".compare-cont #item-" + i).empty();
      $(".compare-cont #item-" + i).append($('.compare-item-empty').html());
    }
    $('.comp-count').text(compareData.length);
    if (compareData.length === 0) {
      $('.compare-btn').addClass('disabled');
      if(productComparisonBottom.getCurrentBreakpoint() == 'MOBILE'){
        $('.compare-cont .compare-items-cont').css('display', 'none');
        $('.compare-cont .compare-items-cont').removeClass('active');
        $('html').removeClass('overflow-prevent');
        productComparisonBottom.removeLayout();
        $(".compare-cont").slideUp('slow');
      }
    } else {
      $('.compare-btn').removeClass('disabled');
    }
  };
  productComparisonBottom.renderCompareBottom = function (isShow) {
    var compareCont = $('.compare-cont');
    if (compareCont.length === 0) {
      var compartPath = $(".header-wrapper").attr('data-compare');

      var compareDesktop =
        '<div class="compare-cont">' +
          '<div class="compare-content">' +
            '<div class="compare-items-cont">' +
              '<div class="compare-item" id="item-1">' +
                  '<div class="empty-cont active-compare-cont">' +
                    '<div class="add-item"></div>' +
                  '</div>' +
              '</div>' +
              '<div class="compare-item" id="item-2">' +
                  '<div class="empty-cont active-compare-cont">' +
                    '<div class="add-item">' + productComparisonBottom.addProductToCompare + '</div>' +
                  '</div>' +
              '</div>' +
              '<div class="compare-item" id="item-3">' +
                  '<div class="empty-cont active-compare-cont">' +
                    '<div class="add-item">' + productComparisonBottom.addProductToCompare + '</div>' +
                  '</div>' +
              '</div>' +
              '<div class="compare-item" id="item-4">' +
                  '<div class="empty-cont active-compare-cont">' +
                    '<div class="add-item">' + productComparisonBottom.addProductToCompare + '</div>' +
                  '</div>' +
              '</div>' +
            '</div>' +
            '<div class="compare-btn-wrapper">' +
              '<div class="comp-clear-btn">' +
                '<div class="clear-all-btn">' + Granite.I18n.get("Clear All") + '</div>' +
              '</div>' +
              '<a class="compare-btn at-navigation" data-at-module="compare" href="' + compartPath + '" target="_blank">' +
                '<div class="comp-btn-text compare-products">' + Granite.I18n.get("Compare") + '</div>' +
                '<div class="comp-count">2</div>' +
              '</a>' +
            '</div>' +
          '</div>' +
          '<div class="close-compare-tab" id="closeCompare">' +
            '<img src="/etc/clientlibs/it/resources/icons/close-defaults-big-1.svg" alt="Close" id="">' +
          '</div>' +
          '<div class="compare-item-empty">' +
            '<div class="empty-cont active-compare-cont">' +
              '<div class="add-item">' + productComparisonBottom.addProductToCompare + '</div>' +
            '</div>' +
          '</div>' +
        '</div>' +
        '<div class="compare-btn-cont" id="compareBtm-2">' +
          '<div class="compare-btn">' +
            '<div class="comp-count">2</div>' +
            '<div class="comp-btn-text compare-list">' + Granite.I18n.get("Compare") + '</div>' +
          '</div>' + 
        '</div>';

      var compareMobile = 
        '<div class="compare-cont">' +
          '<div class="compare-items-cont">' +
            '<div class="compare-item" id="item-1">12321421' +
                '<div class="empty-cont active-compare-cont">' +
                  '<div class="add-item">1111111</div>' +
                '</div>' +
            '</div>' +
            '<div class="compare-item" id="item-2">' +
              '<div class="add-item">' + productComparisonBottom.addProductToCompare + '</div>' +
            '</div>' +
            '<div class="compare-item" id="item-3">' +
              '<div class="add-item">' + productComparisonBottom.addProductToCompare + '</div>' +
            '</div>' +
            '<div class="compare-item" id="item-4">' +
              '<div class="add-item">' + productComparisonBottom.addProductToCompare + '</div>' +
            '</div>' +
          '</div>' +
          '<div class="compare-mobile-bar">' + 
            '<div class="compare-bar-sum-container">' +
              '<div class="compare-bar-sum">' + 
                Granite.I18n.get("Compare Products") + ' ('+  '<span class="compare-bar-active-product comp-count">0</span>' + '/4)' +
              '</div>' +
              '<div class="compare-view-detail">' + Granite.I18n.get("View Details") + '</div>' +
            '</div>' +
            '<div class="compare-btn-wrapper">' +
              '<a class="compare-btn at-navigation" data-at-module="compare" href="' + compartPath + '" target="_blank">' +
                '<div class="comp-btn-text compare-products">' + Granite.I18n.get("Compare") + '</div>' +
              '</a>' +
              '<div class="comp-clear-btn">' +
                '<div class="clear-all-btn">' + Granite.I18n.get("Clear All") + '</div>' +
              '</div>' +
            '</div>' +
          '</div>' +
          '<div class="compare-item-empty">' +
            '<div class="add-item">' + productComparisonBottom.addProductToCompare + '</div>' +
          '</div>' +
        '</div>';


      // console.log(productComparisonBottom.getCurrentBreakpoint());
      var html = productComparisonBottom.getCurrentBreakpoint() == 'DESKTOP' ? compareDesktop : compareMobile;

      $('body').append(html);

      $(".compare-cont").css("display", "none");
      $("#compareBtm-2").css("display", "none");

      // for events
      $("body").on("click", ".compare-cont #closeCompare", productComparisonBottom.closeCompareBar);
      $("body").on("click", ".compare-btn-cont#compareBtm-2", function () {
        $(".compare-cont").slideToggle("slow");
        $(".compare-cont").show(800);
        if(productComparisonBottom.getCurrentBreakpoint() == 'DESKTOP') $(".compare-cont").css("display", "block");
        $(".compare-btn-cont#compareBtm-2").hide();
      });

      $("body").on("click", ".compare-cont .compare-item .close-item", function (e) {
        var productUrl = $(this).attr('data-product-url');
        // $('input[data-product-url="' + productUrl + '"]').trigger('click');
        $('input[data-product-url="' + productUrl + '"]').prop('checked', false);
        if(!$(".product_description_compare .add-to-compare-chk").is(":checked")){
          $(".product_add_compare-btn").show();
          $(".product_added_compare-btn").hide();
        }
        productComparisonBottom.removeCompareDataItem(productUrl, e);
      });
      $("body").on("click", ".compare-cont .comp-clear-btn", productComparisonBottom.clearCompareData);
      productComparisonBottom.viewAllMobile();
      productComparisonBottom.initCompareData();
    }
    if (isShow && $(".compare-cont").css("display") !== "block") {
      $(".compare-cont").slideToggle("slow");
      $(".compare-cont").show(500);
      if(productComparisonBottom.getCurrentBreakpoint() == 'DESKTOP') $(".compare-cont").css("display", "block");
      $(".compare-btn-cont#compareBtm-2").hide();
    }
  };

  productComparisonBottom.viewAllMobile = function () {
    $('.compare-mobile-bar .compare-view-detail').on('click', function(e){

      e.stopPropagation();
      if (!$('.compare-items-cont').hasClass("active") ){
        $('html').addClass('overflow-prevent');
        $('.compare-items-cont').addClass('active');
        $('.compare-cont .compare-items-cont').slideDown('fast');
        $('body').append('<div class="layout compare"></div>');
      } else {
        $('.compare-items-cont').removeClass('active');
        $('.compare-cont .compare-items-cont').slideUp('fast');
        $('body .layout').remove();
        $('html').removeClass('overflow-prevent');
      }
      $('.layout.compare').on('click', function() {
        $('.compare-cont .compare-items-cont').slideUp('fast');
        $('body .layout').remove();
        $('html').removeClass('overflow-prevent');
        $('.compare-items-cont').removeClass("active")
      })
    })
  }

  productComparisonBottom.initComparetEvent = function (comparetTriggerItem) {
    $(comparetTriggerItem).removeAttr('onclick');
    $(comparetTriggerItem).unbind("click").click(function (e) {
      e.stopPropagation();
      productComparisonBottom.renderCompareBottom(true);
      var productUrl = $(this).attr('data-product-url');
      var isAdd = true;
      // if event target is checkbox checked state is add
      // if not checkbox should add attribute data-isadd
      if ($(this).is("input") && ($(this).attr('type') === 'checkbox')) {
        isAdd = $(this).is(":checked");
      } else {
        isAdd = $(this).attr('data-isadd');
      }
      if (productUrl) {
        if (isAdd) {
          $(this).prop('checked', true);
          productComparisonBottom.addCompareDataItem(productUrl, e);
        } else {
          productComparisonBottom.removeCompareDataItem(productUrl, e);
        }
      }
    });
  };

  productComparisonBottom.removeLayout = function () {
    $('body .layout').remove();
  }

  productComparisonBottom.handleMobileViewCompare = function () {
    var contactUsBtnContent = $(".btn-content .contact-us-btn-content");
    var compareBtnContent = $(".compare-btn-cont");
    if (contactUsBtnContent.length != 0) {
      if ($(window).width() <= 1024) {
        contactUsBtnContent.after(compareBtnContent);
      } else {
        $(".compare-cont").after(compareBtnContent);
      }
    }
  };

  productComparisonBottom.init = function (comparetTriggerItem) {
    $(document).ready(function () {
      productComparisonBottom.renderCompareBottom();
      productComparisonBottom.initComparetEvent(comparetTriggerItem);
      productComparisonBottom.handleMobileViewCompare();
    });

    $(window).resize(function () {
      productComparisonBottom.handleMobileViewCompare();
    });
  };

  return productComparisonBottom;
})($);

var compareTriggers = [".add-to-compare-chk"];
for (var i = 0; i < compareTriggers.length; i++) {
  productComparisonBottom.init(compareTriggers[i]);
};

;
(function (document, $) {
  if($(window).width()<=991){
    if($(".widget-combination-wrapper").hasClass("widget-combination-small")){
      $.each($(".widget-combination-wrapper"), function(){
        var $widgetCombinationWrapper = $(this)
        if($widgetCombinationWrapper.hasClass("widget-combination-small")){
        var verticalHtmls = []
        var horizontalHtmls = []
        var squareHtmls = [] 
        $.each($widgetCombinationWrapper.find(".widget-combination-list").find(".widget-combination-card"), function(index, item){ 
        var itemTxt = $(item).attr("data-title") ? $(item).attr("data-title").trim(): '';
        var itemHtml = $(item).html()
        var mobOriginal = $(item).attr("data-original-mobile")
        $(item).empty()
        if(itemHtml && !mobOriginal){
          $(item).append(itemHtml)
        }
        $(item).append(htmlElementNode("div", ['widget-title', $(item).attr("data-titleAlign"), $(item).attr("data-titleColor")],itemTxt))
        if($(item).hasClass("widget-vertical")){
          verticalHtmls.push($(item).attr("order", index))
        } else if($(item).hasClass("widget-horizontal")) {
          verticalHtmls.push($(item).attr('order', index))
        } else if($(item).hasClass("widget-square")) {
          squareHtmls.push($(item).removeClass("widget-combination-card").addClass("widget-combination-item").addClass("scroll-lazy-image").attr('order', index))
        }
        }) 
        var indexD = 0
        countSmallPositionMobile(verticalHtmls,horizontalHtmls,squareHtmls, $(this).find('.widget-combination-list'))
        setTimeout(function() {
            $.each($widgetCombinationWrapper.find(".widget-swiper"), function(){
              var $swiper = $(this)
              var $index = 0
              var $cIndex = $swiper.parent().find('.widget-swiper-pagination').find('.swiper-pagination-bullet.swiper-pagination-bullet-active').index()
              var smallSwipper = new Swiper(this, {
                slidesPerView: "auto",
                loop: false,
                // centeredSlides: true,
                 spaceBetween: 15,
                 pagination: {
                    clickable :true,
                    el: $swiper.parent().find('.widget-swiper-pagination'),
                    bulletElement : 'li',
                },
                on: {
                  touchEnd:function(event){
                    if(event.changedTouches[0].pageX<200&&event.changedTouches[0].pageX>0){
                      indexD++
                    } else if(event.changedTouches[0].pageX<=0){
                      indexD = 1
                    } else {
                      indexD<0?indexD:indexD--
                    }
                    if($(event.target).hasClass('swiper-slide')){
                      $index = $(event.target).index()
                      if($index === 1 && $(event.target).parent().offset().left>-300){
                        $index = -1
                      }
                      if($index === 0 && $(event.target).parent().offset().left>100){
                        $index = -1
                      }
                      console.log('xxx', $(event.target).parent().offset())
                    } else {
                     // 
                     if($(event.target).parent().offset().left>0){
                      $index = 0
                     }
                    //  $index = $(event.target).parent().index() >= 2 ? 1:$(event.target).parent().index()
                    }
                  //  console.log('indexD', indexD)
                    // $.each($(event.target).parent().find('.swiper-slide'), function(index, item){
                    //  if($(item).find(".widget-title").text() === $(event.target).find(".widget-title").text()){
                    //   console.log('index11', index, $(item).index())
                    //  }
                    // })
                    $swiper.parent().find('.widget-swiper-pagination').find('.swiper-pagination-bullet').removeClass('swiper-pagination-bullet-active')
                    $swiper.parent().find('.widget-swiper-pagination').find('.swiper-pagination-bullet').eq($index + 1).addClass('swiper-pagination-bullet-active')
                },        
                slidePrevTransitionEnd:function(){
                  console.log('pre', indexD);
                },
                slideNextTransitionEnd:function(){
                  console.log('next',indexD);
                }
                }
              })
            })
            $.each($(".widget-combination-item"), function(){
                $(this).on("click", function(){
                  if($(this).data("href")){
                  window.open($(this).data("href"), '_self')
                }
                })
             })
          }, 300);
        }
      })
    }
  }
   // 创建html元素
   function htmlElementNode(element,classNames, content){
    var oDivs = document.createElement(element)  
    oDivs.className = classNames.join(" ")
    oDivs.innerHTML = content
    return oDivs
  }
    // small style  mobile布局修改
    function countSmallPositionMobile(verticalHtmls,horizontalHtmls,squareHtmls, parentElement){
      var verticalAndHorizontalArrs = []
     // $(parentElement).empty()
      console.log('verticalHtmls', verticalHtmls)
      $.each(verticalHtmls,function(index,item){
        if($(item).attr("data-item-index") < 6){
          $(item).addClass("swiper-slide").removeClass("widget-combination-card").addClass("widget-combination-item").addClass("scroll-lazy-image")
          $(item).attr("index", index)
          $(parentElement).append($(item))
          verticalAndHorizontalArrs.push(item)
        }
      })  
      var lastItem = $(parentElement).find(".widget-combination-item").last()
        var renderSqueryHtmls = splitSquareHtmls(squareHtmls)
        $.each(renderSqueryHtmls, function(index,es){
            if(index<3-verticalAndHorizontalArrs.length){
              var currentSquare = squareFlexWapperConnections(es, index)
                $(parentElement).append($(currentSquare))
                if(lastItem.length){
                  if($(currentSquare).attr("order")>$(lastItem).attr("order")){
                    $(lastItem).after($(currentSquare))
                    lastItem = currentSquare
                   } else {
                    $(lastItem).after($(currentSquare))
                    lastItem = currentSquare
                   }
                } else {
                  $(parentElement).append($(currentSquare).attr('index', '3'))
                }
            }
        })
    }
  // 将所有的square元素分成每一组处理成被flex-wapper包裹的html元素集合
  function squareFlexWapperConnections(elements, index){
    var $currentDivElement = $("<div class='swiper-slide widget-combination-item' index='"+index+"' order='"+elements[0].attr("order")+"'></div>")
     $.each(elements, function(index, element){
      $currentDivElement.append(element)
     })
     return $currentDivElement
   }
  // 将所有的square元素分成两两一组
  function splitSquareHtmls (widgets){
      var widgetGroups = []; 
       $.each(widgets, function(index, widget) { 
        if (index % 2 === 0) { 
          widgetGroups.push(widgets.slice(index, index + 2)); 
        } 
     });
    return widgetGroups
  }
})(document, $)

$(function () {
  if($('.swiper-container.small-banner-full-carousel').length){
    $.each($('.swiper-container.small-banner-full-carousel'), function(){
      if($(this).parent().parent().parent().hasClass("content-detail-section")){
        return false;
      }
      var self = this
      var bannerId = $(self).attr("id")
      var thinBannerSwiper = new Swiper(this, {
        watchOverflow: true,
        disableScroll: true,
        loop: $(this.$el).find(".thin-loop-div span").length>1 ? true:false,
        noSwiping:  getCurrentBreakPoint() == 'MOBILE' ? false : true,
        autoplay: true,
        pagination: {
            clickable :true,
            el: '.swiper-pagination',
            bulletElement : 'li',
            renderBullet: function (index, className) {
                return '<div class="' + className + '"><div class="swiper-carousel-div"><span class="swiper-carousel-span"></span></div></div>';
            },
        },
        on: {
          transitionStart: function(){
            if(isInViewPort($(self).get(0))){
              var _self = $(this.$el).find(".swiper-slide-active")
              var imgSrc = $(_self).find("picture").attr("data-src")
              var mobImgSrc = $(_self).find("picture").attr("data-mob-src")
              var imageAltText =  $(_self).find(".text-wrapper .small-banner-full__item--title").html() || 'Thin Banner Image Text'
              $(".swiper-carousel-div").removeClass("text-color-grey text-color-white").addClass(_self.attr("data-color"))
              $.each(_self, function(i,e){
                $(e).find("source").attr("srcset", $(e).attr("data-srcset"))
              })
              if(!$(_self).find("picture").find("img").length){
                if(getCurrentBreakpoint()!== "MOBILE"){
                  // find("img").attr("src", $(this).find("img").attr("data-src"))
                  if(imgSrc){
                   $(_self).find("picture").append("<img decoding='async' src='"+imgSrc+"' alt='"+imageAltText+"' /> ")
                  }
                }else{
                    if(mobImgSrc){
                     $(_self).find("picture").append("<img decoding='async' src='"+mobImgSrc+"' alt='"+imageAltText+"' /> ")
                    }
              }
              }
            }
          }
      }
      });
      $(this).hover(function(){
        thinBannerSwiper.autoplay.stop();
        $("#" + bannerId).find(".swiper-pagination-bullet.swiper-pagination-bullet-active .swiper-carousel-div span").addClass("slow")
    },function(){
        thinBannerSwiper.autoplay.start();
        $("#" + bannerId).find(".swiper-pagination-bullet.swiper-pagination-bullet-active .swiper-carousel-div span").removeClass("slow")
    });
    })
  }
  var $targetButton = $('.small-banner-full__item--button').parent()
  $targetButton.on('click', function(e){
    var url = $(this).attr("href");
    var currentUrl = window.location.href;
    var dataModule = $(this).data('at-module')
    atModel.doAtEvent(dataModule + '::' + currentUrl, 'navigation', e)
        if(url.indexOf('software-apply-trial') > -1){
            setLoginCookie("applyTrialUrl", currentUrl);
        }
        if(url){
          var buttonText=$(this).find("button").text()
          var linkStr= url.indexOf('/content/dam') > -1 ? '下载::[file-link]' + url : '跳转页面::[complete-link]'+ url
          var analyticsStr =buttonText+"::Thin Banner Carousel::"+linkStr +"::"+$("#header").attr('data-page-title')
          HiAnalyticsCn.clickDown(analyticsStr); 
        }

  })
})
;
(function (document, $) {
    $(document).ready(function () {
        var $cardStreamComp = $('.card-stream-component')
        var isDesktop = getCurrentBreakPoint() == "DESKTOP"

        if($cardStreamComp.length){
            var cardWidth = ($(window).innerHeight() - ($(window).innerWidth() < 1440 ? 250 : 400)) * 1.776
            var contentWidth =  $(window).innerWidth() < 1370 ? $(window).innerWidth() - 30 : 1310
            // 1920px下是1.28
            var slideNum = (contentWidth / (cardWidth + 30)) < 1 ? 1 : (contentWidth / (cardWidth + 50))
            var space = $(window).innerWidth() < 1370 ? 50 : 60;
            $.each($cardStreamComp, function(){
                var $comp = $(this) 
                if(isDesktop && $comp.attr('data-editPage') != 'edit'){
                    $comp.parent().css('height',+ $comp.height() + $comp.find('.card-stream-item').length * 500 +"px") 
                }
                var $cardStreamWrapper = $comp.find('.card-stream-wrapper')
                var cardStreamSwiper =  new Swiper($cardStreamWrapper, {
                    slidesPerView: isDesktop ? slideNum : ($(window).width() - 30 ) / 315 ,
                    spaceBetween: isDesktop ? space : 15,
                    allowTouchMove: isDesktop ? false : true,
                    pagination: {
                        el: '.swiper-pagination',
                        clickable :false
                    },
                    normalizeSlideIndex: false,
                    on: {
                        slideChangeTransitionEnd: function(){ 
                            $(this.$el).find('.plyr__control--overlaid.plyr__control--pressed').click();
                            $(this.$el).find('.swiper-slide').eq(this.activeIndex).find('.plyr__control.plyr__control--overlaid').click();

                        },
                    }
                });
                onScroll($comp,cardStreamSwiper)
                //添加弹窗视频弹出的逻辑
                $(this).find('.card-stream-video-button,.card-stream-mob-video-button').on('click', function(){
                if(getCurrentBreakPoint() === 'DESKTOP'){
                    if($(this).parent().hasClass('play')){
                        $(this).next('.card-video-button').trigger('click')
                        window.$checkedVideo = $(this).next('.card-video-button')
                    } else {
                        window.$checkedVideo = null
                    }
                }  else {
                    if( $(this).parent().find('.card-stream-video').hasClass('play')){
                        $(this).parent().find('.card-stream-video').find('.card-video-button').trigger('click')
                        window.$checkedVideo =  $(this).parent().find('.card-stream-video').find('.card-video-button')
                    } else {
                        window.$checkedVideo = null
                    }
                }
                   var video = $(this).attr('data-video-path')
                   var isYoutube = $(this).attr('data-internal-video') === 'false'
                   initVideoModal(video, isYoutube, )
                    $('html').addClass('overflow-prevent')
               //   $("body").addClass("hideScroll")
                })
            })

        }

        $cardStreamComp.find('.card-video-button').on('click',function(){
            // if($(this).hasClass('pause')){
            //     $(this).removeClass('pause')
            // } else{
            //     $(this).addClass('pause')
            // }
            $(this).parents(".card-stream-video").find('.plyr__control.plyr__control--overlaid').click();
        })

        function bindVideoClick() {
            if(!isSafari() || getCurrentBreakPoint() !== 'DESKTOP'){
                var videos = $cardStreamComp.find('video');
                if (videos.length) {
                  videos.each(function(index, ele) {
                    // 直接在视频元素上绑定事件
                    $(this).on('play', function() {
                      $(this).parents('.card-stream-video').addClass('play').removeClass('pause').removeClass('ended');
                    }).on('pause', function() {
                      $(this).parents('.card-stream-video').addClass('pause').removeClass('play').removeClass('ended');
                    }).on('ended', function() {
                      $(this).parents('.card-stream-video').addClass('ended').removeClass('play').removeClass('pause');
                    });
              
                    var _this = this;
                    setTimeout(function() {
                      if(getCurrentBreakPoint()!=='MOBILE'){
                        if (!isElementInViewport($(_this).parents('.card-stream-video').get(0))) {
                          $(_this).parents('.card-stream-video').addClass('ended').removeClass('play').removeClass('pause');
                        } 
                        if(!$(_this).closest('.swiper-slide').hasClass('swiper-slide-active')){
                          $(_this).parents('.card-stream-video').addClass('ended').removeClass('play').removeClass('pause');
                        }
                      } else {
                        if (index !==0) {
                          $(_this).parents('.card-stream-video').addClass('ended').removeClass('play').removeClass('pause');
                        } 
                      }
                    }, 200);
                  });
                }
            } else {
                var video = document.querySelector('video');
                video.addEventListener('play', function() {
                  console.log('视频开始播放');
                });
                video.addEventListener('pause', function() {
                  console.log('视频暂停');
                });
                video.addEventListener('ended', function() {
                  console.log('视频播放结束');
                });
            }
          }
        window.onload = function(){
          bindVideoClick();  
        }

        function onScroll($comp,cardStreamSwiper){
            $(window).scroll(function(){
                checkIfSticky($comp.parent(),$comp,cardStreamSwiper)
            })
        }

        function checkIfSticky($pageWapper,$comp,cardStreamSwiper){
            if (!$pageWapper.length) return;
            if (getCurrentBreakpoint() != 'DESKTOP') return
            if (getPostion($pageWapper, 'top') < 0) {
                var listBtmTop = getPostion($pageWapper, 'top') + getPostion($pageWapper, 'height');
                if (listBtmTop - $comp.outerHeight() > 0) {
                    $comp.css('top', 0);
                    var num = $comp.find('.card-stream-item').length
                    var scrollSlide = (getPostion($pageWapper, 'height') - getPostion($comp, 'height')) / num
                    var index = parseInt(($(window).scrollTop() - $pageWapper.offset().top ) / scrollSlide) 
                    cardStreamSwiper.slideTo(index,500)
                } else {
                    $comp.css('top', listBtmTop - $comp.outerHeight());
                }
                stickyFilterList(true,$pageWapper,$comp)
            } else {
                stickyFilterList(false,$pageWapper,$comp)
            }
        }

        function getPostion($ele, pos) {
            if (!$ele || $ele.length === 0)
                return;
            return $ele[0].getBoundingClientRect()[pos];
        }

        function stickyFilterList(isSticky,$pageWapper,$compContent) {
            if (isSticky) {
                $pageWapper.addClass('sticky');
            } else {
                $pageWapper.removeClass('sticky');
                $compContent.css('top', '');
            }
        }
        // 判断元素是否在屏幕范围之内
        function isElementInViewport(el) {
            const rect = el.getBoundingClientRect();
            return (
              rect.top >= 0 &&
              rect.left >= 0 &&
              rect.bottom <= (window.innerHeight || document.documentElement.clientHeight) &&
              rect.right <= (window.innerWidth || document.documentElement.clientWidth)
            );
          }
          //判断是否为safari浏览器
          function isSafari() {
            var userAgent = navigator.userAgent.toLowerCase();
            return userAgent.indexOf('safari') !== -1 && userAgent.indexOf('chrome') === -1;
          }
    });
})(document, $);
;
(function (document, $) {
    $(document).ready(function () {
        var $elements = []
        $.each($('.multi-scenario-switching-wrapper'), function(){
           if(!$(this).parent().parent().parent().hasClass('content-detail-section')){
            $elements.push($(this))
           } 
        }) 
        initMultiScenario($elements);
    });
})(document, $);
$(document).ready(function() {
    initTextOverImageComp();
});
var initTextOverImageComp = function() {
    var currentBreakPoint = getCurrentBreakPoint();
    function updateImageSrc($comp, breakPoint) {
        var $urlData = $comp.find('.img-box');
        var $desktopList = $comp.find('.text-list.desktop');
        var $mobileList = $comp.find('.text-list.mobile');
        var path;

        if (breakPoint !== 'DESKTOP') {
            path = $urlData.attr('data-mobile-img');
            $desktopList.removeClass('active');
            $mobileList.addClass('active');
        } else {
            path = $urlData.attr('data-desktop-img');
            $desktopList.addClass('active');
            $mobileList.removeClass('active');
        }
       if(!$comp.parent().parent().parent().hasClass("content-detail-section")){
        $comp.find('.bg-img').attr('src',path);
       }
    }

    function updateCTAWidth($comp) {
        $comp.find('.cta-link').each(function() {
            var $parent = $(this).closest('.text-container');
            var titleWidth = $parent.find('.title')[0].style.width;
            var descriptionWidth =  $parent.find('.description')[0].style.width;
            var maxWidth = titleWidth > descriptionWidth ? titleWidth : descriptionWidth;
            $(this).css('max-width', maxWidth);
        });
    }

    $('.text-over-image-comp').each(function() {
        var $comp = $(this);
        updateImageSrc($comp, currentBreakPoint);
        updateCTAWidth($comp);
    });

    $(window).on('resize',function() {
        setTimeout(function() {
            var newBreakPoint = getCurrentBreakPoint();
            if (newBreakPoint !== currentBreakPoint) {
                currentBreakPoint = newBreakPoint;
                $('.text-over-image-comp').each(function() {
                    var $comp = $(this);
                    updateImageSrc($comp, newBreakPoint);
                });
            }
        },0)
    });
};

$(document).ready(function() {
    $.each($('.newsroom-hero-banner-box'), function(){
        var _this = this
        $(this).find('.newsroom-hero-banner-swiper-wrapper').slick({
            dots:false,
            arrows:false,
            autoplay:true,
            autoplaySpeed:4500,
        });
        var total = $(this).attr("data-size");
        appendDots(this, Number(total));
        bindEvents(this);
        animateSlide(this);
        heddenDot(this);
        $(this).find('.newsroom-hero-banner-swiper-wrapper').on('afterChange', function(event, slick, currentSlide) {
            $(_this).find('li button').stop();
            $(_this).find('li button').css('width', 0);
            $(_this).find('li').removeClass('slick-active');
            $(_this).find('li').eq(currentSlide).addClass('slick-active');
            animateSlide(_this);
        });
    
        $(this).find('.newsroom-hero-banner-swiper-slide').on('mouseover', function() {
            stopAnimation(_this);
        });
    
        $(this).find('.newsroom-hero-banner-swiper-slide').on('mouseleave', function() {
            animateSlide(_this);
        });
    }) 
    function animateSlide(ele) {
        $(ele).find('.slick-active button').stop().animate({
            width: '100%'
        }, 4500, 'linear', function() {
            $(ele).find('li button').css('width', 0);
        });
    }

    function stopAnimation(ele) {
        var $button = $(ele).find('.slick-active button');
        $button.stop();
        var width =  $button.width();
        $button.css('width', width);
    }

    function jumpAuthorLink() {
        $('.newsroom-hero-banner-swiper-slide-news-Author-right').on('click',function (event) {
            event.preventDefault();
            event.stopPropagation();
            var dataAuthor = $(this).attr('data-value');
            var dataName = "newsroom_hero_banner::blog_author::" + $(this).attr('data-name');
            atModel.doAtEvent(dataName, 'navigation', event);
            window.location.href = dataAuthor;
        })
    }

    function jumpTopicLink($target) {
        $('.newsroom-hero-banner-swiper-slide-news-bottom-right span').on('click',function (event) {
            event.preventDefault();
            event.stopPropagation();
            var dataTopic = $(this).attr('data-value');
            var hrefTopic = $target.attr('data-path');
            var href = hrefTopic + '?pageType=blog'+'&topic=' + dataTopic;
            atModel.doAtEvent('newsroom_hero_banner::blog_topic::' + dataTopic, 'action', event);
            window.location.href = href;
        })
    }

    function heddenDot(ele) {
        var dotLength = $(ele).find('.newsroom-hero-banner-swiper-wrapper').find('.newsroom-hero-banner-swiper-slide').length;
        if(dotLength === 1){
            $(ele).find('li').css('width', 0);
        }
    }

    function appendDots(elements, total) {
        if(!$(elements).find('.newsroom-hero-banner-swiper-wrapper').find('.slick-dots').length && total > 1){
            var html = '<ul class="slick-dots" style="" role="tablist">';
            for (var index = 1; index < total + 1; index++) {
                html += '<li role="presentation" class="' + (index === 1 ? 'slick-active' : '') + '" data-index="' + index + '"><button type="button" tabindex="-1"></button></li>'
            }
            html += '</ul>';
            $(elements).find('.newsroom-hero-banner-swiper-wrapper').append(html);
        };
    }

    function bindEvents(ele) {
        $(ele).find('.newsroom-hero-banner-swiper-wrapper').on('click', '.slick-dots li', function() {
            var index = $(this).attr('data-index');
            var currentSlide = $(ele).find('.newsroom-hero-banner-box .newsroom-hero-banner-swiper-wrapper').slick('slickCurrentSlide');
            if (index - 1 !== currentSlide) {
                $(ele).find('.newsroom-hero-banner-swiper-wrapper').slick('slickGoTo', index - 1);
            }
        });
    }

    function getIsVideo($target) {
        var $bannerBox = $target.find('.newsroom-hero-banner-swiper-slide-bgc');
        $bannerBox.on('click',function (event) { 
           var $videoBtn = $(this).find('.video-play-btn-center');
           if ($videoBtn.length) {
            var isVideo = $videoBtn.data('is-video');
            if (isVideo) {
                event.preventDefault();
            }
           }
        })
    }
    // youtubeImage
    function getYouTubeBeImg($target) {
        var $youTubeBox = $target.find('.newsroom-hero-banner-swiper-slide-bgc.slide-youtobevideo');
        $youTubeBox.each(function(){
            var videoPath = $(this).find('.hik-video-trigger').attr('data-video-path');
            if(videoPath){
                var youtubeVideoId = getVideoId(videoPath,'v');
                var youtubeImage =location.protocol + '//img.youtube.com/vi/' +youtubeVideoId+ '/0.jpg';
                $(this).find('.newsroom-hero-banner-swiper-slide-img-a').css('background-image','url('+youtubeImage+')')
            }
        })
    }
    jumpAuthorLink();

    $('.newsroom-hero-banner-box').each(function () {
        const $target = $(this);
        jumpTopicLink($target);
        getIsVideo($target)
        getYouTubeBeImg($target)
    })
  });
$(document).ready(function () {
    //slick化
    function dogSlick() {
        $('.newsroom-hero-banner-success-mob').slick({
            dots: true,
            arrows: false,
            autoplay: true,
            autoplaySpeed: 5000,
        })
    }
    dogSlick()
    $('.contenttext-mob-act').css('animation-fill-mode','forwards')
    $('.newsroom-hero-banner-success-mob').on('afterChange',function(){
        $('.newsroom-hero-banner-success-contenttext-mob').css('animation','')
        $('.slick-active').find('.newsroom-hero-banner-success-contenttext-mob').css('animation','showtext .5s linear')
        $('.newsroom-hero-banner-success-contenttext-mob').css('animation-fill-mode','forwards')
    })
    //页面初始化加载
    $('.newsroom-hero-banner-success-item').mouseover(function () {
        //图片容器
        $(this).addClass('active');
        $(this).siblings().removeClass('active');
        //蒙层
        $('.mantle').removeClass('mantle')
        $($(this).children().children()[1]).addClass('mantle')
        //文字
        $('.newsroom-hero-banner-success-contenttext').css('z-index','-1')
        $($(this).children().children().children()[2]).css('z-index','')
    })

    // $('.newsroom-hero-banner-success').each(function () {
    //     $comp = $(this);
    // })

})
$(document).ready(function () {
    $('.interactive-banner-carousel').each(function () {
        if(!$(this).parent().parent().parent().hasClass("content-detail-section")){
            const $that = $(this);
            initSwiper($that);
            toggeleVideo($that);
        }
    });
});

</script>

</body>
</html>
